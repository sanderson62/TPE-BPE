* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40******************************************************************
    41
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL156.cbl
    43 ENVIRONMENT DIVISION.
    44
    45 DATA DIVISION.
    46
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    53 77  WS-SSN  PIC X(9) VALUE ZEROS.
    54 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    55
    56*    COPY ELCSCTM.
    57******************************************************************
    58*                                                                *
    59*                                                                *
    60*                            ELCSCTM                             *
    61*                            VMOD=2.001                          *
    62*                                                                *
    63*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    64*                                                                *
    65******************************************************************
    66 01  SECURITY-MESSAGE.
    67     12  FILLER                          PIC X(30)
    68            VALUE '** LOGIC SECURITY VIOLATION -'.
    69     12  SM-READ                         PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' PGM='.
    72     12  SM-PGM                          PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' OPR='.
    75     12  SM-PROCESSOR-ID                 PIC X(4).
    76     12  FILLER                          PIC X(6)
    77            VALUE ' TERM='.
    78     12  SM-TERMID                       PIC X(4).
    79     12  FILLER                          PIC XX   VALUE SPACE.
    80     12  SM-JUL-DATE                     PIC 9(5).
    81     12  FILLER                          PIC X    VALUE SPACE.
    82     12  SM-TIME                         PIC 99.99.
    83
    84
    85*    COPY ELCSCRTY.
    86******************************************************************
    87*                                                                *
    88*                                                                *
    89*                            ELCSCRTY                            *
    90*                            VMOD=2.001                          *
    91*                                                                *
    92*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    93*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    94*        SAVED IN PI-SECURITY-ADDRESS.                           *
    95*                                                                *
    96******************************************************************
    97 01  SECURITY-CONTROL.
    98     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    99     12  FILLER                       PIC XX    VALUE 'SC'.
   100     12  SC-CREDIT-CODES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL156.cbl
   101         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   102             20  SC-CREDIT-DISPLAY    PIC X.
   103             20  SC-CREDIT-UPDATE     PIC X.
   104     12  SC-CLAIMS-CODES.
   105         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   106             20  SC-CLAIMS-DISPLAY    PIC X.
   107             20  SC-CLAIMS-UPDATE     PIC X.
   108
   109 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   110 01  WS-DATE-AREA.
   111     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   112     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   113     12  SAVE-DATE-CCYYMMDD.
   114         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   115         16  SAVE-DATE-YMD.
   116             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   117             20  FILLER              PIC X(04)   VALUE SPACES.
   118
   119 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   120 01  STANDARD-AREAS.
   121     12  WS-RESPONSE         PIC S9(8)   COMP.
   122         88  WS-RESP-NORMAL              VALUE +00.
   123         88  WS-RESP-ERROR               VALUE +01.
   124         88  WS-RESP-NOTFND              VALUE +13.
   125         88  WS-RESP-DUPREC              VALUE +14.
   126         88  WS-RESP-ENDFILE             VALUE +20.
   127     12  PMT-HEAD-A.
   128         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   129         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   130         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   131-        '     RESERVES  TYPE    AMOUNT'.
   132     12  PMT-HEAD-B.
   133         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   134         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   135         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   136     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   137     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   138     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   139     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   140     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   141     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   142     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   143     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   144     12  PGM-NAME            PIC X(8).
   145     12  TIME-IN             PIC S9(7).
   146     12  TIME-OUT-R  REDEFINES TIME-IN.
   147         16  FILLER          PIC X.
   148         16  TIME-OUT        PIC 99V99.
   149         16  FILLER          PIC XX.
   150     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   151     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   152     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   153     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   154     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   155     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   156     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   157     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   158     12  LINK-001            PIC X(8)    VALUE 'EL001'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL156.cbl
   159     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   160     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   161     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   162     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   163     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   164     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   165     12  WS-BLANK            PIC X       VALUE ' '.
   166
   167 01  MISC-WORK-AREAS.
   168     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   169     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   170     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   171     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   172     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   173     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   174     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   175     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   176     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   177     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   178     12  W-CALLED-NAME           PIC X(08).
   179     12  W-EOB-CODES.
   180         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   181             20  W-EOB-CODE      PIC XXX.
   182             20  W-EOB-FILLER    PIC X.
   183     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   184     12  W-NAME-LAST             PIC X(15).
   185     12  W-NAME-FIRST            PIC X(15).
   186     12  W-NAME-MIDDLE.
   187         16  FILLER              PIC X.
   188         16  W-NAME-MIDDLE-2     PIC X.
   189         16  FILLER              PIC X(13).
   190     12  W-DMD-CHECK-NO.
   191         16  W-DMD-CHECK-NO-1    PIC X(4).
   192         16  W-DMD-CHECK-NO-2    PIC X.
   193         16  W-DMD-CHECK-NO-3    PIC XX.
   194
   195     12  WS-COMPUTE-FROM-DT  PIC XX.
   196     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   197     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   198     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   199     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   200     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   201     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   202         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   203         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   204     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   205         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   206     12  WS-UPDATE-SW        PIC X VALUE ' '.
   207     12  WS-GROUPING.
   208         16  WS-GROUP-1      PIC X VALUE SPACES.
   209         16  FILLER          PIC X(05) VALUE SPACES.
   210     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   211     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   212     12  WS-WORK-STATE-ACCT.
   213         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   214         16  FILLER          PIC X       VALUE '/'.
   215         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   216     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL156.cbl
   217     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   218     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   219     12  QID.
   220         16  QID-TERM        PIC X(4)    VALUE SPACES.
   221         16  FILLER          PIC X(4)    VALUE '156A'.
   222     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   223     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   224     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   225     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   226     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   227     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   228     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   229     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   230     12  WS-STATUS           PIC X       VALUE SPACES.
   231     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   232     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   233     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   234     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   235     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   236     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   237     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   238     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   239     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   240     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   241     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   242     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   243     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   244     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   245     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   246     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   247     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   248     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   249     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   250     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   251     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   252     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   253     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   254     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   255     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   256     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   257     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   258     12  WORK-DATE-FROM.
   259         16  WDF-MONTH       PIC 99        VALUE ZERO.
   260         16  WDF-DAY         PIC 99        VALUE ZERO.
   261         16  WDF-YEAR        PIC 99        VALUE ZERO.
   262     12  WORK-DATE-THRU.
   263         16  WDT-MONTH       PIC 99        VALUE ZERO.
   264         16  WDT-DAY         PIC 99        VALUE ZERO.
   265         16  WDT-YEAR        PIC 99        VALUE ZERO.
   266     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   267     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   268     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   269     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   270     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   271     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   272     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   273     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   274     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL156.cbl
   275     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   276     12  WS-PY-WK REDEFINES WS-PY-WORK.
   277         16  WS-PY-NUM       PIC S9(7)V99.
   278         16  WS-PY-SIGN      PIC X.
   279     12  WS-DY-WORK          PIC S9(5).
   280     12  WS-DY-WK REDEFINES WS-DY-WORK.
   281         16  WS-DY-NUM       PIC S9(4).
   282         16  WS-DY-SIGN      PIC X.
   283     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   284         88  COMP-REC-FOUND              VALUE 'Y'.
   285     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   286         88  BENEFIT-FOUND       VALUE 'Y'.
   287         88  NO-BENEFIT-FOUND    VALUE 'N'.
   288     12  WS-TERMS.
   289         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   290         16  FILLER          PIC X       VALUE '/'.
   291         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   292         16  WST-REM-DAYS-GRP.
   293             20  WST-SLASH   PIC X       VALUE '/'.
   294             20  WST-REM-DAYS
   295                             PIC --9.
   296     12  WS-ACCESS.
   297         16  FILLER          PIC XX      VALUE SPACES.
   298         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   299     12  WS-STATE-ACCESS.
   300         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   301         16  FILLER          PIC XX      VALUE SPACES.
   302     12  WS-CARR-ACCESS.
   303         16  FILLER          PIC X(3)    VALUE SPACES.
   304         16  WS-CARR         PIC X       VALUE SPACES.
   305     12  DATE-WORK.
   306         16  FILLER          PIC XX      VALUE SPACES.
   307         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   308     12  WS-SAVE-INPUT.
   309         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   310         16  WS-PAYEE        PIC XX      VALUE SPACE.
   311         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   312         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   313         16  WS-OFFLINE      PIC X       VALUE SPACE.
   314         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   315         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   316         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   317         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   318         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   319         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   320         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   321         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   322         16  WS-ETYPE        PIC X       VALUE SPACE.
   323         16  WS-CASH         PIC X       VALUE SPACE.
   324         16  WS-GROUPED      PIC X       VALUE SPACE.
   325         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   326         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   327         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   328         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   329         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   330     12  LAST-ERROR-LINE.
   331         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   332         16  FILLER              PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL156.cbl
   333             VALUE ' FATAL ERRORS ENCOUNTERED'.
   334         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   335         16  FILLER              PIC X(28)
   336             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   337     12  WS-CHECK-AREA.
   338         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   339         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   340     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   341     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   342         16  FILLER              PIC XX.
   343         16  WS-A-CHECK-NUM-5    PIC 9(5).
   344     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   345         16  FILLER              PIC X.
   346         16  WS-A-CHECK-NUM-6    PIC 9(6).
   347     12  OPTION-1-SAVE-AREA.
   348         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   349         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   350     12  WS-WORK-ZIP.
   351         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   352         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   353     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   354                                 PIC 9(9).
   355     12  WS-FLI-PMTNOTE.
   356         16  WS-PMTOPTION        PIC XX.
   357         16  WS-DOCNAME          PIC X(28).
   358         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   359             20  WS-AMOUNT       PIC X(8).
   360             20  FILLER          PIC X(20).
   361         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   362             20  WS-NUM-AMT      PIC 9(6)V99.
   363             20  FILLER          PIC X(20).
   364
   365     12  WS-HAN-PMTNOTE.
   366         16  WS-HAN-PMT-CODE     PIC X.
   367         16  WS-HAN-PMT-NOTE     PIC X(39).
   368
   369     12  WS-NCL-PMT-OPTION       PIC XX.
   370         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   371
   372     12  WS-CLAIM-SEQUENCE.
   373         16  FILLER              PIC X VALUE '('.
   374         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   375         16  FILLER              PIC X(04) VALUE ' OF '.
   376         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   377         16  FILLER              PIC X VALUE ')'.
   378
   379     12  WS-REFUND-AMT           PIC Z(7).99.
   380     12  WS-CALC-INT             PIC S9(7)V99.
   381     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   382
   383     12  SUB                     PIC 99 VALUE ZEROS.
   384
   385     12  WS-BOANOTE1.
   386         16  WS-BOANOTE1-DESC    PIC X(11).
   387         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   388         16  FILLER              PIC X(17).
   389     12  WS-BOANOTE2.
   390         16  WS-BOANOTE2-DESC    PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL156.cbl
   391         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   392         16  FILLER              PIC X(17).
   393
   394     12  WS-NCLNOTE1.
   395         16  WS-NCLNOTE1-DESC    PIC X(11).
   396         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   397         16  FILLER              PIC X(17).
   398     12  WS-NCLNOTE2.
   399         16  WS-NCLNOTE2-DESC    PIC X(11).
   400         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   401         16  FILLER              PIC X(17).
   402
   403     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   404     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   405     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   406     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   407     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   408     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   409     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   410     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   411     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   412     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   413
   414     12  WS-AIG-WORK-AREAS.
   415         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   416             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   417         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   418             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   419         16  WS-FROM-DATE-MDY.
   420             20  WS-FROM-MO      PIC 99.
   421             20  WS-FROM-DA      PIC 99.
   422             20  WS-FROM-YR      PIC 99.
   423         16  WS-TEMP-DATE-MDY.
   424             20  WS-TEMP-MO      PIC 99.
   425             20  WS-TEMP-DA      PIC 99.
   426             20  WS-TEMP-YR      PIC 99.
   427         16  WS-BIN-FROM-DT      PIC XX.
   428         16  WS-TEMP-INC-MDY.
   429             20  WS-TEMP-INC-MO  PIC 99.
   430             20  WS-TEMP-INC-DA  PIC 99.
   431             20  WS-TEMP-INC-YR  PIC 99.
   432         16  WS-PMT-DUE-MDY.
   433             20  WS-PMT-DUE-MO   PIC 99.
   434             20  WS-PMT-DUE-DA   PIC 99.
   435             20  WS-PMT-DUE-YR   PIC 99.
   436         16  WS-PMT-DUE-DT       PIC XX.
   437         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   438         16  WS-RETRO-ELIM-DT    PIC XX.
   439         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   440             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   441         16  WS-SAVE-DUE-DA      PIC 99.
   442         16  WS-CDAYS            PIC S9(05).
   443         16  WS-DAYS-OFF         PIC S9(05).
   444         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   445             88  ELIM-SATISFIED            VALUE 'Y'.
   446         16  WS-AIG-CHECKNO.
   447             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   448             20  WS-A-CHECKNO-3-7.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL156.cbl
   449                 24  FILLER              PIC X(3)    VALUE SPACES.
   450                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   451                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   452         16  WS-AIG-GROUPING.
   453             20  WS-A-BENE               PIC XXX.
   454             20  FILLER                  PIC XXX.
   455         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   456             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   457             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   458         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   459                 VALUE 'UNEMPLOYMENT PAYMENT'.
   460         16  WS-CHK-THRU-DT              PIC XX.
   461         16  WS-HOLD-BIN-DATE-1          PIC XX.
   462
   463 01  MISC-CSO-AREA.
   464     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   465         88  APPROVAL-NEEDED                        VALUE 'Y'.
   466     12  WS-APPROV-NOTE                  PIC X(43)
   467         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   468     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   469     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   470     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   471     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   472     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   473     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   474     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   475         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   476     12  WS-PAYEE-CITY-STATE     PIC X(30).
   477     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   478         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   479     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   480
   481 01  ERROR-MESSAGES.
   482     12  ER-0000                 PIC X(4)  VALUE '0000'.
   483     12  ER-0004                 PIC X(4)  VALUE '0004'.
   484     12  ER-0008                 PIC X(4)  VALUE '0008'.
   485     12  ER-0019                 PIC X(4)  VALUE '0019'.
   486     12  ER-0029                 PIC X(4)  VALUE '0029'.
   487     12  ER-0042                 PIC X(4)  VALUE '0042'.
   488     12  ER-0070                 PIC X(4)  VALUE '0070'.
   489     12  ER-0130                 PIC X(4)  VALUE '0130'.
   490     12  ER-0149                 PIC X(4)  VALUE '0149'.
   491     12  ER-0154                 PIC X(4)  VALUE '0154'.
   492     12  ER-0168                 PIC X(4)  VALUE '0168'.
   493     12  ER-0169                 PIC X(4)  VALUE '0169'.
   494     12  ER-0172                 PIC X(4)  VALUE '0174'.
   495     12  ER-0198                 PIC X(4)  VALUE '0198'.
   496     12  ER-0204                 PIC X(4)  VALUE '0204'.
   497     12  ER-0206                 PIC X(4)  VALUE '0206'.
   498     12  ER-0252                 PIC X(4)  VALUE '0252'.
   499     12  ER-0254                 PIC X(4)  VALUE '0254'.
   500     12  ER-0282                 PIC X(4)  VALUE '0282'.
   501     12  ER-0283                 PIC X(4)  VALUE '0283'.
   502     12  ER-0294                 PIC X(4)  VALUE '0294'.
   503     12  ER-0338                 PIC X(4)  VALUE '0338'.
   504     12  ER-0419                 PIC X(4)  VALUE '0419'.
   505     12  ER-0420                 PIC X(4)  VALUE '0420'.
   506     12  ER-0421                 PIC X(4)  VALUE '0421'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL156.cbl
   507     12  ER-0422                 PIC X(4)  VALUE '0422'.
   508     12  ER-0433                 PIC X(4)  VALUE '0433'.
   509     12  ER-0436                 PIC X(4)  VALUE '0436'.
   510     12  ER-0437                 PIC X(4)  VALUE '0437'.
   511     12  ER-0438                 PIC X(4)  VALUE '0438'.
   512     12  ER-0439                 PIC X(4)  VALUE '0439'.
   513     12  ER-0440                 PIC X(4)  VALUE '0440'.
   514     12  ER-0441                 PIC X(4)  VALUE '0441'.
   515     12  ER-0442                 PIC X(4)  VALUE '0442'.
   516     12  ER-0443                 PIC X(4)  VALUE '0443'.
   517     12  ER-0444                 PIC X(4)  VALUE '0444'.
   518     12  ER-0445                 PIC X(4)  VALUE '0445'.
   519     12  ER-0446                 PIC X(4)  VALUE '0446'.
   520     12  ER-0447                 PIC X(4)  VALUE '0447'.
   521     12  ER-0448                 PIC X(4)  VALUE '0448'.
   522     12  ER-0449                 PIC X(4)  VALUE '0449'.
   523     12  ER-0452                 PIC X(4)  VALUE '0452'.
   524     12  ER-0458                 PIC X(4)  VALUE '0458'.
   525     12  ER-0459                 PIC X(4)  VALUE '0459'.
   526     12  ER-0460                 PIC X(4)  VALUE '0460'.
   527     12  ER-0461                 PIC X(4)  VALUE '0461'.
   528     12  ER-0462                 PIC X(4)  VALUE '0462'.
   529     12  ER-0463                 PIC X(4)  VALUE '0463'.
   530     12  ER-0464                 PIC X(4)  VALUE '0464'.
   531     12  ER-0465                 PIC X(4)  VALUE '0465'.
   532     12  ER-0466                 PIC X(4)  VALUE '0466'.
   533     12  ER-0467                 PIC X(4)  VALUE '0467'.
   534     12  ER-0468                 PIC X(4)  VALUE '0468'.
   535     12  ER-0469                 PIC X(4)  VALUE '0469'.
   536     12  ER-0473                 PIC X(4)  VALUE '0473'.
   537     12  ER-0474                 PIC X(4)  VALUE '0474'.
   538     12  ER-0475                 PIC X(4)  VALUE '0475'.
   539     12  ER-0476                 PIC X(4)  VALUE '0476'.
   540     12  ER-0477                 PIC X(4)  VALUE '0477'.
   541     12  ER-0478                 PIC X(4)  VALUE '0478'.
   542     12  ER-0479                 PIC X(4)  VALUE '0479'.
   543     12  ER-0481                 PIC X(4)  VALUE '0481'.
   544     12  ER-0491                 PIC X(4)  VALUE '0491'.
   545     12  ER-0492                 PIC X(4)  VALUE '0492'.
   546     12  ER-0493                 PIC X(4)  VALUE '0493'.
   547     12  ER-0494                 PIC X(4)  VALUE '0494'.
   548     12  ER-0495                 PIC X(4)  VALUE '0495'.
   549     12  ER-0499                 PIC X(4)  VALUE '0499'.
   550     12  ER-0500                 PIC X(4)  VALUE '0500'.
   551     12  ER-0501                 PIC X(4)  VALUE '0501'.
   552     12  ER-0502                 PIC X(4)  VALUE '0502'.
   553     12  ER-0508                 PIC X(4)  VALUE '0508'.
   554     12  ER-0513                 PIC X(4)  VALUE '0513'.
   555     12  ER-0518                 PIC X(4)  VALUE '0518'.
   556     12  ER-0524                 PIC X(4)  VALUE '0524'.
   557     12  ER-0525                 PIC X(4)  VALUE '0525'.
   558     12  ER-0526                 PIC X(4)  VALUE '0526'.
   559     12  ER-0530                 PIC X(4)  VALUE '0530'.
   560     12  ER-0540                 PIC X(4)  VALUE '0540'.
   561     12  ER-0541                 PIC X(4)  VALUE '0541'.
   562     12  ER-0542                 PIC X(4)  VALUE '0542'.
   563     12  ER-0543                 PIC X(4)  VALUE '0543'.
   564     12  ER-0545                 PIC X(4)  VALUE '0545'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL156.cbl
   565     12  ER-0552                 PIC X(4)  VALUE '0552'.
   566     12  ER-0555                 PIC X(4)  VALUE '0555'.
   567     12  ER-0556                 PIC X(4)  VALUE '0556'.
   568     12  ER-0557                 PIC X(4)  VALUE '0557'.
   569     12  ER-0572                 PIC X(4)  VALUE '0572'.
   570     12  ER-0573                 PIC X(4)  VALUE '0573'.
   571     12  ER-0594                 PIC X(4)  VALUE '0594'.
   572     12  ER-0616                 PIC X(4)  VALUE '0616'.
   573     12  ER-0617                 PIC X(4)  VALUE '0617'.
   574     12  ER-0618                 PIC X(4)  VALUE '0618'.
   575     12  ER-0657                 PIC X(4)  VALUE '0657'.
   576     12  ER-0658                 PIC X(4)  VALUE '0658'.
   577     12  ER-0699                 PIC X(4)  VALUE '0699'.
   578     12  ER-0730                 PIC X(4)  VALUE '0730'.
   579     12  ER-0737                 PIC X(4)  VALUE '0737'.
   580     12  ER-0760                 PIC X(4)  VALUE '0760'.
   581     12  ER-0768                 PIC X(4)  VALUE '0768'.
   582     12  ER-0769                 PIC X(4)  VALUE '0769'.
   583     12  ER-0770                 PIC X(4)  VALUE '0770'.
   584     12  ER-0802                 PIC X(4)  VALUE '0802'.
   585     12  ER-0803                 PIC X(4)  VALUE '0803'.
   586     12  ER-0819                 PIC X(4)  VALUE '0819'.
   587     12  ER-0834                 PIC X(4)  VALUE '0834'.
   588     12  ER-0836                 PIC X(4)  VALUE '0836'.
   589     12  ER-0844                 PIC X(4)  VALUE '0844'.
   590     12  ER-0845                 PIC X(4)  VALUE '0845'.
   591     12  ER-0846                 PIC X(4)  VALUE '0846'.
   592     12  ER-0849                 PIC X(4)  VALUE '0849'.
   593     12  ER-0851                 PIC X(4)  VALUE '0851'.
   594     12  ER-0872                 PIC X(4)  VALUE '0872'.
   595     12  ER-0873                 PIC X(4)  VALUE '0873'.
   596     12  ER-0874                 PIC X(4)  VALUE '0874'.
   597     12  ER-0879                 PIC X(4)  VALUE '0879'.
   598     12  ER-0919                 PIC X(4)  VALUE '0919'.
   599     12  ER-0921                 PIC X(4)  VALUE '0921'.
   600     12  ER-0923                 PIC X(4)  VALUE '0923'.
   601     12  ER-0925                 PIC X(4)  VALUE '0925'.
   602     12  ER-0944                 PIC X(4)  VALUE '0944'.
   603     12  ER-0945                 PIC X(4)  VALUE '0945'.
   604     12  ER-0946                 PIC X(4)  VALUE '0946'.
   605     12  ER-0947                 PIC X(4)  VALUE '0947'.
   606     12  ER-0948                 PIC X(4)  VALUE '0948'.
   607     12  ER-0949                 PIC X(4)  VALUE '0949'.
   608     12  ER-0950                 PIC X(4)  VALUE '0950'.
   609     12  ER-0951                 PIC X(4)  VALUE '0951'.
   610     12  ER-0954                 PIC X(4)  VALUE '0954'.
   611     12  ER-0956                 PIC X(4)  VALUE '0956'.
   612     12  ER-0967                 PIC X(4)  VALUE '0967'.
   613     12  ER-0968                 PIC X(4)  VALUE '0968'.
   614     12  ER-0974                 PIC X(4)  VALUE '0974'.
   615     12  ER-0975                 PIC X(4)  VALUE '0975'.
   616     12  ER-1561                 PIC X(4)  VALUE '1561'.
   617     12  ER-1775                 PIC X(4)  VALUE '1775'.
   618     12  ER-1880                 PIC X(4)  VALUE '1880'.
   619     12  ER-2044                 PIC X(4)  VALUE '2044'.
   620     12  ER-3140                 PIC X(4)  VALUE '3140'.
   621     12  ER-3141                 PIC X(4)  VALUE '3141'.
   622     12  ER-3255                 PIC X(4)  VALUE '3255'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL156.cbl
   623     12  ER-3516                 PIC X(4)  VALUE '3516'.
   624     12  ER-3527                 PIC X(4)  VALUE '3527'.
   625     12  ER-3528                 PIC X(4)  VALUE '3528'.
   626     12  ER-3529                 PIC X(4)  VALUE '3529'.
   627     12  ER-3530                 PIC X(4)  VALUE '3530'.
   628     12  ER-3531                 PIC X(4)  VALUE '3531'.
   629     12  ER-3532                 PIC X(4)  VALUE '3532'.
   630     12  ER-3533                 PIC X(4)  VALUE '3533'.
   631     12  ER-3534                 PIC X(4)  VALUE '3534'.
   632     12  ER-3535                 PIC X(4)  VALUE '3535'.
   633     12  ER-3536                 PIC X(4)  VALUE '3536'.
   634     12  ER-3537                 PIC X(4)  VALUE '3537'.
   635     12  ER-3538                 PIC X(4)  VALUE '3538'.
   636     12  ER-3539                 PIC X(4)  VALUE '3539'.
   637     12  ER-3540                 PIC X(4)  VALUE '3540'.
   638     12  ER-3541                 PIC X(4)  VALUE '3541'.
   639     12  ER-3542                 PIC X(4)  VALUE '3542'.
   640     12  ER-3543                 PIC X(4)  VALUE '3543'.
   641     12  ER-3546                 PIC X(4)  VALUE '3546'.
   642     12  ER-3549                 PIC X(4)  VALUE '3549'.
   643     12  ER-3818                 PIC X(4)  VALUE '3818'.
   644     12  ER-7540                 PIC X(4)  VALUE '7540'.
   645     12  ER-7576                 PIC X(4)  VALUE '7576'.
   646     12  ER-7830                 PIC X(4)  VALUE '7830'.
   647     12  ER-7831                 PIC X(4)  VALUE '7831'.
   648     12  ER-7832                 PIC X(4)  VALUE '7832'.
   649     12  ER-7833                 PIC X(4)  VALUE '7833'.
   650     12  ER-7834                 PIC X(4)  VALUE '7834'.
   651     12  ER-7835                 PIC X(4)  VALUE '7835'.
   652     12  ER-7836                 PIC X(4)  VALUE '7836'.
   653     12  ER-7837                 PIC X(4)  VALUE '7837'.
   654     12  ER-7838                 PIC X(4)  VALUE '7838'.
   655     12  ER-7841                 PIC X(4)  VALUE '7841'.
   656     12  ER-7844                 PIC X(4)  VALUE '7844'.
   657     12  ER-7845                 PIC X(4)  VALUE '7845'.
   658     12  ER-8000                 PIC X(4)  VALUE '8000'.
   659     12  ER-8051                 PIC X(4)  VALUE '8051'.
   660     12  ER-8052                 PIC X(4)  VALUE '8052'.
   661     12  ER-8053                 PIC X(4)  VALUE '8053'.
   662     12  ER-8054                 PIC X(4)  VALUE '8054'.
   663     12  ER-8055                 PIC X(4)  VALUE '8055'.
   664     12  ER-8056                 PIC X(4)  VALUE '8056'.
   665     12  ER-8057                 PIC X(4)  VALUE '8057'.
   666     12  ER-8058                 PIC X(4)  VALUE '8058'.
   667     12  ER-8059                 PIC X(4)  VALUE '8059'.
   668     12  ER-8060                 PIC X(4)  VALUE '8060'.
   669     12  ER-8061                 PIC X(4)  VALUE '8061'.
   670     12  ER-8062                 PIC X(4)  VALUE '8062'.
   671     12  ER-8063                 PIC X(4)  VALUE '8063'.
   672     12  ER-8064                 PIC X(4)  VALUE '8064'.
   673     12  ER-8065                 PIC X(4)  VALUE '8065'.
   674     12  ER-8066                 PIC X(4)  VALUE '8066'.
   675     12  ER-8146                 PIC X(4)  VALUE '8146'.
   676     12  ER-8147                 PIC X(4)  VALUE '8147'.
   677     12  ER-8152                 PIC X(4)  VALUE '8152'.
   678     12  ER-8153                 PIC X(4)  VALUE '8153'.
   679     12  ER-8154                 PIC X(4)  VALUE '8154'.
   680     12  ER-8155                 PIC X(4)  VALUE '8155'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL156.cbl
   681     12  ER-8310                 PIC X(4)  VALUE '8310'.
   682     12  ER-8311                 PIC X(4)  VALUE '8311'.
   683     12  ER-8312                 PIC X(4)  VALUE '8312'.
   684     12  ER-8313                 PIC X(4)  VALUE '8313'.
   685     12  ER-8314                 PIC X(4)  VALUE '8314'.
   686     12  ER-8315                 PIC X(4)  VALUE '8315'.
   687     12  ER-8316                 PIC X(4)  VALUE '8316'.
   688     12  ER-8317                 PIC X(4)  VALUE '8317'.
   689
   690 01  CSO-WORK-FIELDS.
   691     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   692       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   693
   694     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   695     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   696         88  CERT-NOTE-ADDED           VALUE 'Y'.
   697     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   698         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   699     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   700
   701 01  SC-NP6-CERT-NOTE.
   702     12  FILLER                  PIC X(12)
   703               VALUE 'REM BENEFIT '.
   704     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   705     12  FILLER                  PIC X(8)
   706               VALUE ' + 6 MO '.
   707     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   708     12  FILLER                  PIC X(12)
   709               VALUE ' = AMT PAID '.
   710     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   711
   712 01  SC-NP6-ORIG-NOTE.
   713     12  FILLER                  PIC X(63)  VALUE
   714         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   715
   716 01  ACCESS-KEYS.
   717     12  ELARCH-KEY.
   718         16  ARCH-CO             PIC X.
   719         16  ARCH-NUMBER         PIC S9(08) COMP.
   720         16  ARCH-REC-TYPE       PIC X.
   721         16  ARCH-SEQ            PIC S9(04) COMP.
   722     12  ELMSTR-KEY.
   723         16  MSTR-COMP-CD        PIC X.
   724         16  MSTR-CARRIER        PIC X.
   725         16  MSTR-CLAIM-NO       PIC X(7).
   726         16  MSTR-CERT-NO        PIC X(11).
   727     12  ELCNTL-KEY.
   728         16  CNTL-COMP-ID        PIC X(3).
   729         16  CNTL-REC-TYPE       PIC X.
   730         16  CNTL-ACCESS         PIC X(4).
   731         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   732     12  ELCERT-KEY.
   733         16  CERT-COMP-CD        PIC X.
   734         16  CERT-CARRIER        PIC X.
   735         16  CERT-GROUPING       PIC X(6).
   736         16  CERT-STATE          PIC XX.
   737         16  CERT-ACCOUNT        PIC X(10).
   738         16  CERT-EFF-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL156.cbl
   739         16  CERT-CERT-NO        PIC X(11).
   740     12  ELTRLR-KEY.
   741         16  TRLR-COMP-CD        PIC X.
   742         16  TRLR-CARRIER        PIC X.
   743         16  TRLR-CLAIM-NO       PIC X(7).
   744         16  TRLR-CERT-NO        PIC X(11).
   745         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   746     12  ELACTQ-KEY.
   747         16  ACTQ-COMP-CD        PIC X.
   748         16  ACTQ-CARRIER        PIC X.
   749         16  ACTQ-CLAIM-NO       PIC X(7).
   750         16  ACTQ-CERT-NO        PIC X(11).
   751     12  W-NOTE-KEY.
   752         16  W-NOTE-COMP-CD      PIC X.
   753         16  W-NOTE-CERT-KEY.
   754             20  W-NOTE-CARRIER  PIC X.
   755             20  W-NOTE-GROUPING PIC X(6).
   756             20  W-NOTE-STATE    PIC XX.
   757             20  W-NOTE-ACCOUNT  PIC X(10).
   758             20  W-NOTE-EFF-DT   PIC XX.
   759             20  W-NOTE-CERT-NO  PIC X(11).
   760     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   761     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   762     12  ERACCT-KEY.
   763         16  ERACCT-PARTIAL-KEY.
   764             20  ACCT-COMP-CD    PIC X.
   765             20  ACCT-CARRIER    PIC X.
   766             20  ACCT-GROUPING   PIC X(6).
   767             20  ACCT-STATE      PIC XX.
   768             20  ACCT-ACCOUNT    PIC X(10).
   769         16  ACCT-EXP-DT         PIC XX.
   770         16  FILLER              PIC X(4) VALUE SPACES.
   771     12  ELCHKQ-KEY.
   772         16  CHKQ-COMP-CD        PIC X.
   773         16  CHKQ-CONTROL        PIC S9(8) COMP.
   774         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   775     12  ELBENE-KEY.
   776         16  BENE-COMP-CD         PIC X.
   777         16  BENE-RECORD-TYPE     PIC X.
   778         16  BENE-NUMBER          PIC X(10).
   779     12  ERCOMP-KEY.
   780         16  COMP-COMP-CD        PIC X.
   781         16  COMP-CARRIER        PIC X.
   782         16  COMP-GROUP          PIC X(06).
   783         16  COMP-FIN-RESP       PIC X(10).
   784         16  COMP-ACCOUNT        PIC X(10).
   785         16  COMP-TYPE           PIC X.
   786
   787     12  DLO035-KEY.
   788         16  DL35-PROCESS-TYPE   PIC X.
   789         16  DL35-CREDIT-CARD    PIC X(20).
   790         16  DL35-BEN-TYPE       PIC XX.
   791         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   792         16  DL35-RETURN-CODE    PIC XX.
   793
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL156.cbl
   795*    COPY ELCDATE.
   796******************************************************************
   797*                                                                *
   798*                                                                *
   799*                            ELCDATE.                            *
   800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   801*                            VMOD=2.003
   802*                                                                *
   803*                                                                *
   804*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   805*                 LENGTH = 200                                   *
   806******************************************************************
   807
   808 01  DATE-CONVERSION-DATA.
   809     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   810     12  DC-OPTION-CODE                PIC X.
   811         88  BIN-TO-GREG                VALUE ' '.
   812         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   813         88  EDIT-GREG-TO-BIN           VALUE '2'.
   814         88  YMD-GREG-TO-BIN            VALUE '3'.
   815         88  MDY-GREG-TO-BIN            VALUE '4'.
   816         88  JULIAN-TO-BIN              VALUE '5'.
   817         88  BIN-PLUS-ELAPSED           VALUE '6'.
   818         88  FIND-CENTURY               VALUE '7'.
   819         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   820         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   821         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   822         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   823         88  JULIAN-TO-BIN-3            VALUE 'C'.
   824         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   825         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   826         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   827         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   828         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   829         88  CHECK-LEAP-YEAR            VALUE 'H'.
   830         88  BIN-3-TO-GREG              VALUE 'I'.
   831         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   832         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   833         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   834         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   835         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   836         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   837         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   838         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   839         88  THREE-CHARACTER-BIN
   840                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   841         88  GREGORIAN-TO-BIN
   842                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   843         88  BIN-TO-GREGORIAN
   844                  VALUES ' ' '1' 'I' '8' 'G'.
   845         88  JULIAN-TO-BINARY
   846                  VALUES '5' 'C' 'E' 'F'.
   847     12  DC-ERROR-CODE                 PIC X.
   848         88  NO-CONVERSION-ERROR        VALUE ' '.
   849         88  DATE-CONVERSION-ERROR
   850                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   851         88  DATE-IS-ZERO               VALUE '1'.
   852         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL156.cbl
   853         88  DATE-IS-INVALID            VALUE '3'.
   854         88  DATE1-GREATER-DATE2        VALUE '4'.
   855         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   856         88  DATE-INVALID-OPTION        VALUE '9'.
   857         88  INVALID-CENTURY            VALUE 'A'.
   858         88  ONLY-CENTURY               VALUE 'B'.
   859         88  ONLY-LEAP-YEAR             VALUE 'C'.
   860         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   861     12  DC-END-OF-MONTH               PIC X.
   862         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   863     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   864         88  USE-NORMAL-PROCESS         VALUE ' '.
   865         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   866         88  ADJUST-UP-100-YRS          VALUE '2'.
   867     12  FILLER                        PIC X.
   868     12  DC-CONVERSION-DATES.
   869         16  DC-BIN-DATE-1             PIC XX.
   870         16  DC-BIN-DATE-2             PIC XX.
   871         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   872         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   873                       DC-GREG-DATE-1-EDIT.
   874             20  DC-EDIT1-MONTH        PIC 99.
   875             20  SLASH1-1              PIC X.
   876             20  DC-EDIT1-DAY          PIC 99.
   877             20  SLASH1-2              PIC X.
   878             20  DC-EDIT1-YEAR         PIC 99.
   879         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   880         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   881                     DC-GREG-DATE-2-EDIT.
   882             20  DC-EDIT2-MONTH        PIC 99.
   883             20  SLASH2-1              PIC X.
   884             20  DC-EDIT2-DAY          PIC 99.
   885             20  SLASH2-2              PIC X.
   886             20  DC-EDIT2-YEAR         PIC 99.
   887         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   888         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   889                     DC-GREG-DATE-1-YMD.
   890             20  DC-YMD-YEAR           PIC 99.
   891             20  DC-YMD-MONTH          PIC 99.
   892             20  DC-YMD-DAY            PIC 99.
   893         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   894         16  DC-GREG-DATE-1-MDY-R REDEFINES
   895                      DC-GREG-DATE-1-MDY.
   896             20  DC-MDY-MONTH          PIC 99.
   897             20  DC-MDY-DAY            PIC 99.
   898             20  DC-MDY-YEAR           PIC 99.
   899         16  DC-GREG-DATE-1-ALPHA.
   900             20  DC-ALPHA-MONTH        PIC X(10).
   901             20  DC-ALPHA-DAY          PIC 99.
   902             20  FILLER                PIC XX.
   903             20  DC-ALPHA-CENTURY.
   904                 24 DC-ALPHA-CEN-N     PIC 99.
   905             20  DC-ALPHA-YEAR         PIC 99.
   906         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   907         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   908         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   909         16  DC-JULIAN-DATE            PIC 9(05).
   910         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL156.cbl
   911                                       PIC 9(05).
   912         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   913             20  DC-JULIAN-YEAR        PIC 99.
   914             20  DC-JULIAN-DAYS        PIC 999.
   915         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   916         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   917         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   918     12  DATE-CONVERSION-VARIBLES.
   919         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   920         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   921             20  FILLER                PIC 9(3).
   922             20  HOLD-CEN-1-CCYY.
   923                 24  HOLD-CEN-1-CC     PIC 99.
   924                 24  HOLD-CEN-1-YY     PIC 99.
   925             20  HOLD-CEN-1-MO         PIC 99.
   926             20  HOLD-CEN-1-DA         PIC 99.
   927         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   928             20  HOLD-CEN-1-R-MO       PIC 99.
   929             20  HOLD-CEN-1-R-DA       PIC 99.
   930             20  HOLD-CEN-1-R-CCYY.
   931                 24  HOLD-CEN-1-R-CC   PIC 99.
   932                 24  HOLD-CEN-1-R-YY   PIC 99.
   933             20  FILLER                PIC 9(3).
   934         16  HOLD-CENTURY-1-X.
   935             20  FILLER                PIC X(3)  VALUE SPACES.
   936             20  HOLD-CEN-1-X-CCYY.
   937                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   938                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   939             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   940             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   941         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   942             20  HOLD-CEN-1-R-X-MO     PIC XX.
   943             20  HOLD-CEN-1-R-X-DA     PIC XX.
   944             20  HOLD-CEN-1-R-X-CCYY.
   945                 24  HOLD-CEN-1-R-X-CC PIC XX.
   946                 24  HOLD-CEN-1-R-X-YY PIC XX.
   947             20  FILLER                PIC XXX.
   948         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   949         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   950         16  DC-JULIAN-DATE-1          PIC 9(07).
   951         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   952             20  DC-JULIAN-1-CCYY.
   953                 24  DC-JULIAN-1-CC    PIC 99.
   954                 24  DC-JULIAN-1-YR    PIC 99.
   955             20  DC-JULIAN-DA-1        PIC 999.
   956         16  DC-JULIAN-DATE-2          PIC 9(07).
   957         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   958             20  DC-JULIAN-2-CCYY.
   959                 24  DC-JULIAN-2-CC    PIC 99.
   960                 24  DC-JULIAN-2-YR    PIC 99.
   961             20  DC-JULIAN-DA-2        PIC 999.
   962         16  DC-GREG-DATE-A-EDIT.
   963             20  DC-EDITA-MONTH        PIC 99.
   964             20  SLASHA-1              PIC X VALUE '/'.
   965             20  DC-EDITA-DAY          PIC 99.
   966             20  SLASHA-2              PIC X VALUE '/'.
   967             20  DC-EDITA-CCYY.
   968                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL156.cbl
   969                 24  DC-EDITA-YEAR     PIC 99.
   970         16  DC-GREG-DATE-B-EDIT.
   971             20  DC-EDITB-MONTH        PIC 99.
   972             20  SLASHB-1              PIC X VALUE '/'.
   973             20  DC-EDITB-DAY          PIC 99.
   974             20  SLASHB-2              PIC X VALUE '/'.
   975             20  DC-EDITB-CCYY.
   976                 24  DC-EDITB-CENT     PIC 99.
   977                 24  DC-EDITB-YEAR     PIC 99.
   978         16  DC-GREG-DATE-CYMD         PIC 9(08).
   979         16  DC-GREG-DATE-CYMD-R REDEFINES
   980                              DC-GREG-DATE-CYMD.
   981             20  DC-CYMD-CEN           PIC 99.
   982             20  DC-CYMD-YEAR          PIC 99.
   983             20  DC-CYMD-MONTH         PIC 99.
   984             20  DC-CYMD-DAY           PIC 99.
   985         16  DC-GREG-DATE-MDCY         PIC 9(08).
   986         16  DC-GREG-DATE-MDCY-R REDEFINES
   987                              DC-GREG-DATE-MDCY.
   988             20  DC-MDCY-MONTH         PIC 99.
   989             20  DC-MDCY-DAY           PIC 99.
   990             20  DC-MDCY-CEN           PIC 99.
   991             20  DC-MDCY-YEAR          PIC 99.
   992    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   993        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   994    12  DC-EL310-DATE                  PIC X(21).
   995    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL156.cbl
   997*    COPY ELCLOGOF.
   998******************************************************************
   999*                                                                *
  1000*                                                                *
  1001*                            ELCLOGOF.                           *
  1002*                            VMOD=2.001                          *
  1003*                                                                *
  1004*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1005*                                                                *
  1006******************************************************************
  1007 01  CLASIC-LOGOFF.
  1008     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1009     12  LOGOFF-TEXT.
  1010         16  FILLER          PIC X(5)    VALUE SPACES.
  1011         16  LOGOFF-MSG.
  1012             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1013             20  FILLER      PIC X       VALUE SPACES.
  1014             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1015         16  FILLER          PIC X(80)
  1016           VALUE '* YOU ARE NOW LOGGED OFF'.
  1017         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1018         16  FILLER          PIC X       VALUE QUOTE.
  1019         16  LOGOFF-SYS-MSG  PIC X(17)
  1020           VALUE 'S CLAS-IC SYSTEM '.
  1021     12  TEXT-MESSAGES.
  1022         16  UNACCESS-MSG    PIC X(29)
  1023             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1024         16  PGMIDERR-MSG    PIC X(17)
  1025             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL156.cbl
  1027*    COPY ELCCALC.
  1028******************************************************************
  1029*                                                                *
  1030*                           ELCCALC.                            *
  1031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1032*                            VMOD=2.025                          *
  1033*                                                                *
  1034*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1035*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1036*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1037*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1038*                                                                *
  1039*  PASSED TO ELRTRM                                              *
  1040*  -----------------                                             *
  1041*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1042*  ORIGINAL TERM                                                 *
  1043*  BEGINNING DATE                                                *
  1044*  ENDING DATE                                                   *
  1045*  COMPANY I.D.                                                  *
  1046*  ACCOUNT MASTER USER FIELD                                     *
  1047*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1048*  FREE LOOK DAYS                                                *
  1049*                                                                *
  1050*  RETURNED FROM ELRTRM                                          *
  1051*  ---------------------                                         *
  1052*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1053*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1054*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1055*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1056*----------------------------------------------------------------*
  1057*  PASSED TO ELRAMT                                              *
  1058*  ----------------                                              *
  1059*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1060*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1061*  ORIGINAL AMOUNT                                               *
  1062*  ALTERNATE BENEFIT (BALLON)                                    *
  1063*  A.P.R. - NET PAY ONLY                                         *
  1064*  METHOD
  1065*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1066*  COMPANY I.D.                                                  *
  1067*  BENEFIT TYPE                                                  *
  1068*                                                                *
  1069*  RETURNED FROM ELRAMT                                          *
  1070*  --------------------                                          *
  1071*  REMAINING AMOUNT 1 - CURRENT                                  *
  1072*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1073*  REMAINING AMOUNT FACTOR
  1074*----------------------------------------------------------------*
  1075*  PASSED TO ELRESV                                              *
  1076*  -----------------                                             *
  1077*  CERTIFICATE EFFECTIVE DATE                                    *
  1078*  VALUATION DATE                                                *
  1079*  PAID THRU DATE                                                *
  1080*  BENEFIT                                                       *
  1081*  INCURRED DATE                                                 *
  1082*  REPORTED DATE                                                 *
  1083*  ISSUE AGE                                                     *
  1084*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL156.cbl
  1085*  CDT PERCENT                                                   *
  1086*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1087* *CLAIM TYPE (LIFE, A/H)                                        *
  1088* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1089* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1090*                                                                *
  1091*  RETURNED FROM ELRESV                                          *
  1092*  --------------------                                          *
  1093*  CDT TABLE USED                                                *
  1094*  CDT FACTOR USED                                               *
  1095*  PAY TO CURRENT RESERVE                                        *
  1096*  I.B.N.R. - A/H ONLY                                           *
  1097*  FUTURE (ACCRUED) AH ONLY                                      *
  1098*----------------------------------------------------------------*
  1099*  PASSED TO ELRATE                                              *
  1100*  ----------------                                              *
  1101*  CERT ISSUE DATE                                               *
  1102*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1103*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1104*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1105*  STATE CODE (CLIENT DEFINED)                                   *
  1106*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1107*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1108*  DEVIATION CODE                                                *
  1109*  ISSUE AGE                                                     *
  1110*  ORIGINAL BENEFIT AMOUNT                                       *
  1111*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1112*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1113*  BENEFIT KIND (LIFE OR A/H)                                    *
  1114*  A.P.R.                                                        *
  1115*  METHOD
  1116*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1117*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1118*  COMPANY I.D. (3 CHARACTER)                                    *
  1119*  BENEFIT CODE                                                  *
  1120*  BENEFIT OVERRIDE CODE                                         *
  1121*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1122*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1123*  JOINT INDICATOR (CSL ONLY)                                    *
  1124*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1125*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1126*                                                                *
  1127*  RETURNED FROM ELRATE                                          *
  1128*  --------------------                                          *
  1129*  CALCULATED PREMIUM                                            *
  1130*  PREMIUM RATE                                                  *
  1131*  MORTALITY CODE                                                *
  1132*  MAX ATTAINED AGE                                              *
  1133*  MAX AGE                                                       *
  1134*  MAX TERM                                                      *
  1135*  MAX MONTHLY BENEFIT                                           *
  1136*  MAX TOTAL BENIFIT                                             *
  1137*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1138*----------------------------------------------------------------*
  1139*  PASSED TO ELRFND                                              *
  1140*  ----------------                                              *
  1141*  CERT ISSUE DATE                                               *
  1142*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL156.cbl
  1143*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1144*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1145*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1146*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1147*  STATE CODE (CLIENT DEFINED)                                   *
  1148*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1149*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1150*  DEVIATION CODE                                                *
  1151*  ISSUE AGE                                                     *
  1152*  ORIGINAL BENEFIT AMOUNT                                       *
  1153*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1154*  PROCESS TYPE (CANCEL)                                         *
  1155*  BENEFIT KIND (LIFE OR A/H)                                    *
  1156*  A.P.R.                                                        *
  1157*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1158*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1159*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1160*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1161*  COMPANY I.D. (3 CHARACTER)                                    *
  1162*  BENEFIT CODE                                                  *
  1163*  BENEFIT OVERRIDE CODE                                         *
  1164*                                                                *
  1165*  RETURNED FROM ELRFND                                          *
  1166*  --------------------                                          *
  1167*  CALCULATED REFUND                                             *
  1168*----------------------------------------------------------------*
  1169*  PASSED TO ELEARN                                              *
  1170*  ----------------                                              *
  1171*  CERT ISSUE DATE                                               *
  1172*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1173*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1174*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1175*  STATE CODE (CLIENT DEFINED)                                   *
  1176*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1177*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1178*  DEVIATION CODE                                                *
  1179*  ISSUE AGE                                                     *
  1180*  ORIGINAL BENEFIT AMOUNT                                       *
  1181*  BENEFIT KIND (LIFE OR A/H)                                    *
  1182*  A.P.R.                                                        *
  1183*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1184*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1185*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1186*  COMPANY I.D. (3 CHARACTER)                                    *
  1187*  BENEFIT CODE                                                  *
  1188*  BENEFIT OVERRIDE CODE                                         *
  1189*                                                                *
  1190*  RETURNED FROM ELEARN                                          *
  1191*  --------------------                                          *
  1192*  INDICATED  EARNINGS                                           *
  1193*----------------------------------------------------------------*
  1194*                 LENGTH = 450                                   *
  1195*                                                                *
  1196******************************************************************
  1197******************************************************************
  1198*                   C H A N G E   L O G
  1199*
  1200* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL156.cbl
  1201*-----------------------------------------------------------------
  1202*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1203* EFFECTIVE    NUMBER
  1204*-----------------------------------------------------------------
  1205* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1206* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1207* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1208* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1209* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1210* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1211* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1212* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1213* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1214******************************************************************
  1215
  1216 01  CALCULATION-PASS-AREA.
  1217     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1218                                     COMP.
  1219
  1220     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1221       88  NO-CP-ERROR                             VALUE ZERO.
  1222       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1223                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1224       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1225       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1226       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1227       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1228       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1229       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1230       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1231       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1232       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1233       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1234       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1235       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1236       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1237       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1238       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1239       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1240       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1241
  1242     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1243       88  NO-CP-ERROR-2                           VALUE ZERO.
  1244***********************  INPUT AREAS ****************************
  1245
  1246     12  CP-CALCULATION-AREA.
  1247         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1248         16  CP-CERT-EFF-DT        PIC XX.
  1249         16  CP-VALUATION-DT       PIC XX.
  1250         16  CP-PAID-THRU-DT       PIC XX.
  1251         16  CP-BENEFIT-TYPE       PIC X.
  1252           88  CP-AH                               VALUE 'A' 'D'
  1253                                                   'I' 'U'.
  1254           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1255           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1256         16  CP-INCURRED-DT        PIC XX.
  1257         16  CP-REPORTED-DT        PIC XX.
  1258         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL156.cbl
  1259         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1260         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1261                                     COMP-3.
  1262         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1263                                     COMP-3.
  1264         16  CP-CDT-METHOD         PIC X.
  1265           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1266           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1267           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1268         16  CP-CLAIM-TYPE         PIC X.
  1269           88  CP-AH-CLAIM                         VALUE 'A'.
  1270           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1271         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1272                                     COMP-3.
  1273         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1274                                     COMP-3.
  1275         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1276                                     COMP-3.
  1277         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1278                                     COMP-3.
  1279         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1280                                     COMP-3.
  1281         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1282                                     COMP-3.
  1283         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1284                                     COMP-3.
  1285         16  CP-REM-TERM-METHOD    PIC X.
  1286           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1287           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1288           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1289           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1290           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1291           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1292           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1293         16  CP-EARNING-METHOD     PIC X.
  1294           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1295           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1296           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1297           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1298           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1299           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1300           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1301           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1302           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1303           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1304           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1305           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1306           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1307           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1308         16  CP-PROCESS-TYPE       PIC X.
  1309           88  CP-CLAIM                            VALUE '1'.
  1310           88  CP-CANCEL                           VALUE '2'.
  1311           88  CP-ISSUE                            VALUE '3'.
  1312         16  CP-SPECIAL-CALC-CD    PIC X.
  1313           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1314           88  CP-1-MTH-INTEREST               VALUE ' '.
  1315           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1316           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL156.cbl
  1317           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1318           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1319           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1320           88  CP-FARM-PLAN                    VALUE 'F'.
  1321           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1322           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1323           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1324           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1325           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1326           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1327           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1328           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1329           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1330           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1331                                                     'W' 'X'.
  1332           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1333           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1334           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1335           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1336           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1337           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1338           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1339           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1340           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1341           88  CP-CSL-METH-1                   VALUE '5'.
  1342           88  CP-CSL-METH-2                   VALUE '6'.
  1343           88  CP-CSL-METH-3                   VALUE '7'.
  1344           88  CP-CSL-METH-4                   VALUE '8'.
  1345
  1346         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1347                                     COMP-3.
  1348         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1349         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1350         16  CP-STATE              PIC XX          VALUE SPACE.
  1351         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1352         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1353           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1354               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1355         16  CP-R78-OPTION         PIC X.
  1356           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1357           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1358
  1359         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1360         16  CP-IBNR-RESERVE-SW    PIC X.
  1361         16  CP-CLAIM-STATUS       PIC X.
  1362         16  CP-RATE-FILE          PIC X.
  1363         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1364                                     COMP-3.
  1365
  1366         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1367         16  CP-AH-OVERRIDE-CODE   PIC X.
  1368
  1369         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1370                                     COMP-3.
  1371         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1372                                   PIC S9(5)V99 COMP-3.
  1373         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1374                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL156.cbl
  1375         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1376                                     COMP-3.
  1377         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1378                                     COMP-3.
  1379         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1380                                  PIC S9(7)V99 COMP-3.
  1381
  1382         16  CP-PAID-FROM-DATE     PIC X(02).
  1383         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1384         16  CP-EXT-DAYS-CALC      PIC X.
  1385           88  CP-EXT-NO-CHG                   VALUE ' '.
  1386           88  CP-EXT-CHG-LF                   VALUE '1'.
  1387           88  CP-EXT-CHG-AH                   VALUE '2'.
  1388           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1389         16  CP-DOMICILE-STATE     PIC XX.
  1390         16  CP-CARRIER            PIC X.
  1391         16  CP-REIN-FLAG          PIC X.
  1392         16  CP-REM-TRM-CALC-OPTION PIC X.
  1393           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1394                      '2' '3' '4' '5'.
  1395           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1396           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1397           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1398           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1399           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1400           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1401           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1402           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1403         16  CP-SIG-SWITCH         PIC X.
  1404         16  CP-RATING-METHOD      PIC X.
  1405           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1406           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1407           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1408           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1409           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1410           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1411           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1412           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1413           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1414         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1415                                     COMP-3.
  1416         16  CP-BEN-CATEGORY       PIC X.
  1417         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1418         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1419                                   PIC S99V9(5) COMP-3.
  1420         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1421         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1422                                   PIC S99V9(5) COMP-3.
  1423         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1424         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1425         16  CP-EXPIRE-DT          PIC XX.
  1426         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1427         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1428         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1429         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1430         16  CP-DDF-SPEC-CALC      PIC X.
  1431             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1432             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL156.cbl
  1433         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1434         16  CP-CANCEL-REASON      PIC X.
  1435         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1436         16  CP-PMT-MODE           PIC X.
  1437         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1438         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1439         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1440         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1441         16  FILLER                PIC X.
  1442
  1443***************    OUTPUT FROM ELRESV   ************************
  1444
  1445         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1446
  1447         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1448                                     COMP-3.
  1449         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1450                                     COMP-3.
  1451         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1452                                     COMP-3.
  1453         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1454                                     COMP-3.
  1455         16  FILLER                PIC X(09).
  1456***************    OUTPUT FROM ELRTRM   *************************
  1457
  1458         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1459                                     COMP-3.
  1460         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1461                                     COMP-3.
  1462         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1463                                     COMP-3.
  1464         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1465                                     COMP-3.
  1466         16  FILLER                PIC X(12).
  1467
  1468***************    OUTPUT FROM ELRAMT   *************************
  1469
  1470         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1471                                     COMP-3.
  1472         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1473                                     COMP-3.
  1474         16  FILLER                PIC X(12).
  1475
  1476***************    OUTPUT FROM ELRATE   *************************
  1477
  1478         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1479                                     COMP-3.
  1480         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1481                                     COMP-3.
  1482         16  CP-MORTALITY-CODE     PIC X(4).
  1483         16  CP-RATE-EDIT-FLAG     PIC X.
  1484             88  CP-RATES-NEED-APR                  VALUE '1'.
  1485         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1486                                     COMP-3.
  1487         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1488         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1489         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1490                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL156.cbl
  1491         16  FILLER                PIC X(07).
  1492
  1493***************    OUTPUT FROM ELRFND   *************************
  1494
  1495         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1496                                     COMP-3.
  1497         16  CP-REFUND-TYPE-USED   PIC X.
  1498           88  CP-R-AS-R78                         VALUE '1'.
  1499           88  CP-R-AS-PRORATA                     VALUE '2'.
  1500           88  CP-R-AS-CALIF                       VALUE '3'.
  1501           88  CP-R-AS-TEXAS                       VALUE '4'.
  1502           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1503           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1504           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1505           88  CP-R-AS-MEAN                        VALUE '8'.
  1506           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1507           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1508           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1509           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1510           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1511           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1512         16  FILLER                PIC X(12).
  1513
  1514***************    OUTPUT FROM ELEARN   *************************
  1515
  1516         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1517                                     COMP-3.
  1518         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1519                                     COMP-3.
  1520         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1521                                     COMP-3.
  1522         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1523                                     COMP-3.
  1524         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1525                                     COMP-3.
  1526         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1527                                     COMP-3.
  1528         16  CP-EARNING-TYPE-USED  PIC X.
  1529           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1530           88  CP-E-AS-R78                         VALUE '1'.
  1531           88  CP-E-AS-PRORATA                     VALUE '2'.
  1532           88  CP-E-AS-TEXAS                       VALUE '4'.
  1533           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1534           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1535           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1536           88  CP-E-AS-MEAN                        VALUE '8'.
  1537           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1538         16  FILLER                PIC X(12).
  1539
  1540***************    OUTPUT FROM ELPMNT   *************************
  1541
  1542         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1543                                     COMP-3.
  1544         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1545                                     COMP-3.
  1546         16  FILLER                PIC X(12).
  1547
  1548***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL156.cbl
  1549         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1550                                     COMP-3.
  1551         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1552                                     COMP-3.
  1553         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1554                                     COMP-3.
  1555         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1556                                     COMP-3.
  1557         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1558                                     COMP-3.
  1559         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1560                                     COMP-3.
  1561         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1562             88  OPEN-RATE-FILE                   VALUE 'O'.
  1563             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1564             88  IO-ERROR                         VALUE 'E'.
  1565
  1566         16  CP-FIRST-PAY-DATE     PIC XX.
  1567
  1568         16  CP-JOINT-INDICATOR    PIC X.
  1569
  1570         16  CP-RESERVE-REMAINING-TERM
  1571                                   PIC S9(4)V9    VALUE ZERO
  1572                                     COMP-3.
  1573
  1574         16  CP-INSURED-BIRTH-DT   PIC XX.
  1575
  1576         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1577                                     COMP-3.
  1578
  1579         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1580                                     COMP-3.
  1581
  1582         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1583                                     COMP-3.
  1584
  1585         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1586                                     COMP-3.
  1587
  1588         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1589                                     COMP-3.
  1590
  1591         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1592                                     COMP-3.
  1593
  1594         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1595                                     COMP-3.
  1596
  1597         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1598             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1599
  1600         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1601                                     COMP-3.
  1602         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1603                                     COMP-3.
  1604         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1605         16  FILLER                PIC X(15).
  1606******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL156.cbl
  1607*    COPY ELCICALC.
  1608******************************************************************
  1609*                                                                *
  1610*                           ELCCICALC.                           *
  1611*                            VMOD=2.001                          *
  1612*                                                                *
  1613*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1614*                 CALCULATION MODULE                             *
  1615*                                                                *
  1616*  PASSED TO ELCLMI                                              *
  1617*  -----------------                                             *
  1618*  STATE                                                         *
  1619*  PRODUCT                                                       *
  1620*  COVERAGE                                                      *
  1621*  EFFECTIVE DATE                                                *
  1622*  INCURRED DATE                                                 *
  1623*  ESTABLISHED DATE                                              *
  1624*  LAST PAID DATE                                                *
  1625*  REPORTED DATE                                                 *
  1626*  CLAIM PAYMENT AMOUNT                                          *
  1627*                                                                *
  1628*  RETURNED FROM ELRTRM                                          *
  1629*  ---------------------                                         *
  1630*  RETURN CODE                                                   *
  1631*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1632*  CLAIM INTEREST AMOUNT                                         *
  1633*----------------------------------------------------------------*
  1634*----------------------------------------------------------------*
  1635*                 LENGTH = 100                                   *
  1636*                                                                *
  1637******************************************************************
  1638******************************************************************
  1639*                   C H A N G E   L O G
  1640*
  1641* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1642*-----------------------------------------------------------------
  1643*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1644* EFFECTIVE    NUMBER
  1645*-----------------------------------------------------------------
  1646* 120905    2004040700004  PEMA  NEW COPYBOOK
  1647* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1648******************************************************************
  1649
  1650 01  CLAIM-INT-PASS-AREA.
  1651     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1652                                     COMP.
  1653
  1654     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1655       88  NO-CI-ERROR                             VALUE ZERO.
  1656       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1657       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1658       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1659       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1660       88  CP-AMT-LT-5000                          VALUE '4'.
  1661       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1662       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1663       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1664       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL156.cbl
  1665***********************  INPUT AREAS ****************************
  1666
  1667     12  CP-CALCULATION-AREA.
  1668         16  CP-COMPANY-CD         PIC X.
  1669         16  CP-STATE              PIC XX.
  1670         16  CP-PRODUCT            PIC XX.
  1671         16  CP-COVERAGE           PIC XX.
  1672         16  CP-INC-DT             PIC XX.
  1673         16  CP-EST-DT             PIC XX.
  1674         16  CP-LSTPD-DT           PIC XX.
  1675         16  CP-RPT-DT             PIC XX.
  1676         16  CP-PRF-DT             PIC XX.
  1677         16  CP-EFF-DT             PIC XX.
  1678         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1679         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1680         16  FILLER                PIC X(37).
  1681
  1682***************    OUTPUT FROM ELCLMI   ************************
  1683
  1684         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1685
  1686         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1687         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1688         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1689         16  FILLER                PIC X(19).
  1690******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL156.cbl
  1692*    COPY ELCATTR.
  1693******************************************************************
  1694*                                                                *
  1695*                            ELCATTR.                            *
  1696*                            VMOD=2.001                          *
  1697*                                                                *
  1698*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1699*                                                                *
  1700*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1701*                                                                *
  1702*                   POS 1   P=PROTECTED                          *
  1703*                           U=UNPROTECTED                        *
  1704*                           S=ASKIP                              *
  1705*                   POS 2   A=ALPHA/NUMERIC                      *
  1706*                           N=NUMERIC                            *
  1707*                   POS 3   N=NORMAL                             *
  1708*                           B=BRIGHT                             *
  1709*                           D=DARK                               *
  1710*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1711*                           OF=MODIFIED DATA TAG OFF             *
  1712*                                                                *
  1713*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1714******************************************************************
  1715 01  ATTRIBUTE-LIST.
  1716     12  AL-PABOF            PIC X       VALUE 'Y'.
  1717     12  AL-PABON            PIC X       VALUE 'Z'.
  1718     12  AL-PADOF            PIC X       VALUE '%'.
  1719     12  AL-PADON            PIC X       VALUE '_'.
  1720     12  AL-PANOF            PIC X       VALUE '-'.
  1721     12  AL-PANON            PIC X       VALUE '/'.
  1722     12  AL-SABOF            PIC X       VALUE '8'.
  1723     12  AL-SABON            PIC X       VALUE '9'.
  1724     12  AL-SADOF            PIC X       VALUE '@'.
  1725     12  AL-SADON            PIC X       VALUE QUOTE.
  1726     12  AL-SANOF            PIC X       VALUE '0'.
  1727     12  AL-SANON            PIC X       VALUE '1'.
  1728     12  AL-UABOF            PIC X       VALUE 'H'.
  1729     12  AL-UABON            PIC X       VALUE 'I'.
  1730     12  AL-UADOF            PIC X       VALUE '<'.
  1731     12  AL-UADON            PIC X       VALUE '('.
  1732     12  AL-UANOF            PIC X       VALUE ' '.
  1733     12  AL-UANON            PIC X       VALUE 'A'.
  1734     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1735     12  AL-UNBON            PIC X       VALUE 'R'.
  1736     12  AL-UNDOF            PIC X       VALUE '*'.
  1737     12  AL-UNDON            PIC X       VALUE ')'.
  1738     12  AL-UNNOF            PIC X       VALUE '&'.
  1739     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL156.cbl
  1741*    COPY ELCEMIB.
  1742******************************************************************
  1743*                                                                *
  1744*                                                                *
  1745*                            ELCEMIB.                            *
  1746*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1747*                            VMOD=2.005                          *
  1748*                                                                *
  1749*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1750*                                                                *
  1751******************************************************************
  1752 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1753     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1754     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1755     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1756     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1757     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1758     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1759     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1760     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1761     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1762         88  EMI-NO-ERRORS                    VALUE '1'.
  1763         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1764         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1765     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1766         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1767     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1768         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1769         88  EMI-AREA1-FULL                   VALUE '2'.
  1770     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1771         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1772         88  EMI-AREA2-FULL                   VALUE '2'.
  1773     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1774         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1775         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1776         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1777         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1778         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1779     12  EMI-ERROR-LINES.
  1780         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1781         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1782         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1783         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1784             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1785                 24  EMI-ERR-NUM         PIC X(4).
  1786                 24  EMI-FILLER          PIC X.
  1787                 24  EMI-SEV             PIC X.
  1788                 24  FILLER              PIC X.
  1789             20  FILLER                  PIC X(02).
  1790     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1791         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1792             20  EMI-ERROR-NUMBER    PIC X(4).
  1793             20  EMI-FILL            PIC X.
  1794             20  EMI-SEVERITY        PIC X.
  1795             20  FILLER              PIC X.
  1796             20  EMI-ERROR-TEXT.
  1797                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1798                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL156.cbl
  1799     12  EMI-SEVERITY-SAVE           PIC X.
  1800         88  EMI-NOTE                    VALUE 'N'.
  1801         88  EMI-WARNING                 VALUE 'W'.
  1802         88  EMI-FORCABLE                VALUE 'F'.
  1803         88  EMI-FATAL                   VALUE 'X'.
  1804     12  EMI-MESSAGE-FLAG            PIC X.
  1805         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1806         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1807     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1808     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1809         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1810         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1811         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1812     12  FILLER                      PIC X(137)  VALUE SPACES.
  1813     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1814     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1815     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1816     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL156.cbl
  1818*    COPY ELCLNKLT.
  1819******************************************************************
  1820*                                                                *
  1821*                                                                *
  1822*                           ELCLNKLT                             *
  1823*                            VMOD=2.003                          *
  1824*                                                                *
  1825*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1826*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1827*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1828*                                                                *
  1829*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1830*   COMPLETING THE REQUIRED FIELDS.                              *
  1831*                                                                *
  1832*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1833*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1834*                              9999 INDICATES AN UNKNOWN ABEND   *
  1835*                                   WAS DETECTED.                *
  1836*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1837*                              CODES FOUND IN THE ERROR FILE.    *
  1838******************************************************************
  1839 01  W-1523-LINKDATA.
  1840     12  W-1523-COMMON-PI-DATA.
  1841         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1842         16  FILLER              PIC  X(67).
  1843         16  W-1523-COMPANY-CD   PIC  X(01).
  1844         16  FILLER              PIC  X(10).
  1845         16  W-1523-CONTROL-IN-PROGRESS.
  1846             20  W-1523-CARRIER  PIC  X(01).
  1847             20  W-1523-GROUPING PIC  X(06).
  1848             20  W-1523-STATE    PIC  X(02).
  1849             20  W-1523-ACCOUNT  PIC  X(10).
  1850             20  W-1523-CLAIM-CERT-GRP.
  1851                 24  W-1523-CLAIM-NO
  1852                                 PIC  X(07).
  1853                 24  W-1523-CERT-NO.
  1854                     28  W-1523-CERT-PRIME
  1855                                 PIC  X(10).
  1856                     28  W-1523-CERT-SFX
  1857                                 PIC  X(01).
  1858                 24  W-1523-CERT-EFF-DT
  1859                                 PIC  X(02).
  1860         16  FILLER              PIC X(265).
  1861
  1862     12  W-1523-WORK-AREA.
  1863         16  W-1523-FORM-NUMBER  PIC  X(04).
  1864         16  W-1523-NUMBER-COPIES
  1865                                 PIC  9(01).
  1866         16  W-1523-ADDR-TYPE    PIC  X(02).
  1867         16  W-1523-FOLLOW-UP-DATE
  1868                                 PIC  X(02).
  1869         16  W-1523-RESEND-DATE  PIC  X(02).
  1870         16  W-1523-ERROR-CODE   PIC  9(04).
  1871             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1872             88  W-1523-FATAL-ERROR
  1873                                    VALUES  0006 0013 0042
  1874                                            0154 0168 0169
  1875                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL156.cbl
  1876                                            0179 0186 0281
  1877                                            0332 2055 3697
  1878                                            3698 3699 3770
  1879                                            3771 3772 7675
  1880                                            9106 9808 9883
  1881                                            9887.
  1882             88  W-1523-STOP-ERRORS
  1883                                    VALUES  0013 0042 0154
  1884                                            0168 0169 0172
  1885                                            0281 0332 2055
  1886                                            3698 3699 7675
  1887                                            9106 9808 9883
  1888                                            9999.
  1889         16  W-1523-REASON       PIC  X(70).
  1890         16  W-1523-ARCHIVE-NUMBER
  1891                                 PIC  9(08).
  1892     12  W-1523-POINTER-AREA.
  1893         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1894         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1895         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1896         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1897         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL156.cbl
  1899*    COPY ELCNWA.
  1900*****************************************************************
  1901*                                                               *
  1902*                                                               *
  1903*                            ELCNWA.                            *
  1904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1905*                            VMOD=2.003                         *
  1906*                                                               *
  1907*            M O V E   N A M E   W O R K   A R E A.             *
  1908*                                                               *
  1909*****************************************************************.
  1910
  1911 01  WS-NAME-WORK-AREA.
  1912     05  WS-INSURED-LAST-NAME        PIC X(15).
  1913     05  WS-INSURED-1ST-NAME         PIC X(12).
  1914     05  WS-INSURED-MID-INIT         PIC X.
  1915
  1916     05  WS-NAME-WORK.
  1917         10  WS-NW                   PIC X
  1918             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1919
  1920     05  WS-NAME-WORK2.
  1921         10  WS-NW2                  PIC X
  1922             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1923                                        NWA-INDEX0.
  1924
  1925     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1926                                     COMP-3.
  1927
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL156.cbl
  1929*    COPY ELCDMO.
  1930******************************************************************
  1931*                                                                *
  1932*                                                                *
  1933*                            ELCDMO.                             *
  1934*                            VMOD=2.004                          *
  1935*                                                                *
  1936*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1937*        COMMUNICATION AREA                                      *
  1938*   FILE TYPE = NA                                               *
  1939*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1940*                                                                *
  1941******************************************************************
  1942 01  DMO-COMMUNICATION-AREA.
  1943     12  DM-RECORD-TYPE                  PIC  X(02).
  1944             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1945             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1946             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1947     12  DM-DIST-CODE                    PIC  X(04).
  1948     12  DM-MAIL-CODE                    PIC  X(05).
  1949     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1950     12  DM-INSURED-NAME                 PIC  X(30).
  1951     12  DM-CLAIM-NO                     PIC  X(07).
  1952     12  DM-CLAIM-TYPE                   PIC  X.
  1953
  1954     12  DM-STATUS-DATA-AREA.
  1955         16  DM-CLAIM-STATUS             PIC  X.
  1956             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1957             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1958             88  DM-CLOSED                        VALUE '3'.
  1959             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1960             88  DM-DEFAULT                       VALUE '9'.
  1961         16  DM-STATUS-DATE              PIC  X(08).
  1962******YYYYMMDD
  1963         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1964             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1965             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1966             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1967             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1968             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1969             88  DM-RE-OPENED                     VALUE 'R'.
  1970             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1971             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1972             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1973         16  DM-STAT-CARRIER             PIC X.
  1974
  1975     12  DM-DRAFT-DATA-AREA.
  1976         16  DM-PAYMENT-TYPE             PIC  X.
  1977             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  1978         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  1979         16  DM-PAYMENT-DATE             PIC  X(08).
  1980******YYYYMMDD
  1981         16  DM-CERT-NO                  PIC  X(11).
  1982         16  DM-TRLR-SEQ-NO              PIC  9(04).
  1983         16  DM-CARRIER                  PIC  X.
  1984
  1985     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL156.cbl
  1987*    COPY ELCDMDCD.
  1988******************************************************************
  1989*                                                                *
  1990*                                                                *
  1991*                            ELCDMDCD.                           *
  1992*                            VMOD=2.001                          *
  1993*                                                                *
  1994*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  1995*       COMMUNICATIONS AREA                                      *
  1996*                                                                *
  1997******************************************************************
  1998 01  CD-COMMUNICATION-AREA.
  1999     12  CD-SYSTEM-ID            PIC  X(02).
  2000         88 CD-CLAIMS                      VALUE 'CL'.
  2001         88 CD-CREDIT                      VALUE 'CR'.
  2002     12  CD-RECORD-TYPE          PIC  X(02).
  2003         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2004         88 CD-EOB-CODE                    VALUE 'EO'.
  2005         88 CD-ICD9-CODE                   VALUE 'I9'.
  2006         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2007         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2008         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2009         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2010         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2011     12  CD-RECORD-KEY           PIC  X(06).
  2012         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2013     12  CD-RETURN-CODE          PIC  X(02).
  2014     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2015     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2016     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2017     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL156.cbl
  2019*    COPY ELCDCTB.
  2020******************************************************************
  2021*                                                                *
  2022*                                                                *
  2023*                            ELCDCTB.                            *
  2024*                            VMOD=2.002                          *
  2025*                                                                *
  2026*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2027*       COMMUNICATIONS AREA                                      *
  2028*                                                                *
  2029******************************************************************
  2030 01  DCT-COMMUNICATION-AREA.
  2031     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2032     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2033     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2034     12  DCT-PRODUCT-CODE         PIC  X(02).
  2035     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2036     12  DCT-RETURN-CODE          PIC  X(02).
  2037     12  DCT-MAIL-CODE            PIC  X(05).
  2038     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2039     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL156.cbl
  2041 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2042 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2043 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2044 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL156.cbl
  2046*    COPY ELCINTF.
  2047******************************************************************
  2048*                                                                *
  2049*                                                                *
  2050*                            ELCINTF.                            *
  2051*                            VMOD=2.017                          *
  2052*                                                                *
  2053*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2054*                                                                *
  2055*       LENGTH = 1024                                            *
  2056*                                                                *
  2057******************************************************************
  2058 01  PROGRAM-INTERFACE-BLOCK.
  2059     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2060     12  PI-CALLING-PROGRAM              PIC X(8).
  2061     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2062     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2063     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2064     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2065     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2066     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2067     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2068     12  PI-COMPANY-ID                   PIC XXX.
  2069     12  PI-COMPANY-CD                   PIC X.
  2070
  2071     12  PI-COMPANY-PASSWORD             PIC X(8).
  2072
  2073     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2074
  2075     12  PI-CONTROL-IN-PROGRESS.
  2076         16  PI-CARRIER                  PIC X.
  2077         16  PI-GROUPING                 PIC X(6).
  2078         16  PI-STATE                    PIC XX.
  2079         16  PI-ACCOUNT                  PIC X(10).
  2080         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2081                                         PIC X(10).
  2082         16  PI-CLAIM-CERT-GRP.
  2083             20  PI-CLAIM-NO             PIC X(7).
  2084             20  PI-CERT-NO.
  2085                 25  PI-CERT-PRIME       PIC X(10).
  2086                 25  PI-CERT-SFX         PIC X.
  2087             20  PI-CERT-EFF-DT          PIC XX.
  2088         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2089             20  PI-PLAN-CODE            PIC X(2).
  2090             20  PI-REVISION-NUMBER      PIC X(3).
  2091             20  PI-PLAN-EFF-DT          PIC X(2).
  2092             20  PI-PLAN-EXP-DT          PIC X(2).
  2093             20  FILLER                  PIC X(11).
  2094         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  2095             20  PI-OE-REFERENCE-1.
  2096                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2097                 25  PI-OE-REF-1-SUFF    PIC XX.
  2098
  2099     12  PI-SESSION-IN-PROGRESS          PIC X.
  2100         88  CLAIM-SESSION                   VALUE '1'.
  2101         88  CREDIT-SESSION                  VALUE '2'.
  2102         88  WARRANTY-SESSION                VALUE '3'.
  2103         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL156.cbl
  2104         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2105
  2106
  2107*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2108
  2109     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2110     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2111
  2112     12  PI-CREDIT-USER                  PIC X.
  2113         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2114         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2115
  2116     12  PI-CLAIM-USER                   PIC X.
  2117         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2118         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2119
  2120     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2121         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2122         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2123         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2124         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2125         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2126
  2127     12  PI-PROCESSOR-ID                 PIC X(4).
  2128
  2129     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2130
  2131     12  PI-MEMBER-CAPTION               PIC X(10).
  2132
  2133     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2134         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2135
  2136     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2137     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2138     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2139     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2140
  2141     12  PI-AH-OVERRIDE-L1               PIC X.
  2142     12  PI-AH-OVERRIDE-L2               PIC XX.
  2143     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2144     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2145
  2146     12  PI-NEW-SYSTEM                   PIC X(2).
  2147
  2148     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2149     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2150         88  PI-USES-PAID-TO                 VALUE '1'.
  2151     12  PI-CRDTCRD-SYSTEM.
  2152         16  PI-CRDTCRD-USER             PIC X.
  2153             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2154             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2155         16  PI-CC-MONTH-END-DT          PIC XX.
  2156     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2157
  2158     12  PI-OE-REFERENCE-2.
  2159         16  PI-OE-REF-2-PRIME           PIC X(10).
  2160         16  PI-OE-REF-2-SUFF            PIC X.
  2161
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL156.cbl
  2162     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2163
  2164     12  PI-LANGUAGE-TYPE                PIC X.
  2165             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2166             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2167             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2168
  2169     12  PI-POLICY-LINKAGE-IND           PIC X.
  2170         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2171         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2172                                                   LOW-VALUES.
  2173
  2174     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2175     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2176         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2177         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2178     12  FILLER                          PIC X(4).
  2179
  2180     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2181
  2182     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2183         PI-SYSTEM-LEVEL.
  2184
  2185         16  PI-ENTRY-CODES.
  2186             20  PI-ENTRY-CD-1           PIC X.
  2187             20  PI-ENTRY-CD-2           PIC X.
  2188
  2189         16  PI-RETURN-CODES.
  2190             20  PI-RETURN-CD-1          PIC X.
  2191             20  PI-RETURN-CD-2          PIC X.
  2192
  2193         16  PI-UPDATE-STATUS-SAVE.
  2194             20  PI-UPDATE-BY            PIC X(4).
  2195             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2196
  2197         16  PI-LOWER-CASE-LETTERS       PIC X.
  2198             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2199
  2200*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2201*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2202*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2203
  2204         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2205             88  ST-ACCNT-CNTL               VALUE ' '.
  2206             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2207             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2208             88  ACCNT-CNTL                  VALUE '3'.
  2209             88  CARR-ACCNT-CNTL             VALUE '4'.
  2210
  2211         16  PI-PROCESSOR-CAP-LIST.
  2212             20  PI-SYSTEM-CONTROLS.
  2213                24 PI-SYSTEM-DISPLAY     PIC X.
  2214                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2215                24 PI-SYSTEM-MODIFY      PIC X.
  2216                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2217             20  FILLER                  PIC XX.
  2218             20  PI-DISPLAY-CAP          PIC X.
  2219                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL156.cbl
  2220             20  PI-MODIFY-CAP           PIC X.
  2221                 88  MODIFY-CAP              VALUE 'Y'.
  2222             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2223                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2224             20  PI-FORCE-CAP            PIC X.
  2225                 88  FORCE-CAP               VALUE 'Y'.
  2226
  2227         16  PI-PROGRAM-CONTROLS.
  2228             20  PI-PGM-PRINT-OPT        PIC X.
  2229             20  PI-PGM-FORMAT-OPT       PIC X.
  2230             20  PI-PGM-PROCESS-OPT      PIC X.
  2231             20  PI-PGM-TOTALS-OPT       PIC X.
  2232
  2233         16  PI-HELP-INTERFACE.
  2234             20  PI-LAST-ERROR-NO        PIC X(4).
  2235             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2236
  2237         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2238             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2239
  2240         16  PI-CR-CONTROL-IN-PROGRESS.
  2241             20  PI-CR-CARRIER           PIC X.
  2242             20  PI-CR-GROUPING          PIC X(6).
  2243             20  PI-CR-STATE             PIC XX.
  2244             20  PI-CR-ACCOUNT           PIC X(10).
  2245             20  PI-CR-FIN-RESP          PIC X(10).
  2246             20  PI-CR-TYPE              PIC X.
  2247
  2248         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2249
  2250         16  PI-CR-MONTH-END-DT          PIC XX.
  2251
  2252         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2253             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2254             88  PI-ZERO-CARRIER             VALUE '1'.
  2255             88  PI-ZERO-GROUPING            VALUE '2'.
  2256             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2257
  2258         16  PI-CARRIER-SECURITY         PIC X.
  2259             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2260
  2261         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2262             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2263             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  2264
  2265         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2266             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2267                                         INDEXED BY PI-ACCESS-NDX
  2268                                         PIC X.
  2269
  2270         16  PI-GA-BILLING-CONTROL       PIC X.
  2271             88  PI-GA-BILLING               VALUE '1'.
  2272
  2273         16  PI-MAIL-PROCESSING          PIC X.
  2274             88  PI-MAIL-YES                 VALUE 'Y'.
  2275
  2276         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2277
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL156.cbl
  2278         16  PI-AR-SYSTEM.
  2279             20  PI-AR-PROCESSING-CNTL   PIC X.
  2280                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2281             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2282             20  PI-AR-MONTH-END-DT      PIC XX.
  2283
  2284         16  PI-MP-SYSTEM.
  2285             20  PI-MORTGAGE-USER            PIC X.
  2286                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2287                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2288             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2289                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2290                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2291                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2292                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2293                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2294             20  PI-MP-MONTH-END-DT          PIC XX.
  2295             20  PI-MP-REFERENCE-NO.
  2296                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2297                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2298
  2299         16  PI-LABEL-CONTROL            PIC X(01).
  2300             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2301             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2302
  2303         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2304             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2305
  2306         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2307             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2308             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2309
  2310         16  FILLER                      PIC X(14).
  2311
  2312     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2313******************************************************************
  2314     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2315         16  PI-SAVE-FORM        PIC X(12).
  2316         16  PI-ACCT-KEY         PIC X(26).
  2317         16  PI-PAYEE-NAME       PIC X(30).
  2318         16  PI-DAILY-RATE       PIC S9(3)V99.
  2319         16  PI-MONTH-END-SAVE   PIC XX.
  2320         16  PI-BENEFIT-SAVE.
  2321             20  PI-BEN-DAYS     PIC 99.
  2322             20  PI-BEN-TYPE     PIC X.
  2323         16  PI-MANUAL-SW        PIC 9.
  2324         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2325         16  PI-PASS-SW          PIC X.
  2326         16  PI-PFKEY-USED       PIC X.
  2327         16  PI-CK-ASSIGN        PIC X.
  2328         16  PI-FATAL-COUNT      PIC 99.
  2329         16  PI-FORCE-COUNT      PIC 99.
  2330         16  PI-SAVE-INPUT.
  2331             20  PI-PMTTYPE      PIC X.
  2332             20  PI-PAYEE.
  2333                 24  PI-PAYEE-TYPE PIC X.
  2334                 24  PI-PAYEE-SEQ  PIC X.
  2335                 24  PI-PAYEE-SEQ-NUM REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL156.cbl
  2336                   PI-PAYEE-SEQ    PIC S9.
  2337             20  PI-PMTNOTE1     PIC X(60).
  2338             20  PI-PMTNOTE2     PIC X(60).
  2339             20  PI-OFFLINE      PIC X.
  2340             20  PI-ECHECKNO     PIC X(7).
  2341             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2342                 28  PI-ECHECKNO-N     PIC X.
  2343                 28  PI-ECHECKNO-6     PIC X(6).
  2344             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2345                 24  PI-ECHECKNO-CR    PIC XX.
  2346                 24  PI-ECHECKNO-5     PIC X(5).
  2347             20  PI-HOLDTIL      PIC 9(6).
  2348             20  PI-EPYFROM      PIC 9(6).
  2349             20  PI-EPYTHRU      PIC 9(6).
  2350             20  PI-EDAYS        PIC S9(5).
  2351             20  PI-EPYAMT       PIC S9(7)V99.
  2352             20  PI-ERESV        PIC S9(7)V99.
  2353             20  PI-EEXPENS      PIC 9(6)V99.
  2354             20  PI-ETYPE        PIC X.
  2355             20  PI-CASH         PIC X.
  2356             20  PI-GROUPED      PIC X.
  2357             20  PI-INT-RATE     PIC S99V9(5).
  2358             20  PI-AIGFROM      PIC 9(6).
  2359             20  PI-LOAN-NO      PIC X(20).
  2360             20  PI-PROOF-DATE   PIC 9(6).
  2361             20  PI-PRINT-EOB-YN PIC X.
  2362         16  PI-SAVE-COMPUTED.
  2363             20  PI-CCHECKNO     PIC X(7).
  2364             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2365                 28  PI-CCHECKNO-N     PIC X.
  2366                 28  PI-CCHECKNO-6     PIC X(6).
  2367             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2368                 24  PI-CCHECKNO-CR    PIC XX.
  2369                 24  PI-CCHECKNO-5     PIC X(5).
  2370             20  PI-CPYFROM      PIC XX.
  2371             20  PI-CPYTHRU      PIC XX.
  2372             20  PI-CDAYS        PIC S9(5).
  2373             20  PI-CPYAMT       PIC S9(7)V99.
  2374             20  PI-CRESV        PIC 9(6)V99.
  2375             20  PI-CEXPENS      PIC 9(6)V99.
  2376             20  PI-PMT-APPR-SW  PIC X.
  2377                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2378                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2379                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2380         16  PI-PREV-CLMNO       PIC X(7).
  2381         16  PI-LF-COVERAGE-TYPE PIC X.
  2382         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2383         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2384         16  PI-PROVISIONAL-IND  PIC X.
  2385             88 PI-PROV-PMT      VALUE 'P'.
  2386         16  PI-PREV-TRLR-KEY    PIC X(22).
  2387         16  PI-SPLIT-PMT-SW     PIC X.
  2388         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2389         16  PI-ACTIVITY-CODE    PIC 99.
  2390         16  PI-RESET-SW         PIC X.
  2391         16  PI-SPECIAL-BEN-SW   PIC X.
  2392             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2393         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL156.cbl
  2394         16  PI-EXP-DT           PIC XX.
  2395         16  PI-LOAN-DUE-DAY     PIC 99.
  2396         16  PI-3RD-PARTY-SW     PIC X.
  2397         16  PI-LOAN-UPDATE-SW   PIC X.
  2398
  2399         16  PI-DMD-DATA.
  2400             20  PI-SV-CERT-KEY       PIC X(21).
  2401             20  PI-SV-CERT-NO        PIC X(11).
  2402             20  PI-SV-BEN            PIC X(10).
  2403             20  PI-SV-CCN            PIC X(16).
  2404             20  PI-INTEREST-PAID-IND PIC X.
  2405                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2406             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2407             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2408             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2409             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2410         16  PI-AT-EOB-CODES.
  2411             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2412         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2413         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2414         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2415         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2416         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2417         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2418         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2419         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2420         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2421         16  PI-LF-BENEFIT-CD         PIC X(2).
  2422         16  PI-EOB-CODES-EXIST PIC X.
  2423         16  PI-SET-NOTE2-MDT   PIC X.
  2424         16  PI-VFY-2ND-BENE          PIC X.
  2425*00781          16  FILLER                   PIC X(176).
  2426*052506         16  FILLER                   PIC X(161).
  2427*031808         16  FILLER                   PIC X(154).
  2428*091808         16  FILLER                   PIC X(152).
  2429*041710         16  FILLER                   PIC X(94).
  2430         16  FILLER                   PIC X(93).
  2431
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL156.cbl
  2433*    COPY ELCJPFX.
  2434******************************************************************
  2435*                                                                *
  2436*                                                                *
  2437*                            ELCJPFX.                            *
  2438*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2439*                            VMOD=2.002                          *
  2440*                                                                *
  2441*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2442*                                                                *
  2443*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2444*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2445*        ELCNTL - CONTROL FILE                                   *
  2446*        ELMSTR - CLAIM MASTERS                                  *
  2447*        ELTRLR - ACTIVITY TRAILERS                              *
  2448*        ELCHKQ - CHECK QUE                                      *
  2449******************************************************************
  2450 01  JOURNAL-RECORD.
  2451     12  JP-USER-ID                  PIC X(4).
  2452     12  JP-FILE-ID                  PIC X(8).
  2453     12  JP-PROGRAM-ID               PIC X(8).
  2454     12  JP-RECORD-TYPE              PIC X.
  2455         88 JP-ADD              VALUE 'A'.
  2456         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2457         88 JP-AFTER-CHANGE     VALUE 'C'.
  2458         88 JP-DELETE           VALUE 'D'.
  2459         88 JP-GENERIC-DELETE   VALUE 'G'.
  2460         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2461         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2462     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2463     12  JP-RECORD-AREA
  2464
  2465
  2466                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL156.cbl
  2468*    COPY ELCAID.
  2469******************************************************************
  2470*                                                                *
  2471*                            ELCAID.                             *
  2472*                            VMOD=2.001                          *
  2473*                                                                *
  2474*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2475*                                                                *
  2476*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2477*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2478******************************************************************
  2479
  2480 01  DFHAID.
  2481   02  DFHNULL   PIC  X  VALUE  ' '.
  2482   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2483   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2484   02  DFHPEN    PIC  X  VALUE  '='.
  2485   02  DFHOPID   PIC  X  VALUE  'W'.
  2486   02  DFHPA1    PIC  X  VALUE  '%'.
  2487   02  DFHPA2    PIC  X  VALUE  '>'.
  2488   02  DFHPA3    PIC  X  VALUE  ','.
  2489   02  DFHPF1    PIC  X  VALUE  '1'.
  2490   02  DFHPF2    PIC  X  VALUE  '2'.
  2491   02  DFHPF3    PIC  X  VALUE  '3'.
  2492   02  DFHPF4    PIC  X  VALUE  '4'.
  2493   02  DFHPF5    PIC  X  VALUE  '5'.
  2494   02  DFHPF6    PIC  X  VALUE  '6'.
  2495   02  DFHPF7    PIC  X  VALUE  '7'.
  2496   02  DFHPF8    PIC  X  VALUE  '8'.
  2497   02  DFHPF9    PIC  X  VALUE  '9'.
  2498   02  DFHPF10   PIC  X  VALUE  ':'.
  2499   02  DFHPF11   PIC  X  VALUE  '#'.
  2500   02  DFHPF12   PIC  X  VALUE  '@'.
  2501   02  DFHPF13   PIC  X  VALUE  'A'.
  2502   02  DFHPF14   PIC  X  VALUE  'B'.
  2503   02  DFHPF15   PIC  X  VALUE  'C'.
  2504   02  DFHPF16   PIC  X  VALUE  'D'.
  2505   02  DFHPF17   PIC  X  VALUE  'E'.
  2506   02  DFHPF18   PIC  X  VALUE  'F'.
  2507   02  DFHPF19   PIC  X  VALUE  'G'.
  2508   02  DFHPF20   PIC  X  VALUE  'H'.
  2509   02  DFHPF21   PIC  X  VALUE  'I'.
  2510*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2511   02  DFHPF22   PIC  X  VALUE  '['.
  2512   02  DFHPF23   PIC  X  VALUE  '.'.
  2513   02  DFHPF24   PIC  X  VALUE  '<'.
  2514   02  DFHMSRE   PIC  X  VALUE  'X'.
  2515   02  DFHSTRF   PIC  X  VALUE  'h'.
  2516   02  DFHTRIG   PIC  X  VALUE  '"'.
  2517 01  FILLER    REDEFINES DFHAID.
  2518     12  FILLER              PIC X(8).
  2519     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL156.cbl
  2521*    COPY EL156S.
  2522 01  EL156AI.
  2523     05  FILLER            PIC  X(0012).
  2524*    -------------------------------
  2525     05  RUNDTEAL PIC S9(0004) COMP.
  2526     05  RUNDTEAF PIC  X(0001).
  2527     05  FILLER REDEFINES RUNDTEAF.
  2528         10  RUNDTEAA PIC  X(0001).
  2529     05  RUNDTEAI PIC  X(0008).
  2530*    -------------------------------
  2531     05  RUNTIMAL PIC S9(0004) COMP.
  2532     05  RUNTIMAF PIC  X(0001).
  2533     05  FILLER REDEFINES RUNTIMAF.
  2534         10  RUNTIMAA PIC  X(0001).
  2535     05  RUNTIMAI PIC  X(0005).
  2536*    -------------------------------
  2537     05  SEQUL PIC S9(0004) COMP.
  2538     05  SEQUF PIC  X(0001).
  2539     05  FILLER REDEFINES SEQUF.
  2540         10  SEQUA PIC  X(0001).
  2541     05  SEQUI PIC  X(0010).
  2542*    -------------------------------
  2543     05  CLMNOL PIC S9(0004) COMP.
  2544     05  CLMNOF PIC  X(0001).
  2545     05  FILLER REDEFINES CLMNOF.
  2546         10  CLMNOA PIC  X(0001).
  2547     05  CLMNOI PIC  X(0007).
  2548*    -------------------------------
  2549     05  CARRL PIC S9(0004) COMP.
  2550     05  CARRF PIC  X(0001).
  2551     05  FILLER REDEFINES CARRF.
  2552         10  CARRA PIC  X(0001).
  2553     05  CARRI PIC  X(0001).
  2554*    -------------------------------
  2555     05  CERTNOL PIC S9(0004) COMP.
  2556     05  CERTNOF PIC  X(0001).
  2557     05  FILLER REDEFINES CERTNOF.
  2558         10  CERTNOA PIC  X(0001).
  2559     05  CERTNOI PIC  X(0010).
  2560*    -------------------------------
  2561     05  SUFXL PIC S9(0004) COMP.
  2562     05  SUFXF PIC  X(0001).
  2563     05  FILLER REDEFINES SUFXF.
  2564         10  SUFXA PIC  X(0001).
  2565     05  SUFXI PIC  X(0001).
  2566*    -------------------------------
  2567     05  CLMTYPL PIC S9(0004) COMP.
  2568     05  CLMTYPF PIC  X(0001).
  2569     05  FILLER REDEFINES CLMTYPF.
  2570         10  CLMTYPA PIC  X(0001).
  2571     05  CLMTYPI PIC  X(0006).
  2572*    -------------------------------
  2573     05  CLMSTATL PIC S9(0004) COMP.
  2574     05  CLMSTATF PIC  X(0001).
  2575     05  FILLER REDEFINES CLMSTATF.
  2576         10  CLMSTATA PIC  X(0001).
  2577     05  CLMSTATI PIC  X(0006).
  2578*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL156.cbl
  2579     05  LSTNMEL PIC S9(0004) COMP.
  2580     05  LSTNMEF PIC  X(0001).
  2581     05  FILLER REDEFINES LSTNMEF.
  2582         10  LSTNMEA PIC  X(0001).
  2583     05  LSTNMEI PIC  X(0015).
  2584*    -------------------------------
  2585     05  FSTNMEL PIC S9(0004) COMP.
  2586     05  FSTNMEF PIC  X(0001).
  2587     05  FILLER REDEFINES FSTNMEF.
  2588         10  FSTNMEA PIC  X(0001).
  2589     05  FSTNMEI PIC  X(0012).
  2590*    -------------------------------
  2591     05  MINITL PIC S9(0004) COMP.
  2592     05  MINITF PIC  X(0001).
  2593     05  FILLER REDEFINES MINITF.
  2594         10  MINITA PIC  X(0001).
  2595     05  MINITI PIC  X(0001).
  2596*    -------------------------------
  2597     05  PRIMHDGL PIC S9(0004) COMP.
  2598     05  PRIMHDGF PIC  X(0001).
  2599     05  FILLER REDEFINES PRIMHDGF.
  2600         10  PRIMHDGA PIC  X(0001).
  2601     05  PRIMHDGI PIC  X(0012).
  2602*    -------------------------------
  2603     05  PCERTNOL PIC S9(0004) COMP.
  2604     05  PCERTNOF PIC  X(0001).
  2605     05  FILLER REDEFINES PCERTNOF.
  2606         10  PCERTNOA PIC  X(0001).
  2607     05  PCERTNOI PIC  X(0010).
  2608*    -------------------------------
  2609     05  PSUFXL PIC S9(0004) COMP.
  2610     05  PSUFXF PIC  X(0001).
  2611     05  FILLER REDEFINES PSUFXF.
  2612         10  PSUFXA PIC  X(0001).
  2613     05  PSUFXI PIC  X(0001).
  2614*    -------------------------------
  2615     05  STATUSL PIC S9(0004) COMP.
  2616     05  STATUSF PIC  X(0001).
  2617     05  FILLER REDEFINES STATUSF.
  2618         10  STATUSA PIC  X(0001).
  2619     05  STATUSI PIC  X(0010).
  2620*    -------------------------------
  2621     05  LOANHL PIC S9(0004) COMP.
  2622     05  LOANHF PIC  X(0001).
  2623     05  FILLER REDEFINES LOANHF.
  2624         10  LOANHA PIC  X(0001).
  2625     05  LOANHI PIC  X(0014).
  2626*    -------------------------------
  2627     05  LOANNOL PIC S9(0004) COMP.
  2628     05  LOANNOF PIC  X(0001).
  2629     05  FILLER REDEFINES LOANNOF.
  2630         10  LOANNOA PIC  X(0001).
  2631     05  LOANNOI PIC  X(0025).
  2632*    -------------------------------
  2633     05  DUEDAYHL PIC S9(0004) COMP.
  2634     05  DUEDAYHF PIC  X(0001).
  2635     05  FILLER REDEFINES DUEDAYHF.
  2636         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL156.cbl
  2637     05  DUEDAYHI PIC  X(0008).
  2638*    -------------------------------
  2639     05  DUEDAYL PIC S9(0004) COMP.
  2640     05  DUEDAYF PIC  X(0001).
  2641     05  FILLER REDEFINES DUEDAYF.
  2642         10  DUEDAYA PIC  X(0001).
  2643     05  DUEDAYI PIC  X(0002).
  2644*    -------------------------------
  2645     05  ZINTHL PIC S9(0004) COMP.
  2646     05  ZINTHF PIC  X(0001).
  2647     05  FILLER REDEFINES ZINTHF.
  2648         10  ZINTHA PIC  X(0001).
  2649     05  ZINTHI PIC  X(0009).
  2650*    -------------------------------
  2651     05  ZINTL PIC S9(0004) COMP.
  2652     05  ZINTF PIC  X(0001).
  2653     05  FILLER REDEFINES ZINTF.
  2654         10  ZINTA PIC  X(0001).
  2655     05  ZINTI PIC  99V99999.
  2656*    -------------------------------
  2657     05  PTHRHDGL PIC S9(0004) COMP.
  2658     05  PTHRHDGF PIC  X(0001).
  2659     05  FILLER REDEFINES PTHRHDGF.
  2660         10  PTHRHDGA PIC  X(0001).
  2661     05  PTHRHDGI PIC  X(0014).
  2662*    -------------------------------
  2663     05  PDTHRUL PIC S9(0004) COMP.
  2664     05  PDTHRUF PIC  X(0001).
  2665     05  FILLER REDEFINES PDTHRUF.
  2666         10  PDTHRUA PIC  X(0001).
  2667     05  PDTHRUI PIC  X(0008).
  2668*    -------------------------------
  2669     05  TOTPAIDL PIC S9(0004) COMP.
  2670     05  TOTPAIDF PIC  X(0001).
  2671     05  FILLER REDEFINES TOTPAIDF.
  2672         10  TOTPAIDA PIC  X(0001).
  2673     05  TOTPAIDI PIC  X(0010).
  2674*    -------------------------------
  2675     05  COVERL PIC S9(0004) COMP.
  2676     05  COVERF PIC  X(0001).
  2677     05  FILLER REDEFINES COVERF.
  2678         10  COVERA PIC  X(0001).
  2679     05  COVERI PIC  X(0010).
  2680*    -------------------------------
  2681     05  INCURL PIC S9(0004) COMP.
  2682     05  INCURF PIC  X(0001).
  2683     05  FILLER REDEFINES INCURF.
  2684         10  INCURA PIC  X(0001).
  2685     05  INCURI PIC  X(0008).
  2686*    -------------------------------
  2687     05  LSTDTEL PIC S9(0004) COMP.
  2688     05  LSTDTEF PIC  X(0001).
  2689     05  FILLER REDEFINES LSTDTEF.
  2690         10  LSTDTEA PIC  X(0001).
  2691     05  LSTDTEI PIC  X(0008).
  2692*    -------------------------------
  2693     05  CRTSTATL PIC S9(0004) COMP.
  2694     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL156.cbl
  2695     05  FILLER REDEFINES CRTSTATF.
  2696         10  CRTSTATA PIC  X(0001).
  2697     05  CRTSTATI PIC  X(0010).
  2698*    -------------------------------
  2699     05  EFFECTL PIC S9(0004) COMP.
  2700     05  EFFECTF PIC  X(0001).
  2701     05  FILLER REDEFINES EFFECTF.
  2702         10  EFFECTA PIC  X(0001).
  2703     05  EFFECTI PIC  X(0008).
  2704*    -------------------------------
  2705     05  TERMSL PIC S9(0004) COMP.
  2706     05  TERMSF PIC  X(0001).
  2707     05  FILLER REDEFINES TERMSF.
  2708         10  TERMSA PIC  X(0001).
  2709     05  TERMSI PIC  X(0011).
  2710*    -------------------------------
  2711     05  STACCTL PIC S9(0004) COMP.
  2712     05  STACCTF PIC  X(0001).
  2713     05  FILLER REDEFINES STACCTF.
  2714         10  STACCTA PIC  X(0001).
  2715     05  STACCTI PIC  X(0013).
  2716*    -------------------------------
  2717     05  EXPDTEHL PIC S9(0004) COMP.
  2718     05  EXPDTEHF PIC  X(0001).
  2719     05  FILLER REDEFINES EXPDTEHF.
  2720         10  EXPDTEHA PIC  X(0001).
  2721     05  EXPDTEHI PIC  X(0014).
  2722*    -------------------------------
  2723     05  EXPDTEL PIC S9(0004) COMP.
  2724     05  EXPDTEF PIC  X(0001).
  2725     05  FILLER REDEFINES EXPDTEF.
  2726         10  EXPDTEA PIC  X(0001).
  2727     05  EXPDTEI PIC  X(0008).
  2728*    -------------------------------
  2729     05  BENECAPL PIC S9(0004) COMP.
  2730     05  BENECAPF PIC  X(0001).
  2731     05  FILLER REDEFINES BENECAPF.
  2732         10  BENECAPA PIC  X(0001).
  2733     05  BENECAPI PIC  X(0013).
  2734*    -------------------------------
  2735     05  BENEL PIC S9(0004) COMP.
  2736     05  BENEF PIC  X(0001).
  2737     05  FILLER REDEFINES BENEF.
  2738         10  BENEA PIC  X(0001).
  2739     05  BENEI PIC  X(0009).
  2740*    -------------------------------
  2741     05  FORMTYPL PIC S9(0004) COMP.
  2742     05  FORMTYPF PIC  X(0001).
  2743     05  FILLER REDEFINES FORMTYPF.
  2744         10  FORMTYPA PIC  X(0001).
  2745     05  FORMTYPI PIC  X(0001).
  2746*    -------------------------------
  2747     05  PMTTYPEL PIC S9(0004) COMP.
  2748     05  PMTTYPEF PIC  X(0001).
  2749     05  FILLER REDEFINES PMTTYPEF.
  2750         10  PMTTYPEA PIC  X(0001).
  2751     05  PMTTYPEI PIC  X(0001).
  2752*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL156.cbl
  2753     05  PAYEEL PIC S9(0004) COMP.
  2754     05  PAYEEF PIC  X(0001).
  2755     05  FILLER REDEFINES PAYEEF.
  2756         10  PAYEEA PIC  X(0001).
  2757     05  PAYEEI PIC  X(0002).
  2758*    -------------------------------
  2759     05  CHECKNOL PIC S9(0004) COMP.
  2760     05  CHECKNOF PIC  X(0001).
  2761     05  FILLER REDEFINES CHECKNOF.
  2762         10  CHECKNOA PIC  X(0001).
  2763     05  CHECKNOI PIC  X(0007).
  2764*    -------------------------------
  2765     05  OFFLINEL PIC S9(0004) COMP.
  2766     05  OFFLINEF PIC  X(0001).
  2767     05  FILLER REDEFINES OFFLINEF.
  2768         10  OFFLINEA PIC  X(0001).
  2769     05  OFFLINEI PIC  X(0001).
  2770*    -------------------------------
  2771     05  HOLDTILL PIC S9(0004) COMP.
  2772     05  HOLDTILF PIC  X(0001).
  2773     05  FILLER REDEFINES HOLDTILF.
  2774         10  HOLDTILA PIC  X(0001).
  2775     05  HOLDTILI PIC  X(0008).
  2776*    -------------------------------
  2777     05  NOTE1L PIC S9(0004) COMP.
  2778     05  NOTE1F PIC  X(0001).
  2779     05  FILLER REDEFINES NOTE1F.
  2780         10  NOTE1A PIC  X(0001).
  2781     05  NOTE1I PIC  X(0060).
  2782*    -------------------------------
  2783     05  NOTE2L PIC S9(0004) COMP.
  2784     05  NOTE2F PIC  X(0001).
  2785     05  FILLER REDEFINES NOTE2F.
  2786         10  NOTE2A PIC  X(0001).
  2787     05  NOTE2I PIC  X(0060).
  2788*    -------------------------------
  2789     05  EOBYNL PIC S9(0004) COMP.
  2790     05  EOBYNF PIC  X(0001).
  2791     05  FILLER REDEFINES EOBYNF.
  2792         10  EOBYNA PIC  X(0001).
  2793     05  EOBYNI PIC  X(0001).
  2794*    -------------------------------
  2795     05  CASHHL PIC S9(0004) COMP.
  2796     05  CASHHF PIC  X(0001).
  2797     05  FILLER REDEFINES CASHHF.
  2798         10  CASHHA PIC  X(0001).
  2799     05  CASHHI PIC  X(0011).
  2800*    -------------------------------
  2801     05  CASHL PIC S9(0004) COMP.
  2802     05  CASHF PIC  X(0001).
  2803     05  FILLER REDEFINES CASHF.
  2804         10  CASHA PIC  X(0001).
  2805     05  CASHI PIC  X(0001).
  2806*    -------------------------------
  2807     05  GROUPHL PIC S9(0004) COMP.
  2808     05  GROUPHF PIC  X(0001).
  2809     05  FILLER REDEFINES GROUPHF.
  2810         10  GROUPHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL156.cbl
  2811     05  GROUPHI PIC  X(0010).
  2812*    -------------------------------
  2813     05  GROUPEDL PIC S9(0004) COMP.
  2814     05  GROUPEDF PIC  X(0001).
  2815     05  FILLER REDEFINES GROUPEDF.
  2816         10  GROUPEDA PIC  X(0001).
  2817     05  GROUPEDI PIC  X(0001).
  2818*    -------------------------------
  2819     05  PINTHL PIC S9(0004) COMP.
  2820     05  PINTHF PIC  X(0001).
  2821     05  FILLER REDEFINES PINTHF.
  2822         10  PINTHA PIC  X(0001).
  2823     05  PINTHI PIC  X(0004).
  2824*    -------------------------------
  2825     05  PINTL PIC S9(0004) COMP.
  2826     05  PINTF PIC  X(0001).
  2827     05  FILLER REDEFINES PINTF.
  2828         10  PINTA PIC  X(0001).
  2829     05  PINTI PIC  X(0008).
  2830*    -------------------------------
  2831     05  PROOFDTL PIC S9(0004) COMP.
  2832     05  PROOFDTF PIC  X(0001).
  2833     05  FILLER REDEFINES PROOFDTF.
  2834         10  PROOFDTA PIC  X(0001).
  2835     05  PROOFDTI PIC  X(0008).
  2836*    -------------------------------
  2837     05  AIGFRMHL PIC S9(0004) COMP.
  2838     05  AIGFRMHF PIC  X(0001).
  2839     05  FILLER REDEFINES AIGFRMHF.
  2840         10  AIGFRMHA PIC  X(0001).
  2841     05  AIGFRMHI PIC  X(0012).
  2842*    -------------------------------
  2843     05  AIGFROML PIC S9(0004) COMP.
  2844     05  AIGFROMF PIC  X(0001).
  2845     05  FILLER REDEFINES AIGFROMF.
  2846         10  AIGFROMA PIC  X(0001).
  2847     05  AIGFROMI PIC  X(0008).
  2848*    -------------------------------
  2849     05  PMTHDGAL PIC S9(0004) COMP.
  2850     05  PMTHDGAF PIC  X(0001).
  2851     05  FILLER REDEFINES PMTHDGAF.
  2852         10  PMTHDGAA PIC  X(0001).
  2853     05  PMTHDGAI PIC  X(0066).
  2854*    -------------------------------
  2855     05  EPYFROML PIC S9(0004) COMP.
  2856     05  EPYFROMF PIC  X(0001).
  2857     05  FILLER REDEFINES EPYFROMF.
  2858         10  EPYFROMA PIC  X(0001).
  2859     05  EPYFROMI PIC  X(0008).
  2860*    -------------------------------
  2861     05  EPYTHRUL PIC S9(0004) COMP.
  2862     05  EPYTHRUF PIC  X(0001).
  2863     05  FILLER REDEFINES EPYTHRUF.
  2864         10  EPYTHRUA PIC  X(0001).
  2865     05  EPYTHRUI PIC  X(0008).
  2866*    -------------------------------
  2867     05  EDAYSL PIC S9(0004) COMP.
  2868     05  EDAYSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL156.cbl
  2869     05  FILLER REDEFINES EDAYSF.
  2870         10  EDAYSA PIC  X(0001).
  2871     05  EDAYSI PIC  S9(6).
  2872*    -------------------------------
  2873     05  EPYAMTL PIC S9(0004) COMP.
  2874     05  EPYAMTF PIC  X(0001).
  2875     05  FILLER REDEFINES EPYAMTF.
  2876         10  EPYAMTA PIC  X(0001).
  2877     05  EPYAMTI PIC  S9(8)V99.
  2878*    -------------------------------
  2879     05  ERESVL PIC S9(0004) COMP.
  2880     05  ERESVF PIC  X(0001).
  2881     05  FILLER REDEFINES ERESVF.
  2882         10  ERESVA PIC  X(0001).
  2883     05  ERESVI PIC  S9(7)V99.
  2884*    -------------------------------
  2885     05  ETYPEL PIC S9(0004) COMP.
  2886     05  ETYPEF PIC  X(0001).
  2887     05  FILLER REDEFINES ETYPEF.
  2888         10  ETYPEA PIC  X(0001).
  2889     05  ETYPEI PIC  X(0001).
  2890*    -------------------------------
  2891     05  EEXPENSL PIC S9(0004) COMP.
  2892     05  EEXPENSF PIC  X(0001).
  2893     05  FILLER REDEFINES EEXPENSF.
  2894         10  EEXPENSA PIC  X(0001).
  2895     05  EEXPENSI PIC  9(6)V99.
  2896*    -------------------------------
  2897     05  CPYFROML PIC S9(0004) COMP.
  2898     05  CPYFROMF PIC  X(0001).
  2899     05  FILLER REDEFINES CPYFROMF.
  2900         10  CPYFROMA PIC  X(0001).
  2901     05  CPYFROMI PIC  X(0008).
  2902*    -------------------------------
  2903     05  CPYTHRUL PIC S9(0004) COMP.
  2904     05  CPYTHRUF PIC  X(0001).
  2905     05  FILLER REDEFINES CPYTHRUF.
  2906         10  CPYTHRUA PIC  X(0001).
  2907     05  CPYTHRUI PIC  X(0008).
  2908*    -------------------------------
  2909     05  CDAYSL PIC S9(0004) COMP.
  2910     05  CDAYSF PIC  X(0001).
  2911     05  FILLER REDEFINES CDAYSF.
  2912         10  CDAYSA PIC  X(0001).
  2913     05  CDAYSI PIC  9(6).
  2914*    -------------------------------
  2915     05  CPYAMTL PIC S9(0004) COMP.
  2916     05  CPYAMTF PIC  X(0001).
  2917     05  FILLER REDEFINES CPYAMTF.
  2918         10  CPYAMTA PIC  X(0001).
  2919     05  CPYAMTI PIC  S9(8)V99.
  2920*    -------------------------------
  2921     05  CRESVL PIC S9(0004) COMP.
  2922     05  CRESVF PIC  X(0001).
  2923     05  FILLER REDEFINES CRESVF.
  2924         10  CRESVA PIC  X(0001).
  2925     05  CRESVI PIC  9(6)V99.
  2926*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL156.cbl
  2927     05  CEXPENSL PIC S9(0004) COMP.
  2928     05  CEXPENSF PIC  X(0001).
  2929     05  FILLER REDEFINES CEXPENSF.
  2930         10  CEXPENSA PIC  X(0001).
  2931     05  CEXPENSI PIC  9(6)V99.
  2932*    -------------------------------
  2933     05  ERRMSG0L PIC S9(0004) COMP.
  2934     05  ERRMSG0F PIC  X(0001).
  2935     05  FILLER REDEFINES ERRMSG0F.
  2936         10  ERRMSG0A PIC  X(0001).
  2937     05  ERRMSG0I PIC  X(0072).
  2938*    -------------------------------
  2939     05  ERRMSG1L PIC S9(0004) COMP.
  2940     05  ERRMSG1F PIC  X(0001).
  2941     05  FILLER REDEFINES ERRMSG1F.
  2942         10  ERRMSG1A PIC  X(0001).
  2943     05  ERRMSG1I PIC  X(0072).
  2944*    -------------------------------
  2945     05  ERRMSG2L PIC S9(0004) COMP.
  2946     05  ERRMSG2F PIC  X(0001).
  2947     05  FILLER REDEFINES ERRMSG2F.
  2948         10  ERRMSG2A PIC  X(0001).
  2949     05  ERRMSG2I PIC  X(0072).
  2950*    -------------------------------
  2951     05  ENTERPFL PIC S9(0004) COMP.
  2952     05  ENTERPFF PIC  X(0001).
  2953     05  FILLER REDEFINES ENTERPFF.
  2954         10  ENTERPFA PIC  X(0001).
  2955     05  ENTERPFI PIC  99.
  2956*    -------------------------------
  2957     05  PF6TITL PIC S9(0004) COMP.
  2958     05  PF6TITF PIC  X(0001).
  2959     05  FILLER REDEFINES PF6TITF.
  2960         10  PF6TITA PIC  X(0001).
  2961     05  PF6TITI PIC  X(0016).
  2962 01  EL156AO REDEFINES EL156AI.
  2963     05  FILLER            PIC  X(0012).
  2964*    -------------------------------
  2965     05  FILLER            PIC  X(0003).
  2966     05  RUNDTEAO PIC  X(0008).
  2967*    -------------------------------
  2968     05  FILLER            PIC  X(0003).
  2969     05  RUNTIMAO PIC  99.99.
  2970*    -------------------------------
  2971     05  FILLER            PIC  X(0003).
  2972     05  SEQUO PIC  X(0010).
  2973*    -------------------------------
  2974     05  FILLER            PIC  X(0003).
  2975     05  CLMNOO PIC  X(0007).
  2976*    -------------------------------
  2977     05  FILLER            PIC  X(0003).
  2978     05  CARRO PIC  X(0001).
  2979*    -------------------------------
  2980     05  FILLER            PIC  X(0003).
  2981     05  CERTNOO PIC  X(0010).
  2982*    -------------------------------
  2983     05  FILLER            PIC  X(0003).
  2984     05  SUFXO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL156.cbl
  2985*    -------------------------------
  2986     05  FILLER            PIC  X(0003).
  2987     05  CLMTYPO PIC  X(0006).
  2988*    -------------------------------
  2989     05  FILLER            PIC  X(0003).
  2990     05  CLMSTATO PIC  X(0006).
  2991*    -------------------------------
  2992     05  FILLER            PIC  X(0003).
  2993     05  LSTNMEO PIC  X(0015).
  2994*    -------------------------------
  2995     05  FILLER            PIC  X(0003).
  2996     05  FSTNMEO PIC  X(0012).
  2997*    -------------------------------
  2998     05  FILLER            PIC  X(0003).
  2999     05  MINITO PIC  X(0001).
  3000*    -------------------------------
  3001     05  FILLER            PIC  X(0003).
  3002     05  PRIMHDGO PIC  X(0012).
  3003*    -------------------------------
  3004     05  FILLER            PIC  X(0003).
  3005     05  PCERTNOO PIC  X(0010).
  3006*    -------------------------------
  3007     05  FILLER            PIC  X(0003).
  3008     05  PSUFXO PIC  X(0001).
  3009*    -------------------------------
  3010     05  FILLER            PIC  X(0003).
  3011     05  STATUSO PIC  X(0010).
  3012*    -------------------------------
  3013     05  FILLER            PIC  X(0003).
  3014     05  LOANHO PIC  X(0014).
  3015*    -------------------------------
  3016     05  FILLER            PIC  X(0003).
  3017     05  LOANNOO PIC  X(0025).
  3018*    -------------------------------
  3019     05  FILLER            PIC  X(0003).
  3020     05  DUEDAYHO PIC  X(0008).
  3021*    -------------------------------
  3022     05  FILLER            PIC  X(0003).
  3023     05  DUEDAYO PIC  X(0002).
  3024*    -------------------------------
  3025     05  FILLER            PIC  X(0003).
  3026     05  ZINTHO PIC  X(0009).
  3027*    -------------------------------
  3028     05  FILLER            PIC  X(0003).
  3029     05  ZINTO PIC  9.99999.
  3030*    -------------------------------
  3031     05  FILLER            PIC  X(0003).
  3032     05  PTHRHDGO PIC  X(0014).
  3033*    -------------------------------
  3034     05  FILLER            PIC  X(0003).
  3035     05  PDTHRUO PIC  X(0008).
  3036*    -------------------------------
  3037     05  FILLER            PIC  X(0003).
  3038     05  TOTPAIDO PIC  Z(6).99-.
  3039*    -------------------------------
  3040     05  FILLER            PIC  X(0003).
  3041     05  COVERO PIC  X(0010).
  3042*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL156.cbl
  3043     05  FILLER            PIC  X(0003).
  3044     05  INCURO PIC  X(0008).
  3045*    -------------------------------
  3046     05  FILLER            PIC  X(0003).
  3047     05  LSTDTEO PIC  X(0008).
  3048*    -------------------------------
  3049     05  FILLER            PIC  X(0003).
  3050     05  CRTSTATO PIC  X(0010).
  3051*    -------------------------------
  3052     05  FILLER            PIC  X(0003).
  3053     05  EFFECTO PIC  X(0008).
  3054*    -------------------------------
  3055     05  FILLER            PIC  X(0003).
  3056     05  TERMSO PIC  X(0011).
  3057*    -------------------------------
  3058     05  FILLER            PIC  X(0003).
  3059     05  STACCTO PIC  X(0013).
  3060*    -------------------------------
  3061     05  FILLER            PIC  X(0003).
  3062     05  EXPDTEHO PIC  X(0014).
  3063*    -------------------------------
  3064     05  FILLER            PIC  X(0003).
  3065     05  EXPDTEO PIC  X(0008).
  3066*    -------------------------------
  3067     05  FILLER            PIC  X(0003).
  3068     05  BENECAPO PIC  X(0013).
  3069*    -------------------------------
  3070     05  FILLER            PIC  X(0003).
  3071     05  BENEO PIC  Z(6).99.
  3072*    -------------------------------
  3073     05  FILLER            PIC  X(0003).
  3074     05  FORMTYPO PIC  X(0001).
  3075*    -------------------------------
  3076     05  FILLER            PIC  X(0003).
  3077     05  PMTTYPEO PIC  X(0001).
  3078*    -------------------------------
  3079     05  FILLER            PIC  X(0003).
  3080     05  PAYEEO PIC  X(0002).
  3081*    -------------------------------
  3082     05  FILLER            PIC  X(0003).
  3083     05  CHECKNOO PIC  X(0007).
  3084*    -------------------------------
  3085     05  FILLER            PIC  X(0003).
  3086     05  OFFLINEO PIC  X(0001).
  3087*    -------------------------------
  3088     05  FILLER            PIC  X(0003).
  3089     05  HOLDTILO PIC  99B99B99.
  3090*    -------------------------------
  3091     05  FILLER            PIC  X(0003).
  3092     05  NOTE1O PIC  X(0060).
  3093*    -------------------------------
  3094     05  FILLER            PIC  X(0003).
  3095     05  NOTE2O PIC  X(0060).
  3096*    -------------------------------
  3097     05  FILLER            PIC  X(0003).
  3098     05  EOBYNO PIC  X(0001).
  3099*    -------------------------------
  3100     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL156.cbl
  3101     05  CASHHO PIC  X(0011).
  3102*    -------------------------------
  3103     05  FILLER            PIC  X(0003).
  3104     05  CASHO PIC  X(0001).
  3105*    -------------------------------
  3106     05  FILLER            PIC  X(0003).
  3107     05  GROUPHO PIC  X(0010).
  3108*    -------------------------------
  3109     05  FILLER            PIC  X(0003).
  3110     05  GROUPEDO PIC  X(0001).
  3111*    -------------------------------
  3112     05  FILLER            PIC  X(0003).
  3113     05  PINTHO PIC  X(0004).
  3114*    -------------------------------
  3115     05  FILLER            PIC  X(0003).
  3116     05  PINTO PIC  Z,ZZ9.99.
  3117*    -------------------------------
  3118     05  FILLER            PIC  X(0003).
  3119     05  PROOFDTO PIC  99B99B99.
  3120*    -------------------------------
  3121     05  FILLER            PIC  X(0003).
  3122     05  AIGFRMHO PIC  X(0012).
  3123*    -------------------------------
  3124     05  FILLER            PIC  X(0003).
  3125     05  AIGFROMO PIC  99B99B99.
  3126*    -------------------------------
  3127     05  FILLER            PIC  X(0003).
  3128     05  PMTHDGAO PIC  X(0066).
  3129*    -------------------------------
  3130     05  FILLER            PIC  X(0003).
  3131     05  EPYFROMO PIC  99B99B99.
  3132*    -------------------------------
  3133     05  FILLER            PIC  X(0003).
  3134     05  EPYTHRUO PIC  99B99B99.
  3135*    -------------------------------
  3136     05  FILLER            PIC  X(0003).
  3137     05  EDAYSO PIC  Z(4)9-.
  3138*    -------------------------------
  3139     05  FILLER            PIC  X(0003).
  3140     05  EPYAMTO PIC  Z(6).99-.
  3141*    -------------------------------
  3142     05  FILLER            PIC  X(0003).
  3143     05  ERESVO PIC  Z(5).99-.
  3144*    -------------------------------
  3145     05  FILLER            PIC  X(0003).
  3146     05  ETYPEO PIC  X(0001).
  3147*    -------------------------------
  3148     05  FILLER            PIC  X(0003).
  3149     05  EEXPENSO PIC  Z(5).99.
  3150*    -------------------------------
  3151     05  FILLER            PIC  X(0003).
  3152     05  CPYFROMO PIC  99B99B99.
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  CPYTHRUO PIC  99B99B99.
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  CDAYSO PIC  Z(4)9-.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL156.cbl
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  CPYAMTO PIC  Z(6).99-.
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  CRESVO PIC  Z(5).99.
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  CEXPENSO PIC  Z(5).99.
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  ERRMSG0O PIC  X(0072).
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  ERRMSG1O PIC  X(0072).
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  ERRMSG2O PIC  X(0072).
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  ENTERPFO PIC  X(0002).
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  PF6TITO PIC  X(0016).
  3183*    -------------------------------
  3184 01  EL156BI REDEFINES EL156AI.
  3185     05  FILLER            PIC  X(0012).
  3186*    -------------------------------
  3187     05  RUNDTEBL PIC S9(0004) COMP.
  3188     05  RUNDTEBF PIC  X(0001).
  3189     05  FILLER REDEFINES RUNDTEBF.
  3190         10  RUNDTEBA PIC  X(0001).
  3191     05  RUNDTEBI PIC  X(0008).
  3192*    -------------------------------
  3193     05  RUNTIMBL PIC S9(0004) COMP.
  3194     05  RUNTIMBF PIC  X(0001).
  3195     05  FILLER REDEFINES RUNTIMBF.
  3196         10  RUNTIMBA PIC  X(0001).
  3197     05  RUNTIMBI PIC  X(0005).
  3198*    -------------------------------
  3199     05  PAYDTBL PIC S9(0004) COMP.
  3200     05  PAYDTBF PIC  X(0001).
  3201     05  FILLER REDEFINES PAYDTBF.
  3202         10  PAYDTBA PIC  X(0001).
  3203     05  PAYDTBI PIC  X(0008).
  3204*    -------------------------------
  3205     05  PAYTYPBL PIC S9(0004) COMP.
  3206     05  PAYTYPBF PIC  X(0001).
  3207     05  FILLER REDEFINES PAYTYPBF.
  3208         10  PAYTYPBA PIC  X(0001).
  3209     05  PAYTYPBI PIC  X(0015).
  3210*    -------------------------------
  3211     05  PAYAMTBL PIC S9(0004) COMP.
  3212     05  PAYAMTBF PIC  X(0001).
  3213     05  FILLER REDEFINES PAYAMTBF.
  3214         10  PAYAMTBA PIC  X(0001).
  3215     05  PAYAMTBI PIC  X(0011).
  3216*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL156.cbl
  3217     05  LOANHBL PIC S9(0004) COMP.
  3218     05  LOANHBF PIC  X(0001).
  3219     05  FILLER REDEFINES LOANHBF.
  3220         10  LOANHBA PIC  X(0001).
  3221     05  LOANHBI PIC  X(0012).
  3222*    -------------------------------
  3223     05  LOANNBL PIC S9(0004) COMP.
  3224     05  LOANNBF PIC  X(0001).
  3225     05  FILLER REDEFINES LOANNBF.
  3226         10  LOANNBA PIC  X(0001).
  3227     05  LOANNBI PIC  X(0025).
  3228*    -------------------------------
  3229     05  CKNUMHDL PIC S9(0004) COMP.
  3230     05  CKNUMHDF PIC  X(0001).
  3231     05  FILLER REDEFINES CKNUMHDF.
  3232         10  CKNUMHDA PIC  X(0001).
  3233     05  CKNUMHDI PIC  X(0012).
  3234*    -------------------------------
  3235     05  CKNUMBL PIC S9(0004) COMP.
  3236     05  CKNUMBF PIC  X(0001).
  3237     05  FILLER REDEFINES CKNUMBF.
  3238         10  CKNUMBA PIC  X(0001).
  3239     05  CKNUMBI PIC  X(0007).
  3240*    -------------------------------
  3241     05  AGTHDGL PIC S9(0004) COMP.
  3242     05  AGTHDGF PIC  X(0001).
  3243     05  FILLER REDEFINES AGTHDGF.
  3244         10  AGTHDGA PIC  X(0001).
  3245     05  AGTHDGI PIC  X(0016).
  3246*    -------------------------------
  3247     05  NAMEBL PIC S9(0004) COMP.
  3248     05  NAMEBF PIC  X(0001).
  3249     05  FILLER REDEFINES NAMEBF.
  3250         10  NAMEBA PIC  X(0001).
  3251     05  NAMEBI PIC  X(0030).
  3252*    -------------------------------
  3253     05  NAMEB2L PIC S9(0004) COMP.
  3254     05  NAMEB2F PIC  X(0001).
  3255     05  FILLER REDEFINES NAMEB2F.
  3256         10  NAMEB2A PIC  X(0001).
  3257     05  NAMEB2I PIC  X(0030).
  3258*    -------------------------------
  3259     05  ADDR1BL PIC S9(0004) COMP.
  3260     05  ADDR1BF PIC  X(0001).
  3261     05  FILLER REDEFINES ADDR1BF.
  3262         10  ADDR1BA PIC  X(0001).
  3263     05  ADDR1BI PIC  X(0030).
  3264*    -------------------------------
  3265     05  ADDR1B2L PIC S9(0004) COMP.
  3266     05  ADDR1B2F PIC  X(0001).
  3267     05  FILLER REDEFINES ADDR1B2F.
  3268         10  ADDR1B2A PIC  X(0001).
  3269     05  ADDR1B2I PIC  X(0030).
  3270*    -------------------------------
  3271     05  ADDR2BL PIC S9(0004) COMP.
  3272     05  ADDR2BF PIC  X(0001).
  3273     05  FILLER REDEFINES ADDR2BF.
  3274         10  ADDR2BA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL156.cbl
  3275     05  ADDR2BI PIC  X(0030).
  3276*    -------------------------------
  3277     05  ADDR2B2L PIC S9(0004) COMP.
  3278     05  ADDR2B2F PIC  X(0001).
  3279     05  FILLER REDEFINES ADDR2B2F.
  3280         10  ADDR2B2A PIC  X(0001).
  3281     05  ADDR2B2I PIC  X(0030).
  3282*    -------------------------------
  3283     05  CITYSTBL PIC S9(0004) COMP.
  3284     05  CITYSTBF PIC  X(0001).
  3285     05  FILLER REDEFINES CITYSTBF.
  3286         10  CITYSTBA PIC  X(0001).
  3287     05  CITYSTBI PIC  X(0030).
  3288*    -------------------------------
  3289     05  CITYST2L PIC S9(0004) COMP.
  3290     05  CITYST2F PIC  X(0001).
  3291     05  FILLER REDEFINES CITYST2F.
  3292         10  CITYST2A PIC  X(0001).
  3293     05  CITYST2I PIC  X(0030).
  3294*    -------------------------------
  3295     05  ZIPBL PIC S9(0004) COMP.
  3296     05  ZIPBF PIC  X(0001).
  3297     05  FILLER REDEFINES ZIPBF.
  3298         10  ZIPBA PIC  X(0001).
  3299     05  ZIPBI PIC  X(0009).
  3300*    -------------------------------
  3301     05  ZIPB2L PIC S9(0004) COMP.
  3302     05  ZIPB2F PIC  X(0001).
  3303     05  FILLER REDEFINES ZIPB2F.
  3304         10  ZIPB2A PIC  X(0001).
  3305     05  ZIPB2I PIC  X(0009).
  3306*    -------------------------------
  3307     05  INTHDBL PIC S9(0004) COMP.
  3308     05  INTHDBF PIC  X(0001).
  3309     05  FILLER REDEFINES INTHDBF.
  3310         10  INTHDBA PIC  X(0001).
  3311     05  INTHDBI PIC  X(0012).
  3312*    -------------------------------
  3313     05  INTAMTBL PIC S9(0004) COMP.
  3314     05  INTAMTBF PIC  X(0001).
  3315     05  FILLER REDEFINES INTAMTBF.
  3316         10  INTAMTBA PIC  X(0001).
  3317     05  INTAMTBI PIC  X(0011).
  3318*    -------------------------------
  3319     05  PMTHDGBL PIC S9(0004) COMP.
  3320     05  PMTHDGBF PIC  X(0001).
  3321     05  FILLER REDEFINES PMTHDGBF.
  3322         10  PMTHDGBA PIC  X(0001).
  3323     05  PMTHDGBI PIC  X(0034).
  3324*    -------------------------------
  3325     05  CLMNOBL PIC S9(0004) COMP.
  3326     05  CLMNOBF PIC  X(0001).
  3327     05  FILLER REDEFINES CLMNOBF.
  3328         10  CLMNOBA PIC  X(0001).
  3329     05  CLMNOBI PIC  X(0007).
  3330*    -------------------------------
  3331     05  CARRBL PIC S9(0004) COMP.
  3332     05  CARRBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL156.cbl
  3333     05  FILLER REDEFINES CARRBF.
  3334         10  CARRBA PIC  X(0001).
  3335     05  CARRBI PIC  X(0001).
  3336*    -------------------------------
  3337     05  CERTNOBL PIC S9(0004) COMP.
  3338     05  CERTNOBF PIC  X(0001).
  3339     05  FILLER REDEFINES CERTNOBF.
  3340         10  CERTNOBA PIC  X(0001).
  3341     05  CERTNOBI PIC  X(0010).
  3342*    -------------------------------
  3343     05  SUFXBL PIC S9(0004) COMP.
  3344     05  SUFXBF PIC  X(0001).
  3345     05  FILLER REDEFINES SUFXBF.
  3346         10  SUFXBA PIC  X(0001).
  3347     05  SUFXBI PIC  X(0001).
  3348*    -------------------------------
  3349     05  CLMTYPBL PIC S9(0004) COMP.
  3350     05  CLMTYPBF PIC  X(0001).
  3351     05  FILLER REDEFINES CLMTYPBF.
  3352         10  CLMTYPBA PIC  X(0001).
  3353     05  CLMTYPBI PIC  X(0006).
  3354*    -------------------------------
  3355     05  INCURBL PIC S9(0004) COMP.
  3356     05  INCURBF PIC  X(0001).
  3357     05  FILLER REDEFINES INCURBF.
  3358         10  INCURBA PIC  X(0001).
  3359     05  INCURBI PIC  X(0008).
  3360*    -------------------------------
  3361     05  PYFROMBL PIC S9(0004) COMP.
  3362     05  PYFROMBF PIC  X(0001).
  3363     05  FILLER REDEFINES PYFROMBF.
  3364         10  PYFROMBA PIC  X(0001).
  3365     05  PYFROMBI PIC  X(0008).
  3366*    -------------------------------
  3367     05  PYTHRUBL PIC S9(0004) COMP.
  3368     05  PYTHRUBF PIC  X(0001).
  3369     05  FILLER REDEFINES PYTHRUBF.
  3370         10  PYTHRUBA PIC  X(0001).
  3371     05  PYTHRUBI PIC  X(0008).
  3372*    -------------------------------
  3373     05  DAYSBL PIC S9(0004) COMP.
  3374     05  DAYSBF PIC  X(0001).
  3375     05  FILLER REDEFINES DAYSBF.
  3376         10  DAYSBA PIC  X(0001).
  3377     05  DAYSBI PIC  X(0005).
  3378*    -------------------------------
  3379     05  BYBL PIC S9(0004) COMP.
  3380     05  BYBF PIC  X(0001).
  3381     05  FILLER REDEFINES BYBF.
  3382         10  BYBA PIC  X(0001).
  3383     05  BYBI PIC  X(0004).
  3384*    -------------------------------
  3385     05  PROOFDBL PIC S9(0004) COMP.
  3386     05  PROOFDBF PIC  X(0001).
  3387     05  FILLER REDEFINES PROOFDBF.
  3388         10  PROOFDBA PIC  X(0001).
  3389     05  PROOFDBI PIC  X(0008).
  3390*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL156.cbl
  3391     05  ACCTBL PIC S9(0004) COMP.
  3392     05  ACCTBF PIC  X(0001).
  3393     05  FILLER REDEFINES ACCTBF.
  3394         10  ACCTBA PIC  X(0001).
  3395     05  ACCTBI PIC  X(0010).
  3396*    -------------------------------
  3397     05  STATEBL PIC S9(0004) COMP.
  3398     05  STATEBF PIC  X(0001).
  3399     05  FILLER REDEFINES STATEBF.
  3400         10  STATEBA PIC  X(0001).
  3401     05  STATEBI PIC  X(0002).
  3402*    -------------------------------
  3403     05  GROUPBL PIC S9(0004) COMP.
  3404     05  GROUPBF PIC  X(0001).
  3405     05  FILLER REDEFINES GROUPBF.
  3406         10  GROUPBA PIC  X(0001).
  3407     05  GROUPBI PIC  X(0006).
  3408*    -------------------------------
  3409     05  ACARRBL PIC S9(0004) COMP.
  3410     05  ACARRBF PIC  X(0001).
  3411     05  FILLER REDEFINES ACARRBF.
  3412         10  ACARRBA PIC  X(0001).
  3413     05  ACARRBI PIC  X(0001).
  3414*    -------------------------------
  3415     05  ACCTNMBL PIC S9(0004) COMP.
  3416     05  ACCTNMBF PIC  X(0001).
  3417     05  FILLER REDEFINES ACCTNMBF.
  3418         10  ACCTNMBA PIC  X(0001).
  3419     05  ACCTNMBI PIC  X(0030).
  3420*    -------------------------------
  3421     05  UNDISBL PIC S9(0004) COMP.
  3422     05  UNDISBF PIC  X(0001).
  3423     05  FILLER REDEFINES UNDISBF.
  3424         10  UNDISBA PIC  X(0001).
  3425     05  UNDISBI PIC  X(0010).
  3426*    -------------------------------
  3427     05  RATEBL PIC S9(0004) COMP.
  3428     05  RATEBF PIC  X(0001).
  3429     05  FILLER REDEFINES RATEBF.
  3430         10  RATEBA PIC  X(0001).
  3431     05  RATEBI PIC  X(0006).
  3432*    -------------------------------
  3433     05  ERMSG1BL PIC S9(0004) COMP.
  3434     05  ERMSG1BF PIC  X(0001).
  3435     05  FILLER REDEFINES ERMSG1BF.
  3436         10  ERMSG1BA PIC  X(0001).
  3437     05  ERMSG1BI PIC  X(0072).
  3438*    -------------------------------
  3439     05  ENTPFBL PIC S9(0004) COMP.
  3440     05  ENTPFBF PIC  X(0001).
  3441     05  FILLER REDEFINES ENTPFBF.
  3442         10  ENTPFBA PIC  X(0001).
  3443     05  ENTPFBI PIC  99.
  3444 01  EL156BO REDEFINES EL156AI.
  3445     05  FILLER            PIC  X(0012).
  3446*    -------------------------------
  3447     05  FILLER            PIC  X(0003).
  3448     05  RUNDTEBO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL156.cbl
  3449*    -------------------------------
  3450     05  FILLER            PIC  X(0003).
  3451     05  RUNTIMBO PIC  99.99.
  3452*    -------------------------------
  3453     05  FILLER            PIC  X(0003).
  3454     05  PAYDTBO PIC  99B99B99.
  3455*    -------------------------------
  3456     05  FILLER            PIC  X(0003).
  3457     05  PAYTYPBO PIC  X(0015).
  3458*    -------------------------------
  3459     05  FILLER            PIC  X(0003).
  3460     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3461*    -------------------------------
  3462     05  FILLER            PIC  X(0003).
  3463     05  LOANHBO PIC  X(0012).
  3464*    -------------------------------
  3465     05  FILLER            PIC  X(0003).
  3466     05  LOANNBO PIC  X(0025).
  3467*    -------------------------------
  3468     05  FILLER            PIC  X(0003).
  3469     05  CKNUMHDO PIC  X(0012).
  3470*    -------------------------------
  3471     05  FILLER            PIC  X(0003).
  3472     05  CKNUMBO PIC  X(0007).
  3473*    -------------------------------
  3474     05  FILLER            PIC  X(0003).
  3475     05  AGTHDGO PIC  X(0016).
  3476*    -------------------------------
  3477     05  FILLER            PIC  X(0003).
  3478     05  NAMEBO PIC  X(0030).
  3479*    -------------------------------
  3480     05  FILLER            PIC  X(0003).
  3481     05  NAMEB2O PIC  X(0030).
  3482*    -------------------------------
  3483     05  FILLER            PIC  X(0003).
  3484     05  ADDR1BO PIC  X(0030).
  3485*    -------------------------------
  3486     05  FILLER            PIC  X(0003).
  3487     05  ADDR1B2O PIC  X(0030).
  3488*    -------------------------------
  3489     05  FILLER            PIC  X(0003).
  3490     05  ADDR2BO PIC  X(0030).
  3491*    -------------------------------
  3492     05  FILLER            PIC  X(0003).
  3493     05  ADDR2B2O PIC  X(0030).
  3494*    -------------------------------
  3495     05  FILLER            PIC  X(0003).
  3496     05  CITYSTBO PIC  X(0030).
  3497*    -------------------------------
  3498     05  FILLER            PIC  X(0003).
  3499     05  CITYST2O PIC  X(0030).
  3500*    -------------------------------
  3501     05  FILLER            PIC  X(0003).
  3502     05  ZIPBO PIC  ZZZZ99999.
  3503*    -------------------------------
  3504     05  FILLER            PIC  X(0003).
  3505     05  ZIPB2O PIC  ZZZZZZZZZ.
  3506*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL156.cbl
  3507     05  FILLER            PIC  X(0003).
  3508     05  INTHDBO PIC  X(0012).
  3509*    -------------------------------
  3510     05  FILLER            PIC  X(0003).
  3511     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3512*    -------------------------------
  3513     05  FILLER            PIC  X(0003).
  3514     05  PMTHDGBO PIC  X(0034).
  3515*    -------------------------------
  3516     05  FILLER            PIC  X(0003).
  3517     05  CLMNOBO PIC  X(0007).
  3518*    -------------------------------
  3519     05  FILLER            PIC  X(0003).
  3520     05  CARRBO PIC  X(0001).
  3521*    -------------------------------
  3522     05  FILLER            PIC  X(0003).
  3523     05  CERTNOBO PIC  X(0010).
  3524*    -------------------------------
  3525     05  FILLER            PIC  X(0003).
  3526     05  SUFXBO PIC  X(0001).
  3527*    -------------------------------
  3528     05  FILLER            PIC  X(0003).
  3529     05  CLMTYPBO PIC  X(0006).
  3530*    -------------------------------
  3531     05  FILLER            PIC  X(0003).
  3532     05  INCURBO PIC  X(0008).
  3533*    -------------------------------
  3534     05  FILLER            PIC  X(0003).
  3535     05  PYFROMBO PIC  99B99B99.
  3536*    -------------------------------
  3537     05  FILLER            PIC  X(0003).
  3538     05  PYTHRUBO PIC  99B99B99.
  3539*    -------------------------------
  3540     05  FILLER            PIC  X(0003).
  3541     05  DAYSBO PIC  X(0005).
  3542*    -------------------------------
  3543     05  FILLER            PIC  X(0003).
  3544     05  BYBO PIC  X(0004).
  3545*    -------------------------------
  3546     05  FILLER            PIC  X(0003).
  3547     05  PROOFDBO PIC  99B99B99.
  3548*    -------------------------------
  3549     05  FILLER            PIC  X(0003).
  3550     05  ACCTBO PIC  X(0010).
  3551*    -------------------------------
  3552     05  FILLER            PIC  X(0003).
  3553     05  STATEBO PIC  X(0002).
  3554*    -------------------------------
  3555     05  FILLER            PIC  X(0003).
  3556     05  GROUPBO PIC  X(0006).
  3557*    -------------------------------
  3558     05  FILLER            PIC  X(0003).
  3559     05  ACARRBO PIC  X(0001).
  3560*    -------------------------------
  3561     05  FILLER            PIC  X(0003).
  3562     05  ACCTNMBO PIC  X(0030).
  3563*    -------------------------------
  3564     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL156.cbl
  3565     05  UNDISBO PIC  ZZZ,Z99.99.
  3566*    -------------------------------
  3567     05  FILLER            PIC  X(0003).
  3568     05  RATEBO PIC  ZZZ.99.
  3569*    -------------------------------
  3570     05  FILLER            PIC  X(0003).
  3571     05  ERMSG1BO PIC  X(0072).
  3572*    -------------------------------
  3573     05  FILLER            PIC  X(0003).
  3574     05  ENTPFBO PIC  X(0002).
  3575*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL156.cbl
  3577****************************************************************
  3578*
  3579* Copyright (c) 2007 by Clerity Solutions, Inc.
  3580* All rights reserved.
  3581*
  3582****************************************************************
  3583 01  DFHEIV.
  3584   02  DFHEIV0               PIC X(35).
  3585   02  DFHEIV1               PIC X(08).
  3586   02  DFHEIV2               PIC X(08).
  3587   02  DFHEIV3               PIC X(08).
  3588   02  DFHEIV4               PIC X(06).
  3589   02  DFHEIV5               PIC X(04).
  3590   02  DFHEIV6               PIC X(04).
  3591   02  DFHEIV7               PIC X(02).
  3592   02  DFHEIV8               PIC X(02).
  3593   02  DFHEIV9               PIC X(01).
  3594   02  DFHEIV10              PIC S9(7) COMP-3.
  3595   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3596   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3597   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3598   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3599   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3600   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3601   02  DFHEIV17              PIC X(04).
  3602   02  DFHEIV18              PIC X(04).
  3603   02  DFHEIV19              PIC X(04).
  3604   02  DFHEIV20              USAGE IS POINTER.
  3605   02  DFHEIV21              USAGE IS POINTER.
  3606   02  DFHEIV22              USAGE IS POINTER.
  3607   02  DFHEIV23              USAGE IS POINTER.
  3608   02  DFHEIV24              USAGE IS POINTER.
  3609   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3610   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3611   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3612   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3613   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3614   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3615   02  FILLER                PIC X(02).
  3616   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3617   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3618   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3619   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3620   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3621 LINKAGE  SECTION.
  3622*****************************************************************
  3623*                                                               *
  3624* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3625* All rights reserved.                                          *
  3626*                                                               *
  3627*****************************************************************
  3628 01  dfheiblk.
  3629     02  eibtime          pic s9(7) comp-3.
  3630     02  eibdate          pic s9(7) comp-3.
  3631     02  eibtrnid         pic x(4).
  3632     02  eibtaskn         pic s9(7) comp-3.
  3633     02  eibtrmid         pic x(4).
  3634     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL156.cbl
  3635     02  eibcposn         pic s9(4) comp.
  3636     02  eibcalen         pic s9(4) comp.
  3637     02  eibaid           pic x(1).
  3638     02  eibfiller1       pic x(1).
  3639     02  eibfn            pic x(2).
  3640     02  eibfiller2       pic x(2).
  3641     02  eibrcode         pic x(6).
  3642     02  eibfiller3       pic x(2).
  3643     02  eibds            pic x(8).
  3644     02  eibreqid         pic x(8).
  3645     02  eibrsrce         pic x(8).
  3646     02  eibsync          pic x(1).
  3647     02  eibfree          pic x(1).
  3648     02  eibrecv          pic x(1).
  3649     02  eibsend          pic x(1).
  3650     02  eibatt           pic x(1).
  3651     02  eibeoc           pic x(1).
  3652     02  eibfmh           pic x(1).
  3653     02  eibcompl         pic x(1).
  3654     02  eibsig           pic x(1).
  3655     02  eibconf          pic x(1).
  3656     02  eiberr           pic x(1).
  3657     02  eibrldbk         pic x(1).
  3658     02  eiberrcd         pic x(4).
  3659     02  eibsynrb         pic x(1).
  3660     02  eibnodat         pic x(1).
  3661     02  eibfiller5       pic x(2).
  3662     02  eibresp          pic 9(09) comp.
  3663     02  eibresp2         pic 9(09) comp.
  3664     02  dfheigdj         pic s9(4) comp.
  3665     02  dfheigdk         pic s9(4) comp.
  3666 01  DFHCOMMAREA             PIC X(1024).
  3667
  3668*    COPY ELCMSTR.
  3669******************************************************************
  3670*                                                                *
  3671*                            ELCMSTR.                            *
  3672*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3673*                            VMOD=2.012                          *
  3674*                                                                *
  3675*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3676*                                                                *
  3677*   FILE TYPE = VSAM,KSDS                                        *
  3678*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3679*                                                                *
  3680*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3681*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3682*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3683*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3684*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3685*                                                 RKP=75,LEN=21  *
  3686*                                                                *
  3687*   **** NOTE ****                                               *
  3688*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3689*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3690*                                                                *
  3691*   LOG = YES                                                    *
  3692*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL156.cbl
  3693******************************************************************
  3694*                   C H A N G E   L O G
  3695*
  3696* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3697*-----------------------------------------------------------------
  3698*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3699* EFFECTIVE    NUMBER
  3700*-----------------------------------------------------------------
  3701* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3702* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3703******************************************************************
  3704 01  CLAIM-MASTER.
  3705     12  CL-RECORD-ID                PIC XX.
  3706         88  VALID-CL-ID         VALUE 'CL'.
  3707
  3708     12  CL-CONTROL-PRIMARY.
  3709         16  CL-COMPANY-CD           PIC X.
  3710         16  CL-CARRIER              PIC X.
  3711         16  CL-CLAIM-NO             PIC X(7).
  3712         16  CL-CERT-NO.
  3713             20  CL-CERT-PRIME       PIC X(10).
  3714             20  CL-CERT-SFX         PIC X.
  3715
  3716     12  CL-CONTROL-BY-NAME.
  3717         16  CL-COMPANY-CD-A1        PIC X.
  3718         16  CL-INSURED-LAST-NAME    PIC X(15).
  3719         16  CL-INSURED-NAME.
  3720             20  CL-INSURED-1ST-NAME PIC X(12).
  3721             20  CL-INSURED-MID-INIT PIC X.
  3722
  3723     12  CL-CONTROL-BY-SSN.
  3724         16  CL-COMPANY-CD-A2        PIC X.
  3725         16  CL-SOC-SEC-NO.
  3726             20  CL-SSN-STATE        PIC XX.
  3727             20  CL-SSN-ACCOUNT      PIC X(6).
  3728             20  CL-SSN-LN3          PIC X(3).
  3729
  3730     12  CL-CONTROL-BY-CERT-NO.
  3731         16  CL-COMPANY-CD-A4        PIC X.
  3732         16  CL-CERT-NO-A4.
  3733             20  CL-CERT-A4-PRIME    PIC X(10).
  3734             20  CL-CERT-A4-SFX      PIC X.
  3735
  3736     12  CL-CONTROL-BY-CCN.
  3737         16  CL-COMPANY-CD-A5        PIC X.
  3738         16  CL-CCN-A5.
  3739             20  CL-CCN.
  3740                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3741                 24  CL-CCN-PRIME-A5 PIC X(12).
  3742             20  CL-CCN-FILLER-A5    PIC X(4).
  3743
  3744     12  CL-INSURED-PROFILE-DATA.
  3745         16  CL-INSURED-BIRTH-DT     PIC XX.
  3746         16  CL-INSURED-SEX-CD       PIC X.
  3747             88  INSURED-IS-MALE        VALUE 'M'.
  3748             88  INSURED-IS-FEMALE      VALUE 'F'.
  3749             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3750         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL156.cbl
  3751         16  FILLER                  PIC X(5).
  3752
  3753     12  CL-PROCESSING-INFO.
  3754         16  CL-PROCESSOR-ID         PIC X(4).
  3755         16  CL-CLAIM-STATUS         PIC X.
  3756             88  CLAIM-IS-OPEN          VALUE 'O'.
  3757             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3758         16  CL-CLAIM-TYPE           PIC X.
  3759*            88  AH-CLAIM               VALUE 'A'.
  3760*            88  LIFE-CLAIM             VALUE 'L'.
  3761*            88  PROPERTY-CLAIM         VALUE 'P'.
  3762*            88  IUI-CLAIM              VALUE 'I'.
  3763*            88  GAP-CLAIM              VALUE 'G'.
  3764         16  CL-CLAIM-PREM-TYPE      PIC X.
  3765             88  SINGLE-PREMIUM         VALUE '1'.
  3766             88  O-B-COVERAGE           VALUE '2'.
  3767             88  OPEN-END-COVERAGE      VALUE '3'.
  3768         16  CL-INCURRED-DT          PIC XX.
  3769         16  CL-REPORTED-DT          PIC XX.
  3770         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3771         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3772         16  CL-LAST-PMT-DT          PIC XX.
  3773         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3774         16  CL-PAID-THRU-DT         PIC XX.
  3775         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3776         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3777         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3778         16  CL-PMT-CALC-METHOD      PIC X.
  3779             88  CL-360-DAY-YR          VALUE '1'.
  3780             88  CL-365-DAY-YR          VALUE '2'.
  3781             88  CL-FULL-MONTHS         VALUE '3'.
  3782         16  CL-CAUSE-CD             PIC X(6).
  3783
  3784         16  CL-PRIME-CERT-NO.
  3785             20  CL-PRIME-CERT-PRIME PIC X(10).
  3786             20  CL-PRIME-CERT-SFX   PIC X.
  3787
  3788         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3789             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3790             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3791
  3792         16  CL-MICROFILM-NO         PIC X(10).
  3793         16  CL-PROG-FORM-TYPE       PIC X.
  3794         16  CL-LAST-ADD-ON-DT       PIC XX.
  3795
  3796         16  CL-LAST-REOPEN-DT       PIC XX.
  3797         16  CL-LAST-CLOSE-DT        PIC XX.
  3798         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3799             88  FINAL-PAID             VALUE '1'.
  3800             88  CLAIM-DENIED           VALUE '2'.
  3801             88  AUTO-CLOSE             VALUE '3'.
  3802             88  MANUAL-CLOSE           VALUE '4'.
  3803             88  BENEFITS-CHANGED       VALUE 'C'.
  3804             88  SETUP-ERRORS           VALUE 'E'.
  3805         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3806         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3807         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3808             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL156.cbl
  3809         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3810         16  FILLER                  PIC X.
  3811
  3812     12  CL-CERTIFICATE-DATA.
  3813         16  CL-CERT-ORIGIN          PIC X.
  3814             88  CERT-WAS-ONLINE        VALUE '1'.
  3815             88  CERT-WAS-CREATED       VALUE '2'.
  3816             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3817         16  CL-CERT-KEY-DATA.
  3818             20  CL-CERT-CARRIER     PIC X.
  3819             20  CL-CERT-GROUPING    PIC X(6).
  3820             20  CL-CERT-STATE       PIC XX.
  3821             20  CL-CERT-ACCOUNT.
  3822                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3823                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3824             20  CL-CERT-EFF-DT      PIC XX.
  3825
  3826     12  CL-STATUS-CONTROLS.
  3827         16  CL-PRIORITY-CD          PIC X.
  3828             88  CONFIDENTIAL-DATA      VALUE '8'.
  3829             88  HIGHEST-PRIORITY       VALUE '9'.
  3830         16  CL-SUPV-ATTN-CD         PIC X.
  3831             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3832             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3833         16  CL-PURGED-DT            PIC XX.
  3834         16  CL-RESTORED-DT          PIC XX.
  3835         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3836         16  CL-NEXT-RESEND-DT       PIC XX.
  3837         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3838         16  FILLER                  PIC XX.
  3839         16  CL-LAST-MAINT-DT        PIC XX.
  3840         16  CL-LAST-MAINT-USER      PIC X(4).
  3841         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3842         16  CL-LAST-MAINT-TYPE      PIC X.
  3843             88  CLAIM-SET-UP           VALUE ' '.
  3844             88  PAYMENT-MADE           VALUE '1'.
  3845             88  LETTER-SENT            VALUE '2'.
  3846             88  MASTER-WAS-ALTERED     VALUE '3'.
  3847             88  MASTER-WAS-RESTORED    VALUE '4'.
  3848             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3849             88  FILE-CONVERTED         VALUE '6'.
  3850             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3851             88  ERROR-CORRECTION       VALUE 'E'.
  3852         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3853         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3854         16  CL-BENEFICIARY          PIC X(10).
  3855         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3856         16  CL-DENIAL-TYPE          PIC X.
  3857             88  CL-TYPE-DENIAL          VALUE '1'.
  3858             88  CL-TYPE-RESCISSION      VALUE '2'.
  3859             88  CL-TYPE-REFORMATION     VALUE '3'.
  3860             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3861             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3862         16  FILLER                  PIC X(5).
  3863
  3864     12  CL-TRAILER-CONTROLS.
  3865         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3866             88  CL-1ST-TRL-AVAIL       VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL156.cbl
  3867             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3868             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3869         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3870         16  FILLER                  PIC XX.
  3871         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3872         16  CL-ADDRESS-TRAILER-CNT.
  3873             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3874                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3875             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3876                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3877             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3878                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3879             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3880                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3881             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3882                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3883             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3884                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3885             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3886                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3887
  3888     12  CL-CV-REFERENCE-NO.
  3889         16  CL-CV-REFNO-PRIME       PIC X(18).
  3890         16  CL-CV-REFNO-SFX         PIC XX.
  3891
  3892     12  CL-FILE-LOCATION            PIC X(4).
  3893
  3894     12  CL-PROCESS-ERRORS.
  3895         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3896             88  NO-FATAL-ERRORS        VALUE ZERO.
  3897         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3898             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3899
  3900     12  CL-PRODUCT-CD               PIC X.
  3901
  3902     12  CL-CURRENT-KEY-DATA.
  3903         16  CL-CURRENT-CARRIER      PIC X.
  3904         16  CL-CURRENT-GROUPING     PIC X(6).
  3905         16  CL-CURRENT-STATE        PIC XX.
  3906         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3907
  3908     12  CL-ASSOCIATES               PIC X.
  3909         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3910         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3911         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3912         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3913
  3914     12  CL-ACTIVITY-CODE            PIC 99.
  3915     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3916     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3917
  3918     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3919     12  CL-LAG-REPORT-CODE          PIC 9.
  3920     12  CL-LOAN-TYPE                PIC XX.
  3921     12  CL-LEGAL-STATE              PIC XX.
  3922
  3923*    12  FILLER                      PIC X(5).
  3924     12  CL-YESNOSW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL156.cbl
  3925     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL156.cbl
  3927*    COPY ELCCNTL.
  3928******************************************************************
  3929*                                                                *
  3930*                                                                *
  3931*                            ELCCNTL.                            *
  3932*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3933*                            VMOD=2.059                          *
  3934*                                                                *
  3935*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3936*                                                                *
  3937*   FILE TYPE = VSAM,KSDS                                        *
  3938*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3939*                                                                *
  3940*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3941*       ALTERNATE INDEX = NONE                                   *
  3942*                                                                *
  3943*   LOG = YES                                                    *
  3944*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3945******************************************************************
  3946*                   C H A N G E   L O G
  3947*
  3948* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3949*-----------------------------------------------------------------
  3950*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3951* EFFECTIVE    NUMBER
  3952*-----------------------------------------------------------------
  3953* 082503                   PEMA  ADD BENEFIT GROUP
  3954* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3955* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3956* 092705    2005050300006  PEMA  ADD SPP LEASES
  3957* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3958* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3959* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3960* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3961* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3962******************************************************************
  3963*
  3964 01  CONTROL-FILE.
  3965     12  CF-RECORD-ID                       PIC XX.
  3966         88  VALID-CF-ID                        VALUE 'CF'.
  3967
  3968     12  CF-CONTROL-PRIMARY.
  3969         16  CF-COMPANY-ID                  PIC XXX.
  3970         16  CF-RECORD-TYPE                 PIC X.
  3971             88  CF-COMPANY-MASTER              VALUE '1'.
  3972             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3973             88  CF-STATE-MASTER                VALUE '3'.
  3974             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3975             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3976             88  CF-CARRIER-MASTER              VALUE '6'.
  3977             88  CF-MORTALITY-MASTER            VALUE '7'.
  3978             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3979             88  CF-TERMINAL-MASTER             VALUE '9'.
  3980             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3981             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3982             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3983             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3984             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL156.cbl
  3985             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3986             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3987             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3988             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3989         16  CF-ACCESS-CD-GENL              PIC X(4).
  3990         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3991             20  CF-PROCESSOR               PIC X(4).
  3992         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3993             20  CF-STATE-CODE              PIC XX.
  3994             20  FILLER                     PIC XX.
  3995         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3996             20  FILLER                     PIC XX.
  3997             20  CF-HI-BEN-IN-REC           PIC XX.
  3998         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3999             20  FILLER                     PIC XXX.
  4000             20  CF-CARRIER-CNTL            PIC X.
  4001         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4002             20  FILLER                     PIC XX.
  4003             20  CF-HI-TYPE-IN-REC          PIC 99.
  4004         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4005             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4006                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4007             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4008             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4009         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4010             20  FILLER                     PIC X.
  4011             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4012         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4013             20  FILLER                     PIC XX.
  4014             20  CF-MORTGAGE-PLAN           PIC XX.
  4015         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4016
  4017     12  CF-LAST-MAINT-DT                   PIC XX.
  4018     12  CF-LAST-MAINT-BY                   PIC X(4).
  4019     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4020
  4021     12  CF-RECORD-BODY                     PIC X(728).
  4022
  4023
  4024****************************************************************
  4025*             COMPANY MASTER RECORD                            *
  4026****************************************************************
  4027
  4028     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4029         16  CF-COMPANY-ADDRESS.
  4030             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4031             20  CF-CL-IN-CARE-OF           PIC X(30).
  4032             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4033             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4034             20  CF-CL-CITY-STATE           PIC X(30).
  4035             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4036             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4037         16  CF-COMPANY-CD                  PIC X.
  4038         16  CF-COMPANY-PASSWORD            PIC X(8).
  4039         16  CF-SECURITY-OPTION             PIC X.
  4040             88  ALL-SECURITY                   VALUE '1'.
  4041             88  COMPANY-VERIFY                 VALUE '2'.
  4042             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL156.cbl
  4043             88  NO-SECURITY                    VALUE '4'.
  4044             88  ALL-BUT-TERM                   VALUE '5'.
  4045         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4046             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4047         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4048             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4049         16  CF-INFORCE-LOCATION            PIC X.
  4050             88  CERTS-ARE-ONLINE               VALUE '1'.
  4051             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4052             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4053         16  CF-LOWER-CASE-LETTERS          PIC X.
  4054         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4055             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4056             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4057             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4058             88  CF-ACCNT-CNTL                  VALUE '3'.
  4059             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4060
  4061         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4062         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4063
  4064         16  CF-LGX-CREDIT-USER             PIC X.
  4065             88  CO-IS-NOT-USER                 VALUE 'N'.
  4066             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4067
  4068         16 CF-CREDIT-CALC-CODES.
  4069             20  CF-CR-REM-TERM-CALC PIC X.
  4070               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4071               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4072               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4073               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4074               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4075               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4076               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4077             20  CF-CR-R78-METHOD           PIC X.
  4078               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4079               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4080
  4081         16  CF-CLAIM-CONTROL-COUNTS.
  4082             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4083                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4084
  4085             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4086                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4087
  4088             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4089                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4090
  4091             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4092                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4093
  4094         16  CF-CURRENT-MONTH-END           PIC XX.
  4095
  4096         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4097             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4098             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4099             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4100             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL156.cbl
  4101                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4102                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4103             20  CF-CO-PREM-REJECT-SW       PIC X.
  4104                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4105                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4106             20  CF-CO-REF-REJECT-SW        PIC X.
  4107                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4108                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4109
  4110         16  CF-CO-REPORTING-DT             PIC XX.
  4111         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4112         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4113           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4114           88  CF-CO-MONTH-END                  VALUE '1'.
  4115
  4116         16  CF-LGX-CLAIM-USER              PIC X.
  4117             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4118             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4119
  4120         16  CF-CREDIT-EDIT-CONTROLS.
  4121             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4122             20  CF-MIN-AGE                 PIC 99.
  4123             20  CF-DEFAULT-AGE             PIC 99.
  4124             20  CF-MIN-TERM                PIC S999      COMP-3.
  4125             20  CF-MAX-TERM                PIC S999      COMP-3.
  4126             20  CF-DEFAULT-SEX             PIC X.
  4127             20  CF-JOINT-AGE-INPUT         PIC X.
  4128                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4129             20  CF-BIRTH-DATE-INPUT        PIC X.
  4130                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4131             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4132                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4133                 88  CF-ZERO-CARRIER            VALUE '1'.
  4134                 88  CF-ZERO-GROUPING           VALUE '2'.
  4135                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4136             20  CF-EDIT-SW                 PIC X.
  4137                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4138             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4139             20  CF-CR-PR-METHOD            PIC X.
  4140               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4141               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4142             20  FILLER                     PIC X.
  4143
  4144         16  CF-CREDIT-MISC-CONTROLS.
  4145             20  CF-REIN-TABLE-SW           PIC X.
  4146                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4147             20  CF-COMP-TABLE-SW           PIC X.
  4148                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4149             20  CF-EXPERIENCE-RETENTION-AGE
  4150                                            PIC S9        COMP-3.
  4151             20  CF-CONVERSION-DT           PIC XX.
  4152             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4153             20  CF-RUN-FREQUENCY-SW        PIC X.
  4154                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4155                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4156
  4157             20  CF-CR-CHECK-NO-CONTROL.
  4158                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL156.cbl
  4159                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4160                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4161                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4162                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4163                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4164
  4165                 24  CF-CR-CHECK-COUNT       REDEFINES
  4166                     CF-CR-CHECK-COUNTER      PIC X(4).
  4167
  4168                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4169                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4170
  4171                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4172                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4173                 24  CF-MAIL-PROCESSING       PIC X.
  4174                     88  MAIL-PROCESSING          VALUE 'Y'.
  4175
  4176         16  CF-MISC-SYSTEM-CONTROL.
  4177             20  CF-SYSTEM-C                 PIC X.
  4178                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4179             20  CF-SYSTEM-D                 PIC X.
  4180                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4181             20  CF-SOC-SEC-NO-SW            PIC X.
  4182                 88  SOC-SEC-NO-USED             VALUE '1'.
  4183             20  CF-MEMBER-NO-SW             PIC X.
  4184                 88  MEMBER-NO-USED              VALUE '1'.
  4185             20  CF-TAX-ID-NUMBER            PIC X(11).
  4186             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4187             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4188                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4189                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4190                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4191                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4192             20  CF-SYSTEM-E                 PIC X.
  4193                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4194
  4195         16  CF-LGX-LIFE-USER               PIC X.
  4196             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4197             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4198
  4199         16  CF-CR-MONTH-END-DT             PIC XX.
  4200
  4201         16  CF-FILE-MAINT-DATES.
  4202             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4203                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4204             20  CF-LAST-BATCH       REDEFINES
  4205                 CF-LAST-BATCH-NO               PIC X(4).
  4206             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4207             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4208             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4209             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4210             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4211             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4212             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4213             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4214             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4215             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4216
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL156.cbl
  4217         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4218         16  FILLER                         PIC X.
  4219
  4220         16  CF-ALT-MORT-CODE               PIC X(4).
  4221         16  CF-MEMBER-CAPTION              PIC X(10).
  4222
  4223         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4224             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4225             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4226             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4227             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4228             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4229
  4230         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4231
  4232         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4233         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4234         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4235         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4236
  4237         16  CF-AH-OVERRIDE-L1              PIC X.
  4238         16  CF-AH-OVERRIDE-L2              PIC XX.
  4239         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4240         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4241
  4242         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4243         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4244
  4245         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4246         16  CF-AR-LAST-EL860-DT            PIC XX.
  4247         16  CF-MP-MONTH-END-DT             PIC XX.
  4248
  4249         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4250         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4251             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4252
  4253         16  CF-AR-MONTH-END-DT             PIC XX.
  4254
  4255         16  CF-CRDTCRD-USER                PIC X.
  4256             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4257             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4258
  4259         16  CF-CC-MONTH-END-DT             PIC XX.
  4260
  4261         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4262
  4263         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4264             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4265             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4266             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4267         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4268         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4269         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4270         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4271             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4272             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4273         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4274         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL156.cbl
  4275         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4276             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4277         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4278
  4279         16  CF-CL-ZIP-CODE.
  4280             20  CF-CL-ZIP-PRIME.
  4281                 24  CF-CL-ZIP-1ST          PIC X.
  4282                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4283                 24  FILLER                 PIC X(4).
  4284             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4285         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4286             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4287             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4288             20  FILLER                     PIC XXX.
  4289
  4290         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4291         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4292         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4293         16  CF-CO-OPTION-START-DATE        PIC XX.
  4294         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4295           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4296                                                      '3' '4'.
  4297           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4298           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4299           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4300           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4301           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4302           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4303
  4304         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4305
  4306         16  CF-PAYMENT-APPROVAL-LEVELS.
  4307             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4308             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4309             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4310             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4311             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4312             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4313
  4314         16  CF-END-USER-REPORTING-USER     PIC X.
  4315             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4316             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4317
  4318         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4319             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4320             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4321
  4322         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4323
  4324         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4325         16  FILLER                         PIC X.
  4326
  4327         16  CF-CREDIT-ARCHIVE-CNTL.
  4328             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4329             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4330             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4331
  4332         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL156.cbl
  4333
  4334         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4335             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4336             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4337
  4338         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4339             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4340             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4341
  4342         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4343
  4344         16  CF-CO-ACH-ID-CODE              PIC  X.
  4345             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4346             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4347             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4348         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4349         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4350         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4351         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4352         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4353         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4354         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4355         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4356         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4357                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4358         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4359                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4360
  4361         16  CF-CO-OVER-SHORT.
  4362             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4363             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4364
  4365*         16  FILLER                         PIC X(102).
  4366         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4367             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4368             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4369
  4370         16  CF-AH-APPROVAL-DAYS.
  4371             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4372             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4373             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4374             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4375
  4376         16  FILLER                         PIC X(82).
  4377****************************************************************
  4378*             PROCESSOR/USER RECORD                            *
  4379****************************************************************
  4380
  4381     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4382         16  CF-PROCESSOR-NAME              PIC X(30).
  4383         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4384         16  CF-PROCESSOR-TITLE             PIC X(26).
  4385         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4386                 88  MESSAGE-YES                VALUE 'Y'.
  4387                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4388
  4389*****************************************************
  4390****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL156.cbl
  4391****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4392****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4393****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4394*****************************************************
  4395
  4396         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4397             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4398             20  CF-APPLICATION-FORCE       PIC X.
  4399             20  CF-INDIVIDUAL-APP.
  4400                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4401                     28  CF-BROWSE-APP      PIC X.
  4402                     28  CF-UPDATE-APP      PIC X.
  4403
  4404         16  CF-CURRENT-TERM-ON             PIC X(4).
  4405         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4406             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4407             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4408             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4409             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4410             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4411             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4412             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4413         16  CF-PROCESSOR-CARRIER           PIC X.
  4414             88  NO-CARRIER-SECURITY            VALUE ' '.
  4415         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4416             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4417         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4418             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4419         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4420             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4421
  4422         16  CF-PROC-SYS-ACCESS-SW.
  4423             20  CF-PROC-CREDIT-CLAIMS-SW.
  4424                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4425                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4426                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4427                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4428             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4429                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4430                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4431             20  CF-PROC-LIFE-GNRLDGR-SW.
  4432                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4433                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4434                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4435                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4436             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4437                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4438                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4439         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4440             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4441             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4442         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4443
  4444         16  CF-APPROVAL-LEVEL                  PIC X.
  4445             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4446             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4447             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4448             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL156.cbl
  4449
  4450         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4451
  4452         16  CF-LANGUAGE-TYPE                   PIC X.
  4453             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4454             88  CF-LANG-IS-FR                      VALUE 'F'.
  4455         16  FILLER                             PIC  X(240).
  4456
  4457****************************************************************
  4458*             PROCESSOR/REMINDERS RECORD                       *
  4459****************************************************************
  4460
  4461     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4462         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4463             20  CF-START-REMIND-DT         PIC XX.
  4464             20  CF-END-REMIND-DT           PIC XX.
  4465             20  CF-REMINDER-TEXT           PIC X(50).
  4466         16  FILLER                         PIC X(296).
  4467
  4468
  4469****************************************************************
  4470*             STATE MASTER RECORD                              *
  4471****************************************************************
  4472
  4473     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4474         16  CF-STATE-ABBREVIATION          PIC XX.
  4475         16  CF-STATE-NAME                  PIC X(25).
  4476         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4477         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4478             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4479             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4480             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4481             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4482                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4483                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4484             20  CF-ST-PREM-REJECT-SW       PIC X.
  4485                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4486                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4487             20  CF-ST-REF-REJECT-SW        PIC X.
  4488                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4489                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4490         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4491         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4492         16  CF-ST-REFUND-RULES.
  4493             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4494             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4495             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4496         16  CF-ST-FST-PMT-EXTENSION.
  4497             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4498             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4499                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4500                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4501                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4502                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4503         16  CF-ST-STATE-CALL.
  4504             20  CF-ST-CALL-UNEARNED        PIC X.
  4505             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4506             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL156.cbl
  4507         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4508             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4509             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4510         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4511         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4512         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4513         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4514         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4515         16  FILLER                         PIC X.
  4516         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4517             20  CF-ST-BENEFIT-CD           PIC XX.
  4518             20  CF-ST-BENEFIT-KIND         PIC X.
  4519                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4520                 88  CF-ST-AH-KIND              VALUE 'A'.
  4521             20  CF-ST-REM-TERM-CALC        PIC X.
  4522                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4523                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4524                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4525                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4526                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4527                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4528                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4529                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4530
  4531             20  CF-ST-REFUND-CALC          PIC X.
  4532                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4533                 88  ST-REFD-BY-R78             VALUE '1'.
  4534                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4535                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4536                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4537                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4538                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4539                 88  ST-REFD-UTAH               VALUE '7'.
  4540                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4541                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4542                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4543
  4544             20  CF-ST-EARNING-CALC         PIC X.
  4545                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4546                 88  ST-EARN-BY-R78             VALUE '1'.
  4547                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4548                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4549                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4550                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4551                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4552                 88  ST-EARN-MEAN               VALUE '8'.
  4553                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4554
  4555             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4556                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4557                 88  ST-OVRD-BY-R78             VALUE '1'.
  4558                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4559                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4560                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4561                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4562                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4563                 88  ST-OVRD-MEAN               VALUE '8'.
  4564                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL156.cbl
  4565             20  FILLER                     PIC X.
  4566
  4567         16  CF-ST-COMMISSION-CAPS.
  4568             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4569             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4570             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4571             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4572         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4573                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4574
  4575         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4576
  4577         16  CF-ST-STATUTORY-INTEREST.
  4578             20  CF-ST-STAT-DATE-FROM       PIC X.
  4579                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4580                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4581             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4582             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4583             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4584             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4585             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4586
  4587         16  CF-ST-OVER-SHORT.
  4588             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4589             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4590
  4591         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4592
  4593         16  CF-ST-RT-CALC                  PIC X.
  4594
  4595         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4596         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4597         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4598         16  CF-ST-RF-LR-CALC               PIC X.
  4599         16  CF-ST-RF-LL-CALC               PIC X.
  4600         16  CF-ST-RF-LN-CALC               PIC X.
  4601         16  CF-ST-RF-AH-CALC               PIC X.
  4602         16  CF-ST-RF-CP-CALC               PIC X.
  4603*        16  FILLER                         PIC X(206).
  4604*CIDMOD         16  FILLER                         PIC X(192).
  4605         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4606             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4607         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4608         16  CF-ST-VFY-2ND-BENE             PIC X.
  4609         16  FILLER                         PIC X(186).
  4610
  4611****************************************************************
  4612*             BENEFIT MASTER RECORD                            *
  4613****************************************************************
  4614
  4615     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4616         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4617             20  CF-BENEFIT-CODE            PIC XX.
  4618             20  CF-BENEFIT-NUMERIC  REDEFINES
  4619                 CF-BENEFIT-CODE            PIC XX.
  4620             20  CF-BENEFIT-ALPHA           PIC XXX.
  4621             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4622             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL156.cbl
  4623
  4624             20  CF-LF-COVERAGE-TYPE        PIC X.
  4625                 88  CF-REDUCING                VALUE 'R'.
  4626                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4627
  4628             20  CF-SPECIAL-CALC-CD         PIC X.
  4629                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4630                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4631                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4632                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4633                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4634                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4635                 88  CF-FARM-PLAN               VALUE 'F'.
  4636                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4637                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4638                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4639                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4640                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4641                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4642                 88  CF-PRUDENTIAL              VALUE 'P'.
  4643                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4644                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4645                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4646                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4647                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4648                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4649
  4650             20  CF-JOINT-INDICATOR         PIC X.
  4651                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4652
  4653*            20  FILLER                     PIC X(12).
  4654             20  FILLER                     PIC X(11).
  4655             20  CF-BENEFIT-CATEGORY        PIC X.
  4656             20  CF-LOAN-TYPE               PIC X(8).
  4657
  4658             20  CF-CO-REM-TERM-CALC        PIC X.
  4659                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4660                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4661                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4662                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4663                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4664
  4665             20  CF-CO-EARNINGS-CALC        PIC X.
  4666                 88  CO-EARN-BY-R78             VALUE '1'.
  4667                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4668                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4669                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4670                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4671                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4672                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4673                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4674
  4675             20  CF-CO-REFUND-CALC          PIC X.
  4676                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4677                 88  CO-REFD-BY-R78             VALUE '1'.
  4678                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4679                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4680                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL156.cbl
  4681                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4682                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4683                 88  CO-REFD-MEAN               VALUE '8'.
  4684                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4685                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4686                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4687
  4688             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4689                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4690                 88  CO-OVRD-BY-R78             VALUE '1'.
  4691                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4692                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4693                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4694                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4695                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4696                 88  CO-OVRD-MEAN               VALUE '8'.
  4697                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4698
  4699             20  CF-CO-BEN-I-G-CD           PIC X.
  4700                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4701                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4702                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4703
  4704         16  FILLER                         PIC X(304).
  4705
  4706
  4707****************************************************************
  4708*             CARRIER MASTER RECORD                            *
  4709****************************************************************
  4710
  4711     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4712         16  CF-ADDRESS-DATA.
  4713             20  CF-MAIL-TO-NAME            PIC X(30).
  4714             20  CF-IN-CARE-OF              PIC X(30).
  4715             20  CF-ADDRESS-LINE-1          PIC X(30).
  4716             20  CF-ADDRESS-LINE-2          PIC X(30).
  4717             20  CF-CITY-STATE              PIC X(30).
  4718             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4719             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4720
  4721         16  CF-CLAIM-NO-CONTROL.
  4722             20  CF-CLAIM-NO-METHOD         PIC X.
  4723                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4724                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4725                 88  CLAIM-NO-SEQ               VALUE '3'.
  4726                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4727             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4728                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4729                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4730                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4731
  4732         16  CF-CHECK-NO-CONTROL.
  4733             20  CF-CHECK-NO-METHOD         PIC X.
  4734                 88  CHECK-NO-MANUAL            VALUE '1'.
  4735                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4736                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4737                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4738             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL156.cbl
  4739                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4740
  4741         16  CF-DOMICILE-STATE              PIC XX.
  4742
  4743         16  CF-EXPENSE-CONTROLS.
  4744             20  CF-EXPENSE-METHOD          PIC X.
  4745                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4746                 88  DOLLARS-PER-PMT            VALUE '2'.
  4747                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4748                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4749             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4750             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4751
  4752         16  CF-CORRESPONDENCE-CONTROL.
  4753             20  CF-LETTER-RESEND-OPT       PIC X.
  4754                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4755                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4756             20  FILLER                     PIC X(4).
  4757
  4758         16  CF-RESERVE-CONTROLS.
  4759             20  CF-MANUAL-SW               PIC X.
  4760                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4761             20  CF-FUTURE-SW               PIC X.
  4762                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4763             20  CF-PTC-SW                  PIC X.
  4764                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4765             20  CF-IBNR-SW                 PIC X.
  4766                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4767             20  CF-PTC-LF-SW               PIC X.
  4768                 88  CF-LF-PTC-USED             VALUE '1'.
  4769             20  CF-CDT-ACCESS-METHOD       PIC X.
  4770                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4771                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4772                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4773             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4774
  4775         16  CF-CLAIM-CALC-METHOD           PIC X.
  4776             88  360-PLUS-MONTHS                VALUE '1'.
  4777             88  365-PLUS-MONTHS                VALUE '2'.
  4778             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4779             88  360-DAILY                      VALUE '4'.
  4780             88  365-DAILY                      VALUE '5'.
  4781
  4782         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4783         16  FILLER                         PIC X(11).
  4784
  4785         16  CF-LIMIT-AMOUNTS.
  4786             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4787             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4788             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4789             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4790             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4791             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4792             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4793             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4794             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4795             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4796
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL156.cbl
  4797         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4798         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4799         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4800
  4801         16  CF-ZIP-CODE.
  4802             20  CF-ZIP-PRIME.
  4803                 24  CF-ZIP-1ST             PIC X.
  4804                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4805                 24  FILLER                 PIC X(4).
  4806             20  CF-ZIP-PLUS4               PIC X(4).
  4807         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4808             20  CF-CAN-POSTAL-1            PIC XXX.
  4809             20  CF-CAN-POSTAL-2            PIC XXX.
  4810             20  FILLER                     PIC XXX.
  4811
  4812         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4813         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4814         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4815
  4816         16  CF-RATING-SWITCH               PIC X.
  4817             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4818             88  CF-NO-RATING                   VALUE 'N'.
  4819
  4820         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4821
  4822         16  CF-CARRIER-OVER-SHORT.
  4823             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4824             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4825
  4826         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4827         16  CF-SECPAY-SWITCH               PIC X.
  4828             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4829             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4830         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4831         16  FILLER                         PIC X(448).
  4832*        16  FILLER                         PIC X(452).
  4833
  4834
  4835****************************************************************
  4836*             MORTALITY MASTER RECORD                          *
  4837****************************************************************
  4838
  4839     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4840         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4841                                INDEXED BY CF-MORT-NDX.
  4842             20  CF-MORT-TABLE              PIC X(5).
  4843             20  CF-MORT-TABLE-TYPE         PIC X.
  4844                 88  CF-MORT-JOINT              VALUE 'J'.
  4845                 88  CF-MORT-SINGLE             VALUE 'S'.
  4846                 88  CF-MORT-COMBINED           VALUE 'C'.
  4847                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4848                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4849             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4850             20  CF-MORT-AGE-METHOD         PIC XX.
  4851                 88  CF-AGE-LAST                VALUE 'AL'.
  4852                 88  CF-AGE-NEAR                VALUE 'AN'.
  4853             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4854             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL156.cbl
  4855                                            PIC X.
  4856                 88  CF-MINUS                   VALUE '-'.
  4857                 88  CF-PLUS                    VALUE '+'.
  4858             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4859             20  CF-MORT-JOINT-CODE         PIC X.
  4860                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4861             20  CF-MORT-PC-Q               PIC X.
  4862                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4863             20  CF-MORT-TABLE-CODE         PIC X(4).
  4864             20  CF-MORT-COMMENTS           PIC X(15).
  4865             20  FILLER                     PIC X(14).
  4866
  4867         16  FILLER                         PIC X(251).
  4868
  4869
  4870****************************************************************
  4871*             BUSSINESS TYPE MASTER RECORD                     *
  4872****************************************************************
  4873
  4874     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4875* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4876* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4877* AND RECORD 05 IS TYPES 81-99
  4878         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4879             20  CF-BUSINESS-TITLE          PIC  X(19).
  4880             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4881                                            PIC S9V9(4) COMP-3.
  4882             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4883             20  FILLER                     PIC  X.
  4884         16  FILLER                         PIC  X(248).
  4885
  4886
  4887****************************************************************
  4888*             TERMINAL MASTER RECORD                           *
  4889****************************************************************
  4890
  4891     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4892
  4893         16  CF-COMPANY-TERMINALS.
  4894             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4895                                  PIC X(4).
  4896         16  FILLER               PIC X(248).
  4897
  4898
  4899****************************************************************
  4900*             LIFE EDIT MASTER RECORD                          *
  4901****************************************************************
  4902
  4903     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4904         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4905             20  CF-LIFE-CODE-IN            PIC XX.
  4906             20  CF-LIFE-CODE-OUT           PIC XX.
  4907         16  FILLER                         PIC X(248).
  4908
  4909
  4910****************************************************************
  4911*             AH EDIT MASTER RECORD                            *
  4912****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL156.cbl
  4913
  4914     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4915         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4916             20  CF-AH-CODE-IN              PIC XXX.
  4917             20  CF-AH-CODE-OUT             PIC XX.
  4918         16  FILLER                         PIC X(248).
  4919
  4920
  4921****************************************************************
  4922*             CREDIBILITY TABLES                               *
  4923****************************************************************
  4924
  4925     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4926         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4927                             INDEXED BY CF-CRDB-NDX.
  4928             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4929             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4930             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4931         16  FILLER                         PIC  X(332).
  4932
  4933
  4934****************************************************************
  4935*             REPORT CUSTOMIZATION RECORD                      *
  4936****************************************************************
  4937
  4938     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4939         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4940             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4941             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4942             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4943**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4944****       A T-TRANSFER.                                   ****
  4945             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4946
  4947         16  FILLER                         PIC XX.
  4948
  4949         16  CF-CARRIER-CNTL-OPT.
  4950             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4951                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4952                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4953             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4954                                            PIC X.
  4955         16  CF-GROUP-CNTL-OPT.
  4956             20  CF-GROUP-OPT-SEQ           PIC 9.
  4957                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4958                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4959             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4960                                            PIC X(6).
  4961         16  CF-STATE-CNTL-OPT.
  4962             20  CF-STATE-OPT-SEQ           PIC 9.
  4963                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4964                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4965             20  CF-STATE-SELECT OCCURS 3 TIMES
  4966                                            PIC XX.
  4967         16  CF-ACCOUNT-CNTL-OPT.
  4968             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4969                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4970                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL156.cbl
  4971             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4972                                            PIC X(10).
  4973         16  CF-BUS-TYP-CNTL-OPT.
  4974             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4975                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4976                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4977             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4978                                            PIC XX.
  4979         16  CF-LF-TYP-CNTL-OPT.
  4980             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4981                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4982                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4983             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4984                                            PIC XX.
  4985         16  CF-AH-TYP-CNTL-OPT.
  4986             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4987                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4988                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4989             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4990                                            PIC XX.
  4991         16  CF-REPTCD1-CNTL-OPT.
  4992             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4993                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4994                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4995             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4996                                            PIC X(10).
  4997         16  CF-REPTCD2-CNTL-OPT.
  4998             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4999                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5000                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5001             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5002                                            PIC X(10).
  5003         16  CF-USER1-CNTL-OPT.
  5004             20  CF-USER1-OPT-SEQ           PIC 9.
  5005                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5006                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5007             20  CF-USER1-SELECT OCCURS 3 TIMES
  5008                                            PIC X(10).
  5009         16  CF-USER2-CNTL-OPT.
  5010             20  CF-USER2-OPT-SEQ           PIC 9.
  5011                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5012                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5013             20  CF-USER2-SELECT OCCURS 3 TIMES
  5014                                            PIC X(10).
  5015         16  CF-USER3-CNTL-OPT.
  5016             20  CF-USER3-OPT-SEQ           PIC 9.
  5017                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5018                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5019             20  CF-USER3-SELECT OCCURS 3 TIMES
  5020                                            PIC X(10).
  5021         16  CF-USER4-CNTL-OPT.
  5022             20  CF-USER4-OPT-SEQ           PIC 9.
  5023                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5024                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5025             20  CF-USER4-SELECT OCCURS 3 TIMES
  5026                                            PIC X(10).
  5027         16  CF-USER5-CNTL-OPT.
  5028             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL156.cbl
  5029                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5030                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5031             20  CF-USER5-SELECT OCCURS 3 TIMES
  5032                                            PIC X(10).
  5033         16  CF-REINS-CNTL-OPT.
  5034             20  CF-REINS-OPT-SEQ           PIC 9.
  5035                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5036                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5037             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5038                 24  CF-REINS-PRIME         PIC XXX.
  5039                 24  CF-REINS-SUB           PIC XXX.
  5040
  5041         16  CF-AGENT-CNTL-OPT.
  5042             20  CF-AGENT-OPT-SEQ           PIC 9.
  5043                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5044                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5045             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5046                                            PIC X(10).
  5047
  5048         16  FILLER                         PIC X(43).
  5049
  5050         16  CF-LOSS-RATIO-SELECT.
  5051             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5052             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5053         16  CF-ENTRY-DATE-SELECT.
  5054             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5055             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5056         16  CF-EFFECTIVE-DATE-SELECT.
  5057             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5058             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5059
  5060         16  CF-EXCEPTION-LIST-IND          PIC X.
  5061             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5062
  5063         16  FILLER                         PIC X(318).
  5064
  5065****************************************************************
  5066*                  EXCEPTION REPORTING RECORD                  *
  5067****************************************************************
  5068
  5069     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5070         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5071             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5072
  5073         16  CF-COMBINED-LIFE-AH-OPT.
  5074             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5075             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5076             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5077             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5078
  5079         16  CF-LIFE-OPT.
  5080             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5081             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5082             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5083             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5084             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5085             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5086             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL156.cbl
  5087             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5088             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5089             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5090
  5091         16  CF-AH-OPT.
  5092             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5093             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5094             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5095             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5096             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5097             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5098             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5099             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5100             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5101             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5102
  5103         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5104             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5105             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5106             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5107
  5108         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5109
  5110         16  FILLER                         PIC X(673).
  5111
  5112
  5113****************************************************************
  5114*             MORTGAGE SYSTEM PLAN RECORD                      *
  5115****************************************************************
  5116
  5117     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5118         16  CF-PLAN-TYPE                   PIC X.
  5119             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5120             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5121             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5122         16  CF-PLAN-ABBREV                 PIC XXX.
  5123         16  CF-PLAN-DESCRIPT               PIC X(10).
  5124         16  CF-PLAN-NOTES                  PIC X(20).
  5125         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5126         16  CF-PLAN-UNDERWRITING.
  5127             20  CF-PLAN-TERM-DATA.
  5128                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5129                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5130             20  CF-PLAN-AGE-DATA.
  5131                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5132                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5133                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5134             20  CF-PLAN-BENEFIT-DATA.
  5135                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5136                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5137                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5138                                            PIC S9(7)V99  COMP-3.
  5139         16  CF-PLAN-POLICY-FORMS.
  5140             20  CF-POLICY-FORM             PIC X(12).
  5141             20  CF-MASTER-APPLICATION      PIC X(12).
  5142             20  CF-MASTER-POLICY           PIC X(12).
  5143         16  CF-PLAN-RATING.
  5144             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL156.cbl
  5145             20  CF-SEX-RATING              PIC X.
  5146                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5147                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5148             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5149             20  CF-SUB-STD-TYPE            PIC X.
  5150                 88  CF-PCT-OF-PREM            VALUE '1'.
  5151                 88  CF-PCT-OF-BENE            VALUE '2'.
  5152         16  CF-PLAN-PREM-TOLERANCES.
  5153             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5154             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5155         16  CF-PLAN-PYMT-TOLERANCES.
  5156             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5157             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5158         16  CF-PLAN-MISC-DATA.
  5159             20  FILLER                     PIC X.
  5160             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5161             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5162         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5163         16  CF-PLAN-IND-GRP                PIC X.
  5164             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5165                                                     '1'.
  5166             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5167                                                     '2'.
  5168         16  CF-MIB-SEARCH-SW               PIC X.
  5169             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5170             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5171             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5172             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5173         16  CF-ALPHA-SEARCH-SW             PIC X.
  5174             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5175             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5176             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5177             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5178             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5179             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5180             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5181             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5182             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5183             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5184                                                     'A' 'B' 'C'
  5185                                                     'X' 'Y' 'Z'.
  5186         16  CF-EFF-DT-RULE-SW              PIC X.
  5187             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5188             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5189             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5190             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5191             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5192         16  FILLER                         PIC X(4).
  5193         16  CF-HEALTH-QUESTIONS            PIC X.
  5194             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5195         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5196         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5197         16  CF-PLAN-SNGL-JNT               PIC X.
  5198             88  CF-COMBINED-PLAN              VALUE 'C'.
  5199             88  CF-JNT-PLAN                   VALUE 'J'.
  5200             88  CF-SNGL-PLAN                  VALUE 'S'.
  5201         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5202         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL156.cbl
  5203         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5204         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5205         16  CF-RERATE-CNTL                 PIC  X.
  5206             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5207             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5208             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5209             88  CF-AUTO-RECALC                 VALUE '4'.
  5210         16  CF-BENEFIT-TYPE                PIC  X.
  5211             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5212             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5213         16  CF-POLICY-FEE                  PIC S999V99
  5214                                                    COMP-3.
  5215         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5216         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5217         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5218         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5219         16  FILLER                         PIC  X(32).
  5220         16  CF-TERMINATION-FORM            PIC  X(04).
  5221         16  FILLER                         PIC  X(08).
  5222         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5223                                                       COMP-3.
  5224         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5225         16  CF-ISSUE-LETTER                PIC  X(4).
  5226         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5227         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5228             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5229             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5230         16  CF-MP-REFUND-CALC              PIC X.
  5231             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5232             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5233             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5234             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5235             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5236             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5237             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5238             88  CF-MP-REFD-MEAN                VALUE '8'.
  5239         16  CF-ALT-RATE-CODE               PIC  X(5).
  5240
  5241
  5242         16  FILLER                         PIC X(498).
  5243****************************************************************
  5244*             MORTGAGE COMPANY MASTER RECORD                   *
  5245****************************************************************
  5246
  5247     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5248         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5249         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5250             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5251             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5252             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5253             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5254             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5255
  5256         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5257         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5258         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5259         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5260         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL156.cbl
  5261
  5262         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5263             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5264         16  CF-MP-RECON-USE-IND            PIC X(1).
  5265             88  CF-MP-USE-RECON             VALUE 'Y'.
  5266         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5267             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5268         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5269             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5270             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5271         16  FILLER                         PIC X(1).
  5272         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5273             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5274         16  CF-MORTG-MIB-VERSION           PIC X.
  5275             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5276             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5277             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5278         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5279             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5280                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5281             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5282                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5283             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5284                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5285             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5286                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5287             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5288                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5289             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5290                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5291         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5292         16  FILLER                         PIC X(7).
  5293         16  CF-MORTG-DESTINATION-SYMBOL.
  5294             20  CF-MORTG-MIB-COMM          PIC X(5).
  5295             20  CF-MORTG-MIB-TERM          PIC X(5).
  5296         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5297             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5298         16  FILLER                         PIC X(03).
  5299         16  CF-MP-CHECK-NO-CONTROL.
  5300             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5301                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5302                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5303                                                ' ' LOW-VALUES.
  5304                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5305                                               VALUE '3'.
  5306         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5307         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5308         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5309             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5310                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5311             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5312                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5313             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5314                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5315             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5316                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5317             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5318                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL156.cbl
  5319             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5320                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5321         16  CF-MORTG-BILLING-AREA.
  5322             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5323                                            PIC X.
  5324         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5325         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5326         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5327         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5328             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5329             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5330         16  FILLER                         PIC X.
  5331         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5332             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5333             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5334         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5335         16  FILLER                         PIC X(8).
  5336         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5337         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5338         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5339         16  CF-ACH-COMPANY-ID.
  5340             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5341                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5342                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5343                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5344             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5345         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5346             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5347         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5348             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5349             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5350         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5351         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5352         16  FILLER                         PIC X(536).
  5353
  5354****************************************************************
  5355*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5356****************************************************************
  5357
  5358     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5359         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5360             20  CF-FEMALE-HEIGHT.
  5361                 24  CF-FEMALE-FT           PIC 99.
  5362                 24  CF-FEMALE-IN           PIC 99.
  5363             20  CF-FEMALE-MIN-WT           PIC 999.
  5364             20  CF-FEMALE-MAX-WT           PIC 999.
  5365         16  FILLER                         PIC X(428).
  5366
  5367     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5368         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5369             20  CF-MALE-HEIGHT.
  5370                 24  CF-MALE-FT             PIC 99.
  5371                 24  CF-MALE-IN             PIC 99.
  5372             20  CF-MALE-MIN-WT             PIC 999.
  5373             20  CF-MALE-MAX-WT             PIC 999.
  5374         16  FILLER                         PIC X(428).
  5375******************************************************************
  5376*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL156.cbl
  5377******************************************************************
  5378     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5379         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5380             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5381             20  CF-SYS-LETTER-ID           PIC X(04).
  5382             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5383             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5384             20  CF-SYS-RESET-SW            PIC X(01).
  5385             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5386             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5387
  5388         16  FILLER                         PIC X(50).
  5389
  5390         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5391             20  CF-USER-ACTIVE-SW          PIC X(01).
  5392             20  CF-USER-LETTER-ID          PIC X(04).
  5393             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5394             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5395             20  CF-USER-RESET-SW           PIC X(01).
  5396             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5397             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5398             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5399
  5400         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL156.cbl
  5402*    COPY ELCCERT.
  5403******************************************************************
  5404*                                                                *
  5405*                            ELCCERT.                            *
  5406*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5407*                            VMOD=2.013                          *
  5408*                                                                *
  5409*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5410*                                                                *
  5411*   FILE TYPE = VSAM,KSDS                                        *
  5412*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5413*                                                                *
  5414*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5415*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5416*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5417*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5418*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5419*                                                                *
  5420*   LOG = YES                                                    *
  5421*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5422******************************************************************
  5423*                   C H A N G E   L O G
  5424*
  5425* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5426*-----------------------------------------------------------------
  5427*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5428* EFFECTIVE    NUMBER
  5429*-----------------------------------------------------------------
  5430* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5431* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5432* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5433* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5434* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5435* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5436* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5437* 032612  CR2011110200001  PEMA  AHL CHANGES
  5438******************************************************************
  5439
  5440 01  CERTIFICATE-MASTER.
  5441     12  CM-RECORD-ID                      PIC XX.
  5442         88  VALID-CM-ID                      VALUE 'CM'.
  5443
  5444     12  CM-CONTROL-PRIMARY.
  5445         16  CM-COMPANY-CD                 PIC X.
  5446         16  CM-CARRIER                    PIC X.
  5447         16  CM-GROUPING.
  5448             20  CM-GROUPING-PREFIX        PIC X(3).
  5449             20  CM-GROUPING-PRIME         PIC X(3).
  5450         16  CM-STATE                      PIC XX.
  5451         16  CM-ACCOUNT.
  5452             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5453             20  CM-ACCOUNT-PRIME          PIC X(6).
  5454         16  CM-CERT-EFF-DT                PIC XX.
  5455         16  CM-CERT-NO.
  5456             20  CM-CERT-PRIME             PIC X(10).
  5457             20  CM-CERT-SFX               PIC X.
  5458
  5459     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL156.cbl
  5460         16  CM-COMPANY-CD-A1              PIC X.
  5461         16  CM-INSURED-LAST-NAME          PIC X(15).
  5462         16  CM-INSURED-INITIALS.
  5463             20  CM-INSURED-INITIAL1       PIC X.
  5464             20  CM-INSURED-INITIAL2       PIC X.
  5465
  5466     12  CM-CONTROL-BY-SSN.
  5467         16  CM-COMPANY-CD-A2              PIC X.
  5468         16  CM-SOC-SEC-NO.
  5469             20  CM-SSN-STATE              PIC XX.
  5470             20  CM-SSN-ACCOUNT            PIC X(6).
  5471             20  CM-SSN-LN3.
  5472                 25  CM-INSURED-INITIALS-A2.
  5473                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5474                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5475                 25 CM-PART-LAST-NAME-A2         PIC X.
  5476
  5477     12  CM-CONTROL-BY-CERT-NO.
  5478         16  CM-COMPANY-CD-A4              PIC X.
  5479         16  CM-CERT-NO-A4                 PIC X(11).
  5480
  5481     12  CM-CONTROL-BY-MEMB.
  5482         16  CM-COMPANY-CD-A5              PIC X.
  5483         16  CM-MEMBER-NO.
  5484             20  CM-MEMB-STATE             PIC XX.
  5485             20  CM-MEMB-ACCOUNT           PIC X(6).
  5486             20  CM-MEMB-LN4.
  5487                 25  CM-INSURED-INITIALS-A5.
  5488                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5489                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5490                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5491
  5492     12  CM-INSURED-PROFILE-DATA.
  5493         16  CM-INSURED-FIRST-NAME.
  5494             20  CM-INSURED-1ST-INIT       PIC X.
  5495             20  FILLER                    PIC X(9).
  5496         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5497         16  CM-INSURED-SEX                PIC X.
  5498             88  CM-SEX-MALE                  VALUE 'M'.
  5499             88  CM-SEX-FEMAL                 VALUE 'F'.
  5500         16  CM-INSURED-JOINT-AGE          PIC 99.
  5501         16  CM-JOINT-INSURED-NAME.
  5502             20  CM-JT-LAST-NAME           PIC X(15).
  5503             20  CM-JT-FIRST-NAME.
  5504                 24  CM-JT-1ST-INIT        PIC X.
  5505                 24  FILLER                PIC X(9).
  5506             20  CM-JT-INITIAL             PIC X.
  5507
  5508     12  CM-LIFE-DATA.
  5509         16  CM-LF-BENEFIT-CD              PIC XX.
  5510         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5511         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5512         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5513         16  CM-LF-DEV-CODE                PIC XXX.
  5514         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5515         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5516         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5517         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL156.cbl
  5518         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5519         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5520         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5521         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5522         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5523         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5524         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5525         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5526         16  FILLER                        PIC XX.
  5527
  5528     12  CM-AH-DATA.
  5529         16  CM-AH-BENEFIT-CD              PIC XX.
  5530         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5531         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5532         16  CM-AH-DEV-CODE                PIC XXX.
  5533         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5534         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5535         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5536         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5537         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5538         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5539         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5540         16  CM-AH-PAID-THRU-DT            PIC XX.
  5541             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5542         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5543         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5544         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5545         16  FILLER                        PIC X.
  5546
  5547     12  CM-LOAN-INFORMATION.
  5548         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5549         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5550                                           PIC S9(5)V99  COMP-3.
  5551         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5552         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5553         16  CM-PAY-FREQUENCY              PIC S99.
  5554         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5555         16  CM-RATE-CLASS                 PIC XX.
  5556         16  CM-BENEFICIARY                PIC X(25).
  5557         16  CM-POLICY-FORM-NO             PIC X(12).
  5558         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5559         16  CM-LAST-ADD-ON-DT             PIC XX.
  5560         16  CM-DEDUCTIBLE-AMOUNTS.
  5561             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5562             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5563         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5564             20  CM-RESIDENT-STATE         PIC XX.
  5565             20  CM-RATE-CODE              PIC X(4).
  5566             20  FILLER                    PIC XX.
  5567         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5568             20  CM-LOAN-OFFICER           PIC X(5).
  5569             20  FILLER                    PIC XXX.
  5570         16  CM-CSR-CODE                   PIC XXX.
  5571         16  CM-UNDERWRITING-CODE          PIC X.
  5572             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5573         16  CM-POST-CARD-IND              PIC X.
  5574         16  CM-NH-INTERFACE-SW            PIC X.
  5575         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL156.cbl
  5576             88  CM-SING-PRM                  VALUE '1'.
  5577             88  CM-O-B-COVERAGE              VALUE '2'.
  5578             88  CM-OPEN-END                  VALUE '3'.
  5579         16  CM-IND-GRP-TYPE               PIC X.
  5580             88  CM-INDIVIDUAL                VALUE 'I'.
  5581             88  CM-GROUP                     VALUE 'G'.
  5582         16  CM-SKIP-CODE                  PIC X.
  5583             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5584             88  SKIP-JULY                    VALUE '1'.
  5585             88  SKIP-AUGUST                  VALUE '2'.
  5586             88  SKIP-SEPTEMBER               VALUE '3'.
  5587             88  SKIP-JULY-AUG                VALUE '4'.
  5588             88  SKIP-AUG-SEPT                VALUE '5'.
  5589             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5590             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5591             88  SKIP-JUNE                    VALUE '8'.
  5592             88  SKIP-JUNE-JULY               VALUE '9'.
  5593             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5594             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5595         16  CM-PAYMENT-MODE               PIC X.
  5596             88  PAY-MONTHLY                  VALUE SPACE.
  5597             88  PAY-WEEKLY                   VALUE '1'.
  5598             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5599             88  PAY-BI-WEEKLY                VALUE '3'.
  5600             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5601         16  CM-LOAN-NUMBER                PIC X(8).
  5602         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5603         16  CM-OLD-LOF                    PIC XXX.
  5604*        16  CM-LOAN-OFFICER               PIC XXX.
  5605         16  CM-REIN-TABLE                 PIC XXX.
  5606         16  CM-SPECIAL-REIN-CODE          PIC X.
  5607         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5608         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5609         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5610
  5611     12  CM-STATUS-DATA.
  5612         16  CM-ENTRY-STATUS               PIC X.
  5613         16  CM-ENTRY-DT                   PIC XX.
  5614
  5615         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5616         16  CM-LF-CANCEL-DT               PIC XX.
  5617         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5618
  5619         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5620         16  CM-LF-DEATH-DT                PIC XX.
  5621         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5622
  5623         16  CM-LF-CURRENT-STATUS          PIC X.
  5624             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5625                                                'M' '4' '5' '9'.
  5626             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5627             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5628             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5629             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5630             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5631             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5632             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5633             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL156.cbl
  5634             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5635             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5636             88  CM-LF-DECLINED               VALUE 'D'.
  5637             88  CM-LF-VOIDED                 VALUE 'V'.
  5638
  5639         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5640         16  CM-AH-CANCEL-DT               PIC XX.
  5641         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5642
  5643         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5644         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5645         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5646
  5647         16  CM-AH-CURRENT-STATUS          PIC X.
  5648             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5649                                                'M' '4' '5' '9'.
  5650             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5651             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5652             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5653             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5654             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5655             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5656             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5657             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5658             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5659             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5660             88  CM-AH-DECLINED               VALUE 'D'.
  5661             88  CM-AH-VOIDED                 VALUE 'V'.
  5662
  5663         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5664             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5665             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5666             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5667         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5668
  5669         16  CM-ENTRY-BATCH                PIC X(6).
  5670         16  CM-LF-EXIT-BATCH              PIC X(6).
  5671         16  CM-AH-EXIT-BATCH              PIC X(6).
  5672         16  CM-LAST-MONTH-END             PIC XX.
  5673
  5674     12  CM-NOTE-SW                        PIC X.
  5675         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5676         88  CERT-NOTES-PRESENT               VALUE '1'.
  5677         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5678         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5679         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5680         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5681         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5682         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5683     12  CM-COMP-EXCP-SW                   PIC X.
  5684         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5685         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5686     12  CM-INSURED-ADDRESS-SW             PIC X.
  5687         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5688         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5689
  5690*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5691     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL156.cbl
  5692     12  FILLER                            PIC X.
  5693
  5694*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5695     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5696     12  FILLER                            PIC X.
  5697*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5698     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5699
  5700     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5701         88  CERT-ADDED-BATCH                 VALUE ' '.
  5702         88  CERT-ADDED-ONLINE                VALUE '1'.
  5703         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5704         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5705         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5706     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5707         88  CERT-AS-LOADED                   VALUE ' '.
  5708         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5709         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5710         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5711         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5712         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5713         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5714         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5715
  5716     12  CM-ACCOUNT-COMM-PCTS.
  5717         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5718         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5719
  5720     12  CM-USER-FIELD                     PIC X.
  5721     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5722     12  CM-CLP-STATE                      PIC XX.
  5723     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5724     12  CM-USER-RESERVED                  PIC XXX.
  5725     12  FILLER REDEFINES CM-USER-RESERVED.
  5726         16  CM-AH-CLASS-CD                PIC XX.
  5727         16  F                             PIC X.
  5728******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL156.cbl
  5730*    COPY ELCTRLR.
  5731******************************************************************
  5732*                                                                *
  5733*                            ELCTRLR.                            *
  5734*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5735*                            VMOD=2.014                          *
  5736*                                                                *
  5737*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5738*                                                                *
  5739*   FILE TYPE = VSAM,KSDS                                        *
  5740*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5741*                                                                *
  5742*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5743*       ALTERNATE INDEX = NONE                                   *
  5744*                                                                *
  5745*   LOG = YES                                                    *
  5746*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5747******************************************************************
  5748*                   C H A N G E   L O G
  5749*
  5750* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5751*-----------------------------------------------------------------
  5752*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5753* EFFECTIVE    NUMBER
  5754*-----------------------------------------------------------------
  5755* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5756* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5757* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5758* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5759* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5760* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5761* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5762* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5763* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5764* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5765* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5766* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5767* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5768******************************************************************
  5769 01  ACTIVITY-TRAILERS.
  5770     12  AT-RECORD-ID                    PIC XX.
  5771         88  VALID-AT-ID                       VALUE 'AT'.
  5772
  5773     12  AT-CONTROL-PRIMARY.
  5774         16  AT-COMPANY-CD               PIC X.
  5775         16  AT-CARRIER                  PIC X.
  5776         16  AT-CLAIM-NO                 PIC X(7).
  5777         16  AT-CERT-NO.
  5778             20  AT-CERT-PRIME           PIC X(10).
  5779             20  AT-CERT-SFX             PIC X.
  5780         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5781             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5782             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5783             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5784             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5785             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5786             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5787             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL156.cbl
  5788             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5789             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5790             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5791             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5792             88  AT-BENEFICIARY-TRL           VALUE +91.
  5793             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5794             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5795
  5796     12  AT-TRAILER-TYPE                 PIC X.
  5797         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5798         88  PAYMENT-TR                       VALUE '2'.
  5799         88  AUTO-PAY-TR                      VALUE '3'.
  5800         88  CORRESPONDENCE-TR                VALUE '4'.
  5801         88  ADDRESS-TR                       VALUE '5'.
  5802         88  GENERAL-INFO-TR                  VALUE '6'.
  5803         88  AUTO-PROMPT-TR                   VALUE '7'.
  5804         88  DENIAL-TR                        VALUE '8'.
  5805         88  INCURRED-CHG-TR                  VALUE '9'.
  5806         88  FORM-CONTROL-TR                  VALUE 'A'.
  5807
  5808     12  AT-RECORDED-DT                  PIC XX.
  5809     12  AT-RECORDED-BY                  PIC X(4).
  5810     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5811
  5812     12  AT-TRAILER-BODY                 PIC X(165).
  5813
  5814     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5815         16  AT-RESERVE-CONTROLS.
  5816             20  AT-MANUAL-SW            PIC X.
  5817                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5818             20  AT-FUTURE-SW            PIC X.
  5819                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5820             20  AT-PTC-SW               PIC X.
  5821                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5822             20  AT-IBNR-SW              PIC X.
  5823                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5824             20  AT-PTC-LF-SW            PIC X.
  5825                 88  AT-LF-PTC-USED          VALUE '1'.
  5826             20  AT-CDT-ACCESS-METHOD    PIC X.
  5827                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5828                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5829                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5830             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5831         16  AT-LAST-COMPUTED-DT         PIC XX.
  5832         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5833         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5834         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5835         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5836         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5837         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5838         16  AT-EXPENSE-CONTROLS.
  5839             20  AT-EXPENSE-METHOD       PIC X.
  5840                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5841                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5842                 88  PERCENT-OF-PMT           VALUE '3'.
  5843                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5844             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5845             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL156.cbl
  5846         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5847         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5848
  5849         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5850         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5851
  5852*        16  FILLER                      PIC X(53).
  5853         16  FILLER                      PIC X(47).
  5854
  5855         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5856         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5857
  5858         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5859             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5860             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5861*                    C = CLOSED
  5862*                    O = OPEN
  5863             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5864*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5865
  5866     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5867         16  AT-PAYMENT-TYPE             PIC X.
  5868             88  PARTIAL-PAYMENT                VALUE '1'.
  5869             88  FINAL-PAYMENT                  VALUE '2'.
  5870             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5871             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5872             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5873             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5874             88  VOIDED-PAYMENT                 VALUE '9'.
  5875             88  TRANSFER                       VALUE 'T'.
  5876             88  LIFE-INTEREST                  VALUE 'I'.
  5877
  5878         16  AT-CLAIM-TYPE               PIC X.
  5879             88  PAID-FOR-AH                    VALUE 'A'.
  5880             88  PAID-FOR-LIFE                  VALUE 'L'.
  5881             88  PAID-FOR-IUI                   VALUE 'I'.
  5882             88  PAID-FOR-GAP                   VALUE 'G'.
  5883         16  AT-CLAIM-PREM-TYPE          PIC X.
  5884             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5885             88  AT-O-B-COVERAGE                VALUE '2'.
  5886             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5887         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5888         16  AT-CHECK-NO                 PIC X(7).
  5889         16  AT-PAID-FROM-DT             PIC XX.
  5890         16  AT-PAID-THRU-DT             PIC XX.
  5891         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5892         16  FILLER                      PIC X.
  5893         16  AT-PAYEES-NAME              PIC X(30).
  5894         16  AT-PAYMENT-ORIGIN           PIC X.
  5895             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5896             88  ONLINE-AUTO-PMT                VALUE '2'.
  5897             88  OFFLINE-PMT                    VALUE '3'.
  5898         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5899         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5900         16  AT-VOID-DATA.
  5901             20  AT-VOID-DT              PIC XX.
  5902*00144       20  AT-VOID-REASON          PIC X(30).
  5903             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL156.cbl
  5904         16  AT-PMT-APPROVED-BY          PIC X(04).
  5905         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5906         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5907         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5908                                         PIC S99V9(5)  COMP-3.
  5909         16  AT-CREDIT-INTERFACE.
  5910             20  AT-PMT-SELECT-DT        PIC XX.
  5911                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5912             20  AT-PMT-ACCEPT-DT        PIC XX.
  5913                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5914             20  AT-VOID-SELECT-DT       PIC XX.
  5915                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5916             20  AT-VOID-ACCEPT-DT       PIC XX.
  5917                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5918
  5919         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5920                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5921                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5922         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5923
  5924         16  AT-FORCE-CONTROL            PIC X.
  5925             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5926         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5927         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5928         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5929         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5930         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5931         16  AT-BENEFIT-TYPE             PIC X.
  5932
  5933         16  AT-EXPENSE-TYPE             PIC X.
  5934         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5935
  5936         16  AT-PAYEE-TYPE-CD.
  5937             20  AT-PAYEE-TYPE           PIC X.
  5938                 88  INSURED-PAID           VALUE 'I'.
  5939                 88  BENEFICIARY-PAID       VALUE 'B'.
  5940                 88  ACCOUNT-PAID           VALUE 'A'.
  5941                 88  OTHER-1-PAID           VALUE 'O'.
  5942                 88  OTHER-2-PAID           VALUE 'Q'.
  5943                 88  DOCTOR-PAID            VALUE 'P'.
  5944                 88  EMPLOYER-PAID          VALUE 'E'.
  5945             20  AT-PAYEE-SEQ            PIC X.
  5946
  5947         16  AT-CASH-PAYMENT             PIC X.
  5948         16  AT-GROUPED-PAYMENT          PIC X.
  5949         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5950         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5951         16  AT-APPROVED-LEVEL           PIC X.
  5952         16  AT-VOID-TYPE                PIC X.
  5953             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5954             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5955         16  AT-AIG-UNEMP-IND            PIC X.
  5956             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5957         16  AT-ASSOCIATES               PIC X.
  5958             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5959             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5960
  5961         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL156.cbl
  5962         16  AT-CV-PMT-CODE              PIC X.
  5963             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5964             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5965             88  FULL-ADD-PAYMENT           VALUE '3'.
  5966             88  HALF-ADD-PAYMENT           VALUE '4'.
  5967             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5968             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5969             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5970             88  ADDL-PAYMENT               VALUE '8'.
  5971
  5972         16  AT-EOB-CODE1                PIC XXX.
  5973         16  AT-EOB-CODE2                PIC XXX.
  5974         16  AT-EOB-CODE3                PIC XXX.
  5975         16  AT-EOB-CODE4                PIC XXX.
  5976         16  FILLER REDEFINES AT-EOB-CODE4.
  5977             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5978             20  FILLER                  PIC X.
  5979         16  AT-EOB-CODE5                PIC XXX.
  5980         16  FILLER REDEFINES AT-EOB-CODE5.
  5981             20  AT-PMT-PROOF-DT         PIC XX.
  5982             20  FILLER                  PIC X.
  5983
  5984         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5985             88  AT-PRINT-EOB            VALUE 'Y'.
  5986
  5987         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5988         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5989
  5990     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5991         16  AT-SCHEDULE-START-DT        PIC XX.
  5992         16  AT-SCHEDULE-END-DT          PIC XX.
  5993         16  AT-TERMINATED-DT            PIC XX.
  5994         16  AT-LAST-PMT-TYPE            PIC X.
  5995             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5996             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5997         16  AT-FIRST-PMT-DATA.
  5998             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5999             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6000             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6001         16  AT-REGULAR-PMT-DATA.
  6002             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6003             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6004             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6005         16  AT-AUTO-PAYEE-CD.
  6006             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6007                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6008                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6009                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6010                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6011                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6012             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6013         16  AT-AUTO-PAY-DAY             PIC 99.
  6014         16  AT-AUTO-CASH                PIC X.
  6015             88  AT-CASH                      VALUE 'Y'.
  6016             88  AT-NON-CASH                  VALUE 'N'.
  6017*        16  FILLER                      PIC X(129).
  6018         16  AT-AUTO-END-LETTER          PIC X(4).
  6019         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL156.cbl
  6020
  6021         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6022         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6023
  6024     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6025         16  AT-LETTER-SENT-DT           PIC XX.
  6026         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6027         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6028         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6029         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6030         16  AT-LETTER-ORIGIN            PIC X.
  6031             88  ONLINE-CREATION              VALUE '1' '3'.
  6032             88  OFFLINE-CREATION             VALUE '2' '4'.
  6033             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6034             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6035         16  AT-STD-LETTER-FORM          PIC X(4).
  6036         16  AT-REASON-TEXT              PIC X(70).
  6037         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6038         16  AT-ADDRESEE-TYPE            PIC X.
  6039              88  INSURED-ADDRESEE            VALUE 'I'.
  6040              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6041              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6042              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6043              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6044              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6045              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6046         16  AT-ADDRESSEE-NAME           PIC X(30).
  6047         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6048         16  AT-RESEND-PRINT-DATE        PIC XX.
  6049         16  AT-CORR-SOL-UNSOL           PIC X.
  6050         16  AT-LETTER-PURGED-DT         PIC XX.
  6051*
  6052*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6053*
  6054         16  AT-CSO-REDEFINITION.
  6055             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6056             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6057             20  AT-LETTER-TO-BENE       PIC X(1).
  6058             20  AT-STOP-LETTER-DT       PIC X(2).
  6059             20  FILLER                  PIC X(19).
  6060*             20  FILLER                  PIC X(27).
  6061             20  AT-CSO-LETTER-STATUS    PIC X.
  6062                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6063                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6064                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6065             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6066             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6067*
  6068*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6069*
  6070*        16  FILLER                      PIC X(26).
  6071*
  6072*        16  AT-DMD-BSR-CODE             PIC X.
  6073*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6074*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6075*
  6076*        16  AT-DMD-LETTER-STATUS        PIC X.
  6077*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL156.cbl
  6078*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6079*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6080*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6081*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6082
  6083         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6084         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6085
  6086     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6087         16  AT-ADDRESS-TYPE             PIC X.
  6088             88  INSURED-ADDRESS               VALUE 'I'.
  6089             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6090             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6091             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6092             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6093             88  OTHER-ADDRESS-1               VALUE 'O'.
  6094             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6095         16  AT-MAIL-TO-NAME             PIC X(30).
  6096         16  AT-ADDRESS-LINE-1           PIC X(30).
  6097         16  AT-ADDRESS-LINE-2           PIC X(30).
  6098         16  AT-CITY-STATE.
  6099             20  AT-CITY                 PIC X(28).
  6100             20  AT-STATE                PIC XX.
  6101         16  AT-ZIP.
  6102             20  AT-ZIP-CODE.
  6103                 24  AT-ZIP-1ST          PIC X.
  6104                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6105                 24  FILLER              PIC X(4).
  6106             20  AT-ZIP-PLUS4            PIC X(4).
  6107         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6108             20  AT-CAN-POSTAL-1         PIC XXX.
  6109             20  AT-CAN-POSTAL-2         PIC XXX.
  6110             20  FILLER                  PIC XXX.
  6111         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6112*         16  FILLER                      PIC X(23).
  6113         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6114         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6115         16  FILLER                      PIC X(13).
  6116         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6117         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6118
  6119     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6120         16  AT-INFO-LINE-1              PIC X(60).
  6121         16  AT-INFO-LINE-2              PIC X(60).
  6122         16  AT-INFO-TRAILER-TYPE        PIC X.
  6123             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6124             88  AT-CALL-NOTE            VALUE 'C'.
  6125             88  AT-MAINT-NOTE           VALUE 'M'.
  6126             88  AT-CERT-CHANGE          VALUE 'X'.
  6127             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6128             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6129         16  AT-CALL-TYPE                PIC X.
  6130             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6131             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6132         16  AT-NOTE-CONTINUATION        PIC X.
  6133             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6134         16  AT-EOB-CODES-EXIST          PIC X.
  6135             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL156.cbl
  6136         16  FILLER                      PIC X(35).
  6137         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6138         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6139
  6140     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6141         16  AT-PROMPT-LINE-1            PIC X(60).
  6142         16  AT-PROMPT-LINE-2            PIC X(60).
  6143         16  AT-PROMPT-START-DT          PIC XX.
  6144         16  AT-PROMPT-END-DT            PIC XX.
  6145         16  FILLER                      PIC X(35).
  6146         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6147         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6148
  6149     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6150         16  AT-DENIAL-INFO-1            PIC X(60).
  6151         16  AT-DENIAL-INFO-2            PIC X(60).
  6152         16  AT-DENIAL-DT                PIC XX.
  6153         16  AT-RETRACTION-DT            PIC XX.
  6154         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6155*         16  FILLER                      PIC X(31).
  6156         16  AT-DENIAL-PROOF-DT          PIC XX.
  6157         16  FILLER                      PIC X(29).
  6158         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6159         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6160
  6161     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6162         16  AT-OLD-INCURRED-DT          PIC XX.
  6163         16  AT-OLD-REPORTED-DT          PIC XX.
  6164         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6165         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6166         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6167         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6168         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6169         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6170         16  FILLER                      PIC X(26).
  6171         16  AT-OLD-DIAG-CODE            PIC X(6).
  6172         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6173         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6174         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6175         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6176         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6177         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6178         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6179         16  FILLER                      PIC X(25).
  6180         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6181
  6182     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6183         16  AT-FORM-SEND-ON-DT          PIC XX.
  6184         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6185         16  AT-FORM-RE-SEND-DT          PIC XX.
  6186         16  AT-FORM-ANSWERED-DT         PIC XX.
  6187         16  AT-FORM-PRINTED-DT          PIC XX.
  6188         16  AT-FORM-REPRINT-DT          PIC XX.
  6189         16  AT-FORM-TYPE                PIC X.
  6190             88  INITIAL-FORM                  VALUE '1'.
  6191             88  PROGRESS-FORM                 VALUE '2'.
  6192         16  AT-INSTRUCT-LN-1            PIC X(28).
  6193         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL156.cbl
  6194         16  AT-INSTRUCT-LN-3            PIC X(28).
  6195         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6196         16  AT-FORM-ADDRESS             PIC X.
  6197             88  FORM-TO-INSURED              VALUE 'I'.
  6198             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6199             88  FORM-TO-OTHER-1              VALUE 'O'.
  6200             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6201         16  AT-RELATED-1.
  6202             20 AT-REL-CARR-1            PIC X.
  6203             20 AT-REL-CLAIM-1           PIC X(7).
  6204             20 AT-REL-CERT-1            PIC X(11).
  6205         16  AT-RELATED-2.
  6206             20 AT-REL-CARR-2            PIC X.
  6207             20 AT-REL-CLAIM-2           PIC X(7).
  6208             20 AT-REL-CERT-2            PIC X(11).
  6209         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6210         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6211         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6212         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6213         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6214         16  AT-STOP-FORM-DT             PIC X(2).
  6215
  6216         16  FILLER                      PIC X(09).
  6217         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6218         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6219******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL156.cbl
  6221*    COPY ELCACTQ.
  6222******************************************************************
  6223*                                                                *
  6224*                            ELCACTQ.                            *
  6225*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6226*                            VMOD=2.004                          *
  6227*                                                                *
  6228*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6229*                                                                *
  6230*   FILE TYPE = VSAM,KSDS                                        *
  6231*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6232*                                                                *
  6233*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6234*       ALTERNATE INDEX = NONE                                   *
  6235*                                                                *
  6236*   LOG = YES                                                    *
  6237*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6238*                                                                *
  6239*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6240******************************************************************
  6241
  6242 01  ACTIVITY-QUE.
  6243     12  AQ-RECORD-ID                PIC XX.
  6244         88  VALID-AQ-ID                VALUE 'AQ'.
  6245
  6246     12  AQ-CONTROL-PRIMARY.
  6247         16  AQ-COMPANY-CD           PIC X.
  6248         16  AQ-CARRIER              PIC X.
  6249         16  AQ-CLAIM-NO             PIC X(7).
  6250         16  AQ-CERT-NO.
  6251             20  AQ-CERT-PRIME       PIC X(10).
  6252             20  AQ-CERT-SFX         PIC X.
  6253
  6254     12  AQ-PENDING-ACTIVITY-FLAGS.
  6255         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6256         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6257             88  PENDING-PAYMENTS       VALUE '1'.
  6258         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6259             88  PENDING-FULL-PRINT     VALUE '1'.
  6260             88  PENDING-PART-PRINT     VALUE '2'.
  6261         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6262             88  PENDING-LETTERS        VALUE '1'.
  6263         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6264             88  PENDING-RESTORE        VALUE 'C'.
  6265             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6266
  6267     12  FILLER                      PIC X(20).
  6268
  6269     12  AQ-RESEND-DATE              PIC XX.
  6270     12  AQ-FOLLOWUP-DATE            PIC XX.
  6271     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6272     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6273     12  AQ-AUTO-LETTER              PIC X(4).
  6274     12  FILLER                      PIC XX.
  6275     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6276*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL156.cbl
  6278*    COPY ERCACCT.
  6279******************************************************************
  6280*                                                                *
  6281*                                                                *
  6282*                            ERCACCT                             *
  6283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6284*                            VMOD=2.031                          *
  6285*                                                                *
  6286*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6287*                                                                *
  6288*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6289*   VSAM ACCOUNT MASTER FILES.                                   *
  6290*                                                                *
  6291*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6292*                                                                *
  6293*   FILE TYPE = VSAM,KSDS                                        *
  6294*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6295*                                                                *
  6296*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6297*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6298*                                                                *
  6299*   LOG = NO                                                     *
  6300*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6301*                                                                *
  6302*                                                                *
  6303******************************************************************
  6304*                   C H A N G E   L O G
  6305*
  6306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6307*-----------------------------------------------------------------
  6308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6309* EFFECTIVE    NUMBER
  6310*-----------------------------------------------------------------
  6311* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6312* 092705    2005050300006  PEMA  ADD SPP LEASES
  6313* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6314* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6315* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6316* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6317* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6318******************************************************************
  6319
  6320 01  ACCOUNT-MASTER.
  6321     12  AM-RECORD-ID                      PIC XX.
  6322         88  VALID-AM-ID                      VALUE 'AM'.
  6323
  6324     12  AM-CONTROL-PRIMARY.
  6325         16  AM-COMPANY-CD                 PIC X.
  6326         16  AM-MSTR-CNTRL.
  6327             20  AM-CONTROL-A.
  6328                 24  AM-CARRIER            PIC X.
  6329                 24  AM-GROUPING.
  6330                     28 AM-GROUPING-PREFIX PIC XXX.
  6331                     28 AM-GROUPING-PRIME  PIC XXX.
  6332                 24  AM-STATE              PIC XX.
  6333                 24  AM-ACCOUNT.
  6334                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6335                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL156.cbl
  6336             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6337                                           PIC X(19).
  6338             20  AM-CNTRL-B.
  6339                 24  AM-EXPIRATION-DT      PIC XX.
  6340                 24  FILLER                PIC X(4).
  6341             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6342                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6343
  6344     12  AM-CONTROL-BY-VAR-GRP.
  6345         16  AM-COMPANY-CD-A1              PIC X.
  6346         16  AM-VG-CARRIER                 PIC X.
  6347         16  AM-VG-GROUPING                PIC X(6).
  6348         16  AM-VG-STATE                   PIC XX.
  6349         16  AM-VG-ACCOUNT                 PIC X(10).
  6350         16  AM-VG-DATE.
  6351             20  AM-VG-EXPIRATION-DT       PIC XX.
  6352             20  FILLER                    PIC X(4).
  6353         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6354                                           PIC 9(11)      COMP-3.
  6355     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6356         16  FILLER                        PIC X(10).
  6357         16  AM-VG-KEY3.
  6358             20  AM-VG3-ACCOUNT            PIC X(10).
  6359             20  AM-VG3-EXP-DT             PIC XX.
  6360         16  FILLER                        PIC X(4).
  6361     12  AM-MAINT-INFORMATION.
  6362         16  AM-LAST-MAINT-DT              PIC XX.
  6363         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6364         16  AM-LAST-MAINT-USER            PIC X(4).
  6365         16  FILLER                        PIC XX.
  6366
  6367     12  AM-EFFECTIVE-DT                   PIC XX.
  6368     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6369
  6370     12  AM-PREV-DATES  COMP-3.
  6371         16  AM-PREV-EXP-DT                PIC 9(11).
  6372         16  AM-PREV-EFF-DT                PIC 9(11).
  6373
  6374     12  AM-REPORT-CODE-1                  PIC X(10).
  6375     12  AM-REPORT-CODE-2                  PIC X(10).
  6376
  6377     12  AM-CITY-CODE                      PIC X(4).
  6378     12  AM-COUNTY-PARISH                  PIC X(6).
  6379
  6380     12  AM-NAME                           PIC X(30).
  6381     12  AM-PERSON                         PIC X(30).
  6382     12  AM-ADDRS                          PIC X(30).
  6383     12  AM-CITY.
  6384         16  AM-ADDR-CITY                  PIC X(28).
  6385         16  AM-ADDR-STATE                 PIC XX.
  6386     12  AM-ZIP.
  6387         16  AM-ZIP-PRIME.
  6388             20  AM-ZIP-PRI-1ST            PIC X.
  6389                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6390             20  FILLER                    PIC X(4).
  6391         16  AM-ZIP-PLUS4                  PIC X(4).
  6392     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6393         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL156.cbl
  6394         16  AM-CAN-POSTAL-2               PIC XXX.
  6395         16  FILLER                        PIC XXX.
  6396     12  AM-TEL-NO.
  6397         16  AM-AREA-CODE                  PIC 999.
  6398         16  AM-TEL-PRE                    PIC 999.
  6399         16  AM-TEL-NBR                    PIC 9(4).
  6400     12  AM-TEL-LOC                        PIC X.
  6401         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6402         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6403
  6404     12  AM-COMM-STRUCTURE.
  6405         16  AM-DEFN-1.
  6406             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6407                 24  AM-AGT.
  6408                     28  AM-AGT-PREFIX     PIC X(4).
  6409                     28  AM-AGT-PRIME      PIC X(6).
  6410                 24  AM-COM-TYP            PIC X.
  6411                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6412                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6413                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6414                 24  AM-RECALC-LV-INDIC    PIC X.
  6415                 24  AM-RETRO-LV-INDIC     PIC X.
  6416                 24  AM-GL-CODES           PIC X.
  6417                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6418                 24  FILLER                PIC X(01).
  6419         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6420             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6421                 24  FILLER                PIC X(11).
  6422                 24  AM-L-COMA             PIC XXX.
  6423                 24  AM-J-COMA             PIC XXX.
  6424                 24  AM-A-COMA             PIC XXX.
  6425                 24  FILLER                PIC X(6).
  6426
  6427     12  AM-COMM-CHANGE-STATUS             PIC X.
  6428         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6429
  6430     12  AM-CSR-CODE                       PIC X(4).
  6431
  6432     12  AM-BILLING-STATUS                 PIC X.
  6433         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6434         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6435     12  AM-AUTO-REFUND-SW                 PIC X.
  6436         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6437         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6438     12  AM-GPCD                           PIC 99.
  6439     12  AM-IG                             PIC X.
  6440         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6441         88  AM-HAS-GROUP                     VALUE '2'.
  6442     12  AM-STATUS                         PIC X.
  6443         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6444         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6445         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6446         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6447         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6448         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6449     12  AM-REMIT-TO                       PIC 99.
  6450     12  AM-ID-NO                          PIC X(11).
  6451
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL156.cbl
  6452     12  AM-CAL-TABLE                      PIC XX.
  6453     12  AM-LF-DEVIATION                   PIC XXX.
  6454     12  AM-AH-DEVIATION                   PIC XXX.
  6455     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6456     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6457     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6458     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6459     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6460     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6461
  6462     12  AM-USER-FIELDS.
  6463         16  AM-FLD-1                      PIC XX.
  6464         16  AM-FLD-2                      PIC XX.
  6465         16  AM-FLD-3                      PIC XX.
  6466         16  AM-FLD-4                      PIC XX.
  6467         16  AM-FLD-5                      PIC XX.
  6468
  6469     12  AM-1ST-PROD-DATE.
  6470         16  AM-1ST-PROD-YR                PIC XX.
  6471         16  AM-1ST-PROD-MO                PIC XX.
  6472         16  AM-1ST-PROD-DA                PIC XX.
  6473     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6474     12  AM-CERTS-PURGED-DATE.
  6475         16  AM-PUR-YR                     PIC XX.
  6476         16  AM-PUR-MO                     PIC XX.
  6477         16  AM-PUR-DA                     PIC XX.
  6478     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6479     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6480     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6481     12  AM-INACTIVE-DATE.
  6482         16  AM-INA-MO                     PIC 99.
  6483         16  AM-INA-DA                     PIC 99.
  6484         16  AM-INA-YR                     PIC 99.
  6485     12  AM-AR-HI-CERT-DATE                PIC XX.
  6486
  6487     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6488     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6489
  6490     12  AM-OB-PAYMENT-MODE                PIC X.
  6491         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6492         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6493         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6494         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6495
  6496     12  AM-AH-ONLY-INDICATOR              PIC X.
  6497         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6498         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6499
  6500     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6501
  6502     12  AM-OVER-SHORT.
  6503         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6504         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6505
  6506     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6507     12  AM-DCC-CLP-STATE                  PIC XX.
  6508
  6509     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL156.cbl
  6510     12  AM-RECALC-REIN                    PIC X.
  6511
  6512     12  AM-REI-TABLE                      PIC XXX.
  6513     12  AM-REI-ET-LF                      PIC X.
  6514     12  AM-REI-ET-AH                      PIC X.
  6515     12  AM-REI-PE-LF                      PIC X.
  6516     12  AM-REI-PE-AH                      PIC X.
  6517     12  AM-REI-PRT-ST                     PIC X.
  6518     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6519     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6520     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6521     12  AM-REI-GROUP-A                    PIC X(6).
  6522     12  AM-REI-MORT                       PIC X(4).
  6523     12  AM-REI-PRT-OW                     PIC X.
  6524     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6525     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6526     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6527     12  AM-REI-GROUP-B                    PIC X(6).
  6528
  6529     12  AM-TRUST-TYPE                     PIC X(2).
  6530
  6531     12  AM-EMPLOYER-STMT-USED             PIC X.
  6532     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6533
  6534     12  AM-STD-AH-TYPE                    PIC XX.
  6535     12  AM-EARN-METHODS.
  6536         16  AM-EARN-METHOD-R              PIC X.
  6537             88 AM-REF-RL-R78                 VALUE 'R'.
  6538             88 AM-REF-RL-PR                  VALUE 'P'.
  6539             88 AM-REF-RL-MEAN                VALUE 'M'.
  6540             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6541         16  AM-EARN-METHOD-L              PIC X.
  6542             88 AM-REF-LL-R78                 VALUE 'R'.
  6543             88 AM-REF-LL-PR                  VALUE 'P'.
  6544             88 AM-REF-LL-MEAN                VALUE 'M'.
  6545             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6546         16  AM-EARN-METHOD-A              PIC X.
  6547             88 AM-REF-AH-R78                 VALUE 'R'.
  6548             88 AM-REF-AH-PR                  VALUE 'P'.
  6549             88 AM-REF-AH-MEAN                VALUE 'M'.
  6550             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6551             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6552             88 AM-REF-AH-NET                 VALUE 'N'.
  6553
  6554     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6555     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6556     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6557
  6558     12  AM-RET-Y-N                        PIC X.
  6559     12  AM-RET-P-E                        PIC X.
  6560     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6561     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6562     12  AM-RET-GRP                        PIC X(6).
  6563     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6564         16  AM-POOL-PRIME                 PIC XXX.
  6565         16  AM-POOL-SUB                   PIC XXX.
  6566     12  AM-RETRO-EARNINGS.
  6567         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL156.cbl
  6568         16  AM-RET-EARN-L                 PIC X.
  6569         16  AM-RET-EARN-A                 PIC X.
  6570     12  AM-RET-ST-TAX-USE                 PIC X.
  6571         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6572         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6573     12  AM-RETRO-BEG-EARNINGS.
  6574         16  AM-RET-BEG-EARN-R             PIC X.
  6575         16  AM-RET-BEG-EARN-L             PIC X.
  6576         16  AM-RET-BEG-EARN-A             PIC X.
  6577     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6578     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6579
  6580     12  AM-USER-SELECT-OPTIONS.
  6581         16  AM-USER-SELECT-1              PIC X(10).
  6582         16  AM-USER-SELECT-2              PIC X(10).
  6583         16  AM-USER-SELECT-3              PIC X(10).
  6584         16  AM-USER-SELECT-4              PIC X(10).
  6585         16  AM-USER-SELECT-5              PIC X(10).
  6586
  6587     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6588
  6589     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6590
  6591     12  AM-RPT045A-SWITCH                 PIC X.
  6592         88  RPT045A-OFF                   VALUE 'N'.
  6593
  6594     12  AM-INSURANCE-LIMITS.
  6595         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6596         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6597
  6598     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6599         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6600
  6601     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6602         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6603         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6604
  6605     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6606
  6607     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6608     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6609     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6610     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6611     12  AM-DCC-UEF-STATE                  PIC XX.
  6612     12  FILLER                            PIC XXX.
  6613     12  AM-REPORT-CODE-3                  PIC X(10).
  6614*    12  FILLER                            PIC X(22).
  6615
  6616     12  AM-RESERVE-DATE.
  6617         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6618         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6619         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6620
  6621     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6622     12  AM-NOTIFICATION-TYPES.
  6623         16  AM-NOTIF-OF-LETTERS           PIC X.
  6624         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6625         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL156.cbl
  6626         16  AM-NOTIF-OF-STATUS            PIC X.
  6627
  6628     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6629         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6630         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6631         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6632         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6633
  6634     12  AM-BENEFIT-CONTROLS.
  6635         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6636             20  AM-BENEFIT-CODE           PIC XX.
  6637             20  AM-BENEFIT-TYPE           PIC X.
  6638             20  AM-BENEFIT-REVISION       PIC XXX.
  6639             20  AM-BENEFIT-REM-TERM       PIC X.
  6640             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6641             20  FILLER                    PIC XX.
  6642         16  FILLER                        PIC X(80).
  6643
  6644     12  AM-TRANSFER-DATA.
  6645         16  AM-TRANSFERRED-FROM.
  6646             20  AM-TRNFROM-CARRIER        PIC X.
  6647             20  AM-TRNFROM-GROUPING.
  6648                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6649                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6650             20  AM-TRNFROM-STATE          PIC XX.
  6651             20  AM-TRNFROM-ACCOUNT.
  6652                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6653                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6654             20  AM-TRNFROM-DTE            PIC XX.
  6655         16  AM-TRANSFERRED-TO.
  6656             20  AM-TRNTO-CARRIER          PIC X.
  6657             20  AM-TRNTO-GROUPING.
  6658                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6659                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6660             20  AM-TRNTO-STATE            PIC XX.
  6661             20  AM-TRNTO-ACCOUNT.
  6662                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6663                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6664             20  AM-TRNTO-DTE              PIC XX.
  6665         16  FILLER                        PIC X(10).
  6666
  6667     12  AM-SAVED-REMIT-TO                 PIC 99.
  6668
  6669     12  AM-COMM-STRUCTURE-SAVED.
  6670         16  AM-DEFN-1-SAVED.
  6671             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6672                 24  AM-AGT-SV             PIC X(10).
  6673                 24  AM-COM-TYP-SV         PIC X.
  6674                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6675                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6676                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6677                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6678                 24  FILLER                PIC X.
  6679                 24  AM-GL-CODES-SV        PIC X.
  6680                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6681                 24  FILLER                PIC X.
  6682         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6683             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL156.cbl
  6684                 24  FILLER                PIC X(11).
  6685                 24  AM-L-COMA-SV          PIC XXX.
  6686                 24  AM-J-COMA-SV          PIC XXX.
  6687                 24  AM-A-COMA-SV          PIC XXX.
  6688                 24  FILLER                PIC X(6).
  6689
  6690     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6691         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6692            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6693            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6694            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6695
  6696     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6697     12  FILLER                            PIC X(120).
  6698
  6699     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6700         16  AM-CONTROL-NAME               PIC X(30).
  6701         16  AM-EXECUTIVE-ONE.
  6702             20  AM-EXEC1-NAME             PIC X(15).
  6703             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6704                                                          COMP-3.
  6705             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6706                                                          COMP-3.
  6707         16  AM-EXECUTIVE-TWO.
  6708             20  AM-EXEC2-NAME             PIC X(15).
  6709             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6710                                                          COMP-3.
  6711             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6712                                                          COMP-3.
  6713
  6714     12  AM-RETRO-ADDITIONAL-DATA.
  6715         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6716         16  AM-RETRO-PREM-P-E             PIC X.
  6717         16  AM-RETRO-CLMS-P-I             PIC X.
  6718         16  AM-RETRO-RET-BRACKET-LF.
  6719             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6720                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6721                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6722             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6723                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6724                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6725             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6726                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6727                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6728         16  AM-RETRO-RET-BRACKET-AH.
  6729             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6730                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6731                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6732                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6733             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6734                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6735                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6736             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6737                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6738                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6739
  6740     12  AM-COMMENTS.
  6741         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL156.cbl
  6742
  6743     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6744         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6745         16  AM-FLI-BILLING-CODE           PIC X.
  6746         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6747         16  AM-FLI-UNITED-IDENT           PIC X.
  6748         16  AM-FLI-INTEREST-LOST-DATA.
  6749             20  AM-FLI-BANK-NO            PIC X(5).
  6750             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6751             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6752             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6753         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6754             20  AM-FLI-AGT                PIC X(9).
  6755             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6756             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6757         16  FILLER                        PIC X(102).
  6758
  6759     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6760         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6761             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6762             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6763             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6764             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6765             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6766         16  FILLER                          PIC X(10).
  6767******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL156.cbl
  6769*    COPY ELCCHKQ.
  6770******************************************************************
  6771*                                                                *
  6772*                                                                *
  6773*                            ELCCHKQ.                            *
  6774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6775*                            VMOD=2.007                          *
  6776*                                                                *
  6777*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6778*                                                                *
  6779*   FILE TYPE = VSAM,KSDS                                        *
  6780*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6781*                                                                *
  6782*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6783*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6784*                                                                *
  6785*   LOG = YES                                                    *
  6786*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6787******************************************************************
  6788 01  CHECK-QUE.
  6789     12  CQ-RECORD-ID                PIC XX.
  6790         88  VALID-CQ-ID         VALUE 'CQ'.
  6791
  6792     12  CQ-CONTROL-PRIMARY.
  6793         16  CQ-COMPANY-CD           PIC X.
  6794         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6795         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6796
  6797     12  CQ-CONTROL-BY-PAYEE.
  6798         16  CQ-CONTROL-BY-NUMBER.
  6799             20  CQ-COMPANY-CD-A1     PIC X.
  6800             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6801         16  CQ-PAYEE-CARRIER        PIC X.
  6802         16  CQ-PAYEE-GROUPING       PIC X(6).
  6803         16  CQ-PAYEE-STATE          PIC XX.
  6804         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6805         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6806
  6807     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6808         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6809         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6810         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6811         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6812         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6813         16  FILLER                  PIC X(3).
  6814
  6815     12  CQ-ENTRY-TYPE               PIC X.
  6816             88  CHECK-ON-QUE           VALUE 'Q'.
  6817             88  ALIGNMENT-CHECK        VALUE 'A'.
  6818             88  SPOILED-CHECK          VALUE 'S'.
  6819             88  PAYMENT-ABORTED        VALUE 'X'.
  6820
  6821     12  CQ-CLAIM-MAST-CNTL.
  6822         16  CQ-CARRIER              PIC X.
  6823         16  CQ-CLAIM-NO             PIC X(7).
  6824         16  CQ-CERT-NO.
  6825             20  CQ-CERT-PRIME       PIC X(10).
  6826             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL156.cbl
  6827         16  CQ-CLAIM-TYPE           PIC X.
  6828             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6829             88  CQ-AH-CLAIM            VALUE 'A'.
  6830         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6831             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6832             88  CQ-O-B-COVERAGE        VALUE '2'.
  6833             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6834
  6835     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6836     12  CQ-CHECK-NUMBER             PIC X(7).
  6837     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6838     12  CQ-PAYMENT-TYPE             PIC X.
  6839             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6840             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6841             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6842             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6843             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6844             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6845             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6846             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6847     12  CQ-VOID-INDICATOR           PIC X.
  6848             88  CHECK-IS-STOPPED          VALUE 'S'.
  6849             88  CHECK-IS-VOID             VALUE 'V'.
  6850     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6851     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6852     12  CQ-CHECK-BY-USER            PIC X(4).
  6853     12  CQ-PRE-NUMBERING-SW         PIC X.
  6854       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6855       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6856
  6857     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6858     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6859     12  CQ-LEDGER-FLAG              PIC X(01).
  6860     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6861     12  CQ-LAST-UPDATED-DT          PIC XX.
  6862     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6863     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6864
  6865     12  FILLER                      PIC X(04).
  6866
  6867******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL156.cbl
  6869*    COPY ELCBENE.
  6870******************************************************************
  6871*                                                                *
  6872*                            ELCBENE.                            *
  6873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6874*                            VMOD=2.006                          *
  6875*                                                                *
  6876*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6877*                                                                *
  6878*   FILE TYPE = VSAM,KSDS                                        *
  6879*   RECORD SIZE = 500   RECFORM = FIX                            *
  6880*                                                                *
  6881*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6882*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6883*                                                                *
  6884*   LOG = YES                                                    *
  6885*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6886*                                                                *
  6887*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6888******************************************************************
  6889
  6890 01  BENEFICIARY-MASTER.
  6891     12  BE-RECORD-ID                PIC XX.
  6892         88  VALID-BE-ID                VALUE 'BE'.
  6893
  6894     12  BE-CONTROL-PRIMARY.
  6895         16  BE-COMPANY-CD           PIC X.
  6896         16  BE-RECORD-TYPE          PIC X.
  6897             88  BENEFICIARY-RECORD  VALUE 'B'.
  6898             88  ADJUSTOR-RECORD     VALUE 'A'.
  6899         16  BE-BENEFICIARY          PIC X(10).
  6900     12  BE-CONTROL-BY-NAME.
  6901         16  BE-COMPANY-CD-A1        PIC X.
  6902         16  BE-RECORD-TYPE-A1       PIC X.
  6903         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6904         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6905
  6906     12  BE-LAST-MAINT-DT            PIC XX.
  6907     12  BE-LAST-MAINT-BY            PIC X(4).
  6908     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6909
  6910     12  BE-ADDRESS-DATA.
  6911         16  BE-MAIL-TO-NAME         PIC X(30).
  6912         16  BE-ADDRESS-LINE-1       PIC X(30).
  6913         16  BE-ADDRESS-LINE-2       PIC X(30).
  6914         16  BE-ADDRESS-LINE-3       PIC X(30).
  6915         16  BE-CITY-STATE.
  6916             20  BE-CITY             PIC X(28).
  6917             20  BE-STATE            PIC XX.
  6918         16  BE-ZIP-CODE.
  6919             20  BE-ZIP-PRIME.
  6920                 24  BE-ZIP-1ST      PIC X.
  6921                     88  BE-CANADIAN-POST-CODE
  6922                                         VALUE 'A' THRU 'Z'.
  6923                 24  FILLER          PIC X(4).
  6924             20  BE-ZIP-PLUS4        PIC X(4).
  6925         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6926             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL156.cbl
  6927             20  BE-CAN-POSTAL-2     PIC XXX.
  6928             20  FILLER              PIC XXX.
  6929         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6930         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6931
  6932******************************************************************
  6933*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6934*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6935******************************************************************
  6936     12  BE-CARRIER                  PIC X.
  6937
  6938     12  BE-ADDRESS-DATA2.
  6939         16  BE-MAIL-TO-NAME2        PIC X(30).
  6940         16  BE-ADDRESS-LINE-12      PIC X(30).
  6941         16  BE-ADDRESS-LINE-22      PIC X(30).
  6942         16  BE-ADDRESS-LINE-32      PIC X(30).
  6943         16  BE-CITY-STATE2.
  6944             20  BE-CITY2            PIC X(28).
  6945             20  BE-STATE2           PIC XX.
  6946         16  BE-ZIP-CODE2.
  6947             20  BE-ZIP-PRIME2.
  6948                 24  BE-ZIP-1ST2     PIC X.
  6949                     88  BE-CANADIAN-POST-CODE2
  6950                                         VALUE 'A' THRU 'Z'.
  6951                 24  FILLER          PIC X(4).
  6952             20  BE-ZIP-PLUS42       PIC X(4).
  6953         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6954             20  BE-CAN-POSTAL-12    PIC XXX.
  6955             20  BE-CAN-POSTAL-22    PIC XXX.
  6956             20  FILLER              PIC XXX.
  6957         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6958         16  BE-BILLING-STMT-DATA.
  6959             20  BE-BSR              PIC X.
  6960                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6961                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6962             20  BE-BSR-FROM         PIC X(30).
  6963             20  BE-BSR-DEPT         PIC X(30).
  6964             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6965             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6966             20  BE-OUTPUT-TYPE      PIC X.
  6967                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6968                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6969
  6970     12  FILLER                      PIC X(28).
  6971******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL156.cbl
  6973*    COPY ELCARCH.
  6974******************************************************************
  6975*                                                                *
  6976*                            ELCARCH.                            *
  6977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6978*                            VMOD=2.007                          *
  6979*                                                                *
  6980*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6981*                                                                *
  6982*   FILE TYPE = VSAM,KSDS                                        *
  6983*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6984*                                                                *
  6985*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6986*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6987*                                                                *
  6988*   LOG = NO                                                     *
  6989*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6990*                                                                *
  6991*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6992******************************************************************
  6993 01  LETTER-ARCHIVE.
  6994     12  LA-RECORD-ID                PIC XX.
  6995         88  VALID-LA-ID                VALUE 'LA'.
  6996
  6997     12  LA-CONTROL-PRIMARY.
  6998         16  LA-COMPANY-CD           PIC X.
  6999         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7000         16  LA-RECORD-TYPE          PIC X.
  7001             88  LA-HEADER-DATA         VALUE '1'.
  7002             88  LA-ADDRESS-DATA        VALUE '2'.
  7003             88  LA-TEXT-DATA           VALUE '3'.
  7004             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7005         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7006
  7007     12  LA-CONTROL-BY-TYPE.
  7008         16  LA-COMPANY-CD-A1        PIC X.
  7009         16  LA-RECORD-TYPE-A1       PIC X.
  7010         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7011         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7012
  7013     12  LA-TEXT-RECORD.
  7014         16  LA-SKIP-CONTROL         PIC XX.
  7015             88  NO-LINES-SKIPPED       VALUE SPACES.
  7016             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7017         16  LA-TEXT-LINE            PIC X(70).
  7018
  7019     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7020         16  FILLER                  PIC XX.
  7021         16  LA-ADDRESS-LINE         PIC X(30).
  7022         16  FILLER                  PIC X(40).
  7023
  7024     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7025         16  FILLER                  PIC XX.
  7026         16  LA-CARRIER              PIC X.
  7027         16  LA-CLAIM-NO             PIC X(7).
  7028         16  LA-CERT-NO.
  7029             20  LA-CERT-PRIME       PIC X(10).
  7030             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL156.cbl
  7031         16  LA-NO-OF-COPIES         PIC S9.
  7032         16  LA-RESEND-DATE          PIC XX.
  7033         16  LA-PROCESSOR-CD         PIC X(4).
  7034         16  LA-CREATION-DT          PIC XX.
  7035         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7036         16  LA-RESEND-PRINT-DATE    PIC XX.
  7037         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7038         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7039*
  7040* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7041*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7042*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7043*   I        20  LA-DMD-RES-ST           PIC XX.
  7044*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7045*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7046*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7047*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7048*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7049*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7050*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7051*   I        20  LA-DMD-UND-CODE         PIC XX.
  7052*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7053*   V    16  FILLER                  PIC X(15).
  7054* -----
  7055*
  7056* REINSERTED  CSO  MODS
  7057*
  7058         16  FILLER.
  7059             20  FILLER                  PIC X(29).
  7060             20  LA-CSO-LETTER-STATUS    PIC X.
  7061                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7062                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7063                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7064             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7065             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7066*
  7067
  7068     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7069         16  FILLER                  PIC XX.
  7070         16  LA4-CARRIER             PIC X.
  7071         16  LA4-CLAIM-NO            PIC X(7).
  7072         16  LA4-CERT-NO.
  7073             20  LA4-CERT-PRIME      PIC X(10).
  7074             20  LA4-CERT-SFX        PIC X.
  7075         16  LA4-NO-OF-COPIES        PIC S9.
  7076         16  LA4-RESEND-DATE         PIC XX.
  7077         16  LA4-PROCESSOR-CD        PIC X(4).
  7078         16  LA4-CREATION-DT         PIC XX.
  7079         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7080         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7081         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7082         16  LA4-FORM-TYPE           PIC X.
  7083             88  LA4-INITIAL-FORM    VALUE '1'.
  7084             88  LA4-PROGRESS-FORM   VALUE '2'.
  7085         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7086         16  LA4-STATE               PIC X(02).
  7087         16  FILLER                  PIC X(31).
  7088******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL156.cbl
  7090*    COPY ELCDAR.
  7091******************************************************************
  7092*                                                                *
  7093*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7094*   FILE TYPE = VSAM,KSDS                                        *
  7095*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7096*   BASE CLUSTER = DLYACTV                                       *
  7097*   LOG = YES                                                    *
  7098*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7099*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7100*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7101*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7102*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7103*               BY PROGRAM "LGINFCE".                            *
  7104*                                                                *
  7105******************************************************************
  7106 01  DAILY-ACTIVITY-RECORD.
  7107     05  DA-KEY.
  7108         10  DA-COMP-CD          PIC X.
  7109         10  DA-CARRIER          PIC X.
  7110         10  DA-CLAIM-NO         PIC X(7).
  7111         10  DA-CERT-NO.
  7112             15  DA-CERT-PRIME   PIC X(10).
  7113             15  DA-CERT-SFX     PIC X.
  7114     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7115     05  DA-RECORD-TYPE          PIC X.
  7116     05  FILLER                  PIC X(2).
  7117******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL156.cbl
  7119*    COPY ERCCOMP.
  7120******************************************************************
  7121*                                                                *
  7122*                                                                *
  7123*                            ERCCOMP                             *
  7124*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7125*                            VMOD=2.019                          *
  7126*                                                                *
  7127*   ONLINE CREDIT SYSTEM                                         *
  7128*                                                                *
  7129*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7130*                                                                *
  7131*   FILE TYPE = VSAM,KSDS                                        *
  7132*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7133*                                                                *
  7134*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7135*       ALTERNATE PATH = NONE                                    *
  7136*                                                                *
  7137*   LOG = NO                                                     *
  7138*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7139*                                                                *
  7140******************************************************************
  7141*                   C H A N G E   L O G
  7142*
  7143* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7144*-----------------------------------------------------------------
  7145*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7146* EFFECTIVE    NUMBER
  7147*-----------------------------------------------------------------
  7148* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7149* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7150* 092205    2005050300006  PEMA  ADD LEASE FEE
  7151* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7152* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7153* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7154* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7155* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7156******************************************************************
  7157
  7158 01  COMPENSATION-MASTER.
  7159     12  CO-RECORD-ID                          PIC XX.
  7160         88  VALID-CO-ID                          VALUE 'CO'.
  7161
  7162     12  CO-CONTROL-PRIMARY.
  7163         16  CO-COMPANY-CD                     PIC X.
  7164         16  CO-CONTROL.
  7165             20  CO-CTL-1.
  7166                 24  CO-CARR-GROUP.
  7167                     28  CO-CARRIER            PIC X.
  7168                     28  CO-GROUPING.
  7169                         32  CO-GROUP-PREFIX   PIC XXX.
  7170                         32  CO-GROUP-PRIME    PIC XXX.
  7171                 24  CO-RESP-NO.
  7172                     28  CO-RESP-PREFIX        PIC X(4).
  7173                     28  CO-RESP-PRIME         PIC X(6).
  7174             20  CO-CTL-2.
  7175                 24  CO-ACCOUNT.
  7176                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL156.cbl
  7177                     28  CO-ACCT-PRIME         PIC X(6).
  7178         16  CO-TYPE                           PIC X.
  7179             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7180             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7181             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7182
  7183     12  CO-MAINT-INFORMATION.
  7184         16  CO-LAST-MAINT-DT                  PIC XX.
  7185         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7186         16  CO-LAST-MAINT-USER                PIC X(4).
  7187     12  FILLER                                PIC XX.
  7188     12  CO-STMT-TYPE                          PIC XXX.
  7189     12  CO-COMP-TYPE                          PIC X.
  7190         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7191     12  CO-STMT-OWNER                         PIC X(4).
  7192     12  CO-BALANCE-CONTROL                    PIC X.
  7193         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7194         88  CO-NO-BALANCE                        VALUE 'N'.
  7195
  7196     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7197         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7198         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7199         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7200
  7201     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7202         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7203         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7204
  7205     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7206     12  CO-GA-DIRECT-DEP                      PIC X.
  7207     12  CO-FUTURE-SPACE                       PIC X.
  7208         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7209
  7210     12  CO-ACCT-NAME                          PIC X(30).
  7211     12  CO-MAIL-NAME                          PIC X(30).
  7212     12  CO-ADDR-1                             PIC X(30).
  7213     12  CO-ADDR-2                             PIC X(30).
  7214     12  CO-ADDR-3.
  7215         16  CO-ADDR-CITY                      PIC X(27).
  7216         16  CO-ADDR-STATE                     PIC XX.
  7217     12  CO-CSO-1099                           PIC X.
  7218     12  CO-ZIP.
  7219         16  CO-ZIP-PRIME.
  7220             20  CO-ZIP-PRI-1ST                PIC X.
  7221                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7222             20  FILLER                        PIC X(4).
  7223         16  CO-ZIP-PLUS4                      PIC X(4).
  7224     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7225         16  CO-CAN-POSTAL-1                   PIC XXX.
  7226         16  CO-CAN-POSTAL-2                   PIC XXX.
  7227         16  FILLER                            PIC XXX.
  7228     12  CO-SOC-SEC                            PIC X(13).
  7229     12  CO-TELEPHONE.
  7230         16  CO-AREA-CODE                      PIC XXX.
  7231         16  CO-PREFIX                         PIC XXX.
  7232         16  CO-PHONE                          PIC X(4).
  7233
  7234     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL156.cbl
  7235
  7236     12  CO-AR-BAL-LEVEL                       PIC X.
  7237         88  CO-AR-REF-LVL                        VALUE '1'.
  7238         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7239         88  CO-AR-BILL-LVL                       VALUE '2'.
  7240         88  CO-AR-AGT-LVL                        VALUE '3'.
  7241         88  CO-AR-FR-LVL                         VALUE '4'.
  7242
  7243     12  CO-AR-NORMAL-PRINT                    PIC X.
  7244         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7245         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7246
  7247     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7248
  7249     12  CO-AR-REPORTING                       PIC X.
  7250         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7251         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7252
  7253     12  CO-AR-PULL-CHECK                      PIC X.
  7254         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7255         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7256
  7257     12  CO-AR-BALANCE-PRINT                   PIC X.
  7258         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7259
  7260     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7261         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7262         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7263         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7264
  7265     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7266
  7267     12  CO-USER-CODE                          PIC X.
  7268     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7269
  7270******************************************************************
  7271*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7272*    THE LAST MONTH END RUN.
  7273******************************************************************
  7274
  7275     12  CO-LAST-ACTIVITY-DATE.
  7276         16  CO-ACT-YEAR                       PIC 99.
  7277         16  CO-ACT-MONTH                      PIC 99.
  7278         16  CO-ACT-DAY                        PIC 99.
  7279
  7280     12  CO-LAST-STMT-DT.
  7281         16  CO-LAST-STMT-YEAR                 PIC 99.
  7282         16  CO-LAST-STMT-MONTH                PIC 99.
  7283         16  CO-LAST-STMT-DAY                  PIC 99.
  7284
  7285     12  CO-MO-END-TOTALS.
  7286         16  CO-MONTHLY-TOTALS.
  7287             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7288             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7289             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7290             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7291             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  7292
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL156.cbl
  7293         16  CO-AGING-TOTALS.
  7294             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7295             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7296             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7297             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7298
  7299         16  CO-YTD-TOTALS.
  7300             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7301             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7302
  7303         16  CO-OVER-UNDER-TOTALS.
  7304             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7305             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7306
  7307     12  CO-MISCELLANEOUS-TOTALS.
  7308         16  CO-FICA-TOTALS.
  7309             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7310             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7311
  7312         16  CO-CLAIM-TOTALS.
  7313             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7314             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7315
  7316******************************************************************
  7317*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7318*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7319******************************************************************
  7320
  7321     12  CO-CURRENT-TOTALS.
  7322         16  CO-CURRENT-LAST-STMT-DT.
  7323             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7324             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7325             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7326
  7327         16  CO-CURRENT-MONTHLY-TOTALS.
  7328             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7329             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7330             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7331             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7332             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7333
  7334         16  CO-CURRENT-AGING-TOTALS.
  7335             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7336             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7337             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7338             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7339
  7340         16  CO-CURRENT-YTD-TOTALS.
  7341             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7342             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7343
  7344     12  CO-PAID-COMM-TOTALS.
  7345         16  CO-YTD-PAID-COMMS.
  7346             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7347             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7348
  7349     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  7350         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL156.cbl
  7351         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7352
  7353     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7354         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7355         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7356         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7357         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7358         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7359         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7360         88  CO-FINAL-LETTER                  VALUE 'F'.
  7361         88  CO-RECONCILING                   VALUE 'R'.
  7362         88  CO-PHONE-CALL                    VALUE 'P'.
  7363         88  CO-LEGAL                         VALUE 'L'.
  7364         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7365         88  CO-WRITE-OFF                     VALUE 'W'.
  7366         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7367
  7368     12  CO-CSR-CODE                       PIC X(4).
  7369
  7370     12  CO-GA-STATUS-INFO.
  7371         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7372         16  CO-GA-TERMINATION-DT          PIC XX.
  7373         16  CO-GA-STATUS-CODE             PIC X.
  7374             88  CO-GA-ACTIVE                 VALUE 'A'.
  7375             88  CO-GA-INACTIVE               VALUE 'I'.
  7376             88  CO-GA-PENDING                VALUE 'P'.
  7377         16  CO-GA-COMMENTS.
  7378             20  CO-GA-COMMENT-1           PIC X(40).
  7379             20  CO-GA-COMMENT-2           PIC X(40).
  7380             20  CO-GA-COMMENT-3           PIC X(40).
  7381             20  CO-GA-COMMENT-4           PIC X(40).
  7382
  7383     12  CO-RPTCD2                         PIC X(10).
  7384
  7385     12  CO-TYPE-AGENT                     PIC X(01).
  7386         88  CO-CORPORATION                   VALUE 'C'.
  7387         88  CO-PARTNERSHIP                   VALUE 'P'.
  7388         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7389         88  CO-TRUST                         VALUE 'T'.
  7390         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7391
  7392     12  CO-FAXNO.
  7393         16  CO-FAX-AREA-CODE                  PIC XXX.
  7394         16  CO-FAX-PREFIX                     PIC XXX.
  7395         16  CO-FAX-PHONE                      PIC X(4).
  7396
  7397     12  CO-BANK-INFORMATION.
  7398         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7399         16  CO-BANK-TRANSIT-NON REDEFINES
  7400             CO-BANK-TRANSIT-NO                PIC 9(8).
  7401
  7402         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7403     12  CO-MISC-DEDUCT-INFO REDEFINES
  7404                  CO-BANK-INFORMATION.
  7405         16  CO-MD-GL-ACCT                     PIC X(10).
  7406         16  CO-MD-DIV                         PIC XX.
  7407         16  CO-MD-CENTER                      PIC X(4).
  7408         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL156.cbl
  7409         16  CO-CREATE-AP-CHECK                PIC X.
  7410         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7411         16  FILLER                            PIC XXX.
  7412     12  CO-ACH-STATUS                         PIC X.
  7413         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7414         88  CO-ACH-PENDING                        VALUE 'P'.
  7415
  7416     12  CO-BILL-SW                            PIC X.
  7417     12  CO-CONTROL-NAME                       PIC X(30).
  7418     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7419     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7420     12  CO-CLP-STATE                          PIC XX.
  7421     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7422     12  CO-SPP-REFUND-EDIT                    PIC X.
  7423
  7424******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL156.cbl
  7426*    COPY ERCDMDNT.
  7427******************************************************************
  7428*                                                                *
  7429*                            ERCDMDNT                            *
  7430*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7431*                            VMOD=2.005                          *
  7432*                                                                *
  7433*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7434*                                                                *
  7435*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7436*                                                                *
  7437*        FILE TYPE= VSAM,KSDS                                    *
  7438*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7439*                                                                *
  7440*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7441*                                                                *
  7442*        LOG = YES                                               *
  7443*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7444*                                                                *
  7445******************************************************************
  7446
  7447 01  CERTIFICATE-NOTE.
  7448     12  CN-RECORD-ID                     PIC  XX.
  7449         88  VALID-CN-ID                      VALUE 'CN'.
  7450
  7451     12  CN-CONTROL-PRIMARY.
  7452         16  CN-COMPANY-CD                PIC X.
  7453         16  CN-CERT-KEY.
  7454             20  CN-CARRIER               PIC X.
  7455             20  CN-GROUPING.
  7456                 24  CN-GROUPING-PREFIX   PIC XXX.
  7457                 24  CN-GROUPING-PRIME    PIC XXX.
  7458             20  CN-STATE                 PIC XX.
  7459             20  CN-ACCOUNT.
  7460                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7461                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7462             20  CN-CERT-EFF-DT           PIC XX.
  7463             20  CN-CERT-NO.
  7464                 24  CN-CERT-PRIME        PIC X(10).
  7465                 24  CN-CERT-SFX          PIC X.
  7466
  7467     12  CN-BILLING-START-LINE-NO         PIC 99.
  7468     12  CN-BILLING-END-LINE-NO           PIC 99.
  7469
  7470     12  CN-LINES.
  7471         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7472
  7473     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7474         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7475         16  CN-CSI-GENERAL-DATA-AREA.
  7476             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7477
  7478         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7479             CN-CSI-GENERAL-DATA-AREA.
  7480             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7481             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7482             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7483             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL156.cbl
  7484             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7485             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7486             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7487             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7488             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7489             20  FILLER                       PIC XX.
  7490             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7491             20  FILLER                       PIC X(38).
  7492
  7493         16  CN-CSI-PRODUCT-DATA-AREA.
  7494             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7495
  7496         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7497             CN-CSI-PRODUCT-DATA-AREA.
  7498             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7499             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7500             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7501             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7502             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7503             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7504             20  FILLER                   PIC XX.
  7505             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7506             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7507             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7508             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7509             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7510             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7511             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7512             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7513             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7514             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7515             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7516             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7517             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7518             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7519             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7520             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7521             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7522             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7523             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7524             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7525             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7526             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7527             20  FILLER                   PIC X(25).
  7528
  7529         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7530             CN-CSI-CREDIT-CARD-DATA.
  7531             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7532             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7533             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7534             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7535             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7536             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7537             20  FILLER                   PIC XX.
  7538             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7539             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7540             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7541             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL156.cbl
  7542             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7543             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7544             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7545             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7546             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7547             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7548             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7549             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7550             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7551             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7552             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7553             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7554             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7555             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7556             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7557             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7558             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7559             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7560             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7561             20  FILLER                   PIC X(17).
  7562
  7563         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7564             CN-CSI-FAMILY-LEAVE-DATA.
  7565             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7566             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7567             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7568             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7569             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7570             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7571             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7572             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7573             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7574             20  CN-CSI-SL-INT-ON-PROCEEDS
  7575                                          PIC S9(5)V99  COMP-3.
  7576             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7577             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7578             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7579             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7580             20  CN-CSI-SL-POLICY-BENEFITS
  7581                                          PIC S9(5)V99  COMP-3.
  7582             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7583             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7584             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7585             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7586             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7587             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7588             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7589             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7590             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7591             20  CN-CSI-SL-STATE-NOT      PIC X.
  7592             20  FILLER                   PIC XX.
  7593
  7594         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7595             CN-CSI-SENIOR-LIFE-DATA.
  7596             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7597             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7598             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7599                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL156.cbl
  7600             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7601             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7602             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7603             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7604             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7605             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7606             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7607             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7608             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7609             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7610             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7611             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7612             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7613             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7614             20  CN-CSI-PP-REPAIR         PIC X.
  7615             20  CN-CSI-PP-REPLACE        PIC X.
  7616             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7617             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7618             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7619             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7620             20  FILLER                   PIC X(5).
  7621
  7622         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7623             CN-CSI-PURCH-PROP-DATA.
  7624             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7625             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7626             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7627             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7628             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7629             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7630             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7631             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7632             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7633             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7634             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7635             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7636             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7637             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7638             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7639             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7640             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7641             20  CN-CSI-EW-REPLACE        PIC X.
  7642             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7643             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7644             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7645             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7646             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7647             20  FILLER                   PIC X(4).
  7648
  7649     12  CN-LAST-MAINT-DT                 PIC XX.
  7650     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7651     12  CN-LAST-MAINT-USER               PIC X(4).
  7652     12  FILLER                           PIC X(6).
  7653
  7654******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL156.cbl
  7656*    COPY ERCCNOT.
  7657******************************************************************
  7658*                                                                *
  7659*                            ERCCNOT                             *
  7660*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7661*                            VMOD=2.003                          *
  7662*                                                                *
  7663*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7664*                                                                *
  7665*        FILE TYPE= VSAM,KSDS                                    *
  7666*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7667*                                                                *
  7668*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7669*                                                                *
  7670*        LOG = YES                                               *
  7671*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7672*                                                                *
  7673******************************************************************
  7674*                   C H A N G E   L O G
  7675*
  7676* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7677*-----------------------------------------------------------------
  7678*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7679* EFFECTIVE    NUMBER
  7680*-----------------------------------------------------------------
  7681* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7682******************************************************************
  7683
  7684 01  CERT-NOTE-FILE.
  7685     12  CZ-RECORD-ID                PIC  XX.
  7686         88  VALID-CZ-ID                  VALUE 'CZ'.
  7687
  7688     12  CZ-CONTROL-PRIMARY.
  7689         16  CZ-COMPANY-CD           PIC X.
  7690         16  CZ-CARRIER              PIC X.
  7691         16  CZ-GROUPING.
  7692             20 CZ-GROUPING-PREFIX   PIC XXX.
  7693             20 CZ-GROUPING-PRIME    PIC XXX.
  7694         16  CZ-STATE                PIC XX.
  7695         16  CZ-ACCOUNT.
  7696             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7697             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7698         16  CZ-CERT-EFF-DT          PIC XX.
  7699         16  CZ-CERT-NO.
  7700             20  CZ-CERT-PRIME       PIC X(10).
  7701             20  CZ-CERT-SFX         PIC X.
  7702         16  CZ-RECORD-TYPE          PIC X.
  7703             88  CERT-NOTE           VALUE '1'.
  7704             88  CLAIM-CERT-NOTE     VALUE '2'.
  7705         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7706
  7707     12  CZ-LAST-MAINT-DT            PIC XX.
  7708     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7709     12  CZ-LAST-MAINT-USER          PIC X(4).
  7710
  7711     12  CZ-NOTE-INFORMATION.
  7712         16  CZ-NOTE                 PIC X(63).
  7713         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL156.cbl
  7714******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL156.cbl
  7716 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7717                          CONTROL-FILE CERTIFICATE-MASTER
  7718                          ACTIVITY-TRAILERS ACTIVITY-QUE
  7719                          ACCOUNT-MASTER CHECK-QUE
  7720                          BENEFICIARY-MASTER LETTER-ARCHIVE
  7721                          DAILY-ACTIVITY-RECORD
  7722                          COMPENSATION-MASTER CERTIFICATE-NOTE
  7723                          CERT-NOTE-FILE.
  7724 0000-DFHEXIT SECTION.
  7725     MOVE '9#                    $   ' TO DFHEIV0.
  7726     MOVE 'EL156' TO DFHEIV1.
  7727     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7728
  7729     IF EIBCALEN = 0
  7730         GO TO 8800-UNAUTHORIZED-ACCESS.
  7731
  7732     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7733     MOVE EIBTRMID               TO QID-TERM.
  7734     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7735     MOVE '2'                    TO EMI-SWITCH2.
  7736     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7737     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7738
  7739     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7740     MOVE '5'                    TO DC-OPTION-CODE.
  7741     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7742     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  7743                                    SAVE-BIN-DATE.
  7744     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  7745     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  7746
  7747     IF SAVE-DATE-YY > 70
  7748         MOVE 19                 TO SAVE-DATE-CC
  7749     ELSE
  7750         MOVE 20                 TO SAVE-DATE-CC.
  7751
  7752     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  7753         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  7754     END-IF.
  7755
  7756     IF PI-PRINT-EOB-YN = 'Y'
  7757        MOVE 'Y'                 TO WS-PRINT-EOB-YN
  7758     ELSE
  7759        MOVE 'N'                 TO WS-PRINT-EOB-YN
  7760     END-IF
  7761
  7762* EXEC CICS HANDLE CONDITION
  7763*        NOTOPEN   (9990-ABEND)
  7764*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  7765*        MAPFAIL   (0400-FIRST-TIME)
  7766*        DUPREC    (6180-DUPREC)
  7767*        ERROR     (9990-ABEND)
  7768*    END-EXEC.
  7769*    MOVE '"$JL?%.               ! " #00007757' TO DFHEIV0
  7770     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  7771     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7772     MOVE X'2220233030303037373537' TO DFHEIV0(25:11)
  7773     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL156.cbl
  7774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7775
  7776
  7777     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7778         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  7779
  7780     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7781         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7782             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7783             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7784             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7785             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7786             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7787             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7788             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7789             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7790             MOVE LOW-VALUES           TO EL156AI
  7791             MOVE 'Y'                  TO FIRST-ENTRY
  7792         ELSE
  7793             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7794             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7795             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7796             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7797             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7798             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7799             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7800             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  7801
  7802     IF RETURNED-FROM NOT = SPACES
  7803        IF (RETURNED-FROM = 'EL614')
  7804           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  7805           IF WS-SAVED-EOB-CODES NOT = SPACES
  7806              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  7807           ELSE
  7808              MOVE 'N'                TO WS-SET-NOTE2-MDT
  7809           END-IF
  7810        END-IF
  7811         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7812            MOVE 'Y'             TO FIRST-ENTRY
  7813            IF RETURNED-FROM = 'EL614'
  7814               AND (PI-PASS-SW NOT = 'C')
  7815               IF WS-SAVED-EOB-CODES NOT = SPACES
  7816                  MOVE WS-SAVED-EOB-CODES
  7817                                 TO PI-PMTNOTE2
  7818                                    WS-PMTNOTE2
  7819                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  7820               ELSE
  7821                  MOVE SPACES    TO PI-PMTNOTE2
  7822                                    WS-PMTNOTE2
  7823                                    PI-EOB-CODES-EXIST
  7824               END-IF
  7825            END-IF
  7826            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  7827            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  7828            IF RETURNED-FROM = 'EL614'
  7829               GO TO 1000-EDIT-DATA
  7830            END-IF
  7831            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL156.cbl
  7832               (PAYEEI   = LOW-VALUES OR SPACES)
  7833               GO TO 8100-SEND-INITIAL-MAP
  7834            ELSE
  7835               GO TO 1000-EDIT-DATA.
  7836
  7837     IF EIBTRNID NOT = TRANS-ID
  7838         GO TO 0400-FIRST-TIME.
  7839
  7840     IF EIBAID = DFHCLEAR
  7841        IF PI-PASS-SW = 'C'
  7842           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7843           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  7844           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  7845           MOVE 'Y'            TO RETURNED-FROM-B
  7846           GO TO 1000-EDIT-DATA
  7847        ELSE
  7848           GO TO 9400-CLEAR.
  7849
  7850     IF PI-PASS-SW = 'C'
  7851         MOVE MAP-NAMEB          TO MAP-NAME
  7852         IF EIBAID = DFHPF1 OR DFHPF13
  7853             GO TO 5000-UPDATE
  7854           ELSE
  7855             IF EIBAID NOT = DFHENTER
  7856                 MOVE LOW-VALUES TO EL156BI
  7857                 MOVE MAP-NAMEB  TO MAP-NAME
  7858                 MOVE ER-0029    TO EMI-ERROR
  7859                 MOVE -1         TO  ENTPFBL
  7860                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7861                 GO TO 8200-SEND-DATAONLY.
  7862
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL156.cbl
  7864 0200-RECEIVE.
  7865     MOVE LOW-VALUES             TO EL156AI.
  7866     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7867         MOVE ER-0008            TO EMI-ERROR
  7868         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7869         IF PI-PASS-SW = 'C'
  7870             MOVE -1             TO ENTPFBL
  7871             GO TO 8200-SEND-DATAONLY
  7872         ELSE
  7873             MOVE -1             TO PMTTYPEL
  7874             GO TO 8200-SEND-DATAONLY.
  7875
  7876     IF PI-COMPANY-ID = 'DMD'
  7877         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  7878
  7879     IF PI-PASS-SW = 'C'
  7880         MOVE MAP-NAMEB          TO MAP-NAME.
  7881
  7882
  7883* EXEC CICS RECEIVE
  7884*        MAP   (MAP-NAME)
  7885*        MAPSET(MAPSET-NAME)
  7886*        ASIS
  7887*        INTO  (EL156AI)
  7888*    END-EXEC.
  7889     MOVE LENGTH OF
  7890      EL156AI
  7891       TO DFHEIV11
  7892*    MOVE '8"TAI  L              ''   #00007870' TO DFHEIV0
  7893     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7894     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7895     MOVE X'2020233030303037383730' TO DFHEIV0(25:11)
  7896     CALL 'kxdfhei1' USING DFHEIV0,
  7897           MAP-NAME,
  7898           EL156AI,
  7899           DFHEIV11,
  7900           MAPSET-NAME,
  7901           DFHEIV99,
  7902           DFHEIV99
  7903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7904
  7905
  7906     IF PI-PASS-SW NOT = 'C'
  7907         GO TO 0250-MAPA.
  7908
  7909     IF ENTPFBL NOT > ZERO
  7910         MOVE MAP-NAMEB          TO MAP-NAME
  7911         MOVE ER-0029            TO EMI-ERROR
  7912         MOVE -1                 TO  ENTPFBL
  7913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7914         GO TO 8200-SEND-DATAONLY.
  7915
  7916     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  7917         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  7918       ELSE
  7919         MOVE MAP-NAMEB           TO MAP-NAME
  7920         MOVE ER-0029             TO EMI-ERROR
  7921         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL156.cbl
  7922         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7923         GO TO 8200-SEND-DATAONLY.
  7924
  7925     IF EIBAID = DFHPF1 OR DFHPF13
  7926         IF MODIFY-CAP
  7927            GO TO 5000-UPDATE
  7928          ELSE
  7929            MOVE 'UPDATE'           TO SM-READ
  7930            PERFORM 9995-SECURITY-VIOLATION
  7931            MOVE MAP-NAMEB          TO MAP-NAME
  7932            MOVE ER-0070            TO EMI-ERROR
  7933            MOVE -1                 TO  ENTPFBL
  7934            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7935            GO TO 8200-SEND-DATAONLY.
  7936
  7937 0250-MAPA.
  7938     IF ENTERPFL = 0
  7939         GO TO 0300-CHECK-PFKEYS.
  7940
  7941     IF EIBAID NOT = DFHENTER
  7942         MOVE ER-0004            TO EMI-ERROR
  7943         GO TO 0320-INPUT-ERROR.
  7944
  7945     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7946         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7947     ELSE
  7948         MOVE ER-0029            TO EMI-ERROR
  7949         GO TO 0320-INPUT-ERROR.
  7950
  7951 0300-CHECK-PFKEYS.
  7952     IF EIBAID = DFHPF7 OR DFHPF8
  7953         GO TO 8820-PF7-8.
  7954
  7955     IF EIBAID = DFHPF23
  7956         GO TO 8810-PF23.
  7957
  7958     IF EIBAID = DFHPF24
  7959         GO TO 9200-RETURN-MAIN-MENU.
  7960
  7961     IF EIBAID = DFHPF12
  7962         GO TO 9500-PF12.
  7963
  7964     IF EIBAID = DFHPF1
  7965        IF PI-PASS-SW = 'A' OR 'B'
  7966          GO TO 0330-BROWSE-FORWARD.
  7967
  7968     IF EIBAID = DFHPF2
  7969        IF PI-PASS-SW = 'A' OR 'B'
  7970          GO TO 0350-BROWSE-BACKWARD.
  7971
  7972     IF EIBAID = DFHPF6
  7973        IF PI-EOB-CODES-EXIST = 'Y'
  7974           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  7975        ELSE
  7976           MOVE SPACES              TO WS-PMTNOTE2
  7977        END-IF
  7978         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  7979         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL156.cbl
  7980            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  7981         END-IF
  7982         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7983         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  7984             MOVE 'EL614'        TO PGM-NAME
  7985             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  7986             GO TO 9300-XCTL
  7987         ELSE
  7988             MOVE XCTL-157       TO PGM-NAME
  7989             GO TO 9300-XCTL.
  7990
  7991     IF EIBAID = DFHPF9
  7992        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  7993        MOVE XCTL-141            TO PGM-NAME
  7994        GO TO 9300-XCTL.
  7995
  7996     IF EIBAID = DFHPF10
  7997        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  7998        MOVE XCTL-155            TO PGM-NAME
  7999        GO TO 9300-XCTL.
  8000
  8001     MOVE SPACES                 TO ERRMSG0O
  8002                                    ERRMSG1O
  8003                                    ERRMSG2O.
  8004
  8005     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8006         IF PI-PASS-SW NOT = 'B'
  8007             MOVE ER-0422        TO EMI-ERROR
  8008             GO TO 0320-INPUT-ERROR
  8009           ELSE
  8010             GO TO 0700-TEST-FOR-CHANGES.
  8011
  8012     IF EIBAID = DFHPF11
  8013        IF PI-PASS-SW = 'C'
  8014           MOVE ER-0029          TO EMI-ERROR
  8015           GO TO 0320-INPUT-ERROR.
  8016
  8017     IF EIBAID = DFHENTER OR DFHPF11
  8018        NEXT SENTENCE
  8019     ELSE
  8020        MOVE ER-0029             TO EMI-ERROR
  8021        GO TO 0320-INPUT-ERROR.
  8022
  8023     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8024
  8025     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8026         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8027         GO TO 1000-EDIT-DATA
  8028     ELSE
  8029         IF PI-FATAL-COUNT NOT = 0 OR
  8030            PI-FORCE-COUNT NOT = 0
  8031             GO TO 1000-EDIT-DATA
  8032         ELSE
  8033             GO TO 2000-EDIT-DONE.
  8034
  8035 0320-INPUT-ERROR.
  8036     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8037
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL156.cbl
  8038     IF ENTERPFL = 0
  8039         MOVE -1                 TO PMTTYPEL
  8040     ELSE
  8041         MOVE AL-UNBON           TO ENTERPFA
  8042         MOVE -1                 TO ENTERPFL.
  8043
  8044     GO TO 8200-SEND-DATAONLY.
  8045
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL156.cbl
  8047 0330-BROWSE-FORWARD.
  8048
  8049     MOVE CLMNOI            TO PI-CLAIM-NO.
  8050     MOVE CARRI             TO PI-CARRIER.
  8051     MOVE CERTNOI           TO PI-CERT-PRIME.
  8052     MOVE SUFXI             TO PI-CERT-SFX.
  8053
  8054     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8055     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8056     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8057     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8058
  8059     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8060
  8061
  8062* EXEC CICS HANDLE CONDITION
  8063*         NOTFND   (0380-CLAIM-END-FILE)
  8064*         ENDFILE  (0380-CLAIM-END-FILE)
  8065*    END-EXEC.
  8066*    MOVE '"$I''                  ! # #00008032' TO DFHEIV0
  8067     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8069     MOVE X'2320233030303038303332' TO DFHEIV0(25:11)
  8070     CALL 'kxdfhei1' USING DFHEIV0
  8071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8072
  8073
  8074
  8075* EXEC CICS STARTBR
  8076*         DATASET    ('ELMSTR')
  8077*         RIDFLD     (ELMSTR-KEY)
  8078*         GTEQ
  8079*    END-EXEC.
  8080     MOVE 'ELMSTR' TO DFHEIV1
  8081     MOVE 0
  8082       TO DFHEIV11
  8083*    MOVE '&,         G          &   #00008037' TO DFHEIV0
  8084     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8085     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8086     MOVE X'2020233030303038303337' TO DFHEIV0(25:11)
  8087     CALL 'kxdfhei1' USING DFHEIV0,
  8088           DFHEIV1,
  8089           ELMSTR-KEY,
  8090           DFHEIV99,
  8091           DFHEIV11,
  8092           DFHEIV99
  8093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8094
  8095
  8096     MOVE 'Y' TO WS-BROWSE-START-SW.
  8097
  8098 0335-READNEXT.
  8099
  8100
  8101* EXEC CICS READNEXT
  8102*         DATASET    ('ELMSTR')
  8103*         RIDFLD     (ELMSTR-KEY)
  8104*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL156.cbl
  8105*    END-EXEC.
  8106     MOVE 'ELMSTR' TO DFHEIV1
  8107     MOVE 0
  8108       TO DFHEIV11
  8109*    MOVE '&.S                   )   #00008047' TO DFHEIV0
  8110     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8111     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8112     MOVE X'2020233030303038303437' TO DFHEIV0(25:11)
  8113     CALL 'kxdfhei1' USING DFHEIV0,
  8114           DFHEIV1,
  8115           DFHEIV20,
  8116           DFHEIV99,
  8117           ELMSTR-KEY,
  8118           DFHEIV99,
  8119           DFHEIV11,
  8120           DFHEIV99,
  8121           DFHEIV99
  8122     SET ADDRESS OF CLAIM-MASTER TO
  8123         DFHEIV20
  8124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8125
  8126
  8127     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8128        GO TO 0380-CLAIM-END-FILE.
  8129
  8130     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8131        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8132        GO TO 0335-READNEXT.
  8133
  8134     IF PI-COMPANY-ID = 'CRI'
  8135         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8136            GO TO 0380-CLAIM-END-FILE.
  8137
  8138     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8139         GO TO 0335-READNEXT.
  8140
  8141     IF PI-CARRIER-SECURITY > SPACES
  8142         IF CL-CARRIER = PI-CARRIER-SECURITY
  8143             NEXT SENTENCE
  8144         ELSE
  8145             GO TO 0335-READNEXT.
  8146
  8147     IF PI-ACCOUNT-SECURITY > SPACES
  8148         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8149             NEXT SENTENCE
  8150         ELSE
  8151             GO TO 0335-READNEXT.
  8152
  8153     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8154     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8155     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8156
  8157     GO TO 0400-FIRST-TIME.
  8158
  8159 0350-BROWSE-BACKWARD.
  8160
  8161     MOVE CLMNOI            TO PI-CLAIM-NO
  8162                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL156.cbl
  8163     MOVE CARRI             TO PI-CARRIER.
  8164     MOVE CERTNOI           TO PI-CERT-PRIME.
  8165     MOVE SUFXI             TO PI-CERT-SFX.
  8166
  8167     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8168
  8169     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8170     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8171     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8172
  8173
  8174* EXEC CICS HANDLE CONDITION
  8175*         NOTFND   (0380-CLAIM-END-FILE)
  8176*         ENDFILE  (0380-CLAIM-END-FILE)
  8177*    END-EXEC.
  8178*    MOVE '"$I''                  ! $ #00008099' TO DFHEIV0
  8179     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8181     MOVE X'2420233030303038303939' TO DFHEIV0(25:11)
  8182     CALL 'kxdfhei1' USING DFHEIV0
  8183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8184
  8185
  8186
  8187* EXEC CICS STARTBR
  8188*         DATASET    ('ELMSTR')
  8189*         RIDFLD     (ELMSTR-KEY)
  8190*         GTEQ
  8191*    END-EXEC.
  8192     MOVE 'ELMSTR' TO DFHEIV1
  8193     MOVE 0
  8194       TO DFHEIV11
  8195*    MOVE '&,         G          &   #00008104' TO DFHEIV0
  8196     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8197     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8198     MOVE X'2020233030303038313034' TO DFHEIV0(25:11)
  8199     CALL 'kxdfhei1' USING DFHEIV0,
  8200           DFHEIV1,
  8201           ELMSTR-KEY,
  8202           DFHEIV99,
  8203           DFHEIV11,
  8204           DFHEIV99
  8205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8206
  8207
  8208     MOVE 'Y' TO WS-BROWSE-START-SW.
  8209
  8210
  8211* EXEC CICS READNEXT
  8212*         DATASET    ('ELMSTR')
  8213*         RIDFLD     (ELMSTR-KEY)
  8214*         SET        (ADDRESS OF CLAIM-MASTER)
  8215*    END-EXEC.
  8216     MOVE 'ELMSTR' TO DFHEIV1
  8217     MOVE 0
  8218       TO DFHEIV11
  8219*    MOVE '&.S                   )   #00008112' TO DFHEIV0
  8220     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL156.cbl
  8221     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8222     MOVE X'2020233030303038313132' TO DFHEIV0(25:11)
  8223     CALL 'kxdfhei1' USING DFHEIV0,
  8224           DFHEIV1,
  8225           DFHEIV20,
  8226           DFHEIV99,
  8227           ELMSTR-KEY,
  8228           DFHEIV99,
  8229           DFHEIV11,
  8230           DFHEIV99,
  8231           DFHEIV99
  8232     SET ADDRESS OF CLAIM-MASTER TO
  8233         DFHEIV20
  8234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8235
  8236
  8237
  8238* EXEC CICS READPREV
  8239*         DATASET    ('ELMSTR')
  8240*         RIDFLD     (ELMSTR-KEY)
  8241*         SET        (ADDRESS OF CLAIM-MASTER)
  8242*    END-EXEC.
  8243     MOVE 'ELMSTR' TO DFHEIV1
  8244     MOVE 0
  8245       TO DFHEIV11
  8246*    MOVE '&0S                   )   #00008118' TO DFHEIV0
  8247     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8248     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8249     MOVE X'2020233030303038313138' TO DFHEIV0(25:11)
  8250     CALL 'kxdfhei1' USING DFHEIV0,
  8251           DFHEIV1,
  8252           DFHEIV20,
  8253           DFHEIV99,
  8254           ELMSTR-KEY,
  8255           DFHEIV99,
  8256           DFHEIV11,
  8257           DFHEIV99,
  8258           DFHEIV99
  8259     SET ADDRESS OF CLAIM-MASTER TO
  8260         DFHEIV20
  8261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8262
  8263
  8264 0360-BROWSE-BACKWARD.
  8265
  8266
  8267* EXEC CICS READPREV
  8268*         DATASET    ('ELMSTR')
  8269*         RIDFLD     (ELMSTR-KEY)
  8270*         SET        (ADDRESS OF CLAIM-MASTER)
  8271*    END-EXEC.
  8272     MOVE 'ELMSTR' TO DFHEIV1
  8273     MOVE 0
  8274       TO DFHEIV11
  8275*    MOVE '&0S                   )   #00008126' TO DFHEIV0
  8276     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8277     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8278     MOVE X'2020233030303038313236' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL156.cbl
  8279     CALL 'kxdfhei1' USING DFHEIV0,
  8280           DFHEIV1,
  8281           DFHEIV20,
  8282           DFHEIV99,
  8283           ELMSTR-KEY,
  8284           DFHEIV99,
  8285           DFHEIV11,
  8286           DFHEIV99,
  8287           DFHEIV99
  8288     SET ADDRESS OF CLAIM-MASTER TO
  8289         DFHEIV20
  8290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8291
  8292
  8293     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8294        GO TO 0380-CLAIM-END-FILE.
  8295
  8296     IF PI-COMPANY-ID = 'CRI'
  8297         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8298            GO TO 0380-CLAIM-END-FILE.
  8299
  8300     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8301         GO TO 0360-BROWSE-BACKWARD.
  8302
  8303     IF PI-CARRIER-SECURITY > SPACES
  8304         IF CL-CARRIER = PI-CARRIER-SECURITY
  8305             NEXT SENTENCE
  8306         ELSE
  8307             GO TO 0360-BROWSE-BACKWARD.
  8308
  8309     IF PI-ACCOUNT-SECURITY > SPACES
  8310         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8311             NEXT SENTENCE
  8312         ELSE
  8313             GO TO 0360-BROWSE-BACKWARD.
  8314
  8315     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8316     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8317     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8318
  8319     GO TO 0400-FIRST-TIME.
  8320
  8321 0380-CLAIM-END-FILE.
  8322
  8323     MOVE ER-0130     TO EMI-ERROR.
  8324     MOVE -1          TO CLMNOL.
  8325     MOVE AL-UABON    TO CARRA
  8326                         CLMNOA
  8327                         CERTNOA
  8328                         SUFXA.
  8329
  8330     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8331
  8332     GO TO 8200-SEND-DATAONLY.
  8333
  8334 0400-FIRST-TIME.
  8335
  8336     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL156.cbl
  8337        MOVE 'N'         TO WS-BROWSE-START-SW
  8338
  8339* EXEC CICS ENDBR
  8340*            DATASET    ('ELMSTR')
  8341*       END-EXEC.
  8342     MOVE 'ELMSTR' TO DFHEIV1
  8343     MOVE 0
  8344       TO DFHEIV11
  8345*    MOVE '&2                    $   #00008177' TO DFHEIV0
  8346     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8347     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8348     MOVE X'2020233030303038313737' TO DFHEIV0(25:11)
  8349     CALL 'kxdfhei1' USING DFHEIV0,
  8350           DFHEIV1,
  8351           DFHEIV11,
  8352           DFHEIV99
  8353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8354
  8355
  8356     IF PI-PROCESSOR-ID = 'LGXX'
  8357         NEXT SENTENCE
  8358     ELSE
  8359
  8360* EXEC CICS READQ TS
  8361*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8362*            INTO    (SECURITY-CONTROL)
  8363*            LENGTH  (SC-COMM-LENGTH)
  8364*            ITEM    (SC-ITEM)
  8365*        END-EXEC
  8366*    MOVE '*$II   L              ''   #00008184' TO DFHEIV0
  8367     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8368     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8369     MOVE X'2020233030303038313834' TO DFHEIV0(25:11)
  8370     CALL 'kxdfhei1' USING DFHEIV0,
  8371           PI-SECURITY-TEMP-STORE-ID,
  8372           SECURITY-CONTROL,
  8373           SC-COMM-LENGTH,
  8374           SC-ITEM,
  8375           DFHEIV99,
  8376           DFHEIV99
  8377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8378         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8379         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8380
  8381     MOVE LOW-VALUES             TO EL156AI.
  8382     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8383     MOVE 'Y'                    TO FIRST-ENTRY.
  8384     GO TO 7000-SHOW-CLAIM.
  8385
  8386 0500-CREATE-TEMP-STORAGE.
  8387     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8388
  8389
  8390* EXEC CICS WRITEQ TS
  8391*        QUEUE (QID)
  8392*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8393*        LENGTH(PI-COMM-LENGTH)
  8394*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL156.cbl
  8395*    MOVE '*"                    ''   #00008201' TO DFHEIV0
  8396     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8397     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8398     MOVE X'2020233030303038323031' TO DFHEIV0(25:11)
  8399     CALL 'kxdfhei1' USING DFHEIV0,
  8400           QID,
  8401           PROGRAM-INTERFACE-BLOCK,
  8402           PI-COMM-LENGTH,
  8403           DFHEIV99,
  8404           DFHEIV99,
  8405           DFHEIV99
  8406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8407
  8408
  8409
  8410* EXEC CICS WRITEQ TS
  8411*        QUEUE (QID)
  8412*        FROM  (EL156AI)
  8413*        LENGTH(MAP-LENGTH)
  8414*    END-EXEC.
  8415*    MOVE '*"                    ''   #00008207' TO DFHEIV0
  8416     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8417     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8418     MOVE X'2020233030303038323037' TO DFHEIV0(25:11)
  8419     CALL 'kxdfhei1' USING DFHEIV0,
  8420           QID,
  8421           EL156AI,
  8422           MAP-LENGTH,
  8423           DFHEIV99,
  8424           DFHEIV99,
  8425           DFHEIV99
  8426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8427
  8428
  8429 0599-EXIT.
  8430      EXIT.
  8431
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL156.cbl
  8433 0600-RECOVER-TEMP-STORAGE.
  8434
  8435* EXEC CICS READQ TS
  8436*        QUEUE (QID)
  8437*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8438*        LENGTH(PI-COMM-LENGTH)
  8439*    END-EXEC.
  8440*    MOVE '*$I    L              ''   #00008218' TO DFHEIV0
  8441     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8443     MOVE X'2020233030303038323138' TO DFHEIV0(25:11)
  8444     CALL 'kxdfhei1' USING DFHEIV0,
  8445           QID,
  8446           PROGRAM-INTERFACE-BLOCK,
  8447           PI-COMM-LENGTH,
  8448           DFHEIV99,
  8449           DFHEIV99,
  8450           DFHEIV99
  8451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8452
  8453
  8454
  8455* EXEC CICS READQ TS
  8456*        QUEUE (QID)
  8457*        INTO  (EL156AI)
  8458*        LENGTH(MAP-LENGTH)
  8459*    END-EXEC.
  8460*    MOVE '*$I    L              ''   #00008224' TO DFHEIV0
  8461     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8462     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8463     MOVE X'2020233030303038323234' TO DFHEIV0(25:11)
  8464     CALL 'kxdfhei1' USING DFHEIV0,
  8465           QID,
  8466           EL156AI,
  8467           MAP-LENGTH,
  8468           DFHEIV99,
  8469           DFHEIV99,
  8470           DFHEIV99
  8471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8472
  8473
  8474     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8475
  8476     IF PMTTYPEI NOT = LOW-VALUES
  8477         MOVE AL-UANON           TO PMTTYPEA.
  8478
  8479     IF PAYEEI NOT = LOW-VALUES
  8480         MOVE AL-UANON           TO PAYEEA.
  8481
  8482     IF NOTE1I NOT = LOW-VALUES
  8483         MOVE AL-UANON           TO NOTE1A.
  8484
  8485     IF (RETURNED-FROM = 'EL614')
  8486        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8487     END-IF
  8488*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8489*       AND (PI-EOB-CODES-EXIST = 'Y')
  8490*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL156.cbl
  8491*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8492     IF PI-SET-NOTE2-MDT = 'Y'
  8493         MOVE AL-SANON           TO NOTE2A
  8494     END-IF
  8495
  8496     IF OFFLINEI NOT = LOW-VALUES
  8497         MOVE AL-UANON           TO OFFLINEA.
  8498
  8499     IF GROUPEDI NOT = LOW-VALUES
  8500         MOVE AL-UANON           TO GROUPEDA.
  8501
  8502     IF CASHI NOT = LOW-VALUES
  8503         MOVE AL-UANON           TO CASHA.
  8504
  8505     IF CHECKNOI NOT = LOW-VALUES
  8506         MOVE AL-UANON           TO CHECKNOA.
  8507
  8508     IF HOLDTILI NOT = LOW-VALUES
  8509         MOVE AL-UANON           TO HOLDTILA.
  8510
  8511     IF EPYFROMI NOT = LOW-VALUES
  8512         MOVE AL-UANON           TO EPYFROMA.
  8513
  8514     IF AIGFROMI NOT = LOW-VALUES
  8515         MOVE AL-UANON           TO AIGFROMA.
  8516
  8517     IF EPYTHRUI NOT = LOW-VALUES
  8518         MOVE AL-UANON           TO EPYTHRUA.
  8519
  8520     IF EDAYSI NOT = LOW-VALUES
  8521         MOVE AL-UNNON           TO EDAYSA.
  8522
  8523     IF EPYAMTL NOT = +0
  8524         MOVE AL-UNNON           TO EPYAMTA.
  8525
  8526     IF ERESVL NOT = +0
  8527         MOVE AL-UNNON           TO ERESVA.
  8528
  8529     IF EEXPENSL NOT = +0
  8530         MOVE AL-UNNON           TO EEXPENSA.
  8531
  8532     IF ETYPEI NOT = LOW-VALUES
  8533         MOVE AL-UNNON           TO ETYPEA.
  8534
  8535     IF PROOFDTI NOT = 0
  8536         MOVE AL-UNNON           TO PROOFDTA.
  8537
  8538     IF EOBYNI = 'Y' OR 'N'
  8539        MOVE AL-UANON            TO EOBYNA
  8540     END-IF
  8541     .
  8542 0699-EXIT.
  8543      EXIT.
  8544
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL156.cbl
  8546 0700-TEST-FOR-CHANGES.
  8547     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8548         MOVE ER-0433            TO EMI-ERROR
  8549         GO TO 0750-FUNCTION-ERROR.
  8550
  8551     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8552
  8553     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8554         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8555         MOVE 'A'                TO PI-PASS-SW
  8556         GO TO 1000-EDIT-DATA.
  8557
  8558     IF PI-FATAL-COUNT NOT = 0
  8559         MOVE ER-0499            TO EMI-ERROR
  8560         GO TO 0750-FUNCTION-ERROR.
  8561
  8562     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8563         MOVE ER-0500            TO EMI-ERROR
  8564         GO TO 0750-FUNCTION-ERROR.
  8565
  8566     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8567        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8568           MOVE ER-0542          TO EMI-ERROR
  8569           MOVE -1               TO EPYAMTL
  8570           GO TO 0750-FUNCTION-ERROR.
  8571
  8572     IF PI-OFFLINE = 'Y'  OR
  8573        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8574        MOVE EIBAID              TO PI-PFKEY-USED
  8575        GO TO 5000-UPDATE.
  8576
  8577     GO TO 6000-BUILD-SCREEN-B.
  8578
  8579 0750-FUNCTION-ERROR.
  8580     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8581
  8582     IF ENTERPFL > 0
  8583         MOVE -1                 TO ENTERPFL
  8584         MOVE AL-UNBON           TO ENTERPFA
  8585         GO TO 8200-SEND-DATAONLY
  8586     ELSE
  8587         MOVE -1                 TO ENTERPFL
  8588         MOVE AL-UNNOF           TO ENTERPFA
  8589         GO TO 8200-SEND-DATAONLY.
  8590
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL156.cbl
  8592 0800-DELETE-TS.
  8593
  8594* EXEC CICS HANDLE CONDITION
  8595*        QIDERR(0800-EXIT)
  8596*    END-EXEC.
  8597*    MOVE '"$N                   ! % #00008349' TO DFHEIV0
  8598     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8600     MOVE X'2520233030303038333439' TO DFHEIV0(25:11)
  8601     CALL 'kxdfhei1' USING DFHEIV0
  8602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8603
  8604
  8605
  8606* EXEC CICS DELETEQ TS
  8607*        QUEUE(QID)
  8608*    END-EXEC.
  8609*    MOVE '*&                    #   #00008353' TO DFHEIV0
  8610     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8611     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8612     MOVE X'2020233030303038333533' TO DFHEIV0(25:11)
  8613     CALL 'kxdfhei1' USING DFHEIV0,
  8614           QID,
  8615           DFHEIV99
  8616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8617
  8618
  8619 0800-EXIT.
  8620      EXIT.
  8621
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL156.cbl
  8623 1000-EDIT-DATA.
  8624
  8625     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  8626         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  8627         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  8628
  8629     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  8630
  8631     IF NOT MODIFY-CAP
  8632         MOVE ER-0070            TO EMI-ERROR
  8633         MOVE -1                 TO PMTTYPEL
  8634         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8635         GO TO 2000-EDIT-DONE.
  8636
  8637     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  8638                         '5' AND '6'
  8639         MOVE ER-0420            TO EMI-ERROR
  8640         MOVE -1                 TO PMTTYPEL
  8641         MOVE AL-UABON           TO PMTTYPEA
  8642         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8643     ELSE
  8644         MOVE AL-UANON           TO PMTTYPEA.
  8645
  8646     IF PI-OFFLINE = 'Y'
  8647        IF PI-GROUPED = 'Y'
  8648           MOVE ER-1880         TO EMI-ERROR
  8649           MOVE -1              TO GROUPEDL
  8650           MOVE AL-UABON        TO GROUPEDA
  8651           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8652
  8653     IF GROUPEDL > +0
  8654        IF PI-GROUPED = 'Y' OR 'N'
  8655           MOVE AL-UANON TO GROUPEDA
  8656        ELSE
  8657           MOVE ER-3140            TO EMI-ERROR
  8658           MOVE -1                 TO GROUPEDL
  8659           MOVE AL-UABON           TO GROUPEDA
  8660           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8661
  8662     IF CASHL > +0
  8663        IF PI-CASH = 'Y' OR 'N'
  8664           MOVE AL-UANON           TO CASHA
  8665        ELSE
  8666           MOVE ER-3141            TO EMI-ERROR
  8667           MOVE -1                 TO CASHL
  8668           MOVE AL-UABON           TO CASHA
  8669           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8670
  8671     IF LOANNOL > +0
  8672         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  8673
  8674 1000-EDIT-PAYEE.
  8675
  8676     IF PI-PAYEE-SEQ NOT NUMERIC
  8677         MOVE ER-0294            TO  EMI-ERROR
  8678         MOVE -1                 TO  PAYEEL
  8679         MOVE AL-UABON           TO  PAYEEA
  8680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL156.cbl
  8681         GO TO 1000-CONT-EDIT.
  8682
  8683     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  8684                         'E' OR 'O' OR 'Q'
  8685         NEXT SENTENCE
  8686     ELSE
  8687         MOVE ER-0294            TO  EMI-ERROR
  8688         MOVE -1                 TO  PAYEEL
  8689         MOVE AL-UABON           TO  PAYEEA
  8690         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8691         GO TO 1000-CONT-EDIT.
  8692
  8693     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  8694        (PI-PAYEE-SEQ NOT < '1' AND
  8695         PI-PAYEE-SEQ NOT > '9'))
  8696      OR
  8697        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  8698         (PI-PAYEE-SEQ NOT > '9'))
  8699         MOVE AL-UANON            TO PAYEEA
  8700     ELSE
  8701         MOVE ER-0294            TO EMI-ERROR
  8702         MOVE -1                 TO PAYEEL
  8703         MOVE AL-UABON           TO PAYEEA
  8704         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8705
  8706     IF PI-COMPANY-ID = 'DMD'
  8707         IF PI-PAYEE-TYPE = 'B' AND
  8708            PI-PAYEE-SEQ NOT = '0'
  8709               MOVE ER-7841            TO EMI-ERROR
  8710               MOVE -1                 TO PAYEEL
  8711               MOVE AL-UABON           TO PAYEEA
  8712               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8713
  8714     IF PI-COMPANY-ID = 'JHL'
  8715         IF PI-PAYEE = 'B0'
  8716             NEXT SENTENCE
  8717           ELSE
  8718
  8719* EXEC CICS HANDLE CONDITION
  8720*            ENDFILE(1950-NOT-FOUND)
  8721*            NOTFND (1950-NOT-FOUND)
  8722*        END-EXEC
  8723*    MOVE '"$''I                  ! & #00008456' TO DFHEIV0
  8724     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8726     MOVE X'2620233030303038343536' TO DFHEIV0(25:11)
  8727     CALL 'kxdfhei1' USING DFHEIV0
  8728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8729         MOVE 'N'                    TO FOUND-TOL-SW
  8730         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8731         MOVE '2'                    TO CNTL-REC-TYPE
  8732         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  8733         MOVE +0                     TO CNTL-SEQ-NO
  8734         MOVE 'PROC'                 TO FILE-SWITCH
  8735         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  8736         IF PI-PAYEE = 'I1' AND
  8737            APPROVAL-LEVEL-2
  8738             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL156.cbl
  8739           ELSE
  8740         IF NOT PI-USER-ALMIGHTY-YES
  8741             MOVE ER-3546        TO EMI-ERROR
  8742             MOVE -1             TO PAYEEL
  8743             MOVE AL-UABON       TO PAYEEA
  8744             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8745
  8746     IF PI-PAYEE-TYPE = 'E'
  8747        IF PI-PMTTYPE = '5' OR '6'
  8748            NEXT SENTENCE
  8749        ELSE
  8750            MOVE ER-3539            TO EMI-ERROR
  8751            MOVE -1                 TO PAYEEL
  8752            MOVE AL-UABON           TO PAYEEA
  8753            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8754
  8755 1000-CONT-EDIT.
  8756
  8757     IF PI-OFFLINE NOT = 'Y' AND 'N'
  8758        IF PI-EPYAMT NOT NEGATIVE
  8759            MOVE ER-0421         TO EMI-ERROR
  8760            MOVE -1              TO OFFLINEL
  8761            MOVE AL-UABON        TO OFFLINEA
  8762            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8763        ELSE
  8764            MOVE AL-UANON        TO OFFLINEA.
  8765
  8766     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8767        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  8768           CONTINUE
  8769        ELSE
  8770           MOVE ER-1561          TO EMI-ERROR
  8771           MOVE -1               TO EOBYNL
  8772           MOVE AL-UABON         TO EOBYNA
  8773           PERFORM 9900-ERROR-FORMAT
  8774                                 THRU 9900-EXIT
  8775        END-IF
  8776     END-IF
  8777     IF PI-EPYAMT IS NEGATIVE
  8778         IF PI-OFFLINE NOT = 'Y'
  8779             MOVE ER-0836        TO  EMI-ERROR
  8780             MOVE -1             TO  OFFLINEL
  8781             MOVE AL-UABON       TO  OFFLINEA
  8782             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8783
  8784     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  8785        MOVE ER-0872             TO EMI-ERROR
  8786        MOVE -1                  TO PROOFDTL
  8787        MOVE AL-UABON            TO PROOFDTA
  8788        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8789     ELSE
  8790        MOVE '4'                TO DC-OPTION-CODE
  8791        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  8792        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  8793        IF DATE-CONVERSION-ERROR
  8794            MOVE ER-0873        TO EMI-ERROR
  8795            MOVE -1                  TO PROOFDTL
  8796            MOVE AL-UABON            TO PROOFDTA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL156.cbl
  8797            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8798        ELSE
  8799            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  8800            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  8801                MOVE ER-0873    TO EMI-ERROR
  8802                MOVE -1                  TO PROOFDTL
  8803                MOVE AL-UABON            TO PROOFDTA
  8804                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8805            END-IF
  8806        END-IF
  8807     END-IF.
  8808
  8809     IF PI-COMPANY-ID = 'DMD'
  8810        IF NOTE1L NOT = ZEROS
  8811            MOVE ER-7844        TO  EMI-ERROR
  8812            MOVE -1             TO  NOTE1L
  8813            MOVE AL-UABON       TO  NOTE1A
  8814            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8815
  8816     IF PI-COMPANY-ID = 'DMD'
  8817        IF NOTE2L NOT = ZEROS
  8818          GO TO 1004-DMD-EOB-CHECKS.
  8819
  8820     IF NOTE1L NOT > +0
  8821         GO TO 1005-CHECK-ERRORS.
  8822
  8823     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  8824         GO TO 1005-CHECK-ERRORS.
  8825
  8826     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  8827         GO TO 1003-HAN-PMT-NOTES.
  8828
  8829     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  8830
  8831     IF WS-PMTOPTION NUMERIC
  8832        IF WS-PMTOPTION > '00' AND < '17'
  8833           NEXT SENTENCE
  8834        ELSE
  8835           MOVE ER-0618          TO EMI-ERROR
  8836           MOVE -1               TO NOTE1L
  8837           MOVE AL-UABON         TO NOTE1A
  8838           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8839     ELSE
  8840        GO TO 1005-CHECK-ERRORS.
  8841
  8842     IF WS-PMTOPTION = '05' AND
  8843        WS-DOCNAME = SPACES
  8844          MOVE ER-0616             TO EMI-ERROR
  8845          MOVE -1                  TO NOTE1L
  8846          MOVE AL-UABON            TO NOTE1A
  8847          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8848
  8849     IF WS-PMTOPTION = '15' OR '16'
  8850
  8851* EXEC CICS BIF DEEDIT
  8852*            FIELD (WS-AMOUNT)
  8853*            LENGTH(08)
  8854*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL156.cbl
  8855     MOVE 08
  8856       TO DFHEIV11
  8857*    MOVE '@"L                   #   #00008581' TO DFHEIV0
  8858     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8859     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8860     MOVE X'2020233030303038353831' TO DFHEIV0(25:11)
  8861     CALL 'kxdfhei1' USING DFHEIV0,
  8862           WS-AMOUNT,
  8863           DFHEIV11
  8864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8865        IF (WS-NUM-AMT = ZEROS) OR
  8866           (WS-AMOUNT NOT NUMERIC)
  8867           MOVE ER-0617          TO EMI-ERROR
  8868           MOVE -1               TO NOTE1L
  8869           MOVE AL-UABON         TO NOTE1A
  8870           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8871
  8872     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8873
  8874     GO TO 1005-CHECK-ERRORS.
  8875
  8876 1003-HAN-PMT-NOTES.
  8877
  8878     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  8879
  8880     IF WS-HAN-PMT-CODE = SPACE
  8881         MOVE SPACES             TO WS-HAN-PMT-NOTE
  8882     ELSE
  8883     IF WS-HAN-PMT-CODE = 'A'
  8884         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  8885                                 TO WS-HAN-PMT-NOTE
  8886     ELSE
  8887     IF WS-HAN-PMT-CODE = 'B'
  8888         MOVE ':FINAL PAYMENT / DECEASED'
  8889                                 TO WS-HAN-PMT-NOTE
  8890     ELSE
  8891     IF WS-HAN-PMT-CODE = 'C'
  8892         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  8893                                 TO WS-HAN-PMT-NOTE
  8894     ELSE
  8895     IF WS-HAN-PMT-CODE = 'D'
  8896         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  8897                                 TO WS-HAN-PMT-NOTE
  8898     ELSE
  8899     IF WS-HAN-PMT-CODE = 'E'
  8900         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  8901                                 TO WS-HAN-PMT-NOTE
  8902     ELSE
  8903     IF WS-HAN-PMT-CODE = 'F'
  8904         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  8905                                 TO WS-HAN-PMT-NOTE
  8906     ELSE
  8907     IF WS-HAN-PMT-CODE = 'P'
  8908         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  8909
  8910     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8911     GO TO 1005-CHECK-ERRORS.
  8912
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL156.cbl
  8913 1004-DMD-EOB-CHECKS.
  8914
  8915     INITIALIZE PI-AT-EOB-CODES.
  8916
  8917     IF NOTE2I (20:21) > SPACES
  8918         MOVE ER-7845          TO EMI-ERROR
  8919         MOVE -1               TO NOTE2L
  8920         MOVE AL-UABON         TO NOTE2A
  8921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8922         GO TO 1005-CHECK-ERRORS
  8923      ELSE
  8924         MOVE NOTE2I             TO W-EOB-CODES.
  8925
  8926     MOVE +1                     TO W-EOB-NDX.
  8927
  8928 1004-CHECK-EACH-EOB.
  8929
  8930     IF W-EOB-NDX > +5
  8931             OR
  8932        W-EOB-CODE (W-EOB-NDX) = SPACES
  8933         GO TO 1004-CHECK-DUP-EOB.
  8934
  8935     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  8936         MOVE ER-0956            TO EMI-ERROR
  8937         MOVE -1                 TO NOTE2L
  8938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8939         GO TO 1005-CHECK-ERRORS.
  8940
  8941     MOVE 'CL'                   TO CD-SYSTEM-ID.
  8942     MOVE 'EO'                   TO CD-RECORD-TYPE.
  8943     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  8944     MOVE 'DLO023'               TO PGM-NAME.
  8945
  8946
  8947* EXEC CICS LINK
  8948*        PROGRAM    (PGM-NAME)
  8949*        COMMAREA   (CD-COMMUNICATION-AREA)
  8950*        LENGTH     (CD-RCRD-LENGTH)
  8951*    END-EXEC.
  8952*    MOVE '."C                   ''   #00008666' TO DFHEIV0
  8953     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8954     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8955     MOVE X'2020233030303038363636' TO DFHEIV0(25:11)
  8956     CALL 'kxdfhei1' USING DFHEIV0,
  8957           PGM-NAME,
  8958           CD-COMMUNICATION-AREA,
  8959           CD-RCRD-LENGTH,
  8960           DFHEIV99,
  8961           DFHEIV99,
  8962           DFHEIV99
  8963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8964
  8965
  8966     IF CD-RETURN-CODE = 'OK'
  8967         GO TO 1004-CONT.
  8968
  8969     MOVE -1                     TO NOTE2L.
  8970
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL156.cbl
  8971     IF CD-RETURN-CODE = '01'
  8972         MOVE ER-8310            TO EMI-ERROR
  8973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8974         GO TO 1005-CHECK-ERRORS.
  8975
  8976     IF CD-RETURN-CODE = '02'
  8977         MOVE ER-8311            TO EMI-ERROR
  8978         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8979         GO TO 1005-CHECK-ERRORS.
  8980
  8981     IF CD-RETURN-CODE = '03'
  8982         MOVE ER-8312            TO EMI-ERROR
  8983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8984         GO TO 1005-CHECK-ERRORS.
  8985
  8986     IF CD-RETURN-CODE = '04'
  8987         MOVE ER-8313            TO EMI-ERROR
  8988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8989         GO TO 1005-CHECK-ERRORS.
  8990
  8991     IF CD-RETURN-CODE = '05'
  8992         MOVE ER-8314            TO EMI-ERROR
  8993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8994         GO TO 1005-CHECK-ERRORS.
  8995
  8996     IF CD-RETURN-CODE = '06'
  8997         MOVE ER-8315            TO EMI-ERROR
  8998         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8999         GO TO 1005-CHECK-ERRORS.
  9000
  9001     IF CD-RETURN-CODE = 'E1'
  9002         MOVE ER-8316            TO EMI-ERROR
  9003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9004         GO TO 1005-CHECK-ERRORS.
  9005
  9006     IF CD-RETURN-CODE = 'N1'
  9007         MOVE ER-8317            TO EMI-ERROR
  9008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9009         GO TO 1005-CHECK-ERRORS.
  9010
  9011 1004-CONT.
  9012     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9013
  9014     ADD +1 TO W-EOB-NDX.
  9015     GO TO 1004-CHECK-EACH-EOB.
  9016
  9017 1004-CHECK-DUP-EOB.
  9018     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9019         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9020                               PI-AT-EOB-CODE (3) OR
  9021                               PI-AT-EOB-CODE (4) OR
  9022                               PI-AT-EOB-CODE (5)))
  9023                  OR
  9024        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9025         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9026                               PI-AT-EOB-CODE (4) OR
  9027                               PI-AT-EOB-CODE (5)))
  9028                  OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL156.cbl
  9029        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9030         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9031                               PI-AT-EOB-CODE (5)))
  9032                  OR
  9033        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9034         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9035            MOVE ER-8000            TO EMI-ERROR
  9036            MOVE AL-UABON           TO NOTE2A
  9037            MOVE -1                 TO NOTE2L
  9038            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9039            GO TO 1005-CHECK-ERRORS.
  9040
  9041 1005-CHECK-ERRORS.
  9042*    IF PI-COMPANY-ID NOT = 'DMD'
  9043        GO TO 1006-CHECK-ERRORS.
  9044
  9045*********  DMD CODE START ******************
  9046*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9047*       GO TO 1006-CHECK-ERRORS.
  9048*
  9049*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9050*
  9051*    COMPUTE W-PAYMENT-TOTAL
  9052*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9053*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9054*               AND
  9055*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9056*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9057*          MOVE ER-0967    TO EMI-ERROR
  9058*          MOVE -1         TO PMTTYPEL
  9059*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9060*
  9061*    GO TO 1006-CHECK-ERRORS.
  9062*********  DMD CODE END ******************
  9063
  9064 1006-CHECK-ERRORS.
  9065     IF NOT EMI-NO-ERRORS
  9066        GO TO 2000-EDIT-DONE.
  9067
  9068
  9069* EXEC CICS HANDLE CONDITION
  9070*        NOTFND(1950-NOT-FOUND)
  9071*    END-EXEC.
  9072*    MOVE '"$I                   ! '' #00008774' TO DFHEIV0
  9073     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9075     MOVE X'2720233030303038373734' TO DFHEIV0(25:11)
  9076     CALL 'kxdfhei1' USING DFHEIV0
  9077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9078
  9079
  9080     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9081     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9082     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9083     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9084     MOVE 'MSTR'                 TO FILE-SWITCH.
  9085
  9086     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL156.cbl
  9087
  9088     IF PI-COMPANY-ID = 'DMD'
  9089         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9090
  9091     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9092        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9093           MOVE ER-0873    TO EMI-ERROR
  9094           MOVE -1                  TO PROOFDTL
  9095           MOVE AL-UABON            TO PROOFDTA
  9096           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9097        END-IF
  9098     END-IF
  9099     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9100         IF PI-PMTTYPE = '5' OR '6'
  9101             NEXT SENTENCE
  9102         ELSE
  9103             MOVE ER-0555             TO EMI-ERROR
  9104             MOVE -1                  TO PMTTYPEL
  9105             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9106
  9107     IF CL-LAST-CLOSE-REASON = '2'
  9108         IF CL-CLAIM-STATUS = 'C'
  9109             MOVE ER-0760        TO  EMI-ERROR
  9110             MOVE -1             TO  PMTTYPEL
  9111             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9112
  9113     IF PI-ACTIVITY-CODE = 9
  9114         MOVE ER-3538            TO  EMI-ERROR
  9115         MOVE -1                 TO  PMTTYPEL
  9116         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9117
  9118     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9119         GO TO 1008-READ-CERT.
  9120**********************AIG LOGIC STARTS *********************
  9121     IF CL-CERT-PRIME = 'INCOMPLETE'
  9122         MOVE ER-3540            TO  EMI-ERROR
  9123         MOVE -1                 TO  PMTTYPEL
  9124         MOVE AL-UABON           TO  PMTTYPEA
  9125         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9126         GO TO 2000-EDIT-DONE.
  9127
  9128     IF PI-PMTTYPE = '4'
  9129         IF PI-EPYAMT IS NEGATIVE
  9130             IF PI-ECHECKNO-CR = 'CR'
  9131                 NEXT SENTENCE
  9132             ELSE
  9133                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9134
  9135     IF PI-PMTTYPE = '4'
  9136         IF PI-ECHECKNO-CR = 'CR'
  9137             IF PI-EPYAMT IS NEGATIVE
  9138                 NEXT SENTENCE
  9139             ELSE
  9140                 MOVE ER-0834    TO  EMI-ERROR
  9141                 MOVE -1         TO  EPYAMTL
  9142                 MOVE AL-UNBON   TO  EPYAMTA
  9143                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9144
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL156.cbl
  9145     IF PI-PMTTYPE = '4'
  9146         IF PI-EPYAMT IS NEGATIVE
  9147             IF PI-OFFLINE = 'Y'
  9148                 NEXT SENTENCE
  9149             ELSE
  9150                 MOVE 'Y'        TO  PI-OFFLINE
  9151                                     WS-OFFLINE
  9152                                     OFFLINEO
  9153                 MOVE AL-UANON   TO  OFFLINEA.
  9154
  9155     IF PI-PMTTYPE = '4'
  9156         IF PI-EPYAMT IS NEGATIVE
  9157             IF PI-CASH = 'Y'
  9158                 NEXT SENTENCE
  9159             ELSE
  9160                 MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9161                 MOVE AL-UANON   TO  CASHA
  9162                 GO TO 1007-DEFAULT-AIG-CHECKNO.
  9163
  9164     IF PI-CASH NOT = 'Y' AND 'N'
  9165          IF PI-OFFLINE = 'Y'  AND
  9166             PI-ECHECKNO-CR = 'CR'
  9167               MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9168               MOVE AL-UANON     TO  CASHA
  9169               GO TO 1007-DEFAULT-AIG-CHECKNO.
  9170
  9171     IF PI-CASH NOT = 'Y' AND 'N'
  9172         IF PI-PMTTYPE = '5' OR '6'
  9173             MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9174             MOVE AL-UANON       TO  CASHA
  9175             GO TO 1007-DEFAULT-AIG-CHECKNO.
  9176
  9177     IF PI-CASH NOT = 'Y' AND 'N'
  9178        IF CL-ASSOCIATES = 'N' OR 'A'
  9179            MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9180            MOVE AL-UANON        TO  CASHA
  9181        ELSE
  9182            MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9183            MOVE AL-UANON        TO  CASHA.
  9184
  9185     IF PI-PMTTYPE = '5' OR '6'
  9186         IF PI-CASH = 'N'
  9187             MOVE ER-0819        TO  EMI-ERROR
  9188             MOVE AL-UANON       TO  CASHA
  9189             MOVE -1             TO  CASHL
  9190             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9191
  9192     IF CL-ASSOCIATES = 'N' OR 'A'
  9193        IF CASHI = 'N'
  9194         MOVE ER-3537            TO  EMI-ERROR
  9195         MOVE AL-UANON           TO  CASHA
  9196         MOVE -1                 TO  CASHL
  9197         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9198
  9199 1007-DEFAULT-AIG-CHECKNO.
  9200
  9201     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9202         MOVE ER-3532            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL156.cbl
  9203         MOVE -1                 TO  PMTTYPEL
  9204         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9205**********************AIG LOGIC ENDS ***********************
  9206
  9207 1008-READ-CERT.
  9208
  9209     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9210     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9211     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9212     MOVE CL-CERT-STATE          TO CERT-STATE.
  9213     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9214     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9215     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9216     MOVE 'CERT'                 TO FILE-SWITCH.
  9217
  9218     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9219
  9220     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9221         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9222     ELSE
  9223         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9224
  9225*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9226*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9227
  9228     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9229         MOVE ER-0458            TO EMI-ERROR
  9230         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9231
  9232     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9233         MOVE ER-0459            TO EMI-ERROR
  9234         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9235
  9236     IF CL-REPORTED-DT = LOW-VALUES
  9237        MOVE ER-0530             TO EMI-ERROR
  9238        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9239
  9240     IF PI-COMPANY-ID = 'NCL'
  9241        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9242            MOVE ER-0770            TO EMI-ERROR
  9243            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9244
  9245     IF PI-COMPANY-ID = 'NCL'
  9246        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9247            MOVE ER-0737            TO EMI-ERROR
  9248            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9249
  9250     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9251         MOVE ER-0768            TO  EMI-ERROR
  9252         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9253
  9254     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9255         MOVE ER-0769            TO  EMI-ERROR
  9256         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9257
  9258     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9259         GO TO 1020-DO-LIFE-EDITS
  9260     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL156.cbl
  9261         GO TO 1030-DO-AH-EDITS.
  9262
  9263 1010-GENERAL-ERROR.
  9264     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9265
  9266     IF EMI-MESSAGE-FORMATTED
  9267         MOVE -1                 TO PMTTYPEL.
  9268
  9269 1010-EXIT.
  9270     EXIT.
  9271
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL156.cbl
  9273 1020-DO-LIFE-EDITS.
  9274     IF CM-LF-BENEFIT-CD = '00'
  9275         IF PI-PMTTYPE = '5' OR '6'
  9276             MOVE ER-0658        TO EMI-ERROR
  9277             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9278         ELSE
  9279             MOVE ER-1775        TO EMI-ERROR
  9280             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9281
  9282     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9283         MOVE ER-0460            TO EMI-ERROR
  9284         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9285
  9286     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9287     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9288     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9289     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9290     MOVE '4'                    TO  CNTL-REC-TYPE.
  9291     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9292     MOVE 'BENE'                 TO  FILE-SWITCH.
  9293     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9294     IF NO-BENEFIT-FOUND
  9295         GO TO 1950-NOT-FOUND.
  9296
  9297     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9298
  9299     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9300         IF PI-PMTTYPE = '4'
  9301             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9302                PI-LF-COVERAGE-TYPE = 'P'
  9303                 NEXT SENTENCE
  9304             ELSE
  9305                 MOVE ER-0461        TO EMI-ERROR
  9306                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9307         ELSE
  9308            NEXT SENTENCE
  9309     ELSE
  9310         IF PI-PMTTYPE = '2'
  9311            IF NOT CM-O-B-COVERAGE
  9312              AND CM-LF-CURRENT-STATUS = '7'
  9313                MOVE ER-0462     TO EMI-ERROR
  9314                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9315
  9316     IF PI-PMTTYPE = '2'
  9317         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9318            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9319             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9320             MOVE ER-0730            TO  EMI-ERROR
  9321             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9322             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9323
  9324     IF PI-PMTTYPE = '2'
  9325         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9326            PI-LF-COVERAGE-TYPE = 'P'
  9327             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9328                 MOVE ER-0462    TO  EMI-ERROR
  9329                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9330
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL156.cbl
  9331     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9332       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9333         MOVE ER-0466            TO EMI-ERROR
  9334         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9335
  9336     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9337         IF PI-PMTTYPE = '3'
  9338             MOVE 0436           TO EMI-ERROR
  9339             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9340             GO TO 1045-EDIT-PAYEE-ADDR
  9341         ELSE
  9342             GO TO 1045-EDIT-PAYEE-ADDR.
  9343
  9344     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9345        PI-LF-COVERAGE-TYPE = 'P'
  9346         IF PI-PMTTYPE = '3'
  9347             MOVE ER-0436          TO  EMI-ERROR
  9348             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9349         ELSE
  9350             NEXT SENTENCE
  9351     ELSE
  9352         IF PI-PMTTYPE = '1' OR '3'
  9353             MOVE ER-0436            TO EMI-ERROR
  9354             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9355*
  9356     IF PI-COMPANY-ID = 'CID' AND
  9357        CL-CERT-STATE = 'SC'  AND
  9358        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9359           MOVE ER-0879    TO  EMI-ERROR
  9360           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9361     END-IF.
  9362     IF PI-COMPANY-ID = 'AHL' AND
  9363        CL-CERT-STATE = 'SC'  AND
  9364        (CM-LF-BENEFIT-CD = '5I' OR '6J')
  9365           MOVE ER-0879    TO  EMI-ERROR
  9366           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9367     END-IF.
  9368
  9369     GO TO 1045-EDIT-PAYEE-ADDR.
  9370
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL156.cbl
  9372 1030-DO-AH-EDITS.
  9373     IF CM-AH-BENEFIT-CD = '00'
  9374         IF PI-PMTTYPE = '5' OR '6'
  9375             MOVE ER-0658        TO EMI-ERROR
  9376             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9377         ELSE
  9378             MOVE ER-1775        TO EMI-ERROR
  9379             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9380
  9381     IF CL-TOTAL-PAID-AMT = ZEROS
  9382         IF PI-PMTTYPE = '4'
  9383             MOVE ER-0438        TO EMI-ERROR
  9384             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9385
  9386     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9387         IF PI-PMTTYPE = '3'
  9388             MOVE ER-0463        TO EMI-ERROR
  9389             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9390         ELSE
  9391             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9392              AND CM-LF-CURRENT-STATUS = '7'
  9393                 MOVE ER-0465    TO EMI-ERROR
  9394                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9395
  9396     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9397         IF PI-PMTTYPE = '3'
  9398             MOVE ER-0464        TO EMI-ERROR
  9399             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9400         ELSE
  9401             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9402                 MOVE ER-0469    TO EMI-ERROR
  9403                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9404
  9405     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9406         IF PI-PMTTYPE = '3'
  9407             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9408                 MOVE ER-0467    TO EMI-ERROR
  9409                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9410             ELSE
  9411                 NEXT SENTENCE
  9412         ELSE
  9413             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9414                 MOVE ER-0468    TO EMI-ERROR
  9415                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9416
  9417     GO TO 1045-EDIT-PAYEE-ADDR.
  9418
  9419 1040-PMTTYPE-ERROR.
  9420     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9421
  9422     IF EMI-MESSAGE-FORMATTED
  9423         MOVE -1                 TO PMTTYPEL
  9424         MOVE AL-UABON           TO PMTTYPEA.
  9425
  9426 1040-EXIT.
  9427     EXIT.
  9428
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL156.cbl
  9430 1045-EDIT-PAYEE-ADDR.
  9431
  9432     IF PI-OFFLINE = 'N' AND
  9433        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9434           < PI-PAYEE-SEQ-NUM)
  9435        OR
  9436         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9437         (PI-PAYEE-TYPE = 'B')                 AND
  9438         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9439        OR
  9440         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9441           < PI-PAYEE-SEQ-NUM)
  9442        OR
  9443         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9444           < PI-PAYEE-SEQ-NUM)
  9445        OR
  9446         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9447           < PI-PAYEE-SEQ-NUM)
  9448        OR
  9449         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9450           < PI-PAYEE-SEQ-NUM)
  9451        OR
  9452         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9453           < PI-PAYEE-SEQ-NUM))
  9454             MOVE ER-0437        TO EMI-ERROR
  9455             MOVE -1             TO PAYEEL
  9456             MOVE AL-UABON       TO PAYEEA
  9457             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9458
  9459     IF PI-OFFLINE    = 'N' AND
  9460        PI-PAYEE-TYPE = 'B' AND
  9461        PI-PAYEE-SEQ  = '0'
  9462         PERFORM 7920-READ-BENE THRU 7920-EXIT
  9463         IF BENE-FOUND-SW = 'N'
  9464             MOVE ER-0437        TO EMI-ERROR
  9465             MOVE -1             TO PAYEEL
  9466             MOVE AL-UABON       TO PAYEEA
  9467             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9468
  9469     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9470        IF PI-OFFLINE    = 'N'  AND
  9471           PI-PAYEE-TYPE = 'B'  AND
  9472           PI-PAYEE-SEQ  = '9'
  9473             PERFORM 7920-READ-BENE THRU 7920-EXIT
  9474             IF BENE-FOUND-SW = 'N'
  9475                MOVE ER-0437        TO EMI-ERROR
  9476                MOVE -1             TO PAYEEL
  9477                MOVE AL-UABON       TO PAYEEA
  9478                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9479
  9480*    IF PI-COMPANY-ID = 'CRI'
  9481*        IF CL-CLAIM-TYPE = 'L'
  9482*            MOVE 'N'                TO  WS-GROUPED
  9483*                                        PI-GROUPED
  9484*                                        GROUPEDI
  9485*            MOVE AL-UANON           TO  GROUPEDA
  9486*            GO TO 1050-EDIT-CHECK-NO
  9487*        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL156.cbl
  9488*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
  9489*            IF WS-GROUP-1 = 'C'
  9490*                NEXT SENTENCE
  9491*            ELSE
  9492*                MOVE 'N'            TO  WS-GROUPED
  9493*                                        PI-GROUPED
  9494*                                        GROUPEDI
  9495*                MOVE AL-UANON       TO  GROUPEDA
  9496*                GO TO 1050-EDIT-CHECK-NO.
  9497
  9498     IF PI-GROUPED = 'Y'
  9499        IF PI-PAYEE-TYPE = 'B' OR 'A'
  9500           NEXT SENTENCE
  9501        ELSE
  9502           MOVE ER-0437        TO EMI-ERROR
  9503           MOVE -1             TO PAYEEL
  9504           MOVE AL-UABON       TO PAYEEA
  9505           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9506
  9507     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
  9508        (PI-GROUPED    = ' ')
  9509        NEXT SENTENCE
  9510     ELSE
  9511        GO TO 1050-EDIT-CHECK-NO.
  9512
  9513     IF PI-COMPANY-ID = 'CRI'
  9514        MOVE 'N'           TO GROUPEDI
  9515                              PI-GROUPED
  9516                              WS-GROUPED
  9517        MOVE AL-UANON      TO GROUPEDA.
  9518
  9519     IF PI-COMPANY-ID = 'CRI'
  9520        IF PI-PAYEE-TYPE = 'B'
  9521           IF BENE-FOUND-SW = 'Y'
  9522              IF BE-GROUP-CHECKS-Y-N = 'Y'
  9523                 MOVE 'Y'           TO GROUPEDI
  9524                                       PI-GROUPED
  9525                                       WS-GROUPED
  9526                 MOVE AL-UANON      TO GROUPEDA
  9527              ELSE
  9528                 NEXT SENTENCE
  9529           ELSE
  9530              PERFORM 7920-READ-BENE THRU 7920-EXIT
  9531              IF BENE-FOUND-SW = 'Y'
  9532                 IF BE-GROUP-CHECKS-Y-N = 'Y'
  9533                    MOVE 'Y'      TO GROUPEDI
  9534                                     PI-GROUPED
  9535                                     WS-GROUPED
  9536                    MOVE AL-UANON TO GROUPEDA.
  9537
  9538     IF PI-COMPANY-ID NOT = 'CRI'
  9539        GO TO 1050-EDIT-CHECK-NO.
  9540
  9541*************** CRI CODE START ******************
  9542     IF PI-PAYEE-TYPE NOT = 'A'
  9543        GO TO 1050-EDIT-CHECK-NO.
  9544
  9545     MOVE LOW-VALUES             TO ERACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL156.cbl
  9546     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9547     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9548     MOVE PI-GROUPING            TO ACCT-GROUPING.
  9549     MOVE PI-STATE               TO ACCT-STATE.
  9550     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9551     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
  9552     MOVE 'ACCT'                 TO FILE-SWITCH.
  9553
  9554     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
  9555     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
  9556
  9557
  9558* EXEC CICS HANDLE CONDITION
  9559*         NOTFND   (1950-NOT-FOUND)
  9560*         ENDFILE  (1950-NOT-FOUND)
  9561*    END-EXEC.
  9562*    MOVE '"$I''                  ! ( #00009255' TO DFHEIV0
  9563     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9565     MOVE X'2820233030303039323535' TO DFHEIV0(25:11)
  9566     CALL 'kxdfhei1' USING DFHEIV0
  9567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9568
  9569
  9570
  9571* EXEC CICS STARTBR
  9572*         DATASET   ('ERACCT')
  9573*         RIDFLD    (ERACCT-KEY)
  9574*         GTEQ
  9575*    END-EXEC.
  9576     MOVE 'ERACCT' TO DFHEIV1
  9577     MOVE 0
  9578       TO DFHEIV11
  9579*    MOVE '&,         G          &   #00009260' TO DFHEIV0
  9580     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9581     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9582     MOVE X'2020233030303039323630' TO DFHEIV0(25:11)
  9583     CALL 'kxdfhei1' USING DFHEIV0,
  9584           DFHEIV1,
  9585           ERACCT-KEY,
  9586           DFHEIV99,
  9587           DFHEIV11,
  9588           DFHEIV99
  9589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9590
  9591
  9592 1046-READNEXT-ERACCT.
  9593
  9594
  9595* EXEC CICS READNEXT
  9596*         DATASET   ('ERACCT')
  9597*         RIDFLD    (ERACCT-KEY)
  9598*         SET       (ADDRESS OF ACCOUNT-MASTER)
  9599*    END-EXEC.
  9600     MOVE 'ERACCT' TO DFHEIV1
  9601     MOVE 0
  9602       TO DFHEIV11
  9603*    MOVE '&.S                   )   #00009268' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL156.cbl
  9604     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9605     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9606     MOVE X'2020233030303039323638' TO DFHEIV0(25:11)
  9607     CALL 'kxdfhei1' USING DFHEIV0,
  9608           DFHEIV1,
  9609           DFHEIV20,
  9610           DFHEIV99,
  9611           ERACCT-KEY,
  9612           DFHEIV99,
  9613           DFHEIV11,
  9614           DFHEIV99,
  9615           DFHEIV99
  9616     SET ADDRESS OF ACCOUNT-MASTER TO
  9617         DFHEIV20
  9618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9619
  9620
  9621     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
  9622        IF WS-ERACCT-HOLD-RECORD = SPACES
  9623           GO TO 1950-NOT-FOUND
  9624        ELSE
  9625           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
  9626           GO TO 1048-CONTINUE.
  9627
  9628     IF ACCT-EXP-DT = HIGH-VALUES
  9629        NEXT SENTENCE
  9630     ELSE
  9631        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
  9632        GO TO 1046-READNEXT-ERACCT.
  9633
  9634 1048-CONTINUE.
  9635
  9636     IF AM-GROUPED-CHECKS-Y-N = 'Y'
  9637        MOVE 'Y'                 TO GROUPEDI
  9638                                    PI-GROUPED
  9639                                    WS-GROUPED
  9640        MOVE AL-UANON            TO GROUPEDA.
  9641*************** CRI CODE END ******************
  9642
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL156.cbl
  9644 1050-EDIT-CHECK-NO.
  9645
  9646     IF PI-OFFLINE = 'Y'
  9647         IF PI-ECHECKNO = SPACES
  9648              MOVE ER-0439        TO EMI-ERROR
  9649              GO TO 1090-CHECK-NO-ERROR
  9650           ELSE
  9651         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9652            IF PI-ECHECKNO-N = 'N' AND
  9653               PI-CASH       = 'Y'
  9654                 MOVE ER-3535        TO EMI-ERROR
  9655                 GO TO 1090-CHECK-NO-ERROR
  9656              ELSE
  9657                 MOVE AL-UANON    TO CHECKNOA
  9658                 GO TO 1100-EDIT-HOLDTIL
  9659          ELSE
  9660            MOVE AL-UANON    TO CHECKNOA
  9661            GO TO 1100-EDIT-HOLDTIL.
  9662
  9663     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9664     MOVE '6'                    TO CNTL-REC-TYPE.
  9665
  9666     IF CONTROL-IS-ACTUAL-CARRIER
  9667         MOVE PI-CARRIER         TO WS-CARR
  9668     ELSE
  9669         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
  9670
  9671     IF PI-COMPANY-ID = 'FIA'
  9672         MOVE PI-CARRIER         TO WS-CARR.
  9673
  9674     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9675     MOVE 0                      TO CNTL-SEQ-NO.
  9676     MOVE 'CARR'                 TO FILE-SWITCH.
  9677
  9678     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
  9679
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL156.cbl
  9681     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9682         GO TO 1051-EDIT-CHECKNO-CONT.
  9683
  9684**********************AIG LOGIC STARTS**********************
  9685     IF PI-ECHECKNO = SPACES
  9686         IF CHECK-NO-MANUAL
  9687             MOVE ER-0441        TO EMI-ERROR
  9688             GO TO 1090-CHECK-NO-ERROR
  9689         ELSE
  9690             MOVE AL-UANOF       TO CHECKNOA
  9691             GO TO 1100-EDIT-HOLDTIL.
  9692
  9693     IF PI-ECHECKNO NOT = SPACES
  9694         IF CHECK-NO-MANUAL
  9695             MOVE AL-UANON       TO CHECKNOA
  9696             GO TO 1100-EDIT-HOLDTIL.
  9697
  9698     IF PI-ECHECKNO-CR = 'CR'
  9699        IF PI-OFFLINE = 'Y'
  9700            MOVE AL-UANON       TO CHECKNOA
  9701            GO TO 1100-EDIT-HOLDTIL
  9702        ELSE
  9703            MOVE ER-3534        TO EMI-ERROR
  9704            GO TO 1090-CHECK-NO-ERROR.
  9705
  9706     IF PI-ECHECKNO-N = 'N'
  9707        IF PI-CASH = 'N'
  9708            MOVE AL-UANON       TO CHECKNOA
  9709            GO TO 1100-EDIT-HOLDTIL
  9710        ELSE
  9711            MOVE ER-3535          TO EMI-ERROR
  9712            GO TO 1090-CHECK-NO-ERROR.
  9713
  9714     MOVE ER-0442        TO EMI-ERROR
  9715     GO TO 1090-CHECK-NO-ERROR.
  9716**********************AIG LOGIC ENDS************************
  9717
  9718 1051-EDIT-CHECKNO-CONT.
  9719
  9720     IF PI-COMPANY-ID = 'DMD'
  9721        IF PI-ECHECKNO NOT = SPACES
  9722           IF PI-ECHECKNO (6:2) NOT = 'TP'
  9723              MOVE ER-0442        TO EMI-ERROR
  9724              GO TO 1090-CHECK-NO-ERROR
  9725            ELSE
  9726              GO TO 1100-EDIT-HOLDTIL
  9727          ELSE
  9728           GO TO 1100-EDIT-HOLDTIL.
  9729
  9730     IF PI-ECHECKNO = SPACES
  9731         IF CHECK-NO-MANUAL
  9732             MOVE ER-0441        TO EMI-ERROR
  9733             GO TO 1090-CHECK-NO-ERROR
  9734         ELSE
  9735             MOVE AL-UANOF       TO CHECKNOA
  9736             GO TO 1100-EDIT-HOLDTIL
  9737     ELSE
  9738         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL156.cbl
  9739             MOVE AL-UANON       TO CHECKNOA
  9740             GO TO 1100-EDIT-HOLDTIL
  9741         ELSE
  9742             MOVE ER-0442        TO EMI-ERROR
  9743             GO TO 1090-CHECK-NO-ERROR.
  9744
  9745 1090-CHECK-NO-ERROR.
  9746     MOVE -1                     TO CHECKNOL.
  9747     MOVE AL-UABON               TO CHECKNOA.
  9748     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9749
  9750     GO TO 2000-EDIT-DONE.
  9751
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL156.cbl
  9753 1100-EDIT-HOLDTIL.
  9754     MOVE AL-UANON               TO HOLDTILA.
  9755
  9756     IF PI-HOLDTIL = ZEROS
  9757        IF PI-OFFLINE = 'Y'
  9758           MOVE ER-0572          TO EMI-ERROR
  9759           GO TO 1105-HOLDTIL-ERROR
  9760        ELSE
  9761           GO TO 1110-EDIT-PAID-FROM.
  9762
  9763     MOVE '4'                    TO DC-OPTION-CODE.
  9764     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
  9765     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9766
  9767     IF DATE-CONVERSION-ERROR
  9768         MOVE ER-0446            TO EMI-ERROR
  9769         GO TO 1105-HOLDTIL-ERROR
  9770     END-IF
  9771     IF PI-OFFLINE = 'Y'
  9772        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
  9773           MOVE ER-0446            TO EMI-ERROR
  9774           GO TO 1105-HOLDTIL-ERROR
  9775        END-IF
  9776     END-IF
  9777
  9778     IF PI-OFFLINE = 'Y'
  9779        GO TO 1110-EDIT-PAID-FROM.
  9780
  9781     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
  9782     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
  9783     MOVE '1'                    TO DC-OPTION-CODE.
  9784     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9785
  9786     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
  9787         MOVE ER-0447            TO EMI-ERROR
  9788         GO TO 1105-HOLDTIL-ERROR.
  9789
  9790     GO TO 1110-EDIT-PAID-FROM.
  9791
  9792 1105-HOLDTIL-ERROR.
  9793     MOVE -1                     TO HOLDTILL.
  9794     MOVE AL-UNBON               TO HOLDTILA.
  9795     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9796
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL156.cbl
  9798 1110-EDIT-PAID-FROM.
  9799     MOVE AL-UANON               TO EPYFROMA.
  9800
  9801     IF PI-EPYFROM = ZEROS
  9802         GO TO 1120-CALCULATE-PAID-FROM.
  9803
  9804     IF PI-PMTTYPE = '5' OR '6'
  9805         MOVE ER-0448            TO EMI-ERROR
  9806         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9807         MOVE AL-UNBON           TO EPYFROMA
  9808         MOVE -1                 TO EPYFROML
  9809         GO TO 1150-EDIT-PAID-THRU.
  9810
  9811     MOVE '4'                    TO DC-OPTION-CODE.
  9812     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
  9813     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9814
  9815     IF DATE-CONVERSION-ERROR
  9816         MOVE ER-0449            TO EMI-ERROR
  9817         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9818         MOVE AL-UNBON           TO EPYFROMA
  9819         MOVE -1                 TO EPYFROML
  9820     ELSE
  9821         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
  9822
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL156.cbl
  9824 1120-CALCULATE-PAID-FROM.
  9825     IF PI-PMTTYPE = '5' OR '6'
  9826         GO TO 1150-EDIT-PAID-THRU.
  9827
  9828*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9829*       IF PI-PMTTYPE = '4'
  9830*         GO TO 1150-EDIT-PAID-THRU.
  9831
  9832     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9833         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
  9834         MOVE ' '                TO DC-OPTION-CODE
  9835         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9836         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
  9837         GO TO 1145-TEST-PAID-FROM.
  9838
  9839     IF PI-PMTTYPE = '4'
  9840        GO TO 1150-EDIT-PAID-THRU.
  9841
  9842     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  9843     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9844     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9845     MOVE '5'                    TO CNTL-REC-TYPE.
  9846     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9847     MOVE 'BENE'                 TO FILE-SWITCH.
  9848
  9849     IF WS-BEN-CD = ZEROS
  9850         GO TO 1950-NOT-FOUND.
  9851
  9852     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9853
  9854     IF NO-BENEFIT-FOUND
  9855         GO TO 1950-NOT-FOUND.
  9856
  9857     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
  9858     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
  9859
  9860     IF PI-BEN-DAYS NOT NUMERIC
  9861        MOVE ZEROS               TO PI-BEN-DAYS.
  9862
  9863     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
  9864
  9865     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
  9866        (CL-TOTAL-PAID-AMT > ZEROS)
  9867         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  9868         MOVE '6'                 TO DC-OPTION-CODE
  9869         MOVE +0                  TO DC-ELAPSED-MONTHS
  9870         MOVE +1                  TO DC-ELAPSED-DAYS
  9871         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9872         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
  9873         GO TO 1145-TEST-PAID-FROM.
  9874
  9875******************************************************************
  9876****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
  9877****** SPECIAL ENTERED DATE.
  9878******************************************************************
  9879
  9880     IF PI-AIGFROM = ZEROS
  9881         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL156.cbl
  9882
  9883     MOVE AL-UANON TO AIGFROMA.
  9884
  9885     MOVE '4'                    TO DC-OPTION-CODE.
  9886     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
  9887     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9888
  9889     IF DATE-CONVERSION-ERROR
  9890         MOVE ER-0449            TO EMI-ERROR
  9891         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9892         MOVE AL-UNBON           TO AIGFROMA
  9893         MOVE -1                 TO AIGFROML
  9894         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
  9895     ELSE
  9896         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
  9897         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
  9898
  9899     GO TO 1140-CONTINUE-PAID-FROM.
  9900
  9901 1130-CONTINUE-PAID-FROM.
  9902
  9903     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
  9904        (CL-TOTAL-PAID-AMT = ZEROS)
  9905           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
  9906
  9907 1140-CONTINUE-PAID-FROM.
  9908
  9909     IF PI-BEN-TYPE = 'R'
  9910         IF PI-BEN-DAYS = ZEROS
  9911             NEXT SENTENCE
  9912         ELSE
  9913         IF PI-COMPANY-ID NOT = 'DMD'
  9914             SUBTRACT 1 FROM PI-BEN-DAYS.
  9915
  9916     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
  9917
  9918     IF PI-COMPANY-ID = 'DMD'
  9919         MOVE -1                 TO DC-ELAPSED-DAYS
  9920         MOVE +0                 TO DC-ELAPSED-MONTHS
  9921         MOVE '6'                TO DC-OPTION-CODE
  9922         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9923         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
  9924         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
  9925                               REMAINDER DC-ELAPSED-DAYS
  9926      ELSE
  9927         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
  9928         MOVE +0                 TO DC-ELAPSED-MONTHS.
  9929
  9930     MOVE '6'                    TO DC-OPTION-CODE.
  9931     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9932     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
  9933
  9934     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
  9935
  9936     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
  9937         MOVE ER-0541            TO EMI-ERROR
  9938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9939         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL156.cbl
  9940         MOVE AL-UNBON           TO EPYFROMA.
  9941
  9942     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
  9943        (PI-BENEFIT-SAVE = '60E')
  9944        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
  9945           (CL-TOTAL-PAID-AMT = ZEROS)
  9946             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
  9947             MOVE 30                  TO DC-ELAPSED-DAYS
  9948             MOVE +0                  TO DC-ELAPSED-MONTHS
  9949             MOVE '6'                 TO DC-OPTION-CODE
  9950             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9951
  9952     IF PI-BEN-TYPE = 'R'
  9953         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
  9954     ELSE
  9955         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
  9956         IF WS-SV-EPYFROM = LOW-VALUES
  9957            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
  9958
  9959     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
  9960         IF WS-USE-AIG-PAYFROM   OR
  9961            WS-AIG-RECALC-PAYFROM
  9962              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
  9963                                      DC-BIN-DATE-1
  9964              MOVE ' '            TO  DC-OPTION-CODE
  9965              MOVE +0             TO  DC-ELAPSED-MONTHS
  9966                                      DC-ELAPSED-DAYS
  9967              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9968              IF NO-CONVERSION-ERROR
  9969                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
  9970
  9971     IF PI-CPYFROM < CL-INCURRED-DT
  9972        MOVE -1                  TO EPYFROML
  9973        MOVE ER-3542             TO EMI-ERROR
  9974        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9975
  9976     IF CM-ENTRY-DT < CL-INCURRED-DT
  9977        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  9978        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
  9979        MOVE +0                     TO DC-ELAPSED-DAYS
  9980        MOVE +0                     TO DC-ELAPSED-MONTHS
  9981        MOVE '1'                    TO DC-OPTION-CODE
  9982        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9983        ELSE
  9984        MOVE ZEROS TO DC-ELAPSED-MONTHS.
  9985
  9986     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
  9987         NEXT SENTENCE
  9988     ELSE
  9989         IF DC-ELAPSED-MONTHS < 2
  9990             MOVE ER-3255        TO EMI-ERROR
  9991             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9992
  9993 1145-TEST-PAID-FROM.
  9994     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
  9995         GO TO 1150-EDIT-PAID-THRU.
  9996
  9997     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL156.cbl
  9998         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
  9999         MOVE ' '                TO DC-OPTION-CODE
 10000         MOVE +0                 TO DC-ELAPSED-MONTHS
 10001                                    DC-ELAPSED-DAYS
 10002         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10003         IF NO-CONVERSION-ERROR
 10004             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10005         ELSE
 10006             MOVE SPACES             TO EMI-DATE-FIELD.
 10007
 10008     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10009         IF CL-TOTAL-PAID-AMT = ZEROS
 10010             MOVE ER-3543            TO EMI-ERROR
 10011             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10012             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10013             IF EMI-MESSAGE-FORMATTED
 10014                MOVE -1             TO EPYFROML
 10015                MOVE AL-UNBON       TO EPYFROMA
 10016             ELSE
 10017                NEXT SENTENCE
 10018         ELSE
 10019             MOVE ER-0452            TO EMI-ERROR
 10020             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10021             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10022             IF EMI-MESSAGE-FORMATTED
 10023                MOVE -1             TO EPYFROML
 10024                MOVE AL-UNBON       TO EPYFROMA.
 10025
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL156.cbl
 10027 1150-EDIT-PAID-THRU.
 10028
 10029     MOVE AL-UANON               TO EPYTHRUA.
 10030
 10031     IF PI-EPYTHRU = ZEROS
 10032         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10033             GO TO 1200-EDIT-FIND-TOLERANCES
 10034         ELSE
 10035            IF (PI-PMTTYPE = '3') OR
 10036               (PI-PMTTYPE = '2' AND
 10037                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10038               GO TO 1152-CHECK-TYPE
 10039            ELSE
 10040               MOVE ER-0473      TO EMI-ERROR
 10041               GO TO 1170-PAID-THRU-FATAL-ERROR
 10042     ELSE
 10043         IF PI-PMTTYPE = '5' OR '6'
 10044             MOVE ER-0474        TO EMI-ERROR
 10045             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10046
 10047     MOVE '4'                    TO DC-OPTION-CODE.
 10048     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10049     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10050
 10051     IF DATE-CONVERSION-ERROR
 10052         MOVE ER-0475            TO EMI-ERROR
 10053         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10054
 10055     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10056
 10057     IF PI-COMPANY-ID = 'DMD'
 10058         IF PI-PMTTYPE NOT = '2'
 10059                 AND
 10060            WS-EXP-DT > WS-SV-EPYTHRU
 10061             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10062             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10063             MOVE '1'              TO DC-OPTION-CODE
 10064             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10065             IF DATE-CONVERSION-ERROR
 10066                 MOVE ER-0944      TO EMI-ERROR
 10067                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10068             ELSE
 10069                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10070                    DC-ELAPSED-DAYS   = 1
 10071                     MOVE ER-0945  TO EMI-ERROR
 10072                     MOVE -1       TO EPYTHRUL
 10073                     MOVE AL-UABON TO EPYTHRUA
 10074                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10075
 10076     IF PI-PMTTYPE = '4'
 10077         NEXT SENTENCE
 10078     ELSE
 10079         IF WS-SV-EPYTHRU = WS-EXP-DT
 10080             IF PI-PMTTYPE NOT = '2' AND '3'
 10081                 MOVE ER-3541    TO EMI-ERROR
 10082                 MOVE -1         TO PMTTYPEL
 10083                 MOVE AL-UABON   TO PMTTYPEA
 10084                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL156.cbl
 10085
 10086     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10087         MOVE ER-0501            TO EMI-ERROR
 10088         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10089
 10090     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10091        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10092*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10093*              MOVE ER-0540         TO EMI-ERROR
 10094*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10095*              MOVE -1              TO EPYTHRUL
 10096*              MOVE AL-UNBON        TO EPYTHRUA
 10097*          ELSE
 10098*          IF PI-COMPANY-ID = 'DMD'
 10099*              MOVE ER-7540         TO EMI-ERROR
 10100*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10101*              MOVE -1              TO EPYTHRUL
 10102*              MOVE AL-UNBON        TO EPYTHRUA
 10103*          ELSE
 10104               IF PI-PMTTYPE NOT = '2' AND '3'
 10105                  IF PI-COMPANY-ID = '???'
 10106                      MOVE ER-7540  TO EMI-ERROR
 10107                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10108                      MOVE -1       TO EPYTHRUL
 10109                      MOVE AL-UNBON TO EPYTHRUA
 10110                  ELSE
 10111                      MOVE ER-0540  TO EMI-ERROR
 10112                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10113                      MOVE -1       TO EPYTHRUL
 10114                      MOVE AL-UNBON TO EPYTHRUA.
 10115
 10116     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10117            OR
 10118        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10119         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10120            OR
 10121        (PI-CPYFROM NOT = LOW-VALUES AND
 10122         PI-CPYFROM < CL-PAID-THRU-DT)
 10123        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10124
 10125 1152-CHECK-TYPE.
 10126     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10127        OR (PI-PMTTYPE = '5' OR '6')
 10128         GO TO 1160-EDIT-PAID-THRU-AH.
 10129
 10130 1155-EDIT-PAID-THRU-LIFE.
 10131     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10132     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10133     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10134     MOVE '4'                    TO CNTL-REC-TYPE.
 10135     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10136     MOVE 'BENE'                 TO FILE-SWITCH.
 10137
 10138     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10139
 10140     IF NO-BENEFIT-FOUND
 10141         GO TO 1950-NOT-FOUND.
 10142
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL156.cbl
 10143     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10144
 10145     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10146
 10147     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10148        PI-LF-COVERAGE-TYPE = 'P'
 10149         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10150         GO TO 1200-EDIT-FIND-TOLERANCES.
 10151
 10152     IF PI-EPYTHRU = ZEROS
 10153        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10154
 10155     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10156         MOVE ER-0476            TO EMI-ERROR
 10157         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10158
 10159     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10160     MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10161     MOVE +0                    TO DC-ELAPSED-DAYS.
 10162     MOVE '6'                   TO DC-OPTION-CODE.
 10163     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10164
 10165     IF (NO-CONVERSION-ERROR AND
 10166         WS-SPECIAL-CALC-CD = 'C')
 10167        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10168            MOVE ER-0657 TO EMI-ERROR
 10169            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10170
 10171     IF PI-COMPANY-ID = 'NCL'
 10172         IF WS-SPECIAL-CALC-CD = 'C' AND
 10173            CM-LF-CRITICAL-PERIOD = +0
 10174             MOVE ER-0844       TO EMI-ERROR
 10175             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10176
 10177     GO TO 1200-EDIT-FIND-TOLERANCES.
 10178
 10179 1160-EDIT-PAID-THRU-AH.
 10180     IF PI-EPYTHRU = ZEROS
 10181        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10182                                    WS-SV-EPYTHRU
 10183     ELSE
 10184        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10185
 10186     IF WS-SV-EPYTHRU < PI-CPYFROM
 10187         MOVE ER-0508            TO EMI-ERROR
 10188         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10189
 10190     IF PI-PMTTYPE = '3'
 10191        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10192         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10193             MOVE ER-0477        TO EMI-ERROR
 10194             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10195         ELSE
 10196             NEXT SENTENCE
 10197     ELSE
 10198         IF WS-SV-EPYTHRU > WS-EXP-DT
 10199             MOVE ER-0557        TO EMI-ERROR
 10200             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL156.cbl
 10201
 10202     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10203         PI-PMTTYPE NOT = '3'
 10204         MOVE ER-0541        TO EMI-ERROR
 10205         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10206
 10207     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10208        (PI-PMTTYPE NOT = '3')
 10209         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10210             MOVE ER-0478        TO EMI-ERROR
 10211             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10212
 10213     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10214        (PI-PMTTYPE NOT = '4')
 10215         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10216             MOVE ER-0479        TO EMI-ERROR
 10217             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10218
 10219     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10220         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10221             MOVE ER-0545        TO EMI-ERROR
 10222             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10223
 10224     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10225         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10226             MOVE ER-0481        TO EMI-ERROR
 10227             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10228
 10229*    IF PI-COMPANY-ID = 'NCL'
 10230*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10231*           CM-AH-CRITICAL-PERIOD = +0
 10232*            MOVE ER-0844        TO  EMI-ERROR
 10233*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10234
 10235     IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10236        (WS-SPECIAL-CALC-CD NOT = 'C')
 10237          GO TO 1200-EDIT-FIND-TOLERANCES.
 10238
 10239     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10240     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10241     MOVE '1'        TO DC-OPTION-CODE.
 10242     MOVE +0         TO DC-ELAPSED-DAYS
 10243                        DC-ELAPSED-MONTHS.
 10244     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10245
 10246*    IF NO-CONVERSION-ERROR
 10247*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10248*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10249*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10250*           MOVE ER-0657 TO EMI-ERROR
 10251*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10252
 10253     GO TO 1200-EDIT-FIND-TOLERANCES.
 10254
 10255 1165-PAID-THRU-ERROR.
 10256     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10257
 10258     IF EMI-MESSAGE-FORMATTED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL156.cbl
 10259         MOVE -1                 TO EPYTHRUL
 10260         MOVE AL-UNBON           TO EPYTHRUA.
 10261
 10262 1165-EXIT.
 10263     EXIT.
 10264
 10265 1166-CHECK-ALL-TRLRS.
 10266
 10267     IF PI-PMTTYPE = '4'
 10268        GO TO 1166-TRLR-EXIT.
 10269
 10270     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10271
 10272     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10273        WS-SV-EPYFROM = LOW-VALUES
 10274          GO TO 1166-END-CHECK.
 10275
 10276
 10277* EXEC CICS HANDLE CONDITION
 10278*        ENDFILE   (1166-END-CHECK)
 10279*        NOTFND    (1166-END-CHECK)
 10280*    END-EXEC.
 10281*    MOVE '"$''I                  ! ) #00009929' TO DFHEIV0
 10282     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10283     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10284     MOVE X'2920233030303039393239' TO DFHEIV0(25:11)
 10285     CALL 'kxdfhei1' USING DFHEIV0
 10286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10287
 10288
 10289     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10290     MOVE +100                   TO TRLR-SEQ-NO.
 10291
 10292
 10293* EXEC CICS STARTBR
 10294*         DATASET    ('ELTRLR')
 10295*         RIDFLD     (ELTRLR-KEY)
 10296*         GTEQ
 10297*    END-EXEC.
 10298     MOVE 'ELTRLR' TO DFHEIV1
 10299     MOVE 0
 10300       TO DFHEIV11
 10301*    MOVE '&,         G          &   #00009937' TO DFHEIV0
 10302     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10303     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10304     MOVE X'2020233030303039393337' TO DFHEIV0(25:11)
 10305     CALL 'kxdfhei1' USING DFHEIV0,
 10306           DFHEIV1,
 10307           ELTRLR-KEY,
 10308           DFHEIV99,
 10309           DFHEIV11,
 10310           DFHEIV99
 10311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10312
 10313
 10314     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10315
 10316 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL156.cbl
 10317
 10318
 10319* EXEC CICS READNEXT
 10320*         DATASET    ('ELTRLR')
 10321*         RIDFLD     (ELTRLR-KEY)
 10322*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10323*    END-EXEC.
 10324     MOVE 'ELTRLR' TO DFHEIV1
 10325     MOVE 0
 10326       TO DFHEIV11
 10327*    MOVE '&.S                   )   #00009947' TO DFHEIV0
 10328     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10329     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10330     MOVE X'2020233030303039393437' TO DFHEIV0(25:11)
 10331     CALL 'kxdfhei1' USING DFHEIV0,
 10332           DFHEIV1,
 10333           DFHEIV20,
 10334           DFHEIV99,
 10335           ELTRLR-KEY,
 10336           DFHEIV99,
 10337           DFHEIV11,
 10338           DFHEIV99,
 10339           DFHEIV99
 10340     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10341         DFHEIV20
 10342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10343
 10344
 10345     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10346        TRLR-CARRIER  = MSTR-CARRIER  AND
 10347        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10348        TRLR-CERT-NO  = MSTR-CERT-NO
 10349          NEXT SENTENCE
 10350      ELSE
 10351          GO TO 1166-END-CHECK.
 10352
 10353* **  BYPASS ALL NON-PAYMENT TRAILERS
 10354
 10355     IF AT-TRAILER-TYPE = '2'
 10356        NEXT SENTENCE
 10357     ELSE
 10358        GO TO 1166-READ-TRLR-NEXT.
 10359
 10360* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10361
 10362     IF AT-PAYMENT-TYPE = '1' OR '2'
 10363        NEXT SENTENCE
 10364     ELSE
 10365        GO TO 1166-READ-TRLR-NEXT.
 10366
 10367* **  BYPASS ALL VOID PAYMENTS
 10368
 10369     IF AT-VOID-DT NOT = LOW-VALUES
 10370        GO TO 1166-READ-TRLR-NEXT.
 10371
 10372     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10373        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10374          GO TO 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL156.cbl
 10375
 10376     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10377         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10378            OR
 10379        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10380         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10381        NEXT SENTENCE
 10382     ELSE
 10383         IF CL-TOTAL-PAID-AMT > ZEROS
 10384             MOVE ER-0502            TO EMI-ERROR
 10385             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10386             MOVE -1                 TO EPYTHRUL
 10387             MOVE AL-UNBON           TO EPYTHRUA.
 10388
 10389     GO TO 1166-READ-TRLR-NEXT.
 10390
 10391 1166-END-CHECK.
 10392
 10393     IF WS-BROWSE-TRLR-SW = 'Y'
 10394
 10395* EXEC CICS ENDBR
 10396*            DATASET   ('ELTRLR')
 10397*       END-EXEC.
 10398     MOVE 'ELTRLR' TO DFHEIV1
 10399     MOVE 0
 10400       TO DFHEIV11
 10401*    MOVE '&2                    $   #00010002' TO DFHEIV0
 10402     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10403     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10404     MOVE X'2020233030303130303032' TO DFHEIV0(25:11)
 10405     CALL 'kxdfhei1' USING DFHEIV0,
 10406           DFHEIV1,
 10407           DFHEIV11,
 10408           DFHEIV99
 10409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10410
 10411
 10412     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10413
 10414 1166-TRLR-EXIT.
 10415     EXIT.
 10416
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL156.cbl
 10418 1170-PAID-THRU-FATAL-ERROR.
 10419     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10420
 10421     MOVE -1                     TO EPYTHRUL.
 10422     MOVE AL-UNBON               TO EPYTHRUA.
 10423
 10424 1200-EDIT-FIND-TOLERANCES.
 10425
 10426* EXEC CICS HANDLE CONDITION
 10427*        ENDFILE(1950-NOT-FOUND)
 10428*        NOTFND (1950-NOT-FOUND)
 10429*    END-EXEC.
 10430*    MOVE '"$''I                  ! * #00010019' TO DFHEIV0
 10431     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10433     MOVE X'2A20233030303130303139' TO DFHEIV0(25:11)
 10434     CALL 'kxdfhei1' USING DFHEIV0
 10435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10436
 10437
 10438     IF PI-PROCESSOR-ID = 'LGXX'
 10439        GO TO 1240-FIND-ACCT-TOLERANCES.
 10440
 10441     MOVE 'N'                    TO FOUND-TOL-SW.
 10442     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10443     MOVE '2'                    TO CNTL-REC-TYPE.
 10444     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10445     MOVE +0                     TO CNTL-SEQ-NO.
 10446     MOVE 'PROC'                 TO FILE-SWITCH.
 10447
 10448     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10449
 10450     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10451     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10452                                    PI-MAX-PMT-TOL.
 10453     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10454
 10455     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10456         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 10457
 10458     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 10459     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 10460                                    PI-MAX-LF-PMT-TOL.
 10461
 10462     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 10463         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 10464
 10465     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 10466                                    PI-MAX-EXP-PMT.
 10467
 10468 1240-FIND-ACCT-TOLERANCES.
 10469
 10470     IF WS-PMT-TOL NOT = +0
 10471         MOVE 'Y'                TO FOUND-TOL-SW.
 10472
 10473     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10474         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10475         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL156.cbl
 10476         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 10477         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 10478         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 10479         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 10480     ELSE
 10481         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10482         MOVE PI-CARRIER             TO ACCT-CARRIER
 10483         MOVE PI-GROUPING            TO ACCT-GROUPING
 10484         MOVE PI-STATE               TO ACCT-STATE
 10485         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 10486         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10487
 10488     MOVE 'ACCT'                 TO FILE-SWITCH.
 10489
 10490     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10491     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10492
 10493
 10494* EXEC CICS HANDLE CONDITION
 10495*         NOTFND   (1950-NOT-FOUND)
 10496*         ENDFILE  (1950-NOT-FOUND)
 10497*    END-EXEC.
 10498*    MOVE '"$I''                  ! + #00010079' TO DFHEIV0
 10499     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10501     MOVE X'2B20233030303130303739' TO DFHEIV0(25:11)
 10502     CALL 'kxdfhei1' USING DFHEIV0
 10503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10504
 10505
 10506
 10507* EXEC CICS STARTBR
 10508*        DATASET('ERACCT')
 10509*        RIDFLD (ERACCT-KEY)
 10510*        GTEQ
 10511*    END-EXEC.
 10512     MOVE 'ERACCT' TO DFHEIV1
 10513     MOVE 0
 10514       TO DFHEIV11
 10515*    MOVE '&,         G          &   #00010084' TO DFHEIV0
 10516     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10517     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10518     MOVE X'2020233030303130303834' TO DFHEIV0(25:11)
 10519     CALL 'kxdfhei1' USING DFHEIV0,
 10520           DFHEIV1,
 10521           ERACCT-KEY,
 10522           DFHEIV99,
 10523           DFHEIV11,
 10524           DFHEIV99
 10525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10526
 10527
 10528 1245-FIND-ACCT-TOLERANCES-LOOP.
 10529
 10530
 10531* EXEC CICS READNEXT
 10532*        DATASET('ERACCT')
 10533*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL156.cbl
 10534*        RIDFLD (ERACCT-KEY)
 10535*    END-EXEC.
 10536     MOVE 'ERACCT' TO DFHEIV1
 10537     MOVE 0
 10538       TO DFHEIV11
 10539*    MOVE '&.S                   )   #00010092' TO DFHEIV0
 10540     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10541     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10542     MOVE X'2020233030303130303932' TO DFHEIV0(25:11)
 10543     CALL 'kxdfhei1' USING DFHEIV0,
 10544           DFHEIV1,
 10545           DFHEIV20,
 10546           DFHEIV99,
 10547           ERACCT-KEY,
 10548           DFHEIV99,
 10549           DFHEIV11,
 10550           DFHEIV99,
 10551           DFHEIV99
 10552     SET ADDRESS OF ACCOUNT-MASTER TO
 10553         DFHEIV20
 10554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10555
 10556
 10557     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10558        IF WS-ERACCT-HOLD-RECORD = SPACES
 10559           GO TO 1950-NOT-FOUND
 10560        ELSE
 10561           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10562           GO TO 1250-CONTINUE.
 10563
 10564     IF ACCT-EXP-DT = HIGH-VALUES
 10565        NEXT SENTENCE
 10566     ELSE
 10567        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10568        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 10569
 10570 1250-CONTINUE.
 10571
 10572     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 10573
 10574     IF FOUND-TOL-SW = 'N'
 10575         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 10576
 10577********* 1260-FIND-STATE-TOLERANCES.
 10578
 10579     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10580     MOVE PI-STATE               TO WS-ST-ACCESS.
 10581     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 10582     MOVE '3'                    TO CNTL-REC-TYPE.
 10583     MOVE +0                     TO CNTL-SEQ-NO.
 10584     MOVE 'STAT'                 TO FILE-SWITCH.
 10585
 10586     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10587
 10588     IF WS-PMT-TOL = +0
 10589         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 10590
 10591     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL156.cbl
 10592     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 10593     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 10594     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 10595     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 10596
 10597     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 AND
 10598        PI-VFY-2ND-BENE = 'Y' AND
 10599        PI-PAYEE-TYPE <> 'B'
 10600           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 10601     END-IF.
 10602
 10603     IF PI-PMTTYPE      = '2'  AND
 10604        PI-SPLIT-PMT-SW = 'Y'  AND
 10605        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 10606          MOVE ER-3530                TO EMI-ERROR
 10607          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10608
 10609********* 1280-FIND-BENEFIT-TOLERANCES.
 10610
 10611     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10612        OR (PI-PMTTYPE = '5' OR '6')
 10613         GO TO 1300-FIND-CARR-TOLERANCES.
 10614
 10615     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10616     MOVE '4'                    TO CNTL-REC-TYPE.
 10617     MOVE +0                     TO CNTL-SEQ-NO.
 10618     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10619     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10620     MOVE 'BENE'                 TO FILE-SWITCH.
 10621
 10622     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10623
 10624     IF NO-BENEFIT-FOUND
 10625         GO TO 1950-NOT-FOUND.
 10626
 10627     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 10628     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 10629     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 10630
 10631
 10632* EXEC CICS HANDLE CONDITION
 10633*        NOTFND(1950-NOT-FOUND)
 10634*    END-EXEC.
 10635*    MOVE '"$I                   ! , #00010172' TO DFHEIV0
 10636     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10638     MOVE X'2C20233030303130313732' TO DFHEIV0(25:11)
 10639     CALL 'kxdfhei1' USING DFHEIV0
 10640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10641
 10642
 10643 1300-FIND-CARR-TOLERANCES.
 10644     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10645     MOVE '6'                    TO CNTL-REC-TYPE.
 10646
 10647     IF CONTROL-IS-ACTUAL-CARRIER
 10648         MOVE PI-CARRIER               TO WS-CARR
 10649     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL156.cbl
 10650         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10651
 10652     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10653     MOVE +0                     TO CNTL-SEQ-NO.
 10654     MOVE 'CARR'                 TO FILE-SWITCH.
 10655
 10656     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 10657
 10658     IF WS-DAYS-TOL = +0
 10659         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 10660
 10661     IF WS-PMT-TOL = +0
 10662         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 10663
 10664     IF WS-MAX-DAYS-TOL = +0
 10665         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 10666
 10667     IF WS-MAX-PMT-TOL = +0
 10668         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 10669                                    PI-MAX-PMT-TOL.
 10670
 10671     IF WS-MAX-LF-PMT-TOL = +0
 10672        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 10673                                    PI-MAX-LF-PMT-TOL.
 10674
 10675     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 10676
 10677********* 1320-FIND-COMP-TOLERANCES.
 10678
 10679     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10680     MOVE '1'                    TO CNTL-REC-TYPE.
 10681     MOVE SPACES                 TO CNTL-ACCESS.
 10682     MOVE +0                     TO CNTL-SEQ-NO.
 10683     MOVE 'COMP'                 TO FILE-SWITCH.
 10684
 10685     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10686
 10687     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 10688     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 10689
 10690     IF WS-PMT-TOL NOT = +0
 10691        IF WS-TOL-SEVERITY NOT = ' '
 10692         GO TO 1360-EDIT-DAYS.
 10693
 10694     IF WS-PMT-TOL = +0
 10695         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 10696
 10697     IF WS-TOL-SEVERITY = ' '
 10698         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 10699
 10700 1360-EDIT-DAYS.
 10701     IF PI-PMTTYPE NOT = '4'
 10702        IF PI-EDAYS NEGATIVE OR
 10703           PI-EPYAMT NEGATIVE
 10704          MOVE ER-0513             TO EMI-ERROR
 10705          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10706          MOVE -1                  TO PMTTYPEL.
 10707
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL156.cbl
 10708     IF PI-PMTTYPE = '5' OR '6'
 10709        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 10710
 10711     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10712        IF PI-PMTTYPE = '4'
 10713          MOVE PI-EDAYS          TO PI-CDAYS.
 10714
 10715     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10716         GO TO 1440-COMPUTE-LIFE-REMAINING.
 10717
 10718     IF PI-PMTTYPE = '4'
 10719        MOVE PI-EDAYS            TO PI-CDAYS
 10720        GO TO 1400-EDIT-PAYMENT.
 10721
 10722     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 10723        GO TO 1500-EDIT-EXPENSES.
 10724
 10725*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10726*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 10727*          CM-AH-BENEFIT-CD = '23'              AND
 10728*          CL-CERT-STATE    = '04'              AND
 10729*         (PI-PMTTYPE = '1' OR '2' OR '3')
 10730*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 10731*            GO TO 1362-CHECK-MAX-DAYS.
 10732
 10733     IF PI-EDAYS = ZEROS
 10734*        IF PI-COMPANY-ID = 'DMD'
 10735*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 10736*            MOVE -1             TO DC-ELAPSED-DAYS
 10737*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 10738*            MOVE '6'            TO DC-OPTION-CODE
 10739*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10740*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 10741*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 10742*            MOVE '1'            TO DC-OPTION-CODE
 10743*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10744*            IF NO-CONVERSION-ERROR
 10745*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 10746*                                 + DC-ODD-DAYS-OVER
 10747*               MOVE 6           TO EDAYSL
 10748*               MOVE AL-UNNON    TO EDAYSA
 10749*            ELSE
 10750*                NEXT SENTENCE
 10751*       ELSE
 10752            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 10753            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 10754            MOVE '1'             TO DC-OPTION-CODE
 10755            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10756            IF NO-CONVERSION-ERROR
 10757                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 10758                ADD 1                 TO PI-EDAYS
 10759                MOVE AL-UNNON         TO EDAYSA.
 10760
 10761*    IF PI-COMPANY-ID = 'DMD'
 10762*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10763*        MOVE -1                 TO DC-ELAPSED-DAYS
 10764*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 10765*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL156.cbl
 10766*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10767*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10768*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 10769*        MOVE '1'                TO DC-OPTION-CODE
 10770*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10771*    ELSE
 10772         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 10773         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 10774         MOVE '1'                TO DC-OPTION-CODE.
 10775         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10776
 10777     IF NO-CONVERSION-ERROR
 10778        IF PI-COMPANY-ID = 'DMD'
 10779            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 10780                             + DC-ODD-DAYS-OVER
 10781        ELSE
 10782            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 10783            ADD 1                TO PI-CDAYS.
 10784
 10785     IF DC-ODD-DAYS-OVER NOT = ZEROS
 10786        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 10787        ADD 1                    TO EXPENSE-MONTH-SAVE.
 10788
 10789     IF PI-EDAYS NOT NUMERIC
 10790         MOVE ER-0491            TO EMI-ERROR
 10791         GO TO 1370-DAYS-ERROR.
 10792
 10793     IF CL-NO-OF-PMTS-MADE = 0
 10794        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 10795        AND CL-CERT-STATE = 'MI'
 10796        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 10797            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 10798     END-IF.
 10799
 10800 1362-CHECK-MAX-DAYS.
 10801
 10802     IF WS-MAX-DAYS-TOL = +999
 10803         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 10804
 10805     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10806         IF PI-EDAYS = ZEROS
 10807             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 10808         ELSE
 10809             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 10810
 10811     IF WS-MAX-DAYS-TOL NOT = ZERO
 10812        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 10813           PI-CDAYS > WS-MAX-DAYS-TOL
 10814             MOVE ER-0492          TO EMI-ERROR
 10815             GO TO 1370-DAYS-ERROR.
 10816
 10817 1365-SKIP-MAX-DAYS-EDIT.
 10818     IF PI-EDAYS = ZEROS
 10819        GO TO 1400-EDIT-PAYMENT.
 10820
 10821     IF WS-DAYS-TOL NOT = ZERO
 10822        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 10823           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL156.cbl
 10824                MOVE ER-0493     TO EMI-ERROR
 10825                GO TO 1370-DAYS-ERROR.
 10826
 10827     GO TO 1400-EDIT-PAYMENT.
 10828
 10829 1370-DAYS-ERROR.
 10830     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10831
 10832     IF EMI-MESSAGE-FORMATTED
 10833         MOVE -1                 TO EDAYSL
 10834         MOVE AL-UABON           TO EDAYSA.
 10835
 10836     GO TO 1400-EDIT-PAYMENT.
 10837
 10838 1380-EDIT-EXPENSE-PMT-AMT.
 10839     IF PI-PMTTYPE = '5' OR '6'
 10840         NEXT SENTENCE
 10841     ELSE
 10842         GO TO 1400-EDIT-PAYMENT.
 10843
 10844     IF WS-MAX-EXP-PMT NOT = ZEROS
 10845        IF PI-EPYAMT > WS-MAX-EXP-PMT
 10846            MOVE ER-3529            TO EMI-ERROR
 10847            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 10848
 10849     GO TO 1500-EDIT-EXPENSES.
 10850
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL156.cbl
 10852
 10853 1390-CHECK-PAYMENT-DAYS.
 10854
 10855     IF PI-EDAYS = 0
 10856         MOVE PI-CDAYS TO WS-PD-DAYS
 10857     ELSE
 10858         MOVE PI-EDAYS TO WS-PD-DAYS
 10859     END-IF.
 10860
 10861     IF CM-AH-BENEFIT-CD = '20' OR '21'
 10862         IF WS-PD-DAYS = 14
 10863            GO TO 1390-EXIT
 10864         END-IF
 10865     END-IF.
 10866
 10867     IF PI-COMPANY-ID = 'AHL'  AND
 10868        CM-AH-BENEFIT-CD = '1K'
 10869         IF WS-PD-DAYS = 14
 10870            GO TO 1390-EXIT
 10871         END-IF
 10872     END-IF.
 10873
 10874     IF WS-PD-DAYS < 30
 10875         MOVE ER-3549              TO EMI-ERROR
 10876         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 10877     END-IF.
 10878
 10879 1390-EXIT.
 10880      EXIT.
 10881
 10882 1400-EDIT-PAYMENT.
 10883*    IF PI-COMPANY-ID = 'DMD'
 10884*       IF CL-CERT-NO (5:2) = '69' OR '70'
 10885*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 10886
 10887     IF PI-PMTTYPE NOT = '4'
 10888        GO TO 1405-CALC-PAYMENT.
 10889
 10890     IF PI-EDAYS NOT NUMERIC
 10891         MOVE PI-EPYAMT           TO PI-CPYAMT
 10892         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 10893         GO TO 1430-CHECK-AH-TOLERANCE.
 10894
 10895*    IF PI-COMPANY-ID = 'FIA'
 10896*       IF CERT-ACCOUNT = '0000011043'
 10897*        COMPUTE PI-DAILY-RATE ROUNDED =
 10898*                      (CM-AH-BENEFIT-AMT * 13) / 365
 10899*        COMPUTE PI-CPYAMT ROUNDED =
 10900*                          PI-DAILY-RATE * PI-EDAYS
 10901*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 10902*        GO TO 1430-CHECK-AH-TOLERANCE.
 10903
 10904     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 10905         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 10906         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 10907         GO TO 1420-CHECK-AIG-BENEFIT.
 10908
 10909     IF WS-CALC-METHOD = '2' OR  '5'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL156.cbl
 10910         COMPUTE PI-DAILY-RATE ROUNDED =
 10911                        (CM-AH-BENEFIT-AMT * 12) / 365
 10912         COMPUTE PI-CPYAMT ROUNDED =
 10913                           PI-DAILY-RATE * PI-EDAYS
 10914        GO TO 1420-CHECK-AIG-BENEFIT.
 10915
 10916     IF WS-CALC-METHOD = '3'
 10917         COMPUTE PI-DAILY-RATE =
 10918                         (CM-AH-BENEFIT-AMT * 12) / 365
 10919         COMPUTE PI-CPYAMT ROUNDED =
 10920                           PI-DAILY-RATE * PI-EDAYS
 10921        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL156.cbl
 10923*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 10924
 10925****************************************************************
 10926****************************************************************
 10927*                  CALCULATED FROM      PAYMENT      PAYMENT
 10928*   DATES           DATE ROUTINE        OPT  1       OPT  6
 10929* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 10930*1-01-83  1-15-83    0    15     15        15           15
 10931*1-01-83  1-30-83    0    30     30        30           30
 10932*1-01-83  1-31-83    1     0     31        30           30
 10933*1-01-83  2-01-83    1     1     32        31           31
 10934*1-01-83  2-15-83    1    15     46        45           45
 10935*1-01-83  2-28-83    2     0     59        60           60
 10936*1-01-83  3-01-83    2     1     60        61           61
 10937*1-01-83  3-31-83    3     0     90        90           90
 10938*1-15-83  1-31-83    0    17     17        17           16
 10939*1-15-83  2-01-83    0    18     18        18           17
 10940*1-15-83  2-28-83    1    14     45        44           46
 10941*1-21-83  3-09-83    1    20     48        50           49
 10942*2-05-83  3-06-83    1     2     30        32           32
 10943*2-05-83  3-23-83    1    19     47        49           49
 10944*2-15-83  2-28-83    0    14     14        14           16
 10945*2-15-83  3-01-83    0    15     15        15           17
 10946*2-21-83  3-19-83    0    27     27        27           29
 10947*2-21-83  3-20-83    1     0     28        30           30
 10948*2-21-83  4-10-83    1    18     49        30           50
 10949*2-21-83  5-19-83    2    27     88        87           89
 10950*2-21-83  5-22-83    3     2     91        92           92
 10951*3-21-83  5-19-83    1    30     60        60           59
 10952****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL156.cbl
 10954 1405-CALC-PAYMENT.
 10955     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 10956     MOVE ' '                    TO DC-OPTION-CODE.
 10957     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10958     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 10959     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 10960
 10961     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 10962     MOVE ' '                    TO DC-OPTION-CODE.
 10963     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10964     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 10965     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 10966
 10967     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 10968     MOVE -1                     TO DC-ELAPSED-DAYS.
 10969     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 10970     MOVE '6'                    TO DC-OPTION-CODE.
 10971     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10972     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 10973
 10974     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 10975     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 10976     MOVE '1'                    TO DC-OPTION-CODE.
 10977     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10978
 10979     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 10980     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 10981     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 10982
 10983******************************************************************
 10984*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 10985*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 10986*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 10987******************************************************************
 10988
 10989     IF WS-CALC-METHOD = '1'           AND
 10990        DC-ELAPSED-MONTHS > ZERO AND
 10991        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 10992        WDF-DAY > WDT-DAY
 10993          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 10994          MOVE ZEROS               TO DC-ELAPSED-DAYS
 10995          MOVE -1                  TO DC-ELAPSED-MONTHS
 10996          MOVE '6'                 TO DC-OPTION-CODE
 10997          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10998          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 10999          COMPUTE WS-SAVE-ODD-DAYS =
 11000          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11001          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11002
 11003     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11004     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11005     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11006
 11007     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11008     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11009
 11010*    IF PI-COMPANY-ID = 'FIA'
 11011*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL156.cbl
 11012*        COMPUTE PI-DAILY-RATE ROUNDED =
 11013*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11014*        COMPUTE PI-CPYAMT ROUNDED =
 11015*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11016*        GO TO 1420-CHECK-AIG-BENEFIT.
 11017
 11018*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11019*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11020*          CM-AH-BENEFIT-CD = '23'               AND
 11021*          CL-CERT-STATE    = '04'               AND
 11022*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11023*            COMPUTE WS-DAILY-RATE ROUNDED =
 11024*                               CM-AH-BENEFIT-AMT / 30
 11025*            COMPUTE PI-CPYAMT ROUNDED =
 11026*                               (WS-DAILY-RATE * PI-CDAYS)
 11027*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11028*            GO TO 1420-CHECK-AIG-BENEFIT.
 11029
 11030     IF WS-CALC-METHOD = '1'
 11031         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11032         COMPUTE PI-CPYAMT ROUNDED =
 11033             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11034             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11035         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11036         GO TO 1420-CHECK-AIG-BENEFIT.
 11037
 11038     IF WS-CALC-METHOD = '2'
 11039         COMPUTE PI-DAILY-RATE ROUNDED =
 11040                          (CM-AH-BENEFIT-AMT * 12) / 365
 11041         COMPUTE PI-CPYAMT ROUNDED =
 11042             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11043             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11044         GO TO 1420-CHECK-AIG-BENEFIT.
 11045
 11046     IF WS-CALC-METHOD = '4'
 11047         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11048         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11049         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11050         COMPUTE PI-CPYAMT ROUNDED =
 11051                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11052         GO TO 1420-CHECK-AIG-BENEFIT.
 11053
 11054     IF WS-CALC-METHOD = '5'
 11055         COMPUTE PI-DAILY-RATE ROUNDED =
 11056                            (CM-AH-BENEFIT-AMT * 12) / 365
 11057         COMPUTE PI-CPYAMT ROUNDED =
 11058                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11059         GO TO 1420-CHECK-AIG-BENEFIT.
 11060
 11061     IF WS-CALC-METHOD NOT = '3'
 11062        GO TO 1410-CHECK-PAYMENT.
 11063
 11064******   CALCULATION METHOD  3  ROUTINE
 11065     COMPUTE PI-DAILY-RATE =
 11066                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11067
 11068******CHECK TO SEE IF WITHIN SAME MONTH
 11069     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL156.cbl
 11070        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11071                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11072         GO TO 1420-CHECK-AIG-BENEFIT.
 11073
 11074******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11075     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11076             SAVE-ODD-DAYS-OVER = ZEROS
 11077      COMPUTE PI-CPYAMT  ROUNDED =
 11078                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11079      GO TO 1420-CHECK-AIG-BENEFIT.
 11080
 11081******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11082******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11083     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11084        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11085        IF WDF-MONTH > 12
 11086           ADD 1                 TO WDF-YEAR
 11087           SUBTRACT 12         FROM WDF-MONTH.
 11088
 11089******CONVERT THE NEW FROM MONTH TO BINARY
 11090     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11091        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11092        MOVE '4'              TO DC-OPTION-CODE
 11093        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11094        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11095
 11096     IF WDF-MONTH = WDT-MONTH AND
 11097        WDF-YEAR  = WDT-YEAR
 11098          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11099                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11100                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11101        ELSE
 11102          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11103          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11104          COMPUTE PI-CPYAMT ROUNDED =
 11105       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11106       +
 11107       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11108       +
 11109       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11110
 11111     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL156.cbl
 11113 1410-CHECK-PAYMENT.
 11114******PAYMENT OPTION 6
 11115******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11116     IF SAVE-ELAPSED-MONTHS > ZERO
 11117        IF SAVE-ODD-DAYS-OVER = ZEROS
 11118           GO TO 1412-CHECK-TO-DAY
 11119        ELSE
 11120           IF WDF-DAY > WDT-DAY
 11121              IF WDF-MONTH = 02
 11122                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11123                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11124                  GO TO 1412-CHECK-TO-DAY
 11125              ELSE
 11126                  IF FROM-DAYS-IN-MONTH = 31
 11127                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11128                     GO TO 1412-CHECK-TO-DAY
 11129                  ELSE
 11130                     GO TO 1412-CHECK-TO-DAY
 11131           ELSE
 11132               GO TO 1412-CHECK-TO-DAY.
 11133
 11134     IF WDF-MONTH NOT = WDT-MONTH
 11135        IF WDF-MONTH = 02
 11136           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11137           IF WDF-DAY = 29
 11138              ADD 1              TO SAVE-ODD-DAYS-OVER
 11139           ELSE
 11140              ADD 2              TO SAVE-ODD-DAYS-OVER
 11141        ELSE
 11142           IF FROM-DAYS-IN-MONTH = 31
 11143              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11144
 11145 1412-CHECK-TO-DAY.
 11146        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11147           IF WDT-DAY = 28
 11148              ADD 2              TO SAVE-ODD-DAYS-OVER
 11149           ELSE
 11150              IF WDT-DAY = 29
 11151                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11152              ELSE
 11153                 NEXT SENTENCE
 11154        ELSE
 11155           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11156              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11157
 11158     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11159     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11160     COMPUTE PI-CPYAMT ROUNDED =
 11161         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11162         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11163
 11164     GO TO 1420-CHECK-AIG-BENEFIT.
 11165
 11166 1415-CHECK-LEAP-YEAR.
 11167     IF FROM-DAYS-IN-MONTH = 29
 11168        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11169
 11170 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 216
* EL156.cbl
 11171     EXIT.
 11172
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 217
* EL156.cbl
 11174 1420-CHECK-AIG-BENEFIT.
 11175
 11176     IF WS-SPECIAL-CALC-CD = 'Q'
 11177         GO TO 1425-CHECK-WHOLE-MONTH.
 11178
 11179*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11180*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11181*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11182*       (PI-PMTTYPE = '1' OR '2')
 11183*        NEXT SENTENCE
 11184*    ELSE
 11185         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11186         GO TO 1430-CHECK-AH-TOLERANCE.
 11187
 11188******************AIG LOGIC STARTS**********************
 11189*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11190*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11191*    MOVE ER-3533      TO EMI-ERROR.
 11192*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11193*    GO TO 1430-CHECK-AH-TOLERANCE.
 11194******************AIG LOGIC ENDS************************
 11195
 11196 1425-CHECK-WHOLE-MONTH.
 11197******************************************************************
 11198****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11199****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11200****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11201****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11202****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11203****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11204****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11205****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11206****          PAID * MONTHLY BENEFIT.                         ****
 11207******************************************************************
 11208
 11209     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11210
 11211     IF CL-NO-OF-PMTS-MADE > +0
 11212         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11213
 11214     IF PI-CDAYS < WS-BEN-DAYS
 11215         GO TO 1430-CHECK-AH-TOLERANCE.
 11216
 11217     IF PI-CDAYS = WS-BEN-DAYS
 11218         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11219         GO TO 1430-CHECK-AH-TOLERANCE.
 11220
 11221*    IF PI-COMPANY-ID = 'ACM'
 11222*       NEXT SENTENCE
 11223*    ELSE
 11224        GO TO 1425-NOT-ACM-W15C.
 11225
 11226*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11227*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11228*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11229*    MOVE '6'                    TO  DC-OPTION-CODE.
 11230*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11231*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 218
* EL156.cbl
 11232*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11233*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11234*       MOVE '1'                 TO  DC-OPTION-CODE
 11235*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11236*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11237*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11238*       IF NO-CONVERSION-ERROR
 11239*          IF (DC-ELAPSED-MONTHS > +0) OR
 11240*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11241*             NEXT SENTENCE
 11242*          ELSE
 11243*             MOVE +0            TO  PI-CPYAMT
 11244*             MOVE ER-0846       TO  EMI-ERROR
 11245*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11246*             GO TO 1430-CHECK-AH-TOLERANCE
 11247*       ELSE
 11248*           MOVE ER-0846         TO  EMI-ERROR
 11249*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11250*           GO TO 1430-CHECK-AH-TOLERANCE.
 11251*
 11252*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11253*       ADD +1 TO DC-ELAPSED-MONTHS.
 11254*
 11255*    COMPUTE PI-CPYAMT ROUNDED =
 11256*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11257*
 11258*    GO TO 1430-CHECK-AH-TOLERANCE.
 11259
 11260 1425-NOT-ACM-W15C.
 11261
 11262     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11263     MOVE '6'                        TO  DC-OPTION-CODE.
 11264     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11265     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11266
 11267     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11268     IF NO-CONVERSION-ERROR
 11269         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11270     ELSE
 11271         MOVE ER-0846                TO  EMI-ERROR
 11272         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11273         GO TO 1430-CHECK-AH-TOLERANCE.
 11274
 11275     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11276     MOVE '1'                        TO  DC-OPTION-CODE.
 11277     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11278     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11279     IF NO-CONVERSION-ERROR
 11280         IF DC-ODD-DAYS-OVER = +0
 11281             NEXT SENTENCE
 11282         ELSE
 11283             MOVE ER-0846            TO  EMI-ERROR
 11284             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11285             GO TO 1430-CHECK-AH-TOLERANCE
 11286     ELSE
 11287         MOVE ER-0846                TO  EMI-ERROR
 11288         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11289         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 219
* EL156.cbl
 11290
 11291     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11292         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11293
 11294     GO TO 1430-CHECK-AH-TOLERANCE.
 11295
 11296 1425-CONT-WHOLE-MONTH-PMTS.
 11297******************************************************************
 11298****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11299****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11300****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11301******************************************************************
 11302
 11303     IF PI-COMPANY-ID = 'ACM'
 11304        NEXT SENTENCE
 11305     ELSE
 11306        IF DC-ODD-DAYS-OVER = +0
 11307            NEXT SENTENCE
 11308        ELSE
 11309            MOVE ER-0845            TO  EMI-ERROR
 11310            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11311            GO TO 1430-CHECK-AH-TOLERANCE.
 11312
 11313     COMPUTE PI-CPYAMT ROUNDED =
 11314                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11315
 11316 1430-CHECK-AH-TOLERANCE.
 11317     IF PI-PMT-APPR-SW = 'G'
 11318         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11319
 11320*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11321*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11322*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11323*
 11324*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11325*      IF WDF-MONTH = 02
 11326*        IF SAVE-ELAPSED-MONTHS = 0
 11327*          NEXT SENTENCE
 11328*        ELSE
 11329*          IF SAVE-ODD-DAYS-OVER > 0
 11330*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11331*            COMPUTE WS-PMT-MOS ROUNDED =
 11332*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11333*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11334*                                     WS-PMT-MOS
 11335*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11336*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11337*          ELSE
 11338*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11339*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11340*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11341*                                     WS-PMT-MOS.
 11342
 11343     IF WS-MAX-PMT-TOL NOT = ZERO
 11344        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11345           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11346            MOVE ER-0494         TO  EMI-ERROR
 11347            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 220
* EL156.cbl
 11348            GO TO 1500-EDIT-EXPENSES.
 11349
 11350 1430-CONT-CHECK-AH-TOLERANCE.
 11351
 11352     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11353        GO TO 1500-EDIT-EXPENSES.
 11354
 11355     IF CM-O-B-COVERAGE
 11356        GO TO 1500-EDIT-EXPENSES.
 11357
 11358     IF PI-COMPANY-ID = 'NCL'
 11359       IF FOUND-TOL-SW = 'Y'
 11360         IF WS-PMT-TOL NOT = ZERO
 11361           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11362              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11363                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11364                  IF WS-NCL-PMT-OPTION = SPACES
 11365                      MOVE ER-0699 TO EMI-ERROR
 11366                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11367                  ELSE
 11368                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11369                      NEXT SENTENCE
 11370                  ELSE
 11371                  IF NOT WS-VALID-NCL-OPTION
 11372                      MOVE ER-0699 TO EMI-ERROR
 11373                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11374
 11375     IF WS-PMT-TOL NOT = ZERO
 11376        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11377           ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11378                MOVE ER-0495     TO EMI-ERROR
 11379                PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11380
 11381     GO TO 1500-EDIT-EXPENSES.
 11382
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 221
* EL156.cbl
 11384 1440-COMPUTE-LIFE-REMAINING.
 11385
 11386     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11387        IF PI-PMTTYPE = '4'
 11388          MOVE PI-EPYAMT TO PI-CPYAMT
 11389          GO TO 1460-TEST-TYPE.
 11390
 11391     IF WS-LF-COVERAGE-TYPE = 'L'
 11392        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 11393                          - CL-TOTAL-PAID-AMT
 11394        GO TO 1450-CHECK-MAX.
 11395
 11396     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11397        PI-LF-COVERAGE-TYPE = 'P'
 11398          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 11399                              CM-LF-ITD-DEATH-AMT
 11400          GO TO 1450-CHECK-MAX.
 11401
 11402     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 11403     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 11404     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 11405     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11406     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11407     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 11408     MOVE '4'                    TO CP-REM-TERM-METHOD.
 11409     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11410     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11411
 11412     PERFORM 9800-LINK-REM-TERM.
 11413
 11414     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 11415     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11416     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11417     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 11418     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 11419     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 11420     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 11421     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 11422     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 11423     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 11424     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11425     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11426     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 11427     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 11428     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 11429     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 11430
 11431
 11432* EXEC CICS LINK
 11433*       PROGRAM  (LINK-REMAMT)
 11434*       COMMAREA (CALCULATION-PASS-AREA)
 11435*       LENGTH   (CP-COMM-LENGTH)
 11436*    END-EXEC.
 11437*    MOVE '."C                   ''   #00010964' TO DFHEIV0
 11438     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11439     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11440     MOVE X'2020233030303130393634' TO DFHEIV0(25:11)
 11441     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 222
* EL156.cbl
 11442           LINK-REMAMT,
 11443           CALCULATION-PASS-AREA,
 11444           CP-COMM-LENGTH,
 11445           DFHEIV99,
 11446           DFHEIV99,
 11447           DFHEIV99
 11448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11449
 11450
 11451     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 11452
 11453     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 11454     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 11455
 11456     IF PI-COMPANY-ID = 'BOA' AND
 11457        PI-PMTTYPE    = '2'   AND
 11458        PI-OFFLINE    = 'N'
 11459           GO TO 1441-COMPUTE-BOA-INTEREST.
 11460
 11461     IF PI-COMPANY-ID = 'NCL' AND
 11462        PI-PMTTYPE    = '2'   AND
 11463        PI-OFFLINE    = 'N'
 11464          GO TO 1442-COMPUTE-NCL-INTEREST
 11465       ELSE
 11466          GO TO 1445-CONTINUE.
 11467
 11468 1441-COMPUTE-BOA-INTEREST.
 11469     MOVE +0             TO WS-CALC-INT.
 11470
 11471     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 11472     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 11473     MOVE +0             TO DC-ELAPSED-MONTHS
 11474                            DC-ELAPSED-DAYS.
 11475     MOVE '1'            TO DC-OPTION-CODE.
 11476     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11477     IF NO-CONVERSION-ERROR
 11478         NEXT SENTENCE
 11479     ELSE
 11480         GO TO 1445-CONTINUE.
 11481
 11482     IF (PI-INT-RATE NOT > ZEROS)  AND
 11483        (DC-ELAPSED-DAYS > +30)
 11484         MOVE ER-3531            TO EMI-ERROR
 11485         MOVE -1                 TO PINTL
 11486         MOVE AL-UNBON           TO PINTA
 11487         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11488
 11489     IF PI-EPYAMT NOT > ZEROS
 11490         GO TO 1445-CONTINUE.
 11491
 11492     IF (PI-INT-RATE NOT > ZEROS)  OR
 11493        (DC-ELAPSED-DAYS NOT > +30)
 11494         MOVE PI-EPYAMT TO PI-CPYAMT
 11495         GO TO 1441-FORMAT-NOTE.
 11496
 11497     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 11498                                 *  PI-INT-RATE
 11499                                 *  DC-ELAPSED-DAYS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 223
* EL156.cbl
 11500                                 /  365
 11501                                 /  100.
 11502
 11503     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 11504
 11505 1441-FORMAT-NOTE.
 11506
 11507     MOVE SPACES        TO WS-BOANOTE1.
 11508     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 11509     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 11510     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 11511     MOVE AL-UANON      TO NOTE1A.
 11512
 11513     IF WS-CALC-INT > ZEROS
 11514         MOVE SPACES        TO WS-BOANOTE2
 11515         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 11516         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 11517         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 11518         MOVE AL-UANON      TO NOTE2A.
 11519
 11520     GO TO 1445-CONTINUE.
 11521
 11522 1442-COMPUTE-NCL-INTEREST.
 11523     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11524     MOVE PI-STATE               TO WS-ST-ACCESS.
 11525     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11526     MOVE '3'                    TO CNTL-REC-TYPE.
 11527     MOVE +0                     TO CNTL-SEQ-NO.
 11528     MOVE 'STAT'                 TO FILE-SWITCH.
 11529
 11530     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11531
 11532     MOVE +0                 TO WS-CALC-INT.
 11533
 11534     IF ST-STAT-FROM-INCURRED
 11535         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 11536       ELSE
 11537     IF ST-STAT-FROM-REPORTED
 11538         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 11539       ELSE
 11540         GO TO 1445-CONTINUE.
 11541
 11542     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 11543     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 11544     MOVE +0                 TO DC-ELAPSED-MONTHS
 11545                                DC-ELAPSED-DAYS.
 11546     MOVE '1'                TO DC-OPTION-CODE.
 11547     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11548     IF NO-CONVERSION-ERROR
 11549         NEXT SENTENCE
 11550     ELSE
 11551         GO TO 1445-CONTINUE.
 11552
 11553     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 11554        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 11555         GO TO 1445-CONTINUE.
 11556
 11557     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 224
* EL156.cbl
 11558                                 *  CF-ST-STAT-INTEREST.
 11559
 11560     MOVE SPACES              TO WS-NCLNOTE1.
 11561     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 11562     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 11563     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 11564                                 PI-PMTNOTE1
 11565                                 NOTE1I.
 11566     MOVE AL-UANON            TO NOTE1A.
 11567
 11568     IF WS-CALC-INT > ZEROS
 11569         MOVE SPACES          TO WS-NCLNOTE2
 11570         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 11571         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 11572         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 11573                                 PI-PMTNOTE2
 11574                                 NOTE2I
 11575         MOVE AL-UANON        TO NOTE2A.
 11576
 11577     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 11578
 11579 1445-CONTINUE.
 11580
 11581     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 11582        GO TO 1460-TEST-TYPE.
 11583
 11584     IF CM-O-B-COVERAGE
 11585        GO TO 1460-TEST-TYPE.
 11586
 11587     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 11588         GO TO 1450-CHECK-MAX.
 11589
 11590     IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11591                      > PI-EPYAMT)
 11592                      OR
 11593        (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11594                      < PI-EPYAMT)
 11595         MOVE ER-0594            TO EMI-ERROR
 11596         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11597         GO TO 1460-TEST-TYPE.
 11598
 11599 1450-CHECK-MAX.
 11600
 11601     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11602        PI-LF-COVERAGE-TYPE = 'P'
 11603         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11604                                   CM-LF-ITD-DEATH-AMT
 11605     ELSE
 11606         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11607                                   CL-TOTAL-PAID-AMT.
 11608
 11609     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 11610          MOVE ER-0543           TO EMI-ERROR
 11611          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11612
 11613 1460-TEST-TYPE.
 11614
 11615     IF PI-PMT-APPR-SW = 'G'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 225
* EL156.cbl
 11616       NEXT SENTENCE
 11617     ELSE
 11618       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 11619         IF PI-EPYAMT = ZERO
 11620             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 11621                 MOVE ER-0494    TO  EMI-ERROR
 11622                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11623                 GO TO 1500-EDIT-EXPENSES
 11624             ELSE
 11625                 NEXT SENTENCE
 11626         ELSE
 11627             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 11628                 MOVE ER-0494    TO  EMI-ERROR
 11629                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11630                 GO TO 1500-EDIT-EXPENSES.
 11631
 11632     IF PI-PMTTYPE NOT = '2' OR
 11633        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 11634         GO TO 1500-EDIT-EXPENSES.
 11635
 11636     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 11637     MOVE ER-0526                TO EMI-ERROR.
 11638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11639
 11640     IF EMI-ERROR-NUMBER (1) = '0526'
 11641        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 11642
 11643     IF EMI-ERROR-NUMBER (2) = '0526'
 11644        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 11645
 11646     GO TO 1500-EDIT-EXPENSES.
 11647
 11648 1490-PAYMENT-ERROR.
 11649     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11650
 11651     IF EMI-MESSAGE-FORMATTED
 11652         MOVE -1                 TO EPYAMTL
 11653         MOVE AL-UNBON           TO EPYAMTA.
 11654
 11655 1490-EXIT.
 11656      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 226
* EL156.cbl
 11658 1500-EDIT-EXPENSES.
 11659     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 11660         GO TO 1500-SKIP-ERROR-0556.
 11661
 11662 1500-CONTINUE-ON.
 11663
 11664     IF CM-O-B-COVERAGE
 11665        MOVE ER-0556             TO EMI-ERROR
 11666        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11667
 11668 1500-SKIP-ERROR-0556.
 11669     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11670        IF PI-EEXPENS NOT = ZEROS
 11671           MOVE ER-0524          TO EMI-ERROR
 11672           GO TO 1590-EXPENSE-ERROR
 11673        ELSE
 11674           GO TO 1600-EDIT-RESERVES.
 11675
 11676     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11677     MOVE '6'                    TO CNTL-REC-TYPE.
 11678
 11679     IF CONTROL-IS-ACTUAL-CARRIER
 11680         MOVE PI-CARRIER         TO WS-CARR
 11681     ELSE
 11682         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11683
 11684     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11685     MOVE +0                     TO CNTL-SEQ-NO.
 11686     MOVE 'CARR'                 TO FILE-SWITCH.
 11687
 11688     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11689
 11690     IF EXPENSE-CALC-MANUAL
 11691        GO TO 1600-EDIT-RESERVES.
 11692
 11693     IF DOLLARS-PER-PMT
 11694        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 11695        GO TO 1600-EDIT-RESERVES.
 11696
 11697     IF DOLLARS-PER-MONTH AND
 11698        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11699       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 11700       GO TO 1600-EDIT-RESERVES.
 11701
 11702     IF PERCENT-OF-PAYMENT
 11703        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 11704
 11705     GO TO 1600-EDIT-RESERVES.
 11706
 11707 1590-EXPENSE-ERROR.
 11708     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11709
 11710     IF EMI-MESSAGE-FORMATTED
 11711        MOVE -1                  TO EEXPENSL
 11712        MOVE AL-UNBON            TO EEXPENSA.
 11713
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 227
* EL156.cbl
 11715 1600-EDIT-RESERVES.
 11716     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11717        IF PI-ERESV = ZEROS
 11718           GO TO 1700-EDIT-EXPENSE-TYPE
 11719        ELSE
 11720           MOVE ER-0525          TO EMI-ERROR
 11721           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 11722           GO TO 1700-EDIT-EXPENSE-TYPE.
 11723
 11724     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11725     MOVE ZEROS                  TO TRLR-SEQ-NO.
 11726     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 11727
 11728     IF NOT AT-MANUAL-RESERVES-USED
 11729        IF PI-ERESV NOT = ZEROS
 11730           MOVE ER-0518          TO EMI-ERROR
 11731           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 11732
 11733     IF AT-MANUAL-RESERVES-USED
 11734        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 11735        GO TO 1700-EDIT-EXPENSE-TYPE.
 11736
 11737     IF AT-FUTURE-RESERVES-USED
 11738        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 11739
 11740     IF AT-FUTURE-RESERVES-USED
 11741        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 11742
 11743     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 11744        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 11745
 11746     IF AT-IBNR-RESERVES-USED
 11747        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 11748
 11749     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 11750     GO TO 1700-EDIT-EXPENSE-TYPE.
 11751
 11752 1690-RESERVE-ERROR.
 11753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11754
 11755     IF EMI-MESSAGE-FORMATTED
 11756        MOVE AL-UNBON            TO ERESVA
 11757        MOVE -1                  TO ERESVL.
 11758
 11759 1690-EXIT.
 11760      EXIT.
 11761
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 228
* EL156.cbl
 11763 1700-EDIT-EXPENSE-TYPE.
 11764     IF PI-PMTTYPE NOT = '5' AND '6'
 11765        GO TO 2000-EDIT-DONE.
 11766
 11767     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 11768                   '6' OR '7' OR '8' OR '9'
 11769        GO TO 2000-EDIT-DONE.
 11770
 11771 1705-EXPENSE-ERROR.
 11772     MOVE ER-0573                TO EMI-ERROR.
 11773     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11774
 11775     IF EMI-MESSAGE-FORMATTED
 11776        MOVE AL-UABON            TO ETYPEA
 11777        MOVE -1                  TO ETYPEL.
 11778
 11779     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 229
* EL156.cbl
 11781 1950-NOT-FOUND.
 11782     IF FILE-SWITCH = 'MSTR'
 11783        MOVE ER-0204             TO EMI-ERROR.
 11784
 11785     IF FILE-SWITCH = 'CARR'
 11786        MOVE ER-0252             TO EMI-ERROR.
 11787
 11788     IF FILE-SWITCH = 'COMP'
 11789        MOVE ER-0254             TO EMI-ERROR.
 11790
 11791     IF FILE-SWITCH = 'STAT'
 11792        MOVE ER-0149             TO EMI-ERROR.
 11793
 11794     IF FILE-SWITCH = 'PROC'
 11795        MOVE ER-0019             TO EMI-ERROR.
 11796
 11797     IF FILE-SWITCH = 'ACCT'
 11798        MOVE ER-0198             TO EMI-ERROR.
 11799
 11800     IF FILE-SWITCH = 'BENE'
 11801        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11802           MOVE ER-0282          TO EMI-ERROR
 11803        ELSE
 11804           MOVE ER-0283          TO EMI-ERROR.
 11805
 11806     MOVE -1                     TO PMTTYPEL.
 11807     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11808
 11809     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 11810                                     WS-FORCE-CTR.
 11811
 11812     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 11813                                     WS-FATAL-CTR.
 11814
 11815     GO TO 8200-SEND-DATAONLY.
 11816
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 230
* EL156.cbl
 11818 2000-EDIT-DONE.
 11819     IF (WS-SPECIAL-CALC-CD = 'C')
 11820        AND (CM-AH-CRITICAL-PERIOD) > 0
 11821        IF CM-AH-BENEFIT-AMT NOT = ZERO
 11822           IF PI-EPYAMT > ZEROS
 11823              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11824                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 11825           ELSE
 11826              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11827                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 11828           END-IF
 11829           IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 11830              MOVE ER-0657          TO EMI-ERROR
 11831              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11832           END-IF
 11833        END-IF
 11834     END-IF
 11835     IF PI-HOLDTIL NOT = ZEROS
 11836        MOVE PI-HOLDTIL          TO HOLDTILO
 11837        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 11838
 11839     IF PI-EPYFROM NOT = ZEROS
 11840        MOVE PI-EPYFROM          TO EPYFROMO
 11841        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 11842
 11843     IF PI-EPYTHRU NOT = ZEROS
 11844        MOVE PI-EPYTHRU            TO EPYTHRUO
 11845        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 11846        IF PI-USES-PAID-TO
 11847           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 11848           MOVE '4'                TO DC-OPTION-CODE
 11849           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11850           IF NO-CONVERSION-ERROR
 11851              MOVE +1              TO DC-ELAPSED-DAYS
 11852              MOVE +0              TO DC-ELAPSED-MONTHS
 11853              MOVE '6'             TO DC-OPTION-CODE
 11854              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11855              IF NO-CONVERSION-ERROR
 11856                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 11857
 11858     MOVE PI-EDAYS               TO EDAYSO.
 11859
 11860     IF PI-AIGFROM NOT = ZEROS
 11861        MOVE PI-AIGFROM          TO AIGFROMO
 11862        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 11863
 11864     MOVE PI-EPYAMT              TO EPYAMTO.
 11865     MOVE PI-ERESV               TO ERESVO.
 11866     MOVE PI-EEXPENS             TO EEXPENSO.
 11867
 11868     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11869     MOVE SPACES                 TO DC-OPTION-CODE.
 11870     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11871
 11872     IF DATE-CONVERSION-ERROR
 11873        MOVE SPACES              TO CPYFROMI
 11874     ELSE
 11875        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 231
* EL156.cbl
 11876        IF PI-EPYFROM = ZEROS
 11877           MOVE AL-UANON             TO EPYFROMA
 11878           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 11879           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 11880
 11881     IF PI-USES-PAID-TO
 11882        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 11883        MOVE +1                            TO DC-ELAPSED-DAYS
 11884        MOVE +0                            TO DC-ELAPSED-MONTHS
 11885        MOVE '6'                           TO DC-OPTION-CODE
 11886        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11887        IF NO-CONVERSION-ERROR
 11888           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 11889           IF PI-EPYTHRU = ZEROS
 11890              MOVE AL-UANON                TO EPYTHRUA
 11891              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 11892              MOVE ' '                     TO DC-OPTION-CODE
 11893              MOVE +0                      TO DC-ELAPSED-DAYS
 11894                                              DC-ELAPSED-MONTHS
 11895              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11896              IF NO-CONVERSION-ERROR
 11897                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 11898                  GO TO 2001-CONTINUE
 11899              ELSE
 11900                  GO TO 2001-CONTINUE
 11901           ELSE
 11902              GO TO 2001-CONTINUE.
 11903
 11904     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11905     MOVE SPACES                 TO DC-OPTION-CODE.
 11906     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11907
 11908     IF DATE-CONVERSION-ERROR
 11909        MOVE SPACES              TO CPYTHRUI
 11910     ELSE
 11911        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 11912        IF PI-EPYTHRU = ZEROS
 11913           MOVE AL-UANON TO EPYTHRUA
 11914           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 11915           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 11916
 11917 2001-CONTINUE.
 11918
 11919     MOVE PI-CDAYS               TO CDAYSO.
 11920
 11921     IF PI-EDAYS = ZEROS
 11922        MOVE AL-UNNON TO EDAYSA
 11923        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 11924
 11925     MOVE PI-CPYAMT              TO CPYAMTO.
 11926
 11927     IF PI-EPYAMT = ZEROS
 11928        MOVE AL-UNNON            TO EPYAMTA
 11929        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 11930
 11931     MOVE PI-CRESV               TO CRESVO.
 11932     MOVE PI-CEXPENS             TO CEXPENSO.
 11933
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 232
* EL156.cbl
 11934     IF PI-EEXPENS = ZEROS
 11935        MOVE AL-UNNON TO EEXPENSA
 11936        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 11937
 11938     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 11939        AND (CL-CLAIM-TYPE = 'L')
 11940        AND (PI-OFFLINE NOT EQUAL 'Y')
 11941        IF PI-PMTTYPE = '2' OR '4'
 11942           PERFORM 2200-CALC-INTEREST
 11943                                 THRU 2200-EXIT
 11944        END-IF
 11945     END-IF
 11946     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 11947     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 11948     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 11949
 11950     IF EMI-FATAL-CTR = ZEROS
 11951        MOVE 'B'                 TO PI-PASS-SW.
 11952
 11953     IF NOT EMI-MESSAGE-FORMATTED
 11954         MOVE -1                 TO EPYFROML
 11955     ELSE
 11956         IF EMI-ERROR-NUMBER (1) = '0526' AND
 11957            EMI-ERROR-NUMBER (2) = SPACES
 11958             MOVE -1             TO EPYFROML.
 11959
 11960     GO TO 8200-SEND-DATAONLY.
 11961
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 233
* EL156.cbl
 11963 2200-CALC-INTEREST.
 11964     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 11965        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 11966        MOVE '4'                 TO DC-OPTION-CODE
 11967        PERFORM 9700-LINK-DATE-CONVERT
 11968        IF DATE-CONVERSION-ERROR
 11969            MOVE LOW-VALUES      TO CP-PRF-DT
 11970        ELSE
 11971           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 11972        END-IF
 11973     END-IF
 11974     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 11975        IN CLAIM-INT-PASS-AREA
 11976     MOVE CL-CERT-STATE          TO CP-STATE
 11977        IN CLAIM-INT-PASS-AREA
 11978     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 11979     MOVE 'LF'                   TO CP-COVERAGE
 11980     MOVE CL-INCURRED-DT         TO CP-INC-DT
 11981     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 11982     MOVE LOW-VALUES             TO CP-LSTPD-DT
 11983     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 11984     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 11985     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 11986
 11987* EXEC CICS LINK
 11988*       PROGRAM   ('ELCLMI')
 11989*       COMMAREA  (CLAIM-INT-PASS-AREA)
 11990*       LENGTH    (CP-CLAIM-LENGTH)
 11991*    END-EXEC
 11992     MOVE 'ELCLMI' TO DFHEIV1
 11993*    MOVE '."C                   ''   #00011505' TO DFHEIV0
 11994     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11995     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11996     MOVE X'2020233030303131353035' TO DFHEIV0(25:11)
 11997     CALL 'kxdfhei1' USING DFHEIV0,
 11998           DFHEIV1,
 11999           CLAIM-INT-PASS-AREA,
 12000           CP-CLAIM-LENGTH,
 12001           DFHEIV99,
 12002           DFHEIV99,
 12003           DFHEIV99
 12004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12005     MOVE AL-PANOF               TO PINTHA
 12006                                    PINTA
 12007     IF NO-CI-ERROR
 12008        MOVE CP-CLM-INT-AMT      TO PINTO
 12009                                    PI-INT-AMT
 12010        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12011        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12012        MOVE AL-PANOF            TO PINTHA
 12013                                    PINTA
 12014     ELSE
 12015        IF CI-RETURN-CODE = '8'
 12016           MOVE ER-3818          TO EMI-ERROR
 12017           MOVE -1               TO ZINTL
 12018           PERFORM 9900-ERROR-FORMAT
 12019                                 THRU 9900-EXIT
 12020           GO TO 2200-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 234
* EL156.cbl
 12021        ELSE
 12022           MOVE ZEROS            TO PINTO
 12023                                    PI-INT-AMT
 12024                                    PI-INT-DAYS
 12025                                    PI-INT-RATE-USED
 12026        END-IF
 12027     END-IF
 12028     IF PI-INT-AMT NOT = ZEROS
 12029        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12030           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12031           CONTINUE
 12032        ELSE
 12033           MOVE CL-SOC-SEC-NO (1:3)
 12034                                 TO WS-SSN (1:3)
 12035           MOVE CL-SOC-SEC-NO (5:2)
 12036                                 TO WS-SSN (4:2)
 12037           MOVE CL-SOC-SEC-NO (8:4)
 12038                                 TO WS-SSN (6:4)
 12039           IF (WS-SSN NUMERIC)
 12040              AND (WS-SSN NOT = ZEROS)
 12041              CONTINUE
 12042           ELSE
 12043              MOVE ER-2044       TO EMI-ERROR
 12044              PERFORM 9900-ERROR-FORMAT
 12045                                 THRU 9900-EXIT
 12046           END-IF
 12047        END-IF
 12048        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12049        MOVE +51                 TO TRLR-SEQ-NO
 12050
 12051* EXEC CICS READ
 12052*          DATASET  ('ELTRLR')
 12053*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12054*          RIDFLD   (ELTRLR-KEY)
 12055*          RESP     (WS-RESPONSE)
 12056*       END-EXEC
 12057     MOVE 'ELTRLR' TO DFHEIV1
 12058*    MOVE '&"S        E          (  N#00011555' TO DFHEIV0
 12059     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12061     MOVE X'204E233030303131353535' TO DFHEIV0(25:11)
 12062     CALL 'kxdfhei1' USING DFHEIV0,
 12063           DFHEIV1,
 12064           DFHEIV20,
 12065           DFHEIV99,
 12066           ELTRLR-KEY,
 12067           DFHEIV99,
 12068           DFHEIV99,
 12069           DFHEIV99
 12070     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12071         DFHEIV20
 12072     MOVE EIBRESP  TO WS-RESPONSE
 12073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12074        IF (NOT WS-RESP-NORMAL)
 12075                    OR
 12076           ((WS-RESP-NORMAL)
 12077           AND ((AT-ADDRESS-LINE-1 = SPACES)
 12078           OR (AT-CITY-STATE = SPACES)))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 235
* EL156.cbl
 12079           MOVE ER-0874          TO EMI-ERROR
 12080           PERFORM 9900-ERROR-FORMAT
 12081                                 THRU 9900-EXIT
 12082        END-IF
 12083     END-IF
 12084     .
 12085 2200-EXIT.
 12086     EXIT.
 12087 3000-MOVE-INPUT-TO-SAVE-AREA.
 12088     IF PMTTYPEL > 0
 12089         MOVE PMTTYPEI           TO WS-PMTTYPE.
 12090
 12091     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 12092
 12093     IF WS-PMTTYPE = '9'
 12094         MOVE 'P'                TO PI-PROVISIONAL-IND
 12095         MOVE '1'                TO WS-PMTTYPE.
 12096
 12097     IF PAYEEL > 0
 12098         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 12099         MOVE PAYEEI             TO WS-PAYEE.
 12100
 12101     IF NOTE1L > +0
 12102         MOVE NOTE1I             TO WS-PMTNOTE1
 12103                                    WS-FLI-PMTNOTE
 12104                                    WS-HAN-PMTNOTE.
 12105
 12106     IF NOTE2L > +0
 12107         MOVE NOTE2I             TO WS-PMTNOTE2.
 12108
 12109     IF OFFLINEL > 0
 12110         MOVE OFFLINEI           TO WS-OFFLINE.
 12111
 12112     IF PROOFDTL > 0
 12113         MOVE PROOFDTI            TO DATE-WORK
 12114         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12115         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 12116         MOVE '4'                 TO DC-OPTION-CODE
 12117         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 12118         IF NO-CONVERSION-ERROR
 12119            MOVE NUM-WORK         TO PROOFDTO
 12120            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 12121            MOVE NUM-WORK         TO WS-PROOF-DATE
 12122         ELSE
 12123            MOVE ZEROS            TO WS-PROOF-DATE
 12124         END-IF
 12125     END-IF.
 12126
 12127     IF EOBYNL > +0
 12128        MOVE EOBYNI              TO WS-PRINT-EOB-YN
 12129     END-IF
 12130     IF GROUPEDL > +0
 12131         MOVE GROUPEDI           TO WS-GROUPED.
 12132
 12133     IF CASHL > +0
 12134        MOVE CASHI               TO WS-CASH.
 12135
 12136     IF LOANNOL > +0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 236
* EL156.cbl
 12137         MOVE LOANNOI            TO WS-LOAN-NO.
 12138
 12139     IF CHECKNOL > 0
 12140         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 12141
 12142     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12143         IF WS-AIG-CREDIT-ENTERED
 12144             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 12145             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 12146             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 12147             MOVE AL-UANON         TO CHECKNOA.
 12148
 12149     IF HOLDTILL > 0
 12150         MOVE HOLDTILI           TO DATE-WORK
 12151         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12152         MOVE NUM-WORK           TO WS-HOLDTIL.
 12153
 12154     IF ZINTL > +0
 12155
 12156* EXEC CICS BIF DEEDIT
 12157*           FIELD   (ZINTI)
 12158*           LENGTH  (07)
 12159*       END-EXEC
 12160     MOVE 07
 12161       TO DFHEIV11
 12162*    MOVE '@"L                   #   #00011642' TO DFHEIV0
 12163     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12164     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12165     MOVE X'2020233030303131363432' TO DFHEIV0(25:11)
 12166     CALL 'kxdfhei1' USING DFHEIV0,
 12167           ZINTI,
 12168           DFHEIV11
 12169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12170        IF ZINTI NOT NUMERIC
 12171           MOVE ER-0419          TO EMI-ERROR
 12172           PERFORM 9900-ERROR-FORMAT
 12173           MOVE AL-UABON         TO ZINTA
 12174           MOVE -1               TO ZINTL
 12175        ELSE
 12176           MOVE ZINTI            TO CP-INT-RATE
 12177                                    WS-INT-RATE
 12178           MOVE CP-INT-RATE      TO ZINTO
 12179           MOVE AL-UNNON         TO ZINTA
 12180        END-IF
 12181     ELSE
 12182        MOVE ZEROS               TO CP-INT-RATE
 12183     END-IF
 12184     IF EPYFROML > 0
 12185         MOVE EPYFROMI           TO DATE-WORK
 12186         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12187         MOVE NUM-WORK           TO WS-EPYFROM.
 12188
 12189     IF AIGFROML > 0
 12190         MOVE AIGFROMI           TO DATE-WORK
 12191         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12192         MOVE NUM-WORK           TO WS-AIGFROM
 12193     ELSE
 12194         IF (AIGFROMI = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 237
* EL156.cbl
 12195            (PI-AIGFROM NOT = ZEROS)
 12196              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 12197
 12198     IF EPYTHRUL > +0
 12199        MOVE EPYTHRUI           TO DATE-WORK
 12200        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12201        MOVE NUM-WORK           TO WS-EPYTHRU
 12202        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12203        MOVE '4'                TO DC-OPTION-CODE
 12204        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12205        IF NO-CONVERSION-ERROR
 12206           IF PI-USES-PAID-TO
 12207              MOVE '6'                TO DC-OPTION-CODE
 12208              MOVE -1                 TO DC-ELAPSED-DAYS
 12209              MOVE +0                 TO DC-ELAPSED-MONTHS
 12210              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12211              IF NO-CONVERSION-ERROR
 12212                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 12213                 MOVE ' '             TO DC-OPTION-CODE
 12214                 MOVE +0              TO DC-ELAPSED-DAYS
 12215                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12216              IF NO-CONVERSION-ERROR
 12217                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 12218
 12219*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12220*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12221     IF EDAYSL > 0
 12222
 12223* EXEC CICS BIF DEEDIT
 12224*            FIELD(EDAYSI)
 12225*            LENGTH(6)
 12226*        END-EXEC
 12227     MOVE 6
 12228       TO DFHEIV11
 12229*    MOVE '@"L                   #   #00011698' TO DFHEIV0
 12230     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12231     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12232     MOVE X'2020233030303131363938' TO DFHEIV0(25:11)
 12233     CALL 'kxdfhei1' USING DFHEIV0,
 12234           EDAYSI,
 12235           DFHEIV11
 12236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12237         MOVE EDAYSI             TO WS-DY-WORK
 12238         IF WS-DY-SIGN = SPACES
 12239            MOVE WS-DY-NUM       TO WS-EDAYS
 12240            ADD 0                TO WS-EDAYS
 12241         ELSE
 12242            MOVE EDAYSI          TO WS-EDAYS
 12243            ADD 0                TO WS-EDAYS.
 12244
 12245*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12246*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12247     IF EPYAMTL > 0
 12248
 12249* EXEC CICS BIF DEEDIT
 12250*            FIELD(EPYAMTI)
 12251*            LENGTH(10)
 12252*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 238
* EL156.cbl
 12253     MOVE 10
 12254       TO DFHEIV11
 12255*    MOVE '@"L                   #   #00011713' TO DFHEIV0
 12256     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12257     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12258     MOVE X'2020233030303131373133' TO DFHEIV0(25:11)
 12259     CALL 'kxdfhei1' USING DFHEIV0,
 12260           EPYAMTI,
 12261           DFHEIV11
 12262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12263         MOVE EPYAMTI            TO WS-PY-WORK
 12264         IF WS-PY-SIGN = SPACES
 12265            MOVE WS-PY-NUM       TO WS-EPYAMT
 12266            ADD 0                TO WS-EPYAMT
 12267         ELSE
 12268            MOVE EPYAMTI         TO WS-EPYAMT
 12269            ADD 0                TO WS-EPYAMT.
 12270
 12271     IF ERESVL > 0
 12272
 12273* EXEC CICS BIF DEEDIT
 12274*            FIELD(ERESVI)
 12275*            LENGTH(9)
 12276*        END-EXEC
 12277     MOVE 9
 12278       TO DFHEIV11
 12279*    MOVE '@"L                   #   #00011726' TO DFHEIV0
 12280     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12281     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12282     MOVE X'2020233030303131373236' TO DFHEIV0(25:11)
 12283     CALL 'kxdfhei1' USING DFHEIV0,
 12284           ERESVI,
 12285           DFHEIV11
 12286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12287         MOVE ERESVI TO WS-ERESV.
 12288
 12289     IF EEXPENSL > 0
 12290
 12291* EXEC CICS BIF DEEDIT
 12292*            FIELD(EEXPENSI)
 12293*            LENGTH(8)
 12294*        END-EXEC
 12295     MOVE 8
 12296       TO DFHEIV11
 12297*    MOVE '@"L                   #   #00011733' TO DFHEIV0
 12298     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12299     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12300     MOVE X'2020233030303131373333' TO DFHEIV0(25:11)
 12301     CALL 'kxdfhei1' USING DFHEIV0,
 12302           EEXPENSI,
 12303           DFHEIV11
 12304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12305         MOVE EEXPENSI           TO WS-EEXPENS.
 12306
 12307     IF ETYPEL > ZEROS
 12308         MOVE ETYPEI             TO WS-ETYPE.
 12309
 12310     IF PI-COMPANY-ID = 'BOA'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 239
* EL156.cbl
 12311        IF PINTL > ZEROS
 12312
 12313* EXEC CICS BIF DEEDIT
 12314*            FIELD (PINTI)
 12315*            LENGTH(05)
 12316*          END-EXEC
 12317     MOVE 05
 12318       TO DFHEIV11
 12319*    MOVE '@"L                   #   #00011744' TO DFHEIV0
 12320     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12321     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12322     MOVE X'2020233030303131373434' TO DFHEIV0(25:11)
 12323     CALL 'kxdfhei1' USING DFHEIV0,
 12324           PINTI,
 12325           DFHEIV11
 12326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12327           IF PINTI NUMERIC
 12328               MOVE AL-UNNON     TO PINTA
 12329               MOVE PINTI        TO WS-INT-RATE
 12330               MOVE WS-INT-RATE  TO PINTO.
 12331
 12332 3000-EXIT.
 12333     EXIT.
 12334
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 240
* EL156.cbl
 12336 3050-REBUILD-ENTERED.
 12337
 12338     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 12339
 12340     IF PI-PROV-PMT
 12341         MOVE '9'           TO PMTTYPEO
 12342     ELSE
 12343         MOVE PI-PMTTYPE    TO PMTTYPEO.
 12344
 12345     MOVE PI-PAYEE          TO PAYEEO.
 12346     MOVE PI-PMTNOTE1       TO NOTE1O.
 12347     MOVE PI-PMTNOTE2       TO NOTE2O.
 12348     MOVE PI-OFFLINE        TO OFFLINEO.
 12349     IF PI-PROOF-DATE NOT = ZEROS
 12350         MOVE PI-PROOF-DATE TO PROOFDTO
 12351         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 12352     END-IF.
 12353     MOVE PI-GROUPED        TO GROUPEDO.
 12354
 12355     MOVE PI-CASH           TO CASHO.
 12356
 12357     IF PI-INT-RATE > ZEROS
 12358         MOVE PI-INT-RATE   TO PINTO.
 12359
 12360     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12361        IF PI-INT-AMT > ZEROS
 12362           MOVE PI-INT-AMT       TO PINTO
 12363           MOVE AL-PANOF         TO PINTA
 12364                                    PINTHA
 12365        END-IF
 12366     END-IF
 12367     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 12368     IF PI-HOLDTIL NOT = ZEROS
 12369        MOVE PI-HOLDTIL          TO HOLDTILO
 12370        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12371
 12372     IF PI-EPYFROM NOT = ZEROS
 12373        MOVE PI-EPYFROM          TO EPYFROMO
 12374        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 12375
 12376     IF PI-AIGFROM NOT = ZEROS
 12377        MOVE PI-AIGFROM          TO AIGFROMO
 12378        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12379
 12380     IF PI-EPYTHRU NOT = ZEROS
 12381        MOVE PI-EPYTHRU          TO EPYTHRUO
 12382        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 12383        IF PI-USES-PAID-TO
 12384           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12385           MOVE '4'                TO DC-OPTION-CODE
 12386           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12387           IF NO-CONVERSION-ERROR
 12388              MOVE +1 TO DC-ELAPSED-DAYS
 12389              MOVE +0 TO DC-ELAPSED-MONTHS
 12390              MOVE '6' TO DC-OPTION-CODE
 12391              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12392              IF NO-CONVERSION-ERROR
 12393                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 241
* EL156.cbl
 12394
 12395     IF PI-EDAYS NOT = ZEROS
 12396        MOVE PI-EDAYS TO EDAYSO.
 12397
 12398     IF PI-EPYAMT NOT = ZEROS
 12399        MOVE PI-EPYAMT TO EPYAMTO.
 12400
 12401     IF PI-ERESV NOT = ZEROS
 12402        MOVE PI-ERESV TO ERESVO.
 12403
 12404     IF PI-EEXPENS NOT = ZEROS
 12405        MOVE PI-EEXPENS TO EEXPENSO.
 12406
 12407     MOVE PI-ETYPE TO ETYPEO.
 12408
 12409     IF PI-ECHECKNO NOT = SPACES
 12410        MOVE PI-ECHECKNO         TO CHECKNOO
 12411     ELSE
 12412        MOVE PI-CCHECKNO         TO CHECKNOO.
 12413
 12414     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12415     MOVE SPACES                 TO DC-OPTION-CODE.
 12416     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12417
 12418     IF DATE-CONVERSION-ERROR
 12419        MOVE SPACES              TO CPYFROMI
 12420     ELSE
 12421        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 12422
 12423     IF PI-USES-PAID-TO
 12424        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12425        MOVE +1                  TO DC-ELAPSED-DAYS
 12426        MOVE +0                  TO DC-ELAPSED-MONTHS
 12427        MOVE '6'                 TO DC-OPTION-CODE
 12428        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12429        IF NO-CONVERSION-ERROR
 12430           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12431           GO TO 3051-CONTINUE.
 12432
 12433     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12434     MOVE SPACES                 TO DC-OPTION-CODE.
 12435     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12436
 12437     IF DATE-CONVERSION-ERROR
 12438        MOVE SPACES              TO CPYTHRUI
 12439     ELSE
 12440        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 12441
 12442 3051-CONTINUE.
 12443
 12444     IF PI-CDAYS NOT = ZEROS
 12445        MOVE PI-CDAYS TO CDAYSO.
 12446
 12447     IF PI-CPYAMT NOT = ZEROS
 12448        MOVE PI-CPYAMT TO CPYAMTO.
 12449
 12450     IF PI-CRESV NOT = ZEROS
 12451        MOVE PI-CRESV TO CRESVO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 242
* EL156.cbl
 12452
 12453     IF PI-CEXPENS NOT = ZEROS
 12454        MOVE PI-CEXPENS TO CEXPENSO.
 12455
 12456 3059-EXIT.
 12457     EXIT.
 12458
 12459 3100-DEEDIT-DATE.
 12460
 12461* EXEC CICS BIF DEEDIT
 12462*        FIELD(DATE-WORK)
 12463*        LENGTH(8)
 12464*    END-EXEC.
 12465     MOVE 8
 12466       TO DFHEIV11
 12467*    MOVE '@"L                   #   #00011881' TO DFHEIV0
 12468     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12469     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12470     MOVE X'2020233030303131383831' TO DFHEIV0(25:11)
 12471     CALL 'kxdfhei1' USING DFHEIV0,
 12472           DATE-WORK,
 12473           DFHEIV11
 12474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12475
 12476
 12477 3100-EXIT.
 12478     EXIT.
 12479
 12480 3200-CALC-AIG-DAYS.
 12481
 12482     MOVE 'N'                    TO WS-DUE-DAY-SW.
 12483
 12484     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 12485     MOVE ' '                    TO DC-OPTION-CODE.
 12486     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12487     IF NO-CONVERSION-ERROR
 12488         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 12489     ELSE
 12490         GO TO 3290-ERROR.
 12491
 12492     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12493         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12494                                WS-BIN-FROM-DT
 12495     ELSE
 12496         IF CL-TOTAL-PAID-AMT > ZEROS
 12497             IF WS-SV-EPYFROM = LOW-VALUES
 12498                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12499                                        WS-BIN-FROM-DT
 12500             ELSE
 12501                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12502                                        WS-BIN-FROM-DT
 12503         ELSE
 12504             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12505                                        WS-BIN-FROM-DT.
 12506
 12507 3210-CONTINUE.
 12508
 12509     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 243
* EL156.cbl
 12510     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12511     IF DATE-CONVERSION-ERROR
 12512         GO TO 3290-ERROR.
 12513
 12514     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 12515
 12516     IF PI-LOAN-DUE-DAY = 31
 12517         MOVE 30              TO WS-PMT-DUE-DA
 12518                                 WS-SAVE-DUE-DA
 12519     ELSE
 12520         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 12521                                 WS-SAVE-DUE-DA.
 12522
 12523     IF (PI-LOAN-DUE-DAY > 28) AND
 12524        (WS-PMT-DUE-MO = 2)
 12525         MOVE 'Y'                TO WS-DUE-DAY-SW
 12526         MOVE 28                 TO WS-PMT-DUE-DA.
 12527
 12528     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 12529     MOVE '4'                    TO DC-OPTION-CODE.
 12530     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12531     IF NO-CONVERSION-ERROR
 12532         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 12533     ELSE
 12534         GO TO 3290-ERROR.
 12535
 12536*--------------------------------------------------------------*
 12537*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 12538*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 12539*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 12540*                                                              *
 12541*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 12542*             INCURRED DATE      - 04/15/91                    *
 12543*             PMT DUE DATE       - 04/03/91                    *
 12544*             PMT DUE DATE       - 05/03/91                    *
 12545*--------------------------------------------------------------*
 12546
 12547     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12548        (WS-SV-AIGFROM = LOW-VALUES)
 12549         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 12550            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 12551             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12552             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12553             IF NO-CONVERSION-ERROR
 12554                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12555                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12556             ELSE
 12557                 GO TO 3290-ERROR.
 12558
 12559     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12560        (WS-SV-AIGFROM = LOW-VALUES)
 12561         GO TO 3205-CONT-CALC-PMT.
 12562
 12563     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 12564     MOVE ' '                    TO DC-OPTION-CODE.
 12565     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12566     IF NO-CONVERSION-ERROR
 12567         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 244
* EL156.cbl
 12568     ELSE
 12569         GO TO 3290-ERROR.
 12570
 12571     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 12572        (WS-PMT-DUE-DA < WS-FROM-DA)
 12573          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12574          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12575          IF NO-CONVERSION-ERROR
 12576              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12577              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12578          ELSE
 12579              GO TO 3290-ERROR.
 12580
 12581 3205-CONT-CALC-PMT.
 12582
 12583*--------------------------------------------------------------*
 12584*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 12585*    BETWEEN THE PAY FROM / THRU DATES.                        *
 12586*--------------------------------------------------------------*
 12587
 12588     IF CL-TOTAL-PAID-AMT = ZEROS AND
 12589        PI-PMTTYPE = '2'
 12590          NEXT SENTENCE
 12591     ELSE
 12592        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 12593           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 12594             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 12595             MOVE ER-3527            TO EMI-ERROR
 12596             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12597             MOVE -1                 TO EPYTHRUL
 12598             MOVE AL-UNBON           TO EPYTHRUA
 12599                                        EPYFROMA
 12600             GO TO 3299-EXIT.
 12601
 12602*--------------------------------------------------------------*
 12603*    CALCULATE RETRO ELIMINATION DATE                          *
 12604*--------------------------------------------------------------*
 12605
 12606     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12607         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12608     ELSE
 12609         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12610
 12611     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 12612     MOVE +0             TO DC-ELAPSED-MONTHS.
 12613     MOVE '6'            TO DC-OPTION-CODE.
 12614     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12615     IF NO-CONVERSION-ERROR
 12616         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 12617     ELSE
 12618         GO TO 3290-ERROR.
 12619
 12620 3210-CHECK-PMT-DATE.
 12621
 12622*--------------------------------------------------------------*
 12623*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 12624*    THE ENTERED PAY FROM DATE                                 *
 12625*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 245
* EL156.cbl
 12626
 12627     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 12628         NEXT SENTENCE
 12629     ELSE
 12630         GO TO 3220-COMPUTE-DAYS.
 12631
 12632     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 12633     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12634     IF NO-CONVERSION-ERROR
 12635         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12636         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12637         GO TO 3210-CHECK-PMT-DATE
 12638     ELSE
 12639         GO TO 3290-ERROR.
 12640
 12641 3220-COMPUTE-DAYS.
 12642
 12643     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 12644     MOVE ZEROS         TO WS-CDAYS.
 12645     MOVE 'N'           TO WS-ELIMINATION-SW.
 12646
 12647*--------------------------------------------------------------*
 12648*    COMPUTE CALIFORNIA DUE DAYS                               *
 12649*--------------------------------------------------------------*
 12650
 12651     IF CL-TOTAL-PAID-AMT > ZEROS
 12652         MOVE 'Y' TO WS-ELIMINATION-SW
 12653         GO TO 3240-FIRST-PMT-DUE
 12654     ELSE
 12655        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 12656            NEXT SENTENCE
 12657        ELSE
 12658            GO TO 3240-FIRST-PMT-DUE.
 12659
 12660 3230-NEXT-PMT-DUE.
 12661
 12662     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 12663     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12664     IF NO-CONVERSION-ERROR
 12665         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 12666         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12667     ELSE
 12668         GO TO 3290-ERROR.
 12669
 12670 3240-FIRST-PMT-DUE.
 12671
 12672     IF CL-TOTAL-PAID-AMT > ZEROS
 12673         NEXT SENTENCE
 12674     ELSE
 12675        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 12676            GO TO 3230-NEXT-PMT-DUE.
 12677
 12678     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 12679         GO TO 3250-VERIFY-ELIMINATION.
 12680
 12681     ADD +30 TO WS-CDAYS.
 12682     MOVE 'Y' TO WS-ELIMINATION-SW.
 12683     GO TO 3230-NEXT-PMT-DUE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 246
* EL156.cbl
 12684
 12685 3250-VERIFY-ELIMINATION.
 12686
 12687     IF ELIM-SATISFIED
 12688         GO TO 3260-END-CALC.
 12689
 12690     IF PI-PMTTYPE = '1'
 12691         MOVE ZEROS TO WS-CDAYS
 12692         GO TO 3260-END-CALC.
 12693
 12694     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12695         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12696     ELSE
 12697         IF CL-TOTAL-PAID-AMT > ZEROS
 12698             IF WS-SV-EPYFROM = LOW-VALUES
 12699                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12700             ELSE
 12701                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12702         ELSE
 12703             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 12704
 12705     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 12706     MOVE '1'                    TO DC-OPTION-CODE.
 12707     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12708     IF NO-CONVERSION-ERROR
 12709         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 12710     ELSE
 12711         GO TO 3290-ERROR.
 12712
 12713     IF CL-TOTAL-PAID-AMT > ZEROS
 12714         MOVE WS-DAYS-OFF TO WS-CDAYS
 12715     ELSE
 12716         IF PI-BEN-DAYS > WS-DAYS-OFF
 12717             MOVE ZEROS TO WS-CDAYS
 12718         ELSE
 12719             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 12720
 12721 3260-END-CALC.
 12722
 12723     MOVE WS-CDAYS TO PI-CDAYS.
 12724
 12725     IF PI-EDAYS = ZEROS
 12726         MOVE PI-CDAYS TO PI-EDAYS
 12727         MOVE AL-UNNON TO EDAYSA.
 12728
 12729     GO TO 3299-EXIT.
 12730
 12731 3290-ERROR.
 12732
 12733     MOVE ER-3528            TO EMI-ERROR.
 12734     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12735     MOVE -1                 TO CDAYSL.
 12736     MOVE AL-UNBON           TO CDAYSA.
 12737
 12738 3299-EXIT.
 12739     EXIT.
 12740
 12741 3300-BUMP-DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 247
* EL156.cbl
 12742
 12743     IF WS-RESTORE-DUE-DAY
 12744         MOVE 'N'              TO WS-DUE-DAY-SW
 12745         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 12746         ADD 1                 TO WS-PMT-DUE-MO
 12747         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 12748         MOVE '4'              TO DC-OPTION-CODE
 12749         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12750         IF NO-CONVERSION-ERROR
 12751             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12752             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 12753             GO TO 3399-EXIT
 12754         ELSE
 12755             MOVE '9'          TO DC-ERROR-CODE
 12756             GO TO 3399-EXIT.
 12757
 12758     IF (WS-PMT-DUE-MO = 1) AND
 12759        (WS-SAVE-DUE-DA > 28)
 12760           MOVE 'Y' TO WS-DUE-DAY-SW.
 12761
 12762     MOVE +0                 TO DC-ELAPSED-DAYS.
 12763     MOVE +1                 TO DC-ELAPSED-MONTHS.
 12764     MOVE '6'                TO DC-OPTION-CODE.
 12765     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12766
 12767 3399-EXIT.
 12768     EXIT.
 12769
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 248
* EL156.cbl
 12771 3400-COMPUTE-EXPIRY.
 12772
 12773     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 12774     MOVE +0                    TO DC-ELAPSED-DAYS
 12775                                   DC-ODD-DAYS-OVER.
 12776     MOVE '1'                   TO DC-END-OF-MONTH.
 12777     MOVE '6'                   TO DC-OPTION-CODE.
 12778
 12779     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12780         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 12781     ELSE
 12782         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 12783
 12784     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12785     IF NO-CONVERSION-ERROR
 12786         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 12787     ELSE
 12788         GO TO 3390-CONTINUE.
 12789
 12790     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 12791         GO TO 3390-CONTINUE.
 12792
 12793     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12794     MOVE '4'                    TO CNTL-REC-TYPE.
 12795     MOVE +0                     TO CNTL-SEQ-NO.
 12796     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 12797     MOVE WS-ACCESS              TO CNTL-ACCESS.
 12798     MOVE 'BENE'                 TO FILE-SWITCH.
 12799
 12800     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 12801
 12802     IF NO-BENEFIT-FOUND
 12803         GO TO 3390-CONTINUE.
 12804
 12805     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 12806        IF (PI-OFFLINE = 'Y') OR
 12807           (PI-PMTTYPE = '7')
 12808           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 12809                                     THRU 9870-EXIT
 12810           IF ERROR-ON-OUTPUT
 12811             MOVE -1                 TO ENTERPFL
 12812             MOVE AL-UANON           TO ENTERPFA
 12813             MOVE MAP-NAMEA          TO MAP-NAME
 12814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12815             GO TO 8200-SEND-DATAONLY.
 12816
 12817     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 12818        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 12819        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 12820          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 12821          MOVE +0        TO DC-ELAPSED-DAYS
 12822          MOVE +1        TO DC-ELAPSED-MONTHS
 12823          MOVE 6         TO DC-OPTION-CODE
 12824          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12825          IF NO-CONVERSION-ERROR
 12826              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 12827
 12828 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 249
* EL156.cbl
 12829
 12830      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12831         MOVE CM-AH-LOAN-EXPIRE-DT
 12832                                 TO DC-BIN-DATE-1
 12833      ELSE
 12834         MOVE CM-LF-LOAN-EXPIRE-DT
 12835                                 TO DC-BIN-DATE-1
 12836      END-IF
 12837
 12838      MOVE ' '                    TO DC-OPTION-CODE.
 12839      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12840      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 12841      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 12842
 12843 3499-EXIT.
 12844     EXIT.
 12845
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 250
* EL156.cbl
 12847
 12848 3600-CHECK-VERIFICATION.
 12849
 12850     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12851
 12852     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 12853
 12854     IF PI-PAYEE-TYPE = 'I'
 12855        GO TO 3600-READ-TRAILER.
 12856
 12857     IF PI-PAYEE-TYPE = 'B'
 12858        ADD +10                  TO TRLR-SEQ-NO
 12859        GO TO 3600-READ-TRAILER.
 12860
 12861     IF PI-PAYEE-TYPE = 'A'
 12862        ADD +20                  TO TRLR-SEQ-NO
 12863        GO TO 3600-READ-TRAILER.
 12864
 12865     IF PI-PAYEE-TYPE = 'O'
 12866        ADD +50                  TO TRLR-SEQ-NO
 12867        GO TO 3600-READ-TRAILER.
 12868
 12869     IF PI-PAYEE-TYPE = 'Q'
 12870        ADD +60                  TO TRLR-SEQ-NO
 12871        GO TO 3600-READ-TRAILER.
 12872
 12873     IF PI-PAYEE-TYPE = 'P'
 12874        ADD +30                  TO TRLR-SEQ-NO
 12875        GO TO 3600-READ-TRAILER.
 12876
 12877     IF PI-PAYEE-TYPE = 'E'
 12878        ADD +40                  TO TRLR-SEQ-NO.
 12879
 12880 3600-READ-TRAILER.
 12881
 12882
 12883* EXEC CICS HANDLE CONDITION
 12884*         NOTFND(3600-CONTINUE)
 12885*    END-EXEC.
 12886*    MOVE '"$I                   ! - #00012291' TO DFHEIV0
 12887     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12889     MOVE X'2D20233030303132323931' TO DFHEIV0(25:11)
 12890     CALL 'kxdfhei1' USING DFHEIV0
 12891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12892
 12893
 12894     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12895
 12896 3600-CONTINUE.
 12897
 12898     IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 12899       IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 12900         MOVE ER-7576            TO EMI-ERROR
 12901         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12902         MOVE -1                 TO PAYEEL
 12903         MOVE AL-UABON           TO PAYEEA
 12904       END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 251
* EL156.cbl
 12905     END-IF.
 12906
 12907 3600-EXIT.
 12908     EXIT.
 12909
 12910 5000-UPDATE.
 12911
 12912     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 12913
 12914     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 12915
 12916     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 12917        PI-OFFLINE = 'Y'
 12918        NEXT SENTENCE
 12919     ELSE
 12920        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 12921
 12922*    IF PI-COMPANY-ID = 'CRI'
 12923*       IF PI-PMTTYPE = '1' OR  '2'
 12924*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12925*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 12926*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 12927
 12928*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 12929*       IF PI-PMTTYPE = '1'
 12930*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12931*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 12932
 12933     IF PI-PMTTYPE      = '2' AND
 12934        PI-SPLIT-PMT-SW = 'Y' AND
 12935        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 12936          MOVE ER-3530                TO EMI-ERROR
 12937          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12938
 12939     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12940        AND (CL-CLAIM-TYPE = 'L')
 12941        IF PI-PMTTYPE = '2' OR '4'
 12942           IF PI-INT-AMT NOT = ZEROS
 12943              PERFORM 7110-BUILD-PMT-TRLR
 12944                                 THRU 7130-EXIT
 12945           ELSE
 12946              IF PI-PMTTYPE = '2'
 12947                 PERFORM 7140-BUILD-NOTE-TRLR
 12948                                 THRU 7170-EXIT
 12949              END-IF
 12950           END-IF
 12951        END-IF
 12952     END-IF
 12953*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12954*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12955*            MOVE 'N'                 TO  WS-LETTER-SW.
 12956
 12957*    IF PI-COMPANY-ID = 'DMD'
 12958*        IF CL-NO-OF-PMTS-MADE = +1
 12959*                OR
 12960*           PI-PMTTYPE = '2'
 12961*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 12962
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 252
* EL156.cbl
 12963     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 12964
 12965*    IF PI-COMPANY-ID = 'DMD'
 12966*       IF CL-CERT-NO (5:2) = '69' OR '70'
 12967*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 12968
 12969
 12970* EXEC CICS REWRITE
 12971*         DATASET('ELMSTR')
 12972*         FROM(CLAIM-MASTER)
 12973*     END-EXEC.
 12974     MOVE LENGTH OF
 12975      CLAIM-MASTER
 12976       TO DFHEIV11
 12977     MOVE 'ELMSTR' TO DFHEIV1
 12978*    MOVE '&& L                  %   #00012370' TO DFHEIV0
 12979     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12980     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12981     MOVE X'2020233030303132333730' TO DFHEIV0(25:11)
 12982     CALL 'kxdfhei1' USING DFHEIV0,
 12983           DFHEIV1,
 12984           CLAIM-MASTER,
 12985           DFHEIV11,
 12986           DFHEIV99
 12987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12988
 12989
 12990     IF WS-LETTER-SW = 'N'
 12991         GO TO 5000-END-UPDATE.
 12992
 12993 5000-GENERATE-AUTO-LETTER.
 12994
 12995
 12996* EXEC CICS LINK
 12997*        PROGRAM    (LINK-1523)
 12998*        COMMAREA   (W-1523-LINKDATA)
 12999*        LENGTH     (W-1523-COMM-LENGTH)
 13000*    END-EXEC.
 13001*    MOVE '."C                   ''   #00012380' TO DFHEIV0
 13002     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13003     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13004     MOVE X'2020233030303132333830' TO DFHEIV0(25:11)
 13005     CALL 'kxdfhei1' USING DFHEIV0,
 13006           LINK-1523,
 13007           W-1523-LINKDATA,
 13008           W-1523-COMM-LENGTH,
 13009           DFHEIV99,
 13010           DFHEIV99,
 13011           DFHEIV99
 13012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13013
 13014
 13015     IF W-1523-FATAL-ERROR
 13016         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 13017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13018         MOVE ER-0802                TO  EMI-ERROR
 13019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13020
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 253
* EL156.cbl
 13021     IF W-1523-ERROR-CODE = 0191
 13022         MOVE ER-0803                TO  EMI-ERROR
 13023         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13024
 13025     IF PI-COMPANY-ID      = 'HAN' AND
 13026        PI-PMTTYPE         = '1'   AND
 13027        PI-3RD-PARTY-SW    = 'Y'   AND
 13028        W-1523-FORM-NUMBER = 'EOB1'
 13029           MOVE LOW-VALUES              TO W-1523-LINKDATA
 13030           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 13031           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 13032           GO TO 5000-GENERATE-AUTO-LETTER.
 13033
 13034 5000-END-UPDATE.
 13035
 13036     MOVE ER-0000                TO EMI-ERROR.
 13037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13038     GO TO 7000-SHOW-CLAIM.
 13039
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 254
* EL156.cbl
 13041 5000-MOVE-NAME.
 13042     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13043     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13044     MOVE CL-INSURED-MID-INIT    TO MINITO.
 13045
 13046 5000-EXIT.
 13047     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 255
* EL156.cbl
 13049 5300-CREATE-DMO.
 13050
 13051     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 13052     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 13053     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 13054
 13055
 13056* EXEC CICS HANDLE CONDITION
 13057*         NOTFND   (5300-NOTE-NOT-FOUND)
 13058*    END-EXEC.
 13059*    MOVE '"$I                   ! . #00012426' TO DFHEIV0
 13060     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13061     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13062     MOVE X'2E20233030303132343236' TO DFHEIV0(25:11)
 13063     CALL 'kxdfhei1' USING DFHEIV0
 13064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13065
 13066
 13067
 13068* EXEC CICS READ
 13069*         DATASET('ERNOTE')
 13070*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 13071*         RIDFLD (W-NOTE-KEY)
 13072*    END-EXEC.
 13073     MOVE 'ERNOTE' TO DFHEIV1
 13074*    MOVE '&"S        E          (   #00012430' TO DFHEIV0
 13075     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13077     MOVE X'2020233030303132343330' TO DFHEIV0(25:11)
 13078     CALL 'kxdfhei1' USING DFHEIV0,
 13079           DFHEIV1,
 13080           DFHEIV20,
 13081           DFHEIV99,
 13082           W-NOTE-KEY,
 13083           DFHEIV99,
 13084           DFHEIV99,
 13085           DFHEIV99
 13086     SET ADDRESS OF CERTIFICATE-NOTE TO
 13087         DFHEIV20
 13088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13089
 13090
 13091     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 13092     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 13093     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 13094
 13095     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 13096         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 13097     ELSE
 13098         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 13099
 13100     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 13101     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 13102     MOVE 'DLO006'               TO PGM-NAME.
 13103
 13104
 13105* EXEC CICS LINK
 13106*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 256
* EL156.cbl
 13107*        COMMAREA   (DCT-COMMUNICATION-AREA)
 13108*        LENGTH     (DCT-RCRD-LENGTH)
 13109*    END-EXEC.
 13110*    MOVE '."C                   ''   #00012449' TO DFHEIV0
 13111     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13112     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13113     MOVE X'2020233030303132343439' TO DFHEIV0(25:11)
 13114     CALL 'kxdfhei1' USING DFHEIV0,
 13115           PGM-NAME,
 13116           DCT-COMMUNICATION-AREA,
 13117           DCT-RCRD-LENGTH,
 13118           DFHEIV99,
 13119           DFHEIV99,
 13120           DFHEIV99
 13121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13122
 13123
 13124     IF DCT-RETURN-CODE = 'OK'
 13125         GO TO 5300-CONT.
 13126
 13127     IF DCT-RETURN-CODE = '01' OR '02'
 13128         GO TO 5300-EXIT.
 13129
 13130     IF DCT-RETURN-CODE = '03'
 13131         MOVE ER-0951            TO EMI-ERROR
 13132         GO TO 5300-BAD-EXIT.
 13133
 13134     IF DCT-RETURN-CODE = '04'
 13135         MOVE ER-0946            TO EMI-ERROR
 13136         GO TO 5300-BAD-EXIT.
 13137
 13138     IF DCT-RETURN-CODE = '05'
 13139         MOVE ER-0947            TO EMI-ERROR
 13140         GO TO 5300-BAD-EXIT.
 13141
 13142     IF DCT-RETURN-CODE = '06'
 13143         MOVE ER-0921            TO EMI-ERROR
 13144         GO TO 5300-BAD-EXIT.
 13145
 13146     IF DCT-RETURN-CODE = '07'
 13147         MOVE ER-0849            TO EMI-ERROR
 13148         GO TO 5300-BAD-EXIT.
 13149
 13150     IF DCT-RETURN-CODE = '08'
 13151         MOVE ER-0948            TO EMI-ERROR
 13152         GO TO 5300-BAD-EXIT.
 13153
 13154     IF DCT-RETURN-CODE = 'N1'
 13155         MOVE ER-0950            TO EMI-ERROR
 13156         GO TO 5300-BAD-EXIT.
 13157
 13158     IF DCT-RETURN-CODE = 'E1'
 13159         MOVE ER-0974            TO EMI-ERROR
 13160         GO TO 5300-BAD-EXIT.
 13161
 13162     IF DCT-RETURN-CODE = 'E2'
 13163         MOVE ER-0975            TO EMI-ERROR
 13164         GO TO 5300-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 257
* EL156.cbl
 13165
 13166     IF DCT-RETURN-CODE NOT = 'OK'
 13167         MOVE ER-0949            TO EMI-ERROR
 13168         GO TO 5300-BAD-EXIT.
 13169
 13170 5300-CONT.
 13171
 13172     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 13173     MOVE 'CS'                   TO DM-RECORD-TYPE.
 13174     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 13175     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 13176     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 13177     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 13178     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 13179     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 13180
 13181     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 13182     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 13183     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 13184     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 13185     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 13186
 13187     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 13188
 13189     IF PI-PMTTYPE = '2'
 13190         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 13191         MOVE '4'                TO DM-CLAIM-STATUS
 13192     ELSE
 13193         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 13194         MOVE '2'                TO DM-CLAIM-STATUS.
 13195
 13196     MOVE 'DLO025'               TO PGM-NAME.
 13197
 13198
 13199* EXEC CICS LINK
 13200*        PROGRAM    (PGM-NAME)
 13201*        COMMAREA   (DMO-COMMUNICATION-AREA)
 13202*        LENGTH     (DM-DMO-LENGTH)
 13203*    END-EXEC.
 13204*    MOVE '."C                   ''   #00012529' TO DFHEIV0
 13205     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13206     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13207     MOVE X'2020233030303132353239' TO DFHEIV0(25:11)
 13208     CALL 'kxdfhei1' USING DFHEIV0,
 13209           PGM-NAME,
 13210           DMO-COMMUNICATION-AREA,
 13211           DM-DMO-LENGTH,
 13212           DFHEIV99,
 13213           DFHEIV99,
 13214           DFHEIV99
 13215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13216
 13217
 13218     IF DM-RETURN-CODE = 'OK'
 13219         GO TO 5300-EXIT.
 13220
 13221     IF DM-RETURN-CODE = '01'
 13222         MOVE ER-8051            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 258
* EL156.cbl
 13223         GO TO 5300-BAD-EXIT.
 13224
 13225     IF DM-RETURN-CODE = '02'
 13226         MOVE ER-8052            TO EMI-ERROR
 13227         GO TO 5300-BAD-EXIT.
 13228
 13229     IF DM-RETURN-CODE = '03'
 13230         MOVE ER-8053            TO EMI-ERROR
 13231         GO TO 5300-BAD-EXIT.
 13232
 13233     IF DM-RETURN-CODE = '04'
 13234         MOVE ER-8054            TO EMI-ERROR
 13235         GO TO 5300-BAD-EXIT.
 13236
 13237     IF DM-RETURN-CODE = '05'
 13238         MOVE ER-8055            TO EMI-ERROR
 13239         GO TO 5300-BAD-EXIT.
 13240
 13241     IF DM-RETURN-CODE = '06'
 13242         MOVE ER-8056            TO EMI-ERROR
 13243         GO TO 5300-BAD-EXIT.
 13244
 13245     IF DM-RETURN-CODE = '07'
 13246         MOVE ER-8057            TO EMI-ERROR
 13247         GO TO 5300-BAD-EXIT.
 13248
 13249     IF DM-RETURN-CODE = '08'
 13250         MOVE ER-8058            TO EMI-ERROR
 13251         GO TO 5300-BAD-EXIT.
 13252
 13253     IF DM-RETURN-CODE = '09'
 13254         MOVE ER-8059            TO EMI-ERROR
 13255         GO TO 5300-BAD-EXIT.
 13256
 13257     IF DM-RETURN-CODE = '10'
 13258         MOVE ER-8060            TO EMI-ERROR
 13259         GO TO 5300-BAD-EXIT.
 13260
 13261     IF DM-RETURN-CODE = '11'
 13262         MOVE ER-8061            TO EMI-ERROR
 13263         GO TO 5300-BAD-EXIT.
 13264
 13265     IF DM-RETURN-CODE = '12'
 13266         MOVE ER-8062            TO EMI-ERROR
 13267         GO TO 5300-BAD-EXIT.
 13268
 13269     IF DM-RETURN-CODE = '13'
 13270         MOVE ER-8063            TO EMI-ERROR
 13271         GO TO 5300-BAD-EXIT.
 13272
 13273     IF DM-RETURN-CODE = '14'
 13274         MOVE ER-8064            TO EMI-ERROR
 13275         GO TO 5300-BAD-EXIT.
 13276
 13277     IF DM-RETURN-CODE = '15'
 13278         MOVE ER-8065            TO EMI-ERROR
 13279         GO TO 5300-BAD-EXIT.
 13280
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 259
* EL156.cbl
 13281     IF DM-RETURN-CODE = '16'
 13282         MOVE ER-8154            TO EMI-ERROR
 13283         GO TO 5300-BAD-EXIT.
 13284
 13285     IF DM-RETURN-CODE = '17'
 13286         MOVE ER-8155            TO EMI-ERROR
 13287         GO TO 5300-BAD-EXIT.
 13288
 13289     IF DM-RETURN-CODE = 'N1'
 13290         MOVE ER-8152            TO EMI-ERROR
 13291         GO TO 5300-BAD-EXIT.
 13292
 13293     IF DM-RETURN-CODE = 'E1'
 13294         MOVE ER-8153            TO EMI-ERROR
 13295         GO TO 5300-BAD-EXIT.
 13296
 13297     MOVE ER-8066            TO EMI-ERROR.
 13298     GO TO 5300-BAD-EXIT.
 13299
 13300 5300-NOTE-NOT-FOUND.
 13301
 13302     MOVE ER-0954                TO EMI-ERROR.
 13303     GO TO 5300-BAD-EXIT.
 13304
 13305 5300-BAD-EXIT.
 13306
 13307* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 13308*    MOVE '6"R                   !   #00012623' TO DFHEIV0
 13309     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 13310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13311     MOVE X'2020233030303132363233' TO DFHEIV0(25:11)
 13312     CALL 'kxdfhei1' USING DFHEIV0
 13313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13314
 13315     IF MAP-NAME = 'EL156A'
 13316         MOVE -1             TO ENTERPFL
 13317       ELSE
 13318         MOVE LOW-VALUES     TO EL156BI
 13319         MOVE -1             TO ENTPFBL.
 13320
 13321     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13322     GO TO 8200-SEND-DATAONLY.
 13323
 13324 5300-EXIT.
 13325     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 260
* EL156.cbl
 13327 5350-FORMAT-LAST-NAME-1ST.
 13328*****************************************************************
 13329*             M O V E   N A M E   R O U T I N E                 *
 13330*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13331*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13332*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13333*                  FIELD                   VALUE                *
 13334*           W-NAME-LAST    (CL15)      SMITH                    *
 13335*           W-NAME-FIRST   (CL15)      JOHN                     *
 13336*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 13337*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13338*     CONTAIN                                                   *
 13339*                SMITH, JOHN ALLEN                              *
 13340*     OR                                                        *
 13341*                SMITH, JOHN A.                                 *
 13342*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13343*     COPYBOOK, ELCNWA.                                         *
 13344*****************************************************************.
 13345
 13346     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 13347     MOVE ZERO                   TO  WS-NAME-SW.
 13348     SET NWA-INDEX               TO +1.
 13349
 13350     IF W-NAME-LAST   = SPACES AND
 13351        W-NAME-MIDDLE = SPACES
 13352         MOVE +1                 TO WS-NAME-SW.
 13353
 13354     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13355     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13356
 13357     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13358     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13359
 13360     SET NWA-INDEX UP BY +1.
 13361
 13362     IF W-NAME-MIDDLE NOT = SPACES
 13363         IF W-NAME-MIDDLE-2 = SPACES
 13364             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13365             SET NWA-INDEX UP BY +1
 13366             MOVE '.'            TO WS-NW (NWA-INDEX)
 13367             SET NWA-INDEX UP BY +2
 13368         ELSE
 13369             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13370             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13371
 13372 5350-EXIT.
 13373     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 261
* EL156.cbl
 13375 5360-MOVE-NAME.
 13376
 13377     IF WS-NAME-SW > +1
 13378         GO TO 5360-EXIT.
 13379
 13380     IF WS-NAME-WORK2 = SPACES
 13381         GO TO 5360-EXIT.
 13382
 13383     SET NWA-INDEX2            TO +1.
 13384     SET NWA-INDEX3            TO +2.
 13385
 13386 5360-MOVE-NAME-CYCLE.
 13387
 13388     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 13389
 13390     IF NWA-INDEX < +30
 13391         SET NWA-INDEX UP BY +1
 13392     ELSE
 13393         ADD +2                TO  WS-NAME-SW
 13394         GO TO 5360-EXIT.
 13395
 13396     IF NWA-INDEX2 < +20
 13397         SET NWA-INDEX3 UP BY +1
 13398         SET NWA-INDEX2 UP BY +1.
 13399
 13400     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 13401        WS-NW2 (NWA-INDEX3) = SPACES
 13402         IF WS-NAME-SW = ZERO
 13403             MOVE ','            TO  WS-NW (NWA-INDEX)
 13404             SET NWA-INDEX UP BY +2
 13405             MOVE +1             TO  WS-NAME-SW
 13406             GO TO 5360-EXIT
 13407         ELSE
 13408             GO TO 5360-EXIT.
 13409
 13410     GO TO 5360-MOVE-NAME-CYCLE.
 13411
 13412 5360-EXIT.
 13413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 262
* EL156.cbl
 13415 6000-BUILD-SCREEN-B.
 13416     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 13417     MOVE PI-CARRIER             TO MSTR-CARRIER.
 13418     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 13419     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 13420
 13421     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 13422
 13423 6050-BUILD-SCREEN.
 13424     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 13425     MOVE LOW-VALUES             TO EL156BI.
 13426     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13427
 13428     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13429
 13430     IF PI-PAYEE-TYPE = 'I'
 13431        GO TO 6060-READ-TRAILER.
 13432
 13433     IF PI-PAYEE-TYPE = 'B'
 13434        ADD +10                  TO TRLR-SEQ-NO
 13435        GO TO 6060-READ-TRAILER.
 13436
 13437     IF PI-PAYEE-TYPE = 'A'
 13438        ADD +20                  TO TRLR-SEQ-NO
 13439        GO TO 6060-READ-TRAILER.
 13440
 13441     IF PI-PAYEE-TYPE = 'O'
 13442        ADD +50                  TO TRLR-SEQ-NO
 13443        GO TO 6060-READ-TRAILER.
 13444
 13445     IF PI-PAYEE-TYPE = 'Q'
 13446        ADD +60                  TO TRLR-SEQ-NO
 13447        GO TO 6060-READ-TRAILER.
 13448
 13449     IF PI-PAYEE-TYPE = 'P'
 13450        ADD +30                  TO TRLR-SEQ-NO
 13451        GO TO 6060-READ-TRAILER.
 13452
 13453     IF PI-PAYEE-TYPE = 'E'
 13454        ADD +40                  TO TRLR-SEQ-NO.
 13455
 13456 6060-READ-TRAILER.
 13457
 13458     IF PI-PAYEE-TYPE    = 'A' AND
 13459        PI-PAYEE-SEQ-NUM = 0
 13460          GO TO 6061-READ-ACCOUNT.
 13461
 13462     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 13463        (PI-PAYEE-TYPE    = 'B')             AND
 13464        (PI-PAYEE-SEQ-NUM = 9)
 13465          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13466          IF BENE-FOUND-SW = 'N'
 13467            GO TO 6065-NOT-FOUND
 13468          ELSE
 13469            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13470            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13471            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13472*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 263
* EL156.cbl
 13473            STRING BE-CITY ' ' BE-STATE
 13474               DELIMITED BY '  ' INTO CITYSTBO
 13475            END-STRING
 13476            MOVE BE-ZIP-CODE       TO ZIPBO
 13477            GO TO 6061-READ-ACCOUNT.
 13478
 13479     IF PI-PAYEE-TYPE    = 'B' AND
 13480        PI-PAYEE-SEQ-NUM = 0
 13481          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13482          IF BENE-FOUND-SW = 'N'
 13483            GO TO 6065-NOT-FOUND
 13484          ELSE
 13485            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13486            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13487            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13488*           MOVE BE-CITY-STATE     TO CITYSTBO
 13489            STRING BE-CITY ' ' BE-STATE
 13490               DELIMITED BY '  ' INTO CITYSTBO
 13491            END-STRING
 13492            MOVE BE-ZIP-CODE       TO ZIPBO
 13493            GO TO 6061-READ-ACCOUNT.
 13494
 13495
 13496* EXEC CICS HANDLE CONDITION
 13497*         NOTFND(6065-NOT-FOUND)
 13498*     END-EXEC.
 13499*    MOVE '"$I                   ! / #00012804' TO DFHEIV0
 13500     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13502     MOVE X'2F20233030303132383034' TO DFHEIV0(25:11)
 13503     CALL 'kxdfhei1' USING DFHEIV0
 13504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13505
 13506
 13507     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13508
 13509     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 13510     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 13511     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 13512     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 13513*    MOVE AT-CITY-STATE          TO CITYSTBO.
 13514     STRING AT-CITY ' ' AT-STATE
 13515        DELIMITED BY '  ' INTO CITYSTBO
 13516     END-STRING
 13517     MOVE AT-ZIP-CODE            TO ZIPBO.
 13518
 13519 6061-READ-ACCOUNT.
 13520
 13521* EXEC CICS HANDLE CONDITION
 13522*         NOTFND(6068-ACCT-NOT-FND)
 13523*     END-EXEC.
 13524*    MOVE '"$I                   ! 0 #00012821' TO DFHEIV0
 13525     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13527     MOVE X'3020233030303132383231' TO DFHEIV0(25:11)
 13528     CALL 'kxdfhei1' USING DFHEIV0
 13529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13530
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 264
* EL156.cbl
 13531
 13532
 13533* EXEC CICS READ
 13534*         DATASET('ERACCT')
 13535*         SET    (ADDRESS OF ACCOUNT-MASTER)
 13536*         RIDFLD (PI-ACCT-KEY)
 13537*     END-EXEC.
 13538     MOVE 'ERACCT' TO DFHEIV1
 13539*    MOVE '&"S        E          (   #00012825' TO DFHEIV0
 13540     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13542     MOVE X'2020233030303132383235' TO DFHEIV0(25:11)
 13543     CALL 'kxdfhei1' USING DFHEIV0,
 13544           DFHEIV1,
 13545           DFHEIV20,
 13546           DFHEIV99,
 13547           PI-ACCT-KEY,
 13548           DFHEIV99,
 13549           DFHEIV99,
 13550           DFHEIV99
 13551     SET ADDRESS OF ACCOUNT-MASTER TO
 13552         DFHEIV20
 13553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13554
 13555
 13556     MOVE AM-CARRIER             TO ACARRBO.
 13557     MOVE AM-GROUPING            TO GROUPBO.
 13558     MOVE AM-STATE               TO STATEBO.
 13559     MOVE AM-ACCOUNT             TO ACCTBO.
 13560     MOVE AM-NAME                TO ACCTNMBO.
 13561
 13562     IF PI-PAYEE-TYPE = 'A' AND
 13563        PI-PAYEE-SEQ-NUM = 0
 13564          MOVE AM-NAME             TO NAMEBO
 13565                                      PI-PAYEE-NAME
 13566          MOVE AM-ADDRS            TO ADDR1BO
 13567          MOVE SPACES              TO ADDR2BO
 13568*         MOVE AM-CITY             TO CITYSTBO
 13569          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13570             DELIMITED BY '  ' INTO CITYSTBO
 13571          END-STRING
 13572          MOVE AM-ZIP-PRIME        TO WS-ZIP
 13573          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 13574          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 13575          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 13576
 13577     IF CITYSTBO EQUAL SPACES
 13578         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13579         GO TO 6070-FORMAT-DATA
 13580     END-IF.
 13581
 13582     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 13583     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 13584     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 13585     PERFORM VARYING WS-SUB FROM 30 BY -1
 13586          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 13587        IF WS-END-SUB = 0  AND
 13588           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES OR '.')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 265
* EL156.cbl
 13589            CONTINUE
 13590        ELSE
 13591            IF WS-END-SUB = 0
 13592                MOVE WS-SUB TO WS-END-SUB
 13593            ELSE
 13594                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 13595                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 13596                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13597                END-IF
 13598            END-IF
 13599        END-IF
 13600        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 13601            COMPUTE WS-BEG-SUB = WS-SUB + 1
 13602            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13603        END-IF
 13604     END-PERFORM.
 13605
 13606     IF WS-BEG-SUB > 0
 13607         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 13608         IF WS-STATE-LENGTH = 2
 13609             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 13610                  TO PI-CHECK-STATE-FOR-AK
 13611         ELSE
 13612             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 13613                'ALASKA'
 13614                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 13615             ELSE
 13616                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13617             END-IF
 13618         END-IF
 13619     ELSE
 13620         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13621     END-IF.
 13622
 13623     GO TO 6070-FORMAT-DATA.
 13624
 13625 6065-NOT-FOUND.
 13626     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 13627     GO TO 6061-READ-ACCOUNT.
 13628
 13629 6068-ACCT-NOT-FND.
 13630     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 13631
 13632 6070-FORMAT-DATA.
 13633     IF PI-HOLDTIL = ZEROS
 13634        MOVE SAVE-DATE           TO PAYDTBI
 13635       ELSE
 13636        MOVE PI-HOLDTIL          TO PAYDTBO
 13637        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 13638
 13639     MOVE PI-PROOF-DATE          TO PROOFDBO.
 13640     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 13641
 13642     IF EIBAID = DFHPF3 OR DFHPF4
 13643        NEXT SENTENCE
 13644     ELSE
 13645       GO TO 6071-CONTINUE.
 13646
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 266
* EL156.cbl
 13647     MOVE PI-EPYFROM          TO PYFROMBO.
 13648     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 13649
 13650     IF NOT PI-USES-PAID-TO
 13651        MOVE PI-EPYTHRU          TO PYTHRUBO
 13652        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 13653     ELSE
 13654        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 13655        MOVE '4'              TO DC-OPTION-CODE
 13656        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13657        IF NO-CONVERSION-ERROR
 13658           MOVE +1            TO DC-ELAPSED-DAYS
 13659           MOVE +0            TO DC-ELAPSED-MONTHS
 13660           MOVE '6'           TO DC-OPTION-CODE
 13661           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13662           IF NO-CONVERSION-ERROR
 13663              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13664
 13665     MOVE PI-EDAYS            TO DAYSBO.
 13666     MOVE PI-EPYAMT           TO PAYAMTBO.
 13667     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13668        IF PI-INT-AMT > ZEROS
 13669           MOVE PI-INT-AMT       TO INTAMTBO
 13670        END-IF
 13671     END-IF
 13672     GO TO 6072-SET-TYPE.
 13673
 13674 6071-CONTINUE.
 13675
 13676     IF PI-CPYFROM NOT = LOW-VALUES
 13677        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 13678        MOVE SPACES              TO DC-OPTION-CODE
 13679        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13680        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 13681
 13682     IF PI-CPYTHRU NOT = LOW-VALUES
 13683        IF NOT PI-USES-PAID-TO
 13684           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13685           MOVE SPACES             TO DC-OPTION-CODE
 13686           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13687           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 13688        ELSE
 13689           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13690           MOVE '6'                TO DC-OPTION-CODE
 13691           MOVE +1                 TO DC-ELAPSED-DAYS
 13692           MOVE +0                 TO DC-ELAPSED-MONTHS
 13693           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13694           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13695
 13696     MOVE PI-CDAYS               TO DAYSBO.
 13697     MOVE PI-CPYAMT              TO PAYAMTBO.
 13698     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13699        IF PI-INT-AMT > ZEROS
 13700           MOVE PI-INT-AMT       TO INTAMTBO
 13701        END-IF
 13702     END-IF
 13703     .
 13704 6072-SET-TYPE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 267
* EL156.cbl
 13705     IF PI-PMTTYPE = '1'
 13706        MOVE 'PARTIAL'           TO PAYTYPBO.
 13707
 13708     IF PI-PMTTYPE = '2'
 13709        MOVE 'FINAL'             TO PAYTYPBO.
 13710
 13711     IF PI-PMTTYPE = '3'
 13712        MOVE 'LUMP SUM'          TO PAYTYPBO.
 13713
 13714     IF PI-PMTTYPE = '4'
 13715        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 13716
 13717     IF PI-PMTTYPE = '5'
 13718        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 13719
 13720     IF PI-PMTTYPE = '6'
 13721        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 13722
 13723     IF PI-PROV-PMT
 13724        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 13725
 13726     IF PI-ECHECKNO NOT = SPACES
 13727        MOVE PI-ECHECKNO         TO CKNUMBO
 13728     ELSE
 13729        MOVE PI-CCHECKNO         TO CKNUMBO.
 13730
 13731     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 13732        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 13733        MOVE +91                 TO  TRLR-SEQ-NO
 13734
 13735* EXEC CICS READ
 13736*           DATASET  ('ELTRLR')
 13737*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13738*           RIDFLD   (ELTRLR-KEY)
 13739*           RESP     (WS-RESPONSE)
 13740*       END-EXEC
 13741     MOVE 'ELTRLR' TO DFHEIV1
 13742*    MOVE '&"S        E          (  N#00013009' TO DFHEIV0
 13743     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13744     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13745     MOVE X'204E233030303133303039' TO DFHEIV0(25:11)
 13746     CALL 'kxdfhei1' USING DFHEIV0,
 13747           DFHEIV1,
 13748           DFHEIV20,
 13749           DFHEIV99,
 13750           ELTRLR-KEY,
 13751           DFHEIV99,
 13752           DFHEIV99,
 13753           DFHEIV99
 13754     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13755         DFHEIV20
 13756     MOVE EIBRESP  TO WS-RESPONSE
 13757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13758
 13759        IF WS-RESP-NORMAL
 13760           MOVE AT-INFO-LINE-1   TO  LOANNBO
 13761        ELSE
 13762           MOVE SPACES           TO  LOANNBO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 268
* EL156.cbl
 13763        END-IF
 13764     END-IF
 13765
 13766*       MOVE PI-LOAN-NO          TO LOANNBO
 13767
 13768     IF CKNUMBO = SPACES
 13769         MOVE SPACES             TO CKNUMHDO.
 13770
 13771     MOVE CL-CLAIM-NO            TO CLMNOBO.
 13772     MOVE CL-CARRIER             TO CARRBO.
 13773     MOVE CL-CERT-PRIME          TO CERTNOBO.
 13774     MOVE CL-CERT-SFX            TO SUFXBO.
 13775
 13776     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13777        EVALUATE CL-CLAIM-TYPE
 13778           WHEN 'I'
 13779              MOVE '  IU  '      TO CLMTYPBO
 13780           WHEN 'G'
 13781              MOVE ' GAP  '      TO CLMTYPBO
 13782           WHEN OTHER
 13783              MOVE PI-AH-OVERRIDE-L6
 13784                                 TO CLMTYPBO
 13785        END-EVALUATE
 13786        MOVE ZEROS               TO UNDISBO
 13787*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 13788        IF PI-PMTTYPE = '5' OR '6'
 13789           GO TO 6073-GET-NOTIFY-DATA
 13790        ELSE
 13791           MOVE PI-DAILY-RATE    TO RATEBO
 13792           GO TO 6073-GET-NOTIFY-DATA.
 13793
 13794     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 13795
 13796     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 13797        MOVE ZEROS               TO UNDISBO
 13798     ELSE
 13799        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 13800
 13801 6073-GET-NOTIFY-DATA.
 13802
 13803     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 13804
 13805     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 13806         MOVE SPACES             TO  NAMEB2O
 13807                                     ADDR1B2O
 13808                                     ADDR2B2O
 13809                                     CITYST2O
 13810                                     AGTHDGO
 13811         MOVE ZEROS              TO  ZIPB2O
 13812         GO TO 6080-SET-INCURRED.
 13813
 13814     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 13815     MOVE +29                    TO  TRLR-SEQ-NO.
 13816
 13817
 13818* EXEC CICS HANDLE CONDITION
 13819*        NOTFND   (6074-GET-COMP-DATA)
 13820*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 269
* EL156.cbl
 13821*    MOVE '"$I                   ! 1 #00013074' TO DFHEIV0
 13822     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13824     MOVE X'3120233030303133303734' TO DFHEIV0(25:11)
 13825     CALL 'kxdfhei1' USING DFHEIV0
 13826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13827
 13828
 13829     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13830
 13831     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 13832     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 13833     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 13834*    MOVE AT-CITY-STATE          TO  CITYST2O.
 13835     STRING AT-CITY ' ' AT-STATE
 13836        DELIMITED BY '  ' INTO CITYST2O
 13837     END-STRING
 13838     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 13839     GO TO 6080-SET-INCURRED.
 13840
 13841 6074-GET-COMP-DATA.
 13842
 13843     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 13844         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 13845
 13846     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 13847         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 13848                                         ADDR1B2O
 13849                                         ADDR2B2O
 13850                                         CITYST2O
 13851         MOVE ZEROS                  TO  ZIPB2O
 13852         GO TO 6080-SET-INCURRED.
 13853
 13854     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 13855     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 13856     MOVE AM-CARRIER             TO  COMP-CARRIER.
 13857     MOVE AM-GROUPING            TO  COMP-GROUP.
 13858     MOVE 'A'                    TO  COMP-TYPE.
 13859     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 13860                                 TO  COMP-FIN-RESP.
 13861
 13862     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 13863         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 13864                                       'G' OR 'B'
 13865             MOVE 'G'            TO  COMP-TYPE
 13866             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 13867         ELSE
 13868             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 13869                                 TO  COMP-ACCOUNT
 13870     ELSE
 13871         MOVE 'G'                TO  COMP-TYPE
 13872         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 13873
 13874     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 13875
 13876     IF COMP-REC-FOUND
 13877         MOVE CO-ACCT-NAME       TO  NAMEB2O
 13878         MOVE CO-ADDR-1          TO  ADDR1B2O
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 270
* EL156.cbl
 13879         MOVE CO-ADDR-2          TO  ADDR2B2O
 13880*        MOVE CO-ADDR-3          TO  CITYST2O
 13881         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13882            DELIMITED BY '  ' INTO CITYST2O
 13883         END-STRING
 13884         MOVE CO-ZIP             TO  ZIPB2O
 13885     ELSE
 13886         MOVE 'NO COMP ADDRESS AVAILABLE'
 13887                                 TO  NAMEB2O
 13888                                     ADDR1B2O
 13889                                     ADDR2B2O
 13890                                     CITYST2O
 13891         MOVE ZEROS               TO ZIPB2O.
 13892
 13893 6080-SET-INCURRED.
 13894     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13895     MOVE SPACES                 TO DC-OPTION-CODE.
 13896     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13897     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 13898     MOVE PI-PROCESSOR-ID        TO BYBO.
 13899     MOVE MAP-NAMEB              TO MAP-NAME.
 13900     MOVE 'C'                    TO PI-PASS-SW.
 13901     MOVE EIBAID                 TO PI-PFKEY-USED.
 13902     MOVE -1                     TO ENTPFBL.
 13903     GO TO 8100-SEND-INITIAL-MAP.
 13904
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 271
* EL156.cbl
 13906 6100-BUILD-PAYMENT-TRAILER.
 13907
 13908     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 13909       (PI-COMPANY-ID = 'CID' OR 'AHL')
 13910         GO TO 6105-STATE-CHECK-NUMBER
 13911     END-IF.
 13912
 13913     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13914     MOVE '6'                    TO CNTL-REC-TYPE.
 13915
 13916     IF CONTROL-IS-ACTUAL-CARRIER
 13917         MOVE PI-CARRIER         TO WS-CARR
 13918     ELSE
 13919         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 13920
 13921     IF PI-COMPANY-ID = 'FIA'
 13922         MOVE PI-CARRIER         TO  WS-CARR.
 13923
 13924     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 13925     MOVE 0                      TO CNTL-SEQ-NO.
 13926     MOVE 'CARR'                 TO FILE-SWITCH.
 13927
 13928     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 13929
 13930     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13931         IF PI-OFFLINE     = 'Y' AND
 13932            PI-ECHECKNO-CR = 'CR'
 13933              GO TO 6110-READ-CONTROL
 13934         ELSE
 13935            IF PI-CASH = 'N'
 13936                GO TO 6110-READ-CONTROL.
 13937
 13938     IF CHECK-NO-MANUAL    OR
 13939        CHECK-NO-AT-PRINT  OR
 13940        PI-OFFLINE = 'Y'
 13941          GO TO 6130-BUILD-TRAILER.
 13942
 13943     IF PI-COMPANY-ID = 'FIA'
 13944         NEXT SENTENCE
 13945     ELSE
 13946         IF NOT CONTROL-IS-ACTUAL-CARRIER
 13947             GO TO 6110-READ-CONTROL.
 13948
 13949     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13950
 13951     IF CHECK-CNT-RESET-VALUE
 13952        MOVE +1                  TO CF-CHECK-COUNTER
 13953     ELSE
 13954        ADD +1                   TO CF-CHECK-COUNTER.
 13955
 13956     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 13957
 13958     IF CHECK-NO-CARR-SEQ
 13959        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 13960
 13961     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 13962     GO TO 6120-REWRITE.
 13963
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 272
* EL156.cbl
 13964 6105-STATE-CHECK-NUMBER.
 13965     IF CHECK-NO-MANUAL    OR
 13966        CHECK-NO-AT-PRINT  OR
 13967        PI-OFFLINE = 'Y'
 13968           GO TO 6130-BUILD-TRAILER
 13969     END-IF.
 13970
 13971     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 13972     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 13973     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 13974     MOVE '3'                TO CNTL-REC-TYPE.
 13975     MOVE +0                 TO CNTL-SEQ-NO.
 13976     MOVE 'STAT'             TO FILE-SWITCH.
 13977     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13978
 13979     IF CF-ST-CHECK-CNT-RESET
 13980         MOVE +1             TO CF-ST-CHECK-COUNTER
 13981     ELSE
 13982         ADD +1              TO CF-ST-CHECK-COUNTER
 13983     END-IF.
 13984
 13985     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 13986     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 13987     GO TO 6120-REWRITE.
 13988
 13989 6110-READ-CONTROL.
 13990     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13991     MOVE '1'                    TO CNTL-REC-TYPE.
 13992     MOVE SPACES                 TO CNTL-ACCESS.
 13993     MOVE 0                      TO CNTL-SEQ-NO.
 13994
 13995     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13996
 13997     IF CO-CHECK-COUNT-RESET
 13998        MOVE +1                  TO CF-CO-CHECK-COUNTER
 13999     ELSE
 14000        ADD +1                   TO CF-CO-CHECK-COUNTER.
 14001
 14002     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 14003
 14004     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14005         IF PI-OFFLINE     = 'Y'  AND
 14006            PI-ECHECKNO-CR = 'CR'
 14007              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 14008              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14009              MOVE AL-UANON           TO CHECKNOA
 14010              GO TO 6120-REWRITE
 14011         ELSE
 14012         IF PI-CASH = 'N'
 14013             MOVE 'N'                TO PI-ECHECKNO-N
 14014             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 14015             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 14016             MOVE AL-UANON           TO CHECKNOA
 14017             GO TO 6120-REWRITE.
 14018
 14019     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 14020
 14021 6120-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 273
* EL156.cbl
 14022
 14023* EXEC CICS REWRITE
 14024*         DATASET('ELCNTL')
 14025*         FROM(CONTROL-FILE)
 14026*     END-EXEC.
 14027     MOVE LENGTH OF
 14028      CONTROL-FILE
 14029       TO DFHEIV11
 14030     MOVE 'ELCNTL' TO DFHEIV1
 14031*    MOVE '&& L                  %   #00013271' TO DFHEIV0
 14032     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14033     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14034     MOVE X'2020233030303133323731' TO DFHEIV0(25:11)
 14035     CALL 'kxdfhei1' USING DFHEIV0,
 14036           DFHEIV1,
 14037           CONTROL-FILE,
 14038           DFHEIV11,
 14039           DFHEIV99
 14040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14041
 14042
 14043     MOVE 'Y'                    TO PI-CK-ASSIGN.
 14044
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 274
* EL156.cbl
 14046 6130-BUILD-TRAILER.
 14047
 14048
 14049* EXEC CICS GETMAIN
 14050*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14051*         LENGTH    (200)
 14052*         INITIMG   (GETMAIN-SPACE)
 14053*     END-EXEC.
 14054     MOVE 200
 14055       TO DFHEIV11
 14056*    MOVE ',"IL                  $   #00013281' TO DFHEIV0
 14057     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14058     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14059     MOVE X'2020233030303133323831' TO DFHEIV0(25:11)
 14060     CALL 'kxdfhei1' USING DFHEIV0,
 14061           DFHEIV20,
 14062           DFHEIV11,
 14063           GETMAIN-SPACE
 14064     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14065         DFHEIV20
 14066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14067
 14068
 14069     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 14070                                    AT-PREV-PAID-THRU-DT.
 14071     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 14072     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 14073     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14074     MOVE 'AT'                   TO AT-RECORD-ID.
 14075     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14076
 14077     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14078        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 14079           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 14080     ELSE
 14081           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 14082           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 14083
 14084     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 14085         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 14086             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 14087             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 14088           ELSE
 14089             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 14090             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 14091
 14092     MOVE '2'                    TO AT-TRAILER-TYPE.
 14093     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14094                                    AT-PAYMENT-LAST-MAINT-DT.
 14095     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14096                                    AT-PAYMENT-LAST-UPDATED-BY.
 14097     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14098     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 14099     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 14100     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 14101
 14102     IF PI-PMT-APPROVED
 14103        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 275
* EL156.cbl
 14104           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 14105
 14106     IF PI-PFKEY-USED = DFHPF5
 14107        GO TO 6140-PF5-ENTERED.
 14108
 14109     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 14110     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 14111
 14112     IF PI-AIG-SPECIAL-BENEFIT
 14113         IF WS-1ST-SPECIAL-PMT
 14114             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 14115             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 14116                                        AT-AMOUNT-PAID
 14117         ELSE
 14118             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14119
 14120     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 14121
 14122     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 14123     MOVE '4'                    TO DC-OPTION-CODE.
 14124     PERFORM 9700-LINK-DATE-CONVERT.
 14125
 14126     IF DATE-CONVERSION-ERROR
 14127        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 14128     ELSE
 14129        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 14130
 14131     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14132     MOVE '4'                    TO DC-OPTION-CODE.
 14133     PERFORM 9700-LINK-DATE-CONVERT.
 14134
 14135     IF DATE-CONVERSION-ERROR
 14136        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 14137     ELSE
 14138        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 14139
 14140     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 14141     GO TO 6150-FINISH-MOVE.
 14142
 14143 6140-PF5-ENTERED.
 14144     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 14145     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 14146
 14147     IF PI-AIG-SPECIAL-BENEFIT
 14148         IF WS-1ST-SPECIAL-PMT
 14149             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 14150             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 14151                                        AT-AMOUNT-PAID
 14152         ELSE
 14153             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14154
 14155     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 14156     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 14157     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 14158
 14159 6150-FINISH-MOVE.
 14160
 14161     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 276
* EL156.cbl
 14162         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 14163     ELSE
 14164         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 14165
 14166     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 14167     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 14168
 14169     MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 14170     MOVE PI-CASH                TO AT-CASH-PAYMENT.
 14171
 14172     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14173         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 14174
 14175     IF PI-OFFLINE = 'N'
 14176        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 14177        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 14178     ELSE
 14179        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 14180        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 14181
 14182     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 14183
 14184     IF WS-2ND-SPECIAL-PMT
 14185         MOVE 'Y'                TO AT-CASH-PAYMENT
 14186         MOVE SPACES             TO AT-CHECK-NO
 14187         MOVE '3'                TO AT-PAYMENT-ORIGIN
 14188         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 14189         MOVE 'U'                TO AT-AIG-UNEMP-IND
 14190         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 14191
 14192     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 14193                                    AT-TO-BE-WRITTEN-DT.
 14194
 14195     IF PI-HOLDTIL NOT = ZEROS
 14196        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 14197        MOVE '4'                 TO DC-OPTION-CODE
 14198        PERFORM 9700-LINK-DATE-CONVERT
 14199        IF PI-OFFLINE = 'N'
 14200           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 14201        ELSE
 14202           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 14203
 14204     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 14205     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 14206                                    AT-CHECK-QUE-SEQUENCE.
 14207
 14208     IF PI-PFKEY-USED = DFHPF4
 14209        MOVE '1'                 TO AT-FORCE-CONTROL.
 14210
 14211     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 14212        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 14213        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 14214        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 14215
 14216     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 14217                                    AT-VOID-SELECT-DT
 14218                                    AT-VOID-ACCEPT-DT
 14219                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 277
* EL156.cbl
 14220     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14221        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 14222        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 14223        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 14224        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 14225     ELSE
 14226        MOVE ZEROS               TO AT-DAILY-RATE
 14227                                    AT-ELIMINATION-DAYS
 14228        MOVE SPACES              TO AT-BENEFIT-TYPE
 14229     END-IF
 14230     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 14231     MOVE '4'                    TO DC-OPTION-CODE.
 14232     PERFORM 9700-LINK-DATE-CONVERT.
 14233     IF DATE-CONVERSION-ERROR
 14234         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 14235     ELSE
 14236         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 14237     END-IF.
 14238     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 14239*******************************************************
 14240     IF NOT PI-PMT-GRADUATED
 14241         GO TO 6170-WRITE.
 14242
 14243     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14244     MOVE '1'                    TO CNTL-REC-TYPE.
 14245     MOVE SPACES                 TO CNTL-ACCESS.
 14246     MOVE +0                     TO CNTL-SEQ-NO.
 14247     MOVE 'COMP'                 TO FILE-SWITCH.
 14248
 14249     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14250
 14251     IF PAID-FOR-LIFE
 14252         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 14253             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14254                                     WS-PMT-APPROVAL-SW
 14255             GO TO 6170-WRITE.
 14256
 14257*05999      IF PAID-FOR-AH
 14258     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14259         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 14260             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14261                                     WS-PMT-APPROVAL-SW
 14262             GO TO 6170-WRITE.
 14263
 14264     MOVE '1'                    TO AT-APPROVED-LEVEL.
 14265
 14266******A&H Limits are set as a monthly payment.  Calculate the mont
 14267******equivalent of the amount paid today
 14268     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 14269        PI-SAVE-ODD-DAYS-OVER > 0
 14270           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 14271                               / 30) + PI-SAVE-ELAPSED-MONTHS
 14272           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 14273                                  WS-CALC-PMT-MONTHS
 14274     ELSE
 14275           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 14276     END-IF.
 14277*06007      IF ((PAID-FOR-AH) AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 278
* EL156.cbl
 14278     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14279*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14280        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 14281              OR
 14282        ((PAID-FOR-LIFE) AND
 14283        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14284            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14285       ELSE
 14286*06014      IF ((PAID-FOR-AH)  AND
 14287         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14288*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14289           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 14290              OR
 14291        ((PAID-FOR-LIFE) AND
 14292        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14293            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14294         ELSE
 14295*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 14296           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14297               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 14298              OR
 14299          ((PAID-FOR-LIFE) AND
 14300          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 14301            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14302       ELSE
 14303            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14304
 14305     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14306        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 14307        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 14308            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14309        END-IF
 14310     ELSE
 14311     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14312        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 14313        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 14314            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14315        END-IF
 14316     ELSE
 14317     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14318        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 14319        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 14320            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14321        END-IF
 14322     ELSE
 14323     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14324            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14325
 14326     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 14327
 14328     IF NOT PI-PMT-GRADUATED
 14329         GO TO 6170-WRITE.
 14330
 14331
 14332* EXEC CICS HANDLE CONDITION
 14333*        NOTFND   (6170-WRITE)
 14334*    END-EXEC.
 14335*    MOVE '"$I                   ! 2 #00013549' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 279
* EL156.cbl
 14336     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14337     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14338     MOVE X'3220233030303133353439' TO DFHEIV0(25:11)
 14339     CALL 'kxdfhei1' USING DFHEIV0
 14340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14341
 14342
 14343     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14344     MOVE '2'                    TO CNTL-REC-TYPE.
 14345     MOVE +0                     TO CNTL-SEQ-NO.
 14346     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 14347
 14348
 14349* EXEC CICS READ
 14350*         DATASET  ('ELCNTL')
 14351*         SET      (ADDRESS OF CONTROL-FILE)
 14352*         RIDFLD   (ELCNTL-KEY)
 14353*    END-EXEC.
 14354     MOVE 'ELCNTL' TO DFHEIV1
 14355*    MOVE '&"S        E          (   #00013558' TO DFHEIV0
 14356     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14357     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14358     MOVE X'2020233030303133353538' TO DFHEIV0(25:11)
 14359     CALL 'kxdfhei1' USING DFHEIV0,
 14360           DFHEIV1,
 14361           DFHEIV20,
 14362           DFHEIV99,
 14363           ELCNTL-KEY,
 14364           DFHEIV99,
 14365           DFHEIV99,
 14366           DFHEIV99
 14367     SET ADDRESS OF CONTROL-FILE TO
 14368         DFHEIV20
 14369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14370
 14371
 14372     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 14373
 14374     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 14375                         OR '4'
 14376         NEXT SENTENCE
 14377     ELSE
 14378         MOVE 'Y' TO WS-NEED-APPROVAL
 14379         GO TO 6170-WRITE.
 14380
 14381     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 14382         MOVE 'Y' TO WS-NEED-APPROVAL
 14383         IF WS-APPROVAL-LEVEL = '1'
 14384             MOVE '2'        TO  AT-APPROVED-LEVEL
 14385                            WS-SAVE-APPROVED-LEVEL
 14386             GO TO 6170-WRITE
 14387         ELSE
 14388             IF WS-APPROVAL-LEVEL = '2'
 14389                 MOVE '3'        TO  AT-APPROVED-LEVEL
 14390                                WS-SAVE-APPROVED-LEVEL
 14391                 GO TO 6170-WRITE
 14392             ELSE IF WS-APPROVAL-LEVEL = '3'
 14393                 MOVE '4'        TO  AT-APPROVED-LEVEL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 280
* EL156.cbl
 14394                                WS-SAVE-APPROVED-LEVEL
 14395                 GO TO 6170-WRITE.
 14396
 14397     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14398                             WS-PMT-APPROVAL-SW.
 14399     MOVE SPACES         TO  AT-APPROVED-LEVEL
 14400                             AT-APPROVAL-LEVEL-REQD.
 14401
 14402*******************************************************
 14403
 14404 6170-WRITE.
 14405
 14406     IF PI-COMPANY-ID = 'DMD'
 14407        IF PI-AT-EOB-CODES NOT = SPACES
 14408           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 14409           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 14410           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 14411           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 14412           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 14413
 14414
 14415* EXEC CICS HANDLE CONDITION
 14416*        DUPREC    (6180-DUPREC)
 14417*    END-EXEC.
 14418*    MOVE '"$%                   ! 3 #00013606' TO DFHEIV0
 14419     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14421     MOVE X'3320233030303133363036' TO DFHEIV0(25:11)
 14422     CALL 'kxdfhei1' USING DFHEIV0
 14423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14424
 14425
 14426
 14427* EXEC CICS WRITE
 14428*         DATASET       ('ELTRLR')
 14429*         FROM          (ACTIVITY-TRAILERS)
 14430*         RIDFLD        (AT-CONTROL-PRIMARY)
 14431*     END-EXEC.
 14432     MOVE LENGTH OF
 14433      ACTIVITY-TRAILERS
 14434       TO DFHEIV11
 14435     MOVE 'ELTRLR' TO DFHEIV1
 14436*    MOVE '&$ L                  ''   #00013610' TO DFHEIV0
 14437     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14438     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14439     MOVE X'2020233030303133363130' TO DFHEIV0(25:11)
 14440     CALL 'kxdfhei1' USING DFHEIV0,
 14441           DFHEIV1,
 14442           ACTIVITY-TRAILERS,
 14443           DFHEIV11,
 14444           AT-CONTROL-PRIMARY,
 14445           DFHEIV99,
 14446           DFHEIV99
 14447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14448
 14449
 14450     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14451        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 281
* EL156.cbl
 14452*06088           GO TO 6199-EXIT.
 14453           GO TO 6176-APPROVAL-NOTE.
 14454
 14455
 14456* EXEC CICS GETMAIN
 14457*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14458*         LENGTH    (200)
 14459*         INITIMG   (GETMAIN-SPACE)
 14460*     END-EXEC.
 14461     MOVE 200
 14462       TO DFHEIV11
 14463*    MOVE ',"IL                  $   #00013621' TO DFHEIV0
 14464     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14465     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14466     MOVE X'2020233030303133363231' TO DFHEIV0(25:11)
 14467     CALL 'kxdfhei1' USING DFHEIV0,
 14468           DFHEIV20,
 14469           DFHEIV11,
 14470           GETMAIN-SPACE
 14471     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14472         DFHEIV20
 14473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14474
 14475
 14476     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14477
 14478     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14479     MOVE 'AT'                   TO AT-RECORD-ID.
 14480     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14481     MOVE '6'                    TO AT-TRAILER-TYPE.
 14482     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14483                                    AT-GEN-INFO-LAST-MAINT-DT
 14484     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14485                                    AT-GEN-INFO-LAST-UPDATED-BY
 14486     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14487
 14488     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 14489     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 14490     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 14491
 14492     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 14493
 14494 6175-WRITE.
 14495
 14496
 14497* EXEC CICS HANDLE CONDITION
 14498*        DUPREC    (6190-DUPREC)
 14499*    END-EXEC.
 14500*    MOVE '"$%                   ! 4 #00013647' TO DFHEIV0
 14501     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14502     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14503     MOVE X'3420233030303133363437' TO DFHEIV0(25:11)
 14504     CALL 'kxdfhei1' USING DFHEIV0
 14505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14506
 14507
 14508
 14509* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 282
* EL156.cbl
 14510*         DATASET     ('ELTRLR')
 14511*         FROM        (ACTIVITY-TRAILERS)
 14512*         RIDFLD      (AT-CONTROL-PRIMARY)
 14513*     END-EXEC.
 14514     MOVE LENGTH OF
 14515      ACTIVITY-TRAILERS
 14516       TO DFHEIV11
 14517     MOVE 'ELTRLR' TO DFHEIV1
 14518*    MOVE '&$ L                  ''   #00013651' TO DFHEIV0
 14519     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14520     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14521     MOVE X'2020233030303133363531' TO DFHEIV0(25:11)
 14522     CALL 'kxdfhei1' USING DFHEIV0,
 14523           DFHEIV1,
 14524           ACTIVITY-TRAILERS,
 14525           DFHEIV11,
 14526           AT-CONTROL-PRIMARY,
 14527           DFHEIV99,
 14528           DFHEIV99
 14529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14530
 14531
 14532 6176-APPROVAL-NOTE.
 14533
 14534     IF NOT APPROVAL-NEEDED
 14535         GO TO 6199-EXIT.
 14536
 14537
 14538* EXEC CICS GETMAIN
 14539*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14540*        LENGTH    (200)
 14541*        INITIMG   (GETMAIN-SPACE)
 14542*    END-EXEC.
 14543     MOVE 200
 14544       TO DFHEIV11
 14545*    MOVE ',"IL                  $   #00013662' TO DFHEIV0
 14546     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14547     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14548     MOVE X'2020233030303133363632' TO DFHEIV0(25:11)
 14549     CALL 'kxdfhei1' USING DFHEIV0,
 14550           DFHEIV20,
 14551           DFHEIV11,
 14552           GETMAIN-SPACE
 14553     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14554         DFHEIV20
 14555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14556
 14557
 14558     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 14559
 14560     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 14561     MOVE 'AT'               TO AT-RECORD-ID
 14562     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 14563     MOVE '6'                TO AT-TRAILER-TYPE
 14564     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 14565                                AT-GEN-INFO-LAST-MAINT-DT
 14566     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 14567                                AT-GEN-INFO-LAST-UPDATED-BY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 283
* EL156.cbl
 14568     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 14569
 14570     MOVE WS-APPROV-NOTE     TO AT-INFO-LINE-1
 14571     MOVE SPACES             TO AT-INFO-LINE-2
 14572
 14573     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 14574 6177-WRITE.
 14575
 14576
 14577* EXEC CICS HANDLE CONDITION
 14578*        DUPREC    (6185-DUPREC)
 14579*    END-EXEC.
 14580*    MOVE '"$%                   ! 5 #00013686' TO DFHEIV0
 14581     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14582     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14583     MOVE X'3520233030303133363836' TO DFHEIV0(25:11)
 14584     CALL 'kxdfhei1' USING DFHEIV0
 14585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14586
 14587
 14588
 14589* EXEC CICS WRITE
 14590*         DATASET     ('ELTRLR')
 14591*         FROM        (ACTIVITY-TRAILERS)
 14592*         RIDFLD      (AT-CONTROL-PRIMARY)
 14593*     END-EXEC.
 14594     MOVE LENGTH OF
 14595      ACTIVITY-TRAILERS
 14596       TO DFHEIV11
 14597     MOVE 'ELTRLR' TO DFHEIV1
 14598*    MOVE '&$ L                  ''   #00013690' TO DFHEIV0
 14599     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14600     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14601     MOVE X'2020233030303133363930' TO DFHEIV0(25:11)
 14602     CALL 'kxdfhei1' USING DFHEIV0,
 14603           DFHEIV1,
 14604           ACTIVITY-TRAILERS,
 14605           DFHEIV11,
 14606           AT-CONTROL-PRIMARY,
 14607           DFHEIV99,
 14608           DFHEIV99
 14609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14610
 14611
 14612
 14613     GO TO 6199-EXIT.
 14614
 14615 6180-DUPREC.
 14616
 14617     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14618     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14619     GO TO 6170-WRITE.
 14620
 14621 6185-DUPREC.
 14622     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14623     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14624     GO TO 6177-WRITE.
 14625
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 284
* EL156.cbl
 14626 6190-DUPREC.
 14627     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14628     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14629     GO TO 6175-WRITE.
 14630
 14631 6199-EXIT.
 14632      EXIT.
 14633
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 285
* EL156.cbl
 14635 6200-UPDATE-CLAIM-MSTR.
 14636     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14637     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14638     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14639     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14640
 14641     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 14642
 14643     MOVE ZEROS                  TO W-INTEREST.
 14644
 14645     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 14646        IF (PI-OFFLINE = 'Y') OR
 14647           (PI-PMTTYPE = '7')
 14648           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14649                                 THRU 9870-EXIT
 14650        END-IF
 14651     END-IF
 14652     IF NOT ERROR-ON-OUTPUT
 14653        CONTINUE
 14654     ELSE
 14655
 14656* EXEC CICS REWRITE
 14657*          DATASET('ELMSTR')
 14658*          FROM(CLAIM-MASTER)
 14659*       END-EXEC
 14660     MOVE LENGTH OF
 14661      CLAIM-MASTER
 14662       TO DFHEIV11
 14663     MOVE 'ELMSTR' TO DFHEIV1
 14664*    MOVE '&& L                  %   #00013739' TO DFHEIV0
 14665     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14666     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14667     MOVE X'2020233030303133373339' TO DFHEIV0(25:11)
 14668     CALL 'kxdfhei1' USING DFHEIV0,
 14669           DFHEIV1,
 14670           CLAIM-MASTER,
 14671           DFHEIV11,
 14672           DFHEIV99
 14673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14674
 14675        MOVE -1                  TO ENTPFBL
 14676        MOVE AL-UANON            TO ENTPFBA
 14677        MOVE MAP-NAMEB           TO MAP-NAME
 14678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14679        GO TO 8200-SEND-DATAONLY
 14680     END-IF
 14681
 14682     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 14683
 14684     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 14685
 14686     IF PI-AIG-SPECIAL-BENEFIT
 14687         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 14688
 14689     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 14690
 14691     IF PI-SPECIAL-BEN-SW = 'Y'
 14692         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 286
* EL156.cbl
 14693         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 14694
 14695     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14696         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 14697     ELSE
 14698         IF PI-PMTTYPE NOT = '4'
 14699            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 14700
 14701     IF PI-PMTTYPE = '5' OR '6'
 14702        GO TO  6250-SET-MAINT.
 14703
 14704     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 14705                                         CL-LAG-REPORT-CODE.
 14706
 14707     IF CL-ACTIVITY-CODE = 09
 14708         GO TO 6200-CONT-UPDATE.
 14709
 14710     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14711         IF CL-ACTIVITY-CODE = 11
 14712             GO TO 6200-CONT-UPDATE.
 14713
 14714     IF WS-ACT-REC-FOUND-SW = 'N'
 14715         GO TO 6200-CONT-UPDATE.
 14716
 14717     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 14718         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 14719         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 14720         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 14721
 14722     IF WS-UPDATE-SW = 'Y'
 14723         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 14724                                         CL-NEXT-FOLLOWUP-DT.
 14725
 14726 6200-CONT-UPDATE.
 14727
 14728     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14729       IF CLAIM-IS-CLOSED
 14730         IF PI-PMTTYPE = '2' OR '3' OR '4'
 14731           IF WS-OPEN-CLOSE-SW = '2'
 14732             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 14733                                        CL-LAST-CLOSE-DT.
 14734
 14735     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 14736        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 14737        MOVE 'O'                 TO CL-CLAIM-STATUS.
 14738
 14739     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 14740        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 14741        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 14742        MOVE 'C'                 TO CL-CLAIM-STATUS
 14743        IF PI-PMTTYPE = '2'
 14744           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14745           CONTINUE
 14746        ELSE
 14747           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14748        END-IF
 14749     ELSE
 14750        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 287
* EL156.cbl
 14751           IF PI-PMTTYPE = '2' AND
 14752              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14753              CONTINUE
 14754           ELSE
 14755              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14756           END-IF
 14757        END-IF
 14758     END-IF
 14759
 14760     IF PI-PMTTYPE = '4'
 14761        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 14762
 14763     IF PI-COMPANY-ID = 'CVL'
 14764         IF PI-LOAN-UPDATE-SW = 'Y'
 14765             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 14766             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 14767             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 14768             MOVE CL-CERT-STATE      TO  CERT-STATE
 14769             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 14770             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 14771             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 14772             MOVE 'CERT'             TO  FILE-SWITCH
 14773             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 14774             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 14775             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 14776
 14777     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 14778        GO TO 6220-USE-COMPUTED.
 14779
 14780     IF (PI-PMTTYPE = '4')  AND
 14781        (PI-EPYAMT < ZEROS)
 14782          COMPUTE CL-NO-OF-DAYS-PAID =
 14783                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 14784          IF CL-NO-OF-DAYS-PAID < +0
 14785              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14786          ELSE
 14787              NEXT SENTENCE
 14788     ELSE
 14789          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 14790
 14791     IF PI-PROCESSOR-ID = 'FIX '
 14792        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 14793           NEXT SENTENCE
 14794        ELSE
 14795           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 14796     ELSE
 14797        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 14798
 14799     IF PI-PMTTYPE = '4'
 14800        GO TO 6250-SET-MAINT.
 14801
 14802     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14803
 14804     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14805     MOVE '4'                    TO DC-OPTION-CODE.
 14806     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14807     IF DATE-CONVERSION-ERROR
 14808        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 288
* EL156.cbl
 14809     ELSE
 14810        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 14811           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 14812           IF PI-AIG-SPECIAL-BENEFIT
 14813               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 14814           ELSE
 14815               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 14816
 14817     GO TO 6250-SET-MAINT.
 14818
 14819 6220-USE-COMPUTED.
 14820
 14821     IF (PI-PMTTYPE = '4')  AND
 14822        (PI-CPYAMT < ZEROS)
 14823          COMPUTE CL-NO-OF-DAYS-PAID =
 14824                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 14825          IF CL-NO-OF-DAYS-PAID < +0
 14826              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14827          ELSE
 14828              NEXT SENTENCE
 14829     ELSE
 14830          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 14831
 14832     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 14833
 14834     IF PI-PMTTYPE = '4'
 14835        GO TO 6250-SET-MAINT.
 14836
 14837     IF PI-AIG-SPECIAL-BENEFIT
 14838         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 14839     ELSE
 14840         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 14841
 14842     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14843
 14844     IF PI-CPYTHRU > CL-PAID-THRU-DT
 14845        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 14846
 14847 6250-SET-MAINT.
 14848     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 14849
 14850     IF PI-PROCESSOR-ID = 'FIX '
 14851        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 14852           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 14853        ELSE
 14854           NEXT SENTENCE
 14855     ELSE
 14856        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 14857
 14858     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 14859     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 14860     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 14861
 14862 6299-EXIT.
 14863      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 289
* EL156.cbl
 14865 6300-UPDATE-CERT.
 14866
 14867*  ADD CERTNOTE FOR SC NP+6
 14868     IF PI-COMPANY-ID = 'CID' AND
 14869       (PI-PMTTYPE = '2' OR '3') AND
 14870        CL-CERT-STATE = 'SC'  AND
 14871        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 14872           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 14873     END-IF.
 14874
 14875     IF PI-COMPANY-ID = 'AHL' AND
 14876       (PI-PMTTYPE = '2' OR '3') AND
 14877        CL-CERT-STATE = 'SC'  AND
 14878        (PI-LF-BENEFIT-CD = '5I' OR '6J')
 14879           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 14880     END-IF.
 14881
 14882     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 14883     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 14884     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 14885     MOVE CL-CERT-STATE    TO CERT-STATE.
 14886     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 14887     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 14888     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 14889     MOVE 'CERT'           TO FILE-SWITCH.
 14890
 14891     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 14892
 14893     IF CERT-NOTE-ADDED
 14894        IF CM-NOTE-SW = ' '
 14895           MOVE '4'             TO CM-NOTE-SW
 14896        ELSE
 14897           IF CM-NOTE-SW = '1'
 14898               MOVE '5'           TO CM-NOTE-SW
 14899           ELSE
 14900              IF CM-NOTE-SW = '2'
 14901                 MOVE '6'         TO CM-NOTE-SW
 14902              ELSE
 14903                 IF CM-NOTE-SW = '3'
 14904                    MOVE '7'      TO CM-NOTE-SW
 14905                 END-IF
 14906              END-IF
 14907           END-IF
 14908        END-IF
 14909     END-IF.
 14910
 14911     IF PI-COMPANY-ID = 'CVL'
 14912         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 14913         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 14914
 14915     IF PI-PMTTYPE NOT = '4'
 14916        GO TO 6340-UPDATE-CERT.
 14917
 14918     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14919        IF PI-PFKEY-USED = DFHPF5
 14920           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 14921        ELSE
 14922           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 290
* EL156.cbl
 14923
 14924*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14925*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 14926*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14927*               PI-LF-COVERAGE-TYPE = 'P'
 14928*                GO TO 6350-REWRITE-CERT.
 14929
 14930     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14931       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14932          PI-LF-COVERAGE-TYPE = 'P'
 14933           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 14934                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 14935                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 14936                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 14937                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 14938                GO TO 6350-REWRITE-CERT
 14939            ELSE
 14940                GO TO 6350-REWRITE-CERT.
 14941
 14942     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14943         GO TO 6350-REWRITE-CERT.
 14944
 14945     IF NOT CM-AH-LUMP-SUM-DISAB
 14946        GO TO 6380-UNLOCK-CERT.
 14947
 14948     IF PI-PFKEY-USED = DFHPF5
 14949        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 14950                                    CM-AH-ITD-AH-PMT
 14951        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 14952        GO TO 6350-REWRITE-CERT
 14953     ELSE
 14954        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 14955                                    CM-AH-ITD-AH-PMT
 14956        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 14957        GO TO 6350-REWRITE-CERT.
 14958
 14959 6340-UPDATE-CERT.
 14960
 14961     IF CL-CLAIM-TYPE = 'L'
 14962         IF PI-PFKEY-USED = DFHPF5
 14963             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 14964         ELSE
 14965             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 14966
 14967     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14968         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 14969             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14970                PI-LF-COVERAGE-TYPE = 'P'
 14971                 GO TO 6350-REWRITE-CERT.
 14972
 14973     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14974       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14975          PI-LF-COVERAGE-TYPE = 'P'
 14976           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 14977                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 14978                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 14979                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 14980                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 291
* EL156.cbl
 14981                GO TO 6350-REWRITE-CERT.
 14982
 14983     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14984         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 14985            PI-LF-COVERAGE-TYPE NOT = 'P'
 14986             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 14987             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 14988             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 14989             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 14990             GO TO 6350-REWRITE-CERT.
 14991
 14992     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14993         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 14994         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 14995         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 14996         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 14997         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 14998         IF PI-PFKEY-USED = DFHPF5
 14999             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 15000                                        CM-AH-ITD-AH-PMT
 15001             GO TO 6350-REWRITE-CERT
 15002         ELSE
 15003             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 15004                                        CM-AH-ITD-AH-PMT
 15005             GO TO 6350-REWRITE-CERT.
 15006
 15007 6350-REWRITE-CERT.
 15008
 15009
 15010* EXEC CICS REWRITE
 15011*         DATASET  ('ELCERT')
 15012*         FROM(CERTIFICATE-MASTER)
 15013*     END-EXEC.
 15014     MOVE LENGTH OF
 15015      CERTIFICATE-MASTER
 15016       TO DFHEIV11
 15017     MOVE 'ELCERT' TO DFHEIV1
 15018*    MOVE '&& L                  %   #00014078' TO DFHEIV0
 15019     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15020     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15021     MOVE X'2020233030303134303738' TO DFHEIV0(25:11)
 15022     CALL 'kxdfhei1' USING DFHEIV0,
 15023           DFHEIV1,
 15024           CERTIFICATE-MASTER,
 15025           DFHEIV11,
 15026           DFHEIV99
 15027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15028
 15029
 15030     GO TO 6399-EXIT.
 15031
 15032 6380-UNLOCK-CERT.
 15033
 15034* EXEC CICS UNLOCK
 15035*         DATASET  ('ELCERT')
 15036*     END-EXEC.
 15037     MOVE 'ELCERT' TO DFHEIV1
 15038*    MOVE '&*                    #   #00014086' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 292
* EL156.cbl
 15039     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15040     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15041     MOVE X'2020233030303134303836' TO DFHEIV0(25:11)
 15042     CALL 'kxdfhei1' USING DFHEIV0,
 15043           DFHEIV1,
 15044           DFHEIV99
 15045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15046
 15047
 15048 6399-EXIT.
 15049      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 293
* EL156.cbl
 15051 6400-UPDATE-ZERO-TRAILER.
 15052     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15053     MOVE ZEROS                  TO TRLR-SEQ-NO.
 15054
 15055     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 15056
 15057     IF PI-EPYAMT NOT = ZEROS
 15058         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 15059     ELSE
 15060         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 15061
 15062     IF PI-ERESV NOT = ZEROS
 15063        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 15064
 15065     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 15066        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 15067
 15068     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 15069        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 15070     ELSE
 15071        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 15072
 15073     IF PI-PMTTYPE = '5'
 15074        IF PI-EPYAMT = ZEROS
 15075           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 15076        ELSE
 15077           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 15078
 15079     IF PI-PMTTYPE = '6'
 15080        IF PI-EPYAMT = ZEROS
 15081           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 15082        ELSE
 15083           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 15084
 15085 6420-CHECK-OPEN-CLOSE.
 15086     IF PI-PMTTYPE = '5' OR '6'
 15087        GO TO 6450-REWRITE.
 15088
 15089     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15090         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15091             IF CLAIM-IS-CLOSED
 15092                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 15093                 MOVE 1          TO  SUB-1
 15094                 GO TO 6440-AIG-LOOP.
 15095
 15096     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 15097        GO TO 6450-REWRITE.
 15098
 15099     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 15100        GO TO 6450-REWRITE.
 15101
 15102     MOVE 1                      TO SUB-1.
 15103
 15104 6430-LOOP.
 15105     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 15106        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 15107        IF PI-PMTTYPE = '1' OR '4'
 15108           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 294
* EL156.cbl
 15109           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 15110           GO TO 6450-REWRITE
 15111        ELSE
 15112           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 15113           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 15114           GO TO 6450-REWRITE.
 15115
 15116     IF SUB-1 = 6
 15117      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15118      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15119      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15120      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15121      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15122      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15123      GO TO 6430-LOOP.
 15124
 15125     ADD 1                       TO SUB-1.
 15126     GO TO 6430-LOOP.
 15127
 15128
 15129 6440-AIG-LOOP.
 15130
 15131     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 15132       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 15133       IF WS-OPEN-CLOSE-SW = '1'
 15134         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15135         IF PI-PMTTYPE = '2'
 15136           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15137           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 15138         ELSE
 15139           IF PI-PMTTYPE = '3'
 15140             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15141             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 15142           ELSE
 15143             IF PI-PMTTYPE = '4'
 15144               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15145               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15146             ELSE
 15147               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15148               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15149       ELSE
 15150         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15151         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15152         GO TO 6450-REWRITE.
 15153
 15154     IF SUB-1 = 6
 15155      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15156      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15157      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15158      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15159      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15160      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15161      GO TO 6440-AIG-LOOP.
 15162
 15163     ADD 1                       TO SUB-1.
 15164     GO TO 6440-AIG-LOOP.
 15165
 15166 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 295
* EL156.cbl
 15167     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 15168     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 15169     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 15170
 15171     IF PI-COMPANY-ID = 'DMD'
 15172         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15173         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15174         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15175         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15176         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15177
 15178
 15179* EXEC CICS REWRITE
 15180*         DATASET  ('ELTRLR')
 15181*         FROM     (ACTIVITY-TRAILERS)
 15182*     END-EXEC.
 15183     MOVE LENGTH OF
 15184      ACTIVITY-TRAILERS
 15185       TO DFHEIV11
 15186     MOVE 'ELTRLR' TO DFHEIV1
 15187*    MOVE '&& L                  %   #00014220' TO DFHEIV0
 15188     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15189     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15190     MOVE X'2020233030303134323230' TO DFHEIV0(25:11)
 15191     CALL 'kxdfhei1' USING DFHEIV0,
 15192           DFHEIV1,
 15193           ACTIVITY-TRAILERS,
 15194           DFHEIV11,
 15195           DFHEIV99
 15196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15197
 15198
 15199 6499-EXIT.
 15200      EXIT.
 15201
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 296
* EL156.cbl
 15203 6500-READ-DLO035.
 15204     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 15205     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15206     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15207     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15208
 15209
 15210* EXEC CICS LINK
 15211*        PROGRAM    ('DLO035')
 15212*        COMMAREA   (DLO035-KEY)
 15213*        LENGTH     (DL35-LENGTH)
 15214*    END-EXEC.
 15215     MOVE 'DLO035' TO DFHEIV1
 15216*    MOVE '."C                   ''   #00014235' TO DFHEIV0
 15217     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15218     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15219     MOVE X'2020233030303134323335' TO DFHEIV0(25:11)
 15220     CALL 'kxdfhei1' USING DFHEIV0,
 15221           DFHEIV1,
 15222           DLO035-KEY,
 15223           DL35-LENGTH,
 15224           DFHEIV99,
 15225           DFHEIV99,
 15226           DFHEIV99
 15227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15228
 15229
 15230     IF DL35-RETURN-CODE = 'OK'
 15231         GO TO 6500-EXIT.
 15232
 15233     IF DL35-RETURN-CODE = '01'
 15234         MOVE ER-7830            TO EMI-ERROR
 15235         GO TO 6500-BAD-EXIT.
 15236
 15237     IF DL35-RETURN-CODE = '02'
 15238         MOVE ER-7831            TO EMI-ERROR
 15239         GO TO 6500-BAD-EXIT.
 15240
 15241     IF DL35-RETURN-CODE = '03'
 15242         MOVE ER-7832            TO EMI-ERROR
 15243         GO TO 6500-BAD-EXIT.
 15244
 15245     IF DL35-RETURN-CODE = '04'
 15246         MOVE ER-7833            TO EMI-ERROR
 15247         GO TO 6500-BAD-EXIT.
 15248
 15249     IF DL35-RETURN-CODE = '05'
 15250         MOVE ER-7834            TO EMI-ERROR
 15251         GO TO 6500-BAD-EXIT.
 15252
 15253     IF DL35-RETURN-CODE = '06'
 15254         MOVE ER-7835            TO EMI-ERROR
 15255         GO TO 6500-BAD-EXIT.
 15256
 15257     IF DL35-RETURN-CODE = '07'
 15258         MOVE ER-7836            TO EMI-ERROR
 15259         GO TO 6500-BAD-EXIT.
 15260
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 297
* EL156.cbl
 15261     IF DL35-RETURN-CODE = 'E1'
 15262         MOVE ER-7837            TO EMI-ERROR
 15263         GO TO 6500-BAD-EXIT.
 15264
 15265     IF DL35-RETURN-CODE NOT = 'OK'
 15266         MOVE ER-7838            TO EMI-ERROR
 15267         GO TO 6500-BAD-EXIT.
 15268
 15269 6500-EXIT.
 15270      EXIT.
 15271
 15272 6500-BAD-EXIT.
 15273
 15274* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15275*    MOVE '6"R                   !   #00014284' TO DFHEIV0
 15276     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15277     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15278     MOVE X'2020233030303134323834' TO DFHEIV0(25:11)
 15279     CALL 'kxdfhei1' USING DFHEIV0
 15280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15281
 15282     MOVE -1                 TO PMTTYPEL.
 15283     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15284     GO TO 8200-SEND-DATAONLY.
 15285
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 298
* EL156.cbl
 15287 6600-UPDATE-DLO035.
 15288     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 15289     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15290     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15291     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15292
 15293
 15294* EXEC CICS LINK
 15295*        PROGRAM    ('DLO035')
 15296*        COMMAREA   (DLO035-KEY)
 15297*        LENGTH     (DL35-LENGTH)
 15298*    END-EXEC.
 15299     MOVE 'DLO035' TO DFHEIV1
 15300*    MOVE '."C                   ''   #00014296' TO DFHEIV0
 15301     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15302     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15303     MOVE X'2020233030303134323936' TO DFHEIV0(25:11)
 15304     CALL 'kxdfhei1' USING DFHEIV0,
 15305           DFHEIV1,
 15306           DLO035-KEY,
 15307           DL35-LENGTH,
 15308           DFHEIV99,
 15309           DFHEIV99,
 15310           DFHEIV99
 15311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15312
 15313
 15314     IF DL35-RETURN-CODE = 'OK'
 15315         GO TO 6600-EXIT.
 15316
 15317     IF DL35-RETURN-CODE = '01'
 15318         MOVE ER-7830            TO EMI-ERROR
 15319         GO TO 6500-BAD-EXIT.
 15320
 15321     IF DL35-RETURN-CODE = '02'
 15322         MOVE ER-7831            TO EMI-ERROR
 15323         GO TO 6500-BAD-EXIT.
 15324
 15325     IF DL35-RETURN-CODE = '03'
 15326         MOVE ER-7832            TO EMI-ERROR
 15327         GO TO 6500-BAD-EXIT.
 15328
 15329     IF DL35-RETURN-CODE = '04'
 15330         MOVE ER-7833            TO EMI-ERROR
 15331         GO TO 6500-BAD-EXIT.
 15332
 15333     IF DL35-RETURN-CODE = '05'
 15334         MOVE ER-7834            TO EMI-ERROR
 15335         GO TO 6500-BAD-EXIT.
 15336
 15337     IF DL35-RETURN-CODE = '06'
 15338         MOVE ER-7835            TO EMI-ERROR
 15339         GO TO 6500-BAD-EXIT.
 15340
 15341     IF DL35-RETURN-CODE = '07'
 15342         MOVE ER-7836            TO EMI-ERROR
 15343         GO TO 6500-BAD-EXIT.
 15344
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 299
* EL156.cbl
 15345     IF DL35-RETURN-CODE = 'E1'
 15346         MOVE ER-7837            TO EMI-ERROR
 15347         GO TO 6500-BAD-EXIT.
 15348
 15349     IF DL35-RETURN-CODE NOT = 'OK'
 15350         MOVE ER-7838            TO EMI-ERROR
 15351         GO TO 6500-BAD-EXIT.
 15352
 15353 6600-EXIT.
 15354      EXIT.
 15355
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 300
* EL156.cbl
 15357 6700-UPDATE-ACTQ.
 15358***************************************************************
 15359*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 15360*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 15361*    ONE ALREADY THERE.                                       *
 15362***************************************************************
 15363
 15364
 15365* EXEC CICS HANDLE CONDITION
 15366*         NOTFND(6720-BUILD-NEW-RECORD)
 15367*     END-EXEC.
 15368*    MOVE '"$I                   ! 6 #00014352' TO DFHEIV0
 15369     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15371     MOVE X'3620233030303134333532' TO DFHEIV0(25:11)
 15372     CALL 'kxdfhei1' USING DFHEIV0
 15373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15374
 15375
 15376
 15377* EXEC CICS READ
 15378*         DATASET('ELACTQ')
 15379*         RIDFLD (ELMSTR-KEY)
 15380*         SET    (ADDRESS OF ACTIVITY-QUE)
 15381*         UPDATE
 15382*     END-EXEC.
 15383     MOVE 'ELACTQ' TO DFHEIV1
 15384*    MOVE '&"S        EU         (   #00014356' TO DFHEIV0
 15385     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15386     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15387     MOVE X'2020233030303134333536' TO DFHEIV0(25:11)
 15388     CALL 'kxdfhei1' USING DFHEIV0,
 15389           DFHEIV1,
 15390           DFHEIV20,
 15391           DFHEIV99,
 15392           ELMSTR-KEY,
 15393           DFHEIV99,
 15394           DFHEIV99,
 15395           DFHEIV99
 15396     SET ADDRESS OF ACTIVITY-QUE TO
 15397         DFHEIV20
 15398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15399
 15400
 15401     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15402
 15403     IF PI-AIG-SPECIAL-BENEFIT AND
 15404        PI-CASH = 'Y'
 15405         ADD 2                   TO AQ-PAYMENT-COUNTER
 15406     ELSE
 15407         ADD 1                   TO AQ-PAYMENT-COUNTER.
 15408
 15409     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 15410         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 15411
 15412     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 15413
 15414     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 301
* EL156.cbl
 15415         IF WS-PMT-APPROVAL-SW = 'A'
 15416             NEXT SENTENCE
 15417         ELSE
 15418            IF PI-AIG-SPECIAL-BENEFIT AND
 15419               PI-CASH = 'Y'
 15420                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15421                                     WS-PMT-UNAPPROVED-CNT
 15422            ELSE
 15423                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15424                                     WS-PMT-UNAPPROVED-CNT
 15425     ELSE
 15426         IF PI-PMT-APPR-SW = 'Y'
 15427            IF PI-AIG-SPECIAL-BENEFIT AND
 15428               PI-CASH = 'Y'
 15429                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15430                                     WS-PMT-UNAPPROVED-CNT
 15431            ELSE
 15432                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15433                                     WS-PMT-UNAPPROVED-CNT.
 15434
 15435     IF WS-PMT-UNAPPROVED-CNT > ZERO
 15436         MOVE ER-3536 TO EMI-ERROR
 15437         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15438
 15439     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 15440
 15441
 15442* EXEC CICS REWRITE
 15443*         DATASET('ELACTQ')
 15444*         FROM   (ACTIVITY-QUE)
 15445*     END-EXEC.
 15446     MOVE LENGTH OF
 15447      ACTIVITY-QUE
 15448       TO DFHEIV11
 15449     MOVE 'ELACTQ' TO DFHEIV1
 15450*    MOVE '&& L                  %   #00014403' TO DFHEIV0
 15451     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15452     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15453     MOVE X'2020233030303134343033' TO DFHEIV0(25:11)
 15454     CALL 'kxdfhei1' USING DFHEIV0,
 15455           DFHEIV1,
 15456           ACTIVITY-QUE,
 15457           DFHEIV11,
 15458           DFHEIV99
 15459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15460
 15461
 15462     GO TO 6799-EXIT.
 15463
 15464 6720-BUILD-NEW-RECORD.
 15465
 15466* EXEC CICS GETMAIN
 15467*         SET    (ADDRESS OF ACTIVITY-QUE)
 15468*         LENGTH (60)
 15469*         INITIMG(GETMAIN-SPACE)
 15470*     END-EXEC.
 15471     MOVE 60
 15472       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 302
* EL156.cbl
 15473*    MOVE ',"IL                  $   #00014411' TO DFHEIV0
 15474     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15475     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15476     MOVE X'2020233030303134343131' TO DFHEIV0(25:11)
 15477     CALL 'kxdfhei1' USING DFHEIV0,
 15478           DFHEIV20,
 15479           DFHEIV11,
 15480           GETMAIN-SPACE
 15481     SET ADDRESS OF ACTIVITY-QUE TO
 15482         DFHEIV20
 15483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15484
 15485
 15486     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 15487
 15488     IF PI-AIG-SPECIAL-BENEFIT AND
 15489        PI-CASH = 'Y'
 15490         MOVE 2                  TO AQ-PAYMENT-COUNTER
 15491     ELSE
 15492         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 15493
 15494     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 15495     MOVE 'AQ'                   TO AQ-RECORD-ID.
 15496     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 15497     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 15498                                    AQ-FOLLOWUP-DATE.
 15499     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 15500     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15501
 15502     IF PI-PMT-GRADUATED
 15503         IF WS-PMT-APPROVAL-SW = 'A'
 15504             NEXT SENTENCE
 15505         ELSE
 15506            IF PI-AIG-SPECIAL-BENEFIT AND
 15507               PI-CASH = 'Y'
 15508                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15509            ELSE
 15510                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15511     ELSE
 15512         IF PI-PMT-APPR-SW = 'Y'
 15513            IF PI-AIG-SPECIAL-BENEFIT AND
 15514               PI-CASH = 'Y'
 15515                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15516            ELSE
 15517                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 15518
 15519     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 15520         MOVE ER-3536 TO EMI-ERROR
 15521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15522
 15523
 15524* EXEC CICS WRITE
 15525*         DATASET('ELACTQ')
 15526*         RIDFLD (ELMSTR-KEY)
 15527*         FROM   (ACTIVITY-QUE)
 15528*     END-EXEC.
 15529     MOVE LENGTH OF
 15530      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 303
* EL156.cbl
 15531       TO DFHEIV11
 15532     MOVE 'ELACTQ' TO DFHEIV1
 15533*    MOVE '&$ L                  ''   #00014454' TO DFHEIV0
 15534     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15535     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15536     MOVE X'2020233030303134343534' TO DFHEIV0(25:11)
 15537     CALL 'kxdfhei1' USING DFHEIV0,
 15538           DFHEIV1,
 15539           ACTIVITY-QUE,
 15540           DFHEIV11,
 15541           ELMSTR-KEY,
 15542           DFHEIV99,
 15543           DFHEIV99
 15544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15545
 15546
 15547 6799-EXIT.
 15548      EXIT.
 15549
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 304
* EL156.cbl
 15551 6800-BUILD-FORM-TRAILER.
 15552
 15553
 15554* EXEC CICS GETMAIN
 15555*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15556*         LENGTH   (200)
 15557*         INITIMG  (GETMAIN-SPACE)
 15558*    END-EXEC.
 15559     MOVE 200
 15560       TO DFHEIV11
 15561*    MOVE ',"IL                  $   #00014466' TO DFHEIV0
 15562     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15563     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15564     MOVE X'2020233030303134343636' TO DFHEIV0(25:11)
 15565     CALL 'kxdfhei1' USING DFHEIV0,
 15566           DFHEIV20,
 15567           DFHEIV11,
 15568           GETMAIN-SPACE
 15569     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15570         DFHEIV20
 15571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15572
 15573
 15574     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 15575
 15576     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 15577     MOVE 'AT'                   TO AT-RECORD-ID.
 15578     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15579
 15580     MOVE 'A'                    TO AT-TRAILER-TYPE.
 15581     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15582                                    AT-FORM-LAST-MAINT-DT
 15583                                    AT-FORM-SEND-ON-DT.
 15584     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15585                                    AT-FORM-LAST-UPDATED-BY.
 15586     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15587     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 15588     MOVE '6'                    TO DC-OPTION-CODE.
 15589     MOVE +29                    TO DC-ELAPSED-DAYS.
 15590     MOVE +0                     TO DC-ELAPSED-MONTHS.
 15591     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15592     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 15593
 15594     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15595         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 15596
 15597     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 15598                                    AT-FORM-RE-SEND-DT
 15599                                    AT-EMP-FORM-ANSWERED-DT
 15600                                    AT-PHY-FORM-ANSWERED-DT
 15601                                    AT-EMP-FORM-SEND-ON-DT
 15602                                    AT-PHY-FORM-SEND-ON-DT
 15603                                    AT-FORM-PRINTED-DT
 15604                                    AT-FORM-REPRINT-DT.
 15605     MOVE '2'                    TO AT-FORM-TYPE.
 15606
 15607     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 15608     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 305
* EL156.cbl
 15609
 15610     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15611         NEXT SENTENCE
 15612     ELSE
 15613         IF CL-PROG-FORM-TYPE NOT = 'S'
 15614            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 15615
 15616
 15617* EXEC CICS WRITE
 15618*         DATASET  ('ELTRLR')
 15619*         FROM     (ACTIVITY-TRAILERS)
 15620*         RIDFLD   (AT-CONTROL-PRIMARY)
 15621*     END-EXEC.
 15622     MOVE LENGTH OF
 15623      ACTIVITY-TRAILERS
 15624       TO DFHEIV11
 15625     MOVE 'ELTRLR' TO DFHEIV1
 15626*    MOVE '&$ L                  ''   #00014514' TO DFHEIV0
 15627     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15628     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15629     MOVE X'2020233030303134353134' TO DFHEIV0(25:11)
 15630     CALL 'kxdfhei1' USING DFHEIV0,
 15631           DFHEIV1,
 15632           ACTIVITY-TRAILERS,
 15633           DFHEIV11,
 15634           AT-CONTROL-PRIMARY,
 15635           DFHEIV99,
 15636           DFHEIV99
 15637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15638
 15639
 15640 6899-EXIT.
 15641      EXIT.
 15642
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 306
* EL156.cbl
 15644 6900-BUILD-ARCHIVE-HEADER.
 15645
 15646     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15647     MOVE '1'                    TO CNTL-REC-TYPE.
 15648     MOVE +0                     TO CNTL-SEQ-NO.
 15649     MOVE SPACES                 TO CNTL-ACCESS.
 15650
 15651
 15652* EXEC CICS READ
 15653*         DATASET  ('ELCNTL')
 15654*         SET      (ADDRESS OF CONTROL-FILE)
 15655*         RIDFLD   (ELCNTL-KEY)
 15656*         UPDATE
 15657*    END-EXEC.
 15658     MOVE 'ELCNTL' TO DFHEIV1
 15659*    MOVE '&"S        EU         (   #00014531' TO DFHEIV0
 15660     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15661     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15662     MOVE X'2020233030303134353331' TO DFHEIV0(25:11)
 15663     CALL 'kxdfhei1' USING DFHEIV0,
 15664           DFHEIV1,
 15665           DFHEIV20,
 15666           DFHEIV99,
 15667           ELCNTL-KEY,
 15668           DFHEIV99,
 15669           DFHEIV99,
 15670           DFHEIV99
 15671     SET ADDRESS OF CONTROL-FILE TO
 15672         DFHEIV20
 15673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15674
 15675
 15676     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 15677     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 15678
 15679
 15680* EXEC CICS REWRITE
 15681*         FROM     (CONTROL-FILE)
 15682*         DATASET  ('ELCNTL')
 15683*    END-EXEC.
 15684     MOVE LENGTH OF
 15685      CONTROL-FILE
 15686       TO DFHEIV11
 15687     MOVE 'ELCNTL' TO DFHEIV1
 15688*    MOVE '&& L                  %   #00014541' TO DFHEIV0
 15689     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15690     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15691     MOVE X'2020233030303134353431' TO DFHEIV0(25:11)
 15692     CALL 'kxdfhei1' USING DFHEIV0,
 15693           DFHEIV1,
 15694           CONTROL-FILE,
 15695           DFHEIV11,
 15696           DFHEIV99
 15697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15698
 15699
 15700
 15701* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 307
* EL156.cbl
 15702*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 15703*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 15704*    END-EXEC.
 15705*    MOVE '"$$%                  ! 7 #00014546' TO DFHEIV0
 15706     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 15707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15708     MOVE X'3720233030303134353436' TO DFHEIV0(25:11)
 15709     CALL 'kxdfhei1' USING DFHEIV0
 15710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15711
 15712
 15713
 15714* EXEC CICS GETMAIN
 15715*         SET     (ADDRESS OF LETTER-ARCHIVE)
 15716*         LENGTH  (ELARCH-LENGTH)
 15717*         INITIMG (GETMAIN-SPACE)
 15718*    END-EXEC.
 15719*    MOVE ',"IL                  $   #00014551' TO DFHEIV0
 15720     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15722     MOVE X'2020233030303134353531' TO DFHEIV0(25:11)
 15723     CALL 'kxdfhei1' USING DFHEIV0,
 15724           DFHEIV20,
 15725           ELARCH-LENGTH,
 15726           GETMAIN-SPACE
 15727     SET ADDRESS OF LETTER-ARCHIVE TO
 15728         DFHEIV20
 15729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15730
 15731
 15732     MOVE 'LA'                   TO LA-RECORD-ID.
 15733     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 15734                                    LA-ARCHIVE-NO-A1.
 15735     MOVE '4'                    TO LA-RECORD-TYPE
 15736                                    LA-RECORD-TYPE-A1.
 15737     MOVE +0                     TO LA-LINE-SEQ-NO
 15738                                    LA-LINE-SEQ-NO-A1.
 15739     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 15740                                    LA-COMPANY-CD-A1.
 15741     MOVE CL-CARRIER             TO LA4-CARRIER.
 15742     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 15743     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 15744     MOVE CL-CERT-STATE          TO LA4-STATE.
 15745     MOVE +0                     TO LA4-NO-OF-COPIES.
 15746     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 15747     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 15748     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 15749                                    LA4-INITIAL-PRINT-DATE
 15750                                    LA4-RESEND-PRINT-DATE
 15751                                    LA4-FORM-REM-PRINT-DT.
 15752     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 15753     MOVE '2'                    TO LA4-FORM-TYPE.
 15754
 15755
 15756* EXEC CICS WRITE
 15757*         DATASET  ('ELARCH')
 15758*         FROM     (LETTER-ARCHIVE)
 15759*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 308
* EL156.cbl
 15760*    END-EXEC.
 15761     MOVE LENGTH OF
 15762      LETTER-ARCHIVE
 15763       TO DFHEIV11
 15764     MOVE 'ELARCH' TO DFHEIV1
 15765*    MOVE '&$ L                  ''   #00014580' TO DFHEIV0
 15766     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15767     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15768     MOVE X'2020233030303134353830' TO DFHEIV0(25:11)
 15769     CALL 'kxdfhei1' USING DFHEIV0,
 15770           DFHEIV1,
 15771           LETTER-ARCHIVE,
 15772           DFHEIV11,
 15773           LA-CONTROL-PRIMARY,
 15774           DFHEIV99,
 15775           DFHEIV99
 15776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15777
 15778
 15779 6999-EXIT.
 15780      EXIT.
 15781
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 309
* EL156.cbl
 15783 7000-SHOW-CLAIM.
 15784     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 15785     MOVE 'A'                    TO PI-PASS-SW.
 15786     MOVE LOW-VALUES             TO PI-CPYFROM
 15787                                    PI-MONTH-END-SAVE
 15788                                    PI-CPYTHRU.
 15789
 15790     MOVE ZEROS                  TO PI-FATAL-COUNT
 15791                                    PI-DAILY-RATE
 15792                                    PI-BEN-DAYS
 15793                                    PI-MANUAL-SW
 15794                                    PI-SAVE-CURSOR
 15795                                    PI-FORCE-COUNT
 15796                                    PI-HOLDTIL
 15797                                    PI-EPYFROM
 15798                                    PI-EPYTHRU
 15799                                    PI-EDAYS
 15800                                    PI-EPYAMT
 15801                                    PI-ERESV
 15802                                    PI-EEXPENS
 15803                                    PI-CDAYS
 15804                                    PI-CPYAMT
 15805                                    PI-CRESV
 15806                                    PI-CEXPENS
 15807                                    PI-INT-RATE
 15808                                    PI-AIGFROM.
 15809     MOVE ZEROS                  TO PI-PROOF-DATE.
 15810     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 15811                                    PI-REM-BEN-AMT
 15812                                    PI-MO-BEN-AMT.
 15813
 15814     MOVE LOW-VALUES             TO EL156AI.
 15815     MOVE MAP-NAMEA              TO MAP-NAME.
 15816
 15817 7010-BUILD-MAP.
 15818
 15819
 15820* EXEC CICS HANDLE CONDITION
 15821*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 15822*    END-EXEC.
 15823*    MOVE '"$I                   ! 8 #00014626' TO DFHEIV0
 15824     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15826     MOVE X'3820233030303134363236' TO DFHEIV0(25:11)
 15827     CALL 'kxdfhei1' USING DFHEIV0
 15828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15829
 15830
 15831     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15832     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15833     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15834     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15835     MOVE 'MSTR'                 TO FILE-SWITCH.
 15836
 15837     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15838
 15839     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 15840     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 310
* EL156.cbl
 15841     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 15842     MOVE CL-CCN                 TO PI-SV-CCN.
 15843
 15844     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15845     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15846     MOVE CL-CLAIM-NO            TO CLMNOO.
 15847     MOVE CL-CARRIER             TO CARRO.
 15848     MOVE CL-CERT-PRIME          TO CERTNOO.
 15849     MOVE CL-CERT-SFX            TO SUFXO.
 15850
 15851     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 15852        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 15853        CONTINUE
 15854     ELSE
 15855        MOVE AL-SADOF            TO ZINTHA
 15856                                    ZINTA
 15857                                    PINTHA
 15858                                    PINTA
 15859     END-IF
 15860     EVALUATE TRUE
 15861     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 15862         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 15863     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15864         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 15865
 15866     WHEN CL-CLAIM-TYPE = 'I'
 15867         MOVE '  IU  '           TO CLMTYPO
 15868     WHEN CL-CLAIM-TYPE = 'G'
 15869         MOVE ' GAP  '           TO CLMTYPO
 15870     END-EVALUATE.
 15871     IF CLAIM-IS-OPEN
 15872         MOVE ' OPEN'            TO CLMSTATO
 15873     ELSE
 15874         MOVE 'CLOSED'           TO CLMSTATO.
 15875
 15876     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 15877
 15878     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 15879         MOVE SPACES             TO  PCERTNOO
 15880                                     PSUFXO
 15881                                     PRIMHDGO
 15882                                     SEQUO
 15883         MOVE AL-SADOF           TO  PCERTNOA
 15884                                     PSUFXA
 15885                                     PRIMHDGA
 15886                                     SEQUA
 15887     ELSE
 15888         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 15889         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 15890         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 15891         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 15892         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 15893         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 15894         MOVE AL-SANON               TO  PCERTNOA
 15895                                         PSUFXA
 15896                                         PRIMHDGA
 15897         MOVE AL-SABON               TO  SEQUA.
 15898
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 311
* EL156.cbl
 15899     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 15900
 15901     IF CL-NO-OF-PMTS-MADE = 0 AND
 15902        CL-TOTAL-PAID-AMT = 0
 15903         NEXT SENTENCE
 15904     ELSE
 15905         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 15906             IF NOT PI-USES-PAID-TO
 15907                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 15908                 MOVE ' '                 TO DC-OPTION-CODE
 15909                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15910                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15911             ELSE
 15912                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 15913                 MOVE '6'                 TO DC-OPTION-CODE
 15914                 MOVE +1                  TO DC-ELAPSED-DAYS
 15915                 MOVE +0                  TO DC-ELAPSED-MONTHS
 15916                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15917                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 15918
 15919     IF MAP-NAME = 'EL156A'
 15920     IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 15921        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 15922          MOVE AL-SADOF TO    AIGFRMHA AIGFROMA.
 15923
 15924     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 15925         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 15926         MOVE ' '                TO DC-OPTION-CODE
 15927         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15928         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 15929
 15930     IF CL-INCURRED-DT NOT = LOW-VALUES
 15931         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15932         MOVE ' '                TO DC-OPTION-CODE
 15933         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15934         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 15935
 15936     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 15937
 15938     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 15939         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 15940         MOVE ' '                TO DC-OPTION-CODE
 15941         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15942         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 15943
 15944     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15945         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 15946         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 15947     ELSE
 15948         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 15949         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 15950
 15951     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 15952     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 15953     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 15954     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 15955                                    PI-GROUPING.
 15956     MOVE CL-CERT-STATE          TO CERT-STATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 312
* EL156.cbl
 15957                                    PI-STATE.
 15958     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 15959                                    PI-ACCOUNT.
 15960     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 15961     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 15962     MOVE 'CERT'                 TO FILE-SWITCH.
 15963
 15964     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 15965
 15966     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15967     MOVE PI-STATE               TO WS-ST-ACCESS.
 15968     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 15969     MOVE '3'                    TO CNTL-REC-TYPE.
 15970     MOVE +0                     TO CNTL-SEQ-NO.
 15971     MOVE 'STAT'                 TO FILE-SWITCH.
 15972
 15973     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15974
 15975     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 15976     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 15977
 15978     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15979        GO TO 7020-BYPASS-BENEFIT.
 15980
 15981     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15982     MOVE '4'                    TO CNTL-REC-TYPE.
 15983     MOVE +0                     TO CNTL-SEQ-NO.
 15984     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 15985     MOVE WS-ACCESS              TO CNTL-ACCESS.
 15986     MOVE 'BENE'                 TO FILE-SWITCH.
 15987
 15988     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 15989
 15990     IF NO-BENEFIT-FOUND
 15991        GO TO 7020-BYPASS-BENEFIT.
 15992
 15993     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 15994     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 15995     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 15996
 15997 7020-BYPASS-BENEFIT.
 15998
 15999*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16000*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 16001*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 16002
 16003     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 16004         GO TO 7021-GO-TO-LIFE.
 16005
 16006     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 16007     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 16008     MOVE CM-AH-BENEFIT-AMT      TO BENEO.
 16009     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 16010     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 16011                                    CP-ORIGINAL-TERM.
 16012     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 16013
 16014*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 313
* EL156.cbl
 16015*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 16016*    ELSE
 16017         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 16018
 16019     MOVE ' '                    TO DC-OPTION-CODE.
 16020     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16021     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 16022
 16023     IF PI-COMPANY-ID = 'DMD'
 16024         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 16025         GO TO 7023-BYPASS-REMAINING-TERM.
 16026
 16027     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 16028     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 16029     GO TO 7022-AROUND-LIFE.
 16030
 16031 7021-GO-TO-LIFE.
 16032
 16033     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16034     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 16035     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 16036                                    CP-ORIGINAL-TERM.
 16037     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 16038     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 16039     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 16040     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 16041
 16042     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16043         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 16044     ELSE
 16045         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 16046
 16047     MOVE ' '                    TO DC-OPTION-CODE.
 16048     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16049     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 16050
 16051 7022-AROUND-LIFE.
 16052
 16053     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 16054     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16055     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 16056     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 16057     MOVE '4'                    TO CP-REM-TERM-METHOD.
 16058     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 16059     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 16060
 16061     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 16062
 16063     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16064        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 16065           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 16066
 16067     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16068        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 16069           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 16070
 16071 7023-BYPASS-REMAINING-TERM.
 16072
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 314
* EL156.cbl
 16073     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16074       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 16075          MOVE ZEROS                  TO BENEO
 16076       ELSE
 16077          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 16078          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 16079          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 16080          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 16081          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 16082          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 16083          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 16084          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 16085          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 16086          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 16087          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 16088          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 16089
 16090* EXEC CICS LINK
 16091*            PROGRAM  (LINK-REMAMT)
 16092*            COMMAREA (CALCULATION-PASS-AREA)
 16093*            LENGTH   (CP-COMM-LENGTH)
 16094*         END-EXEC
 16095*    MOVE '."C                   ''   #00014888' TO DFHEIV0
 16096     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16097     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16098     MOVE X'2020233030303134383838' TO DFHEIV0(25:11)
 16099     CALL 'kxdfhei1' USING DFHEIV0,
 16100           LINK-REMAMT,
 16101           CALCULATION-PASS-AREA,
 16102           CP-COMM-LENGTH,
 16103           DFHEIV99,
 16104           DFHEIV99,
 16105           DFHEIV99
 16106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16107          MOVE CP-REMAINING-AMT       TO BENEO.
 16108
 16109     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16110         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16111            WS-LF-COVERAGE-TYPE = 'P'
 16112             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 16113                                        CM-LF-ITD-DEATH-AMT
 16114             MOVE WS-REMAINING-AMT  TO  BENEO.
 16115
 16116     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 16117     MOVE BENEO                  TO PI-REM-BEN-AMT.
 16118     MOVE WS-TERMS               TO TERMSO.
 16119
 16120     IF WS-STATUS = '6' OR '7' OR '8'
 16121         MOVE AL-SABOF           TO CRTSTATA.
 16122
 16123     IF WS-STATUS = '1' OR '4'
 16124        IF CP-REMAINING-TERM-3 = ZEROS
 16125           MOVE 'EXPIRED'        TO CRTSTATO
 16126        ELSE
 16127           MOVE 'ACTIVE  '       TO CRTSTATO.
 16128
 16129     IF WS-STATUS = '2'
 16130         MOVE 'PEND    '         TO CRTSTATO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 315
* EL156.cbl
 16131
 16132     IF WS-STATUS = '3'
 16133         MOVE 'RESTORE '         TO CRTSTATO.
 16134
 16135     IF WS-STATUS = '5'
 16136         MOVE 'REISSUE '         TO CRTSTATO.
 16137
 16138     IF WS-STATUS = '6'
 16139         MOVE 'LMP DIS'          TO CRTSTATO.
 16140
 16141     IF WS-STATUS = '7'
 16142         MOVE 'DEATH'            TO CRTSTATO.
 16143
 16144     IF WS-STATUS = '8'
 16145         MOVE 'CANCEL'           TO CRTSTATO.
 16146
 16147     IF WS-STATUS = '9'
 16148         MOVE 'RE-ONLY '         TO CRTSTATO.
 16149
 16150     IF WS-STATUS = 'V'
 16151         MOVE 'VOID  '           TO CRTSTATO.
 16152
 16153     IF WS-STATUS = 'D'
 16154         MOVE 'DECLINE '         TO CRTSTATO.
 16155
 16156     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16157         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 16158         MOVE '5'                TO CNTL-REC-TYPE
 16159     ELSE
 16160         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 16161         MOVE '4'                TO CNTL-REC-TYPE.
 16162
 16163     MOVE '** NONE **'           TO COVERO.
 16164     MOVE AL-SABON               TO COVERA.
 16165
 16166     IF PI-COMPANY-ID = 'CVL'
 16167         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 16168             MOVE CM-BENEFICIARY TO LOANNOO
 16169             MOVE AL-UANON       TO LOANNOA.
 16170
 16171     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 16172        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 16173        MOVE +91                 TO  TRLR-SEQ-NO
 16174
 16175* EXEC CICS READ
 16176*           DATASET  ('ELTRLR')
 16177*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16178*           RIDFLD   (ELTRLR-KEY)
 16179*           RESP     (WS-RESPONSE)
 16180*       END-EXEC
 16181     MOVE 'ELTRLR' TO DFHEIV1
 16182*    MOVE '&"S        E          (  N#00014960' TO DFHEIV0
 16183     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16184     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16185     MOVE X'204E233030303134393630' TO DFHEIV0(25:11)
 16186     CALL 'kxdfhei1' USING DFHEIV0,
 16187           DFHEIV1,
 16188           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 316
* EL156.cbl
 16189           DFHEIV99,
 16190           ELTRLR-KEY,
 16191           DFHEIV99,
 16192           DFHEIV99,
 16193           DFHEIV99
 16194     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16195         DFHEIV20
 16196     MOVE EIBRESP  TO WS-RESPONSE
 16197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16198
 16199        IF WS-RESP-NORMAL
 16200           MOVE AT-INFO-LINE-1   TO  LOANNOO
 16201        ELSE
 16202           MOVE SPACES           TO  LOANNOO
 16203        END-IF
 16204*052506
 16205*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 16206*052506
 16207     END-IF
 16208
 16209     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 16210        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 16211
 16212     IF WS-BEN-CD = ZEROS
 16213         GO TO 7050-SHOW-CONTINUE.
 16214
 16215     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16216     MOVE WS-ACCESS              TO CNTL-ACCESS.
 16217     MOVE +0                     TO CNTL-SEQ-NO.
 16218     MOVE 'BENE'                 TO FILE-SWITCH.
 16219
 16220     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 16221
 16222     IF BENEFIT-FOUND
 16223         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 16224         MOVE AL-SANON                    TO COVERA.
 16225
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 317
* EL156.cbl
 16227 7050-SHOW-CONTINUE.
 16228
 16229     IF PI-COMPANY-ID = 'DMD'
 16230         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 16231
 16232     MOVE -1                     TO PMTTYPEL.
 16233     GO TO 8100-SEND-INITIAL-MAP.
 16234
 16235 7100-SHOW-RECORD-NOT-FOUND.
 16236     IF FILE-SWITCH = 'MSTR'
 16237         MOVE ER-0204            TO EMI-ERROR.
 16238
 16239     IF FILE-SWITCH = 'CERT'
 16240         MOVE ER-0206            TO EMI-ERROR.
 16241
 16242     IF FILE-SWITCH = 'STAT'
 16243         MOVE ER-0149            TO EMI-ERROR.
 16244
 16245     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16246
 16247     MOVE -1                     TO PMTTYPEL.
 16248     GO TO 8100-SEND-INITIAL-MAP
 16249
 16250     .
 16251 7110-BUILD-PMT-TRLR.
 16252     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 16253     MOVE +51                    TO TRLR-SEQ-NO
 16254
 16255* EXEC CICS READ
 16256*        DATASET  ('ELTRLR')
 16257*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16258*        RIDFLD   (ELTRLR-KEY)
 16259*        RESP     (WS-RESPONSE)
 16260*    END-EXEC
 16261     MOVE 'ELTRLR' TO DFHEIV1
 16262*    MOVE '&"S        E          (  N#00015022' TO DFHEIV0
 16263     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16264     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16265     MOVE X'204E233030303135303232' TO DFHEIV0(25:11)
 16266     CALL 'kxdfhei1' USING DFHEIV0,
 16267           DFHEIV1,
 16268           DFHEIV20,
 16269           DFHEIV99,
 16270           ELTRLR-KEY,
 16271           DFHEIV99,
 16272           DFHEIV99,
 16273           DFHEIV99
 16274     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16275         DFHEIV20
 16276     MOVE EIBRESP  TO WS-RESPONSE
 16277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16278     IF WS-RESP-NORMAL
 16279        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 16280     END-IF
 16281     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 16282
 16283* EXEC CICS GETMAIN
 16284*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 318
* EL156.cbl
 16285*         LENGTH    (200)
 16286*         INITIMG   (GETMAIN-SPACE)
 16287*     END-EXEC
 16288     MOVE 200
 16289       TO DFHEIV11
 16290*    MOVE ',"IL                  $   #00015032' TO DFHEIV0
 16291     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16292     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16293     MOVE X'2020233030303135303332' TO DFHEIV0(25:11)
 16294     CALL 'kxdfhei1' USING DFHEIV0,
 16295           DFHEIV20,
 16296           DFHEIV11,
 16297           GETMAIN-SPACE
 16298     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16299         DFHEIV20
 16300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16301     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 16302                                    AT-PREV-PAID-THRU-DT
 16303     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 16304     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16305     MOVE 'AT'                   TO AT-RECORD-ID
 16306     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16307     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 16308     MOVE '2'                    TO AT-TRAILER-TYPE
 16309     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16310                                    AT-PAYMENT-LAST-MAINT-DT
 16311     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16312                                    AT-PAYMENT-LAST-UPDATED-BY
 16313     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16314     MOVE 'I'                    TO AT-PAYMENT-TYPE
 16315     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 16316     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 16317     MOVE +0                     TO AT-EXPENSE-PER-PMT
 16318     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 16319     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 16320     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 16321     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 16322     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 16323     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 16324     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 16325     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 16326     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 16327     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 16328     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 16329                                    AT-TO-BE-WRITTEN-DT
 16330     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 16331                                    AT-CHECK-QUE-SEQUENCE
 16332                                    AT-ADDL-RESERVE
 16333     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 16334                                    AT-VOID-SELECT-DT
 16335                                    AT-VOID-ACCEPT-DT
 16336                                    AT-VOID-DT
 16337                                    AT-PMT-PROOF-DT
 16338                                    AT-INT-PMT-SELECT-DT
 16339     MOVE ZEROS                  TO AT-DAILY-RATE
 16340                                    AT-ELIMINATION-DAYS
 16341     MOVE SPACES                 TO AT-BENEFIT-TYPE
 16342*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 319
* EL156.cbl
 16343*        DUPREC    (7120-DUPREC)
 16344*    END-EXEC
 16345     .
 16346 7115-WRITE-INT-TRLR.
 16347
 16348* EXEC CICS WRITE
 16349*         DATASET       ('ELTRLR')
 16350*         FROM          (ACTIVITY-TRAILERS)
 16351*         RIDFLD        (AT-CONTROL-PRIMARY)
 16352*         RESP          (WS-RESPONSE)
 16353*     END-EXEC
 16354     MOVE LENGTH OF
 16355      ACTIVITY-TRAILERS
 16356       TO DFHEIV11
 16357     MOVE 'ELTRLR' TO DFHEIV1
 16358*    MOVE '&$ L                  ''  N#00015083' TO DFHEIV0
 16359     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16360     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16361     MOVE X'204E233030303135303833' TO DFHEIV0(25:11)
 16362     CALL 'kxdfhei1' USING DFHEIV0,
 16363           DFHEIV1,
 16364           ACTIVITY-TRAILERS,
 16365           DFHEIV11,
 16366           AT-CONTROL-PRIMARY,
 16367           DFHEIV99,
 16368           DFHEIV99
 16369     MOVE EIBRESP  TO WS-RESPONSE
 16370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16371      IF WS-RESP-DUPREC
 16372         GO TO 7120-DUPREC
 16373      END-IF
 16374     GO TO 7130-EXIT
 16375     .
 16376 7120-DUPREC.
 16377     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16378     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 16379     GO TO 7115-WRITE-INT-TRLR
 16380     .
 16381 7130-EXIT.
 16382      EXIT.
 16383 7140-BUILD-NOTE-TRLR.
 16384
 16385
 16386* EXEC CICS GETMAIN
 16387*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16388*         LENGTH    (200)
 16389*         INITIMG   (GETMAIN-SPACE)
 16390*     END-EXEC
 16391     MOVE 200
 16392       TO DFHEIV11
 16393*    MOVE ',"IL                  $   #00015103' TO DFHEIV0
 16394     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16395     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16396     MOVE X'2020233030303135313033' TO DFHEIV0(25:11)
 16397     CALL 'kxdfhei1' USING DFHEIV0,
 16398           DFHEIV20,
 16399           DFHEIV11,
 16400           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 320
* EL156.cbl
 16401     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16402         DFHEIV20
 16403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16404     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16405     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16406     MOVE 'AT'                   TO AT-RECORD-ID
 16407     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16408     MOVE '6'                    TO AT-TRAILER-TYPE
 16409     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16410                                    AT-GEN-INFO-LAST-MAINT-DT
 16411     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16412                                    AT-GEN-INFO-LAST-UPDATED-BY
 16413     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16414     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 16415     .
 16416 7150-WRITE.
 16417
 16418* EXEC CICS HANDLE CONDITION
 16419*        DUPREC    (7160-DUPREC)
 16420*    END-EXEC
 16421*    MOVE '"$%                   ! 9 #00015121' TO DFHEIV0
 16422     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16424     MOVE X'3920233030303135313231' TO DFHEIV0(25:11)
 16425     CALL 'kxdfhei1' USING DFHEIV0
 16426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16427
 16428* EXEC CICS WRITE
 16429*         DATASET     ('ELTRLR')
 16430*         FROM        (ACTIVITY-TRAILERS)
 16431*         RIDFLD      (AT-CONTROL-PRIMARY)
 16432*         RESP        (WS-RESPONSE)
 16433*     END-EXEC
 16434     MOVE LENGTH OF
 16435      ACTIVITY-TRAILERS
 16436       TO DFHEIV11
 16437     MOVE 'ELTRLR' TO DFHEIV1
 16438*    MOVE '&$ L                  ''  N#00015124' TO DFHEIV0
 16439     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16440     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16441     MOVE X'204E233030303135313234' TO DFHEIV0(25:11)
 16442     CALL 'kxdfhei1' USING DFHEIV0,
 16443           DFHEIV1,
 16444           ACTIVITY-TRAILERS,
 16445           DFHEIV11,
 16446           AT-CONTROL-PRIMARY,
 16447           DFHEIV99,
 16448           DFHEIV99
 16449     MOVE EIBRESP  TO WS-RESPONSE
 16450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16451      IF WS-RESP-DUPREC
 16452         GO TO 7160-DUPREC
 16453      END-IF
 16454     GO TO 7170-EXIT
 16455     .
 16456 7160-DUPREC.
 16457     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16458     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 321
* EL156.cbl
 16459     GO TO 7150-WRITE
 16460     .
 16461 7170-EXIT.
 16462      EXIT.
 16463
 16464 7180-ADD-CERT-NOTE.
 16465*ADD CERT NOTE FOR SC NP+6
 16466
 16467
 16468* EXEC CICS GETMAIN
 16469*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16470*         LENGTH    (150)
 16471*         INITIMG   (GETMAIN-SPACE)
 16472*     END-EXEC.
 16473     MOVE 150
 16474       TO DFHEIV11
 16475*    MOVE ',"IL                  $   #00015146' TO DFHEIV0
 16476     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16477     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16478     MOVE X'2020233030303135313436' TO DFHEIV0(25:11)
 16479     CALL 'kxdfhei1' USING DFHEIV0,
 16480           DFHEIV20,
 16481           DFHEIV11,
 16482           GETMAIN-SPACE
 16483     SET ADDRESS OF CERT-NOTE-FILE TO
 16484         DFHEIV20
 16485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16486
 16487
 16488     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 16489     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 16490     MOVE +1                     TO WRK-NOTE-SEQ.
 16491     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16492     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16493     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16494     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16495     MOVE CL-CERT-STATE          TO CZ-STATE.
 16496     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16497     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16498     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16499     MOVE '2'                    TO CZ-RECORD-TYPE.
 16500     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16501     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16502     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16503     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16504     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16505     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 16506     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 16507     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 16508     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 16509
 16510 7181-WRITE.
 16511
 16512
 16513* EXEC CICS WRITE
 16514*         DATASET     ('ERCNOT')
 16515*         FROM        (CERT-NOTE-FILE)
 16516*         RIDFLD      (CZ-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 322
* EL156.cbl
 16517*         RESP        (WS-RESPONSE)
 16518*    END-EXEC.
 16519     MOVE LENGTH OF
 16520      CERT-NOTE-FILE
 16521       TO DFHEIV11
 16522     MOVE 'ERCNOT' TO DFHEIV1
 16523*    MOVE '&$ L                  ''  N#00015176' TO DFHEIV0
 16524     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16525     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16526     MOVE X'204E233030303135313736' TO DFHEIV0(25:11)
 16527     CALL 'kxdfhei1' USING DFHEIV0,
 16528           DFHEIV1,
 16529           CERT-NOTE-FILE,
 16530           DFHEIV11,
 16531           CZ-CONTROL-PRIMARY,
 16532           DFHEIV99,
 16533           DFHEIV99
 16534     MOVE EIBRESP  TO WS-RESPONSE
 16535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16536
 16537
 16538     IF WS-RESP-DUPREC
 16539         GO TO 7182-DUPREC
 16540     END-IF.
 16541
 16542     SET CERT-NOTE-ADDED TO TRUE.
 16543
 16544     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 16545         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 16546     END-IF.
 16547
 16548     GO TO 7189-EXIT.
 16549
 16550 7182-DUPREC.
 16551
 16552     ADD +1                      TO  WRK-NOTE-SEQ.
 16553     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16554     GO TO 7181-WRITE.
 16555
 16556 7189-EXIT.
 16557      EXIT.
 16558
 16559 7190-ADD-ORIG-NOTE.
 16560
 16561
 16562* EXEC CICS GETMAIN
 16563*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16564*         LENGTH    (150)
 16565*         INITIMG   (GETMAIN-SPACE)
 16566*     END-EXEC.
 16567     MOVE 150
 16568       TO DFHEIV11
 16569*    MOVE ',"IL                  $   #00015206' TO DFHEIV0
 16570     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16571     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16572     MOVE X'2020233030303135323036' TO DFHEIV0(25:11)
 16573     CALL 'kxdfhei1' USING DFHEIV0,
 16574           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 323
* EL156.cbl
 16575           DFHEIV11,
 16576           GETMAIN-SPACE
 16577     SET ADDRESS OF CERT-NOTE-FILE TO
 16578         DFHEIV20
 16579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16580
 16581
 16582     ADD +1                      TO WRK-NOTE-SEQ.
 16583     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16584     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16585     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16586     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16587     MOVE CL-CERT-STATE          TO CZ-STATE.
 16588     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16589     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16590     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16591     MOVE '2'                    TO CZ-RECORD-TYPE.
 16592     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16593     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16594     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16595     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16596     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16597     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 16598
 16599 7191-WRITE.
 16600
 16601
 16602* EXEC CICS WRITE
 16603*         DATASET     ('ERCNOT')
 16604*         FROM        (CERT-NOTE-FILE)
 16605*         RIDFLD      (CZ-CONTROL-PRIMARY)
 16606*         RESP        (WS-RESPONSE)
 16607*    END-EXEC.
 16608     MOVE LENGTH OF
 16609      CERT-NOTE-FILE
 16610       TO DFHEIV11
 16611     MOVE 'ERCNOT' TO DFHEIV1
 16612*    MOVE '&$ L                  ''  N#00015231' TO DFHEIV0
 16613     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16614     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16615     MOVE X'204E233030303135323331' TO DFHEIV0(25:11)
 16616     CALL 'kxdfhei1' USING DFHEIV0,
 16617           DFHEIV1,
 16618           CERT-NOTE-FILE,
 16619           DFHEIV11,
 16620           CZ-CONTROL-PRIMARY,
 16621           DFHEIV99,
 16622           DFHEIV99
 16623     MOVE EIBRESP  TO WS-RESPONSE
 16624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16625
 16626
 16627     IF WS-RESP-DUPREC
 16628         GO TO 7192-DUPREC
 16629     END-IF.
 16630
 16631     GO TO 7199-EXIT.
 16632
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 324
* EL156.cbl
 16633 7192-DUPREC.
 16634
 16635     ADD +1                      TO  WRK-NOTE-SEQ.
 16636     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16637     GO TO 7191-WRITE.
 16638
 16639 7199-EXIT.
 16640      EXIT.
 16641 7200-FIND-BENEFIT.
 16642     MOVE 'N' TO WS-BEN-SEARCH-SW.
 16643
 16644
 16645* EXEC CICS HANDLE CONDITION
 16646*        ENDFILE(7200-EXIT)
 16647*        NOTFND(7200-EXIT)
 16648*    END-EXEC.
 16649*    MOVE '"$''I                  ! : #00015255' TO DFHEIV0
 16650     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16652     MOVE X'3A20233030303135323535' TO DFHEIV0(25:11)
 16653     CALL 'kxdfhei1' USING DFHEIV0
 16654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16655
 16656
 16657
 16658* EXEC CICS READ
 16659*        DATASET('ELCNTL')
 16660*        SET(ADDRESS OF CONTROL-FILE)
 16661*        RIDFLD(ELCNTL-KEY)
 16662*        GTEQ
 16663*    END-EXEC.
 16664     MOVE 'ELCNTL' TO DFHEIV1
 16665*    MOVE '&"S        G          (   #00015260' TO DFHEIV0
 16666     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16668     MOVE X'2020233030303135323630' TO DFHEIV0(25:11)
 16669     CALL 'kxdfhei1' USING DFHEIV0,
 16670           DFHEIV1,
 16671           DFHEIV20,
 16672           DFHEIV99,
 16673           ELCNTL-KEY,
 16674           DFHEIV99,
 16675           DFHEIV99,
 16676           DFHEIV99
 16677     SET ADDRESS OF CONTROL-FILE TO
 16678         DFHEIV20
 16679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16680
 16681
 16682     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 16683        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 16684           GO TO 7200-EXIT.
 16685
 16686     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 16687         VARYING SUB-1 FROM 1 BY 1 UNTIL
 16688            ((SUB-1 > 8) OR
 16689            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 16690
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 325
* EL156.cbl
 16691     IF SUB-1 NOT = 9
 16692         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 16693
 16694     GO TO 7200-EXIT.
 16695
 16696 7200-BENEFIT-DUMMY.
 16697
 16698 7200-DUMMY-EXIT.
 16699     EXIT.
 16700
 16701 7200-EXIT.
 16702     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 326
* EL156.cbl
 16704*052506
 16705*052506 7250-FIND-LETTER-TRLR.
 16706*052506     EXEC CICS HANDLE CONDITION
 16707*052506         ENDFILE  (7250-END)
 16708*052506         NOTFND   (7250-END)
 16709*052506     END-EXEC.
 16710*052506
 16711*052506     EXEC CICS STARTBR
 16712*052506         DATASET   ('ELTRLR')
 16713*052506         RIDFLD    (ELTRLR-KEY)
 16714*052506         GTEQ
 16715*052506     END-EXEC.
 16716*052506
 16717*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 16718*052506
 16719*052506 7250-FIND-LOOP.
 16720*052506     EXEC CICS READNEXT
 16721*052506         DATASET   ('ELTRLR')
 16722*052506         RIDFLD    (ELTRLR-KEY)
 16723*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16724*052506     END-EXEC.
 16725*052506
 16726*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 16727*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 16728*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 16729*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 16730*052506        GO TO 7250-END
 16731*052506     END-IF.
 16732*052506
 16733*052506     IF AT-TRAILER-TYPE NOT = '4'
 16734*052506         GO TO 7250-FIND-LOOP
 16735*052506     END-IF.
 16736*052506
 16737*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 16738*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 16739*052506     END-IF.
 16740*052506
 16741*052506     GO TO 7250-FIND-LOOP.
 16742*052506
 16743*052506 7250-END.
 16744*052506
 16745*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 16746*051506         MOVE SPACES             TO  DC-OPTION-CODE
 16747*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 16748*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16749*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 16750*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 16751*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 16752*052506     END-IF.
 16753*052506
 16754*052506     EXEC CICS ENDBR
 16755*052506          DATASET    ('ELTRLR')
 16756*052506     END-EXEC.
 16757*052506
 16758*052506 7250-EXIT.
 16759*052506     EXIT.
 16760*052506     EJECT
 16761*052506
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 327
* EL156.cbl
 16762 7300-CHECK-AUTO-ACTIVITY.
 16763
 16764     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 16765         NEXT SENTENCE
 16766     ELSE
 16767         GO TO 7399-EXIT.
 16768
 16769     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 16770
 16771     IF WS-ACT-REC-FOUND-SW = 'N'
 16772         GO TO 7399-EXIT.
 16773
 16774     IF PI-ACTIVITY-CODE = 09
 16775         GO TO 7300-CONT-AUTO-ACTIVITY.
 16776
 16777     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 16778        (PI-ACTIVITY-CODE = 11)
 16779         GO TO 7300-CONT-AUTO-ACTIVITY.
 16780
 16781     IF PI-PROVISIONAL-IND = 'P'
 16782         IF PI-PMTTYPE = '1'
 16783             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 16784                 MOVE 'N'    TO  PI-RESET-SW
 16785                 GO TO 7399-EXIT.
 16786
 16787     IF PI-PMTTYPE = '1'
 16788         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 16789             MOVE 'N'        TO  PI-RESET-SW
 16790             GO TO 7399-EXIT.
 16791
 16792     IF PI-PMTTYPE = '2' OR '3'
 16793         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 16794             MOVE 'N'        TO  PI-RESET-SW
 16795             GO TO 7399-EXIT.
 16796
 16797     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16798         IF PI-PROVISIONAL-IND = 'P'
 16799             NEXT SENTENCE
 16800         ELSE
 16801             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 16802
 16803 7300-CONT-AUTO-ACTIVITY.
 16804
 16805     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16806         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 16807         MOVE '4'            TO DC-OPTION-CODE
 16808         MOVE +0             TO DC-ELAPSED-DAYS
 16809                                DC-ELAPSED-MONTHS
 16810         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16811         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 16812         IF PI-USES-PAID-TO
 16813             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16814             IF NO-CONVERSION-ERROR
 16815                 MOVE +1     TO DC-ELAPSED-DAYS
 16816                 MOVE +0     TO DC-ELAPSED-MONTHS
 16817                 MOVE '6'    TO DC-OPTION-CODE
 16818                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16819                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 328
* EL156.cbl
 16820                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 16821
 16822     IF PI-PFKEY-USED = DFHPF5
 16823         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 16824         IF PI-USES-PAID-TO
 16825             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 16826             MOVE +1                  TO DC-ELAPSED-DAYS
 16827             MOVE +0                  TO DC-ELAPSED-MONTHS
 16828             MOVE '6'                 TO DC-OPTION-CODE
 16829             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16830             IF NO-CONVERSION-ERROR
 16831                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 16832
 16833     IF WS-CHK-THRU-DT < PI-EXP-DT
 16834         NEXT SENTENCE
 16835     ELSE
 16836         MOVE 03                     TO  WS-ACTIVITY-CODE
 16837         GO TO 7390-PROCESS-ACTIVITY.
 16838
 16839     IF PI-PROV-PMT
 16840         MOVE 09                     TO  WS-ACTIVITY-CODE
 16841     ELSE
 16842        IF PI-PMTTYPE = '1'
 16843            MOVE 02                  TO  WS-ACTIVITY-CODE
 16844        ELSE
 16845        IF PI-PMTTYPE = '2' OR '3'
 16846            MOVE 07                  TO  WS-ACTIVITY-CODE
 16847        ELSE
 16848        IF PI-PMTTYPE = '4'
 16849            MOVE 00                  TO  WS-ACTIVITY-CODE
 16850        ELSE
 16851            MOVE 'N'                 TO  PI-RESET-SW
 16852            GO TO 7399-EXIT.
 16853
 16854 7390-PROCESS-ACTIVITY.
 16855
 16856     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 16857
 16858 7399-EXIT.
 16859     EXIT.
 16860
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 329
* EL156.cbl
 16862 7400-CHECK-AUTO-ACTIVITY.
 16863
 16864
 16865* EXEC CICS HANDLE CONDITION
 16866*        NOTFND   (7400-NOT-FOUND)
 16867*    END-EXEC.
 16868*    MOVE '"$I                   ! ; #00015449' TO DFHEIV0
 16869     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16871     MOVE X'3B20233030303135343439' TO DFHEIV0(25:11)
 16872     CALL 'kxdfhei1' USING DFHEIV0
 16873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16874
 16875
 16876     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 16877     MOVE 'T'                    TO  CNTL-REC-TYPE.
 16878     MOVE SPACES                 TO  CNTL-ACCESS.
 16879     MOVE +0                     TO  CNTL-SEQ-NO.
 16880
 16881
 16882* EXEC CICS READ
 16883*        DATASET   ('ELCNTL')
 16884*        RIDFLD    (ELCNTL-KEY)
 16885*        SET       (ADDRESS OF CONTROL-FILE)
 16886*    END-EXEC.
 16887     MOVE 'ELCNTL' TO DFHEIV1
 16888*    MOVE '&"S        E          (   #00015458' TO DFHEIV0
 16889     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16891     MOVE X'2020233030303135343538' TO DFHEIV0(25:11)
 16892     CALL 'kxdfhei1' USING DFHEIV0,
 16893           DFHEIV1,
 16894           DFHEIV20,
 16895           DFHEIV99,
 16896           ELCNTL-KEY,
 16897           DFHEIV99,
 16898           DFHEIV99,
 16899           DFHEIV99
 16900     SET ADDRESS OF CONTROL-FILE TO
 16901         DFHEIV20
 16902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16903
 16904
 16905     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 16906     GO TO 7400-EXIT.
 16907
 16908 7400-NOT-FOUND.
 16909     MOVE 'N'                        TO  PI-RESET-SW
 16910                                         WS-LETTER-SW
 16911                                         WS-ACT-REC-FOUND-SW.
 16912
 16913     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16914
 16915 7400-EXIT.
 16916     EXIT.
 16917
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 330
* EL156.cbl
 16919 7450-FORMAT-AUTO-LETTER.
 16920
 16921     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 16922         MOVE 'Y'                    TO PI-RESET-SW
 16923         GO TO 7450-CONTINUE-PROCESS.
 16924
 16925     MOVE PI-ACTIVITY-CODE           TO  SUB.
 16926
 16927     IF SUB > 9
 16928         SUBTRACT 9 FROM SUB
 16929         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 16930     ELSE
 16931         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 16932
 16933 7450-CONTINUE-PROCESS.
 16934
 16935     IF WS-ACTIVITY-CODE = ZEROS
 16936         MOVE 'N'                    TO  WS-LETTER-SW
 16937         GO TO 7499-EXIT.
 16938
 16939     MOVE WS-ACTIVITY-CODE           TO  SUB.
 16940
 16941     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 16942         MOVE 'N'                    TO  PI-RESET-SW
 16943                                         WS-LETTER-SW
 16944         GO TO 7499-EXIT.
 16945
 16946     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 16947         MOVE 'N'                    TO  WS-LETTER-SW
 16948         GO TO 7499-EXIT.
 16949
 16950     MOVE 'Y'                        TO  WS-LETTER-SW.
 16951     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16952     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16953
 16954     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 16955
 16956     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 16957         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 16958         MOVE '6'                    TO  DC-OPTION-CODE
 16959         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 16960         MOVE +0                     TO  DC-ELAPSED-MONTHS
 16961         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16962         IF NO-CONVERSION-ERROR
 16963             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 16964         ELSE
 16965              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 16966
 16967     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 16968         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 16969         MOVE '6'                    TO  DC-OPTION-CODE
 16970         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 16971         MOVE +0                     TO  DC-ELAPSED-MONTHS
 16972         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16973         IF NO-CONVERSION-ERROR
 16974             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 16975         ELSE
 16976             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 331
* EL156.cbl
 16977
 16978 7499-EXIT.
 16979     EXIT.
 16980
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 332
* EL156.cbl
 16982 7500-RESET-AUTO-ACTIVITY.
 16983
 16984     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 16985     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 16986     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 16987     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 16988     MOVE +100                   TO  TRLR-SEQ-NO.
 16989
 16990 7500-STARTBR-TRLR.
 16991
 16992
 16993* EXEC CICS HANDLE CONDITION
 16994*        ENDFILE  (7590-END)
 16995*        NOTFND   (7590-END)
 16996*    END-EXEC.
 16997*    MOVE '"$''I                  ! < #00015551' TO DFHEIV0
 16998     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17000     MOVE X'3C20233030303135353531' TO DFHEIV0(25:11)
 17001     CALL 'kxdfhei1' USING DFHEIV0
 17002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17003
 17004
 17005
 17006* EXEC CICS STARTBR
 17007*        DATASET   ('ELTRLR')
 17008*        RIDFLD    (ELTRLR-KEY)
 17009*        GTEQ
 17010*    END-EXEC.
 17011     MOVE 'ELTRLR' TO DFHEIV1
 17012     MOVE 0
 17013       TO DFHEIV11
 17014*    MOVE '&,         G          &   #00015556' TO DFHEIV0
 17015     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17016     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17017     MOVE X'2020233030303135353536' TO DFHEIV0(25:11)
 17018     CALL 'kxdfhei1' USING DFHEIV0,
 17019           DFHEIV1,
 17020           ELTRLR-KEY,
 17021           DFHEIV99,
 17022           DFHEIV11,
 17023           DFHEIV99
 17024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17025
 17026
 17027     MOVE 'Y'                        TO  WS-BROWSE-SW.
 17028
 17029 7500-READ-NEXT.
 17030
 17031
 17032* EXEC CICS READNEXT
 17033*        DATASET   ('ELTRLR')
 17034*        RIDFLD    (ELTRLR-KEY)
 17035*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17036*    END-EXEC.
 17037     MOVE 'ELTRLR' TO DFHEIV1
 17038     MOVE 0
 17039       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 333
* EL156.cbl
 17040*    MOVE '&.S                   )   #00015566' TO DFHEIV0
 17041     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17042     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17043     MOVE X'2020233030303135353636' TO DFHEIV0(25:11)
 17044     CALL 'kxdfhei1' USING DFHEIV0,
 17045           DFHEIV1,
 17046           DFHEIV20,
 17047           DFHEIV99,
 17048           ELTRLR-KEY,
 17049           DFHEIV99,
 17050           DFHEIV11,
 17051           DFHEIV99,
 17052           DFHEIV99
 17053     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17054         DFHEIV20
 17055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17056
 17057
 17058     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17059        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17060        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17061        PI-CERT-NO    NOT = TRLR-CERT-NO
 17062         GO TO 7590-END.
 17063
 17064     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 17065         GO TO 7500-READ-NEXT.
 17066
 17067     IF AT-TRAILER-TYPE NOT = '4'
 17068         GO TO 7500-READ-NEXT.
 17069
 17070     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 17071         GO TO 7500-READ-NEXT.
 17072
 17073     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 17074        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 17075         GO TO 7500-READ-NEXT.
 17076
 17077     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 17078        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 17079        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 17080         GO TO 7500-READ-NEXT.
 17081
 17082     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 17083                         AND
 17084        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 17085                         AND
 17086        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 17087            GO TO 7500-READ-NEXT.
 17088
 17089     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 17090
 17091
 17092* EXEC CICS ENDBR
 17093*        DATASET   ('ELTRLR')
 17094*    END-EXEC.
 17095     MOVE 'ELTRLR' TO DFHEIV1
 17096     MOVE 0
 17097       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 334
* EL156.cbl
 17098*    MOVE '&2                    $   #00015605' TO DFHEIV0
 17099     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17100     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17101     MOVE X'2020233030303135363035' TO DFHEIV0(25:11)
 17102     CALL 'kxdfhei1' USING DFHEIV0,
 17103           DFHEIV1,
 17104           DFHEIV11,
 17105           DFHEIV99
 17106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17107
 17108
 17109     MOVE 'N'                        TO  WS-BROWSE-SW.
 17110
 17111
 17112* EXEC CICS READ
 17113*        DATASET   ('ELTRLR')
 17114*        RIDFLD    (ELTRLR-KEY)
 17115*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17116*        UPDATE
 17117*    END-EXEC.
 17118     MOVE 'ELTRLR' TO DFHEIV1
 17119*    MOVE '&"S        EU         (   #00015611' TO DFHEIV0
 17120     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17121     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17122     MOVE X'2020233030303135363131' TO DFHEIV0(25:11)
 17123     CALL 'kxdfhei1' USING DFHEIV0,
 17124           DFHEIV1,
 17125           DFHEIV20,
 17126           DFHEIV99,
 17127           ELTRLR-KEY,
 17128           DFHEIV99,
 17129           DFHEIV99,
 17130           DFHEIV99
 17131     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17132         DFHEIV20
 17133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17134
 17135
 17136     MOVE 'Y'                        TO  WS-UPDATE-SW.
 17137
 17138     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 17139         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 17140     ELSE
 17141         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 17142             NEXT SENTENCE
 17143         ELSE
 17144             GO TO 7500-REWRITE-TRLR.
 17145
 17146     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 17147
 17148     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 17149     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 17150     MOVE '1'                        TO  ARCH-REC-TYPE.
 17151     MOVE +0                         TO  ARCH-SEQ.
 17152
 17153     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 17154
 17155 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 335
* EL156.cbl
 17156
 17157
 17158* EXEC CICS REWRITE
 17159*        DATASET   ('ELTRLR')
 17160*        FROM      (ACTIVITY-TRAILERS)
 17161*    END-EXEC.
 17162     MOVE LENGTH OF
 17163      ACTIVITY-TRAILERS
 17164       TO DFHEIV11
 17165     MOVE 'ELTRLR' TO DFHEIV1
 17166*    MOVE '&& L                  %   #00015639' TO DFHEIV0
 17167     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17168     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17169     MOVE X'2020233030303135363339' TO DFHEIV0(25:11)
 17170     CALL 'kxdfhei1' USING DFHEIV0,
 17171           DFHEIV1,
 17172           ACTIVITY-TRAILERS,
 17173           DFHEIV11,
 17174           DFHEIV99
 17175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17176
 17177
 17178     GO TO 7500-STARTBR-TRLR.
 17179
 17180 7590-END.
 17181
 17182     IF WS-BROWSE-SW = 'Y'
 17183         MOVE 'N'                    TO  WS-BROWSE-SW
 17184
 17185* EXEC CICS ENDBR
 17186*            DATASET   ('ELTRLR')
 17187*        END-EXEC.
 17188     MOVE 'ELTRLR' TO DFHEIV1
 17189     MOVE 0
 17190       TO DFHEIV11
 17191*    MOVE '&2                    $   #00015650' TO DFHEIV0
 17192     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17193     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17194     MOVE X'2020233030303135363530' TO DFHEIV0(25:11)
 17195     CALL 'kxdfhei1' USING DFHEIV0,
 17196           DFHEIV1,
 17197           DFHEIV11,
 17198           DFHEIV99
 17199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17200
 17201
 17202 7599-EXIT.
 17203     EXIT.
 17204
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 336
* EL156.cbl
 17206 7600-READ-ARCH-UPDATE.
 17207
 17208
 17209* EXEC CICS HANDLE CONDITION
 17210*        NOTFND   (7699-EXIT)
 17211*    END-EXEC.
 17212*    MOVE '"$I                   ! = #00015660' TO DFHEIV0
 17213     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17215     MOVE X'3D20233030303135363630' TO DFHEIV0(25:11)
 17216     CALL 'kxdfhei1' USING DFHEIV0
 17217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17218
 17219
 17220
 17221* EXEC CICS READ
 17222*        DATASET   ('ELARCH')
 17223*        RIDFLD    (ELARCH-KEY)
 17224*        SET       (ADDRESS OF LETTER-ARCHIVE)
 17225*        UPDATE
 17226*    END-EXEC.
 17227     MOVE 'ELARCH' TO DFHEIV1
 17228*    MOVE '&"S        EU         (   #00015664' TO DFHEIV0
 17229     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17230     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17231     MOVE X'2020233030303135363634' TO DFHEIV0(25:11)
 17232     CALL 'kxdfhei1' USING DFHEIV0,
 17233           DFHEIV1,
 17234           DFHEIV20,
 17235           DFHEIV99,
 17236           ELARCH-KEY,
 17237           DFHEIV99,
 17238           DFHEIV99,
 17239           DFHEIV99
 17240     SET ADDRESS OF LETTER-ARCHIVE TO
 17241         DFHEIV20
 17242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17243
 17244
 17245     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 17246
 17247
 17248* EXEC CICS REWRITE
 17249*        DATASET   ('ELARCH')
 17250*        FROM      (LETTER-ARCHIVE)
 17251*    END-EXEC.
 17252     MOVE LENGTH OF
 17253      LETTER-ARCHIVE
 17254       TO DFHEIV11
 17255     MOVE 'ELARCH' TO DFHEIV1
 17256*    MOVE '&& L                  %   #00015673' TO DFHEIV0
 17257     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17258     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17259     MOVE X'2020233030303135363733' TO DFHEIV0(25:11)
 17260     CALL 'kxdfhei1' USING DFHEIV0,
 17261           DFHEIV1,
 17262           LETTER-ARCHIVE,
 17263           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 337
* EL156.cbl
 17264           DFHEIV99
 17265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17266
 17267
 17268 7699-EXIT.
 17269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 338
* EL156.cbl
 17271 7700-GET-DCT.
 17272
 17273     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 17274     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 17275     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 17276     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 17277                                    PI-MAX-BENEFIT-AMT
 17278                                    PI-MAX-BENEFIT-PYMT
 17279                                    PI-MIN-PAYMENT-AMT
 17280                                    PI-TIME-OF-LOSS-BAL.
 17281
 17282
 17283* EXEC CICS HANDLE CONDITION
 17284*         NOTFND (5300-NOTE-NOT-FOUND)
 17285*     END-EXEC.
 17286*    MOVE '"$I                   ! > #00015692' TO DFHEIV0
 17287     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17289     MOVE X'3E20233030303135363932' TO DFHEIV0(25:11)
 17290     CALL 'kxdfhei1' USING DFHEIV0
 17291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17292
 17293
 17294
 17295* EXEC CICS READ
 17296*         DATASET('ERNOTE')
 17297*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 17298*         RIDFLD (W-NOTE-KEY)
 17299*     END-EXEC.
 17300     MOVE 'ERNOTE' TO DFHEIV1
 17301*    MOVE '&"S        E          (   #00015696' TO DFHEIV0
 17302     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17304     MOVE X'2020233030303135363936' TO DFHEIV0(25:11)
 17305     CALL 'kxdfhei1' USING DFHEIV0,
 17306           DFHEIV1,
 17307           DFHEIV20,
 17308           DFHEIV99,
 17309           W-NOTE-KEY,
 17310           DFHEIV99,
 17311           DFHEIV99,
 17312           DFHEIV99
 17313     SET ADDRESS OF CERTIFICATE-NOTE TO
 17314         DFHEIV20
 17315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17316
 17317
 17318     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 17319     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 17320     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 17321     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 17322     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 17323
 17324     IF PI-PAYEE-TYPE NOT = 'B'
 17325         GO TO 7700-EXIT.
 17326
 17327     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 17328     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 339
* EL156.cbl
 17329     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 17330
 17331     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 17332         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 17333     ELSE
 17334         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 17335
 17336     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 17337     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 17338     MOVE 'DLO006'               TO PGM-NAME.
 17339
 17340
 17341* EXEC CICS LINK
 17342*        PROGRAM    (PGM-NAME)
 17343*        COMMAREA   (DCT-COMMUNICATION-AREA)
 17344*        LENGTH     (DCT-RCRD-LENGTH)
 17345*    END-EXEC.
 17346*    MOVE '."C                   ''   #00015724' TO DFHEIV0
 17347     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17348     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17349     MOVE X'2020233030303135373234' TO DFHEIV0(25:11)
 17350     CALL 'kxdfhei1' USING DFHEIV0,
 17351           PGM-NAME,
 17352           DCT-COMMUNICATION-AREA,
 17353           DCT-RCRD-LENGTH,
 17354           DFHEIV99,
 17355           DFHEIV99,
 17356           DFHEIV99
 17357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17358
 17359
 17360     IF DCT-RETURN-CODE = 'OK'
 17361         GO TO 7700-CONT.
 17362
 17363     IF DCT-RETURN-CODE = '01' OR '02'
 17364         GO TO 7700-SET-TO-YES.
 17365
 17366     IF DCT-RETURN-CODE = '03'
 17367
 17368* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17369*    MOVE '6"R                   !   #00015737' TO DFHEIV0
 17370     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17372     MOVE X'2020233030303135373337' TO DFHEIV0(25:11)
 17373     CALL 'kxdfhei1' USING DFHEIV0
 17374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17375         MOVE ER-0951            TO EMI-ERROR
 17376         MOVE -1                 TO PMTTYPEL
 17377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17378         GO TO 8200-SEND-DATAONLY.
 17379
 17380     IF DCT-RETURN-CODE = '04'
 17381
 17382* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17383*    MOVE '6"R                   !   #00015744' TO DFHEIV0
 17384     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17386     MOVE X'2020233030303135373434' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 340
* EL156.cbl
 17387     CALL 'kxdfhei1' USING DFHEIV0
 17388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17389         MOVE ER-0946            TO EMI-ERROR
 17390         MOVE -1                 TO PMTTYPEL
 17391         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17392         GO TO 8200-SEND-DATAONLY.
 17393
 17394     IF DCT-RETURN-CODE = '05'
 17395
 17396* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17397*    MOVE '6"R                   !   #00015751' TO DFHEIV0
 17398     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17400     MOVE X'2020233030303135373531' TO DFHEIV0(25:11)
 17401     CALL 'kxdfhei1' USING DFHEIV0
 17402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17403         MOVE ER-0947            TO EMI-ERROR
 17404         MOVE -1                 TO PMTTYPEL
 17405         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17406         GO TO 8200-SEND-DATAONLY.
 17407
 17408     IF DCT-RETURN-CODE = '06'
 17409
 17410* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17411*    MOVE '6"R                   !   #00015758' TO DFHEIV0
 17412     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17414     MOVE X'2020233030303135373538' TO DFHEIV0(25:11)
 17415     CALL 'kxdfhei1' USING DFHEIV0
 17416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17417         MOVE ER-0921            TO EMI-ERROR
 17418         MOVE -1                 TO PMTTYPEL
 17419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17420         GO TO 8200-SEND-DATAONLY.
 17421
 17422     IF DCT-RETURN-CODE = '07'
 17423
 17424* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17425*    MOVE '6"R                   !   #00015765' TO DFHEIV0
 17426     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17428     MOVE X'2020233030303135373635' TO DFHEIV0(25:11)
 17429     CALL 'kxdfhei1' USING DFHEIV0
 17430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17431         MOVE ER-0919            TO EMI-ERROR
 17432         MOVE -1                 TO PMTTYPEL
 17433         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17434         GO TO 8200-SEND-DATAONLY.
 17435
 17436     IF DCT-RETURN-CODE = '08'
 17437
 17438* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17439*    MOVE '6"R                   !   #00015772' TO DFHEIV0
 17440     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17442     MOVE X'2020233030303135373732' TO DFHEIV0(25:11)
 17443     CALL 'kxdfhei1' USING DFHEIV0
 17444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 341
* EL156.cbl
 17445         MOVE ER-0948            TO EMI-ERROR
 17446         MOVE -1                 TO PMTTYPEL
 17447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17448         GO TO 8200-SEND-DATAONLY.
 17449
 17450     IF DCT-RETURN-CODE = 'N1'
 17451
 17452* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17453*    MOVE '6"R                   !   #00015779' TO DFHEIV0
 17454     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17456     MOVE X'2020233030303135373739' TO DFHEIV0(25:11)
 17457     CALL 'kxdfhei1' USING DFHEIV0
 17458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17459         MOVE ER-0950            TO EMI-ERROR
 17460         MOVE -1                 TO PMTTYPEL
 17461         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17462         GO TO 8200-SEND-DATAONLY.
 17463
 17464     IF DCT-RETURN-CODE = 'E1'
 17465
 17466* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17467*    MOVE '6"R                   !   #00015786' TO DFHEIV0
 17468     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17469     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17470     MOVE X'2020233030303135373836' TO DFHEIV0(25:11)
 17471     CALL 'kxdfhei1' USING DFHEIV0
 17472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17473         MOVE ER-0974            TO EMI-ERROR
 17474         MOVE -1                 TO PMTTYPEL
 17475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17476         GO TO 8200-SEND-DATAONLY.
 17477
 17478     IF DCT-RETURN-CODE = 'E2'
 17479
 17480* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17481*    MOVE '6"R                   !   #00015793' TO DFHEIV0
 17482     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17484     MOVE X'2020233030303135373933' TO DFHEIV0(25:11)
 17485     CALL 'kxdfhei1' USING DFHEIV0
 17486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17487         MOVE ER-0975            TO EMI-ERROR
 17488         MOVE -1                 TO PMTTYPEL
 17489         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17490         GO TO 8200-SEND-DATAONLY.
 17491
 17492     IF DCT-RETURN-CODE NOT = 'OK'
 17493
 17494* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17495*    MOVE '6"R                   !   #00015800' TO DFHEIV0
 17496     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17498     MOVE X'2020233030303135383030' TO DFHEIV0(25:11)
 17499     CALL 'kxdfhei1' USING DFHEIV0
 17500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17501         MOVE ER-0949            TO EMI-ERROR
 17502         MOVE -1                 TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 342
* EL156.cbl
 17503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17504         GO TO 8200-SEND-DATAONLY.
 17505
 17506 7700-CONT.
 17507
 17508     MOVE 'N'                    TO CASHO.
 17509     MOVE +1                     TO CASHL.
 17510     MOVE AL-UANON               TO CASHA.
 17511
 17512     IF PI-OFFLINE = 'Y'
 17513         GO TO 7700-EXIT.
 17514
 17515     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 17516     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 17517     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 17518     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 17519     MOVE +7                     TO CHECKNOL.
 17520     MOVE AL-UANON               TO CHECKNOA.
 17521     GO TO 7700-EXIT.
 17522
 17523 7700-SET-TO-YES.
 17524
 17525     MOVE 'Y'                    TO CASHO.
 17526     MOVE +1                     TO CASHL.
 17527     MOVE AL-UANON               TO CASHA.
 17528
 17529 7700-EXIT.
 17530     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 343
* EL156.cbl
 17532 7800-READ-COMP-MSTR.
 17533
 17534
 17535* EXEC CICS HANDLE CONDITION
 17536*        NOTFND   (7800-COMP-NOTFND)
 17537*    END-EXEC.
 17538*    MOVE '"$I                   ! ? #00015834' TO DFHEIV0
 17539     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17541     MOVE X'3F20233030303135383334' TO DFHEIV0(25:11)
 17542     CALL 'kxdfhei1' USING DFHEIV0
 17543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17544
 17545
 17546
 17547* EXEC CICS READ
 17548*        DATASET   ('ERCOMP')
 17549*        RIDFLD    (ERCOMP-KEY)
 17550*        SET       (ADDRESS OF COMPENSATION-MASTER)
 17551*    END-EXEC.
 17552     MOVE 'ERCOMP' TO DFHEIV1
 17553*    MOVE '&"S        E          (   #00015838' TO DFHEIV0
 17554     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17555     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17556     MOVE X'2020233030303135383338' TO DFHEIV0(25:11)
 17557     CALL 'kxdfhei1' USING DFHEIV0,
 17558           DFHEIV1,
 17559           DFHEIV20,
 17560           DFHEIV99,
 17561           ERCOMP-KEY,
 17562           DFHEIV99,
 17563           DFHEIV99,
 17564           DFHEIV99
 17565     SET ADDRESS OF COMPENSATION-MASTER TO
 17566         DFHEIV20
 17567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17568
 17569
 17570     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 17571     GO TO 7800-COMP-EXIT.
 17572
 17573 7800-COMP-NOTFND.
 17574     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 17575
 17576 7800-COMP-EXIT.
 17577     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 344
* EL156.cbl
 17579 7900-READ-CLAIM.
 17580
 17581* EXEC CICS READ
 17582*        DATASET  ('ELMSTR')
 17583*        SET      (ADDRESS OF CLAIM-MASTER)
 17584*        RIDFLD   (ELMSTR-KEY)
 17585*    END-EXEC.
 17586     MOVE 'ELMSTR' TO DFHEIV1
 17587*    MOVE '&"S        E          (   #00015854' TO DFHEIV0
 17588     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17590     MOVE X'2020233030303135383534' TO DFHEIV0(25:11)
 17591     CALL 'kxdfhei1' USING DFHEIV0,
 17592           DFHEIV1,
 17593           DFHEIV20,
 17594           DFHEIV99,
 17595           ELMSTR-KEY,
 17596           DFHEIV99,
 17597           DFHEIV99,
 17598           DFHEIV99
 17599     SET ADDRESS OF CLAIM-MASTER TO
 17600         DFHEIV20
 17601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17602
 17603
 17604 7900-EXIT.
 17605      EXIT.
 17606
 17607 7910-READ-CLAIM-UPDATE.
 17608
 17609* EXEC CICS READ
 17610*        DATASET  ('ELMSTR')
 17611*        SET      (ADDRESS OF CLAIM-MASTER)
 17612*        RIDFLD   (ELMSTR-KEY)
 17613*        UPDATE
 17614*    END-EXEC.
 17615     MOVE 'ELMSTR' TO DFHEIV1
 17616*    MOVE '&"S        EU         (   #00015864' TO DFHEIV0
 17617     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17618     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17619     MOVE X'2020233030303135383634' TO DFHEIV0(25:11)
 17620     CALL 'kxdfhei1' USING DFHEIV0,
 17621           DFHEIV1,
 17622           DFHEIV20,
 17623           DFHEIV99,
 17624           ELMSTR-KEY,
 17625           DFHEIV99,
 17626           DFHEIV99,
 17627           DFHEIV99
 17628     SET ADDRESS OF CLAIM-MASTER TO
 17629         DFHEIV20
 17630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17631
 17632
 17633 7910-EXIT.
 17634      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 345
* EL156.cbl
 17636 7920-READ-BENE.
 17637     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 17638     MOVE 'B'                TO BENE-RECORD-TYPE.
 17639     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 17640
 17641     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17642        IF PI-PAYEE-TYPE    = 'B' AND
 17643           PI-PAYEE-SEQ-NUM = 9
 17644             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 17645             MOVE WS-A-BENE           TO BENE-NUMBER.
 17646
 17647
 17648* EXEC CICS HANDLE CONDITION
 17649*        NOTFND   (7920-NOT-FOUND)
 17650*    END-EXEC.
 17651*    MOVE '"$I                   ! @ #00015885' TO DFHEIV0
 17652     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17653     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17654     MOVE X'4020233030303135383835' TO DFHEIV0(25:11)
 17655     CALL 'kxdfhei1' USING DFHEIV0
 17656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17657
 17658
 17659
 17660* EXEC CICS READ
 17661*        DATASET  ('ELBENE')
 17662*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 17663*        RIDFLD   (ELBENE-KEY)
 17664*    END-EXEC.
 17665     MOVE 'ELBENE' TO DFHEIV1
 17666*    MOVE '&"S        E          (   #00015889' TO DFHEIV0
 17667     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17669     MOVE X'2020233030303135383839' TO DFHEIV0(25:11)
 17670     CALL 'kxdfhei1' USING DFHEIV0,
 17671           DFHEIV1,
 17672           DFHEIV20,
 17673           DFHEIV99,
 17674           ELBENE-KEY,
 17675           DFHEIV99,
 17676           DFHEIV99,
 17677           DFHEIV99
 17678     SET ADDRESS OF BENEFICIARY-MASTER TO
 17679         DFHEIV20
 17680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17681
 17682
 17683     MOVE 'Y' TO BENE-FOUND-SW.
 17684     GO TO 7920-EXIT.
 17685
 17686 7920-NOT-FOUND.
 17687     MOVE 'N'                    TO BENE-FOUND-SW.
 17688
 17689 7920-EXIT.
 17690      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 346
* EL156.cbl
 17692 7930-READ-CONTROL.
 17693
 17694* EXEC CICS READ
 17695*        DATASET  ('ELCNTL')
 17696*        SET      (ADDRESS OF CONTROL-FILE)
 17697*        RIDFLD   (ELCNTL-KEY)
 17698*    END-EXEC.
 17699     MOVE 'ELCNTL' TO DFHEIV1
 17700*    MOVE '&"S        E          (   #00015905' TO DFHEIV0
 17701     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17703     MOVE X'2020233030303135393035' TO DFHEIV0(25:11)
 17704     CALL 'kxdfhei1' USING DFHEIV0,
 17705           DFHEIV1,
 17706           DFHEIV20,
 17707           DFHEIV99,
 17708           ELCNTL-KEY,
 17709           DFHEIV99,
 17710           DFHEIV99,
 17711           DFHEIV99
 17712     SET ADDRESS OF CONTROL-FILE TO
 17713         DFHEIV20
 17714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17715
 17716
 17717 7930-EXIT.
 17718      EXIT.
 17719
 17720 7940-READ-CONTROL-UPDATE.
 17721
 17722* EXEC CICS READ
 17723*        DATASET  ('ELCNTL')
 17724*        SET      (ADDRESS OF CONTROL-FILE)
 17725*        RIDFLD   (ELCNTL-KEY)
 17726*        UPDATE
 17727*    END-EXEC.
 17728     MOVE 'ELCNTL' TO DFHEIV1
 17729*    MOVE '&"S        EU         (   #00015915' TO DFHEIV0
 17730     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17731     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17732     MOVE X'2020233030303135393135' TO DFHEIV0(25:11)
 17733     CALL 'kxdfhei1' USING DFHEIV0,
 17734           DFHEIV1,
 17735           DFHEIV20,
 17736           DFHEIV99,
 17737           ELCNTL-KEY,
 17738           DFHEIV99,
 17739           DFHEIV99,
 17740           DFHEIV99
 17741     SET ADDRESS OF CONTROL-FILE TO
 17742         DFHEIV20
 17743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17744
 17745
 17746 7940-EXIT.
 17747      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 347
* EL156.cbl
 17749 7950-READ-TRAILER.
 17750
 17751* EXEC CICS READ
 17752*        DATASET  ('ELTRLR')
 17753*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17754*        RIDFLD   (ELTRLR-KEY)
 17755*    END-EXEC.
 17756     MOVE 'ELTRLR' TO DFHEIV1
 17757*    MOVE '&"S        E          (   #00015926' TO DFHEIV0
 17758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17760     MOVE X'2020233030303135393236' TO DFHEIV0(25:11)
 17761     CALL 'kxdfhei1' USING DFHEIV0,
 17762           DFHEIV1,
 17763           DFHEIV20,
 17764           DFHEIV99,
 17765           ELTRLR-KEY,
 17766           DFHEIV99,
 17767           DFHEIV99,
 17768           DFHEIV99
 17769     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17770         DFHEIV20
 17771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17772
 17773
 17774 7950-EXIT.
 17775      EXIT.
 17776
 17777 7960-READ-TRAILER-UPDATE.
 17778
 17779* EXEC CICS READ
 17780*        DATASET  ('ELTRLR')
 17781*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17782*        RIDFLD   (ELTRLR-KEY)
 17783*        UPDATE
 17784*    END-EXEC.
 17785     MOVE 'ELTRLR' TO DFHEIV1
 17786*    MOVE '&"S        EU         (   #00015936' TO DFHEIV0
 17787     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17788     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17789     MOVE X'2020233030303135393336' TO DFHEIV0(25:11)
 17790     CALL 'kxdfhei1' USING DFHEIV0,
 17791           DFHEIV1,
 17792           DFHEIV20,
 17793           DFHEIV99,
 17794           ELTRLR-KEY,
 17795           DFHEIV99,
 17796           DFHEIV99,
 17797           DFHEIV99
 17798     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17799         DFHEIV20
 17800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17801
 17802
 17803 7960-EXIT.
 17804      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 348
* EL156.cbl
 17806 7970-READ-CERT.
 17807
 17808* EXEC CICS READ
 17809*        DATASET  ('ELCERT')
 17810*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 17811*        RIDFLD   (ELCERT-KEY)
 17812*    END-EXEC.
 17813     MOVE 'ELCERT' TO DFHEIV1
 17814*    MOVE '&"S        E          (   #00015947' TO DFHEIV0
 17815     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17816     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17817     MOVE X'2020233030303135393437' TO DFHEIV0(25:11)
 17818     CALL 'kxdfhei1' USING DFHEIV0,
 17819           DFHEIV1,
 17820           DFHEIV20,
 17821           DFHEIV99,
 17822           ELCERT-KEY,
 17823           DFHEIV99,
 17824           DFHEIV99,
 17825           DFHEIV99
 17826     SET ADDRESS OF CERTIFICATE-MASTER TO
 17827         DFHEIV20
 17828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17829
 17830
 17831 7970-EXIT.
 17832      EXIT.
 17833
 17834 7980-READ-CERT-UPDATE.
 17835
 17836* EXEC CICS READ
 17837*        DATASET  ('ELCERT')
 17838*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 17839*        RIDFLD   (ELCERT-KEY)
 17840*        UPDATE
 17841*    END-EXEC.
 17842     MOVE 'ELCERT' TO DFHEIV1
 17843*    MOVE '&"S        EU         (   #00015957' TO DFHEIV0
 17844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17845     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17846     MOVE X'2020233030303135393537' TO DFHEIV0(25:11)
 17847     CALL 'kxdfhei1' USING DFHEIV0,
 17848           DFHEIV1,
 17849           DFHEIV20,
 17850           DFHEIV99,
 17851           ELCERT-KEY,
 17852           DFHEIV99,
 17853           DFHEIV99,
 17854           DFHEIV99
 17855     SET ADDRESS OF CERTIFICATE-MASTER TO
 17856         DFHEIV20
 17857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17858
 17859
 17860 7980-EXIT.
 17861      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 349
* EL156.cbl
 17863 8000-LOAD-ERROR-MESSAGES.
 17864     IF PI-PASS-SW = 'C'
 17865        MOVE EMI-LINE1           TO ERMSG1BO
 17866     ELSE
 17867        MOVE EMI-LINE1           TO ERRMSG1O
 17868        MOVE EMI-LINE2           TO ERRMSG2O.
 17869
 17870 8000-EXIT.
 17871     EXIT.
 17872
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 350
* EL156.cbl
 17874
 17875 8010-DMD-ERROR-CHECKS.
 17876     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 17877
 17878     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 17879         GO TO 8051-ISSUE-ERROR.
 17880
 17881     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 17882     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 17883     MOVE '3'                    TO DC-OPTION-CODE.
 17884     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17885     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 17886         GO TO 8051-ISSUE-ERROR.
 17887
 17888     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 17889       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 17890                           OR
 17891          (CL-SSN-STATE   = CL-CERT-STATE  AND
 17892           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 17893             MOVE ER-0851         TO EMI-ERROR
 17894             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17895       END-IF
 17896       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 17897             MOVE ER-8147         TO EMI-ERROR
 17898             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17899
 17900     GO TO 8090-EXIT.
 17901
 17902 8051-ISSUE-ERROR.
 17903     MOVE ER-8146            TO EMI-ERROR.
 17904     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17905     GO TO 8090-EXIT.
 17906
 17907 8090-EXIT.
 17908      EXIT.
 17909
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 351
* EL156.cbl
 17911 8100-SEND-INITIAL-MAP.
 17912
 17913     MOVE SAVE-DATE              TO RUNDTEAO.
 17914     MOVE EIBTIME                TO TIME-IN.
 17915     MOVE TIME-OUT               TO RUNTIMAO.
 17916     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 17917
 17918     IF MAP-NAME = 'EL156A'
 17919        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17920           MOVE 'PF6=EOB CODES'  TO PF6TITO
 17921        END-IF
 17922     END-IF
 17923     IF MAP-NAME = 'EL156A'
 17924        IF PI-COMPANY-ID = 'CRI'
 17925           NEXT SENTENCE
 17926        ELSE
 17927           MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 17928
 17929     IF MAP-NAME = 'EL156A'
 17930        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 17931           NEXT SENTENCE
 17932        ELSE
 17933           MOVE AL-SADOF TO  PINTA    PINTHA.
 17934
 17935     IF MAP-NAME = 'EL156A'
 17936        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17937            NEXT SENTENCE
 17938        ELSE
 17939           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 17940
 17941     IF MAP-NAME = 'EL156A'
 17942        IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 17943           NEXT SENTENCE
 17944        ELSE
 17945           MOVE AL-SADOF TO CASHHA CASHA.
 17946
 17947     IF MAP-NAME = 'EL156A'
 17948        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 17949           NEXT SENTENCE
 17950        ELSE
 17951           MOVE AL-SADOF        TO  LOANHA
 17952                                    LOANNOA.
 17953
 17954     IF MAP-NAME = 'EL156A'
 17955        MOVE -1                 TO  ENTERPFL
 17956        IF PI-USES-PAID-TO
 17957           MOVE 'PAID TO DATE :' TO PTHRHDGO
 17958           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 17959           MOVE PMT-HEAD-A      TO  PMTHDGAO
 17960        ELSE
 17961           NEXT SENTENCE
 17962     ELSE
 17963        IF MAP-NAME = 'EL156B'
 17964           IF PI-USES-PAID-TO
 17965              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 17966              MOVE PMT-HEAD-B     TO PMTHDGBO.
 17967
 17968
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 352
* EL156.cbl
 17969* EXEC CICS SEND
 17970*        MAP   (MAP-NAME)
 17971*        MAPSET(MAPSET-NAME)
 17972*        FROM  (EL156AI)
 17973*        ERASE
 17974*        CURSOR
 17975*    END-EXEC.
 17976     MOVE LENGTH OF
 17977      EL156AI
 17978       TO DFHEIV12
 17979     MOVE -1
 17980       TO DFHEIV11
 17981*    MOVE '8$     CT  E    H L F ,   #00016072' TO DFHEIV0
 17982     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17983     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17984     MOVE X'2020233030303136303732' TO DFHEIV0(25:11)
 17985     CALL 'kxdfhei1' USING DFHEIV0,
 17986           MAP-NAME,
 17987           EL156AI,
 17988           DFHEIV12,
 17989           MAPSET-NAME,
 17990           DFHEIV99,
 17991           DFHEIV99,
 17992           DFHEIV99,
 17993           DFHEIV11,
 17994           DFHEIV99,
 17995           DFHEIV99,
 17996           DFHEIV99
 17997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17998
 17999
 18000     GO TO 9100-RETURN-TRAN.
 18001
 18002 8200-SEND-DATAONLY.
 18003
 18004     IF FIRST-ENTRY = 'Y'
 18005         GO TO 8100-SEND-INITIAL-MAP.
 18006
 18007     IF RETURNED-FROM-B = 'Y'
 18008         GO TO 8100-SEND-INITIAL-MAP.
 18009
 18010     MOVE SAVE-DATE              TO RUNDTEAO.
 18011     MOVE EIBTIME                TO TIME-IN.
 18012     MOVE TIME-OUT               TO RUNTIMAO.
 18013
 18014     IF EIBAID = DFHPF11
 18015        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 18016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18017        MOVE 'EL001   '          TO RETURNED-FROM
 18018        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 18019        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 18020        GO TO 8100-SEND-INITIAL-MAP.
 18021
 18022     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 18023
 18024     IF MAP-NAME =  'EL156A'
 18025        MOVE -1                 TO  ENTERPFL
 18026        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 353
* EL156.cbl
 18027           MOVE 'PAID TO DATE :' TO PTHRHDGO
 18028           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 18029           MOVE PMT-HEAD-A      TO  PMTHDGAO
 18030        ELSE
 18031           NEXT SENTENCE
 18032     ELSE
 18033        IF MAP-NAME = 'EL156B'
 18034           IF PI-USES-PAID-TO
 18035              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 18036              MOVE PMT-HEAD-B     TO PMTHDGBO.
 18037
 18038     IF MAP-NAME =  'EL156A'
 18039        IF PI-COMPANY-ID = 'BOA'
 18040            IF PI-INT-RATE NUMERIC
 18041                MOVE PI-INT-RATE TO PINTO.
 18042     IF MAP-NAME = 'EL156A'
 18043        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 18044           MOVE 'PF6=EOB CODES'  TO PF6TITO
 18045*          MOVE 'Y'              TO EOBYNO
 18046        END-IF
 18047     END-IF
 18048
 18049
 18050* EXEC CICS SEND
 18051*        MAP   (MAP-NAME)
 18052*        MAPSET(MAPSET-NAME)
 18053*        FROM  (EL156AI)
 18054*        DATAONLY
 18055*        CURSOR
 18056*    END-EXEC.
 18057     MOVE LENGTH OF
 18058      EL156AI
 18059       TO DFHEIV12
 18060     MOVE -1
 18061       TO DFHEIV11
 18062*    MOVE '8$D    CT       H L F ,   #00016129' TO DFHEIV0
 18063     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 18064     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 18065     MOVE X'2020233030303136313239' TO DFHEIV0(25:11)
 18066     CALL 'kxdfhei1' USING DFHEIV0,
 18067           MAP-NAME,
 18068           EL156AI,
 18069           DFHEIV12,
 18070           MAPSET-NAME,
 18071           DFHEIV99,
 18072           DFHEIV99,
 18073           DFHEIV99,
 18074           DFHEIV11,
 18075           DFHEIV99,
 18076           DFHEIV99,
 18077           DFHEIV99
 18078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18079
 18080
 18081     GO TO 9100-RETURN-TRAN.
 18082
 18083 8300-SEND-TEXT.
 18084
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 354
* EL156.cbl
 18085* EXEC CICS SEND TEXT
 18086*        FROM(LOGOFF-TEXT)
 18087*        LENGTH(LOGOFF-LENGTH)
 18088*        ERASE
 18089*        FREEKB
 18090*    END-EXEC.
 18091*    MOVE '8&      T  E F  H   F -   #00016140' TO DFHEIV0
 18092     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 18093     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 18094     MOVE X'2020233030303136313430' TO DFHEIV0(25:11)
 18095     CALL 'kxdfhei1' USING DFHEIV0,
 18096           LOGOFF-TEXT,
 18097           LOGOFF-LENGTH,
 18098           DFHEIV99,
 18099           DFHEIV99,
 18100           DFHEIV99,
 18101           DFHEIV99,
 18102           DFHEIV99,
 18103           DFHEIV99,
 18104           DFHEIV99,
 18105           DFHEIV99,
 18106           DFHEIV99,
 18107           DFHEIV99
 18108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18109
 18110
 18111
 18112* EXEC CICS RETURN
 18113*    END-EXEC.
 18114*    MOVE '.(                    &   #00016147' TO DFHEIV0
 18115     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 18116     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18117     MOVE X'2020233030303136313437' TO DFHEIV0(25:11)
 18118     CALL 'kxdfhei1' USING DFHEIV0,
 18119           DFHEIV99,
 18120           DFHEIV99,
 18121           DFHEIV99,
 18122           DFHEIV99,
 18123           DFHEIV99
 18124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18125
 18126
 18127 8500-FILE-NOTOPEN.
 18128     IF FILE-SWITCH = 'MSTR'
 18129         MOVE ER-0154            TO EMI-ERROR.
 18130     IF FILE-SWITCH = 'TRLR'
 18131         MOVE ER-0172            TO EMI-ERROR.
 18132     IF FILE-SWITCH = 'CERT'
 18133         MOVE ER-0169            TO EMI-ERROR.
 18134     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 18135                      'PROC' OR 'STAT'
 18136         MOVE ER-0042            TO EMI-ERROR.
 18137     IF FILE-SWITCH = 'ACTQ'
 18138         MOVE ER-0338            TO EMI-ERROR.
 18139     IF FILE-SWITCH = 'ACCT'
 18140         MOVE ER-0168            TO EMI-ERROR.
 18141
 18142     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 355
* EL156.cbl
 18143     MOVE -1                     TO PMTTYPEL.
 18144
 18145     IF FIRST-ENTRY = 'Y'
 18146         GO TO 8100-SEND-INITIAL-MAP.
 18147
 18148     GO TO 8200-SEND-DATAONLY.
 18149
 18150 8600-PGRM-NOT-FOUND.
 18151
 18152     MOVE ER-0923                TO EMI-ERROR.
 18153     MOVE -1                     TO ENTPFBL.
 18154     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18155
 18156     IF FIRST-ENTRY = 'Y'
 18157         GO TO 8100-SEND-INITIAL-MAP
 18158     ELSE
 18159         GO TO 8200-SEND-DATAONLY.
 18160
 18161 8800-UNAUTHORIZED-ACCESS.
 18162     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 18163     GO TO 8300-SEND-TEXT.
 18164
 18165 8810-PF23.
 18166     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 18167     MOVE XCTL-005               TO PGM-NAME.
 18168     GO TO 9300-XCTL.
 18169
 18170 8820-PF7-8.
 18171     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 18172     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 18173                                    PI-SAVED-PROGRAM-2
 18174                                    PI-SAVED-PROGRAM-3
 18175                                    PI-SAVED-PROGRAM-4
 18176                                    PI-SAVED-PROGRAM-5
 18177                                    PI-SAVED-PROGRAM-6
 18178                                    PI-RETURN-TO-PROGRAM.
 18179     IF EIBAID = DFHPF8
 18180        MOVE XCTL-132            TO PGM-NAME
 18181     ELSE
 18182        MOVE XCTL-130            TO PGM-NAME.
 18183
 18184     GO TO 9300-XCTL.
 18185
 18186 9100-RETURN-TRAN.
 18187     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 18188     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 18189
 18190
 18191* EXEC CICS RETURN
 18192*        TRANSID(TRANS-ID)
 18193*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18194*        LENGTH(PI-COMM-LENGTH)
 18195*    END-EXEC.
 18196*    MOVE '.(CT                  &   #00016213' TO DFHEIV0
 18197     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 18198     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18199     MOVE X'2020233030303136323133' TO DFHEIV0(25:11)
 18200     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 356
* EL156.cbl
 18201           TRANS-ID,
 18202           PROGRAM-INTERFACE-BLOCK,
 18203           PI-COMM-LENGTH,
 18204           DFHEIV99,
 18205           DFHEIV99
 18206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18207
 18208
 18209 9200-RETURN-MAIN-MENU.
 18210     MOVE XCTL-126               TO PGM-NAME.
 18211     GO TO 9300-XCTL.
 18212
 18213 9300-XCTL.
 18214
 18215* EXEC CICS XCTL
 18216*        PROGRAM(PGM-NAME)
 18217*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18218*        LENGTH(PI-COMM-LENGTH)
 18219*    END-EXEC.
 18220*    MOVE '.$C                   $   #00016224' TO DFHEIV0
 18221     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 18222     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18223     MOVE X'2020233030303136323234' TO DFHEIV0(25:11)
 18224     CALL 'kxdfhei1' USING DFHEIV0,
 18225           PGM-NAME,
 18226           PROGRAM-INTERFACE-BLOCK,
 18227           PI-COMM-LENGTH
 18228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18229
 18230
 18231 9400-CLEAR.
 18232     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 18233     GO TO 9300-XCTL.
 18234
 18235 9500-PF12.
 18236     MOVE XCTL-010               TO PGM-NAME.
 18237     GO TO 9300-XCTL.
 18238
 18239 9700-LINK-DATE-CONVERT.
 18240     MOVE LINK-ELDATCV           TO PGM-NAME.
 18241
 18242* EXEC CICS LINK
 18243*        PROGRAM   (PGM-NAME)
 18244*        COMMAREA  (DATE-CONVERSION-DATA)
 18245*        LENGTH    (DC-COMM-LENGTH)
 18246*    END-EXEC.
 18247*    MOVE '."C                   ''   #00016240' TO DFHEIV0
 18248     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18249     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18250     MOVE X'2020233030303136323430' TO DFHEIV0(25:11)
 18251     CALL 'kxdfhei1' USING DFHEIV0,
 18252           PGM-NAME,
 18253           DATE-CONVERSION-DATA,
 18254           DC-COMM-LENGTH,
 18255           DFHEIV99,
 18256           DFHEIV99,
 18257           DFHEIV99
 18258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 357
* EL156.cbl
 18259
 18260
 18261 9700-EXIT.
 18262     EXIT.
 18263
 18264 9800-LINK-REM-TERM.
 18265     MOVE LINK-REMTERM TO PGM-NAME.
 18266
 18267
 18268* EXEC CICS LINK
 18269*        PROGRAM   (PGM-NAME)
 18270*        COMMAREA  (CALCULATION-PASS-AREA)
 18271*        LENGTH    (CP-COMM-LENGTH)
 18272*    END-EXEC.
 18273*    MOVE '."C                   ''   #00016252' TO DFHEIV0
 18274     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18275     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18276     MOVE X'2020233030303136323532' TO DFHEIV0(25:11)
 18277     CALL 'kxdfhei1' USING DFHEIV0,
 18278           PGM-NAME,
 18279           CALCULATION-PASS-AREA,
 18280           CP-COMM-LENGTH,
 18281           DFHEIV99,
 18282           DFHEIV99,
 18283           DFHEIV99
 18284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18285
 18286
 18287 9800-EXIT.
 18288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 358
* EL156.cbl
 18290 9830-DMD-REMAINING-TERM.
 18291
 18292     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 18293         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 18294
 18295     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 18296                              CM-PMT-EXTENSION-DAYS.
 18297
 18298     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 18299                                  CL-NO-OF-DAYS-PAID.
 18300
 18301     DIVIDE W-REM-TERM-IN-DAYS BY +30
 18302         GIVING W-REM REMAINDER W-REM-DAYS.
 18303
 18304     MOVE W-REM                  TO WST-REM.
 18305
 18306     IF W-REM-DAYS > ZEROS
 18307         MOVE '/'                TO WST-SLASH
 18308         MOVE W-REM-DAYS         TO WST-REM-DAYS
 18309     ELSE
 18310         MOVE SPACES             TO WST-REM-DAYS-GRP.
 18311
 18312 9830-EXIT.
 18313     EXIT.
 18314
 18315 9870-OUTPUT-ACTIVITY-RECORD.
 18316
 18317
 18318* EXEC CICS GETMAIN
 18319*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 18320*         LENGTH(25)
 18321*         INITIMG(WS-BLANK)
 18322*    END-EXEC.
 18323     MOVE 25
 18324       TO DFHEIV11
 18325*    MOVE ',"IL                  $   #00016288' TO DFHEIV0
 18326     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18327     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18328     MOVE X'2020233030303136323838' TO DFHEIV0(25:11)
 18329     CALL 'kxdfhei1' USING DFHEIV0,
 18330           DFHEIV20,
 18331           DFHEIV11,
 18332           WS-BLANK
 18333     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 18334         DFHEIV20
 18335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18336
 18337
 18338     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 18339     MOVE ELMSTR-KEY             TO DA-KEY.
 18340     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 18341
 18342     IF PI-PMTTYPE EQUAL '7'
 18343         MOVE 'V'                TO DA-RECORD-TYPE
 18344     ELSE
 18345         MOVE 'P'                TO DA-RECORD-TYPE.
 18346
 18347
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 359
* EL156.cbl
 18348* EXEC CICS HANDLE CONDITION
 18349*         NOTOPEN(9870-NOTOPEN)
 18350*         DUPREC(9870-EXIT)
 18351*    END-EXEC.
 18352*    MOVE '"$J%                  ! A #00016303' TO DFHEIV0
 18353     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 18354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18355     MOVE X'4120233030303136333033' TO DFHEIV0(25:11)
 18356     CALL 'kxdfhei1' USING DFHEIV0
 18357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18358
 18359
 18360
 18361* EXEC CICS WRITE
 18362*         DATASET('DLYACTV')
 18363*         RIDFLD(DA-KEY)
 18364*         FROM(DAILY-ACTIVITY-RECORD)
 18365*         LENGTH(25)
 18366*    END-EXEC.
 18367     MOVE 'DLYACTV' TO DFHEIV1
 18368     MOVE 25
 18369       TO DFHEIV11
 18370*    MOVE '&$ L                  ''   #00016308' TO DFHEIV0
 18371     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18372     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18373     MOVE X'2020233030303136333038' TO DFHEIV0(25:11)
 18374     CALL 'kxdfhei1' USING DFHEIV0,
 18375           DFHEIV1,
 18376           DAILY-ACTIVITY-RECORD,
 18377           DFHEIV11,
 18378           DA-KEY,
 18379           DFHEIV99,
 18380           DFHEIV99
 18381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18382
 18383     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 18384     GO TO 9870-EXIT.
 18385
 18386 9870-NOTOPEN.
 18387
 18388     MOVE '2955'                 TO EMI-ERROR.
 18389     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 18390
 18391 9870-EXIT.
 18392     EXIT.
 18393
 18394 9900-ERROR-FORMAT.
 18395
 18396     IF EMI-ERROR = ER-0923
 18397         MOVE PGM-NAME           TO W-CALLED-NAME.
 18398
 18399     MOVE LINK-001      TO PGM-NAME.
 18400     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 18401
 18402
 18403* EXEC CICS LINK
 18404*        PROGRAM (PGM-NAME)
 18405*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 360
* EL156.cbl
 18406*        LENGTH  (EMI-COMM-LENGTH)
 18407*    END-EXEC.
 18408*    MOVE '."C                   ''   #00016333' TO DFHEIV0
 18409     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18410     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18411     MOVE X'2020233030303136333333' TO DFHEIV0(25:11)
 18412     CALL 'kxdfhei1' USING DFHEIV0,
 18413           PGM-NAME,
 18414           ERROR-MESSAGE-INTERFACE-BLOCK,
 18415           EMI-COMM-LENGTH,
 18416           DFHEIV99,
 18417           DFHEIV99,
 18418           DFHEIV99
 18419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18420
 18421
 18422     IF EMI-ERROR = ER-0923
 18423         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 18424
 18425 9900-EXIT.
 18426     EXIT.
 18427
 18428 9990-ABEND.
 18429     MOVE LINK-004               TO PGM-NAME.
 18430     MOVE DFHEIBLK               TO EMI-LINE1.
 18431
 18432* EXEC CICS LINK
 18433*        PROGRAM   (PGM-NAME)
 18434*        COMMAREA  (EMI-LINE1)
 18435*        LENGTH    (64)
 18436*    END-EXEC.
 18437     MOVE 64
 18438       TO DFHEIV11
 18439*    MOVE '."C                   ''   #00016348' TO DFHEIV0
 18440     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18441     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18442     MOVE X'2020233030303136333438' TO DFHEIV0(25:11)
 18443     CALL 'kxdfhei1' USING DFHEIV0,
 18444           PGM-NAME,
 18445           EMI-LINE1,
 18446           DFHEIV11,
 18447           DFHEIV99,
 18448           DFHEIV99,
 18449           DFHEIV99
 18450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18451
 18452
 18453     MOVE 'EL156A'               TO  MAP-NAME.
 18454     MOVE LOW-VALUES             TO  EL156AO.
 18455     GO TO 8100-SEND-INITIAL-MAP.
 18456
 18457 9995-SECURITY-VIOLATION.
 18458*    COPY ELCSCTP.
 18459******************************************************************
 18460*                                                                *
 18461*                            ELCSCTP                             *
 18462*                            VMOD=2.001                          *
 18463*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 361
* EL156.cbl
 18464*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 18465******************************************************************
 18466
 18467
 18468     MOVE EIBDATE          TO SM-JUL-DATE.
 18469     MOVE EIBTRMID         TO SM-TERMID.
 18470     MOVE THIS-PGM         TO SM-PGM.
 18471     MOVE EIBTIME          TO TIME-IN.
 18472     MOVE TIME-OUT         TO SM-TIME.
 18473     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 18474
 18475
 18476* EXEC CICS LINK
 18477*         PROGRAM  ('EL003')
 18478*         COMMAREA (SECURITY-MESSAGE)
 18479*         LENGTH   (80)
 18480*    END-EXEC.
 18481     MOVE 'EL003' TO DFHEIV1
 18482     MOVE 80
 18483       TO DFHEIV11
 18484*    MOVE '."C                   ''   #00016376' TO DFHEIV0
 18485     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18486     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18487     MOVE X'2020233030303136333736' TO DFHEIV0(25:11)
 18488     CALL 'kxdfhei1' USING DFHEIV0,
 18489           DFHEIV1,
 18490           SECURITY-MESSAGE,
 18491           DFHEIV11,
 18492           DFHEIV99,
 18493           DFHEIV99,
 18494           DFHEIV99
 18495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18496
 18497
 18498******************************************************************
 18499
 18500
 18501
 18502 9999-DFHBACK SECTION.
 18503     MOVE '9%                    "   ' TO DFHEIV0
 18504     MOVE 'EL156' TO DFHEIV1
 18505     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18506     GOBACK.
 18507 9999-DFHEXIT.
 18508     IF DFHEIGDJ EQUAL 0001
 18509         NEXT SENTENCE
 18510     ELSE IF DFHEIGDJ EQUAL 2
 18511         GO TO 9990-ABEND,
 18512               8600-PGRM-NOT-FOUND,
 18513               0400-FIRST-TIME,
 18514               6180-DUPREC,
 18515               9990-ABEND
 18516         DEPENDING ON DFHEIGDI
 18517     ELSE IF DFHEIGDJ EQUAL 3
 18518         GO TO 0380-CLAIM-END-FILE,
 18519               0380-CLAIM-END-FILE
 18520         DEPENDING ON DFHEIGDI
 18521     ELSE IF DFHEIGDJ EQUAL 4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 362
* EL156.cbl
 18522         GO TO 0380-CLAIM-END-FILE,
 18523               0380-CLAIM-END-FILE
 18524         DEPENDING ON DFHEIGDI
 18525     ELSE IF DFHEIGDJ EQUAL 5
 18526         GO TO 0800-EXIT
 18527         DEPENDING ON DFHEIGDI
 18528     ELSE IF DFHEIGDJ EQUAL 6
 18529         GO TO 1950-NOT-FOUND,
 18530               1950-NOT-FOUND
 18531         DEPENDING ON DFHEIGDI
 18532     ELSE IF DFHEIGDJ EQUAL 7
 18533         GO TO 1950-NOT-FOUND
 18534         DEPENDING ON DFHEIGDI
 18535     ELSE IF DFHEIGDJ EQUAL 8
 18536         GO TO 1950-NOT-FOUND,
 18537               1950-NOT-FOUND
 18538         DEPENDING ON DFHEIGDI
 18539     ELSE IF DFHEIGDJ EQUAL 9
 18540         GO TO 1166-END-CHECK,
 18541               1166-END-CHECK
 18542         DEPENDING ON DFHEIGDI
 18543     ELSE IF DFHEIGDJ EQUAL 10
 18544         GO TO 1950-NOT-FOUND,
 18545               1950-NOT-FOUND
 18546         DEPENDING ON DFHEIGDI
 18547     ELSE IF DFHEIGDJ EQUAL 11
 18548         GO TO 1950-NOT-FOUND,
 18549               1950-NOT-FOUND
 18550         DEPENDING ON DFHEIGDI
 18551     ELSE IF DFHEIGDJ EQUAL 12
 18552         GO TO 1950-NOT-FOUND
 18553         DEPENDING ON DFHEIGDI
 18554     ELSE IF DFHEIGDJ EQUAL 13
 18555         GO TO 3600-CONTINUE
 18556         DEPENDING ON DFHEIGDI
 18557     ELSE IF DFHEIGDJ EQUAL 14
 18558         GO TO 5300-NOTE-NOT-FOUND
 18559         DEPENDING ON DFHEIGDI
 18560     ELSE IF DFHEIGDJ EQUAL 15
 18561         GO TO 6065-NOT-FOUND
 18562         DEPENDING ON DFHEIGDI
 18563     ELSE IF DFHEIGDJ EQUAL 16
 18564         GO TO 6068-ACCT-NOT-FND
 18565         DEPENDING ON DFHEIGDI
 18566     ELSE IF DFHEIGDJ EQUAL 17
 18567         GO TO 6074-GET-COMP-DATA
 18568         DEPENDING ON DFHEIGDI
 18569     ELSE IF DFHEIGDJ EQUAL 18
 18570         GO TO 6170-WRITE
 18571         DEPENDING ON DFHEIGDI
 18572     ELSE IF DFHEIGDJ EQUAL 19
 18573         GO TO 6180-DUPREC
 18574         DEPENDING ON DFHEIGDI
 18575     ELSE IF DFHEIGDJ EQUAL 20
 18576         GO TO 6190-DUPREC
 18577         DEPENDING ON DFHEIGDI
 18578     ELSE IF DFHEIGDJ EQUAL 21
 18579         GO TO 6185-DUPREC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 363
* EL156.cbl
 18580         DEPENDING ON DFHEIGDI
 18581     ELSE IF DFHEIGDJ EQUAL 22
 18582         GO TO 6720-BUILD-NEW-RECORD
 18583         DEPENDING ON DFHEIGDI
 18584     ELSE IF DFHEIGDJ EQUAL 23
 18585         GO TO 6900-BUILD-ARCHIVE-HEADER,
 18586               6900-BUILD-ARCHIVE-HEADER
 18587         DEPENDING ON DFHEIGDI
 18588     ELSE IF DFHEIGDJ EQUAL 24
 18589         GO TO 7100-SHOW-RECORD-NOT-FOUND
 18590         DEPENDING ON DFHEIGDI
 18591     ELSE IF DFHEIGDJ EQUAL 25
 18592         GO TO 7160-DUPREC
 18593         DEPENDING ON DFHEIGDI
 18594     ELSE IF DFHEIGDJ EQUAL 26
 18595         GO TO 7200-EXIT,
 18596               7200-EXIT
 18597         DEPENDING ON DFHEIGDI
 18598     ELSE IF DFHEIGDJ EQUAL 27
 18599         GO TO 7400-NOT-FOUND
 18600         DEPENDING ON DFHEIGDI
 18601     ELSE IF DFHEIGDJ EQUAL 28
 18602         GO TO 7590-END,
 18603               7590-END
 18604         DEPENDING ON DFHEIGDI
 18605     ELSE IF DFHEIGDJ EQUAL 29
 18606         GO TO 7699-EXIT
 18607         DEPENDING ON DFHEIGDI
 18608     ELSE IF DFHEIGDJ EQUAL 30
 18609         GO TO 5300-NOTE-NOT-FOUND
 18610         DEPENDING ON DFHEIGDI
 18611     ELSE IF DFHEIGDJ EQUAL 31
 18612         GO TO 7800-COMP-NOTFND
 18613         DEPENDING ON DFHEIGDI
 18614     ELSE IF DFHEIGDJ EQUAL 32
 18615         GO TO 7920-NOT-FOUND
 18616         DEPENDING ON DFHEIGDI
 18617     ELSE IF DFHEIGDJ EQUAL 33
 18618         GO TO 9870-NOTOPEN,
 18619               9870-EXIT
 18620         DEPENDING ON DFHEIGDI.
 18621     MOVE '9%                    "   ' TO DFHEIV0
 18622     MOVE 'EL156' TO DFHEIV1
 18623     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18624     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       11628     Code:       67986
