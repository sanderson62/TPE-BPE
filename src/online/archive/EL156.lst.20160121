* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61******************************************************************
    62
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page   3
* EL156.cbl
    64 ENVIRONMENT DIVISION.
    65
    66 DATA DIVISION.
    67
    68 WORKING-STORAGE SECTION.
    69 01  DFH-START PIC X(04).
    70
    71 77  FILLER  PIC X(32)  VALUE '********************************'.
    72 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    73 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    74 77  WS-SSN  PIC X(9) VALUE ZEROS.
    75 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    76 77  C0                          PIC S999 COMP-3 VALUE +0.
    77 77  C1                          PIC S999 COMP-3 VALUE +0.
    78 77  C2                          PIC S999 COMP-3 VALUE +0.
    79 77  C3                          PIC S999 COMP-3 VALUE +0.
    80 77  s1                          PIC S999 COMP-3 VALUE +0.
    81 77  s2                          pic s999 comp-3 value +0.
    82 77  P1                          PIC S999 COMP-3 VALUE +0.
    83 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    84 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    85 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    86 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    87 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    88 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    89 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    90 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    91 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    92 77  ws-max-bens                 pic s999 comp-3 value +0.
    93 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    94 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    95 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    96 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    97 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    98 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
    99
   100*    COPY ELCSCTM.
   101******************************************************************
   102*                                                                *
   103*                                                                *
   104*                            ELCSCTM                             *
   105*                            VMOD=2.001                          *
   106*                                                                *
   107*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   108*                                                                *
   109******************************************************************
   110 01  SECURITY-MESSAGE.
   111     12  FILLER                          PIC X(30)
   112            VALUE '** LOGIC SECURITY VIOLATION -'.
   113     12  SM-READ                         PIC X(6).
   114     12  FILLER                          PIC X(5)
   115            VALUE ' PGM='.
   116     12  SM-PGM                          PIC X(6).
   117     12  FILLER                          PIC X(5)
   118            VALUE ' OPR='.
   119     12  SM-PROCESSOR-ID                 PIC X(4).
   120     12  FILLER                          PIC X(6)
   121            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page   4
* EL156.cbl
   122     12  SM-TERMID                       PIC X(4).
   123     12  FILLER                          PIC XX   VALUE SPACE.
   124     12  SM-JUL-DATE                     PIC 9(5).
   125     12  FILLER                          PIC X    VALUE SPACE.
   126     12  SM-TIME                         PIC 99.99.
   127
   128
   129*    COPY ELCSCRTY.
   130******************************************************************
   131*                                                                *
   132*                                                                *
   133*                            ELCSCRTY                            *
   134*                            VMOD=2.001                          *
   135*                                                                *
   136*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   137*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   138*        SAVED IN PI-SECURITY-ADDRESS.                           *
   139*                                                                *
   140******************************************************************
   141 01  SECURITY-CONTROL.
   142     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   143     12  FILLER                       PIC XX    VALUE 'SC'.
   144     12  SC-CREDIT-CODES.
   145         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   146             20  SC-CREDIT-DISPLAY    PIC X.
   147             20  SC-CREDIT-UPDATE     PIC X.
   148     12  SC-CLAIMS-CODES.
   149         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   150             20  SC-CLAIMS-DISPLAY    PIC X.
   151             20  SC-CLAIMS-UPDATE     PIC X.
   152
   153 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   154 01  WS-DATE-AREA.
   155     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   156     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   157     12  SAVE-DATE-CCYYMMDD.
   158         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   159         16  SAVE-DATE-YMD.
   160             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   161             20  FILLER              PIC X(04)   VALUE SPACES.
   162
   163 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   164 01  STANDARD-AREAS.
   165     12  WS-RESPONSE         PIC S9(8)   COMP.
   166         88  WS-RESP-NORMAL              VALUE +00.
   167         88  WS-RESP-ERROR               VALUE +01.
   168         88  WS-RESP-NOTFND              VALUE +13.
   169         88  WS-RESP-DUPREC              VALUE +14.
   170         88  WS-RESP-ENDFILE             VALUE +20.
   171     12  PMT-HEAD-A.
   172         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   173         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   174         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   175-        '     RESERVES  TYPE    AMOUNT'.
   176     12  PMT-HEAD-B.
   177         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   178         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   179         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page   5
* EL156.cbl
   180     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   181     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   182     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   183     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   184     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   185     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   186     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   187     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   188     12  PGM-NAME            PIC X(8).
   189     12  TIME-IN             PIC S9(7).
   190     12  TIME-OUT-R  REDEFINES TIME-IN.
   191         16  FILLER          PIC X.
   192         16  TIME-OUT        PIC 99V99.
   193         16  FILLER          PIC XX.
   194     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   195     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   196     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   197     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   198     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   199     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   200     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   201     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   202     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   203     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   204     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   205     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   206     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   207     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   208     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   209     12  WS-BLANK            PIC X       VALUE ' '.
   210
   211 01  MISC-WORK-AREAS.
   212     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   213     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   214     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   215     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   216     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   217     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   218     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   219     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   220     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   221     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   222     12  W-CALLED-NAME           PIC X(08).
   223     12  W-EOB-CODES.
   224         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   225             20  W-EOB-CODE      PIC XXX.
   226             20  W-EOB-FILLER    PIC X.
   227     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   228     12  W-NAME-LAST             PIC X(15).
   229     12  W-NAME-FIRST            PIC X(15).
   230     12  W-NAME-MIDDLE.
   231         16  FILLER              PIC X.
   232         16  W-NAME-MIDDLE-2     PIC X.
   233         16  FILLER              PIC X(13).
   234     12  W-DMD-CHECK-NO.
   235         16  W-DMD-CHECK-NO-1    PIC X(4).
   236         16  W-DMD-CHECK-NO-2    PIC X.
   237         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page   6
* EL156.cbl
   238
   239     12  WS-COMPUTE-FROM-DT  PIC XX.
   240     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   241     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   242     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   243     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   244     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   245     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   246         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   247         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   248     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   249         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   250     12  WS-UPDATE-SW        PIC X VALUE ' '.
   251     12  WS-GROUPING.
   252         16  WS-GROUP-1      PIC X VALUE SPACES.
   253         16  FILLER          PIC X(05) VALUE SPACES.
   254     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   255     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   256     12  WS-WORK-STATE-ACCT.
   257         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   258         16  FILLER          PIC X       VALUE '/'.
   259         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   260     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   261     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   262     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   263     12  QID.
   264         16  QID-TERM        PIC X(4)    VALUE SPACES.
   265         16  FILLER          PIC X(4)    VALUE '156A'.
   266     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   267     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   268     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   269     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   270     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   271     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   272     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   273     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   274     12  WS-STATUS           PIC X       VALUE SPACES.
   275     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   276     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   277     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   278     12  ws-extended-exp-dt  pic xx      value low-values.
   279     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   280     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   281     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   282     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   283     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   284     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   285     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   286     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   287     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   288     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   289     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   290     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   291     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   292     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   293     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   294     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   295     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page   7
* EL156.cbl
   296     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   297     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   298     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   299     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   300     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   301     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   302     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   303     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   304     12  WORK-DATE-FROM.
   305         16  WDF-MONTH       PIC 99        VALUE ZERO.
   306         16  WDF-DAY         PIC 99        VALUE ZERO.
   307         16  WDF-YEAR        PIC 99        VALUE ZERO.
   308     12  WORK-DATE-THRU.
   309         16  WDT-MONTH       PIC 99        VALUE ZERO.
   310         16  WDT-DAY         PIC 99        VALUE ZERO.
   311         16  WDT-YEAR        PIC 99        VALUE ZERO.
   312     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   313     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   314     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   315     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   316     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   317     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   318     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   319     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   320     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   321     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   322     12  WS-PY-WK REDEFINES WS-PY-WORK.
   323         16  WS-PY-NUM       PIC S9(7)V99.
   324         16  WS-PY-SIGN      PIC X.
   325     12  WS-DY-WORK          PIC S9(5).
   326     12  WS-DY-WK REDEFINES WS-DY-WORK.
   327         16  WS-DY-NUM       PIC S9(4).
   328         16  WS-DY-SIGN      PIC X.
   329     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   330         88  COMP-REC-FOUND              VALUE 'Y'.
   331     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   332         88  BENEFIT-FOUND       VALUE 'Y'.
   333         88  NO-BENEFIT-FOUND    VALUE 'N'.
   334     12  WS-TERMS.
   335         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   336         16  FILLER          PIC X       VALUE '/'.
   337         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   338         16  WST-REM-DAYS-GRP.
   339             20  WST-SLASH   PIC X       VALUE '/'.
   340             20  WST-REM-DAYS
   341                             PIC --9.
   342     12  WS-ACCESS.
   343         16  FILLER          PIC XX      VALUE SPACES.
   344         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   345     12  WS-STATE-ACCESS.
   346         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   347         16  FILLER          PIC XX      VALUE SPACES.
   348     12  WS-CARR-ACCESS.
   349         16  FILLER          PIC X(3)    VALUE SPACES.
   350         16  WS-CARR         PIC X       VALUE SPACES.
   351     12  DATE-WORK.
   352         16  FILLER          PIC XX      VALUE SPACES.
   353         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page   8
* EL156.cbl
   354     12  WS-SAVE-INPUT.
   355         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   356         16  WS-PAYEE        PIC XX      VALUE SPACE.
   357         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   358         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   359         16  WS-OFFLINE      PIC X       VALUE SPACE.
   360         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   361         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   362         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   363         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   364         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   365         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   366         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   367         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   368         16  WS-ETYPE        PIC X       VALUE SPACE.
   369         16  WS-CASH         PIC X       VALUE SPACE.
   370         16  WS-GROUPED      PIC X       VALUE SPACE.
   371         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   372         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   373         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   374         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   375         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   376         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   377         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   378         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   379         16  ws-int-to-rem-borr pic x value spaces.
   380     12  LAST-ERROR-LINE.
   381         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   382         16  FILLER              PIC X(30)
   383             VALUE ' FATAL ERRORS ENCOUNTERED'.
   384         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   385         16  FILLER              PIC X(28)
   386             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   387     12  WS-CHECK-AREA.
   388         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   389         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   390     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   391     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   392         16  FILLER              PIC XX.
   393         16  WS-A-CHECK-NUM-5    PIC 9(5).
   394     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   395         16  FILLER              PIC X.
   396         16  WS-A-CHECK-NUM-6    PIC 9(6).
   397     12  OPTION-1-SAVE-AREA.
   398         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   399         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   400     12  WS-WORK-ZIP.
   401         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   402         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   403     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   404                                 PIC 9(9).
   405     12  WS-FLI-PMTNOTE.
   406         16  WS-PMTOPTION        PIC XX.
   407         16  WS-DOCNAME          PIC X(28).
   408         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   409             20  WS-AMOUNT       PIC X(8).
   410             20  FILLER          PIC X(20).
   411         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page   9
* EL156.cbl
   412             20  WS-NUM-AMT      PIC 9(6)V99.
   413             20  FILLER          PIC X(20).
   414
   415     12  WS-HAN-PMTNOTE.
   416         16  WS-HAN-PMT-CODE     PIC X.
   417         16  WS-HAN-PMT-NOTE     PIC X(39).
   418
   419     12  WS-NCL-PMT-OPTION       PIC XX.
   420         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   421
   422     12  WS-CLAIM-SEQUENCE.
   423         16  FILLER              PIC X VALUE '('.
   424         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   425         16  FILLER              PIC X(04) VALUE ' OF '.
   426         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   427         16  FILLER              PIC X VALUE ')'.
   428
   429     12  WS-REFUND-AMT           PIC Z(7).99.
   430     12  WS-CALC-INT             PIC S9(7)V99.
   431     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   432
   433     12  SUB                     PIC 99 VALUE ZEROS.
   434
   435     12  WS-BOANOTE1.
   436         16  WS-BOANOTE1-DESC    PIC X(11).
   437         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   438         16  FILLER              PIC X(17).
   439     12  WS-BOANOTE2.
   440         16  WS-BOANOTE2-DESC    PIC X(11).
   441         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   442         16  FILLER              PIC X(17).
   443
   444     12  WS-NCLNOTE1.
   445         16  WS-NCLNOTE1-DESC    PIC X(11).
   446         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   447         16  FILLER              PIC X(17).
   448     12  WS-NCLNOTE2.
   449         16  WS-NCLNOTE2-DESC    PIC X(11).
   450         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   451         16  FILLER              PIC X(17).
   452
   453     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   454     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   455     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   456     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   457     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   458     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   459     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   460     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   461     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   462     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   463
   464     12  WS-AIG-WORK-AREAS.
   465         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   466             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   467         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   468             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   469         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  10
* EL156.cbl
   470             20  WS-FROM-MO      PIC 99.
   471             20  WS-FROM-DA      PIC 99.
   472             20  WS-FROM-YR      PIC 99.
   473         16  WS-TEMP-DATE-MDY.
   474             20  WS-TEMP-MO      PIC 99.
   475             20  WS-TEMP-DA      PIC 99.
   476             20  WS-TEMP-YR      PIC 99.
   477         16  WS-BIN-FROM-DT      PIC XX.
   478         16  WS-TEMP-INC-MDY.
   479             20  WS-TEMP-INC-MO  PIC 99.
   480             20  WS-TEMP-INC-DA  PIC 99.
   481             20  WS-TEMP-INC-YR  PIC 99.
   482         16  WS-PMT-DUE-MDY.
   483             20  WS-PMT-DUE-MO   PIC 99.
   484             20  WS-PMT-DUE-DA   PIC 99.
   485             20  WS-PMT-DUE-YR   PIC 99.
   486         16  WS-PMT-DUE-DT       PIC XX.
   487         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   488         16  WS-RETRO-ELIM-DT    PIC XX.
   489         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   490             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   491         16  WS-SAVE-DUE-DA      PIC 99.
   492         16  WS-CDAYS            PIC S9(05).
   493         16  WS-DAYS-OFF         PIC S9(05).
   494         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   495             88  ELIM-SATISFIED            VALUE 'Y'.
   496         16  WS-AIG-CHECKNO.
   497             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   498             20  WS-A-CHECKNO-3-7.
   499                 24  FILLER              PIC X(3)    VALUE SPACES.
   500                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   501                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   502         16  WS-AIG-GROUPING.
   503             20  WS-A-BENE               PIC XXX.
   504             20  FILLER                  PIC XXX.
   505         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   506             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   507             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   508         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   509                 VALUE 'UNEMPLOYMENT PAYMENT'.
   510         16  WS-CHK-THRU-DT              PIC XX.
   511         16  WS-HOLD-BIN-DATE-1          PIC XX.
   512
   513 01  MISC-CSO-AREA.
   514     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   515     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   516     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   517         88  APPROVAL-NEEDED                        VALUE 'Y'.
   518     12  WS-APPROV-NOTE                  PIC X(43)
   519         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   520     12  WS-3550-APPROV-NOTE             PIC X(43)
   521         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   522     12  WS-REAUDIT-NOTE                 PIC X(43)
   523         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   524     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   525     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   526     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   527     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  11
* EL156.cbl
   528     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   529     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   530     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   531         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   532     12  WS-PAYEE-CITY-STATE     PIC X(30).
   533     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   534         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   535     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   536     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   537     12  WS-WORK-NAME            PIC X(30).
   538     12  FILLER  REDEFINES WS-WORK-NAME.
   539         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   540     12  WS-INSURED-NAME         PIC X(30).
   541     12  FILLER  REDEFINES WS-INSURED-NAME.
   542         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   543     12  WS-PAYEE-NAME           PIC X(30).
   544     12  FILLER  REDEFINES WS-PAYEE-NAME.
   545         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   546
   547 01  ERROR-MESSAGES.
   548     12  ER-0000                 PIC X(4)  VALUE '0000'.
   549     12  ER-0004                 PIC X(4)  VALUE '0004'.
   550     12  ER-0008                 PIC X(4)  VALUE '0008'.
   551     12  ER-0019                 PIC X(4)  VALUE '0019'.
   552     12  ER-0029                 PIC X(4)  VALUE '0029'.
   553     12  ER-0042                 PIC X(4)  VALUE '0042'.
   554     12  ER-0070                 PIC X(4)  VALUE '0070'.
   555     12  ER-0130                 PIC X(4)  VALUE '0130'.
   556     12  ER-0149                 PIC X(4)  VALUE '0149'.
   557     12  ER-0154                 PIC X(4)  VALUE '0154'.
   558     12  ER-0168                 PIC X(4)  VALUE '0168'.
   559     12  ER-0169                 PIC X(4)  VALUE '0169'.
   560     12  ER-0172                 PIC X(4)  VALUE '0174'.
   561     12  ER-0198                 PIC X(4)  VALUE '0198'.
   562     12  ER-0204                 PIC X(4)  VALUE '0204'.
   563     12  ER-0206                 PIC X(4)  VALUE '0206'.
   564     12  ER-0252                 PIC X(4)  VALUE '0252'.
   565     12  ER-0254                 PIC X(4)  VALUE '0254'.
   566     12  ER-0282                 PIC X(4)  VALUE '0282'.
   567     12  ER-0283                 PIC X(4)  VALUE '0283'.
   568     12  ER-0294                 PIC X(4)  VALUE '0294'.
   569     12  ER-0338                 PIC X(4)  VALUE '0338'.
   570     12  ER-0419                 PIC X(4)  VALUE '0419'.
   571     12  ER-0420                 PIC X(4)  VALUE '0420'.
   572     12  ER-0421                 PIC X(4)  VALUE '0421'.
   573     12  ER-0422                 PIC X(4)  VALUE '0422'.
   574     12  ER-0433                 PIC X(4)  VALUE '0433'.
   575     12  ER-0436                 PIC X(4)  VALUE '0436'.
   576     12  ER-0437                 PIC X(4)  VALUE '0437'.
   577     12  ER-0438                 PIC X(4)  VALUE '0438'.
   578     12  ER-0439                 PIC X(4)  VALUE '0439'.
   579     12  ER-0440                 PIC X(4)  VALUE '0440'.
   580     12  ER-0441                 PIC X(4)  VALUE '0441'.
   581     12  ER-0442                 PIC X(4)  VALUE '0442'.
   582     12  ER-0443                 PIC X(4)  VALUE '0443'.
   583     12  ER-0444                 PIC X(4)  VALUE '0444'.
   584     12  ER-0445                 PIC X(4)  VALUE '0445'.
   585     12  ER-0446                 PIC X(4)  VALUE '0446'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  12
* EL156.cbl
   586     12  ER-0447                 PIC X(4)  VALUE '0447'.
   587     12  ER-0448                 PIC X(4)  VALUE '0448'.
   588     12  ER-0449                 PIC X(4)  VALUE '0449'.
   589     12  ER-0452                 PIC X(4)  VALUE '0452'.
   590     12  ER-0458                 PIC X(4)  VALUE '0458'.
   591     12  ER-0459                 PIC X(4)  VALUE '0459'.
   592     12  ER-0460                 PIC X(4)  VALUE '0460'.
   593     12  ER-0461                 PIC X(4)  VALUE '0461'.
   594     12  ER-0462                 PIC X(4)  VALUE '0462'.
   595     12  ER-0463                 PIC X(4)  VALUE '0463'.
   596     12  ER-0464                 PIC X(4)  VALUE '0464'.
   597     12  ER-0465                 PIC X(4)  VALUE '0465'.
   598     12  ER-0466                 PIC X(4)  VALUE '0466'.
   599     12  ER-0467                 PIC X(4)  VALUE '0467'.
   600     12  ER-0468                 PIC X(4)  VALUE '0468'.
   601     12  ER-0469                 PIC X(4)  VALUE '0469'.
   602     12  ER-0473                 PIC X(4)  VALUE '0473'.
   603     12  ER-0474                 PIC X(4)  VALUE '0474'.
   604     12  ER-0475                 PIC X(4)  VALUE '0475'.
   605     12  ER-0476                 PIC X(4)  VALUE '0476'.
   606     12  ER-0477                 PIC X(4)  VALUE '0477'.
   607     12  ER-0478                 PIC X(4)  VALUE '0478'.
   608     12  ER-0479                 PIC X(4)  VALUE '0479'.
   609     12  ER-0481                 PIC X(4)  VALUE '0481'.
   610     12  ER-0491                 PIC X(4)  VALUE '0491'.
   611     12  ER-0492                 PIC X(4)  VALUE '0492'.
   612     12  ER-0493                 PIC X(4)  VALUE '0493'.
   613     12  ER-0494                 PIC X(4)  VALUE '0494'.
   614     12  ER-0495                 PIC X(4)  VALUE '0495'.
   615     12  ER-0499                 PIC X(4)  VALUE '0499'.
   616     12  ER-0500                 PIC X(4)  VALUE '0500'.
   617     12  ER-0501                 PIC X(4)  VALUE '0501'.
   618     12  ER-0502                 PIC X(4)  VALUE '0502'.
   619     12  ER-0508                 PIC X(4)  VALUE '0508'.
   620     12  ER-0513                 PIC X(4)  VALUE '0513'.
   621     12  ER-0518                 PIC X(4)  VALUE '0518'.
   622     12  ER-0524                 PIC X(4)  VALUE '0524'.
   623     12  ER-0525                 PIC X(4)  VALUE '0525'.
   624     12  ER-0526                 PIC X(4)  VALUE '0526'.
   625     12  ER-0530                 PIC X(4)  VALUE '0530'.
   626     12  ER-0540                 PIC X(4)  VALUE '0540'.
   627     12  ER-0541                 PIC X(4)  VALUE '0541'.
   628     12  ER-0542                 PIC X(4)  VALUE '0542'.
   629     12  ER-0543                 PIC X(4)  VALUE '0543'.
   630     12  ER-0545                 PIC X(4)  VALUE '0545'.
   631     12  ER-0552                 PIC X(4)  VALUE '0552'.
   632     12  ER-0555                 PIC X(4)  VALUE '0555'.
   633     12  ER-0556                 PIC X(4)  VALUE '0556'.
   634     12  ER-0557                 PIC X(4)  VALUE '0557'.
   635     12  ER-0572                 PIC X(4)  VALUE '0572'.
   636     12  ER-0573                 PIC X(4)  VALUE '0573'.
   637     12  ER-0594                 PIC X(4)  VALUE '0594'.
   638     12  ER-0616                 PIC X(4)  VALUE '0616'.
   639     12  ER-0617                 PIC X(4)  VALUE '0617'.
   640     12  ER-0618                 PIC X(4)  VALUE '0618'.
   641     12  ER-0657                 PIC X(4)  VALUE '0657'.
   642     12  ER-0658                 PIC X(4)  VALUE '0658'.
   643     12  ER-0699                 PIC X(4)  VALUE '0699'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  13
* EL156.cbl
   644     12  ER-0730                 PIC X(4)  VALUE '0730'.
   645     12  ER-0737                 PIC X(4)  VALUE '0737'.
   646     12  ER-0760                 PIC X(4)  VALUE '0760'.
   647     12  ER-0768                 PIC X(4)  VALUE '0768'.
   648     12  ER-0769                 PIC X(4)  VALUE '0769'.
   649     12  ER-0770                 PIC X(4)  VALUE '0770'.
   650     12  ER-0802                 PIC X(4)  VALUE '0802'.
   651     12  ER-0803                 PIC X(4)  VALUE '0803'.
   652     12  ER-0819                 PIC X(4)  VALUE '0819'.
   653     12  ER-0834                 PIC X(4)  VALUE '0834'.
   654     12  ER-0836                 PIC X(4)  VALUE '0836'.
   655     12  ER-0844                 PIC X(4)  VALUE '0844'.
   656     12  ER-0845                 PIC X(4)  VALUE '0845'.
   657     12  ER-0846                 PIC X(4)  VALUE '0846'.
   658     12  ER-0849                 PIC X(4)  VALUE '0849'.
   659     12  ER-0851                 PIC X(4)  VALUE '0851'.
   660     12  ER-0872                 PIC X(4)  VALUE '0872'.
   661     12  ER-0873                 PIC X(4)  VALUE '0873'.
   662     12  ER-0874                 PIC X(4)  VALUE '0874'.
   663     12  ER-0879                 PIC X(4)  VALUE '0879'.
   664     12  ER-0919                 PIC X(4)  VALUE '0919'.
   665     12  ER-0921                 PIC X(4)  VALUE '0921'.
   666     12  ER-0923                 PIC X(4)  VALUE '0923'.
   667     12  ER-0925                 PIC X(4)  VALUE '0925'.
   668     12  ER-0944                 PIC X(4)  VALUE '0944'.
   669     12  ER-0945                 PIC X(4)  VALUE '0945'.
   670     12  ER-0946                 PIC X(4)  VALUE '0946'.
   671     12  ER-0947                 PIC X(4)  VALUE '0947'.
   672     12  ER-0948                 PIC X(4)  VALUE '0948'.
   673     12  ER-0949                 PIC X(4)  VALUE '0949'.
   674     12  ER-0950                 PIC X(4)  VALUE '0950'.
   675     12  ER-0951                 PIC X(4)  VALUE '0951'.
   676     12  ER-0954                 PIC X(4)  VALUE '0954'.
   677     12  ER-0956                 PIC X(4)  VALUE '0956'.
   678     12  ER-0967                 PIC X(4)  VALUE '0967'.
   679     12  ER-0968                 PIC X(4)  VALUE '0968'.
   680     12  ER-0974                 PIC X(4)  VALUE '0974'.
   681     12  ER-0975                 PIC X(4)  VALUE '0975'.
   682     12  ER-1561                 PIC X(4)  VALUE '1561'.
   683     12  ER-1566                 PIC X(4)  VALUE '1566'.
   684     12  ER-1567                 PIC X(4)  VALUE '1567'.
   685     12  ER-1569                 PIC X(4)  VALUE '1569'.
   686     12  er-1582                 pic x(4)  value '1582'.
   687     12  er-1657                 pic x(4)  value '1657'.
   688     12  er-1658                 pic x(4)  value '1658'.
   689     12  er-1667                 pic x(4)  value '1667'.
   690     12  er-1670                 pic x(4)  value '1670'.
   691     12  er-1671                 pic x(4)  value '1671'.
   692     12  er-1672                 pic x(4)  value '1672'.
   693     12  er-1673                 pic x(4)  value '1673'.
   694     12  er-1674                 pic x(4)  value '1674'.
   695     12  er-1677                 pic x(4)  value '1677'.
   696     12  ER-1775                 PIC X(4)  VALUE '1775'.
   697     12  ER-1880                 PIC X(4)  VALUE '1880'.
   698     12  ER-2044                 PIC X(4)  VALUE '2044'.
   699     12  ER-3140                 PIC X(4)  VALUE '3140'.
   700     12  ER-3141                 PIC X(4)  VALUE '3141'.
   701     12  ER-3255                 PIC X(4)  VALUE '3255'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  14
* EL156.cbl
   702     12  ER-3516                 PIC X(4)  VALUE '3516'.
   703     12  ER-3527                 PIC X(4)  VALUE '3527'.
   704     12  ER-3528                 PIC X(4)  VALUE '3528'.
   705     12  ER-3529                 PIC X(4)  VALUE '3529'.
   706     12  ER-3530                 PIC X(4)  VALUE '3530'.
   707     12  ER-3531                 PIC X(4)  VALUE '3531'.
   708     12  ER-3532                 PIC X(4)  VALUE '3532'.
   709     12  ER-3533                 PIC X(4)  VALUE '3533'.
   710     12  ER-3534                 PIC X(4)  VALUE '3534'.
   711     12  ER-3535                 PIC X(4)  VALUE '3535'.
   712     12  ER-3536                 PIC X(4)  VALUE '3536'.
   713     12  ER-3537                 PIC X(4)  VALUE '3537'.
   714     12  ER-3538                 PIC X(4)  VALUE '3538'.
   715     12  ER-3539                 PIC X(4)  VALUE '3539'.
   716     12  ER-3540                 PIC X(4)  VALUE '3540'.
   717     12  ER-3541                 PIC X(4)  VALUE '3541'.
   718     12  ER-3542                 PIC X(4)  VALUE '3542'.
   719     12  ER-3543                 PIC X(4)  VALUE '3543'.
   720     12  ER-3546                 PIC X(4)  VALUE '3546'.
   721     12  ER-3549                 PIC X(4)  VALUE '3549'.
   722     12  ER-3818                 PIC X(4)  VALUE '3818'.
   723     12  ER-7540                 PIC X(4)  VALUE '7540'.
   724     12  ER-7576                 PIC X(4)  VALUE '7576'.
   725     12  ER-7579                 PIC X(4)  VALUE '7579'.
   726     12  ER-7580                 PIC X(4)  VALUE '7580'.
   727     12  ER-7583                 PIC X(4)  VALUE '7583'.
   728     12  ER-7830                 PIC X(4)  VALUE '7830'.
   729     12  ER-7831                 PIC X(4)  VALUE '7831'.
   730     12  ER-7832                 PIC X(4)  VALUE '7832'.
   731     12  ER-7833                 PIC X(4)  VALUE '7833'.
   732     12  ER-7834                 PIC X(4)  VALUE '7834'.
   733     12  ER-7835                 PIC X(4)  VALUE '7835'.
   734     12  ER-7836                 PIC X(4)  VALUE '7836'.
   735     12  ER-7837                 PIC X(4)  VALUE '7837'.
   736     12  ER-7838                 PIC X(4)  VALUE '7838'.
   737     12  ER-7841                 PIC X(4)  VALUE '7841'.
   738     12  ER-7844                 PIC X(4)  VALUE '7844'.
   739     12  ER-7845                 PIC X(4)  VALUE '7845'.
   740     12  ER-8000                 PIC X(4)  VALUE '8000'.
   741     12  ER-8051                 PIC X(4)  VALUE '8051'.
   742     12  ER-8052                 PIC X(4)  VALUE '8052'.
   743     12  ER-8053                 PIC X(4)  VALUE '8053'.
   744     12  ER-8054                 PIC X(4)  VALUE '8054'.
   745     12  ER-8055                 PIC X(4)  VALUE '8055'.
   746     12  ER-8056                 PIC X(4)  VALUE '8056'.
   747     12  ER-8057                 PIC X(4)  VALUE '8057'.
   748     12  ER-8058                 PIC X(4)  VALUE '8058'.
   749     12  ER-8059                 PIC X(4)  VALUE '8059'.
   750     12  ER-8060                 PIC X(4)  VALUE '8060'.
   751     12  ER-8061                 PIC X(4)  VALUE '8061'.
   752     12  ER-8062                 PIC X(4)  VALUE '8062'.
   753     12  ER-8063                 PIC X(4)  VALUE '8063'.
   754     12  ER-8064                 PIC X(4)  VALUE '8064'.
   755     12  ER-8065                 PIC X(4)  VALUE '8065'.
   756     12  ER-8066                 PIC X(4)  VALUE '8066'.
   757     12  ER-8146                 PIC X(4)  VALUE '8146'.
   758     12  ER-8147                 PIC X(4)  VALUE '8147'.
   759     12  ER-8152                 PIC X(4)  VALUE '8152'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  15
* EL156.cbl
   760     12  ER-8153                 PIC X(4)  VALUE '8153'.
   761     12  ER-8154                 PIC X(4)  VALUE '8154'.
   762     12  ER-8155                 PIC X(4)  VALUE '8155'.
   763     12  ER-8310                 PIC X(4)  VALUE '8310'.
   764     12  ER-8311                 PIC X(4)  VALUE '8311'.
   765     12  ER-8312                 PIC X(4)  VALUE '8312'.
   766     12  ER-8313                 PIC X(4)  VALUE '8313'.
   767     12  ER-8314                 PIC X(4)  VALUE '8314'.
   768     12  ER-8315                 PIC X(4)  VALUE '8315'.
   769     12  ER-8316                 PIC X(4)  VALUE '8316'.
   770     12  ER-8317                 PIC X(4)  VALUE '8317'.
   771
   772 01  CSO-WORK-FIELDS.
   773     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   774       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   775
   776     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   777     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   778         88  CERT-NOTE-ADDED           VALUE 'Y'.
   779     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   780         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   781     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   782
   783     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   784
   785 01  SC-NP6-CERT-NOTE.
   786     12  FILLER                  PIC X(12)
   787               VALUE 'REM BENEFIT '.
   788     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   789     12  SC-NP6-COMM             PIC X(8)
   790               VALUE ' + 6 MO '.
   791     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   792     12  FILLER                  PIC X(12)
   793               VALUE ' = AMT PAID '.
   794     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   795
   796 01  SC-NP6-ORIG-NOTE.
   797     12  FILLER                  PIC X(63)  VALUE
   798         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   799 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   800     88  PDEF-FOUND                   VALUE 'Y'.
   801 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   802     88  ACCT-FOUND                   VALUE 'Y'.
   803 01  CTBL-KEY-SAVE               PIC X(5).
   804 01  CTBL-KEY.
   805     05  CTBL-COMPANY-CD         PIC X.
   806     05  CTBL-TABLE              PIC XXX.
   807     05  CTBL-BEN-TYPE           PIC X.
   808     05  CTBL-BEN-CODE           PIC XX.
   809 01  ERPDEF-KEY-SAVE             PIC X(18).
   810 01  ERPDEF-KEY.
   811     12  ERPDEF-COMPANY-CD       PIC X.
   812     12  ERPDEF-STATE            PIC XX.
   813     12  ERPDEF-PROD-CD          PIC XXX.
   814     12  F                       PIC X(7).
   815     12  ERPDEF-BEN-TYPE         PIC X.
   816     12  ERPDEF-BEN-CODE         PIC XX.
   817     12  ERPDEF-EXP-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  16
* EL156.cbl
   818 01  ELCRTT-KEY.
   819     05  CTRLR-COMP-CD       PIC X.
   820     05  CTRLR-CARRIER       PIC X.
   821     05  CTRLR-GROUPING      PIC X(6).
   822     05  CTRLR-STATE         PIC X(2).
   823     05  CTRLR-ACCOUNT       PIC X(10).
   824     05  CTRLR-EFF-DT        PIC XX.
   825     05  CTRLR-CERT-NO       PIC X(11).
   826     05  CTRLR-REC-TYPE      PIC X.
   827 01  ACCESS-KEYS.
   828     12  ELARCH-KEY.
   829         16  ARCH-CO             PIC X.
   830         16  ARCH-NUMBER         PIC S9(08) COMP.
   831         16  ARCH-REC-TYPE       PIC X.
   832         16  ARCH-SEQ            PIC S9(04) COMP.
   833     12  ELMSTR-KEY.
   834         16  MSTR-COMP-CD        PIC X.
   835         16  MSTR-CARRIER        PIC X.
   836         16  MSTR-CLAIM-NO       PIC X(7).
   837         16  MSTR-CERT-NO        PIC X(11).
   838     12  ELCNTL-KEY.
   839         16  CNTL-COMP-ID        PIC X(3).
   840         16  CNTL-REC-TYPE       PIC X.
   841         16  CNTL-ACCESS         PIC X(4).
   842         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   843     12  ELCERT-KEY.
   844         16  CERT-COMP-CD        PIC X.
   845         16  CERT-CARRIER        PIC X.
   846         16  CERT-GROUPING       PIC X(6).
   847         16  CERT-STATE          PIC XX.
   848         16  CERT-ACCOUNT        PIC X(10).
   849         16  CERT-EFF-DT         PIC XX.
   850         16  CERT-CERT-NO        PIC X(11).
   851     12  ELTRLR-KEY.
   852         16  TRLR-COMP-CD        PIC X.
   853         16  TRLR-CARRIER        PIC X.
   854         16  TRLR-CLAIM-NO       PIC X(7).
   855         16  TRLR-CERT-NO        PIC X(11).
   856         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   857     12  ELACTQ-KEY.
   858         16  ACTQ-COMP-CD        PIC X.
   859         16  ACTQ-CARRIER        PIC X.
   860         16  ACTQ-CLAIM-NO       PIC X(7).
   861         16  ACTQ-CERT-NO        PIC X(11).
   862     12  W-NOTE-KEY.
   863         16  W-NOTE-COMP-CD      PIC X.
   864         16  W-NOTE-CERT-KEY.
   865             20  W-NOTE-CARRIER  PIC X.
   866             20  W-NOTE-GROUPING PIC X(6).
   867             20  W-NOTE-STATE    PIC XX.
   868             20  W-NOTE-ACCOUNT  PIC X(10).
   869             20  W-NOTE-EFF-DT   PIC XX.
   870             20  W-NOTE-CERT-NO  PIC X(11).
   871     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   872     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   873     12  ERACCT-KEY.
   874         16  ERACCT-PARTIAL-KEY.
   875             20  ACCT-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  17
* EL156.cbl
   876             20  ACCT-CARRIER    PIC X.
   877             20  ACCT-GROUPING   PIC X(6).
   878             20  ACCT-STATE      PIC XX.
   879             20  ACCT-ACCOUNT    PIC X(10).
   880         16  ACCT-EXP-DT         PIC XX.
   881         16  FILLER              PIC X(4) VALUE SPACES.
   882     12  ELCHKQ-KEY.
   883         16  CHKQ-COMP-CD        PIC X.
   884         16  CHKQ-CONTROL        PIC S9(8) COMP.
   885         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   886     12  ELBENE-KEY.
   887         16  BENE-COMP-CD         PIC X.
   888         16  BENE-RECORD-TYPE     PIC X.
   889         16  BENE-NUMBER          PIC X(10).
   890     12  ERCOMP-KEY.
   891         16  COMP-COMP-CD        PIC X.
   892         16  COMP-CARRIER        PIC X.
   893         16  COMP-GROUP          PIC X(06).
   894         16  COMP-FIN-RESP       PIC X(10).
   895         16  COMP-ACCOUNT        PIC X(10).
   896         16  COMP-TYPE           PIC X.
   897
   898     12  DLO035-KEY.
   899         16  DL35-PROCESS-TYPE   PIC X.
   900         16  DL35-CREDIT-CARD    PIC X(20).
   901         16  DL35-BEN-TYPE       PIC XX.
   902         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   903         16  DL35-RETURN-CODE    PIC XX.
   904
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  18
* EL156.cbl
   906*    COPY ELCDATE.
   907******************************************************************
   908*                                                                *
   909*                                                                *
   910*                            ELCDATE.                            *
   911*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   912*                            VMOD=2.003
   913*                                                                *
   914*                                                                *
   915*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   916*                 LENGTH = 200                                   *
   917******************************************************************
   918
   919 01  DATE-CONVERSION-DATA.
   920     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   921     12  DC-OPTION-CODE                PIC X.
   922         88  BIN-TO-GREG                VALUE ' '.
   923         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   924         88  EDIT-GREG-TO-BIN           VALUE '2'.
   925         88  YMD-GREG-TO-BIN            VALUE '3'.
   926         88  MDY-GREG-TO-BIN            VALUE '4'.
   927         88  JULIAN-TO-BIN              VALUE '5'.
   928         88  BIN-PLUS-ELAPSED           VALUE '6'.
   929         88  FIND-CENTURY               VALUE '7'.
   930         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   931         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   932         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   933         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   934         88  JULIAN-TO-BIN-3            VALUE 'C'.
   935         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   936         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   937         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   938         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   939         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   940         88  CHECK-LEAP-YEAR            VALUE 'H'.
   941         88  BIN-3-TO-GREG              VALUE 'I'.
   942         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   943         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   944         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   945         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   946         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   947         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   948         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   949         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   950         88  THREE-CHARACTER-BIN
   951                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   952         88  GREGORIAN-TO-BIN
   953                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   954         88  BIN-TO-GREGORIAN
   955                  VALUES ' ' '1' 'I' '8' 'G'.
   956         88  JULIAN-TO-BINARY
   957                  VALUES '5' 'C' 'E' 'F'.
   958     12  DC-ERROR-CODE                 PIC X.
   959         88  NO-CONVERSION-ERROR        VALUE ' '.
   960         88  DATE-CONVERSION-ERROR
   961                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   962         88  DATE-IS-ZERO               VALUE '1'.
   963         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  19
* EL156.cbl
   964         88  DATE-IS-INVALID            VALUE '3'.
   965         88  DATE1-GREATER-DATE2        VALUE '4'.
   966         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   967         88  DATE-INVALID-OPTION        VALUE '9'.
   968         88  INVALID-CENTURY            VALUE 'A'.
   969         88  ONLY-CENTURY               VALUE 'B'.
   970         88  ONLY-LEAP-YEAR             VALUE 'C'.
   971         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   972     12  DC-END-OF-MONTH               PIC X.
   973         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   974     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   975         88  USE-NORMAL-PROCESS         VALUE ' '.
   976         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   977         88  ADJUST-UP-100-YRS          VALUE '2'.
   978     12  FILLER                        PIC X.
   979     12  DC-CONVERSION-DATES.
   980         16  DC-BIN-DATE-1             PIC XX.
   981         16  DC-BIN-DATE-2             PIC XX.
   982         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   983         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   984                       DC-GREG-DATE-1-EDIT.
   985             20  DC-EDIT1-MONTH        PIC 99.
   986             20  SLASH1-1              PIC X.
   987             20  DC-EDIT1-DAY          PIC 99.
   988             20  SLASH1-2              PIC X.
   989             20  DC-EDIT1-YEAR         PIC 99.
   990         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   991         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   992                     DC-GREG-DATE-2-EDIT.
   993             20  DC-EDIT2-MONTH        PIC 99.
   994             20  SLASH2-1              PIC X.
   995             20  DC-EDIT2-DAY          PIC 99.
   996             20  SLASH2-2              PIC X.
   997             20  DC-EDIT2-YEAR         PIC 99.
   998         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   999         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1000                     DC-GREG-DATE-1-YMD.
  1001             20  DC-YMD-YEAR           PIC 99.
  1002             20  DC-YMD-MONTH          PIC 99.
  1003             20  DC-YMD-DAY            PIC 99.
  1004         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1005         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1006                      DC-GREG-DATE-1-MDY.
  1007             20  DC-MDY-MONTH          PIC 99.
  1008             20  DC-MDY-DAY            PIC 99.
  1009             20  DC-MDY-YEAR           PIC 99.
  1010         16  DC-GREG-DATE-1-ALPHA.
  1011             20  DC-ALPHA-MONTH        PIC X(10).
  1012             20  DC-ALPHA-DAY          PIC 99.
  1013             20  FILLER                PIC XX.
  1014             20  DC-ALPHA-CENTURY.
  1015                 24 DC-ALPHA-CEN-N     PIC 99.
  1016             20  DC-ALPHA-YEAR         PIC 99.
  1017         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1018         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1019         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1020         16  DC-JULIAN-DATE            PIC 9(05).
  1021         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  20
* EL156.cbl
  1022                                       PIC 9(05).
  1023         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1024             20  DC-JULIAN-YEAR        PIC 99.
  1025             20  DC-JULIAN-DAYS        PIC 999.
  1026         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1027         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1028         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1029     12  DATE-CONVERSION-VARIBLES.
  1030         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1031         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1032             20  FILLER                PIC 9(3).
  1033             20  HOLD-CEN-1-CCYY.
  1034                 24  HOLD-CEN-1-CC     PIC 99.
  1035                 24  HOLD-CEN-1-YY     PIC 99.
  1036             20  HOLD-CEN-1-MO         PIC 99.
  1037             20  HOLD-CEN-1-DA         PIC 99.
  1038         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1039             20  HOLD-CEN-1-R-MO       PIC 99.
  1040             20  HOLD-CEN-1-R-DA       PIC 99.
  1041             20  HOLD-CEN-1-R-CCYY.
  1042                 24  HOLD-CEN-1-R-CC   PIC 99.
  1043                 24  HOLD-CEN-1-R-YY   PIC 99.
  1044             20  FILLER                PIC 9(3).
  1045         16  HOLD-CENTURY-1-X.
  1046             20  FILLER                PIC X(3)  VALUE SPACES.
  1047             20  HOLD-CEN-1-X-CCYY.
  1048                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1049                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1050             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1051             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1052         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1053             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1054             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1055             20  HOLD-CEN-1-R-X-CCYY.
  1056                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1057                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1058             20  FILLER                PIC XXX.
  1059         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1060         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1061         16  DC-JULIAN-DATE-1          PIC 9(07).
  1062         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1063             20  DC-JULIAN-1-CCYY.
  1064                 24  DC-JULIAN-1-CC    PIC 99.
  1065                 24  DC-JULIAN-1-YR    PIC 99.
  1066             20  DC-JULIAN-DA-1        PIC 999.
  1067         16  DC-JULIAN-DATE-2          PIC 9(07).
  1068         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1069             20  DC-JULIAN-2-CCYY.
  1070                 24  DC-JULIAN-2-CC    PIC 99.
  1071                 24  DC-JULIAN-2-YR    PIC 99.
  1072             20  DC-JULIAN-DA-2        PIC 999.
  1073         16  DC-GREG-DATE-A-EDIT.
  1074             20  DC-EDITA-MONTH        PIC 99.
  1075             20  SLASHA-1              PIC X VALUE '/'.
  1076             20  DC-EDITA-DAY          PIC 99.
  1077             20  SLASHA-2              PIC X VALUE '/'.
  1078             20  DC-EDITA-CCYY.
  1079                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  21
* EL156.cbl
  1080                 24  DC-EDITA-YEAR     PIC 99.
  1081         16  DC-GREG-DATE-B-EDIT.
  1082             20  DC-EDITB-MONTH        PIC 99.
  1083             20  SLASHB-1              PIC X VALUE '/'.
  1084             20  DC-EDITB-DAY          PIC 99.
  1085             20  SLASHB-2              PIC X VALUE '/'.
  1086             20  DC-EDITB-CCYY.
  1087                 24  DC-EDITB-CENT     PIC 99.
  1088                 24  DC-EDITB-YEAR     PIC 99.
  1089         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1090         16  DC-GREG-DATE-CYMD-R REDEFINES
  1091                              DC-GREG-DATE-CYMD.
  1092             20  DC-CYMD-CEN           PIC 99.
  1093             20  DC-CYMD-YEAR          PIC 99.
  1094             20  DC-CYMD-MONTH         PIC 99.
  1095             20  DC-CYMD-DAY           PIC 99.
  1096         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1097         16  DC-GREG-DATE-MDCY-R REDEFINES
  1098                              DC-GREG-DATE-MDCY.
  1099             20  DC-MDCY-MONTH         PIC 99.
  1100             20  DC-MDCY-DAY           PIC 99.
  1101             20  DC-MDCY-CEN           PIC 99.
  1102             20  DC-MDCY-YEAR          PIC 99.
  1103    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1104        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1105    12  DC-EL310-DATE                  PIC X(21).
  1106    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  22
* EL156.cbl
  1108*    COPY ELCLOGOF.
  1109******************************************************************
  1110*                                                                *
  1111*                                                                *
  1112*                            ELCLOGOF.                           *
  1113*                            VMOD=2.001                          *
  1114*                                                                *
  1115*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1116*                                                                *
  1117******************************************************************
  1118 01  CLASIC-LOGOFF.
  1119     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1120     12  LOGOFF-TEXT.
  1121         16  FILLER          PIC X(5)    VALUE SPACES.
  1122         16  LOGOFF-MSG.
  1123             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1124             20  FILLER      PIC X       VALUE SPACES.
  1125             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1126         16  FILLER          PIC X(80)
  1127           VALUE '* YOU ARE NOW LOGGED OFF'.
  1128         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1129         16  FILLER          PIC X       VALUE QUOTE.
  1130         16  LOGOFF-SYS-MSG  PIC X(17)
  1131           VALUE 'S CLAS-IC SYSTEM '.
  1132     12  TEXT-MESSAGES.
  1133         16  UNACCESS-MSG    PIC X(29)
  1134             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1135         16  PGMIDERR-MSG    PIC X(17)
  1136             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  23
* EL156.cbl
  1138*    COPY ELCCALC.
  1139******************************************************************
  1140*                                                                *
  1141*                           ELCCALC.                            *
  1142*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1143*                            VMOD=2.025                          *
  1144*                                                                *
  1145*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1146*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1147*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1148*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1149*                                                                *
  1150*  PASSED TO ELRTRM                                              *
  1151*  -----------------                                             *
  1152*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1153*  ORIGINAL TERM                                                 *
  1154*  BEGINNING DATE                                                *
  1155*  ENDING DATE                                                   *
  1156*  COMPANY I.D.                                                  *
  1157*  ACCOUNT MASTER USER FIELD                                     *
  1158*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1159*  FREE LOOK DAYS                                                *
  1160*                                                                *
  1161*  RETURNED FROM ELRTRM                                          *
  1162*  ---------------------                                         *
  1163*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1164*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1165*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1166*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1167*----------------------------------------------------------------*
  1168*  PASSED TO ELRAMT                                              *
  1169*  ----------------                                              *
  1170*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1171*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1172*  ORIGINAL AMOUNT                                               *
  1173*  ALTERNATE BENEFIT (BALLON)                                    *
  1174*  A.P.R. - NET PAY ONLY                                         *
  1175*  METHOD
  1176*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1177*  COMPANY I.D.                                                  *
  1178*  BENEFIT TYPE                                                  *
  1179*                                                                *
  1180*  RETURNED FROM ELRAMT                                          *
  1181*  --------------------                                          *
  1182*  REMAINING AMOUNT 1 - CURRENT                                  *
  1183*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1184*  REMAINING AMOUNT FACTOR
  1185*----------------------------------------------------------------*
  1186*  PASSED TO ELRESV                                              *
  1187*  -----------------                                             *
  1188*  CERTIFICATE EFFECTIVE DATE                                    *
  1189*  VALUATION DATE                                                *
  1190*  PAID THRU DATE                                                *
  1191*  BENEFIT                                                       *
  1192*  INCURRED DATE                                                 *
  1193*  REPORTED DATE                                                 *
  1194*  ISSUE AGE                                                     *
  1195*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  24
* EL156.cbl
  1196*  CDT PERCENT                                                   *
  1197*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1198* *CLAIM TYPE (LIFE, A/H)                                        *
  1199* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1200* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1201*                                                                *
  1202*  RETURNED FROM ELRESV                                          *
  1203*  --------------------                                          *
  1204*  CDT TABLE USED                                                *
  1205*  CDT FACTOR USED                                               *
  1206*  PAY TO CURRENT RESERVE                                        *
  1207*  I.B.N.R. - A/H ONLY                                           *
  1208*  FUTURE (ACCRUED) AH ONLY                                      *
  1209*----------------------------------------------------------------*
  1210*  PASSED TO ELRATE                                              *
  1211*  ----------------                                              *
  1212*  CERT ISSUE DATE                                               *
  1213*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1214*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1215*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1216*  STATE CODE (CLIENT DEFINED)                                   *
  1217*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1218*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1219*  DEVIATION CODE                                                *
  1220*  ISSUE AGE                                                     *
  1221*  ORIGINAL BENEFIT AMOUNT                                       *
  1222*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1223*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1224*  BENEFIT KIND (LIFE OR A/H)                                    *
  1225*  A.P.R.                                                        *
  1226*  METHOD
  1227*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1228*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1229*  COMPANY I.D. (3 CHARACTER)                                    *
  1230*  BENEFIT CODE                                                  *
  1231*  BENEFIT OVERRIDE CODE                                         *
  1232*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1233*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1234*  JOINT INDICATOR (CSL ONLY)                                    *
  1235*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1236*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1237*                                                                *
  1238*  RETURNED FROM ELRATE                                          *
  1239*  --------------------                                          *
  1240*  CALCULATED PREMIUM                                            *
  1241*  PREMIUM RATE                                                  *
  1242*  MORTALITY CODE                                                *
  1243*  MAX ATTAINED AGE                                              *
  1244*  MAX AGE                                                       *
  1245*  MAX TERM                                                      *
  1246*  MAX MONTHLY BENEFIT                                           *
  1247*  MAX TOTAL BENIFIT                                             *
  1248*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1249*----------------------------------------------------------------*
  1250*  PASSED TO ELRFND                                              *
  1251*  ----------------                                              *
  1252*  CERT ISSUE DATE                                               *
  1253*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  25
* EL156.cbl
  1254*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1255*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1256*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1257*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1258*  STATE CODE (CLIENT DEFINED)                                   *
  1259*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1260*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1261*  DEVIATION CODE                                                *
  1262*  ISSUE AGE                                                     *
  1263*  ORIGINAL BENEFIT AMOUNT                                       *
  1264*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1265*  PROCESS TYPE (CANCEL)                                         *
  1266*  BENEFIT KIND (LIFE OR A/H)                                    *
  1267*  A.P.R.                                                        *
  1268*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1269*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1270*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1271*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1272*  COMPANY I.D. (3 CHARACTER)                                    *
  1273*  BENEFIT CODE                                                  *
  1274*  BENEFIT OVERRIDE CODE                                         *
  1275*                                                                *
  1276*  RETURNED FROM ELRFND                                          *
  1277*  --------------------                                          *
  1278*  CALCULATED REFUND                                             *
  1279*----------------------------------------------------------------*
  1280*  PASSED TO ELEARN                                              *
  1281*  ----------------                                              *
  1282*  CERT ISSUE DATE                                               *
  1283*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1284*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1285*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1286*  STATE CODE (CLIENT DEFINED)                                   *
  1287*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1288*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1289*  DEVIATION CODE                                                *
  1290*  ISSUE AGE                                                     *
  1291*  ORIGINAL BENEFIT AMOUNT                                       *
  1292*  BENEFIT KIND (LIFE OR A/H)                                    *
  1293*  A.P.R.                                                        *
  1294*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1295*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1296*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1297*  COMPANY I.D. (3 CHARACTER)                                    *
  1298*  BENEFIT CODE                                                  *
  1299*  BENEFIT OVERRIDE CODE                                         *
  1300*                                                                *
  1301*  RETURNED FROM ELEARN                                          *
  1302*  --------------------                                          *
  1303*  INDICATED  EARNINGS                                           *
  1304*----------------------------------------------------------------*
  1305*                 LENGTH = 450                                   *
  1306*                                                                *
  1307******************************************************************
  1308******************************************************************
  1309*                   C H A N G E   L O G
  1310*
  1311* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  26
* EL156.cbl
  1312*-----------------------------------------------------------------
  1313*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1314* EFFECTIVE    NUMBER
  1315*-----------------------------------------------------------------
  1316* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1317* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1318* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1319* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1320* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1321* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1322* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1323* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1324* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1325* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1326******************************************************************
  1327
  1328 01  CALCULATION-PASS-AREA.
  1329     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1330                                     COMP.
  1331
  1332     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1333       88  NO-CP-ERROR                             VALUE ZERO.
  1334       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1335                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1336       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1337       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1338       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1339       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1340       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1341       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1342       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1343       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1344       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1345       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1346       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1347       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1348       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1349       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1350       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1351       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1352       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1353
  1354     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1355       88  NO-CP-ERROR-2                           VALUE ZERO.
  1356***********************  INPUT AREAS ****************************
  1357
  1358     12  CP-CALCULATION-AREA.
  1359         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1360         16  CP-CERT-EFF-DT        PIC XX.
  1361         16  CP-VALUATION-DT       PIC XX.
  1362         16  CP-PAID-THRU-DT       PIC XX.
  1363         16  CP-BENEFIT-TYPE       PIC X.
  1364           88  CP-AH                               VALUE 'A' 'D'
  1365                                                   'I' 'U'.
  1366           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1367           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1368         16  CP-INCURRED-DT        PIC XX.
  1369         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  27
* EL156.cbl
  1370         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1371         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1372         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1373                                     COMP-3.
  1374         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1375                                     COMP-3.
  1376         16  CP-CDT-METHOD         PIC X.
  1377           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1378           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1379           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1380         16  CP-CLAIM-TYPE         PIC X.
  1381           88  CP-AH-CLAIM                         VALUE 'A'.
  1382           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1383         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1384                                     COMP-3.
  1385         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1386                                     COMP-3.
  1387         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1388                                     COMP-3.
  1389         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1390                                     COMP-3.
  1391         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1392                                     COMP-3.
  1393         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1394                                     COMP-3.
  1395         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1396                                     COMP-3.
  1397         16  CP-REM-TERM-METHOD    PIC X.
  1398           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1399           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1400           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1401           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1402           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1403           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1404           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1405         16  CP-EARNING-METHOD     PIC X.
  1406           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1407           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1408           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1409           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1410           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1411           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1412           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1413           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1414           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1415           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1416           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1417           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1418           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1419           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1420         16  CP-PROCESS-TYPE       PIC X.
  1421           88  CP-CLAIM                            VALUE '1'.
  1422           88  CP-CANCEL                           VALUE '2'.
  1423           88  CP-ISSUE                            VALUE '3'.
  1424         16  CP-SPECIAL-CALC-CD    PIC X.
  1425           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1426           88  CP-1-MTH-INTEREST               VALUE ' '.
  1427           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  28
* EL156.cbl
  1428           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1429           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1430           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1431           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1432           88  CP-FARM-PLAN                    VALUE 'F'.
  1433           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1434           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1435           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1436           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1437           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1438           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1439           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1440           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1441           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1442           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1443                                                     'W' 'X'.
  1444           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1445           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1446           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1447           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1448           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1449           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1450           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1451           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1452           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1453           88  CP-CSL-METH-1                   VALUE '5'.
  1454           88  CP-CSL-METH-2                   VALUE '6'.
  1455           88  CP-CSL-METH-3                   VALUE '7'.
  1456           88  CP-CSL-METH-4                   VALUE '8'.
  1457
  1458         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1459                                     COMP-3.
  1460         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1461         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1462         16  CP-STATE              PIC XX          VALUE SPACE.
  1463         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1464         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1465           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1466               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1467         16  CP-R78-OPTION         PIC X.
  1468           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1469           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1470
  1471         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1472         16  CP-IBNR-RESERVE-SW    PIC X.
  1473         16  CP-CLAIM-STATUS       PIC X.
  1474         16  CP-RATE-FILE          PIC X.
  1475         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1476                                     COMP-3.
  1477
  1478         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1479         16  CP-AH-OVERRIDE-CODE   PIC X.
  1480
  1481         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1482                                     COMP-3.
  1483         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1484                                   PIC S9(5)V99 COMP-3.
  1485         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  29
* EL156.cbl
  1486                                     COMP-3.
  1487         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1488                                     COMP-3.
  1489         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1490                                     COMP-3.
  1491         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1492                                  PIC S9(7)V99 COMP-3.
  1493
  1494         16  CP-PAID-FROM-DATE     PIC X(02).
  1495         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1496         16  CP-EXT-DAYS-CALC      PIC X.
  1497           88  CP-EXT-NO-CHG                   VALUE ' '.
  1498           88  CP-EXT-CHG-LF                   VALUE '1'.
  1499           88  CP-EXT-CHG-AH                   VALUE '2'.
  1500           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1501         16  CP-DOMICILE-STATE     PIC XX.
  1502         16  CP-CARRIER            PIC X.
  1503         16  CP-REIN-FLAG          PIC X.
  1504         16  CP-REM-TRM-CALC-OPTION PIC X.
  1505           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1506                      '2' '3' '4' '5'.
  1507           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1508           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1509           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1510           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1511           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1512           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1513           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1514           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1515         16  CP-SIG-SWITCH         PIC X.
  1516         16  CP-RATING-METHOD      PIC X.
  1517           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1518           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1519           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1520           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1521           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1522           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1523           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1524           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1525           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1526         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1527                                     COMP-3.
  1528         16  CP-BEN-CATEGORY       PIC X.
  1529         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1530         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1531                                   PIC S99V9(5) COMP-3.
  1532         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1533         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1534                                   PIC S99V9(5) COMP-3.
  1535         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1536         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1537         16  CP-EXPIRE-DT          PIC XX.
  1538         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1539         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1540         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1541         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1542         16  CP-DDF-SPEC-CALC      PIC X.
  1543             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  30
* EL156.cbl
  1544             88  CP-CALC-CLP              VALUE 'C'.
  1545         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1546         16  CP-CANCEL-REASON      PIC X.
  1547         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1548         16  CP-PMT-MODE           PIC X.
  1549         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1550         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1551         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1552         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1553         16  FILLER                PIC X.
  1554
  1555***************    OUTPUT FROM ELRESV   ************************
  1556
  1557         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1558
  1559         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1560                                     COMP-3.
  1561         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1562                                     COMP-3.
  1563         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1564                                     COMP-3.
  1565         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1566                                     COMP-3.
  1567         16  FILLER                PIC X(09).
  1568***************    OUTPUT FROM ELRTRM   *************************
  1569
  1570         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1571                                     COMP-3.
  1572         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1573                                     COMP-3.
  1574         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1575                                     COMP-3.
  1576         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1577                                     COMP-3.
  1578         16  FILLER                PIC X(12).
  1579
  1580***************    OUTPUT FROM ELRAMT   *************************
  1581
  1582         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1583                                     COMP-3.
  1584         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1585                                     COMP-3.
  1586         16  FILLER                PIC X(12).
  1587
  1588***************    OUTPUT FROM ELRATE   *************************
  1589
  1590         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1591                                     COMP-3.
  1592         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1593                                     COMP-3.
  1594         16  CP-MORTALITY-CODE     PIC X(4).
  1595         16  CP-RATE-EDIT-FLAG     PIC X.
  1596             88  CP-RATES-NEED-APR                  VALUE '1'.
  1597         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1598                                     COMP-3.
  1599         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1600         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1601         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  31
* EL156.cbl
  1602                                   PIC S9(7)V99 COMP-3.
  1603         16  FILLER                PIC X(07).
  1604
  1605***************    OUTPUT FROM ELRFND   *************************
  1606
  1607         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1608                                     COMP-3.
  1609         16  CP-REFUND-TYPE-USED   PIC X.
  1610           88  CP-R-AS-R78                         VALUE '1'.
  1611           88  CP-R-AS-PRORATA                     VALUE '2'.
  1612           88  CP-R-AS-CALIF                       VALUE '3'.
  1613           88  CP-R-AS-TEXAS                       VALUE '4'.
  1614           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1615           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1616           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1617           88  CP-R-AS-MEAN                        VALUE '8'.
  1618           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1619           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1620           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1621           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1622           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1623           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1624         16  FILLER                PIC X(12).
  1625
  1626***************    OUTPUT FROM ELEARN   *************************
  1627
  1628         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1629                                     COMP-3.
  1630         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1631                                     COMP-3.
  1632         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1633                                     COMP-3.
  1634         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1635                                     COMP-3.
  1636         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1637                                     COMP-3.
  1638         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1639                                     COMP-3.
  1640         16  CP-EARNING-TYPE-USED  PIC X.
  1641           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1642           88  CP-E-AS-R78                         VALUE '1'.
  1643           88  CP-E-AS-PRORATA                     VALUE '2'.
  1644           88  CP-E-AS-TEXAS                       VALUE '4'.
  1645           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1646           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1647           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1648           88  CP-E-AS-MEAN                        VALUE '8'.
  1649           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1650         16  FILLER                PIC X(12).
  1651
  1652***************    OUTPUT FROM ELPMNT   *************************
  1653
  1654         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1655                                     COMP-3.
  1656         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1657                                     COMP-3.
  1658         16  FILLER                PIC X(12).
  1659
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  32
* EL156.cbl
  1660***************   MISC WORK AREAS    *****************************
  1661         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1662                                     COMP-3.
  1663         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1664                                     COMP-3.
  1665         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1666                                     COMP-3.
  1667         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1668                                     COMP-3.
  1669         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1670                                     COMP-3.
  1671         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1672                                     COMP-3.
  1673         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1674             88  OPEN-RATE-FILE                   VALUE 'O'.
  1675             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1676             88  IO-ERROR                         VALUE 'E'.
  1677
  1678         16  CP-FIRST-PAY-DATE     PIC XX.
  1679
  1680         16  CP-JOINT-INDICATOR    PIC X.
  1681
  1682         16  CP-RESERVE-REMAINING-TERM
  1683                                   PIC S9(4)V9    VALUE ZERO
  1684                                     COMP-3.
  1685
  1686         16  CP-INSURED-BIRTH-DT   PIC XX.
  1687
  1688         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1689                                     COMP-3.
  1690
  1691         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1692                                     COMP-3.
  1693
  1694         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1695                                     COMP-3.
  1696
  1697         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1698                                     COMP-3.
  1699
  1700         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1701                                     COMP-3.
  1702
  1703         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1704                                     COMP-3.
  1705
  1706         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1707                                     COMP-3.
  1708
  1709         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1710             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1711
  1712         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1713                                     COMP-3.
  1714         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1715                                     COMP-3.
  1716         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1717         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  33
* EL156.cbl
  1718         16  cp-net-only-state     pic x value spaces.
  1719         16  FILLER                PIC X(13).
  1720******************************************************************
  1721*    COPY ELCICALC.
  1722******************************************************************
  1723*                                                                *
  1724*                           ELCCICALC.                           *
  1725*                            VMOD=2.001                          *
  1726*                                                                *
  1727*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1728*                 CALCULATION MODULE                             *
  1729*                                                                *
  1730*  PASSED TO ELCLMI                                              *
  1731*  -----------------                                             *
  1732*  STATE                                                         *
  1733*  PRODUCT                                                       *
  1734*  COVERAGE                                                      *
  1735*  EFFECTIVE DATE                                                *
  1736*  INCURRED DATE                                                 *
  1737*  ESTABLISHED DATE                                              *
  1738*  LAST PAID DATE                                                *
  1739*  REPORTED DATE                                                 *
  1740*  CLAIM PAYMENT AMOUNT                                          *
  1741*                                                                *
  1742*  RETURNED FROM ELRTRM                                          *
  1743*  ---------------------                                         *
  1744*  RETURN CODE                                                   *
  1745*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1746*  CLAIM INTEREST AMOUNT                                         *
  1747*----------------------------------------------------------------*
  1748*----------------------------------------------------------------*
  1749*                 LENGTH = 100                                   *
  1750*                                                                *
  1751******************************************************************
  1752******************************************************************
  1753*                   C H A N G E   L O G
  1754*
  1755* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1756*-----------------------------------------------------------------
  1757*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1758* EFFECTIVE    NUMBER
  1759*-----------------------------------------------------------------
  1760* 120905    2004040700004  PEMA  NEW COPYBOOK
  1761* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1762******************************************************************
  1763
  1764 01  CLAIM-INT-PASS-AREA.
  1765     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1766                                     COMP.
  1767
  1768     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1769       88  NO-CI-ERROR                             VALUE ZERO.
  1770       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1771       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1772       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1773       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1774       88  CP-AMT-LT-5000                          VALUE '4'.
  1775       88  CP-ERROR-IN-DATES                       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  34
* EL156.cbl
  1776       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1777       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1778       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1779***********************  INPUT AREAS ****************************
  1780
  1781     12  CP-CALCULATION-AREA.
  1782         16  CP-COMPANY-CD         PIC X.
  1783         16  CP-STATE              PIC XX.
  1784         16  CP-PRODUCT            PIC XX.
  1785         16  CP-COVERAGE           PIC XX.
  1786         16  CP-INC-DT             PIC XX.
  1787         16  CP-EST-DT             PIC XX.
  1788         16  CP-LSTPD-DT           PIC XX.
  1789         16  CP-RPT-DT             PIC XX.
  1790         16  CP-PRF-DT             PIC XX.
  1791         16  CP-EFF-DT             PIC XX.
  1792         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1793         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1794         16  FILLER                PIC X(37).
  1795
  1796***************    OUTPUT FROM ELCLMI   ************************
  1797
  1798         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1799
  1800         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1801         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1802         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1803         16  FILLER                PIC X(19).
  1804******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  35
* EL156.cbl
  1806*    COPY ELCATTR.
  1807******************************************************************
  1808*                                                                *
  1809*                            ELCATTR.                            *
  1810*                            VMOD=2.001                          *
  1811*                                                                *
  1812*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1813*                                                                *
  1814*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1815*                                                                *
  1816*                   POS 1   P=PROTECTED                          *
  1817*                           U=UNPROTECTED                        *
  1818*                           S=ASKIP                              *
  1819*                   POS 2   A=ALPHA/NUMERIC                      *
  1820*                           N=NUMERIC                            *
  1821*                   POS 3   N=NORMAL                             *
  1822*                           B=BRIGHT                             *
  1823*                           D=DARK                               *
  1824*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1825*                           OF=MODIFIED DATA TAG OFF             *
  1826*                                                                *
  1827*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1828******************************************************************
  1829 01  ATTRIBUTE-LIST.
  1830     12  AL-PABOF            PIC X       VALUE 'Y'.
  1831     12  AL-PABON            PIC X       VALUE 'Z'.
  1832     12  AL-PADOF            PIC X       VALUE '%'.
  1833     12  AL-PADON            PIC X       VALUE '_'.
  1834     12  AL-PANOF            PIC X       VALUE '-'.
  1835     12  AL-PANON            PIC X       VALUE '/'.
  1836     12  AL-SABOF            PIC X       VALUE '8'.
  1837     12  AL-SABON            PIC X       VALUE '9'.
  1838     12  AL-SADOF            PIC X       VALUE '@'.
  1839     12  AL-SADON            PIC X       VALUE QUOTE.
  1840     12  AL-SANOF            PIC X       VALUE '0'.
  1841     12  AL-SANON            PIC X       VALUE '1'.
  1842     12  AL-UABOF            PIC X       VALUE 'H'.
  1843     12  AL-UABON            PIC X       VALUE 'I'.
  1844     12  AL-UADOF            PIC X       VALUE '<'.
  1845     12  AL-UADON            PIC X       VALUE '('.
  1846     12  AL-UANOF            PIC X       VALUE ' '.
  1847     12  AL-UANON            PIC X       VALUE 'A'.
  1848     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1849     12  AL-UNBON            PIC X       VALUE 'R'.
  1850     12  AL-UNDOF            PIC X       VALUE '*'.
  1851     12  AL-UNDON            PIC X       VALUE ')'.
  1852     12  AL-UNNOF            PIC X       VALUE '&'.
  1853     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  36
* EL156.cbl
  1855*    COPY ELCEMIB.
  1856******************************************************************
  1857*                                                                *
  1858*                                                                *
  1859*                            ELCEMIB.                            *
  1860*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1861*                            VMOD=2.005                          *
  1862*                                                                *
  1863*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1864*                                                                *
  1865******************************************************************
  1866 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1867     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1868     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1869     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1870     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1871     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1872     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1873     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1874     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1875     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1876         88  EMI-NO-ERRORS                    VALUE '1'.
  1877         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1878         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1879     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1880         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1881     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1882         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1883         88  EMI-AREA1-FULL                   VALUE '2'.
  1884     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1885         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1886         88  EMI-AREA2-FULL                   VALUE '2'.
  1887     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1888         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1889         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1890         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1891         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1892         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1893     12  EMI-ERROR-LINES.
  1894         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1895         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1896         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1897         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1898             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1899                 24  EMI-ERR-NUM         PIC X(4).
  1900                 24  EMI-FILLER          PIC X.
  1901                 24  EMI-SEV             PIC X.
  1902                 24  FILLER              PIC X.
  1903             20  FILLER                  PIC X(02).
  1904     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1905         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1906             20  EMI-ERROR-NUMBER    PIC X(4).
  1907             20  EMI-FILL            PIC X.
  1908             20  EMI-SEVERITY        PIC X.
  1909             20  FILLER              PIC X.
  1910             20  EMI-ERROR-TEXT.
  1911                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1912                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  37
* EL156.cbl
  1913     12  EMI-SEVERITY-SAVE           PIC X.
  1914         88  EMI-NOTE                    VALUE 'N'.
  1915         88  EMI-WARNING                 VALUE 'W'.
  1916         88  EMI-FORCABLE                VALUE 'F'.
  1917         88  EMI-FATAL                   VALUE 'X'.
  1918     12  EMI-MESSAGE-FLAG            PIC X.
  1919         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1920         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1921     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1922     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1923         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1924         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1925         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1926     12  emi-claim-no                pic x(7).
  1927     12  emi-claim-type              pic x(6).
  1928     12  FILLER                      PIC X(124)  VALUE SPACES.
  1929     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1930     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1931     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1932     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  38
* EL156.cbl
  1934*    COPY ELCLNKLT.
  1935******************************************************************
  1936*                                                                *
  1937*                                                                *
  1938*                           ELCLNKLT                             *
  1939*                            VMOD=2.003                          *
  1940*                                                                *
  1941*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1942*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1943*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1944*                                                                *
  1945*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1946*   COMPLETING THE REQUIRED FIELDS.                              *
  1947*                                                                *
  1948*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1949*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1950*                              9999 INDICATES AN UNKNOWN ABEND   *
  1951*                                   WAS DETECTED.                *
  1952*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1953*                              CODES FOUND IN THE ERROR FILE.    *
  1954******************************************************************
  1955 01  W-1523-LINKDATA.
  1956     12  W-1523-COMMON-PI-DATA.
  1957         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1958         16  FILLER              PIC  X(67).
  1959         16  W-1523-COMPANY-CD   PIC  X(01).
  1960         16  FILLER              PIC  X(10).
  1961         16  W-1523-CONTROL-IN-PROGRESS.
  1962             20  W-1523-CARRIER  PIC  X(01).
  1963             20  W-1523-GROUPING PIC  X(06).
  1964             20  W-1523-STATE    PIC  X(02).
  1965             20  W-1523-ACCOUNT  PIC  X(10).
  1966             20  W-1523-CLAIM-CERT-GRP.
  1967                 24  W-1523-CLAIM-NO
  1968                                 PIC  X(07).
  1969                 24  W-1523-CERT-NO.
  1970                     28  W-1523-CERT-PRIME
  1971                                 PIC  X(10).
  1972                     28  W-1523-CERT-SFX
  1973                                 PIC  X(01).
  1974                 24  W-1523-CERT-EFF-DT
  1975                                 PIC  X(02).
  1976         16  FILLER              PIC X(265).
  1977
  1978     12  W-1523-WORK-AREA.
  1979         16  W-1523-FORM-NUMBER  PIC  X(04).
  1980         16  W-1523-NUMBER-COPIES
  1981                                 PIC  9(01).
  1982         16  W-1523-ADDR-TYPE    PIC  X(02).
  1983         16  W-1523-FOLLOW-UP-DATE
  1984                                 PIC  X(02).
  1985         16  W-1523-RESEND-DATE  PIC  X(02).
  1986         16  W-1523-ERROR-CODE   PIC  9(04).
  1987             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1988             88  W-1523-FATAL-ERROR
  1989                                    VALUES  0006 0013 0042
  1990                                            0154 0168 0169
  1991                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  39
* EL156.cbl
  1992                                            0179 0186 0281
  1993                                            0332 2055 3697
  1994                                            3698 3699 3770
  1995                                            3771 3772 7675
  1996                                            9106 9808 9883
  1997                                            9887.
  1998             88  W-1523-STOP-ERRORS
  1999                                    VALUES  0013 0042 0154
  2000                                            0168 0169 0172
  2001                                            0281 0332 2055
  2002                                            3698 3699 7675
  2003                                            9106 9808 9883
  2004                                            9999.
  2005         16  W-1523-REASON       PIC  X(70).
  2006         16  W-1523-ARCHIVE-NUMBER
  2007                                 PIC  9(08).
  2008     12  W-1523-POINTER-AREA.
  2009         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2010         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2011         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2012         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2013         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  40
* EL156.cbl
  2015*    COPY ELCNWA.
  2016*****************************************************************
  2017*                                                               *
  2018*                                                               *
  2019*                            ELCNWA.                            *
  2020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2021*                            VMOD=2.003                         *
  2022*                                                               *
  2023*            M O V E   N A M E   W O R K   A R E A.             *
  2024*                                                               *
  2025*****************************************************************.
  2026
  2027 01  WS-NAME-WORK-AREA.
  2028     05  WS-INSURED-LAST-NAME        PIC X(15).
  2029     05  WS-INSURED-1ST-NAME         PIC X(12).
  2030     05  WS-INSURED-MID-INIT         PIC X.
  2031
  2032     05  WS-NAME-WORK.
  2033         10  WS-NW                   PIC X
  2034             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2035
  2036     05  WS-NAME-WORK2.
  2037         10  WS-NW2                  PIC X
  2038             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2039                                        NWA-INDEX0.
  2040
  2041     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2042                                     COMP-3.
  2043
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  41
* EL156.cbl
  2045*    COPY ELCDMO.
  2046******************************************************************
  2047*                                                                *
  2048*                                                                *
  2049*                            ELCDMO.                             *
  2050*                            VMOD=2.004                          *
  2051*                                                                *
  2052*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2053*        COMMUNICATION AREA                                      *
  2054*   FILE TYPE = NA                                               *
  2055*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2056*                                                                *
  2057******************************************************************
  2058 01  DMO-COMMUNICATION-AREA.
  2059     12  DM-RECORD-TYPE                  PIC  X(02).
  2060             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2061             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2062             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2063     12  DM-DIST-CODE                    PIC  X(04).
  2064     12  DM-MAIL-CODE                    PIC  X(05).
  2065     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2066     12  DM-INSURED-NAME                 PIC  X(30).
  2067     12  DM-CLAIM-NO                     PIC  X(07).
  2068     12  DM-CLAIM-TYPE                   PIC  X.
  2069
  2070     12  DM-STATUS-DATA-AREA.
  2071         16  DM-CLAIM-STATUS             PIC  X.
  2072             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2073             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2074             88  DM-CLOSED                        VALUE '3'.
  2075             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2076             88  DM-DEFAULT                       VALUE '9'.
  2077         16  DM-STATUS-DATE              PIC  X(08).
  2078******YYYYMMDD
  2079         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2080             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2081             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2082             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2083             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2084             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2085             88  DM-RE-OPENED                     VALUE 'R'.
  2086             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2087             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2088             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2089         16  DM-STAT-CARRIER             PIC X.
  2090
  2091     12  DM-DRAFT-DATA-AREA.
  2092         16  DM-PAYMENT-TYPE             PIC  X.
  2093             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2094         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2095         16  DM-PAYMENT-DATE             PIC  X(08).
  2096******YYYYMMDD
  2097         16  DM-CERT-NO                  PIC  X(11).
  2098         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2099         16  DM-CARRIER                  PIC  X.
  2100
  2101     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  42
* EL156.cbl
  2103*    COPY ELCDMDCD.
  2104******************************************************************
  2105*                                                                *
  2106*                                                                *
  2107*                            ELCDMDCD.                           *
  2108*                            VMOD=2.001                          *
  2109*                                                                *
  2110*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2111*       COMMUNICATIONS AREA                                      *
  2112*                                                                *
  2113******************************************************************
  2114 01  CD-COMMUNICATION-AREA.
  2115     12  CD-SYSTEM-ID            PIC  X(02).
  2116         88 CD-CLAIMS                      VALUE 'CL'.
  2117         88 CD-CREDIT                      VALUE 'CR'.
  2118     12  CD-RECORD-TYPE          PIC  X(02).
  2119         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2120         88 CD-EOB-CODE                    VALUE 'EO'.
  2121         88 CD-ICD9-CODE                   VALUE 'I9'.
  2122         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2123         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2124         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2125         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2126         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2127     12  CD-RECORD-KEY           PIC  X(06).
  2128         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2129     12  CD-RETURN-CODE          PIC  X(02).
  2130     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2131     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2132     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2133     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  43
* EL156.cbl
  2135*    COPY ELCDCTB.
  2136******************************************************************
  2137*                                                                *
  2138*                                                                *
  2139*                            ELCDCTB.                            *
  2140*                            VMOD=2.002                          *
  2141*                                                                *
  2142*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2143*       COMMUNICATIONS AREA                                      *
  2144*                                                                *
  2145******************************************************************
  2146 01  DCT-COMMUNICATION-AREA.
  2147     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2148     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2149     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2150     12  DCT-PRODUCT-CODE         PIC  X(02).
  2151     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2152     12  DCT-RETURN-CODE          PIC  X(02).
  2153     12  DCT-MAIL-CODE            PIC  X(05).
  2154     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2155     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  44
* EL156.cbl
  2157 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2158 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2159 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2160 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  45
* EL156.cbl
  2162*    COPY ELCINTF.
  2163******************************************************************
  2164*                                                                *
  2165*                                                                *
  2166*                            ELCINTF.                            *
  2167*                            VMOD=2.017                          *
  2168*                                                                *
  2169*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2170*                                                                *
  2171*       LENGTH = 1024                                            *
  2172*                                                                *
  2173******************************************************************
  2174*                   C H A N G E   L O G
  2175*
  2176* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2177*-----------------------------------------------------------------
  2178*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2179* EFFECTIVE    NUMBER
  2180*-----------------------------------------------------------------
  2181* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2182******************************************************************
  2183 01  PROGRAM-INTERFACE-BLOCK.
  2184     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2185     12  PI-CALLING-PROGRAM              PIC X(8).
  2186     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2187     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2188     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2189     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2190     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2191     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2192     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2193     12  PI-COMPANY-ID                   PIC XXX.
  2194     12  PI-COMPANY-CD                   PIC X.
  2195
  2196     12  PI-COMPANY-PASSWORD             PIC X(8).
  2197
  2198     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2199
  2200     12  PI-CONTROL-IN-PROGRESS.
  2201         16  PI-CARRIER                  PIC X.
  2202         16  PI-GROUPING                 PIC X(6).
  2203         16  PI-STATE                    PIC XX.
  2204         16  PI-ACCOUNT                  PIC X(10).
  2205         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2206                                         PIC X(10).
  2207         16  PI-CLAIM-CERT-GRP.
  2208             20  PI-CLAIM-NO             PIC X(7).
  2209             20  PI-CERT-NO.
  2210                 25  PI-CERT-PRIME       PIC X(10).
  2211                 25  PI-CERT-SFX         PIC X.
  2212             20  PI-CERT-EFF-DT          PIC XX.
  2213         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2214             20  PI-PLAN-CODE            PIC X(2).
  2215             20  PI-REVISION-NUMBER      PIC X(3).
  2216             20  PI-PLAN-EFF-DT          PIC X(2).
  2217             20  PI-PLAN-EXP-DT          PIC X(2).
  2218             20  FILLER                  PIC X(11).
  2219         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  46
* EL156.cbl
  2220             20  PI-OE-REFERENCE-1.
  2221                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2222                 25  PI-OE-REF-1-SUFF    PIC XX.
  2223
  2224     12  PI-SESSION-IN-PROGRESS          PIC X.
  2225         88  CLAIM-SESSION                   VALUE '1'.
  2226         88  CREDIT-SESSION                  VALUE '2'.
  2227         88  WARRANTY-SESSION                VALUE '3'.
  2228         88  MORTGAGE-SESSION                VALUE '4'.
  2229         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2230
  2231
  2232*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2233
  2234     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2235     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2236
  2237     12  PI-CREDIT-USER                  PIC X.
  2238         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2239         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2240
  2241     12  PI-CLAIM-USER                   PIC X.
  2242         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2243         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2244
  2245     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2246         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2247         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2248         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2249         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2250         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2251
  2252     12  PI-PROCESSOR-ID                 PIC X(4).
  2253
  2254     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2255
  2256     12  PI-MEMBER-CAPTION               PIC X(10).
  2257
  2258     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2259         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2260
  2261     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2262     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2263     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2264     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2265
  2266     12  PI-AH-OVERRIDE-L1               PIC X.
  2267     12  PI-AH-OVERRIDE-L2               PIC XX.
  2268     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2269     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2270
  2271     12  PI-NEW-SYSTEM                   PIC X(2).
  2272
  2273     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2274     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2275         88  PI-USES-PAID-TO                 VALUE '1'.
  2276     12  PI-CRDTCRD-SYSTEM.
  2277         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  47
* EL156.cbl
  2278             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2279             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2280         16  PI-CC-MONTH-END-DT          PIC XX.
  2281     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2282
  2283     12  PI-OE-REFERENCE-2.
  2284         16  PI-OE-REF-2-PRIME           PIC X(10).
  2285         16  PI-OE-REF-2-SUFF            PIC X.
  2286
  2287     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2288
  2289     12  PI-LANGUAGE-TYPE                PIC X.
  2290             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2291             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2292             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2293
  2294     12  PI-POLICY-LINKAGE-IND           PIC X.
  2295         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2296         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2297                                                   LOW-VALUES.
  2298
  2299     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2300     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2301         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2302         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2303
  2304     12  PI-PROCESSOR-CSR-IND            PIC X.
  2305         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2306         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2307
  2308     12  FILLER                          PIC X(3).
  2309
  2310     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2311
  2312     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2313         PI-SYSTEM-LEVEL.
  2314
  2315         16  PI-ENTRY-CODES.
  2316             20  PI-ENTRY-CD-1           PIC X.
  2317             20  PI-ENTRY-CD-2           PIC X.
  2318
  2319         16  PI-RETURN-CODES.
  2320             20  PI-RETURN-CD-1          PIC X.
  2321             20  PI-RETURN-CD-2          PIC X.
  2322
  2323         16  PI-UPDATE-STATUS-SAVE.
  2324             20  PI-UPDATE-BY            PIC X(4).
  2325             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2326
  2327         16  PI-LOWER-CASE-LETTERS       PIC X.
  2328             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2329
  2330*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2331*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2332*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2333
  2334         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2335             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  48
* EL156.cbl
  2336             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2337             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2338             88  ACCNT-CNTL                  VALUE '3'.
  2339             88  CARR-ACCNT-CNTL             VALUE '4'.
  2340
  2341         16  PI-PROCESSOR-CAP-LIST.
  2342             20  PI-SYSTEM-CONTROLS.
  2343                24 PI-SYSTEM-DISPLAY     PIC X.
  2344                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2345                24 PI-SYSTEM-MODIFY      PIC X.
  2346                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2347             20  FILLER                  PIC XX.
  2348             20  PI-DISPLAY-CAP          PIC X.
  2349                 88  DISPLAY-CAP             VALUE 'Y'.
  2350             20  PI-MODIFY-CAP           PIC X.
  2351                 88  MODIFY-CAP              VALUE 'Y'.
  2352             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2353                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2354             20  PI-FORCE-CAP            PIC X.
  2355                 88  FORCE-CAP               VALUE 'Y'.
  2356
  2357         16  PI-PROGRAM-CONTROLS.
  2358             20  PI-PGM-PRINT-OPT        PIC X.
  2359             20  PI-PGM-FORMAT-OPT       PIC X.
  2360             20  PI-PGM-PROCESS-OPT      PIC X.
  2361             20  PI-PGM-TOTALS-OPT       PIC X.
  2362
  2363         16  PI-HELP-INTERFACE.
  2364             20  PI-LAST-ERROR-NO        PIC X(4).
  2365             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2366
  2367         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2368             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2369
  2370         16  PI-CR-CONTROL-IN-PROGRESS.
  2371             20  PI-CR-CARRIER           PIC X.
  2372             20  PI-CR-GROUPING          PIC X(6).
  2373             20  PI-CR-STATE             PIC XX.
  2374             20  PI-CR-ACCOUNT           PIC X(10).
  2375             20  PI-CR-FIN-RESP          PIC X(10).
  2376             20  PI-CR-TYPE              PIC X.
  2377
  2378         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2379
  2380         16  PI-CR-MONTH-END-DT          PIC XX.
  2381
  2382         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2383             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2384             88  PI-ZERO-CARRIER             VALUE '1'.
  2385             88  PI-ZERO-GROUPING            VALUE '2'.
  2386             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2387
  2388         16  PI-CARRIER-SECURITY         PIC X.
  2389             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2390
  2391         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2392             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2393             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  49
* EL156.cbl
  2394
  2395         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2396             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2397                                         INDEXED BY PI-ACCESS-NDX
  2398                                         PIC X.
  2399
  2400         16  PI-GA-BILLING-CONTROL       PIC X.
  2401             88  PI-GA-BILLING               VALUE '1'.
  2402
  2403         16  PI-MAIL-PROCESSING          PIC X.
  2404             88  PI-MAIL-YES                 VALUE 'Y'.
  2405
  2406         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2407
  2408         16  PI-AR-SYSTEM.
  2409             20  PI-AR-PROCESSING-CNTL   PIC X.
  2410                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2411             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2412             20  PI-AR-MONTH-END-DT      PIC XX.
  2413
  2414         16  PI-MP-SYSTEM.
  2415             20  PI-MORTGAGE-USER            PIC X.
  2416                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2417                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2418             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2419                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2420                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2421                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2422                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2423                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2424             20  PI-MP-MONTH-END-DT          PIC XX.
  2425             20  PI-MP-REFERENCE-NO.
  2426                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2427                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2428
  2429         16  PI-LABEL-CONTROL            PIC X(01).
  2430             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2431             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2432
  2433         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2434             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2435
  2436         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2437             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2438             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2439
  2440         16  FILLER                      PIC X(14).
  2441
  2442     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2443******************************************************************
  2444     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2445         16  PI-SAVE-FORM        PIC X(12).
  2446         16  PI-ACCT-KEY         PIC X(26).
  2447         16  PI-PAYEE-NAME       PIC X(30).
  2448         16  PI-DAILY-RATE       PIC S9(3)V99.
  2449         16  PI-MONTH-END-SAVE   PIC XX.
  2450         16  PI-BENEFIT-SAVE.
  2451             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  50
* EL156.cbl
  2452             20  PI-BEN-TYPE     PIC X.
  2453         16  PI-MANUAL-SW        PIC 9.
  2454         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2455         16  PI-PASS-SW          PIC X.
  2456         16  PI-PFKEY-USED       PIC X.
  2457         16  PI-CK-ASSIGN        PIC X.
  2458         16  PI-FATAL-COUNT      PIC 99.
  2459         16  PI-FORCE-COUNT      PIC 99.
  2460         16  PI-SAVE-INPUT.
  2461             20  PI-PMTTYPE      PIC X.
  2462             20  PI-PAYEE.
  2463                 24  PI-PAYEE-TYPE PIC X.
  2464                 24  PI-PAYEE-SEQ  PIC X.
  2465                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2466                   PI-PAYEE-SEQ    PIC S9.
  2467             20  PI-PMTNOTE1     PIC X(60).
  2468             20  PI-PMTNOTE2     PIC X(60).
  2469             20  PI-OFFLINE      PIC X.
  2470             20  PI-ECHECKNO     PIC X(7).
  2471             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2472                 28  PI-ECHECKNO-N     PIC X.
  2473                 28  PI-ECHECKNO-6     PIC X(6).
  2474             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2475                 24  PI-ECHECKNO-CR    PIC XX.
  2476                 24  PI-ECHECKNO-5     PIC X(5).
  2477             20  PI-HOLDTIL      PIC 9(6).
  2478             20  PI-EPYFROM      PIC 9(6).
  2479             20  PI-EPYTHRU      PIC 9(6).
  2480             20  PI-EDAYS        PIC S9(5).
  2481             20  PI-EPYAMT       PIC S9(7)V99.
  2482             20  PI-ERESV        PIC S9(7)V99.
  2483             20  PI-EEXPENS      PIC 9(6)V99.
  2484             20  PI-ETYPE        PIC X.
  2485             20  PI-CASH         PIC X.
  2486             20  PI-GROUPED      PIC X.
  2487             20  PI-INT-RATE     PIC S99V9(5).
  2488             20  PI-AIGFROM      PIC 9(6).
  2489             20  PI-LOAN-NO      PIC X(20).
  2490             20  PI-PROOF-DATE   PIC 9(6).
  2491             20  PI-PRINT-EOB-YN PIC X.
  2492             20  PI-PRINT-CLM-FRM-YN PIC X.
  2493             20  PI-PRINT-SURVEY-YN PIC X.
  2494             20  PI-SPECIAL-RELEASE-YN PIC X.
  2495             20  pi-int-to-rem-borr pic x.
  2496         16  PI-SAVE-COMPUTED.
  2497             20  PI-CCHECKNO     PIC X(7).
  2498             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2499                 28  PI-CCHECKNO-N     PIC X.
  2500                 28  PI-CCHECKNO-6     PIC X(6).
  2501             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2502                 24  PI-CCHECKNO-CR    PIC XX.
  2503                 24  PI-CCHECKNO-5     PIC X(5).
  2504             20  PI-CPYFROM      PIC XX.
  2505             20  PI-CPYTHRU      PIC XX.
  2506             20  PI-CDAYS        PIC S9(5).
  2507             20  PI-CPYAMT       PIC S9(7)V99.
  2508             20  PI-CRESV        PIC 9(6)V99.
  2509             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  51
* EL156.cbl
  2510             20  PI-PMT-APPR-SW  PIC X.
  2511                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2512                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2513                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2514         16  PI-PREV-CLMNO       PIC X(7).
  2515         16  PI-LF-COVERAGE-TYPE PIC X.
  2516         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2517         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2518         16  PI-PROVISIONAL-IND  PIC X.
  2519             88 PI-PROV-PMT      VALUE 'P'.
  2520         16  PI-PREV-TRLR-KEY    PIC X(22).
  2521         16  PI-SPLIT-PMT-SW     PIC X.
  2522         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2523         16  PI-ACTIVITY-CODE    PIC 99.
  2524         16  PI-RESET-SW         PIC X.
  2525         16  PI-SPECIAL-BEN-SW   PIC X.
  2526             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2527         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2528         16  PI-EXP-DT           PIC XX.
  2529         16  PI-LOAN-DUE-DAY     PIC 99.
  2530         16  PI-3RD-PARTY-SW     PIC X.
  2531         16  PI-LOAN-UPDATE-SW   PIC X.
  2532
  2533         16  PI-DMD-DATA.
  2534             20  PI-SV-CERT-KEY       PIC X(21).
  2535             20  PI-SV-CERT-NO        PIC X(11).
  2536             20  PI-SV-BEN            PIC X(10).
  2537             20  PI-SV-CCN            PIC X(16).
  2538             20  PI-INTEREST-PAID-IND PIC X.
  2539                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2540             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2541             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2542             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2543             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2544         16  PI-AT-EOB-CODES.
  2545             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2546         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2547         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2548         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2549         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2550         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2551         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2552         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2553         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2554         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2555         16  PI-LF-BENEFIT-CD         PIC X(2).
  2556         16  PI-EOB-CODES-EXIST PIC X.
  2557         16  PI-SET-NOTE2-MDT   PIC X.
  2558         16  PI-VFY-2ND-BENE          PIC X.
  2559         16  PI-CLM-TYPE              PIC X.
  2560         16  PI-APPROVAL-LEVEL        PIC X.
  2561         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2562         16  PI-REAUDIT-NEEDED        PIC X.
  2563         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2564         16  PI-AH-BENEFIT-CD         PIC XX.
  2565         16  pi-ah-term               pic s999 comp-3.
  2566         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2567         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  52
* EL156.cbl
  2568         16  pi-max-ext-used          pic x.
  2569         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2570         16  PI-JOINT-COV-IND         PIC X.
  2571             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2572             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2573         16  PI-JOINT-INSURED-IND     PIC X.
  2574             88  PI-JOINT-INSURED        VALUE 'Y'.
  2575             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2576         16  pi-int-payees-name       pic x(20).
  2577         16  PI-RB-JOINT-COV-IND      PIC X.
  2578             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2579             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2580*00781          16  FILLER                   PIC X(176).
  2581*052506         16  FILLER                   PIC X(161).
  2582*031808         16  FILLER                   PIC X(154).
  2583*091808         16  FILLER                   PIC X(152).
  2584*041710         16  FILLER                   PIC X(94).
  2585         16  FILLER                   PIC X(45).
  2586
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  53
* EL156.cbl
  2588*    COPY ELCJPFX.
  2589******************************************************************
  2590*                                                                *
  2591*                                                                *
  2592*                            ELCJPFX.                            *
  2593*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2594*                            VMOD=2.002                          *
  2595*                                                                *
  2596*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2597*                                                                *
  2598*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2599*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2600*        ELCNTL - CONTROL FILE                                   *
  2601*        ELMSTR - CLAIM MASTERS                                  *
  2602*        ELTRLR - ACTIVITY TRAILERS                              *
  2603*        ELCHKQ - CHECK QUE                                      *
  2604******************************************************************
  2605 01  JOURNAL-RECORD.
  2606     12  jp-date                     pic s9(5) comp-3.
  2607     12  jp-time                     pic s9(7) comp-3.
  2608     12  JP-USER-ID                  PIC X(4).
  2609     12  JP-FILE-ID                  PIC X(8).
  2610     12  JP-PROGRAM-ID               PIC X(8).
  2611     12  JP-RECORD-TYPE              PIC X.
  2612         88 JP-ADD              VALUE 'A'.
  2613         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2614         88 JP-AFTER-CHANGE     VALUE 'C'.
  2615         88 JP-DELETE           VALUE 'D'.
  2616         88 JP-GENERIC-DELETE   VALUE 'G'.
  2617         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2618         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2619     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2620     12  JP-RECORD-AREA
  2621
  2622
  2623                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  54
* EL156.cbl
  2625*    COPY ELCAID.
  2626******************************************************************
  2627*                                                                *
  2628*                            ELCAID.                             *
  2629*                            VMOD=2.001                          *
  2630*                                                                *
  2631*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2632*                                                                *
  2633*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2634*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2635******************************************************************
  2636
  2637 01  DFHAID.
  2638   02  DFHNULL   PIC  X  VALUE  ' '.
  2639   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2640   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2641   02  DFHPEN    PIC  X  VALUE  '='.
  2642   02  DFHOPID   PIC  X  VALUE  'W'.
  2643   02  DFHPA1    PIC  X  VALUE  '%'.
  2644   02  DFHPA2    PIC  X  VALUE  '>'.
  2645   02  DFHPA3    PIC  X  VALUE  ','.
  2646   02  DFHPF1    PIC  X  VALUE  '1'.
  2647   02  DFHPF2    PIC  X  VALUE  '2'.
  2648   02  DFHPF3    PIC  X  VALUE  '3'.
  2649   02  DFHPF4    PIC  X  VALUE  '4'.
  2650   02  DFHPF5    PIC  X  VALUE  '5'.
  2651   02  DFHPF6    PIC  X  VALUE  '6'.
  2652   02  DFHPF7    PIC  X  VALUE  '7'.
  2653   02  DFHPF8    PIC  X  VALUE  '8'.
  2654   02  DFHPF9    PIC  X  VALUE  '9'.
  2655   02  DFHPF10   PIC  X  VALUE  ':'.
  2656   02  DFHPF11   PIC  X  VALUE  '#'.
  2657   02  DFHPF12   PIC  X  VALUE  '@'.
  2658   02  DFHPF13   PIC  X  VALUE  'A'.
  2659   02  DFHPF14   PIC  X  VALUE  'B'.
  2660   02  DFHPF15   PIC  X  VALUE  'C'.
  2661   02  DFHPF16   PIC  X  VALUE  'D'.
  2662   02  DFHPF17   PIC  X  VALUE  'E'.
  2663   02  DFHPF18   PIC  X  VALUE  'F'.
  2664   02  DFHPF19   PIC  X  VALUE  'G'.
  2665   02  DFHPF20   PIC  X  VALUE  'H'.
  2666   02  DFHPF21   PIC  X  VALUE  'I'.
  2667*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2668   02  DFHPF22   PIC  X  VALUE  '['.
  2669   02  DFHPF23   PIC  X  VALUE  '.'.
  2670   02  DFHPF24   PIC  X  VALUE  '<'.
  2671   02  DFHMSRE   PIC  X  VALUE  'X'.
  2672   02  DFHSTRF   PIC  X  VALUE  'h'.
  2673   02  DFHTRIG   PIC  X  VALUE  '"'.
  2674 01  FILLER    REDEFINES DFHAID.
  2675     12  FILLER              PIC X(8).
  2676     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  55
* EL156.cbl
  2678*    COPY EL156S.
  2679 01  EL156AI.
  2680     05  FILLER            PIC  X(0012).
  2681*    -------------------------------
  2682     05  RUNDTEAL PIC S9(0004) COMP.
  2683     05  RUNDTEAF PIC  X(0001).
  2684     05  FILLER REDEFINES RUNDTEAF.
  2685         10  RUNDTEAA PIC  X(0001).
  2686     05  RUNDTEAI PIC  X(0008).
  2687*    -------------------------------
  2688     05  RUNTIMAL PIC S9(0004) COMP.
  2689     05  RUNTIMAF PIC  X(0001).
  2690     05  FILLER REDEFINES RUNTIMAF.
  2691         10  RUNTIMAA PIC  X(0001).
  2692     05  RUNTIMAI PIC  X(0005).
  2693*    -------------------------------
  2694     05  SEQUL PIC S9(0004) COMP.
  2695     05  SEQUF PIC  X(0001).
  2696     05  FILLER REDEFINES SEQUF.
  2697         10  SEQUA PIC  X(0001).
  2698     05  SEQUI PIC  X(0010).
  2699*    -------------------------------
  2700     05  CLMNOL PIC S9(0004) COMP.
  2701     05  CLMNOF PIC  X(0001).
  2702     05  FILLER REDEFINES CLMNOF.
  2703         10  CLMNOA PIC  X(0001).
  2704     05  CLMNOI PIC  X(0007).
  2705*    -------------------------------
  2706     05  CARRL PIC S9(0004) COMP.
  2707     05  CARRF PIC  X(0001).
  2708     05  FILLER REDEFINES CARRF.
  2709         10  CARRA PIC  X(0001).
  2710     05  CARRI PIC  X(0001).
  2711*    -------------------------------
  2712     05  CERTNOL PIC S9(0004) COMP.
  2713     05  CERTNOF PIC  X(0001).
  2714     05  FILLER REDEFINES CERTNOF.
  2715         10  CERTNOA PIC  X(0001).
  2716     05  CERTNOI PIC  X(0010).
  2717*    -------------------------------
  2718     05  SUFXL PIC S9(0004) COMP.
  2719     05  SUFXF PIC  X(0001).
  2720     05  FILLER REDEFINES SUFXF.
  2721         10  SUFXA PIC  X(0001).
  2722     05  SUFXI PIC  X(0001).
  2723*    -------------------------------
  2724     05  CLMTYPL PIC S9(0004) COMP.
  2725     05  CLMTYPF PIC  X(0001).
  2726     05  FILLER REDEFINES CLMTYPF.
  2727         10  CLMTYPA PIC  X(0001).
  2728     05  CLMTYPI PIC  X(0006).
  2729*    -------------------------------
  2730     05  CLMSTATL PIC S9(0004) COMP.
  2731     05  CLMSTATF PIC  X(0001).
  2732     05  FILLER REDEFINES CLMSTATF.
  2733         10  CLMSTATA PIC  X(0001).
  2734     05  CLMSTATI PIC  X(0006).
  2735*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  56
* EL156.cbl
  2736     05  LSTNMEL PIC S9(0004) COMP.
  2737     05  LSTNMEF PIC  X(0001).
  2738     05  FILLER REDEFINES LSTNMEF.
  2739         10  LSTNMEA PIC  X(0001).
  2740     05  LSTNMEI PIC  X(0015).
  2741*    -------------------------------
  2742     05  FSTNMEL PIC S9(0004) COMP.
  2743     05  FSTNMEF PIC  X(0001).
  2744     05  FILLER REDEFINES FSTNMEF.
  2745         10  FSTNMEA PIC  X(0001).
  2746     05  FSTNMEI PIC  X(0012).
  2747*    -------------------------------
  2748     05  MINITL PIC S9(0004) COMP.
  2749     05  MINITF PIC  X(0001).
  2750     05  FILLER REDEFINES MINITF.
  2751         10  MINITA PIC  X(0001).
  2752     05  MINITI PIC  X(0001).
  2753*    -------------------------------
  2754     05  PRIMHDGL PIC S9(0004) COMP.
  2755     05  PRIMHDGF PIC  X(0001).
  2756     05  FILLER REDEFINES PRIMHDGF.
  2757         10  PRIMHDGA PIC  X(0001).
  2758     05  PRIMHDGI PIC  X(0012).
  2759*    -------------------------------
  2760     05  PCERTNOL PIC S9(0004) COMP.
  2761     05  PCERTNOF PIC  X(0001).
  2762     05  FILLER REDEFINES PCERTNOF.
  2763         10  PCERTNOA PIC  X(0001).
  2764     05  PCERTNOI PIC  X(0010).
  2765*    -------------------------------
  2766     05  PSUFXL PIC S9(0004) COMP.
  2767     05  PSUFXF PIC  X(0001).
  2768     05  FILLER REDEFINES PSUFXF.
  2769         10  PSUFXA PIC  X(0001).
  2770     05  PSUFXI PIC  X(0001).
  2771*    -------------------------------
  2772     05  STATUSL PIC S9(0004) COMP.
  2773     05  STATUSF PIC  X(0001).
  2774     05  FILLER REDEFINES STATUSF.
  2775         10  STATUSA PIC  X(0001).
  2776     05  STATUSI PIC  X(0010).
  2777*    -------------------------------
  2778     05  LOANHL PIC S9(0004) COMP.
  2779     05  LOANHF PIC  X(0001).
  2780     05  FILLER REDEFINES LOANHF.
  2781         10  LOANHA PIC  X(0001).
  2782     05  LOANHI PIC  X(0014).
  2783*    -------------------------------
  2784     05  LOANNOL PIC S9(0004) COMP.
  2785     05  LOANNOF PIC  X(0001).
  2786     05  FILLER REDEFINES LOANNOF.
  2787         10  LOANNOA PIC  X(0001).
  2788     05  LOANNOI PIC  X(0025).
  2789*    -------------------------------
  2790     05  DUEDAYHL PIC S9(0004) COMP.
  2791     05  DUEDAYHF PIC  X(0001).
  2792     05  FILLER REDEFINES DUEDAYHF.
  2793         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  57
* EL156.cbl
  2794     05  DUEDAYHI PIC  X(0008).
  2795*    -------------------------------
  2796     05  DUEDAYL PIC S9(0004) COMP.
  2797     05  DUEDAYF PIC  X(0001).
  2798     05  FILLER REDEFINES DUEDAYF.
  2799         10  DUEDAYA PIC  X(0001).
  2800     05  DUEDAYI PIC  X(0002).
  2801*    -------------------------------
  2802     05  ZINTHL PIC S9(0004) COMP.
  2803     05  ZINTHF PIC  X(0001).
  2804     05  FILLER REDEFINES ZINTHF.
  2805         10  ZINTHA PIC  X(0001).
  2806     05  ZINTHI PIC  X(0009).
  2807*    -------------------------------
  2808     05  ZINTL PIC S9(0004) COMP.
  2809     05  ZINTF PIC  X(0001).
  2810     05  FILLER REDEFINES ZINTF.
  2811         10  ZINTA PIC  X(0001).
  2812     05  ZINTI PIC  99V99999.
  2813*    -------------------------------
  2814     05  PTHRHDGL PIC S9(0004) COMP.
  2815     05  PTHRHDGF PIC  X(0001).
  2816     05  FILLER REDEFINES PTHRHDGF.
  2817         10  PTHRHDGA PIC  X(0001).
  2818     05  PTHRHDGI PIC  X(0014).
  2819*    -------------------------------
  2820     05  PDTHRUL PIC S9(0004) COMP.
  2821     05  PDTHRUF PIC  X(0001).
  2822     05  FILLER REDEFINES PDTHRUF.
  2823         10  PDTHRUA PIC  X(0001).
  2824     05  PDTHRUI PIC  X(0008).
  2825*    -------------------------------
  2826     05  TOTPAIDL PIC S9(0004) COMP.
  2827     05  TOTPAIDF PIC  X(0001).
  2828     05  FILLER REDEFINES TOTPAIDF.
  2829         10  TOTPAIDA PIC  X(0001).
  2830     05  TOTPAIDI PIC  X(0010).
  2831*    -------------------------------
  2832     05  COVERL PIC S9(0004) COMP.
  2833     05  COVERF PIC  X(0001).
  2834     05  FILLER REDEFINES COVERF.
  2835         10  COVERA PIC  X(0001).
  2836     05  COVERI PIC  X(0010).
  2837*    -------------------------------
  2838     05  INCURL PIC S9(0004) COMP.
  2839     05  INCURF PIC  X(0001).
  2840     05  FILLER REDEFINES INCURF.
  2841         10  INCURA PIC  X(0001).
  2842     05  INCURI PIC  X(0008).
  2843*    -------------------------------
  2844     05  LSTDTEL PIC S9(0004) COMP.
  2845     05  LSTDTEF PIC  X(0001).
  2846     05  FILLER REDEFINES LSTDTEF.
  2847         10  LSTDTEA PIC  X(0001).
  2848     05  LSTDTEI PIC  X(0008).
  2849*    -------------------------------
  2850     05  CRTSTATL PIC S9(0004) COMP.
  2851     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  58
* EL156.cbl
  2852     05  FILLER REDEFINES CRTSTATF.
  2853         10  CRTSTATA PIC  X(0001).
  2854     05  CRTSTATI PIC  X(0010).
  2855*    -------------------------------
  2856     05  EFFECTL PIC S9(0004) COMP.
  2857     05  EFFECTF PIC  X(0001).
  2858     05  FILLER REDEFINES EFFECTF.
  2859         10  EFFECTA PIC  X(0001).
  2860     05  EFFECTI PIC  X(0008).
  2861*    -------------------------------
  2862     05  TERMSL PIC S9(0004) COMP.
  2863     05  TERMSF PIC  X(0001).
  2864     05  FILLER REDEFINES TERMSF.
  2865         10  TERMSA PIC  X(0001).
  2866     05  TERMSI PIC  X(0011).
  2867*    -------------------------------
  2868     05  STACCTL PIC S9(0004) COMP.
  2869     05  STACCTF PIC  X(0001).
  2870     05  FILLER REDEFINES STACCTF.
  2871         10  STACCTA PIC  X(0001).
  2872     05  STACCTI PIC  X(0013).
  2873*    -------------------------------
  2874     05  EXPDTEHL PIC S9(0004) COMP.
  2875     05  EXPDTEHF PIC  X(0001).
  2876     05  FILLER REDEFINES EXPDTEHF.
  2877         10  EXPDTEHA PIC  X(0001).
  2878     05  EXPDTEHI PIC  X(0014).
  2879*    -------------------------------
  2880     05  EXPDTEL PIC S9(0004) COMP.
  2881     05  EXPDTEF PIC  X(0001).
  2882     05  FILLER REDEFINES EXPDTEF.
  2883         10  EXPDTEA PIC  X(0001).
  2884     05  EXPDTEI PIC  X(0008).
  2885*    -------------------------------
  2886     05  BENECAPL PIC S9(0004) COMP.
  2887     05  BENECAPF PIC  X(0001).
  2888     05  FILLER REDEFINES BENECAPF.
  2889         10  BENECAPA PIC  X(0001).
  2890     05  BENECAPI PIC  X(0013).
  2891*    -------------------------------
  2892     05  BENEL PIC S9(0004) COMP.
  2893     05  BENEF PIC  X(0001).
  2894     05  FILLER REDEFINES BENEF.
  2895         10  BENEA PIC  X(0001).
  2896     05  BENEI PIC  X(0009).
  2897*    -------------------------------
  2898     05  FORMTYPL PIC S9(0004) COMP.
  2899     05  FORMTYPF PIC  X(0001).
  2900     05  FILLER REDEFINES FORMTYPF.
  2901         10  FORMTYPA PIC  X(0001).
  2902     05  FORMTYPI PIC  X(0001).
  2903*    -------------------------------
  2904     05  PMTTYPEL PIC S9(0004) COMP.
  2905     05  PMTTYPEF PIC  X(0001).
  2906     05  FILLER REDEFINES PMTTYPEF.
  2907         10  PMTTYPEA PIC  X(0001).
  2908     05  PMTTYPEI PIC  X(0001).
  2909*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  59
* EL156.cbl
  2910     05  PAYEEL PIC S9(0004) COMP.
  2911     05  PAYEEF PIC  X(0001).
  2912     05  FILLER REDEFINES PAYEEF.
  2913         10  PAYEEA PIC  X(0001).
  2914     05  PAYEEI PIC  X(0002).
  2915*    -------------------------------
  2916     05  CHECKNOL PIC S9(0004) COMP.
  2917     05  CHECKNOF PIC  X(0001).
  2918     05  FILLER REDEFINES CHECKNOF.
  2919         10  CHECKNOA PIC  X(0001).
  2920     05  CHECKNOI PIC  X(0007).
  2921*    -------------------------------
  2922     05  OFFLINEL PIC S9(0004) COMP.
  2923     05  OFFLINEF PIC  X(0001).
  2924     05  FILLER REDEFINES OFFLINEF.
  2925         10  OFFLINEA PIC  X(0001).
  2926     05  OFFLINEI PIC  X(0001).
  2927*    -------------------------------
  2928     05  HOLDTILL PIC S9(0004) COMP.
  2929     05  HOLDTILF PIC  X(0001).
  2930     05  FILLER REDEFINES HOLDTILF.
  2931         10  HOLDTILA PIC  X(0001).
  2932     05  HOLDTILI PIC  X(0008).
  2933*    -------------------------------
  2934     05  NOTE1L PIC S9(0004) COMP.
  2935     05  NOTE1F PIC  X(0001).
  2936     05  FILLER REDEFINES NOTE1F.
  2937         10  NOTE1A PIC  X(0001).
  2938     05  NOTE1I PIC  X(0060).
  2939*    -------------------------------
  2940     05  ITRB1L PIC S9(0004) COMP.
  2941     05  ITRB1F PIC  X(0001).
  2942     05  FILLER REDEFINES ITRB1F.
  2943         10  ITRB1A PIC  X(0001).
  2944     05  ITRB1I PIC  X(0008).
  2945*    -------------------------------
  2946     05  NOTE2L PIC S9(0004) COMP.
  2947     05  NOTE2F PIC  X(0001).
  2948     05  FILLER REDEFINES NOTE2F.
  2949         10  NOTE2A PIC  X(0001).
  2950     05  NOTE2I PIC  X(0060).
  2951*    -------------------------------
  2952     05  ITRB2L PIC S9(0004) COMP.
  2953     05  ITRB2F PIC  X(0001).
  2954     05  FILLER REDEFINES ITRB2F.
  2955         10  ITRB2A PIC  X(0001).
  2956     05  ITRB2I PIC  X(0010).
  2957*    -------------------------------
  2958     05  EOBYNL PIC S9(0004) COMP.
  2959     05  EOBYNF PIC  X(0001).
  2960     05  FILLER REDEFINES EOBYNF.
  2961         10  EOBYNA PIC  X(0001).
  2962     05  EOBYNI PIC  X(0001).
  2963*    -------------------------------
  2964     05  CLMFMYNL PIC S9(0004) COMP.
  2965     05  CLMFMYNF PIC  X(0001).
  2966     05  FILLER REDEFINES CLMFMYNF.
  2967         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  60
* EL156.cbl
  2968     05  CLMFMYNI PIC  X(0001).
  2969*    -------------------------------
  2970     05  SURVYYNL PIC S9(0004) COMP.
  2971     05  SURVYYNF PIC  X(0001).
  2972     05  FILLER REDEFINES SURVYYNF.
  2973         10  SURVYYNA PIC  X(0001).
  2974     05  SURVYYNI PIC  X(0001).
  2975*    -------------------------------
  2976     05  SPRELYNL PIC S9(0004) COMP.
  2977     05  SPRELYNF PIC  X(0001).
  2978     05  FILLER REDEFINES SPRELYNF.
  2979         10  SPRELYNA PIC  X(0001).
  2980     05  SPRELYNI PIC  X(0001).
  2981*    -------------------------------
  2982     05  PINTHL PIC S9(0004) COMP.
  2983     05  PINTHF PIC  X(0001).
  2984     05  FILLER REDEFINES PINTHF.
  2985         10  PINTHA PIC  X(0001).
  2986     05  PINTHI PIC  X(0004).
  2987*    -------------------------------
  2988     05  PINTL PIC S9(0004) COMP.
  2989     05  PINTF PIC  X(0001).
  2990     05  FILLER REDEFINES PINTF.
  2991         10  PINTA PIC  X(0001).
  2992     05  PINTI PIC  X(0008).
  2993*    -------------------------------
  2994     05  ITRBYNL PIC S9(0004) COMP.
  2995     05  ITRBYNF PIC  X(0001).
  2996     05  FILLER REDEFINES ITRBYNF.
  2997         10  ITRBYNA PIC  X(0001).
  2998     05  ITRBYNI PIC  X(0001).
  2999*    -------------------------------
  3000     05  PROOFDTL PIC S9(0004) COMP.
  3001     05  PROOFDTF PIC  X(0001).
  3002     05  FILLER REDEFINES PROOFDTF.
  3003         10  PROOFDTA PIC  X(0001).
  3004     05  PROOFDTI PIC  X(0008).
  3005*    -------------------------------
  3006     05  AIGFRMHL PIC S9(0004) COMP.
  3007     05  AIGFRMHF PIC  X(0001).
  3008     05  FILLER REDEFINES AIGFRMHF.
  3009         10  AIGFRMHA PIC  X(0001).
  3010     05  AIGFRMHI PIC  X(0012).
  3011*    -------------------------------
  3012     05  AIGFROML PIC S9(0004) COMP.
  3013     05  AIGFROMF PIC  X(0001).
  3014     05  FILLER REDEFINES AIGFROMF.
  3015         10  AIGFROMA PIC  X(0001).
  3016     05  AIGFROMI PIC  X(0008).
  3017*    -------------------------------
  3018     05  PMTHDGAL PIC S9(0004) COMP.
  3019     05  PMTHDGAF PIC  X(0001).
  3020     05  FILLER REDEFINES PMTHDGAF.
  3021         10  PMTHDGAA PIC  X(0001).
  3022     05  PMTHDGAI PIC  X(0066).
  3023*    -------------------------------
  3024     05  EPYFROML PIC S9(0004) COMP.
  3025     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  61
* EL156.cbl
  3026     05  FILLER REDEFINES EPYFROMF.
  3027         10  EPYFROMA PIC  X(0001).
  3028     05  EPYFROMI PIC  X(0008).
  3029*    -------------------------------
  3030     05  EPYTHRUL PIC S9(0004) COMP.
  3031     05  EPYTHRUF PIC  X(0001).
  3032     05  FILLER REDEFINES EPYTHRUF.
  3033         10  EPYTHRUA PIC  X(0001).
  3034     05  EPYTHRUI PIC  X(0008).
  3035*    -------------------------------
  3036     05  EDAYSL PIC S9(0004) COMP.
  3037     05  EDAYSF PIC  X(0001).
  3038     05  FILLER REDEFINES EDAYSF.
  3039         10  EDAYSA PIC  X(0001).
  3040     05  EDAYSI PIC  S9(6).
  3041*    -------------------------------
  3042     05  EPYAMTL PIC S9(0004) COMP.
  3043     05  EPYAMTF PIC  X(0001).
  3044     05  FILLER REDEFINES EPYAMTF.
  3045         10  EPYAMTA PIC  X(0001).
  3046     05  EPYAMTI PIC  S9(8)V99.
  3047*    -------------------------------
  3048     05  ERESVL PIC S9(0004) COMP.
  3049     05  ERESVF PIC  X(0001).
  3050     05  FILLER REDEFINES ERESVF.
  3051         10  ERESVA PIC  X(0001).
  3052     05  ERESVI PIC  S9(7)V99.
  3053*    -------------------------------
  3054     05  ETYPEL PIC S9(0004) COMP.
  3055     05  ETYPEF PIC  X(0001).
  3056     05  FILLER REDEFINES ETYPEF.
  3057         10  ETYPEA PIC  X(0001).
  3058     05  ETYPEI PIC  X(0001).
  3059*    -------------------------------
  3060     05  EEXPENSL PIC S9(0004) COMP.
  3061     05  EEXPENSF PIC  X(0001).
  3062     05  FILLER REDEFINES EEXPENSF.
  3063         10  EEXPENSA PIC  X(0001).
  3064     05  EEXPENSI PIC  9(6)V99.
  3065*    -------------------------------
  3066     05  CPYFROML PIC S9(0004) COMP.
  3067     05  CPYFROMF PIC  X(0001).
  3068     05  FILLER REDEFINES CPYFROMF.
  3069         10  CPYFROMA PIC  X(0001).
  3070     05  CPYFROMI PIC  X(0008).
  3071*    -------------------------------
  3072     05  CPYTHRUL PIC S9(0004) COMP.
  3073     05  CPYTHRUF PIC  X(0001).
  3074     05  FILLER REDEFINES CPYTHRUF.
  3075         10  CPYTHRUA PIC  X(0001).
  3076     05  CPYTHRUI PIC  X(0008).
  3077*    -------------------------------
  3078     05  CDAYSL PIC S9(0004) COMP.
  3079     05  CDAYSF PIC  X(0001).
  3080     05  FILLER REDEFINES CDAYSF.
  3081         10  CDAYSA PIC  X(0001).
  3082     05  CDAYSI PIC  9(6).
  3083*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  62
* EL156.cbl
  3084     05  CPYAMTL PIC S9(0004) COMP.
  3085     05  CPYAMTF PIC  X(0001).
  3086     05  FILLER REDEFINES CPYAMTF.
  3087         10  CPYAMTA PIC  X(0001).
  3088     05  CPYAMTI PIC  S9(8)V99.
  3089*    -------------------------------
  3090     05  CRESVL PIC S9(0004) COMP.
  3091     05  CRESVF PIC  X(0001).
  3092     05  FILLER REDEFINES CRESVF.
  3093         10  CRESVA PIC  X(0001).
  3094     05  CRESVI PIC  9(6)V99.
  3095*    -------------------------------
  3096     05  CEXPENSL PIC S9(0004) COMP.
  3097     05  CEXPENSF PIC  X(0001).
  3098     05  FILLER REDEFINES CEXPENSF.
  3099         10  CEXPENSA PIC  X(0001).
  3100     05  CEXPENSI PIC  9(6)V99.
  3101*    -------------------------------
  3102     05  ERRMSG0L PIC S9(0004) COMP.
  3103     05  ERRMSG0F PIC  X(0001).
  3104     05  FILLER REDEFINES ERRMSG0F.
  3105         10  ERRMSG0A PIC  X(0001).
  3106     05  ERRMSG0I PIC  X(0072).
  3107*    -------------------------------
  3108     05  ERRMSG1L PIC S9(0004) COMP.
  3109     05  ERRMSG1F PIC  X(0001).
  3110     05  FILLER REDEFINES ERRMSG1F.
  3111         10  ERRMSG1A PIC  X(0001).
  3112     05  ERRMSG1I PIC  X(0072).
  3113*    -------------------------------
  3114     05  ERRMSG2L PIC S9(0004) COMP.
  3115     05  ERRMSG2F PIC  X(0001).
  3116     05  FILLER REDEFINES ERRMSG2F.
  3117         10  ERRMSG2A PIC  X(0001).
  3118     05  ERRMSG2I PIC  X(0072).
  3119*    -------------------------------
  3120     05  ENTERPFL PIC S9(0004) COMP.
  3121     05  ENTERPFF PIC  X(0001).
  3122     05  FILLER REDEFINES ENTERPFF.
  3123         10  ENTERPFA PIC  X(0001).
  3124     05  ENTERPFI PIC  99.
  3125*    -------------------------------
  3126     05  PF6TITL PIC S9(0004) COMP.
  3127     05  PF6TITF PIC  X(0001).
  3128     05  FILLER REDEFINES PF6TITF.
  3129         10  PF6TITA PIC  X(0001).
  3130     05  PF6TITI PIC  X(0016).
  3131 01  EL156AO REDEFINES EL156AI.
  3132     05  FILLER            PIC  X(0012).
  3133*    -------------------------------
  3134     05  FILLER            PIC  X(0003).
  3135     05  RUNDTEAO PIC  X(0008).
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  RUNTIMAO PIC  99.99.
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  63
* EL156.cbl
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
  3144     05  CLMNOO PIC  X(0007).
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  CARRO PIC  X(0001).
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  CERTNOO PIC  X(0010).
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  SUFXO PIC  X(0001).
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  CLMTYPO PIC  X(0006).
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  CLMSTATO PIC  X(0006).
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  LSTNMEO PIC  X(0015).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  FSTNMEO PIC  X(0012).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  MINITO PIC  X(0001).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  PRIMHDGO PIC  X(0012).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  PCERTNOO PIC  X(0010).
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  PSUFXO PIC  X(0001).
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  STATUSO PIC  X(0010).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  LOANHO PIC  X(0014).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  LOANNOO PIC  X(0025).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  DUEDAYHO PIC  X(0008).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  DUEDAYO PIC  X(0002).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  ZINTHO PIC  X(0009).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  ZINTO PIC  9.99999.
  3199*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  64
* EL156.cbl
  3200     05  FILLER            PIC  X(0003).
  3201     05  PTHRHDGO PIC  X(0014).
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  PDTHRUO PIC  X(0008).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  TOTPAIDO PIC  Z(6).99-.
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  COVERO PIC  X(0010).
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  INCURO PIC  X(0008).
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  LSTDTEO PIC  X(0008).
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  CRTSTATO PIC  X(0010).
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  EFFECTO PIC  X(0008).
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  TERMSO PIC  X(0011).
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  STACCTO PIC  X(0013).
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  EXPDTEHO PIC  X(0014).
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  EXPDTEO PIC  X(0008).
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  BENECAPO PIC  X(0013).
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  BENEO PIC  Z(6).99.
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  FORMTYPO PIC  X(0001).
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  PMTTYPEO PIC  X(0001).
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  PAYEEO PIC  X(0002).
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  CHECKNOO PIC  X(0007).
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  OFFLINEO PIC  X(0001).
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  65
* EL156.cbl
  3258     05  HOLDTILO PIC  99B99B99.
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  NOTE1O PIC  X(0060).
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  ITRB1O PIC  X(0008).
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  NOTE2O PIC  X(0060).
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  ITRB2O PIC  X(0010).
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
  3273     05  EOBYNO PIC  X(0001).
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
  3276     05  CLMFMYNO PIC  X(0001).
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  SURVYYNO PIC  X(0001).
  3280*    -------------------------------
  3281     05  FILLER            PIC  X(0003).
  3282     05  SPRELYNO PIC  X(0001).
  3283*    -------------------------------
  3284     05  FILLER            PIC  X(0003).
  3285     05  PINTHO PIC  X(0004).
  3286*    -------------------------------
  3287     05  FILLER            PIC  X(0003).
  3288     05  PINTO PIC  Z,ZZ9.99.
  3289*    -------------------------------
  3290     05  FILLER            PIC  X(0003).
  3291     05  ITRBYNO PIC  X(0001).
  3292*    -------------------------------
  3293     05  FILLER            PIC  X(0003).
  3294     05  PROOFDTO PIC  99B99B99.
  3295*    -------------------------------
  3296     05  FILLER            PIC  X(0003).
  3297     05  AIGFRMHO PIC  X(0012).
  3298*    -------------------------------
  3299     05  FILLER            PIC  X(0003).
  3300     05  AIGFROMO PIC  99B99B99.
  3301*    -------------------------------
  3302     05  FILLER            PIC  X(0003).
  3303     05  PMTHDGAO PIC  X(0066).
  3304*    -------------------------------
  3305     05  FILLER            PIC  X(0003).
  3306     05  EPYFROMO PIC  99B99B99.
  3307*    -------------------------------
  3308     05  FILLER            PIC  X(0003).
  3309     05  EPYTHRUO PIC  99B99B99.
  3310*    -------------------------------
  3311     05  FILLER            PIC  X(0003).
  3312     05  EDAYSO PIC  Z(4)9-.
  3313*    -------------------------------
  3314     05  FILLER            PIC  X(0003).
  3315     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  66
* EL156.cbl
  3316*    -------------------------------
  3317     05  FILLER            PIC  X(0003).
  3318     05  ERESVO PIC  Z(5).99-.
  3319*    -------------------------------
  3320     05  FILLER            PIC  X(0003).
  3321     05  ETYPEO PIC  X(0001).
  3322*    -------------------------------
  3323     05  FILLER            PIC  X(0003).
  3324     05  EEXPENSO PIC  Z(5).99.
  3325*    -------------------------------
  3326     05  FILLER            PIC  X(0003).
  3327     05  CPYFROMO PIC  99B99B99.
  3328*    -------------------------------
  3329     05  FILLER            PIC  X(0003).
  3330     05  CPYTHRUO PIC  99B99B99.
  3331*    -------------------------------
  3332     05  FILLER            PIC  X(0003).
  3333     05  CDAYSO PIC  Z(4)9-.
  3334*    -------------------------------
  3335     05  FILLER            PIC  X(0003).
  3336     05  CPYAMTO PIC  Z(6).99-.
  3337*    -------------------------------
  3338     05  FILLER            PIC  X(0003).
  3339     05  CRESVO PIC  Z(5).99.
  3340*    -------------------------------
  3341     05  FILLER            PIC  X(0003).
  3342     05  CEXPENSO PIC  Z(5).99.
  3343*    -------------------------------
  3344     05  FILLER            PIC  X(0003).
  3345     05  ERRMSG0O PIC  X(0072).
  3346*    -------------------------------
  3347     05  FILLER            PIC  X(0003).
  3348     05  ERRMSG1O PIC  X(0072).
  3349*    -------------------------------
  3350     05  FILLER            PIC  X(0003).
  3351     05  ERRMSG2O PIC  X(0072).
  3352*    -------------------------------
  3353     05  FILLER            PIC  X(0003).
  3354     05  ENTERPFO PIC  X(0002).
  3355*    -------------------------------
  3356     05  FILLER            PIC  X(0003).
  3357     05  PF6TITO PIC  X(0016).
  3358*    -------------------------------
  3359 01  EL156BI REDEFINES EL156AI.
  3360     05  FILLER            PIC  X(0012).
  3361*    -------------------------------
  3362     05  RUNDTEBL PIC S9(0004) COMP.
  3363     05  RUNDTEBF PIC  X(0001).
  3364     05  FILLER REDEFINES RUNDTEBF.
  3365         10  RUNDTEBA PIC  X(0001).
  3366     05  RUNDTEBI PIC  X(0008).
  3367*    -------------------------------
  3368     05  RUNTIMBL PIC S9(0004) COMP.
  3369     05  RUNTIMBF PIC  X(0001).
  3370     05  FILLER REDEFINES RUNTIMBF.
  3371         10  RUNTIMBA PIC  X(0001).
  3372     05  RUNTIMBI PIC  X(0005).
  3373*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  67
* EL156.cbl
  3374     05  PAYDTBL PIC S9(0004) COMP.
  3375     05  PAYDTBF PIC  X(0001).
  3376     05  FILLER REDEFINES PAYDTBF.
  3377         10  PAYDTBA PIC  X(0001).
  3378     05  PAYDTBI PIC  X(0008).
  3379*    -------------------------------
  3380     05  PAYTYPBL PIC S9(0004) COMP.
  3381     05  PAYTYPBF PIC  X(0001).
  3382     05  FILLER REDEFINES PAYTYPBF.
  3383         10  PAYTYPBA PIC  X(0001).
  3384     05  PAYTYPBI PIC  X(0015).
  3385*    -------------------------------
  3386     05  PAYAMTBL PIC S9(0004) COMP.
  3387     05  PAYAMTBF PIC  X(0001).
  3388     05  FILLER REDEFINES PAYAMTBF.
  3389         10  PAYAMTBA PIC  X(0001).
  3390     05  PAYAMTBI PIC  X(0011).
  3391*    -------------------------------
  3392     05  LOANHBL PIC S9(0004) COMP.
  3393     05  LOANHBF PIC  X(0001).
  3394     05  FILLER REDEFINES LOANHBF.
  3395         10  LOANHBA PIC  X(0001).
  3396     05  LOANHBI PIC  X(0012).
  3397*    -------------------------------
  3398     05  LOANNBL PIC S9(0004) COMP.
  3399     05  LOANNBF PIC  X(0001).
  3400     05  FILLER REDEFINES LOANNBF.
  3401         10  LOANNBA PIC  X(0001).
  3402     05  LOANNBI PIC  X(0025).
  3403*    -------------------------------
  3404     05  CKNUMHDL PIC S9(0004) COMP.
  3405     05  CKNUMHDF PIC  X(0001).
  3406     05  FILLER REDEFINES CKNUMHDF.
  3407         10  CKNUMHDA PIC  X(0001).
  3408     05  CKNUMHDI PIC  X(0012).
  3409*    -------------------------------
  3410     05  CKNUMBL PIC S9(0004) COMP.
  3411     05  CKNUMBF PIC  X(0001).
  3412     05  FILLER REDEFINES CKNUMBF.
  3413         10  CKNUMBA PIC  X(0001).
  3414     05  CKNUMBI PIC  X(0007).
  3415*    -------------------------------
  3416     05  AGTHDGL PIC S9(0004) COMP.
  3417     05  AGTHDGF PIC  X(0001).
  3418     05  FILLER REDEFINES AGTHDGF.
  3419         10  AGTHDGA PIC  X(0001).
  3420     05  AGTHDGI PIC  X(0016).
  3421*    -------------------------------
  3422     05  NAMEBL PIC S9(0004) COMP.
  3423     05  NAMEBF PIC  X(0001).
  3424     05  FILLER REDEFINES NAMEBF.
  3425         10  NAMEBA PIC  X(0001).
  3426     05  NAMEBI PIC  X(0030).
  3427*    -------------------------------
  3428     05  NAMEB2L PIC S9(0004) COMP.
  3429     05  NAMEB2F PIC  X(0001).
  3430     05  FILLER REDEFINES NAMEB2F.
  3431         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  68
* EL156.cbl
  3432     05  NAMEB2I PIC  X(0030).
  3433*    -------------------------------
  3434     05  ADDR1BL PIC S9(0004) COMP.
  3435     05  ADDR1BF PIC  X(0001).
  3436     05  FILLER REDEFINES ADDR1BF.
  3437         10  ADDR1BA PIC  X(0001).
  3438     05  ADDR1BI PIC  X(0030).
  3439*    -------------------------------
  3440     05  ADDR1B2L PIC S9(0004) COMP.
  3441     05  ADDR1B2F PIC  X(0001).
  3442     05  FILLER REDEFINES ADDR1B2F.
  3443         10  ADDR1B2A PIC  X(0001).
  3444     05  ADDR1B2I PIC  X(0030).
  3445*    -------------------------------
  3446     05  ADDR2BL PIC S9(0004) COMP.
  3447     05  ADDR2BF PIC  X(0001).
  3448     05  FILLER REDEFINES ADDR2BF.
  3449         10  ADDR2BA PIC  X(0001).
  3450     05  ADDR2BI PIC  X(0030).
  3451*    -------------------------------
  3452     05  ADDR2B2L PIC S9(0004) COMP.
  3453     05  ADDR2B2F PIC  X(0001).
  3454     05  FILLER REDEFINES ADDR2B2F.
  3455         10  ADDR2B2A PIC  X(0001).
  3456     05  ADDR2B2I PIC  X(0030).
  3457*    -------------------------------
  3458     05  CITYSTBL PIC S9(0004) COMP.
  3459     05  CITYSTBF PIC  X(0001).
  3460     05  FILLER REDEFINES CITYSTBF.
  3461         10  CITYSTBA PIC  X(0001).
  3462     05  CITYSTBI PIC  X(0030).
  3463*    -------------------------------
  3464     05  CITYST2L PIC S9(0004) COMP.
  3465     05  CITYST2F PIC  X(0001).
  3466     05  FILLER REDEFINES CITYST2F.
  3467         10  CITYST2A PIC  X(0001).
  3468     05  CITYST2I PIC  X(0030).
  3469*    -------------------------------
  3470     05  ZIPBL PIC S9(0004) COMP.
  3471     05  ZIPBF PIC  X(0001).
  3472     05  FILLER REDEFINES ZIPBF.
  3473         10  ZIPBA PIC  X(0001).
  3474     05  ZIPBI PIC  X(0009).
  3475*    -------------------------------
  3476     05  ZIPB2L PIC S9(0004) COMP.
  3477     05  ZIPB2F PIC  X(0001).
  3478     05  FILLER REDEFINES ZIPB2F.
  3479         10  ZIPB2A PIC  X(0001).
  3480     05  ZIPB2I PIC  X(0009).
  3481*    -------------------------------
  3482     05  INTHDBL PIC S9(0004) COMP.
  3483     05  INTHDBF PIC  X(0001).
  3484     05  FILLER REDEFINES INTHDBF.
  3485         10  INTHDBA PIC  X(0001).
  3486     05  INTHDBI PIC  X(0012).
  3487*    -------------------------------
  3488     05  INTAMTBL PIC S9(0004) COMP.
  3489     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  69
* EL156.cbl
  3490     05  FILLER REDEFINES INTAMTBF.
  3491         10  INTAMTBA PIC  X(0001).
  3492     05  INTAMTBI PIC  X(0011).
  3493*    -------------------------------
  3494     05  PMTHDGBL PIC S9(0004) COMP.
  3495     05  PMTHDGBF PIC  X(0001).
  3496     05  FILLER REDEFINES PMTHDGBF.
  3497         10  PMTHDGBA PIC  X(0001).
  3498     05  PMTHDGBI PIC  X(0034).
  3499*    -------------------------------
  3500     05  CLMNOBL PIC S9(0004) COMP.
  3501     05  CLMNOBF PIC  X(0001).
  3502     05  FILLER REDEFINES CLMNOBF.
  3503         10  CLMNOBA PIC  X(0001).
  3504     05  CLMNOBI PIC  X(0007).
  3505*    -------------------------------
  3506     05  CARRBL PIC S9(0004) COMP.
  3507     05  CARRBF PIC  X(0001).
  3508     05  FILLER REDEFINES CARRBF.
  3509         10  CARRBA PIC  X(0001).
  3510     05  CARRBI PIC  X(0001).
  3511*    -------------------------------
  3512     05  CERTNOBL PIC S9(0004) COMP.
  3513     05  CERTNOBF PIC  X(0001).
  3514     05  FILLER REDEFINES CERTNOBF.
  3515         10  CERTNOBA PIC  X(0001).
  3516     05  CERTNOBI PIC  X(0010).
  3517*    -------------------------------
  3518     05  SUFXBL PIC S9(0004) COMP.
  3519     05  SUFXBF PIC  X(0001).
  3520     05  FILLER REDEFINES SUFXBF.
  3521         10  SUFXBA PIC  X(0001).
  3522     05  SUFXBI PIC  X(0001).
  3523*    -------------------------------
  3524     05  CLMTYPBL PIC S9(0004) COMP.
  3525     05  CLMTYPBF PIC  X(0001).
  3526     05  FILLER REDEFINES CLMTYPBF.
  3527         10  CLMTYPBA PIC  X(0001).
  3528     05  CLMTYPBI PIC  X(0006).
  3529*    -------------------------------
  3530     05  INCURBL PIC S9(0004) COMP.
  3531     05  INCURBF PIC  X(0001).
  3532     05  FILLER REDEFINES INCURBF.
  3533         10  INCURBA PIC  X(0001).
  3534     05  INCURBI PIC  X(0008).
  3535*    -------------------------------
  3536     05  PYFROMBL PIC S9(0004) COMP.
  3537     05  PYFROMBF PIC  X(0001).
  3538     05  FILLER REDEFINES PYFROMBF.
  3539         10  PYFROMBA PIC  X(0001).
  3540     05  PYFROMBI PIC  X(0008).
  3541*    -------------------------------
  3542     05  PYTHRUBL PIC S9(0004) COMP.
  3543     05  PYTHRUBF PIC  X(0001).
  3544     05  FILLER REDEFINES PYTHRUBF.
  3545         10  PYTHRUBA PIC  X(0001).
  3546     05  PYTHRUBI PIC  X(0008).
  3547*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  70
* EL156.cbl
  3548     05  DAYSBL PIC S9(0004) COMP.
  3549     05  DAYSBF PIC  X(0001).
  3550     05  FILLER REDEFINES DAYSBF.
  3551         10  DAYSBA PIC  X(0001).
  3552     05  DAYSBI PIC  X(0005).
  3553*    -------------------------------
  3554     05  BYBL PIC S9(0004) COMP.
  3555     05  BYBF PIC  X(0001).
  3556     05  FILLER REDEFINES BYBF.
  3557         10  BYBA PIC  X(0001).
  3558     05  BYBI PIC  X(0004).
  3559*    -------------------------------
  3560     05  PROOFDBL PIC S9(0004) COMP.
  3561     05  PROOFDBF PIC  X(0001).
  3562     05  FILLER REDEFINES PROOFDBF.
  3563         10  PROOFDBA PIC  X(0001).
  3564     05  PROOFDBI PIC  X(0008).
  3565*    -------------------------------
  3566     05  ACCTBL PIC S9(0004) COMP.
  3567     05  ACCTBF PIC  X(0001).
  3568     05  FILLER REDEFINES ACCTBF.
  3569         10  ACCTBA PIC  X(0001).
  3570     05  ACCTBI PIC  X(0010).
  3571*    -------------------------------
  3572     05  STATEBL PIC S9(0004) COMP.
  3573     05  STATEBF PIC  X(0001).
  3574     05  FILLER REDEFINES STATEBF.
  3575         10  STATEBA PIC  X(0001).
  3576     05  STATEBI PIC  X(0002).
  3577*    -------------------------------
  3578     05  GROUPBL PIC S9(0004) COMP.
  3579     05  GROUPBF PIC  X(0001).
  3580     05  FILLER REDEFINES GROUPBF.
  3581         10  GROUPBA PIC  X(0001).
  3582     05  GROUPBI PIC  X(0006).
  3583*    -------------------------------
  3584     05  ACARRBL PIC S9(0004) COMP.
  3585     05  ACARRBF PIC  X(0001).
  3586     05  FILLER REDEFINES ACARRBF.
  3587         10  ACARRBA PIC  X(0001).
  3588     05  ACARRBI PIC  X(0001).
  3589*    -------------------------------
  3590     05  ACCTNMBL PIC S9(0004) COMP.
  3591     05  ACCTNMBF PIC  X(0001).
  3592     05  FILLER REDEFINES ACCTNMBF.
  3593         10  ACCTNMBA PIC  X(0001).
  3594     05  ACCTNMBI PIC  X(0030).
  3595*    -------------------------------
  3596     05  UNDISBL PIC S9(0004) COMP.
  3597     05  UNDISBF PIC  X(0001).
  3598     05  FILLER REDEFINES UNDISBF.
  3599         10  UNDISBA PIC  X(0001).
  3600     05  UNDISBI PIC  X(0010).
  3601*    -------------------------------
  3602     05  RATEBL PIC S9(0004) COMP.
  3603     05  RATEBF PIC  X(0001).
  3604     05  FILLER REDEFINES RATEBF.
  3605         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  71
* EL156.cbl
  3606     05  RATEBI PIC  X(0006).
  3607*    -------------------------------
  3608     05  ERMSG1BL PIC S9(0004) COMP.
  3609     05  ERMSG1BF PIC  X(0001).
  3610     05  FILLER REDEFINES ERMSG1BF.
  3611         10  ERMSG1BA PIC  X(0001).
  3612     05  ERMSG1BI PIC  X(0072).
  3613*    -------------------------------
  3614     05  ENTPFBL PIC S9(0004) COMP.
  3615     05  ENTPFBF PIC  X(0001).
  3616     05  FILLER REDEFINES ENTPFBF.
  3617         10  ENTPFBA PIC  X(0001).
  3618     05  ENTPFBI PIC  99.
  3619 01  EL156BO REDEFINES EL156AI.
  3620     05  FILLER            PIC  X(0012).
  3621*    -------------------------------
  3622     05  FILLER            PIC  X(0003).
  3623     05  RUNDTEBO PIC  X(0008).
  3624*    -------------------------------
  3625     05  FILLER            PIC  X(0003).
  3626     05  RUNTIMBO PIC  99.99.
  3627*    -------------------------------
  3628     05  FILLER            PIC  X(0003).
  3629     05  PAYDTBO PIC  99B99B99.
  3630*    -------------------------------
  3631     05  FILLER            PIC  X(0003).
  3632     05  PAYTYPBO PIC  X(0015).
  3633*    -------------------------------
  3634     05  FILLER            PIC  X(0003).
  3635     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3636*    -------------------------------
  3637     05  FILLER            PIC  X(0003).
  3638     05  LOANHBO PIC  X(0012).
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  LOANNBO PIC  X(0025).
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  CKNUMHDO PIC  X(0012).
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  CKNUMBO PIC  X(0007).
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  AGTHDGO PIC  X(0016).
  3651*    -------------------------------
  3652     05  FILLER            PIC  X(0003).
  3653     05  NAMEBO PIC  X(0030).
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  NAMEB2O PIC  X(0030).
  3657*    -------------------------------
  3658     05  FILLER            PIC  X(0003).
  3659     05  ADDR1BO PIC  X(0030).
  3660*    -------------------------------
  3661     05  FILLER            PIC  X(0003).
  3662     05  ADDR1B2O PIC  X(0030).
  3663*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  72
* EL156.cbl
  3664     05  FILLER            PIC  X(0003).
  3665     05  ADDR2BO PIC  X(0030).
  3666*    -------------------------------
  3667     05  FILLER            PIC  X(0003).
  3668     05  ADDR2B2O PIC  X(0030).
  3669*    -------------------------------
  3670     05  FILLER            PIC  X(0003).
  3671     05  CITYSTBO PIC  X(0030).
  3672*    -------------------------------
  3673     05  FILLER            PIC  X(0003).
  3674     05  CITYST2O PIC  X(0030).
  3675*    -------------------------------
  3676     05  FILLER            PIC  X(0003).
  3677     05  ZIPBO PIC  ZZZZ99999.
  3678*    -------------------------------
  3679     05  FILLER            PIC  X(0003).
  3680     05  ZIPB2O PIC  ZZZZZZZZZ.
  3681*    -------------------------------
  3682     05  FILLER            PIC  X(0003).
  3683     05  INTHDBO PIC  X(0012).
  3684*    -------------------------------
  3685     05  FILLER            PIC  X(0003).
  3686     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3687*    -------------------------------
  3688     05  FILLER            PIC  X(0003).
  3689     05  PMTHDGBO PIC  X(0034).
  3690*    -------------------------------
  3691     05  FILLER            PIC  X(0003).
  3692     05  CLMNOBO PIC  X(0007).
  3693*    -------------------------------
  3694     05  FILLER            PIC  X(0003).
  3695     05  CARRBO PIC  X(0001).
  3696*    -------------------------------
  3697     05  FILLER            PIC  X(0003).
  3698     05  CERTNOBO PIC  X(0010).
  3699*    -------------------------------
  3700     05  FILLER            PIC  X(0003).
  3701     05  SUFXBO PIC  X(0001).
  3702*    -------------------------------
  3703     05  FILLER            PIC  X(0003).
  3704     05  CLMTYPBO PIC  X(0006).
  3705*    -------------------------------
  3706     05  FILLER            PIC  X(0003).
  3707     05  INCURBO PIC  X(0008).
  3708*    -------------------------------
  3709     05  FILLER            PIC  X(0003).
  3710     05  PYFROMBO PIC  99B99B99.
  3711*    -------------------------------
  3712     05  FILLER            PIC  X(0003).
  3713     05  PYTHRUBO PIC  99B99B99.
  3714*    -------------------------------
  3715     05  FILLER            PIC  X(0003).
  3716     05  DAYSBO PIC  X(0005).
  3717*    -------------------------------
  3718     05  FILLER            PIC  X(0003).
  3719     05  BYBO PIC  X(0004).
  3720*    -------------------------------
  3721     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  73
* EL156.cbl
  3722     05  PROOFDBO PIC  99B99B99.
  3723*    -------------------------------
  3724     05  FILLER            PIC  X(0003).
  3725     05  ACCTBO PIC  X(0010).
  3726*    -------------------------------
  3727     05  FILLER            PIC  X(0003).
  3728     05  STATEBO PIC  X(0002).
  3729*    -------------------------------
  3730     05  FILLER            PIC  X(0003).
  3731     05  GROUPBO PIC  X(0006).
  3732*    -------------------------------
  3733     05  FILLER            PIC  X(0003).
  3734     05  ACARRBO PIC  X(0001).
  3735*    -------------------------------
  3736     05  FILLER            PIC  X(0003).
  3737     05  ACCTNMBO PIC  X(0030).
  3738*    -------------------------------
  3739     05  FILLER            PIC  X(0003).
  3740     05  UNDISBO PIC  ZZZ,Z99.99.
  3741*    -------------------------------
  3742     05  FILLER            PIC  X(0003).
  3743     05  RATEBO PIC  ZZZ.99.
  3744*    -------------------------------
  3745     05  FILLER            PIC  X(0003).
  3746     05  ERMSG1BO PIC  X(0072).
  3747*    -------------------------------
  3748     05  FILLER            PIC  X(0003).
  3749     05  ENTPFBO PIC  X(0002).
  3750*    -------------------------------
  3751****************************************************************
  3752*
  3753* Copyright (c) 2007 by Clerity Solutions, Inc.
  3754* All rights reserved.
  3755*
  3756****************************************************************
  3757 01  DFHEIV.
  3758   02  DFHEIV0               PIC X(35).
  3759   02  DFHEIV1               PIC X(08).
  3760   02  DFHEIV2               PIC X(08).
  3761   02  DFHEIV3               PIC X(08).
  3762   02  DFHEIV4               PIC X(06).
  3763   02  DFHEIV5               PIC X(04).
  3764   02  DFHEIV6               PIC X(04).
  3765   02  DFHEIV7               PIC X(02).
  3766   02  DFHEIV8               PIC X(02).
  3767   02  DFHEIV9               PIC X(01).
  3768   02  DFHEIV10              PIC S9(7) COMP-3.
  3769   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3770   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3771   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3772   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3773   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3774   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3775   02  DFHEIV17              PIC X(04).
  3776   02  DFHEIV18              PIC X(04).
  3777   02  DFHEIV19              PIC X(04).
  3778   02  DFHEIV20              USAGE IS POINTER.
  3779   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  74
* EL156.cbl
  3780   02  DFHEIV22              USAGE IS POINTER.
  3781   02  DFHEIV23              USAGE IS POINTER.
  3782   02  DFHEIV24              USAGE IS POINTER.
  3783   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3784   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3785   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3786   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3787   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3788   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3789   02  FILLER                PIC X(02).
  3790   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3791   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3792   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3793   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3794   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3795 LINKAGE  SECTION.
  3796*****************************************************************
  3797*                                                               *
  3798* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3799* All rights reserved.                                          *
  3800*                                                               *
  3801*****************************************************************
  3802 01  dfheiblk.
  3803     02  eibtime          pic s9(7) comp-3.
  3804     02  eibdate          pic s9(7) comp-3.
  3805     02  eibtrnid         pic x(4).
  3806     02  eibtaskn         pic s9(7) comp-3.
  3807     02  eibtrmid         pic x(4).
  3808     02  dfheigdi         pic s9(4) comp.
  3809     02  eibcposn         pic s9(4) comp.
  3810     02  eibcalen         pic s9(4) comp.
  3811     02  eibaid           pic x(1).
  3812     02  eibfiller1       pic x(1).
  3813     02  eibfn            pic x(2).
  3814     02  eibfiller2       pic x(2).
  3815     02  eibrcode         pic x(6).
  3816     02  eibfiller3       pic x(2).
  3817     02  eibds            pic x(8).
  3818     02  eibreqid         pic x(8).
  3819     02  eibrsrce         pic x(8).
  3820     02  eibsync          pic x(1).
  3821     02  eibfree          pic x(1).
  3822     02  eibrecv          pic x(1).
  3823     02  eibsend          pic x(1).
  3824     02  eibatt           pic x(1).
  3825     02  eibeoc           pic x(1).
  3826     02  eibfmh           pic x(1).
  3827     02  eibcompl         pic x(1).
  3828     02  eibsig           pic x(1).
  3829     02  eibconf          pic x(1).
  3830     02  eiberr           pic x(1).
  3831     02  eibrldbk         pic x(1).
  3832     02  eiberrcd         pic x(4).
  3833     02  eibsynrb         pic x(1).
  3834     02  eibnodat         pic x(1).
  3835     02  eibfiller5       pic x(2).
  3836     02  eibresp          pic 9(09) comp.
  3837     02  eibresp2         pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  75
* EL156.cbl
  3838     02  dfheigdj         pic s9(4) comp.
  3839     02  dfheigdk         pic s9(4) comp.
  3840 01  DFHCOMMAREA             PIC X(1024).
  3841
  3842*    COPY ELCMSTR.
  3843******************************************************************
  3844*                                                                *
  3845*                            ELCMSTR.                            *
  3846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3847*                            VMOD=2.012                          *
  3848*                                                                *
  3849*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3850*                                                                *
  3851*   FILE TYPE = VSAM,KSDS                                        *
  3852*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3853*                                                                *
  3854*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3855*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3856*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3857*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3858*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3859*                                                 RKP=75,LEN=21  *
  3860*                                                                *
  3861*   **** NOTE ****                                               *
  3862*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3863*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3864*                                                                *
  3865*   LOG = YES                                                    *
  3866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3867******************************************************************
  3868*                   C H A N G E   L O G
  3869*
  3870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3871*-----------------------------------------------------------------
  3872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3873* EFFECTIVE    NUMBER
  3874*-----------------------------------------------------------------
  3875* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3876* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3877* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3878* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3879* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3880******************************************************************
  3881 01  CLAIM-MASTER.
  3882     12  CL-RECORD-ID                PIC XX.
  3883         88  VALID-CL-ID         VALUE 'CL'.
  3884
  3885     12  CL-CONTROL-PRIMARY.
  3886         16  CL-COMPANY-CD           PIC X.
  3887         16  CL-CARRIER              PIC X.
  3888         16  CL-CLAIM-NO             PIC X(7).
  3889         16  CL-CERT-NO.
  3890             20  CL-CERT-PRIME       PIC X(10).
  3891             20  CL-CERT-SFX         PIC X.
  3892
  3893     12  CL-CONTROL-BY-NAME.
  3894         16  CL-COMPANY-CD-A1        PIC X.
  3895         16  CL-INSURED-LAST-NAME    PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  76
* EL156.cbl
  3896         16  CL-INSURED-NAME.
  3897             20  CL-INSURED-1ST-NAME PIC X(12).
  3898             20  CL-INSURED-MID-INIT PIC X.
  3899
  3900     12  CL-CONTROL-BY-SSN.
  3901         16  CL-COMPANY-CD-A2        PIC X.
  3902         16  CL-SOC-SEC-NO.
  3903             20  CL-SSN-STATE        PIC XX.
  3904             20  CL-SSN-ACCOUNT      PIC X(6).
  3905             20  CL-SSN-LN3          PIC X(3).
  3906
  3907     12  CL-CONTROL-BY-CERT-NO.
  3908         16  CL-COMPANY-CD-A4        PIC X.
  3909         16  CL-CERT-NO-A4.
  3910             20  CL-CERT-A4-PRIME    PIC X(10).
  3911             20  CL-CERT-A4-SFX      PIC X.
  3912
  3913     12  CL-CONTROL-BY-CCN.
  3914         16  CL-COMPANY-CD-A5        PIC X.
  3915         16  CL-CCN-A5.
  3916             20  CL-CCN.
  3917                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3918                 24  CL-CCN-PRIME-A5 PIC X(12).
  3919             20  CL-CCN-FILLER-A5    PIC X(4).
  3920
  3921     12  CL-INSURED-PROFILE-DATA.
  3922         16  CL-INSURED-BIRTH-DT     PIC XX.
  3923         16  CL-INSURED-SEX-CD       PIC X.
  3924             88  INSURED-IS-MALE        VALUE 'M'.
  3925             88  INSURED-IS-FEMALE      VALUE 'F'.
  3926             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3927         16  CL-INSURED-OCC-CD       PIC X(6).
  3928         16  FILLER                  PIC X(5).
  3929
  3930     12  CL-PROCESSING-INFO.
  3931         16  CL-PROCESSOR-ID         PIC X(4).
  3932         16  CL-CLAIM-STATUS         PIC X.
  3933             88  CLAIM-IS-OPEN          VALUE 'O'.
  3934             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3935         16  CL-CLAIM-TYPE           PIC X.
  3936*            88  AH-CLAIM               VALUE 'A'.
  3937*            88  LIFE-CLAIM             VALUE 'L'.
  3938*            88  PROPERTY-CLAIM         VALUE 'P'.
  3939*            88  IUI-CLAIM              VALUE 'I'.
  3940*            88  GAP-CLAIM              VALUE 'G'.
  3941*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3942         16  CL-CLAIM-PREM-TYPE      PIC X.
  3943             88  SINGLE-PREMIUM         VALUE '1'.
  3944             88  O-B-COVERAGE           VALUE '2'.
  3945             88  OPEN-END-COVERAGE      VALUE '3'.
  3946         16  CL-INCURRED-DT          PIC XX.
  3947         16  CL-REPORTED-DT          PIC XX.
  3948         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3949         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3950         16  CL-LAST-PMT-DT          PIC XX.
  3951         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3952         16  CL-PAID-THRU-DT         PIC XX.
  3953         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  77
* EL156.cbl
  3954         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3955         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3956         16  CL-PMT-CALC-METHOD      PIC X.
  3957             88  CL-360-DAY-YR          VALUE '1'.
  3958             88  CL-365-DAY-YR          VALUE '2'.
  3959             88  CL-FULL-MONTHS         VALUE '3'.
  3960         16  CL-CAUSE-CD             PIC X(6).
  3961
  3962         16  CL-PRIME-CERT-NO.
  3963             20  CL-PRIME-CERT-PRIME PIC X(10).
  3964             20  CL-PRIME-CERT-SFX   PIC X.
  3965
  3966         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3967             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3968             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3969
  3970         16  CL-MICROFILM-NO         PIC X(10).
  3971         16  FILLER REDEFINES CL-MICROFILM-NO.
  3972             20  CL-BENEFIT-PERIOD   PIC 99.
  3973             20  FILLER              PIC X(8).
  3974         16  CL-PROG-FORM-TYPE       PIC X.
  3975         16  CL-LAST-ADD-ON-DT       PIC XX.
  3976
  3977         16  CL-LAST-REOPEN-DT       PIC XX.
  3978         16  CL-LAST-CLOSE-DT        PIC XX.
  3979         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3980             88  FINAL-PAID             VALUE '1'.
  3981             88  CLAIM-DENIED           VALUE '2'.
  3982             88  AUTO-CLOSE             VALUE '3'.
  3983             88  MANUAL-CLOSE           VALUE '4'.
  3984             88  BENEFITS-CHANGED       VALUE 'C'.
  3985             88  SETUP-ERRORS           VALUE 'E'.
  3986         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3987         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3988         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3989             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3990         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3991         16  FILLER                  PIC X.
  3992
  3993     12  CL-CERTIFICATE-DATA.
  3994         16  CL-CERT-ORIGIN          PIC X.
  3995             88  CERT-WAS-ONLINE        VALUE '1'.
  3996             88  CERT-WAS-CREATED       VALUE '2'.
  3997             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3998         16  CL-CERT-KEY-DATA.
  3999             20  CL-CERT-CARRIER     PIC X.
  4000             20  CL-CERT-GROUPING    PIC X(6).
  4001             20  CL-CERT-STATE       PIC XX.
  4002             20  CL-CERT-ACCOUNT.
  4003                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4004                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4005             20  CL-CERT-EFF-DT      PIC XX.
  4006
  4007     12  CL-STATUS-CONTROLS.
  4008         16  CL-PRIORITY-CD          PIC X.
  4009             88  CONFIDENTIAL-DATA      VALUE '8'.
  4010             88  HIGHEST-PRIORITY       VALUE '9'.
  4011         16  CL-SUPV-ATTN-CD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  78
* EL156.cbl
  4012             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4013             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4014         16  CL-PURGED-DT            PIC XX.
  4015         16  CL-RESTORED-DT          PIC XX.
  4016         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4017         16  CL-NEXT-RESEND-DT       PIC XX.
  4018         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4019         16  CL-CRITICAL-PERIOD      PIC 99.
  4020*        16  FILLER                  PIC XX.
  4021         16  CL-LAST-MAINT-DT        PIC XX.
  4022         16  CL-LAST-MAINT-USER      PIC X(4).
  4023         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4024         16  CL-LAST-MAINT-TYPE      PIC X.
  4025             88  CLAIM-SET-UP           VALUE ' '.
  4026             88  PAYMENT-MADE           VALUE '1'.
  4027             88  LETTER-SENT            VALUE '2'.
  4028             88  MASTER-WAS-ALTERED     VALUE '3'.
  4029             88  MASTER-WAS-RESTORED    VALUE '4'.
  4030             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4031             88  FILE-CONVERTED         VALUE '6'.
  4032             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4033             88  ERROR-CORRECTION       VALUE 'E'.
  4034         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4035         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4036         16  CL-BENEFICIARY          PIC X(10).
  4037         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4038         16  CL-DENIAL-TYPE          PIC X.
  4039             88  CL-TYPE-DENIAL          VALUE '1'.
  4040             88  CL-TYPE-RESCISSION      VALUE '2'.
  4041             88  CL-TYPE-REFORMATION     VALUE '3'.
  4042             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4043             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4044         16  filler                  pic x(5).
  4045*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4046*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4047*        16  CL-RTW-DT               PIC XX.
  4048
  4049     12  CL-TRAILER-CONTROLS.
  4050         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4051             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4052             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4053             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4054         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4055         16  FILLER                  PIC XX.
  4056         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4057         16  CL-ADDRESS-TRAILER-CNT.
  4058             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4059                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4060             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4061                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4062             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4063                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4064             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4065                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4066             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4067                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4068             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4069                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  79
* EL156.cbl
  4070             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4071                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4072
  4073     12  CL-CV-REFERENCE-NO.
  4074         16  CL-CV-REFNO-PRIME       PIC X(18).
  4075         16  CL-CV-REFNO-SFX         PIC XX.
  4076
  4077     12  CL-FILE-LOCATION            PIC X(4).
  4078
  4079     12  CL-PROCESS-ERRORS.
  4080         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4081             88  NO-FATAL-ERRORS        VALUE ZERO.
  4082         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4083             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4084
  4085     12  CL-PRODUCT-CD               PIC X.
  4086
  4087     12  CL-CURRENT-KEY-DATA.
  4088         16  CL-CURRENT-CARRIER      PIC X.
  4089         16  CL-CURRENT-GROUPING     PIC X(6).
  4090         16  CL-CURRENT-STATE        PIC XX.
  4091         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4092
  4093     12  CL-ASSOCIATES               PIC X.
  4094         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4095         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4096         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4097         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4098
  4099     12  CL-ACTIVITY-CODE            PIC 99.
  4100     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4101     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4102
  4103     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4104     12  CL-LAG-REPORT-CODE          PIC 9.
  4105     12  CL-LOAN-TYPE                PIC XX.
  4106     12  CL-LEGAL-STATE              PIC XX.
  4107
  4108     12  CL-YESNOSW                  PIC X.
  4109     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4110         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4111         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4112         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4113     12  cl-insured-type             pic x.
  4114         88  cl-claim-on-primary         value 'P'.
  4115         88  cl-claim-on-co-borrower     value 'C'.
  4116     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  80
* EL156.cbl
  4118*    COPY ELCCNTL.
  4119******************************************************************
  4120*                                                                *
  4121*                                                                *
  4122*                            ELCCNTL.                            *
  4123*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4124*                            VMOD=2.059                          *
  4125*                                                                *
  4126*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4127*                                                                *
  4128*   FILE TYPE = VSAM,KSDS                                        *
  4129*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4130*                                                                *
  4131*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4132*       ALTERNATE INDEX = NONE                                   *
  4133*                                                                *
  4134*   LOG = YES                                                    *
  4135*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4136******************************************************************
  4137*                   C H A N G E   L O G
  4138*
  4139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4140*-----------------------------------------------------------------
  4141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4142* EFFECTIVE    NUMBER
  4143*-----------------------------------------------------------------
  4144* 082503                   PEMA  ADD BENEFIT GROUP
  4145* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4146* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4147* 092705    2005050300006  PEMA  ADD SPP LEASES
  4148* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4149* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4150* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4151* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4152* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4153* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4154* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4155* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4156* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4157* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4158******************************************************************
  4159*
  4160 01  CONTROL-FILE.
  4161     12  CF-RECORD-ID                       PIC XX.
  4162         88  VALID-CF-ID                        VALUE 'CF'.
  4163
  4164     12  CF-CONTROL-PRIMARY.
  4165         16  CF-COMPANY-ID                  PIC XXX.
  4166         16  CF-RECORD-TYPE                 PIC X.
  4167             88  CF-COMPANY-MASTER              VALUE '1'.
  4168             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4169             88  CF-STATE-MASTER                VALUE '3'.
  4170             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4171             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4172             88  CF-CARRIER-MASTER              VALUE '6'.
  4173             88  CF-MORTALITY-MASTER            VALUE '7'.
  4174             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4175             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  81
* EL156.cbl
  4176             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4177             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4178             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4179             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4180             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4181             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4182             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4183             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4184             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4185         16  CF-ACCESS-CD-GENL              PIC X(4).
  4186         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4187             20  CF-PROCESSOR               PIC X(4).
  4188         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4189             20  CF-STATE-CODE              PIC XX.
  4190             20  FILLER                     PIC XX.
  4191         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4192             20  FILLER                     PIC XX.
  4193             20  CF-HI-BEN-IN-REC           PIC XX.
  4194         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4195             20  FILLER                     PIC XXX.
  4196             20  CF-CARRIER-CNTL            PIC X.
  4197         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4198             20  FILLER                     PIC XX.
  4199             20  CF-HI-TYPE-IN-REC          PIC 99.
  4200         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4201             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4202                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4203             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4204             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4205         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4206             20  FILLER                     PIC X.
  4207             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4208         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4209             20  FILLER                     PIC XX.
  4210             20  CF-MORTGAGE-PLAN           PIC XX.
  4211         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4212
  4213     12  CF-LAST-MAINT-DT                   PIC XX.
  4214     12  CF-LAST-MAINT-BY                   PIC X(4).
  4215     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4216
  4217     12  CF-RECORD-BODY                     PIC X(728).
  4218
  4219
  4220****************************************************************
  4221*             COMPANY MASTER RECORD                            *
  4222****************************************************************
  4223
  4224     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4225         16  CF-COMPANY-ADDRESS.
  4226             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4227             20  CF-CL-IN-CARE-OF           PIC X(30).
  4228             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4229             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4230             20  CF-CL-CITY-STATE           PIC X(30).
  4231             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4232             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4233         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  82
* EL156.cbl
  4234         16  CF-COMPANY-PASSWORD            PIC X(8).
  4235         16  CF-SECURITY-OPTION             PIC X.
  4236             88  ALL-SECURITY                   VALUE '1'.
  4237             88  COMPANY-VERIFY                 VALUE '2'.
  4238             88  PROCESSOR-VERIFY               VALUE '3'.
  4239             88  NO-SECURITY                    VALUE '4'.
  4240             88  ALL-BUT-TERM                   VALUE '5'.
  4241         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4242             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4243         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4244             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4245         16  CF-INFORCE-LOCATION            PIC X.
  4246             88  CERTS-ARE-ONLINE               VALUE '1'.
  4247             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4248             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4249         16  CF-LOWER-CASE-LETTERS          PIC X.
  4250         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4251             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4252             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4253             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4254             88  CF-ACCNT-CNTL                  VALUE '3'.
  4255             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4256
  4257         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4258         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4259
  4260         16  CF-LGX-CREDIT-USER             PIC X.
  4261             88  CO-IS-NOT-USER                 VALUE 'N'.
  4262             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4263
  4264         16 CF-CREDIT-CALC-CODES.
  4265             20  CF-CR-REM-TERM-CALC PIC X.
  4266               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4267               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4268               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4269               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4270               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4271               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4272               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4273             20  CF-CR-R78-METHOD           PIC X.
  4274               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4275               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4276
  4277         16  CF-CLAIM-CONTROL-COUNTS.
  4278             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4279                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4280
  4281             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4282                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4283
  4284             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4285                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4286
  4287             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4288                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4289
  4290         16  CF-CURRENT-MONTH-END           PIC XX.
  4291
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  83
* EL156.cbl
  4292         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4293             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4294             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4295             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4296             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4297                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4298                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4299             20  CF-CO-PREM-REJECT-SW       PIC X.
  4300                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4301                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4302             20  CF-CO-REF-REJECT-SW        PIC X.
  4303                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4304                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4305
  4306         16  CF-CO-REPORTING-DT             PIC XX.
  4307         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4308         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4309           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4310           88  CF-CO-MONTH-END                  VALUE '1'.
  4311
  4312         16  CF-LGX-CLAIM-USER              PIC X.
  4313             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4314             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4315
  4316         16  CF-CREDIT-EDIT-CONTROLS.
  4317             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4318             20  CF-MIN-AGE                 PIC 99.
  4319             20  CF-DEFAULT-AGE             PIC 99.
  4320             20  CF-MIN-TERM                PIC S999      COMP-3.
  4321             20  CF-MAX-TERM                PIC S999      COMP-3.
  4322             20  CF-DEFAULT-SEX             PIC X.
  4323             20  CF-JOINT-AGE-INPUT         PIC X.
  4324                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4325             20  CF-BIRTH-DATE-INPUT        PIC X.
  4326                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4327             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4328                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4329                 88  CF-ZERO-CARRIER            VALUE '1'.
  4330                 88  CF-ZERO-GROUPING           VALUE '2'.
  4331                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4332             20  CF-EDIT-SW                 PIC X.
  4333                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4334             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4335             20  CF-CR-PR-METHOD            PIC X.
  4336               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4337               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4338             20  FILLER                     PIC X.
  4339
  4340         16  CF-CREDIT-MISC-CONTROLS.
  4341             20  CF-REIN-TABLE-SW           PIC X.
  4342                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4343             20  CF-COMP-TABLE-SW           PIC X.
  4344                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4345             20  CF-EXPERIENCE-RETENTION-AGE
  4346                                            PIC S9        COMP-3.
  4347             20  CF-CONVERSION-DT           PIC XX.
  4348             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4349             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  84
* EL156.cbl
  4350                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4351                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4352
  4353             20  CF-CR-CHECK-NO-CONTROL.
  4354                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4355                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4356                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4357                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4358                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4359                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4360
  4361                 24  CF-CR-CHECK-COUNT       REDEFINES
  4362                     CF-CR-CHECK-COUNTER      PIC X(4).
  4363
  4364                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4365                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4366
  4367                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4368                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4369                 24  CF-MAIL-PROCESSING       PIC X.
  4370                     88  MAIL-PROCESSING          VALUE 'Y'.
  4371
  4372         16  CF-MISC-SYSTEM-CONTROL.
  4373             20  CF-SYSTEM-C                 PIC X.
  4374                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4375             20  CF-SYSTEM-D                 PIC X.
  4376                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4377             20  CF-SOC-SEC-NO-SW            PIC X.
  4378                 88  SOC-SEC-NO-USED             VALUE '1'.
  4379             20  CF-MEMBER-NO-SW             PIC X.
  4380                 88  MEMBER-NO-USED              VALUE '1'.
  4381             20  CF-TAX-ID-NUMBER            PIC X(11).
  4382             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4383             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4384                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4385                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4386                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4387                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4388             20  CF-SYSTEM-E                 PIC X.
  4389                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4390
  4391         16  CF-LGX-LIFE-USER               PIC X.
  4392             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4393             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4394
  4395         16  CF-CR-MONTH-END-DT             PIC XX.
  4396
  4397         16  CF-FILE-MAINT-DATES.
  4398             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4399                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4400             20  CF-LAST-BATCH       REDEFINES
  4401                 CF-LAST-BATCH-NO               PIC X(4).
  4402             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4403             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4404             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4405             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4406             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4407             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  85
* EL156.cbl
  4408             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4409             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4410             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4411             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4412
  4413         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4414         16  FILLER                         PIC X.
  4415
  4416         16  CF-ALT-MORT-CODE               PIC X(4).
  4417         16  CF-MEMBER-CAPTION              PIC X(10).
  4418
  4419         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4420             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4421             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4422             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4423             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4424             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4425
  4426         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4427
  4428         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4429         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4430         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4431         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4432
  4433         16  CF-AH-OVERRIDE-L1              PIC X.
  4434         16  CF-AH-OVERRIDE-L2              PIC XX.
  4435         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4436         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4437
  4438         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4439         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4440
  4441         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4442         16  CF-AR-LAST-EL860-DT            PIC XX.
  4443         16  CF-MP-MONTH-END-DT             PIC XX.
  4444
  4445         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4446         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4447             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4448
  4449         16  CF-AR-MONTH-END-DT             PIC XX.
  4450
  4451         16  CF-CRDTCRD-USER                PIC X.
  4452             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4453             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4454
  4455         16  CF-CC-MONTH-END-DT             PIC XX.
  4456
  4457         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4458
  4459         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4460             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4461             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4462             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4463         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4464         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4465         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  86
* EL156.cbl
  4466         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4467             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4468             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4469         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4470         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4471         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4472             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4473         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4474
  4475         16  CF-CL-ZIP-CODE.
  4476             20  CF-CL-ZIP-PRIME.
  4477                 24  CF-CL-ZIP-1ST          PIC X.
  4478                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4479                 24  FILLER                 PIC X(4).
  4480             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4481         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4482             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4483             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4484             20  FILLER                     PIC XXX.
  4485
  4486         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4487         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4488         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4489         16  CF-CO-OPTION-START-DATE        PIC XX.
  4490         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4491           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4492                                                      '3' '4'.
  4493           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4494           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4495           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4496           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4497           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4498           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4499
  4500         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4501
  4502         16  CF-PAYMENT-APPROVAL-LEVELS.
  4503             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4504             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4505             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4506             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4507             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4508             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4509
  4510         16  CF-END-USER-REPORTING-USER     PIC X.
  4511             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4512             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4513
  4514         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4515             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4516             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4517
  4518         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4519
  4520         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4521         16  FILLER                         PIC X.
  4522
  4523         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  87
* EL156.cbl
  4524             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4525             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4526             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4527
  4528         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4529
  4530         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4531             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4532             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4533
  4534         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4535             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4536             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4537
  4538         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4539
  4540         16  CF-CO-ACH-ID-CODE              PIC  X.
  4541             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4542             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4543             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4544         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4545         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4546         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4547         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4548         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4549         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4550         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4551         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4552         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4553                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4554         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4555                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4556
  4557         16  CF-CO-OVER-SHORT.
  4558             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4559             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4560
  4561*         16  FILLER                         PIC X(102).
  4562         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4563             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4564             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4565
  4566         16  CF-AH-APPROVAL-DAYS.
  4567             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4568             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4569             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4570             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4571
  4572         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4573
  4574         16  CF-APPROV-LEV-5.
  4575             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4576             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4577             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4578
  4579         16  FILLER                         PIC X(68).
  4580****************************************************************
  4581*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  88
* EL156.cbl
  4582****************************************************************
  4583
  4584     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4585         16  CF-PROCESSOR-NAME              PIC X(30).
  4586         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4587         16  CF-PROCESSOR-TITLE             PIC X(26).
  4588         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4589                 88  MESSAGE-YES                VALUE 'Y'.
  4590                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4591
  4592*****************************************************
  4593****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4594****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4595****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4596****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4597*****************************************************
  4598
  4599         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4600             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4601             20  CF-APPLICATION-FORCE       PIC X.
  4602             20  CF-INDIVIDUAL-APP.
  4603                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4604                     28  CF-BROWSE-APP      PIC X.
  4605                     28  CF-UPDATE-APP      PIC X.
  4606
  4607         16  CF-CURRENT-TERM-ON             PIC X(4).
  4608         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4609             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4610             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4611             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4612             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4613             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4614             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4615             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4616         16  CF-PROCESSOR-CARRIER           PIC X.
  4617             88  NO-CARRIER-SECURITY            VALUE ' '.
  4618         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4619             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4620         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4621             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4622         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4623             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4624
  4625         16  CF-PROC-SYS-ACCESS-SW.
  4626             20  CF-PROC-CREDIT-CLAIMS-SW.
  4627                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4628                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4629                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4630                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4631             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4632                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4633                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4634             20  CF-PROC-LIFE-GNRLDGR-SW.
  4635                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4636                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4637                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4638                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4639             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  89
* EL156.cbl
  4640                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4641                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4642         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4643             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4644             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4645         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4646
  4647         16  CF-APPROVAL-LEVEL                  PIC X.
  4648             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4649             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4650             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4651             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4652             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4653
  4654         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4655
  4656         16  CF-LANGUAGE-TYPE                   PIC X.
  4657             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4658             88  CF-LANG-IS-FR                      VALUE 'F'.
  4659
  4660         16  CF-CSR-IND                         PIC X.
  4661         16  FILLER                             PIC X(239).
  4662
  4663****************************************************************
  4664*             PROCESSOR/REMINDERS RECORD                       *
  4665****************************************************************
  4666
  4667     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4668         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4669             20  CF-START-REMIND-DT         PIC XX.
  4670             20  CF-END-REMIND-DT           PIC XX.
  4671             20  CF-REMINDER-TEXT           PIC X(50).
  4672         16  FILLER                         PIC X(296).
  4673
  4674
  4675****************************************************************
  4676*             STATE MASTER RECORD                              *
  4677****************************************************************
  4678
  4679     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4680         16  CF-STATE-ABBREVIATION          PIC XX.
  4681         16  CF-STATE-NAME                  PIC X(25).
  4682         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4683         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4684             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4685             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4686             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4687             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4688                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4689                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4690             20  CF-ST-PREM-REJECT-SW       PIC X.
  4691                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4692                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4693             20  CF-ST-REF-REJECT-SW        PIC X.
  4694                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4695                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4696         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4697         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  90
* EL156.cbl
  4698         16  CF-ST-REFUND-RULES.
  4699             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4700             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4701             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4702         16  CF-ST-FST-PMT-EXTENSION.
  4703             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4704             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4705                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4706                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4707                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4708                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4709         16  CF-ST-STATE-CALL.
  4710             20  CF-ST-CALL-UNEARNED        PIC X.
  4711             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4712             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4713         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4714             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4715             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4716         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4717         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4718         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4719         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4720         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4721         16  FILLER                         PIC X.
  4722         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4723             20  CF-ST-BENEFIT-CD           PIC XX.
  4724             20  CF-ST-BENEFIT-KIND         PIC X.
  4725                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4726                 88  CF-ST-AH-KIND              VALUE 'A'.
  4727             20  CF-ST-REM-TERM-CALC        PIC X.
  4728                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4729                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4730                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4731                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4732                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4733                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4734                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4735                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4736
  4737             20  CF-ST-REFUND-CALC          PIC X.
  4738                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4739                 88  ST-REFD-BY-R78             VALUE '1'.
  4740                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4741                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4742                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4743                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4744                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4745                 88  ST-REFD-UTAH               VALUE '7'.
  4746                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4747                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4748                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4749
  4750             20  CF-ST-EARNING-CALC         PIC X.
  4751                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4752                 88  ST-EARN-BY-R78             VALUE '1'.
  4753                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4754                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4755                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  91
* EL156.cbl
  4756                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4757                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4758                 88  ST-EARN-MEAN               VALUE '8'.
  4759                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4760
  4761             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4762                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4763                 88  ST-OVRD-BY-R78             VALUE '1'.
  4764                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4765                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4766                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4767                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4768                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4769                 88  ST-OVRD-MEAN               VALUE '8'.
  4770                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4771             20  cf-st-extra-periods        pic 9.
  4772*            20  FILLER                     PIC X.
  4773
  4774         16  CF-ST-COMMISSION-CAPS.
  4775             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4776             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4777             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4778             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4779         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4780                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4781
  4782         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4783
  4784         16  CF-ST-STATUTORY-INTEREST.
  4785             20  CF-ST-STAT-DATE-FROM       PIC X.
  4786                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4787                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4788             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4789             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4790             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4791             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4792             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4793
  4794         16  CF-ST-OVER-SHORT.
  4795             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4796             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4797
  4798         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4799
  4800         16  CF-ST-RT-CALC                  PIC X.
  4801
  4802         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4803         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4804         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4805         16  CF-ST-RF-LR-CALC               PIC X.
  4806         16  CF-ST-RF-LL-CALC               PIC X.
  4807         16  CF-ST-RF-LN-CALC               PIC X.
  4808         16  CF-ST-RF-AH-CALC               PIC X.
  4809         16  CF-ST-RF-CP-CALC               PIC X.
  4810*        16  FILLER                         PIC X(206).
  4811*CIDMOD         16  FILLER                         PIC X(192).
  4812         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4813             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  92
* EL156.cbl
  4814         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4815         16  CF-ST-VFY-2ND-BENE             PIC X.
  4816         16  CF-ST-CAUSAL-STATE             PIC X.
  4817         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4818         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4819         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4820             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4821         16  CF-ST-NET-ONLY-STATE           PIC X.
  4822             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4823         16  FILLER                         PIC X(181).
  4824
  4825****************************************************************
  4826*             BENEFIT MASTER RECORD                            *
  4827****************************************************************
  4828
  4829     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4830         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4831             20  CF-BENEFIT-CODE            PIC XX.
  4832             20  CF-BENEFIT-NUMERIC  REDEFINES
  4833                 CF-BENEFIT-CODE            PIC XX.
  4834             20  CF-BENEFIT-ALPHA           PIC XXX.
  4835             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4836             20  CF-BENEFIT-COMMENT         PIC X(10).
  4837
  4838             20  CF-LF-COVERAGE-TYPE        PIC X.
  4839                 88  CF-REDUCING                VALUE 'R'.
  4840                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4841
  4842             20  CF-SPECIAL-CALC-CD         PIC X.
  4843                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4844                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4845                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4846                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4847                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4848                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4849                 88  CF-FARM-PLAN               VALUE 'F'.
  4850                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4851                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4852                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4853                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4854                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4855                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4856                 88  CF-PRUDENTIAL              VALUE 'P'.
  4857                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4858                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4859                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4860                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4861                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4862                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4863
  4864             20  CF-JOINT-INDICATOR         PIC X.
  4865                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4866
  4867*            20  FILLER                     PIC X(12).
  4868             20  cf-maximum-benefits        pic s999 comp-3.
  4869             20  FILLER                     PIC X(09).
  4870             20  CF-BENEFIT-CATEGORY        PIC X.
  4871             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  93
* EL156.cbl
  4872
  4873             20  CF-CO-REM-TERM-CALC        PIC X.
  4874                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4875                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4876                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4877                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4878                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4879
  4880             20  CF-CO-EARNINGS-CALC        PIC X.
  4881                 88  CO-EARN-BY-R78             VALUE '1'.
  4882                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4883                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4884                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4885                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4886                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4887                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4888                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4889
  4890             20  CF-CO-REFUND-CALC          PIC X.
  4891                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4892                 88  CO-REFD-BY-R78             VALUE '1'.
  4893                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4894                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4895                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4896                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4897                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4898                 88  CO-REFD-MEAN               VALUE '8'.
  4899                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4900                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4901                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4902
  4903             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4904                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4905                 88  CO-OVRD-BY-R78             VALUE '1'.
  4906                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4907                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4908                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4909                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4910                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4911                 88  CO-OVRD-MEAN               VALUE '8'.
  4912                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4913
  4914             20  CF-CO-BEN-I-G-CD           PIC X.
  4915                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4916                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4917                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4918
  4919         16  FILLER                         PIC X(304).
  4920
  4921
  4922****************************************************************
  4923*             CARRIER MASTER RECORD                            *
  4924****************************************************************
  4925
  4926     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4927         16  CF-ADDRESS-DATA.
  4928             20  CF-MAIL-TO-NAME            PIC X(30).
  4929             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  94
* EL156.cbl
  4930             20  CF-ADDRESS-LINE-1          PIC X(30).
  4931             20  CF-ADDRESS-LINE-2          PIC X(30).
  4932             20  CF-CITY-STATE              PIC X(30).
  4933             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4934             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4935
  4936         16  CF-CLAIM-NO-CONTROL.
  4937             20  CF-CLAIM-NO-METHOD         PIC X.
  4938                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4939                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4940                 88  CLAIM-NO-SEQ               VALUE '3'.
  4941                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4942             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4943                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4944                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4945                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4946
  4947         16  CF-CHECK-NO-CONTROL.
  4948             20  CF-CHECK-NO-METHOD         PIC X.
  4949                 88  CHECK-NO-MANUAL            VALUE '1'.
  4950                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4951                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4952                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4953             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4954                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4955
  4956         16  CF-DOMICILE-STATE              PIC XX.
  4957
  4958         16  CF-EXPENSE-CONTROLS.
  4959             20  CF-EXPENSE-METHOD          PIC X.
  4960                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4961                 88  DOLLARS-PER-PMT            VALUE '2'.
  4962                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4963                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4964             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4965             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4966
  4967         16  CF-CORRESPONDENCE-CONTROL.
  4968             20  CF-LETTER-RESEND-OPT       PIC X.
  4969                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4970                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4971             20  FILLER                     PIC X(4).
  4972
  4973         16  CF-RESERVE-CONTROLS.
  4974             20  CF-MANUAL-SW               PIC X.
  4975                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4976             20  CF-FUTURE-SW               PIC X.
  4977                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4978             20  CF-PTC-SW                  PIC X.
  4979                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4980             20  CF-IBNR-SW                 PIC X.
  4981                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4982             20  CF-PTC-LF-SW               PIC X.
  4983                 88  CF-LF-PTC-USED             VALUE '1'.
  4984             20  CF-CDT-ACCESS-METHOD       PIC X.
  4985                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4986                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4987                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  95
* EL156.cbl
  4988             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4989
  4990         16  CF-CLAIM-CALC-METHOD           PIC X.
  4991             88  360-PLUS-MONTHS                VALUE '1'.
  4992             88  365-PLUS-MONTHS                VALUE '2'.
  4993             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4994             88  360-DAILY                      VALUE '4'.
  4995             88  365-DAILY                      VALUE '5'.
  4996
  4997         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4998         16  FILLER                         PIC X(11).
  4999
  5000         16  CF-LIMIT-AMOUNTS.
  5001             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5002             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5003             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5004             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5005             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5006             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5007             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5008             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5009             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5010             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5011
  5012         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5013         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5014         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5015
  5016         16  CF-ZIP-CODE.
  5017             20  CF-ZIP-PRIME.
  5018                 24  CF-ZIP-1ST             PIC X.
  5019                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5020                 24  FILLER                 PIC X(4).
  5021             20  CF-ZIP-PLUS4               PIC X(4).
  5022         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5023             20  CF-CAN-POSTAL-1            PIC XXX.
  5024             20  CF-CAN-POSTAL-2            PIC XXX.
  5025             20  FILLER                     PIC XXX.
  5026
  5027         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5028         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5029         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5030
  5031         16  CF-RATING-SWITCH               PIC X.
  5032             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5033             88  CF-NO-RATING                   VALUE 'N'.
  5034
  5035         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5036
  5037         16  CF-CARRIER-OVER-SHORT.
  5038             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5039             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5040
  5041         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5042         16  CF-SECPAY-SWITCH               PIC X.
  5043             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5044             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5045         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  96
* EL156.cbl
  5046         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5047         16  FILLER                         PIC X(444).
  5048*        16  FILLER                         PIC X(452).
  5049
  5050
  5051****************************************************************
  5052*             MORTALITY MASTER RECORD                          *
  5053****************************************************************
  5054
  5055     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5056         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5057                                INDEXED BY CF-MORT-NDX.
  5058             20  CF-MORT-TABLE              PIC X(5).
  5059             20  CF-MORT-TABLE-TYPE         PIC X.
  5060                 88  CF-MORT-JOINT              VALUE 'J'.
  5061                 88  CF-MORT-SINGLE             VALUE 'S'.
  5062                 88  CF-MORT-COMBINED           VALUE 'C'.
  5063                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5064                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5065             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5066             20  CF-MORT-AGE-METHOD         PIC XX.
  5067                 88  CF-AGE-LAST                VALUE 'AL'.
  5068                 88  CF-AGE-NEAR                VALUE 'AN'.
  5069             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5070             20  CF-MORT-ADJUSTMENT-DIRECTION
  5071                                            PIC X.
  5072                 88  CF-MINUS                   VALUE '-'.
  5073                 88  CF-PLUS                    VALUE '+'.
  5074             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5075             20  CF-MORT-JOINT-CODE         PIC X.
  5076                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5077             20  CF-MORT-PC-Q               PIC X.
  5078                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5079             20  CF-MORT-TABLE-CODE         PIC X(4).
  5080             20  CF-MORT-COMMENTS           PIC X(15).
  5081             20  FILLER                     PIC X(14).
  5082
  5083         16  FILLER                         PIC X(251).
  5084
  5085
  5086****************************************************************
  5087*             BUSSINESS TYPE MASTER RECORD                     *
  5088****************************************************************
  5089
  5090     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5091* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5092* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5093* AND RECORD 05 IS TYPES 81-99
  5094         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5095             20  CF-BUSINESS-TITLE          PIC  X(19).
  5096             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5097                                            PIC S9V9(4) COMP-3.
  5098             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5099             20  FILLER                     PIC  X.
  5100         16  FILLER                         PIC  X(248).
  5101
  5102
  5103****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  97
* EL156.cbl
  5104*             TERMINAL MASTER RECORD                           *
  5105****************************************************************
  5106
  5107     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5108
  5109         16  CF-COMPANY-TERMINALS.
  5110             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5111                                  PIC X(4).
  5112         16  FILLER               PIC X(248).
  5113
  5114
  5115****************************************************************
  5116*             LIFE EDIT MASTER RECORD                          *
  5117****************************************************************
  5118
  5119     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5120         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5121             20  CF-LIFE-CODE-IN            PIC XX.
  5122             20  CF-LIFE-CODE-OUT           PIC XX.
  5123         16  FILLER                         PIC X(248).
  5124
  5125
  5126****************************************************************
  5127*             AH EDIT MASTER RECORD                            *
  5128****************************************************************
  5129
  5130     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5131         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5132             20  CF-AH-CODE-IN              PIC XXX.
  5133             20  CF-AH-CODE-OUT             PIC XX.
  5134         16  FILLER                         PIC X(248).
  5135
  5136
  5137****************************************************************
  5138*             CREDIBILITY TABLES                               *
  5139****************************************************************
  5140
  5141     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5142         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5143                             INDEXED BY CF-CRDB-NDX.
  5144             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5145             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5146             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5147         16  FILLER                         PIC  X(332).
  5148
  5149
  5150****************************************************************
  5151*             REPORT CUSTOMIZATION RECORD                      *
  5152****************************************************************
  5153
  5154     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5155         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5156             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5157             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5158             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5159**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5160****       A T-TRANSFER.                                   ****
  5161             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  98
* EL156.cbl
  5162
  5163         16  FILLER                         PIC XX.
  5164
  5165         16  CF-CARRIER-CNTL-OPT.
  5166             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5167                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5168                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5169             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5170                                            PIC X.
  5171         16  CF-GROUP-CNTL-OPT.
  5172             20  CF-GROUP-OPT-SEQ           PIC 9.
  5173                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5174                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5175             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5176                                            PIC X(6).
  5177         16  CF-STATE-CNTL-OPT.
  5178             20  CF-STATE-OPT-SEQ           PIC 9.
  5179                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5180                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5181             20  CF-STATE-SELECT OCCURS 3 TIMES
  5182                                            PIC XX.
  5183         16  CF-ACCOUNT-CNTL-OPT.
  5184             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5185                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5186                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5187             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5188                                            PIC X(10).
  5189         16  CF-BUS-TYP-CNTL-OPT.
  5190             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5191                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5192                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5193             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5194                                            PIC XX.
  5195         16  CF-LF-TYP-CNTL-OPT.
  5196             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5197                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5198                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5199             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5200                                            PIC XX.
  5201         16  CF-AH-TYP-CNTL-OPT.
  5202             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5203                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5204                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5205             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5206                                            PIC XX.
  5207         16  CF-REPTCD1-CNTL-OPT.
  5208             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5209                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5210                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5211             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5212                                            PIC X(10).
  5213         16  CF-REPTCD2-CNTL-OPT.
  5214             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5215                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5216                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5217             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5218                                            PIC X(10).
  5219         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page  99
* EL156.cbl
  5220             20  CF-USER1-OPT-SEQ           PIC 9.
  5221                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5222                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5223             20  CF-USER1-SELECT OCCURS 3 TIMES
  5224                                            PIC X(10).
  5225         16  CF-USER2-CNTL-OPT.
  5226             20  CF-USER2-OPT-SEQ           PIC 9.
  5227                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5228                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5229             20  CF-USER2-SELECT OCCURS 3 TIMES
  5230                                            PIC X(10).
  5231         16  CF-USER3-CNTL-OPT.
  5232             20  CF-USER3-OPT-SEQ           PIC 9.
  5233                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5234                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5235             20  CF-USER3-SELECT OCCURS 3 TIMES
  5236                                            PIC X(10).
  5237         16  CF-USER4-CNTL-OPT.
  5238             20  CF-USER4-OPT-SEQ           PIC 9.
  5239                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5240                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5241             20  CF-USER4-SELECT OCCURS 3 TIMES
  5242                                            PIC X(10).
  5243         16  CF-USER5-CNTL-OPT.
  5244             20  CF-USER5-OPT-SEQ           PIC 9.
  5245                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5246                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5247             20  CF-USER5-SELECT OCCURS 3 TIMES
  5248                                            PIC X(10).
  5249         16  CF-REINS-CNTL-OPT.
  5250             20  CF-REINS-OPT-SEQ           PIC 9.
  5251                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5252                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5253             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5254                 24  CF-REINS-PRIME         PIC XXX.
  5255                 24  CF-REINS-SUB           PIC XXX.
  5256
  5257         16  CF-AGENT-CNTL-OPT.
  5258             20  CF-AGENT-OPT-SEQ           PIC 9.
  5259                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5260                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5261             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5262                                            PIC X(10).
  5263
  5264         16  FILLER                         PIC X(43).
  5265
  5266         16  CF-LOSS-RATIO-SELECT.
  5267             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5268             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5269         16  CF-ENTRY-DATE-SELECT.
  5270             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5271             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5272         16  CF-EFFECTIVE-DATE-SELECT.
  5273             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5274             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5275
  5276         16  CF-EXCEPTION-LIST-IND          PIC X.
  5277             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 100
* EL156.cbl
  5278
  5279         16  FILLER                         PIC X(318).
  5280
  5281****************************************************************
  5282*                  EXCEPTION REPORTING RECORD                  *
  5283****************************************************************
  5284
  5285     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5286         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5287             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5288
  5289         16  CF-COMBINED-LIFE-AH-OPT.
  5290             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5291             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5292             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5293             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5294
  5295         16  CF-LIFE-OPT.
  5296             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5297             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5298             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5299             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5300             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5301             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5302             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5303             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5304             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5305             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5306
  5307         16  CF-AH-OPT.
  5308             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5309             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5310             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5311             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5312             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5313             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5314             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5315             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5316             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5317             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5318
  5319         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5320             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5321             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5322             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5323
  5324         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5325
  5326         16  FILLER                         PIC X(673).
  5327
  5328
  5329****************************************************************
  5330*             MORTGAGE SYSTEM PLAN RECORD                      *
  5331****************************************************************
  5332
  5333     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5334         16  CF-PLAN-TYPE                   PIC X.
  5335             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 101
* EL156.cbl
  5336             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5337             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5338         16  CF-PLAN-ABBREV                 PIC XXX.
  5339         16  CF-PLAN-DESCRIPT               PIC X(10).
  5340         16  CF-PLAN-NOTES                  PIC X(20).
  5341         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5342         16  CF-PLAN-UNDERWRITING.
  5343             20  CF-PLAN-TERM-DATA.
  5344                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5345                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5346             20  CF-PLAN-AGE-DATA.
  5347                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5348                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5349                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5350             20  CF-PLAN-BENEFIT-DATA.
  5351                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5352                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5353                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5354                                            PIC S9(7)V99  COMP-3.
  5355         16  CF-PLAN-POLICY-FORMS.
  5356             20  CF-POLICY-FORM             PIC X(12).
  5357             20  CF-MASTER-APPLICATION      PIC X(12).
  5358             20  CF-MASTER-POLICY           PIC X(12).
  5359         16  CF-PLAN-RATING.
  5360             20  CF-RATE-CODE               PIC X(5).
  5361             20  CF-SEX-RATING              PIC X.
  5362                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5363                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5364             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5365             20  CF-SUB-STD-TYPE            PIC X.
  5366                 88  CF-PCT-OF-PREM            VALUE '1'.
  5367                 88  CF-PCT-OF-BENE            VALUE '2'.
  5368         16  CF-PLAN-PREM-TOLERANCES.
  5369             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5370             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5371         16  CF-PLAN-PYMT-TOLERANCES.
  5372             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5373             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5374         16  CF-PLAN-MISC-DATA.
  5375             20  FILLER                     PIC X.
  5376             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5377             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5378         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5379         16  CF-PLAN-IND-GRP                PIC X.
  5380             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5381                                                     '1'.
  5382             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5383                                                     '2'.
  5384         16  CF-MIB-SEARCH-SW               PIC X.
  5385             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5386             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5387             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5388             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5389         16  CF-ALPHA-SEARCH-SW             PIC X.
  5390             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5391             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5392             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5393             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 102
* EL156.cbl
  5394             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5395             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5396             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5397             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5398             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5399             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5400                                                     'A' 'B' 'C'
  5401                                                     'X' 'Y' 'Z'.
  5402         16  CF-EFF-DT-RULE-SW              PIC X.
  5403             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5404             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5405             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5406             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5407             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5408         16  FILLER                         PIC X(4).
  5409         16  CF-HEALTH-QUESTIONS            PIC X.
  5410             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5411         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5412         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5413         16  CF-PLAN-SNGL-JNT               PIC X.
  5414             88  CF-COMBINED-PLAN              VALUE 'C'.
  5415             88  CF-JNT-PLAN                   VALUE 'J'.
  5416             88  CF-SNGL-PLAN                  VALUE 'S'.
  5417         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5418         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5419         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5420         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5421         16  CF-RERATE-CNTL                 PIC  X.
  5422             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5423             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5424             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5425             88  CF-AUTO-RECALC                 VALUE '4'.
  5426         16  CF-BENEFIT-TYPE                PIC  X.
  5427             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5428             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5429         16  CF-POLICY-FEE                  PIC S999V99
  5430                                                    COMP-3.
  5431         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5432         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5433         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5434         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5435         16  FILLER                         PIC  X(32).
  5436         16  CF-TERMINATION-FORM            PIC  X(04).
  5437         16  FILLER                         PIC  X(08).
  5438         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5439                                                       COMP-3.
  5440         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5441         16  CF-ISSUE-LETTER                PIC  X(4).
  5442         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5443         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5444             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5445             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5446         16  CF-MP-REFUND-CALC              PIC X.
  5447             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5448             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5449             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5450             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5451             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 103
* EL156.cbl
  5452             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5453             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5454             88  CF-MP-REFD-MEAN                VALUE '8'.
  5455         16  CF-ALT-RATE-CODE               PIC  X(5).
  5456
  5457
  5458         16  FILLER                         PIC X(498).
  5459****************************************************************
  5460*             MORTGAGE COMPANY MASTER RECORD                   *
  5461****************************************************************
  5462
  5463     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5464         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5465         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5466             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5467             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5468             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5469             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5470             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5471
  5472         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5473         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5474         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5475         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5476         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5477
  5478         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5479             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5480         16  CF-MP-RECON-USE-IND            PIC X(1).
  5481             88  CF-MP-USE-RECON             VALUE 'Y'.
  5482         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5483             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5484         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5485             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5486             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5487         16  FILLER                         PIC X(1).
  5488         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5489             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5490         16  CF-MORTG-MIB-VERSION           PIC X.
  5491             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5492             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5493             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5494         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5495             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5496                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5497             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5498                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5499             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5500                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5501             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5502                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5503             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5504                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5505             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5506                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5507         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5508         16  FILLER                         PIC X(7).
  5509         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 104
* EL156.cbl
  5510             20  CF-MORTG-MIB-COMM          PIC X(5).
  5511             20  CF-MORTG-MIB-TERM          PIC X(5).
  5512         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5513             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5514         16  FILLER                         PIC X(03).
  5515         16  CF-MP-CHECK-NO-CONTROL.
  5516             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5517                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5518                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5519                                                ' ' LOW-VALUES.
  5520                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5521                                               VALUE '3'.
  5522         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5523         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5524         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5525             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5526                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5527             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5528                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5529             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5530                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5531             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5532                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5533             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5534                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5535             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5536                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5537         16  CF-MORTG-BILLING-AREA.
  5538             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5539                                            PIC X.
  5540         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5541         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5542         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5543         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5544             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5545             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5546         16  FILLER                         PIC X.
  5547         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5548             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5549             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5550         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5551         16  FILLER                         PIC X(8).
  5552         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5553         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5554         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5555         16  CF-ACH-COMPANY-ID.
  5556             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5557                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5558                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5559                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5560             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5561         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5562             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5563         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5564             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5565             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5566         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5567         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 105
* EL156.cbl
  5568         16  FILLER                         PIC X(536).
  5569
  5570****************************************************************
  5571*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5572****************************************************************
  5573
  5574     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5575         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5576             20  CF-FEMALE-HEIGHT.
  5577                 24  CF-FEMALE-FT           PIC 99.
  5578                 24  CF-FEMALE-IN           PIC 99.
  5579             20  CF-FEMALE-MIN-WT           PIC 999.
  5580             20  CF-FEMALE-MAX-WT           PIC 999.
  5581         16  FILLER                         PIC X(428).
  5582
  5583     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5584         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5585             20  CF-MALE-HEIGHT.
  5586                 24  CF-MALE-FT             PIC 99.
  5587                 24  CF-MALE-IN             PIC 99.
  5588             20  CF-MALE-MIN-WT             PIC 999.
  5589             20  CF-MALE-MAX-WT             PIC 999.
  5590         16  FILLER                         PIC X(428).
  5591******************************************************************
  5592*             AUTOMATIC ACTIVITY RECORD                          *
  5593******************************************************************
  5594     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5595         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5596             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5597             20  CF-SYS-LETTER-ID           PIC X(04).
  5598             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5599             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5600             20  CF-SYS-RESET-SW            PIC X(01).
  5601             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5602             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5603
  5604         16  FILLER                         PIC X(50).
  5605
  5606         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5607             20  CF-USER-ACTIVE-SW          PIC X(01).
  5608             20  CF-USER-LETTER-ID          PIC X(04).
  5609             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5610             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5611             20  CF-USER-RESET-SW           PIC X(01).
  5612             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5613             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5614             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5615
  5616         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 106
* EL156.cbl
  5618*    COPY ELCCERT.
  5619******************************************************************
  5620*                                                                *
  5621*                            ELCCERT.                            *
  5622*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5623*                            VMOD=2.013                          *
  5624*                                                                *
  5625*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5626*                                                                *
  5627*   FILE TYPE = VSAM,KSDS                                        *
  5628*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5629*                                                                *
  5630*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5631*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5632*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5633*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5634*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5635*                                                                *
  5636*   LOG = YES                                                    *
  5637*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5638******************************************************************
  5639*                   C H A N G E   L O G
  5640*
  5641* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5642*-----------------------------------------------------------------
  5643*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5644* EFFECTIVE    NUMBER
  5645*-----------------------------------------------------------------
  5646* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5647* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5648* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5649* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5650* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5651* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5652* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5653* 032612  CR2011110200001  PEMA  AHL CHANGES
  5654* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5655******************************************************************
  5656
  5657 01  CERTIFICATE-MASTER.
  5658     12  CM-RECORD-ID                      PIC XX.
  5659         88  VALID-CM-ID                      VALUE 'CM'.
  5660
  5661     12  CM-CONTROL-PRIMARY.
  5662         16  CM-COMPANY-CD                 PIC X.
  5663         16  CM-CARRIER                    PIC X.
  5664         16  CM-GROUPING.
  5665             20  CM-GROUPING-PREFIX        PIC X(3).
  5666             20  CM-GROUPING-PRIME         PIC X(3).
  5667         16  CM-STATE                      PIC XX.
  5668         16  CM-ACCOUNT.
  5669             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5670             20  CM-ACCOUNT-PRIME          PIC X(6).
  5671         16  CM-CERT-EFF-DT                PIC XX.
  5672         16  CM-CERT-NO.
  5673             20  CM-CERT-PRIME             PIC X(10).
  5674             20  CM-CERT-SFX               PIC X.
  5675
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 107
* EL156.cbl
  5676     12  CM-CONTROL-BY-NAME.
  5677         16  CM-COMPANY-CD-A1              PIC X.
  5678         16  CM-INSURED-LAST-NAME          PIC X(15).
  5679         16  CM-INSURED-INITIALS.
  5680             20  CM-INSURED-INITIAL1       PIC X.
  5681             20  CM-INSURED-INITIAL2       PIC X.
  5682
  5683     12  CM-CONTROL-BY-SSN.
  5684         16  CM-COMPANY-CD-A2              PIC X.
  5685         16  CM-SOC-SEC-NO.
  5686             20  CM-SSN-STATE              PIC XX.
  5687             20  CM-SSN-ACCOUNT            PIC X(6).
  5688             20  CM-SSN-LN3.
  5689                 25  CM-INSURED-INITIALS-A2.
  5690                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5691                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5692                 25 CM-PART-LAST-NAME-A2         PIC X.
  5693
  5694     12  CM-CONTROL-BY-CERT-NO.
  5695         16  CM-COMPANY-CD-A4              PIC X.
  5696         16  CM-CERT-NO-A4                 PIC X(11).
  5697
  5698     12  CM-CONTROL-BY-MEMB.
  5699         16  CM-COMPANY-CD-A5              PIC X.
  5700         16  CM-MEMBER-NO.
  5701             20  CM-MEMB-STATE             PIC XX.
  5702             20  CM-MEMB-ACCOUNT           PIC X(6).
  5703             20  CM-MEMB-LN4.
  5704                 25  CM-INSURED-INITIALS-A5.
  5705                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5706                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5707                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5708
  5709     12  CM-INSURED-PROFILE-DATA.
  5710         16  CM-INSURED-FIRST-NAME.
  5711             20  CM-INSURED-1ST-INIT       PIC X.
  5712             20  FILLER                    PIC X(9).
  5713         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5714         16  CM-INSURED-SEX                PIC X.
  5715             88  CM-SEX-MALE                  VALUE 'M'.
  5716             88  CM-SEX-FEMAL                 VALUE 'F'.
  5717         16  CM-INSURED-JOINT-AGE          PIC 99.
  5718         16  CM-JOINT-INSURED-NAME.
  5719             20  CM-JT-LAST-NAME           PIC X(15).
  5720             20  CM-JT-FIRST-NAME.
  5721                 24  CM-JT-1ST-INIT        PIC X.
  5722                 24  FILLER                PIC X(9).
  5723             20  CM-JT-INITIAL             PIC X.
  5724
  5725     12  CM-LIFE-DATA.
  5726         16  CM-LF-BENEFIT-CD              PIC XX.
  5727         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5728         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5729         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5730         16  CM-LF-DEV-CODE                PIC XXX.
  5731         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5732         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5733         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 108
* EL156.cbl
  5734         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5735         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5736         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5737         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5738         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5739         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5740         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5741         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5742         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5743         16  cm-temp-epiq                  pic xx.
  5744             88  EPIQ-CLASS                  value 'EQ'.
  5745*        16  FILLER                        PIC XX.
  5746
  5747     12  CM-AH-DATA.
  5748         16  CM-AH-BENEFIT-CD              PIC XX.
  5749         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5750         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5751         16  CM-AH-DEV-CODE                PIC XXX.
  5752         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5753         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5754         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5755         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5756         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5757         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5758         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5759         16  CM-AH-PAID-THRU-DT            PIC XX.
  5760             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5761         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5762         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5763         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5764         16  FILLER                        PIC X.
  5765
  5766     12  CM-LOAN-INFORMATION.
  5767         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5768         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5769                                           PIC S9(5)V99  COMP-3.
  5770         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5771         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5772         16  CM-PAY-FREQUENCY              PIC S99.
  5773         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5774         16  CM-RATE-CLASS                 PIC XX.
  5775         16  CM-BENEFICIARY                PIC X(25).
  5776         16  CM-POLICY-FORM-NO             PIC X(12).
  5777         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5778         16  CM-LAST-ADD-ON-DT             PIC XX.
  5779         16  CM-DEDUCTIBLE-AMOUNTS.
  5780             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5781             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5782         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5783             20  CM-RESIDENT-STATE         PIC XX.
  5784             20  CM-RATE-CODE              PIC X(4).
  5785             20  FILLER                    PIC XX.
  5786         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5787             20  CM-LOAN-OFFICER           PIC X(5).
  5788             20  FILLER                    PIC XXX.
  5789         16  CM-CSR-CODE                   PIC XXX.
  5790         16  CM-UNDERWRITING-CODE          PIC X.
  5791             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 109
* EL156.cbl
  5792         16  CM-POST-CARD-IND              PIC X.
  5793         16  CM-NH-INTERFACE-SW            PIC X.
  5794         16  CM-PREMIUM-TYPE               PIC X.
  5795             88  CM-SING-PRM                  VALUE '1'.
  5796             88  CM-O-B-COVERAGE              VALUE '2'.
  5797             88  CM-OPEN-END                  VALUE '3'.
  5798         16  CM-IND-GRP-TYPE               PIC X.
  5799             88  CM-INDIVIDUAL                VALUE 'I'.
  5800             88  CM-GROUP                     VALUE 'G'.
  5801         16  CM-SKIP-CODE                  PIC X.
  5802             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5803             88  SKIP-JULY                    VALUE '1'.
  5804             88  SKIP-AUGUST                  VALUE '2'.
  5805             88  SKIP-SEPTEMBER               VALUE '3'.
  5806             88  SKIP-JULY-AUG                VALUE '4'.
  5807             88  SKIP-AUG-SEPT                VALUE '5'.
  5808             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5809             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5810             88  SKIP-JUNE                    VALUE '8'.
  5811             88  SKIP-JUNE-JULY               VALUE '9'.
  5812             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5813             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5814         16  CM-PAYMENT-MODE               PIC X.
  5815             88  PAY-MONTHLY                  VALUE SPACE.
  5816             88  PAY-WEEKLY                   VALUE '1'.
  5817             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5818             88  PAY-BI-WEEKLY                VALUE '3'.
  5819             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5820         16  CM-LOAN-NUMBER                PIC X(8).
  5821         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5822         16  CM-OLD-LOF                    PIC XXX.
  5823*        16  CM-LOAN-OFFICER               PIC XXX.
  5824         16  CM-REIN-TABLE                 PIC XXX.
  5825         16  CM-SPECIAL-REIN-CODE          PIC X.
  5826         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5827         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5828         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5829
  5830     12  CM-STATUS-DATA.
  5831         16  CM-ENTRY-STATUS               PIC X.
  5832         16  CM-ENTRY-DT                   PIC XX.
  5833
  5834         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5835         16  CM-LF-CANCEL-DT               PIC XX.
  5836         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5837
  5838         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5839         16  CM-LF-DEATH-DT                PIC XX.
  5840         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5841
  5842         16  CM-LF-CURRENT-STATUS          PIC X.
  5843             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5844                                                'M' '4' '5' '9'.
  5845             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5846             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5847             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5848             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5849             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 110
* EL156.cbl
  5850             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5851             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5852             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5853             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5854             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5855             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5856             88  CM-LF-DECLINED               VALUE 'D'.
  5857             88  CM-LF-VOIDED                 VALUE 'V'.
  5858
  5859         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5860         16  CM-AH-CANCEL-DT               PIC XX.
  5861         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5862
  5863         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5864         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5865         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5866
  5867         16  CM-AH-CURRENT-STATUS          PIC X.
  5868             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5869                                                'M' '4' '5' '9'.
  5870             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5871             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5872             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5873             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5874             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5875             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5876             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5877             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5878             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5879             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5880             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5881             88  CM-AH-DECLINED               VALUE 'D'.
  5882             88  CM-AH-VOIDED                 VALUE 'V'.
  5883
  5884         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5885             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5886             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5887             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5888         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5889
  5890         16  CM-ENTRY-BATCH                PIC X(6).
  5891         16  CM-LF-EXIT-BATCH              PIC X(6).
  5892         16  CM-AH-EXIT-BATCH              PIC X(6).
  5893         16  CM-LAST-MONTH-END             PIC XX.
  5894
  5895     12  CM-NOTE-SW                        PIC X.
  5896         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5897         88  CERT-NOTES-PRESENT               VALUE '1'.
  5898         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5899         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5900         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5901         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5902         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5903         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5904     12  CM-COMP-EXCP-SW                   PIC X.
  5905         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5906         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5907     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 111
* EL156.cbl
  5908         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5909         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5910
  5911*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5912     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5913     12  FILLER                            PIC X.
  5914
  5915*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5916     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5917     12  FILLER                            PIC X.
  5918*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5919     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5920
  5921     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5922         88  CERT-ADDED-BATCH                 VALUE ' '.
  5923         88  CERT-ADDED-ONLINE                VALUE '1'.
  5924         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5925         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5926         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5927     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5928         88  CERT-AS-LOADED                   VALUE ' '.
  5929         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5930         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5931         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5932         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5933         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5934         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5935         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5936
  5937     12  CM-ACCOUNT-COMM-PCTS.
  5938         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5939         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5940
  5941     12  CM-USER-FIELD                     PIC X.
  5942     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5943     12  CM-CLP-STATE                      PIC XX.
  5944     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5945     12  CM-USER-RESERVED                  PIC XXX.
  5946     12  FILLER REDEFINES CM-USER-RESERVED.
  5947         16  CM-AH-CLASS-CD                PIC XX.
  5948         16  F                             PIC X.
  5949******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 112
* EL156.cbl
  5951*    COPY ELCTRLR.
  5952******************************************************************
  5953*                                                                *
  5954*                            ELCTRLR.                            *
  5955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5956*                            VMOD=2.014                          *
  5957*                                                                *
  5958*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5959*                                                                *
  5960*   FILE TYPE = VSAM,KSDS                                        *
  5961*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5962*                                                                *
  5963*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5964*       ALTERNATE INDEX = NONE                                   *
  5965*                                                                *
  5966*   LOG = YES                                                    *
  5967*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5968******************************************************************
  5969*                   C H A N G E   L O G
  5970*
  5971* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5972*-----------------------------------------------------------------
  5973*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5974* EFFECTIVE    NUMBER
  5975*-----------------------------------------------------------------
  5976* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5977* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5978* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5979* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5980* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5981* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5982* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5983* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5984* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5985* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5986* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5987* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5988* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5989* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5990* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5991* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5992* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5993* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5994* 040814    2014030500002  AJRA  ADD ICD CODES
  5995* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5996******************************************************************
  5997 01  ACTIVITY-TRAILERS.
  5998     12  AT-RECORD-ID                    PIC XX.
  5999         88  VALID-AT-ID                       VALUE 'AT'.
  6000
  6001     12  AT-CONTROL-PRIMARY.
  6002         16  AT-COMPANY-CD               PIC X.
  6003         16  AT-CARRIER                  PIC X.
  6004         16  AT-CLAIM-NO                 PIC X(7).
  6005         16  AT-CERT-NO.
  6006             20  AT-CERT-PRIME           PIC X(10).
  6007             20  AT-CERT-SFX             PIC X.
  6008         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 113
* EL156.cbl
  6009             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6010             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6011             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6012             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6013             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6014             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6015             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6016             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6017             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6018             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6019             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6020             88  AT-BENEFICIARY-TRL           VALUE +91.
  6021             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6022             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6023             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6024             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6025
  6026     12  AT-TRAILER-TYPE                 PIC X.
  6027         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6028         88  PAYMENT-TR                       VALUE '2'.
  6029         88  AUTO-PAY-TR                      VALUE '3'.
  6030         88  CORRESPONDENCE-TR                VALUE '4'.
  6031         88  ADDRESS-TR                       VALUE '5'.
  6032         88  GENERAL-INFO-TR                  VALUE '6'.
  6033         88  AUTO-PROMPT-TR                   VALUE '7'.
  6034         88  DENIAL-TR                        VALUE '8'.
  6035         88  INCURRED-CHG-TR                  VALUE '9'.
  6036         88  FORM-CONTROL-TR                  VALUE 'A'.
  6037
  6038     12  AT-RECORDED-DT                  PIC XX.
  6039     12  AT-RECORDED-BY                  PIC X(4).
  6040     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6041
  6042     12  AT-TRAILER-BODY                 PIC X(165).
  6043
  6044     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6045         16  AT-RESERVE-CONTROLS.
  6046             20  AT-MANUAL-SW            PIC X.
  6047                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6048             20  AT-FUTURE-SW            PIC X.
  6049                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6050             20  AT-PTC-SW               PIC X.
  6051                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6052             20  AT-IBNR-SW              PIC X.
  6053                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6054             20  AT-PTC-LF-SW            PIC X.
  6055                 88  AT-LF-PTC-USED          VALUE '1'.
  6056             20  AT-CDT-ACCESS-METHOD    PIC X.
  6057                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6058                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6059                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6060             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6061         16  AT-LAST-COMPUTED-DT         PIC XX.
  6062         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6063         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6064         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6065         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6066         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 114
* EL156.cbl
  6067         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6068         16  AT-EXPENSE-CONTROLS.
  6069             20  AT-EXPENSE-METHOD       PIC X.
  6070                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6071                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6072                 88  PERCENT-OF-PMT           VALUE '3'.
  6073                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6074             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6075             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6076         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6077         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6078
  6079         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6080         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6081
  6082*        16  FILLER                      PIC X(53).
  6083         16  FILLER                      PIC X(47).
  6084
  6085         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6086         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6087
  6088         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6089             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6090             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6091*                    C = CLOSED
  6092*                    O = OPEN
  6093             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6094*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6095
  6096     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6097         16  AT-PAYMENT-TYPE             PIC X.
  6098             88  PARTIAL-PAYMENT                VALUE '1'.
  6099             88  FINAL-PAYMENT                  VALUE '2'.
  6100             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6101             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6102             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6103             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6104             88  VOIDED-PAYMENT                 VALUE '9'.
  6105             88  TRANSFER                       VALUE 'T'.
  6106             88  LIFE-INTEREST                  VALUE 'I'.
  6107
  6108         16  AT-CLAIM-TYPE               PIC X.
  6109             88  PAID-FOR-AH                    VALUE 'A'.
  6110             88  PAID-FOR-LIFE                  VALUE 'L'.
  6111             88  PAID-FOR-IUI                   VALUE 'I'.
  6112             88  PAID-FOR-GAP                   VALUE 'G'.
  6113             88  PAID-FOR-FAM                   VALUE 'F'.
  6114         16  AT-CLAIM-PREM-TYPE          PIC X.
  6115             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6116             88  AT-O-B-COVERAGE                VALUE '2'.
  6117             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6118         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6119         16  AT-CHECK-NO                 PIC X(7).
  6120         16  AT-PAID-FROM-DT             PIC XX.
  6121         16  AT-PAID-THRU-DT             PIC XX.
  6122         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6123         16  FILLER                      PIC X.
  6124         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 115
* EL156.cbl
  6125         16  AT-PAYMENT-ORIGIN           PIC X.
  6126             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6127             88  ONLINE-AUTO-PMT                VALUE '2'.
  6128             88  OFFLINE-PMT                    VALUE '3'.
  6129         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6130         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6131         16  AT-VOID-DATA.
  6132             20  AT-VOID-DT              PIC XX.
  6133*00144       20  AT-VOID-REASON          PIC X(30).
  6134             20  AT-VOID-REASON          PIC X(26).
  6135         16  AT-PMT-APPROVED-BY          PIC X(04).
  6136         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6137         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6138         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6139                                         PIC S99V9(5)  COMP-3.
  6140         16  AT-CREDIT-INTERFACE.
  6141             20  AT-PMT-SELECT-DT        PIC XX.
  6142                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6143             20  AT-PMT-ACCEPT-DT        PIC XX.
  6144                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6145             20  AT-VOID-SELECT-DT       PIC XX.
  6146                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6147             20  AT-VOID-ACCEPT-DT       PIC XX.
  6148                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6149
  6150         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6151                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6152                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6153         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6154
  6155         16  AT-FORCE-CONTROL            PIC X.
  6156             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6157         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6158         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6159         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6160         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6161         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6162         16  AT-BENEFIT-TYPE             PIC X.
  6163
  6164         16  AT-EXPENSE-TYPE             PIC X.
  6165         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6166
  6167         16  AT-PAYEE-TYPE-CD.
  6168             20  AT-PAYEE-TYPE           PIC X.
  6169                 88  INSURED-PAID           VALUE 'I'.
  6170                 88  BENEFICIARY-PAID       VALUE 'B'.
  6171                 88  ACCOUNT-PAID           VALUE 'A'.
  6172                 88  OTHER-1-PAID           VALUE 'O'.
  6173                 88  OTHER-2-PAID           VALUE 'Q'.
  6174                 88  DOCTOR-PAID            VALUE 'P'.
  6175                 88  EMPLOYER-PAID          VALUE 'E'.
  6176             20  AT-PAYEE-SEQ            PIC X.
  6177
  6178         16  AT-CASH-PAYMENT             PIC X.
  6179         16  AT-GROUPED-PAYMENT          PIC X.
  6180         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6181         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6182         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 116
* EL156.cbl
  6183         16  AT-VOID-TYPE                PIC X.
  6184             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6185             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6186         16  AT-AIG-UNEMP-IND            PIC X.
  6187             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6188         16  AT-ASSOCIATES               PIC X.
  6189             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6190             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6191
  6192         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6193         16  AT-CV-PMT-CODE              PIC X.
  6194             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6195             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6196             88  FULL-ADD-PAYMENT           VALUE '3'.
  6197             88  HALF-ADD-PAYMENT           VALUE '4'.
  6198             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6199             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6200             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6201             88  ADDL-PAYMENT               VALUE '8'.
  6202
  6203         16  AT-EOB-CODE1                PIC XXX.
  6204         16  AT-EOB-CODE2                PIC XXX.
  6205         16  AT-EOB-CODE3                PIC XXX.
  6206         16  FILLER REDEFINES AT-EOB-CODE3.
  6207             20  AT-PRINT-CLM-FORM       PIC X.
  6208             20  AT-PRINT-SURVEY         PIC X.
  6209             20  AT-SPECIAL-RELEASE      PIC X.
  6210         16  AT-EOB-CODE4                PIC XXX.
  6211         16  FILLER REDEFINES AT-EOB-CODE4.
  6212             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6213             20  FILLER                  PIC X.
  6214         16  AT-EOB-CODE5                PIC XXX.
  6215         16  FILLER REDEFINES AT-EOB-CODE5.
  6216             20  AT-PMT-PROOF-DT         PIC XX.
  6217             20  FILLER                  PIC X.
  6218
  6219         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6220             88  AT-PRINT-EOB            VALUE 'Y'.
  6221
  6222         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6223         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6224
  6225     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6226         16  AT-SCHEDULE-START-DT        PIC XX.
  6227         16  AT-SCHEDULE-END-DT          PIC XX.
  6228         16  AT-TERMINATED-DT            PIC XX.
  6229         16  AT-LAST-PMT-TYPE            PIC X.
  6230             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6231             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6232         16  AT-FIRST-PMT-DATA.
  6233             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6234             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6235             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6236         16  AT-REGULAR-PMT-DATA.
  6237             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6238             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6239             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6240         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 117
* EL156.cbl
  6241             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6242                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6243                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6244                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6245                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6246                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6247             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6248         16  AT-AUTO-PAY-DAY             PIC 99.
  6249         16  AT-AUTO-CASH                PIC X.
  6250             88  AT-CASH                      VALUE 'Y'.
  6251             88  AT-NON-CASH                  VALUE 'N'.
  6252*        16  FILLER                      PIC X(129).
  6253         16  AT-AUTO-END-LETTER          PIC X(4).
  6254         16  FILLER                      PIC X(125).
  6255
  6256         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6257         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6258
  6259     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6260         16  AT-LETTER-SENT-DT           PIC XX.
  6261         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6262         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6263         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6264         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6265         16  AT-LETTER-ORIGIN            PIC X.
  6266             88  ONLINE-CREATION              VALUE '1' '3'.
  6267             88  OFFLINE-CREATION             VALUE '2' '4'.
  6268             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6269             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6270         16  AT-STD-LETTER-FORM          PIC X(4).
  6271         16  AT-REASON-TEXT              PIC X(70).
  6272         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6273         16  AT-ADDRESEE-TYPE            PIC X.
  6274              88  INSURED-ADDRESEE            VALUE 'I'.
  6275              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6276              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6277              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6278              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6279              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6280              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6281         16  AT-ADDRESSEE-NAME           PIC X(30).
  6282         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6283         16  AT-RESEND-PRINT-DATE        PIC XX.
  6284         16  AT-CORR-SOL-UNSOL           PIC X.
  6285         16  AT-LETTER-PURGED-DT         PIC XX.
  6286*
  6287*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6288*
  6289         16  AT-CSO-REDEFINITION.
  6290             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6291             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6292             20  AT-LETTER-TO-BENE       PIC X(1).
  6293             20  AT-STOP-LETTER-DT       PIC X(2).
  6294             20  FILLER                  PIC X(19).
  6295*             20  FILLER                  PIC X(27).
  6296             20  AT-CSO-LETTER-STATUS    PIC X.
  6297                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6298                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 118
* EL156.cbl
  6299                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6300             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6301             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6302*
  6303*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6304*
  6305*        16  FILLER                      PIC X(26).
  6306*
  6307*        16  AT-DMD-BSR-CODE             PIC X.
  6308*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6309*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6310*
  6311*        16  AT-DMD-LETTER-STATUS        PIC X.
  6312*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6313*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6314*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6315*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6316*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6317
  6318         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6319         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6320
  6321     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6322         16  AT-ADDRESS-TYPE             PIC X.
  6323             88  INSURED-ADDRESS               VALUE 'I'.
  6324             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6325             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6326             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6327             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6328             88  OTHER-ADDRESS-1               VALUE 'O'.
  6329             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6330         16  AT-MAIL-TO-NAME             PIC X(30).
  6331         16  AT-ADDRESS-LINE-1           PIC X(30).
  6332         16  AT-ADDRESS-LINE-2           PIC X(30).
  6333         16  AT-CITY-STATE.
  6334             20  AT-CITY                 PIC X(28).
  6335             20  AT-STATE                PIC XX.
  6336         16  AT-ZIP.
  6337             20  AT-ZIP-CODE.
  6338                 24  AT-ZIP-1ST          PIC X.
  6339                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6340                 24  FILLER              PIC X(4).
  6341             20  AT-ZIP-PLUS4            PIC X(4).
  6342         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6343             20  AT-CAN-POSTAL-1         PIC XXX.
  6344             20  AT-CAN-POSTAL-2         PIC XXX.
  6345             20  FILLER                  PIC XXX.
  6346         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6347*         16  FILLER                      PIC X(23).
  6348         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6349         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6350         16  FILLER                      PIC X(13).
  6351         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6352         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6353
  6354     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6355         16  AT-INFO-LINE-1              PIC X(60).
  6356         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 119
* EL156.cbl
  6357             20  AT-NOTE-ERROR-NO OCCURS 15
  6358                                         PIC X(4).
  6359         16  AT-INFO-LINE-2              PIC X(60).
  6360         16  FILLER REDEFINES AT-INFO-LINE-2.
  6361             20  AT-ICD-CODE-1           PIC X(8).
  6362             20  AT-ICD-CODE-2           PIC X(8).
  6363             20  FILLER                  PIC X(44).
  6364         16  AT-INFO-TRAILER-TYPE        PIC X.
  6365             88  AT-ERRORS-NOTE          VALUE 'E'.
  6366             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6367             88  AT-CALL-NOTE            VALUE 'C'.
  6368             88  AT-MAINT-NOTE           VALUE 'M'.
  6369             88  AT-CERT-CHANGE          VALUE 'X'.
  6370             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6371             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6372             88  AT-CERT-CANCELLED       VALUE 'T'.
  6373         16  AT-CALL-TYPE                PIC X.
  6374             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6375             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6376         16  AT-NOTE-CONTINUATION        PIC X.
  6377             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6378         16  AT-EOB-CODES-EXIST          PIC X.
  6379             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6380         16  FILLER                      PIC X(35).
  6381         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6382         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6383
  6384     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6385         16  AT-PROMPT-LINE-1            PIC X(60).
  6386         16  AT-PROMPT-LINE-2            PIC X(60).
  6387         16  AT-PROMPT-START-DT          PIC XX.
  6388         16  AT-PROMPT-END-DT            PIC XX.
  6389         16  FILLER                      PIC X(35).
  6390         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6391         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6392
  6393     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6394         16  AT-DENIAL-INFO-1            PIC X(60).
  6395         16  AT-DENIAL-INFO-2            PIC X(60).
  6396         16  AT-DENIAL-DT                PIC XX.
  6397         16  AT-RETRACTION-DT            PIC XX.
  6398         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6399*         16  FILLER                      PIC X(31).
  6400         16  AT-DENIAL-PROOF-DT          PIC XX.
  6401         16  FILLER                      PIC X(29).
  6402         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6403         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6404
  6405     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6406         16  AT-OLD-INCURRED-DT          PIC XX.
  6407         16  AT-OLD-REPORTED-DT          PIC XX.
  6408         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6409         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6410         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6411         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6412         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6413         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6414         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 120
* EL156.cbl
  6415         16  AT-OLD-DIAG-CODE            PIC X(6).
  6416         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6417         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6418         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6419         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6420         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6421         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6422         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6423         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6424         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6425         16  FILLER                      PIC X(9).
  6426         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6427
  6428     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6429         16  AT-FORM-SEND-ON-DT          PIC XX.
  6430         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6431         16  AT-FORM-RE-SEND-DT          PIC XX.
  6432         16  AT-FORM-ANSWERED-DT         PIC XX.
  6433         16  AT-FORM-PRINTED-DT          PIC XX.
  6434         16  AT-FORM-REPRINT-DT          PIC XX.
  6435         16  AT-FORM-TYPE                PIC X.
  6436             88  INITIAL-FORM                  VALUE '1'.
  6437             88  PROGRESS-FORM                 VALUE '2'.
  6438         16  AT-INSTRUCT-LN-1            PIC X(28).
  6439         16  AT-INSTRUCT-LN-2            PIC X(28).
  6440         16  AT-INSTRUCT-LN-3            PIC X(28).
  6441         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6442         16  AT-FORM-ADDRESS             PIC X.
  6443             88  FORM-TO-INSURED              VALUE 'I'.
  6444             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6445             88  FORM-TO-OTHER-1              VALUE 'O'.
  6446             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6447         16  AT-RELATED-1.
  6448             20 AT-REL-CARR-1            PIC X.
  6449             20 AT-REL-CLAIM-1           PIC X(7).
  6450             20 AT-REL-CERT-1            PIC X(11).
  6451         16  AT-RELATED-2.
  6452             20 AT-REL-CARR-2            PIC X.
  6453             20 AT-REL-CLAIM-2           PIC X(7).
  6454             20 AT-REL-CERT-2            PIC X(11).
  6455         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6456         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6457         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6458         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6459         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6460         16  AT-STOP-FORM-DT             PIC X(2).
  6461
  6462         16  FILLER                      PIC X(09).
  6463         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6464         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6465******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 121
* EL156.cbl
  6467*    COPY ELCACTQ.
  6468******************************************************************
  6469*                                                                *
  6470*                            ELCACTQ.                            *
  6471*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6472*                            VMOD=2.004                          *
  6473*                                                                *
  6474*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6475*                                                                *
  6476*   FILE TYPE = VSAM,KSDS                                        *
  6477*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6478*                                                                *
  6479*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6480*       ALTERNATE INDEX = NONE                                   *
  6481*                                                                *
  6482*   LOG = YES                                                    *
  6483*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6484*                                                                *
  6485*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6486******************************************************************
  6487
  6488 01  ACTIVITY-QUE.
  6489     12  AQ-RECORD-ID                PIC XX.
  6490         88  VALID-AQ-ID                VALUE 'AQ'.
  6491
  6492     12  AQ-CONTROL-PRIMARY.
  6493         16  AQ-COMPANY-CD           PIC X.
  6494         16  AQ-CARRIER              PIC X.
  6495         16  AQ-CLAIM-NO             PIC X(7).
  6496         16  AQ-CERT-NO.
  6497             20  AQ-CERT-PRIME       PIC X(10).
  6498             20  AQ-CERT-SFX         PIC X.
  6499
  6500     12  AQ-PENDING-ACTIVITY-FLAGS.
  6501         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6502         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6503             88  PENDING-PAYMENTS       VALUE '1'.
  6504         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6505             88  PENDING-FULL-PRINT     VALUE '1'.
  6506             88  PENDING-PART-PRINT     VALUE '2'.
  6507         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6508             88  PENDING-LETTERS        VALUE '1'.
  6509         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6510             88  PENDING-RESTORE        VALUE 'C'.
  6511             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6512
  6513     12  FILLER                      PIC X(20).
  6514
  6515     12  AQ-RESEND-DATE              PIC XX.
  6516     12  AQ-FOLLOWUP-DATE            PIC XX.
  6517     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6518     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6519     12  AQ-AUTO-LETTER              PIC X(4).
  6520     12  FILLER                      PIC XX.
  6521     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6522*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 122
* EL156.cbl
  6524*    COPY ERCACCT.
  6525******************************************************************
  6526*                                                                *
  6527*                                                                *
  6528*                            ERCACCT                             *
  6529*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6530*                            VMOD=2.031                          *
  6531*                                                                *
  6532*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6533*                                                                *
  6534*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6535*   VSAM ACCOUNT MASTER FILES.                                   *
  6536*                                                                *
  6537*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6538*                                                                *
  6539*   FILE TYPE = VSAM,KSDS                                        *
  6540*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6541*                                                                *
  6542*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6543*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6544*                                                                *
  6545*   LOG = NO                                                     *
  6546*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6547*                                                                *
  6548*                                                                *
  6549******************************************************************
  6550*                   C H A N G E   L O G
  6551*
  6552* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6553*-----------------------------------------------------------------
  6554*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6555* EFFECTIVE    NUMBER
  6556*-----------------------------------------------------------------
  6557* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6558* 092705    2005050300006  PEMA  ADD SPP LEASES
  6559* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6560* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6561* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6562* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6563* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6564******************************************************************
  6565
  6566 01  ACCOUNT-MASTER.
  6567     12  AM-RECORD-ID                      PIC XX.
  6568         88  VALID-AM-ID                      VALUE 'AM'.
  6569
  6570     12  AM-CONTROL-PRIMARY.
  6571         16  AM-COMPANY-CD                 PIC X.
  6572         16  AM-MSTR-CNTRL.
  6573             20  AM-CONTROL-A.
  6574                 24  AM-CARRIER            PIC X.
  6575                 24  AM-GROUPING.
  6576                     28 AM-GROUPING-PREFIX PIC XXX.
  6577                     28 AM-GROUPING-PRIME  PIC XXX.
  6578                 24  AM-STATE              PIC XX.
  6579                 24  AM-ACCOUNT.
  6580                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6581                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 123
* EL156.cbl
  6582             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6583                                           PIC X(19).
  6584             20  AM-CNTRL-B.
  6585                 24  AM-EXPIRATION-DT      PIC XX.
  6586                 24  FILLER                PIC X(4).
  6587             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6588                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6589
  6590     12  AM-CONTROL-BY-VAR-GRP.
  6591         16  AM-COMPANY-CD-A1              PIC X.
  6592         16  AM-VG-CARRIER                 PIC X.
  6593         16  AM-VG-GROUPING                PIC X(6).
  6594         16  AM-VG-STATE                   PIC XX.
  6595         16  AM-VG-ACCOUNT                 PIC X(10).
  6596         16  AM-VG-DATE.
  6597             20  AM-VG-EXPIRATION-DT       PIC XX.
  6598             20  FILLER                    PIC X(4).
  6599         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6600                                           PIC 9(11)      COMP-3.
  6601     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6602         16  FILLER                        PIC X(10).
  6603         16  AM-VG-KEY3.
  6604             20  AM-VG3-ACCOUNT            PIC X(10).
  6605             20  AM-VG3-EXP-DT             PIC XX.
  6606         16  FILLER                        PIC X(4).
  6607     12  AM-MAINT-INFORMATION.
  6608         16  AM-LAST-MAINT-DT              PIC XX.
  6609         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6610         16  AM-LAST-MAINT-USER            PIC X(4).
  6611         16  FILLER                        PIC XX.
  6612
  6613     12  AM-EFFECTIVE-DT                   PIC XX.
  6614     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6615
  6616     12  AM-PREV-DATES  COMP-3.
  6617         16  AM-PREV-EXP-DT                PIC 9(11).
  6618         16  AM-PREV-EFF-DT                PIC 9(11).
  6619
  6620     12  AM-REPORT-CODE-1                  PIC X(10).
  6621     12  AM-REPORT-CODE-2                  PIC X(10).
  6622
  6623     12  AM-CITY-CODE                      PIC X(4).
  6624     12  AM-COUNTY-PARISH                  PIC X(6).
  6625
  6626     12  AM-NAME                           PIC X(30).
  6627     12  AM-PERSON                         PIC X(30).
  6628     12  AM-ADDRS                          PIC X(30).
  6629     12  AM-CITY.
  6630         16  AM-ADDR-CITY                  PIC X(28).
  6631         16  AM-ADDR-STATE                 PIC XX.
  6632     12  AM-ZIP.
  6633         16  AM-ZIP-PRIME.
  6634             20  AM-ZIP-PRI-1ST            PIC X.
  6635                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6636             20  FILLER                    PIC X(4).
  6637         16  AM-ZIP-PLUS4                  PIC X(4).
  6638     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6639         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 124
* EL156.cbl
  6640         16  AM-CAN-POSTAL-2               PIC XXX.
  6641         16  FILLER                        PIC XXX.
  6642     12  AM-TEL-NO.
  6643         16  AM-AREA-CODE                  PIC 999.
  6644         16  AM-TEL-PRE                    PIC 999.
  6645         16  AM-TEL-NBR                    PIC 9(4).
  6646     12  AM-TEL-LOC                        PIC X.
  6647         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6648         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6649
  6650     12  AM-COMM-STRUCTURE.
  6651         16  AM-DEFN-1.
  6652             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6653                 24  AM-AGT.
  6654                     28  AM-AGT-PREFIX     PIC X(4).
  6655                     28  AM-AGT-PRIME      PIC X(6).
  6656                 24  AM-COM-TYP            PIC X.
  6657                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6658                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6659                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6660                 24  AM-RECALC-LV-INDIC    PIC X.
  6661                 24  AM-RETRO-LV-INDIC     PIC X.
  6662                 24  AM-GL-CODES           PIC X.
  6663                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6664                 24  FILLER                PIC X(01).
  6665         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6666             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6667                 24  FILLER                PIC X(11).
  6668                 24  AM-L-COMA             PIC XXX.
  6669                 24  AM-J-COMA             PIC XXX.
  6670                 24  AM-A-COMA             PIC XXX.
  6671                 24  FILLER                PIC X(6).
  6672
  6673     12  AM-COMM-CHANGE-STATUS             PIC X.
  6674         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6675
  6676     12  AM-CSR-CODE                       PIC X(4).
  6677
  6678     12  AM-BILLING-STATUS                 PIC X.
  6679         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6680         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6681     12  AM-AUTO-REFUND-SW                 PIC X.
  6682         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6683         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6684     12  AM-GPCD                           PIC 99.
  6685     12  AM-IG                             PIC X.
  6686         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6687         88  AM-HAS-GROUP                     VALUE '2'.
  6688     12  AM-STATUS                         PIC X.
  6689         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6690         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6691         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6692         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6693         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6694         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6695     12  AM-REMIT-TO                       PIC 99.
  6696     12  AM-ID-NO                          PIC X(11).
  6697
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 125
* EL156.cbl
  6698     12  AM-CAL-TABLE                      PIC XX.
  6699     12  AM-LF-DEVIATION                   PIC XXX.
  6700     12  AM-AH-DEVIATION                   PIC XXX.
  6701     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6702     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6703     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6704     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6705     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6706     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6707
  6708     12  AM-USER-FIELDS.
  6709         16  AM-FLD-1                      PIC XX.
  6710         16  AM-FLD-2                      PIC XX.
  6711         16  AM-FLD-3                      PIC XX.
  6712         16  AM-FLD-4                      PIC XX.
  6713         16  AM-FLD-5                      PIC XX.
  6714
  6715     12  AM-1ST-PROD-DATE.
  6716         16  AM-1ST-PROD-YR                PIC XX.
  6717         16  AM-1ST-PROD-MO                PIC XX.
  6718         16  AM-1ST-PROD-DA                PIC XX.
  6719     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6720     12  AM-CERTS-PURGED-DATE.
  6721         16  AM-PUR-YR                     PIC XX.
  6722         16  AM-PUR-MO                     PIC XX.
  6723         16  AM-PUR-DA                     PIC XX.
  6724     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6725     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6726     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6727     12  AM-INACTIVE-DATE.
  6728         16  AM-INA-MO                     PIC 99.
  6729         16  AM-INA-DA                     PIC 99.
  6730         16  AM-INA-YR                     PIC 99.
  6731     12  AM-AR-HI-CERT-DATE                PIC XX.
  6732
  6733     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6734     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6735
  6736     12  AM-OB-PAYMENT-MODE                PIC X.
  6737         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6738         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6739         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6740         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6741
  6742     12  AM-AH-ONLY-INDICATOR              PIC X.
  6743         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6744         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6745
  6746     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6747
  6748     12  AM-OVER-SHORT.
  6749         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6750         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6751
  6752     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6753     12  AM-DCC-CLP-STATE                  PIC XX.
  6754
  6755     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 126
* EL156.cbl
  6756     12  AM-RECALC-REIN                    PIC X.
  6757
  6758     12  AM-REI-TABLE                      PIC XXX.
  6759     12  AM-REI-ET-LF                      PIC X.
  6760     12  AM-REI-ET-AH                      PIC X.
  6761     12  AM-REI-PE-LF                      PIC X.
  6762     12  AM-REI-PE-AH                      PIC X.
  6763     12  AM-REI-PRT-ST                     PIC X.
  6764     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6765     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6766     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6767     12  AM-REI-GROUP-A                    PIC X(6).
  6768     12  AM-REI-MORT                       PIC X(4).
  6769     12  AM-REI-PRT-OW                     PIC X.
  6770     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6771     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6772     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6773     12  AM-REI-GROUP-B                    PIC X(6).
  6774
  6775     12  AM-TRUST-TYPE                     PIC X(2).
  6776
  6777     12  AM-EMPLOYER-STMT-USED             PIC X.
  6778     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6779
  6780     12  AM-STD-AH-TYPE                    PIC XX.
  6781     12  AM-EARN-METHODS.
  6782         16  AM-EARN-METHOD-R              PIC X.
  6783             88 AM-REF-RL-R78                 VALUE 'R'.
  6784             88 AM-REF-RL-PR                  VALUE 'P'.
  6785             88 AM-REF-RL-MEAN                VALUE 'M'.
  6786             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6787         16  AM-EARN-METHOD-L              PIC X.
  6788             88 AM-REF-LL-R78                 VALUE 'R'.
  6789             88 AM-REF-LL-PR                  VALUE 'P'.
  6790             88 AM-REF-LL-MEAN                VALUE 'M'.
  6791             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6792         16  AM-EARN-METHOD-A              PIC X.
  6793             88 AM-REF-AH-R78                 VALUE 'R'.
  6794             88 AM-REF-AH-PR                  VALUE 'P'.
  6795             88 AM-REF-AH-MEAN                VALUE 'M'.
  6796             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6797             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6798             88 AM-REF-AH-NET                 VALUE 'N'.
  6799
  6800     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6801     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6802     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6803
  6804     12  AM-RET-Y-N                        PIC X.
  6805     12  AM-RET-P-E                        PIC X.
  6806     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6807     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6808     12  AM-RET-GRP                        PIC X(6).
  6809     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6810         16  AM-POOL-PRIME                 PIC XXX.
  6811         16  AM-POOL-SUB                   PIC XXX.
  6812     12  AM-RETRO-EARNINGS.
  6813         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 127
* EL156.cbl
  6814         16  AM-RET-EARN-L                 PIC X.
  6815         16  AM-RET-EARN-A                 PIC X.
  6816     12  AM-RET-ST-TAX-USE                 PIC X.
  6817         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6818         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6819     12  AM-RETRO-BEG-EARNINGS.
  6820         16  AM-RET-BEG-EARN-R             PIC X.
  6821         16  AM-RET-BEG-EARN-L             PIC X.
  6822         16  AM-RET-BEG-EARN-A             PIC X.
  6823     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6824     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6825
  6826     12  AM-USER-SELECT-OPTIONS.
  6827         16  AM-USER-SELECT-1              PIC X(10).
  6828         16  AM-USER-SELECT-2              PIC X(10).
  6829         16  AM-USER-SELECT-3              PIC X(10).
  6830         16  AM-USER-SELECT-4              PIC X(10).
  6831         16  AM-USER-SELECT-5              PIC X(10).
  6832
  6833     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6834
  6835     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6836
  6837     12  AM-RPT045A-SWITCH                 PIC X.
  6838         88  RPT045A-OFF                   VALUE 'N'.
  6839
  6840     12  AM-INSURANCE-LIMITS.
  6841         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6842         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6843
  6844     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6845         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6846
  6847     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6848         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6849         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6850
  6851     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6852
  6853     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6854     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6855     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6856     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6857     12  AM-DCC-UEF-STATE                  PIC XX.
  6858     12  FILLER                            PIC XXX.
  6859     12  AM-REPORT-CODE-3                  PIC X(10).
  6860*    12  FILLER                            PIC X(22).
  6861
  6862     12  AM-RESERVE-DATE.
  6863         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6864         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6865         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6866
  6867     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6868     12  AM-NOTIFICATION-TYPES.
  6869         16  AM-NOTIF-OF-LETTERS           PIC X.
  6870         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6871         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 128
* EL156.cbl
  6872         16  AM-NOTIF-OF-STATUS            PIC X.
  6873
  6874     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6875         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6876         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6877         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6878         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6879
  6880     12  AM-BENEFIT-CONTROLS.
  6881         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6882             20  AM-BENEFIT-CODE           PIC XX.
  6883             20  AM-BENEFIT-TYPE           PIC X.
  6884             20  AM-BENEFIT-REVISION       PIC XXX.
  6885             20  AM-BENEFIT-REM-TERM       PIC X.
  6886             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6887             20  FILLER                    PIC XX.
  6888         16  FILLER                        PIC X(80).
  6889
  6890     12  AM-TRANSFER-DATA.
  6891         16  AM-TRANSFERRED-FROM.
  6892             20  AM-TRNFROM-CARRIER        PIC X.
  6893             20  AM-TRNFROM-GROUPING.
  6894                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6895                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6896             20  AM-TRNFROM-STATE          PIC XX.
  6897             20  AM-TRNFROM-ACCOUNT.
  6898                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6899                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6900             20  AM-TRNFROM-DTE            PIC XX.
  6901         16  AM-TRANSFERRED-TO.
  6902             20  AM-TRNTO-CARRIER          PIC X.
  6903             20  AM-TRNTO-GROUPING.
  6904                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6905                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6906             20  AM-TRNTO-STATE            PIC XX.
  6907             20  AM-TRNTO-ACCOUNT.
  6908                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6909                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6910             20  AM-TRNTO-DTE              PIC XX.
  6911         16  FILLER                        PIC X(10).
  6912
  6913     12  AM-SAVED-REMIT-TO                 PIC 99.
  6914
  6915     12  AM-COMM-STRUCTURE-SAVED.
  6916         16  AM-DEFN-1-SAVED.
  6917             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6918                 24  AM-AGT-SV             PIC X(10).
  6919                 24  AM-COM-TYP-SV         PIC X.
  6920                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6921                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6922                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6923                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6924                 24  FILLER                PIC X.
  6925                 24  AM-GL-CODES-SV        PIC X.
  6926                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6927                 24  FILLER                PIC X.
  6928         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6929             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 129
* EL156.cbl
  6930                 24  FILLER                PIC X(11).
  6931                 24  AM-L-COMA-SV          PIC XXX.
  6932                 24  AM-J-COMA-SV          PIC XXX.
  6933                 24  AM-A-COMA-SV          PIC XXX.
  6934                 24  FILLER                PIC X(6).
  6935
  6936     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6937         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6938            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6939            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6940            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6941
  6942     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6943     12  FILLER                            PIC X(120).
  6944
  6945     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6946         16  AM-CONTROL-NAME               PIC X(30).
  6947         16  AM-EXECUTIVE-ONE.
  6948             20  AM-EXEC1-NAME             PIC X(15).
  6949             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6950                                                          COMP-3.
  6951             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6952                                                          COMP-3.
  6953         16  AM-EXECUTIVE-TWO.
  6954             20  AM-EXEC2-NAME             PIC X(15).
  6955             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6956                                                          COMP-3.
  6957             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6958                                                          COMP-3.
  6959
  6960     12  AM-RETRO-ADDITIONAL-DATA.
  6961         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6962         16  AM-RETRO-PREM-P-E             PIC X.
  6963         16  AM-RETRO-CLMS-P-I             PIC X.
  6964         16  AM-RETRO-RET-BRACKET-LF.
  6965             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6966                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6967                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6968             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6969                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6970                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6971             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6972                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6973                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6974         16  AM-RETRO-RET-BRACKET-AH.
  6975             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6976                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6977                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6978                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6979             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6980                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6981                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6982             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6983                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6984                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6985
  6986     12  AM-COMMENTS.
  6987         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 130
* EL156.cbl
  6988
  6989     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6990         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6991         16  AM-FLI-BILLING-CODE           PIC X.
  6992         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6993         16  AM-FLI-UNITED-IDENT           PIC X.
  6994         16  AM-FLI-INTEREST-LOST-DATA.
  6995             20  AM-FLI-BANK-NO            PIC X(5).
  6996             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6997             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6998             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6999         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7000             20  AM-FLI-AGT                PIC X(9).
  7001             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7002             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7003         16  FILLER                        PIC X(102).
  7004
  7005     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7006         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7007             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7008             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7009             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7010             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7011             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7012         16  FILLER                          PIC X(10).
  7013******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 131
* EL156.cbl
  7015*    COPY ELCCHKQ.
  7016******************************************************************
  7017*                                                                *
  7018*                                                                *
  7019*                            ELCCHKQ.                            *
  7020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7021*                            VMOD=2.007                          *
  7022*                                                                *
  7023*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7024*                                                                *
  7025*   FILE TYPE = VSAM,KSDS                                        *
  7026*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7027*                                                                *
  7028*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7029*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7030*                                                                *
  7031*   LOG = YES                                                    *
  7032*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7033******************************************************************
  7034 01  CHECK-QUE.
  7035     12  CQ-RECORD-ID                PIC XX.
  7036         88  VALID-CQ-ID         VALUE 'CQ'.
  7037
  7038     12  CQ-CONTROL-PRIMARY.
  7039         16  CQ-COMPANY-CD           PIC X.
  7040         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7041         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7042
  7043     12  CQ-CONTROL-BY-PAYEE.
  7044         16  CQ-CONTROL-BY-NUMBER.
  7045             20  CQ-COMPANY-CD-A1     PIC X.
  7046             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7047         16  CQ-PAYEE-CARRIER        PIC X.
  7048         16  CQ-PAYEE-GROUPING       PIC X(6).
  7049         16  CQ-PAYEE-STATE          PIC XX.
  7050         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7051         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7052
  7053     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7054         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7055         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7056         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7057         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7058         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7059         16  FILLER                  PIC X(3).
  7060
  7061     12  CQ-ENTRY-TYPE               PIC X.
  7062             88  CHECK-ON-QUE           VALUE 'Q'.
  7063             88  ALIGNMENT-CHECK        VALUE 'A'.
  7064             88  SPOILED-CHECK          VALUE 'S'.
  7065             88  PAYMENT-ABORTED        VALUE 'X'.
  7066
  7067     12  CQ-CLAIM-MAST-CNTL.
  7068         16  CQ-CARRIER              PIC X.
  7069         16  CQ-CLAIM-NO             PIC X(7).
  7070         16  CQ-CERT-NO.
  7071             20  CQ-CERT-PRIME       PIC X(10).
  7072             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 132
* EL156.cbl
  7073         16  CQ-CLAIM-TYPE           PIC X.
  7074             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7075             88  CQ-AH-CLAIM            VALUE 'A'.
  7076         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7077             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7078             88  CQ-O-B-COVERAGE        VALUE '2'.
  7079             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7080
  7081     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7082     12  CQ-CHECK-NUMBER             PIC X(7).
  7083     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7084     12  CQ-PAYMENT-TYPE             PIC X.
  7085             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7086             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7087             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7088             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7089             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7090             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7091             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7092             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7093     12  CQ-VOID-INDICATOR           PIC X.
  7094             88  CHECK-IS-STOPPED          VALUE 'S'.
  7095             88  CHECK-IS-VOID             VALUE 'V'.
  7096     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7097     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7098     12  CQ-CHECK-BY-USER            PIC X(4).
  7099     12  CQ-PRE-NUMBERING-SW         PIC X.
  7100       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7101       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7102
  7103     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7104     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7105     12  CQ-LEDGER-FLAG              PIC X(01).
  7106     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7107     12  CQ-LAST-UPDATED-DT          PIC XX.
  7108     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7109     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7110
  7111     12  FILLER                      PIC X(04).
  7112
  7113******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 133
* EL156.cbl
  7115*    COPY ELCBENE.
  7116******************************************************************
  7117*                                                                *
  7118*                            ELCBENE.                            *
  7119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7120*                            VMOD=2.006                          *
  7121*                                                                *
  7122*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7123*                                                                *
  7124*   FILE TYPE = VSAM,KSDS                                        *
  7125*   RECORD SIZE = 500   RECFORM = FIX                            *
  7126*                                                                *
  7127*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7128*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7129*                                                                *
  7130*   LOG = YES                                                    *
  7131*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7132*                                                                *
  7133*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7134******************************************************************
  7135
  7136 01  BENEFICIARY-MASTER.
  7137     12  BE-RECORD-ID                PIC XX.
  7138         88  VALID-BE-ID                VALUE 'BE'.
  7139
  7140     12  BE-CONTROL-PRIMARY.
  7141         16  BE-COMPANY-CD           PIC X.
  7142         16  BE-RECORD-TYPE          PIC X.
  7143             88  BENEFICIARY-RECORD  VALUE 'B'.
  7144             88  ADJUSTOR-RECORD     VALUE 'A'.
  7145         16  BE-BENEFICIARY          PIC X(10).
  7146     12  BE-CONTROL-BY-NAME.
  7147         16  BE-COMPANY-CD-A1        PIC X.
  7148         16  BE-RECORD-TYPE-A1       PIC X.
  7149         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7150         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7151
  7152     12  BE-LAST-MAINT-DT            PIC XX.
  7153     12  BE-LAST-MAINT-BY            PIC X(4).
  7154     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7155
  7156     12  BE-ADDRESS-DATA.
  7157         16  BE-MAIL-TO-NAME         PIC X(30).
  7158         16  BE-ADDRESS-LINE-1       PIC X(30).
  7159         16  BE-ADDRESS-LINE-2       PIC X(30).
  7160         16  BE-ADDRESS-LINE-3       PIC X(30).
  7161         16  BE-CITY-STATE.
  7162             20  BE-CITY             PIC X(28).
  7163             20  BE-STATE            PIC XX.
  7164         16  BE-ZIP-CODE.
  7165             20  BE-ZIP-PRIME.
  7166                 24  BE-ZIP-1ST      PIC X.
  7167                     88  BE-CANADIAN-POST-CODE
  7168                                         VALUE 'A' THRU 'Z'.
  7169                 24  FILLER          PIC X(4).
  7170             20  BE-ZIP-PLUS4        PIC X(4).
  7171         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7172             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 134
* EL156.cbl
  7173             20  BE-CAN-POSTAL-2     PIC XXX.
  7174             20  FILLER              PIC XXX.
  7175         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7176         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7177
  7178******************************************************************
  7179*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7180*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7181******************************************************************
  7182     12  BE-CARRIER                  PIC X.
  7183
  7184     12  BE-ADDRESS-DATA2.
  7185         16  BE-MAIL-TO-NAME2        PIC X(30).
  7186         16  BE-ADDRESS-LINE-12      PIC X(30).
  7187         16  BE-ADDRESS-LINE-22      PIC X(30).
  7188         16  BE-ADDRESS-LINE-32      PIC X(30).
  7189         16  BE-CITY-STATE2.
  7190             20  BE-CITY2            PIC X(28).
  7191             20  BE-STATE2           PIC XX.
  7192         16  BE-ZIP-CODE2.
  7193             20  BE-ZIP-PRIME2.
  7194                 24  BE-ZIP-1ST2     PIC X.
  7195                     88  BE-CANADIAN-POST-CODE2
  7196                                         VALUE 'A' THRU 'Z'.
  7197                 24  FILLER          PIC X(4).
  7198             20  BE-ZIP-PLUS42       PIC X(4).
  7199         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7200             20  BE-CAN-POSTAL-12    PIC XXX.
  7201             20  BE-CAN-POSTAL-22    PIC XXX.
  7202             20  FILLER              PIC XXX.
  7203         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7204         16  BE-BILLING-STMT-DATA.
  7205             20  BE-BSR              PIC X.
  7206                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7207                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7208             20  BE-BSR-FROM         PIC X(30).
  7209             20  BE-BSR-DEPT         PIC X(30).
  7210             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7211             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7212             20  BE-OUTPUT-TYPE      PIC X.
  7213                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7214                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7215
  7216     12  FILLER                      PIC X(28).
  7217******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 135
* EL156.cbl
  7219*    COPY ELCARCH.
  7220******************************************************************
  7221*                                                                *
  7222*                            ELCARCH.                            *
  7223*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7224*                            VMOD=2.007                          *
  7225*                                                                *
  7226*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7227*                                                                *
  7228*   FILE TYPE = VSAM,KSDS                                        *
  7229*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7230*                                                                *
  7231*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7232*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7233*                                                                *
  7234*   LOG = NO                                                     *
  7235*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7236*                                                                *
  7237*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7238******************************************************************
  7239 01  LETTER-ARCHIVE.
  7240     12  LA-RECORD-ID                PIC XX.
  7241         88  VALID-LA-ID                VALUE 'LA'.
  7242
  7243     12  LA-CONTROL-PRIMARY.
  7244         16  LA-COMPANY-CD           PIC X.
  7245         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7246         16  LA-RECORD-TYPE          PIC X.
  7247             88  LA-HEADER-DATA         VALUE '1'.
  7248             88  LA-ADDRESS-DATA        VALUE '2'.
  7249             88  LA-TEXT-DATA           VALUE '3'.
  7250             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7251         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7252
  7253     12  LA-CONTROL-BY-TYPE.
  7254         16  LA-COMPANY-CD-A1        PIC X.
  7255         16  LA-RECORD-TYPE-A1       PIC X.
  7256         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7257         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7258
  7259     12  LA-TEXT-RECORD.
  7260         16  LA-SKIP-CONTROL         PIC XX.
  7261             88  NO-LINES-SKIPPED       VALUE SPACES.
  7262             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7263         16  LA-TEXT-LINE            PIC X(70).
  7264
  7265     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7266         16  FILLER                  PIC XX.
  7267         16  LA-ADDRESS-LINE         PIC X(30).
  7268         16  FILLER                  PIC X(40).
  7269
  7270     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7271         16  FILLER                  PIC XX.
  7272         16  LA-CARRIER              PIC X.
  7273         16  LA-CLAIM-NO             PIC X(7).
  7274         16  LA-CERT-NO.
  7275             20  LA-CERT-PRIME       PIC X(10).
  7276             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 136
* EL156.cbl
  7277         16  LA-NO-OF-COPIES         PIC S9.
  7278         16  LA-RESEND-DATE          PIC XX.
  7279         16  LA-PROCESSOR-CD         PIC X(4).
  7280         16  LA-CREATION-DT          PIC XX.
  7281         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7282         16  LA-RESEND-PRINT-DATE    PIC XX.
  7283         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7284         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7285*
  7286* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7287*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7288*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7289*   I        20  LA-DMD-RES-ST           PIC XX.
  7290*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7291*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7292*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7293*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7294*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7295*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7296*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7297*   I        20  LA-DMD-UND-CODE         PIC XX.
  7298*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7299*   V    16  FILLER                  PIC X(15).
  7300* -----
  7301*
  7302* REINSERTED  CSO  MODS
  7303*
  7304         16  FILLER.
  7305             20  FILLER                  PIC X(29).
  7306             20  LA-CSO-LETTER-STATUS    PIC X.
  7307                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7308                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7309                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7310             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7311             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7312*
  7313
  7314     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7315         16  FILLER                  PIC XX.
  7316         16  LA4-CARRIER             PIC X.
  7317         16  LA4-CLAIM-NO            PIC X(7).
  7318         16  LA4-CERT-NO.
  7319             20  LA4-CERT-PRIME      PIC X(10).
  7320             20  LA4-CERT-SFX        PIC X.
  7321         16  LA4-NO-OF-COPIES        PIC S9.
  7322         16  LA4-RESEND-DATE         PIC XX.
  7323         16  LA4-PROCESSOR-CD        PIC X(4).
  7324         16  LA4-CREATION-DT         PIC XX.
  7325         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7326         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7327         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7328         16  LA4-FORM-TYPE           PIC X.
  7329             88  LA4-INITIAL-FORM    VALUE '1'.
  7330             88  LA4-PROGRESS-FORM   VALUE '2'.
  7331         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7332         16  LA4-STATE               PIC X(02).
  7333         16  FILLER                  PIC X(31).
  7334******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 137
* EL156.cbl
  7336*    COPY ELCDAR.
  7337******************************************************************
  7338*                                                                *
  7339*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7340*   FILE TYPE = VSAM,KSDS                                        *
  7341*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7342*   BASE CLUSTER = DLYACTV                                       *
  7343*   LOG = YES                                                    *
  7344*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7345*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7346*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7347*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7348*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7349*               BY PROGRAM "LGINFCE".                            *
  7350*                                                                *
  7351******************************************************************
  7352 01  DAILY-ACTIVITY-RECORD.
  7353     05  DA-KEY.
  7354         10  DA-COMP-CD          PIC X.
  7355         10  DA-CARRIER          PIC X.
  7356         10  DA-CLAIM-NO         PIC X(7).
  7357         10  DA-CERT-NO.
  7358             15  DA-CERT-PRIME   PIC X(10).
  7359             15  DA-CERT-SFX     PIC X.
  7360     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7361     05  DA-RECORD-TYPE          PIC X.
  7362     05  FILLER                  PIC X(2).
  7363******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 138
* EL156.cbl
  7365*    COPY ERCCOMP.
  7366******************************************************************
  7367*                                                                *
  7368*                                                                *
  7369*                            ERCCOMP                             *
  7370*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7371*                            VMOD=2.019                          *
  7372*                                                                *
  7373*   ONLINE CREDIT SYSTEM                                         *
  7374*                                                                *
  7375*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7376*                                                                *
  7377*   FILE TYPE = VSAM,KSDS                                        *
  7378*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7379*                                                                *
  7380*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7381*       ALTERNATE PATH = NONE                                    *
  7382*                                                                *
  7383*   LOG = NO                                                     *
  7384*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7385*                                                                *
  7386******************************************************************
  7387*                   C H A N G E   L O G
  7388*
  7389* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7390*-----------------------------------------------------------------
  7391*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7392* EFFECTIVE    NUMBER
  7393*-----------------------------------------------------------------
  7394* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7395* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7396* 092205    2005050300006  PEMA  ADD LEASE FEE
  7397* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7398* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7399* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7400* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7401* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7402* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7403******************************************************************
  7404
  7405 01  COMPENSATION-MASTER.
  7406     12  CO-RECORD-ID                          PIC XX.
  7407         88  VALID-CO-ID                          VALUE 'CO'.
  7408
  7409     12  CO-CONTROL-PRIMARY.
  7410         16  CO-COMPANY-CD                     PIC X.
  7411         16  CO-CONTROL.
  7412             20  CO-CTL-1.
  7413                 24  CO-CARR-GROUP.
  7414                     28  CO-CARRIER            PIC X.
  7415                     28  CO-GROUPING.
  7416                         32  CO-GROUP-PREFIX   PIC XXX.
  7417                         32  CO-GROUP-PRIME    PIC XXX.
  7418                 24  CO-RESP-NO.
  7419                     28  CO-RESP-PREFIX        PIC X(4).
  7420                     28  CO-RESP-PRIME         PIC X(6).
  7421             20  CO-CTL-2.
  7422                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 139
* EL156.cbl
  7423                     28  CO-ACCT-PREFIX        PIC X(4).
  7424                     28  CO-ACCT-PRIME         PIC X(6).
  7425         16  CO-TYPE                           PIC X.
  7426             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7427             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7428             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7429
  7430     12  CO-MAINT-INFORMATION.
  7431         16  CO-LAST-MAINT-DT                  PIC XX.
  7432         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7433         16  CO-LAST-MAINT-USER                PIC X(4).
  7434     12  FILLER                                PIC XX.
  7435     12  CO-STMT-TYPE                          PIC XXX.
  7436     12  CO-COMP-TYPE                          PIC X.
  7437         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7438     12  CO-STMT-OWNER                         PIC X(4).
  7439     12  CO-BALANCE-CONTROL                    PIC X.
  7440         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7441         88  CO-NO-BALANCE                        VALUE 'N'.
  7442
  7443     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7444         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7445         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7446         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7447
  7448     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7449         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7450         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7451
  7452     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7453     12  CO-GA-DIRECT-DEP                      PIC X.
  7454     12  CO-FUTURE-SPACE                       PIC X.
  7455         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7456
  7457     12  CO-ACCT-NAME                          PIC X(30).
  7458     12  CO-MAIL-NAME                          PIC X(30).
  7459     12  CO-ADDR-1                             PIC X(30).
  7460     12  CO-ADDR-2                             PIC X(30).
  7461     12  CO-ADDR-3.
  7462         16  CO-ADDR-CITY                      PIC X(27).
  7463         16  CO-ADDR-STATE                     PIC XX.
  7464     12  CO-CSO-1099                           PIC X.
  7465     12  CO-ZIP.
  7466         16  CO-ZIP-PRIME.
  7467             20  CO-ZIP-PRI-1ST                PIC X.
  7468                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7469             20  FILLER                        PIC X(4).
  7470         16  CO-ZIP-PLUS4                      PIC X(4).
  7471     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7472         16  CO-CAN-POSTAL-1                   PIC XXX.
  7473         16  CO-CAN-POSTAL-2                   PIC XXX.
  7474         16  FILLER                            PIC XXX.
  7475     12  CO-SOC-SEC                            PIC X(13).
  7476     12  CO-TELEPHONE.
  7477         16  CO-AREA-CODE                      PIC XXX.
  7478         16  CO-PREFIX                         PIC XXX.
  7479         16  CO-PHONE                          PIC X(4).
  7480
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 140
* EL156.cbl
  7481     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7482
  7483     12  CO-AR-BAL-LEVEL                       PIC X.
  7484         88  CO-AR-REF-LVL                        VALUE '1'.
  7485         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7486         88  CO-AR-BILL-LVL                       VALUE '2'.
  7487         88  CO-AR-AGT-LVL                        VALUE '3'.
  7488         88  CO-AR-FR-LVL                         VALUE '4'.
  7489
  7490     12  CO-AR-NORMAL-PRINT                    PIC X.
  7491         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7492         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7493
  7494     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7495
  7496     12  CO-AR-REPORTING                       PIC X.
  7497         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7498         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7499
  7500     12  CO-AR-PULL-CHECK                      PIC X.
  7501         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7502         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7503
  7504     12  CO-AR-BALANCE-PRINT                   PIC X.
  7505         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7506
  7507     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7508         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7509         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7510         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7511
  7512     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7513
  7514     12  CO-USER-CODE                          PIC X.
  7515     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7516
  7517******************************************************************
  7518*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7519*    THE LAST MONTH END RUN.
  7520******************************************************************
  7521
  7522     12  CO-LAST-ACTIVITY-DATE.
  7523         16  CO-ACT-YEAR                       PIC 99.
  7524         16  CO-ACT-MONTH                      PIC 99.
  7525         16  CO-ACT-DAY                        PIC 99.
  7526
  7527     12  CO-LAST-STMT-DT.
  7528         16  CO-LAST-STMT-YEAR                 PIC 99.
  7529         16  CO-LAST-STMT-MONTH                PIC 99.
  7530         16  CO-LAST-STMT-DAY                  PIC 99.
  7531
  7532     12  CO-MO-END-TOTALS.
  7533         16  CO-MONTHLY-TOTALS.
  7534             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7535             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7536             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7537             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7538             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 141
* EL156.cbl
  7539
  7540         16  CO-AGING-TOTALS.
  7541             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7542             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7543             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7544             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7545
  7546         16  CO-YTD-TOTALS.
  7547             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7548             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7549
  7550         16  CO-OVER-UNDER-TOTALS.
  7551             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7552             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7553
  7554     12  CO-MISCELLANEOUS-TOTALS.
  7555         16  CO-FICA-TOTALS.
  7556             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7557             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7558
  7559         16  CO-CLAIM-TOTALS.
  7560             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7561             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7562
  7563******************************************************************
  7564*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7565*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7566******************************************************************
  7567
  7568     12  CO-CURRENT-TOTALS.
  7569         16  CO-CURRENT-LAST-STMT-DT.
  7570             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7571             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7572             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7573
  7574         16  CO-CURRENT-MONTHLY-TOTALS.
  7575             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7576             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7577             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7578             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7579             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7580
  7581         16  CO-CURRENT-AGING-TOTALS.
  7582             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7583             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7584             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7585             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7586
  7587         16  CO-CURRENT-YTD-TOTALS.
  7588             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7589             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7590
  7591     12  CO-PAID-COMM-TOTALS.
  7592         16  CO-YTD-PAID-COMMS.
  7593             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7594             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7595
  7596     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 142
* EL156.cbl
  7597         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7598         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7599
  7600     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7601         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7602         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7603         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7604         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7605         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7606         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7607         88  CO-FINAL-LETTER                  VALUE 'F'.
  7608         88  CO-RECONCILING                   VALUE 'R'.
  7609         88  CO-PHONE-CALL                    VALUE 'P'.
  7610         88  CO-LEGAL                         VALUE 'L'.
  7611         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7612         88  CO-WRITE-OFF                     VALUE 'W'.
  7613         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7614
  7615     12  CO-CSR-CODE                       PIC X(4).
  7616
  7617     12  CO-GA-STATUS-INFO.
  7618         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7619         16  CO-GA-TERMINATION-DT          PIC XX.
  7620         16  CO-GA-STATUS-CODE             PIC X.
  7621             88  CO-GA-ACTIVE                 VALUE 'A'.
  7622             88  CO-GA-INACTIVE               VALUE 'I'.
  7623             88  CO-GA-PENDING                VALUE 'P'.
  7624         16  CO-GA-COMMENTS.
  7625             20  CO-GA-COMMENT-1           PIC X(40).
  7626             20  CO-GA-COMMENT-2           PIC X(40).
  7627             20  CO-GA-COMMENT-3           PIC X(40).
  7628             20  CO-GA-COMMENT-4           PIC X(40).
  7629
  7630     12  CO-RPTCD2                         PIC X(10).
  7631     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7632         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7633         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7634
  7635     12  CO-TYPE-AGENT                     PIC X(01).
  7636         88  CO-CORPORATION                   VALUE 'C'.
  7637         88  CO-PARTNERSHIP                   VALUE 'P'.
  7638         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7639         88  CO-TRUST                         VALUE 'T'.
  7640         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7641
  7642     12  CO-FAXNO.
  7643         16  CO-FAX-AREA-CODE                  PIC XXX.
  7644         16  CO-FAX-PREFIX                     PIC XXX.
  7645         16  CO-FAX-PHONE                      PIC X(4).
  7646
  7647     12  CO-BANK-INFORMATION.
  7648         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7649         16  CO-BANK-TRANSIT-NON REDEFINES
  7650             CO-BANK-TRANSIT-NO                PIC 9(8).
  7651
  7652         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7653     12  CO-MISC-DEDUCT-INFO REDEFINES
  7654                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 143
* EL156.cbl
  7655         16  CO-MD-GL-ACCT                     PIC X(10).
  7656         16  CO-MD-DIV                         PIC XX.
  7657         16  CO-MD-CENTER                      PIC X(4).
  7658         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7659         16  CO-CREATE-AP-CHECK                PIC X.
  7660         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7661         16  FILLER                            PIC XXX.
  7662     12  CO-ACH-STATUS                         PIC X.
  7663         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7664         88  CO-ACH-PENDING                        VALUE 'P'.
  7665
  7666     12  CO-BILL-SW                            PIC X.
  7667     12  CO-CONTROL-NAME                       PIC X(30).
  7668     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7669     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7670     12  CO-CLP-STATE                          PIC XX.
  7671     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7672     12  CO-SPP-REFUND-EDIT                    PIC X.
  7673
  7674******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 144
* EL156.cbl
  7676*    COPY ERCDMDNT.
  7677******************************************************************
  7678*                                                                *
  7679*                            ERCDMDNT                            *
  7680*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7681*                            VMOD=2.005                          *
  7682*                                                                *
  7683*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7684*                                                                *
  7685*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7686*                                                                *
  7687*        FILE TYPE= VSAM,KSDS                                    *
  7688*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7689*                                                                *
  7690*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7691*                                                                *
  7692*        LOG = YES                                               *
  7693*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7694*                                                                *
  7695******************************************************************
  7696
  7697 01  CERTIFICATE-NOTE.
  7698     12  CN-RECORD-ID                     PIC  XX.
  7699         88  VALID-CN-ID                      VALUE 'CN'.
  7700
  7701     12  CN-CONTROL-PRIMARY.
  7702         16  CN-COMPANY-CD                PIC X.
  7703         16  CN-CERT-KEY.
  7704             20  CN-CARRIER               PIC X.
  7705             20  CN-GROUPING.
  7706                 24  CN-GROUPING-PREFIX   PIC XXX.
  7707                 24  CN-GROUPING-PRIME    PIC XXX.
  7708             20  CN-STATE                 PIC XX.
  7709             20  CN-ACCOUNT.
  7710                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7711                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7712             20  CN-CERT-EFF-DT           PIC XX.
  7713             20  CN-CERT-NO.
  7714                 24  CN-CERT-PRIME        PIC X(10).
  7715                 24  CN-CERT-SFX          PIC X.
  7716
  7717     12  CN-BILLING-START-LINE-NO         PIC 99.
  7718     12  CN-BILLING-END-LINE-NO           PIC 99.
  7719
  7720     12  CN-LINES.
  7721         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7722
  7723     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7724         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7725         16  CN-CSI-GENERAL-DATA-AREA.
  7726             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7727
  7728         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7729             CN-CSI-GENERAL-DATA-AREA.
  7730             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7731             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7732             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7733             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 145
* EL156.cbl
  7734             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7735             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7736             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7737             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7738             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7739             20  FILLER                       PIC XX.
  7740             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7741             20  FILLER                       PIC X(38).
  7742
  7743         16  CN-CSI-PRODUCT-DATA-AREA.
  7744             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7745
  7746         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7747             CN-CSI-PRODUCT-DATA-AREA.
  7748             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7749             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7750             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7751             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7752             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7753             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7754             20  FILLER                   PIC XX.
  7755             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7756             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7757             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7758             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7759             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7760             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7761             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7762             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7763             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7764             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7765             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7766             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7767             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7768             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7769             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7770             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7771             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7772             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7773             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7774             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7775             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7776             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7777             20  FILLER                   PIC X(25).
  7778
  7779         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7780             CN-CSI-CREDIT-CARD-DATA.
  7781             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7782             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7783             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7784             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7785             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7786             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7787             20  FILLER                   PIC XX.
  7788             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7789             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7790             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7791             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 146
* EL156.cbl
  7792             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7793             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7794             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7795             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7796             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7797             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7798             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7799             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7800             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7801             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7802             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7803             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7804             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7805             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7806             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7807             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7808             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7809             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7810             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7811             20  FILLER                   PIC X(17).
  7812
  7813         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7814             CN-CSI-FAMILY-LEAVE-DATA.
  7815             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7816             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7817             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7818             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7819             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7820             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7821             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7822             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7823             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7824             20  CN-CSI-SL-INT-ON-PROCEEDS
  7825                                          PIC S9(5)V99  COMP-3.
  7826             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7827             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7828             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7829             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7830             20  CN-CSI-SL-POLICY-BENEFITS
  7831                                          PIC S9(5)V99  COMP-3.
  7832             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7833             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7834             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7835             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7836             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7837             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7838             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7839             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7840             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7841             20  CN-CSI-SL-STATE-NOT      PIC X.
  7842             20  FILLER                   PIC XX.
  7843
  7844         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7845             CN-CSI-SENIOR-LIFE-DATA.
  7846             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7847             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7848             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7849                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 147
* EL156.cbl
  7850             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7851             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7852             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7853             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7854             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7855             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7856             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7857             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7858             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7859             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7860             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7861             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7862             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7863             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7864             20  CN-CSI-PP-REPAIR         PIC X.
  7865             20  CN-CSI-PP-REPLACE        PIC X.
  7866             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7867             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7868             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7869             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7870             20  FILLER                   PIC X(5).
  7871
  7872         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7873             CN-CSI-PURCH-PROP-DATA.
  7874             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7875             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7876             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7877             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7878             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7879             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7880             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7881             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7882             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7883             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7884             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7885             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7886             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7887             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7888             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7889             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7890             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7891             20  CN-CSI-EW-REPLACE        PIC X.
  7892             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7893             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7894             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7895             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7896             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7897             20  FILLER                   PIC X(4).
  7898
  7899     12  CN-LAST-MAINT-DT                 PIC XX.
  7900     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7901     12  CN-LAST-MAINT-USER               PIC X(4).
  7902     12  FILLER                           PIC X(6).
  7903
  7904******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 148
* EL156.cbl
  7906*    COPY ERCCNOT.
  7907******************************************************************
  7908*                                                                *
  7909*                            ERCCNOT                             *
  7910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7911*                            VMOD=2.003                          *
  7912*                                                                *
  7913*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7914*                                                                *
  7915*        FILE TYPE= VSAM,KSDS                                    *
  7916*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7917*                                                                *
  7918*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7919*                                                                *
  7920*        LOG = YES                                               *
  7921*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7922*                                                                *
  7923******************************************************************
  7924*                   C H A N G E   L O G
  7925*
  7926* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7927*-----------------------------------------------------------------
  7928*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7929* EFFECTIVE    NUMBER
  7930*-----------------------------------------------------------------
  7931* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7932******************************************************************
  7933
  7934 01  CERT-NOTE-FILE.
  7935     12  CZ-RECORD-ID                PIC  XX.
  7936         88  VALID-CZ-ID                  VALUE 'CZ'.
  7937
  7938     12  CZ-CONTROL-PRIMARY.
  7939         16  CZ-COMPANY-CD           PIC X.
  7940         16  CZ-CARRIER              PIC X.
  7941         16  CZ-GROUPING.
  7942             20 CZ-GROUPING-PREFIX   PIC XXX.
  7943             20 CZ-GROUPING-PRIME    PIC XXX.
  7944         16  CZ-STATE                PIC XX.
  7945         16  CZ-ACCOUNT.
  7946             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7947             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7948         16  CZ-CERT-EFF-DT          PIC XX.
  7949         16  CZ-CERT-NO.
  7950             20  CZ-CERT-PRIME       PIC X(10).
  7951             20  CZ-CERT-SFX         PIC X.
  7952         16  CZ-RECORD-TYPE          PIC X.
  7953             88  CERT-NOTE           VALUE '1'.
  7954             88  CLAIM-CERT-NOTE     VALUE '2'.
  7955         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7956
  7957     12  CZ-LAST-MAINT-DT            PIC XX.
  7958     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7959     12  CZ-LAST-MAINT-USER          PIC X(4).
  7960
  7961     12  CZ-NOTE-INFORMATION.
  7962         16  CZ-NOTE                 PIC X(63).
  7963         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 149
* EL156.cbl
  7964******************************************************************
  7965*                            COPY ERCPDEF.
  7966******************************************************************
  7967*                                                                *
  7968*                                                                *
  7969*                            ERCPDEF.                            *
  7970*                                                                *
  7971*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7972*                                                                *
  7973*    FILE TYPE = VSAM,KSDS                                       *
  7974*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7975*                                                                *
  7976*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7977*                                                                *
  7978*    LOG = YES                                                   *
  7979*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7980******************************************************************
  7981*                   C H A N G E   L O G
  7982*
  7983* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7984*-----------------------------------------------------------------
  7985*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7986* EFFECTIVE    NUMBER
  7987*-----------------------------------------------------------------
  7988* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7989* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7990* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  7991******************************************************************
  7992 01  PRODUCT-MASTER.
  7993    12  PD-RECORD-ID                 PIC X(02).
  7994        88  VALID-PD-ID                  VALUE 'PD'.
  7995    12  PD-CONTROL-PRIMARY.
  7996        16  PD-COMPANY-CD            PIC X.
  7997        16  PD-STATE                 PIC XX.
  7998        16  PD-PRODUCT-CD            PIC XXX.
  7999        16  PD-FILLER                PIC X(7).
  8000        16  PD-BEN-TYPE              PIC X.
  8001        16  PD-BEN-CODE              PIC XX.
  8002        16  PD-PROD-EXP-DT           PIC XX.
  8003    12  FILLER                       PIC X(50).
  8004    12  PD-PRODUCT-DATA OCCURS 8.
  8005        16  PD-PROD-CODE             PIC X.
  8006            88  PD-PROD-LIFE           VALUE 'L'.
  8007            88  PD-PROD-PROP           VALUE 'P'.
  8008            88  PD-PROD-AH             VALUE 'A'.
  8009            88  PD-PROD-IU             VALUE 'I'.
  8010            88  PD-PROD-GAP            VALUE 'G'.
  8011            88  PD-PROD-FAML           VALUE 'F'.
  8012        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8013        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8014        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8015        16  PD-MAX-TERM              PIC S999        COMP-3.
  8016        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8017        16  FILLER                   PIC X.
  8018        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8019        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  8020        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8021        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 150
* EL156.cbl
  8022        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8023        16  PD-REC-CRIT-PERIOD       PIC 99.
  8024        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8025            20  PD-RECURRING-YN      PIC X.
  8026            20  FILLER               PIC X.
  8027        16  PD-RTW-MOS               PIC 99.
  8028        16  PD-MAX-EXTENSION         PIC 99.
  8029        16  pd-ben-pct               pic sv999 comp-3.
  8030*       16  FILLER                   PIC XX.
  8031    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8032    12  PD-TERM-LIMITS OCCURS 15.
  8033        16  PD-LOW-TERM              PIC S999        COMP-3.
  8034        16  PD-HI-TERM               PIC S999        COMP-3.
  8035*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8036    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8037        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8038        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8039    12  PD-EARN-FACTORS.
  8040        16  FILLER OCCURS 15.
  8041            20  FILLER OCCURS 15.
  8042                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8043    12  PD-PRODUCT-DESC              PIC X(80).
  8044    12  PD-TRUNCATED                 PIC X.
  8045    12  FILLER                       PIC X(59).
  8046    12  PD-MAINT-INFORMATION.
  8047        16  PD-LAST-MAINT-DT         PIC X(02).
  8048        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8049        16  PD-LAST-MAINT-BY         PIC X(04).
  8050*                            COPY ELCCRTT.
  8051******************************************************************
  8052*                                                                *
  8053*                            ELCCRTT.                            *
  8054*                                                                *
  8055*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8056*                                                                *
  8057*   FILE TYPE = VSAM,KSDS                                        *
  8058*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8059*                                                                *
  8060*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8061*                                                                *
  8062*   LOG = YES                                                    *
  8063*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8064******************************************************************
  8065*                   C H A N G E   L O G
  8066*
  8067* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8068*-----------------------------------------------------------------
  8069*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8070* EFFECTIVE    NUMBER
  8071*-----------------------------------------------------------------
  8072* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8073* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8074* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8075* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8076* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8077* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8078* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8079* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 151
* EL156.cbl
  8080******************************************************************
  8081
  8082 01  CERTIFICATE-TRAILERS.
  8083     12  CS-RECORD-ID                      PIC XX.
  8084         88  VALID-CS-ID                      VALUE 'CS'.
  8085
  8086     12  CS-CONTROL-PRIMARY.
  8087         16  CS-COMPANY-CD                 PIC X.
  8088         16  CS-CARRIER                    PIC X.
  8089         16  CS-GROUPING                   PIC X(6).
  8090         16  CS-STATE                      PIC XX.
  8091         16  CS-ACCOUNT                    PIC X(10).
  8092         16  CS-CERT-EFF-DT                PIC XX.
  8093         16  CS-CERT-NO.
  8094             20  CS-CERT-PRIME             PIC X(10).
  8095             20  CS-CERT-SFX               PIC X.
  8096         16  CS-TRAILER-TYPE               PIC X.
  8097             88  COMM-TRLR           VALUE 'A'.
  8098             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8099             88  CERT-DATA-TRLR      VALUE 'C'.
  8100
  8101     12  CS-DATA-AREA                      PIC X(516).
  8102
  8103     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8104         16  CS-BANK-COMMISSION-AREA.
  8105             20  CS-BANK-COMMS       OCCURS 10.
  8106                 24  CS-AGT                PIC X(10).
  8107                 24  CS-COM-TYP            PIC X.
  8108                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8109                 24  CS-RECALC-LV-INDIC    PIC X.
  8110                 24  FILLER                PIC X(10).
  8111         16  FILLER                        PIC X(256).
  8112
  8113     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8114****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8115         16  CS-MB-CLAIM-DATA OCCURS 24.
  8116             20  CS-CLAIM-NO               PIC X(7).
  8117             20  CS-CLAIM-TYPE             PIC X.
  8118                 88  CS-AH-CLM               VALUE 'A'.
  8119                 88  CS-IU-CLM               VALUE 'I'.
  8120                 88  CS-GP-CLM               VALUE 'G'.
  8121                 88  CS-LF-CLM               VALUE 'L'.
  8122                 88  CS-PR-CLM               VALUE 'P'.
  8123                 88  CS-FL-CLM               VALUE 'F'.
  8124             20  CS-INSURED-TYPE           PIC X.
  8125                 88  CS-PRIM-INSURED          VALUE 'P'.
  8126                 88  CS-CO-BORROWER           VALUE 'C'.
  8127             20  CS-BENEFIT-PERIOD         PIC 99.
  8128             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8129             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8130             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8131         16  FILLER                        PIC X(12).
  8132     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8133         16  CS-VIN-NUMBER                 PIC X(17).
  8134         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8135         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8136         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8137         16  cs-agent-name.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 152
* EL156.cbl
  8138             20  cs-agent-fname            pic x(20).
  8139             20  cs-agent-mi               pic x.
  8140             20  cs-agent-lname            pic x(25).
  8141         16  cs-license-no                 pic x(15).
  8142         16  cs-npn-number                 pic x(10).
  8143         16  cs-agent-edit-status          pic x.
  8144             88  cs-ae-refer-to-manager      value 'M'.
  8145             88  cs-ae-cover-sheet           value 'C'.
  8146             88  cs-ae-sig-form              value 'S'.
  8147             88  cs-ae-verified              value 'V'.
  8148             88  cs-unidentified-signature   value 'U'.
  8149             88  cs-cert-returned            value 'R'.
  8150             88  cs-accept-no-commission     value 'N'.
  8151         16  FILLER                        PIC X(424).
  8152*        16  FILLER                        PIC X(496).
  8153 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8154                          CONTROL-FILE CERTIFICATE-MASTER
  8155                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8156                          ACCOUNT-MASTER CHECK-QUE
  8157                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8158                          DAILY-ACTIVITY-RECORD
  8159                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8160                          CERT-NOTE-FILE PRODUCT-MASTER
  8161                          CERTIFICATE-TRAILERS.
  8162 0000-DFHEXIT SECTION.
  8163     MOVE '9#                    $   ' TO DFHEIV0.
  8164     MOVE 'EL156' TO DFHEIV1.
  8165     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8166
  8167     IF EIBCALEN = 0
  8168         GO TO 8800-UNAUTHORIZED-ACCESS.
  8169
  8170     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8171     MOVE EIBTRMID               TO QID-TERM.
  8172     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8173     MOVE '2'                    TO EMI-SWITCH2.
  8174     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8175     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8176
  8177     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8178     MOVE '5'                    TO DC-OPTION-CODE.
  8179     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8180     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8181                                    SAVE-BIN-DATE.
  8182     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8183     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8184
  8185     IF SAVE-DATE-YY > 70
  8186         MOVE 19                 TO SAVE-DATE-CC
  8187     ELSE
  8188         MOVE 20                 TO SAVE-DATE-CC.
  8189
  8190     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8191         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8192     END-IF.
  8193
  8194     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8195        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 153
* EL156.cbl
  8196     ELSE
  8197        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8198     END-IF
  8199
  8200     IF PI-PRINT-CLM-FRM-YN = 'N'
  8201         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8202     ELSE
  8203         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8204     END-IF
  8205
  8206     IF PI-PRINT-SURVEY-YN = 'N'
  8207         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8208     ELSE
  8209         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8210     END-IF
  8211
  8212     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8213         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8214     ELSE
  8215         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8216     END-IF
  8217
  8218* EXEC CICS HANDLE CONDITION
  8219*        NOTOPEN   (9990-ABEND)
  8220*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8221*        MAPFAIL   (0400-FIRST-TIME)
  8222*        DUPREC    (6180-DUPREC)
  8223*        ERROR     (9990-ABEND)
  8224*    END-EXEC.
  8225*    MOVE '"$JL?%.               ! " #00008213' TO DFHEIV0
  8226     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8227     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8228     MOVE X'2220233030303038323133' TO DFHEIV0(25:11)
  8229     CALL 'kxdfhei1' USING DFHEIV0
  8230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8231
  8232
  8233     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8234         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8235
  8236     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8237         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8238             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8239             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8240             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8241             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8242             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8243             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8244             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8245             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8246             MOVE LOW-VALUES           TO EL156AI
  8247             MOVE 'Y'                  TO FIRST-ENTRY
  8248         ELSE
  8249             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8250             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8251             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8252             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8253             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 154
* EL156.cbl
  8254             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8255             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8256             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8257
  8258     IF RETURNED-FROM NOT = SPACES
  8259        IF (RETURNED-FROM = 'EL614')
  8260           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8261           IF WS-SAVED-EOB-CODES NOT = SPACES
  8262              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8263           ELSE
  8264              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8265           END-IF
  8266        END-IF
  8267         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8268            MOVE 'Y'             TO FIRST-ENTRY
  8269            IF RETURNED-FROM = 'EL614'
  8270               AND (PI-PASS-SW NOT = 'C')
  8271               IF WS-SAVED-EOB-CODES NOT = SPACES
  8272                  MOVE WS-SAVED-EOB-CODES
  8273                                 TO PI-PMTNOTE2
  8274                                    WS-PMTNOTE2
  8275                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8276               ELSE
  8277                  MOVE SPACES    TO PI-PMTNOTE2
  8278                                    WS-PMTNOTE2
  8279                                    PI-EOB-CODES-EXIST
  8280               END-IF
  8281            END-IF
  8282            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8283            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8284            IF RETURNED-FROM = 'EL614'
  8285               GO TO 1000-EDIT-DATA
  8286            END-IF
  8287            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8288               (PAYEEI   = LOW-VALUES OR SPACES)
  8289               GO TO 8100-SEND-INITIAL-MAP
  8290            ELSE
  8291               GO TO 1000-EDIT-DATA.
  8292
  8293     IF EIBTRNID NOT = TRANS-ID
  8294         GO TO 0400-FIRST-TIME.
  8295
  8296     IF EIBAID = DFHCLEAR
  8297        IF PI-PASS-SW = 'C'
  8298           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8299           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8300           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8301           MOVE 'Y'            TO RETURNED-FROM-B
  8302           GO TO 1000-EDIT-DATA
  8303        ELSE
  8304           GO TO 9400-CLEAR.
  8305
  8306     IF PI-PASS-SW = 'C'
  8307         MOVE MAP-NAMEB          TO MAP-NAME
  8308         IF EIBAID = DFHPF1 OR DFHPF13
  8309             GO TO 5000-UPDATE
  8310           ELSE
  8311             IF EIBAID NOT = DFHENTER
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 155
* EL156.cbl
  8312                 MOVE LOW-VALUES TO EL156BI
  8313                 MOVE MAP-NAMEB  TO MAP-NAME
  8314                 MOVE ER-0029    TO EMI-ERROR
  8315                 MOVE -1         TO  ENTPFBL
  8316                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8317                 GO TO 8200-SEND-DATAONLY.
  8318
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 156
* EL156.cbl
  8320 0200-RECEIVE.
  8321     MOVE LOW-VALUES             TO EL156AI.
  8322     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8323         MOVE ER-0008            TO EMI-ERROR
  8324         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8325         IF PI-PASS-SW = 'C'
  8326             MOVE -1             TO ENTPFBL
  8327             GO TO 8200-SEND-DATAONLY
  8328         ELSE
  8329             MOVE -1             TO PMTTYPEL
  8330             GO TO 8200-SEND-DATAONLY.
  8331
  8332     IF PI-COMPANY-ID = 'DMD'
  8333         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8334
  8335     IF PI-PASS-SW = 'C'
  8336         MOVE MAP-NAMEB          TO MAP-NAME.
  8337
  8338
  8339* EXEC CICS RECEIVE
  8340*        MAP   (MAP-NAME)
  8341*        MAPSET(MAPSET-NAME)
  8342*        ASIS
  8343*        INTO  (EL156AI)
  8344*    END-EXEC.
  8345     MOVE LENGTH OF
  8346      EL156AI
  8347       TO DFHEIV11
  8348*    MOVE '8"TAI  L              ''   #00008326' TO DFHEIV0
  8349     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8350     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8351     MOVE X'2020233030303038333236' TO DFHEIV0(25:11)
  8352     CALL 'kxdfhei1' USING DFHEIV0,
  8353           MAP-NAME,
  8354           EL156AI,
  8355           DFHEIV11,
  8356           MAPSET-NAME,
  8357           DFHEIV99,
  8358           DFHEIV99
  8359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8360
  8361
  8362     IF PI-PASS-SW NOT = 'C'
  8363         GO TO 0250-MAPA.
  8364
  8365     IF ENTPFBL NOT > ZERO
  8366         MOVE MAP-NAMEB          TO MAP-NAME
  8367         MOVE ER-0029            TO EMI-ERROR
  8368         MOVE -1                 TO  ENTPFBL
  8369         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8370         GO TO 8200-SEND-DATAONLY.
  8371
  8372     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8373         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8374       ELSE
  8375         MOVE MAP-NAMEB           TO MAP-NAME
  8376         MOVE ER-0029             TO EMI-ERROR
  8377         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 157
* EL156.cbl
  8378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8379         GO TO 8200-SEND-DATAONLY.
  8380
  8381     IF EIBAID = DFHPF1 OR DFHPF13
  8382         IF MODIFY-CAP
  8383            GO TO 5000-UPDATE
  8384          ELSE
  8385            MOVE 'UPDATE'           TO SM-READ
  8386            PERFORM 9995-SECURITY-VIOLATION
  8387            MOVE MAP-NAMEB          TO MAP-NAME
  8388            MOVE ER-0070            TO EMI-ERROR
  8389            MOVE -1                 TO  ENTPFBL
  8390            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8391            GO TO 8200-SEND-DATAONLY.
  8392
  8393 0250-MAPA.
  8394     IF ENTERPFL = 0
  8395         GO TO 0300-CHECK-PFKEYS.
  8396
  8397     IF EIBAID NOT = DFHENTER
  8398         MOVE ER-0004            TO EMI-ERROR
  8399         GO TO 0320-INPUT-ERROR.
  8400
  8401     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8402         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8403     ELSE
  8404         MOVE ER-0029            TO EMI-ERROR
  8405         GO TO 0320-INPUT-ERROR.
  8406
  8407 0300-CHECK-PFKEYS.
  8408     IF EIBAID = DFHPF7 OR DFHPF8
  8409         GO TO 8820-PF7-8.
  8410
  8411     IF EIBAID = DFHPF23
  8412         GO TO 8810-PF23.
  8413
  8414     IF EIBAID = DFHPF24
  8415         GO TO 9200-RETURN-MAIN-MENU.
  8416
  8417     IF EIBAID = DFHPF12
  8418         GO TO 9500-PF12.
  8419
  8420     IF EIBAID = DFHPF1
  8421        IF PI-PASS-SW = 'A' OR 'B'
  8422          GO TO 0330-BROWSE-FORWARD.
  8423
  8424     IF EIBAID = DFHPF2
  8425        IF PI-PASS-SW = 'A' OR 'B'
  8426          GO TO 0350-BROWSE-BACKWARD.
  8427
  8428     IF EIBAID = DFHPF6
  8429        IF PI-EOB-CODES-EXIST = 'Y'
  8430           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8431        ELSE
  8432           MOVE SPACES              TO WS-PMTNOTE2
  8433        END-IF
  8434         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8435         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 158
* EL156.cbl
  8436            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8437         END-IF
  8438         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8439         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  8440             MOVE 'EL614'        TO PGM-NAME
  8441             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8442             GO TO 9300-XCTL
  8443         ELSE
  8444             MOVE XCTL-157       TO PGM-NAME
  8445             GO TO 9300-XCTL.
  8446
  8447     IF EIBAID = DFHPF9
  8448        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8449        MOVE XCTL-141            TO PGM-NAME
  8450        GO TO 9300-XCTL.
  8451
  8452     IF EIBAID = DFHPF10
  8453        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8454        MOVE XCTL-155            TO PGM-NAME
  8455        GO TO 9300-XCTL.
  8456
  8457     MOVE SPACES                 TO ERRMSG0O
  8458                                    ERRMSG1O
  8459                                    ERRMSG2O.
  8460
  8461     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8462         IF PI-PASS-SW NOT = 'B'
  8463             MOVE ER-0422        TO EMI-ERROR
  8464             GO TO 0320-INPUT-ERROR
  8465           ELSE
  8466             GO TO 0700-TEST-FOR-CHANGES.
  8467
  8468     IF EIBAID = DFHPF11
  8469        IF PI-PASS-SW = 'C'
  8470           MOVE ER-0029          TO EMI-ERROR
  8471           GO TO 0320-INPUT-ERROR.
  8472
  8473     IF EIBAID = DFHENTER OR DFHPF11
  8474        NEXT SENTENCE
  8475     ELSE
  8476        MOVE ER-0029             TO EMI-ERROR
  8477        GO TO 0320-INPUT-ERROR.
  8478
  8479     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8480
  8481     if pi-epyfrom not = zeros
  8482        if pi-epyfrom not = ws-epyfrom
  8483           move zeros        to ws-edays
  8484        end-if
  8485     end-if
  8486
  8487     if pi-epythru not = zeros
  8488        if pi-epythru not = ws-epythru
  8489           move zeros        to ws-edays
  8490        end-if
  8491     end-if
  8492
  8493     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 159
* EL156.cbl
  8494         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8495         GO TO 1000-EDIT-DATA
  8496     ELSE
  8497         IF PI-FATAL-COUNT NOT = 0 OR
  8498            PI-FORCE-COUNT NOT = 0
  8499             GO TO 1000-EDIT-DATA
  8500         ELSE
  8501             GO TO 2000-EDIT-DONE.
  8502
  8503 0320-INPUT-ERROR.
  8504     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8505
  8506     IF ENTERPFL = 0
  8507         MOVE -1                 TO PMTTYPEL
  8508     ELSE
  8509         MOVE AL-UNBON           TO ENTERPFA
  8510         MOVE -1                 TO ENTERPFL.
  8511
  8512     GO TO 8200-SEND-DATAONLY.
  8513
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 160
* EL156.cbl
  8515 0330-BROWSE-FORWARD.
  8516
  8517     MOVE CLMNOI            TO PI-CLAIM-NO.
  8518     MOVE CARRI             TO PI-CARRIER.
  8519     MOVE CERTNOI           TO PI-CERT-PRIME.
  8520     MOVE SUFXI             TO PI-CERT-SFX.
  8521
  8522     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8523     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8524     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8525     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8526
  8527     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8528
  8529
  8530* EXEC CICS HANDLE CONDITION
  8531*         NOTFND   (0380-CLAIM-END-FILE)
  8532*         ENDFILE  (0380-CLAIM-END-FILE)
  8533*    END-EXEC.
  8534*    MOVE '"$I''                  ! # #00008500' TO DFHEIV0
  8535     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8537     MOVE X'2320233030303038353030' TO DFHEIV0(25:11)
  8538     CALL 'kxdfhei1' USING DFHEIV0
  8539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8540
  8541
  8542
  8543* EXEC CICS STARTBR
  8544*         DATASET    ('ELMSTR')
  8545*         RIDFLD     (ELMSTR-KEY)
  8546*         GTEQ
  8547*    END-EXEC.
  8548     MOVE 'ELMSTR' TO DFHEIV1
  8549     MOVE 0
  8550       TO DFHEIV11
  8551*    MOVE '&,         G          &   #00008505' TO DFHEIV0
  8552     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8553     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8554     MOVE X'2020233030303038353035' TO DFHEIV0(25:11)
  8555     CALL 'kxdfhei1' USING DFHEIV0,
  8556           DFHEIV1,
  8557           ELMSTR-KEY,
  8558           DFHEIV99,
  8559           DFHEIV11,
  8560           DFHEIV99
  8561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8562
  8563
  8564     MOVE 'Y' TO WS-BROWSE-START-SW.
  8565
  8566 0335-READNEXT.
  8567
  8568
  8569* EXEC CICS READNEXT
  8570*         DATASET    ('ELMSTR')
  8571*         RIDFLD     (ELMSTR-KEY)
  8572*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 161
* EL156.cbl
  8573*    END-EXEC.
  8574     MOVE 'ELMSTR' TO DFHEIV1
  8575     MOVE 0
  8576       TO DFHEIV11
  8577*    MOVE '&.S                   )   #00008515' TO DFHEIV0
  8578     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8579     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8580     MOVE X'2020233030303038353135' TO DFHEIV0(25:11)
  8581     CALL 'kxdfhei1' USING DFHEIV0,
  8582           DFHEIV1,
  8583           DFHEIV20,
  8584           DFHEIV99,
  8585           ELMSTR-KEY,
  8586           DFHEIV99,
  8587           DFHEIV11,
  8588           DFHEIV99,
  8589           DFHEIV99
  8590     SET ADDRESS OF CLAIM-MASTER TO
  8591         DFHEIV20
  8592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8593
  8594
  8595     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8596        GO TO 0380-CLAIM-END-FILE.
  8597
  8598     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8599        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8600        GO TO 0335-READNEXT.
  8601
  8602     IF PI-COMPANY-ID = 'CRI'
  8603         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8604            GO TO 0380-CLAIM-END-FILE.
  8605
  8606     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8607         GO TO 0335-READNEXT.
  8608
  8609     IF PI-CARRIER-SECURITY > SPACES
  8610         IF CL-CARRIER = PI-CARRIER-SECURITY
  8611             NEXT SENTENCE
  8612         ELSE
  8613             GO TO 0335-READNEXT.
  8614
  8615     IF PI-ACCOUNT-SECURITY > SPACES
  8616         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8617             NEXT SENTENCE
  8618         ELSE
  8619             GO TO 0335-READNEXT.
  8620
  8621     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8622     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8623     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8624
  8625     GO TO 0400-FIRST-TIME.
  8626
  8627 0350-BROWSE-BACKWARD.
  8628
  8629     MOVE CLMNOI            TO PI-CLAIM-NO
  8630                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 162
* EL156.cbl
  8631     MOVE CARRI             TO PI-CARRIER.
  8632     MOVE CERTNOI           TO PI-CERT-PRIME.
  8633     MOVE SUFXI             TO PI-CERT-SFX.
  8634
  8635     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8636
  8637     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8638     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8639     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8640
  8641
  8642* EXEC CICS HANDLE CONDITION
  8643*         NOTFND   (0380-CLAIM-END-FILE)
  8644*         ENDFILE  (0380-CLAIM-END-FILE)
  8645*    END-EXEC.
  8646*    MOVE '"$I''                  ! $ #00008567' TO DFHEIV0
  8647     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8649     MOVE X'2420233030303038353637' TO DFHEIV0(25:11)
  8650     CALL 'kxdfhei1' USING DFHEIV0
  8651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8652
  8653
  8654
  8655* EXEC CICS STARTBR
  8656*         DATASET    ('ELMSTR')
  8657*         RIDFLD     (ELMSTR-KEY)
  8658*         GTEQ
  8659*    END-EXEC.
  8660     MOVE 'ELMSTR' TO DFHEIV1
  8661     MOVE 0
  8662       TO DFHEIV11
  8663*    MOVE '&,         G          &   #00008572' TO DFHEIV0
  8664     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8665     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8666     MOVE X'2020233030303038353732' TO DFHEIV0(25:11)
  8667     CALL 'kxdfhei1' USING DFHEIV0,
  8668           DFHEIV1,
  8669           ELMSTR-KEY,
  8670           DFHEIV99,
  8671           DFHEIV11,
  8672           DFHEIV99
  8673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8674
  8675
  8676     MOVE 'Y' TO WS-BROWSE-START-SW.
  8677
  8678
  8679* EXEC CICS READNEXT
  8680*         DATASET    ('ELMSTR')
  8681*         RIDFLD     (ELMSTR-KEY)
  8682*         SET        (ADDRESS OF CLAIM-MASTER)
  8683*    END-EXEC.
  8684     MOVE 'ELMSTR' TO DFHEIV1
  8685     MOVE 0
  8686       TO DFHEIV11
  8687*    MOVE '&.S                   )   #00008580' TO DFHEIV0
  8688     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 163
* EL156.cbl
  8689     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8690     MOVE X'2020233030303038353830' TO DFHEIV0(25:11)
  8691     CALL 'kxdfhei1' USING DFHEIV0,
  8692           DFHEIV1,
  8693           DFHEIV20,
  8694           DFHEIV99,
  8695           ELMSTR-KEY,
  8696           DFHEIV99,
  8697           DFHEIV11,
  8698           DFHEIV99,
  8699           DFHEIV99
  8700     SET ADDRESS OF CLAIM-MASTER TO
  8701         DFHEIV20
  8702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8703
  8704
  8705
  8706* EXEC CICS READPREV
  8707*         DATASET    ('ELMSTR')
  8708*         RIDFLD     (ELMSTR-KEY)
  8709*         SET        (ADDRESS OF CLAIM-MASTER)
  8710*    END-EXEC.
  8711     MOVE 'ELMSTR' TO DFHEIV1
  8712     MOVE 0
  8713       TO DFHEIV11
  8714*    MOVE '&0S                   )   #00008586' TO DFHEIV0
  8715     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8716     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8717     MOVE X'2020233030303038353836' TO DFHEIV0(25:11)
  8718     CALL 'kxdfhei1' USING DFHEIV0,
  8719           DFHEIV1,
  8720           DFHEIV20,
  8721           DFHEIV99,
  8722           ELMSTR-KEY,
  8723           DFHEIV99,
  8724           DFHEIV11,
  8725           DFHEIV99,
  8726           DFHEIV99
  8727     SET ADDRESS OF CLAIM-MASTER TO
  8728         DFHEIV20
  8729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8730
  8731
  8732 0360-BROWSE-BACKWARD.
  8733
  8734
  8735* EXEC CICS READPREV
  8736*         DATASET    ('ELMSTR')
  8737*         RIDFLD     (ELMSTR-KEY)
  8738*         SET        (ADDRESS OF CLAIM-MASTER)
  8739*    END-EXEC.
  8740     MOVE 'ELMSTR' TO DFHEIV1
  8741     MOVE 0
  8742       TO DFHEIV11
  8743*    MOVE '&0S                   )   #00008594' TO DFHEIV0
  8744     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8745     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8746     MOVE X'2020233030303038353934' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 164
* EL156.cbl
  8747     CALL 'kxdfhei1' USING DFHEIV0,
  8748           DFHEIV1,
  8749           DFHEIV20,
  8750           DFHEIV99,
  8751           ELMSTR-KEY,
  8752           DFHEIV99,
  8753           DFHEIV11,
  8754           DFHEIV99,
  8755           DFHEIV99
  8756     SET ADDRESS OF CLAIM-MASTER TO
  8757         DFHEIV20
  8758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8759
  8760
  8761     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8762        GO TO 0380-CLAIM-END-FILE.
  8763
  8764     IF PI-COMPANY-ID = 'CRI'
  8765         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8766            GO TO 0380-CLAIM-END-FILE.
  8767
  8768     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8769         GO TO 0360-BROWSE-BACKWARD.
  8770
  8771     IF PI-CARRIER-SECURITY > SPACES
  8772         IF CL-CARRIER = PI-CARRIER-SECURITY
  8773             NEXT SENTENCE
  8774         ELSE
  8775             GO TO 0360-BROWSE-BACKWARD.
  8776
  8777     IF PI-ACCOUNT-SECURITY > SPACES
  8778         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8779             NEXT SENTENCE
  8780         ELSE
  8781             GO TO 0360-BROWSE-BACKWARD.
  8782
  8783     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8784     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8785     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8786
  8787     GO TO 0400-FIRST-TIME.
  8788
  8789 0380-CLAIM-END-FILE.
  8790
  8791     MOVE ER-0130     TO EMI-ERROR.
  8792     MOVE -1          TO CLMNOL.
  8793     MOVE AL-UABON    TO CARRA
  8794                         CLMNOA
  8795                         CERTNOA
  8796                         SUFXA.
  8797
  8798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8799
  8800     GO TO 8200-SEND-DATAONLY.
  8801
  8802 0400-FIRST-TIME.
  8803
  8804     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 165
* EL156.cbl
  8805        MOVE 'N'         TO WS-BROWSE-START-SW
  8806
  8807* EXEC CICS ENDBR
  8808*            DATASET    ('ELMSTR')
  8809*       END-EXEC.
  8810     MOVE 'ELMSTR' TO DFHEIV1
  8811     MOVE 0
  8812       TO DFHEIV11
  8813*    MOVE '&2                    $   #00008645' TO DFHEIV0
  8814     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8815     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8816     MOVE X'2020233030303038363435' TO DFHEIV0(25:11)
  8817     CALL 'kxdfhei1' USING DFHEIV0,
  8818           DFHEIV1,
  8819           DFHEIV11,
  8820           DFHEIV99
  8821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8822
  8823
  8824     IF PI-PROCESSOR-ID = 'LGXX'
  8825         NEXT SENTENCE
  8826     ELSE
  8827
  8828* EXEC CICS READQ TS
  8829*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8830*            INTO    (SECURITY-CONTROL)
  8831*            LENGTH  (SC-COMM-LENGTH)
  8832*            ITEM    (SC-ITEM)
  8833*        END-EXEC
  8834*    MOVE '*$II   L              ''   #00008652' TO DFHEIV0
  8835     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8836     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8837     MOVE X'2020233030303038363532' TO DFHEIV0(25:11)
  8838     CALL 'kxdfhei1' USING DFHEIV0,
  8839           PI-SECURITY-TEMP-STORE-ID,
  8840           SECURITY-CONTROL,
  8841           SC-COMM-LENGTH,
  8842           SC-ITEM,
  8843           DFHEIV99,
  8844           DFHEIV99
  8845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8846         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8847         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8848
  8849     MOVE LOW-VALUES             TO EL156AI.
  8850     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8851     MOVE 'Y'                    TO FIRST-ENTRY.
  8852     GO TO 7000-SHOW-CLAIM.
  8853
  8854 0500-CREATE-TEMP-STORAGE.
  8855     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8856
  8857
  8858* EXEC CICS WRITEQ TS
  8859*        QUEUE (QID)
  8860*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8861*        LENGTH(PI-COMM-LENGTH)
  8862*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 166
* EL156.cbl
  8863*    MOVE '*"                    ''   #00008669' TO DFHEIV0
  8864     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8865     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8866     MOVE X'2020233030303038363639' TO DFHEIV0(25:11)
  8867     CALL 'kxdfhei1' USING DFHEIV0,
  8868           QID,
  8869           PROGRAM-INTERFACE-BLOCK,
  8870           PI-COMM-LENGTH,
  8871           DFHEIV99,
  8872           DFHEIV99,
  8873           DFHEIV99
  8874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8875
  8876
  8877
  8878* EXEC CICS WRITEQ TS
  8879*        QUEUE (QID)
  8880*        FROM  (EL156AI)
  8881*        LENGTH(MAP-LENGTH)
  8882*    END-EXEC.
  8883*    MOVE '*"                    ''   #00008675' TO DFHEIV0
  8884     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8885     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8886     MOVE X'2020233030303038363735' TO DFHEIV0(25:11)
  8887     CALL 'kxdfhei1' USING DFHEIV0,
  8888           QID,
  8889           EL156AI,
  8890           MAP-LENGTH,
  8891           DFHEIV99,
  8892           DFHEIV99,
  8893           DFHEIV99
  8894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8895
  8896
  8897 0599-EXIT.
  8898      EXIT.
  8899
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 167
* EL156.cbl
  8901 0600-RECOVER-TEMP-STORAGE.
  8902
  8903* EXEC CICS READQ TS
  8904*        QUEUE (QID)
  8905*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8906*        LENGTH(PI-COMM-LENGTH)
  8907*    END-EXEC.
  8908*    MOVE '*$I    L              ''   #00008686' TO DFHEIV0
  8909     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8910     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8911     MOVE X'2020233030303038363836' TO DFHEIV0(25:11)
  8912     CALL 'kxdfhei1' USING DFHEIV0,
  8913           QID,
  8914           PROGRAM-INTERFACE-BLOCK,
  8915           PI-COMM-LENGTH,
  8916           DFHEIV99,
  8917           DFHEIV99,
  8918           DFHEIV99
  8919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8920
  8921
  8922
  8923* EXEC CICS READQ TS
  8924*        QUEUE (QID)
  8925*        INTO  (EL156AI)
  8926*        LENGTH(MAP-LENGTH)
  8927*    END-EXEC.
  8928*    MOVE '*$I    L              ''   #00008692' TO DFHEIV0
  8929     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8930     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8931     MOVE X'2020233030303038363932' TO DFHEIV0(25:11)
  8932     CALL 'kxdfhei1' USING DFHEIV0,
  8933           QID,
  8934           EL156AI,
  8935           MAP-LENGTH,
  8936           DFHEIV99,
  8937           DFHEIV99,
  8938           DFHEIV99
  8939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8940
  8941
  8942     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8943
  8944     IF PMTTYPEI NOT = LOW-VALUES
  8945         MOVE AL-UANON           TO PMTTYPEA.
  8946
  8947     IF PAYEEI NOT = LOW-VALUES
  8948         MOVE AL-UANON           TO PAYEEA.
  8949
  8950     IF NOTE1I NOT = LOW-VALUES
  8951         MOVE AL-UANON           TO NOTE1A.
  8952
  8953     IF (RETURNED-FROM = 'EL614')
  8954        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8955     END-IF
  8956*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8957*       AND (PI-EOB-CODES-EXIST = 'Y')
  8958*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 168
* EL156.cbl
  8959*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8960     IF PI-SET-NOTE2-MDT = 'Y'
  8961         MOVE AL-SANON           TO NOTE2A
  8962     END-IF
  8963
  8964     IF OFFLINEI NOT = LOW-VALUES
  8965         MOVE AL-UANON           TO OFFLINEA.
  8966
  8967*    IF GROUPEDI NOT = LOW-VALUES
  8968*        MOVE AL-UANON           TO GROUPEDA.
  8969
  8970*    IF CASHI NOT = LOW-VALUES
  8971*        MOVE AL-UANON           TO CASHA.
  8972
  8973     IF CHECKNOI NOT = LOW-VALUES
  8974         MOVE AL-UANON           TO CHECKNOA.
  8975
  8976     IF HOLDTILI NOT = LOW-VALUES
  8977         MOVE AL-UANON           TO HOLDTILA.
  8978
  8979     IF EPYFROMI NOT = LOW-VALUES
  8980         MOVE AL-UANON           TO EPYFROMA.
  8981
  8982     IF AIGFROMI NOT = LOW-VALUES
  8983         MOVE AL-UANON           TO AIGFROMA.
  8984
  8985     IF EPYTHRUI NOT = LOW-VALUES
  8986         MOVE AL-UANON           TO EPYTHRUA.
  8987
  8988     IF EDAYSI NOT = LOW-VALUES
  8989         MOVE AL-UNNON           TO EDAYSA.
  8990
  8991     IF EPYAMTL NOT = +0
  8992         MOVE AL-UNNON           TO EPYAMTA.
  8993
  8994     IF ERESVL NOT = +0
  8995         MOVE AL-UNNON           TO ERESVA.
  8996
  8997     IF EEXPENSL NOT = +0
  8998         MOVE AL-UNNON           TO EEXPENSA.
  8999
  9000     IF ETYPEI NOT = LOW-VALUES
  9001         MOVE AL-UNNON           TO ETYPEA.
  9002
  9003     IF PROOFDTI NOT = 0
  9004         MOVE AL-UNNON           TO PROOFDTA.
  9005
  9006     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9007        MOVE AL-UANON            TO EOBYNA
  9008     END-IF
  9009     IF CLMFMYNI = 'Y' OR 'N'
  9010        MOVE AL-UANON            TO CLMFMYNA
  9011     END-IF
  9012
  9013     IF SURVYYNI = 'Y' OR 'N'
  9014        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9015           MOVE AL-UANON         TO SURVYYNA
  9016        END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 169
* EL156.cbl
  9017     END-IF
  9018
  9019     IF SPRELYNI = 'Y' OR 'N'
  9020        MOVE AL-UANON            TO SPRELYNA
  9021     END-IF
  9022
  9023     .
  9024 0699-EXIT.
  9025      EXIT.
  9026
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 170
* EL156.cbl
  9028 0700-TEST-FOR-CHANGES.
  9029     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9030         MOVE ER-0433            TO EMI-ERROR
  9031         GO TO 0750-FUNCTION-ERROR.
  9032
  9033     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9034
  9035     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9036         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9037         MOVE 'A'                TO PI-PASS-SW
  9038         GO TO 1000-EDIT-DATA.
  9039
  9040     IF PI-FATAL-COUNT NOT = 0
  9041         MOVE ER-0499            TO EMI-ERROR
  9042         GO TO 0750-FUNCTION-ERROR.
  9043
  9044     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9045         MOVE ER-0500            TO EMI-ERROR
  9046         GO TO 0750-FUNCTION-ERROR.
  9047
  9048     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9049        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9050           MOVE ER-0542          TO EMI-ERROR
  9051           MOVE -1               TO EPYAMTL
  9052           GO TO 0750-FUNCTION-ERROR.
  9053
  9054     IF PI-OFFLINE = 'Y'  OR
  9055        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9056        MOVE EIBAID              TO PI-PFKEY-USED
  9057        GO TO 5000-UPDATE.
  9058
  9059     GO TO 6000-BUILD-SCREEN-B.
  9060
  9061 0750-FUNCTION-ERROR.
  9062     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9063
  9064     IF ENTERPFL > 0
  9065         MOVE -1                 TO ENTERPFL
  9066         MOVE AL-UNBON           TO ENTERPFA
  9067         GO TO 8200-SEND-DATAONLY
  9068     ELSE
  9069         MOVE -1                 TO ENTERPFL
  9070         MOVE AL-UNNOF           TO ENTERPFA
  9071         GO TO 8200-SEND-DATAONLY.
  9072
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 171
* EL156.cbl
  9074 0800-DELETE-TS.
  9075
  9076* EXEC CICS HANDLE CONDITION
  9077*        QIDERR(0800-EXIT)
  9078*    END-EXEC.
  9079*    MOVE '"$N                   ! % #00008831' TO DFHEIV0
  9080     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9082     MOVE X'2520233030303038383331' TO DFHEIV0(25:11)
  9083     CALL 'kxdfhei1' USING DFHEIV0
  9084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9085
  9086
  9087
  9088* EXEC CICS DELETEQ TS
  9089*        QUEUE(QID)
  9090*    END-EXEC.
  9091*    MOVE '*&                    #   #00008835' TO DFHEIV0
  9092     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9093     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9094     MOVE X'2020233030303038383335' TO DFHEIV0(25:11)
  9095     CALL 'kxdfhei1' USING DFHEIV0,
  9096           QID,
  9097           DFHEIV99
  9098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9099
  9100
  9101 0800-EXIT.
  9102      EXIT.
  9103 0900-GET-DDF-LIMITS.
  9104
  9105     if cm-clp-state = zeros or spaces or low-values
  9106        move cm-state            to cm-clp-state
  9107     end-if
  9108     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9109     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9110     MOVE cm-clp-state           TO ERPDEF-STATE
  9111     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9112     evaluate true
  9113        when (cl-claim-type = 'L' or 'P')
  9114           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9115             and 'CU')
  9116           move 'L'              to erpdef-ben-type
  9117           move pi-lf-benefit-cd to erpdef-ben-code
  9118        when (cl-claim-type not = 'L' and 'P')
  9119           and (pi-ah-benefit-cd not = '00' and '  ')
  9120           move 'A'              to erpdef-ben-type
  9121           move pi-ah-benefit-cd to erpdef-ben-code
  9122        when (cl-claim-type not = 'L' and 'P')
  9123           and (pi-ah-benefit-cd = '00' or '  ')
  9124           move 'L'              to erpdef-ben-type
  9125           move pi-lf-benefit-cd to erpdef-ben-code
  9126        when (cl-claim-type = 'L' or 'P')
  9127           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9128           move 'A'              to erpdef-ben-type
  9129           move pi-ah-benefit-cd to erpdef-ben-code
  9130        when other
  9131           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 172
* EL156.cbl
  9132           move pi-ah-benefit-cd to erpdef-ben-code
  9133     end-evaluate
  9134*    if (cl-claim-type = 'L' or 'P')
  9135*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9136*          and 'CU')
  9137*       move 'L'                 to erpdef-ben-type
  9138*       move pi-lf-benefit-cd    to erpdef-ben-code
  9139*    else
  9140*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9141*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9142*    end-if
  9143     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9144
  9145     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9146
  9147
  9148* EXEC CICS STARTBR
  9149*        DATASET  ('ERPDEF')
  9150*        RIDFLD   (ERPDEF-KEY)
  9151*        GTEQ
  9152*        RESP     (WS-RESPONSE)
  9153*    END-EXEC
  9154     MOVE 'ERPDEF' TO DFHEIV1
  9155     MOVE 0
  9156       TO DFHEIV11
  9157*    MOVE '&,         G          &  N#00008885' TO DFHEIV0
  9158     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9159     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9160     MOVE X'204E233030303038383835' TO DFHEIV0(25:11)
  9161     CALL 'kxdfhei1' USING DFHEIV0,
  9162           DFHEIV1,
  9163           ERPDEF-KEY,
  9164           DFHEIV99,
  9165           DFHEIV11,
  9166           DFHEIV99
  9167     MOVE EIBRESP  TO WS-RESPONSE
  9168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9169
  9170     IF NOT WS-RESP-NORMAL
  9171        GO TO 0900-EXIT
  9172     END-IF
  9173
  9174     .
  9175 0900-READNEXT.
  9176
  9177
  9178* EXEC CICS READNEXT
  9179*       DATASET  ('ERPDEF')
  9180*       SET      (ADDRESS OF PRODUCT-MASTER)
  9181*       RIDFLD   (ERPDEF-KEY)
  9182*       RESP     (WS-RESPONSE)
  9183*    END-EXEC
  9184     MOVE 'ERPDEF' TO DFHEIV1
  9185     MOVE 0
  9186       TO DFHEIV11
  9187*    MOVE '&.S                   )  N#00008899' TO DFHEIV0
  9188     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9189     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 173
* EL156.cbl
  9190     MOVE X'204E233030303038383939' TO DFHEIV0(25:11)
  9191     CALL 'kxdfhei1' USING DFHEIV0,
  9192           DFHEIV1,
  9193           DFHEIV20,
  9194           DFHEIV99,
  9195           ERPDEF-KEY,
  9196           DFHEIV99,
  9197           DFHEIV11,
  9198           DFHEIV99,
  9199           DFHEIV99
  9200     SET ADDRESS OF PRODUCT-MASTER TO
  9201         DFHEIV20
  9202     MOVE EIBRESP  TO WS-RESPONSE
  9203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9204
  9205     IF NOT WS-RESP-NORMAL
  9206        GO TO 0900-ENDBR
  9207     END-IF
  9208
  9209     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9210        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9211           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9212        ELSE
  9213           GO TO 0900-READNEXT
  9214        END-IF
  9215     ELSE
  9216        GO TO 0900-ENDBR
  9217     END-IF
  9218
  9219     IF CM-LOAN-TERM = ZEROS
  9220        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9221     END-IF
  9222
  9223     .
  9224 0900-ENDBR.
  9225
  9226
  9227* EXEC CICS ENDBR
  9228*       DATASET  ('ERPDEF')
  9229*    END-EXEC
  9230     MOVE 'ERPDEF' TO DFHEIV1
  9231     MOVE 0
  9232       TO DFHEIV11
  9233*    MOVE '&2                    $   #00008927' TO DFHEIV0
  9234     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9235     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9236     MOVE X'2020233030303038393237' TO DFHEIV0(25:11)
  9237     CALL 'kxdfhei1' USING DFHEIV0,
  9238           DFHEIV1,
  9239           DFHEIV11,
  9240           DFHEIV99
  9241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9242
  9243     .
  9244 0900-EXIT.
  9245     EXIT.
  9246 1000-EDIT-DATA.
  9247
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 174
* EL156.cbl
  9248     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9249         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9250         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9251
  9252     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9253
  9254     IF NOT MODIFY-CAP
  9255         MOVE ER-0070            TO EMI-ERROR
  9256         MOVE -1                 TO PMTTYPEL
  9257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9258         GO TO 2000-EDIT-DONE.
  9259
  9260     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9261                         '5' AND '6'
  9262         MOVE ER-0420            TO EMI-ERROR
  9263         MOVE -1                 TO PMTTYPEL
  9264         MOVE AL-UABON           TO PMTTYPEA
  9265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9266     ELSE
  9267         MOVE AL-UANON           TO PMTTYPEA.
  9268
  9269*    IF PI-OFFLINE = 'Y'
  9270*       IF PI-GROUPED = 'Y'
  9271*          MOVE ER-1880         TO EMI-ERROR
  9272*          MOVE -1              TO GROUPEDL
  9273*          MOVE AL-UABON        TO GROUPEDA
  9274*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9275*
  9276*    IF GROUPEDL > +0
  9277*       IF PI-GROUPED = 'Y' OR 'N'
  9278*          MOVE AL-UANON TO GROUPEDA
  9279*       ELSE
  9280*          MOVE ER-3140            TO EMI-ERROR
  9281*          MOVE -1                 TO GROUPEDL
  9282*          MOVE AL-UABON           TO GROUPEDA
  9283*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9284*
  9285*    IF CASHL > +0
  9286*       IF PI-CASH = 'Y' OR 'N'
  9287*          MOVE AL-UANON           TO CASHA
  9288*       ELSE
  9289*          MOVE ER-3141            TO EMI-ERROR
  9290*          MOVE -1                 TO CASHL
  9291*          MOVE AL-UABON           TO CASHA
  9292*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9293
  9294     IF LOANNOL > +0
  9295         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9296
  9297 1000-EDIT-PAYEE.
  9298
  9299     IF PI-PAYEE-SEQ NOT NUMERIC
  9300         MOVE ER-0294            TO  EMI-ERROR
  9301         MOVE -1                 TO  PAYEEL
  9302         MOVE AL-UABON           TO  PAYEEA
  9303         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9304         GO TO 1000-CONT-EDIT.
  9305
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 175
* EL156.cbl
  9306     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9307                         'E' OR 'O' OR 'Q'
  9308         NEXT SENTENCE
  9309     ELSE
  9310         MOVE ER-0294            TO  EMI-ERROR
  9311         MOVE -1                 TO  PAYEEL
  9312         MOVE AL-UABON           TO  PAYEEA
  9313         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9314         GO TO 1000-CONT-EDIT.
  9315
  9316     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9317        (PI-PAYEE-SEQ NOT < '1' AND
  9318         PI-PAYEE-SEQ NOT > '9'))
  9319      OR
  9320        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9321         (PI-PAYEE-SEQ NOT > '9'))
  9322         MOVE AL-UANON            TO PAYEEA
  9323     ELSE
  9324         MOVE ER-0294            TO EMI-ERROR
  9325         MOVE -1                 TO PAYEEL
  9326         MOVE AL-UABON           TO PAYEEA
  9327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9328
  9329     IF PI-COMPANY-ID = 'DMD'
  9330         IF PI-PAYEE-TYPE = 'B' AND
  9331            PI-PAYEE-SEQ NOT = '0'
  9332               MOVE ER-7841            TO EMI-ERROR
  9333               MOVE -1                 TO PAYEEL
  9334               MOVE AL-UABON           TO PAYEEA
  9335               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9336
  9337     IF PI-COMPANY-ID = 'JHL'
  9338         IF PI-PAYEE = 'B0'
  9339             NEXT SENTENCE
  9340           ELSE
  9341
  9342* EXEC CICS HANDLE CONDITION
  9343*            ENDFILE(1950-NOT-FOUND)
  9344*            NOTFND (1950-NOT-FOUND)
  9345*        END-EXEC
  9346*    MOVE '"$''I                  ! & #00009029' TO DFHEIV0
  9347     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9349     MOVE X'2620233030303039303239' TO DFHEIV0(25:11)
  9350     CALL 'kxdfhei1' USING DFHEIV0
  9351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9352         MOVE 'N'                    TO FOUND-TOL-SW
  9353         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9354         MOVE '2'                    TO CNTL-REC-TYPE
  9355         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9356         MOVE +0                     TO CNTL-SEQ-NO
  9357         MOVE 'PROC'                 TO FILE-SWITCH
  9358         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9359         IF PI-PAYEE = 'I1' AND
  9360            APPROVAL-LEVEL-2
  9361             NEXT SENTENCE
  9362           ELSE
  9363         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 176
* EL156.cbl
  9364             MOVE ER-3546        TO EMI-ERROR
  9365             MOVE -1             TO PAYEEL
  9366             MOVE AL-UABON       TO PAYEEA
  9367             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9368
  9369     IF PI-PAYEE-TYPE = 'E'
  9370        IF PI-PMTTYPE = '5' OR '6'
  9371            NEXT SENTENCE
  9372        ELSE
  9373            MOVE ER-3539            TO EMI-ERROR
  9374            MOVE -1                 TO PAYEEL
  9375            MOVE AL-UABON           TO PAYEEA
  9376            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9377
  9378 1000-CONT-EDIT.
  9379
  9380     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9381        IF PI-EPYAMT NOT NEGATIVE
  9382            MOVE ER-0421         TO EMI-ERROR
  9383            MOVE -1              TO OFFLINEL
  9384            MOVE AL-UABON        TO OFFLINEA
  9385            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9386        ELSE
  9387            MOVE AL-UANON        TO OFFLINEA.
  9388
  9389     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  9390        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9391           CONTINUE
  9392        ELSE
  9393           IF PI-PRINT-EOB-YN = 'S' AND
  9394              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9395                CONTINUE
  9396           ELSE
  9397              MOVE ER-1561       TO EMI-ERROR
  9398              MOVE -1            TO EOBYNL
  9399              MOVE AL-UABON      TO EOBYNA
  9400              PERFORM 9900-ERROR-FORMAT
  9401                                 THRU 9900-EXIT
  9402           END-IF
  9403        END-IF
  9404
  9405        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9406            MOVE ER-1566        TO EMI-ERROR
  9407            MOVE -1             TO CLMFMYNL
  9408            MOVE AL-UABON       TO CLMFMYNA
  9409            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9410        END-IF
  9411
  9412        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9413            MOVE ER-1567        TO EMI-ERROR
  9414            MOVE -1             TO SURVYYNL
  9415            MOVE AL-UABON       TO SURVYYNA
  9416            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9417        END-IF
  9418
  9419        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9420            MOVE ER-1569        TO EMI-ERROR
  9421            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 177
* EL156.cbl
  9422            MOVE AL-UABON       TO SPRELYNA
  9423            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9424        END-IF
  9425
  9426     END-IF
  9427     IF PI-EPYAMT IS NEGATIVE
  9428         IF PI-OFFLINE NOT = 'Y'
  9429             MOVE ER-0836        TO  EMI-ERROR
  9430             MOVE -1             TO  OFFLINEL
  9431             MOVE AL-UABON       TO  OFFLINEA
  9432             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9433
  9434     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9435        MOVE ER-0872             TO EMI-ERROR
  9436        MOVE -1                  TO PROOFDTL
  9437        MOVE AL-UABON            TO PROOFDTA
  9438        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9439     ELSE
  9440        MOVE '4'                TO DC-OPTION-CODE
  9441        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9442        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9443        IF DATE-CONVERSION-ERROR
  9444            MOVE ER-0873        TO EMI-ERROR
  9445            MOVE -1                  TO PROOFDTL
  9446            MOVE AL-UABON            TO PROOFDTA
  9447            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9448        ELSE
  9449            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9450            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9451                MOVE ER-0873    TO EMI-ERROR
  9452                MOVE -1                  TO PROOFDTL
  9453                MOVE AL-UABON            TO PROOFDTA
  9454                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9455            END-IF
  9456        END-IF
  9457     END-IF.
  9458
  9459     IF PI-COMPANY-ID = 'DMD'
  9460        IF NOTE1L NOT = ZEROS
  9461            MOVE ER-7844        TO  EMI-ERROR
  9462            MOVE -1             TO  NOTE1L
  9463            MOVE AL-UABON       TO  NOTE1A
  9464            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9465
  9466     IF PI-COMPANY-ID = 'DMD'
  9467        IF NOTE2L NOT = ZEROS
  9468          GO TO 1004-DMD-EOB-CHECKS.
  9469
  9470     IF NOTE1L NOT > +0
  9471         GO TO 1005-CHECK-ERRORS.
  9472
  9473     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9474         GO TO 1005-CHECK-ERRORS.
  9475
  9476     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9477         GO TO 1003-HAN-PMT-NOTES.
  9478
  9479     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 178
* EL156.cbl
  9480
  9481     IF WS-PMTOPTION NUMERIC
  9482        IF WS-PMTOPTION > '00' AND < '17'
  9483           NEXT SENTENCE
  9484        ELSE
  9485           MOVE ER-0618          TO EMI-ERROR
  9486           MOVE -1               TO NOTE1L
  9487           MOVE AL-UABON         TO NOTE1A
  9488           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9489     ELSE
  9490        GO TO 1005-CHECK-ERRORS.
  9491
  9492     IF WS-PMTOPTION = '05' AND
  9493        WS-DOCNAME = SPACES
  9494          MOVE ER-0616             TO EMI-ERROR
  9495          MOVE -1                  TO NOTE1L
  9496          MOVE AL-UABON            TO NOTE1A
  9497          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9498
  9499     IF WS-PMTOPTION = '15' OR '16'
  9500
  9501* EXEC CICS BIF DEEDIT
  9502*            FIELD (WS-AMOUNT)
  9503*            LENGTH(08)
  9504*        END-EXEC
  9505     MOVE 08
  9506       TO DFHEIV11
  9507*    MOVE '@"L                   #   #00009181' TO DFHEIV0
  9508     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9509     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9510     MOVE X'2020233030303039313831' TO DFHEIV0(25:11)
  9511     CALL 'kxdfhei1' USING DFHEIV0,
  9512           WS-AMOUNT,
  9513           DFHEIV11
  9514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9515        IF (WS-NUM-AMT = ZEROS) OR
  9516           (WS-AMOUNT NOT NUMERIC)
  9517           MOVE ER-0617          TO EMI-ERROR
  9518           MOVE -1               TO NOTE1L
  9519           MOVE AL-UABON         TO NOTE1A
  9520           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9521
  9522     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9523
  9524     GO TO 1005-CHECK-ERRORS.
  9525
  9526 1003-HAN-PMT-NOTES.
  9527
  9528     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9529
  9530     IF WS-HAN-PMT-CODE = SPACE
  9531         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9532     ELSE
  9533     IF WS-HAN-PMT-CODE = 'A'
  9534         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9535                                 TO WS-HAN-PMT-NOTE
  9536     ELSE
  9537     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 179
* EL156.cbl
  9538         MOVE ':FINAL PAYMENT / DECEASED'
  9539                                 TO WS-HAN-PMT-NOTE
  9540     ELSE
  9541     IF WS-HAN-PMT-CODE = 'C'
  9542         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9543                                 TO WS-HAN-PMT-NOTE
  9544     ELSE
  9545     IF WS-HAN-PMT-CODE = 'D'
  9546         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9547                                 TO WS-HAN-PMT-NOTE
  9548     ELSE
  9549     IF WS-HAN-PMT-CODE = 'E'
  9550         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9551                                 TO WS-HAN-PMT-NOTE
  9552     ELSE
  9553     IF WS-HAN-PMT-CODE = 'F'
  9554         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9555                                 TO WS-HAN-PMT-NOTE
  9556     ELSE
  9557     IF WS-HAN-PMT-CODE = 'P'
  9558         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9559
  9560     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9561     GO TO 1005-CHECK-ERRORS.
  9562
  9563 1004-DMD-EOB-CHECKS.
  9564
  9565     INITIALIZE PI-AT-EOB-CODES.
  9566
  9567     IF NOTE2I (20:21) > SPACES
  9568         MOVE ER-7845          TO EMI-ERROR
  9569         MOVE -1               TO NOTE2L
  9570         MOVE AL-UABON         TO NOTE2A
  9571         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9572         GO TO 1005-CHECK-ERRORS
  9573      ELSE
  9574         MOVE NOTE2I             TO W-EOB-CODES.
  9575
  9576     MOVE +1                     TO W-EOB-NDX.
  9577
  9578 1004-CHECK-EACH-EOB.
  9579
  9580     IF W-EOB-NDX > +5
  9581             OR
  9582        W-EOB-CODE (W-EOB-NDX) = SPACES
  9583         GO TO 1004-CHECK-DUP-EOB.
  9584
  9585     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9586         MOVE ER-0956            TO EMI-ERROR
  9587         MOVE -1                 TO NOTE2L
  9588         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9589         GO TO 1005-CHECK-ERRORS.
  9590
  9591     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9592     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9593     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9594     MOVE 'DLO023'               TO PGM-NAME.
  9595
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 180
* EL156.cbl
  9596
  9597* EXEC CICS LINK
  9598*        PROGRAM    (PGM-NAME)
  9599*        COMMAREA   (CD-COMMUNICATION-AREA)
  9600*        LENGTH     (CD-RCRD-LENGTH)
  9601*    END-EXEC.
  9602*    MOVE '."C                   (   #00009266' TO DFHEIV0
  9603     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9605     MOVE X'2020233030303039323636' TO DFHEIV0(25:11)
  9606     CALL 'kxdfhei1' USING DFHEIV0,
  9607           PGM-NAME,
  9608           CD-COMMUNICATION-AREA,
  9609           CD-RCRD-LENGTH,
  9610           DFHEIV99,
  9611           DFHEIV99,
  9612           DFHEIV99,
  9613           DFHEIV99
  9614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9615
  9616
  9617     IF CD-RETURN-CODE = 'OK'
  9618         GO TO 1004-CONT.
  9619
  9620     MOVE -1                     TO NOTE2L.
  9621
  9622     IF CD-RETURN-CODE = '01'
  9623         MOVE ER-8310            TO EMI-ERROR
  9624         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9625         GO TO 1005-CHECK-ERRORS.
  9626
  9627     IF CD-RETURN-CODE = '02'
  9628         MOVE ER-8311            TO EMI-ERROR
  9629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9630         GO TO 1005-CHECK-ERRORS.
  9631
  9632     IF CD-RETURN-CODE = '03'
  9633         MOVE ER-8312            TO EMI-ERROR
  9634         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9635         GO TO 1005-CHECK-ERRORS.
  9636
  9637     IF CD-RETURN-CODE = '04'
  9638         MOVE ER-8313            TO EMI-ERROR
  9639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9640         GO TO 1005-CHECK-ERRORS.
  9641
  9642     IF CD-RETURN-CODE = '05'
  9643         MOVE ER-8314            TO EMI-ERROR
  9644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9645         GO TO 1005-CHECK-ERRORS.
  9646
  9647     IF CD-RETURN-CODE = '06'
  9648         MOVE ER-8315            TO EMI-ERROR
  9649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9650         GO TO 1005-CHECK-ERRORS.
  9651
  9652     IF CD-RETURN-CODE = 'E1'
  9653         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 181
* EL156.cbl
  9654         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9655         GO TO 1005-CHECK-ERRORS.
  9656
  9657     IF CD-RETURN-CODE = 'N1'
  9658         MOVE ER-8317            TO EMI-ERROR
  9659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9660         GO TO 1005-CHECK-ERRORS.
  9661
  9662 1004-CONT.
  9663     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9664
  9665     ADD +1 TO W-EOB-NDX.
  9666     GO TO 1004-CHECK-EACH-EOB.
  9667
  9668 1004-CHECK-DUP-EOB.
  9669     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9670         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9671                               PI-AT-EOB-CODE (3) OR
  9672                               PI-AT-EOB-CODE (4) OR
  9673                               PI-AT-EOB-CODE (5)))
  9674                  OR
  9675        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9676         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9677                               PI-AT-EOB-CODE (4) OR
  9678                               PI-AT-EOB-CODE (5)))
  9679                  OR
  9680        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9681         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9682                               PI-AT-EOB-CODE (5)))
  9683                  OR
  9684        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9685         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9686            MOVE ER-8000            TO EMI-ERROR
  9687            MOVE AL-UABON           TO NOTE2A
  9688            MOVE -1                 TO NOTE2L
  9689            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9690            GO TO 1005-CHECK-ERRORS.
  9691
  9692 1005-CHECK-ERRORS.
  9693*    IF PI-COMPANY-ID NOT = 'DMD'
  9694        GO TO 1006-CHECK-ERRORS.
  9695
  9696*********  DMD CODE START ******************
  9697*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9698*       GO TO 1006-CHECK-ERRORS.
  9699*
  9700*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9701*
  9702*    COMPUTE W-PAYMENT-TOTAL
  9703*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9704*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9705*               AND
  9706*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9707*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9708*          MOVE ER-0967    TO EMI-ERROR
  9709*          MOVE -1         TO PMTTYPEL
  9710*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9711*
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 182
* EL156.cbl
  9712*    GO TO 1006-CHECK-ERRORS.
  9713*********  DMD CODE END ******************
  9714
  9715 1006-CHECK-ERRORS.
  9716     if emi-forcable-ctr = zeros
  9717        and emi-fatal-ctr = zeros
  9718        continue
  9719     else
  9720        IF NOT EMI-NO-ERRORS
  9721           GO TO 2000-EDIT-DONE
  9722        end-if
  9723     end-if
  9724
  9725* EXEC CICS HANDLE CONDITION
  9726*        NOTFND(1950-NOT-FOUND)
  9727*    END-EXEC.
  9728*    MOVE '"$I                   ! '' #00009379' TO DFHEIV0
  9729     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9731     MOVE X'2720233030303039333739' TO DFHEIV0(25:11)
  9732     CALL 'kxdfhei1' USING DFHEIV0
  9733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9734
  9735
  9736     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9737     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9738     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9739     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9740     MOVE 'MSTR'                 TO FILE-SWITCH.
  9741
  9742     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9743
  9744     IF PI-COMPANY-ID = 'DMD'
  9745         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9746
  9747     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9748        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9749           MOVE ER-0873    TO EMI-ERROR
  9750           MOVE -1                  TO PROOFDTL
  9751           MOVE AL-UABON            TO PROOFDTA
  9752           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9753        END-IF
  9754     END-IF
  9755     if cl-benefit-period = zeros
  9756        move er-1667             to emi-error
  9757        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9758     end-if
  9759     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9760     MOVE +95                    TO TRLR-SEQ-NO
  9761
  9762* EXEC CICS READ
  9763*       DATASET  ('ELTRLR')
  9764*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9765*       RIDFLD   (ELTRLR-KEY)
  9766*       RESP     (WS-RESPONSE)
  9767*    END-EXEC
  9768     MOVE 'ELTRLR' TO DFHEIV1
  9769*    MOVE '&"S        E          (  N#00009408' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 183
* EL156.cbl
  9770     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9772     MOVE X'204E233030303039343038' TO DFHEIV0(25:11)
  9773     CALL 'kxdfhei1' USING DFHEIV0,
  9774           DFHEIV1,
  9775           DFHEIV20,
  9776           DFHEIV99,
  9777           ELTRLR-KEY,
  9778           DFHEIV99,
  9779           DFHEIV99,
  9780           DFHEIV99
  9781     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9782         DFHEIV20
  9783     MOVE EIBRESP  TO WS-RESPONSE
  9784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9785
  9786     if ws-resp-normal
  9787        perform varying s1 from +1 by +1 until
  9788           at-note-error-no (s1) = spaces
  9789           if at-note-error-no (s1) = '1662'
  9790              continue
  9791           else
  9792              move at-note-error-no (s1)
  9793                                 to emi-error
  9794              if at-note-error-no (s1) = '1653'
  9795                 evaluate true
  9796                    when cl-claim-type = 'L'
  9797                       move '  LF  '
  9798                                 to emi-claim-type
  9799                    when cl-claim-type = 'I'
  9800                       move '  IU  '
  9801                                 to emi-claim-type
  9802                    when cl-claim-type = 'A'
  9803                       move '  AH  '
  9804                                 to emi-claim-type
  9805                    when other
  9806                       move ' FMLA '
  9807                                 to emi-claim-type
  9808                 end-evaluate
  9809              end-if
  9810              PERFORM 9900-ERROR-FORMAT
  9811                                 THRU 9900-EXIT
  9812           end-if
  9813        end-perform
  9814     end-if
  9815     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9816         IF PI-PMTTYPE = '5' OR '6'
  9817             NEXT SENTENCE
  9818         ELSE
  9819             MOVE ER-0555             TO EMI-ERROR
  9820             MOVE -1                  TO PMTTYPEL
  9821             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9822
  9823     IF CL-LAST-CLOSE-REASON = '2'
  9824         IF CL-CLAIM-STATUS = 'C'
  9825             MOVE ER-0760        TO  EMI-ERROR
  9826             MOVE -1             TO  PMTTYPEL
  9827             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 184
* EL156.cbl
  9828
  9829     IF PI-ACTIVITY-CODE = 9
  9830         MOVE ER-3538            TO  EMI-ERROR
  9831         MOVE -1                 TO  PMTTYPEL
  9832         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9833
  9834     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9835         GO TO 1008-READ-CERT.
  9836**********************AIG LOGIC STARTS *********************
  9837     IF CL-CERT-PRIME = 'INCOMPLETE'
  9838         MOVE ER-3540            TO  EMI-ERROR
  9839         MOVE -1                 TO  PMTTYPEL
  9840         MOVE AL-UABON           TO  PMTTYPEA
  9841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9842         GO TO 2000-EDIT-DONE.
  9843
  9844     IF PI-PMTTYPE = '4'
  9845         IF PI-EPYAMT IS NEGATIVE
  9846             IF PI-ECHECKNO-CR = 'CR'
  9847                 NEXT SENTENCE
  9848             ELSE
  9849                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9850
  9851     IF PI-PMTTYPE = '4'
  9852         IF PI-ECHECKNO-CR = 'CR'
  9853             IF PI-EPYAMT IS NEGATIVE
  9854                 NEXT SENTENCE
  9855             ELSE
  9856                 MOVE ER-0834    TO  EMI-ERROR
  9857                 MOVE -1         TO  EPYAMTL
  9858                 MOVE AL-UNBON   TO  EPYAMTA
  9859                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9860
  9861     IF PI-PMTTYPE = '4'
  9862         IF PI-EPYAMT IS NEGATIVE
  9863             IF PI-OFFLINE = 'Y'
  9864                 NEXT SENTENCE
  9865             ELSE
  9866                 MOVE 'Y'        TO  PI-OFFLINE
  9867                                     WS-OFFLINE
  9868                                     OFFLINEO
  9869                 MOVE AL-UANON   TO  OFFLINEA.
  9870
  9871*    IF PI-PMTTYPE = '4'
  9872*        IF PI-EPYAMT IS NEGATIVE
  9873*            IF PI-CASH = 'Y'
  9874*                NEXT SENTENCE
  9875*            ELSE
  9876*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9877*                MOVE AL-UANON   TO  CASHA
  9878*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9879*
  9880*    IF PI-CASH NOT = 'Y' AND 'N'
  9881*         IF PI-OFFLINE = 'Y'  AND
  9882*            PI-ECHECKNO-CR = 'CR'
  9883*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9884*              MOVE AL-UANON     TO  CASHA
  9885*              GO TO 1007-DEFAULT-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 185
* EL156.cbl
  9886*
  9887*    IF PI-CASH NOT = 'Y' AND 'N'
  9888*        IF PI-PMTTYPE = '5' OR '6'
  9889*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9890*            MOVE AL-UANON       TO  CASHA
  9891*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9892*
  9893*    IF PI-CASH NOT = 'Y' AND 'N'
  9894*       IF CL-ASSOCIATES = 'N' OR 'A'
  9895*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9896*           MOVE AL-UANON        TO  CASHA
  9897*       ELSE
  9898*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9899*           MOVE AL-UANON        TO  CASHA.
  9900*
  9901*    IF PI-PMTTYPE = '5' OR '6'
  9902*        IF PI-CASH = 'N'
  9903*            MOVE ER-0819        TO  EMI-ERROR
  9904*            MOVE AL-UANON       TO  CASHA
  9905*            MOVE -1             TO  CASHL
  9906*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9907*
  9908*    IF CL-ASSOCIATES = 'N' OR 'A'
  9909*       IF CASHI = 'N'
  9910*        MOVE ER-3537            TO  EMI-ERROR
  9911*        MOVE AL-UANON           TO  CASHA
  9912*        MOVE -1                 TO  CASHL
  9913*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9914
  9915 1007-DEFAULT-AIG-CHECKNO.
  9916
  9917     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9918         MOVE ER-3532            TO  EMI-ERROR
  9919         MOVE -1                 TO  PMTTYPEL
  9920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9921**********************AIG LOGIC ENDS ***********************
  9922
  9923 1008-READ-CERT.
  9924
  9925     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9926     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9927     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9928     MOVE CL-CERT-STATE          TO CERT-STATE.
  9929     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9930     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9931     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9932     MOVE 'CERT'                 TO FILE-SWITCH.
  9933
  9934     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9935
  9936     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9937        MOVE CM-LF-LOAN-EXPIRE-DT
  9938                                 TO WS-EXP-DT PI-EXP-DT
  9939                                    ws-extended-exp-dt
  9940     ELSE
  9941        MOVE CM-AH-LOAN-EXPIRE-DT
  9942                                 TO WS-EXP-DT PI-EXP-DT
  9943                                    ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 186
* EL156.cbl
  9944     end-if
  9945     if pi-dcc-product-code not = spaces
  9946        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9947        move cm-lf-benefit-cd    to pi-lf-benefit-cd
  9948        PERFORM 0900-GET-DDF-limits
  9949                                 THRU 0900-EXIT
  9950        IF PDEF-FOUND
  9951           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9952              (P1 > +8)
  9953              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  9954           END-PERFORM
  9955           IF P1 < +9
  9956              MOVE '6'           TO DC-OPTION-CODE
  9957              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
  9958              MOVE PD-MAX-EXTENSION (P1)
  9959                                 TO DC-ELAPSED-MONTHS
  9960              PERFORM 9700-LINK-DATE-CONVERT
  9961                                 THRU 9700-EXIT
  9962              if no-conversion-error
  9963                 move dc-bin-date-2 to ws-extended-exp-dt
  9964              end-if
  9965           else
  9966              move er-1674       to emi-error
  9967              PERFORM 9900-ERROR-FORMAT
  9968                                 THRU 9900-EXIT
  9969           end-if
  9970        end-if
  9971     end-if
  9972*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9973*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9974
  9975     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9976         MOVE ER-0458            TO EMI-ERROR
  9977         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9978
  9979     IF (CL-INCURRED-DT > WS-EXP-DT)
  9980        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
  9981        MOVE ER-1677             TO EMI-ERROR
  9982        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
  9983     END-IF
  9984     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
  9985     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
  9986         MOVE ER-0459            TO EMI-ERROR
  9987         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9988
  9989     IF CL-REPORTED-DT = LOW-VALUES
  9990        MOVE ER-0530             TO EMI-ERROR
  9991        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9992
  9993     IF PI-COMPANY-ID = 'NCL'
  9994        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9995            MOVE ER-0770            TO EMI-ERROR
  9996            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9997
  9998     IF PI-COMPANY-ID = 'NCL'
  9999        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10000            MOVE ER-0737            TO EMI-ERROR
 10001            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 187
* EL156.cbl
 10002
 10003     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10004         MOVE ER-0768            TO  EMI-ERROR
 10005         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10006
 10007     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10008         MOVE ER-0769            TO  EMI-ERROR
 10009         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10010
 10011     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10012         GO TO 1020-DO-LIFE-EDITS
 10013     ELSE
 10014         GO TO 1030-DO-AH-EDITS.
 10015
 10016 1010-GENERAL-ERROR.
 10017     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10018
 10019     IF EMI-MESSAGE-FORMATTED
 10020         MOVE -1                 TO PMTTYPEL.
 10021
 10022 1010-EXIT.
 10023     EXIT.
 10024
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 188
* EL156.cbl
 10026 1020-DO-LIFE-EDITS.
 10027     IF CM-LF-BENEFIT-CD = '00'
 10028         IF PI-PMTTYPE = '5' OR '6'
 10029             MOVE ER-0658        TO EMI-ERROR
 10030             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10031         ELSE
 10032            if (pi-company-id = 'DCC' or 'CAP')
 10033               and (pi-dcc-product-code not = spaces)
 10034               continue
 10035            else
 10036               MOVE ER-1775      TO EMI-ERROR
 10037               PERFORM 1040-PMTTYPE-ERROR
 10038                                 THRU 1040-EXIT
 10039            end-if
 10040         end-if
 10041     end-if
 10042
 10043     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10044     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10045         MOVE ER-0460            TO EMI-ERROR
 10046         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10047
 10048     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10049     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10050     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10051     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10052     MOVE '4'                    TO  CNTL-REC-TYPE.
 10053     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10054     MOVE 'BENE'                 TO  FILE-SWITCH.
 10055     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10056     IF NO-BENEFIT-FOUND
 10057         GO TO 1950-NOT-FOUND.
 10058
 10059     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10060
 10061     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10062         IF PI-PMTTYPE = '4'
 10063             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10064                PI-LF-COVERAGE-TYPE = 'P'
 10065                 NEXT SENTENCE
 10066             ELSE
 10067                 MOVE ER-0461        TO EMI-ERROR
 10068                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10069         ELSE
 10070            NEXT SENTENCE
 10071     ELSE
 10072         IF PI-PMTTYPE = '2'
 10073            IF NOT CM-O-B-COVERAGE
 10074              AND CM-LF-CURRENT-STATUS = '7'
 10075                MOVE ER-0462     TO EMI-ERROR
 10076                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10077
 10078     IF PI-PMTTYPE = '2'
 10079         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10080            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10081             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10082             MOVE ER-0730            TO  EMI-ERROR
 10083             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 189
* EL156.cbl
 10084             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10085
 10086     IF PI-PMTTYPE = '2'
 10087         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10088            PI-LF-COVERAGE-TYPE = 'P'
 10089             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10090                 MOVE ER-0462    TO  EMI-ERROR
 10091                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10092
 10093     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10094       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10095         MOVE ER-0466            TO EMI-ERROR
 10096         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10097
 10098     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10099         IF PI-PMTTYPE = '3'
 10100             MOVE 0436           TO EMI-ERROR
 10101             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10102             GO TO 1045-EDIT-PAYEE-ADDR
 10103         ELSE
 10104             GO TO 1045-EDIT-PAYEE-ADDR.
 10105
 10106     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10107        PI-LF-COVERAGE-TYPE = 'P'
 10108         IF PI-PMTTYPE = '3'
 10109             MOVE ER-0436          TO  EMI-ERROR
 10110             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10111         ELSE
 10112             NEXT SENTENCE
 10113     ELSE
 10114         IF PI-PMTTYPE = '1' OR '3'
 10115             MOVE ER-0436            TO EMI-ERROR
 10116             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10117*
 10118     IF PI-COMPANY-ID = 'CID' AND
 10119        CL-CERT-STATE = 'SC'  AND
 10120        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10121           MOVE ER-0879    TO  EMI-ERROR
 10122           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10123           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10124     END-IF.
 10125     IF PI-COMPANY-ID = 'AHL'
 10126        evaluate true
 10127           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10128              MOVE ER-0879       TO  EMI-ERROR
 10129              PERFORM 1040-PMTTYPE-ERROR
 10130                                 THRU 1040-EXIT
 10131              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10132           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10133                 '6D' OR '6H' OR '6R'
 10134              MOVE ER-0879       TO  EMI-ERROR
 10135              PERFORM 1040-PMTTYPE-ERROR
 10136                                 THRU 1040-EXIT
 10137              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10138           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10139              MOVE ER-0879       TO  EMI-ERROR
 10140              PERFORM 1040-PMTTYPE-ERROR
 10141                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 190
* EL156.cbl
 10142              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10143        end-evaluate
 10144     END-IF
 10145     GO TO 1045-EDIT-PAYEE-ADDR.
 10146
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 191
* EL156.cbl
 10148 1030-DO-AH-EDITS.
 10149     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10150     IF CM-AH-BENEFIT-CD = '00'
 10151         IF PI-PMTTYPE = '5' OR '6'
 10152             MOVE ER-0658        TO EMI-ERROR
 10153             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10154         ELSE
 10155             MOVE ER-1775        TO EMI-ERROR
 10156             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10157
 10158     IF CL-TOTAL-PAID-AMT = ZEROS
 10159         IF PI-PMTTYPE = '4'
 10160             MOVE ER-0438        TO EMI-ERROR
 10161             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10162
 10163     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10164         IF PI-PMTTYPE = '3'
 10165             MOVE ER-0463        TO EMI-ERROR
 10166             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10167         ELSE
 10168             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10169              AND CM-LF-CURRENT-STATUS = '7'
 10170                 MOVE ER-0465    TO EMI-ERROR
 10171                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10172
 10173     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10174         IF PI-PMTTYPE = '3'
 10175             MOVE ER-0464        TO EMI-ERROR
 10176             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10177         ELSE
 10178             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10179                 MOVE ER-0469    TO EMI-ERROR
 10180                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10181
 10182     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10183         IF PI-PMTTYPE = '3'
 10184             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10185                 MOVE ER-0467    TO EMI-ERROR
 10186                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10187             ELSE
 10188                 NEXT SENTENCE
 10189         ELSE
 10190             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10191                 MOVE ER-0468    TO EMI-ERROR
 10192                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10193
 10194     GO TO 1045-EDIT-PAYEE-ADDR.
 10195
 10196 1040-PMTTYPE-ERROR.
 10197     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10198
 10199     IF EMI-MESSAGE-FORMATTED
 10200         MOVE -1                 TO PMTTYPEL
 10201         MOVE AL-UABON           TO PMTTYPEA.
 10202
 10203 1040-EXIT.
 10204     EXIT.
 10205
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 192
* EL156.cbl
 10207 1045-EDIT-PAYEE-ADDR.
 10208
 10209     IF PI-OFFLINE = 'N' AND
 10210        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10211           < PI-PAYEE-SEQ-NUM)
 10212        OR
 10213         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10214         (PI-PAYEE-TYPE = 'B')                 AND
 10215         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10216        OR
 10217         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10218           < PI-PAYEE-SEQ-NUM)
 10219        OR
 10220         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10221           < PI-PAYEE-SEQ-NUM)
 10222        OR
 10223         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10224           < PI-PAYEE-SEQ-NUM)
 10225        OR
 10226         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10227           < PI-PAYEE-SEQ-NUM)
 10228        OR
 10229         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10230           < PI-PAYEE-SEQ-NUM))
 10231             MOVE ER-0437        TO EMI-ERROR
 10232             MOVE -1             TO PAYEEL
 10233             MOVE AL-UABON       TO PAYEEA
 10234             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10235
 10236     IF PI-OFFLINE    = 'N' AND
 10237        PI-PAYEE-TYPE = 'B' AND
 10238        PI-PAYEE-SEQ  = '0'
 10239         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10240         IF BENE-FOUND-SW = 'N'
 10241             MOVE ER-0437        TO EMI-ERROR
 10242             MOVE -1             TO PAYEEL
 10243             MOVE AL-UABON       TO PAYEEA
 10244             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10245
 10246     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10247        IF PI-OFFLINE    = 'N'  AND
 10248           PI-PAYEE-TYPE = 'B'  AND
 10249           PI-PAYEE-SEQ  = '9'
 10250             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10251             IF BENE-FOUND-SW = 'N'
 10252                MOVE ER-0437        TO EMI-ERROR
 10253                MOVE -1             TO PAYEEL
 10254                MOVE AL-UABON       TO PAYEEA
 10255                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10256
 10257*    IF PI-COMPANY-ID = 'CRI'
 10258*        IF CL-CLAIM-TYPE = 'L'
 10259*            MOVE 'N'                TO  WS-GROUPED
 10260*                                        PI-GROUPED
 10261*                                        GROUPEDI
 10262*            MOVE AL-UANON           TO  GROUPEDA
 10263*            GO TO 1050-EDIT-CHECK-NO
 10264*        ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 193
* EL156.cbl
 10265*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10266*            IF WS-GROUP-1 = 'C'
 10267*                NEXT SENTENCE
 10268*            ELSE
 10269*                MOVE 'N'            TO  WS-GROUPED
 10270*                                        PI-GROUPED
 10271*                                        GROUPEDI
 10272*                MOVE AL-UANON       TO  GROUPEDA
 10273*                GO TO 1050-EDIT-CHECK-NO.
 10274
 10275*     IF PI-GROUPED = 'Y'
 10276*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10277*           NEXT SENTENCE
 10278*        ELSE
 10279*           MOVE ER-0437        TO EMI-ERROR
 10280*           MOVE -1             TO PAYEEL
 10281**02180            MOVE AL-UABON       TO PAYEEA
 10282*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10283*
 10284*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10285*        (PI-GROUPED    = ' ')
 10286*        NEXT SENTENCE
 10287*     ELSE
 10288*
 10289     GO TO 1050-EDIT-CHECK-NO.
 10290*     IF PI-COMPANY-ID = 'CRI'
 10291*        MOVE 'N'           TO GROUPEDI
 10292*                              PI-GROUPED
 10293*                              WS-GROUPED
 10294*        MOVE AL-UANON      TO GROUPEDA.
 10295*
 10296*     IF PI-COMPANY-ID = 'CRI'
 10297*        IF PI-PAYEE-TYPE = 'B'
 10298*           IF BENE-FOUND-SW = 'Y'
 10299*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10300*                 MOVE 'Y'           TO GROUPEDI
 10301*                                       PI-GROUPED
 10302*                                       WS-GROUPED
 10303*                 MOVE AL-UANON      TO GROUPEDA
 10304*              ELSE
 10305*                 NEXT SENTENCE
 10306*           ELSE
 10307*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10308*              IF BENE-FOUND-SW = 'Y'
 10309*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10310*                    MOVE 'Y'      TO GROUPEDI
 10311*                                     PI-GROUPED
 10312*                                     WS-GROUPED
 10313*                    MOVE AL-UANON TO GROUPEDA.
 10314*
 10315
 10316     IF PI-COMPANY-ID NOT = 'CRI'
 10317        GO TO 1050-EDIT-CHECK-NO.
 10318
 10319*************** CRI CODE START ******************
 10320     IF PI-PAYEE-TYPE NOT = 'A'
 10321        GO TO 1050-EDIT-CHECK-NO.
 10322
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 194
* EL156.cbl
 10323     MOVE LOW-VALUES             TO ERACCT-KEY.
 10324     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10325     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10326     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10327     MOVE PI-STATE               TO ACCT-STATE.
 10328     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10329     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10330     MOVE 'ACCT'                 TO FILE-SWITCH.
 10331
 10332     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10333     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10334
 10335
 10336* EXEC CICS HANDLE CONDITION
 10337*         NOTFND   (1950-NOT-FOUND)
 10338*         ENDFILE  (1950-NOT-FOUND)
 10339*    END-EXEC.
 10340*    MOVE '"$I''                  ! ( #00009964' TO DFHEIV0
 10341     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10343     MOVE X'2820233030303039393634' TO DFHEIV0(25:11)
 10344     CALL 'kxdfhei1' USING DFHEIV0
 10345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10346
 10347
 10348
 10349* EXEC CICS STARTBR
 10350*         DATASET   ('ERACCT')
 10351*         RIDFLD    (ERACCT-KEY)
 10352*         GTEQ
 10353*    END-EXEC.
 10354     MOVE 'ERACCT' TO DFHEIV1
 10355     MOVE 0
 10356       TO DFHEIV11
 10357*    MOVE '&,         G          &   #00009969' TO DFHEIV0
 10358     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10359     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10360     MOVE X'2020233030303039393639' TO DFHEIV0(25:11)
 10361     CALL 'kxdfhei1' USING DFHEIV0,
 10362           DFHEIV1,
 10363           ERACCT-KEY,
 10364           DFHEIV99,
 10365           DFHEIV11,
 10366           DFHEIV99
 10367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10368
 10369
 10370 1046-READNEXT-ERACCT.
 10371
 10372
 10373* EXEC CICS READNEXT
 10374*         DATASET   ('ERACCT')
 10375*         RIDFLD    (ERACCT-KEY)
 10376*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10377*    END-EXEC.
 10378     MOVE 'ERACCT' TO DFHEIV1
 10379     MOVE 0
 10380       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 195
* EL156.cbl
 10381*    MOVE '&.S                   )   #00009977' TO DFHEIV0
 10382     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10383     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10384     MOVE X'2020233030303039393737' TO DFHEIV0(25:11)
 10385     CALL 'kxdfhei1' USING DFHEIV0,
 10386           DFHEIV1,
 10387           DFHEIV20,
 10388           DFHEIV99,
 10389           ERACCT-KEY,
 10390           DFHEIV99,
 10391           DFHEIV11,
 10392           DFHEIV99,
 10393           DFHEIV99
 10394     SET ADDRESS OF ACCOUNT-MASTER TO
 10395         DFHEIV20
 10396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10397
 10398
 10399     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10400        IF WS-ERACCT-HOLD-RECORD = SPACES
 10401           GO TO 1950-NOT-FOUND
 10402        ELSE
 10403           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10404           GO TO 1048-CONTINUE.
 10405
 10406     IF ACCT-EXP-DT = HIGH-VALUES
 10407        NEXT SENTENCE
 10408     ELSE
 10409        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10410        GO TO 1046-READNEXT-ERACCT.
 10411
 10412 1048-CONTINUE.
 10413
 10414*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10415*       MOVE 'Y'                 TO GROUPEDI
 10416*                                   PI-GROUPED
 10417*                                   WS-GROUPED
 10418*       MOVE AL-UANON            TO GROUPEDA.
 10419*************** CRI CODE END ******************
 10420
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 196
* EL156.cbl
 10422 1050-EDIT-CHECK-NO.
 10423
 10424     IF PI-OFFLINE = 'Y'
 10425         IF PI-ECHECKNO = SPACES
 10426              MOVE ER-0439        TO EMI-ERROR
 10427              GO TO 1090-CHECK-NO-ERROR
 10428           ELSE
 10429*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10430*           IF PI-ECHECKNO-N = 'N' AND
 10431*              PI-CASH       = 'Y'
 10432*                MOVE ER-3535        TO EMI-ERROR
 10433*                GO TO 1090-CHECK-NO-ERROR
 10434*             ELSE
 10435*                MOVE AL-UANON    TO CHECKNOA
 10436*                GO TO 1100-EDIT-HOLDTIL
 10437*         ELSE
 10438            MOVE AL-UANON    TO CHECKNOA
 10439            GO TO 1100-EDIT-HOLDTIL.
 10440
 10441     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10442     MOVE '6'                    TO CNTL-REC-TYPE.
 10443
 10444     IF CONTROL-IS-ACTUAL-CARRIER
 10445         MOVE PI-CARRIER         TO WS-CARR
 10446     ELSE
 10447         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10448
 10449     IF PI-COMPANY-ID = 'FIA'
 10450         MOVE PI-CARRIER         TO WS-CARR.
 10451
 10452     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10453     MOVE 0                      TO CNTL-SEQ-NO.
 10454     MOVE 'CARR'                 TO FILE-SWITCH.
 10455
 10456     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10457
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 197
* EL156.cbl
 10459     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10460         GO TO 1051-EDIT-CHECKNO-CONT.
 10461
 10462**********************AIG LOGIC STARTS**********************
 10463     IF PI-ECHECKNO = SPACES
 10464         IF CHECK-NO-MANUAL
 10465             MOVE ER-0441        TO EMI-ERROR
 10466             GO TO 1090-CHECK-NO-ERROR
 10467         ELSE
 10468             MOVE AL-UANOF       TO CHECKNOA
 10469             GO TO 1100-EDIT-HOLDTIL.
 10470
 10471     IF PI-ECHECKNO NOT = SPACES
 10472         IF CHECK-NO-MANUAL
 10473             MOVE AL-UANON       TO CHECKNOA
 10474             GO TO 1100-EDIT-HOLDTIL.
 10475
 10476     IF PI-ECHECKNO-CR = 'CR'
 10477        IF PI-OFFLINE = 'Y'
 10478            MOVE AL-UANON       TO CHECKNOA
 10479            GO TO 1100-EDIT-HOLDTIL
 10480        ELSE
 10481            MOVE ER-3534        TO EMI-ERROR
 10482            GO TO 1090-CHECK-NO-ERROR.
 10483
 10484     IF PI-ECHECKNO-N = 'N'
 10485        IF PI-CASH = 'N'
 10486            MOVE AL-UANON       TO CHECKNOA
 10487            GO TO 1100-EDIT-HOLDTIL
 10488        ELSE
 10489            MOVE ER-3535          TO EMI-ERROR
 10490            GO TO 1090-CHECK-NO-ERROR.
 10491
 10492     MOVE ER-0442        TO EMI-ERROR
 10493     GO TO 1090-CHECK-NO-ERROR.
 10494**********************AIG LOGIC ENDS************************
 10495
 10496 1051-EDIT-CHECKNO-CONT.
 10497
 10498     IF PI-COMPANY-ID = 'DMD'
 10499        IF PI-ECHECKNO NOT = SPACES
 10500           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10501              MOVE ER-0442        TO EMI-ERROR
 10502              GO TO 1090-CHECK-NO-ERROR
 10503            ELSE
 10504              GO TO 1100-EDIT-HOLDTIL
 10505          ELSE
 10506           GO TO 1100-EDIT-HOLDTIL.
 10507
 10508     IF PI-ECHECKNO = SPACES
 10509         IF CHECK-NO-MANUAL
 10510             MOVE ER-0441        TO EMI-ERROR
 10511             GO TO 1090-CHECK-NO-ERROR
 10512         ELSE
 10513             MOVE AL-UANOF       TO CHECKNOA
 10514             GO TO 1100-EDIT-HOLDTIL
 10515     ELSE
 10516         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 198
* EL156.cbl
 10517             MOVE AL-UANON       TO CHECKNOA
 10518             GO TO 1100-EDIT-HOLDTIL
 10519         ELSE
 10520             MOVE ER-0442        TO EMI-ERROR
 10521             GO TO 1090-CHECK-NO-ERROR.
 10522
 10523 1090-CHECK-NO-ERROR.
 10524     MOVE -1                     TO CHECKNOL.
 10525     MOVE AL-UABON               TO CHECKNOA.
 10526     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10527
 10528     GO TO 2000-EDIT-DONE.
 10529
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 199
* EL156.cbl
 10531 1100-EDIT-HOLDTIL.
 10532     MOVE AL-UANON               TO HOLDTILA.
 10533
 10534     IF PI-HOLDTIL = ZEROS
 10535        IF PI-OFFLINE = 'Y'
 10536           MOVE ER-0572          TO EMI-ERROR
 10537           GO TO 1105-HOLDTIL-ERROR
 10538        ELSE
 10539           GO TO 1110-EDIT-PAID-FROM.
 10540
 10541     MOVE '4'                    TO DC-OPTION-CODE.
 10542     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10543     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10544
 10545     IF DATE-CONVERSION-ERROR
 10546         MOVE ER-0446            TO EMI-ERROR
 10547         GO TO 1105-HOLDTIL-ERROR
 10548     END-IF
 10549     IF PI-OFFLINE = 'Y'
 10550        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10551           MOVE ER-0446            TO EMI-ERROR
 10552           GO TO 1105-HOLDTIL-ERROR
 10553        END-IF
 10554     END-IF
 10555
 10556     IF PI-OFFLINE = 'Y'
 10557        GO TO 1110-EDIT-PAID-FROM.
 10558
 10559     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10560     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10561     MOVE '1'                    TO DC-OPTION-CODE.
 10562     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10563
 10564     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10565         MOVE ER-0447            TO EMI-ERROR
 10566         GO TO 1105-HOLDTIL-ERROR.
 10567
 10568     GO TO 1110-EDIT-PAID-FROM.
 10569
 10570 1105-HOLDTIL-ERROR.
 10571     MOVE -1                     TO HOLDTILL.
 10572     MOVE AL-UNBON               TO HOLDTILA.
 10573     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10574
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 200
* EL156.cbl
 10576 1110-EDIT-PAID-FROM.
 10577     MOVE AL-UANON               TO EPYFROMA.
 10578
 10579     IF PI-EPYFROM = ZEROS
 10580         GO TO 1120-CALCULATE-PAID-FROM.
 10581
 10582     IF PI-PMTTYPE = '5' OR '6'
 10583         MOVE ER-0448            TO EMI-ERROR
 10584         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10585         MOVE AL-UNBON           TO EPYFROMA
 10586         MOVE -1                 TO EPYFROML
 10587         GO TO 1150-EDIT-PAID-THRU.
 10588
 10589     MOVE '4'                    TO DC-OPTION-CODE.
 10590     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10591     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10592
 10593     IF DATE-CONVERSION-ERROR
 10594         MOVE ER-0449            TO EMI-ERROR
 10595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10596         MOVE AL-UNBON           TO EPYFROMA
 10597         MOVE -1                 TO EPYFROML
 10598     ELSE
 10599         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10600
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 201
* EL156.cbl
 10602 1120-CALCULATE-PAID-FROM.
 10603     IF PI-PMTTYPE = '5' OR '6'
 10604         GO TO 1150-EDIT-PAID-THRU.
 10605
 10606*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10607*       IF PI-PMTTYPE = '4'
 10608*         GO TO 1150-EDIT-PAID-THRU.
 10609
 10610     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10611         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10612         MOVE ' '                TO DC-OPTION-CODE
 10613         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10614         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10615         GO TO 1145-TEST-PAID-FROM.
 10616
 10617     IF PI-PMTTYPE = '4'
 10618        GO TO 1150-EDIT-PAID-THRU.
 10619
 10620     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10621     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10622     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10623     MOVE '5'                    TO CNTL-REC-TYPE.
 10624     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10625     MOVE 'BENE'                 TO FILE-SWITCH.
 10626
 10627     IF WS-BEN-CD = ZEROS
 10628         GO TO 1950-NOT-FOUND.
 10629
 10630     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10631
 10632     IF NO-BENEFIT-FOUND
 10633         GO TO 1950-NOT-FOUND.
 10634
 10635     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10636     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10637
 10638     IF PI-BEN-DAYS NOT NUMERIC
 10639        MOVE ZEROS               TO PI-BEN-DAYS.
 10640
 10641     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10642
 10643     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10644        (CL-TOTAL-PAID-AMT > ZEROS)
 10645         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10646         MOVE '6'                 TO DC-OPTION-CODE
 10647         MOVE +0                  TO DC-ELAPSED-MONTHS
 10648         MOVE +1                  TO DC-ELAPSED-DAYS
 10649         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10650         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10651         GO TO 1145-TEST-PAID-FROM.
 10652
 10653******************************************************************
 10654****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10655****** SPECIAL ENTERED DATE.
 10656******************************************************************
 10657
 10658     IF PI-AIGFROM = ZEROS
 10659         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 202
* EL156.cbl
 10660
 10661     MOVE AL-UANON TO AIGFROMA.
 10662
 10663     MOVE '4'                    TO DC-OPTION-CODE.
 10664     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10665     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10666
 10667     IF DATE-CONVERSION-ERROR
 10668         MOVE ER-0449            TO EMI-ERROR
 10669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10670         MOVE AL-UNBON           TO AIGFROMA
 10671         MOVE -1                 TO AIGFROML
 10672         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10673     ELSE
 10674         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10675         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10676
 10677     GO TO 1140-CONTINUE-PAID-FROM.
 10678
 10679 1130-CONTINUE-PAID-FROM.
 10680
 10681     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10682        (CL-TOTAL-PAID-AMT = ZEROS)
 10683           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10684
 10685 1140-CONTINUE-PAID-FROM.
 10686
 10687     IF PI-BEN-TYPE = 'R'
 10688         IF PI-BEN-DAYS = ZEROS
 10689             NEXT SENTENCE
 10690         ELSE
 10691         IF PI-COMPANY-ID NOT = 'DMD'
 10692             SUBTRACT 1 FROM PI-BEN-DAYS.
 10693
 10694     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10695
 10696     IF PI-COMPANY-ID = 'DMD'
 10697         MOVE -1                 TO DC-ELAPSED-DAYS
 10698         MOVE +0                 TO DC-ELAPSED-MONTHS
 10699         MOVE '6'                TO DC-OPTION-CODE
 10700         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10701         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10702         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10703                               REMAINDER DC-ELAPSED-DAYS
 10704      ELSE
 10705         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10706         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10707
 10708     MOVE '6'                    TO DC-OPTION-CODE.
 10709     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10710     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10711
 10712     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10713
 10714     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10715         MOVE ER-0541            TO EMI-ERROR
 10716         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10717         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 203
* EL156.cbl
 10718         MOVE AL-UNBON           TO EPYFROMA.
 10719
 10720     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10721        (PI-BENEFIT-SAVE = '60E')
 10722        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10723           (CL-TOTAL-PAID-AMT = ZEROS)
 10724             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10725             MOVE 30                  TO DC-ELAPSED-DAYS
 10726             MOVE +0                  TO DC-ELAPSED-MONTHS
 10727             MOVE '6'                 TO DC-OPTION-CODE
 10728             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10729
 10730     IF PI-BEN-TYPE = 'R'
 10731         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10732     ELSE
 10733         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10734         IF WS-SV-EPYFROM = LOW-VALUES
 10735            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10736
 10737     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10738         IF WS-USE-AIG-PAYFROM   OR
 10739            WS-AIG-RECALC-PAYFROM
 10740              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10741                                      DC-BIN-DATE-1
 10742              MOVE ' '            TO  DC-OPTION-CODE
 10743              MOVE +0             TO  DC-ELAPSED-MONTHS
 10744                                      DC-ELAPSED-DAYS
 10745              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10746              IF NO-CONVERSION-ERROR
 10747                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10748
 10749     IF PI-CPYFROM < CL-INCURRED-DT
 10750        MOVE -1                  TO EPYFROML
 10751        MOVE ER-3542             TO EMI-ERROR
 10752        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10753
 10754     IF CM-ENTRY-DT < CL-INCURRED-DT
 10755        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10756        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10757        MOVE +0                     TO DC-ELAPSED-DAYS
 10758        MOVE +0                     TO DC-ELAPSED-MONTHS
 10759        MOVE '1'                    TO DC-OPTION-CODE
 10760        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10761        ELSE
 10762        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10763
 10764     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10765         NEXT SENTENCE
 10766     ELSE
 10767         IF DC-ELAPSED-MONTHS < 2
 10768             MOVE ER-3255        TO EMI-ERROR
 10769             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10770
 10771 1145-TEST-PAID-FROM.
 10772     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10773         GO TO 1150-EDIT-PAID-THRU.
 10774
 10775     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 204
* EL156.cbl
 10776         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10777         MOVE ' '                TO DC-OPTION-CODE
 10778         MOVE +0                 TO DC-ELAPSED-MONTHS
 10779                                    DC-ELAPSED-DAYS
 10780         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10781         IF NO-CONVERSION-ERROR
 10782             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10783         ELSE
 10784             MOVE SPACES             TO EMI-DATE-FIELD.
 10785
 10786     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10787         IF CL-TOTAL-PAID-AMT = ZEROS
 10788             MOVE ER-3543            TO EMI-ERROR
 10789             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10790             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10791             IF EMI-MESSAGE-FORMATTED
 10792                MOVE -1             TO EPYFROML
 10793                MOVE AL-UNBON       TO EPYFROMA
 10794             ELSE
 10795                NEXT SENTENCE
 10796         ELSE
 10797             MOVE ER-0452            TO EMI-ERROR
 10798             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10799             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10800             IF EMI-MESSAGE-FORMATTED
 10801                MOVE -1             TO EPYFROML
 10802                MOVE AL-UNBON       TO EPYFROMA.
 10803
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 205
* EL156.cbl
 10805 1150-EDIT-PAID-THRU.
 10806
 10807     MOVE AL-UANON               TO EPYTHRUA.
 10808
 10809     IF PI-EPYTHRU = ZEROS
 10810         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10811             GO TO 1200-EDIT-FIND-TOLERANCES
 10812         ELSE
 10813            IF (PI-PMTTYPE = '3') OR
 10814               (PI-PMTTYPE = '2' AND
 10815                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10816               GO TO 1152-CHECK-TYPE
 10817            ELSE
 10818               MOVE ER-0473      TO EMI-ERROR
 10819               GO TO 1170-PAID-THRU-FATAL-ERROR
 10820     ELSE
 10821         IF PI-PMTTYPE = '5' OR '6'
 10822             MOVE ER-0474        TO EMI-ERROR
 10823             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10824
 10825     MOVE '4'                    TO DC-OPTION-CODE.
 10826     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10827     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10828
 10829     IF DATE-CONVERSION-ERROR
 10830         MOVE ER-0475            TO EMI-ERROR
 10831         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10832
 10833     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10834
 10835     IF PI-COMPANY-ID = 'DMD'
 10836         IF PI-PMTTYPE NOT = '2'
 10837                 AND
 10838            WS-EXP-DT > WS-SV-EPYTHRU
 10839             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10840             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10841             MOVE '1'              TO DC-OPTION-CODE
 10842             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10843             IF DATE-CONVERSION-ERROR
 10844                 MOVE ER-0944      TO EMI-ERROR
 10845                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10846             ELSE
 10847                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10848                    DC-ELAPSED-DAYS   = 1
 10849                     MOVE ER-0945  TO EMI-ERROR
 10850                     MOVE -1       TO EPYTHRUL
 10851                     MOVE AL-UABON TO EPYTHRUA
 10852                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10853
 10854     IF PI-PMTTYPE = '4'
 10855         NEXT SENTENCE
 10856     ELSE
 10857         IF WS-SV-EPYTHRU = WS-EXP-DT
 10858             IF PI-PMTTYPE NOT = '2' AND '3'
 10859                 MOVE ER-3541    TO EMI-ERROR
 10860                 MOVE -1         TO PMTTYPEL
 10861                 MOVE AL-UABON   TO PMTTYPEA
 10862                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 206
* EL156.cbl
 10863
 10864     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10865         MOVE ER-0501            TO EMI-ERROR
 10866         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10867
 10868     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10869        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10870*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10871*              MOVE ER-0540         TO EMI-ERROR
 10872*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10873*              MOVE -1              TO EPYTHRUL
 10874*              MOVE AL-UNBON        TO EPYTHRUA
 10875*          ELSE
 10876*          IF PI-COMPANY-ID = 'DMD'
 10877*              MOVE ER-7540         TO EMI-ERROR
 10878*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10879*              MOVE -1              TO EPYTHRUL
 10880*              MOVE AL-UNBON        TO EPYTHRUA
 10881*          ELSE
 10882               IF PI-PMTTYPE NOT = '2' AND '3'
 10883                  IF PI-COMPANY-ID = '???'
 10884                      MOVE ER-7540  TO EMI-ERROR
 10885                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10886                      MOVE -1       TO EPYTHRUL
 10887                      MOVE AL-UNBON TO EPYTHRUA
 10888                  ELSE
 10889                      MOVE ER-0540  TO EMI-ERROR
 10890                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10891                      MOVE -1       TO EPYTHRUL
 10892                      MOVE AL-UNBON TO EPYTHRUA.
 10893
 10894     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10895            OR
 10896        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10897         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10898            OR
 10899        (PI-CPYFROM NOT = LOW-VALUES AND
 10900         PI-CPYFROM < CL-PAID-THRU-DT)
 10901        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10902
 10903 1152-CHECK-TYPE.
 10904     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 10905        OR (PI-PMTTYPE = '5' OR '6')
 10906         GO TO 1160-EDIT-PAID-THRU-AH.
 10907
 10908 1155-EDIT-PAID-THRU-LIFE.
 10909     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10910     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10911     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10912     MOVE '4'                    TO CNTL-REC-TYPE.
 10913     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10914     MOVE 'BENE'                 TO FILE-SWITCH.
 10915
 10916     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10917
 10918     IF NO-BENEFIT-FOUND
 10919         GO TO 1950-NOT-FOUND.
 10920
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 207
* EL156.cbl
 10921     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10922
 10923     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10924
 10925     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10926        PI-LF-COVERAGE-TYPE = 'P'
 10927         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10928         GO TO 1200-EDIT-FIND-TOLERANCES.
 10929
 10930     IF PI-EPYTHRU = ZEROS
 10931        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10932
 10933     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10934         MOVE ER-0476            TO EMI-ERROR
 10935         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10936
 10937     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10938*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10939     move cl-critical-period    to dc-elapsed-months
 10940     MOVE +0                    TO DC-ELAPSED-DAYS.
 10941     MOVE '6'                   TO DC-OPTION-CODE.
 10942     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10943
 10944     IF (NO-CONVERSION-ERROR AND
 10945         WS-SPECIAL-CALC-CD = 'C')
 10946        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10947            MOVE ER-0657 TO EMI-ERROR
 10948            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10949
 10950     IF PI-COMPANY-ID = 'NCL'
 10951         IF WS-SPECIAL-CALC-CD = 'C' AND
 10952            cl-critical-period = zeros
 10953*           CM-LF-CRITICAL-PERIOD = +0
 10954             MOVE ER-0844       TO EMI-ERROR
 10955             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10956
 10957     GO TO 1200-EDIT-FIND-TOLERANCES.
 10958
 10959 1160-EDIT-PAID-THRU-AH.
 10960     IF PI-EPYTHRU = ZEROS
 10961        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10962                                    WS-SV-EPYTHRU
 10963     ELSE
 10964        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10965
 10966     IF WS-SV-EPYTHRU < PI-CPYFROM
 10967         MOVE ER-0508            TO EMI-ERROR
 10968         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10969
 10970     perform 7975-read-acct      thru 7975-exit
 10971     move zeros                  to pi-max-ext
 10972     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10973        PERFORM 0900-GET-DDF-LIMITS
 10974                                 THRU 0900-EXIT
 10975        IF PDEF-FOUND
 10976           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10977              (P1 > +8)
 10978              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 208
* EL156.cbl
 10979           END-PERFORM
 10980           IF P1 < +9
 10981              MOVE PD-MAX-extension (P1)
 10982                                 TO pi-max-ext
 10983           else
 10984              move er-1674       to emi-error
 10985              PERFORM 9900-ERROR-FORMAT
 10986                                 THRU 9900-EXIT
 10987           END-IF
 10988        else
 10989           move er-1672          to emi-error
 10990           PERFORM 9900-ERROR-FORMAT
 10991                                 THRU 9900-EXIT
 10992        END-IF
 10993     end-if
 10994     move spaces                 to pi-max-ext-used
 10995     IF PI-PMTTYPE = '3'
 10996        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10997        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10998           MOVE ER-0477          TO EMI-ERROR
 10999           PERFORM 1165-PAID-THRU-ERROR
 11000                                 THRU 1165-EXIT
 11001        ELSE
 11002           continue
 11003        end-if
 11004     ELSE
 11005        IF WS-SV-EPYTHRU > WS-EXP-DT
 11006           move ws-exp-dt        to dc-bin-date-1
 11007           move ws-sv-epythru    to dc-bin-date-2
 11008           MOVE '1'              TO DC-OPTION-CODE
 11009           MOVE +0               TO DC-ELAPSED-DAYS
 11010                                    DC-ELAPSED-MONTHS
 11011           PERFORM 9700-LINK-DATE-CONVERT
 11012                                 THRU 9700-EXIT
 11013           if no-conversion-error
 11014              if dc-elapsed-days > zeros
 11015                 add +1 to dc-elapsed-months
 11016              end-if
 11017              if dc-elapsed-months > pi-max-ext
 11018                 MOVE ER-0557    TO EMI-ERROR
 11019                 PERFORM 1165-PAID-THRU-ERROR
 11020                                 THRU 1165-EXIT
 11021              else
 11022                 move 'Y'        to pi-max-ext-used
 11023                 move er-1670    to emi-error
 11024                 perform 9900-error-format
 11025                                 thru 9900-exit
 11026              end-if
 11027           end-if
 11028        end-if
 11029     end-if
 11030
 11031     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11032         PI-PMTTYPE NOT = '3'
 11033         MOVE ER-0541        TO EMI-ERROR
 11034         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11035
 11036     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 209
* EL156.cbl
 11037        (PI-PMTTYPE NOT = '3')
 11038         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11039             MOVE ER-0478        TO EMI-ERROR
 11040             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11041
 11042     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11043        (PI-PMTTYPE NOT = '4')
 11044         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11045             MOVE ER-0479        TO EMI-ERROR
 11046             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11047
 11048     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11049         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11050             MOVE ER-0545        TO EMI-ERROR
 11051             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11052
 11053     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11054         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11055             MOVE ER-0481        TO EMI-ERROR
 11056             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11057
 11058*    IF PI-COMPANY-ID = 'NCL'
 11059*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11060*           CM-AH-CRITICAL-PERIOD = +0
 11061*            MOVE ER-0844        TO  EMI-ERROR
 11062*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11063
 11064*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11065     if (cl-critical-period = zeros)
 11066        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11067          GO TO 1200-EDIT-FIND-TOLERANCES.
 11068
 11069     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11070     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11071     MOVE '1'        TO DC-OPTION-CODE.
 11072     MOVE +0         TO DC-ELAPSED-DAYS
 11073                        DC-ELAPSED-MONTHS.
 11074     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11075
 11076*    IF NO-CONVERSION-ERROR
 11077*       COMPUTE ws-benefits-paid =
 11078*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11079*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11080*           MOVE ER-0657 TO EMI-ERROR
 11081*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11082
 11083     GO TO 1200-EDIT-FIND-TOLERANCES.
 11084
 11085 1165-PAID-THRU-ERROR.
 11086     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11087
 11088     IF EMI-MESSAGE-FORMATTED
 11089         MOVE -1                 TO EPYTHRUL
 11090         MOVE AL-UNBON           TO EPYTHRUA.
 11091
 11092 1165-EXIT.
 11093     EXIT.
 11094
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 210
* EL156.cbl
 11095 1166-CHECK-ALL-TRLRS.
 11096
 11097     IF PI-PMTTYPE = '4'
 11098        GO TO 1166-TRLR-EXIT.
 11099
 11100     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11101
 11102     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11103        WS-SV-EPYFROM = LOW-VALUES
 11104          GO TO 1166-END-CHECK.
 11105
 11106
 11107* EXEC CICS HANDLE CONDITION
 11108*        ENDFILE   (1166-END-CHECK)
 11109*        NOTFND    (1166-END-CHECK)
 11110*    END-EXEC.
 11111*    MOVE '"$''I                  ! ) #00010690' TO DFHEIV0
 11112     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11114     MOVE X'2920233030303130363930' TO DFHEIV0(25:11)
 11115     CALL 'kxdfhei1' USING DFHEIV0
 11116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11117
 11118
 11119     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11120     MOVE +100                   TO TRLR-SEQ-NO.
 11121
 11122
 11123* EXEC CICS STARTBR
 11124*         DATASET    ('ELTRLR')
 11125*         RIDFLD     (ELTRLR-KEY)
 11126*         GTEQ
 11127*    END-EXEC.
 11128     MOVE 'ELTRLR' TO DFHEIV1
 11129     MOVE 0
 11130       TO DFHEIV11
 11131*    MOVE '&,         G          &   #00010698' TO DFHEIV0
 11132     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11133     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11134     MOVE X'2020233030303130363938' TO DFHEIV0(25:11)
 11135     CALL 'kxdfhei1' USING DFHEIV0,
 11136           DFHEIV1,
 11137           ELTRLR-KEY,
 11138           DFHEIV99,
 11139           DFHEIV11,
 11140           DFHEIV99
 11141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11142
 11143
 11144     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11145
 11146 1166-READ-TRLR-NEXT.
 11147
 11148
 11149* EXEC CICS READNEXT
 11150*         DATASET    ('ELTRLR')
 11151*         RIDFLD     (ELTRLR-KEY)
 11152*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 211
* EL156.cbl
 11153*    END-EXEC.
 11154     MOVE 'ELTRLR' TO DFHEIV1
 11155     MOVE 0
 11156       TO DFHEIV11
 11157*    MOVE '&.S                   )   #00010708' TO DFHEIV0
 11158     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11159     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11160     MOVE X'2020233030303130373038' TO DFHEIV0(25:11)
 11161     CALL 'kxdfhei1' USING DFHEIV0,
 11162           DFHEIV1,
 11163           DFHEIV20,
 11164           DFHEIV99,
 11165           ELTRLR-KEY,
 11166           DFHEIV99,
 11167           DFHEIV11,
 11168           DFHEIV99,
 11169           DFHEIV99
 11170     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11171         DFHEIV20
 11172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11173
 11174
 11175     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11176        TRLR-CARRIER  = MSTR-CARRIER  AND
 11177        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11178        TRLR-CERT-NO  = MSTR-CERT-NO
 11179          NEXT SENTENCE
 11180      ELSE
 11181          GO TO 1166-END-CHECK.
 11182
 11183* **  BYPASS ALL NON-PAYMENT TRAILERS
 11184
 11185     IF AT-TRAILER-TYPE = '2'
 11186        NEXT SENTENCE
 11187     ELSE
 11188        GO TO 1166-READ-TRLR-NEXT.
 11189
 11190* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11191
 11192     IF AT-PAYMENT-TYPE = '1' OR '2'
 11193        NEXT SENTENCE
 11194     ELSE
 11195        GO TO 1166-READ-TRLR-NEXT.
 11196
 11197* **  BYPASS ALL VOID PAYMENTS
 11198
 11199     IF AT-VOID-DT NOT = LOW-VALUES
 11200        GO TO 1166-READ-TRLR-NEXT.
 11201
 11202     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11203        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11204          GO TO 1166-READ-TRLR-NEXT.
 11205
 11206     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11207         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11208            OR
 11209        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11210         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 212
* EL156.cbl
 11211        NEXT SENTENCE
 11212     ELSE
 11213         IF CL-TOTAL-PAID-AMT > ZEROS
 11214             MOVE ER-0502            TO EMI-ERROR
 11215             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11216             MOVE -1                 TO EPYTHRUL
 11217             MOVE AL-UNBON           TO EPYTHRUA.
 11218
 11219     GO TO 1166-READ-TRLR-NEXT.
 11220
 11221 1166-END-CHECK.
 11222
 11223     IF WS-BROWSE-TRLR-SW = 'Y'
 11224
 11225* EXEC CICS ENDBR
 11226*            DATASET   ('ELTRLR')
 11227*       END-EXEC.
 11228     MOVE 'ELTRLR' TO DFHEIV1
 11229     MOVE 0
 11230       TO DFHEIV11
 11231*    MOVE '&2                    $   #00010763' TO DFHEIV0
 11232     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11233     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11234     MOVE X'2020233030303130373633' TO DFHEIV0(25:11)
 11235     CALL 'kxdfhei1' USING DFHEIV0,
 11236           DFHEIV1,
 11237           DFHEIV11,
 11238           DFHEIV99
 11239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11240
 11241
 11242     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11243
 11244 1166-TRLR-EXIT.
 11245     EXIT.
 11246
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 213
* EL156.cbl
 11248 1170-PAID-THRU-FATAL-ERROR.
 11249     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11250
 11251     MOVE -1                     TO EPYTHRUL.
 11252     MOVE AL-UNBON               TO EPYTHRUA.
 11253
 11254 1200-EDIT-FIND-TOLERANCES.
 11255
 11256* EXEC CICS HANDLE CONDITION
 11257*        ENDFILE(1950-NOT-FOUND)
 11258*        NOTFND (1950-NOT-FOUND)
 11259*    END-EXEC.
 11260*    MOVE '"$''I                  ! * #00010780' TO DFHEIV0
 11261     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11263     MOVE X'2A20233030303130373830' TO DFHEIV0(25:11)
 11264     CALL 'kxdfhei1' USING DFHEIV0
 11265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11266
 11267
 11268     IF PI-PROCESSOR-ID = 'LGXX'
 11269        GO TO 1240-FIND-ACCT-TOLERANCES.
 11270
 11271     MOVE 'N'                    TO FOUND-TOL-SW.
 11272     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11273     MOVE '2'                    TO CNTL-REC-TYPE.
 11274     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11275     MOVE +0                     TO CNTL-SEQ-NO.
 11276     MOVE 'PROC'                 TO FILE-SWITCH.
 11277
 11278     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11279
 11280     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11281     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11282                                    PI-MAX-PMT-TOL.
 11283     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11284
 11285     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11286         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11287
 11288     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11289     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11290                                    PI-MAX-LF-PMT-TOL.
 11291
 11292     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11293         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11294
 11295     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11296                                    PI-MAX-EXP-PMT.
 11297
 11298 1240-FIND-ACCT-TOLERANCES.
 11299
 11300     IF WS-PMT-TOL NOT = +0
 11301         MOVE 'Y'                TO FOUND-TOL-SW.
 11302
 11303     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11304         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11305         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 214
* EL156.cbl
 11306         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11307         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11308         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11309         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11310     ELSE
 11311         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11312         MOVE PI-CARRIER             TO ACCT-CARRIER
 11313         MOVE PI-GROUPING            TO ACCT-GROUPING
 11314         MOVE PI-STATE               TO ACCT-STATE
 11315         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11316         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11317
 11318     MOVE 'ACCT'                 TO FILE-SWITCH.
 11319
 11320     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11321     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11322
 11323
 11324* EXEC CICS HANDLE CONDITION
 11325*         NOTFND   (1950-NOT-FOUND)
 11326*         ENDFILE  (1950-NOT-FOUND)
 11327*    END-EXEC.
 11328*    MOVE '"$I''                  ! + #00010840' TO DFHEIV0
 11329     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11331     MOVE X'2B20233030303130383430' TO DFHEIV0(25:11)
 11332     CALL 'kxdfhei1' USING DFHEIV0
 11333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11334
 11335
 11336
 11337* EXEC CICS STARTBR
 11338*        DATASET('ERACCT')
 11339*        RIDFLD (ERACCT-KEY)
 11340*        GTEQ
 11341*    END-EXEC.
 11342     MOVE 'ERACCT' TO DFHEIV1
 11343     MOVE 0
 11344       TO DFHEIV11
 11345*    MOVE '&,         G          &   #00010845' TO DFHEIV0
 11346     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11347     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11348     MOVE X'2020233030303130383435' TO DFHEIV0(25:11)
 11349     CALL 'kxdfhei1' USING DFHEIV0,
 11350           DFHEIV1,
 11351           ERACCT-KEY,
 11352           DFHEIV99,
 11353           DFHEIV11,
 11354           DFHEIV99
 11355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11356
 11357
 11358 1245-FIND-ACCT-TOLERANCES-LOOP.
 11359
 11360
 11361* EXEC CICS READNEXT
 11362*        DATASET('ERACCT')
 11363*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 215
* EL156.cbl
 11364*        RIDFLD (ERACCT-KEY)
 11365*    END-EXEC.
 11366     MOVE 'ERACCT' TO DFHEIV1
 11367     MOVE 0
 11368       TO DFHEIV11
 11369*    MOVE '&.S                   )   #00010853' TO DFHEIV0
 11370     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11371     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11372     MOVE X'2020233030303130383533' TO DFHEIV0(25:11)
 11373     CALL 'kxdfhei1' USING DFHEIV0,
 11374           DFHEIV1,
 11375           DFHEIV20,
 11376           DFHEIV99,
 11377           ERACCT-KEY,
 11378           DFHEIV99,
 11379           DFHEIV11,
 11380           DFHEIV99,
 11381           DFHEIV99
 11382     SET ADDRESS OF ACCOUNT-MASTER TO
 11383         DFHEIV20
 11384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11385
 11386
 11387     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11388        IF WS-ERACCT-HOLD-RECORD = SPACES
 11389           GO TO 1950-NOT-FOUND
 11390        ELSE
 11391           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11392           GO TO 1250-CONTINUE.
 11393
 11394     IF ACCT-EXP-DT = HIGH-VALUES
 11395        NEXT SENTENCE
 11396     ELSE
 11397        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11398        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11399
 11400 1250-CONTINUE.
 11401
 11402     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11403
 11404     IF FOUND-TOL-SW = 'N'
 11405         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11406
 11407********* 1260-FIND-STATE-TOLERANCES.
 11408
 11409     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11410     MOVE PI-STATE               TO WS-ST-ACCESS.
 11411     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11412     MOVE '3'                    TO CNTL-REC-TYPE.
 11413     MOVE +0                     TO CNTL-SEQ-NO.
 11414     MOVE 'STAT'                 TO FILE-SWITCH.
 11415
 11416     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11417
 11418     IF WS-PMT-TOL = +0
 11419         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11420
 11421     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 216
* EL156.cbl
 11422     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11423     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11424     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11425     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11426
 11427****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11428****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11429     IF PI-PAYEE-TYPE <> 'B'
 11430           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11431     END-IF.
 11432
 11433     IF PI-PMTTYPE      = '2'  AND
 11434        PI-SPLIT-PMT-SW = 'Y'  AND
 11435        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11436          MOVE ER-3530                TO EMI-ERROR
 11437          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11438
 11439********* 1280-FIND-BENEFIT-TOLERANCES.
 11440
 11441     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11442        OR (PI-PMTTYPE = '5' OR '6')
 11443         GO TO 1300-FIND-CARR-TOLERANCES.
 11444
 11445     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11446     MOVE '4'                    TO CNTL-REC-TYPE.
 11447     MOVE +0                     TO CNTL-SEQ-NO.
 11448     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11449     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11450     MOVE 'BENE'                 TO FILE-SWITCH.
 11451
 11452     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11453
 11454     IF NO-BENEFIT-FOUND
 11455         GO TO 1950-NOT-FOUND.
 11456
 11457     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11458     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11459     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11460
 11461
 11462* EXEC CICS HANDLE CONDITION
 11463*        NOTFND(1950-NOT-FOUND)
 11464*    END-EXEC.
 11465*    MOVE '"$I                   ! , #00010933' TO DFHEIV0
 11466     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11468     MOVE X'2C20233030303130393333' TO DFHEIV0(25:11)
 11469     CALL 'kxdfhei1' USING DFHEIV0
 11470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11471
 11472
 11473 1300-FIND-CARR-TOLERANCES.
 11474     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11475     MOVE '6'                    TO CNTL-REC-TYPE.
 11476
 11477     IF CONTROL-IS-ACTUAL-CARRIER
 11478         MOVE PI-CARRIER               TO WS-CARR
 11479     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 217
* EL156.cbl
 11480         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11481
 11482     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11483     MOVE +0                     TO CNTL-SEQ-NO.
 11484     MOVE 'CARR'                 TO FILE-SWITCH.
 11485
 11486     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11487
 11488     IF WS-DAYS-TOL = +0
 11489         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11490
 11491     IF WS-PMT-TOL = +0
 11492         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11493
 11494     IF WS-MAX-DAYS-TOL = +0
 11495         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11496
 11497     IF WS-MAX-PMT-TOL = +0
 11498         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11499                                    PI-MAX-PMT-TOL.
 11500
 11501     IF WS-MAX-LF-PMT-TOL = +0
 11502        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11503                                    PI-MAX-LF-PMT-TOL.
 11504
 11505     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11506
 11507********* 1320-FIND-COMP-TOLERANCES.
 11508
 11509     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11510     MOVE '1'                    TO CNTL-REC-TYPE.
 11511     MOVE SPACES                 TO CNTL-ACCESS.
 11512     MOVE +0                     TO CNTL-SEQ-NO.
 11513     MOVE 'COMP'                 TO FILE-SWITCH.
 11514
 11515     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11516
 11517     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11518     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11519
 11520     IF WS-PMT-TOL NOT = +0
 11521        IF WS-TOL-SEVERITY NOT = ' '
 11522         GO TO 1360-EDIT-DAYS.
 11523
 11524     IF WS-PMT-TOL = +0
 11525         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11526
 11527     IF WS-TOL-SEVERITY = ' '
 11528         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11529
 11530 1360-EDIT-DAYS.
 11531     IF PI-PMTTYPE NOT = '4'
 11532        IF PI-EDAYS NEGATIVE OR
 11533           PI-EPYAMT NEGATIVE
 11534          MOVE ER-0513             TO EMI-ERROR
 11535          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536          MOVE -1                  TO PMTTYPEL.
 11537
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 218
* EL156.cbl
 11538     IF PI-PMTTYPE = '5' OR '6'
 11539        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11540
 11541     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11542        IF PI-PMTTYPE = '4'
 11543          MOVE PI-EDAYS          TO PI-CDAYS.
 11544
 11545     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11546         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11547
 11548     IF PI-PMTTYPE = '4'
 11549        MOVE PI-EDAYS            TO PI-CDAYS
 11550        GO TO 1400-EDIT-PAYMENT.
 11551
 11552     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11553        GO TO 1500-EDIT-EXPENSES.
 11554
 11555*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11556*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11557*          CM-AH-BENEFIT-CD = '23'              AND
 11558*          CL-CERT-STATE    = '04'              AND
 11559*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11560*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11561*            GO TO 1362-CHECK-MAX-DAYS.
 11562
 11563     IF PI-EDAYS = ZEROS
 11564*        IF PI-COMPANY-ID = 'DMD'
 11565*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11566*            MOVE -1             TO DC-ELAPSED-DAYS
 11567*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11568*            MOVE '6'            TO DC-OPTION-CODE
 11569*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11570*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11571*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11572*            MOVE '1'            TO DC-OPTION-CODE
 11573*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11574*            IF NO-CONVERSION-ERROR
 11575*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11576*                                 + DC-ODD-DAYS-OVER
 11577*               MOVE 6           TO EDAYSL
 11578*               MOVE AL-UNNON    TO EDAYSA
 11579*            ELSE
 11580*                NEXT SENTENCE
 11581*       ELSE
 11582            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11583            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11584            MOVE '1'             TO DC-OPTION-CODE
 11585            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11586            IF NO-CONVERSION-ERROR
 11587                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11588                ADD 1                 TO PI-EDAYS
 11589                MOVE AL-UNNON         TO EDAYSA.
 11590
 11591*    IF PI-COMPANY-ID = 'DMD'
 11592*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11593*        MOVE -1                 TO DC-ELAPSED-DAYS
 11594*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11595*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 219
* EL156.cbl
 11596*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11597*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11598*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11599*        MOVE '1'                TO DC-OPTION-CODE
 11600*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11601*    ELSE
 11602         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11603         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11604         MOVE '1'                TO DC-OPTION-CODE.
 11605         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11606
 11607     IF NO-CONVERSION-ERROR
 11608        IF PI-COMPANY-ID = 'DMD'
 11609            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11610                             + DC-ODD-DAYS-OVER
 11611        ELSE
 11612            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11613            ADD 1                TO PI-CDAYS.
 11614
 11615     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11616        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11617        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11618
 11619     IF PI-EDAYS NOT NUMERIC
 11620         MOVE ER-0491            TO EMI-ERROR
 11621         GO TO 1370-DAYS-ERROR.
 11622
 11623     IF CL-NO-OF-PMTS-MADE = 0
 11624        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11625        AND CL-CERT-STATE = 'MI'
 11626        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11627            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11628     END-IF.
 11629
 11630 1362-CHECK-MAX-DAYS.
 11631
 11632     IF WS-MAX-DAYS-TOL = +999
 11633         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11634
 11635     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11636         IF PI-EDAYS = ZEROS
 11637             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11638         ELSE
 11639             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11640
 11641     IF WS-MAX-DAYS-TOL NOT = ZERO
 11642        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11643           PI-CDAYS > WS-MAX-DAYS-TOL
 11644             MOVE ER-0492          TO EMI-ERROR
 11645             GO TO 1370-DAYS-ERROR.
 11646
 11647 1365-SKIP-MAX-DAYS-EDIT.
 11648     IF PI-EDAYS = ZEROS
 11649        GO TO 1400-EDIT-PAYMENT.
 11650
 11651     IF WS-DAYS-TOL NOT = ZERO
 11652        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11653           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 220
* EL156.cbl
 11654                MOVE ER-0493     TO EMI-ERROR
 11655                GO TO 1370-DAYS-ERROR.
 11656
 11657     GO TO 1400-EDIT-PAYMENT.
 11658
 11659 1370-DAYS-ERROR.
 11660     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11661
 11662     IF EMI-MESSAGE-FORMATTED
 11663         MOVE -1                 TO EDAYSL
 11664         MOVE AL-UABON           TO EDAYSA.
 11665
 11666     GO TO 1400-EDIT-PAYMENT.
 11667
 11668 1380-EDIT-EXPENSE-PMT-AMT.
 11669     IF PI-PMTTYPE = '5' OR '6'
 11670         NEXT SENTENCE
 11671     ELSE
 11672         GO TO 1400-EDIT-PAYMENT.
 11673
 11674     IF WS-MAX-EXP-PMT NOT = ZEROS
 11675        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11676            MOVE ER-3529            TO EMI-ERROR
 11677            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11678
 11679     GO TO 1500-EDIT-EXPENSES.
 11680
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 221
* EL156.cbl
 11682
 11683 1390-CHECK-PAYMENT-DAYS.
 11684
 11685     IF PI-EDAYS = 0
 11686         MOVE PI-CDAYS TO WS-PD-DAYS
 11687     ELSE
 11688         MOVE PI-EDAYS TO WS-PD-DAYS
 11689     END-IF.
 11690
 11691     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11692         IF WS-PD-DAYS = 14
 11693            GO TO 1390-EXIT
 11694         END-IF
 11695     END-IF.
 11696
 11697     IF PI-COMPANY-ID = 'AHL'  AND
 11698        CM-AH-BENEFIT-CD = '1K'
 11699         IF WS-PD-DAYS = 14
 11700            GO TO 1390-EXIT
 11701         END-IF
 11702     END-IF.
 11703
 11704     IF WS-PD-DAYS < 30
 11705         MOVE ER-3549              TO EMI-ERROR
 11706         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11707     END-IF.
 11708
 11709 1390-EXIT.
 11710      EXIT.
 11711
 11712 1400-EDIT-PAYMENT.
 11713*    IF PI-COMPANY-ID = 'DMD'
 11714*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11715*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11716
 11717     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 11718        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11719        MOVE PI-CARRIER          TO ACCT-CARRIER
 11720        MOVE PI-GROUPING         TO ACCT-GROUPING
 11721        MOVE PI-STATE            TO ACCT-STATE
 11722        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11723        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11724        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11725        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11726
 11727
 11728* EXEC CICS READ
 11729*          DATASET ('ERACCT')
 11730*          RIDFLD  (ERACCT-KEY)
 11731*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11732*          GTEQ
 11733*          resp    (WS-RESPONSE)
 11734*       END-EXEC
 11735     MOVE 'ERACCT' TO DFHEIV1
 11736*    MOVE '&"S        G          (  N#00011191' TO DFHEIV0
 11737     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11738     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11739     MOVE X'204E233030303131313931' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 222
* EL156.cbl
 11740     CALL 'kxdfhei1' USING DFHEIV0,
 11741           DFHEIV1,
 11742           DFHEIV20,
 11743           DFHEIV99,
 11744           ERACCT-KEY,
 11745           DFHEIV99,
 11746           DFHEIV99,
 11747           DFHEIV99
 11748     SET ADDRESS OF ACCOUNT-MASTER TO
 11749         DFHEIV20
 11750     MOVE EIBRESP  TO WS-RESPONSE
 11751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11752        IF WS-RESP-NORMAL
 11753           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11754           and pi-cert-eff-dt < am-expiration-dt
 11755           and pi-cert-eff-dt >= am-effective-dt
 11756           move am-dcc-product-code to pi-dcc-product-code
 11757        else
 11758           move spaces           to pi-dcc-product-code
 11759        end-if
 11760        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11761           PERFORM 0900-GET-DDF-LIMITS
 11762                                 THRU 0900-EXIT
 11763           IF PDEF-FOUND
 11764              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11765                 (P1 > +8)
 11766                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11767              END-PERFORM
 11768              IF P1 < +9
 11769                 if pd-ben-pct (p1) not numeric
 11770                    move zeros   to pd-ben-pct (p1)
 11771                 end-if
 11772                 if pd-ben-pct (p1) = zeros
 11773                    move +1      to ws-work-ben-pct
 11774                 else
 11775                    move pd-ben-pct (p1)
 11776                                 to ws-work-ben-pct
 11777                 end-if
 11778                 compute cm-ah-benefit-amt =
 11779                    cm-ah-benefit-amt * ws-work-ben-pct
 11780                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11781                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11782                 end-if
 11783              else
 11784                 move er-1674    to emi-error
 11785                 PERFORM 9900-ERROR-FORMAT
 11786                                 THRU 9900-EXIT
 11787              END-IF
 11788           else
 11789              move er-1672       to emi-error
 11790              PERFORM 9900-ERROR-FORMAT
 11791                                 THRU 9900-EXIT
 11792           END-IF
 11793        end-if
 11794     END-IF
 11795     IF PI-PMTTYPE NOT = '4'
 11796        GO TO 1405-CALC-PAYMENT.
 11797     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 223
* EL156.cbl
 11798         MOVE PI-EPYAMT           TO PI-CPYAMT
 11799         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11800         GO TO 1430-CHECK-AH-TOLERANCE.
 11801
 11802*    IF PI-COMPANY-ID = 'FIA'
 11803*       IF CERT-ACCOUNT = '0000011043'
 11804*        COMPUTE PI-DAILY-RATE ROUNDED =
 11805*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11806*        COMPUTE PI-CPYAMT ROUNDED =
 11807*                          PI-DAILY-RATE * PI-EDAYS
 11808*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11809*        GO TO 1430-CHECK-AH-TOLERANCE.
 11810
 11811     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11812         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11813         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11814         GO TO 1420-CHECK-AIG-BENEFIT.
 11815
 11816     IF WS-CALC-METHOD = '2' OR  '5'
 11817         COMPUTE PI-DAILY-RATE ROUNDED =
 11818                        (CM-AH-BENEFIT-AMT * 12) / 365
 11819         COMPUTE PI-CPYAMT ROUNDED =
 11820                           PI-DAILY-RATE * PI-EDAYS
 11821        GO TO 1420-CHECK-AIG-BENEFIT.
 11822
 11823     IF WS-CALC-METHOD = '3'
 11824         COMPUTE PI-DAILY-RATE =
 11825                         (CM-AH-BENEFIT-AMT * 12) / 365
 11826         COMPUTE PI-CPYAMT ROUNDED =
 11827                           PI-DAILY-RATE * PI-EDAYS
 11828        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 224
* EL156.cbl
 11830*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11831
 11832****************************************************************
 11833****************************************************************
 11834*                  CALCULATED FROM      PAYMENT      PAYMENT
 11835*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11836* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11837*1-01-83  1-15-83    0    15     15        15           15
 11838*1-01-83  1-30-83    0    30     30        30           30
 11839*1-01-83  1-31-83    1     0     31        30           30
 11840*1-01-83  2-01-83    1     1     32        31           31
 11841*1-01-83  2-15-83    1    15     46        45           45
 11842*1-01-83  2-28-83    2     0     59        60           60
 11843*1-01-83  3-01-83    2     1     60        61           61
 11844*1-01-83  3-31-83    3     0     90        90           90
 11845*1-15-83  1-31-83    0    17     17        17           16
 11846*1-15-83  2-01-83    0    18     18        18           17
 11847*1-15-83  2-28-83    1    14     45        44           46
 11848*1-21-83  3-09-83    1    20     48        50           49
 11849*2-05-83  3-06-83    1     2     30        32           32
 11850*2-05-83  3-23-83    1    19     47        49           49
 11851*2-15-83  2-28-83    0    14     14        14           16
 11852*2-15-83  3-01-83    0    15     15        15           17
 11853*2-21-83  3-19-83    0    27     27        27           29
 11854*2-21-83  3-20-83    1     0     28        30           30
 11855*2-21-83  4-10-83    1    18     49        30           50
 11856*2-21-83  5-19-83    2    27     88        87           89
 11857*2-21-83  5-22-83    3     2     91        92           92
 11858*3-21-83  5-19-83    1    30     60        60           59
 11859****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 225
* EL156.cbl
 11861 1405-CALC-PAYMENT.
 11862     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11863     MOVE ' '                    TO DC-OPTION-CODE.
 11864     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11865     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11866     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11867
 11868     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11869     MOVE ' '                    TO DC-OPTION-CODE.
 11870     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11871     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11872     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11873
 11874     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11875     MOVE -1                     TO DC-ELAPSED-DAYS.
 11876     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11877     MOVE '6'                    TO DC-OPTION-CODE.
 11878     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11879     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11880
 11881     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11882     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11883     MOVE '1'                    TO DC-OPTION-CODE.
 11884     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11885
 11886     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11887     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11888     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11889
 11890******************************************************************
 11891*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11892*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11893*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11894******************************************************************
 11895
 11896     IF WS-CALC-METHOD = '1'           AND
 11897        DC-ELAPSED-MONTHS > ZERO AND
 11898        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11899        WDF-DAY > WDT-DAY
 11900          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11901          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11902          MOVE -1                  TO DC-ELAPSED-MONTHS
 11903          MOVE '6'                 TO DC-OPTION-CODE
 11904          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11905          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11906          COMPUTE WS-SAVE-ODD-DAYS =
 11907          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11908          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11909
 11910     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11911     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11912     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11913
 11914     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11915     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11916
 11917*    IF PI-COMPANY-ID = 'FIA'
 11918*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 226
* EL156.cbl
 11919*        COMPUTE PI-DAILY-RATE ROUNDED =
 11920*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11921*        COMPUTE PI-CPYAMT ROUNDED =
 11922*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11923*        GO TO 1420-CHECK-AIG-BENEFIT.
 11924
 11925*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11926*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11927*          CM-AH-BENEFIT-CD = '23'               AND
 11928*          CL-CERT-STATE    = '04'               AND
 11929*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11930*            COMPUTE WS-DAILY-RATE ROUNDED =
 11931*                               CM-AH-BENEFIT-AMT / 30
 11932*            COMPUTE PI-CPYAMT ROUNDED =
 11933*                               (WS-DAILY-RATE * PI-CDAYS)
 11934*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11935*            GO TO 1420-CHECK-AIG-BENEFIT.
 11936
 11937     IF WS-CALC-METHOD = '1'
 11938         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11939         COMPUTE PI-CPYAMT ROUNDED =
 11940             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11941             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11942         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11943         GO TO 1420-CHECK-AIG-BENEFIT.
 11944
 11945     IF WS-CALC-METHOD = '2'
 11946         COMPUTE PI-DAILY-RATE ROUNDED =
 11947                          (CM-AH-BENEFIT-AMT * 12) / 365
 11948         COMPUTE PI-CPYAMT ROUNDED =
 11949             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11950             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11951         GO TO 1420-CHECK-AIG-BENEFIT.
 11952
 11953     IF WS-CALC-METHOD = '4'
 11954         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11955         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11956         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11957         COMPUTE PI-CPYAMT ROUNDED =
 11958                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11959         GO TO 1420-CHECK-AIG-BENEFIT.
 11960
 11961     IF WS-CALC-METHOD = '5'
 11962         COMPUTE PI-DAILY-RATE ROUNDED =
 11963                            (CM-AH-BENEFIT-AMT * 12) / 365
 11964         COMPUTE PI-CPYAMT ROUNDED =
 11965                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11966         GO TO 1420-CHECK-AIG-BENEFIT.
 11967
 11968     IF WS-CALC-METHOD NOT = '3'
 11969        GO TO 1410-CHECK-PAYMENT.
 11970
 11971******   CALCULATION METHOD  3  ROUTINE
 11972     COMPUTE PI-DAILY-RATE =
 11973                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11974
 11975******CHECK TO SEE IF WITHIN SAME MONTH
 11976     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 227
* EL156.cbl
 11977        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11978                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11979         GO TO 1420-CHECK-AIG-BENEFIT.
 11980
 11981******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11982     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11983             SAVE-ODD-DAYS-OVER = ZEROS
 11984      COMPUTE PI-CPYAMT  ROUNDED =
 11985                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11986      GO TO 1420-CHECK-AIG-BENEFIT.
 11987
 11988******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11989******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11990     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11991        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11992        IF WDF-MONTH > 12
 11993           ADD 1                 TO WDF-YEAR
 11994           SUBTRACT 12         FROM WDF-MONTH.
 11995
 11996******CONVERT THE NEW FROM MONTH TO BINARY
 11997     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11998        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11999        MOVE '4'              TO DC-OPTION-CODE
 12000        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12001        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12002
 12003     IF WDF-MONTH = WDT-MONTH AND
 12004        WDF-YEAR  = WDT-YEAR
 12005          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12006                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12007                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12008        ELSE
 12009          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12010          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12011          COMPUTE PI-CPYAMT ROUNDED =
 12012       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12013       +
 12014       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12015       +
 12016       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12017
 12018     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 228
* EL156.cbl
 12020 1410-CHECK-PAYMENT.
 12021******PAYMENT OPTION 6
 12022******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12023     IF SAVE-ELAPSED-MONTHS > ZERO
 12024        IF SAVE-ODD-DAYS-OVER = ZEROS
 12025           GO TO 1412-CHECK-TO-DAY
 12026        ELSE
 12027           IF WDF-DAY > WDT-DAY
 12028              IF WDF-MONTH = 02
 12029                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12030                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12031                  GO TO 1412-CHECK-TO-DAY
 12032              ELSE
 12033                  IF FROM-DAYS-IN-MONTH = 31
 12034                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12035                     GO TO 1412-CHECK-TO-DAY
 12036                  ELSE
 12037                     GO TO 1412-CHECK-TO-DAY
 12038           ELSE
 12039               GO TO 1412-CHECK-TO-DAY.
 12040
 12041     IF WDF-MONTH NOT = WDT-MONTH
 12042        IF WDF-MONTH = 02
 12043           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12044           IF WDF-DAY = 29
 12045              ADD 1              TO SAVE-ODD-DAYS-OVER
 12046           ELSE
 12047              ADD 2              TO SAVE-ODD-DAYS-OVER
 12048        ELSE
 12049           IF FROM-DAYS-IN-MONTH = 31
 12050              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12051
 12052 1412-CHECK-TO-DAY.
 12053        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12054           IF WDT-DAY = 28
 12055              ADD 2              TO SAVE-ODD-DAYS-OVER
 12056           ELSE
 12057              IF WDT-DAY = 29
 12058                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12059              ELSE
 12060                 NEXT SENTENCE
 12061        ELSE
 12062           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12063              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12064
 12065     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12066     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12067     COMPUTE PI-CPYAMT ROUNDED =
 12068         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12069         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12070
 12071     GO TO 1420-CHECK-AIG-BENEFIT.
 12072
 12073 1415-CHECK-LEAP-YEAR.
 12074     IF FROM-DAYS-IN-MONTH = 29
 12075        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12076
 12077 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 229
* EL156.cbl
 12078     EXIT.
 12079
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 230
* EL156.cbl
 12081 1420-CHECK-AIG-BENEFIT.
 12082
 12083     IF WS-SPECIAL-CALC-CD = 'Q'
 12084         GO TO 1425-CHECK-WHOLE-MONTH.
 12085
 12086*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12087*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12088*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12089*       (PI-PMTTYPE = '1' OR '2')
 12090*        NEXT SENTENCE
 12091*    ELSE
 12092         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12093         GO TO 1430-CHECK-AH-TOLERANCE.
 12094
 12095******************AIG LOGIC STARTS**********************
 12096*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12097*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12098*    MOVE ER-3533      TO EMI-ERROR.
 12099*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12100*    GO TO 1430-CHECK-AH-TOLERANCE.
 12101******************AIG LOGIC ENDS************************
 12102
 12103 1425-CHECK-WHOLE-MONTH.
 12104******************************************************************
 12105****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12106****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12107****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12108****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12109****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12110****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12111****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12112****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12113****          PAID * MONTHLY BENEFIT.                         ****
 12114******************************************************************
 12115
 12116     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12117
 12118     IF CL-NO-OF-PMTS-MADE > +0
 12119         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12120
 12121     IF PI-CDAYS < WS-BEN-DAYS
 12122         GO TO 1430-CHECK-AH-TOLERANCE.
 12123
 12124     IF PI-CDAYS = WS-BEN-DAYS
 12125         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12126         GO TO 1430-CHECK-AH-TOLERANCE.
 12127
 12128*    IF PI-COMPANY-ID = 'ACM'
 12129*       NEXT SENTENCE
 12130*    ELSE
 12131        GO TO 1425-NOT-ACM-W15C.
 12132
 12133*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12134*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12135*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12136*    MOVE '6'                    TO  DC-OPTION-CODE.
 12137*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12138*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 231
* EL156.cbl
 12139*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12140*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12141*       MOVE '1'                 TO  DC-OPTION-CODE
 12142*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12143*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12144*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12145*       IF NO-CONVERSION-ERROR
 12146*          IF (DC-ELAPSED-MONTHS > +0) OR
 12147*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12148*             NEXT SENTENCE
 12149*          ELSE
 12150*             MOVE +0            TO  PI-CPYAMT
 12151*             MOVE ER-0846       TO  EMI-ERROR
 12152*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12153*             GO TO 1430-CHECK-AH-TOLERANCE
 12154*       ELSE
 12155*           MOVE ER-0846         TO  EMI-ERROR
 12156*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12157*           GO TO 1430-CHECK-AH-TOLERANCE.
 12158*
 12159*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12160*       ADD +1 TO DC-ELAPSED-MONTHS.
 12161*
 12162*    COMPUTE PI-CPYAMT ROUNDED =
 12163*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12164*
 12165*    GO TO 1430-CHECK-AH-TOLERANCE.
 12166
 12167 1425-NOT-ACM-W15C.
 12168
 12169     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12170     MOVE '6'                        TO  DC-OPTION-CODE.
 12171     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12172     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12173
 12174     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12175     IF NO-CONVERSION-ERROR
 12176         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12177     ELSE
 12178         MOVE ER-0846                TO  EMI-ERROR
 12179         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12180         GO TO 1430-CHECK-AH-TOLERANCE.
 12181
 12182     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12183     MOVE '1'                        TO  DC-OPTION-CODE.
 12184     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12185     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12186     IF NO-CONVERSION-ERROR
 12187         IF DC-ODD-DAYS-OVER = +0
 12188             NEXT SENTENCE
 12189         ELSE
 12190             MOVE ER-0846            TO  EMI-ERROR
 12191             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12192             GO TO 1430-CHECK-AH-TOLERANCE
 12193     ELSE
 12194         MOVE ER-0846                TO  EMI-ERROR
 12195         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12196         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 232
* EL156.cbl
 12197
 12198     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12199         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12200
 12201     GO TO 1430-CHECK-AH-TOLERANCE.
 12202
 12203 1425-CONT-WHOLE-MONTH-PMTS.
 12204******************************************************************
 12205****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12206****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12207****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12208******************************************************************
 12209
 12210     IF PI-COMPANY-ID = 'ACM'
 12211        NEXT SENTENCE
 12212     ELSE
 12213        IF DC-ODD-DAYS-OVER = +0
 12214            NEXT SENTENCE
 12215        ELSE
 12216            MOVE ER-0845            TO  EMI-ERROR
 12217            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12218            GO TO 1430-CHECK-AH-TOLERANCE.
 12219
 12220     COMPUTE PI-CPYAMT ROUNDED =
 12221                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12222
 12223 1430-CHECK-AH-TOLERANCE.
 12224     IF PI-PMT-APPR-SW = 'G'
 12225         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12226
 12227*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12228*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12229*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12230*
 12231*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12232*      IF WDF-MONTH = 02
 12233*        IF SAVE-ELAPSED-MONTHS = 0
 12234*          NEXT SENTENCE
 12235*        ELSE
 12236*          IF SAVE-ODD-DAYS-OVER > 0
 12237*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12238*            COMPUTE WS-PMT-MOS ROUNDED =
 12239*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12240*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12241*                                     WS-PMT-MOS
 12242*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12243*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12244*          ELSE
 12245*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12246*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12247*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12248*                                     WS-PMT-MOS.
 12249
 12250     IF WS-MAX-PMT-TOL NOT = ZERO
 12251        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12252           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12253            MOVE ER-0494         TO  EMI-ERROR
 12254            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 233
* EL156.cbl
 12255            GO TO 1500-EDIT-EXPENSES.
 12256
 12257 1430-CONT-CHECK-AH-TOLERANCE.
 12258
 12259     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12260        GO TO 1500-EDIT-EXPENSES.
 12261
 12262     IF CM-O-B-COVERAGE
 12263        GO TO 1500-EDIT-EXPENSES.
 12264
 12265     IF PI-COMPANY-ID = 'NCL'
 12266       IF FOUND-TOL-SW = 'Y'
 12267         IF WS-PMT-TOL NOT = ZERO
 12268           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12269              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12270                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12271                  IF WS-NCL-PMT-OPTION = SPACES
 12272                      MOVE ER-0699 TO EMI-ERROR
 12273                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12274                  ELSE
 12275                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12276                      NEXT SENTENCE
 12277                  ELSE
 12278                  IF NOT WS-VALID-NCL-OPTION
 12279                      MOVE ER-0699 TO EMI-ERROR
 12280                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12281
 12282     IF WS-PMT-TOL NOT = ZERO
 12283        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12284           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12285           MOVE ER-0495          TO EMI-ERROR
 12286           PERFORM 1490-PAYMENT-ERROR
 12287                                 THRU 1490-EXIT
 12288        end-if
 12289     end-if
 12290
 12291     GO TO 1500-EDIT-EXPENSES.
 12292
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 234
* EL156.cbl
 12294 1440-COMPUTE-LIFE-REMAINING.
 12295
 12296     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12297        IF PI-PMTTYPE = '4'
 12298          MOVE PI-EPYAMT TO PI-CPYAMT
 12299          GO TO 1460-TEST-TYPE.
 12300
 12301     IF WS-LF-COVERAGE-TYPE = 'L'
 12302        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12303                          - CL-TOTAL-PAID-AMT
 12304        GO TO 1450-CHECK-MAX.
 12305
 12306     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12307        PI-LF-COVERAGE-TYPE = 'P'
 12308          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12309                              CM-LF-ITD-DEATH-AMT
 12310          GO TO 1450-CHECK-MAX.
 12311
 12312     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12313     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12314     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12315     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12316     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12317     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12318     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12319     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12320     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12321
 12322     PERFORM 9800-LINK-REM-TERM.
 12323
 12324     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12325     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12326     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12327     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12328     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12329     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12330     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12331     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12332     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12333     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12334     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12335     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12336     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12337     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12338     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12339     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12340     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 12341        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12342        MOVE PI-CARRIER          TO ACCT-CARRIER
 12343        MOVE PI-GROUPING         TO ACCT-GROUPING
 12344        MOVE PI-STATE            TO ACCT-STATE
 12345        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12346        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12347        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12348        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12349
 12350
 12351* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 235
* EL156.cbl
 12352*          DATASET ('ERACCT')
 12353*          RIDFLD  (ERACCT-KEY)
 12354*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12355*          GTEQ
 12356*          resp    (WS-RESPONSE)
 12357*       END-EXEC
 12358     MOVE 'ERACCT' TO DFHEIV1
 12359*    MOVE '&"S        G          (  N#00011796' TO DFHEIV0
 12360     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12361     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12362     MOVE X'204E233030303131373936' TO DFHEIV0(25:11)
 12363     CALL 'kxdfhei1' USING DFHEIV0,
 12364           DFHEIV1,
 12365           DFHEIV20,
 12366           DFHEIV99,
 12367           ERACCT-KEY,
 12368           DFHEIV99,
 12369           DFHEIV99,
 12370           DFHEIV99
 12371     SET ADDRESS OF ACCOUNT-MASTER TO
 12372         DFHEIV20
 12373     MOVE EIBRESP  TO WS-RESPONSE
 12374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12375        IF WS-RESP-NORMAL
 12376           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12377           and (pi-cert-eff-dt < am-expiration-dt)
 12378           and (pi-cert-eff-dt >= am-effective-dt)
 12379           move am-dcc-product-code to pi-dcc-product-code
 12380        else
 12381           move spaces           to pi-dcc-product-code
 12382        end-if
 12383        if pi-dcc-product-code not = spaces
 12384           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12385           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12386           PERFORM 0900-GET-DDF-limits
 12387                                 THRU 0900-EXIT
 12388           IF PDEF-FOUND
 12389              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12390                 (P1 > +8)
 12391                 OR (PD-PROD-CODE (P1) = 'L')
 12392              END-PERFORM
 12393              IF P1 < +9
 12394                 MOVE PD-MAX-AMT (P1)
 12395                                 TO CP-R-MAX-TOT-BEN
 12396              else
 12397                 move er-1674    to emi-error
 12398                 PERFORM 9900-ERROR-FORMAT
 12399                                 THRU 9900-EXIT
 12400              END-IF
 12401           else
 12402              move er-1672       to emi-error
 12403              PERFORM 9900-ERROR-FORMAT
 12404                                 THRU 9900-EXIT
 12405           END-IF
 12406        end-if
 12407     END-IF
 12408
 12409* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 236
* EL156.cbl
 12410*       PROGRAM  (LINK-REMAMT)
 12411*       COMMAREA (CALCULATION-PASS-AREA)
 12412*       LENGTH   (CP-COMM-LENGTH)
 12413*    END-EXEC.
 12414*    MOVE '."C                   (   #00011836' TO DFHEIV0
 12415     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12417     MOVE X'2020233030303131383336' TO DFHEIV0(25:11)
 12418     CALL 'kxdfhei1' USING DFHEIV0,
 12419           LINK-REMAMT,
 12420           CALCULATION-PASS-AREA,
 12421           CP-COMM-LENGTH,
 12422           DFHEIV99,
 12423           DFHEIV99,
 12424           DFHEIV99,
 12425           DFHEIV99
 12426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12427
 12428
 12429     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12430
 12431     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12432     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12433
 12434     IF PI-COMPANY-ID = 'BOA' AND
 12435        PI-PMTTYPE    = '2'   AND
 12436        PI-OFFLINE    = 'N'
 12437           GO TO 1441-COMPUTE-BOA-INTEREST.
 12438
 12439     IF PI-COMPANY-ID = 'NCL' AND
 12440        PI-PMTTYPE    = '2'   AND
 12441        PI-OFFLINE    = 'N'
 12442          GO TO 1442-COMPUTE-NCL-INTEREST
 12443       ELSE
 12444          GO TO 1445-CONTINUE.
 12445
 12446 1441-COMPUTE-BOA-INTEREST.
 12447     MOVE +0             TO WS-CALC-INT.
 12448
 12449     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12450     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12451     MOVE +0             TO DC-ELAPSED-MONTHS
 12452                            DC-ELAPSED-DAYS.
 12453     MOVE '1'            TO DC-OPTION-CODE.
 12454     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12455     IF NO-CONVERSION-ERROR
 12456         NEXT SENTENCE
 12457     ELSE
 12458         GO TO 1445-CONTINUE.
 12459
 12460     IF (PI-INT-RATE NOT > ZEROS)  AND
 12461        (DC-ELAPSED-DAYS > +30)
 12462         MOVE ER-3531            TO EMI-ERROR
 12463         MOVE -1                 TO PINTL
 12464         MOVE AL-UNBON           TO PINTA
 12465         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12466
 12467     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 237
* EL156.cbl
 12468         GO TO 1445-CONTINUE.
 12469
 12470     IF (PI-INT-RATE NOT > ZEROS)  OR
 12471        (DC-ELAPSED-DAYS NOT > +30)
 12472         MOVE PI-EPYAMT TO PI-CPYAMT
 12473         GO TO 1441-FORMAT-NOTE.
 12474
 12475     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12476                                 *  PI-INT-RATE
 12477                                 *  DC-ELAPSED-DAYS
 12478                                 /  365
 12479                                 /  100.
 12480
 12481     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12482
 12483 1441-FORMAT-NOTE.
 12484
 12485     MOVE SPACES        TO WS-BOANOTE1.
 12486     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12487     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12488     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12489     MOVE AL-UANON      TO NOTE1A.
 12490
 12491     IF WS-CALC-INT > ZEROS
 12492         MOVE SPACES        TO WS-BOANOTE2
 12493         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12494         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12495         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12496         MOVE AL-UANON      TO NOTE2A.
 12497
 12498     GO TO 1445-CONTINUE.
 12499
 12500 1442-COMPUTE-NCL-INTEREST.
 12501     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12502     MOVE PI-STATE               TO WS-ST-ACCESS.
 12503     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12504     MOVE '3'                    TO CNTL-REC-TYPE.
 12505     MOVE +0                     TO CNTL-SEQ-NO.
 12506     MOVE 'STAT'                 TO FILE-SWITCH.
 12507
 12508     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12509
 12510     MOVE +0                 TO WS-CALC-INT.
 12511
 12512     IF ST-STAT-FROM-INCURRED
 12513         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12514       ELSE
 12515     IF ST-STAT-FROM-REPORTED
 12516         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12517       ELSE
 12518         GO TO 1445-CONTINUE.
 12519
 12520     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12521     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12522     MOVE +0                 TO DC-ELAPSED-MONTHS
 12523                                DC-ELAPSED-DAYS.
 12524     MOVE '1'                TO DC-OPTION-CODE.
 12525     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 238
* EL156.cbl
 12526     IF NO-CONVERSION-ERROR
 12527         NEXT SENTENCE
 12528     ELSE
 12529         GO TO 1445-CONTINUE.
 12530
 12531     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12532        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12533         GO TO 1445-CONTINUE.
 12534
 12535     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12536                                 *  CF-ST-STAT-INTEREST.
 12537
 12538     MOVE SPACES              TO WS-NCLNOTE1.
 12539     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12540     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12541     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12542                                 PI-PMTNOTE1
 12543                                 NOTE1I.
 12544     MOVE AL-UANON            TO NOTE1A.
 12545
 12546     IF WS-CALC-INT > ZEROS
 12547         MOVE SPACES          TO WS-NCLNOTE2
 12548         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12549         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12550         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12551                                 PI-PMTNOTE2
 12552                                 NOTE2I
 12553         MOVE AL-UANON        TO NOTE2A.
 12554
 12555     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12556
 12557 1445-CONTINUE.
 12558
 12559     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12560        GO TO 1460-TEST-TYPE.
 12561
 12562     IF CM-O-B-COVERAGE
 12563        GO TO 1460-TEST-TYPE.
 12564
 12565     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12566         GO TO 1450-CHECK-MAX.
 12567
 12568     if (pi-company-id = 'DCC' or 'CAP')
 12569        and (pdef-found)
 12570        if pi-epyamt > pd-max-amt (p1)
 12571           move er-1657          to emi-error
 12572           perform 1490-payment-error
 12573                                 thru 1490-exit
 12574           go to 1460-test-type
 12575        end-if
 12576     else
 12577        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12578           > PI-EPYAMT)
 12579                         OR
 12580           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12581           < PI-EPYAMT)
 12582           MOVE ER-0594          TO EMI-ERROR
 12583           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 239
* EL156.cbl
 12584                                 THRU 1490-EXIT
 12585           GO TO 1460-TEST-TYPE
 12586        end-if
 12587     end-if
 12588     .
 12589 1450-CHECK-MAX.
 12590
 12591     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12592        PI-LF-COVERAGE-TYPE = 'P'
 12593         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12594                                   CM-LF-ITD-DEATH-AMT
 12595     ELSE
 12596         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12597                                   CL-TOTAL-PAID-AMT.
 12598
 12599     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12600          MOVE ER-0543           TO EMI-ERROR
 12601          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12602
 12603 1460-TEST-TYPE.
 12604
 12605     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12606        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12607           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12608                                   CM-LF-ALT-BENEFIT-AMT -
 12609                                   CL-TOTAL-PAID-AMT
 12610           IF PI-EPYAMT > WS-LF-BEN-AMT
 12611               MOVE ER-0543      TO EMI-ERROR
 12612               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12613           END-IF
 12614        END-IF
 12615     END-IF
 12616
 12617     IF PI-PMT-APPR-SW = 'G'
 12618       NEXT SENTENCE
 12619     ELSE
 12620       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12621         IF PI-EPYAMT = ZERO
 12622             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12623                 MOVE ER-0494    TO  EMI-ERROR
 12624                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12625                 GO TO 1500-EDIT-EXPENSES
 12626             ELSE
 12627                 NEXT SENTENCE
 12628         ELSE
 12629             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12630                 MOVE ER-0494    TO  EMI-ERROR
 12631                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12632                 GO TO 1500-EDIT-EXPENSES.
 12633
 12634     IF PI-PMTTYPE NOT = '2' OR
 12635        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12636         GO TO 1500-EDIT-EXPENSES.
 12637
 12638     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12639     MOVE ER-0526                TO EMI-ERROR.
 12640     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12641
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 240
* EL156.cbl
 12642     IF EMI-ERROR-NUMBER (1) = '0526'
 12643        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12644
 12645     IF EMI-ERROR-NUMBER (2) = '0526'
 12646        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12647
 12648     GO TO 1500-EDIT-EXPENSES.
 12649
 12650 1490-PAYMENT-ERROR.
 12651     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12652
 12653     IF EMI-MESSAGE-FORMATTED
 12654         MOVE -1                 TO EPYAMTL
 12655         MOVE AL-UNBON           TO EPYAMTA.
 12656
 12657 1490-EXIT.
 12658      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 241
* EL156.cbl
 12660 1500-EDIT-EXPENSES.
 12661     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12662         GO TO 1500-SKIP-ERROR-0556.
 12663
 12664 1500-CONTINUE-ON.
 12665
 12666     IF CM-O-B-COVERAGE
 12667        MOVE ER-0556             TO EMI-ERROR
 12668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12669
 12670 1500-SKIP-ERROR-0556.
 12671     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12672        IF PI-EEXPENS NOT = ZEROS
 12673           MOVE ER-0524          TO EMI-ERROR
 12674           GO TO 1590-EXPENSE-ERROR
 12675        ELSE
 12676           GO TO 1600-EDIT-RESERVES.
 12677
 12678     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12679     MOVE '6'                    TO CNTL-REC-TYPE.
 12680
 12681     IF CONTROL-IS-ACTUAL-CARRIER
 12682         MOVE PI-CARRIER         TO WS-CARR
 12683     ELSE
 12684         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12685
 12686     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12687     MOVE +0                     TO CNTL-SEQ-NO.
 12688     MOVE 'CARR'                 TO FILE-SWITCH.
 12689
 12690     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12691
 12692     IF EXPENSE-CALC-MANUAL
 12693        GO TO 1600-EDIT-RESERVES.
 12694
 12695     IF DOLLARS-PER-PMT
 12696        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12697        GO TO 1600-EDIT-RESERVES.
 12698
 12699     IF DOLLARS-PER-MONTH AND
 12700        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12701       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12702       GO TO 1600-EDIT-RESERVES.
 12703
 12704     IF PERCENT-OF-PAYMENT
 12705        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12706
 12707     GO TO 1600-EDIT-RESERVES.
 12708
 12709 1590-EXPENSE-ERROR.
 12710     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12711
 12712     IF EMI-MESSAGE-FORMATTED
 12713        MOVE -1                  TO EEXPENSL
 12714        MOVE AL-UNBON            TO EEXPENSA.
 12715
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 242
* EL156.cbl
 12717 1600-EDIT-RESERVES.
 12718     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12719        IF PI-ERESV = ZEROS
 12720           GO TO 1700-EDIT-EXPENSE-TYPE
 12721        ELSE
 12722           MOVE ER-0525          TO EMI-ERROR
 12723           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12724           GO TO 1700-EDIT-EXPENSE-TYPE.
 12725
 12726     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12727     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12728     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12729
 12730     IF NOT AT-MANUAL-RESERVES-USED
 12731        IF PI-ERESV NOT = ZEROS
 12732           MOVE ER-0518          TO EMI-ERROR
 12733           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12734
 12735     IF AT-MANUAL-RESERVES-USED
 12736        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12737        GO TO 1700-EDIT-EXPENSE-TYPE.
 12738
 12739     IF AT-FUTURE-RESERVES-USED
 12740        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12741
 12742     IF AT-FUTURE-RESERVES-USED
 12743        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12744
 12745     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12746        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12747
 12748     IF AT-IBNR-RESERVES-USED
 12749        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12750
 12751     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12752     GO TO 1700-EDIT-EXPENSE-TYPE.
 12753
 12754 1690-RESERVE-ERROR.
 12755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12756
 12757     IF EMI-MESSAGE-FORMATTED
 12758        MOVE AL-UNBON            TO ERESVA
 12759        MOVE -1                  TO ERESVL.
 12760
 12761 1690-EXIT.
 12762      EXIT.
 12763
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 243
* EL156.cbl
 12765 1700-EDIT-EXPENSE-TYPE.
 12766     IF PI-PMTTYPE NOT = '5' AND '6'
 12767        GO TO 2000-EDIT-DONE.
 12768
 12769     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12770                   '6' OR '7' OR '8' OR '9'
 12771        GO TO 2000-EDIT-DONE.
 12772
 12773 1705-EXPENSE-ERROR.
 12774     MOVE ER-0573                TO EMI-ERROR.
 12775     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12776
 12777     IF EMI-MESSAGE-FORMATTED
 12778        MOVE AL-UABON            TO ETYPEA
 12779        MOVE -1                  TO ETYPEL.
 12780
 12781     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 244
* EL156.cbl
 12783 1950-NOT-FOUND.
 12784     IF FILE-SWITCH = 'MSTR'
 12785        MOVE ER-0204             TO EMI-ERROR.
 12786
 12787     IF FILE-SWITCH = 'CARR'
 12788        MOVE ER-0252             TO EMI-ERROR.
 12789
 12790     IF FILE-SWITCH = 'COMP'
 12791        MOVE ER-0254             TO EMI-ERROR.
 12792
 12793     IF FILE-SWITCH = 'STAT'
 12794        MOVE ER-0149             TO EMI-ERROR.
 12795
 12796     IF FILE-SWITCH = 'PROC'
 12797        MOVE ER-0019             TO EMI-ERROR.
 12798
 12799     IF FILE-SWITCH = 'ACCT'
 12800        MOVE ER-0198             TO EMI-ERROR.
 12801
 12802     IF FILE-SWITCH = 'BENE'
 12803        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12804           MOVE ER-0282          TO EMI-ERROR
 12805        ELSE
 12806           MOVE ER-0283          TO EMI-ERROR.
 12807
 12808     MOVE -1                     TO PMTTYPEL.
 12809     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12810
 12811     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12812                                     WS-FORCE-CTR.
 12813
 12814     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12815                                     WS-FATAL-CTR.
 12816
 12817     GO TO 8200-SEND-DATAONLY.
 12818
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 245
* EL156.cbl
 12820 2000-EDIT-DONE.
 12821     perform 2210-dcc-max-benes thru 2210-exit
 12822     if pi-company-id not = 'DCC' and 'CAP'
 12823        IF (WS-SPECIAL-CALC-CD = 'C')
 12824           and (cl-critical-period > 0)
 12825           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12826              IF PI-EPYAMT > ZEROS
 12827                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12828                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12829              ELSE
 12830                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12831                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12832              END-IF
 12833              if ws-benefits-paid > cl-critical-period
 12834                 MOVE ER-0657          TO EMI-ERROR
 12835                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12836              END-IF
 12837           END-IF
 12838        END-IF
 12839     end-if
 12840     IF PI-HOLDTIL NOT = ZEROS
 12841        MOVE PI-HOLDTIL          TO HOLDTILO
 12842        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12843
 12844     IF PI-EPYFROM NOT = ZEROS
 12845        MOVE PI-EPYFROM          TO EPYFROMO
 12846        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12847
 12848     IF PI-EPYTHRU NOT = ZEROS
 12849        MOVE PI-EPYTHRU            TO EPYTHRUO
 12850        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12851        IF PI-USES-PAID-TO
 12852           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12853           MOVE '4'                TO DC-OPTION-CODE
 12854           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12855           IF NO-CONVERSION-ERROR
 12856              MOVE +1              TO DC-ELAPSED-DAYS
 12857              MOVE +0              TO DC-ELAPSED-MONTHS
 12858              MOVE '6'             TO DC-OPTION-CODE
 12859              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12860              IF NO-CONVERSION-ERROR
 12861                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12862
 12863     MOVE PI-EDAYS               TO EDAYSO.
 12864
 12865     IF PI-AIGFROM NOT = ZEROS
 12866        MOVE PI-AIGFROM          TO AIGFROMO
 12867        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12868
 12869     MOVE PI-EPYAMT              TO EPYAMTO.
 12870     MOVE PI-ERESV               TO ERESVO.
 12871     MOVE PI-EEXPENS             TO EEXPENSO.
 12872
 12873     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12874     MOVE SPACES                 TO DC-OPTION-CODE.
 12875     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12876
 12877     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 246
* EL156.cbl
 12878        MOVE SPACES              TO CPYFROMI
 12879     ELSE
 12880        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12881        IF PI-EPYFROM = ZEROS
 12882           MOVE AL-UANON             TO EPYFROMA
 12883           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12884           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12885
 12886     IF PI-USES-PAID-TO
 12887        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12888        MOVE +1                            TO DC-ELAPSED-DAYS
 12889        MOVE +0                            TO DC-ELAPSED-MONTHS
 12890        MOVE '6'                           TO DC-OPTION-CODE
 12891        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12892        IF NO-CONVERSION-ERROR
 12893           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12894           IF PI-EPYTHRU = ZEROS
 12895              MOVE AL-UANON                TO EPYTHRUA
 12896              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12897              MOVE ' '                     TO DC-OPTION-CODE
 12898              MOVE +0                      TO DC-ELAPSED-DAYS
 12899                                              DC-ELAPSED-MONTHS
 12900              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12901              IF NO-CONVERSION-ERROR
 12902                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12903                  GO TO 2001-CONTINUE
 12904              ELSE
 12905                  GO TO 2001-CONTINUE
 12906           ELSE
 12907              GO TO 2001-CONTINUE.
 12908
 12909     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12910     MOVE SPACES                 TO DC-OPTION-CODE.
 12911     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12912
 12913     IF DATE-CONVERSION-ERROR
 12914        MOVE SPACES              TO CPYTHRUI
 12915     ELSE
 12916        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12917        IF PI-EPYTHRU = ZEROS
 12918           MOVE AL-UANON TO EPYTHRUA
 12919           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12920           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12921
 12922 2001-CONTINUE.
 12923
 12924     MOVE PI-CDAYS               TO CDAYSO.
 12925
 12926     IF PI-EDAYS = ZEROS
 12927        MOVE AL-UNNON TO EDAYSA
 12928        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12929
 12930     MOVE PI-CPYAMT              TO CPYAMTO.
 12931
 12932     IF PI-EPYAMT = ZEROS
 12933        MOVE AL-UNNON            TO EPYAMTA
 12934        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12935
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 247
* EL156.cbl
 12936     MOVE PI-CRESV               TO CRESVO.
 12937     MOVE PI-CEXPENS             TO CEXPENSO.
 12938
 12939     IF PI-EEXPENS = ZEROS
 12940        MOVE AL-UNNON TO EEXPENSA
 12941        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12942
 12943     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12944        AND (CL-CLAIM-TYPE = 'L')
 12945        AND (PI-OFFLINE NOT EQUAL 'Y')
 12946        IF PI-PMTTYPE = '2' OR '4'
 12947           PERFORM 2200-CALC-INTEREST
 12948                                 THRU 2200-EXIT
 12949        END-IF
 12950     END-IF
 12951     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12952     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12953     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12954
 12955     IF EMI-FATAL-CTR = ZEROS
 12956        MOVE 'B'                 TO PI-PASS-SW.
 12957
 12958     IF NOT EMI-MESSAGE-FORMATTED
 12959         MOVE -1                 TO EPYFROML
 12960     ELSE
 12961         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12962            EMI-ERROR-NUMBER (2) = SPACES
 12963             MOVE -1             TO EPYFROML.
 12964
 12965     GO TO 8200-SEND-DATAONLY.
 12966
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 248
* EL156.cbl
 12968 2200-CALC-INTEREST.
 12969     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12970        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12971        MOVE '4'                 TO DC-OPTION-CODE
 12972        PERFORM 9700-LINK-DATE-CONVERT
 12973        IF DATE-CONVERSION-ERROR
 12974            MOVE LOW-VALUES      TO CP-PRF-DT
 12975        ELSE
 12976           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12977        END-IF
 12978     END-IF
 12979     if (pi-int-to-rem-borr <> 'Y' and 'N')
 12980        if pi-rb-joint-coverage
 12981           move 'Y'              to pi-int-to-rem-borr
 12982        end-if
 12983     end-if
 12984     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12985        IN CLAIM-INT-PASS-AREA
 12986     MOVE CL-CERT-STATE          TO CP-STATE
 12987        IN CLAIM-INT-PASS-AREA
 12988     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12989     MOVE 'LF'                   TO CP-COVERAGE
 12990     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12991     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12992     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12993     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12994     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12995     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12996
 12997* EXEC CICS LINK
 12998*       PROGRAM   ('ELCLMI')
 12999*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13000*       LENGTH    (CP-CLAIM-LENGTH)
 13001*    END-EXEC
 13002     MOVE 'ELCLMI' TO DFHEIV1
 13003*    MOVE '."C                   (   #00012409' TO DFHEIV0
 13004     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13006     MOVE X'2020233030303132343039' TO DFHEIV0(25:11)
 13007     CALL 'kxdfhei1' USING DFHEIV0,
 13008           DFHEIV1,
 13009           CLAIM-INT-PASS-AREA,
 13010           CP-CLAIM-LENGTH,
 13011           DFHEIV99,
 13012           DFHEIV99,
 13013           DFHEIV99,
 13014           DFHEIV99
 13015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13016     MOVE AL-PANOF               TO PINTHA
 13017                                    PINTA
 13018     if cp-clm-int-amt = zeros
 13019        move ' ' to pi-int-to-rem-borr
 13020     end-if
 13021     IF NO-CI-ERROR
 13022        MOVE CP-CLM-INT-AMT      TO PINTO
 13023                                    PI-INT-AMT
 13024        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13025        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 249
* EL156.cbl
 13026        MOVE AL-PANOF            TO PINTHA
 13027                                    PINTA
 13028        if pi-rb-joint-coverage
 13029           and pi-int-amt > zeros
 13030           move '  INT TO'       to itrb1o
 13031           move ' REM BORR?'     to itrb2o
 13032           move pi-int-to-rem-borr
 13033                                 to itrbyno
 13034           move al-uanon         to itrbyna
 13035           move +1               to itrbynl
 13036        else
 13037           move ' '              to pi-int-to-rem-borr
 13038        end-if
 13039     ELSE
 13040        IF CI-RETURN-CODE = '8'
 13041           MOVE ER-3818          TO EMI-ERROR
 13042           MOVE -1               TO ZINTL
 13043           PERFORM 9900-ERROR-FORMAT
 13044                                 THRU 9900-EXIT
 13045           GO TO 2200-EXIT
 13046        ELSE
 13047           MOVE ZEROS            TO PINTO
 13048                                    PI-INT-AMT
 13049                                    PI-INT-DAYS
 13050                                    PI-INT-RATE-USED
 13051        END-IF
 13052     END-IF
 13053     IF PI-INT-AMT NOT = ZEROS
 13054        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13055           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13056           CONTINUE
 13057        ELSE
 13058           MOVE CL-SOC-SEC-NO (1:3)
 13059                                 TO WS-SSN (1:3)
 13060           MOVE CL-SOC-SEC-NO (5:2)
 13061                                 TO WS-SSN (4:2)
 13062           MOVE CL-SOC-SEC-NO (8:4)
 13063                                 TO WS-SSN (6:4)
 13064           IF (WS-SSN NUMERIC)
 13065              AND (WS-SSN NOT = ZEROS)
 13066              CONTINUE
 13067           ELSE
 13068              MOVE ER-2044       TO EMI-ERROR
 13069              PERFORM 9900-ERROR-FORMAT
 13070                                 THRU 9900-EXIT
 13071           END-IF
 13072        END-IF
 13073        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13074        if pi-int-to-rem-borr = 'Y'
 13075           move +61              to trlr-seq-no
 13076        else
 13077           MOVE +51              TO TRLR-SEQ-NO
 13078        end-if
 13079
 13080* EXEC CICS READ
 13081*          DATASET  ('ELTRLR')
 13082*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13083*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 250
* EL156.cbl
 13084*          RESP     (WS-RESPONSE)
 13085*       END-EXEC
 13086     MOVE 'ELTRLR' TO DFHEIV1
 13087*    MOVE '&"S        E          (  N#00012477' TO DFHEIV0
 13088     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13090     MOVE X'204E233030303132343737' TO DFHEIV0(25:11)
 13091     CALL 'kxdfhei1' USING DFHEIV0,
 13092           DFHEIV1,
 13093           DFHEIV20,
 13094           DFHEIV99,
 13095           ELTRLR-KEY,
 13096           DFHEIV99,
 13097           DFHEIV99,
 13098           DFHEIV99
 13099     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13100         DFHEIV20
 13101     MOVE EIBRESP  TO WS-RESPONSE
 13102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13103        IF (NOT WS-RESP-NORMAL)
 13104                    OR
 13105           ((WS-RESP-NORMAL)
 13106           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13107           OR (AT-CITY-STATE = SPACES)))
 13108           MOVE ER-0874          TO EMI-ERROR
 13109           if pi-rb-joint-coverage
 13110              move -1            to itrbynl
 13111           end-if
 13112           PERFORM 9900-ERROR-FORMAT
 13113                                 THRU 9900-EXIT
 13114        else
 13115           move at-mail-to-name  to pi-int-payees-name
 13116        END-IF
 13117     END-IF
 13118     .
 13119 2200-EXIT.
 13120     EXIT.
 13121 2210-dcc-max-benes.
 13122
 13123     move pi-ah-term             to ws-max-bens
 13124     if cl-critical-period not = zeros and spaces
 13125        move cl-critical-period  to ws-max-bens
 13126     end-if
 13127     move cm-ah-benefit-amt      to ws-monthly-benefit
 13128     if pdef-found
 13129        and (pd-max-amt (p1) not = zeros)
 13130        if pd-ben-pct (p1) not numeric
 13131           move zeros            to pd-ben-pct (p1)
 13132        end-if
 13133        if pd-ben-pct (p1) = zeros
 13134           move +1               to ws-work-ben-pct
 13135        else
 13136           move pd-ben-pct (p1)  to ws-work-ben-pct
 13137        end-if
 13138*       compute ws-monthly-benefit =
 13139*          ws-monthly-benefit * ws-work-ben-pct
 13140*       if ws-monthly-benefit > pd-max-amt (p1)
 13141*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 251
* EL156.cbl
 13142*       end-if
 13143     end-if
 13144
 13145     move cl-cert-key-data       to elcrtt-key (2:21)
 13146     move cl-company-cd          to ctrlr-comp-cd
 13147     move cl-cert-no             to ctrlr-cert-no
 13148     move 'B'                    to ctrlr-rec-type
 13149
 13150
 13151* EXEC CICS READ
 13152*       DATASET  ('ELCRTT')
 13153*       set      (address of CERTIFICATE-TRAILERS)
 13154*       RIDFLD   (ELCRTT-KEY)
 13155*       RESP     (WS-RESPONSE)
 13156*    END-EXEC
 13157     MOVE 'ELCRTT' TO DFHEIV1
 13158*    MOVE '&"S        E          (  N#00012530' TO DFHEIV0
 13159     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13160     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13161     MOVE X'204E233030303132353330' TO DFHEIV0(25:11)
 13162     CALL 'kxdfhei1' USING DFHEIV0,
 13163           DFHEIV1,
 13164           DFHEIV20,
 13165           DFHEIV99,
 13166           ELCRTT-KEY,
 13167           DFHEIV99,
 13168           DFHEIV99,
 13169           DFHEIV99
 13170     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13171         DFHEIV20
 13172     MOVE EIBRESP  TO WS-RESPONSE
 13173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13174     IF not WS-RESP-NORMAL
 13175        go to 2210-exit
 13176     end-if
 13177
 13178*    if instypei = 'P'
 13179*       move +1 to s1
 13180*    else
 13181*       MOVE +2 to s1
 13182*    end-if
 13183
 13184*    move +1 to s1
 13185*    evaluate cl-claim-type
 13186*       when 'A'
 13187*          move +1 to s2
 13188*       when 'I'
 13189*          move +2 to s2
 13190*       when 'G'
 13191*          move +3 to s2
 13192*       when 'L'
 13193*          move +4 to s2
 13194*       when 'P'
 13195*          move +5 to s2
 13196*    end-evaluate
 13197
 13198     move zeros                  to ws-prev-days-paid
 13199                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 252
* EL156.cbl
 13200                                    ws-prev-amt-paid
 13201     perform varying s1 from +1 by +1 until
 13202        (s1 > +24)
 13203        or (cs-claim-type (s1) = spaces)
 13204        if pi-company-id not = 'DCC' and 'CAP'
 13205           if cs-claim-type (s1) = cl-claim-type
 13206              compute ws-prev-days-paid =
 13207                 ws-prev-days-paid + cs-days-paid (s1)
 13208              compute ws-prev-amt-paid =
 13209                 ws-prev-amt-paid + cs-total-paid (s1)
 13210           end-if
 13211        else
 13212           if (cs-claim-type (s1) = cl-claim-type)
 13213              and (cs-benefit-period (s1) = cl-benefit-period)
 13214              and (cs-insured-type (s1) = cl-insured-type)
 13215              compute ws-prev-days-paid =
 13216                 ws-prev-days-paid + cs-days-paid (s1)
 13217              compute ws-prev-amt-paid =
 13218                 ws-prev-amt-paid + cs-total-paid (s1)
 13219           end-if
 13220        end-if
 13221     end-perform
 13222     if pi-epyamt > zeros
 13223        compute ws-benefits-paid =
 13224           (ws-prev-amt-paid + pi-epyamt)
 13225           / ws-monthly-benefit
 13226     else
 13227        compute ws-benefits-paid =
 13228           (ws-prev-amt-paid + pi-cpyamt)
 13229           / ws-monthly-benefit
 13230     end-if
 13231*    if pi-company-id = 'DCC'
 13232     if cl-claim-type not = 'L' and 'P'
 13233        if ws-benefits-paid > ws-max-bens
 13234           move er-1658          to emi-error
 13235           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13236        end-if
 13237     end-if
 13238*    end-if
 13239*     if s1 < +25
 13240*        if pi-epyamt > zeros
 13241*           compute ws-benefits-paid =
 13242*              (cs-total-paid (s1) + PI-EPYAMT)
 13243*              / ws-monthly-benefit
 13244*        else
 13245*           compute ws-benefits-paid =
 13246*              (cs-total-paid (s1) + PI-CPYAMT)
 13247*              / ws-monthly-benefit
 13248*        end-if
 13249
 13250*       if ws-benefits-paid > pd-crit-period (p1)
 13251*        if ws-benefits-paid > ws-max-bens
 13252*           move er-1658          to emi-error
 13253*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13254*        end-if
 13255*     end-if
 13256     .
 13257 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 253
* EL156.cbl
 13258     exit.
 13259
 13260 2220-update-elcrtt.
 13261
 13262
 13263* EXEC CICS GETMAIN
 13264*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13265*       LENGTH   (ELCRTT-LENGTH)
 13266*       INITIMG  (GETMAIN-SPACE)
 13267*    END-EXEC
 13268*    MOVE ',"IL                  $   #00012624' TO DFHEIV0
 13269     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13270     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13271     MOVE X'2020233030303132363234' TO DFHEIV0(25:11)
 13272     CALL 'kxdfhei1' USING DFHEIV0,
 13273           DFHEIV20,
 13274           ELCRTT-LENGTH,
 13275           GETMAIN-SPACE
 13276     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13277         DFHEIV20
 13278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13279
 13280     move cl-cert-key-data       to elcrtt-key (2:21)
 13281     move cl-company-cd          to ctrlr-comp-cd
 13282     move cl-cert-no             to ctrlr-cert-no
 13283     move 'B'                    to ctrlr-rec-type
 13284
 13285
 13286* EXEC CICS READ
 13287*       UPDATE
 13288*       DATASET  (ELCRTT-DSID)
 13289*       into     (CERTIFICATE-TRAILERS)
 13290*       RIDFLD   (ELCRTT-KEY)
 13291*       RESP     (WS-RESPONSE)
 13292*    END-EXEC
 13293     MOVE LENGTH OF
 13294      CERTIFICATE-TRAILERS
 13295       TO DFHEIV11
 13296*    MOVE '&"IL       EU         (  N#00012635' TO DFHEIV0
 13297     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13298     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13299     MOVE X'204E233030303132363335' TO DFHEIV0(25:11)
 13300     CALL 'kxdfhei1' USING DFHEIV0,
 13301           ELCRTT-DSID,
 13302           CERTIFICATE-TRAILERS,
 13303           DFHEIV11,
 13304           ELCRTT-KEY,
 13305           DFHEIV99,
 13306           DFHEIV99,
 13307           DFHEIV99
 13308     MOVE EIBRESP  TO WS-RESPONSE
 13309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13310
 13311     IF WS-RESP-NORMAL
 13312        perform 2225-upd-crt-trlr thru 2225-exit
 13313
 13314* EXEC CICS REWRITE
 13315*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 254
* EL156.cbl
 13316*          from     (CERTIFICATE-TRAILERS)
 13317*          RESP     (WS-RESPONSE)
 13318*       END-EXEC
 13319     MOVE LENGTH OF
 13320      CERTIFICATE-TRAILERS
 13321       TO DFHEIV11
 13322*    MOVE '&& L                  %  N#00012645' TO DFHEIV0
 13323     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13324     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13325     MOVE X'204E233030303132363435' TO DFHEIV0(25:11)
 13326     CALL 'kxdfhei1' USING DFHEIV0,
 13327           ELCRTT-DSID,
 13328           CERTIFICATE-TRAILERS,
 13329           DFHEIV11,
 13330           DFHEIV99
 13331     MOVE EIBRESP  TO WS-RESPONSE
 13332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13333     else
 13334        if ws-resp-notfnd
 13335           move 'CS'             to certificate-trailers
 13336           move cl-company-cd    to cs-company-cd
 13337           move cl-cert-key-data to cs-control-primary (2:21)
 13338           move cl-cert-no       to cs-cert-no
 13339           move 'B'              to cs-trailer-type
 13340           perform varying s1 from +1 by +1 until s1 > +24
 13341              move zeros         to cs-benefit-period (s1)
 13342                                    cs-days-paid (s1)
 13343                                    cs-total-paid (s1)
 13344                                    cs-remaining-bens (s1)
 13345           end-perform
 13346           perform 2225-upd-crt-trlr
 13347                                 thru 2225-exit
 13348
 13349* EXEC CICS WRITE
 13350*             DATASET  (ELCRTT-DSID)
 13351*             from     (CERTIFICATE-TRAILERS)
 13352*             RIDFLD   (cs-control-primary)
 13353*             RESP     (WS-RESPONSE)
 13354*          END-EXEC
 13355     MOVE LENGTH OF
 13356      CERTIFICATE-TRAILERS
 13357       TO DFHEIV11
 13358*    MOVE '&$ L                  ''  N#00012665' TO DFHEIV0
 13359     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13360     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13361     MOVE X'204E233030303132363635' TO DFHEIV0(25:11)
 13362     CALL 'kxdfhei1' USING DFHEIV0,
 13363           ELCRTT-DSID,
 13364           CERTIFICATE-TRAILERS,
 13365           DFHEIV11,
 13366           cs-control-primary,
 13367           DFHEIV99,
 13368           DFHEIV99
 13369     MOVE EIBRESP  TO WS-RESPONSE
 13370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13371        end-if
 13372     END-IF
 13373
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 255
* EL156.cbl
 13374     .
 13375 2220-exit.
 13376     exit.
 13377
 13378 2225-upd-crt-trlr.
 13379
 13380*    if instypei = 'P'
 13381*       move +1 to s1
 13382*    else
 13383*       MOVE +2 to s1
 13384*    end-if
 13385
 13386*    move +1 to s1
 13387*    evaluate cl-claim-type
 13388*       when 'A'
 13389*          move +1 to s2
 13390*       when 'I'
 13391*          move +2 to s2
 13392*       when 'G'
 13393*          move +3 to s2
 13394*       when 'L'
 13395*          move +4 to s2
 13396*       when 'P'
 13397*          move +5 to s2
 13398*    end-evaluate
 13399     perform varying s1 from +1 by +1 until
 13400        (s1 > +24)
 13401        or (cl-claim-no = cs-claim-no (s1))
 13402     end-perform
 13403     if s1 < +25
 13404        compute cs-total-paid (s1) =
 13405           cs-total-paid (s1) + at-amount-paid
 13406        compute cs-days-paid (s1) =
 13407           cs-days-paid (s1) +  at-days-in-period
 13408*       compute cs-remaining-bens (s1) =
 13409*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13410        perform 2230-accum-bens-paid thru 2230-exit
 13411     end-if
 13412
 13413     .
 13414 2225-exit.
 13415     exit.
 13416 2230-accum-bens-paid.
 13417     if cl-claim-type not = 'L' and 'P'
 13418        move pi-ah-term          to ws-max-bens
 13419        if cl-critical-period not = zeros and spaces
 13420           move cl-critical-period
 13421                                 to ws-max-bens
 13422        end-if
 13423     else
 13424        move 01                  to ws-max-bens
 13425     end-if
 13426     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13427     perform varying s2 from +1 by +1 until
 13428        (s2 > +24)
 13429        or (cs-claim-no (s2) = spaces)
 13430        if pi-company-id not = 'DCC' and 'CAP'
 13431           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 256
* EL156.cbl
 13432              compute ws-tot-days-paid =
 13433                 ws-tot-days-paid + cs-days-paid (s2)
 13434              compute ws-tot-amt-paid =
 13435                 ws-tot-amt-paid + cs-total-paid (s2)
 13436           end-if
 13437        else
 13438           if (cs-benefit-period (s2) = cl-benefit-period)
 13439              and (cs-claim-type (s2) = cl-claim-type)
 13440              and (cs-insured-type (s2) = cl-insured-type)
 13441              compute ws-tot-days-paid =
 13442                 ws-tot-days-paid + cs-days-paid (s2)
 13443              compute ws-tot-amt-paid =
 13444                 ws-tot-amt-paid + cs-total-paid (s2)
 13445           end-if
 13446        end-if
 13447     end-perform
 13448     if cl-claim-type = 'L' and 'P'
 13449        if ws-tot-amt-paid > zeros
 13450           move zeros            to cs-remaining-bens (s1)
 13451        else
 13452           move 01               to cs-remaining-bens (s1)
 13453        end-if
 13454     else
 13455        compute ws-pd-bens rounded =
 13456           ws-tot-amt-paid / pi-ah-benefit-amt
 13457        compute cs-remaining-bens (s1) =
 13458           ws-max-bens - ws-pd-bens
 13459        if cs-remaining-bens (s1) < zeros
 13460           move zeros            to cs-remaining-bens (s1)
 13461        end-if
 13462     end-if
 13463     .
 13464 2230-exit.
 13465     exit.
 13466 3000-MOVE-INPUT-TO-SAVE-AREA.
 13467     IF PMTTYPEL > 0
 13468         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13469
 13470     if ws-pmttype = '4'
 13471        if pi-rb-joint-coverage
 13472           if payeel = +0
 13473              move +2            to payeel
 13474              move al-uanon      to payeea
 13475              move 'Q1'          to payeeo
 13476           else
 13477              if payeei not = 'Q1' and 'q1'
 13478                 move er-1582    to emi-error
 13479                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13480              end-if
 13481           end-if
 13482        end-if
 13483     end-if
 13484     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13485
 13486     IF WS-PMTTYPE = '9'
 13487         MOVE 'P'                TO PI-PROVISIONAL-IND
 13488         MOVE '1'                TO WS-PMTTYPE.
 13489
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 257
* EL156.cbl
 13490     IF PAYEEL > 0
 13491         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13492         MOVE PAYEEI             TO WS-PAYEE.
 13493
 13494     IF NOTE1L > +0
 13495         MOVE NOTE1I             TO WS-PMTNOTE1
 13496                                    WS-FLI-PMTNOTE
 13497                                    WS-HAN-PMTNOTE.
 13498
 13499     IF NOTE2L > +0
 13500         MOVE NOTE2I             TO WS-PMTNOTE2.
 13501
 13502     IF OFFLINEL > 0
 13503         MOVE OFFLINEI           TO WS-OFFLINE.
 13504
 13505     IF PROOFDTL > 0
 13506         MOVE PROOFDTI            TO DATE-WORK
 13507         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13508         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13509         MOVE '4'                 TO DC-OPTION-CODE
 13510         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13511         IF NO-CONVERSION-ERROR
 13512            MOVE NUM-WORK         TO PROOFDTO
 13513            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13514            MOVE NUM-WORK         TO WS-PROOF-DATE
 13515         ELSE
 13516            MOVE ZEROS            TO WS-PROOF-DATE
 13517         END-IF
 13518     END-IF.
 13519
 13520     IF EOBYNL > +0
 13521         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13522         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13523     END-IF
 13524
 13525     IF CLMFMYNL > +0
 13526         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13527         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13528     END-IF
 13529
 13530     IF SURVYYNL > +0
 13531         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13532         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13533     END-IF
 13534
 13535     IF SPRELYNL > +0
 13536         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13537         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13538     END-IF
 13539     if itrbynl <> +0
 13540        move function upper-case(itrbyni) to itrbyni
 13541        move itrbyni             to ws-int-to-rem-borr
 13542     end-if
 13543*    IF GROUPEDL > +0
 13544*        MOVE GROUPEDI           TO WS-GROUPED.
 13545*
 13546*    IF CASHL > +0
 13547*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 258
* EL156.cbl
 13548     IF LOANNOL > +0
 13549         MOVE LOANNOI            TO WS-LOAN-NO.
 13550
 13551     IF CHECKNOL > 0
 13552         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13553
 13554     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13555         IF WS-AIG-CREDIT-ENTERED
 13556             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13557             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13558             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13559             MOVE AL-UANON         TO CHECKNOA.
 13560
 13561     IF HOLDTILL > 0
 13562         MOVE HOLDTILI           TO DATE-WORK
 13563         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13564         MOVE NUM-WORK           TO WS-HOLDTIL.
 13565
 13566     IF ZINTL > +0
 13567
 13568* EXEC CICS BIF DEEDIT
 13569*           FIELD   (ZINTI)
 13570*           LENGTH  (07)
 13571*       END-EXEC
 13572     MOVE 07
 13573       TO DFHEIV11
 13574*    MOVE '@"L                   #   #00012867' TO DFHEIV0
 13575     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13576     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13577     MOVE X'2020233030303132383637' TO DFHEIV0(25:11)
 13578     CALL 'kxdfhei1' USING DFHEIV0,
 13579           ZINTI,
 13580           DFHEIV11
 13581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13582        IF ZINTI NOT NUMERIC
 13583           MOVE ER-0419          TO EMI-ERROR
 13584           PERFORM 9900-ERROR-FORMAT
 13585           MOVE AL-UABON         TO ZINTA
 13586           MOVE -1               TO ZINTL
 13587        ELSE
 13588           MOVE ZINTI            TO CP-INT-RATE
 13589                                    WS-INT-RATE
 13590           MOVE CP-INT-RATE      TO ZINTO
 13591           MOVE AL-UNNON         TO ZINTA
 13592        END-IF
 13593     ELSE
 13594        MOVE ZEROS               TO CP-INT-RATE
 13595     END-IF
 13596     IF EPYFROML > 0
 13597         MOVE EPYFROMI           TO DATE-WORK
 13598         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13599         MOVE NUM-WORK           TO WS-EPYFROM.
 13600
 13601     IF AIGFROML > 0
 13602         MOVE AIGFROMI           TO DATE-WORK
 13603         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13604         MOVE NUM-WORK           TO WS-AIGFROM
 13605     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 259
* EL156.cbl
 13606         IF (AIGFROMI = LOW-VALUES) AND
 13607            (PI-AIGFROM NOT = ZEROS)
 13608              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13609
 13610     IF EPYTHRUL > +0
 13611        MOVE EPYTHRUI           TO DATE-WORK
 13612        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13613        MOVE NUM-WORK           TO WS-EPYTHRU
 13614        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13615        MOVE '4'                TO DC-OPTION-CODE
 13616        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13617        IF NO-CONVERSION-ERROR
 13618           IF PI-USES-PAID-TO
 13619              MOVE '6'                TO DC-OPTION-CODE
 13620              MOVE -1                 TO DC-ELAPSED-DAYS
 13621              MOVE +0                 TO DC-ELAPSED-MONTHS
 13622              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13623              IF NO-CONVERSION-ERROR
 13624                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13625                 MOVE ' '             TO DC-OPTION-CODE
 13626                 MOVE +0              TO DC-ELAPSED-DAYS
 13627                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13628              IF NO-CONVERSION-ERROR
 13629                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13630
 13631*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13632*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13633     IF EDAYSL > 0
 13634
 13635* EXEC CICS BIF DEEDIT
 13636*            FIELD(EDAYSI)
 13637*            LENGTH(6)
 13638*        END-EXEC
 13639     MOVE 6
 13640       TO DFHEIV11
 13641*    MOVE '@"L                   #   #00012923' TO DFHEIV0
 13642     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13643     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13644     MOVE X'2020233030303132393233' TO DFHEIV0(25:11)
 13645     CALL 'kxdfhei1' USING DFHEIV0,
 13646           EDAYSI,
 13647           DFHEIV11
 13648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13649         MOVE EDAYSI             TO WS-DY-WORK
 13650         IF WS-DY-SIGN = SPACES
 13651            MOVE WS-DY-NUM       TO WS-EDAYS
 13652            ADD 0                TO WS-EDAYS
 13653         ELSE
 13654            MOVE EDAYSI          TO WS-EDAYS
 13655            ADD 0                TO WS-EDAYS.
 13656
 13657*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13658*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13659     IF EPYAMTL > 0
 13660
 13661* EXEC CICS BIF DEEDIT
 13662*            FIELD(EPYAMTI)
 13663*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 260
* EL156.cbl
 13664*        END-EXEC
 13665     MOVE 10
 13666       TO DFHEIV11
 13667*    MOVE '@"L                   #   #00012938' TO DFHEIV0
 13668     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13669     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13670     MOVE X'2020233030303132393338' TO DFHEIV0(25:11)
 13671     CALL 'kxdfhei1' USING DFHEIV0,
 13672           EPYAMTI,
 13673           DFHEIV11
 13674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13675         MOVE EPYAMTI            TO WS-PY-WORK
 13676         IF WS-PY-SIGN = SPACES
 13677            MOVE WS-PY-NUM       TO WS-EPYAMT
 13678            ADD 0                TO WS-EPYAMT
 13679         ELSE
 13680            MOVE EPYAMTI         TO WS-EPYAMT
 13681            ADD 0                TO WS-EPYAMT.
 13682
 13683     IF ERESVL > 0
 13684
 13685* EXEC CICS BIF DEEDIT
 13686*            FIELD(ERESVI)
 13687*            LENGTH(9)
 13688*        END-EXEC
 13689     MOVE 9
 13690       TO DFHEIV11
 13691*    MOVE '@"L                   #   #00012951' TO DFHEIV0
 13692     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13693     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13694     MOVE X'2020233030303132393531' TO DFHEIV0(25:11)
 13695     CALL 'kxdfhei1' USING DFHEIV0,
 13696           ERESVI,
 13697           DFHEIV11
 13698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13699         MOVE ERESVI TO WS-ERESV.
 13700
 13701     IF EEXPENSL > 0
 13702
 13703* EXEC CICS BIF DEEDIT
 13704*            FIELD(EEXPENSI)
 13705*            LENGTH(8)
 13706*        END-EXEC
 13707     MOVE 8
 13708       TO DFHEIV11
 13709*    MOVE '@"L                   #   #00012958' TO DFHEIV0
 13710     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13711     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13712     MOVE X'2020233030303132393538' TO DFHEIV0(25:11)
 13713     CALL 'kxdfhei1' USING DFHEIV0,
 13714           EEXPENSI,
 13715           DFHEIV11
 13716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13717         MOVE EEXPENSI           TO WS-EEXPENS.
 13718
 13719     IF ETYPEL > ZEROS
 13720         MOVE ETYPEI             TO WS-ETYPE.
 13721
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 261
* EL156.cbl
 13722     IF PI-COMPANY-ID = 'BOA'
 13723        IF PINTL > ZEROS
 13724
 13725* EXEC CICS BIF DEEDIT
 13726*            FIELD (PINTI)
 13727*            LENGTH(05)
 13728*          END-EXEC
 13729     MOVE 05
 13730       TO DFHEIV11
 13731*    MOVE '@"L                   #   #00012969' TO DFHEIV0
 13732     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13733     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13734     MOVE X'2020233030303132393639' TO DFHEIV0(25:11)
 13735     CALL 'kxdfhei1' USING DFHEIV0,
 13736           PINTI,
 13737           DFHEIV11
 13738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13739           IF PINTI NUMERIC
 13740               MOVE AL-UNNON     TO PINTA
 13741               MOVE PINTI        TO WS-INT-RATE
 13742               MOVE WS-INT-RATE  TO PINTO.
 13743
 13744 3000-EXIT.
 13745     EXIT.
 13746
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 262
* EL156.cbl
 13748 3050-REBUILD-ENTERED.
 13749
 13750     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13751
 13752     IF PI-PROV-PMT
 13753         MOVE '9'           TO PMTTYPEO
 13754     ELSE
 13755         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13756
 13757     MOVE PI-PAYEE          TO PAYEEO.
 13758     MOVE PI-PMTNOTE1       TO NOTE1O.
 13759     MOVE PI-PMTNOTE2       TO NOTE2O.
 13760     MOVE PI-OFFLINE        TO OFFLINEO.
 13761     IF PI-PROOF-DATE NOT = ZEROS
 13762         MOVE PI-PROOF-DATE TO PROOFDTO
 13763         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13764     END-IF.
 13765*    MOVE PI-GROUPED        TO GROUPEDO.
 13766
 13767*    MOVE PI-CASH           TO CASHO.
 13768
 13769     IF PI-INT-RATE > ZEROS
 13770        MOVE PI-INT-RATE         TO PINTO
 13771     end-if
 13772     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13773        IF PI-INT-AMT > ZEROS
 13774           MOVE PI-INT-AMT       TO PINTO
 13775           MOVE AL-PANOF         TO PINTA
 13776                                    PINTHA
 13777           if pi-rb-joint-coverage
 13778              move '  INT TO'    to itrb1o
 13779              move ' REM BORR?'  to itrb2o
 13780              move 'Y'           to itrbyno
 13781              move al-uanon      to itrbyna
 13782              move +1            to itrbynl
 13783           end-if
 13784        END-IF
 13785     END-IF
 13786     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13787     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13788     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13789     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13790     IF PI-HOLDTIL NOT = ZEROS
 13791        MOVE PI-HOLDTIL          TO HOLDTILO
 13792        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13793
 13794     IF PI-EPYFROM NOT = ZEROS
 13795        MOVE PI-EPYFROM          TO EPYFROMO
 13796        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13797
 13798     IF PI-AIGFROM NOT = ZEROS
 13799        MOVE PI-AIGFROM          TO AIGFROMO
 13800        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13801
 13802     IF PI-EPYTHRU NOT = ZEROS
 13803        MOVE PI-EPYTHRU          TO EPYTHRUO
 13804        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13805        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 263
* EL156.cbl
 13806           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13807           MOVE '4'                TO DC-OPTION-CODE
 13808           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13809           IF NO-CONVERSION-ERROR
 13810              MOVE +1 TO DC-ELAPSED-DAYS
 13811              MOVE +0 TO DC-ELAPSED-MONTHS
 13812              MOVE '6' TO DC-OPTION-CODE
 13813              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13814              IF NO-CONVERSION-ERROR
 13815                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13816
 13817     IF PI-EDAYS NOT = ZEROS
 13818        MOVE PI-EDAYS TO EDAYSO.
 13819
 13820     IF PI-EPYAMT NOT = ZEROS
 13821        MOVE PI-EPYAMT TO EPYAMTO.
 13822
 13823     IF PI-ERESV NOT = ZEROS
 13824        MOVE PI-ERESV TO ERESVO.
 13825
 13826     IF PI-EEXPENS NOT = ZEROS
 13827        MOVE PI-EEXPENS TO EEXPENSO.
 13828
 13829     MOVE PI-ETYPE TO ETYPEO.
 13830
 13831     IF PI-ECHECKNO NOT = SPACES
 13832        MOVE PI-ECHECKNO         TO CHECKNOO
 13833     ELSE
 13834        MOVE PI-CCHECKNO         TO CHECKNOO.
 13835
 13836     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13837     MOVE SPACES                 TO DC-OPTION-CODE.
 13838     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13839
 13840     IF DATE-CONVERSION-ERROR
 13841        MOVE SPACES              TO CPYFROMI
 13842     ELSE
 13843        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13844
 13845     IF PI-USES-PAID-TO
 13846        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13847        MOVE +1                  TO DC-ELAPSED-DAYS
 13848        MOVE +0                  TO DC-ELAPSED-MONTHS
 13849        MOVE '6'                 TO DC-OPTION-CODE
 13850        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13851        IF NO-CONVERSION-ERROR
 13852           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13853           GO TO 3051-CONTINUE.
 13854
 13855     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13856     MOVE SPACES                 TO DC-OPTION-CODE.
 13857     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13858
 13859     IF DATE-CONVERSION-ERROR
 13860        MOVE SPACES              TO CPYTHRUI
 13861     ELSE
 13862        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13863
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 264
* EL156.cbl
 13864 3051-CONTINUE.
 13865
 13866     IF PI-CDAYS NOT = ZEROS
 13867        MOVE PI-CDAYS TO CDAYSO.
 13868
 13869     IF PI-CPYAMT NOT = ZEROS
 13870        MOVE PI-CPYAMT TO CPYAMTO.
 13871
 13872     IF PI-CRESV NOT = ZEROS
 13873        MOVE PI-CRESV TO CRESVO.
 13874
 13875     IF PI-CEXPENS NOT = ZEROS
 13876        MOVE PI-CEXPENS TO CEXPENSO.
 13877
 13878 3059-EXIT.
 13879     EXIT.
 13880
 13881 3100-DEEDIT-DATE.
 13882
 13883* EXEC CICS BIF DEEDIT
 13884*        FIELD(DATE-WORK)
 13885*        LENGTH(8)
 13886*    END-EXEC.
 13887     MOVE 8
 13888       TO DFHEIV11
 13889*    MOVE '@"L                   #   #00013116' TO DFHEIV0
 13890     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13891     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13892     MOVE X'2020233030303133313136' TO DFHEIV0(25:11)
 13893     CALL 'kxdfhei1' USING DFHEIV0,
 13894           DATE-WORK,
 13895           DFHEIV11
 13896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13897
 13898
 13899 3100-EXIT.
 13900     EXIT.
 13901
 13902 3200-CALC-AIG-DAYS.
 13903
 13904     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13905
 13906     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13907     MOVE ' '                    TO DC-OPTION-CODE.
 13908     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13909     IF NO-CONVERSION-ERROR
 13910         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13911     ELSE
 13912         GO TO 3290-ERROR.
 13913
 13914     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13915         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13916                                WS-BIN-FROM-DT
 13917     ELSE
 13918         IF CL-TOTAL-PAID-AMT > ZEROS
 13919             IF WS-SV-EPYFROM = LOW-VALUES
 13920                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13921                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 265
* EL156.cbl
 13922             ELSE
 13923                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13924                                        WS-BIN-FROM-DT
 13925         ELSE
 13926             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13927                                        WS-BIN-FROM-DT.
 13928
 13929 3210-CONTINUE.
 13930
 13931     MOVE ' '                    TO DC-OPTION-CODE.
 13932     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13933     IF DATE-CONVERSION-ERROR
 13934         GO TO 3290-ERROR.
 13935
 13936     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13937
 13938     IF PI-LOAN-DUE-DAY = 31
 13939         MOVE 30              TO WS-PMT-DUE-DA
 13940                                 WS-SAVE-DUE-DA
 13941     ELSE
 13942         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13943                                 WS-SAVE-DUE-DA.
 13944
 13945     IF (PI-LOAN-DUE-DAY > 28) AND
 13946        (WS-PMT-DUE-MO = 2)
 13947         MOVE 'Y'                TO WS-DUE-DAY-SW
 13948         MOVE 28                 TO WS-PMT-DUE-DA.
 13949
 13950     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13951     MOVE '4'                    TO DC-OPTION-CODE.
 13952     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13953     IF NO-CONVERSION-ERROR
 13954         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13955     ELSE
 13956         GO TO 3290-ERROR.
 13957
 13958*--------------------------------------------------------------*
 13959*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13960*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13961*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13962*                                                              *
 13963*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13964*             INCURRED DATE      - 04/15/91                    *
 13965*             PMT DUE DATE       - 04/03/91                    *
 13966*             PMT DUE DATE       - 05/03/91                    *
 13967*--------------------------------------------------------------*
 13968
 13969     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13970        (WS-SV-AIGFROM = LOW-VALUES)
 13971         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13972            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13973             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13974             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13975             IF NO-CONVERSION-ERROR
 13976                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13977                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13978             ELSE
 13979                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 266
* EL156.cbl
 13980
 13981     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13982        (WS-SV-AIGFROM = LOW-VALUES)
 13983         GO TO 3205-CONT-CALC-PMT.
 13984
 13985     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13986     MOVE ' '                    TO DC-OPTION-CODE.
 13987     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13988     IF NO-CONVERSION-ERROR
 13989         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13990     ELSE
 13991         GO TO 3290-ERROR.
 13992
 13993     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13994        (WS-PMT-DUE-DA < WS-FROM-DA)
 13995          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13996          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13997          IF NO-CONVERSION-ERROR
 13998              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13999              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14000          ELSE
 14001              GO TO 3290-ERROR.
 14002
 14003 3205-CONT-CALC-PMT.
 14004
 14005*--------------------------------------------------------------*
 14006*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14007*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14008*--------------------------------------------------------------*
 14009
 14010     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14011        PI-PMTTYPE = '2'
 14012          NEXT SENTENCE
 14013     ELSE
 14014        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14015           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14016             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14017             MOVE ER-3527            TO EMI-ERROR
 14018             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14019             MOVE -1                 TO EPYTHRUL
 14020             MOVE AL-UNBON           TO EPYTHRUA
 14021                                        EPYFROMA
 14022             GO TO 3299-EXIT.
 14023
 14024*--------------------------------------------------------------*
 14025*    CALCULATE RETRO ELIMINATION DATE                          *
 14026*--------------------------------------------------------------*
 14027
 14028     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14029         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14030     ELSE
 14031         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14032
 14033     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14034     MOVE +0             TO DC-ELAPSED-MONTHS.
 14035     MOVE '6'            TO DC-OPTION-CODE.
 14036     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14037     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 267
* EL156.cbl
 14038         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14039     ELSE
 14040         GO TO 3290-ERROR.
 14041
 14042 3210-CHECK-PMT-DATE.
 14043
 14044*--------------------------------------------------------------*
 14045*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14046*    THE ENTERED PAY FROM DATE                                 *
 14047*--------------------------------------------------------------*
 14048
 14049     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14050         NEXT SENTENCE
 14051     ELSE
 14052         GO TO 3220-COMPUTE-DAYS.
 14053
 14054     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14055     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14056     IF NO-CONVERSION-ERROR
 14057         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14058         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14059         GO TO 3210-CHECK-PMT-DATE
 14060     ELSE
 14061         GO TO 3290-ERROR.
 14062
 14063 3220-COMPUTE-DAYS.
 14064
 14065     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14066     MOVE ZEROS         TO WS-CDAYS.
 14067     MOVE 'N'           TO WS-ELIMINATION-SW.
 14068
 14069*--------------------------------------------------------------*
 14070*    COMPUTE CALIFORNIA DUE DAYS                               *
 14071*--------------------------------------------------------------*
 14072
 14073     IF CL-TOTAL-PAID-AMT > ZEROS
 14074         MOVE 'Y' TO WS-ELIMINATION-SW
 14075         GO TO 3240-FIRST-PMT-DUE
 14076     ELSE
 14077        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14078            NEXT SENTENCE
 14079        ELSE
 14080            GO TO 3240-FIRST-PMT-DUE.
 14081
 14082 3230-NEXT-PMT-DUE.
 14083
 14084     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14085     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14086     IF NO-CONVERSION-ERROR
 14087         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14088         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14089     ELSE
 14090         GO TO 3290-ERROR.
 14091
 14092 3240-FIRST-PMT-DUE.
 14093
 14094     IF CL-TOTAL-PAID-AMT > ZEROS
 14095         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 268
* EL156.cbl
 14096     ELSE
 14097        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14098            GO TO 3230-NEXT-PMT-DUE.
 14099
 14100     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14101         GO TO 3250-VERIFY-ELIMINATION.
 14102
 14103     ADD +30 TO WS-CDAYS.
 14104     MOVE 'Y' TO WS-ELIMINATION-SW.
 14105     GO TO 3230-NEXT-PMT-DUE.
 14106
 14107 3250-VERIFY-ELIMINATION.
 14108
 14109     IF ELIM-SATISFIED
 14110         GO TO 3260-END-CALC.
 14111
 14112     IF PI-PMTTYPE = '1'
 14113         MOVE ZEROS TO WS-CDAYS
 14114         GO TO 3260-END-CALC.
 14115
 14116     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14117         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14118     ELSE
 14119         IF CL-TOTAL-PAID-AMT > ZEROS
 14120             IF WS-SV-EPYFROM = LOW-VALUES
 14121                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14122             ELSE
 14123                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14124         ELSE
 14125             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14126
 14127     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14128     MOVE '1'                    TO DC-OPTION-CODE.
 14129     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14130     IF NO-CONVERSION-ERROR
 14131         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14132     ELSE
 14133         GO TO 3290-ERROR.
 14134
 14135     IF CL-TOTAL-PAID-AMT > ZEROS
 14136         MOVE WS-DAYS-OFF TO WS-CDAYS
 14137     ELSE
 14138         IF PI-BEN-DAYS > WS-DAYS-OFF
 14139             MOVE ZEROS TO WS-CDAYS
 14140         ELSE
 14141             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14142
 14143 3260-END-CALC.
 14144
 14145     MOVE WS-CDAYS TO PI-CDAYS.
 14146
 14147     IF PI-EDAYS = ZEROS
 14148         MOVE PI-CDAYS TO PI-EDAYS
 14149         MOVE AL-UNNON TO EDAYSA.
 14150
 14151     GO TO 3299-EXIT.
 14152
 14153 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 269
* EL156.cbl
 14154
 14155     MOVE ER-3528            TO EMI-ERROR.
 14156     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14157     MOVE -1                 TO CDAYSL.
 14158     MOVE AL-UNBON           TO CDAYSA.
 14159
 14160 3299-EXIT.
 14161     EXIT.
 14162
 14163 3300-BUMP-DATE.
 14164
 14165     IF WS-RESTORE-DUE-DAY
 14166         MOVE 'N'              TO WS-DUE-DAY-SW
 14167         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14168         ADD 1                 TO WS-PMT-DUE-MO
 14169         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14170         MOVE '4'              TO DC-OPTION-CODE
 14171         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14172         IF NO-CONVERSION-ERROR
 14173             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14174             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14175             GO TO 3399-EXIT
 14176         ELSE
 14177             MOVE '9'          TO DC-ERROR-CODE
 14178             GO TO 3399-EXIT.
 14179
 14180     IF (WS-PMT-DUE-MO = 1) AND
 14181        (WS-SAVE-DUE-DA > 28)
 14182           MOVE 'Y' TO WS-DUE-DAY-SW.
 14183
 14184     MOVE +0                 TO DC-ELAPSED-DAYS.
 14185     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14186     MOVE '6'                TO DC-OPTION-CODE.
 14187     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14188
 14189 3399-EXIT.
 14190     EXIT.
 14191
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 270
* EL156.cbl
 14193 3400-COMPUTE-EXPIRY.
 14194
 14195     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14196     MOVE +0                    TO DC-ELAPSED-DAYS
 14197                                   DC-ODD-DAYS-OVER.
 14198     MOVE '1'                   TO DC-END-OF-MONTH.
 14199     MOVE '6'                   TO DC-OPTION-CODE.
 14200
 14201     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14202         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14203     ELSE
 14204         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14205
 14206     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14207     IF NO-CONVERSION-ERROR
 14208         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14209     ELSE
 14210         GO TO 3390-CONTINUE.
 14211
 14212     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14213         GO TO 3390-CONTINUE.
 14214
 14215     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14216     MOVE '4'                    TO CNTL-REC-TYPE.
 14217     MOVE +0                     TO CNTL-SEQ-NO.
 14218     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14219     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14220     MOVE 'BENE'                 TO FILE-SWITCH.
 14221
 14222     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14223
 14224     IF NO-BENEFIT-FOUND
 14225         GO TO 3390-CONTINUE.
 14226
 14227     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 14228        IF (PI-OFFLINE = 'Y') OR
 14229           (PI-PMTTYPE = '7')
 14230           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14231                                     THRU 9870-EXIT
 14232           IF ERROR-ON-OUTPUT
 14233             MOVE -1                 TO ENTERPFL
 14234             MOVE AL-UANON           TO ENTERPFA
 14235             MOVE MAP-NAMEA          TO MAP-NAME
 14236             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14237             GO TO 8200-SEND-DATAONLY.
 14238
 14239     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14240        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14241        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14242          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14243          MOVE +0        TO DC-ELAPSED-DAYS
 14244          MOVE +1        TO DC-ELAPSED-MONTHS
 14245          MOVE 6         TO DC-OPTION-CODE
 14246          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14247          IF NO-CONVERSION-ERROR
 14248              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14249
 14250 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 271
* EL156.cbl
 14251
 14252      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14253         MOVE CM-AH-LOAN-EXPIRE-DT
 14254                                 TO DC-BIN-DATE-1
 14255      ELSE
 14256         MOVE CM-LF-LOAN-EXPIRE-DT
 14257                                 TO DC-BIN-DATE-1
 14258      END-IF
 14259
 14260      MOVE ' '                    TO DC-OPTION-CODE.
 14261      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14262      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14263      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14264
 14265 3499-EXIT.
 14266     EXIT.
 14267
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 272
* EL156.cbl
 14269
 14270 3600-CHECK-VERIFICATION.
 14271
 14272     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14273
 14274     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14275
 14276     IF PI-PAYEE-TYPE = 'I'
 14277        GO TO 3600-READ-TRAILER.
 14278
 14279     IF PI-PAYEE-TYPE = 'B'
 14280        ADD +10                  TO TRLR-SEQ-NO
 14281        GO TO 3600-READ-TRAILER.
 14282
 14283     IF PI-PAYEE-TYPE = 'A'
 14284        ADD +20                  TO TRLR-SEQ-NO
 14285        GO TO 3600-READ-TRAILER.
 14286
 14287     IF PI-PAYEE-TYPE = 'O'
 14288        ADD +50                  TO TRLR-SEQ-NO
 14289        GO TO 3600-READ-TRAILER.
 14290
 14291     IF PI-PAYEE-TYPE = 'Q'
 14292        ADD +60                  TO TRLR-SEQ-NO
 14293        GO TO 3600-READ-TRAILER.
 14294
 14295     IF PI-PAYEE-TYPE = 'P'
 14296        ADD +30                  TO TRLR-SEQ-NO
 14297        GO TO 3600-READ-TRAILER.
 14298
 14299     IF PI-PAYEE-TYPE = 'E'
 14300        ADD +40                  TO TRLR-SEQ-NO.
 14301
 14302 3600-READ-TRAILER.
 14303
 14304
 14305* EXEC CICS HANDLE CONDITION
 14306*         NOTFND(3600-CONTINUE)
 14307*    END-EXEC.
 14308*    MOVE '"$I                   ! - #00013526' TO DFHEIV0
 14309     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14311     MOVE X'2D20233030303133353236' TO DFHEIV0(25:11)
 14312     CALL 'kxdfhei1' USING DFHEIV0
 14313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14314
 14315
 14316     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14317
 14318 3600-CONTINUE.
 14319
 14320     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14321         GO TO 3600-AH-VERIFY
 14322     END-IF.
 14323
 14324     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14325       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14326         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 273
* EL156.cbl
 14327           MOVE ER-7576            TO EMI-ERROR
 14328           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14329           MOVE -1                 TO PAYEEL
 14330           MOVE AL-UABON           TO PAYEEA
 14331           GO TO 3600-EXIT
 14332         END-IF
 14333       END-IF
 14334     END-IF.
 14335
 14336     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14337     MOVE 1 TO WS-SUB2
 14338     MOVE SPACES TO WS-PAYEE-NAME
 14339     PERFORM VARYING WS-SUB FROM 1 BY 1
 14340             UNTIL WS-SUB > 30
 14341         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14342            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14343                 WS-PAYEE-NAME-X (WS-SUB2)
 14344            ADD +1 TO WS-SUB2
 14345         END-IF
 14346     END-PERFORM.
 14347
 14348     STRING CL-INSURED-1ST-NAME
 14349            CL-INSURED-MID-INIT
 14350            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14351     MOVE 1 TO WS-SUB2
 14352     MOVE SPACES TO WS-INSURED-NAME
 14353     PERFORM VARYING WS-SUB FROM 1 BY 1
 14354             UNTIL WS-SUB > 30
 14355         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14356            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14357                 WS-INSURED-NAME-X (WS-SUB2)
 14358            ADD +1 TO WS-SUB2
 14359         END-IF
 14360     END-PERFORM.
 14361
 14362     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14363        MOVE ER-7579            TO EMI-ERROR
 14364        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14365        MOVE -1                 TO PAYEEL
 14366        MOVE AL-UABON           TO PAYEEA
 14367     END-IF.
 14368
 14369     IF PI-PMTTYPE = '4'  AND
 14370        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14371        PI-PAYEE-TYPE <> 'I'
 14372          MOVE ER-7580          TO EMI-ERROR
 14373          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14374          MOVE -1               TO PAYEEL
 14375          MOVE AL-UABON         TO PAYEEA
 14376     END-IF.
 14377
 14378     GO TO 3600-EXIT.
 14379
 14380 3600-AH-VERIFY.
 14381
 14382     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14383        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14384           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 274
* EL156.cbl
 14385           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14386           MOVE -1                 TO PAYEEL
 14387           MOVE AL-UABON           TO PAYEEA
 14388        END-IF
 14389     END-IF.
 14390
 14391
 14392 3600-EXIT.
 14393     EXIT.
 14394
 14395 5000-UPDATE.
 14396
 14397     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14398
 14399     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14400
 14401     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14402        PI-OFFLINE = 'Y'
 14403        NEXT SENTENCE
 14404     ELSE
 14405        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14406
 14407*    IF PI-COMPANY-ID = 'CRI'
 14408*       IF PI-PMTTYPE = '1' OR  '2'
 14409*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14410*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14411*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14412
 14413*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14414*       IF PI-PMTTYPE = '1'
 14415*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14416*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14417
 14418     IF PI-PMTTYPE      = '2' AND
 14419        PI-SPLIT-PMT-SW = 'Y' AND
 14420        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14421          MOVE ER-3530                TO EMI-ERROR
 14422          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14423
 14424     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14425        AND (CL-CLAIM-TYPE = 'L')
 14426        IF PI-PMTTYPE = '2' OR '4'
 14427           IF PI-INT-AMT NOT = ZEROS
 14428              PERFORM 7110-BUILD-PMT-TRLR
 14429                                 THRU 7130-EXIT
 14430           ELSE
 14431              IF PI-PMTTYPE = '2'
 14432                 PERFORM 7140-BUILD-NOTE-TRLR
 14433                                 THRU 7170-EXIT
 14434              END-IF
 14435           END-IF
 14436        END-IF
 14437     END-IF
 14438*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14439*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14440*            MOVE 'N'                 TO  WS-LETTER-SW.
 14441
 14442*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 275
* EL156.cbl
 14443*        IF CL-NO-OF-PMTS-MADE = +1
 14444*                OR
 14445*           PI-PMTTYPE = '2'
 14446*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14447
 14448     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14449
 14450*    IF PI-COMPANY-ID = 'DMD'
 14451*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14452*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14453
 14454
 14455* EXEC CICS REWRITE
 14456*         DATASET('ELMSTR')
 14457*         FROM(CLAIM-MASTER)
 14458*     END-EXEC.
 14459     MOVE LENGTH OF
 14460      CLAIM-MASTER
 14461       TO DFHEIV11
 14462     MOVE 'ELMSTR' TO DFHEIV1
 14463*    MOVE '&& L                  %   #00013668' TO DFHEIV0
 14464     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14465     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14466     MOVE X'2020233030303133363638' TO DFHEIV0(25:11)
 14467     CALL 'kxdfhei1' USING DFHEIV0,
 14468           DFHEIV1,
 14469           CLAIM-MASTER,
 14470           DFHEIV11,
 14471           DFHEIV99
 14472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14473
 14474
 14475     IF WS-LETTER-SW = 'N'
 14476         GO TO 5000-END-UPDATE.
 14477
 14478 5000-GENERATE-AUTO-LETTER.
 14479
 14480
 14481* EXEC CICS LINK
 14482*        PROGRAM    (LINK-1523)
 14483*        COMMAREA   (W-1523-LINKDATA)
 14484*        LENGTH     (W-1523-COMM-LENGTH)
 14485*    END-EXEC.
 14486*    MOVE '."C                   (   #00013678' TO DFHEIV0
 14487     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14488     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14489     MOVE X'2020233030303133363738' TO DFHEIV0(25:11)
 14490     CALL 'kxdfhei1' USING DFHEIV0,
 14491           LINK-1523,
 14492           W-1523-LINKDATA,
 14493           W-1523-COMM-LENGTH,
 14494           DFHEIV99,
 14495           DFHEIV99,
 14496           DFHEIV99,
 14497           DFHEIV99
 14498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14499
 14500
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 276
* EL156.cbl
 14501     IF W-1523-FATAL-ERROR
 14502         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14504         MOVE ER-0802                TO  EMI-ERROR
 14505         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14506
 14507     IF W-1523-ERROR-CODE = 0191
 14508         MOVE ER-0803                TO  EMI-ERROR
 14509         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14510
 14511     IF PI-COMPANY-ID      = 'HAN' AND
 14512        PI-PMTTYPE         = '1'   AND
 14513        PI-3RD-PARTY-SW    = 'Y'   AND
 14514        W-1523-FORM-NUMBER = 'EOB1'
 14515           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14516           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14517           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14518           GO TO 5000-GENERATE-AUTO-LETTER.
 14519
 14520 5000-END-UPDATE.
 14521
 14522     MOVE ER-0000                TO EMI-ERROR.
 14523     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14524     GO TO 7000-SHOW-CLAIM.
 14525
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 277
* EL156.cbl
 14527 5000-MOVE-NAME.
 14528     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14529     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14530     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14531
 14532 5000-EXIT.
 14533     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 278
* EL156.cbl
 14535 5300-CREATE-DMO.
 14536
 14537     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14538     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14539     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14540
 14541
 14542* EXEC CICS HANDLE CONDITION
 14543*         NOTFND   (5300-NOTE-NOT-FOUND)
 14544*    END-EXEC.
 14545*    MOVE '"$I                   ! . #00013724' TO DFHEIV0
 14546     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14548     MOVE X'2E20233030303133373234' TO DFHEIV0(25:11)
 14549     CALL 'kxdfhei1' USING DFHEIV0
 14550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14551
 14552
 14553
 14554* EXEC CICS READ
 14555*         DATASET('ERNOTE')
 14556*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14557*         RIDFLD (W-NOTE-KEY)
 14558*    END-EXEC.
 14559     MOVE 'ERNOTE' TO DFHEIV1
 14560*    MOVE '&"S        E          (   #00013728' TO DFHEIV0
 14561     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14563     MOVE X'2020233030303133373238' TO DFHEIV0(25:11)
 14564     CALL 'kxdfhei1' USING DFHEIV0,
 14565           DFHEIV1,
 14566           DFHEIV20,
 14567           DFHEIV99,
 14568           W-NOTE-KEY,
 14569           DFHEIV99,
 14570           DFHEIV99,
 14571           DFHEIV99
 14572     SET ADDRESS OF CERTIFICATE-NOTE TO
 14573         DFHEIV20
 14574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14575
 14576
 14577     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14578     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14579     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14580
 14581     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14582         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14583     ELSE
 14584         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14585
 14586     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14587     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14588     MOVE 'DLO006'               TO PGM-NAME.
 14589
 14590
 14591* EXEC CICS LINK
 14592*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 279
* EL156.cbl
 14593*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14594*        LENGTH     (DCT-RCRD-LENGTH)
 14595*    END-EXEC.
 14596*    MOVE '."C                   (   #00013747' TO DFHEIV0
 14597     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14599     MOVE X'2020233030303133373437' TO DFHEIV0(25:11)
 14600     CALL 'kxdfhei1' USING DFHEIV0,
 14601           PGM-NAME,
 14602           DCT-COMMUNICATION-AREA,
 14603           DCT-RCRD-LENGTH,
 14604           DFHEIV99,
 14605           DFHEIV99,
 14606           DFHEIV99,
 14607           DFHEIV99
 14608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14609
 14610
 14611     IF DCT-RETURN-CODE = 'OK'
 14612         GO TO 5300-CONT.
 14613
 14614     IF DCT-RETURN-CODE = '01' OR '02'
 14615         GO TO 5300-EXIT.
 14616
 14617     IF DCT-RETURN-CODE = '03'
 14618         MOVE ER-0951            TO EMI-ERROR
 14619         GO TO 5300-BAD-EXIT.
 14620
 14621     IF DCT-RETURN-CODE = '04'
 14622         MOVE ER-0946            TO EMI-ERROR
 14623         GO TO 5300-BAD-EXIT.
 14624
 14625     IF DCT-RETURN-CODE = '05'
 14626         MOVE ER-0947            TO EMI-ERROR
 14627         GO TO 5300-BAD-EXIT.
 14628
 14629     IF DCT-RETURN-CODE = '06'
 14630         MOVE ER-0921            TO EMI-ERROR
 14631         GO TO 5300-BAD-EXIT.
 14632
 14633     IF DCT-RETURN-CODE = '07'
 14634         MOVE ER-0849            TO EMI-ERROR
 14635         GO TO 5300-BAD-EXIT.
 14636
 14637     IF DCT-RETURN-CODE = '08'
 14638         MOVE ER-0948            TO EMI-ERROR
 14639         GO TO 5300-BAD-EXIT.
 14640
 14641     IF DCT-RETURN-CODE = 'N1'
 14642         MOVE ER-0950            TO EMI-ERROR
 14643         GO TO 5300-BAD-EXIT.
 14644
 14645     IF DCT-RETURN-CODE = 'E1'
 14646         MOVE ER-0974            TO EMI-ERROR
 14647         GO TO 5300-BAD-EXIT.
 14648
 14649     IF DCT-RETURN-CODE = 'E2'
 14650         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 280
* EL156.cbl
 14651         GO TO 5300-BAD-EXIT.
 14652
 14653     IF DCT-RETURN-CODE NOT = 'OK'
 14654         MOVE ER-0949            TO EMI-ERROR
 14655         GO TO 5300-BAD-EXIT.
 14656
 14657 5300-CONT.
 14658
 14659     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14660     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14661     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14662     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14663     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14664     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14665     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14666     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14667
 14668     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14669     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14670     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14671     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14672     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14673
 14674     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14675
 14676     IF PI-PMTTYPE = '2'
 14677         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14678         MOVE '4'                TO DM-CLAIM-STATUS
 14679     ELSE
 14680         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14681         MOVE '2'                TO DM-CLAIM-STATUS.
 14682
 14683     MOVE 'DLO025'               TO PGM-NAME.
 14684
 14685
 14686* EXEC CICS LINK
 14687*        PROGRAM    (PGM-NAME)
 14688*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14689*        LENGTH     (DM-DMO-LENGTH)
 14690*    END-EXEC.
 14691*    MOVE '."C                   (   #00013827' TO DFHEIV0
 14692     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14694     MOVE X'2020233030303133383237' TO DFHEIV0(25:11)
 14695     CALL 'kxdfhei1' USING DFHEIV0,
 14696           PGM-NAME,
 14697           DMO-COMMUNICATION-AREA,
 14698           DM-DMO-LENGTH,
 14699           DFHEIV99,
 14700           DFHEIV99,
 14701           DFHEIV99,
 14702           DFHEIV99
 14703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14704
 14705
 14706     IF DM-RETURN-CODE = 'OK'
 14707         GO TO 5300-EXIT.
 14708
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 281
* EL156.cbl
 14709     IF DM-RETURN-CODE = '01'
 14710         MOVE ER-8051            TO EMI-ERROR
 14711         GO TO 5300-BAD-EXIT.
 14712
 14713     IF DM-RETURN-CODE = '02'
 14714         MOVE ER-8052            TO EMI-ERROR
 14715         GO TO 5300-BAD-EXIT.
 14716
 14717     IF DM-RETURN-CODE = '03'
 14718         MOVE ER-8053            TO EMI-ERROR
 14719         GO TO 5300-BAD-EXIT.
 14720
 14721     IF DM-RETURN-CODE = '04'
 14722         MOVE ER-8054            TO EMI-ERROR
 14723         GO TO 5300-BAD-EXIT.
 14724
 14725     IF DM-RETURN-CODE = '05'
 14726         MOVE ER-8055            TO EMI-ERROR
 14727         GO TO 5300-BAD-EXIT.
 14728
 14729     IF DM-RETURN-CODE = '06'
 14730         MOVE ER-8056            TO EMI-ERROR
 14731         GO TO 5300-BAD-EXIT.
 14732
 14733     IF DM-RETURN-CODE = '07'
 14734         MOVE ER-8057            TO EMI-ERROR
 14735         GO TO 5300-BAD-EXIT.
 14736
 14737     IF DM-RETURN-CODE = '08'
 14738         MOVE ER-8058            TO EMI-ERROR
 14739         GO TO 5300-BAD-EXIT.
 14740
 14741     IF DM-RETURN-CODE = '09'
 14742         MOVE ER-8059            TO EMI-ERROR
 14743         GO TO 5300-BAD-EXIT.
 14744
 14745     IF DM-RETURN-CODE = '10'
 14746         MOVE ER-8060            TO EMI-ERROR
 14747         GO TO 5300-BAD-EXIT.
 14748
 14749     IF DM-RETURN-CODE = '11'
 14750         MOVE ER-8061            TO EMI-ERROR
 14751         GO TO 5300-BAD-EXIT.
 14752
 14753     IF DM-RETURN-CODE = '12'
 14754         MOVE ER-8062            TO EMI-ERROR
 14755         GO TO 5300-BAD-EXIT.
 14756
 14757     IF DM-RETURN-CODE = '13'
 14758         MOVE ER-8063            TO EMI-ERROR
 14759         GO TO 5300-BAD-EXIT.
 14760
 14761     IF DM-RETURN-CODE = '14'
 14762         MOVE ER-8064            TO EMI-ERROR
 14763         GO TO 5300-BAD-EXIT.
 14764
 14765     IF DM-RETURN-CODE = '15'
 14766         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 282
* EL156.cbl
 14767         GO TO 5300-BAD-EXIT.
 14768
 14769     IF DM-RETURN-CODE = '16'
 14770         MOVE ER-8154            TO EMI-ERROR
 14771         GO TO 5300-BAD-EXIT.
 14772
 14773     IF DM-RETURN-CODE = '17'
 14774         MOVE ER-8155            TO EMI-ERROR
 14775         GO TO 5300-BAD-EXIT.
 14776
 14777     IF DM-RETURN-CODE = 'N1'
 14778         MOVE ER-8152            TO EMI-ERROR
 14779         GO TO 5300-BAD-EXIT.
 14780
 14781     IF DM-RETURN-CODE = 'E1'
 14782         MOVE ER-8153            TO EMI-ERROR
 14783         GO TO 5300-BAD-EXIT.
 14784
 14785     MOVE ER-8066            TO EMI-ERROR.
 14786     GO TO 5300-BAD-EXIT.
 14787
 14788 5300-NOTE-NOT-FOUND.
 14789
 14790     MOVE ER-0954                TO EMI-ERROR.
 14791     GO TO 5300-BAD-EXIT.
 14792
 14793 5300-BAD-EXIT.
 14794
 14795* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14796*    MOVE '6"R                   !   #00013921' TO DFHEIV0
 14797     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14799     MOVE X'2020233030303133393231' TO DFHEIV0(25:11)
 14800     CALL 'kxdfhei1' USING DFHEIV0
 14801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14802
 14803     IF MAP-NAME = 'EL156A'
 14804         MOVE -1             TO ENTERPFL
 14805       ELSE
 14806         MOVE LOW-VALUES     TO EL156BI
 14807         MOVE -1             TO ENTPFBL.
 14808
 14809     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14810     GO TO 8200-SEND-DATAONLY.
 14811
 14812 5300-EXIT.
 14813     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 283
* EL156.cbl
 14815 5350-FORMAT-LAST-NAME-1ST.
 14816*****************************************************************
 14817*             M O V E   N A M E   R O U T I N E                 *
 14818*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14819*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14820*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14821*                  FIELD                   VALUE                *
 14822*           W-NAME-LAST    (CL15)      SMITH                    *
 14823*           W-NAME-FIRST   (CL15)      JOHN                     *
 14824*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14825*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14826*     CONTAIN                                                   *
 14827*                SMITH, JOHN ALLEN                              *
 14828*     OR                                                        *
 14829*                SMITH, JOHN A.                                 *
 14830*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14831*     COPYBOOK, ELCNWA.                                         *
 14832*****************************************************************.
 14833
 14834     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14835     MOVE ZERO                   TO  WS-NAME-SW.
 14836     SET NWA-INDEX               TO +1.
 14837
 14838     IF W-NAME-LAST   = SPACES AND
 14839        W-NAME-MIDDLE = SPACES
 14840         MOVE +1                 TO WS-NAME-SW.
 14841
 14842     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14843     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14844
 14845     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14846     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14847
 14848     SET NWA-INDEX UP BY +1.
 14849
 14850     IF W-NAME-MIDDLE NOT = SPACES
 14851         IF W-NAME-MIDDLE-2 = SPACES
 14852             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14853             SET NWA-INDEX UP BY +1
 14854             MOVE '.'            TO WS-NW (NWA-INDEX)
 14855             SET NWA-INDEX UP BY +2
 14856         ELSE
 14857             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14858             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14859
 14860 5350-EXIT.
 14861     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 284
* EL156.cbl
 14863 5360-MOVE-NAME.
 14864
 14865     IF WS-NAME-SW > +1
 14866         GO TO 5360-EXIT.
 14867
 14868     IF WS-NAME-WORK2 = SPACES
 14869         GO TO 5360-EXIT.
 14870
 14871     SET NWA-INDEX2            TO +1.
 14872     SET NWA-INDEX3            TO +2.
 14873
 14874 5360-MOVE-NAME-CYCLE.
 14875
 14876     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14877
 14878     IF NWA-INDEX < +30
 14879         SET NWA-INDEX UP BY +1
 14880     ELSE
 14881         ADD +2                TO  WS-NAME-SW
 14882         GO TO 5360-EXIT.
 14883
 14884     IF NWA-INDEX2 < +20
 14885         SET NWA-INDEX3 UP BY +1
 14886         SET NWA-INDEX2 UP BY +1.
 14887
 14888     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14889        WS-NW2 (NWA-INDEX3) = SPACES
 14890         IF WS-NAME-SW = ZERO
 14891             MOVE ','            TO  WS-NW (NWA-INDEX)
 14892             SET NWA-INDEX UP BY +2
 14893             MOVE +1             TO  WS-NAME-SW
 14894             GO TO 5360-EXIT
 14895         ELSE
 14896             GO TO 5360-EXIT.
 14897
 14898     GO TO 5360-MOVE-NAME-CYCLE.
 14899
 14900 5360-EXIT.
 14901     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 285
* EL156.cbl
 14903 6000-BUILD-SCREEN-B.
 14904     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14905     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14906     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14907     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14908
 14909     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14910
 14911 6050-BUILD-SCREEN.
 14912     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14913     MOVE LOW-VALUES             TO EL156BI.
 14914     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14915
 14916     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14917
 14918     IF PI-PAYEE-TYPE = 'I'
 14919        GO TO 6060-READ-TRAILER.
 14920
 14921     IF PI-PAYEE-TYPE = 'B'
 14922        ADD +10                  TO TRLR-SEQ-NO
 14923        GO TO 6060-READ-TRAILER.
 14924
 14925     IF PI-PAYEE-TYPE = 'A'
 14926        ADD +20                  TO TRLR-SEQ-NO
 14927        GO TO 6060-READ-TRAILER.
 14928
 14929     IF PI-PAYEE-TYPE = 'O'
 14930        ADD +50                  TO TRLR-SEQ-NO
 14931        GO TO 6060-READ-TRAILER.
 14932
 14933     IF PI-PAYEE-TYPE = 'Q'
 14934        ADD +60                  TO TRLR-SEQ-NO
 14935        GO TO 6060-READ-TRAILER.
 14936
 14937     IF PI-PAYEE-TYPE = 'P'
 14938        ADD +30                  TO TRLR-SEQ-NO
 14939        GO TO 6060-READ-TRAILER.
 14940
 14941     IF PI-PAYEE-TYPE = 'E'
 14942        ADD +40                  TO TRLR-SEQ-NO.
 14943
 14944 6060-READ-TRAILER.
 14945
 14946     IF PI-PAYEE-TYPE    = 'A' AND
 14947        PI-PAYEE-SEQ-NUM = 0
 14948          GO TO 6061-READ-ACCOUNT.
 14949
 14950     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14951        (PI-PAYEE-TYPE    = 'B')             AND
 14952        (PI-PAYEE-SEQ-NUM = 9)
 14953          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14954          IF BENE-FOUND-SW = 'N'
 14955            GO TO 6065-NOT-FOUND
 14956          ELSE
 14957            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14958            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14959            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14960*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 286
* EL156.cbl
 14961            STRING BE-CITY ' ' BE-STATE
 14962               DELIMITED BY '  ' INTO CITYSTBO
 14963            END-STRING
 14964            MOVE BE-ZIP-CODE       TO ZIPBO
 14965            GO TO 6061-READ-ACCOUNT.
 14966
 14967     IF PI-PAYEE-TYPE    = 'B' AND
 14968        PI-PAYEE-SEQ-NUM = 0
 14969          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14970          IF BENE-FOUND-SW = 'N'
 14971            GO TO 6065-NOT-FOUND
 14972          ELSE
 14973            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14974            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14975            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14976*           MOVE BE-CITY-STATE     TO CITYSTBO
 14977            STRING BE-CITY ' ' BE-STATE
 14978               DELIMITED BY '  ' INTO CITYSTBO
 14979            END-STRING
 14980            MOVE BE-ZIP-CODE       TO ZIPBO
 14981            GO TO 6061-READ-ACCOUNT.
 14982
 14983
 14984* EXEC CICS HANDLE CONDITION
 14985*         NOTFND(6065-NOT-FOUND)
 14986*     END-EXEC.
 14987*    MOVE '"$I                   ! / #00014102' TO DFHEIV0
 14988     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14989     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14990     MOVE X'2F20233030303134313032' TO DFHEIV0(25:11)
 14991     CALL 'kxdfhei1' USING DFHEIV0
 14992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14993
 14994
 14995     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14996
 14997     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14998     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14999     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15000     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15001*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15002     STRING AT-CITY ' ' AT-STATE
 15003        DELIMITED BY '  ' INTO CITYSTBO
 15004     END-STRING
 15005     MOVE AT-ZIP-CODE            TO ZIPBO.
 15006
 15007 6061-READ-ACCOUNT.
 15008
 15009* EXEC CICS HANDLE CONDITION
 15010*         NOTFND(6068-ACCT-NOT-FND)
 15011*     END-EXEC.
 15012*    MOVE '"$I                   ! 0 #00014119' TO DFHEIV0
 15013     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15015     MOVE X'3020233030303134313139' TO DFHEIV0(25:11)
 15016     CALL 'kxdfhei1' USING DFHEIV0
 15017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15018
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 287
* EL156.cbl
 15019
 15020
 15021* EXEC CICS READ
 15022*         DATASET('ERACCT')
 15023*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15024*         RIDFLD (PI-ACCT-KEY)
 15025*     END-EXEC.
 15026     MOVE 'ERACCT' TO DFHEIV1
 15027*    MOVE '&"S        E          (   #00014123' TO DFHEIV0
 15028     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15029     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15030     MOVE X'2020233030303134313233' TO DFHEIV0(25:11)
 15031     CALL 'kxdfhei1' USING DFHEIV0,
 15032           DFHEIV1,
 15033           DFHEIV20,
 15034           DFHEIV99,
 15035           PI-ACCT-KEY,
 15036           DFHEIV99,
 15037           DFHEIV99,
 15038           DFHEIV99
 15039     SET ADDRESS OF ACCOUNT-MASTER TO
 15040         DFHEIV20
 15041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15042
 15043
 15044     MOVE AM-CARRIER             TO ACARRBO.
 15045     MOVE AM-GROUPING            TO GROUPBO.
 15046     MOVE AM-STATE               TO STATEBO.
 15047     MOVE AM-ACCOUNT             TO ACCTBO.
 15048     MOVE AM-NAME                TO ACCTNMBO.
 15049
 15050     IF PI-PAYEE-TYPE = 'A' AND
 15051        PI-PAYEE-SEQ-NUM = 0
 15052          MOVE AM-NAME             TO NAMEBO
 15053                                      PI-PAYEE-NAME
 15054          MOVE AM-ADDRS            TO ADDR1BO
 15055          MOVE SPACES              TO ADDR2BO
 15056*         MOVE AM-CITY             TO CITYSTBO
 15057          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15058             DELIMITED BY '  ' INTO CITYSTBO
 15059          END-STRING
 15060          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15061          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15062          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15063          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15064
 15065***  We don't really need the code below because we don't do the
 15066***  AK thing anymore.  However, we may have a state special
 15067***  of some sort in the future so why not just leave it??
 15068     IF CITYSTBO EQUAL SPACES
 15069         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15070         GO TO 6070-FORMAT-DATA
 15071     END-IF.
 15072
 15073     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15074     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15075     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15076     PERFORM VARYING WS-SUB FROM 30 BY -1
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 288
* EL156.cbl
 15077          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15078        IF WS-END-SUB = 0  AND
 15079           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15080              OR LOW-VALUES  OR '.')
 15081            CONTINUE
 15082        ELSE
 15083            IF WS-END-SUB = 0
 15084                MOVE WS-SUB TO WS-END-SUB
 15085            ELSE
 15086                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15087                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15088                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15089                END-IF
 15090            END-IF
 15091        END-IF
 15092        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15093            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15094            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15095        END-IF
 15096     END-PERFORM.
 15097
 15098     IF WS-BEG-SUB > 0
 15099         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15100         IF WS-STATE-LENGTH = 2
 15101             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15102                  TO PI-CHECK-STATE-FOR-AK
 15103         ELSE
 15104             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15105                'ALASKA'
 15106                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15107             ELSE
 15108                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15109             END-IF
 15110         END-IF
 15111     ELSE
 15112         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15113     END-IF.
 15114
 15115     GO TO 6070-FORMAT-DATA.
 15116
 15117 6065-NOT-FOUND.
 15118     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15119     GO TO 6061-READ-ACCOUNT.
 15120
 15121 6068-ACCT-NOT-FND.
 15122     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15123
 15124 6070-FORMAT-DATA.
 15125     IF PI-HOLDTIL = ZEROS
 15126        MOVE SAVE-DATE           TO PAYDTBI
 15127       ELSE
 15128        MOVE PI-HOLDTIL          TO PAYDTBO
 15129        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 15130
 15131     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15132     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15133
 15134     IF EIBAID = DFHPF3 OR DFHPF4
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 289
* EL156.cbl
 15135        NEXT SENTENCE
 15136     ELSE
 15137       GO TO 6071-CONTINUE.
 15138
 15139     MOVE PI-EPYFROM          TO PYFROMBO.
 15140     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15141
 15142     IF NOT PI-USES-PAID-TO
 15143        MOVE PI-EPYTHRU          TO PYTHRUBO
 15144        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15145     ELSE
 15146        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15147        MOVE '4'              TO DC-OPTION-CODE
 15148        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15149        IF NO-CONVERSION-ERROR
 15150           MOVE +1            TO DC-ELAPSED-DAYS
 15151           MOVE +0            TO DC-ELAPSED-MONTHS
 15152           MOVE '6'           TO DC-OPTION-CODE
 15153           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15154           IF NO-CONVERSION-ERROR
 15155              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15156
 15157     MOVE PI-EDAYS            TO DAYSBO.
 15158     MOVE PI-EPYAMT           TO PAYAMTBO.
 15159     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15160        IF PI-INT-AMT > ZEROS
 15161           MOVE PI-INT-AMT       TO INTAMTBO
 15162        END-IF
 15163     END-IF
 15164     GO TO 6072-SET-TYPE.
 15165
 15166 6071-CONTINUE.
 15167
 15168     IF PI-CPYFROM NOT = LOW-VALUES
 15169        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15170        MOVE SPACES              TO DC-OPTION-CODE
 15171        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15172        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15173
 15174     IF PI-CPYTHRU NOT = LOW-VALUES
 15175        IF NOT PI-USES-PAID-TO
 15176           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15177           MOVE SPACES             TO DC-OPTION-CODE
 15178           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15179           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15180        ELSE
 15181           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15182           MOVE '6'                TO DC-OPTION-CODE
 15183           MOVE +1                 TO DC-ELAPSED-DAYS
 15184           MOVE +0                 TO DC-ELAPSED-MONTHS
 15185           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15186           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15187
 15188     MOVE PI-CDAYS               TO DAYSBO.
 15189     MOVE PI-CPYAMT              TO PAYAMTBO.
 15190     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15191        IF PI-INT-AMT > ZEROS
 15192           MOVE PI-INT-AMT       TO INTAMTBO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 290
* EL156.cbl
 15193        END-IF
 15194     END-IF
 15195     .
 15196 6072-SET-TYPE.
 15197     IF PI-PMTTYPE = '1'
 15198        MOVE 'PARTIAL'           TO PAYTYPBO.
 15199
 15200     IF PI-PMTTYPE = '2'
 15201        MOVE 'FINAL'             TO PAYTYPBO.
 15202
 15203     IF PI-PMTTYPE = '3'
 15204        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15205
 15206     IF PI-PMTTYPE = '4'
 15207        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15208
 15209     IF PI-PMTTYPE = '5'
 15210        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15211
 15212     IF PI-PMTTYPE = '6'
 15213        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15214
 15215     IF PI-PROV-PMT
 15216        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15217
 15218     IF PI-ECHECKNO NOT = SPACES
 15219        MOVE PI-ECHECKNO         TO CKNUMBO
 15220     ELSE
 15221        MOVE PI-CCHECKNO         TO CKNUMBO.
 15222
 15223     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 15224        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15225        MOVE +91                 TO  TRLR-SEQ-NO
 15226
 15227* EXEC CICS READ
 15228*           DATASET  ('ELTRLR')
 15229*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15230*           RIDFLD   (ELTRLR-KEY)
 15231*           RESP     (WS-RESPONSE)
 15232*       END-EXEC
 15233     MOVE 'ELTRLR' TO DFHEIV1
 15234*    MOVE '&"S        E          (  N#00014311' TO DFHEIV0
 15235     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15236     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15237     MOVE X'204E233030303134333131' TO DFHEIV0(25:11)
 15238     CALL 'kxdfhei1' USING DFHEIV0,
 15239           DFHEIV1,
 15240           DFHEIV20,
 15241           DFHEIV99,
 15242           ELTRLR-KEY,
 15243           DFHEIV99,
 15244           DFHEIV99,
 15245           DFHEIV99
 15246     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15247         DFHEIV20
 15248     MOVE EIBRESP  TO WS-RESPONSE
 15249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15250
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 291
* EL156.cbl
 15251        IF WS-RESP-NORMAL
 15252           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15253        ELSE
 15254           MOVE SPACES           TO  LOANNBO
 15255        END-IF
 15256     END-IF
 15257
 15258*       MOVE PI-LOAN-NO          TO LOANNBO
 15259
 15260     IF CKNUMBO = SPACES
 15261         MOVE SPACES             TO CKNUMHDO.
 15262
 15263     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15264     MOVE CL-CARRIER             TO CARRBO.
 15265     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15266     MOVE CL-CERT-SFX            TO SUFXBO.
 15267
 15268     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15269        EVALUATE CL-CLAIM-TYPE
 15270           WHEN 'I'
 15271              MOVE '  IU  '      TO CLMTYPBO
 15272           WHEN 'G'
 15273              MOVE ' GAP  '      TO CLMTYPBO
 15274           WHEN 'F'
 15275              MOVE ' FMLA '      TO CLMTYPBO
 15276           WHEN OTHER
 15277              MOVE PI-AH-OVERRIDE-L6
 15278                                 TO CLMTYPBO
 15279        END-EVALUATE
 15280        MOVE ZEROS               TO UNDISBO
 15281*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15282        IF PI-PMTTYPE = '5' OR '6'
 15283           GO TO 6073-GET-NOTIFY-DATA
 15284        ELSE
 15285           MOVE PI-DAILY-RATE    TO RATEBO
 15286           GO TO 6073-GET-NOTIFY-DATA.
 15287
 15288     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15289
 15290     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15291        MOVE ZEROS               TO UNDISBO
 15292     ELSE
 15293        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15294
 15295 6073-GET-NOTIFY-DATA.
 15296
 15297     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15298
 15299     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15300         MOVE SPACES             TO  NAMEB2O
 15301                                     ADDR1B2O
 15302                                     ADDR2B2O
 15303                                     CITYST2O
 15304                                     AGTHDGO
 15305         MOVE ZEROS              TO  ZIPB2O
 15306         GO TO 6080-SET-INCURRED.
 15307
 15308     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 292
* EL156.cbl
 15309     MOVE +29                    TO  TRLR-SEQ-NO.
 15310
 15311
 15312* EXEC CICS HANDLE CONDITION
 15313*        NOTFND   (6074-GET-COMP-DATA)
 15314*    END-EXEC.
 15315*    MOVE '"$I                   ! 1 #00014378' TO DFHEIV0
 15316     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15318     MOVE X'3120233030303134333738' TO DFHEIV0(25:11)
 15319     CALL 'kxdfhei1' USING DFHEIV0
 15320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15321
 15322
 15323     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15324
 15325     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15326     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15327     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15328*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15329     STRING AT-CITY ' ' AT-STATE
 15330        DELIMITED BY '  ' INTO CITYST2O
 15331     END-STRING
 15332     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15333     GO TO 6080-SET-INCURRED.
 15334
 15335 6074-GET-COMP-DATA.
 15336
 15337     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15338         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15339
 15340     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15341         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15342                                         ADDR1B2O
 15343                                         ADDR2B2O
 15344                                         CITYST2O
 15345         MOVE ZEROS                  TO  ZIPB2O
 15346         GO TO 6080-SET-INCURRED.
 15347
 15348     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15349     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15350     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15351     MOVE AM-GROUPING            TO  COMP-GROUP.
 15352     MOVE 'A'                    TO  COMP-TYPE.
 15353     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15354                                 TO  COMP-FIN-RESP.
 15355
 15356     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15357         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15358                                       'G' OR 'B' or 'S'
 15359             MOVE 'G'            TO  COMP-TYPE
 15360             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15361         ELSE
 15362             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15363                                 TO  COMP-ACCOUNT
 15364     ELSE
 15365         MOVE 'G'                TO  COMP-TYPE
 15366         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 293
* EL156.cbl
 15367
 15368     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15369
 15370     IF COMP-REC-FOUND
 15371         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15372         MOVE CO-ADDR-1          TO  ADDR1B2O
 15373         MOVE CO-ADDR-2          TO  ADDR2B2O
 15374*        MOVE CO-ADDR-3          TO  CITYST2O
 15375         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15376            DELIMITED BY '  ' INTO CITYST2O
 15377         END-STRING
 15378         MOVE CO-ZIP             TO  ZIPB2O
 15379     ELSE
 15380         MOVE 'NO COMP ADDRESS AVAILABLE'
 15381                                 TO  NAMEB2O
 15382                                     ADDR1B2O
 15383                                     ADDR2B2O
 15384                                     CITYST2O
 15385         MOVE ZEROS               TO ZIPB2O.
 15386
 15387 6080-SET-INCURRED.
 15388     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15389     MOVE SPACES                 TO DC-OPTION-CODE.
 15390     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15391     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15392     MOVE PI-PROCESSOR-ID        TO BYBO.
 15393     MOVE MAP-NAMEB              TO MAP-NAME.
 15394     MOVE 'C'                    TO PI-PASS-SW.
 15395     MOVE EIBAID                 TO PI-PFKEY-USED.
 15396     MOVE -1                     TO ENTPFBL.
 15397     GO TO 8100-SEND-INITIAL-MAP.
 15398
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 294
* EL156.cbl
 15400 6100-BUILD-PAYMENT-TRAILER.
 15401
 15402     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15403     MOVE '6'                    TO CNTL-REC-TYPE.
 15404
 15405     IF CONTROL-IS-ACTUAL-CARRIER
 15406         MOVE PI-CARRIER         TO WS-CARR
 15407     ELSE
 15408         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15409
 15410     IF PI-COMPANY-ID = 'FIA'
 15411         MOVE PI-CARRIER         TO  WS-CARR.
 15412
 15413     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15414     MOVE 0                      TO CNTL-SEQ-NO.
 15415     MOVE 'CARR'                 TO FILE-SWITCH.
 15416
 15417     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15418
 15419     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15420         IF PI-OFFLINE     = 'Y' AND
 15421            PI-ECHECKNO-CR = 'CR'
 15422              GO TO 6110-READ-CONTROL
 15423         ELSE
 15424            IF PI-CASH = 'N'
 15425                GO TO 6110-READ-CONTROL.
 15426
 15427     IF CHECK-NO-MANUAL    OR
 15428        CHECK-NO-AT-PRINT  OR
 15429        PI-OFFLINE = 'Y'
 15430          GO TO 6130-BUILD-TRAILER.
 15431
 15432     IF PI-COMPANY-ID = 'FIA'
 15433         NEXT SENTENCE
 15434     ELSE
 15435         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15436             GO TO 6110-READ-CONTROL.
 15437
 15438     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15439
 15440     IF CHECK-CNT-RESET-VALUE
 15441        MOVE +1                  TO CF-CHECK-COUNTER
 15442     ELSE
 15443        ADD +1                   TO CF-CHECK-COUNTER.
 15444
 15445     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15446
 15447     IF CHECK-NO-CARR-SEQ
 15448        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15449
 15450     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15451
 15452     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15453     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15454        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15455         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15456         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15457            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 295
* EL156.cbl
 15458         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15459                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15460     END-IF.
 15461
 15462     GO TO 6120-REWRITE.
 15463
 15464 6105-STATE-CHECK-NUMBER.
 15465     IF CHECK-NO-MANUAL    OR
 15466        CHECK-NO-AT-PRINT  OR
 15467        PI-OFFLINE = 'Y'
 15468           GO TO 6130-BUILD-TRAILER
 15469     END-IF.
 15470
 15471     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15472     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15473     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15474     MOVE '3'                TO CNTL-REC-TYPE.
 15475     MOVE +0                 TO CNTL-SEQ-NO.
 15476     MOVE 'STAT'             TO FILE-SWITCH.
 15477     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15478
 15479     IF CF-ST-CHECK-CNT-RESET
 15480         MOVE +1             TO CF-ST-CHECK-COUNTER
 15481     ELSE
 15482         ADD +1              TO CF-ST-CHECK-COUNTER
 15483     END-IF.
 15484
 15485     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15486     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15487     GO TO 6120-REWRITE.
 15488
 15489 6110-READ-CONTROL.
 15490     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15491     MOVE '1'                    TO CNTL-REC-TYPE.
 15492     MOVE SPACES                 TO CNTL-ACCESS.
 15493     MOVE 0                      TO CNTL-SEQ-NO.
 15494
 15495     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15496
 15497     IF CO-CHECK-COUNT-RESET
 15498        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15499     ELSE
 15500        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15501
 15502     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15503
 15504     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15505         IF PI-OFFLINE     = 'Y'  AND
 15506            PI-ECHECKNO-CR = 'CR'
 15507              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15508              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15509              MOVE AL-UANON           TO CHECKNOA
 15510              GO TO 6120-REWRITE
 15511         ELSE
 15512         IF PI-CASH = 'N'
 15513             MOVE 'N'                TO PI-ECHECKNO-N
 15514             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15515             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 296
* EL156.cbl
 15516             MOVE AL-UANON           TO CHECKNOA
 15517             GO TO 6120-REWRITE.
 15518
 15519     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15520
 15521 6120-REWRITE.
 15522
 15523* EXEC CICS REWRITE
 15524*         DATASET('ELCNTL')
 15525*         FROM(CONTROL-FILE)
 15526*     END-EXEC.
 15527     MOVE LENGTH OF
 15528      CONTROL-FILE
 15529       TO DFHEIV11
 15530     MOVE 'ELCNTL' TO DFHEIV1
 15531*    MOVE '&& L                  %   #00014581' TO DFHEIV0
 15532     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15533     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15534     MOVE X'2020233030303134353831' TO DFHEIV0(25:11)
 15535     CALL 'kxdfhei1' USING DFHEIV0,
 15536           DFHEIV1,
 15537           CONTROL-FILE,
 15538           DFHEIV11,
 15539           DFHEIV99
 15540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15541
 15542
 15543     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15544
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 297
* EL156.cbl
 15546 6130-BUILD-TRAILER.
 15547
 15548
 15549* EXEC CICS GETMAIN
 15550*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15551*         LENGTH    (200)
 15552*         INITIMG   (GETMAIN-SPACE)
 15553*     END-EXEC.
 15554     MOVE 200
 15555       TO DFHEIV11
 15556*    MOVE ',"IL                  $   #00014591' TO DFHEIV0
 15557     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15558     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15559     MOVE X'2020233030303134353931' TO DFHEIV0(25:11)
 15560     CALL 'kxdfhei1' USING DFHEIV0,
 15561           DFHEIV20,
 15562           DFHEIV11,
 15563           GETMAIN-SPACE
 15564     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15565         DFHEIV20
 15566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15567
 15568
 15569     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15570                                    AT-PREV-PAID-THRU-DT.
 15571     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15572     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15573     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15574     MOVE 'AT'                   TO AT-RECORD-ID.
 15575     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15576
 15577     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15578        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15579           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15580     ELSE
 15581           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15582           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15583
 15584     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15585         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15586             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15587             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15588           ELSE
 15589             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15590             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15591
 15592     MOVE '2'                    TO AT-TRAILER-TYPE.
 15593     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15594                                    AT-PAYMENT-LAST-MAINT-DT.
 15595     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15596                                    AT-PAYMENT-LAST-UPDATED-BY.
 15597     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15598     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15599     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15600     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15601
 15602     IF PI-PMT-APPROVED
 15603        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 298
* EL156.cbl
 15604           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15605
 15606     IF PI-PFKEY-USED = DFHPF5
 15607        GO TO 6140-PF5-ENTERED.
 15608
 15609     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15610     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15611
 15612     IF PI-AIG-SPECIAL-BENEFIT
 15613         IF WS-1ST-SPECIAL-PMT
 15614             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15615             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15616                                        AT-AMOUNT-PAID
 15617         ELSE
 15618             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15619
 15620     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15621
 15622     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15623     MOVE '4'                    TO DC-OPTION-CODE.
 15624     PERFORM 9700-LINK-DATE-CONVERT.
 15625
 15626     IF DATE-CONVERSION-ERROR
 15627        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15628     ELSE
 15629        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15630
 15631     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15632     MOVE '4'                    TO DC-OPTION-CODE.
 15633     PERFORM 9700-LINK-DATE-CONVERT.
 15634
 15635     IF DATE-CONVERSION-ERROR
 15636        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15637     ELSE
 15638        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15639
 15640     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15641     GO TO 6150-FINISH-MOVE.
 15642
 15643 6140-PF5-ENTERED.
 15644     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15645     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15646
 15647     IF PI-AIG-SPECIAL-BENEFIT
 15648         IF WS-1ST-SPECIAL-PMT
 15649             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15650             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15651                                        AT-AMOUNT-PAID
 15652         ELSE
 15653             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15654
 15655     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15656     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15657     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15658
 15659 6150-FINISH-MOVE.
 15660
 15661     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 299
* EL156.cbl
 15662         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15663     ELSE
 15664         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15665
 15666     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15667     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15668
 15669*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15670*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15671
 15672     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15673         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15674
 15675     IF PI-OFFLINE = 'N'
 15676        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15677        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15678     ELSE
 15679        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15680        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15681
 15682     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15683
 15684     IF WS-2ND-SPECIAL-PMT
 15685         MOVE 'Y'                TO AT-CASH-PAYMENT
 15686         MOVE SPACES             TO AT-CHECK-NO
 15687         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15688         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15689         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15690         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15691
 15692     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15693                                    AT-TO-BE-WRITTEN-DT.
 15694
 15695     IF PI-HOLDTIL NOT = ZEROS
 15696        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15697        MOVE '4'                 TO DC-OPTION-CODE
 15698        PERFORM 9700-LINK-DATE-CONVERT
 15699        IF PI-OFFLINE = 'N'
 15700           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15701        ELSE
 15702           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15703
 15704     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15705     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15706                                    AT-CHECK-QUE-SEQUENCE.
 15707
 15708     IF PI-PFKEY-USED = DFHPF4
 15709        MOVE '1'                 TO AT-FORCE-CONTROL.
 15710
 15711     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15712        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15713        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15714        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15715
 15716     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15717                                    AT-VOID-SELECT-DT
 15718                                    AT-VOID-ACCEPT-DT
 15719                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 300
* EL156.cbl
 15720     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15721        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15722        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15723        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15724        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15725     ELSE
 15726        MOVE ZEROS               TO AT-DAILY-RATE
 15727                                    AT-ELIMINATION-DAYS
 15728        MOVE SPACES              TO AT-BENEFIT-TYPE
 15729     END-IF
 15730     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15731     MOVE '4'                    TO DC-OPTION-CODE.
 15732     PERFORM 9700-LINK-DATE-CONVERT.
 15733     IF DATE-CONVERSION-ERROR
 15734         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15735     ELSE
 15736         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15737     END-IF.
 15738     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15739     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15740     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15741     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15742     IF (PI-REAUDIT-NEEDED = 'Y')
 15743        or (pi-max-ext-used = 'Y')
 15744        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15745         PERFORM 6155-READ-CONTROL
 15746         PERFORM 6157-SET-APP-LEVEL
 15747         IF AT-APPROVAL-LEVEL-REQD < '4'
 15748            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15749         END-IF
 15750         MOVE 'Y' TO WS-NEED-APPROVAL
 15751         GO TO 6170-WRITE
 15752     END-IF.
 15753*******************************************************
 15754     IF NOT PI-PMT-GRADUATED
 15755         GO TO 6170-WRITE.
 15756     PERFORM 6155-READ-CONTROL.
 15757
 15758     IF PAID-FOR-LIFE
 15759         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15760             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15761                                     WS-PMT-APPROVAL-SW
 15762             GO TO 6170-WRITE.
 15763
 15764*05999      IF PAID-FOR-AH
 15765     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15766         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15767             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15768                                     WS-PMT-APPROVAL-SW
 15769             GO TO 6170-WRITE.
 15770
 15771     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15772
 15773     PERFORM 6157-SET-APP-LEVEL.
 15774
 15775     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15776
 15777     IF NOT PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 301
* EL156.cbl
 15778         GO TO 6170-WRITE.
 15779
 15780
 15781* EXEC CICS HANDLE CONDITION
 15782*        NOTFND   (6170-WRITE)
 15783*    END-EXEC.
 15784*    MOVE '"$I                   ! 2 #00014808' TO DFHEIV0
 15785     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15786     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15787     MOVE X'3220233030303134383038' TO DFHEIV0(25:11)
 15788     CALL 'kxdfhei1' USING DFHEIV0
 15789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15790
 15791
 15792     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15793     MOVE '2'                    TO CNTL-REC-TYPE.
 15794     MOVE +0                     TO CNTL-SEQ-NO.
 15795     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15796
 15797
 15798* EXEC CICS READ
 15799*         DATASET  ('ELCNTL')
 15800*         SET      (ADDRESS OF CONTROL-FILE)
 15801*         RIDFLD   (ELCNTL-KEY)
 15802*    END-EXEC.
 15803     MOVE 'ELCNTL' TO DFHEIV1
 15804*    MOVE '&"S        E          (   #00014817' TO DFHEIV0
 15805     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15807     MOVE X'2020233030303134383137' TO DFHEIV0(25:11)
 15808     CALL 'kxdfhei1' USING DFHEIV0,
 15809           DFHEIV1,
 15810           DFHEIV20,
 15811           DFHEIV99,
 15812           ELCNTL-KEY,
 15813           DFHEIV99,
 15814           DFHEIV99,
 15815           DFHEIV99
 15816     SET ADDRESS OF CONTROL-FILE TO
 15817         DFHEIV20
 15818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15819
 15820
 15821     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15822
 15823     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15824                         OR '4' OR '5'
 15825         NEXT SENTENCE
 15826     ELSE
 15827         MOVE 'Y' TO WS-NEED-APPROVAL
 15828         GO TO 6170-WRITE.
 15829
 15830     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15831         MOVE 'Y' TO WS-NEED-APPROVAL
 15832         IF WS-APPROVAL-LEVEL = '1'
 15833             MOVE '2'        TO  AT-APPROVED-LEVEL
 15834                            WS-SAVE-APPROVED-LEVEL
 15835             GO TO 6170-WRITE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 302
* EL156.cbl
 15836         ELSE
 15837             IF WS-APPROVAL-LEVEL = '2'
 15838                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15839                                WS-SAVE-APPROVED-LEVEL
 15840                 GO TO 6170-WRITE
 15841             ELSE IF WS-APPROVAL-LEVEL = '3'
 15842                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15843                                WS-SAVE-APPROVED-LEVEL
 15844                 GO TO 6170-WRITE
 15845             ELSE IF WS-APPROVAL-LEVEL = '4'
 15846                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15847                                WS-SAVE-APPROVED-LEVEL
 15848                 GO TO 6170-WRITE.
 15849
 15850     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15851                             WS-PMT-APPROVAL-SW.
 15852     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15853                             AT-APPROVAL-LEVEL-REQD.
 15854
 15855*******************************************************
 15856 6155-READ-CONTROL.
 15857     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15858     MOVE '1'                    TO CNTL-REC-TYPE.
 15859     MOVE SPACES                 TO CNTL-ACCESS.
 15860     MOVE +0                     TO CNTL-SEQ-NO.
 15861     MOVE 'COMP'                 TO FILE-SWITCH.
 15862
 15863     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15864 6157-SET-APP-LEVEL.
 15865******A&H Limits are set as a monthly payment.  Calculate the mont
 15866******equivalent of the amount paid today
 15867     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15868        PI-SAVE-ODD-DAYS-OVER > 0
 15869           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15870                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15871           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15872                                  WS-CALC-PMT-MONTHS
 15873     ELSE
 15874           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15875     END-IF.
 15876*06007      IF ((PAID-FOR-AH) AND
 15877     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15878*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15879        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15880              OR
 15881        ((PAID-FOR-LIFE) AND
 15882        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15883            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15884       ELSE
 15885*06014      IF ((PAID-FOR-AH)  AND
 15886         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15887*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15888           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15889              OR
 15890        ((PAID-FOR-LIFE) AND
 15891        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15892            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15893         ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 303
* EL156.cbl
 15894*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15895           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15896               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15897              OR
 15898          ((PAID-FOR-LIFE) AND
 15899          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15900            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15901       ELSE
 15902           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15903               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15904              OR
 15905          ((PAID-FOR-LIFE) AND
 15906          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15907            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15908       ELSE
 15909            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15910
 15911     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15912        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15913        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15914            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15915        END-IF
 15916     ELSE
 15917     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15918        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15919        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15920            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15921        END-IF
 15922     ELSE
 15923     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15924        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15925        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15926            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15927        END-IF
 15928     ELSE
 15929     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15930        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15931        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15932            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15933        END-IF
 15934     ELSE
 15935     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15936            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15937
 15938 6170-WRITE.
 15939
 15940     if pi-company-id = 'DCC' or 'CAP'
 15941        PERFORM 0900-GET-DDF-limits
 15942                                 THRU 0900-EXIT
 15943     end-if
 15944     perform 2220-update-elcrtt  thru 2220-exit
 15945     IF PI-COMPANY-ID = 'DMD'
 15946        IF PI-AT-EOB-CODES NOT = SPACES
 15947           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15948           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15949           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15950           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15951           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 304
* EL156.cbl
 15952
 15953
 15954* EXEC CICS HANDLE CONDITION
 15955*        DUPREC    (6180-DUPREC)
 15956*    END-EXEC.
 15957*    MOVE '"$%                   ! 3 #00014955' TO DFHEIV0
 15958     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15959     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15960     MOVE X'3320233030303134393535' TO DFHEIV0(25:11)
 15961     CALL 'kxdfhei1' USING DFHEIV0
 15962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15963
 15964
 15965
 15966* EXEC CICS WRITE
 15967*         DATASET       ('ELTRLR')
 15968*         FROM          (ACTIVITY-TRAILERS)
 15969*         RIDFLD        (AT-CONTROL-PRIMARY)
 15970*     END-EXEC.
 15971     MOVE LENGTH OF
 15972      ACTIVITY-TRAILERS
 15973       TO DFHEIV11
 15974     MOVE 'ELTRLR' TO DFHEIV1
 15975*    MOVE '&$ L                  ''   #00014959' TO DFHEIV0
 15976     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15977     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15978     MOVE X'2020233030303134393539' TO DFHEIV0(25:11)
 15979     CALL 'kxdfhei1' USING DFHEIV0,
 15980           DFHEIV1,
 15981           ACTIVITY-TRAILERS,
 15982           DFHEIV11,
 15983           AT-CONTROL-PRIMARY,
 15984           DFHEIV99,
 15985           DFHEIV99
 15986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15987
 15988
 15989     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15990        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15991*06088           GO TO 6199-EXIT.
 15992           GO TO 6176-APPROVAL-NOTE.
 15993
 15994
 15995* EXEC CICS GETMAIN
 15996*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15997*         LENGTH    (200)
 15998*         INITIMG   (GETMAIN-SPACE)
 15999*     END-EXEC.
 16000     MOVE 200
 16001       TO DFHEIV11
 16002*    MOVE ',"IL                  $   #00014970' TO DFHEIV0
 16003     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16004     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16005     MOVE X'2020233030303134393730' TO DFHEIV0(25:11)
 16006     CALL 'kxdfhei1' USING DFHEIV0,
 16007           DFHEIV20,
 16008           DFHEIV11,
 16009           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 305
* EL156.cbl
 16010     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16011         DFHEIV20
 16012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16013
 16014
 16015     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16016
 16017     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16018     MOVE 'AT'                   TO AT-RECORD-ID.
 16019     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16020     MOVE '6'                    TO AT-TRAILER-TYPE.
 16021     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16022                                    AT-GEN-INFO-LAST-MAINT-DT
 16023     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16024                                    AT-GEN-INFO-LAST-UPDATED-BY
 16025     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16026
 16027     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16028     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16029     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16030
 16031     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16032
 16033 6175-WRITE.
 16034
 16035
 16036* EXEC CICS HANDLE CONDITION
 16037*        DUPREC    (6190-DUPREC)
 16038*    END-EXEC.
 16039*    MOVE '"$%                   ! 4 #00014996' TO DFHEIV0
 16040     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16042     MOVE X'3420233030303134393936' TO DFHEIV0(25:11)
 16043     CALL 'kxdfhei1' USING DFHEIV0
 16044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16045
 16046
 16047
 16048* EXEC CICS WRITE
 16049*         DATASET     ('ELTRLR')
 16050*         FROM        (ACTIVITY-TRAILERS)
 16051*         RIDFLD      (AT-CONTROL-PRIMARY)
 16052*     END-EXEC.
 16053     MOVE LENGTH OF
 16054      ACTIVITY-TRAILERS
 16055       TO DFHEIV11
 16056     MOVE 'ELTRLR' TO DFHEIV1
 16057*    MOVE '&$ L                  ''   #00015000' TO DFHEIV0
 16058     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16059     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16060     MOVE X'2020233030303135303030' TO DFHEIV0(25:11)
 16061     CALL 'kxdfhei1' USING DFHEIV0,
 16062           DFHEIV1,
 16063           ACTIVITY-TRAILERS,
 16064           DFHEIV11,
 16065           AT-CONTROL-PRIMARY,
 16066           DFHEIV99,
 16067           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 306
* EL156.cbl
 16068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16069
 16070
 16071 6176-APPROVAL-NOTE.
 16072
 16073     IF NOT APPROVAL-NEEDED
 16074         GO TO 6199-EXIT.
 16075
 16076
 16077* EXEC CICS GETMAIN
 16078*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16079*        LENGTH    (200)
 16080*        INITIMG   (GETMAIN-SPACE)
 16081*    END-EXEC.
 16082     MOVE 200
 16083       TO DFHEIV11
 16084*    MOVE ',"IL                  $   #00015011' TO DFHEIV0
 16085     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16086     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16087     MOVE X'2020233030303135303131' TO DFHEIV0(25:11)
 16088     CALL 'kxdfhei1' USING DFHEIV0,
 16089           DFHEIV20,
 16090           DFHEIV11,
 16091           GETMAIN-SPACE
 16092     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16093         DFHEIV20
 16094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16095
 16096
 16097     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16098
 16099     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16100     MOVE 'AT'               TO AT-RECORD-ID
 16101     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16102     MOVE '6'                TO AT-TRAILER-TYPE
 16103     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16104                                AT-GEN-INFO-LAST-MAINT-DT
 16105     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16106                                AT-GEN-INFO-LAST-UPDATED-BY
 16107     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16108
 16109     IF PI-REAUDIT-NEEDED = 'Y'
 16110         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16111     ELSE
 16112         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16113     END-IF
 16114     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16115         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16116     END-IF
 16117     MOVE SPACES             TO AT-INFO-LINE-2
 16118
 16119     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16120 6177-WRITE.
 16121
 16122
 16123* EXEC CICS HANDLE CONDITION
 16124*        DUPREC    (6185-DUPREC)
 16125*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 307
* EL156.cbl
 16126*    MOVE '"$%                   ! 5 #00015042' TO DFHEIV0
 16127     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16129     MOVE X'3520233030303135303432' TO DFHEIV0(25:11)
 16130     CALL 'kxdfhei1' USING DFHEIV0
 16131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16132
 16133
 16134
 16135* EXEC CICS WRITE
 16136*         DATASET     ('ELTRLR')
 16137*         FROM        (ACTIVITY-TRAILERS)
 16138*         RIDFLD      (AT-CONTROL-PRIMARY)
 16139*     END-EXEC.
 16140     MOVE LENGTH OF
 16141      ACTIVITY-TRAILERS
 16142       TO DFHEIV11
 16143     MOVE 'ELTRLR' TO DFHEIV1
 16144*    MOVE '&$ L                  ''   #00015046' TO DFHEIV0
 16145     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16146     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16147     MOVE X'2020233030303135303436' TO DFHEIV0(25:11)
 16148     CALL 'kxdfhei1' USING DFHEIV0,
 16149           DFHEIV1,
 16150           ACTIVITY-TRAILERS,
 16151           DFHEIV11,
 16152           AT-CONTROL-PRIMARY,
 16153           DFHEIV99,
 16154           DFHEIV99
 16155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16156
 16157
 16158
 16159     GO TO 6199-EXIT.
 16160
 16161 6180-DUPREC.
 16162
 16163     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16164     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16165     GO TO 6170-WRITE.
 16166
 16167 6185-DUPREC.
 16168     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16169     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16170     GO TO 6177-WRITE.
 16171
 16172 6190-DUPREC.
 16173     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16174     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16175     GO TO 6175-WRITE.
 16176
 16177 6199-EXIT.
 16178      EXIT.
 16179
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 308
* EL156.cbl
 16181 6200-UPDATE-CLAIM-MSTR.
 16182     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16183     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16184     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16185     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16186
 16187     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16188
 16189     MOVE ZEROS                  TO W-INTEREST.
 16190
 16191     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 16192        IF (PI-OFFLINE = 'Y') OR
 16193           (PI-PMTTYPE = '7')
 16194           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16195                                 THRU 9870-EXIT
 16196        END-IF
 16197     END-IF
 16198     IF NOT ERROR-ON-OUTPUT
 16199        CONTINUE
 16200     ELSE
 16201
 16202* EXEC CICS REWRITE
 16203*          DATASET('ELMSTR')
 16204*          FROM(CLAIM-MASTER)
 16205*       END-EXEC
 16206     MOVE LENGTH OF
 16207      CLAIM-MASTER
 16208       TO DFHEIV11
 16209     MOVE 'ELMSTR' TO DFHEIV1
 16210*    MOVE '&& L                  %   #00015095' TO DFHEIV0
 16211     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16212     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16213     MOVE X'2020233030303135303935' TO DFHEIV0(25:11)
 16214     CALL 'kxdfhei1' USING DFHEIV0,
 16215           DFHEIV1,
 16216           CLAIM-MASTER,
 16217           DFHEIV11,
 16218           DFHEIV99
 16219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16220
 16221        MOVE -1                  TO ENTPFBL
 16222        MOVE AL-UANON            TO ENTPFBA
 16223        MOVE MAP-NAMEB           TO MAP-NAME
 16224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16225        GO TO 8200-SEND-DATAONLY
 16226     END-IF
 16227
 16228     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16229
 16230     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16231
 16232     IF PI-AIG-SPECIAL-BENEFIT
 16233         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16234
 16235     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16236
 16237     IF PI-SPECIAL-BEN-SW = 'Y'
 16238         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 309
* EL156.cbl
 16239         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16240
 16241     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16242         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16243     ELSE
 16244         IF PI-PMTTYPE NOT = '4'
 16245            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16246
 16247     IF PI-PMTTYPE = '5' OR '6'
 16248        GO TO  6250-SET-MAINT.
 16249
 16250     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16251                                         CL-LAG-REPORT-CODE.
 16252
 16253     IF CL-ACTIVITY-CODE = 09
 16254         GO TO 6200-CONT-UPDATE.
 16255
 16256     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16257         IF CL-ACTIVITY-CODE = 11
 16258             GO TO 6200-CONT-UPDATE.
 16259
 16260     IF WS-ACT-REC-FOUND-SW = 'N'
 16261         GO TO 6200-CONT-UPDATE.
 16262
 16263     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16264         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16265         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16266         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16267
 16268     IF WS-UPDATE-SW = 'Y'
 16269         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16270                                         CL-NEXT-FOLLOWUP-DT.
 16271
 16272 6200-CONT-UPDATE.
 16273
 16274     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16275       IF CLAIM-IS-CLOSED
 16276         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16277           IF WS-OPEN-CLOSE-SW = '2'
 16278             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16279                                        CL-LAST-CLOSE-DT.
 16280
 16281     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16282        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16283        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16284
 16285     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16286        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16287        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16288        MOVE 'C'                 TO CL-CLAIM-STATUS
 16289        IF PI-PMTTYPE = '2'
 16290           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16291              or 'F')
 16292           CONTINUE
 16293        ELSE
 16294           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16295        END-IF
 16296     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 310
* EL156.cbl
 16297        IF PI-PMTTYPE = '2' OR '3'
 16298           IF PI-PMTTYPE = '2' AND
 16299              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16300                 or 'F')
 16301              CONTINUE
 16302           ELSE
 16303              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16304           END-IF
 16305        END-IF
 16306     END-IF
 16307
 16308     IF PI-PMTTYPE = '4'
 16309        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16310
 16311     IF PI-COMPANY-ID = 'CVL'
 16312         IF PI-LOAN-UPDATE-SW = 'Y'
 16313             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16314             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16315             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16316             MOVE CL-CERT-STATE      TO  CERT-STATE
 16317             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16318             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16319             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16320             MOVE 'CERT'             TO  FILE-SWITCH
 16321             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16322             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16323             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16324
 16325     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16326        GO TO 6220-USE-COMPUTED.
 16327
 16328     IF (PI-PMTTYPE = '4')  AND
 16329        (PI-EPYAMT < ZEROS)
 16330          COMPUTE CL-NO-OF-DAYS-PAID =
 16331                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16332          IF CL-NO-OF-DAYS-PAID < +0
 16333              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16334          ELSE
 16335              NEXT SENTENCE
 16336     ELSE
 16337          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16338
 16339     IF PI-PROCESSOR-ID = 'FIX '
 16340        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16341           NEXT SENTENCE
 16342        ELSE
 16343           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16344     ELSE
 16345        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16346
 16347     IF PI-PMTTYPE = '4'
 16348        GO TO 6250-SET-MAINT.
 16349
 16350     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16351
 16352     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16353     MOVE '4'                    TO DC-OPTION-CODE.
 16354     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 311
* EL156.cbl
 16355     IF DATE-CONVERSION-ERROR
 16356        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16357     ELSE
 16358        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16359           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16360           IF PI-AIG-SPECIAL-BENEFIT
 16361               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16362           ELSE
 16363               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16364
 16365     GO TO 6250-SET-MAINT.
 16366
 16367 6220-USE-COMPUTED.
 16368
 16369     IF (PI-PMTTYPE = '4')  AND
 16370        (PI-CPYAMT < ZEROS)
 16371          COMPUTE CL-NO-OF-DAYS-PAID =
 16372                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16373          IF CL-NO-OF-DAYS-PAID < +0
 16374              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16375          ELSE
 16376              NEXT SENTENCE
 16377     ELSE
 16378          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16379
 16380     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16381
 16382     IF PI-PMTTYPE = '4'
 16383        GO TO 6250-SET-MAINT.
 16384
 16385     IF PI-AIG-SPECIAL-BENEFIT
 16386         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16387     ELSE
 16388         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16389
 16390     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16391
 16392     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16393        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16394
 16395 6250-SET-MAINT.
 16396     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16397
 16398     IF PI-PROCESSOR-ID = 'FIX '
 16399        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16400           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16401        ELSE
 16402           NEXT SENTENCE
 16403     ELSE
 16404        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16405
 16406     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16407     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16408     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16409
 16410 6299-EXIT.
 16411      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 312
* EL156.cbl
 16413 6300-UPDATE-CERT.
 16414
 16415*  ADD CERTNOTE FOR SC NP+6
 16416     IF PI-COMPANY-ID = 'CID' AND
 16417       (PI-PMTTYPE = '2' OR '3') AND
 16418        CL-CERT-STATE = 'SC'  AND
 16419        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16420           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16421     END-IF.
 16422
 16423     IF PI-COMPANY-ID = 'AHL' AND
 16424       (PI-PMTTYPE = '2' OR '3') AND
 16425        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16426           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16427           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16428     END-IF.
 16429
 16430     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16431     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16432     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16433     MOVE CL-CERT-STATE    TO CERT-STATE.
 16434     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16435     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16436     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16437     MOVE 'CERT'           TO FILE-SWITCH.
 16438
 16439     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16440
 16441     IF CERT-NOTE-ADDED
 16442        IF CM-NOTE-SW = ' '
 16443           MOVE '4'             TO CM-NOTE-SW
 16444        ELSE
 16445           IF CM-NOTE-SW = '1'
 16446               MOVE '5'           TO CM-NOTE-SW
 16447           ELSE
 16448              IF CM-NOTE-SW = '2'
 16449                 MOVE '6'         TO CM-NOTE-SW
 16450              ELSE
 16451                 IF CM-NOTE-SW = '3'
 16452                    MOVE '7'      TO CM-NOTE-SW
 16453                 END-IF
 16454              END-IF
 16455           END-IF
 16456        END-IF
 16457     END-IF.
 16458
 16459     IF PI-COMPANY-ID = 'CVL'
 16460         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16461         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16462
 16463     IF PI-PMTTYPE NOT = '4'
 16464        GO TO 6340-UPDATE-CERT.
 16465
 16466     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16467        IF PI-PFKEY-USED = DFHPF5
 16468           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16469        ELSE
 16470           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 313
* EL156.cbl
 16471
 16472*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16473*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16474*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16475*               PI-LF-COVERAGE-TYPE = 'P'
 16476*                GO TO 6350-REWRITE-CERT.
 16477
 16478     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16479       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16480          PI-LF-COVERAGE-TYPE = 'P'
 16481           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16482                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16483                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16484                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16485                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16486                GO TO 6350-REWRITE-CERT
 16487            ELSE
 16488                GO TO 6350-REWRITE-CERT.
 16489
 16490     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16491         GO TO 6350-REWRITE-CERT.
 16492
 16493     IF NOT CM-AH-LUMP-SUM-DISAB
 16494        GO TO 6380-UNLOCK-CERT.
 16495
 16496     IF PI-PFKEY-USED = DFHPF5
 16497        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16498                                    CM-AH-ITD-AH-PMT
 16499        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16500        GO TO 6350-REWRITE-CERT
 16501     ELSE
 16502        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16503                                    CM-AH-ITD-AH-PMT
 16504        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16505        GO TO 6350-REWRITE-CERT.
 16506
 16507 6340-UPDATE-CERT.
 16508
 16509     IF CL-CLAIM-TYPE = 'L'
 16510         IF PI-PFKEY-USED = DFHPF5
 16511             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16512         ELSE
 16513             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16514
 16515     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16516         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16517             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16518                PI-LF-COVERAGE-TYPE = 'P'
 16519                 GO TO 6350-REWRITE-CERT.
 16520
 16521     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16522       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16523          PI-LF-COVERAGE-TYPE = 'P'
 16524           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16525                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16526                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16527                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16528                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 314
* EL156.cbl
 16529                GO TO 6350-REWRITE-CERT.
 16530
 16531     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16532         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16533            PI-LF-COVERAGE-TYPE NOT = 'P'
 16534             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16535             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16536             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16537             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16538             GO TO 6350-REWRITE-CERT.
 16539
 16540     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16541         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16542         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16543         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16544         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16545         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16546         IF PI-PFKEY-USED = DFHPF5
 16547             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16548                                        CM-AH-ITD-AH-PMT
 16549             GO TO 6350-REWRITE-CERT
 16550         ELSE
 16551             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16552                                        CM-AH-ITD-AH-PMT
 16553             GO TO 6350-REWRITE-CERT.
 16554
 16555 6350-REWRITE-CERT.
 16556
 16557
 16558* EXEC CICS REWRITE
 16559*         DATASET  ('ELCERT')
 16560*         FROM(CERTIFICATE-MASTER)
 16561*     END-EXEC.
 16562     MOVE LENGTH OF
 16563      CERTIFICATE-MASTER
 16564       TO DFHEIV11
 16565     MOVE 'ELCERT' TO DFHEIV1
 16566*    MOVE '&& L                  %   #00015436' TO DFHEIV0
 16567     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16568     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16569     MOVE X'2020233030303135343336' TO DFHEIV0(25:11)
 16570     CALL 'kxdfhei1' USING DFHEIV0,
 16571           DFHEIV1,
 16572           CERTIFICATE-MASTER,
 16573           DFHEIV11,
 16574           DFHEIV99
 16575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16576
 16577
 16578     GO TO 6399-EXIT.
 16579
 16580 6380-UNLOCK-CERT.
 16581
 16582* EXEC CICS UNLOCK
 16583*         DATASET  ('ELCERT')
 16584*     END-EXEC.
 16585     MOVE 'ELCERT' TO DFHEIV1
 16586*    MOVE '&*                    #   #00015444' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 315
* EL156.cbl
 16587     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16588     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16589     MOVE X'2020233030303135343434' TO DFHEIV0(25:11)
 16590     CALL 'kxdfhei1' USING DFHEIV0,
 16591           DFHEIV1,
 16592           DFHEIV99
 16593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16594
 16595
 16596 6399-EXIT.
 16597      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 316
* EL156.cbl
 16599 6400-UPDATE-ZERO-TRAILER.
 16600     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16601     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16602
 16603     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16604
 16605     IF PI-EPYAMT NOT = ZEROS
 16606         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16607     ELSE
 16608         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16609
 16610     IF PI-ERESV NOT = ZEROS
 16611        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16612
 16613     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16614        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16615
 16616     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16617        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16618     ELSE
 16619        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16620
 16621     IF PI-PMTTYPE = '5'
 16622        IF PI-EPYAMT = ZEROS
 16623           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16624        ELSE
 16625           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16626
 16627     IF PI-PMTTYPE = '6'
 16628        IF PI-EPYAMT = ZEROS
 16629           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16630        ELSE
 16631           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16632
 16633 6420-CHECK-OPEN-CLOSE.
 16634     IF PI-PMTTYPE = '5' OR '6'
 16635        GO TO 6450-REWRITE.
 16636
 16637     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16638         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16639             IF CLAIM-IS-CLOSED
 16640                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16641                 MOVE 1          TO  SUB-1
 16642                 GO TO 6440-AIG-LOOP.
 16643
 16644     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16645        GO TO 6450-REWRITE.
 16646
 16647     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16648        GO TO 6450-REWRITE.
 16649
 16650     MOVE 1                      TO SUB-1.
 16651
 16652 6430-LOOP.
 16653     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16654        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16655        IF PI-PMTTYPE = '1' OR '4'
 16656           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 317
* EL156.cbl
 16657           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16658           GO TO 6450-REWRITE
 16659        ELSE
 16660           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16661           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16662           GO TO 6450-REWRITE.
 16663
 16664     IF SUB-1 = 6
 16665      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16666      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16667      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16668      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16669      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16670      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16671      GO TO 6430-LOOP.
 16672
 16673     ADD 1                       TO SUB-1.
 16674     GO TO 6430-LOOP.
 16675
 16676
 16677 6440-AIG-LOOP.
 16678
 16679     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16680       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16681       IF WS-OPEN-CLOSE-SW = '1'
 16682         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16683         IF PI-PMTTYPE = '2'
 16684           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16685           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16686         ELSE
 16687           IF PI-PMTTYPE = '3'
 16688             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16689             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16690           ELSE
 16691             IF PI-PMTTYPE = '4'
 16692               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16693               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16694             ELSE
 16695               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16696               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16697       ELSE
 16698         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16699         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16700         GO TO 6450-REWRITE.
 16701
 16702     IF SUB-1 = 6
 16703      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16704      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16705      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16706      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16707      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16708      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16709      GO TO 6440-AIG-LOOP.
 16710
 16711     ADD 1                       TO SUB-1.
 16712     GO TO 6440-AIG-LOOP.
 16713
 16714 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 318
* EL156.cbl
 16715     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16716     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16717     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16718
 16719     IF PI-COMPANY-ID = 'DMD'
 16720         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16721         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16722         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16723         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16724         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16725
 16726
 16727* EXEC CICS REWRITE
 16728*         DATASET  ('ELTRLR')
 16729*         FROM     (ACTIVITY-TRAILERS)
 16730*     END-EXEC.
 16731     MOVE LENGTH OF
 16732      ACTIVITY-TRAILERS
 16733       TO DFHEIV11
 16734     MOVE 'ELTRLR' TO DFHEIV1
 16735*    MOVE '&& L                  %   #00015578' TO DFHEIV0
 16736     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16737     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16738     MOVE X'2020233030303135353738' TO DFHEIV0(25:11)
 16739     CALL 'kxdfhei1' USING DFHEIV0,
 16740           DFHEIV1,
 16741           ACTIVITY-TRAILERS,
 16742           DFHEIV11,
 16743           DFHEIV99
 16744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16745
 16746
 16747 6499-EXIT.
 16748      EXIT.
 16749
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 319
* EL156.cbl
 16751 6500-READ-DLO035.
 16752     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16753     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16754     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16755     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16756
 16757
 16758* EXEC CICS LINK
 16759*        PROGRAM    ('DLO035')
 16760*        COMMAREA   (DLO035-KEY)
 16761*        LENGTH     (DL35-LENGTH)
 16762*    END-EXEC.
 16763     MOVE 'DLO035' TO DFHEIV1
 16764*    MOVE '."C                   (   #00015593' TO DFHEIV0
 16765     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16766     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16767     MOVE X'2020233030303135353933' TO DFHEIV0(25:11)
 16768     CALL 'kxdfhei1' USING DFHEIV0,
 16769           DFHEIV1,
 16770           DLO035-KEY,
 16771           DL35-LENGTH,
 16772           DFHEIV99,
 16773           DFHEIV99,
 16774           DFHEIV99,
 16775           DFHEIV99
 16776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16777
 16778
 16779     IF DL35-RETURN-CODE = 'OK'
 16780         GO TO 6500-EXIT.
 16781
 16782     IF DL35-RETURN-CODE = '01'
 16783         MOVE ER-7830            TO EMI-ERROR
 16784         GO TO 6500-BAD-EXIT.
 16785
 16786     IF DL35-RETURN-CODE = '02'
 16787         MOVE ER-7831            TO EMI-ERROR
 16788         GO TO 6500-BAD-EXIT.
 16789
 16790     IF DL35-RETURN-CODE = '03'
 16791         MOVE ER-7832            TO EMI-ERROR
 16792         GO TO 6500-BAD-EXIT.
 16793
 16794     IF DL35-RETURN-CODE = '04'
 16795         MOVE ER-7833            TO EMI-ERROR
 16796         GO TO 6500-BAD-EXIT.
 16797
 16798     IF DL35-RETURN-CODE = '05'
 16799         MOVE ER-7834            TO EMI-ERROR
 16800         GO TO 6500-BAD-EXIT.
 16801
 16802     IF DL35-RETURN-CODE = '06'
 16803         MOVE ER-7835            TO EMI-ERROR
 16804         GO TO 6500-BAD-EXIT.
 16805
 16806     IF DL35-RETURN-CODE = '07'
 16807         MOVE ER-7836            TO EMI-ERROR
 16808         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 320
* EL156.cbl
 16809
 16810     IF DL35-RETURN-CODE = 'E1'
 16811         MOVE ER-7837            TO EMI-ERROR
 16812         GO TO 6500-BAD-EXIT.
 16813
 16814     IF DL35-RETURN-CODE NOT = 'OK'
 16815         MOVE ER-7838            TO EMI-ERROR
 16816         GO TO 6500-BAD-EXIT.
 16817
 16818 6500-EXIT.
 16819      EXIT.
 16820
 16821 6500-BAD-EXIT.
 16822
 16823* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16824*    MOVE '6"R                   !   #00015642' TO DFHEIV0
 16825     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16827     MOVE X'2020233030303135363432' TO DFHEIV0(25:11)
 16828     CALL 'kxdfhei1' USING DFHEIV0
 16829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16830
 16831     MOVE -1                 TO PMTTYPEL.
 16832     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16833     GO TO 8200-SEND-DATAONLY.
 16834
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 321
* EL156.cbl
 16836 6600-UPDATE-DLO035.
 16837     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16838     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16839     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16840     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16841
 16842
 16843* EXEC CICS LINK
 16844*        PROGRAM    ('DLO035')
 16845*        COMMAREA   (DLO035-KEY)
 16846*        LENGTH     (DL35-LENGTH)
 16847*    END-EXEC.
 16848     MOVE 'DLO035' TO DFHEIV1
 16849*    MOVE '."C                   (   #00015654' TO DFHEIV0
 16850     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16851     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16852     MOVE X'2020233030303135363534' TO DFHEIV0(25:11)
 16853     CALL 'kxdfhei1' USING DFHEIV0,
 16854           DFHEIV1,
 16855           DLO035-KEY,
 16856           DL35-LENGTH,
 16857           DFHEIV99,
 16858           DFHEIV99,
 16859           DFHEIV99,
 16860           DFHEIV99
 16861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16862
 16863
 16864     IF DL35-RETURN-CODE = 'OK'
 16865         GO TO 6600-EXIT.
 16866
 16867     IF DL35-RETURN-CODE = '01'
 16868         MOVE ER-7830            TO EMI-ERROR
 16869         GO TO 6500-BAD-EXIT.
 16870
 16871     IF DL35-RETURN-CODE = '02'
 16872         MOVE ER-7831            TO EMI-ERROR
 16873         GO TO 6500-BAD-EXIT.
 16874
 16875     IF DL35-RETURN-CODE = '03'
 16876         MOVE ER-7832            TO EMI-ERROR
 16877         GO TO 6500-BAD-EXIT.
 16878
 16879     IF DL35-RETURN-CODE = '04'
 16880         MOVE ER-7833            TO EMI-ERROR
 16881         GO TO 6500-BAD-EXIT.
 16882
 16883     IF DL35-RETURN-CODE = '05'
 16884         MOVE ER-7834            TO EMI-ERROR
 16885         GO TO 6500-BAD-EXIT.
 16886
 16887     IF DL35-RETURN-CODE = '06'
 16888         MOVE ER-7835            TO EMI-ERROR
 16889         GO TO 6500-BAD-EXIT.
 16890
 16891     IF DL35-RETURN-CODE = '07'
 16892         MOVE ER-7836            TO EMI-ERROR
 16893         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 322
* EL156.cbl
 16894
 16895     IF DL35-RETURN-CODE = 'E1'
 16896         MOVE ER-7837            TO EMI-ERROR
 16897         GO TO 6500-BAD-EXIT.
 16898
 16899     IF DL35-RETURN-CODE NOT = 'OK'
 16900         MOVE ER-7838            TO EMI-ERROR
 16901         GO TO 6500-BAD-EXIT.
 16902
 16903 6600-EXIT.
 16904      EXIT.
 16905
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 323
* EL156.cbl
 16907 6700-UPDATE-ACTQ.
 16908***************************************************************
 16909*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16910*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16911*    ONE ALREADY THERE.                                       *
 16912***************************************************************
 16913
 16914
 16915* EXEC CICS HANDLE CONDITION
 16916*         NOTFND(6720-BUILD-NEW-RECORD)
 16917*     END-EXEC.
 16918*    MOVE '"$I                   ! 6 #00015710' TO DFHEIV0
 16919     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16921     MOVE X'3620233030303135373130' TO DFHEIV0(25:11)
 16922     CALL 'kxdfhei1' USING DFHEIV0
 16923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16924
 16925
 16926
 16927* EXEC CICS READ
 16928*         DATASET('ELACTQ')
 16929*         RIDFLD (ELMSTR-KEY)
 16930*         SET    (ADDRESS OF ACTIVITY-QUE)
 16931*         UPDATE
 16932*     END-EXEC.
 16933     MOVE 'ELACTQ' TO DFHEIV1
 16934*    MOVE '&"S        EU         (   #00015714' TO DFHEIV0
 16935     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16936     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16937     MOVE X'2020233030303135373134' TO DFHEIV0(25:11)
 16938     CALL 'kxdfhei1' USING DFHEIV0,
 16939           DFHEIV1,
 16940           DFHEIV20,
 16941           DFHEIV99,
 16942           ELMSTR-KEY,
 16943           DFHEIV99,
 16944           DFHEIV99,
 16945           DFHEIV99
 16946     SET ADDRESS OF ACTIVITY-QUE TO
 16947         DFHEIV20
 16948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16949
 16950
 16951     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16952
 16953     IF PI-AIG-SPECIAL-BENEFIT AND
 16954        PI-CASH = 'Y'
 16955         ADD 2                   TO AQ-PAYMENT-COUNTER
 16956     ELSE
 16957         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16958
 16959     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16960         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16961
 16962     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16963
 16964     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 324
* EL156.cbl
 16965         IF WS-PMT-APPROVAL-SW = 'A'
 16966             NEXT SENTENCE
 16967         ELSE
 16968            IF PI-AIG-SPECIAL-BENEFIT AND
 16969               PI-CASH = 'Y'
 16970                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16971                                     WS-PMT-UNAPPROVED-CNT
 16972            ELSE
 16973                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16974                                     WS-PMT-UNAPPROVED-CNT
 16975     ELSE
 16976         IF PI-PMT-APPR-SW = 'Y'
 16977            IF PI-AIG-SPECIAL-BENEFIT AND
 16978               PI-CASH = 'Y'
 16979                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16980                                     WS-PMT-UNAPPROVED-CNT
 16981            ELSE
 16982                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16983                                     WS-PMT-UNAPPROVED-CNT.
 16984
 16985     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16986         MOVE ER-3536 TO EMI-ERROR
 16987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16988
 16989     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16990
 16991
 16992* EXEC CICS REWRITE
 16993*         DATASET('ELACTQ')
 16994*         FROM   (ACTIVITY-QUE)
 16995*     END-EXEC.
 16996     MOVE LENGTH OF
 16997      ACTIVITY-QUE
 16998       TO DFHEIV11
 16999     MOVE 'ELACTQ' TO DFHEIV1
 17000*    MOVE '&& L                  %   #00015761' TO DFHEIV0
 17001     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17002     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17003     MOVE X'2020233030303135373631' TO DFHEIV0(25:11)
 17004     CALL 'kxdfhei1' USING DFHEIV0,
 17005           DFHEIV1,
 17006           ACTIVITY-QUE,
 17007           DFHEIV11,
 17008           DFHEIV99
 17009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17010
 17011
 17012     GO TO 6799-EXIT.
 17013
 17014 6720-BUILD-NEW-RECORD.
 17015
 17016* EXEC CICS GETMAIN
 17017*         SET    (ADDRESS OF ACTIVITY-QUE)
 17018*         LENGTH (60)
 17019*         INITIMG(GETMAIN-SPACE)
 17020*     END-EXEC.
 17021     MOVE 60
 17022       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 325
* EL156.cbl
 17023*    MOVE ',"IL                  $   #00015769' TO DFHEIV0
 17024     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17025     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17026     MOVE X'2020233030303135373639' TO DFHEIV0(25:11)
 17027     CALL 'kxdfhei1' USING DFHEIV0,
 17028           DFHEIV20,
 17029           DFHEIV11,
 17030           GETMAIN-SPACE
 17031     SET ADDRESS OF ACTIVITY-QUE TO
 17032         DFHEIV20
 17033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17034
 17035
 17036     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17037
 17038     IF PI-AIG-SPECIAL-BENEFIT AND
 17039        PI-CASH = 'Y'
 17040         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17041     ELSE
 17042         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17043
 17044     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17045     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17046     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17047     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17048                                    AQ-FOLLOWUP-DATE.
 17049     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17050     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17051
 17052     IF PI-PMT-GRADUATED
 17053         IF WS-PMT-APPROVAL-SW = 'A'
 17054             NEXT SENTENCE
 17055         ELSE
 17056            IF PI-AIG-SPECIAL-BENEFIT AND
 17057               PI-CASH = 'Y'
 17058                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17059            ELSE
 17060                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17061     ELSE
 17062         IF PI-PMT-APPR-SW = 'Y'
 17063            IF PI-AIG-SPECIAL-BENEFIT AND
 17064               PI-CASH = 'Y'
 17065                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17066            ELSE
 17067                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17068
 17069     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17070         MOVE ER-3536 TO EMI-ERROR
 17071         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17072
 17073
 17074* EXEC CICS WRITE
 17075*         DATASET('ELACTQ')
 17076*         RIDFLD (ELMSTR-KEY)
 17077*         FROM   (ACTIVITY-QUE)
 17078*     END-EXEC.
 17079     MOVE LENGTH OF
 17080      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 326
* EL156.cbl
 17081       TO DFHEIV11
 17082     MOVE 'ELACTQ' TO DFHEIV1
 17083*    MOVE '&$ L                  ''   #00015812' TO DFHEIV0
 17084     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17085     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17086     MOVE X'2020233030303135383132' TO DFHEIV0(25:11)
 17087     CALL 'kxdfhei1' USING DFHEIV0,
 17088           DFHEIV1,
 17089           ACTIVITY-QUE,
 17090           DFHEIV11,
 17091           ELMSTR-KEY,
 17092           DFHEIV99,
 17093           DFHEIV99
 17094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17095
 17096
 17097 6799-EXIT.
 17098      EXIT.
 17099
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 327
* EL156.cbl
 17101 6800-BUILD-FORM-TRAILER.
 17102
 17103
 17104* EXEC CICS GETMAIN
 17105*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17106*         LENGTH   (200)
 17107*         INITIMG  (GETMAIN-SPACE)
 17108*    END-EXEC.
 17109     MOVE 200
 17110       TO DFHEIV11
 17111*    MOVE ',"IL                  $   #00015824' TO DFHEIV0
 17112     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17113     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17114     MOVE X'2020233030303135383234' TO DFHEIV0(25:11)
 17115     CALL 'kxdfhei1' USING DFHEIV0,
 17116           DFHEIV20,
 17117           DFHEIV11,
 17118           GETMAIN-SPACE
 17119     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17120         DFHEIV20
 17121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17122
 17123
 17124     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17125
 17126     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17127     MOVE 'AT'                   TO AT-RECORD-ID.
 17128     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17129
 17130     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17131     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17132                                    AT-FORM-LAST-MAINT-DT
 17133                                    AT-FORM-SEND-ON-DT.
 17134     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17135                                    AT-FORM-LAST-UPDATED-BY.
 17136     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17137     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17138     MOVE '6'                    TO DC-OPTION-CODE.
 17139     MOVE +29                    TO DC-ELAPSED-DAYS.
 17140     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17141     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17142     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17143
 17144     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17145         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17146
 17147     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17148                                    AT-FORM-RE-SEND-DT
 17149                                    AT-EMP-FORM-ANSWERED-DT
 17150                                    AT-PHY-FORM-ANSWERED-DT
 17151                                    AT-EMP-FORM-SEND-ON-DT
 17152                                    AT-PHY-FORM-SEND-ON-DT
 17153                                    AT-FORM-PRINTED-DT
 17154                                    AT-FORM-REPRINT-DT.
 17155     MOVE '2'                    TO AT-FORM-TYPE.
 17156
 17157     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17158     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 328
* EL156.cbl
 17159
 17160     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17161         NEXT SENTENCE
 17162     ELSE
 17163         IF CL-PROG-FORM-TYPE NOT = 'S'
 17164            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17165
 17166
 17167* EXEC CICS WRITE
 17168*         DATASET  ('ELTRLR')
 17169*         FROM     (ACTIVITY-TRAILERS)
 17170*         RIDFLD   (AT-CONTROL-PRIMARY)
 17171*     END-EXEC.
 17172     MOVE LENGTH OF
 17173      ACTIVITY-TRAILERS
 17174       TO DFHEIV11
 17175     MOVE 'ELTRLR' TO DFHEIV1
 17176*    MOVE '&$ L                  ''   #00015872' TO DFHEIV0
 17177     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17178     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17179     MOVE X'2020233030303135383732' TO DFHEIV0(25:11)
 17180     CALL 'kxdfhei1' USING DFHEIV0,
 17181           DFHEIV1,
 17182           ACTIVITY-TRAILERS,
 17183           DFHEIV11,
 17184           AT-CONTROL-PRIMARY,
 17185           DFHEIV99,
 17186           DFHEIV99
 17187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17188
 17189
 17190 6899-EXIT.
 17191      EXIT.
 17192
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 329
* EL156.cbl
 17194 6900-BUILD-ARCHIVE-HEADER.
 17195
 17196     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17197     MOVE '1'                    TO CNTL-REC-TYPE.
 17198     MOVE +0                     TO CNTL-SEQ-NO.
 17199     MOVE SPACES                 TO CNTL-ACCESS.
 17200
 17201
 17202* EXEC CICS READ
 17203*         DATASET  ('ELCNTL')
 17204*         SET      (ADDRESS OF CONTROL-FILE)
 17205*         RIDFLD   (ELCNTL-KEY)
 17206*         UPDATE
 17207*    END-EXEC.
 17208     MOVE 'ELCNTL' TO DFHEIV1
 17209*    MOVE '&"S        EU         (   #00015889' TO DFHEIV0
 17210     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17211     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17212     MOVE X'2020233030303135383839' TO DFHEIV0(25:11)
 17213     CALL 'kxdfhei1' USING DFHEIV0,
 17214           DFHEIV1,
 17215           DFHEIV20,
 17216           DFHEIV99,
 17217           ELCNTL-KEY,
 17218           DFHEIV99,
 17219           DFHEIV99,
 17220           DFHEIV99
 17221     SET ADDRESS OF CONTROL-FILE TO
 17222         DFHEIV20
 17223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17224
 17225
 17226     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17227     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17228
 17229
 17230* EXEC CICS REWRITE
 17231*         FROM     (CONTROL-FILE)
 17232*         DATASET  ('ELCNTL')
 17233*    END-EXEC.
 17234     MOVE LENGTH OF
 17235      CONTROL-FILE
 17236       TO DFHEIV11
 17237     MOVE 'ELCNTL' TO DFHEIV1
 17238*    MOVE '&& L                  %   #00015899' TO DFHEIV0
 17239     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17240     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17241     MOVE X'2020233030303135383939' TO DFHEIV0(25:11)
 17242     CALL 'kxdfhei1' USING DFHEIV0,
 17243           DFHEIV1,
 17244           CONTROL-FILE,
 17245           DFHEIV11,
 17246           DFHEIV99
 17247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17248
 17249
 17250
 17251* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 330
* EL156.cbl
 17252*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17253*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17254*    END-EXEC.
 17255*    MOVE '"$$%                  ! 7 #00015904' TO DFHEIV0
 17256     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17258     MOVE X'3720233030303135393034' TO DFHEIV0(25:11)
 17259     CALL 'kxdfhei1' USING DFHEIV0
 17260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17261
 17262
 17263
 17264* EXEC CICS GETMAIN
 17265*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17266*         LENGTH  (ELARCH-LENGTH)
 17267*         INITIMG (GETMAIN-SPACE)
 17268*    END-EXEC.
 17269*    MOVE ',"IL                  $   #00015909' TO DFHEIV0
 17270     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17271     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17272     MOVE X'2020233030303135393039' TO DFHEIV0(25:11)
 17273     CALL 'kxdfhei1' USING DFHEIV0,
 17274           DFHEIV20,
 17275           ELARCH-LENGTH,
 17276           GETMAIN-SPACE
 17277     SET ADDRESS OF LETTER-ARCHIVE TO
 17278         DFHEIV20
 17279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17280
 17281
 17282     MOVE 'LA'                   TO LA-RECORD-ID.
 17283     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17284                                    LA-ARCHIVE-NO-A1.
 17285     MOVE '4'                    TO LA-RECORD-TYPE
 17286                                    LA-RECORD-TYPE-A1.
 17287     MOVE +0                     TO LA-LINE-SEQ-NO
 17288                                    LA-LINE-SEQ-NO-A1.
 17289     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17290                                    LA-COMPANY-CD-A1.
 17291     MOVE CL-CARRIER             TO LA4-CARRIER.
 17292     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17293     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17294     MOVE CL-CERT-STATE          TO LA4-STATE.
 17295     MOVE +0                     TO LA4-NO-OF-COPIES.
 17296     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17297     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17298     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17299                                    LA4-INITIAL-PRINT-DATE
 17300                                    LA4-RESEND-PRINT-DATE
 17301                                    LA4-FORM-REM-PRINT-DT.
 17302     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17303     MOVE '2'                    TO LA4-FORM-TYPE.
 17304
 17305
 17306* EXEC CICS WRITE
 17307*         DATASET  ('ELARCH')
 17308*         FROM     (LETTER-ARCHIVE)
 17309*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 331
* EL156.cbl
 17310*    END-EXEC.
 17311     MOVE LENGTH OF
 17312      LETTER-ARCHIVE
 17313       TO DFHEIV11
 17314     MOVE 'ELARCH' TO DFHEIV1
 17315*    MOVE '&$ L                  ''   #00015938' TO DFHEIV0
 17316     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17317     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17318     MOVE X'2020233030303135393338' TO DFHEIV0(25:11)
 17319     CALL 'kxdfhei1' USING DFHEIV0,
 17320           DFHEIV1,
 17321           LETTER-ARCHIVE,
 17322           DFHEIV11,
 17323           LA-CONTROL-PRIMARY,
 17324           DFHEIV99,
 17325           DFHEIV99
 17326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17327
 17328
 17329 6999-EXIT.
 17330      EXIT.
 17331
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 332
* EL156.cbl
 17333 7000-SHOW-CLAIM.
 17334     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17335     MOVE 'A'                    TO PI-PASS-SW.
 17336     MOVE LOW-VALUES             TO PI-CPYFROM
 17337                                    PI-MONTH-END-SAVE
 17338                                    PI-CPYTHRU.
 17339
 17340     MOVE ZEROS                  TO PI-FATAL-COUNT
 17341                                    PI-DAILY-RATE
 17342                                    PI-BEN-DAYS
 17343                                    PI-MANUAL-SW
 17344                                    PI-SAVE-CURSOR
 17345                                    PI-FORCE-COUNT
 17346                                    PI-HOLDTIL
 17347                                    PI-EPYFROM
 17348                                    PI-EPYTHRU
 17349                                    PI-EDAYS
 17350                                    PI-EPYAMT
 17351                                    PI-ERESV
 17352                                    PI-EEXPENS
 17353                                    PI-CDAYS
 17354                                    PI-CPYAMT
 17355                                    PI-CRESV
 17356                                    PI-CEXPENS
 17357                                    PI-INT-RATE
 17358                                    PI-AIGFROM.
 17359     MOVE ZEROS                  TO PI-PROOF-DATE.
 17360     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17361                                    PI-REM-BEN-AMT
 17362                                    PI-MO-BEN-AMT
 17363                                    pi-ah-term.
 17364
 17365     MOVE LOW-VALUES             TO EL156AI.
 17366     MOVE MAP-NAMEA              TO MAP-NAME.
 17367
 17368* EXEC CICS HANDLE CONDITION
 17369*        NOTFND   (7010-BUILD-MAP)
 17370*    END-EXEC.
 17371*    MOVE '"$I                   ! 8 #00015982' TO DFHEIV0
 17372     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17373     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17374     MOVE X'3820233030303135393832' TO DFHEIV0(25:11)
 17375     CALL 'kxdfhei1' USING DFHEIV0
 17376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17377
 17378
 17379     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17380     MOVE '2'                    TO CNTL-REC-TYPE.
 17381     MOVE +0                     TO CNTL-SEQ-NO.
 17382     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17383
 17384
 17385* EXEC CICS READ
 17386*         DATASET  ('ELCNTL')
 17387*         SET      (ADDRESS OF CONTROL-FILE)
 17388*         RIDFLD   (ELCNTL-KEY)
 17389*    END-EXEC.
 17390     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 333
* EL156.cbl
 17391*    MOVE '&"S        E          (   #00015991' TO DFHEIV0
 17392     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17393     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17394     MOVE X'2020233030303135393931' TO DFHEIV0(25:11)
 17395     CALL 'kxdfhei1' USING DFHEIV0,
 17396           DFHEIV1,
 17397           DFHEIV20,
 17398           DFHEIV99,
 17399           ELCNTL-KEY,
 17400           DFHEIV99,
 17401           DFHEIV99,
 17402           DFHEIV99
 17403     SET ADDRESS OF CONTROL-FILE TO
 17404         DFHEIV20
 17405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17406
 17407
 17408     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17409
 17410     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17411         MOVE AL-UANON      TO SURVYYNA
 17412     END-IF.
 17413
 17414
 17415     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17416     MOVE '1'                    TO CNTL-REC-TYPE.
 17417     MOVE SPACES                 TO CNTL-ACCESS.
 17418     MOVE +0                     TO CNTL-SEQ-NO.
 17419
 17420
 17421* EXEC CICS READ
 17422*         DATASET  ('ELCNTL')
 17423*         SET      (ADDRESS OF CONTROL-FILE)
 17424*         RIDFLD   (ELCNTL-KEY)
 17425*    END-EXEC.
 17426     MOVE 'ELCNTL' TO DFHEIV1
 17427*    MOVE '&"S        E          (   #00016009' TO DFHEIV0
 17428     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17430     MOVE X'2020233030303136303039' TO DFHEIV0(25:11)
 17431     CALL 'kxdfhei1' USING DFHEIV0,
 17432           DFHEIV1,
 17433           DFHEIV20,
 17434           DFHEIV99,
 17435           ELCNTL-KEY,
 17436           DFHEIV99,
 17437           DFHEIV99,
 17438           DFHEIV99
 17439     SET ADDRESS OF CONTROL-FILE TO
 17440         DFHEIV20
 17441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17442
 17443
 17444     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17445
 17446 7010-BUILD-MAP.
 17447
 17448
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 334
* EL156.cbl
 17449* EXEC CICS HANDLE CONDITION
 17450*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17451*    END-EXEC.
 17452*    MOVE '"$I                   ! 9 #00016019' TO DFHEIV0
 17453     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17455     MOVE X'3920233030303136303139' TO DFHEIV0(25:11)
 17456     CALL 'kxdfhei1' USING DFHEIV0
 17457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17458
 17459
 17460     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17461     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17462     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17463     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17464     MOVE 'MSTR'                 TO FILE-SWITCH.
 17465
 17466     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17467
 17468     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17469     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17470     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17471     MOVE CL-CCN                 TO PI-SV-CCN.
 17472
 17473     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17474     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17475     MOVE CL-CLAIM-NO            TO CLMNOO.
 17476     MOVE CL-CARRIER             TO CARRO.
 17477     MOVE CL-CERT-PRIME          TO CERTNOO.
 17478     MOVE CL-CERT-SFX            TO SUFXO.
 17479
 17480     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17481        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17482        CONTINUE
 17483     ELSE
 17484        MOVE AL-SADOF            TO ZINTHA
 17485                                    ZINTA
 17486                                    PINTHA
 17487                                    PINTA
 17488     END-IF
 17489     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17490     EVALUATE TRUE
 17491     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17492         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17493     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17494         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17495
 17496     WHEN CL-CLAIM-TYPE = 'I'
 17497         MOVE '  IU  '           TO CLMTYPO
 17498     WHEN CL-CLAIM-TYPE = 'G'
 17499         MOVE ' GAP  '           TO CLMTYPO
 17500     WHEN CL-CLAIM-TYPE = 'F'
 17501         MOVE ' FMLA '           TO CLMTYPO
 17502     END-EVALUATE.
 17503     IF CLAIM-IS-OPEN
 17504         MOVE ' OPEN'            TO CLMSTATO
 17505     ELSE
 17506         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 335
* EL156.cbl
 17507
 17508     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17509
 17510     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17511         MOVE SPACES             TO  PCERTNOO
 17512                                     PSUFXO
 17513                                     PRIMHDGO
 17514                                     SEQUO
 17515         MOVE AL-SADOF           TO  PCERTNOA
 17516                                     PSUFXA
 17517                                     PRIMHDGA
 17518                                     SEQUA
 17519     ELSE
 17520         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17521         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17522         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17523         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17524         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17525         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17526         MOVE AL-SANON               TO  PCERTNOA
 17527                                         PSUFXA
 17528                                         PRIMHDGA
 17529         MOVE AL-SABON               TO  SEQUA.
 17530
 17531     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17532
 17533     IF CL-NO-OF-PMTS-MADE = 0 AND
 17534        CL-TOTAL-PAID-AMT = 0
 17535         NEXT SENTENCE
 17536     ELSE
 17537         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17538             IF NOT PI-USES-PAID-TO
 17539                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17540                 MOVE ' '                 TO DC-OPTION-CODE
 17541                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17542                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17543             ELSE
 17544                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17545                 MOVE '6'                 TO DC-OPTION-CODE
 17546                 MOVE +1                  TO DC-ELAPSED-DAYS
 17547                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17548                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17549                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17550
 17551     IF MAP-NAME = 'EL156A'
 17552        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17553           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17554             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17555           end-if
 17556        end-if
 17557     end-if
 17558     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17559         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17560         MOVE ' '                TO DC-OPTION-CODE
 17561         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17562         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17563
 17564     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 336
* EL156.cbl
 17565         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17566         MOVE ' '                TO DC-OPTION-CODE
 17567         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17568         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17569
 17570     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17571
 17572     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17573         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17574         MOVE ' '                TO DC-OPTION-CODE
 17575         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17576         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17577
 17578     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17579         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17580         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17581     ELSE
 17582         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17583         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17584
 17585     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17586     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17587     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17588     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17589                                    PI-GROUPING.
 17590     MOVE CL-CERT-STATE          TO CERT-STATE
 17591                                    PI-STATE.
 17592     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17593                                    PI-ACCOUNT.
 17594     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17595     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17596     MOVE 'CERT'                 TO FILE-SWITCH.
 17597
 17598     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17599     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17600        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17601        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17602            MOVE 'N' TO PI-JOINT-INSURED-IND
 17603     ELSE
 17604            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17605     END-IF.
 17606
 17607     perform 7975-read-acct      thru 7975-exit
 17608     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17609     MOVE PI-STATE               TO WS-ST-ACCESS.
 17610     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17611     MOVE '3'                    TO CNTL-REC-TYPE.
 17612     MOVE +0                     TO CNTL-SEQ-NO.
 17613     MOVE 'STAT'                 TO FILE-SWITCH.
 17614
 17615     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17616
 17617     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17618     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17619
 17620     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17621        GO TO 7020-BYPASS-BENEFIT.
 17622
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 337
* EL156.cbl
 17623     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17624     MOVE '4'                    TO CNTL-REC-TYPE.
 17625     MOVE +0                     TO CNTL-SEQ-NO.
 17626     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17627     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17628     MOVE 'BENE'                 TO FILE-SWITCH.
 17629
 17630     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17631
 17632     IF NO-BENEFIT-FOUND
 17633        GO TO 7020-BYPASS-BENEFIT.
 17634
 17635     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17636     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17637     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17638
 17639 7020-BYPASS-BENEFIT.
 17640
 17641*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17642*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17643*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17644
 17645     move zeros                  to PI-MAX-BENEFIT-AMT
 17646     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17647     move cm-ah-orig-term        to pi-ah-term
 17648     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17649     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17650          'G' and 'F'
 17651         GO TO 7021-GO-TO-LIFE.
 17652
 17653     IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17654        and (acct-found)
 17655        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17656        PERFORM 0900-GET-DDF-limits
 17657                                 THRU 0900-EXIT
 17658        IF PDEF-FOUND
 17659           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17660              (P1 > +8)
 17661              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17662           END-PERFORM
 17663           IF P1 < +9
 17664              if pd-ben-pct (p1) not numeric
 17665                 move zeros      to pd-ben-pct (p1)
 17666              end-if
 17667              if pd-ben-pct (p1) = zeros
 17668                 move +1         to ws-work-ben-pct
 17669              else
 17670                 move pd-ben-pct (p1)
 17671                                 to ws-work-ben-pct
 17672              end-if
 17673              compute cm-ah-benefit-amt =
 17674                 cm-ah-benefit-amt * ws-work-ben-pct
 17675              move pd-max-amt (p1) to pi-max-benefit-amt
 17676           END-IF
 17677        END-IF
 17678     end-if
 17679     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17680     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 338
* EL156.cbl
 17681     if (pi-max-benefit-amt not = zeros)
 17682        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17683        move pi-max-benefit-amt  to beneo
 17684     else
 17685        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17686     end-if
 17687     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17688     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17689                                    CP-ORIGINAL-TERM.
 17690     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17691
 17692*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17693*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17694*    ELSE
 17695         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17696
 17697     MOVE ' '                    TO DC-OPTION-CODE.
 17698     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17699     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17700
 17701     IF PI-COMPANY-ID = 'DMD'
 17702         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17703         GO TO 7023-BYPASS-REMAINING-TERM.
 17704
 17705     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17706     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17707     GO TO 7022-AROUND-LIFE.
 17708
 17709 7021-GO-TO-LIFE.
 17710
 17711     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17712     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17713     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17714                                    CP-ORIGINAL-TERM.
 17715     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17716     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17717     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17718     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17719
 17720     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17721         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17722     ELSE
 17723         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17724
 17725     MOVE ' '                    TO DC-OPTION-CODE.
 17726     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17727     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17728
 17729 7022-AROUND-LIFE.
 17730
 17731     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17732     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17733     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17734     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17735     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17736     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17737     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17738
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 339
* EL156.cbl
 17739     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17740
 17741     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17742        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17743           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17744
 17745     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17746        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17747           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17748
 17749 7023-BYPASS-REMAINING-TERM.
 17750     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17751       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17752          MOVE ZEROS                  TO BENEO
 17753       ELSE
 17754          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17755          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17756          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17757          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17758          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17759          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17760          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17761          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17762          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17763          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17764          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17765          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17766          IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17767             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17768             PERFORM 0900-GET-DDF-limits
 17769                                 THRU 0900-EXIT
 17770             IF PDEF-FOUND
 17771                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17772                   (P1 > +8)
 17773                   OR (PD-PROD-CODE (P1) = 'L')
 17774                END-PERFORM
 17775                IF P1 < +9
 17776                   MOVE PD-MAX-AMT (P1)
 17777                                 TO CP-R-MAX-TOT-BEN
 17778                END-IF
 17779             END-IF
 17780          END-IF
 17781
 17782* EXEC CICS LINK
 17783*            PROGRAM  (LINK-REMAMT)
 17784*            COMMAREA (CALCULATION-PASS-AREA)
 17785*            LENGTH   (CP-COMM-LENGTH)
 17786*         END-EXEC
 17787*    MOVE '."C                   (   #00016344' TO DFHEIV0
 17788     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17789     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17790     MOVE X'2020233030303136333434' TO DFHEIV0(25:11)
 17791     CALL 'kxdfhei1' USING DFHEIV0,
 17792           LINK-REMAMT,
 17793           CALCULATION-PASS-AREA,
 17794           CP-COMM-LENGTH,
 17795           DFHEIV99,
 17796           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 340
* EL156.cbl
 17797           DFHEIV99,
 17798           DFHEIV99
 17799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17800          MOVE CP-REMAINING-AMT       TO BENEO
 17801       end-if
 17802     end-if
 17803     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17804     MOVE +95                    TO TRLR-SEQ-NO
 17805
 17806* EXEC CICS READ
 17807*       DATASET  ('ELTRLR')
 17808*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17809*       RIDFLD   (ELTRLR-KEY)
 17810*       RESP     (WS-RESPONSE)
 17811*    END-EXEC
 17812     MOVE 'ELTRLR' TO DFHEIV1
 17813*    MOVE '&"S        E          (  N#00016354' TO DFHEIV0
 17814     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17816     MOVE X'204E233030303136333534' TO DFHEIV0(25:11)
 17817     CALL 'kxdfhei1' USING DFHEIV0,
 17818           DFHEIV1,
 17819           DFHEIV20,
 17820           DFHEIV99,
 17821           ELTRLR-KEY,
 17822           DFHEIV99,
 17823           DFHEIV99,
 17824           DFHEIV99
 17825     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17826         DFHEIV20
 17827     MOVE EIBRESP  TO WS-RESPONSE
 17828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17829
 17830     if ws-resp-normal
 17831        perform varying s1 from +1 by +1 until
 17832           at-note-error-no (s1) = spaces
 17833           move at-note-error-no (s1)
 17834                                 to emi-error
 17835           if at-note-error-no (s1) = '1653'
 17836              evaluate true
 17837                 when cl-claim-type = 'L'
 17838                    move '  LF  '
 17839                                 to emi-claim-type
 17840                 when cl-claim-type = 'I'
 17841                    move '  IU  '
 17842                                 to emi-claim-type
 17843                 when cl-claim-type = 'F'
 17844                    move ' FMLA '
 17845                                 to emi-claim-type
 17846                 when other
 17847                    move '  AH  '
 17848                                 to emi-claim-type
 17849              end-evaluate
 17850           end-if
 17851           PERFORM 9900-ERROR-FORMAT
 17852                                 THRU 9900-EXIT
 17853        end-perform
 17854     end-if
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 341
* EL156.cbl
 17855     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17856         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17857            WS-LF-COVERAGE-TYPE = 'P'
 17858             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17859                                        CM-LF-ITD-DEATH-AMT
 17860             MOVE WS-REMAINING-AMT  TO  BENEO.
 17861
 17862     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17863     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17864     MOVE WS-TERMS               TO TERMSO.
 17865
 17866     IF WS-STATUS = '6' OR '7' OR '8'
 17867         MOVE AL-SABOF           TO CRTSTATA.
 17868
 17869     IF WS-STATUS = '1' OR '4'
 17870        IF CP-REMAINING-TERM-3 = ZEROS
 17871           MOVE 'EXPIRED'        TO CRTSTATO
 17872        ELSE
 17873           MOVE 'ACTIVE  '       TO CRTSTATO.
 17874
 17875     IF WS-STATUS = '2'
 17876         MOVE 'PEND    '         TO CRTSTATO.
 17877
 17878     IF WS-STATUS = '3'
 17879         MOVE 'RESTORE '         TO CRTSTATO.
 17880
 17881     IF WS-STATUS = '5'
 17882         MOVE 'REISSUE '         TO CRTSTATO.
 17883
 17884     IF WS-STATUS = '6'
 17885         MOVE 'LMP DIS'          TO CRTSTATO.
 17886
 17887     IF WS-STATUS = '7'
 17888         MOVE 'DEATH'            TO CRTSTATO.
 17889
 17890     IF WS-STATUS = '8'
 17891         MOVE 'CANCEL'           TO CRTSTATO.
 17892
 17893     IF WS-STATUS = '9'
 17894         MOVE 'RE-ONLY '         TO CRTSTATO.
 17895
 17896     IF WS-STATUS = 'V'
 17897         MOVE 'VOID  '           TO CRTSTATO.
 17898
 17899     IF WS-STATUS = 'D'
 17900         MOVE 'DECLINE '         TO CRTSTATO.
 17901
 17902     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17903         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17904         MOVE '5'                TO CNTL-REC-TYPE
 17905     ELSE
 17906         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17907         MOVE '4'                TO CNTL-REC-TYPE.
 17908
 17909     MOVE '** NONE **'           TO COVERO.
 17910     MOVE AL-SABON               TO COVERA.
 17911
 17912     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 342
* EL156.cbl
 17913         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17914             MOVE CM-BENEFICIARY TO LOANNOO
 17915             MOVE AL-UANON       TO LOANNOA.
 17916
 17917     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 17918        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17919        MOVE +91                 TO  TRLR-SEQ-NO
 17920
 17921* EXEC CICS READ
 17922*           DATASET  ('ELTRLR')
 17923*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17924*           RIDFLD   (ELTRLR-KEY)
 17925*           RESP     (WS-RESPONSE)
 17926*       END-EXEC
 17927     MOVE 'ELTRLR' TO DFHEIV1
 17928*    MOVE '&"S        E          (  N#00016451' TO DFHEIV0
 17929     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17930     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17931     MOVE X'204E233030303136343531' TO DFHEIV0(25:11)
 17932     CALL 'kxdfhei1' USING DFHEIV0,
 17933           DFHEIV1,
 17934           DFHEIV20,
 17935           DFHEIV99,
 17936           ELTRLR-KEY,
 17937           DFHEIV99,
 17938           DFHEIV99,
 17939           DFHEIV99
 17940     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17941         DFHEIV20
 17942     MOVE EIBRESP  TO WS-RESPONSE
 17943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17944
 17945        IF WS-RESP-NORMAL
 17946           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17947        ELSE
 17948           MOVE SPACES           TO  LOANNOO
 17949        END-IF
 17950*052506
 17951*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17952*052506
 17953     END-IF
 17954
 17955     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17956        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17957
 17958     IF WS-BEN-CD = ZEROS
 17959         GO TO 7050-SHOW-CONTINUE.
 17960
 17961     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17962     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17963     MOVE +0                     TO CNTL-SEQ-NO.
 17964     MOVE 'BENE'                 TO FILE-SWITCH.
 17965
 17966     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17967     IF BENEFIT-FOUND
 17968        MOVE CF-JOINT-INDICATOR (SUB-1)
 17969                                 TO PI-JOINT-COV-IND
 17970                                    PI-RB-JOINT-COV-IND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 343
* EL156.cbl
 17971        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 17972                                 TO COVERO
 17973        MOVE AL-SANON            TO COVERA
 17974     END-IF
 17975     if (cntl-rec-type = '4')   *> Life claim
 17976        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 17977        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 17978        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 17979        MOVE '5'              TO CNTL-REC-TYPE
 17980        MOVE WS-ACCESS        TO CNTL-ACCESS
 17981        MOVE +0               TO CNTL-SEQ-NO
 17982        MOVE 'BENE'           TO FILE-SWITCH
 17983        PERFORM 7200-FIND-BENEFIT
 17984                              THRU 7200-EXIT
 17985        IF (BENEFIT-FOUND)
 17986           and (pi-rb-joint-cov-ind) not = 'J'
 17987           MOVE CF-JOINT-INDICATOR (SUB-1)
 17988                              TO PI-rb-JOINT-COV-IND
 17989        end-if
 17990     end-if
 17991     .
 17992 7050-SHOW-CONTINUE.
 17993
 17994     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 17995        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 17996            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 17997     END-IF
 17998
 17999     IF PI-COMPANY-ID = 'DMD'
 18000         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18001
 18002     MOVE -1                     TO PMTTYPEL.
 18003     GO TO 8100-SEND-INITIAL-MAP.
 18004
 18005 7100-SHOW-RECORD-NOT-FOUND.
 18006     IF FILE-SWITCH = 'MSTR'
 18007         MOVE ER-0204            TO EMI-ERROR.
 18008
 18009     IF FILE-SWITCH = 'CERT'
 18010         MOVE ER-0206            TO EMI-ERROR.
 18011
 18012     IF FILE-SWITCH = 'STAT'
 18013         MOVE ER-0149            TO EMI-ERROR.
 18014
 18015     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18016
 18017     MOVE -1                     TO PMTTYPEL.
 18018     GO TO 8100-SEND-INITIAL-MAP
 18019
 18020     .
 18021 7110-BUILD-PMT-TRLR.
 18022     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18023     MOVE +51                    TO TRLR-SEQ-NO
 18024
 18025* EXEC CICS READ
 18026*        DATASET  ('ELTRLR')
 18027*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18028*        RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 344
* EL156.cbl
 18029*        RESP     (WS-RESPONSE)
 18030*    END-EXEC
 18031     MOVE 'ELTRLR' TO DFHEIV1
 18032*    MOVE '&"S        E          (  N#00016537' TO DFHEIV0
 18033     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18035     MOVE X'204E233030303136353337' TO DFHEIV0(25:11)
 18036     CALL 'kxdfhei1' USING DFHEIV0,
 18037           DFHEIV1,
 18038           DFHEIV20,
 18039           DFHEIV99,
 18040           ELTRLR-KEY,
 18041           DFHEIV99,
 18042           DFHEIV99,
 18043           DFHEIV99
 18044     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18045         DFHEIV20
 18046     MOVE EIBRESP  TO WS-RESPONSE
 18047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18048     IF WS-RESP-NORMAL
 18049        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18050     END-IF
 18051     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18052
 18053* EXEC CICS GETMAIN
 18054*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18055*         LENGTH    (200)
 18056*         INITIMG   (GETMAIN-SPACE)
 18057*     END-EXEC
 18058     MOVE 200
 18059       TO DFHEIV11
 18060*    MOVE ',"IL                  $   #00016547' TO DFHEIV0
 18061     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18062     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18063     MOVE X'2020233030303136353437' TO DFHEIV0(25:11)
 18064     CALL 'kxdfhei1' USING DFHEIV0,
 18065           DFHEIV20,
 18066           DFHEIV11,
 18067           GETMAIN-SPACE
 18068     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18069         DFHEIV20
 18070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18071     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18072                                    AT-PREV-PAID-THRU-DT
 18073     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18074     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18075     MOVE 'AT'                   TO AT-RECORD-ID
 18076     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18077     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18078     MOVE '2'                    TO AT-TRAILER-TYPE
 18079     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18080                                    AT-PAYMENT-LAST-MAINT-DT
 18081     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18082                                    AT-PAYMENT-LAST-UPDATED-BY
 18083     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18084     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18085     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18086     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 345
* EL156.cbl
 18087     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18088     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18089     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18090     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18091     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18092     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18093     if pi-int-to-rem-borr = 'Y'
 18094        move 'Q1'                to at-payee-type-cd
 18095     else
 18096        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18097     end-if
 18098     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18099     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18100     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18101     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18102     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18103                                    AT-TO-BE-WRITTEN-DT
 18104     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18105                                    AT-CHECK-QUE-SEQUENCE
 18106                                    AT-ADDL-RESERVE
 18107     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18108                                    AT-VOID-SELECT-DT
 18109                                    AT-VOID-ACCEPT-DT
 18110                                    AT-VOID-DT
 18111                                    AT-PMT-PROOF-DT
 18112                                    AT-INT-PMT-SELECT-DT
 18113     MOVE ZEROS                  TO AT-DAILY-RATE
 18114                                    AT-ELIMINATION-DAYS
 18115     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18116*    EXEC CICS HANDLE CONDITION
 18117*        DUPREC    (7120-DUPREC)
 18118*    END-EXEC
 18119     .
 18120 7115-WRITE-INT-TRLR.
 18121
 18122* EXEC CICS WRITE
 18123*         DATASET       ('ELTRLR')
 18124*         FROM          (ACTIVITY-TRAILERS)
 18125*         RIDFLD        (AT-CONTROL-PRIMARY)
 18126*         RESP          (WS-RESPONSE)
 18127*     END-EXEC
 18128     MOVE LENGTH OF
 18129      ACTIVITY-TRAILERS
 18130       TO DFHEIV11
 18131     MOVE 'ELTRLR' TO DFHEIV1
 18132*    MOVE '&$ L                  ''  N#00016602' TO DFHEIV0
 18133     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18134     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18135     MOVE X'204E233030303136363032' TO DFHEIV0(25:11)
 18136     CALL 'kxdfhei1' USING DFHEIV0,
 18137           DFHEIV1,
 18138           ACTIVITY-TRAILERS,
 18139           DFHEIV11,
 18140           AT-CONTROL-PRIMARY,
 18141           DFHEIV99,
 18142           DFHEIV99
 18143     MOVE EIBRESP  TO WS-RESPONSE
 18144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 346
* EL156.cbl
 18145      IF WS-RESP-DUPREC
 18146         GO TO 7120-DUPREC
 18147      END-IF
 18148     GO TO 7130-EXIT
 18149     .
 18150 7120-DUPREC.
 18151     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18152     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18153     GO TO 7115-WRITE-INT-TRLR
 18154     .
 18155 7130-EXIT.
 18156      EXIT.
 18157 7140-BUILD-NOTE-TRLR.
 18158
 18159
 18160* EXEC CICS GETMAIN
 18161*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18162*         LENGTH    (200)
 18163*         INITIMG   (GETMAIN-SPACE)
 18164*     END-EXEC
 18165     MOVE 200
 18166       TO DFHEIV11
 18167*    MOVE ',"IL                  $   #00016622' TO DFHEIV0
 18168     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18169     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18170     MOVE X'2020233030303136363232' TO DFHEIV0(25:11)
 18171     CALL 'kxdfhei1' USING DFHEIV0,
 18172           DFHEIV20,
 18173           DFHEIV11,
 18174           GETMAIN-SPACE
 18175     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18176         DFHEIV20
 18177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18178     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18179     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18180     MOVE 'AT'                   TO AT-RECORD-ID
 18181     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18182     MOVE '6'                    TO AT-TRAILER-TYPE
 18183     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18184                                    AT-GEN-INFO-LAST-MAINT-DT
 18185     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18186                                    AT-GEN-INFO-LAST-UPDATED-BY
 18187     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18188     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18189     .
 18190 7150-WRITE.
 18191
 18192* EXEC CICS HANDLE CONDITION
 18193*        DUPREC    (7160-DUPREC)
 18194*    END-EXEC
 18195*    MOVE '"$%                   ! : #00016640' TO DFHEIV0
 18196     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18198     MOVE X'3A20233030303136363430' TO DFHEIV0(25:11)
 18199     CALL 'kxdfhei1' USING DFHEIV0
 18200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18201
 18202* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 347
* EL156.cbl
 18203*         DATASET     ('ELTRLR')
 18204*         FROM        (ACTIVITY-TRAILERS)
 18205*         RIDFLD      (AT-CONTROL-PRIMARY)
 18206*         RESP        (WS-RESPONSE)
 18207*     END-EXEC
 18208     MOVE LENGTH OF
 18209      ACTIVITY-TRAILERS
 18210       TO DFHEIV11
 18211     MOVE 'ELTRLR' TO DFHEIV1
 18212*    MOVE '&$ L                  ''  N#00016643' TO DFHEIV0
 18213     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18214     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18215     MOVE X'204E233030303136363433' TO DFHEIV0(25:11)
 18216     CALL 'kxdfhei1' USING DFHEIV0,
 18217           DFHEIV1,
 18218           ACTIVITY-TRAILERS,
 18219           DFHEIV11,
 18220           AT-CONTROL-PRIMARY,
 18221           DFHEIV99,
 18222           DFHEIV99
 18223     MOVE EIBRESP  TO WS-RESPONSE
 18224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18225      IF WS-RESP-DUPREC
 18226         GO TO 7160-DUPREC
 18227      END-IF
 18228     GO TO 7170-EXIT
 18229     .
 18230 7160-DUPREC.
 18231     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18232     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18233     GO TO 7150-WRITE
 18234     .
 18235 7170-EXIT.
 18236      EXIT.
 18237
 18238 7180-ADD-CERT-NOTE.
 18239*ADD CERT NOTE FOR SC NP+6
 18240
 18241
 18242* EXEC CICS GETMAIN
 18243*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18244*         LENGTH    (150)
 18245*         INITIMG   (GETMAIN-SPACE)
 18246*     END-EXEC.
 18247     MOVE 150
 18248       TO DFHEIV11
 18249*    MOVE ',"IL                  $   #00016665' TO DFHEIV0
 18250     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18251     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18252     MOVE X'2020233030303136363635' TO DFHEIV0(25:11)
 18253     CALL 'kxdfhei1' USING DFHEIV0,
 18254           DFHEIV20,
 18255           DFHEIV11,
 18256           GETMAIN-SPACE
 18257     SET ADDRESS OF CERT-NOTE-FILE TO
 18258         DFHEIV20
 18259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18260
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 348
* EL156.cbl
 18261
 18262     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18263     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18264     MOVE +1                     TO WRK-NOTE-SEQ.
 18265     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18266     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18267     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18268     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18269     MOVE CL-CERT-STATE          TO CZ-STATE.
 18270     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18271     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18272     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18273     MOVE '2'                    TO CZ-RECORD-TYPE.
 18274     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18275     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18276     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18277     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18278     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18279     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18280     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18281     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18282     IF PI-COMPANY-ID = 'AHL'
 18283        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18284           CONTINUE
 18285        ELSE
 18286           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18287              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18288           ELSE
 18289              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18290           END-IF
 18291        END-IF
 18292     END-IF
 18293     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18294     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18295
 18296 7181-WRITE.
 18297
 18298
 18299* EXEC CICS WRITE
 18300*         DATASET     ('ERCNOT')
 18301*         FROM        (CERT-NOTE-FILE)
 18302*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18303*         RESP        (WS-RESPONSE)
 18304*    END-EXEC.
 18305     MOVE LENGTH OF
 18306      CERT-NOTE-FILE
 18307       TO DFHEIV11
 18308     MOVE 'ERCNOT' TO DFHEIV1
 18309*    MOVE '&$ L                  ''  N#00016707' TO DFHEIV0
 18310     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18311     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18312     MOVE X'204E233030303136373037' TO DFHEIV0(25:11)
 18313     CALL 'kxdfhei1' USING DFHEIV0,
 18314           DFHEIV1,
 18315           CERT-NOTE-FILE,
 18316           DFHEIV11,
 18317           CZ-CONTROL-PRIMARY,
 18318           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 349
* EL156.cbl
 18319           DFHEIV99
 18320     MOVE EIBRESP  TO WS-RESPONSE
 18321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18322
 18323
 18324     IF WS-RESP-DUPREC
 18325         GO TO 7182-DUPREC
 18326     END-IF.
 18327
 18328     SET CERT-NOTE-ADDED TO TRUE.
 18329
 18330     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18331         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18332     END-IF.
 18333
 18334     GO TO 7189-EXIT.
 18335
 18336 7182-DUPREC.
 18337
 18338     ADD +1                      TO  WRK-NOTE-SEQ.
 18339     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18340     GO TO 7181-WRITE.
 18341
 18342 7189-EXIT.
 18343      EXIT.
 18344
 18345 7190-ADD-ORIG-NOTE.
 18346
 18347
 18348* EXEC CICS GETMAIN
 18349*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18350*         LENGTH    (150)
 18351*         INITIMG   (GETMAIN-SPACE)
 18352*     END-EXEC.
 18353     MOVE 150
 18354       TO DFHEIV11
 18355*    MOVE ',"IL                  $   #00016737' TO DFHEIV0
 18356     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18357     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18358     MOVE X'2020233030303136373337' TO DFHEIV0(25:11)
 18359     CALL 'kxdfhei1' USING DFHEIV0,
 18360           DFHEIV20,
 18361           DFHEIV11,
 18362           GETMAIN-SPACE
 18363     SET ADDRESS OF CERT-NOTE-FILE TO
 18364         DFHEIV20
 18365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18366
 18367
 18368     ADD +1                      TO WRK-NOTE-SEQ.
 18369     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18370     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18371     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18372     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18373     MOVE CL-CERT-STATE          TO CZ-STATE.
 18374     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18375     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18376     MOVE CL-CERT-NO             TO CZ-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 350
* EL156.cbl
 18377     MOVE '2'                    TO CZ-RECORD-TYPE.
 18378     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18379     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18380     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18381     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18382     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18383     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18384
 18385 7191-WRITE.
 18386
 18387
 18388* EXEC CICS WRITE
 18389*         DATASET     ('ERCNOT')
 18390*         FROM        (CERT-NOTE-FILE)
 18391*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18392*         RESP        (WS-RESPONSE)
 18393*    END-EXEC.
 18394     MOVE LENGTH OF
 18395      CERT-NOTE-FILE
 18396       TO DFHEIV11
 18397     MOVE 'ERCNOT' TO DFHEIV1
 18398*    MOVE '&$ L                  ''  N#00016762' TO DFHEIV0
 18399     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18400     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18401     MOVE X'204E233030303136373632' TO DFHEIV0(25:11)
 18402     CALL 'kxdfhei1' USING DFHEIV0,
 18403           DFHEIV1,
 18404           CERT-NOTE-FILE,
 18405           DFHEIV11,
 18406           CZ-CONTROL-PRIMARY,
 18407           DFHEIV99,
 18408           DFHEIV99
 18409     MOVE EIBRESP  TO WS-RESPONSE
 18410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18411
 18412
 18413     IF WS-RESP-DUPREC
 18414         GO TO 7192-DUPREC
 18415     END-IF.
 18416
 18417     GO TO 7199-EXIT.
 18418
 18419 7192-DUPREC.
 18420
 18421     ADD +1                      TO  WRK-NOTE-SEQ.
 18422     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18423     GO TO 7191-WRITE.
 18424
 18425 7199-EXIT.
 18426      EXIT.
 18427 7200-FIND-BENEFIT.
 18428     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18429
 18430
 18431* EXEC CICS HANDLE CONDITION
 18432*        ENDFILE(7200-EXIT)
 18433*        NOTFND(7200-EXIT)
 18434*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 351
* EL156.cbl
 18435*    MOVE '"$''I                  ! ; #00016786' TO DFHEIV0
 18436     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18437     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18438     MOVE X'3B20233030303136373836' TO DFHEIV0(25:11)
 18439     CALL 'kxdfhei1' USING DFHEIV0
 18440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18441
 18442
 18443
 18444* EXEC CICS READ
 18445*        DATASET('ELCNTL')
 18446*        SET(ADDRESS OF CONTROL-FILE)
 18447*        RIDFLD(ELCNTL-KEY)
 18448*        GTEQ
 18449*    END-EXEC.
 18450     MOVE 'ELCNTL' TO DFHEIV1
 18451*    MOVE '&"S        G          (   #00016791' TO DFHEIV0
 18452     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18454     MOVE X'2020233030303136373931' TO DFHEIV0(25:11)
 18455     CALL 'kxdfhei1' USING DFHEIV0,
 18456           DFHEIV1,
 18457           DFHEIV20,
 18458           DFHEIV99,
 18459           ELCNTL-KEY,
 18460           DFHEIV99,
 18461           DFHEIV99,
 18462           DFHEIV99
 18463     SET ADDRESS OF CONTROL-FILE TO
 18464         DFHEIV20
 18465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18466
 18467
 18468     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18469        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18470           GO TO 7200-EXIT.
 18471
 18472     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18473         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18474            ((SUB-1 > 8) OR
 18475            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18476
 18477     IF SUB-1 NOT = 9
 18478         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18479
 18480     GO TO 7200-EXIT.
 18481
 18482 7200-BENEFIT-DUMMY.
 18483
 18484 7200-DUMMY-EXIT.
 18485     EXIT.
 18486
 18487 7200-EXIT.
 18488     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 352
* EL156.cbl
 18490*052506
 18491*052506 7250-FIND-LETTER-TRLR.
 18492*052506     EXEC CICS HANDLE CONDITION
 18493*052506         ENDFILE  (7250-END)
 18494*052506         NOTFND   (7250-END)
 18495*052506     END-EXEC.
 18496*052506
 18497*052506     EXEC CICS STARTBR
 18498*052506         DATASET   ('ELTRLR')
 18499*052506         RIDFLD    (ELTRLR-KEY)
 18500*052506         GTEQ
 18501*052506     END-EXEC.
 18502*052506
 18503*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18504*052506
 18505*052506 7250-FIND-LOOP.
 18506*052506     EXEC CICS READNEXT
 18507*052506         DATASET   ('ELTRLR')
 18508*052506         RIDFLD    (ELTRLR-KEY)
 18509*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18510*052506     END-EXEC.
 18511*052506
 18512*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18513*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18514*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18515*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18516*052506        GO TO 7250-END
 18517*052506     END-IF.
 18518*052506
 18519*052506     IF AT-TRAILER-TYPE NOT = '4'
 18520*052506         GO TO 7250-FIND-LOOP
 18521*052506     END-IF.
 18522*052506
 18523*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18524*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18525*052506     END-IF.
 18526*052506
 18527*052506     GO TO 7250-FIND-LOOP.
 18528*052506
 18529*052506 7250-END.
 18530*052506
 18531*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18532*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18533*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18534*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18535*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18536*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18537*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18538*052506     END-IF.
 18539*052506
 18540*052506     EXEC CICS ENDBR
 18541*052506          DATASET    ('ELTRLR')
 18542*052506     END-EXEC.
 18543*052506
 18544*052506 7250-EXIT.
 18545*052506     EXIT.
 18546*052506     EJECT
 18547*052506
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 353
* EL156.cbl
 18548 7300-CHECK-AUTO-ACTIVITY.
 18549
 18550     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18551         NEXT SENTENCE
 18552     ELSE
 18553         GO TO 7399-EXIT.
 18554
 18555     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18556
 18557     IF WS-ACT-REC-FOUND-SW = 'N'
 18558         GO TO 7399-EXIT.
 18559
 18560     IF PI-ACTIVITY-CODE = 09
 18561         GO TO 7300-CONT-AUTO-ACTIVITY.
 18562
 18563     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18564        (PI-ACTIVITY-CODE = 11)
 18565         GO TO 7300-CONT-AUTO-ACTIVITY.
 18566
 18567     IF PI-PROVISIONAL-IND = 'P'
 18568         IF PI-PMTTYPE = '1'
 18569             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18570                 MOVE 'N'    TO  PI-RESET-SW
 18571                 GO TO 7399-EXIT.
 18572
 18573     IF PI-PMTTYPE = '1'
 18574         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18575             MOVE 'N'        TO  PI-RESET-SW
 18576             GO TO 7399-EXIT.
 18577
 18578     IF PI-PMTTYPE = '2' OR '3'
 18579         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18580             MOVE 'N'        TO  PI-RESET-SW
 18581             GO TO 7399-EXIT.
 18582
 18583     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18584         IF PI-PROVISIONAL-IND = 'P'
 18585             NEXT SENTENCE
 18586         ELSE
 18587             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18588
 18589 7300-CONT-AUTO-ACTIVITY.
 18590
 18591     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18592         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18593         MOVE '4'            TO DC-OPTION-CODE
 18594         MOVE +0             TO DC-ELAPSED-DAYS
 18595                                DC-ELAPSED-MONTHS
 18596         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18597         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18598         IF PI-USES-PAID-TO
 18599             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18600             IF NO-CONVERSION-ERROR
 18601                 MOVE +1     TO DC-ELAPSED-DAYS
 18602                 MOVE +0     TO DC-ELAPSED-MONTHS
 18603                 MOVE '6'    TO DC-OPTION-CODE
 18604                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18605                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 354
* EL156.cbl
 18606                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18607
 18608     IF PI-PFKEY-USED = DFHPF5
 18609         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18610         IF PI-USES-PAID-TO
 18611             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18612             MOVE +1                  TO DC-ELAPSED-DAYS
 18613             MOVE +0                  TO DC-ELAPSED-MONTHS
 18614             MOVE '6'                 TO DC-OPTION-CODE
 18615             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18616             IF NO-CONVERSION-ERROR
 18617                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18618
 18619     IF WS-CHK-THRU-DT < PI-EXP-DT
 18620         NEXT SENTENCE
 18621     ELSE
 18622         MOVE 03                     TO  WS-ACTIVITY-CODE
 18623         GO TO 7390-PROCESS-ACTIVITY.
 18624
 18625     IF PI-PROV-PMT
 18626         MOVE 09                     TO  WS-ACTIVITY-CODE
 18627     ELSE
 18628        IF PI-PMTTYPE = '1'
 18629            MOVE 02                  TO  WS-ACTIVITY-CODE
 18630        ELSE
 18631        IF PI-PMTTYPE = '2' OR '3'
 18632            MOVE 07                  TO  WS-ACTIVITY-CODE
 18633        ELSE
 18634        IF PI-PMTTYPE = '4'
 18635            MOVE 00                  TO  WS-ACTIVITY-CODE
 18636        ELSE
 18637            MOVE 'N'                 TO  PI-RESET-SW
 18638            GO TO 7399-EXIT.
 18639
 18640 7390-PROCESS-ACTIVITY.
 18641
 18642     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18643
 18644 7399-EXIT.
 18645     EXIT.
 18646
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 355
* EL156.cbl
 18648 7400-CHECK-AUTO-ACTIVITY.
 18649
 18650
 18651* EXEC CICS HANDLE CONDITION
 18652*        NOTFND   (7400-NOT-FOUND)
 18653*    END-EXEC.
 18654*    MOVE '"$I                   ! < #00016980' TO DFHEIV0
 18655     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18657     MOVE X'3C20233030303136393830' TO DFHEIV0(25:11)
 18658     CALL 'kxdfhei1' USING DFHEIV0
 18659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18660
 18661
 18662     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18663     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18664     MOVE SPACES                 TO  CNTL-ACCESS.
 18665     MOVE +0                     TO  CNTL-SEQ-NO.
 18666
 18667
 18668* EXEC CICS READ
 18669*        DATASET   ('ELCNTL')
 18670*        RIDFLD    (ELCNTL-KEY)
 18671*        SET       (ADDRESS OF CONTROL-FILE)
 18672*    END-EXEC.
 18673     MOVE 'ELCNTL' TO DFHEIV1
 18674*    MOVE '&"S        E          (   #00016989' TO DFHEIV0
 18675     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18677     MOVE X'2020233030303136393839' TO DFHEIV0(25:11)
 18678     CALL 'kxdfhei1' USING DFHEIV0,
 18679           DFHEIV1,
 18680           DFHEIV20,
 18681           DFHEIV99,
 18682           ELCNTL-KEY,
 18683           DFHEIV99,
 18684           DFHEIV99,
 18685           DFHEIV99
 18686     SET ADDRESS OF CONTROL-FILE TO
 18687         DFHEIV20
 18688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18689
 18690
 18691     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18692     GO TO 7400-EXIT.
 18693
 18694 7400-NOT-FOUND.
 18695     MOVE 'N'                        TO  PI-RESET-SW
 18696                                         WS-LETTER-SW
 18697                                         WS-ACT-REC-FOUND-SW.
 18698
 18699     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18700
 18701 7400-EXIT.
 18702     EXIT.
 18703
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 356
* EL156.cbl
 18705 7450-FORMAT-AUTO-LETTER.
 18706
 18707     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18708         MOVE 'Y'                    TO PI-RESET-SW
 18709         GO TO 7450-CONTINUE-PROCESS.
 18710
 18711     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18712
 18713     IF SUB > 9
 18714         SUBTRACT 9 FROM SUB
 18715         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18716     ELSE
 18717         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18718
 18719 7450-CONTINUE-PROCESS.
 18720
 18721     IF WS-ACTIVITY-CODE = ZEROS
 18722         MOVE 'N'                    TO  WS-LETTER-SW
 18723         GO TO 7450-EXIT.
 18724
 18725     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18726
 18727     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18728         MOVE 'N'                    TO  PI-RESET-SW
 18729                                         WS-LETTER-SW
 18730         GO TO 7450-EXIT.
 18731
 18732     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18733         MOVE 'N'                    TO  WS-LETTER-SW
 18734         GO TO 7450-EXIT.
 18735
 18736     MOVE 'Y'                        TO  WS-LETTER-SW.
 18737     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18738     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18739
 18740     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18741
 18742     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18743         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18744         MOVE '6'                    TO  DC-OPTION-CODE
 18745         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18746         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18747         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18748         IF NO-CONVERSION-ERROR
 18749             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18750         ELSE
 18751              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18752
 18753     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18754         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18755         MOVE '6'                    TO  DC-OPTION-CODE
 18756         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18757         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18758         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18759         IF NO-CONVERSION-ERROR
 18760             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18761         ELSE
 18762             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 357
* EL156.cbl
 18763
 18764 7450-EXIT.
 18765     EXIT.
 18766
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 358
* EL156.cbl
 18768 7500-RESET-AUTO-ACTIVITY.
 18769
 18770     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18771     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18772     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18773     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18774     MOVE +100                   TO  TRLR-SEQ-NO.
 18775
 18776 7500-STARTBR-TRLR.
 18777
 18778
 18779* EXEC CICS HANDLE CONDITION
 18780*        ENDFILE  (7590-END)
 18781*        NOTFND   (7590-END)
 18782*    END-EXEC.
 18783*    MOVE '"$''I                  ! = #00017082' TO DFHEIV0
 18784     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18786     MOVE X'3D20233030303137303832' TO DFHEIV0(25:11)
 18787     CALL 'kxdfhei1' USING DFHEIV0
 18788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18789
 18790
 18791
 18792* EXEC CICS STARTBR
 18793*        DATASET   ('ELTRLR')
 18794*        RIDFLD    (ELTRLR-KEY)
 18795*        GTEQ
 18796*    END-EXEC.
 18797     MOVE 'ELTRLR' TO DFHEIV1
 18798     MOVE 0
 18799       TO DFHEIV11
 18800*    MOVE '&,         G          &   #00017087' TO DFHEIV0
 18801     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18802     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18803     MOVE X'2020233030303137303837' TO DFHEIV0(25:11)
 18804     CALL 'kxdfhei1' USING DFHEIV0,
 18805           DFHEIV1,
 18806           ELTRLR-KEY,
 18807           DFHEIV99,
 18808           DFHEIV11,
 18809           DFHEIV99
 18810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18811
 18812
 18813     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18814
 18815 7500-READ-NEXT.
 18816
 18817
 18818* EXEC CICS READNEXT
 18819*        DATASET   ('ELTRLR')
 18820*        RIDFLD    (ELTRLR-KEY)
 18821*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18822*    END-EXEC.
 18823     MOVE 'ELTRLR' TO DFHEIV1
 18824     MOVE 0
 18825       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 359
* EL156.cbl
 18826*    MOVE '&.S                   )   #00017097' TO DFHEIV0
 18827     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18828     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18829     MOVE X'2020233030303137303937' TO DFHEIV0(25:11)
 18830     CALL 'kxdfhei1' USING DFHEIV0,
 18831           DFHEIV1,
 18832           DFHEIV20,
 18833           DFHEIV99,
 18834           ELTRLR-KEY,
 18835           DFHEIV99,
 18836           DFHEIV11,
 18837           DFHEIV99,
 18838           DFHEIV99
 18839     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18840         DFHEIV20
 18841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18842
 18843
 18844     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18845        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18846        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18847        PI-CERT-NO    NOT = TRLR-CERT-NO
 18848         GO TO 7590-END.
 18849
 18850     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18851         GO TO 7500-READ-NEXT.
 18852
 18853     IF AT-TRAILER-TYPE NOT = '4'
 18854         GO TO 7500-READ-NEXT.
 18855
 18856     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18857         GO TO 7500-READ-NEXT.
 18858
 18859     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18860        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18861         GO TO 7500-READ-NEXT.
 18862
 18863     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18864        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18865        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18866         GO TO 7500-READ-NEXT.
 18867
 18868     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18869                         AND
 18870        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18871                         AND
 18872        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18873            GO TO 7500-READ-NEXT.
 18874
 18875     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18876
 18877
 18878* EXEC CICS ENDBR
 18879*        DATASET   ('ELTRLR')
 18880*    END-EXEC.
 18881     MOVE 'ELTRLR' TO DFHEIV1
 18882     MOVE 0
 18883       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 360
* EL156.cbl
 18884*    MOVE '&2                    $   #00017136' TO DFHEIV0
 18885     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18886     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18887     MOVE X'2020233030303137313336' TO DFHEIV0(25:11)
 18888     CALL 'kxdfhei1' USING DFHEIV0,
 18889           DFHEIV1,
 18890           DFHEIV11,
 18891           DFHEIV99
 18892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18893
 18894
 18895     MOVE 'N'                        TO  WS-BROWSE-SW.
 18896
 18897
 18898* EXEC CICS READ
 18899*        DATASET   ('ELTRLR')
 18900*        RIDFLD    (ELTRLR-KEY)
 18901*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18902*        UPDATE
 18903*    END-EXEC.
 18904     MOVE 'ELTRLR' TO DFHEIV1
 18905*    MOVE '&"S        EU         (   #00017142' TO DFHEIV0
 18906     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18907     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18908     MOVE X'2020233030303137313432' TO DFHEIV0(25:11)
 18909     CALL 'kxdfhei1' USING DFHEIV0,
 18910           DFHEIV1,
 18911           DFHEIV20,
 18912           DFHEIV99,
 18913           ELTRLR-KEY,
 18914           DFHEIV99,
 18915           DFHEIV99,
 18916           DFHEIV99
 18917     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18918         DFHEIV20
 18919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18920
 18921
 18922     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18923
 18924     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18925         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18926     ELSE
 18927         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18928             NEXT SENTENCE
 18929         ELSE
 18930             GO TO 7500-REWRITE-TRLR.
 18931
 18932     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18933
 18934     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18935     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18936     MOVE '1'                        TO  ARCH-REC-TYPE.
 18937     MOVE +0                         TO  ARCH-SEQ.
 18938
 18939     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18940
 18941 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 361
* EL156.cbl
 18942
 18943
 18944* EXEC CICS REWRITE
 18945*        DATASET   ('ELTRLR')
 18946*        FROM      (ACTIVITY-TRAILERS)
 18947*    END-EXEC.
 18948     MOVE LENGTH OF
 18949      ACTIVITY-TRAILERS
 18950       TO DFHEIV11
 18951     MOVE 'ELTRLR' TO DFHEIV1
 18952*    MOVE '&& L                  %   #00017170' TO DFHEIV0
 18953     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18954     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18955     MOVE X'2020233030303137313730' TO DFHEIV0(25:11)
 18956     CALL 'kxdfhei1' USING DFHEIV0,
 18957           DFHEIV1,
 18958           ACTIVITY-TRAILERS,
 18959           DFHEIV11,
 18960           DFHEIV99
 18961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18962
 18963
 18964     GO TO 7500-STARTBR-TRLR.
 18965
 18966 7590-END.
 18967
 18968     IF WS-BROWSE-SW = 'Y'
 18969         MOVE 'N'                    TO  WS-BROWSE-SW
 18970
 18971* EXEC CICS ENDBR
 18972*            DATASET   ('ELTRLR')
 18973*        END-EXEC.
 18974     MOVE 'ELTRLR' TO DFHEIV1
 18975     MOVE 0
 18976       TO DFHEIV11
 18977*    MOVE '&2                    $   #00017181' TO DFHEIV0
 18978     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18979     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18980     MOVE X'2020233030303137313831' TO DFHEIV0(25:11)
 18981     CALL 'kxdfhei1' USING DFHEIV0,
 18982           DFHEIV1,
 18983           DFHEIV11,
 18984           DFHEIV99
 18985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18986
 18987
 18988 7599-EXIT.
 18989     EXIT.
 18990
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 362
* EL156.cbl
 18992 7600-READ-ARCH-UPDATE.
 18993
 18994
 18995* EXEC CICS HANDLE CONDITION
 18996*        NOTFND   (7699-EXIT)
 18997*    END-EXEC.
 18998*    MOVE '"$I                   ! > #00017191' TO DFHEIV0
 18999     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19001     MOVE X'3E20233030303137313931' TO DFHEIV0(25:11)
 19002     CALL 'kxdfhei1' USING DFHEIV0
 19003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19004
 19005
 19006
 19007* EXEC CICS READ
 19008*        DATASET   ('ELARCH')
 19009*        RIDFLD    (ELARCH-KEY)
 19010*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19011*        UPDATE
 19012*    END-EXEC.
 19013     MOVE 'ELARCH' TO DFHEIV1
 19014*    MOVE '&"S        EU         (   #00017195' TO DFHEIV0
 19015     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19016     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19017     MOVE X'2020233030303137313935' TO DFHEIV0(25:11)
 19018     CALL 'kxdfhei1' USING DFHEIV0,
 19019           DFHEIV1,
 19020           DFHEIV20,
 19021           DFHEIV99,
 19022           ELARCH-KEY,
 19023           DFHEIV99,
 19024           DFHEIV99,
 19025           DFHEIV99
 19026     SET ADDRESS OF LETTER-ARCHIVE TO
 19027         DFHEIV20
 19028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19029
 19030
 19031     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19032
 19033
 19034* EXEC CICS REWRITE
 19035*        DATASET   ('ELARCH')
 19036*        FROM      (LETTER-ARCHIVE)
 19037*    END-EXEC.
 19038     MOVE LENGTH OF
 19039      LETTER-ARCHIVE
 19040       TO DFHEIV11
 19041     MOVE 'ELARCH' TO DFHEIV1
 19042*    MOVE '&& L                  %   #00017204' TO DFHEIV0
 19043     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19044     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19045     MOVE X'2020233030303137323034' TO DFHEIV0(25:11)
 19046     CALL 'kxdfhei1' USING DFHEIV0,
 19047           DFHEIV1,
 19048           LETTER-ARCHIVE,
 19049           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 363
* EL156.cbl
 19050           DFHEIV99
 19051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19052
 19053
 19054 7699-EXIT.
 19055     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 364
* EL156.cbl
 19057 7700-GET-DCT.
 19058
 19059     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19060     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19061     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19062     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19063                                    PI-MAX-BENEFIT-AMT
 19064                                    PI-MAX-BENEFIT-PYMT
 19065                                    PI-MIN-PAYMENT-AMT
 19066                                    PI-TIME-OF-LOSS-BAL.
 19067
 19068
 19069* EXEC CICS HANDLE CONDITION
 19070*         NOTFND (5300-NOTE-NOT-FOUND)
 19071*     END-EXEC.
 19072*    MOVE '"$I                   ! ? #00017223' TO DFHEIV0
 19073     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19075     MOVE X'3F20233030303137323233' TO DFHEIV0(25:11)
 19076     CALL 'kxdfhei1' USING DFHEIV0
 19077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19078
 19079
 19080
 19081* EXEC CICS READ
 19082*         DATASET('ERNOTE')
 19083*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19084*         RIDFLD (W-NOTE-KEY)
 19085*     END-EXEC.
 19086     MOVE 'ERNOTE' TO DFHEIV1
 19087*    MOVE '&"S        E          (   #00017227' TO DFHEIV0
 19088     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19090     MOVE X'2020233030303137323237' TO DFHEIV0(25:11)
 19091     CALL 'kxdfhei1' USING DFHEIV0,
 19092           DFHEIV1,
 19093           DFHEIV20,
 19094           DFHEIV99,
 19095           W-NOTE-KEY,
 19096           DFHEIV99,
 19097           DFHEIV99,
 19098           DFHEIV99
 19099     SET ADDRESS OF CERTIFICATE-NOTE TO
 19100         DFHEIV20
 19101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19102
 19103
 19104     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19105     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19106     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19107     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19108     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19109
 19110     IF PI-PAYEE-TYPE NOT = 'B'
 19111         GO TO 7700-EXIT.
 19112
 19113     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19114     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 365
* EL156.cbl
 19115     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19116
 19117     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19118         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19119     ELSE
 19120         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19121
 19122     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19123     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19124     MOVE 'DLO006'               TO PGM-NAME.
 19125
 19126
 19127* EXEC CICS LINK
 19128*        PROGRAM    (PGM-NAME)
 19129*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19130*        LENGTH     (DCT-RCRD-LENGTH)
 19131*    END-EXEC.
 19132*    MOVE '."C                   (   #00017255' TO DFHEIV0
 19133     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19135     MOVE X'2020233030303137323535' TO DFHEIV0(25:11)
 19136     CALL 'kxdfhei1' USING DFHEIV0,
 19137           PGM-NAME,
 19138           DCT-COMMUNICATION-AREA,
 19139           DCT-RCRD-LENGTH,
 19140           DFHEIV99,
 19141           DFHEIV99,
 19142           DFHEIV99,
 19143           DFHEIV99
 19144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19145
 19146
 19147     IF DCT-RETURN-CODE = 'OK'
 19148         GO TO 7700-CONT.
 19149
 19150     IF DCT-RETURN-CODE = '01' OR '02'
 19151         GO TO 7700-SET-TO-YES.
 19152
 19153     IF DCT-RETURN-CODE = '03'
 19154
 19155* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19156*    MOVE '6"R                   !   #00017268' TO DFHEIV0
 19157     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19159     MOVE X'2020233030303137323638' TO DFHEIV0(25:11)
 19160     CALL 'kxdfhei1' USING DFHEIV0
 19161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19162         MOVE ER-0951            TO EMI-ERROR
 19163         MOVE -1                 TO PMTTYPEL
 19164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19165         GO TO 8200-SEND-DATAONLY.
 19166
 19167     IF DCT-RETURN-CODE = '04'
 19168
 19169* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19170*    MOVE '6"R                   !   #00017275' TO DFHEIV0
 19171     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 366
* EL156.cbl
 19173     MOVE X'2020233030303137323735' TO DFHEIV0(25:11)
 19174     CALL 'kxdfhei1' USING DFHEIV0
 19175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19176         MOVE ER-0946            TO EMI-ERROR
 19177         MOVE -1                 TO PMTTYPEL
 19178         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19179         GO TO 8200-SEND-DATAONLY.
 19180
 19181     IF DCT-RETURN-CODE = '05'
 19182
 19183* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19184*    MOVE '6"R                   !   #00017282' TO DFHEIV0
 19185     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19186     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19187     MOVE X'2020233030303137323832' TO DFHEIV0(25:11)
 19188     CALL 'kxdfhei1' USING DFHEIV0
 19189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19190         MOVE ER-0947            TO EMI-ERROR
 19191         MOVE -1                 TO PMTTYPEL
 19192         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19193         GO TO 8200-SEND-DATAONLY.
 19194
 19195     IF DCT-RETURN-CODE = '06'
 19196
 19197* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19198*    MOVE '6"R                   !   #00017289' TO DFHEIV0
 19199     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19201     MOVE X'2020233030303137323839' TO DFHEIV0(25:11)
 19202     CALL 'kxdfhei1' USING DFHEIV0
 19203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19204         MOVE ER-0921            TO EMI-ERROR
 19205         MOVE -1                 TO PMTTYPEL
 19206         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19207         GO TO 8200-SEND-DATAONLY.
 19208
 19209     IF DCT-RETURN-CODE = '07'
 19210
 19211* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19212*    MOVE '6"R                   !   #00017296' TO DFHEIV0
 19213     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19215     MOVE X'2020233030303137323936' TO DFHEIV0(25:11)
 19216     CALL 'kxdfhei1' USING DFHEIV0
 19217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19218         MOVE ER-0919            TO EMI-ERROR
 19219         MOVE -1                 TO PMTTYPEL
 19220         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19221         GO TO 8200-SEND-DATAONLY.
 19222
 19223     IF DCT-RETURN-CODE = '08'
 19224
 19225* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19226*    MOVE '6"R                   !   #00017303' TO DFHEIV0
 19227     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19229     MOVE X'2020233030303137333033' TO DFHEIV0(25:11)
 19230     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 367
* EL156.cbl
 19231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19232         MOVE ER-0948            TO EMI-ERROR
 19233         MOVE -1                 TO PMTTYPEL
 19234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19235         GO TO 8200-SEND-DATAONLY.
 19236
 19237     IF DCT-RETURN-CODE = 'N1'
 19238
 19239* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19240*    MOVE '6"R                   !   #00017310' TO DFHEIV0
 19241     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19243     MOVE X'2020233030303137333130' TO DFHEIV0(25:11)
 19244     CALL 'kxdfhei1' USING DFHEIV0
 19245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19246         MOVE ER-0950            TO EMI-ERROR
 19247         MOVE -1                 TO PMTTYPEL
 19248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19249         GO TO 8200-SEND-DATAONLY.
 19250
 19251     IF DCT-RETURN-CODE = 'E1'
 19252
 19253* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19254*    MOVE '6"R                   !   #00017317' TO DFHEIV0
 19255     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19256     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19257     MOVE X'2020233030303137333137' TO DFHEIV0(25:11)
 19258     CALL 'kxdfhei1' USING DFHEIV0
 19259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19260         MOVE ER-0974            TO EMI-ERROR
 19261         MOVE -1                 TO PMTTYPEL
 19262         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19263         GO TO 8200-SEND-DATAONLY.
 19264
 19265     IF DCT-RETURN-CODE = 'E2'
 19266
 19267* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19268*    MOVE '6"R                   !   #00017324' TO DFHEIV0
 19269     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19271     MOVE X'2020233030303137333234' TO DFHEIV0(25:11)
 19272     CALL 'kxdfhei1' USING DFHEIV0
 19273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19274         MOVE ER-0975            TO EMI-ERROR
 19275         MOVE -1                 TO PMTTYPEL
 19276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19277         GO TO 8200-SEND-DATAONLY.
 19278
 19279     IF DCT-RETURN-CODE NOT = 'OK'
 19280
 19281* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19282*    MOVE '6"R                   !   #00017331' TO DFHEIV0
 19283     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19285     MOVE X'2020233030303137333331' TO DFHEIV0(25:11)
 19286     CALL 'kxdfhei1' USING DFHEIV0
 19287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19288         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 368
* EL156.cbl
 19289         MOVE -1                 TO PMTTYPEL
 19290         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19291         GO TO 8200-SEND-DATAONLY.
 19292
 19293 7700-CONT.
 19294
 19295*    MOVE 'N'                    TO CASHO.
 19296*    MOVE +1                     TO CASHL.
 19297*    MOVE AL-UANON               TO CASHA.
 19298
 19299     IF PI-OFFLINE = 'Y'
 19300         GO TO 7700-EXIT.
 19301
 19302     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19303     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19304     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19305     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19306     MOVE +7                     TO CHECKNOL.
 19307     MOVE AL-UANON               TO CHECKNOA.
 19308     GO TO 7700-EXIT.
 19309
 19310 7700-SET-TO-YES.
 19311
 19312*    MOVE 'Y'                    TO CASHO.
 19313*    MOVE +1                     TO CASHL.
 19314*    MOVE AL-UANON               TO CASHA.
 19315
 19316 7700-EXIT.
 19317     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 369
* EL156.cbl
 19319 7800-READ-COMP-MSTR.
 19320
 19321
 19322* EXEC CICS HANDLE CONDITION
 19323*        NOTFND   (7800-COMP-NOTFND)
 19324*    END-EXEC.
 19325*    MOVE '"$I                   ! @ #00017365' TO DFHEIV0
 19326     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19328     MOVE X'4020233030303137333635' TO DFHEIV0(25:11)
 19329     CALL 'kxdfhei1' USING DFHEIV0
 19330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19331
 19332
 19333
 19334* EXEC CICS READ
 19335*        DATASET   ('ERCOMP')
 19336*        RIDFLD    (ERCOMP-KEY)
 19337*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19338*    END-EXEC.
 19339     MOVE 'ERCOMP' TO DFHEIV1
 19340*    MOVE '&"S        E          (   #00017369' TO DFHEIV0
 19341     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19343     MOVE X'2020233030303137333639' TO DFHEIV0(25:11)
 19344     CALL 'kxdfhei1' USING DFHEIV0,
 19345           DFHEIV1,
 19346           DFHEIV20,
 19347           DFHEIV99,
 19348           ERCOMP-KEY,
 19349           DFHEIV99,
 19350           DFHEIV99,
 19351           DFHEIV99
 19352     SET ADDRESS OF COMPENSATION-MASTER TO
 19353         DFHEIV20
 19354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19355
 19356
 19357     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19358     GO TO 7800-COMP-EXIT.
 19359
 19360 7800-COMP-NOTFND.
 19361     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19362
 19363 7800-COMP-EXIT.
 19364     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 370
* EL156.cbl
 19366 7900-READ-CLAIM.
 19367
 19368* EXEC CICS READ
 19369*        DATASET  ('ELMSTR')
 19370*        SET      (ADDRESS OF CLAIM-MASTER)
 19371*        RIDFLD   (ELMSTR-KEY)
 19372*    END-EXEC.
 19373     MOVE 'ELMSTR' TO DFHEIV1
 19374*    MOVE '&"S        E          (   #00017385' TO DFHEIV0
 19375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19377     MOVE X'2020233030303137333835' TO DFHEIV0(25:11)
 19378     CALL 'kxdfhei1' USING DFHEIV0,
 19379           DFHEIV1,
 19380           DFHEIV20,
 19381           DFHEIV99,
 19382           ELMSTR-KEY,
 19383           DFHEIV99,
 19384           DFHEIV99,
 19385           DFHEIV99
 19386     SET ADDRESS OF CLAIM-MASTER TO
 19387         DFHEIV20
 19388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19389
 19390
 19391 7900-EXIT.
 19392      EXIT.
 19393
 19394 7910-READ-CLAIM-UPDATE.
 19395
 19396* EXEC CICS READ
 19397*        DATASET  ('ELMSTR')
 19398*        SET      (ADDRESS OF CLAIM-MASTER)
 19399*        RIDFLD   (ELMSTR-KEY)
 19400*        UPDATE
 19401*    END-EXEC.
 19402     MOVE 'ELMSTR' TO DFHEIV1
 19403*    MOVE '&"S        EU         (   #00017395' TO DFHEIV0
 19404     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19405     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19406     MOVE X'2020233030303137333935' TO DFHEIV0(25:11)
 19407     CALL 'kxdfhei1' USING DFHEIV0,
 19408           DFHEIV1,
 19409           DFHEIV20,
 19410           DFHEIV99,
 19411           ELMSTR-KEY,
 19412           DFHEIV99,
 19413           DFHEIV99,
 19414           DFHEIV99
 19415     SET ADDRESS OF CLAIM-MASTER TO
 19416         DFHEIV20
 19417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19418
 19419
 19420 7910-EXIT.
 19421      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 371
* EL156.cbl
 19423 7920-READ-BENE.
 19424     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19425     MOVE 'B'                TO BENE-RECORD-TYPE.
 19426     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19427
 19428     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19429        IF PI-PAYEE-TYPE    = 'B' AND
 19430           PI-PAYEE-SEQ-NUM = 9
 19431             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19432             MOVE WS-A-BENE           TO BENE-NUMBER.
 19433
 19434
 19435* EXEC CICS HANDLE CONDITION
 19436*        NOTFND   (7920-NOT-FOUND)
 19437*    END-EXEC.
 19438*    MOVE '"$I                   ! A #00017416' TO DFHEIV0
 19439     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19441     MOVE X'4120233030303137343136' TO DFHEIV0(25:11)
 19442     CALL 'kxdfhei1' USING DFHEIV0
 19443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19444
 19445
 19446
 19447* EXEC CICS READ
 19448*        DATASET  ('ELBENE')
 19449*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19450*        RIDFLD   (ELBENE-KEY)
 19451*    END-EXEC.
 19452     MOVE 'ELBENE' TO DFHEIV1
 19453*    MOVE '&"S        E          (   #00017420' TO DFHEIV0
 19454     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19456     MOVE X'2020233030303137343230' TO DFHEIV0(25:11)
 19457     CALL 'kxdfhei1' USING DFHEIV0,
 19458           DFHEIV1,
 19459           DFHEIV20,
 19460           DFHEIV99,
 19461           ELBENE-KEY,
 19462           DFHEIV99,
 19463           DFHEIV99,
 19464           DFHEIV99
 19465     SET ADDRESS OF BENEFICIARY-MASTER TO
 19466         DFHEIV20
 19467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19468
 19469
 19470     MOVE 'Y' TO BENE-FOUND-SW.
 19471     GO TO 7920-EXIT.
 19472
 19473 7920-NOT-FOUND.
 19474     MOVE 'N'                    TO BENE-FOUND-SW.
 19475
 19476 7920-EXIT.
 19477      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 372
* EL156.cbl
 19479 7930-READ-CONTROL.
 19480
 19481* EXEC CICS READ
 19482*        DATASET  ('ELCNTL')
 19483*        SET      (ADDRESS OF CONTROL-FILE)
 19484*        RIDFLD   (ELCNTL-KEY)
 19485*    END-EXEC.
 19486     MOVE 'ELCNTL' TO DFHEIV1
 19487*    MOVE '&"S        E          (   #00017436' TO DFHEIV0
 19488     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19490     MOVE X'2020233030303137343336' TO DFHEIV0(25:11)
 19491     CALL 'kxdfhei1' USING DFHEIV0,
 19492           DFHEIV1,
 19493           DFHEIV20,
 19494           DFHEIV99,
 19495           ELCNTL-KEY,
 19496           DFHEIV99,
 19497           DFHEIV99,
 19498           DFHEIV99
 19499     SET ADDRESS OF CONTROL-FILE TO
 19500         DFHEIV20
 19501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19502
 19503
 19504 7930-EXIT.
 19505      EXIT.
 19506
 19507 7940-READ-CONTROL-UPDATE.
 19508
 19509* EXEC CICS READ
 19510*        DATASET  ('ELCNTL')
 19511*        SET      (ADDRESS OF CONTROL-FILE)
 19512*        RIDFLD   (ELCNTL-KEY)
 19513*        UPDATE
 19514*    END-EXEC.
 19515     MOVE 'ELCNTL' TO DFHEIV1
 19516*    MOVE '&"S        EU         (   #00017446' TO DFHEIV0
 19517     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19518     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19519     MOVE X'2020233030303137343436' TO DFHEIV0(25:11)
 19520     CALL 'kxdfhei1' USING DFHEIV0,
 19521           DFHEIV1,
 19522           DFHEIV20,
 19523           DFHEIV99,
 19524           ELCNTL-KEY,
 19525           DFHEIV99,
 19526           DFHEIV99,
 19527           DFHEIV99
 19528     SET ADDRESS OF CONTROL-FILE TO
 19529         DFHEIV20
 19530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19531
 19532
 19533 7940-EXIT.
 19534      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 373
* EL156.cbl
 19536 7950-READ-TRAILER.
 19537
 19538* EXEC CICS READ
 19539*        DATASET  ('ELTRLR')
 19540*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19541*        RIDFLD   (ELTRLR-KEY)
 19542*    END-EXEC.
 19543     MOVE 'ELTRLR' TO DFHEIV1
 19544*    MOVE '&"S        E          (   #00017457' TO DFHEIV0
 19545     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19546     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19547     MOVE X'2020233030303137343537' TO DFHEIV0(25:11)
 19548     CALL 'kxdfhei1' USING DFHEIV0,
 19549           DFHEIV1,
 19550           DFHEIV20,
 19551           DFHEIV99,
 19552           ELTRLR-KEY,
 19553           DFHEIV99,
 19554           DFHEIV99,
 19555           DFHEIV99
 19556     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19557         DFHEIV20
 19558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19559
 19560
 19561 7950-EXIT.
 19562      EXIT.
 19563
 19564 7960-READ-TRAILER-UPDATE.
 19565
 19566* EXEC CICS READ
 19567*        DATASET  ('ELTRLR')
 19568*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19569*        RIDFLD   (ELTRLR-KEY)
 19570*        UPDATE
 19571*    END-EXEC.
 19572     MOVE 'ELTRLR' TO DFHEIV1
 19573*    MOVE '&"S        EU         (   #00017467' TO DFHEIV0
 19574     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19575     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19576     MOVE X'2020233030303137343637' TO DFHEIV0(25:11)
 19577     CALL 'kxdfhei1' USING DFHEIV0,
 19578           DFHEIV1,
 19579           DFHEIV20,
 19580           DFHEIV99,
 19581           ELTRLR-KEY,
 19582           DFHEIV99,
 19583           DFHEIV99,
 19584           DFHEIV99
 19585     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19586         DFHEIV20
 19587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19588
 19589
 19590 7960-EXIT.
 19591      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 374
* EL156.cbl
 19593 7970-READ-CERT.
 19594
 19595* EXEC CICS READ
 19596*        DATASET  ('ELCERT')
 19597*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19598*        RIDFLD   (ELCERT-KEY)
 19599*    END-EXEC.
 19600     MOVE 'ELCERT' TO DFHEIV1
 19601*    MOVE '&"S        E          (   #00017478' TO DFHEIV0
 19602     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19603     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19604     MOVE X'2020233030303137343738' TO DFHEIV0(25:11)
 19605     CALL 'kxdfhei1' USING DFHEIV0,
 19606           DFHEIV1,
 19607           DFHEIV20,
 19608           DFHEIV99,
 19609           ELCERT-KEY,
 19610           DFHEIV99,
 19611           DFHEIV99,
 19612           DFHEIV99
 19613     SET ADDRESS OF CERTIFICATE-MASTER TO
 19614         DFHEIV20
 19615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19616
 19617
 19618 7970-EXIT.
 19619      EXIT.
 19620 7975-read-acct.
 19621
 19622     move spaces              to WS-ACCT-RECORD-SW
 19623                                 pi-dcc-product-code
 19624
 19625     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19626     MOVE PI-CARRIER          TO ACCT-CARRIER
 19627     MOVE PI-GROUPING         TO ACCT-GROUPING
 19628     MOVE PI-STATE            TO ACCT-STATE
 19629     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19630     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19631     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19632     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19633
 19634
 19635* EXEC CICS READ
 19636*       DATASET ('ERACCT')
 19637*       RIDFLD  (ERACCT-KEY)
 19638*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19639*       GTEQ
 19640*       resp    (WS-RESPONSE)
 19641*    END-EXEC
 19642     MOVE 'ERACCT' TO DFHEIV1
 19643*    MOVE '&"S        G          (  N#00017500' TO DFHEIV0
 19644     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19645     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19646     MOVE X'204E233030303137353030' TO DFHEIV0(25:11)
 19647     CALL 'kxdfhei1' USING DFHEIV0,
 19648           DFHEIV1,
 19649           DFHEIV20,
 19650           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 375
* EL156.cbl
 19651           ERACCT-KEY,
 19652           DFHEIV99,
 19653           DFHEIV99,
 19654           DFHEIV99
 19655     SET ADDRESS OF ACCOUNT-MASTER TO
 19656         DFHEIV20
 19657     MOVE EIBRESP  TO WS-RESPONSE
 19658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19659     IF WS-RESP-NORMAL
 19660        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19661        and pi-cert-eff-dt < am-expiration-dt
 19662        and pi-cert-eff-dt >= am-effective-dt
 19663        move am-dcc-product-code to pi-dcc-product-code
 19664        set acct-found to true
 19665     end-if
 19666
 19667     .
 19668 7975-exit.
 19669     exit.
 19670 7980-READ-CERT-UPDATE.
 19671
 19672* EXEC CICS READ
 19673*        DATASET  ('ELCERT')
 19674*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19675*        RIDFLD   (ELCERT-KEY)
 19676*        UPDATE
 19677*    END-EXEC.
 19678     MOVE 'ELCERT' TO DFHEIV1
 19679*    MOVE '&"S        EU         (   #00017519' TO DFHEIV0
 19680     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19681     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19682     MOVE X'2020233030303137353139' TO DFHEIV0(25:11)
 19683     CALL 'kxdfhei1' USING DFHEIV0,
 19684           DFHEIV1,
 19685           DFHEIV20,
 19686           DFHEIV99,
 19687           ELCERT-KEY,
 19688           DFHEIV99,
 19689           DFHEIV99,
 19690           DFHEIV99
 19691     SET ADDRESS OF CERTIFICATE-MASTER TO
 19692         DFHEIV20
 19693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19694
 19695
 19696 7980-EXIT.
 19697      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 376
* EL156.cbl
 19699 8000-LOAD-ERROR-MESSAGES.
 19700     IF PI-PASS-SW = 'C'
 19701        MOVE EMI-LINE1           TO ERMSG1BO
 19702     ELSE
 19703        MOVE EMI-LINE1           TO ERRMSG1O
 19704        MOVE EMI-LINE2           TO ERRMSG2O.
 19705
 19706 8000-EXIT.
 19707     EXIT.
 19708
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 377
* EL156.cbl
 19710
 19711 8010-DMD-ERROR-CHECKS.
 19712     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19713
 19714     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19715         GO TO 8051-ISSUE-ERROR.
 19716
 19717     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19718     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19719     MOVE '3'                    TO DC-OPTION-CODE.
 19720     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19721     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19722         GO TO 8051-ISSUE-ERROR.
 19723
 19724     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19725       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19726                           OR
 19727          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19728           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19729             MOVE ER-0851         TO EMI-ERROR
 19730             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19731       END-IF
 19732       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19733             MOVE ER-8147         TO EMI-ERROR
 19734             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19735
 19736     GO TO 8090-EXIT.
 19737
 19738 8051-ISSUE-ERROR.
 19739     MOVE ER-8146            TO EMI-ERROR.
 19740     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19741     GO TO 8090-EXIT.
 19742
 19743 8090-EXIT.
 19744      EXIT.
 19745
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 378
* EL156.cbl
 19747 8100-SEND-INITIAL-MAP.
 19748
 19749     MOVE SAVE-DATE              TO RUNDTEAO.
 19750     MOVE EIBTIME                TO TIME-IN.
 19751     MOVE TIME-OUT               TO RUNTIMAO.
 19752     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19753
 19754     IF MAP-NAME = 'EL156A'
 19755        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19756           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19757        END-IF
 19758        IF PI-COMPANY-ID = 'DCC' or 'CAP'
 19759           MOVE 'N'     TO SURVYYNO
 19760        END-IF
 19761     END-IF
 19762*    IF MAP-NAME = 'EL156A'
 19763*       IF PI-COMPANY-ID = 'CRI'
 19764*          NEXT SENTENCE
 19765*       ELSE
 19766*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19767
 19768     IF MAP-NAME = 'EL156A'
 19769        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19770           NEXT SENTENCE
 19771        ELSE
 19772           MOVE AL-SADOF TO  PINTA    PINTHA.
 19773
 19774     IF MAP-NAME = 'EL156A'
 19775        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19776            NEXT SENTENCE
 19777        ELSE
 19778           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19779
 19780*    IF MAP-NAME = 'EL156A'
 19781*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19782*          NEXT SENTENCE
 19783*       ELSE
 19784*          MOVE AL-SADOF TO CASHHA CASHA.
 19785
 19786     IF MAP-NAME = 'EL156A'
 19787        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19788                        or 'CAP'
 19789           NEXT SENTENCE
 19790        ELSE
 19791           MOVE AL-SADOF        TO  LOANHA
 19792                                    LOANNOA.
 19793
 19794     IF MAP-NAME = 'EL156A'
 19795        MOVE -1                 TO  ENTERPFL
 19796        IF PI-USES-PAID-TO
 19797           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19798           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19799           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19800        ELSE
 19801           NEXT SENTENCE
 19802     ELSE
 19803        IF MAP-NAME = 'EL156B'
 19804           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 379
* EL156.cbl
 19805              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19806              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19807
 19808
 19809* EXEC CICS SEND
 19810*        MAP   (MAP-NAME)
 19811*        MAPSET(MAPSET-NAME)
 19812*        FROM  (EL156AI)
 19813*        ERASE
 19814*        CURSOR
 19815*    END-EXEC.
 19816     MOVE LENGTH OF
 19817      EL156AI
 19818       TO DFHEIV12
 19819     MOVE -1
 19820       TO DFHEIV11
 19821*    MOVE '8$     CT  E    H L F ,   #00017638' TO DFHEIV0
 19822     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19823     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19824     MOVE X'2020233030303137363338' TO DFHEIV0(25:11)
 19825     CALL 'kxdfhei1' USING DFHEIV0,
 19826           MAP-NAME,
 19827           EL156AI,
 19828           DFHEIV12,
 19829           MAPSET-NAME,
 19830           DFHEIV99,
 19831           DFHEIV99,
 19832           DFHEIV99,
 19833           DFHEIV11,
 19834           DFHEIV99,
 19835           DFHEIV99,
 19836           DFHEIV99
 19837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19838
 19839
 19840     GO TO 9100-RETURN-TRAN.
 19841
 19842 8200-SEND-DATAONLY.
 19843
 19844     IF FIRST-ENTRY = 'Y'
 19845         GO TO 8100-SEND-INITIAL-MAP.
 19846
 19847     IF RETURNED-FROM-B = 'Y'
 19848         GO TO 8100-SEND-INITIAL-MAP.
 19849
 19850     MOVE SAVE-DATE              TO RUNDTEAO.
 19851     MOVE EIBTIME                TO TIME-IN.
 19852     MOVE TIME-OUT               TO RUNTIMAO.
 19853
 19854     IF EIBAID = DFHPF11
 19855        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19856        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19857        MOVE 'EL001   '          TO RETURNED-FROM
 19858        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19859        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19860        GO TO 8100-SEND-INITIAL-MAP.
 19861
 19862     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 380
* EL156.cbl
 19863
 19864     IF MAP-NAME =  'EL156A'
 19865        MOVE -1                 TO  ENTERPFL
 19866        IF PI-USES-PAID-TO
 19867           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19868           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19869           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19870        ELSE
 19871           NEXT SENTENCE
 19872     ELSE
 19873        IF MAP-NAME = 'EL156B'
 19874           IF PI-USES-PAID-TO
 19875              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19876              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19877
 19878     IF MAP-NAME =  'EL156A'
 19879        IF PI-COMPANY-ID = 'BOA'
 19880            IF PI-INT-RATE NUMERIC
 19881                MOVE PI-INT-RATE TO PINTO.
 19882     IF MAP-NAME = 'EL156A'
 19883        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19884           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19885*          MOVE 'Y'              TO EOBYNO
 19886        END-IF
 19887     END-IF
 19888
 19889
 19890* EXEC CICS SEND
 19891*        MAP   (MAP-NAME)
 19892*        MAPSET(MAPSET-NAME)
 19893*        FROM  (EL156AI)
 19894*        DATAONLY
 19895*        CURSOR
 19896*    END-EXEC.
 19897     MOVE LENGTH OF
 19898      EL156AI
 19899       TO DFHEIV12
 19900     MOVE -1
 19901       TO DFHEIV11
 19902*    MOVE '8$D    CT       H L F ,   #00017695' TO DFHEIV0
 19903     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19904     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19905     MOVE X'2020233030303137363935' TO DFHEIV0(25:11)
 19906     CALL 'kxdfhei1' USING DFHEIV0,
 19907           MAP-NAME,
 19908           EL156AI,
 19909           DFHEIV12,
 19910           MAPSET-NAME,
 19911           DFHEIV99,
 19912           DFHEIV99,
 19913           DFHEIV99,
 19914           DFHEIV11,
 19915           DFHEIV99,
 19916           DFHEIV99,
 19917           DFHEIV99
 19918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19919
 19920
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 381
* EL156.cbl
 19921     GO TO 9100-RETURN-TRAN.
 19922
 19923 8300-SEND-TEXT.
 19924
 19925* EXEC CICS SEND TEXT
 19926*        FROM(LOGOFF-TEXT)
 19927*        LENGTH(LOGOFF-LENGTH)
 19928*        ERASE
 19929*        FREEKB
 19930*    END-EXEC.
 19931*    MOVE '8&      T  E F  H   F -   #00017706' TO DFHEIV0
 19932     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19933     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19934     MOVE X'2020233030303137373036' TO DFHEIV0(25:11)
 19935     CALL 'kxdfhei1' USING DFHEIV0,
 19936           LOGOFF-TEXT,
 19937           LOGOFF-LENGTH,
 19938           DFHEIV99,
 19939           DFHEIV99,
 19940           DFHEIV99,
 19941           DFHEIV99,
 19942           DFHEIV99,
 19943           DFHEIV99,
 19944           DFHEIV99,
 19945           DFHEIV99,
 19946           DFHEIV99,
 19947           DFHEIV99
 19948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19949
 19950
 19951
 19952* EXEC CICS RETURN
 19953*    END-EXEC.
 19954*    MOVE '.(                    ''   #00017713' TO DFHEIV0
 19955     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19956     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19957     MOVE X'2020233030303137373133' TO DFHEIV0(25:11)
 19958     CALL 'kxdfhei1' USING DFHEIV0,
 19959           DFHEIV99,
 19960           DFHEIV99,
 19961           DFHEIV99,
 19962           DFHEIV99,
 19963           DFHEIV99,
 19964           DFHEIV99
 19965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19966
 19967
 19968 8500-FILE-NOTOPEN.
 19969     IF FILE-SWITCH = 'MSTR'
 19970         MOVE ER-0154            TO EMI-ERROR.
 19971     IF FILE-SWITCH = 'TRLR'
 19972         MOVE ER-0172            TO EMI-ERROR.
 19973     IF FILE-SWITCH = 'CERT'
 19974         MOVE ER-0169            TO EMI-ERROR.
 19975     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19976                      'PROC' OR 'STAT'
 19977         MOVE ER-0042            TO EMI-ERROR.
 19978     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 382
* EL156.cbl
 19979         MOVE ER-0338            TO EMI-ERROR.
 19980     IF FILE-SWITCH = 'ACCT'
 19981         MOVE ER-0168            TO EMI-ERROR.
 19982
 19983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19984     MOVE -1                     TO PMTTYPEL.
 19985
 19986     IF FIRST-ENTRY = 'Y'
 19987         GO TO 8100-SEND-INITIAL-MAP.
 19988
 19989     GO TO 8200-SEND-DATAONLY.
 19990
 19991 8600-PGRM-NOT-FOUND.
 19992
 19993     MOVE ER-0923                TO EMI-ERROR.
 19994     MOVE -1                     TO ENTPFBL.
 19995     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19996
 19997     IF FIRST-ENTRY = 'Y'
 19998         GO TO 8100-SEND-INITIAL-MAP
 19999     ELSE
 20000         GO TO 8200-SEND-DATAONLY.
 20001
 20002 8800-UNAUTHORIZED-ACCESS.
 20003     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20004     GO TO 8300-SEND-TEXT.
 20005
 20006 8810-PF23.
 20007     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20008     MOVE XCTL-005               TO PGM-NAME.
 20009     GO TO 9300-XCTL.
 20010
 20011 8820-PF7-8.
 20012     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20013     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20014                                    PI-SAVED-PROGRAM-2
 20015                                    PI-SAVED-PROGRAM-3
 20016                                    PI-SAVED-PROGRAM-4
 20017                                    PI-SAVED-PROGRAM-5
 20018                                    PI-SAVED-PROGRAM-6
 20019                                    PI-RETURN-TO-PROGRAM.
 20020     IF EIBAID = DFHPF8
 20021        MOVE XCTL-132            TO PGM-NAME
 20022     ELSE
 20023        MOVE XCTL-130            TO PGM-NAME.
 20024
 20025     GO TO 9300-XCTL.
 20026
 20027 9100-RETURN-TRAN.
 20028     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20029     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20030
 20031
 20032* EXEC CICS RETURN
 20033*        TRANSID(TRANS-ID)
 20034*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20035*        LENGTH(PI-COMM-LENGTH)
 20036*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 383
* EL156.cbl
 20037*    MOVE '.(CT                  ''   #00017779' TO DFHEIV0
 20038     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20039     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20040     MOVE X'2020233030303137373739' TO DFHEIV0(25:11)
 20041     CALL 'kxdfhei1' USING DFHEIV0,
 20042           TRANS-ID,
 20043           PROGRAM-INTERFACE-BLOCK,
 20044           PI-COMM-LENGTH,
 20045           DFHEIV99,
 20046           DFHEIV99,
 20047           DFHEIV99
 20048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20049
 20050
 20051 9200-RETURN-MAIN-MENU.
 20052     MOVE XCTL-126               TO PGM-NAME.
 20053     GO TO 9300-XCTL.
 20054
 20055 9300-XCTL.
 20056
 20057* EXEC CICS XCTL
 20058*        PROGRAM(PGM-NAME)
 20059*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20060*        LENGTH(PI-COMM-LENGTH)
 20061*    END-EXEC.
 20062*    MOVE '.$C                   %   #00017790' TO DFHEIV0
 20063     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20064     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20065     MOVE X'2020233030303137373930' TO DFHEIV0(25:11)
 20066     CALL 'kxdfhei1' USING DFHEIV0,
 20067           PGM-NAME,
 20068           PROGRAM-INTERFACE-BLOCK,
 20069           PI-COMM-LENGTH,
 20070           DFHEIV99
 20071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20072
 20073
 20074 9400-CLEAR.
 20075     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20076     GO TO 9300-XCTL.
 20077
 20078 9500-PF12.
 20079     MOVE XCTL-010               TO PGM-NAME.
 20080     GO TO 9300-XCTL.
 20081
 20082 9700-LINK-DATE-CONVERT.
 20083     MOVE LINK-ELDATCV           TO PGM-NAME.
 20084
 20085* EXEC CICS LINK
 20086*        PROGRAM   (PGM-NAME)
 20087*        COMMAREA  (DATE-CONVERSION-DATA)
 20088*        LENGTH    (DC-COMM-LENGTH)
 20089*    END-EXEC.
 20090*    MOVE '."C                   (   #00017806' TO DFHEIV0
 20091     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20092     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20093     MOVE X'2020233030303137383036' TO DFHEIV0(25:11)
 20094     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 384
* EL156.cbl
 20095           PGM-NAME,
 20096           DATE-CONVERSION-DATA,
 20097           DC-COMM-LENGTH,
 20098           DFHEIV99,
 20099           DFHEIV99,
 20100           DFHEIV99,
 20101           DFHEIV99
 20102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20103
 20104
 20105 9700-EXIT.
 20106     EXIT.
 20107
 20108 9800-LINK-REM-TERM.
 20109     MOVE LINK-REMTERM TO PGM-NAME.
 20110
 20111
 20112* EXEC CICS LINK
 20113*        PROGRAM   (PGM-NAME)
 20114*        COMMAREA  (CALCULATION-PASS-AREA)
 20115*        LENGTH    (CP-COMM-LENGTH)
 20116*    END-EXEC.
 20117*    MOVE '."C                   (   #00017818' TO DFHEIV0
 20118     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20119     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20120     MOVE X'2020233030303137383138' TO DFHEIV0(25:11)
 20121     CALL 'kxdfhei1' USING DFHEIV0,
 20122           PGM-NAME,
 20123           CALCULATION-PASS-AREA,
 20124           CP-COMM-LENGTH,
 20125           DFHEIV99,
 20126           DFHEIV99,
 20127           DFHEIV99,
 20128           DFHEIV99
 20129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20130
 20131
 20132 9800-EXIT.
 20133     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 385
* EL156.cbl
 20135 9830-DMD-REMAINING-TERM.
 20136
 20137     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20138         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20139
 20140     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20141                              CM-PMT-EXTENSION-DAYS.
 20142
 20143     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20144                                  CL-NO-OF-DAYS-PAID.
 20145
 20146     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20147         GIVING W-REM REMAINDER W-REM-DAYS.
 20148
 20149     MOVE W-REM                  TO WST-REM.
 20150
 20151     IF W-REM-DAYS > ZEROS
 20152         MOVE '/'                TO WST-SLASH
 20153         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20154     ELSE
 20155         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20156
 20157 9830-EXIT.
 20158     EXIT.
 20159
 20160 9870-OUTPUT-ACTIVITY-RECORD.
 20161
 20162
 20163* EXEC CICS GETMAIN
 20164*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20165*         LENGTH(25)
 20166*         INITIMG(WS-BLANK)
 20167*    END-EXEC.
 20168     MOVE 25
 20169       TO DFHEIV11
 20170*    MOVE ',"IL                  $   #00017854' TO DFHEIV0
 20171     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20172     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20173     MOVE X'2020233030303137383534' TO DFHEIV0(25:11)
 20174     CALL 'kxdfhei1' USING DFHEIV0,
 20175           DFHEIV20,
 20176           DFHEIV11,
 20177           WS-BLANK
 20178     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20179         DFHEIV20
 20180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20181
 20182
 20183     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20184     MOVE ELMSTR-KEY             TO DA-KEY.
 20185     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20186
 20187     IF PI-PMTTYPE EQUAL '7'
 20188         MOVE 'V'                TO DA-RECORD-TYPE
 20189     ELSE
 20190         MOVE 'P'                TO DA-RECORD-TYPE.
 20191
 20192
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 386
* EL156.cbl
 20193* EXEC CICS HANDLE CONDITION
 20194*         NOTOPEN(9870-NOTOPEN)
 20195*         DUPREC(9870-EXIT)
 20196*    END-EXEC.
 20197*    MOVE '"$J%                  ! B #00017869' TO DFHEIV0
 20198     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20199     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20200     MOVE X'4220233030303137383639' TO DFHEIV0(25:11)
 20201     CALL 'kxdfhei1' USING DFHEIV0
 20202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20203
 20204
 20205
 20206* EXEC CICS WRITE
 20207*         DATASET('DLYACTV')
 20208*         RIDFLD(DA-KEY)
 20209*         FROM(DAILY-ACTIVITY-RECORD)
 20210*         LENGTH(25)
 20211*    END-EXEC.
 20212     MOVE 'DLYACTV' TO DFHEIV1
 20213     MOVE 25
 20214       TO DFHEIV11
 20215*    MOVE '&$ L                  ''   #00017874' TO DFHEIV0
 20216     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20217     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20218     MOVE X'2020233030303137383734' TO DFHEIV0(25:11)
 20219     CALL 'kxdfhei1' USING DFHEIV0,
 20220           DFHEIV1,
 20221           DAILY-ACTIVITY-RECORD,
 20222           DFHEIV11,
 20223           DA-KEY,
 20224           DFHEIV99,
 20225           DFHEIV99
 20226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20227
 20228     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20229     GO TO 9870-EXIT.
 20230
 20231 9870-NOTOPEN.
 20232
 20233     MOVE '2955'                 TO EMI-ERROR.
 20234     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20235
 20236 9870-EXIT.
 20237     EXIT.
 20238
 20239 9900-ERROR-FORMAT.
 20240
 20241     IF EMI-ERROR = ER-0923
 20242         MOVE PGM-NAME           TO W-CALLED-NAME.
 20243
 20244     MOVE LINK-001      TO PGM-NAME.
 20245     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20246
 20247
 20248* EXEC CICS LINK
 20249*        PROGRAM (PGM-NAME)
 20250*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 387
* EL156.cbl
 20251*        LENGTH  (EMI-COMM-LENGTH)
 20252*    END-EXEC.
 20253*    MOVE '."C                   (   #00017899' TO DFHEIV0
 20254     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20256     MOVE X'2020233030303137383939' TO DFHEIV0(25:11)
 20257     CALL 'kxdfhei1' USING DFHEIV0,
 20258           PGM-NAME,
 20259           ERROR-MESSAGE-INTERFACE-BLOCK,
 20260           EMI-COMM-LENGTH,
 20261           DFHEIV99,
 20262           DFHEIV99,
 20263           DFHEIV99,
 20264           DFHEIV99
 20265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20266
 20267
 20268     IF EMI-ERROR = ER-0923
 20269         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20270
 20271 9900-EXIT.
 20272     EXIT.
 20273
 20274 9990-ABEND.
 20275     MOVE LINK-004               TO PGM-NAME.
 20276     MOVE DFHEIBLK               TO EMI-LINE1.
 20277
 20278* EXEC CICS LINK
 20279*        PROGRAM   (PGM-NAME)
 20280*        COMMAREA  (EMI-LINE1)
 20281*        LENGTH    (64)
 20282*    END-EXEC.
 20283     MOVE 64
 20284       TO DFHEIV11
 20285*    MOVE '."C                   (   #00017914' TO DFHEIV0
 20286     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20287     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20288     MOVE X'2020233030303137393134' TO DFHEIV0(25:11)
 20289     CALL 'kxdfhei1' USING DFHEIV0,
 20290           PGM-NAME,
 20291           EMI-LINE1,
 20292           DFHEIV11,
 20293           DFHEIV99,
 20294           DFHEIV99,
 20295           DFHEIV99,
 20296           DFHEIV99
 20297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20298
 20299
 20300     MOVE 'EL156A'               TO  MAP-NAME.
 20301     MOVE LOW-VALUES             TO  EL156AO.
 20302     GO TO 8100-SEND-INITIAL-MAP.
 20303
 20304 9995-SECURITY-VIOLATION.
 20305*    COPY ELCSCTP.
 20306******************************************************************
 20307*                                                                *
 20308*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 388
* EL156.cbl
 20309*                            VMOD=2.001                          *
 20310*                                                                *
 20311*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20312******************************************************************
 20313
 20314
 20315     MOVE EIBDATE          TO SM-JUL-DATE.
 20316     MOVE EIBTRMID         TO SM-TERMID.
 20317     MOVE THIS-PGM         TO SM-PGM.
 20318     MOVE EIBTIME          TO TIME-IN.
 20319     MOVE TIME-OUT         TO SM-TIME.
 20320     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20321
 20322
 20323* EXEC CICS LINK
 20324*         PROGRAM  ('EL003')
 20325*         COMMAREA (SECURITY-MESSAGE)
 20326*         LENGTH   (80)
 20327*    END-EXEC.
 20328     MOVE 'EL003' TO DFHEIV1
 20329     MOVE 80
 20330       TO DFHEIV11
 20331*    MOVE '."C                   (   #00017942' TO DFHEIV0
 20332     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20334     MOVE X'2020233030303137393432' TO DFHEIV0(25:11)
 20335     CALL 'kxdfhei1' USING DFHEIV0,
 20336           DFHEIV1,
 20337           SECURITY-MESSAGE,
 20338           DFHEIV11,
 20339           DFHEIV99,
 20340           DFHEIV99,
 20341           DFHEIV99,
 20342           DFHEIV99
 20343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20344
 20345
 20346******************************************************************
 20347
 20348
 20349
 20350 9999-DFHBACK SECTION.
 20351     MOVE '9%                    "   ' TO DFHEIV0
 20352     MOVE 'EL156' TO DFHEIV1
 20353     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20354     GOBACK.
 20355 9999-DFHEXIT.
 20356     IF DFHEIGDJ EQUAL 0001
 20357         NEXT SENTENCE
 20358     ELSE IF DFHEIGDJ EQUAL 2
 20359         GO TO 9990-ABEND,
 20360               8600-PGRM-NOT-FOUND,
 20361               0400-FIRST-TIME,
 20362               6180-DUPREC,
 20363               9990-ABEND
 20364         DEPENDING ON DFHEIGDI
 20365     ELSE IF DFHEIGDJ EQUAL 3
 20366         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 389
* EL156.cbl
 20367               0380-CLAIM-END-FILE
 20368         DEPENDING ON DFHEIGDI
 20369     ELSE IF DFHEIGDJ EQUAL 4
 20370         GO TO 0380-CLAIM-END-FILE,
 20371               0380-CLAIM-END-FILE
 20372         DEPENDING ON DFHEIGDI
 20373     ELSE IF DFHEIGDJ EQUAL 5
 20374         GO TO 0800-EXIT
 20375         DEPENDING ON DFHEIGDI
 20376     ELSE IF DFHEIGDJ EQUAL 6
 20377         GO TO 1950-NOT-FOUND,
 20378               1950-NOT-FOUND
 20379         DEPENDING ON DFHEIGDI
 20380     ELSE IF DFHEIGDJ EQUAL 7
 20381         GO TO 1950-NOT-FOUND
 20382         DEPENDING ON DFHEIGDI
 20383     ELSE IF DFHEIGDJ EQUAL 8
 20384         GO TO 1950-NOT-FOUND,
 20385               1950-NOT-FOUND
 20386         DEPENDING ON DFHEIGDI
 20387     ELSE IF DFHEIGDJ EQUAL 9
 20388         GO TO 1166-END-CHECK,
 20389               1166-END-CHECK
 20390         DEPENDING ON DFHEIGDI
 20391     ELSE IF DFHEIGDJ EQUAL 10
 20392         GO TO 1950-NOT-FOUND,
 20393               1950-NOT-FOUND
 20394         DEPENDING ON DFHEIGDI
 20395     ELSE IF DFHEIGDJ EQUAL 11
 20396         GO TO 1950-NOT-FOUND,
 20397               1950-NOT-FOUND
 20398         DEPENDING ON DFHEIGDI
 20399     ELSE IF DFHEIGDJ EQUAL 12
 20400         GO TO 1950-NOT-FOUND
 20401         DEPENDING ON DFHEIGDI
 20402     ELSE IF DFHEIGDJ EQUAL 13
 20403         GO TO 3600-CONTINUE
 20404         DEPENDING ON DFHEIGDI
 20405     ELSE IF DFHEIGDJ EQUAL 14
 20406         GO TO 5300-NOTE-NOT-FOUND
 20407         DEPENDING ON DFHEIGDI
 20408     ELSE IF DFHEIGDJ EQUAL 15
 20409         GO TO 6065-NOT-FOUND
 20410         DEPENDING ON DFHEIGDI
 20411     ELSE IF DFHEIGDJ EQUAL 16
 20412         GO TO 6068-ACCT-NOT-FND
 20413         DEPENDING ON DFHEIGDI
 20414     ELSE IF DFHEIGDJ EQUAL 17
 20415         GO TO 6074-GET-COMP-DATA
 20416         DEPENDING ON DFHEIGDI
 20417     ELSE IF DFHEIGDJ EQUAL 18
 20418         GO TO 6170-WRITE
 20419         DEPENDING ON DFHEIGDI
 20420     ELSE IF DFHEIGDJ EQUAL 19
 20421         GO TO 6180-DUPREC
 20422         DEPENDING ON DFHEIGDI
 20423     ELSE IF DFHEIGDJ EQUAL 20
 20424         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-16 09:21 Page 390
* EL156.cbl
 20425         DEPENDING ON DFHEIGDI
 20426     ELSE IF DFHEIGDJ EQUAL 21
 20427         GO TO 6185-DUPREC
 20428         DEPENDING ON DFHEIGDI
 20429     ELSE IF DFHEIGDJ EQUAL 22
 20430         GO TO 6720-BUILD-NEW-RECORD
 20431         DEPENDING ON DFHEIGDI
 20432     ELSE IF DFHEIGDJ EQUAL 23
 20433         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20434               6900-BUILD-ARCHIVE-HEADER
 20435         DEPENDING ON DFHEIGDI
 20436     ELSE IF DFHEIGDJ EQUAL 24
 20437         GO TO 7010-BUILD-MAP
 20438         DEPENDING ON DFHEIGDI
 20439     ELSE IF DFHEIGDJ EQUAL 25
 20440         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20441         DEPENDING ON DFHEIGDI
 20442     ELSE IF DFHEIGDJ EQUAL 26
 20443         GO TO 7160-DUPREC
 20444         DEPENDING ON DFHEIGDI
 20445     ELSE IF DFHEIGDJ EQUAL 27
 20446         GO TO 7200-EXIT,
 20447               7200-EXIT
 20448         DEPENDING ON DFHEIGDI
 20449     ELSE IF DFHEIGDJ EQUAL 28
 20450         GO TO 7400-NOT-FOUND
 20451         DEPENDING ON DFHEIGDI
 20452     ELSE IF DFHEIGDJ EQUAL 29
 20453         GO TO 7590-END,
 20454               7590-END
 20455         DEPENDING ON DFHEIGDI
 20456     ELSE IF DFHEIGDJ EQUAL 30
 20457         GO TO 7699-EXIT
 20458         DEPENDING ON DFHEIGDI
 20459     ELSE IF DFHEIGDJ EQUAL 31
 20460         GO TO 5300-NOTE-NOT-FOUND
 20461         DEPENDING ON DFHEIGDI
 20462     ELSE IF DFHEIGDJ EQUAL 32
 20463         GO TO 7800-COMP-NOTFND
 20464         DEPENDING ON DFHEIGDI
 20465     ELSE IF DFHEIGDJ EQUAL 33
 20466         GO TO 7920-NOT-FOUND
 20467         DEPENDING ON DFHEIGDI
 20468     ELSE IF DFHEIGDJ EQUAL 34
 20469         GO TO 9870-NOTOPEN,
 20470               9870-EXIT
 20471         DEPENDING ON DFHEIGDI.
 20472     MOVE '9%                    "   ' TO DFHEIV0
 20473     MOVE 'EL156' TO DFHEIV1
 20474     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20475     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12228     Code:       76213
