* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    51*071117   IR2017061900003  PEMA  ALLOW 0% APR ON REFUNDS
    52* 100417  CR2017051000002  PEMA  Add fields to interface
    53* 100418  CR2018073000001  PEMA  REWORD REFUND METHODS
    54* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    55* 052319  IR2019052300001  PEMA  VIN&BENE not being passed at time
    56* 062119  CR2019050800001  PEMA  Add option to search by VIN
    57* 080519  IR2019080200001  PEMA  Allow multiple quotes by VIN
    58******************************************************************
    59 environment division.
    60 data division.
    61 working-storage section.
    62 01  DFH-START PIC X(04).
    63*
    64* program buffers
    65*
    66 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    67     88  ALREADY-SENT              VALUE 'Y'.
    68 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    69 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    70     88  ELCERT-FINISHED            VALUE 'Y'.
    71 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page   3
* SOCK03.cbl
    72 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    73     88  ERACCT-FOUND               VALUE 'Y'.
    74 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    75 77 ws-send-msg-size           pic s9(8) comp value 4096.
    76 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    77 77 ws-recv-buf                pic x(4096).
    78 77 ws-send-buf                pic x(4096) VALUE SPACES.
    79 77 ws-recv-total              pic s9(8) comp value 0.
    80 77 ws-recv-left               pic s9(8) comp value 0.
    81 77 ws-seq-num                 pic s9(8) comp value 0.
    82 77 ws-flags                   pic s9(8) comp value 0.
    83 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    84 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    85 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    86 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    87 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    88 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    89 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    90 77  ws-cancel-reason            pic x   value spaces.
    91 77  P1                          PIC S999 COMP-3 VALUE +0.
    92 77  P2                          PIC S999 COMP-3 VALUE +0.
    93 77  C0                          PIC S999 COMP-3 VALUE +0.
    94 77  C1                          PIC S999 COMP-3 VALUE +0.
    95 77  C2                          PIC S999 COMP-3 VALUE +0.
    96 77  C3                          PIC S999 COMP-3 VALUE +0.
    97 77 S1                           PIC S999 COMP-3 VALUE +0.
    98 77 S2                           PIC S999 COMP-3 VALUE +0.
    99 77 L1                           PIC S999 COMP-3 VALUE +0.
   100 77 L2                           PIC S999 COMP-3 VALUE +0.
   101 77 F1                           PIC S999 COMP-3 VALUE +0.
   102 77 WS-BUILD-SW                  PIC X.
   103    88  TIME-TO-BUILD               VALUE 'Y'.
   104 77 WS-SAVE-ERACCT               PIC X(2000).
   105 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
   106 77 WS-STOP-SW                   PIC X  VALUE ' '.
   107    88  TOLD-TO-STOP               VALUE 'Y'.
   108 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   109    88  GET-RATES                    VALUE 'R'.
   110    88  GET-ACT-ACCTS                VALUE 'A'.
   111 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   112 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   113 77 ws-disp-rate                 pic z9.99999.
   114 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   115     88  END-OF-ERCTBL                 VALUE 'Y'.
   116 77  WS-STATUS                   PIC X.
   117 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   118 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   119 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   120 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   121 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   122 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   123 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   124 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   125 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   126 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   127 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   128 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   129     88  WS-ELCERT-FULL             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page   4
* SOCK03.cbl
   130     88  WS-ELCERT-NAME             VALUE '2'.
   131     88  WS-ELCERT-CERT-NO          VALUE '3'.
   132     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   133     88  WS-ELCERT-VIN              value '5'.
   134 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   135 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   136     88  I-SAY-TO-STOP      VALUE 'Y'.
   137 77  WS-HEX-0A                   PIC X.
   138 77  WS-CALL-TYPE                PIC X(6).
   139 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   140 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   141 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   142 77  DD-IU-SW                    PIC X   VALUE ' '.
   143     88  DD-IU-PRESENT                 VALUE 'Y'.
   144 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   145 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   146 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   147 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   148 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   149 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   150 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   151 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   152 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   153     88  PDEF-FOUND                              VALUE 'Y'.
   154 77  ws-epiq-sw                  pic x  value ' '.
   155     88  ws-epiq-request           value 'Y'.
   156 77  ws-epiq-max                 pic s999 value +0 comp-3.
   157 01  WS-STRING-DATA.
   158     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   159     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   160     05  WS-CARRIER              PIC X        VALUE SPACES.
   161     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   162     05  WS-STATE                PIC XX       VALUE SPACES.
   163     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   164     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   165     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   166     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   167     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   168     05  WS-MID-INIT             PIC X        VALUE SPACES.
   169     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   170     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   171     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   172     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   173     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   174     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   175     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   176     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   177     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   178     05  WS-LF-METHOD            PIC X(15)    VALUE SPACES.
   179     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   180     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   181     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   182     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   183     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   184     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   185     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   186     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   187     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page   5
* SOCK03.cbl
   188     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   189     05  WS-AH-METHOD            PIC X(15)    VALUE SPACES.
   190     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   191     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   192     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   193     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   194     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   195     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   196     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   197     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   198     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   199     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   200     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   201     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   202     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   203     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   204     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   205     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   206     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   207     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   208     05  WS-LF-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   209     05  WS-AH-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   210     05  WS-VIN                  PIC X(17)  VALUE SPACES.
   211     05  WS-CRED-BENE-NAME       PIC X(30)  VALUE SPACES.
   212 01  ws-work-date.
   213     05  ws-work-ccyy            pic x(4).
   214     05  ws-work-mm              pic xx.
   215     05  ws-work-dd              pic xx.
   216 01  ws-work-date-num redefines ws-work-date
   217                                 pic 9(8).
   218 01  FILLER.
   219     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   220     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   221     12  WS-STATE-ABBREVIATION   PIC XX.
   222     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   223     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   224     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   225     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   226     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   227     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   228     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   229     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   230     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   231     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   232     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   233     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   234     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   235     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   236     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   237     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   238     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   239     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   240     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   241     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   242     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   243     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   244     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   245     12  WS-AH-OVERRIDE-L1       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page   6
* SOCK03.cbl
   246     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   247     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   248         88  WS-REDUCING                         VALUE 'R'.
   249         88  WS-LEVEL                            VALUE 'L'  'P'.
   250 01  ELMSTR-KEY.
   251     12  ELMSTR-COMP-CD          PIC X.
   252     12  ELMSTR-CERT-NO          PIC X(11).
   253 01  CTBL-KEY-SAVE               PIC X(5).
   254 01  CTBL-KEY.
   255     05  CTBL-COMPANY-CD         PIC X.
   256     05  CTBL-TABLE              PIC XXX.
   257     05  CTBL-BEN-TYPE           PIC X.
   258     05  CTBL-BEN-CODE           PIC XX.
   259 01  ERPDEF-KEY-SAVE             PIC X(18).
   260 01  ERPDEF-KEY.
   261     12  ERPDEF-COMPANY-CD       PIC X.
   262     12  ERPDEF-STATE            PIC XX.
   263     12  ERPDEF-PROD-CD          PIC XXX.
   264     12  F                       PIC X(7).
   265     12  ERPDEF-BEN-TYPE         PIC X.
   266     12  ERPDEF-BEN-CODE         PIC XX.
   267     12  ERPDEF-EXP-DT           PIC XX.
   268 01  WS-AM3-KEY.
   269     12  WS-AM3-ACCOUNT          PIC X(10).
   270     12  WS-AM3-EXP-DT           PIC XX.
   271 01  WS-AM-KEY.
   272     12  WS-AM-COMPANY-CD        PIC X.
   273     12  WS-AM-CARRIER           PIC X.
   274     12  WS-AM-GROUPING          PIC X(6).
   275     12  WS-AM-STATE             PIC XX.
   276     12  WS-AM-ACCOUNT           PIC X(10).
   277     12  WS-AM-EXPIRATION-DT     PIC XX.
   278     12  WS-AM-FILLER            PIC XXXX.
   279 01  WS-CO-DATA.
   280     05  WS-CO-NUM               PIC X(10).
   281     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   282     05  WS-CO-NAME              PIC X(30).
   283     05  WS-CO-MAIL-NAME         PIC X(30).
   284     05  WS-CO-ADDR1             PIC X(30).
   285     05  WS-CO-ADDR2             PIC X(30).
   286     05  WS-CO-ADDR3             PIC X(30).
   287     05  WS-CO-ZIP               PIC X(9).
   288     05  WS-CO-PHONE             PIC X(10).
   289 01  WS-CF-KEY.
   290     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   291     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   292*        88  COMPANY-MASTER                      VALUE '1'.
   293*        88  STATE-MASTER                        VALUE '3'.
   294*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   295*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   296     12  WS-CF-ACCESS.
   297         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   298         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   299             20  FILLER          PIC  X(01).
   300             20  WS-CF-CARRIER   PIC  X(01).
   301     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   302 01  WS-CS-KEY.
   303     05  WS-CS-COMPANY-CD        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page   7
* SOCK03.cbl
   304     05  WS-CS-CARRIER           PIC X.
   305     05  WS-CS-GROUP             PIC X(6).
   306     05  WS-CS-STATE             PIC XX.
   307     05  WS-CS-ACCOUNT           PIC X(10).
   308     05  WS-CS-EFF-DT            PIC XX.
   309     05  WS-CS-CERT-NO           PIC X(11).
   310     05  WS-CS-TRLR-TYPE         PIC X.
   311 01  WS-MA-KEY.
   312     05  WS-MA-COMPANY-CD        PIC X.
   313     05  WS-MA-CARRIER           PIC X.
   314     05  WS-MA-GROUP             PIC X(6).
   315     05  WS-MA-STATE             PIC XX.
   316     05  WS-MA-ACCOUNT           PIC X(10).
   317     05  WS-MA-EFF-DT            PIC XX.
   318     05  WS-MA-CERT-NO           PIC X(11).
   319 01  WS-CM-KEY.
   320     05  WS-CM-COMPANY-CD        PIC X.
   321     05  WS-CM-CARRIER           PIC X.
   322     05  WS-CM-GROUP             PIC X(6).
   323     05  WS-CM-STATE             PIC XX.
   324     05  WS-CM-ACCOUNT           PIC X(10).
   325     05  WS-CM-EFF-DT            PIC XX.
   326     05  WS-CM-CERT-NO           PIC X(11).
   327 01  WS-CM-KEY-A1.
   328     05  WS-CM-COMPANY-CD-A1     PIC X.
   329     05  WS-CM-LAST-NAME         PIC X(15).
   330     05  WS-CM-INITIALS          PIC XX.
   331 01  WS-CM-KEY-A4.
   332     05  WS-CM-COMPANY-CD-A4     PIC X.
   333     05  WS-CM-CERT-NO-A4        PIC X(11).
   334 01  WS-CID-NO                   PIC X(8).
   335 01  WS-DISP-RESP                PIC 9(5).
   336 01  WS-RESPONSE                 PIC S9(8)   COMP.
   337     88  RESP-NORMAL                  VALUE +00.
   338     88  RESP-NOTFND                  VALUE +13.
   339     88  RESP-DUPKEY                  VALUE +15.
   340     88  RESP-NOTOPEN                 VALUE +19.
   341     88  RESP-ENDFILE                 VALUE +20.
   342*                                 COPY ELCCERT.
   343******************************************************************
   344*                                                                *
   345*                            ELCCERT.                            *
   346*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   347*                            VMOD=2.013                          *
   348*                                                                *
   349*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   350*                                                                *
   351*   FILE TYPE = VSAM,KSDS                                        *
   352*   RECORD SIZE = 450  RECFORM = FIXED                           *
   353*                                                                *
   354*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   355*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   356*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   357*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   358*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   359*                                                                *
   360*   LOG = YES                                                    *
   361*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page   8
* SOCK03.cbl
   362******************************************************************
   363*                   C H A N G E   L O G
   364*
   365* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   366*-----------------------------------------------------------------
   367*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   368* EFFECTIVE    NUMBER
   369*-----------------------------------------------------------------
   370* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   371* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   372* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   373* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   374* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   375* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   376* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   377* 032612  CR2011110200001  PEMA  AHL CHANGES
   378* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   379* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   380* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   381******************************************************************
   382
   383 01  CERTIFICATE-MASTER.
   384     12  CM-RECORD-ID                      PIC XX.
   385         88  VALID-CM-ID                      VALUE 'CM'.
   386
   387     12  CM-CONTROL-PRIMARY.
   388         16  CM-COMPANY-CD                 PIC X.
   389         16  CM-CARRIER                    PIC X.
   390         16  CM-GROUPING.
   391             20  CM-GROUPING-PREFIX        PIC X(3).
   392             20  CM-GROUPING-PRIME         PIC X(3).
   393         16  CM-STATE                      PIC XX.
   394         16  CM-ACCOUNT.
   395             20  CM-ACCOUNT-PREFIX         PIC X(4).
   396             20  CM-ACCOUNT-PRIME          PIC X(6).
   397         16  CM-CERT-EFF-DT                PIC XX.
   398         16  CM-CERT-NO.
   399             20  CM-CERT-PRIME             PIC X(10).
   400             20  CM-CERT-SFX               PIC X.
   401
   402     12  CM-CONTROL-BY-NAME.
   403         16  CM-COMPANY-CD-A1              PIC X.
   404         16  CM-INSURED-LAST-NAME          PIC X(15).
   405         16  CM-INSURED-INITIALS.
   406             20  CM-INSURED-INITIAL1       PIC X.
   407             20  CM-INSURED-INITIAL2       PIC X.
   408
   409     12  CM-CONTROL-BY-SSN.
   410         16  CM-COMPANY-CD-A2              PIC X.
   411         16  CM-SOC-SEC-NO.
   412             20  CM-SSN-STATE              PIC XX.
   413             20  CM-SSN-ACCOUNT            PIC X(6).
   414             20  CM-SSN-LN3.
   415                 25  CM-INSURED-INITIALS-A2.
   416                     30 CM-INSURED-INITIAL1-A2   PIC X.
   417                     30 CM-INSURED-INITIAL2-A2   PIC X.
   418                 25 CM-PART-LAST-NAME-A2         PIC X.
   419
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page   9
* SOCK03.cbl
   420     12  CM-CONTROL-BY-CERT-NO.
   421         16  CM-COMPANY-CD-A4              PIC X.
   422         16  CM-CERT-NO-A4                 PIC X(11).
   423
   424     12  CM-CONTROL-BY-MEMB.
   425         16  CM-COMPANY-CD-A5              PIC X.
   426         16  CM-MEMBER-NO.
   427             20  CM-MEMB-STATE             PIC XX.
   428             20  CM-MEMB-ACCOUNT           PIC X(6).
   429             20  CM-MEMB-LN4.
   430                 25  CM-INSURED-INITIALS-A5.
   431                     30 CM-INSURED-INITIAL1-A5   PIC X.
   432                     30 CM-INSURED-INITIAL2-A5   PIC X.
   433                 25 CM-PART-LAST-NAME-A5         PIC XX.
   434
   435     12  CM-INSURED-PROFILE-DATA.
   436         16  CM-INSURED-FIRST-NAME.
   437             20  CM-INSURED-1ST-INIT       PIC X.
   438             20  FILLER                    PIC X(9).
   439         16  CM-INSURED-ISSUE-AGE          PIC 99.
   440         16  CM-INSURED-SEX                PIC X.
   441             88  CM-SEX-MALE                  VALUE 'M'.
   442             88  CM-SEX-FEMAL                 VALUE 'F'.
   443         16  CM-INSURED-JOINT-AGE          PIC 99.
   444         16  CM-JOINT-INSURED-NAME.
   445             20  CM-JT-LAST-NAME           PIC X(15).
   446             20  CM-JT-FIRST-NAME.
   447                 24  CM-JT-1ST-INIT        PIC X.
   448                 24  FILLER                PIC X(9).
   449             20  CM-JT-INITIAL             PIC X.
   450
   451     12  CM-LIFE-DATA.
   452         16  CM-LF-BENEFIT-CD              PIC XX.
   453         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   454         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   455         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   456         16  CM-LF-DEV-CODE                PIC XXX.
   457         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   458         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   459         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   460         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   461         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   462         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   463         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   464         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   465         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   466         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   467         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   468         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   469         16  cm-temp-epiq                  pic xx.
   470             88  EPIQ-CLASS                  value 'EQ'.
   471*        16  FILLER                        PIC XX.
   472
   473     12  CM-AH-DATA.
   474         16  CM-AH-BENEFIT-CD              PIC XX.
   475         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   476         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   477         16  CM-AH-DEV-CODE                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  10
* SOCK03.cbl
   478         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   479         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   480         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   481         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   482         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   483         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   484         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   485         16  CM-AH-PAID-THRU-DT            PIC XX.
   486             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   487         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   488         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   489         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   490         16  FILLER                        PIC X.
   491
   492     12  CM-LOAN-INFORMATION.
   493         16  CM-LIVES                      PIC S9(7)     COMP-3.
   494         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   495                                           PIC S9(5)V99  COMP-3.
   496         16  CM-BILLED                     PIC S9(7)     COMP-3.
   497         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   498         16  CM-PAY-FREQUENCY              PIC S99.
   499         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   500         16  CM-RATE-CLASS                 PIC XX.
   501         16  CM-BENEFICIARY                PIC X(25).
   502         16  CM-POLICY-FORM-NO             PIC X(12).
   503         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   504         16  CM-LAST-ADD-ON-DT             PIC XX.
   505         16  CM-DEDUCTIBLE-AMOUNTS.
   506             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   507             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   508         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   509             20  CM-RESIDENT-STATE         PIC XX.
   510             20  CM-RATE-CODE              PIC X(4).
   511             20  FILLER                    PIC XX.
   512         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   513             20  CM-LOAN-OFFICER           PIC X(5).
   514             20  FILLER                    PIC XXX.
   515         16  CM-CSR-CODE                   PIC XXX.
   516         16  CM-UNDERWRITING-CODE          PIC X.
   517             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   518         16  CM-POST-CARD-IND              PIC X.
   519         16  CM-REF-INTERFACE-SW           PIC X.
   520         16  CM-PREMIUM-TYPE               PIC X.
   521             88  CM-SING-PRM                  VALUE '1'.
   522             88  CM-O-B-COVERAGE              VALUE '2'.
   523             88  CM-OPEN-END                  VALUE '3'.
   524         16  CM-IND-GRP-TYPE               PIC X.
   525             88  CM-INDIVIDUAL                VALUE 'I'.
   526             88  CM-GROUP                     VALUE 'G'.
   527         16  CM-SKIP-CODE                  PIC X.
   528             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   529             88  SKIP-JULY                    VALUE '1'.
   530             88  SKIP-AUGUST                  VALUE '2'.
   531             88  SKIP-SEPTEMBER               VALUE '3'.
   532             88  SKIP-JULY-AUG                VALUE '4'.
   533             88  SKIP-AUG-SEPT                VALUE '5'.
   534             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   535             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  11
* SOCK03.cbl
   536             88  SKIP-JUNE                    VALUE '8'.
   537             88  SKIP-JUNE-JULY               VALUE '9'.
   538             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   539             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   540         16  CM-PAYMENT-MODE               PIC X.
   541             88  PAY-MONTHLY                  VALUE SPACE.
   542             88  PAY-WEEKLY                   VALUE '1'.
   543             88  PAY-SEMI-MONTHLY             VALUE '2'.
   544             88  PAY-BI-WEEKLY                VALUE '3'.
   545             88  PAY-SEMI-ANUALLY             VALUE '4'.
   546         16  CM-LOAN-NUMBER                PIC X(8).
   547         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   548         16  CM-OLD-LOF                    PIC XXX.
   549*        16  CM-LOAN-OFFICER               PIC XXX.
   550         16  CM-REIN-TABLE                 PIC XXX.
   551         16  CM-SPECIAL-REIN-CODE          PIC X.
   552         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   553         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   554         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   555
   556     12  CM-STATUS-DATA.
   557         16  CM-ENTRY-STATUS               PIC X.
   558         16  CM-ENTRY-DT                   PIC XX.
   559
   560         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   561         16  CM-LF-CANCEL-DT               PIC XX.
   562         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   563
   564         16  CM-LF-STATUS-AT-DEATH         PIC X.
   565         16  CM-LF-DEATH-DT                PIC XX.
   566         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   567
   568         16  CM-LF-CURRENT-STATUS          PIC X.
   569             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   570                                                'M' '4' '5' '9'.
   571             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   572             88  CM-LF-POLICY-PENDING         VALUE '2'.
   573             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   574             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   575             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   576             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   577             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   578             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   579             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   580             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   581             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   582             88  CM-LF-DECLINED               VALUE 'D'.
   583             88  CM-LF-VOIDED                 VALUE 'V'.
   584
   585         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   586         16  CM-AH-CANCEL-DT               PIC XX.
   587         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   588
   589         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   590         16  CM-AH-SETTLEMENT-DT           PIC XX.
   591         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   592
   593         16  CM-AH-CURRENT-STATUS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  12
* SOCK03.cbl
   594             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   595                                                'M' '4' '5' '9'.
   596             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   597             88  CM-AH-POLICY-PENDING         VALUE '2'.
   598             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   599             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   600             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   601             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   602             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   603             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   604             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   605             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   606             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   607             88  CM-AH-DECLINED               VALUE 'D'.
   608             88  CM-AH-VOIDED                 VALUE 'V'.
   609
   610         16  CM-CLAIM-INTERFACE-SW         PIC X.
   611             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   612             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   613             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   614         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   615
   616         16  CM-ENTRY-BATCH                PIC X(6).
   617         16  CM-LF-EXIT-BATCH              PIC X(6).
   618         16  CM-AH-EXIT-BATCH              PIC X(6).
   619         16  CM-LAST-MONTH-END             PIC XX.
   620
   621     12  CM-NOTE-SW                        PIC X.
   622         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   623         88  CERT-NOTES-PRESENT               VALUE '1'.
   624         88  BILLING-NOTES-PRESENT            VALUE '2'.
   625         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   626         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   627         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   628         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   629         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   630     12  CM-COMP-EXCP-SW                   PIC X.
   631         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   632         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   633     12  CM-INSURED-ADDRESS-SW             PIC X.
   634         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   635         88  INSURED-ADDR-PRESENT             VALUE '1'.
   636
   637*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   638     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   639     12  FILLER                            PIC X.
   640
   641*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   642     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   643     12  FILLER                            PIC X.
   644*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   645     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   646
   647     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   648         88  CERT-ADDED-BATCH                 VALUE ' '.
   649         88  CERT-ADDED-ONLINE                VALUE '1'.
   650         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   651         88  CERT-PURGED-OFFLINE              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  13
* SOCK03.cbl
   652         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   653     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   654         88  CERT-AS-LOADED                   VALUE ' '.
   655         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   656         88  CERT-CLAIM-ONLINE                VALUE '2'.
   657         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   658         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   659         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   660         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   661         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   662
   663     12  CM-ACCOUNT-COMM-PCTS.
   664         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   665         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   666
   667     12  CM-USER-FIELD                     PIC X.
   668     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   669     12  CM-CLP-STATE                      PIC XX.
   670     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   671     12  CM-USER-RESERVED                  PIC XXX.
   672     12  FILLER REDEFINES CM-USER-RESERVED.
   673         16  CM-AH-CLASS-CD                PIC XX.
   674         16  F                             PIC X.
   675******************************************************************
   676*                                 COPY ELCMSTR.
   677******************************************************************
   678*                                                                *
   679*                            ELCMSTR.                            *
   680*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   681*                            VMOD=2.012                          *
   682*                                                                *
   683*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   684*                                                                *
   685*   FILE TYPE = VSAM,KSDS                                        *
   686*   RECORD SIZE = 350  RECFORM = FIXED                           *
   687*                                                                *
   688*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   689*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   690*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   691*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   692*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   693*                                                 RKP=75,LEN=21  *
   694*                                                                *
   695*   **** NOTE ****                                               *
   696*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   697*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   698*                                                                *
   699*   LOG = YES                                                    *
   700*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   701******************************************************************
   702*                   C H A N G E   L O G
   703*
   704* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   705*-----------------------------------------------------------------
   706*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   707* EFFECTIVE    NUMBER
   708*-----------------------------------------------------------------
   709* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  14
* SOCK03.cbl
   710* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   711* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   712* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   713* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   714* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   715* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   716******************************************************************
   717 01  CLAIM-MASTER.
   718     12  CL-RECORD-ID                PIC XX.
   719         88  VALID-CL-ID         VALUE 'CL'.
   720
   721     12  CL-CONTROL-PRIMARY.
   722         16  CL-COMPANY-CD           PIC X.
   723         16  CL-CARRIER              PIC X.
   724         16  CL-CLAIM-NO             PIC X(7).
   725         16  CL-CERT-NO.
   726             20  CL-CERT-PRIME       PIC X(10).
   727             20  CL-CERT-SFX         PIC X.
   728
   729     12  CL-CONTROL-BY-NAME.
   730         16  CL-COMPANY-CD-A1        PIC X.
   731         16  CL-INSURED-LAST-NAME    PIC X(15).
   732         16  CL-INSURED-NAME.
   733             20  CL-INSURED-1ST-NAME PIC X(12).
   734             20  CL-INSURED-MID-INIT PIC X.
   735
   736     12  CL-CONTROL-BY-SSN.
   737         16  CL-COMPANY-CD-A2        PIC X.
   738         16  CL-SOC-SEC-NO.
   739             20  CL-SSN-STATE        PIC XX.
   740             20  CL-SSN-ACCOUNT      PIC X(6).
   741             20  CL-SSN-LN3          PIC X(3).
   742
   743     12  CL-CONTROL-BY-CERT-NO.
   744         16  CL-COMPANY-CD-A4        PIC X.
   745         16  CL-CERT-NO-A4.
   746             20  CL-CERT-A4-PRIME    PIC X(10).
   747             20  CL-CERT-A4-SFX      PIC X.
   748
   749     12  CL-CONTROL-BY-CCN.
   750         16  CL-COMPANY-CD-A5        PIC X.
   751         16  CL-CCN-A5.
   752             20  CL-CCN.
   753                 24  CL-CCN-PREFIX-A5 PIC X(4).
   754                 24  CL-CCN-PRIME-A5 PIC X(12).
   755             20  CL-CCN-FILLER-A5    PIC X(4).
   756
   757     12  CL-INSURED-PROFILE-DATA.
   758         16  CL-INSURED-BIRTH-DT     PIC XX.
   759         16  CL-INSURED-SEX-CD       PIC X.
   760             88  INSURED-IS-MALE        VALUE 'M'.
   761             88  INSURED-IS-FEMALE      VALUE 'F'.
   762             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   763         16  CL-INSURED-OCC-CD       PIC X(6).
   764         16  FILLER                  PIC X(5).
   765
   766     12  CL-PROCESSING-INFO.
   767         16  CL-PROCESSOR-ID         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  15
* SOCK03.cbl
   768         16  CL-CLAIM-STATUS         PIC X.
   769             88  CLAIM-IS-OPEN          VALUE 'O'.
   770             88  CLAIM-IS-CLOSED        VALUE 'C'.
   771         16  CL-CLAIM-TYPE           PIC X.
   772*            88  AH-CLAIM               VALUE 'A'.
   773*            88  LIFE-CLAIM             VALUE 'L'.
   774*            88  PROPERTY-CLAIM         VALUE 'P'.
   775*            88  IUI-CLAIM              VALUE 'I'.
   776*            88  GAP-CLAIM              VALUE 'G'.
   777*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   778*            88  OTHER-CLAIM            VALUE 'O'.
   779         16  CL-CLAIM-PREM-TYPE      PIC X.
   780             88  SINGLE-PREMIUM         VALUE '1'.
   781             88  O-B-COVERAGE           VALUE '2'.
   782             88  OPEN-END-COVERAGE      VALUE '3'.
   783         16  CL-INCURRED-DT          PIC XX.
   784         16  CL-REPORTED-DT          PIC XX.
   785         16  CL-FILE-ESTABLISH-DT    PIC XX.
   786         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   787         16  CL-LAST-PMT-DT          PIC XX.
   788         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   789         16  CL-PAID-THRU-DT         PIC XX.
   790         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   791         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   792         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   793         16  CL-PMT-CALC-METHOD      PIC X.
   794             88  CL-360-DAY-YR          VALUE '1'.
   795             88  CL-365-DAY-YR          VALUE '2'.
   796             88  CL-FULL-MONTHS         VALUE '3'.
   797         16  CL-CAUSE-CD             PIC X(6).
   798
   799         16  CL-PRIME-CERT-NO.
   800             20  CL-PRIME-CERT-PRIME PIC X(10).
   801             20  CL-PRIME-CERT-SFX   PIC X.
   802
   803         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   804             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   805             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   806
   807         16  CL-MICROFILM-NO         PIC X(10).
   808         16  FILLER REDEFINES CL-MICROFILM-NO.
   809             20  CL-BENEFIT-PERIOD   PIC 99.
   810             20  FILLER              PIC X(8).
   811         16  CL-PROG-FORM-TYPE       PIC X.
   812         16  CL-LAST-ADD-ON-DT       PIC XX.
   813
   814         16  CL-LAST-REOPEN-DT       PIC XX.
   815         16  CL-LAST-CLOSE-DT        PIC XX.
   816         16  CL-LAST-CLOSE-REASON    PIC X(01).
   817             88  FINAL-PAID             VALUE '1'.
   818             88  CLAIM-DENIED           VALUE '2'.
   819             88  AUTO-CLOSE             VALUE '3'.
   820             88  MANUAL-CLOSE           VALUE '4'.
   821             88  BENEFITS-CHANGED       VALUE 'C'.
   822             88  SETUP-ERRORS           VALUE 'E'.
   823         16  CL-ASSOC-CERT-SEQU      PIC S99.
   824         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   825         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  16
* SOCK03.cbl
   826             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   827         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   828         16  FILLER                  PIC X.
   829
   830     12  CL-CERTIFICATE-DATA.
   831         16  CL-CERT-ORIGIN          PIC X.
   832             88  CERT-WAS-ONLINE        VALUE '1'.
   833             88  CERT-WAS-CREATED       VALUE '2'.
   834             88  COVERAGE-WAS-ADDED     VALUE '3'.
   835         16  CL-CERT-KEY-DATA.
   836             20  CL-CERT-CARRIER     PIC X.
   837             20  CL-CERT-GROUPING    PIC X(6).
   838             20  CL-CERT-STATE       PIC XX.
   839             20  CL-CERT-ACCOUNT.
   840                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   841                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   842             20  CL-CERT-EFF-DT      PIC XX.
   843
   844     12  CL-STATUS-CONTROLS.
   845         16  CL-PRIORITY-CD          PIC X.
   846             88  CONFIDENTIAL-DATA      VALUE '8'.
   847             88  HIGHEST-PRIORITY       VALUE '9'.
   848         16  CL-SUPV-ATTN-CD         PIC X.
   849             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   850             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   851         16  CL-PURGED-DT            PIC XX.
   852         16  CL-RESTORED-DT          PIC XX.
   853         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   854         16  CL-NEXT-RESEND-DT       PIC XX.
   855         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   856         16  CL-CRITICAL-PERIOD      PIC 99.
   857*        16  FILLER                  PIC XX.
   858         16  CL-LAST-MAINT-DT        PIC XX.
   859         16  CL-LAST-MAINT-USER      PIC X(4).
   860         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   861         16  CL-LAST-MAINT-TYPE      PIC X.
   862             88  CLAIM-SET-UP           VALUE ' '.
   863             88  PAYMENT-MADE           VALUE '1'.
   864             88  LETTER-SENT            VALUE '2'.
   865             88  MASTER-WAS-ALTERED     VALUE '3'.
   866             88  MASTER-WAS-RESTORED    VALUE '4'.
   867             88  INCURRED-DATE-CHANGED  VALUE '5'.
   868             88  FILE-CONVERTED         VALUE '6'.
   869             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   870             88  ERROR-CORRECTION       VALUE 'E'.
   871         16  CL-RELATED-CLAIM-NO     PIC X(7).
   872         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   873         16  CL-BENEFICIARY          PIC X(10).
   874         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   875         16  CL-DENIAL-TYPE          PIC X.
   876             88  CL-TYPE-DENIAL          VALUE '1'.
   877             88  CL-TYPE-RESCISSION      VALUE '2'.
   878             88  CL-TYPE-REFORMATION     VALUE '3'.
   879             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   880             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   881         16  CL-NO-OF-EXTENSIONS     PIC 99.
   882         16  filler                  pic x(3).
   883*        16  CL-CRIT-PER-RECURRENT   PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  17
* SOCK03.cbl
   884*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   885*        16  CL-RTW-DT               PIC XX.
   886
   887     12  CL-TRAILER-CONTROLS.
   888         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   889             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   890             88  CL-LAST-TRL-AVAIL      VALUE +100.
   891             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   892         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   893         16  FILLER                  PIC XX.
   894         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   895         16  CL-ADDRESS-TRAILER-CNT.
   896             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   897                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   898             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   899                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   900             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   901                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   902             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   903                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   904             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   905                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   906             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   907                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   908             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   909                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   910
   911     12  CL-CV-REFERENCE-NO.
   912         16  CL-CV-REFNO-PRIME       PIC X(18).
   913         16  CL-CV-REFNO-SFX         PIC XX.
   914
   915     12  CL-FILE-LOCATION            PIC X(4).
   916
   917     12  CL-PROCESS-ERRORS.
   918         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   919             88  NO-FATAL-ERRORS        VALUE ZERO.
   920         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   921             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   922
   923     12  CL-PRODUCT-CD               PIC X.
   924
   925     12  CL-CURRENT-KEY-DATA.
   926         16  CL-CURRENT-CARRIER      PIC X.
   927         16  CL-CURRENT-GROUPING     PIC X(6).
   928         16  CL-CURRENT-STATE        PIC XX.
   929         16  CL-CURRENT-ACCOUNT      PIC X(10).
   930
   931     12  CL-ASSOCIATES               PIC X.
   932         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   933         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   934         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   935         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   936
   937     12  CL-ACTIVITY-CODE            PIC 99.
   938     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   939     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   940
   941     12  CL-LAPSE-REPORT-CODE        PIC 9.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  18
* SOCK03.cbl
   942     12  CL-LAG-REPORT-CODE          PIC 9.
   943     12  CL-LOAN-TYPE                PIC XX.
   944     12  CL-LEGAL-STATE              PIC XX.
   945
   946     12  CL-YESNOSW                  PIC X.
   947     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   948         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   949         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   950         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   951     12  cl-insured-type             pic x.
   952         88  cl-claim-on-primary         value 'P'.
   953         88  cl-claim-on-co-borrower     value 'C'.
   954     12  cl-benefit-expiration-dt    PIC XX.
   955*                                 COPY ERCPDEF.
   956******************************************************************
   957*                                                                *
   958*                                                                *
   959*                            ERCPDEF.                            *
   960*                                                                *
   961*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   962*                                                                *
   963*    FILE TYPE = VSAM,KSDS                                       *
   964*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   965*                                                                *
   966*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   967*                                                                *
   968*    LOG = YES                                                   *
   969*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   970******************************************************************
   971*                   C H A N G E   L O G
   972*
   973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   974*-----------------------------------------------------------------
   975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   976* EFFECTIVE    NUMBER
   977*-----------------------------------------------------------------
   978* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   979* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   980* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   981* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   982******************************************************************
   983 01  PRODUCT-MASTER.
   984    12  PD-RECORD-ID                 PIC X(02).
   985        88  VALID-PD-ID                  VALUE 'PD'.
   986    12  PD-CONTROL-PRIMARY.
   987        16  PD-COMPANY-CD            PIC X.
   988        16  PD-STATE                 PIC XX.
   989        16  PD-PRODUCT-CD            PIC XXX.
   990        16  PD-FILLER                PIC X(7).
   991        16  PD-BEN-TYPE              PIC X.
   992        16  PD-BEN-CODE              PIC XX.
   993        16  PD-PROD-EXP-DT           PIC XX.
   994    12  FILLER                       PIC X(50).
   995    12  PD-PRODUCT-DATA OCCURS 8.
   996        16  PD-PROD-CODE             PIC X.
   997            88  PD-PROD-LIFE           VALUE 'L'.
   998            88  PD-PROD-PROP           VALUE 'P'.
   999            88  PD-PROD-AH             VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  19
* SOCK03.cbl
  1000            88  PD-PROD-IU             VALUE 'I'.
  1001            88  PD-PROD-GAP            VALUE 'G'.
  1002            88  PD-PROD-FAML           VALUE 'F'.
  1003            88  PD-PROD-OTH            VALUE 'O'.
  1004        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  1005        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  1006        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  1007        16  PD-MAX-TERM              PIC S999        COMP-3.
  1008        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  1009        16  FILLER                   PIC X.
  1010        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  1011        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  1012        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  1013        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  1014        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  1015        16  PD-REC-CRIT-PERIOD       PIC 99.
  1016        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  1017            20  PD-RECURRING-YN      PIC X.
  1018            20  FILLER               PIC X.
  1019        16  PD-RTW-MOS               PIC 99.
  1020        16  PD-MAX-EXTENSION         PIC 99.
  1021        16  pd-ben-pct               pic sv999 comp-3.
  1022*       16  FILLER                   PIC XX.
  1023    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  1024    12  PD-TERM-LIMITS OCCURS 15.
  1025        16  PD-LOW-TERM              PIC S999        COMP-3.
  1026        16  PD-HI-TERM               PIC S999        COMP-3.
  1027*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  1028    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  1029        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  1030        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  1031    12  PD-EARN-FACTORS.
  1032        16  FILLER OCCURS 15.
  1033            20  FILLER OCCURS 15.
  1034                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1035    12  PD-PRODUCT-DESC              PIC X(80).
  1036    12  PD-TRUNCATED                 PIC X.
  1037    12  FILLER                       PIC X(59).
  1038    12  PD-MAINT-INFORMATION.
  1039        16  PD-LAST-MAINT-DT         PIC X(02).
  1040        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1041        16  PD-LAST-MAINT-BY         PIC X(04).
  1042*                                 COPY ERCCTBL.
  1043******************************************************************
  1044*                                                                *
  1045*                                                                *
  1046*                            ERCCTBL                             *
  1047*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1048*                            VMOD=2.003
  1049*                                                                *
  1050*   ONLINE CREDIT SYSTEM                                         *
  1051*                                                                *
  1052*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1053*                                                                *
  1054*   FILE TYPE = VSAM,KSDS                                        *
  1055*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1056*                                                                *
  1057*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  20
* SOCK03.cbl
  1058*       ALTERNATE PATH = NONE                                    *
  1059*                                                                *
  1060*   LOG = NO                                                     *
  1061*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1062*                                                                *
  1063*                                                                *
  1064******************************************************************
  1065
  1066 01  COMM-TABLE-RECORD.
  1067     12  CT-RECORD-ID                      PIC XX.
  1068         88  VALID-CT-ID                      VALUE 'CT'.
  1069
  1070     12  CT-CONTROL-PRIMARY.
  1071         16  CT-COMPANY-CD                 PIC X.
  1072         16  CT-TABLE                      PIC XXX.
  1073         16  CT-CNTRL-2.
  1074             20  CT-BEN-TYPE               PIC X.
  1075             20  CT-BEN-CODE               PIC XX.
  1076
  1077     12  CT-MAINT-INFORMATION.
  1078         16  CT-LAST-MAINT-DT              PIC XX.
  1079         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1080         16  CT-LAST-MAINT-USER            PIC X(4).
  1081         16  FILLER                        PIC X(31).
  1082
  1083     12  CT-LIMITS.
  1084         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1085
  1086         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1087
  1088         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1089
  1090     12  CT-RATES.
  1091         16  CT-RTX          OCCURS 27 TIMES.
  1092             20  CT-RT                     PIC SV9(5)     COMP-3.
  1093             20  CT-RT-R   REDEFINES
  1094                 CT-RT                     PIC XXX.
  1095
  1096     12  FILLER                            PIC  X(42).
  1097
  1098******************************************************************
  1099*                                 COPY ELCCNTL.
  1100******************************************************************
  1101*                                                                *
  1102*                                                                *
  1103*                            ELCCNTL.                            *
  1104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1105*                            VMOD=2.059                          *
  1106*                                                                *
  1107*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1108*                                                                *
  1109*   FILE TYPE = VSAM,KSDS                                        *
  1110*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1111*                                                                *
  1112*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1113*       ALTERNATE INDEX = NONE                                   *
  1114*                                                                *
  1115*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  21
* SOCK03.cbl
  1116*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1117******************************************************************
  1118*                   C H A N G E   L O G
  1119*
  1120* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1121*-----------------------------------------------------------------
  1122*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1123* EFFECTIVE    NUMBER
  1124*-----------------------------------------------------------------
  1125* 082503                   PEMA  ADD BENEFIT GROUP
  1126* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1127* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1128* 092705    2005050300006  PEMA  ADD SPP LEASES
  1129* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1130* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1131* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1132* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1133* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1134* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1135* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1136* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1137* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1138* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1139* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1140******************************************************************
  1141*
  1142 01  CONTROL-FILE.
  1143     12  CF-RECORD-ID                       PIC XX.
  1144         88  VALID-CF-ID                        VALUE 'CF'.
  1145
  1146     12  CF-CONTROL-PRIMARY.
  1147         16  CF-COMPANY-ID                  PIC XXX.
  1148         16  CF-RECORD-TYPE                 PIC X.
  1149             88  CF-COMPANY-MASTER              VALUE '1'.
  1150             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1151             88  CF-STATE-MASTER                VALUE '3'.
  1152             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1153             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1154             88  CF-CARRIER-MASTER              VALUE '6'.
  1155             88  CF-MORTALITY-MASTER            VALUE '7'.
  1156             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1157             88  CF-TERMINAL-MASTER             VALUE '9'.
  1158             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1159             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1160             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1161             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1162             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1163             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1164             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1165             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1166             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1167         16  CF-ACCESS-CD-GENL              PIC X(4).
  1168         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1169             20  CF-PROCESSOR               PIC X(4).
  1170         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1171             20  CF-STATE-CODE              PIC XX.
  1172             20  FILLER                     PIC XX.
  1173         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  22
* SOCK03.cbl
  1174             20  FILLER                     PIC XX.
  1175             20  CF-HI-BEN-IN-REC           PIC XX.
  1176         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1177             20  FILLER                     PIC XXX.
  1178             20  CF-CARRIER-CNTL            PIC X.
  1179         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1180             20  FILLER                     PIC XX.
  1181             20  CF-HI-TYPE-IN-REC          PIC 99.
  1182         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1183             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1184                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1185             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1186             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1187         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1188             20  FILLER                     PIC X.
  1189             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1190         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1191             20  FILLER                     PIC XX.
  1192             20  CF-MORTGAGE-PLAN           PIC XX.
  1193         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1194
  1195     12  CF-LAST-MAINT-DT                   PIC XX.
  1196     12  CF-LAST-MAINT-BY                   PIC X(4).
  1197     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1198
  1199     12  CF-RECORD-BODY                     PIC X(728).
  1200
  1201
  1202****************************************************************
  1203*             COMPANY MASTER RECORD                            *
  1204****************************************************************
  1205
  1206     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1207         16  CF-COMPANY-ADDRESS.
  1208             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1209             20  CF-CL-IN-CARE-OF           PIC X(30).
  1210             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1211             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1212             20  CF-CL-CITY-STATE           PIC X(30).
  1213             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1214             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1215         16  CF-COMPANY-CD                  PIC X.
  1216         16  CF-COMPANY-PASSWORD            PIC X(8).
  1217         16  CF-SECURITY-OPTION             PIC X.
  1218             88  ALL-SECURITY                   VALUE '1'.
  1219             88  COMPANY-VERIFY                 VALUE '2'.
  1220             88  PROCESSOR-VERIFY               VALUE '3'.
  1221             88  NO-SECURITY                    VALUE '4'.
  1222             88  ALL-BUT-TERM                   VALUE '5'.
  1223         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1224             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1225         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1226             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1227         16  CF-INFORCE-LOCATION            PIC X.
  1228             88  CERTS-ARE-ONLINE               VALUE '1'.
  1229             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1230             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1231         16  CF-LOWER-CASE-LETTERS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  23
* SOCK03.cbl
  1232         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1233             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1234             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1235             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1236             88  CF-ACCNT-CNTL                  VALUE '3'.
  1237             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1238
  1239         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1240         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1241
  1242         16  CF-LGX-CREDIT-USER             PIC X.
  1243             88  CO-IS-NOT-USER                 VALUE 'N'.
  1244             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1245
  1246         16 CF-CREDIT-CALC-CODES.
  1247             20  CF-CR-REM-TERM-CALC PIC X.
  1248               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1249               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1250               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1251               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1252               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1253               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1254               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1255             20  CF-CR-R78-METHOD           PIC X.
  1256               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1257               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1258
  1259         16  CF-CLAIM-CONTROL-COUNTS.
  1260             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1261                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1262
  1263             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1264                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1265
  1266             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1267                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1268
  1269             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1270                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1271
  1272         16  CF-CURRENT-MONTH-END           PIC XX.
  1273
  1274         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1275             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1276             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1277             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1278             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1279                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1280                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1281             20  CF-CO-PREM-REJECT-SW       PIC X.
  1282                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1283                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1284             20  CF-CO-REF-REJECT-SW        PIC X.
  1285                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1286                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1287
  1288         16  CF-CO-REPORTING-DT             PIC XX.
  1289         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  24
* SOCK03.cbl
  1290         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1291           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1292           88  CF-CO-MONTH-END                  VALUE '1'.
  1293
  1294         16  CF-LGX-CLAIM-USER              PIC X.
  1295             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1296             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1297
  1298         16  CF-CREDIT-EDIT-CONTROLS.
  1299             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1300             20  CF-MIN-AGE                 PIC 99.
  1301             20  CF-DEFAULT-AGE             PIC 99.
  1302             20  CF-MIN-TERM                PIC S999      COMP-3.
  1303             20  CF-MAX-TERM                PIC S999      COMP-3.
  1304             20  CF-DEFAULT-SEX             PIC X.
  1305             20  CF-JOINT-AGE-INPUT         PIC X.
  1306                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1307             20  CF-BIRTH-DATE-INPUT        PIC X.
  1308                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1309             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1310                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1311                 88  CF-ZERO-CARRIER            VALUE '1'.
  1312                 88  CF-ZERO-GROUPING           VALUE '2'.
  1313                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1314             20  CF-EDIT-SW                 PIC X.
  1315                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1316             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1317             20  CF-CR-PR-METHOD            PIC X.
  1318               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1319               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1320             20  FILLER                     PIC X.
  1321
  1322         16  CF-CREDIT-MISC-CONTROLS.
  1323             20  CF-REIN-TABLE-SW           PIC X.
  1324                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1325             20  CF-COMP-TABLE-SW           PIC X.
  1326                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1327             20  CF-EXPERIENCE-RETENTION-AGE
  1328                                            PIC S9        COMP-3.
  1329             20  CF-CONVERSION-DT           PIC XX.
  1330             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1331             20  CF-RUN-FREQUENCY-SW        PIC X.
  1332                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1333                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1334
  1335             20  CF-CR-CHECK-NO-CONTROL.
  1336                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1337                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1338                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1339                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1340                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1341                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1342
  1343                 24  CF-CR-CHECK-COUNT       REDEFINES
  1344                     CF-CR-CHECK-COUNTER      PIC X(4).
  1345
  1346                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1347                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  25
* SOCK03.cbl
  1348
  1349                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1350                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1351                 24  CF-MAIL-PROCESSING       PIC X.
  1352                     88  MAIL-PROCESSING          VALUE 'Y'.
  1353
  1354         16  CF-MISC-SYSTEM-CONTROL.
  1355             20  CF-SYSTEM-C                 PIC X.
  1356                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1357             20  CF-SYSTEM-D                 PIC X.
  1358                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1359             20  CF-SOC-SEC-NO-SW            PIC X.
  1360                 88  SOC-SEC-NO-USED             VALUE '1'.
  1361             20  CF-MEMBER-NO-SW             PIC X.
  1362                 88  MEMBER-NO-USED              VALUE '1'.
  1363             20  CF-TAX-ID-NUMBER            PIC X(11).
  1364             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1365             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1366                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1367                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1368                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1369                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1370             20  CF-SYSTEM-E                 PIC X.
  1371                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1372
  1373         16  CF-LGX-LIFE-USER               PIC X.
  1374             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1375             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1376
  1377         16  CF-CR-MONTH-END-DT             PIC XX.
  1378
  1379         16  CF-FILE-MAINT-DATES.
  1380             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1381                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1382             20  CF-LAST-BATCH       REDEFINES
  1383                 CF-LAST-BATCH-NO               PIC X(4).
  1384             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1385             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1386             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1387             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1388             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1389             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1390             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1391             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1392             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1393             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1394
  1395         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1396         16  FILLER                         PIC X.
  1397
  1398         16  CF-ALT-MORT-CODE               PIC X(4).
  1399         16  CF-MEMBER-CAPTION              PIC X(10).
  1400
  1401         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1402             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1403             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1404             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1405             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  26
* SOCK03.cbl
  1406             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1407
  1408         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1409
  1410         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1411         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1412         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1413         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1414
  1415         16  CF-AH-OVERRIDE-L1              PIC X.
  1416         16  CF-AH-OVERRIDE-L2              PIC XX.
  1417         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1418         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1419
  1420         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1421         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1422
  1423         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1424         16  CF-AR-LAST-EL860-DT            PIC XX.
  1425         16  CF-MP-MONTH-END-DT             PIC XX.
  1426
  1427         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1428         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1429             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1430
  1431         16  CF-AR-MONTH-END-DT             PIC XX.
  1432
  1433         16  CF-CRDTCRD-USER                PIC X.
  1434             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1435             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1436
  1437         16  CF-CC-MONTH-END-DT             PIC XX.
  1438
  1439         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1440
  1441         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1442             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1443             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1444             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1445         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1446         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1447         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1448         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1449             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1450             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1451         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1452         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1453         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1454             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1455         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1456
  1457         16  CF-CL-ZIP-CODE.
  1458             20  CF-CL-ZIP-PRIME.
  1459                 24  CF-CL-ZIP-1ST          PIC X.
  1460                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1461                 24  FILLER                 PIC X(4).
  1462             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1463         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  27
* SOCK03.cbl
  1464             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1465             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1466             20  FILLER                     PIC XXX.
  1467
  1468         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1469         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1470         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1471         16  CF-CO-OPTION-START-DATE        PIC XX.
  1472         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1473           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1474                                                      '3' '4'.
  1475           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1476           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1477           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1478           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1479           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1480           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1481
  1482         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1483
  1484         16  CF-PAYMENT-APPROVAL-LEVELS.
  1485             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1486             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1487             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1488             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1489             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1490             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1491
  1492         16  CF-END-USER-REPORTING-USER     PIC X.
  1493             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1494             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1495
  1496         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1497             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1498             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1499
  1500         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1501
  1502         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1503         16  FILLER                         PIC X.
  1504
  1505         16  CF-CREDIT-ARCHIVE-CNTL.
  1506             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1507             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1508             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1509
  1510         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1511
  1512         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1513             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1514             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1515
  1516         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1517             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1518             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1519
  1520         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1521
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  28
* SOCK03.cbl
  1522         16  CF-CO-ACH-ID-CODE              PIC  X.
  1523             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1524             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1525             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1526         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1527         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1528         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1529         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1530         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1531         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1532         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1533         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1534         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1535                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1536         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1537                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1538
  1539         16  CF-CO-OVER-SHORT.
  1540             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1541             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1542
  1543*         16  FILLER                         PIC X(102).
  1544         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1545             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1546             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1547
  1548         16  CF-AH-APPROVAL-DAYS.
  1549             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1550             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1551             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1552             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1553
  1554         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1555
  1556         16  CF-APPROV-LEV-5.
  1557             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1558             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1559             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1560
  1561         16  FILLER                         PIC X(68).
  1562****************************************************************
  1563*             PROCESSOR/USER RECORD                            *
  1564****************************************************************
  1565
  1566     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1567         16  CF-PROCESSOR-NAME              PIC X(30).
  1568         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1569         16  CF-PROCESSOR-TITLE             PIC X(26).
  1570         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1571                 88  MESSAGE-YES                VALUE 'Y'.
  1572                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1573
  1574*****************************************************
  1575****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1576****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1577****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1578****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1579*****************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  29
* SOCK03.cbl
  1580
  1581         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1582             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1583             20  CF-APPLICATION-FORCE       PIC X.
  1584             20  CF-INDIVIDUAL-APP.
  1585                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1586                     28  CF-BROWSE-APP      PIC X.
  1587                     28  CF-UPDATE-APP      PIC X.
  1588
  1589         16  CF-CURRENT-TERM-ON             PIC X(4).
  1590         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1591             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1592             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1593             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1594             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1595             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1596             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1597             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1598         16  CF-PROCESSOR-CARRIER           PIC X.
  1599             88  NO-CARRIER-SECURITY            VALUE ' '.
  1600         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1601             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1602         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1603             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1604         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1605             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1606
  1607         16  CF-PROC-SYS-ACCESS-SW.
  1608             20  CF-PROC-CREDIT-CLAIMS-SW.
  1609                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1610                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1611                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1612                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1613             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1614                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1615                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1616             20  CF-PROC-LIFE-GNRLDGR-SW.
  1617                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1618                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1619                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1620                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1621             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1622                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1623                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1624         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1625             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1626             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1627         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1628
  1629         16  CF-APPROVAL-LEVEL                  PIC X.
  1630             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1631             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1632             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1633             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1634             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1635
  1636         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1637
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  30
* SOCK03.cbl
  1638         16  CF-LANGUAGE-TYPE                   PIC X.
  1639             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1640             88  CF-LANG-IS-FR                      VALUE 'F'.
  1641
  1642         16  CF-CSR-IND                         PIC X.
  1643         16  FILLER                             PIC X(239).
  1644
  1645****************************************************************
  1646*             PROCESSOR/REMINDERS RECORD                       *
  1647****************************************************************
  1648
  1649     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1650         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1651             20  CF-START-REMIND-DT         PIC XX.
  1652             20  CF-END-REMIND-DT           PIC XX.
  1653             20  CF-REMINDER-TEXT           PIC X(50).
  1654         16  FILLER                         PIC X(296).
  1655
  1656
  1657****************************************************************
  1658*             STATE MASTER RECORD                              *
  1659****************************************************************
  1660
  1661     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1662         16  CF-STATE-ABBREVIATION          PIC XX.
  1663         16  CF-STATE-NAME                  PIC X(25).
  1664         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1665         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1666             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1667             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1668             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1669             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1670                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1671                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1672             20  CF-ST-PREM-REJECT-SW       PIC X.
  1673                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1674                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1675             20  CF-ST-REF-REJECT-SW        PIC X.
  1676                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1677                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1678         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1679         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1680         16  CF-ST-REFUND-RULES.
  1681             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1682             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1683             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1684         16  CF-ST-FST-PMT-EXTENSION.
  1685             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1686             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1687                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1688                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1689                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1690                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1691         16  CF-ST-STATE-CALL.
  1692             20  CF-ST-CALL-UNEARNED        PIC X.
  1693             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1694             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1695         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  31
* SOCK03.cbl
  1696             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1697             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1698         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1699         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1700         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1701         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1702         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1703         16  FILLER                         PIC X.
  1704         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1705             20  CF-ST-BENEFIT-CD           PIC XX.
  1706             20  CF-ST-BENEFIT-KIND         PIC X.
  1707                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1708                 88  CF-ST-AH-KIND              VALUE 'A'.
  1709             20  CF-ST-REM-TERM-CALC        PIC X.
  1710                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1711                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1712                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1713                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1714                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1715                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1716                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1717                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1718
  1719             20  CF-ST-REFUND-CALC          PIC X.
  1720                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1721                 88  ST-REFD-BY-R78             VALUE '1'.
  1722                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1723                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1724                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1725                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1726                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1727                 88  ST-REFD-UTAH               VALUE '7'.
  1728                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1729                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1730                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1731
  1732             20  CF-ST-EARNING-CALC         PIC X.
  1733                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1734                 88  ST-EARN-BY-R78             VALUE '1'.
  1735                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1736                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1737                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1738                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1739                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1740                 88  ST-EARN-MEAN               VALUE '8'.
  1741                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1742
  1743             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1744                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1745                 88  ST-OVRD-BY-R78             VALUE '1'.
  1746                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1747                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1748                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1749                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1750                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1751                 88  ST-OVRD-MEAN               VALUE '8'.
  1752                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1753             20  cf-st-extra-periods        pic 9.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  32
* SOCK03.cbl
  1754*            20  FILLER                     PIC X.
  1755
  1756         16  CF-ST-COMMISSION-CAPS.
  1757             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1758             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1759             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1760             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1761         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1762                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1763                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1764                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1765
  1766         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1767
  1768         16  CF-ST-STATUTORY-INTEREST.
  1769             20  CF-ST-STAT-DATE-FROM       PIC X.
  1770                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1771                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1772             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1773             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1774             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1775             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1776             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1777
  1778         16  CF-ST-OVER-SHORT.
  1779             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1780             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1781
  1782         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1783
  1784         16  CF-ST-RT-CALC                  PIC X.
  1785
  1786         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1787         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1788         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1789         16  CF-ST-RF-LR-CALC               PIC X.
  1790         16  CF-ST-RF-LL-CALC               PIC X.
  1791         16  CF-ST-RF-LN-CALC               PIC X.
  1792         16  CF-ST-RF-AH-CALC               PIC X.
  1793         16  CF-ST-RF-CP-CALC               PIC X.
  1794*        16  FILLER                         PIC X(206).
  1795*CIDMOD         16  FILLER                         PIC X(192).
  1796         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1797             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1798         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1799         16  CF-ST-VFY-2ND-BENE             PIC X.
  1800         16  CF-ST-CAUSAL-STATE             PIC X.
  1801         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1802         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1803         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1804             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1805         16  CF-ST-NET-ONLY-STATE           PIC X.
  1806             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1807         16  cf-commission-cap-required     pic x.
  1808         16  CF-ST-GA-COMMISSION-CAPS.
  1809             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1810             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1811             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  33
* SOCK03.cbl
  1812             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  1813         16  CF-ST-TOT-COMMISSION-CAPS.
  1814             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  1815             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  1816             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  1817             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1818         16  FILLER                         PIC X(156).
  1819
  1820****************************************************************
  1821*             BENEFIT MASTER RECORD                            *
  1822****************************************************************
  1823
  1824     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1825         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1826             20  CF-BENEFIT-CODE            PIC XX.
  1827             20  CF-BENEFIT-NUMERIC  REDEFINES
  1828                 CF-BENEFIT-CODE            PIC XX.
  1829             20  CF-BENEFIT-ALPHA           PIC XXX.
  1830             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1831             20  CF-BENEFIT-COMMENT         PIC X(10).
  1832
  1833             20  CF-LF-COVERAGE-TYPE        PIC X.
  1834                 88  CF-REDUCING                VALUE 'R'.
  1835                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1836
  1837             20  CF-SPECIAL-CALC-CD         PIC X.
  1838                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1839                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1840                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1841                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1842                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1843                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1844                 88  CF-FARM-PLAN               VALUE 'F'.
  1845                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1846                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1847                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1848                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1849                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1850                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1851                 88  CF-PRUDENTIAL              VALUE 'P'.
  1852                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1853                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1854                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1855                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1856                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1857                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1858
  1859             20  CF-JOINT-INDICATOR         PIC X.
  1860                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1861
  1862*            20  FILLER                     PIC X(12).
  1863             20  cf-maximum-benefits        pic s999 comp-3.
  1864             20  FILLER                     PIC X(09).
  1865             20  CF-BENEFIT-CATEGORY        PIC X.
  1866             20  CF-LOAN-TYPE               PIC X(8).
  1867
  1868             20  CF-CO-REM-TERM-CALC        PIC X.
  1869                 88  CO-EARN-AFTER-15TH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  34
* SOCK03.cbl
  1870                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1871                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1872                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1873                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1874
  1875             20  CF-CO-EARNINGS-CALC        PIC X.
  1876                 88  CO-EARN-BY-R78             VALUE '1'.
  1877                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1878                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1879                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1880                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1881                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1882                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1883                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1884
  1885             20  CF-CO-REFUND-CALC          PIC X.
  1886                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1887                 88  CO-REFD-BY-R78             VALUE '1'.
  1888                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1889                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1890                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1891                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1892                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1893                 88  CO-REFD-MEAN               VALUE '8'.
  1894                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1895                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1896                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1897
  1898             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1899                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1900                 88  CO-OVRD-BY-R78             VALUE '1'.
  1901                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1902                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1903                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1904                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1905                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1906                 88  CO-OVRD-MEAN               VALUE '8'.
  1907                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1908
  1909             20  CF-CO-BEN-I-G-CD           PIC X.
  1910                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1911                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1912                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1913
  1914         16  FILLER                         PIC X(304).
  1915
  1916
  1917****************************************************************
  1918*             CARRIER MASTER RECORD                            *
  1919****************************************************************
  1920
  1921     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1922         16  CF-ADDRESS-DATA.
  1923             20  CF-MAIL-TO-NAME            PIC X(30).
  1924             20  CF-IN-CARE-OF              PIC X(30).
  1925             20  CF-ADDRESS-LINE-1          PIC X(30).
  1926             20  CF-ADDRESS-LINE-2          PIC X(30).
  1927             20  CF-CITY-STATE              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  35
* SOCK03.cbl
  1928             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1929             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1930
  1931         16  CF-CLAIM-NO-CONTROL.
  1932             20  CF-CLAIM-NO-METHOD         PIC X.
  1933                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1934                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1935                 88  CLAIM-NO-SEQ               VALUE '3'.
  1936                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1937             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1938                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1939                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1940                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1941
  1942         16  CF-CHECK-NO-CONTROL.
  1943             20  CF-CHECK-NO-METHOD         PIC X.
  1944                 88  CHECK-NO-MANUAL            VALUE '1'.
  1945                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1946                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1947                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1948             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1949                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1950
  1951         16  CF-DOMICILE-STATE              PIC XX.
  1952
  1953         16  CF-EXPENSE-CONTROLS.
  1954             20  CF-EXPENSE-METHOD          PIC X.
  1955                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1956                 88  DOLLARS-PER-PMT            VALUE '2'.
  1957                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1958                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1959             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1960             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1961
  1962         16  CF-CORRESPONDENCE-CONTROL.
  1963             20  CF-LETTER-RESEND-OPT       PIC X.
  1964                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1965                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1966             20  FILLER                     PIC X(4).
  1967
  1968         16  CF-RESERVE-CONTROLS.
  1969             20  CF-MANUAL-SW               PIC X.
  1970                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1971             20  CF-FUTURE-SW               PIC X.
  1972                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1973             20  CF-PTC-SW                  PIC X.
  1974                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1975             20  CF-IBNR-SW                 PIC X.
  1976                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1977             20  CF-PTC-LF-SW               PIC X.
  1978                 88  CF-LF-PTC-USED             VALUE '1'.
  1979             20  CF-CDT-ACCESS-METHOD       PIC X.
  1980                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1981                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1982                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1983             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1984
  1985         16  CF-CLAIM-CALC-METHOD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  36
* SOCK03.cbl
  1986             88  360-PLUS-MONTHS                VALUE '1'.
  1987             88  365-PLUS-MONTHS                VALUE '2'.
  1988             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1989             88  360-DAILY                      VALUE '4'.
  1990             88  365-DAILY                      VALUE '5'.
  1991
  1992         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1993         16  FILLER                         PIC X(11).
  1994
  1995         16  CF-LIMIT-AMOUNTS.
  1996             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1997             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1998             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1999             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2000             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2001             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2002             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2003             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2004             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2005             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2006
  2007         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2008         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2009         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2010
  2011         16  CF-ZIP-CODE.
  2012             20  CF-ZIP-PRIME.
  2013                 24  CF-ZIP-1ST             PIC X.
  2014                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2015                 24  FILLER                 PIC X(4).
  2016             20  CF-ZIP-PLUS4               PIC X(4).
  2017         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2018             20  CF-CAN-POSTAL-1            PIC XXX.
  2019             20  CF-CAN-POSTAL-2            PIC XXX.
  2020             20  FILLER                     PIC XXX.
  2021
  2022         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2023         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2024         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2025
  2026         16  CF-RATING-SWITCH               PIC X.
  2027             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2028             88  CF-NO-RATING                   VALUE 'N'.
  2029
  2030         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2031
  2032         16  CF-CARRIER-OVER-SHORT.
  2033             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2034             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2035
  2036         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2037         16  CF-SECPAY-SWITCH               PIC X.
  2038             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2039             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2040         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2041         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2042         16  FILLER                         PIC X(444).
  2043*        16  FILLER                         PIC X(452).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  37
* SOCK03.cbl
  2044
  2045
  2046****************************************************************
  2047*             MORTALITY MASTER RECORD                          *
  2048****************************************************************
  2049
  2050     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2051         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2052                                INDEXED BY CF-MORT-NDX.
  2053             20  CF-MORT-TABLE              PIC X(5).
  2054             20  CF-MORT-TABLE-TYPE         PIC X.
  2055                 88  CF-MORT-JOINT              VALUE 'J'.
  2056                 88  CF-MORT-SINGLE             VALUE 'S'.
  2057                 88  CF-MORT-COMBINED           VALUE 'C'.
  2058                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2059                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2060             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2061             20  CF-MORT-AGE-METHOD         PIC XX.
  2062                 88  CF-AGE-LAST                VALUE 'AL'.
  2063                 88  CF-AGE-NEAR                VALUE 'AN'.
  2064             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2065             20  CF-MORT-ADJUSTMENT-DIRECTION
  2066                                            PIC X.
  2067                 88  CF-MINUS                   VALUE '-'.
  2068                 88  CF-PLUS                    VALUE '+'.
  2069             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2070             20  CF-MORT-JOINT-CODE         PIC X.
  2071                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2072             20  CF-MORT-PC-Q               PIC X.
  2073                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2074             20  CF-MORT-TABLE-CODE         PIC X(4).
  2075             20  CF-MORT-COMMENTS           PIC X(15).
  2076             20  FILLER                     PIC X(14).
  2077
  2078         16  FILLER                         PIC X(251).
  2079
  2080
  2081****************************************************************
  2082*             BUSSINESS TYPE MASTER RECORD                     *
  2083****************************************************************
  2084
  2085     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2086* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2087* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2088* AND RECORD 05 IS TYPES 81-99
  2089         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2090             20  CF-BUSINESS-TITLE          PIC  X(19).
  2091             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2092                                            PIC S9V9(4) COMP-3.
  2093             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2094             20  FILLER                     PIC  X.
  2095         16  FILLER                         PIC  X(248).
  2096
  2097
  2098****************************************************************
  2099*             TERMINAL MASTER RECORD                           *
  2100****************************************************************
  2101
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  38
* SOCK03.cbl
  2102     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2103
  2104         16  CF-COMPANY-TERMINALS.
  2105             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2106                                  PIC X(4).
  2107         16  FILLER               PIC X(248).
  2108
  2109
  2110****************************************************************
  2111*             LIFE EDIT MASTER RECORD                          *
  2112****************************************************************
  2113
  2114     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2115         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2116             20  CF-LIFE-CODE-IN            PIC XX.
  2117             20  CF-LIFE-CODE-OUT           PIC XX.
  2118         16  FILLER                         PIC X(248).
  2119
  2120
  2121****************************************************************
  2122*             AH EDIT MASTER RECORD                            *
  2123****************************************************************
  2124
  2125     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2126         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2127             20  CF-AH-CODE-IN              PIC XXX.
  2128             20  CF-AH-CODE-OUT             PIC XX.
  2129         16  FILLER                         PIC X(248).
  2130
  2131
  2132****************************************************************
  2133*             CREDIBILITY TABLES                               *
  2134****************************************************************
  2135
  2136     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2137         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2138                             INDEXED BY CF-CRDB-NDX.
  2139             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2140             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2141             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2142         16  FILLER                         PIC  X(332).
  2143
  2144
  2145****************************************************************
  2146*             REPORT CUSTOMIZATION RECORD                      *
  2147****************************************************************
  2148
  2149     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2150         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2151             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2152             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2153             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2154**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2155****       A T-TRANSFER.                                   ****
  2156             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2157
  2158         16  FILLER                         PIC XX.
  2159
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  39
* SOCK03.cbl
  2160         16  CF-CARRIER-CNTL-OPT.
  2161             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2162                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2163                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2164             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2165                                            PIC X.
  2166         16  CF-GROUP-CNTL-OPT.
  2167             20  CF-GROUP-OPT-SEQ           PIC 9.
  2168                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2169                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2170             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2171                                            PIC X(6).
  2172         16  CF-STATE-CNTL-OPT.
  2173             20  CF-STATE-OPT-SEQ           PIC 9.
  2174                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2175                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2176             20  CF-STATE-SELECT OCCURS 3 TIMES
  2177                                            PIC XX.
  2178         16  CF-ACCOUNT-CNTL-OPT.
  2179             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2180                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2181                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2182             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2183                                            PIC X(10).
  2184         16  CF-BUS-TYP-CNTL-OPT.
  2185             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2186                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2187                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2188             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2189                                            PIC XX.
  2190         16  CF-LF-TYP-CNTL-OPT.
  2191             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2192                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2193                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2194             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2195                                            PIC XX.
  2196         16  CF-AH-TYP-CNTL-OPT.
  2197             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2198                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2199                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2200             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2201                                            PIC XX.
  2202         16  CF-REPTCD1-CNTL-OPT.
  2203             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2204                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2205                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2206             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2207                                            PIC X(10).
  2208         16  CF-REPTCD2-CNTL-OPT.
  2209             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2210                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2211                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2212             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2213                                            PIC X(10).
  2214         16  CF-USER1-CNTL-OPT.
  2215             20  CF-USER1-OPT-SEQ           PIC 9.
  2216                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2217                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  40
* SOCK03.cbl
  2218             20  CF-USER1-SELECT OCCURS 3 TIMES
  2219                                            PIC X(10).
  2220         16  CF-USER2-CNTL-OPT.
  2221             20  CF-USER2-OPT-SEQ           PIC 9.
  2222                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2223                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2224             20  CF-USER2-SELECT OCCURS 3 TIMES
  2225                                            PIC X(10).
  2226         16  CF-USER3-CNTL-OPT.
  2227             20  CF-USER3-OPT-SEQ           PIC 9.
  2228                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2229                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2230             20  CF-USER3-SELECT OCCURS 3 TIMES
  2231                                            PIC X(10).
  2232         16  CF-USER4-CNTL-OPT.
  2233             20  CF-USER4-OPT-SEQ           PIC 9.
  2234                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2235                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2236             20  CF-USER4-SELECT OCCURS 3 TIMES
  2237                                            PIC X(10).
  2238         16  CF-USER5-CNTL-OPT.
  2239             20  CF-USER5-OPT-SEQ           PIC 9.
  2240                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2241                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2242             20  CF-USER5-SELECT OCCURS 3 TIMES
  2243                                            PIC X(10).
  2244         16  CF-REINS-CNTL-OPT.
  2245             20  CF-REINS-OPT-SEQ           PIC 9.
  2246                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2247                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2248             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2249                 24  CF-REINS-PRIME         PIC XXX.
  2250                 24  CF-REINS-SUB           PIC XXX.
  2251
  2252         16  CF-AGENT-CNTL-OPT.
  2253             20  CF-AGENT-OPT-SEQ           PIC 9.
  2254                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2255                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2256             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2257                                            PIC X(10).
  2258
  2259         16  FILLER                         PIC X(43).
  2260
  2261         16  CF-LOSS-RATIO-SELECT.
  2262             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2263             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2264         16  CF-ENTRY-DATE-SELECT.
  2265             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2266             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2267         16  CF-EFFECTIVE-DATE-SELECT.
  2268             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2269             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2270
  2271         16  CF-EXCEPTION-LIST-IND          PIC X.
  2272             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2273
  2274         16  FILLER                         PIC X(318).
  2275
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  41
* SOCK03.cbl
  2276****************************************************************
  2277*                  EXCEPTION REPORTING RECORD                  *
  2278****************************************************************
  2279
  2280     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2281         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2282             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2283
  2284         16  CF-COMBINED-LIFE-AH-OPT.
  2285             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2286             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2287             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2288             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2289
  2290         16  CF-LIFE-OPT.
  2291             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2292             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2293             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2294             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2295             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2296             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2297             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2298             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2299             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2300             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2301
  2302         16  CF-AH-OPT.
  2303             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2304             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2305             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2306             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2307             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2308             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2309             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2310             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2311             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2312             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2313
  2314         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2315             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2316             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2317             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2318
  2319         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2320
  2321         16  FILLER                         PIC X(673).
  2322
  2323
  2324****************************************************************
  2325*             MORTGAGE SYSTEM PLAN RECORD                      *
  2326****************************************************************
  2327
  2328     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2329         16  CF-PLAN-TYPE                   PIC X.
  2330             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2331             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2332             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2333         16  CF-PLAN-ABBREV                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  42
* SOCK03.cbl
  2334         16  CF-PLAN-DESCRIPT               PIC X(10).
  2335         16  CF-PLAN-NOTES                  PIC X(20).
  2336         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2337         16  CF-PLAN-UNDERWRITING.
  2338             20  CF-PLAN-TERM-DATA.
  2339                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2340                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2341             20  CF-PLAN-AGE-DATA.
  2342                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2343                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2344                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2345             20  CF-PLAN-BENEFIT-DATA.
  2346                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2347                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2348                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2349                                            PIC S9(7)V99  COMP-3.
  2350         16  CF-PLAN-POLICY-FORMS.
  2351             20  CF-POLICY-FORM             PIC X(12).
  2352             20  CF-MASTER-APPLICATION      PIC X(12).
  2353             20  CF-MASTER-POLICY           PIC X(12).
  2354         16  CF-PLAN-RATING.
  2355             20  CF-RATE-CODE               PIC X(5).
  2356             20  CF-SEX-RATING              PIC X.
  2357                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2358                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2359             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2360             20  CF-SUB-STD-TYPE            PIC X.
  2361                 88  CF-PCT-OF-PREM            VALUE '1'.
  2362                 88  CF-PCT-OF-BENE            VALUE '2'.
  2363         16  CF-PLAN-PREM-TOLERANCES.
  2364             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2365             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2366         16  CF-PLAN-PYMT-TOLERANCES.
  2367             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2368             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2369         16  CF-PLAN-MISC-DATA.
  2370             20  FILLER                     PIC X.
  2371             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2372             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2373         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2374         16  CF-PLAN-IND-GRP                PIC X.
  2375             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2376                                                     '1'.
  2377             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2378                                                     '2'.
  2379         16  CF-MIB-SEARCH-SW               PIC X.
  2380             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2381             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2382             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2383             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2384         16  CF-ALPHA-SEARCH-SW             PIC X.
  2385             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2386             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2387             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2388             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2389             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2390             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2391             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  43
* SOCK03.cbl
  2392             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2393             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2394             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2395                                                     'A' 'B' 'C'
  2396                                                     'X' 'Y' 'Z'.
  2397         16  CF-EFF-DT-RULE-SW              PIC X.
  2398             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2399             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2400             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2401             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2402             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2403         16  FILLER                         PIC X(4).
  2404         16  CF-HEALTH-QUESTIONS            PIC X.
  2405             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2406         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2407         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2408         16  CF-PLAN-SNGL-JNT               PIC X.
  2409             88  CF-COMBINED-PLAN              VALUE 'C'.
  2410             88  CF-JNT-PLAN                   VALUE 'J'.
  2411             88  CF-SNGL-PLAN                  VALUE 'S'.
  2412         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2413         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2414         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2415         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2416         16  CF-RERATE-CNTL                 PIC  X.
  2417             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2418             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2419             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2420             88  CF-AUTO-RECALC                 VALUE '4'.
  2421         16  CF-BENEFIT-TYPE                PIC  X.
  2422             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2423             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2424         16  CF-POLICY-FEE                  PIC S999V99
  2425                                                    COMP-3.
  2426         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2427         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2428         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2429         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2430         16  FILLER                         PIC  X(32).
  2431         16  CF-TERMINATION-FORM            PIC  X(04).
  2432         16  FILLER                         PIC  X(08).
  2433         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2434                                                       COMP-3.
  2435         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2436         16  CF-ISSUE-LETTER                PIC  X(4).
  2437         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2438         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2439             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2440             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2441         16  CF-MP-REFUND-CALC              PIC X.
  2442             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2443             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2444             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2445             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2446             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2447             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2448             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2449             88  CF-MP-REFD-MEAN                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  44
* SOCK03.cbl
  2450         16  CF-ALT-RATE-CODE               PIC  X(5).
  2451
  2452
  2453         16  FILLER                         PIC X(498).
  2454****************************************************************
  2455*             MORTGAGE COMPANY MASTER RECORD                   *
  2456****************************************************************
  2457
  2458     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2459         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2460         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2461             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2462             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2463             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2464             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2465             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2466
  2467         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2468         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2469         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2470         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2471         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2472
  2473         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2474             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2475         16  CF-MP-RECON-USE-IND            PIC X(1).
  2476             88  CF-MP-USE-RECON             VALUE 'Y'.
  2477         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2478             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2479         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2480             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2481             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2482         16  FILLER                         PIC X(1).
  2483         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2484             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2485         16  CF-MORTG-MIB-VERSION           PIC X.
  2486             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2487             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2488             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2489         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2490             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2491                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2492             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2493                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2494             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2495                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2496             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2497                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2498             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2499                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2500             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2501                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2502         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2503         16  FILLER                         PIC X(7).
  2504         16  CF-MORTG-DESTINATION-SYMBOL.
  2505             20  CF-MORTG-MIB-COMM          PIC X(5).
  2506             20  CF-MORTG-MIB-TERM          PIC X(5).
  2507         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  45
* SOCK03.cbl
  2508             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2509         16  FILLER                         PIC X(03).
  2510         16  CF-MP-CHECK-NO-CONTROL.
  2511             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2512                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2513                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2514                                                ' ' LOW-VALUES.
  2515                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2516                                               VALUE '3'.
  2517         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2518         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2519         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2520             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2521                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2522             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2523                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2524             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2525                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2526             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2527                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2528             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2529                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2530             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2531                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2532         16  CF-MORTG-BILLING-AREA.
  2533             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2534                                            PIC X.
  2535         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2536         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2537         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2538         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2539             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2540             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2541         16  FILLER                         PIC X.
  2542         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2543             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2544             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2545         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2546         16  FILLER                         PIC X(8).
  2547         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2548         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2549         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2550         16  CF-ACH-COMPANY-ID.
  2551             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2552                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2553                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2554                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2555             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2556         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2557             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2558         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2559             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2560             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2561         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2562         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2563         16  FILLER                         PIC X(536).
  2564
  2565****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  46
* SOCK03.cbl
  2566*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2567****************************************************************
  2568
  2569     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2570         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2571             20  CF-FEMALE-HEIGHT.
  2572                 24  CF-FEMALE-FT           PIC 99.
  2573                 24  CF-FEMALE-IN           PIC 99.
  2574             20  CF-FEMALE-MIN-WT           PIC 999.
  2575             20  CF-FEMALE-MAX-WT           PIC 999.
  2576         16  FILLER                         PIC X(428).
  2577
  2578     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2579         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2580             20  CF-MALE-HEIGHT.
  2581                 24  CF-MALE-FT             PIC 99.
  2582                 24  CF-MALE-IN             PIC 99.
  2583             20  CF-MALE-MIN-WT             PIC 999.
  2584             20  CF-MALE-MAX-WT             PIC 999.
  2585         16  FILLER                         PIC X(428).
  2586******************************************************************
  2587*             AUTOMATIC ACTIVITY RECORD                          *
  2588******************************************************************
  2589     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2590         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2591             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2592             20  CF-SYS-LETTER-ID           PIC X(04).
  2593             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2594             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2595             20  CF-SYS-RESET-SW            PIC X(01).
  2596             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2597             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2598
  2599         16  FILLER                         PIC X(50).
  2600
  2601         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2602             20  CF-USER-ACTIVE-SW          PIC X(01).
  2603             20  CF-USER-LETTER-ID          PIC X(04).
  2604             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2605             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2606             20  CF-USER-RESET-SW           PIC X(01).
  2607             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2608             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2609             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2610
  2611         16  FILLER                         PIC X(246).
  2612*                                 COPY ERCACCT.
  2613******************************************************************
  2614*                                                                *
  2615*                                                                *
  2616*                            ERCACCT                             *
  2617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2618*                            VMOD=2.031                          *
  2619*                                                                *
  2620*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2621*                                                                *
  2622*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2623*   VSAM ACCOUNT MASTER FILES.                                   *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  47
* SOCK03.cbl
  2624*                                                                *
  2625*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2626*                                                                *
  2627*   FILE TYPE = VSAM,KSDS                                        *
  2628*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2629*                                                                *
  2630*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2631*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2632*                                                                *
  2633*   LOG = NO                                                     *
  2634*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2635*                                                                *
  2636*                                                                *
  2637******************************************************************
  2638*                   C H A N G E   L O G
  2639*
  2640* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2641*-----------------------------------------------------------------
  2642*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2643* EFFECTIVE    NUMBER
  2644*-----------------------------------------------------------------
  2645* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2646* 092705    2005050300006  PEMA  ADD SPP LEASES
  2647* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2648* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2649* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2650* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2651* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2652* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2653******************************************************************
  2654
  2655 01  ACCOUNT-MASTER.
  2656     12  AM-RECORD-ID                      PIC XX.
  2657         88  VALID-AM-ID                      VALUE 'AM'.
  2658
  2659     12  AM-CONTROL-PRIMARY.
  2660         16  AM-COMPANY-CD                 PIC X.
  2661         16  AM-MSTR-CNTRL.
  2662             20  AM-CONTROL-A.
  2663                 24  AM-CARRIER            PIC X.
  2664                 24  AM-GROUPING.
  2665                     28 AM-GROUPING-PREFIX PIC XXX.
  2666                     28 AM-GROUPING-PRIME  PIC XXX.
  2667                 24  AM-STATE              PIC XX.
  2668                 24  AM-ACCOUNT.
  2669                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2670                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2671             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2672                                           PIC X(19).
  2673             20  AM-CNTRL-B.
  2674                 24  AM-EXPIRATION-DT      PIC XX.
  2675                 24  FILLER                PIC X(4).
  2676             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2677                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2678
  2679     12  AM-CONTROL-BY-VAR-GRP.
  2680         16  AM-COMPANY-CD-A1              PIC X.
  2681         16  AM-VG-CARRIER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  48
* SOCK03.cbl
  2682         16  AM-VG-GROUPING                PIC X(6).
  2683         16  AM-VG-STATE                   PIC XX.
  2684         16  AM-VG-ACCOUNT                 PIC X(10).
  2685         16  AM-VG-DATE.
  2686             20  AM-VG-EXPIRATION-DT       PIC XX.
  2687             20  FILLER                    PIC X(4).
  2688         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2689                                           PIC 9(11)      COMP-3.
  2690     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2691         16  FILLER                        PIC X(10).
  2692         16  AM-VG-KEY3.
  2693             20  AM-VG3-ACCOUNT            PIC X(10).
  2694             20  AM-VG3-EXP-DT             PIC XX.
  2695         16  FILLER                        PIC X(4).
  2696     12  AM-MAINT-INFORMATION.
  2697         16  AM-LAST-MAINT-DT              PIC XX.
  2698         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2699         16  AM-LAST-MAINT-USER            PIC X(4).
  2700         16  FILLER                        PIC XX.
  2701
  2702     12  AM-EFFECTIVE-DT                   PIC XX.
  2703     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2704
  2705     12  AM-PREV-DATES  COMP-3.
  2706         16  AM-PREV-EXP-DT                PIC 9(11).
  2707         16  AM-PREV-EFF-DT                PIC 9(11).
  2708
  2709     12  AM-REPORT-CODE-1                  PIC X(10).
  2710     12  AM-REPORT-CODE-2                  PIC X(10).
  2711
  2712     12  AM-CITY-CODE                      PIC X(4).
  2713     12  AM-COUNTY-PARISH                  PIC X(6).
  2714
  2715     12  AM-NAME                           PIC X(30).
  2716     12  AM-PERSON                         PIC X(30).
  2717     12  AM-ADDRS                          PIC X(30).
  2718     12  AM-CITY.
  2719         16  AM-ADDR-CITY                  PIC X(28).
  2720         16  AM-ADDR-STATE                 PIC XX.
  2721     12  AM-ZIP.
  2722         16  AM-ZIP-PRIME.
  2723             20  AM-ZIP-PRI-1ST            PIC X.
  2724                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2725             20  FILLER                    PIC X(4).
  2726         16  AM-ZIP-PLUS4                  PIC X(4).
  2727     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2728         16  AM-CAN-POSTAL-1               PIC XXX.
  2729         16  AM-CAN-POSTAL-2               PIC XXX.
  2730         16  FILLER                        PIC XXX.
  2731     12  AM-TEL-NO.
  2732         16  AM-AREA-CODE                  PIC 999.
  2733         16  AM-TEL-PRE                    PIC 999.
  2734         16  AM-TEL-NBR                    PIC 9(4).
  2735     12  AM-TEL-LOC                        PIC X.
  2736         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2737         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2738
  2739     12  AM-COMM-STRUCTURE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  49
* SOCK03.cbl
  2740         16  AM-DEFN-1.
  2741             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2742                 24  AM-AGT.
  2743                     28  AM-AGT-PREFIX     PIC X(4).
  2744                     28  AM-AGT-PRIME      PIC X(6).
  2745                 24  AM-COM-TYP            PIC X.
  2746                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2747                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2748                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2749                 24  AM-RECALC-LV-INDIC    PIC X.
  2750                 24  AM-RETRO-LV-INDIC     PIC X.
  2751                 24  AM-GL-CODES           PIC X.
  2752                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2753                 24  FILLER                PIC X(01).
  2754         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2755             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2756                 24  FILLER                PIC X(11).
  2757                 24  AM-L-COMA             PIC XXX.
  2758                 24  AM-J-COMA             PIC XXX.
  2759                 24  AM-A-COMA             PIC XXX.
  2760                 24  FILLER                PIC X(6).
  2761
  2762     12  AM-COMM-CHANGE-STATUS             PIC X.
  2763         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2764
  2765     12  AM-CSR-CODE                       PIC X(4).
  2766
  2767     12  AM-BILLING-STATUS                 PIC X.
  2768         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2769         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2770     12  AM-AUTO-REFUND-SW                 PIC X.
  2771         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2772         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2773     12  AM-GPCD                           PIC 99.
  2774     12  AM-IG                             PIC X.
  2775         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2776         88  AM-HAS-GROUP                     VALUE '2'.
  2777     12  AM-STATUS                         PIC X.
  2778         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2779         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2780         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2781         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2782         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2783         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2784         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2785         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2786         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2787         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2788     12  AM-REMIT-TO                       PIC 99.
  2789     12  AM-ID-NO                          PIC X(11).
  2790
  2791     12  AM-CAL-TABLE                      PIC XX.
  2792     12  AM-LF-DEVIATION                   PIC XXX.
  2793     12  AM-AH-DEVIATION                   PIC XXX.
  2794     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2795     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2796     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2797     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  50
* SOCK03.cbl
  2798     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2799     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2800
  2801     12  AM-USER-FIELDS.
  2802         16  AM-FLD-1                      PIC XX.
  2803         16  AM-FLD-2                      PIC XX.
  2804         16  AM-FLD-3                      PIC XX.
  2805         16  AM-FLD-4                      PIC XX.
  2806         16  AM-FLD-5                      PIC XX.
  2807
  2808     12  AM-1ST-PROD-DATE.
  2809         16  AM-1ST-PROD-YR                PIC XX.
  2810         16  AM-1ST-PROD-MO                PIC XX.
  2811         16  AM-1ST-PROD-DA                PIC XX.
  2812     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2813     12  AM-CERTS-PURGED-DATE.
  2814         16  AM-PUR-YR                     PIC XX.
  2815         16  AM-PUR-MO                     PIC XX.
  2816         16  AM-PUR-DA                     PIC XX.
  2817     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2818     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2819     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2820     12  AM-INACTIVE-DATE.
  2821         16  AM-INA-MO                     PIC 99.
  2822         16  AM-INA-DA                     PIC 99.
  2823         16  AM-INA-YR                     PIC 99.
  2824     12  AM-AR-HI-CERT-DATE                PIC XX.
  2825
  2826     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2827     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2828
  2829     12  AM-OB-PAYMENT-MODE                PIC X.
  2830         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2831         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2832         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2833         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2834
  2835     12  AM-AH-ONLY-INDICATOR              PIC X.
  2836         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2837         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2838
  2839     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2840
  2841     12  AM-OVER-SHORT.
  2842         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2843         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2844
  2845     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2846     12  AM-DCC-CLP-STATE                  PIC XX.
  2847
  2848     12  AM-RECALC-COMM                    PIC X.
  2849     12  AM-RECALC-REIN                    PIC X.
  2850
  2851     12  AM-REI-TABLE                      PIC XXX.
  2852     12  AM-REI-ET-LF                      PIC X.
  2853     12  AM-REI-ET-AH                      PIC X.
  2854     12  AM-REI-PE-LF                      PIC X.
  2855     12  AM-REI-PE-AH                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  51
* SOCK03.cbl
  2856     12  AM-REI-PRT-ST                     PIC X.
  2857     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2858     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2859     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2860     12  AM-REI-GROUP-A                    PIC X(6).
  2861     12  AM-REI-MORT                       PIC X(4).
  2862     12  AM-REI-PRT-OW                     PIC X.
  2863     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2864     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2865     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2866     12  AM-REI-GROUP-B                    PIC X(6).
  2867
  2868     12  AM-TRUST-TYPE                     PIC X(2).
  2869
  2870     12  AM-EMPLOYER-STMT-USED             PIC X.
  2871     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2872
  2873     12  AM-STD-AH-TYPE                    PIC XX.
  2874     12  AM-EARN-METHODS.
  2875         16  AM-EARN-METHOD-R              PIC X.
  2876             88 AM-REF-RL-R78                 VALUE 'R'.
  2877             88 AM-REF-RL-PR                  VALUE 'P'.
  2878             88 AM-REF-RL-MEAN                VALUE 'M'.
  2879             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2880         16  AM-EARN-METHOD-L              PIC X.
  2881             88 AM-REF-LL-R78                 VALUE 'R'.
  2882             88 AM-REF-LL-PR                  VALUE 'P'.
  2883             88 AM-REF-LL-MEAN                VALUE 'M'.
  2884             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2885         16  AM-EARN-METHOD-A              PIC X.
  2886             88 AM-REF-AH-R78                 VALUE 'R'.
  2887             88 AM-REF-AH-PR                  VALUE 'P'.
  2888             88 AM-REF-AH-MEAN                VALUE 'M'.
  2889             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2890             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2891             88 AM-REF-AH-NET                 VALUE 'N'.
  2892
  2893     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2894     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2895     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2896
  2897     12  AM-RET-Y-N                        PIC X.
  2898     12  AM-RET-P-E                        PIC X.
  2899     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2900     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2901     12  AM-RET-GRP                        PIC X(6).
  2902     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2903         16  AM-POOL-PRIME                 PIC XXX.
  2904         16  AM-POOL-SUB                   PIC XXX.
  2905     12  AM-RETRO-EARNINGS.
  2906         16  AM-RET-EARN-R                 PIC X.
  2907         16  AM-RET-EARN-L                 PIC X.
  2908         16  AM-RET-EARN-A                 PIC X.
  2909     12  AM-RET-ST-TAX-USE                 PIC X.
  2910         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2911         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2912     12  AM-RETRO-BEG-EARNINGS.
  2913         16  AM-RET-BEG-EARN-R             PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  52
* SOCK03.cbl
  2914         16  AM-RET-BEG-EARN-L             PIC X.
  2915         16  AM-RET-BEG-EARN-A             PIC X.
  2916     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2917     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2918
  2919     12  AM-USER-SELECT-OPTIONS.
  2920         16  AM-USER-SELECT-1              PIC X(10).
  2921         16  AM-USER-SELECT-2              PIC X(10).
  2922         16  AM-USER-SELECT-3              PIC X(10).
  2923         16  AM-USER-SELECT-4              PIC X(10).
  2924         16  AM-USER-SELECT-5              PIC X(10).
  2925
  2926     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2927
  2928     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2929
  2930     12  AM-RPT045A-SWITCH                 PIC X.
  2931         88  RPT045A-OFF                   VALUE 'N'.
  2932
  2933     12  AM-INSURANCE-LIMITS.
  2934         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2935         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2936
  2937     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2938         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2939
  2940     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2941         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2942         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2943
  2944     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2945
  2946     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2947     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2948     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2949     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2950     12  AM-DCC-UEF-STATE                  PIC XX.
  2951     12  FILLER                            PIC XXX.
  2952     12  AM-REPORT-CODE-3                  PIC X(10).
  2953*    12  FILLER                            PIC X(22).
  2954
  2955     12  AM-RESERVE-DATE.
  2956         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2957         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2958         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2959
  2960     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2961     12  AM-NOTIFICATION-TYPES.
  2962         16  AM-NOTIF-OF-LETTERS           PIC X.
  2963         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2964         16  AM-NOTIF-OF-REPORTS           PIC X.
  2965         16  AM-NOTIF-OF-STATUS            PIC X.
  2966
  2967     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2968         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2969         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2970         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2971         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  53
* SOCK03.cbl
  2972
  2973     12  AM-BENEFIT-CONTROLS.
  2974         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2975             20  AM-BENEFIT-CODE           PIC XX.
  2976             20  AM-BENEFIT-TYPE           PIC X.
  2977             20  AM-BENEFIT-REVISION       PIC XXX.
  2978             20  AM-BENEFIT-REM-TERM       PIC X.
  2979             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2980             20  FILLER                    PIC XX.
  2981         16  FILLER                        PIC X(80).
  2982
  2983     12  AM-TRANSFER-DATA.
  2984         16  AM-TRANSFERRED-FROM.
  2985             20  AM-TRNFROM-CARRIER        PIC X.
  2986             20  AM-TRNFROM-GROUPING.
  2987                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2988                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2989             20  AM-TRNFROM-STATE          PIC XX.
  2990             20  AM-TRNFROM-ACCOUNT.
  2991                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2992                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2993             20  AM-TRNFROM-DTE            PIC XX.
  2994         16  AM-TRANSFERRED-TO.
  2995             20  AM-TRNTO-CARRIER          PIC X.
  2996             20  AM-TRNTO-GROUPING.
  2997                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2998                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2999             20  AM-TRNTO-STATE            PIC XX.
  3000             20  AM-TRNTO-ACCOUNT.
  3001                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3002                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3003             20  AM-TRNTO-DTE              PIC XX.
  3004         16  FILLER                        PIC X(10).
  3005
  3006     12  AM-SAVED-REMIT-TO                 PIC 99.
  3007
  3008     12  AM-COMM-STRUCTURE-SAVED.
  3009         16  AM-DEFN-1-SAVED.
  3010             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3011                 24  AM-AGT-SV             PIC X(10).
  3012                 24  AM-COM-TYP-SV         PIC X.
  3013                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3014                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3015                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3016                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3017                 24  FILLER                PIC X.
  3018                 24  AM-GL-CODES-SV        PIC X.
  3019                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3020                 24  FILLER                PIC X.
  3021         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3022             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3023                 24  FILLER                PIC X(11).
  3024                 24  AM-L-COMA-SV          PIC XXX.
  3025                 24  AM-J-COMA-SV          PIC XXX.
  3026                 24  AM-A-COMA-SV          PIC XXX.
  3027                 24  FILLER                PIC X(6).
  3028
  3029     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  54
* SOCK03.cbl
  3030         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3031            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3032            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3033            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3034
  3035     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3036     12  FILLER                            PIC X(120).
  3037
  3038     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3039         16  AM-CONTROL-NAME               PIC X(30).
  3040         16  AM-EXECUTIVE-ONE.
  3041             20  AM-EXEC1-NAME             PIC X(15).
  3042             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3043                                                          COMP-3.
  3044             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3045                                                          COMP-3.
  3046         16  AM-EXECUTIVE-TWO.
  3047             20  AM-EXEC2-NAME             PIC X(15).
  3048             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3049                                                          COMP-3.
  3050             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3051                                                          COMP-3.
  3052
  3053     12  AM-RETRO-ADDITIONAL-DATA.
  3054         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3055         16  AM-RETRO-PREM-P-E             PIC X.
  3056         16  AM-RETRO-CLMS-P-I             PIC X.
  3057         16  AM-RETRO-RET-BRACKET-LF.
  3058             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3059                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3060                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3061             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3062                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3063                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3064             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3065                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3066                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3067         16  AM-RETRO-RET-BRACKET-AH.
  3068             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3069                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3070                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3071                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3072             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3073                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3074                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3075             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3076                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3077                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3078
  3079     12  AM-COMMENTS.
  3080         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3081
  3082     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3083         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3084         16  AM-FLI-BILLING-CODE           PIC X.
  3085         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3086         16  AM-FLI-UNITED-IDENT           PIC X.
  3087         16  AM-FLI-INTEREST-LOST-DATA.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  55
* SOCK03.cbl
  3088             20  AM-FLI-BANK-NO            PIC X(5).
  3089             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3090             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3091             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3092         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3093             20  AM-FLI-AGT                PIC X(9).
  3094             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3095             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3096         16  FILLER                        PIC X(102).
  3097
  3098     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3099         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3100             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3101             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3102             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3103             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3104             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3105         16  FILLER                          PIC X(10).
  3106******************************************************************
  3107*                                 COPY ERCMAIL.
  3108******************************************************************
  3109*                                                                *
  3110*                                                                *
  3111*                            ERCMAIL                             *
  3112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3113*                            VMOD=2.003                          *
  3114*                                                                *
  3115*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3116*                                                                *
  3117*   FILE TYPE = VSAM,KSDS                                        *
  3118*   RECORD SIZE = 374   RECFORM = FIX                            *
  3119*                                                                *
  3120*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3121*   ALTERNATE PATH    = NOT USED                                 *
  3122*                                                                *
  3123*   LOG = YES                                                    *
  3124*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3125******************************************************************
  3126*                   C H A N G E   L O G
  3127*
  3128* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3129*-----------------------------------------------------------------
  3130*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3131* EFFECTIVE    NUMBER
  3132*-----------------------------------------------------------------
  3133* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3134* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3135* 111108                   PEMA  ADD CRED BENE ADDR2
  3136******************************************************************
  3137
  3138 01  MAILING-DATA.
  3139     12  MA-RECORD-ID                      PIC XX.
  3140         88  VALID-MA-ID                       VALUE 'MA'.
  3141
  3142     12  MA-CONTROL-PRIMARY.
  3143         16  MA-COMPANY-CD                 PIC X.
  3144         16  MA-CARRIER                    PIC X.
  3145         16  MA-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  56
* SOCK03.cbl
  3146             20  MA-GROUPING-PREFIX        PIC XXX.
  3147             20  MA-GROUPING-PRIME         PIC XXX.
  3148         16  MA-STATE                      PIC XX.
  3149         16  MA-ACCOUNT.
  3150             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3151             20  MA-ACCOUNT-PRIME          PIC X(6).
  3152         16  MA-CERT-EFF-DT                PIC XX.
  3153         16  MA-CERT-NO.
  3154             20  MA-CERT-PRIME             PIC X(10).
  3155             20  MA-CERT-SFX               PIC X.
  3156
  3157     12  FILLER                            PIC XX.
  3158
  3159     12  MA-ACCESS-CONTROL.
  3160         16  MA-SOURCE-SYSTEM              PIC XX.
  3161             88  MA-FROM-CREDIT                VALUE 'CR'.
  3162             88  MA-FROM-VSI                   VALUE 'VS'.
  3163             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3164             88  MA-FROM-OTHER                 VALUE 'OT'.
  3165         16  MA-RECORD-ADD-DT              PIC XX.
  3166         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3167         16  MA-LAST-MAINT-DT              PIC XX.
  3168         16  MA-LAST-MAINT-BY              PIC XXXX.
  3169         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3170
  3171     12  MA-PROFILE-INFO.
  3172         16  MA-QUALIFY-CODE-1             PIC XX.
  3173         16  MA-QUALIFY-CODE-2             PIC XX.
  3174         16  MA-QUALIFY-CODE-3             PIC XX.
  3175         16  MA-QUALIFY-CODE-4             PIC XX.
  3176         16  MA-QUALIFY-CODE-5             PIC XX.
  3177
  3178         16  MA-INSURED-LAST-NAME          PIC X(15).
  3179         16  MA-INSURED-FIRST-NAME         PIC X(10).
  3180         16  MA-INSURED-MIDDLE-INIT        PIC X.
  3181         16  MA-INSURED-ISSUE-AGE          PIC 99.
  3182         16  MA-INSURED-BIRTH-DT           PIC XX.
  3183         16  MA-INSURED-SEX                PIC X.
  3184             88  MA-SEX-MALE                   VALUE 'M'.
  3185             88  MA-SEX-FEMALE                 VALUE 'F'.
  3186         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  3187
  3188         16  MA-ADDRESS-CORRECTED          PIC X.
  3189         16  MA-JOINT-BIRTH-DT             PIC XX.
  3190*        16  FILLER                        PIC X(12).
  3191
  3192         16  MA-ADDRESS-LINE-1             PIC X(30).
  3193         16  MA-ADDRESS-LINE-2             PIC X(30).
  3194         16  MA-CITY-STATE.
  3195             20  MA-CITY                   PIC X(28).
  3196             20  MA-ADDR-STATE             PIC XX.
  3197         16  MA-ZIP.
  3198             20  MA-ZIP-CODE.
  3199                 24  MA-ZIP-CODE-1ST       PIC X(1).
  3200                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3201                 24  FILLER                PIC X(4).
  3202             20  MA-ZIP-PLUS4              PIC X(4).
  3203         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  57
* SOCK03.cbl
  3204             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  3205             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  3206             20  FILLER                    PIC X(3).
  3207
  3208         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  3209
  3210         16  FILLER                        PIC XXX.
  3211*        16  FILLER                        PIC X(10).
  3212
  3213     12  MA-CRED-BENE-INFO.
  3214         16  MA-CRED-BENE-NAME                 PIC X(25).
  3215         16  MA-CRED-BENE-ADDR                 PIC X(30).
  3216         16  MA-CRED-BENE-ADDR2                PIC X(30).
  3217         16  MA-CRED-BENE-CTYST.
  3218             20  MA-CRED-BENE-CITY             PIC X(28).
  3219             20  MA-CRED-BENE-STATE            PIC XX.
  3220         16  MA-CRED-BENE-ZIP.
  3221             20  MA-CB-ZIP-CODE.
  3222                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  3223                     88  MA-CB-CANADIAN-POST-CODE
  3224                                           VALUE 'A' THRU 'Z'.
  3225                 24  FILLER                    PIC X(4).
  3226             20  MA-CB-ZIP-PLUS4               PIC X(4).
  3227         16  MA-CB-CANADIAN-POSTAL-CODE
  3228                            REDEFINES MA-CRED-BENE-ZIP.
  3229             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  3230             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  3231             20  FILLER                        PIC X(3).
  3232     12  MA-POST-CARD-MAIL-DATA.
  3233         16  MA-MAIL-DATA OCCURS 7.
  3234             20  MA-MAIL-TYPE              PIC X.
  3235                 88  MA-12MO-MAILING           VALUE '1'.
  3236                 88  MA-EXP-MAILING            VALUE '2'.
  3237             20  MA-MAIL-STATUS            PIC X.
  3238                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  3239                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  3240                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  3241             20  MA-MAIL-DATE              PIC XX.
  3242     12  FILLER                            PIC XX.
  3243     12  FILLER                            PIC XX.
  3244*    12  FILLER                            PIC X(30).
  3245******************************************************************
  3246*                                 COPY ELCCRTT.
  3247******************************************************************
  3248*                                                                *
  3249*                            ELCCRTT.                            *
  3250*                                                                *
  3251*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3252*                                                                *
  3253*   FILE TYPE = VSAM,KSDS                                        *
  3254*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3255*                                                                *
  3256*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3257*                                                                *
  3258*   LOG = YES                                                    *
  3259*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3260******************************************************************
  3261*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  58
* SOCK03.cbl
  3262*
  3263* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3264*-----------------------------------------------------------------
  3265*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3266* EFFECTIVE    NUMBER
  3267*-----------------------------------------------------------------
  3268* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3269* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3270* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3271* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3272* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3273* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3274* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3275* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3276* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3277* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3278* 091318  CR2018073000001  PEMA  ADD Refund methods
  3279* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3280******************************************************************
  3281
  3282 01  CERTIFICATE-TRAILERS.
  3283     12  CS-RECORD-ID                      PIC XX.
  3284         88  VALID-CS-ID                      VALUE 'CS'.
  3285
  3286     12  CS-CONTROL-PRIMARY.
  3287         16  CS-COMPANY-CD                 PIC X.
  3288         16  CS-CARRIER                    PIC X.
  3289         16  CS-GROUPING                   PIC X(6).
  3290         16  CS-STATE                      PIC XX.
  3291         16  CS-ACCOUNT                    PIC X(10).
  3292         16  CS-CERT-EFF-DT                PIC XX.
  3293         16  CS-CERT-NO.
  3294             20  CS-CERT-PRIME             PIC X(10).
  3295             20  CS-CERT-SFX               PIC X.
  3296         16  CS-TRAILER-TYPE               PIC X.
  3297             88  COMM-TRLR           VALUE 'A'.
  3298             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3299             88  CERT-DATA-TRLR      VALUE 'C'.
  3300
  3301     12  CS-DATA-AREA                      PIC X(516).
  3302
  3303     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3304         16  CS-BANK-COMMISSION-AREA.
  3305             20  CS-BANK-COMMS       OCCURS 10.
  3306                 24  CS-AGT                PIC X(10).
  3307                 24  CS-COM-TYP            PIC X.
  3308                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3309                 24  CS-RECALC-LV-INDIC    PIC X.
  3310                 24  FILLER                PIC X(10).
  3311         16  FILLER                        PIC X(256).
  3312
  3313     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3314****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3315         16  CS-MB-CLAIM-DATA OCCURS 24.
  3316             20  CS-CLAIM-NO               PIC X(7).
  3317             20  CS-CLAIM-TYPE             PIC X.
  3318                 88  CS-AH-CLM               VALUE 'A'.
  3319                 88  CS-IU-CLM               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  59
* SOCK03.cbl
  3320                 88  CS-GP-CLM               VALUE 'G'.
  3321                 88  CS-LF-CLM               VALUE 'L'.
  3322                 88  CS-PR-CLM               VALUE 'P'.
  3323                 88  CS-FL-CLM               VALUE 'F'.
  3324                 88  CS-OT-CLM               VALUE 'O'.
  3325             20  CS-INSURED-TYPE           PIC X.
  3326                 88  CS-PRIM-INSURED          VALUE 'P'.
  3327                 88  CS-CO-BORROWER           VALUE 'C'.
  3328             20  CS-BENEFIT-PERIOD         PIC 99.
  3329             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3330             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3331             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3332         16  FILLER                        PIC X(12).
  3333     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3334         16  CS-VIN-NUMBER                 PIC X(17).
  3335         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3336         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3337         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3338         16  cs-agent-name.
  3339             20  cs-agent-fname            pic x(20).
  3340             20  cs-agent-mi               pic x.
  3341             20  cs-agent-lname            pic x(25).
  3342         16  cs-license-no                 pic x(15).
  3343         16  cs-npn-number                 pic x(10).
  3344         16  cs-agent-edit-status          pic x.
  3345             88  cs-ae-refer-to-manager      value 'M'.
  3346             88  cs-ae-cover-sheet           value 'C'.
  3347             88  cs-ae-sig-form              value 'S'.
  3348             88  cs-ae-verified              value 'V'.
  3349             88  cs-unidentified-signature   value 'U'.
  3350             88  cs-cert-returned            value 'R'.
  3351             88  cs-accept-no-commission     value 'N'.
  3352         16  cs-year                       pic 9999.
  3353         16  cs-make                       pic x(20).
  3354         16  cs-model                      pic x(20).
  3355         16  cs-future                     pic x(20).
  3356         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3357         16  cs-claim-verification-status  pic x.
  3358             88  cs-clm-ver-eligible         value 'A'.
  3359             88  cs-clm-ver-partial-elig     value 'B'.
  3360             88  cs-clm-ver-not-eligible     value 'C'.
  3361             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3362             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3363             88  cs-clm-ver-ND-CERT          value 'F'.
  3364             88  cs-clm-ver-spec-other       value 'G'.
  3365             88  cs-clam-ver-pratial-corrected
  3366                                             value 'H'.
  3367             88  cs-clm-ver-no-matches       value 'I'.
  3368             88  cs-clm-ver-not-elig-corrected
  3369                                             value 'J'.
  3370             88  cs-clm-ver-needs-review     value 'R'.
  3371             88  cs-clm-ver-sent-to-claims   value 'W'.
  3372         16  CS-LF-REFUND-METHOD           PIC X.
  3373         16  CS-AH-REFUND-METHOD           PIC X.
  3374         16  FILLER                        PIC X(353). *> was 420
  3375*        16  FILLER                        PIC X(496).
  3376*                                 COPY ELCDATE.
  3377******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  60
* SOCK03.cbl
  3378*                                                                *
  3379*                                                                *
  3380*                            ELCDATE.                            *
  3381*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3382*                            VMOD=2.003
  3383*                                                                *
  3384*                                                                *
  3385*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3386*                 LENGTH = 200                                   *
  3387******************************************************************
  3388
  3389 01  DATE-CONVERSION-DATA.
  3390     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3391     12  DC-OPTION-CODE                PIC X.
  3392         88  BIN-TO-GREG                VALUE ' '.
  3393         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3394         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3395         88  YMD-GREG-TO-BIN            VALUE '3'.
  3396         88  MDY-GREG-TO-BIN            VALUE '4'.
  3397         88  JULIAN-TO-BIN              VALUE '5'.
  3398         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3399         88  FIND-CENTURY               VALUE '7'.
  3400         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3401         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3402         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3403         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3404         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3405         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3406         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3407         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3408         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3409         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3410         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3411         88  BIN-3-TO-GREG              VALUE 'I'.
  3412         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3413         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3414         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3415         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3416         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3417         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3418         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3419         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3420         88  THREE-CHARACTER-BIN
  3421                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3422         88  GREGORIAN-TO-BIN
  3423                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3424         88  BIN-TO-GREGORIAN
  3425                  VALUES ' ' '1' 'I' '8' 'G'.
  3426         88  JULIAN-TO-BINARY
  3427                  VALUES '5' 'C' 'E' 'F'.
  3428     12  DC-ERROR-CODE                 PIC X.
  3429         88  NO-CONVERSION-ERROR        VALUE ' '.
  3430         88  DATE-CONVERSION-ERROR
  3431                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3432         88  DATE-IS-ZERO               VALUE '1'.
  3433         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3434         88  DATE-IS-INVALID            VALUE '3'.
  3435         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  61
* SOCK03.cbl
  3436         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3437         88  DATE-INVALID-OPTION        VALUE '9'.
  3438         88  INVALID-CENTURY            VALUE 'A'.
  3439         88  ONLY-CENTURY               VALUE 'B'.
  3440         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3441         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3442     12  DC-END-OF-MONTH               PIC X.
  3443         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3444     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3445         88  USE-NORMAL-PROCESS         VALUE ' '.
  3446         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3447         88  ADJUST-UP-100-YRS          VALUE '2'.
  3448     12  FILLER                        PIC X.
  3449     12  DC-CONVERSION-DATES.
  3450         16  DC-BIN-DATE-1             PIC XX.
  3451         16  DC-BIN-DATE-2             PIC XX.
  3452         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3453         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3454                       DC-GREG-DATE-1-EDIT.
  3455             20  DC-EDIT1-MONTH        PIC 99.
  3456             20  SLASH1-1              PIC X.
  3457             20  DC-EDIT1-DAY          PIC 99.
  3458             20  SLASH1-2              PIC X.
  3459             20  DC-EDIT1-YEAR         PIC 99.
  3460         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3461         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3462                     DC-GREG-DATE-2-EDIT.
  3463             20  DC-EDIT2-MONTH        PIC 99.
  3464             20  SLASH2-1              PIC X.
  3465             20  DC-EDIT2-DAY          PIC 99.
  3466             20  SLASH2-2              PIC X.
  3467             20  DC-EDIT2-YEAR         PIC 99.
  3468         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3469         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3470                     DC-GREG-DATE-1-YMD.
  3471             20  DC-YMD-YEAR           PIC 99.
  3472             20  DC-YMD-MONTH          PIC 99.
  3473             20  DC-YMD-DAY            PIC 99.
  3474         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3475         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3476                      DC-GREG-DATE-1-MDY.
  3477             20  DC-MDY-MONTH          PIC 99.
  3478             20  DC-MDY-DAY            PIC 99.
  3479             20  DC-MDY-YEAR           PIC 99.
  3480         16  DC-GREG-DATE-1-ALPHA.
  3481             20  DC-ALPHA-MONTH        PIC X(10).
  3482             20  DC-ALPHA-DAY          PIC 99.
  3483             20  FILLER                PIC XX.
  3484             20  DC-ALPHA-CENTURY.
  3485                 24 DC-ALPHA-CEN-N     PIC 99.
  3486             20  DC-ALPHA-YEAR         PIC 99.
  3487         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3488         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3489         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3490         16  DC-JULIAN-DATE            PIC 9(05).
  3491         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3492                                       PIC 9(05).
  3493         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  62
* SOCK03.cbl
  3494             20  DC-JULIAN-YEAR        PIC 99.
  3495             20  DC-JULIAN-DAYS        PIC 999.
  3496         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3497         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3498         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3499     12  DATE-CONVERSION-VARIBLES.
  3500         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3501         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3502             20  FILLER                PIC 9(3).
  3503             20  HOLD-CEN-1-CCYY.
  3504                 24  HOLD-CEN-1-CC     PIC 99.
  3505                 24  HOLD-CEN-1-YY     PIC 99.
  3506             20  HOLD-CEN-1-MO         PIC 99.
  3507             20  HOLD-CEN-1-DA         PIC 99.
  3508         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3509             20  HOLD-CEN-1-R-MO       PIC 99.
  3510             20  HOLD-CEN-1-R-DA       PIC 99.
  3511             20  HOLD-CEN-1-R-CCYY.
  3512                 24  HOLD-CEN-1-R-CC   PIC 99.
  3513                 24  HOLD-CEN-1-R-YY   PIC 99.
  3514             20  FILLER                PIC 9(3).
  3515         16  HOLD-CENTURY-1-X.
  3516             20  FILLER                PIC X(3)  VALUE SPACES.
  3517             20  HOLD-CEN-1-X-CCYY.
  3518                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3519                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3520             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3521             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3522         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3523             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3524             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3525             20  HOLD-CEN-1-R-X-CCYY.
  3526                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3527                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3528             20  FILLER                PIC XXX.
  3529         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3530         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3531         16  DC-JULIAN-DATE-1          PIC 9(07).
  3532         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3533             20  DC-JULIAN-1-CCYY.
  3534                 24  DC-JULIAN-1-CC    PIC 99.
  3535                 24  DC-JULIAN-1-YR    PIC 99.
  3536             20  DC-JULIAN-DA-1        PIC 999.
  3537         16  DC-JULIAN-DATE-2          PIC 9(07).
  3538         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3539             20  DC-JULIAN-2-CCYY.
  3540                 24  DC-JULIAN-2-CC    PIC 99.
  3541                 24  DC-JULIAN-2-YR    PIC 99.
  3542             20  DC-JULIAN-DA-2        PIC 999.
  3543         16  DC-GREG-DATE-A-EDIT.
  3544             20  DC-EDITA-MONTH        PIC 99.
  3545             20  SLASHA-1              PIC X VALUE '/'.
  3546             20  DC-EDITA-DAY          PIC 99.
  3547             20  SLASHA-2              PIC X VALUE '/'.
  3548             20  DC-EDITA-CCYY.
  3549                 24  DC-EDITA-CENT     PIC 99.
  3550                 24  DC-EDITA-YEAR     PIC 99.
  3551         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  63
* SOCK03.cbl
  3552             20  DC-EDITB-MONTH        PIC 99.
  3553             20  SLASHB-1              PIC X VALUE '/'.
  3554             20  DC-EDITB-DAY          PIC 99.
  3555             20  SLASHB-2              PIC X VALUE '/'.
  3556             20  DC-EDITB-CCYY.
  3557                 24  DC-EDITB-CENT     PIC 99.
  3558                 24  DC-EDITB-YEAR     PIC 99.
  3559         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3560         16  DC-GREG-DATE-CYMD-R REDEFINES
  3561                              DC-GREG-DATE-CYMD.
  3562             20  DC-CYMD-CEN           PIC 99.
  3563             20  DC-CYMD-YEAR          PIC 99.
  3564             20  DC-CYMD-MONTH         PIC 99.
  3565             20  DC-CYMD-DAY           PIC 99.
  3566         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3567         16  DC-GREG-DATE-MDCY-R REDEFINES
  3568                              DC-GREG-DATE-MDCY.
  3569             20  DC-MDCY-MONTH         PIC 99.
  3570             20  DC-MDCY-DAY           PIC 99.
  3571             20  DC-MDCY-CEN           PIC 99.
  3572             20  DC-MDCY-YEAR          PIC 99.
  3573    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3574        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3575    12  DC-EL310-DATE                  PIC X(21).
  3576    12  FILLER                         PIC X(28).
  3577*                                 COPY ELCCALC.
  3578******************************************************************
  3579*                                                                *
  3580*                           ELCCALC.                            *
  3581*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3582*                            VMOD=2.025                          *
  3583*                                                                *
  3584*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3585*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3586*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3587*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3588*                                                                *
  3589*  PASSED TO ELRTRM                                              *
  3590*  -----------------                                             *
  3591*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3592*  ORIGINAL TERM                                                 *
  3593*  BEGINNING DATE                                                *
  3594*  ENDING DATE                                                   *
  3595*  COMPANY I.D.                                                  *
  3596*  ACCOUNT MASTER USER FIELD                                     *
  3597*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3598*  FREE LOOK DAYS                                                *
  3599*                                                                *
  3600*  RETURNED FROM ELRTRM                                          *
  3601*  ---------------------                                         *
  3602*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3603*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3604*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3605*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3606*----------------------------------------------------------------*
  3607*  PASSED TO ELRAMT                                              *
  3608*  ----------------                                              *
  3609*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  64
* SOCK03.cbl
  3610*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3611*  ORIGINAL AMOUNT                                               *
  3612*  ALTERNATE BENEFIT (BALLON)                                    *
  3613*  A.P.R. - NET PAY ONLY                                         *
  3614*  METHOD
  3615*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3616*  COMPANY I.D.                                                  *
  3617*  BENEFIT TYPE                                                  *
  3618*                                                                *
  3619*  RETURNED FROM ELRAMT                                          *
  3620*  --------------------                                          *
  3621*  REMAINING AMOUNT 1 - CURRENT                                  *
  3622*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3623*  REMAINING AMOUNT FACTOR
  3624*----------------------------------------------------------------*
  3625*  PASSED TO ELRESV                                              *
  3626*  -----------------                                             *
  3627*  CERTIFICATE EFFECTIVE DATE                                    *
  3628*  VALUATION DATE                                                *
  3629*  PAID THRU DATE                                                *
  3630*  BENEFIT                                                       *
  3631*  INCURRED DATE                                                 *
  3632*  REPORTED DATE                                                 *
  3633*  ISSUE AGE                                                     *
  3634*  TERM                                                          *
  3635*  CDT PERCENT                                                   *
  3636*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3637* *CLAIM TYPE (LIFE, A/H)                                        *
  3638* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3639* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3640*                                                                *
  3641*  RETURNED FROM ELRESV                                          *
  3642*  --------------------                                          *
  3643*  CDT TABLE USED                                                *
  3644*  CDT FACTOR USED                                               *
  3645*  PAY TO CURRENT RESERVE                                        *
  3646*  I.B.N.R. - A/H ONLY                                           *
  3647*  FUTURE (ACCRUED) AH ONLY                                      *
  3648*----------------------------------------------------------------*
  3649*  PASSED TO ELRATE                                              *
  3650*  ----------------                                              *
  3651*  CERT ISSUE DATE                                               *
  3652*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3653*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3654*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3655*  STATE CODE (CLIENT DEFINED)                                   *
  3656*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3657*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3658*  DEVIATION CODE                                                *
  3659*  ISSUE AGE                                                     *
  3660*  ORIGINAL BENEFIT AMOUNT                                       *
  3661*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3662*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3663*  BENEFIT KIND (LIFE OR A/H)                                    *
  3664*  A.P.R.                                                        *
  3665*  METHOD
  3666*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3667*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  65
* SOCK03.cbl
  3668*  COMPANY I.D. (3 CHARACTER)                                    *
  3669*  BENEFIT CODE                                                  *
  3670*  BENEFIT OVERRIDE CODE                                         *
  3671*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3672*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3673*  JOINT INDICATOR (CSL ONLY)                                    *
  3674*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3675*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3676*                                                                *
  3677*  RETURNED FROM ELRATE                                          *
  3678*  --------------------                                          *
  3679*  CALCULATED PREMIUM                                            *
  3680*  PREMIUM RATE                                                  *
  3681*  MORTALITY CODE                                                *
  3682*  MAX ATTAINED AGE                                              *
  3683*  MAX AGE                                                       *
  3684*  MAX TERM                                                      *
  3685*  MAX MONTHLY BENEFIT                                           *
  3686*  MAX TOTAL BENIFIT                                             *
  3687*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3688*----------------------------------------------------------------*
  3689*  PASSED TO ELRFND                                              *
  3690*  ----------------                                              *
  3691*  CERT ISSUE DATE                                               *
  3692*  REFUND DATE                                                   *
  3693*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3694*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3695*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3696*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3697*  STATE CODE (CLIENT DEFINED)                                   *
  3698*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3699*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3700*  DEVIATION CODE                                                *
  3701*  ISSUE AGE                                                     *
  3702*  ORIGINAL BENEFIT AMOUNT                                       *
  3703*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3704*  PROCESS TYPE (CANCEL)                                         *
  3705*  BENEFIT KIND (LIFE OR A/H)                                    *
  3706*  A.P.R.                                                        *
  3707*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3708*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3709*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3710*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3711*  COMPANY I.D. (3 CHARACTER)                                    *
  3712*  BENEFIT CODE                                                  *
  3713*  BENEFIT OVERRIDE CODE                                         *
  3714*                                                                *
  3715*  RETURNED FROM ELRFND                                          *
  3716*  --------------------                                          *
  3717*  CALCULATED REFUND                                             *
  3718*----------------------------------------------------------------*
  3719*  PASSED TO ELEARN                                              *
  3720*  ----------------                                              *
  3721*  CERT ISSUE DATE                                               *
  3722*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3723*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3724*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3725*  STATE CODE (CLIENT DEFINED)                                   *
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  66
* SOCK03.cbl
  3726*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3727*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3728*  DEVIATION CODE                                                *
  3729*  ISSUE AGE                                                     *
  3730*  ORIGINAL BENEFIT AMOUNT                                       *
  3731*  BENEFIT KIND (LIFE OR A/H)                                    *
  3732*  A.P.R.                                                        *
  3733*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3734*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3735*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3736*  COMPANY I.D. (3 CHARACTER)                                    *
  3737*  BENEFIT CODE                                                  *
  3738*  BENEFIT OVERRIDE CODE                                         *
  3739*                                                                *
  3740*  RETURNED FROM ELEARN                                          *
  3741*  --------------------                                          *
  3742*  INDICATED  EARNINGS                                           *
  3743*----------------------------------------------------------------*
  3744*                 LENGTH = 450                                   *
  3745*                                                                *
  3746******************************************************************
  3747******************************************************************
  3748*                   C H A N G E   L O G
  3749*
  3750* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3751*-----------------------------------------------------------------
  3752*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3753* EFFECTIVE    NUMBER
  3754*-----------------------------------------------------------------
  3755* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3756* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3757* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3758* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3759* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3760* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3761* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3762* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3763* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3764* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3765* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3766******************************************************************
  3767
  3768 01  CALCULATION-PASS-AREA.
  3769     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3770                                     COMP.
  3771
  3772     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3773       88  NO-CP-ERROR                             VALUE ZERO.
  3774       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3775                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3776       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3777       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3778       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3779       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3780       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3781       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3782       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3783       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  67
* SOCK03.cbl
  3784       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3785       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3786       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3787       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3788       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3789       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3790       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3791       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3792       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3793
  3794     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3795       88  NO-CP-ERROR-2                           VALUE ZERO.
  3796***********************  INPUT AREAS ****************************
  3797
  3798     12  CP-CALCULATION-AREA.
  3799         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3800         16  CP-CERT-EFF-DT        PIC XX.
  3801         16  CP-VALUATION-DT       PIC XX.
  3802         16  CP-PAID-THRU-DT       PIC XX.
  3803         16  CP-BENEFIT-TYPE       PIC X.
  3804           88  CP-AH                               VALUE 'A' 'D'
  3805                                                   'I' 'U'.
  3806           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3807           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3808         16  CP-INCURRED-DT        PIC XX.
  3809         16  CP-REPORTED-DT        PIC XX.
  3810         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3811         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3812         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3813                                     COMP-3.
  3814         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3815                                     COMP-3.
  3816         16  CP-CDT-METHOD         PIC X.
  3817           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3818           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3819           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3820         16  CP-CLAIM-TYPE         PIC X.
  3821           88  CP-AH-CLAIM                         VALUE 'A'.
  3822           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3823         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3824                                     COMP-3.
  3825         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3826                                     COMP-3.
  3827         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3828                                     COMP-3.
  3829         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3830                                     COMP-3.
  3831         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3832                                     COMP-3.
  3833         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3834                                     COMP-3.
  3835         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3836                                     COMP-3.
  3837         16  CP-REM-TERM-METHOD    PIC X.
  3838           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3839           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3840           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3841           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  68
* SOCK03.cbl
  3842           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3843           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3844           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3845         16  CP-EARNING-METHOD     PIC X.
  3846           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3847           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3848           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3849           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3850           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3851           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3852           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3853           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3854           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3855           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3856           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3857           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3858           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3859           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3860         16  CP-PROCESS-TYPE       PIC X.
  3861           88  CP-CLAIM                            VALUE '1'.
  3862           88  CP-CANCEL                           VALUE '2'.
  3863           88  CP-ISSUE                            VALUE '3'.
  3864         16  CP-SPECIAL-CALC-CD    PIC X.
  3865           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3866           88  CP-1-MTH-INTEREST               VALUE ' '.
  3867           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3868           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3869           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3870           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3871           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3872           88  CP-FARM-PLAN                    VALUE 'F'.
  3873           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3874           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3875           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3876           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3877           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3878           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3879           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3880           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3881           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3882           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3883                                                     'W' 'X'.
  3884           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3885           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3886           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3887           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3888           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3889           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3890           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3891           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3892           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3893           88  CP-CSL-METH-1                   VALUE '5'.
  3894           88  CP-CSL-METH-2                   VALUE '6'.
  3895           88  CP-CSL-METH-3                   VALUE '7'.
  3896           88  CP-CSL-METH-4                   VALUE '8'.
  3897
  3898         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3899                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  69
* SOCK03.cbl
  3900         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3901         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3902         16  CP-STATE              PIC XX          VALUE SPACE.
  3903         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3904         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3905           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3906               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3907         16  CP-R78-OPTION         PIC X.
  3908           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3909           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3910
  3911         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3912         16  CP-IBNR-RESERVE-SW    PIC X.
  3913         16  CP-CLAIM-STATUS       PIC X.
  3914         16  CP-RATE-FILE          PIC X.
  3915         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3916                                     COMP-3.
  3917
  3918         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3919         16  CP-AH-OVERRIDE-CODE   PIC X.
  3920
  3921         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3922                                     COMP-3.
  3923         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3924                                   PIC S9(5)V99 COMP-3.
  3925         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3926                                     COMP-3.
  3927         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3928                                     COMP-3.
  3929         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3930                                     COMP-3.
  3931         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3932                                  PIC S9(7)V99 COMP-3.
  3933
  3934         16  CP-PAID-FROM-DATE     PIC X(02).
  3935         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3936         16  CP-EXT-DAYS-CALC      PIC X.
  3937           88  CP-EXT-NO-CHG                   VALUE ' '.
  3938           88  CP-EXT-CHG-LF                   VALUE '1'.
  3939           88  CP-EXT-CHG-AH                   VALUE '2'.
  3940           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3941         16  CP-DOMICILE-STATE     PIC XX.
  3942         16  CP-CARRIER            PIC X.
  3943         16  CP-REIN-FLAG          PIC X.
  3944         16  CP-REM-TRM-CALC-OPTION PIC X.
  3945           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3946                      '2' '3' '4' '5'.
  3947           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3948           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3949           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3950           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3951           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3952           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3953           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3954           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3955         16  CP-SIG-SWITCH         PIC X.
  3956         16  CP-RATING-METHOD      PIC X.
  3957           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  70
* SOCK03.cbl
  3958           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3959           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3960           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3961           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3962           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3963           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3964           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3965           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3966         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3967                                     COMP-3.
  3968         16  CP-BEN-CATEGORY       PIC X.
  3969         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3970         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3971                                   PIC S99V9(5) COMP-3.
  3972         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3973         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3974                                   PIC S99V9(5) COMP-3.
  3975         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3976         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3977         16  CP-EXPIRE-DT          PIC XX.
  3978         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3979         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3980         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3981         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3982         16  CP-DDF-SPEC-CALC      PIC X.
  3983             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3984             88  CP-CALC-CLP              VALUE 'C'.
  3985         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3986         16  CP-CANCEL-REASON      PIC X.
  3987         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3988         16  CP-PMT-MODE           PIC X.
  3989         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3990         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3991         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3992         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3993         16  FILLER                PIC X.
  3994
  3995***************    OUTPUT FROM ELRESV   ************************
  3996
  3997         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3998
  3999         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  4000                                     COMP-3.
  4001         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  4002                                     COMP-3.
  4003         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  4004                                     COMP-3.
  4005         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  4006                                     COMP-3.
  4007         16  FILLER                PIC X(09).
  4008***************    OUTPUT FROM ELRTRM   *************************
  4009
  4010         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  4011                                     COMP-3.
  4012         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  4013                                     COMP-3.
  4014         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  4015                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  71
* SOCK03.cbl
  4016         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  4017                                     COMP-3.
  4018         16  FILLER                PIC X(12).
  4019
  4020***************    OUTPUT FROM ELRAMT   *************************
  4021
  4022         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  4023                                     COMP-3.
  4024         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  4025                                     COMP-3.
  4026         16  FILLER                PIC X(12).
  4027
  4028***************    OUTPUT FROM ELRATE   *************************
  4029
  4030         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  4031                                     COMP-3.
  4032         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  4033                                     COMP-3.
  4034         16  CP-MORTALITY-CODE     PIC X(4).
  4035         16  CP-RATE-EDIT-FLAG     PIC X.
  4036             88  CP-RATES-NEED-APR                  VALUE '1'.
  4037         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  4038                                     COMP-3.
  4039         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  4040         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  4041         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  4042                                   PIC S9(7)V99 COMP-3.
  4043         16  FILLER                PIC X(07).
  4044
  4045***************    OUTPUT FROM ELRFND   *************************
  4046
  4047         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  4048                                     COMP-3.
  4049         16  CP-REFUND-TYPE-USED   PIC X.
  4050           88  CP-R-AS-R78                         VALUE '1'.
  4051           88  CP-R-AS-PRORATA                     VALUE '2'.
  4052           88  CP-R-AS-CALIF                       VALUE '3'.
  4053           88  CP-R-AS-TEXAS                       VALUE '4'.
  4054           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  4055           88  CP-R-AS-NET-PAY                     VALUE '5'.
  4056           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  4057           88  CP-R-AS-MEAN                        VALUE '8'.
  4058           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  4059           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  4060           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  4061           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  4062           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  4063           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  4064         16  FILLER                PIC X(12).
  4065
  4066***************    OUTPUT FROM ELEARN   *************************
  4067
  4068         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  4069                                     COMP-3.
  4070         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  4071                                     COMP-3.
  4072         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  4073                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  72
* SOCK03.cbl
  4074         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  4075                                     COMP-3.
  4076         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  4077                                     COMP-3.
  4078         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  4079                                     COMP-3.
  4080         16  CP-EARNING-TYPE-USED  PIC X.
  4081           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  4082           88  CP-E-AS-R78                         VALUE '1'.
  4083           88  CP-E-AS-PRORATA                     VALUE '2'.
  4084           88  CP-E-AS-TEXAS                       VALUE '4'.
  4085           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  4086           88  CP-E-AS-NET-PAY                     VALUE '5'.
  4087           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  4088           88  CP-E-AS-MEAN                        VALUE '8'.
  4089           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4090         16  FILLER                PIC X(12).
  4091
  4092***************    OUTPUT FROM ELPMNT   *************************
  4093
  4094         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4095                                     COMP-3.
  4096         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  4097                                     COMP-3.
  4098         16  FILLER                PIC X(12).
  4099
  4100***************   MISC WORK AREAS    *****************************
  4101         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4102                                     COMP-3.
  4103         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4104                                     COMP-3.
  4105         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4106                                     COMP-3.
  4107         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4108                                     COMP-3.
  4109         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4110                                     COMP-3.
  4111         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4112                                     COMP-3.
  4113         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4114             88  OPEN-RATE-FILE                   VALUE 'O'.
  4115             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4116             88  IO-ERROR                         VALUE 'E'.
  4117
  4118         16  CP-FIRST-PAY-DATE     PIC XX.
  4119
  4120         16  CP-JOINT-INDICATOR    PIC X.
  4121
  4122         16  CP-RESERVE-REMAINING-TERM
  4123                                   PIC S9(4)V9    VALUE ZERO
  4124                                     COMP-3.
  4125
  4126         16  CP-INSURED-BIRTH-DT   PIC XX.
  4127
  4128         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4129                                     COMP-3.
  4130
  4131         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  73
* SOCK03.cbl
  4132                                     COMP-3.
  4133
  4134         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4135                                     COMP-3.
  4136
  4137         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4138                                     COMP-3.
  4139
  4140         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4141                                     COMP-3.
  4142
  4143         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4144                                     COMP-3.
  4145
  4146         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4147                                     COMP-3.
  4148
  4149         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4150             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4151
  4152         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4153                                     COMP-3.
  4154         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4155                                     COMP-3.
  4156         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4157         16  cp-extra-periods      pic 9 value zeros.
  4158         16  cp-net-only-state     pic x value spaces.
  4159         16  FILLER                PIC X(13).
  4160******************************************************************
  4161****************************************************************
  4162*
  4163* Copyright (c) 2007-2013 Dell Inc.
  4164* All rights reserved.
  4165*
  4166****************************************************************
  4167 01  DFHEIV.
  4168   02  DFHEIV0               PIC X(35).
  4169   02  DFHEIV1               PIC X(08).
  4170   02  DFHEIV2               PIC X(08).
  4171   02  DFHEIV3               PIC X(08).
  4172   02  DFHEIV4               PIC X(06).
  4173   02  DFHEIV5               PIC X(04).
  4174   02  DFHEIV6               PIC X(04).
  4175   02  DFHEIV7               PIC X(02).
  4176   02  DFHEIV8               PIC X(02).
  4177   02  DFHEIV9               PIC X(01).
  4178   02  DFHEIV10              PIC S9(7) COMP-3.
  4179   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4180   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4181   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4182   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4183   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4184   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4185   02  DFHEIV17              PIC X(04).
  4186   02  DFHEIV18              PIC X(04).
  4187   02  DFHEIV19              PIC X(04).
  4188   02  DFHEIV20              USAGE IS POINTER.
  4189   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  74
* SOCK03.cbl
  4190   02  DFHEIV22              USAGE IS POINTER.
  4191   02  DFHEIV23              USAGE IS POINTER.
  4192   02  DFHEIV24              USAGE IS POINTER.
  4193   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4194   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4195   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4196   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4197   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4198   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4199   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4200   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4201   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4202   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4203   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4204   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4205   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4206   02  FILLER                PIC X(02).
  4207   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4208   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4209   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4210   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4211   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4212   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4213   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4214 LINKAGE  SECTION.
  4215*****************************************************************
  4216*                                                               *
  4217* Copyright (c) 2007-2013 Dell Inc.                             *
  4218* All rights reserved.                                          *
  4219*                                                               *
  4220*****************************************************************
  4221 01  dfheiblk.
  4222     02  eibtime          pic s9(7) comp-3.
  4223     02  eibdate          pic s9(7) comp-3.
  4224     02  eibtrnid         pic x(4).
  4225     02  eibtaskn         pic s9(7) comp-3.
  4226     02  eibtrmid         pic x(4).
  4227     02  dfheigdi         pic s9(4) comp.
  4228     02  eibcposn         pic s9(4) comp.
  4229     02  eibcalen         pic s9(4) comp.
  4230     02  eibaid           pic x(1).
  4231     02  eibfiller1       pic x(1).
  4232     02  eibfn            pic x(2).
  4233     02  eibfiller2       pic x(2).
  4234     02  eibrcode         pic x(6).
  4235     02  eibfiller3       pic x(2).
  4236     02  eibds            pic x(8).
  4237     02  eibreqid         pic x(8).
  4238     02  eibrsrce         pic x(8).
  4239     02  eibsync          pic x(1).
  4240     02  eibfree          pic x(1).
  4241     02  eibrecv          pic x(1).
  4242     02  eibsend          pic x(1).
  4243     02  eibatt           pic x(1).
  4244     02  eibeoc           pic x(1).
  4245     02  eibfmh           pic x(1).
  4246     02  eibcompl         pic x(1).
  4247     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  75
* SOCK03.cbl
  4248     02  eibconf          pic x(1).
  4249     02  eiberr           pic x(1).
  4250     02  eibrldbk         pic x(1).
  4251     02  eiberrcd         pic x(4).
  4252     02  eibsynrb         pic x(1).
  4253     02  eibnodat         pic x(1).
  4254     02  eibfiller5       pic x(2).
  4255     02  eibresp          pic s9(8) comp.
  4256     02  eibresp2         pic s9(8) comp.
  4257     02  dfheigdj         pic s9(4) comp.
  4258     02  dfheigdk         pic s9(4) comp.
  4259 01  DFHCOMMAREA.
  4260   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  4261   05 LSTN-NAME                PIC X(8).
  4262   05 LSTN-SUBNAME             PIC X(8).
  4263   05 CLIENT-IN-DATA.
  4264      15  CLIENT-CAR           PIC X.
  4265      15  CLIENT-GRP           PIC X(6).
  4266      15  CLIENT-STATE         PIC XX.
  4267      15  CLIENT-ACCOUNT       PIC X(10).
  4268      15  CLIENT-EFF-DT        PIC X(8).  *> ccyymmdd
  4269      15  CLIENT-CERT-NO       PIC X(11).
  4270      15  CLIENT-LAST-NAME     PIC X(15).
  4271      15  CLIENT-FIRST-NAME    PIC X(10).
  4272      15  CLIENT-VAL-DT        PIC X(8).  *> ccyymmdd
  4273      15  CLIENT-CAN-REASON    PIC X.
  4274      15  client-vin           pic x(17).
  4275   05 SOCKADDR-IN-PARM.
  4276     15 SIN-FAMILY             PIC 9(4) COMP.
  4277     15 SIN-PORT               PIC 9(4) COMP.
  4278     15 SIN-ADDRESS            PIC 9(8) COMP.
  4279     15 SIN-ZERO               PIC X(8).
  4280 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4281 0000-DFHEXIT SECTION.
  4282     MOVE '9#                    $   ' TO DFHEIV0.
  4283     MOVE 'SOCK03' TO DFHEIV1.
  4284     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4285     display '  BEGIN SOCK03 '
  4286     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  4287     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  4288     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  4289        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  4290        evaluate true
  4291           when client-in-data (8:3) = 'AHL'
  4292              MOVE X'06'         TO WS-COMP-CD
  4293              MOVE 'AHL'         TO WS-SEND-BUF (5:3)
  4294                                    WS-COMP-ID
  4295           when CLIENT-IN-DATA (8:3) = 'DCC'
  4296              MOVE X'05'         TO WS-COMP-CD
  4297              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  4298                                    WS-COMP-ID
  4299           when CLIENT-IN-DATA (8:3) = 'VPP'
  4300              MOVE X'07'         TO WS-COMP-CD
  4301              MOVE 'VPP'         TO WS-SEND-BUF (5:3)
  4302                                    WS-COMP-ID
  4303           when other
  4304              MOVE X'04'         TO WS-COMP-CD
  4305              MOVE 'CID'         TO WS-SEND-BUF (5:3)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  76
* SOCK03.cbl
  4306                                    WS-COMP-ID
  4307        end-evaluate
  4308        move 'CSO'               to ws-send-buf (1:3)
  4309        move +25                 to ws-send-msg-size
  4310     END-IF
  4311     display 'SOCK03:sequence number  =', ws-seq-num.
  4312     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  4313     call "send" using by value GIVE-TAKE-SOCKET,
  4314         by reference ws-send-buf,
  4315         by value ws-send-msg-size,
  4316         by value ws-flags.
  4317     if return-code <= zero
  4318         display 'SOCK03:send error ',
  4319         go to socket-error.
  4320     move low-values to ws-recv-buf.
  4321     set ws-recv-total to zero.
  4322     compute ws-recv-left = ws-recv-msg-size.
  4323     display 'SOCK03:About to recv '
  4324     call "recv" using by value GIVE-TAKE-SOCKET,
  4325         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4326         by value ws-recv-left,
  4327         by value ws-flags.
  4328     if return-code < zero
  4329        display 'SOCK03:recv error ',
  4330        go to socket-error.
  4331     if return-code = zero
  4332        display 'SOCK03:client disconnected',
  4333        go to socket-error.
  4334*
  4335     display 'SOCK03:Good recv  '
  4336     display 'SOCK03:return code      = ', return-code
  4337     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:89)
  4338     move +4096                  to ws-send-msg-size
  4339*    move +750                   to ws-send-msg-size
  4340     move ws-recv-buf (1:89)     to client-in-data
  4341     MOVE SPACES                 TO WS-ELCERT-SW
  4342     MOVE X'0A'                  TO WS-HEX-0A
  4343     if client-account = 'EPIQ000001'
  4344        set ws-epiq-request to true
  4345        move spaces              to client-account
  4346     end-if
  4347     move +0 to ws-epiq-max
  4348     if client-car = spaces
  4349        if client-state = 'KY'
  4350           move '8'              to client-car
  4351        else
  4352           move '9'              to client-car
  4353        end-if
  4354     end-if
  4355     if client-grp = spaces
  4356        move '000000'            to client-grp
  4357     end-if
  4358     EVALUATE TRUE
  4359        WHEN (CLIENT-CAR NOT = SPACES)
  4360           AND (CLIENT-STATE NOT = SPACES)
  4361           AND (CLIENT-ACCOUNT NOT = SPACES)
  4362           AND (CLIENT-EFF-DT NOT = SPACES)
  4363           AND (CLIENT-CERT-NO NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  77
* SOCK03.cbl
  4364           SET WS-ELCERT-FULL    TO TRUE
  4365           DISPLAY ' SETTING FULL '
  4366        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4367           SET WS-ELCERT-CERT-NO TO TRUE
  4368           DISPLAY ' SETTING CERT NO '
  4369*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4370*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4371        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4372           AND (CLIENT-LAST-NAME NOT = SPACES)
  4373           SET WS-ELCERT-ACT-NAME TO TRUE
  4374        WHEN CLIENT-LAST-NAME NOT = SPACES
  4375           SET WS-ELCERT-NAME    TO TRUE
  4376           DISPLAY ' SETTING NAME '
  4377        when (client-vin not = spaces)
  4378           and (client-state not = spaces)
  4379           and (client-account not = spaces)
  4380           set ws-elcert-vin to true
  4381           display ' SETTING VIN '
  4382        WHEN OTHER
  4383           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4384           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4385           MOVE ZEROS            TO WS-RESP
  4386           PERFORM 0030-BUILD-BUFFER
  4387                                 THRU 0030-EXIT
  4388           PERFORM 0020-SEND-BUFFER
  4389                                 THRU 0020-EXIT
  4390           PERFORM 0025-CLOSE-SOCKET
  4391                                 THRU 0025-EXIT
  4392           GO TO 0010-RETURN
  4393     END-EVALUATE
  4394     IF CLIENT-CAN-REASON = 'R'
  4395        MOVE 'R'                 TO WS-CANCEL-REASON
  4396     ELSE
  4397        MOVE ' '                 TO WS-CANCEL-REASON
  4398     END-IF
  4399     IF WS-ELCERT-KEY-SW NOT = SPACES
  4400        PERFORM 0050-BEGIN-REFUND-PROCESS
  4401                                 THRU 0050-EXIT
  4402     END-IF
  4403     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4404     .
  4405 0010-RETURN.
  4406
  4407* exec cics return end-exec.
  4408*    MOVE '.(                    ''   #00004402' TO DFHEIV0
  4409     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4410     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4411     MOVE X'2020233030303034343032' TO DFHEIV0(25:11)
  4412     CALL 'kxdfhei1' USING DFHEIV0,
  4413           DFHEIV99,
  4414           DFHEIV99,
  4415           DFHEIV99,
  4416           DFHEIV99,
  4417           DFHEIV99,
  4418           DFHEIV99
  4419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4420
  4421
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  78
* SOCK03.cbl
  4422* goback.
  4423     MOVE '9%                    "   ' TO DFHEIV0
  4424     MOVE 'SOCK03' TO DFHEIV1
  4425     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4426     goback.
  4427*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4428     .
  4429 0020-SEND-BUFFER.
  4430     display 'SOCK03:About to send      '
  4431     display 'SOCK03:sequence number  =', ws-seq-num.
  4432     display 'SOCK03:send buffer      =', ws-send-buf(1:500).
  4433     call "send" using by value GIVE-TAKE-SOCKET,
  4434         by reference ws-send-buf,
  4435         by value ws-send-msg-size,
  4436         by value ws-flags.
  4437     if return-code <= zero
  4438         display 'SOCK03:send error ' return-code,
  4439         go to socket-error.
  4440 0020-EXIT.
  4441     EXIT.
  4442 0025-CLOSE-SOCKET.
  4443*    display 'SOCK03:closing socket'.
  4444*    call "close" using by value GIVE-TAKE-SOCKET .
  4445     display 'SOCK03:done'.
  4446     .
  4447 0025-EXIT.
  4448     EXIT.
  4449*
  4450* set up the receive buffer
  4451*
  4452     move low-values to ws-recv-buf.
  4453     set ws-recv-total to zero.
  4454     compute ws-recv-left = ws-recv-msg-size.
  4455*
  4456* receive data
  4457*
  4458 recv-1.
  4459     call "recv" using by value GIVE-TAKE-SOCKET,
  4460         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4461         by value ws-recv-left,
  4462         by value ws-flags.
  4463*
  4464* test what was received and decide what we should do
  4465*
  4466     if return-code < zero
  4467        display 'SOCK03:recv error ',
  4468        go to socket-error.
  4469     if return-code = zero
  4470        display 'SOCK03:client disconnected',
  4471        go to socket-error.
  4472*
  4473* have we received all the data yet?
  4474*
  4475     compute ws-recv-total = ws-recv-total + return-code.
  4476     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4477*
  4478* not yet
  4479*
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  79
* SOCK03.cbl
  4480     if ws-recv-left > 0 go to recv-1.
  4481*
  4482* received all the data
  4483*
  4484     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4485*
  4486* make sure what we received was what we sent
  4487*
  4488*    if ws-recv-buf <> ws-send-buf
  4489*        display "SOCK03:data doesn't match",
  4490*        go to socket-error.
  4491*
  4492* end of pass
  4493*
  4494*loop-end.
  4495*    if ws-seq-num = 5 go to socket-error.
  4496*    go to loop-1.
  4497*
  4498* program end
  4499*
  4500 socket-error.
  4501     if ws-seq-num <> 0
  4502         display "SOCK03:did not complete".
  4503*
  4504* flush the send buffer and deallocate
  4505*
  4506*    display 'SOCK03:closing socket'.
  4507*    call "close" using by value GIVE-TAKE-SOCKET .
  4508*
  4509* finised return to cics
  4510*
  4511 socket-fin.
  4512*    display 'SOCK03:closing socket'.
  4513*    call "close" using by value GIVE-TAKE-SOCKET .
  4514     display 'SOCK03:done'.
  4515
  4516* exec cics return end-exec.
  4517*    MOVE '.(                    ''   #00004492' TO DFHEIV0
  4518     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4519     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4520     MOVE X'2020233030303034343932' TO DFHEIV0(25:11)
  4521     CALL 'kxdfhei1' USING DFHEIV0,
  4522           DFHEIV99,
  4523           DFHEIV99,
  4524           DFHEIV99,
  4525           DFHEIV99,
  4526           DFHEIV99,
  4527           DFHEIV99
  4528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4529
  4530
  4531* goback.
  4532     MOVE '9%                    "   ' TO DFHEIV0
  4533     MOVE 'SOCK03' TO DFHEIV1
  4534     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4535     goback.
  4536 0030-BUILD-BUFFER.
  4537     MOVE SPACES                 TO WS-SEND-BUF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  80
* SOCK03.cbl
  4538     IF WS-CALL-TYPE = 'NEWBUS'
  4539        STRING
  4540           WS-COMMENT            ';'
  4541           WS-RESP               ';'
  4542           WS-CARRIER            ';'
  4543           WS-GROUPING           ';'
  4544           WS-STATE              ';'
  4545           WS-ACCOUNT            ';'
  4546           WS-CERT-EFF-DATE      ';'
  4547           WS-CERT-NO            ';'
  4548           WS-LAST-NAME          ';'
  4549           WS-FIRST-NAME         ';'
  4550           WS-MID-INIT           ';'
  4551           WS-LAST-JNAME         ';'
  4552           WS-FIRST-JNAME        ';'
  4553           WS-MID-JINIT          ';'
  4554           WS-POST-CARD-SW       ';'
  4555           ws-lf-coverage-type   ';'
  4556           WS-LF-STATUS          ';'
  4557           WS-LF-BEN-CODE        ';'
  4558           WS-LF-BEN-CODE-DESC   ';'
  4559           WS-LF-TERM            ';'
  4560           WS-LF-REM-TERM        ';'
  4561           WS-LF-PREM            ';'
  4562           WS-LF-REFUND          ';'
  4563           WS-LF-METHOD          ';'
  4564           WS-LF-ORIG-BENEFIT    ';'
  4565           WS-LF-REM-BEN         ';'
  4566           WS-LF-EXPIRE-DATE     ';'
  4567           WS-LF-COMM            ';'
  4568           WS-LF-UEC             ';'
  4569           WS-AH-COVERAGE-TYPE   ';'
  4570           WS-AH-STATUS          ';'
  4571           WS-AH-BEN-CODE        ';'
  4572           WS-AH-BEN-CODE-DESC   ';'
  4573           WS-AH-TERM            ';'
  4574           WS-AH-REM-TERM        ';'
  4575           WS-AH-PREM            ';'
  4576           WS-AH-REFUND          ';'
  4577           WS-AH-METHOD          ';'
  4578           WS-AH-ORIG-BENEFIT    ';'
  4579           WS-AH-REM-BEN         ';'
  4580           WS-AH-EXPIRE-DATE     ';'
  4581           WS-AH-COMM            ';'
  4582           WS-AH-UEC             ';'
  4583           WS-ACCOUNT-NAME       ';'
  4584           WS-REPORT-CODE-1      ';'
  4585           WS-REPORT-CODE-2      ';'
  4586           WS-REPORT-CODE-3      ';'
  4587           WS-CLM-PAID-THRU-DT   ';'
  4588           WS-LF-CANCEL-DATE     ';'
  4589           WS-AH-CANCEL-DATE     ';'
  4590           WS-VIN                ';'
  4591           WS-CRED-BENE-NAME     ';'
  4592           WS-HEX-0A
  4593            DELIMITED BY '  ' INTO WS-SEND-BUF
  4594        END-STRING
  4595     ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  81
* SOCK03.cbl
  4596        STRING
  4597           WS-COMMENT            ';'  *> 0
  4598           WS-RESP               ';'
  4599           WS-CARRIER            ';'
  4600           WS-GROUPING           ';'
  4601           WS-STATE              ';'
  4602           WS-ACCOUNT            ';'
  4603           WS-CERT-EFF-DATE      ';'
  4604           WS-CERT-NO            ';'
  4605           WS-LAST-NAME          ';'
  4606           WS-FIRST-NAME         ';'
  4607           WS-MID-INIT           ';'
  4608           WS-LAST-JNAME         ';'
  4609           WS-FIRST-JNAME        ';'
  4610           WS-MID-JINIT          ';'
  4611           WS-POST-CARD-SW       ';'
  4612           WS-LF-STATUS          ';'
  4613           WS-LF-BEN-CODE        ';'  *> 16
  4614           WS-LF-BEN-CODE-DESC   ';'
  4615           WS-LF-TERM            ';'
  4616           WS-LF-REM-TERM        ';'
  4617           WS-LF-PREM            ';'
  4618           WS-LF-REFUND          ';'
  4619           WS-LF-METHOD          ';'
  4620           WS-LF-ORIG-BENEFIT    ';'
  4621           WS-LF-REM-BEN         ';'
  4622           WS-LF-EXPIRE-DATE     ';'
  4623           WS-LF-COMM            ';'
  4624           WS-LF-UEC             ';'
  4625           WS-AH-STATUS          ';'
  4626           WS-AH-BEN-CODE        ';'   *> 29
  4627           WS-AH-BEN-CODE-DESC   ';'
  4628           WS-AH-TERM            ';'
  4629           WS-AH-REM-TERM        ';'
  4630           WS-AH-PREM            ';'   *> 32
  4631           WS-AH-REFUND          ';'   *> 33
  4632           WS-AH-METHOD          ';'
  4633           WS-AH-ORIG-BENEFIT    ';'   *> 36
  4634           WS-AH-REM-BEN         ';'
  4635           WS-AH-EXPIRE-DATE     ';'
  4636           WS-AH-COMM            ';'
  4637           WS-AH-UEC             ';'
  4638           WS-ACCOUNT-NAME       ';'
  4639           WS-REPORT-CODE-1      ';'
  4640           WS-REPORT-CODE-2      ';'
  4641           WS-REPORT-CODE-3      ';'
  4642           WS-CLM-PAID-THRU-DT   ';'
  4643           WS-LF-CANCEL-DATE     ';'
  4644           WS-AH-CANCEL-DATE     ';'
  4645           WS-VIN                ';'
  4646           WS-CRED-BENE-NAME     ';'
  4647           'E'                   ';'
  4648            DELIMITED BY '  ' INTO WS-SEND-BUF
  4649        END-STRING
  4650     END-IF
  4651     .
  4652 0030-EXIT.
  4653     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  82
* SOCK03.cbl
  4654 0050-BEGIN-REFUND-PROCESS.
  4655     IF WS-ELCERT-ACT-NAME
  4656        PERFORM 0060-FIND-FULL-KEY
  4657                                 THRU 0060-EXIT
  4658        MOVE AM-CARRIER          TO CLIENT-CAR
  4659        MOVE AM-GROUPING         TO CLIENT-GRP
  4660        MOVE AM-STATE            TO CLIENT-STATE
  4661     END-IF
  4662     PERFORM 0100-START-ELCERT   THRU 0100-EXIT
  4663     IF NOT RESP-NORMAL
  4664        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4665        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4666        MOVE WS-RESPONSE         TO WS-RESP
  4667        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4668        PERFORM 0020-SEND-BUFFER
  4669                                 THRU 0020-EXIT
  4670        PERFORM 0025-CLOSE-SOCKET
  4671                                 THRU 0025-EXIT
  4672        GO TO 0010-RETURN
  4673     END-IF
  4674     PERFORM 0150-READ-NEXT-ELCERT
  4675                                 THRU 0150-EXIT
  4676*    display ' came back from 0150 ' ws-response
  4677     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4678        DISPLAY ' CERT NOT FOUND '
  4679        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4680        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4681        MOVE WS-RESPONSE         TO WS-RESP
  4682        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4683        PERFORM 0020-SEND-BUFFER
  4684                                 THRU 0020-EXIT
  4685        PERFORM 0025-CLOSE-SOCKET
  4686                                 THRU 0025-EXIT
  4687        GO TO 0010-RETURN
  4688     END-IF
  4689     PERFORM 0200-BEGIN-REFUND-PROCESS
  4690                                 THRU 0200-EXIT UNTIL
  4691        ELCERT-FINISHED
  4692     .
  4693 0050-EXIT.
  4694     EXIT.
  4695 0060-FIND-FULL-KEY.
  4696     MOVE ' ' TO WS-STOP-SW
  4697     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4698     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4699
  4700* EXEC CICS STARTBR
  4701*       DATASET  ('ERACCT3')
  4702*       RIDFLD   (WS-AM3-KEY)
  4703*       GTEQ
  4704*       RESP (WS-RESPONSE)
  4705*    END-EXEC
  4706     MOVE 'ERACCT3' TO DFHEIV1
  4707     MOVE 0
  4708       TO DFHEIV11
  4709*    MOVE '&,         G          &  N#00004657' TO DFHEIV0
  4710     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4711     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  83
* SOCK03.cbl
  4712     MOVE X'204E233030303034363537' TO DFHEIV0(25:11)
  4713     CALL 'kxdfhei1' USING DFHEIV0,
  4714           DFHEIV1,
  4715           WS-AM3-KEY,
  4716           DFHEIV99,
  4717           DFHEIV11,
  4718           DFHEIV99
  4719     MOVE EIBRESP  TO WS-RESPONSE
  4720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4721     IF RESP-NORMAL
  4722        PERFORM UNTIL TOLD-TO-STOP
  4723
  4724* EXEC CICS READNEXT
  4725*             DATASET  ('ERACCT3')
  4726*             INTO     (ACCOUNT-MASTER)
  4727*             RIDFLD   (WS-AM3-KEY)
  4728*          END-EXEC
  4729     MOVE LENGTH OF
  4730      ACCOUNT-MASTER
  4731       TO DFHEIV12
  4732     MOVE 'ERACCT3' TO DFHEIV1
  4733     MOVE 0
  4734       TO DFHEIV11
  4735*    MOVE '&.IL                  )   #00004665' TO DFHEIV0
  4736     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4737     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4738     MOVE X'2020233030303034363635' TO DFHEIV0(25:11)
  4739     CALL 'kxdfhei1' USING DFHEIV0,
  4740           DFHEIV1,
  4741           ACCOUNT-MASTER,
  4742           DFHEIV12,
  4743           WS-AM3-KEY,
  4744           DFHEIV99,
  4745           DFHEIV11,
  4746           DFHEIV99,
  4747           DFHEIV99
  4748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4749           EVALUATE TRUE
  4750              WHEN (RESP-NORMAL)
  4751                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4752                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4753                 SET TOLD-TO-STOP TO TRUE
  4754              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4755                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4756                 CONTINUE
  4757              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4758                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4759                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4760                 MOVE ZEROS      TO WS-RESP
  4761                 PERFORM 0030-BUILD-BUFFER
  4762                                 THRU 0030-EXIT
  4763                 PERFORM 0020-SEND-BUFFER
  4764                                 THRU 0020-EXIT
  4765                 PERFORM 0025-CLOSE-SOCKET
  4766                                 THRU 0025-EXIT
  4767                 GO TO 0010-RETURN
  4768           END-EVALUATE
  4769        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  84
* SOCK03.cbl
  4770
  4771* EXEC CICS ENDBR
  4772*          DATASET   ('ERACCT3')
  4773*       END-EXEC
  4774     MOVE 'ERACCT3' TO DFHEIV1
  4775     MOVE 0
  4776       TO DFHEIV11
  4777*    MOVE '&2                    $   #00004691' TO DFHEIV0
  4778     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4779     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4780     MOVE X'2020233030303034363931' TO DFHEIV0(25:11)
  4781     CALL 'kxdfhei1' USING DFHEIV0,
  4782           DFHEIV1,
  4783           DFHEIV11,
  4784           DFHEIV99
  4785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4786     ELSE
  4787        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4788        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4789        MOVE ZEROS      TO WS-RESP
  4790        PERFORM 0030-BUILD-BUFFER
  4791                                 THRU 0030-EXIT
  4792        PERFORM 0020-SEND-BUFFER
  4793                                 THRU 0020-EXIT
  4794        PERFORM 0025-CLOSE-SOCKET
  4795                                 THRU 0025-EXIT
  4796        GO TO 0010-RETURN
  4797     END-IF
  4798     .
  4799 0060-EXIT.
  4800     EXIT.
  4801 0100-START-ELCERT.
  4802     MOVE SPACES                 TO WS-SEND-BUF
  4803     INITIALIZE WS-STRING-DATA
  4804     MOVE LOW-VALUES             TO WS-CM-KEY
  4805                                    WS-CM-KEY-A1
  4806                                    WS-CM-KEY-A4
  4807     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4808                                    WS-CM-COMPANY-CD-A1
  4809                                    WS-CM-COMPANY-CD-A4
  4810     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4811     MOVE 'L'                    TO DC-OPTION-CODE
  4812     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4813     IF NO-CONVERSION-ERROR
  4814        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4815     ELSE
  4816        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4817        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4818        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4819        PERFORM 0020-SEND-BUFFER
  4820                                 THRU 0020-EXIT
  4821        PERFORM 0025-CLOSE-SOCKET
  4822                                 THRU 0025-EXIT
  4823        GO TO 0010-RETURN
  4824     END-IF
  4825     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4826        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4827        MOVE 'L'                 TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  85
* SOCK03.cbl
  4828        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4829        IF NO-CONVERSION-ERROR
  4830           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4831        ELSE
  4832           MOVE 'BAD EFF DT CONVERT '
  4833                                 TO WS-COMMENT
  4834           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4835           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4836           PERFORM 0020-SEND-BUFFER
  4837                                 THRU 0020-EXIT
  4838           PERFORM 0025-CLOSE-SOCKET
  4839                                 THRU 0025-EXIT
  4840           GO TO 0010-RETURN
  4841        END-IF
  4842     END-IF
  4843     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4844        (F1 > +10)
  4845        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4846     END-PERFORM
  4847     IF F1 > +1
  4848        SUBTRACT +1 FROM F1
  4849     END-IF
  4850     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4851        (L1 > +15)
  4852        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4853     END-PERFORM
  4854     IF L1 > +1
  4855        SUBTRACT +1 FROM L1
  4856     END-IF
  4857     EVALUATE TRUE
  4858        WHEN WS-ELCERT-FULL
  4859           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4860           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4861           MOVE CLIENT-STATE        TO WS-CM-STATE
  4862           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4863           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4864           MOVE CLIENT-CERT-NO (1:10)
  4865                                    TO WS-CM-CERT-NO
  4866
  4867* EXEC CICS READ
  4868*             INTO    (CERTIFICATE-MASTER)
  4869*             DATASET ('ELCERT')
  4870*             RIDFLD  (WS-CM-KEY)
  4871*             RESP    (WS-RESPONSE)
  4872*          END-EXEC
  4873     MOVE LENGTH OF
  4874      CERTIFICATE-MASTER
  4875       TO DFHEIV11
  4876     MOVE 'ELCERT' TO DFHEIV1
  4877*    MOVE '&"IL       E          (  N#00004775' TO DFHEIV0
  4878     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4879     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4880     MOVE X'204E233030303034373735' TO DFHEIV0(25:11)
  4881     CALL 'kxdfhei1' USING DFHEIV0,
  4882           DFHEIV1,
  4883           CERTIFICATE-MASTER,
  4884           DFHEIV11,
  4885           WS-CM-KEY,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  86
* SOCK03.cbl
  4886           DFHEIV99,
  4887           DFHEIV99,
  4888           DFHEIV99
  4889     MOVE EIBRESP  TO WS-RESPONSE
  4890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4891        WHEN WS-ELCERT-ACT-NAME
  4892           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4893           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4894           MOVE CLIENT-STATE        TO WS-CM-STATE
  4895           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4896           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4897           MOVE ZEROS               TO WS-CM-CERT-NO
  4898
  4899* EXEC CICS STARTBR
  4900*             DATASET ('ELCERT')
  4901*             RIDFLD  (WS-CM-KEY)
  4902*             RESP    (WS-RESPONSE)
  4903*          END-EXEC
  4904     MOVE 'ELCERT' TO DFHEIV1
  4905     MOVE 0
  4906       TO DFHEIV11
  4907*    MOVE '&,         G          &  N#00004788' TO DFHEIV0
  4908     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4909     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4910     MOVE X'204E233030303034373838' TO DFHEIV0(25:11)
  4911     CALL 'kxdfhei1' USING DFHEIV0,
  4912           DFHEIV1,
  4913           WS-CM-KEY,
  4914           DFHEIV99,
  4915           DFHEIV11,
  4916           DFHEIV99
  4917     MOVE EIBRESP  TO WS-RESPONSE
  4918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4919        WHEN WS-ELCERT-NAME
  4920           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4921           MOVE SPACES           TO WS-CM-INITIALS
  4922           COMPUTE WS-LENGTH = L1 + +1
  4923
  4924* EXEC CICS STARTBR
  4925*             DATASET   ('ELCERT2')
  4926*             RIDFLD    (WS-CM-KEY-A1)
  4927*             GENERIC
  4928*             KEYLENGTH (WS-LENGTH)
  4929*             GTEQ
  4930*             RESP      (WS-RESPONSE)
  4931*          END-EXEC
  4932     MOVE 'ELCERT2' TO DFHEIV1
  4933     MOVE 0
  4934       TO DFHEIV11
  4935*    MOVE '&,   KG    G          &  N#00004797' TO DFHEIV0
  4936     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4937     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4938     MOVE X'204E233030303034373937' TO DFHEIV0(25:11)
  4939     CALL 'kxdfhei1' USING DFHEIV0,
  4940           DFHEIV1,
  4941           WS-CM-KEY-A1,
  4942           WS-LENGTH,
  4943           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  87
* SOCK03.cbl
  4944           DFHEIV99
  4945     MOVE EIBRESP  TO WS-RESPONSE
  4946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4947*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4948*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4949        WHEN WS-ELCERT-CERT-NO
  4950* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4951           MOVE +11 TO WS-LENGTH
  4952           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4953
  4954* EXEC CICS STARTBR
  4955*             DATASET   ('ELCERT5')
  4956*             RIDFLD    (WS-CM-KEY-A4)
  4957*             GENERIC
  4958*             KEYLENGTH (WS-LENGTH)
  4959*             GTEQ
  4960*             RESP      (WS-RESPONSE)
  4961*          END-EXEC
  4962     MOVE 'ELCERT5' TO DFHEIV1
  4963     MOVE 0
  4964       TO DFHEIV11
  4965*    MOVE '&,   KG    G          &  N#00004811' TO DFHEIV0
  4966     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4967     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4968     MOVE X'204E233030303034383131' TO DFHEIV0(25:11)
  4969     CALL 'kxdfhei1' USING DFHEIV0,
  4970           DFHEIV1,
  4971           WS-CM-KEY-A4,
  4972           WS-LENGTH,
  4973           DFHEIV11,
  4974           DFHEIV99
  4975     MOVE EIBRESP  TO WS-RESPONSE
  4976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4977        when ws-elcert-vin
  4978           move low-values       to ws-cs-key
  4979           move ws-comp-cd       to ws-cs-company-cd
  4980           move client-car       to ws-cs-carrier
  4981           move client-grp       to ws-cs-group
  4982           move client-state     to ws-cs-state
  4983           move client-account   to ws-cs-account
  4984
  4985* exec cics startbr
  4986*             dataset   ('ELCRTT')
  4987*             RIDFLD    (WS-CS-KEY)
  4988*             GTEQ
  4989*             RESP      (WS-RESPONSE)
  4990*          END-EXEC
  4991     MOVE 'ELCRTT' TO DFHEIV1
  4992     MOVE 0
  4993       TO DFHEIV11
  4994*    MOVE '&,         G          &  N#00004826' TO DFHEIV0
  4995     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4996     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4997     MOVE X'204E233030303034383236' TO DFHEIV0(25:11)
  4998     CALL 'kxdfhei1' USING DFHEIV0,
  4999           DFHEIV1,
  5000           WS-CS-KEY,
  5001           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  88
* SOCK03.cbl
  5002           DFHEIV11,
  5003           DFHEIV99
  5004     MOVE EIBRESP  TO WS-RESPONSE
  5005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5006     END-EVALUATE
  5007     .
  5008 0100-EXIT.
  5009     EXIT.
  5010 0150-READ-NEXT-ELCERT.
  5011     EVALUATE TRUE
  5012        WHEN WS-ELCERT-ACT-NAME
  5013*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  5014
  5015* EXEC CICS READNEXT
  5016*             DATASET   ('ELCERT')
  5017*             RIDFLD    (WS-CM-KEY)
  5018*             INTO      (CERTIFICATE-MASTER)
  5019*             RESP      (WS-RESPONSE)
  5020*          END-EXEC
  5021     MOVE LENGTH OF
  5022      CERTIFICATE-MASTER
  5023       TO DFHEIV12
  5024     MOVE 'ELCERT' TO DFHEIV1
  5025     MOVE 0
  5026       TO DFHEIV11
  5027*    MOVE '&.IL                  )  N#00004841' TO DFHEIV0
  5028     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5029     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5030     MOVE X'204E233030303034383431' TO DFHEIV0(25:11)
  5031     CALL 'kxdfhei1' USING DFHEIV0,
  5032           DFHEIV1,
  5033           CERTIFICATE-MASTER,
  5034           DFHEIV12,
  5035           WS-CM-KEY,
  5036           DFHEIV99,
  5037           DFHEIV11,
  5038           DFHEIV99,
  5039           DFHEIV99
  5040     MOVE EIBRESP  TO WS-RESPONSE
  5041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5042        WHEN WS-ELCERT-NAME
  5043*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  5044
  5045* EXEC CICS READNEXT
  5046*             DATASET   ('ELCERT2')
  5047*             RIDFLD    (WS-CM-KEY-A1)
  5048*             INTO      (CERTIFICATE-MASTER)
  5049*             RESP      (WS-RESPONSE)
  5050*          END-EXEC
  5051     MOVE LENGTH OF
  5052      CERTIFICATE-MASTER
  5053       TO DFHEIV12
  5054     MOVE 'ELCERT2' TO DFHEIV1
  5055     MOVE 0
  5056       TO DFHEIV11
  5057*    MOVE '&.IL                  )  N#00004849' TO DFHEIV0
  5058     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5059     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  89
* SOCK03.cbl
  5060     MOVE X'204E233030303034383439' TO DFHEIV0(25:11)
  5061     CALL 'kxdfhei1' USING DFHEIV0,
  5062           DFHEIV1,
  5063           CERTIFICATE-MASTER,
  5064           DFHEIV12,
  5065           WS-CM-KEY-A1,
  5066           DFHEIV99,
  5067           DFHEIV11,
  5068           DFHEIV99,
  5069           DFHEIV99
  5070     MOVE EIBRESP  TO WS-RESPONSE
  5071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5072        WHEN WS-ELCERT-CERT-NO
  5073
  5074* EXEC CICS READNEXT
  5075*             DATASET   ('ELCERT5')
  5076*             RIDFLD    (WS-CM-KEY-A4)
  5077*             INTO      (CERTIFICATE-MASTER)
  5078*             RESP      (WS-RESPONSE)
  5079*          END-EXEC
  5080     MOVE LENGTH OF
  5081      CERTIFICATE-MASTER
  5082       TO DFHEIV12
  5083     MOVE 'ELCERT5' TO DFHEIV1
  5084     MOVE 0
  5085       TO DFHEIV11
  5086*    MOVE '&.IL                  )  N#00004856' TO DFHEIV0
  5087     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5088     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5089     MOVE X'204E233030303034383536' TO DFHEIV0(25:11)
  5090     CALL 'kxdfhei1' USING DFHEIV0,
  5091           DFHEIV1,
  5092           CERTIFICATE-MASTER,
  5093           DFHEIV12,
  5094           WS-CM-KEY-A4,
  5095           DFHEIV99,
  5096           DFHEIV11,
  5097           DFHEIV99,
  5098           DFHEIV99
  5099     MOVE EIBRESP  TO WS-RESPONSE
  5100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5101        WHEN WS-ELCERT-VIN
  5102
  5103* EXEC CICS READNEXT
  5104*             DATASET   ('ELCRTT')
  5105*             RIDFLD    (WS-CS-KEY)
  5106*             INTO      (CERTIFICATE-TRAILERS)
  5107*             RESP      (WS-RESPONSE)
  5108*          END-EXEC
  5109     MOVE LENGTH OF
  5110      CERTIFICATE-TRAILERS
  5111       TO DFHEIV12
  5112     MOVE 'ELCRTT' TO DFHEIV1
  5113     MOVE 0
  5114       TO DFHEIV11
  5115*    MOVE '&.IL                  )  N#00004863' TO DFHEIV0
  5116     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5117     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  90
* SOCK03.cbl
  5118     MOVE X'204E233030303034383633' TO DFHEIV0(25:11)
  5119     CALL 'kxdfhei1' USING DFHEIV0,
  5120           DFHEIV1,
  5121           CERTIFICATE-TRAILERS,
  5122           DFHEIV12,
  5123           WS-CS-KEY,
  5124           DFHEIV99,
  5125           DFHEIV11,
  5126           DFHEIV99,
  5127           DFHEIV99
  5128     MOVE EIBRESP  TO WS-RESPONSE
  5129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5130     END-EVALUATE
  5131     .
  5132 0150-EXIT.
  5133     EXIT.
  5134 0200-BEGIN-REFUND-PROCESS.
  5135     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5136                                    WS-ERACCT-SW
  5137     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  5138                                    WS-NCB-DIFF-ODD-DAYS
  5139     INITIALIZE WS-STRING-DATA
  5140     IF RESP-NORMAL OR RESP-DUPKEY
  5141        EVALUATE TRUE
  5142           WHEN WS-ELCERT-ACT-NAME
  5143              EVALUATE TRUE
  5144                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  5145                    OR (CM-CARRIER NOT = CLIENT-CAR)
  5146                    OR (CM-GROUPING NOT = CLIENT-GRP)
  5147                    OR (CM-STATE NOT = CLIENT-STATE)
  5148                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  5149                    SET ELCERT-FINISHED TO TRUE
  5150                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  5151                    CLIENT-LAST-NAME (1:L1))
  5152                    GO TO 0200-CONTINUE
  5153                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  5154                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5155                    GO TO 0200-CONTINUE
  5156                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  5157                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5158                     CLIENT-FIRST-NAME (1:F1)))
  5159                    GO TO 0200-CONTINUE
  5160                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  5161                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5162                    GO TO 0200-CONTINUE
  5163              END-EVALUATE
  5164           WHEN WS-ELCERT-CERT-NO
  5165              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5166                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  5167                 SET ELCERT-FINISHED TO TRUE
  5168              ELSE
  5169                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5170                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5171                              OR
  5172                    ((CLIENT-LAST-NAME NOT = SPACES)
  5173                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  5174                        CLIENT-LAST-NAME (1:L1)))
  5175                              OR
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  91
* SOCK03.cbl
  5176                    ((CLIENT-FIRST-NAME NOT = SPACES)
  5177                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5178                        CLIENT-FIRST-NAME (1:F1)))
  5179                              OR
  5180                    ((CLIENT-ACCOUNT NOT = SPACES)
  5181                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5182                     GO TO 0200-CONTINUE
  5183                 END-IF
  5184              END-IF
  5185           WHEN WS-ELCERT-NAME
  5186              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5187                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  5188                    CLIENT-LAST-NAME (1:L1))
  5189                  SET ELCERT-FINISHED TO TRUE
  5190              ELSE
  5191                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5192                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5193                           OR
  5194                 ((CLIENT-FIRST-NAME NOT = SPACES)
  5195                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5196                     CLIENT-FIRST-NAME (1:F1)))
  5197                           OR
  5198                 ((CLIENT-ACCOUNT NOT = SPACES)
  5199                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5200                  GO TO 0200-CONTINUE
  5201                 END-IF
  5202              END-IF
  5203           WHEN WS-ELCERT-VIN
  5204              evaluate true
  5205                 when (CS-COMPANY-CD NOT = WS-COMP-CD)
  5206                    OR (CS-STATE NOT = CLIENT-STATE)
  5207                    OR (CS-ACCOUNT NOT = CLIENT-ACCOUNT)
  5208                    SET ELCERT-FINISHED TO TRUE
  5209                 when (cs-trailer-type  = 'C')
  5210                    and (cs-vin-number = client-vin)
  5211                    continue
  5212                 when (cs-trailer-type  = 'C')
  5213                    and (cs-vin-number(10:8) = client-vin(1:8))
  5214                    continue
  5215                 when other
  5216                    go to 0200-continue
  5217              end-evaluate
  5218           WHEN OTHER
  5219              SET ELCERT-FINISHED   TO TRUE
  5220        END-EVALUATE
  5221     ELSE
  5222        SET ELCERT-FINISHED TO TRUE
  5223     END-IF
  5224     if ws-elcert-vin
  5225        move cs-control-primary(1:33)
  5226                                 to ws-cm-key
  5227
  5228* EXEC CICS READ
  5229*          INTO    (CERTIFICATE-MASTER)
  5230*          DATASET ('ELCERT')
  5231*          RIDFLD  (WS-CM-KEY)
  5232*          RESP    (WS-RESPONSE)
  5233*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  92
* SOCK03.cbl
  5234     MOVE LENGTH OF
  5235      CERTIFICATE-MASTER
  5236       TO DFHEIV11
  5237     MOVE 'ELCERT' TO DFHEIV1
  5238*    MOVE '&"IL       E          (  N#00004966' TO DFHEIV0
  5239     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5240     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5241     MOVE X'204E233030303034393636' TO DFHEIV0(25:11)
  5242     CALL 'kxdfhei1' USING DFHEIV0,
  5243           DFHEIV1,
  5244           CERTIFICATE-MASTER,
  5245           DFHEIV11,
  5246           WS-CM-KEY,
  5247           DFHEIV99,
  5248           DFHEIV99,
  5249           DFHEIV99
  5250     MOVE EIBRESP  TO WS-RESPONSE
  5251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5252        if not resp-normal
  5253           set elcert-finished to true
  5254        end-if
  5255     end-if
  5256*       IF WS-ELCERT-CERT-NO
  5257*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5258*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  5259*                          OR
  5260*                ((CLIENT-EFF-DT NOT = SPACES)
  5261*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5262*                          OR
  5263*                ((CLIENT-LAST-NAME NOT = SPACES)
  5264*                 AND (CM-INSURED-LAST-NAME NOT =
  5265*                    CLIENT-LAST-NAME))
  5266*                 SET ELCERT-FINISHED TO TRUE
  5267*          END-IF
  5268*          IF WS-ELCERT-NAME
  5269*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5270*                OR (CM-INSURED-LAST-NAME NOT =
  5271*                   CLIENT-LAST-NAME)
  5272*                            OR
  5273*                ((CLIENT-EFF-DT NOT = SPACES)
  5274*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5275*                 SET ELCERT-FINISHED TO TRUE
  5276*             END-IF
  5277*          ELSE
  5278*             SET ELCERT-FINISHED   TO TRUE
  5279*          END-IF
  5280     IF NOT WS-ELCERT-FULL
  5281        IF ELCERT-FINISHED
  5282           GO TO 0200-EXIT
  5283        END-IF
  5284     END-IF
  5285     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  5286        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  5287        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5288        PERFORM 0030-BUILD-BUFFER
  5289                                 THRU 0030-EXIT
  5290        PERFORM 0020-SEND-BUFFER
  5291                                 THRU 0020-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  93
* SOCK03.cbl
  5292        GO TO 0200-CONTINUE
  5293     END-IF
  5294     if (ws-epiq-request)
  5295        and (not EPIQ-CLASS)
  5296        go to 0200-continue
  5297     end-if
  5298
  5299     if ws-epiq-request
  5300        add +1 to ws-epiq-max
  5301        if ws-epiq-max > +100
  5302           go to 0200-continue
  5303        end-if
  5304     end-if
  5305     PERFORM 0300-GET-ELCNTL-RECORDS
  5306                                 THRU 0300-EXIT
  5307     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  5308     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  5309     MOVE +0                     TO DC-ELAPSED-MONTHS
  5310                                    DC-ELAPSED-DAYS
  5311     MOVE '1'                    TO DC-OPTION-CODE
  5312     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5313     IF NO-CONVERSION-ERROR
  5314        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  5315        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  5316     END-IF
  5317     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  5318     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  5319     perform 0610-get-ermail     thru 0610-exit
  5320     perform 0620-get-elcrtt     thru 0620-exit
  5321     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  5322     IF NOT ALREADY-SENT
  5323        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  5324     END-IF
  5325     .
  5326 0200-CONTINUE.
  5327     PERFORM 0150-READ-NEXT-ELCERT
  5328                                 THRU 0150-EXIT
  5329     .
  5330 0200-EXIT.
  5331     EXIT.
  5332 0300-GET-ELCNTL-RECORDS.
  5333     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  5334     IF NOT RESP-NORMAL
  5335        MOVE ' COMPANY RECORD NOT FOUND '
  5336                                 TO WS-COMMENT
  5337        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5338        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5339        PERFORM 0020-SEND-BUFFER
  5340                                 THRU 0020-EXIT
  5341        PERFORM 0025-CLOSE-SOCKET
  5342                                 THRU 0025-EXIT
  5343        GO TO 0010-RETURN
  5344     END-IF
  5345     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  5346        PERFORM 0320-GET-LIFE-RECORD
  5347                                 THRU 0320-EXIT
  5348        IF NOT RESP-NORMAL
  5349           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  94
* SOCK03.cbl
  5350                                 TO WS-COMMENT
  5351           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5352           PERFORM 0030-BUILD-BUFFER
  5353                                 THRU 0030-EXIT
  5354           PERFORM 0020-SEND-BUFFER
  5355                                 THRU 0020-EXIT
  5356           PERFORM 0025-CLOSE-SOCKET
  5357                                 THRU 0025-EXIT
  5358           GO TO 0010-RETURN
  5359        END-IF
  5360     END-IF
  5361     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5362        PERFORM 0330-GET-AH-RECORD
  5363                                 THRU 0330-EXIT
  5364        IF NOT RESP-NORMAL
  5365           MOVE ' AH BENEFIT RECORD NOT FOUND '
  5366                                 TO WS-COMMENT
  5367           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5368           PERFORM 0030-BUILD-BUFFER
  5369                                 THRU 0030-EXIT
  5370           PERFORM 0020-SEND-BUFFER
  5371                                 THRU 0020-EXIT
  5372           PERFORM 0025-CLOSE-SOCKET
  5373                                 THRU 0025-EXIT
  5374           GO TO 0010-RETURN
  5375        END-IF
  5376     END-IF
  5377     PERFORM 0340-GET-STATE-RECORD
  5378                                 THRU 0340-EXIT
  5379     IF NOT RESP-NORMAL
  5380        MOVE ' STATE RECORD NOT FOUND '
  5381                                 TO WS-COMMENT
  5382        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5383        PERFORM 0030-BUILD-BUFFER
  5384                                 THRU 0030-EXIT
  5385        PERFORM 0020-SEND-BUFFER
  5386                                 THRU 0020-EXIT
  5387        PERFORM 0025-CLOSE-SOCKET
  5388                                 THRU 0025-EXIT
  5389        GO TO 0010-RETURN
  5390     END-IF
  5391     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  5392     IF NOT ERACCT-FOUND
  5393        MOVE ' ACCOUNT NOT FOUND '
  5394                                 TO WS-COMMENT
  5395        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5396        PERFORM 0030-BUILD-BUFFER
  5397                                 THRU 0030-EXIT
  5398        PERFORM 0020-SEND-BUFFER
  5399                                 THRU 0020-EXIT
  5400        PERFORM 0025-CLOSE-SOCKET
  5401                                 THRU 0025-EXIT
  5402        GO TO 0010-RETURN
  5403     ELSE
  5404        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  5405        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  5406        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  5407        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  95
* SOCK03.cbl
  5408     END-IF
  5409     .
  5410 0300-EXIT.
  5411     EXIT.
  5412 0310-GET-COMPANY.
  5413     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  5414     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  5415     MOVE SPACES                 TO  WS-CF-ACCESS
  5416     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  5417
  5418* EXEC CICS READ
  5419*       INTO    (CONTROL-FILE)
  5420*       DATASET ('ELCNTL')
  5421*       RIDFLD  (WS-CF-KEY)
  5422*       RESP    (WS-RESPONSE)
  5423*    END-EXEC
  5424     MOVE LENGTH OF
  5425      CONTROL-FILE
  5426       TO DFHEIV11
  5427     MOVE 'ELCNTL' TO DFHEIV1
  5428*    MOVE '&"IL       E          (  N#00005137' TO DFHEIV0
  5429     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5431     MOVE X'204E233030303035313337' TO DFHEIV0(25:11)
  5432     CALL 'kxdfhei1' USING DFHEIV0,
  5433           DFHEIV1,
  5434           CONTROL-FILE,
  5435           DFHEIV11,
  5436           WS-CF-KEY,
  5437           DFHEIV99,
  5438           DFHEIV99,
  5439           DFHEIV99
  5440     MOVE EIBRESP  TO WS-RESPONSE
  5441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5442     IF (RESP-NORMAL)
  5443        AND (CF-COMPANY-ID = WS-COMP-ID)
  5444        AND (CF-RECORD-TYPE = '1')
  5445        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  5446        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  5447        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  5448        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  5449        IF CF-DEFAULT-APR NUMERIC
  5450           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  5451        ELSE
  5452           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  5453        END-IF
  5454        IF CF-VALID-REM-TRM-OPTION
  5455           MOVE CF-REM-TRM-CALC-OPTION
  5456                                 TO WS-CF-REM-TRM-CALC-OPTION
  5457        ELSE
  5458           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  5459        END-IF
  5460     END-IF
  5461     .
  5462 0310-EXIT.
  5463     EXIT.
  5464 0320-GET-LIFE-RECORD.
  5465     MOVE '4'                    TO WS-CF-RECORD-TYPE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  96
* SOCK03.cbl
  5466     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5467                                    WS-LF-BEN-CODE
  5468     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5469
  5470* EXEC CICS READ
  5471*       INTO    (CONTROL-FILE)
  5472*       DATASET ('ELCNTL')
  5473*       RIDFLD  (WS-CF-KEY)
  5474*       GTEQ
  5475*       RESP    (WS-RESPONSE)
  5476*    END-EXEC
  5477     MOVE LENGTH OF
  5478      CONTROL-FILE
  5479       TO DFHEIV11
  5480     MOVE 'ELCNTL' TO DFHEIV1
  5481*    MOVE '&"IL       G          (  N#00005170' TO DFHEIV0
  5482     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5483     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5484     MOVE X'204E233030303035313730' TO DFHEIV0(25:11)
  5485     CALL 'kxdfhei1' USING DFHEIV0,
  5486           DFHEIV1,
  5487           CONTROL-FILE,
  5488           DFHEIV11,
  5489           WS-CF-KEY,
  5490           DFHEIV99,
  5491           DFHEIV99,
  5492           DFHEIV99
  5493     MOVE EIBRESP  TO WS-RESPONSE
  5494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5495     IF RESP-NORMAL
  5496        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5497        AND (CF-RECORD-TYPE = '4')
  5498        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5499           (S1 > +8)
  5500           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5501        END-PERFORM
  5502        IF S1 > +8
  5503           CONTINUE
  5504        ELSE
  5505           MOVE CF-BENEFIT-DESCRIP (S1)
  5506                                 TO WS-LF-BEN-CODE-DESC
  5507           MOVE CF-LF-COVERAGE-TYPE (S1)
  5508                                 TO WS-CF-LF-COVERAGE-TYPE
  5509           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5510              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5511           ELSE
  5512              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5513           END-IF
  5514           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5515               MOVE CF-CO-REM-TERM-CALC (S1)
  5516                                 TO WS-LF-CO-REM-TERM-CALC
  5517           END-IF
  5518           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5519               MOVE CF-CO-EARNINGS-CALC (S1)
  5520                                 TO WS-LF-CO-EARNINGS-CALC
  5521                                    WS-LF-CO-REFUND-CALC
  5522           END-IF
  5523           IF CF-SPECIAL-CALC-CD (S1) > ' '
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  97
* SOCK03.cbl
  5524               MOVE CF-SPECIAL-CALC-CD (S1)
  5525                                 TO WS-LF-SPECIAL-CALC-CD
  5526           END-IF
  5527           IF CF-CO-REFUND-CALC (S1) > '0'
  5528               MOVE CF-CO-REFUND-CALC (S1)
  5529                                 TO WS-LF-CO-REFUND-CALC
  5530        END-IF
  5531     END-IF
  5532     .
  5533 0320-EXIT.
  5534     EXIT.
  5535 0330-GET-AH-RECORD.
  5536     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5537     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5538     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5539
  5540* EXEC CICS READ
  5541*       INTO    (CONTROL-FILE)
  5542*       DATASET ('ELCNTL')
  5543*       RIDFLD  (WS-CF-KEY)
  5544*       GTEQ
  5545*       RESP    (WS-RESPONSE)
  5546*    END-EXEC
  5547     MOVE LENGTH OF
  5548      CONTROL-FILE
  5549       TO DFHEIV11
  5550     MOVE 'ELCNTL' TO DFHEIV1
  5551*    MOVE '&"IL       G          (  N#00005221' TO DFHEIV0
  5552     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5554     MOVE X'204E233030303035323231' TO DFHEIV0(25:11)
  5555     CALL 'kxdfhei1' USING DFHEIV0,
  5556           DFHEIV1,
  5557           CONTROL-FILE,
  5558           DFHEIV11,
  5559           WS-CF-KEY,
  5560           DFHEIV99,
  5561           DFHEIV99,
  5562           DFHEIV99
  5563     MOVE EIBRESP  TO WS-RESPONSE
  5564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5565     IF RESP-NORMAL
  5566        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5567        AND (CF-RECORD-TYPE = '5')
  5568        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5569           (S1 > +8)
  5570           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5571        END-PERFORM
  5572        IF S1 > +8
  5573           CONTINUE
  5574        ELSE
  5575           MOVE CF-BENEFIT-DESCRIP (S1)
  5576                                 TO WS-AH-BEN-CODE-DESC
  5577           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5578              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5579           ELSE
  5580              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5581           END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  98
* SOCK03.cbl
  5582           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5583              MOVE CF-CO-REM-TERM-CALC (S1)
  5584                                 TO WS-AH-CO-REM-TERM-CALC
  5585           END-IF
  5586           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5587              MOVE CF-CO-EARNINGS-CALC (S1)
  5588                                 TO WS-AH-CO-EARNINGS-CALC
  5589                                    WS-AH-CO-REFUND-CALC
  5590           END-IF
  5591           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5592              MOVE CF-SPECIAL-CALC-CD (S1)
  5593                                 TO WS-AH-SPECIAL-CALC-CD
  5594           END-IF
  5595           IF CF-CO-REFUND-CALC (S1) > '0'
  5596              MOVE CF-CO-REFUND-CALC (S1)
  5597                                 TO WS-AH-CO-REFUND-CALC
  5598           END-IF
  5599           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5600              MOVE CF-BENEFIT-CATEGORY (S1)
  5601                                 TO WS-AH-BEN-CATEGORY
  5602           END-IF
  5603        END-IF
  5604     END-IF
  5605     .
  5606 0330-EXIT.
  5607     EXIT.
  5608 0340-GET-STATE-RECORD.
  5609     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5610     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5611     MOVE CM-STATE               TO WS-CF-ACCESS
  5612     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5613
  5614* EXEC CICS READ
  5615*       INTO    (CONTROL-FILE)
  5616*       DATASET ('ELCNTL')
  5617*       RIDFLD  (WS-CF-KEY)
  5618*       RESP    (WS-RESPONSE)
  5619*    END-EXEC
  5620     MOVE LENGTH OF
  5621      CONTROL-FILE
  5622       TO DFHEIV11
  5623     MOVE 'ELCNTL' TO DFHEIV1
  5624*    MOVE '&"IL       E          (  N#00005276' TO DFHEIV0
  5625     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5627     MOVE X'204E233030303035323736' TO DFHEIV0(25:11)
  5628     CALL 'kxdfhei1' USING DFHEIV0,
  5629           DFHEIV1,
  5630           CONTROL-FILE,
  5631           DFHEIV11,
  5632           WS-CF-KEY,
  5633           DFHEIV99,
  5634           DFHEIV99,
  5635           DFHEIV99
  5636     MOVE EIBRESP  TO WS-RESPONSE
  5637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5638     IF (RESP-NORMAL)
  5639        AND (CF-COMPANY-ID = WS-COMP-ID)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page  99
* SOCK03.cbl
  5640        AND (CF-RECORD-TYPE = '3')
  5641        AND (CF-STATE-CODE = CM-STATE)
  5642        MOVE CF-ST-FREE-LOOK-PERIOD
  5643                                 TO WS-FREE-LOOK
  5644        MOVE CF-STATE-ABBREVIATION
  5645                                 TO WS-STATE-ABBREVIATION
  5646        MOVE CF-ST-FST-PMT-DAYS-CHG
  5647                                 TO  WS-STATE-EXT-DAYS-CHG
  5648        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5649           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5650           IF CF-ST-RT-CALC NOT = SPACES
  5651              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5652           END-IF
  5653           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5654              IF CF-ST-RF-LR-CALC > '0'
  5655                 MOVE CF-ST-RF-LR-CALC
  5656                                 TO WS-LF-ST-REFUND-CALC
  5657              END-IF
  5658              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5659                 IF CF-ST-RF-LN-CALC > '0'
  5660                    MOVE CF-ST-RF-LN-CALC
  5661                                 TO WS-LF-ST-REFUND-CALC
  5662                 END-IF
  5663              END-IF
  5664           ELSE
  5665              IF CF-ST-RF-LL-CALC > '0'
  5666                 MOVE CF-ST-RF-LL-CALC
  5667                                 TO WS-LF-ST-REFUND-CALC
  5668              END-IF
  5669           END-IF
  5670           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5671              (S1 > 50)
  5672              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5673                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5674           END-PERFORM
  5675           IF S1 < +51
  5676              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5677                 MOVE CF-ST-REM-TERM-CALC (S1)
  5678                                 TO WS-LF-ST-REM-TERM-CALC
  5679              END-IF
  5680              IF CF-ST-REFUND-CALC (S1) > '0'
  5681                 MOVE CF-ST-REFUND-CALC (S1)
  5682                                 TO WS-LF-ST-REFUND-CALC
  5683              END-IF
  5684           END-IF
  5685        END-IF
  5686        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5687           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5688           IF CF-ST-RT-CALC NOT = SPACES
  5689              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5690           END-IF
  5691           IF CF-ST-RF-AH-CALC > '0'
  5692              MOVE CF-ST-RF-AH-CALC
  5693                                 TO WS-AH-ST-REFUND-CALC
  5694           END-IF
  5695           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5696              IF CF-ST-RF-CP-CALC > '0'
  5697                 MOVE CF-ST-RF-CP-CALC
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 100
* SOCK03.cbl
  5698                                 TO WS-AH-ST-REFUND-CALC
  5699              END-IF
  5700           END-IF
  5701           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5702              (S1 > 50)
  5703              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5704                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5705           END-PERFORM
  5706           IF S1 < +51
  5707              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5708                 MOVE CF-ST-REM-TERM-CALC (S1)
  5709                                 TO WS-AH-ST-REM-TERM-CALC
  5710              END-IF
  5711              IF CF-ST-REFUND-CALC (S1) > '0'
  5712                 MOVE CF-ST-REFUND-CALC (S1)
  5713                                 TO WS-AH-ST-REFUND-CALC
  5714              END-IF
  5715           END-IF
  5716        END-IF
  5717     END-IF
  5718     .
  5719 0340-EXIT.
  5720     EXIT.
  5721 0350-GET-ERACCT.
  5722     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5723                                    WS-AM-EARN-METHOD-R
  5724                                    WS-AM-EARN-METHOD-A
  5725                                    WS-LF-AM-REM-TERM-CALC
  5726                                    WS-AH-AM-REM-TERM-CALC
  5727     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5728     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5729     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5730     MOVE CM-STATE               TO WS-AM-STATE
  5731     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5732     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5733     MOVE LOW-VALUES             TO WS-AM-FILLER
  5734     MOVE ' '                    TO WS-STOP-SW
  5735
  5736* EXEC CICS STARTBR
  5737*       DATASET  ('ERACCT')
  5738*       RIDFLD   (WS-AM-KEY)
  5739*       GTEQ
  5740*       RESP (WS-RESPONSE)
  5741*    END-EXEC
  5742     MOVE 'ERACCT' TO DFHEIV1
  5743     MOVE 0
  5744       TO DFHEIV11
  5745*    MOVE '&,         G          &  N#00005379' TO DFHEIV0
  5746     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5747     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5748     MOVE X'204E233030303035333739' TO DFHEIV0(25:11)
  5749     CALL 'kxdfhei1' USING DFHEIV0,
  5750           DFHEIV1,
  5751           WS-AM-KEY,
  5752           DFHEIV99,
  5753           DFHEIV11,
  5754           DFHEIV99
  5755     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 101
* SOCK03.cbl
  5756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5757     IF RESP-NORMAL
  5758        PERFORM UNTIL TOLD-TO-STOP
  5759
  5760* EXEC CICS READNEXT
  5761*             DATASET  ('ERACCT')
  5762*             INTO     (ACCOUNT-MASTER)
  5763*             RIDFLD   (WS-AM-KEY)
  5764*          END-EXEC
  5765     MOVE LENGTH OF
  5766      ACCOUNT-MASTER
  5767       TO DFHEIV12
  5768     MOVE 'ERACCT' TO DFHEIV1
  5769     MOVE 0
  5770       TO DFHEIV11
  5771*    MOVE '&.IL                  )   #00005387' TO DFHEIV0
  5772     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5773     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5774     MOVE X'2020233030303035333837' TO DFHEIV0(25:11)
  5775     CALL 'kxdfhei1' USING DFHEIV0,
  5776           DFHEIV1,
  5777           ACCOUNT-MASTER,
  5778           DFHEIV12,
  5779           WS-AM-KEY,
  5780           DFHEIV99,
  5781           DFHEIV11,
  5782           DFHEIV99,
  5783           DFHEIV99
  5784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5785           IF RESP-NORMAL
  5786              EVALUATE TRUE
  5787                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5788                    CM-CONTROL-PRIMARY (1:20)
  5789                    SET TOLD-TO-STOP TO TRUE
  5790                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5791                    CM-CONTROL-PRIMARY (1:20))
  5792                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5793                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5794                    SET ERACCT-FOUND      TO TRUE
  5795                    SET TOLD-TO-STOP TO TRUE
  5796              END-EVALUATE
  5797           ELSE
  5798              SET TOLD-TO-STOP TO TRUE
  5799           END-IF
  5800        END-PERFORM
  5801
  5802* EXEC CICS ENDBR
  5803*          DATASET   ('ERACCT')
  5804*       END-EXEC
  5805     MOVE 'ERACCT' TO DFHEIV1
  5806     MOVE 0
  5807       TO DFHEIV11
  5808*    MOVE '&2                    $   #00005408' TO DFHEIV0
  5809     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5810     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5811     MOVE X'2020233030303035343038' TO DFHEIV0(25:11)
  5812     CALL 'kxdfhei1' USING DFHEIV0,
  5813           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 102
* SOCK03.cbl
  5814           DFHEIV11,
  5815           DFHEIV99
  5816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5817     END-IF
  5818     .
  5819 0350-EXIT.
  5820     EXIT.
  5821 0400-PROCESS-LIFE.
  5822     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5823     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5824     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5825     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5826     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5827     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5828     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5829     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5830     MOVE CM-CARRIER             TO WS-CARRIER
  5831     MOVE CM-GROUPING            TO WS-GROUPING
  5832     MOVE CM-STATE               TO WS-STATE
  5833     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5834     MOVE CM-CERT-NO             TO WS-CERT-NO
  5835     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5836     MOVE ' '                    TO  DC-OPTION-CODE.
  5837     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5838     IF NO-CONVERSION-ERROR
  5839        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5840     ELSE
  5841        MOVE 99999999            TO WS-CERT-EFF-DATE
  5842     END-IF
  5843     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5844        GO TO 0400-EXIT
  5845     END-IF
  5846     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5847                                    WS-TOT-LF-PREM
  5848                                    WS-TOT-LF-COMM
  5849                                    WS-LF-CANCEL-DATE
  5850     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5851     MOVE ' '                    TO  DC-OPTION-CODE
  5852     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5853     IF NO-CONVERSION-ERROR
  5854        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5855     ELSE
  5856        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5857     END-IF
  5858     IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5859        MOVE CM-LF-DEATH-DT      TO DC-BIN-DATE-1
  5860        MOVE ' '                 TO DC-OPTION-CODE
  5861
  5862        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5863        IF NO-CONVERSION-ERROR
  5864           MOVE DC-GREG-DATE-CYMD
  5865                                 TO WS-LF-CANCEL-DATE
  5866        ELSE
  5867           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5868        END-IF
  5869     END-IF
  5870     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5871        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 103
* SOCK03.cbl
  5872        MOVE ' '                 TO DC-OPTION-CODE
  5873
  5874        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5875        IF NO-CONVERSION-ERROR
  5876           MOVE DC-GREG-DATE-CYMD
  5877                                 TO WS-LF-CANCEL-DATE
  5878        ELSE
  5879           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5880        END-IF
  5881     END-IF
  5882     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5883     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5884     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5885     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5886     MOVE CM-STATE               TO CP-STATE
  5887     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5888     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5889     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5890     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5891     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5892     MOVE '2'                    TO CP-PROCESS-TYPE
  5893     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5894     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5895     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5896     MOVE WS-CF-REM-TRM-CALC-OPTION
  5897                                 TO CP-REM-TRM-CALC-OPTION
  5898     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5899     IF WS-LF-CO-REM-TERM-CALC > '0'
  5900        MOVE WS-LF-CO-REM-TERM-CALC
  5901                                 TO CP-REM-TERM-METHOD
  5902     END-IF
  5903     IF WS-LF-ST-REM-TERM-CALC > '0'
  5904         MOVE WS-LF-ST-REM-TERM-CALC
  5905                                 TO  CP-REM-TERM-METHOD.
  5906     IF WS-LF-AM-REM-TERM-CALC > '0'
  5907         MOVE WS-LF-AM-REM-TERM-CALC
  5908                                 TO  CP-REM-TERM-METHOD.
  5909     IF (WS-COMP-ID = 'CID')
  5910        AND (CP-STATE-STD-ABBRV = 'WI')
  5911        MOVE '7'                 TO CP-REM-TERM-METHOD
  5912        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5913     END-IF
  5914     IF (WS-COMP-ID = 'CID')
  5915        AND (CP-STATE-STD-ABBRV = 'MO')
  5916        AND (CM-CERT-EFF-DT >= X'9B41')
  5917        AND (CM-CERT-EFF-DT <= X'A2FB')
  5918        MOVE '7'                 TO CP-REM-TERM-METHOD
  5919        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5920     END-IF
  5921     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5922                                    CP-LOAN-TERM
  5923                                    WS-LF-TERM
  5924     IF CP-TRUNCATED-LIFE
  5925         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5926     IF CP-TERM-IS-DAYS
  5927        IF CM-LF-TERM-IN-DAYS NUMERIC
  5928           MOVE CM-LF-TERM-IN-DAYS
  5929                                 TO CP-TERM-OR-EXT-DAYS
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 104
* SOCK03.cbl
  5930        ELSE
  5931           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5932        END-IF
  5933     ELSE
  5934        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5935           MOVE CM-PMT-EXTENSION-DAYS
  5936                                 TO CP-TERM-OR-EXT-DAYS
  5937        ELSE
  5938           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5939        END-IF
  5940     END-IF
  5941     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5942     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5943        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5944        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5945     END-IF
  5946     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5947     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5948     MOVE ' '                    TO WS-CLM-STOP-SW
  5949     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5950     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5951
  5952* EXEC CICS STARTBR
  5953*       DATASET     ('ELMSTR5')
  5954*       RIDFLD      (ELMSTR-KEY)
  5955*       RESP        (WS-RESPONSE)
  5956*    END-EXEC
  5957     MOVE 'ELMSTR5' TO DFHEIV1
  5958     MOVE 0
  5959       TO DFHEIV11
  5960*    MOVE '&,         G          &  N#00005545' TO DFHEIV0
  5961     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5962     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5963     MOVE X'204E233030303035353435' TO DFHEIV0(25:11)
  5964     CALL 'kxdfhei1' USING DFHEIV0,
  5965           DFHEIV1,
  5966           ELMSTR-KEY,
  5967           DFHEIV99,
  5968           DFHEIV11,
  5969           DFHEIV99
  5970     MOVE EIBRESP  TO WS-RESPONSE
  5971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5972     DISPLAY ' AFTER START ' WS-RESPONSE
  5973     IF RESP-NORMAL
  5974        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5975
  5976* EXEC CICS READNEXT
  5977*             DATASET   ('ELMSTR5')
  5978*             RIDFLD    (ELMSTR-KEY)
  5979*             INTO      (CLAIM-MASTER)
  5980*             RESP      (WS-RESPONSE)
  5981*          END-EXEC
  5982     MOVE LENGTH OF
  5983      CLAIM-MASTER
  5984       TO DFHEIV12
  5985     MOVE 'ELMSTR5' TO DFHEIV1
  5986     MOVE 0
  5987       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 105
* SOCK03.cbl
  5988*    MOVE '&.IL                  )  N#00005553' TO DFHEIV0
  5989     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5990     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5991     MOVE X'204E233030303035353533' TO DFHEIV0(25:11)
  5992     CALL 'kxdfhei1' USING DFHEIV0,
  5993           DFHEIV1,
  5994           CLAIM-MASTER,
  5995           DFHEIV12,
  5996           ELMSTR-KEY,
  5997           DFHEIV99,
  5998           DFHEIV11,
  5999           DFHEIV99,
  6000           DFHEIV99
  6001     MOVE EIBRESP  TO WS-RESPONSE
  6002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6003        IF (RESP-NORMAL OR RESP-DUPKEY)
  6004           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6005           AND (CM-CERT-NO = CL-CERT-NO)
  6006           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6007              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6008              IF CL-CLAIM-TYPE = 'L' OR 'O'
  6009                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  6010                    MOVE 'D'     TO WS-AH-STATUS
  6011                 END-IF
  6012                 IF CLAIM-IS-OPEN
  6013                    MOVE ' OPEN LIFE CLAIM '
  6014                                 TO WS-COMMENT
  6015                    MOVE 'L'     TO WS-LF-STATUS
  6016                    GO TO 0400-EXIT
  6017                 ELSE
  6018                    MOVE ' DEATH CLAIM APPLIED '
  6019                                 TO WS-COMMENT
  6020                    MOVE 'D'     TO WS-LF-STATUS
  6021*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  6022*                      MOVE CL-PAID-THRU-DT
  6023*                                TO WS-LF-BIN-PAID-THRU-DT
  6024*                   END-IF
  6025                 END-IF
  6026              END-IF
  6027           END-IF
  6028        ELSE
  6029           SET I-SAY-TO-STOP TO TRUE
  6030        END-IF
  6031        END-PERFORM
  6032
  6033* EXEC CICS ENDBR
  6034*          DATASET   ('ELMSTR5')
  6035*       END-EXEC
  6036     MOVE 'ELMSTR5' TO DFHEIV1
  6037     MOVE 0
  6038       TO DFHEIV11
  6039*    MOVE '&2                    $   #00005588' TO DFHEIV0
  6040     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6041     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6042     MOVE X'2020233030303035353838' TO DFHEIV0(25:11)
  6043     CALL 'kxdfhei1' USING DFHEIV0,
  6044           DFHEIV1,
  6045           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 106
* SOCK03.cbl
  6046           DFHEIV99
  6047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6048     END-IF
  6049     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6050*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  6051        MOVE WS-LF-BIN-PAID-THRU-DT
  6052                                 TO DC-BIN-DATE-1
  6053        MOVE ' '                 TO DC-OPTION-CODE
  6054        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6055        IF NO-CONVERSION-ERROR
  6056           MOVE DC-GREG-DATE-CYMD
  6057                                 TO WS-CLM-PAID-THRU-DT
  6058        ELSE
  6059           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6060        END-IF
  6061*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  6062*          MOVE 'CAN DT =< CLM PD THRU DT'
  6063*                                TO WS-COMMENT
  6064*          MOVE 'P'              TO WS-LF-STATUS
  6065*          GO TO 0400-EXIT
  6066*       END-IF
  6067        GO TO 0400-EXIT
  6068     END-IF
  6069     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6070     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6071        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6072        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  6073        COMPUTE CP-REMAINING-TERM-1 =
  6074                CP-REMAINING-TERM-1 - +1
  6075        COMPUTE CP-REMAINING-TERM-2 =
  6076                CP-REMAINING-TERM-2 - +1
  6077     END-IF
  6078     IF CP-REMAINING-TERM-1 NEGATIVE
  6079        MOVE ZEROS               TO CP-REMAINING-TERM-1
  6080     END-IF
  6081     IF CP-REMAINING-TERM-2 NEGATIVE
  6082        MOVE ZEROS               TO CP-REMAINING-TERM-2
  6083     END-IF
  6084     IF CM-LIFE-COMM-PCT NOT NUMERIC
  6085        MOVE ZERO                TO CM-LIFE-COMM-PCT
  6086     END-IF
  6087     IF CM-LIFE-COMM-PCT > ZEROS
  6088        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  6089           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  6090     END-IF
  6091     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  6092     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  6093     IF CM-LF-CURRENT-STATUS = '8'
  6094        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  6095           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  6096                                 TO WS-COMMENT
  6097           MOVE 'C'              TO WS-LF-STATUS
  6098           move cm-lf-itd-cancel-amt
  6099                                 to ws-lf-refund
  6100*          PERFORM 0030-BUILD-BUFFER
  6101*                                THRU 0030-EXIT
  6102*          PERFORM 0020-SEND-BUFFER
  6103*                                THRU 0020-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 107
* SOCK03.cbl
  6104*          SET ALREADY-SENT      TO TRUE
  6105*          MOVE SPACES           TO WS-COMMENT
  6106           GO TO 0400-EXIT
  6107*          PERFORM 0025-CLOSE-SOCKET
  6108*                                THRU 0025-EXIT
  6109*          GO TO 0010-RETURN
  6110        END-IF
  6111     END-IF
  6112     IF CM-LF-CURRENT-STATUS = '7'
  6113        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  6114           MOVE ' DEATH CLAIM APPLIED '
  6115                                 TO WS-COMMENT
  6116           MOVE 'D'              TO WS-LF-STATUS
  6117*          PERFORM 0030-BUILD-BUFFER
  6118*                                THRU 0030-EXIT
  6119*          IF NOT ALREADY-SENT
  6120*             PERFORM 0020-SEND-BUFFER
  6121*                                THRU 0020-EXIT
  6122*             SET ALREADY-SENT   TO TRUE
  6123*          END-IF
  6124           GO TO 0400-EXIT
  6125*          PERFORM 0025-CLOSE-SOCKET
  6126*                                THRU 0025-EXIT
  6127*          GO TO 0010-RETURN
  6128        END-IF
  6129     END-IF
  6130     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6131        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  6132        MOVE 'LF COVERAGE EXPIRED '
  6133                                 TO WS-COMMENT
  6134        MOVE 'E'                 TO WS-LF-STATUS
  6135        GO TO 0400-EXIT
  6136     END-IF
  6137     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6138        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6139        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6140     ELSE
  6141        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  6142     END-IF
  6143     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  6144     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  6145*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  6146     if ws-comp-id = 'AHL'
  6147        move cm-lf-class-cd      to cp-class-code
  6148        if cp-class-code = spaces
  6149           move zeros            to cp-class-code
  6150        end-if
  6151     else
  6152        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6153     end-if
  6154     IF (ws-comp-id = 'DCC' or 'VPP')
  6155        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6156        MOVE ' '                 TO WS-PDEF-RECORD-SW
  6157        PERFORM 0730-GET-DDF-FACTORS
  6158                                 THRU 0730-EXIT
  6159        IF PDEF-FOUND
  6160           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6161              (P1 > +8)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 108
* SOCK03.cbl
  6162              OR (PD-PROD-CODE (P1) = 'L')
  6163           END-PERFORM
  6164           IF P1 < +9
  6165              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  6166           END-IF
  6167        END-IF
  6168     END-IF
  6169     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  6170*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  6171     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  6172        CM-LF-ALT-BENEFIT-AMT
  6173*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  6174     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  6175                                    WS-LF-REM-BEN
  6176     move cm-lf-premium-amt      to ws-tot-lf-prem
  6177     if ws-lf-co-earnings-calc = 'B'
  6178        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  6179           + CM-LF-ALT-PREMIUM-AMT
  6180     end-if
  6181     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  6182     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6183        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6184        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6185     ELSE
  6186        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  6187     END-IF
  6188     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6189     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6190     IF WS-LF-ST-REFUND-CALC > ZERO
  6191         MOVE WS-LF-ST-REFUND-CALC
  6192                                 TO  CP-EARNING-METHOD.
  6193     IF WS-LF-FO-REFUND-CALC > ZERO
  6194         MOVE WS-LF-FO-REFUND-CALC
  6195                                 TO  CP-EARNING-METHOD.
  6196     IF CP-RATING-METHOD = '4'
  6197        MOVE '4'                 TO CP-EARNING-METHOD
  6198     END-IF
  6199*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6200     if ws-comp-id = 'AHL'
  6201        move cm-lf-class-cd      to cp-class-code
  6202        if cp-class-code = spaces
  6203           move zeros            to cp-class-code
  6204        end-if
  6205     else
  6206        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6207     end-if
  6208     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6209     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6210                                     CP-RATING-BENEFIT-AMT.
  6211     IF CP-STATE-STD-ABBRV = 'OR'
  6212         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6213                                         CM-LF-ALT-BENEFIT-AMT.
  6214****   N O T E   ****
  6215*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  6216*      THE OH HARD CODING IN ELCRFNDP
  6217     IF WS-COMP-ID = 'CID'
  6218        IF CP-STATE-STD-ABBRV = 'OH'
  6219           MOVE WS-LF-CO-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 109
* SOCK03.cbl
  6220                                 TO CP-EARNING-METHOD
  6221        END-IF
  6222     END-IF
  6223****   N O T E   ****
  6224     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6225     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6226     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  6227     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6228     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6229*    IF CP-EARN-AS-NET-PAY
  6230*       IF CP-LOAN-APR <= ZEROS
  6231*          IF WS-CF-DEFAULT-APR > ZEROS
  6232*             MOVE WS-CF-DEFAULT-APR
  6233*                                TO  CP-LOAN-APR
  6234*          END-IF
  6235*       END-IF
  6236*    END-IF
  6237*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  6238*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  6239*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  6240*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  6241*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  6242*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  6243*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  6244*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  6245*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  6246*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  6247*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  6248*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  6249*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  6250*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  6251*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  6252*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  6253*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  6254*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  6255     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6256     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  6257     DISPLAY ' MADE IT BACK FROM ELRFND '
  6258     IF (CP-ERROR-RATE-IS-ZERO)
  6259        OR (CP-ERROR-RATE-NOT-FOUND)
  6260        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6261        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  6262          DELIMITED BY SIZE INTO WS-COMMENT
  6263        END-STRING
  6264        MOVE 'X'                 TO WS-LF-STATUS
  6265        GO TO 0400-EXIT
  6266*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6267*       IF NOT ALREADY-SENT
  6268*          PERFORM 0020-SEND-BUFFER
  6269*                                THRU 0020-EXIT
  6270*          SET ALREADY-SENT      TO TRUE
  6271*       END-IF
  6272*       PERFORM 0025-CLOSE-SOCKET
  6273*                                THRU 0025-EXIT
  6274*       GO TO 0010-RETURN
  6275     END-IF
  6276     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  6277                                    WS-TOT-LF-RFND
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 110
* SOCK03.cbl
  6278     IF (WS-LF-STATUS = SPACES)
  6279        OR (CP-CALC-REFUND > ZEROS)
  6280        MOVE 'A'                 TO WS-LF-STATUS
  6281     END-IF
  6282     EVALUATE TRUE
  6283        WHEN CP-R-AS-R78
  6284           MOVE 'RULE 78'          TO  WS-LF-METHOD
  6285        WHEN  CP-R-AS-PRORATA
  6286           MOVE 'PRORATA'          TO  WS-LF-METHOD
  6287        WHEN CP-R-AS-CALIF
  6288           MOVE 'CALIF'            TO  WS-LF-METHOD
  6289        WHEN CP-R-AS-TEXAS
  6290           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6291        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  6292           MOVE 'UTAH'             TO  WS-LF-METHOD
  6293        WHEN CP-R-AS-FARM-PLAN
  6294           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6295        WHEN CP-R-AS-NET-PAY
  6296           MOVE 'NET PAY'          TO  WS-LF-METHOD
  6297        WHEN CP-R-AS-ANTICIPATION
  6298           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  6299        WHEN CP-R-AS-MEAN
  6300           MOVE 'MEAN'             TO  WS-LF-METHOD
  6301        WHEN CP-R-AS-SUM-OF-DIGITS
  6302           MOVE 'SUM OF DIGITS'    TO  WS-LF-METHOD
  6303        WHEN CP-R-AS-REPOSSESSION
  6304           MOVE 'REPOSSESSION'     TO  WS-LF-METHOD
  6305     END-EVALUATE
  6306     IF WS-TOT-LF-RFND > ZEROS
  6307        COMPUTE WS-WORK-FACTOR ROUNDED =
  6308           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  6309        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  6310           WS-TOT-LF-COMM
  6311     END-IF
  6312     IF ERACCT-FOUND
  6313        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6314           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6315        END-IF
  6316        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6317           IF (AM-COMM-CHARGEBACK (1) = 99)
  6318                     OR
  6319              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6320                     OR
  6321              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6322              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6323              MOVE ZEROS         TO WS-LF-UEC
  6324           END-IF
  6325        END-IF
  6326     END-IF
  6327     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  6328        GO TO 0400-EXIT
  6329     END-IF
  6330     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  6331     MOVE '2'                    TO  CP-EARNING-METHOD
  6332                                     CP-RATING-METHOD.
  6333     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  6334                                     CP-REMAINING-BENEFIT
  6335                                     CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 111
* SOCK03.cbl
  6336     IF CP-STATE-STD-ABBRV = 'OR'
  6337         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6338                                         CM-LF-ALT-BENEFIT-AMT.
  6339     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  6340     IF ws-comp-id = 'CID'
  6341        IF (CP-STATE-STD-ABBRV = 'MN')
  6342           AND (CM-CERT-EFF-DT > X'A4FF')
  6343           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  6344           MOVE '5'              TO CP-EARNING-METHOD
  6345           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  6346        END-IF
  6347     END-IF
  6348     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  6349     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  6350     IF (CP-ERROR-RATE-IS-ZERO)
  6351        OR (CP-ERROR-RATE-NOT-FOUND)
  6352        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6353        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  6354          DELIMITED BY SIZE INTO WS-COMMENT
  6355        END-STRING
  6356        MOVE 'X'              TO WS-LF-STATUS
  6357        GO TO 0400-EXIT
  6358*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6359*       IF NOT ALREADY-SENT
  6360*          PERFORM 0020-SEND-BUFFER
  6361*                                THRU 0020-EXIT
  6362*          SET ALREADY-SENT      TO TRUE
  6363*       END-IF
  6364*       PERFORM 0025-CLOSE-SOCKET
  6365*                                THRU 0025-EXIT
  6366*       GO TO 0010-RETURN
  6367     END-IF
  6368     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  6369     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  6370     IF WS-TOT-LF-RFND > ZEROS
  6371        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  6372           WS-TOT-LF-COMM
  6373     END-IF
  6374     IF ERACCT-FOUND
  6375        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6376           IF (AM-COMM-CHARGEBACK (1) = 99)
  6377                     OR
  6378              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6379                     OR
  6380              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6381              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6382              MOVE ZEROS         TO WS-LF-UEC
  6383           END-IF
  6384        END-IF
  6385     END-IF
  6386     .
  6387 0400-EXIT.
  6388     EXIT.
  6389 0500-PROCESS-AH.
  6390     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  6391        GO TO 0500-EXIT
  6392     END-IF
  6393     MOVE ZEROS                  TO WS-TOT-AH-RFND
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 112
* SOCK03.cbl
  6394                                    WS-TOT-AH-PREM
  6395                                    WS-TOT-AH-COMM
  6396                                    WS-AH-CANCEL-DATE
  6397     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  6398     MOVE ' '                    TO  DC-OPTION-CODE
  6399     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6400     IF NO-CONVERSION-ERROR
  6401        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  6402     ELSE
  6403        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  6404     END-IF
  6405     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6406        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
  6407        MOVE ' '                 TO DC-OPTION-CODE
  6408
  6409        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6410        IF NO-CONVERSION-ERROR
  6411           MOVE DC-GREG-DATE-CYMD TO WS-AH-CANCEL-DATE
  6412        ELSE
  6413           MOVE ZEROS            TO WS-AH-CANCEL-DATE
  6414        END-IF
  6415     END-IF
  6416     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  6417     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  6418     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  6419     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6420     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6421     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  6422     MOVE CM-STATE               TO  CP-STATE.
  6423     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6424     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  6425     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6426     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6427     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  6428     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6429     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6430     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  6431     MOVE WS-CF-CR-REM-TERM-CALC
  6432                                 TO  CP-REM-TERM-METHOD.
  6433     IF WS-AH-CO-REM-TERM-CALC > '0'
  6434         MOVE WS-AH-CO-REM-TERM-CALC
  6435                                 TO  CP-REM-TERM-METHOD.
  6436     IF WS-AH-ST-REM-TERM-CALC > '0'
  6437         MOVE WS-AH-ST-REM-TERM-CALC
  6438                                 TO  CP-REM-TERM-METHOD.
  6439     IF WS-AH-AM-REM-TERM-CALC > '0'
  6440         MOVE WS-AH-AM-REM-TERM-CALC
  6441                                 TO  CP-REM-TERM-METHOD.
  6442     IF (WS-COMP-ID = 'CID')
  6443        AND (CP-STATE-STD-ABBRV = 'WI')
  6444        MOVE '7'                 TO CP-REM-TERM-METHOD
  6445        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6446     END-IF
  6447     IF (WS-COMP-ID = 'CID')
  6448        AND (CP-STATE-STD-ABBRV = 'MO')
  6449        AND (CM-CERT-EFF-DT >= X'9B41')
  6450        AND (CM-CERT-EFF-DT <= X'A2FB')
  6451        MOVE '7'                 TO CP-REM-TERM-METHOD
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 113
* SOCK03.cbl
  6452        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6453     END-IF
  6454     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  6455                                     CP-LOAN-TERM.
  6456     IF  NOT  CP-TERM-IS-DAYS
  6457         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6458             MOVE CM-PMT-EXTENSION-DAYS
  6459                                 TO  CP-TERM-OR-EXT-DAYS
  6460         ELSE
  6461             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6462     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  6463     IF CM-AH-COMM-PCT > ZEROS
  6464        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  6465           CM-AH-PREMIUM-AMT
  6466     END-IF
  6467     IF (ws-comp-id = 'DCC' or 'VPP')
  6468        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6469        compute ws-tot-ah-comm = cm-ah-premium-amt -
  6470           (cm-ah-clp + cm-addl-clp)
  6471     end-if
  6472     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  6473     IF WS-AH-STATUS = 'D'
  6474        GO TO 0500-EXIT
  6475     END-IF
  6476     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  6477     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  6478     MOVE ' '                    TO WS-CLM-STOP-SW
  6479     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6480     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6481
  6482* EXEC CICS STARTBR
  6483*       DATASET     ('ELMSTR5')
  6484*       RIDFLD      (ELMSTR-KEY)
  6485*       RESP        (WS-RESPONSE)
  6486*    END-EXEC
  6487     MOVE 'ELMSTR5' TO DFHEIV1
  6488     MOVE 0
  6489       TO DFHEIV11
  6490*    MOVE '&,         G          &  N#00006024' TO DFHEIV0
  6491     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6492     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6493     MOVE X'204E233030303036303234' TO DFHEIV0(25:11)
  6494     CALL 'kxdfhei1' USING DFHEIV0,
  6495           DFHEIV1,
  6496           ELMSTR-KEY,
  6497           DFHEIV99,
  6498           DFHEIV11,
  6499           DFHEIV99
  6500     MOVE EIBRESP  TO WS-RESPONSE
  6501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6502     DISPLAY ' AFTER START ' WS-RESPONSE
  6503     IF RESP-NORMAL
  6504        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6505           DISPLAY ' AH READNEXT '
  6506
  6507* EXEC CICS READNEXT
  6508*             DATASET   ('ELMSTR5')
  6509*             RIDFLD    (ELMSTR-KEY)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 114
* SOCK03.cbl
  6510*             INTO      (CLAIM-MASTER)
  6511*             RESP      (WS-RESPONSE)
  6512*          END-EXEC
  6513     MOVE LENGTH OF
  6514      CLAIM-MASTER
  6515       TO DFHEIV12
  6516     MOVE 'ELMSTR5' TO DFHEIV1
  6517     MOVE 0
  6518       TO DFHEIV11
  6519*    MOVE '&.IL                  )  N#00006033' TO DFHEIV0
  6520     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6521     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6522     MOVE X'204E233030303036303333' TO DFHEIV0(25:11)
  6523     CALL 'kxdfhei1' USING DFHEIV0,
  6524           DFHEIV1,
  6525           CLAIM-MASTER,
  6526           DFHEIV12,
  6527           ELMSTR-KEY,
  6528           DFHEIV99,
  6529           DFHEIV11,
  6530           DFHEIV99,
  6531           DFHEIV99
  6532     MOVE EIBRESP  TO WS-RESPONSE
  6533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6534        IF (RESP-NORMAL OR RESP-DUPKEY)
  6535           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6536           AND (CM-CERT-NO = CL-CERT-NO)
  6537           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6538              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6539              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6540                 IF CLAIM-IS-OPEN
  6541                    DISPLAY ' FOUND OPEN AH CLAIM '
  6542                    MOVE ' OPEN HEALTH CLAIM '
  6543                                 TO WS-COMMENT
  6544                    MOVE 'H'     TO WS-AH-STATUS
  6545                 ELSE
  6546                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6547                    MOVE ' CLOSED HEALTH CLAIM '
  6548                                 TO WS-COMMENT
  6549                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6550                       MOVE CL-PAID-THRU-DT
  6551                                 TO WS-AH-BIN-PAID-THRU-DT
  6552                    END-IF
  6553                 END-IF
  6554              END-IF
  6555           END-IF
  6556        ELSE
  6557           SET I-SAY-TO-STOP TO TRUE
  6558        END-IF
  6559        END-PERFORM
  6560
  6561* EXEC CICS ENDBR
  6562*          DATASET   ('ELMSTR5')
  6563*       END-EXEC
  6564     MOVE 'ELMSTR5' TO DFHEIV1
  6565     MOVE 0
  6566       TO DFHEIV11
  6567*    MOVE '&2                    $   #00006065' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 115
* SOCK03.cbl
  6568     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6569     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6570     MOVE X'2020233030303036303635' TO DFHEIV0(25:11)
  6571     CALL 'kxdfhei1' USING DFHEIV0,
  6572           DFHEIV1,
  6573           DFHEIV11,
  6574           DFHEIV99
  6575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6576     END-IF
  6577     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6578*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6579        MOVE WS-AH-BIN-PAID-THRU-DT
  6580                                 TO DC-BIN-DATE-1
  6581        MOVE ' '                 TO DC-OPTION-CODE
  6582        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6583        IF NO-CONVERSION-ERROR
  6584           MOVE DC-GREG-DATE-CYMD
  6585                                 TO WS-CLM-PAID-THRU-DT
  6586        ELSE
  6587           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6588        END-IF
  6589        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6590           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6591                                 TO WS-COMMENT
  6592           MOVE 'P'              TO WS-AH-STATUS
  6593           GO TO 0500-EXIT
  6594        END-IF
  6595     END-IF
  6596     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6597     IF CM-AH-CURRENT-STATUS = '8'
  6598        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6599           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6600                                 TO WS-COMMENT
  6601           MOVE 'C'              TO WS-AH-STATUS
  6602           move cm-ah-itd-cancel-amt
  6603                                 to ws-ah-refund
  6604           GO TO 0500-EXIT
  6605        END-IF
  6606     END-IF
  6607     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6608        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6609           MOVE ' SETTLEMENT CLAIM APPLIED '
  6610                                 TO WS-COMMENT
  6611           MOVE 'S'              TO WS-AH-STATUS
  6612*          PERFORM 0030-BUILD-BUFFER
  6613*                                THRU 0030-EXIT
  6614*          IF NOT ALREADY-SENT
  6615*             PERFORM 0020-SEND-BUFFER
  6616*                                THRU 0020-EXIT
  6617*             SET ALREADY-SENT   TO TRUE
  6618*          END-IF
  6619           GO TO 0500-EXIT
  6620*          PERFORM 0025-CLOSE-SOCKET
  6621*                                THRU 0025-EXIT
  6622*          GO TO 0010-RETURN
  6623        END-IF
  6624     END-IF
  6625     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 116
* SOCK03.cbl
  6626        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6627        MOVE 'AH COVERAGE EXPIRED '
  6628                                 TO WS-COMMENT
  6629        MOVE 'E'                 TO WS-AH-STATUS
  6630        GO TO 0500-EXIT
  6631     END-IF
  6632     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6633                                    WS-AH-PREM
  6634     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6635     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6636        * CP-REMAINING-TERM-1
  6637     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6638                                     WS-AH-REM-TERM
  6639     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6640     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6641     IF WS-AH-ST-REFUND-CALC > ZERO
  6642         MOVE WS-AH-ST-REFUND-CALC
  6643                                 TO  CP-EARNING-METHOD.
  6644     IF WS-AH-FO-REFUND-CALC > ZERO
  6645         MOVE WS-AH-FO-REFUND-CALC
  6646                                 TO  CP-EARNING-METHOD.
  6647*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6648     if ws-comp-id = 'AHL'
  6649        move cm-ah-class-cd      to cp-class-code
  6650        if cp-class-code = spaces
  6651           move zeros            to cp-class-code
  6652        end-if
  6653     else
  6654        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6655     end-if
  6656     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6657     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6658                                     CP-RATING-BENEFIT-AMT.
  6659     IF CP-STATE-STD-ABBRV = 'OR'
  6660         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6661                                         CM-AH-ORIG-TERM.
  6662     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6663     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6664     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6665     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6666     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6667     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6668     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6669     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6670     MOVE ' '                    TO  DC-OPTION-CODE.
  6671     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6672     IF CP-STATE-STD-ABBRV = 'OH'
  6673        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6674         IF (CP-ORIGINAL-TERM > 60)
  6675           AND (DC-GREG-DATE-1-YMD > '831101')
  6676           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6677             MOVE '6'            TO  CP-EARNING-METHOD
  6678         END-IF
  6679        END-IF
  6680        IF WS-COMP-ID = 'CID'
  6681           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6682                           LOW-VALUES)
  6683              IF CP-CRITICAL-PERIOD
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 117
* SOCK03.cbl
  6684                 MOVE '2'       TO CP-EARNING-METHOD
  6685              ELSE
  6686                 MOVE '6'       TO CP-EARNING-METHOD
  6687              END-IF
  6688           ELSE
  6689              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6690                 MOVE '2'       TO CP-EARNING-METHOD
  6691              ELSE
  6692                 IF ((CM-LF-ORIG-TERM > 60) AND
  6693                    (CM-RATE-CLASS NOT = 'L '))
  6694                               OR
  6695                    (WS-LF-CO-EARNINGS-CALC = '5')
  6696                    IF CP-CRITICAL-PERIOD
  6697                       MOVE '2'  TO CP-EARNING-METHOD
  6698                    ELSE
  6699                       MOVE '6'  TO CP-EARNING-METHOD
  6700                    END-IF
  6701                 ELSE
  6702                    MOVE '1'     TO CP-EARNING-METHOD
  6703                 END-IF
  6704              END-IF
  6705           END-IF
  6706        END-IF
  6707     END-IF
  6708     IF CP-STATE-STD-ABBRV = 'VA'
  6709       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6710         IF DC-GREG-DATE-1-YMD > '921231'
  6711            IF CP-ORIGINAL-TERM > 61
  6712                MOVE '6'            TO  CP-EARNING-METHOD
  6713            ELSE
  6714                MOVE '1'            TO  CP-EARNING-METHOD.
  6715*    IF CP-EARN-AS-NET-PAY
  6716*       IF CP-LOAN-APR <= ZEROS
  6717*          IF WS-CF-DEFAULT-APR > ZEROS
  6718*             MOVE WS-CF-DEFAULT-APR
  6719*                                TO  CP-LOAN-APR
  6720*          END-IF
  6721*       END-IF
  6722*    END-IF
  6723     IF WS-COMP-ID = 'DCC' or 'VPP'
  6724        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6725           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6726           MOVE 'S'              TO CP-EARNING-METHOD
  6727        END-IF
  6728     END-IF
  6729     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6730     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6731        AND (CP-EARNING-METHOD = 'D')
  6732        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6733                                    WS-DDF-CSO-ADMIN-FEE
  6734                                    WS-DDF-1ST-YR-TOT-EXP
  6735                                    WS-DDF-COMM-AND-MFEE
  6736        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6737           S1 > +10
  6738           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6739              IF (AM-A-COM (S1) NUMERIC)
  6740                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6741                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 118
* SOCK03.cbl
  6742              ELSE
  6743                 MOVE +0         TO WS-COMM-PCT C0
  6744                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6745                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6746              END-IF
  6747              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6748                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6749                    + WS-COMM-PCT
  6750              END-IF
  6751              IF AM-COM-TYP (S1) = 'N'
  6752                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6753                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6754              END-IF
  6755              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6756                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6757                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6758              END-IF
  6759              IF AM-COM-TYP (S1) = 'I'
  6760                 COMPUTE WS-DDF-COMM-AND-MFEE
  6761                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6762              END-IF
  6763           END-IF
  6764        END-PERFORM
  6765        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6766        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6767        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6768           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6769     END-IF
  6770     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6771        AND (CP-EARNING-METHOD = 'D')
  6772        AND (ws-CANCEL-REASON NOT = 'R')
  6773        PERFORM 0730-GET-DDF-FACTORS
  6774                                 THRU 0730-EXIT
  6775        IF NOT PDEF-FOUND
  6776           MOVE ' DDF UE FACTORS  NOT FOUND '
  6777                                 TO WS-COMMENT
  6778           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6779           PERFORM 0030-BUILD-BUFFER
  6780                                 THRU 0030-EXIT
  6781           PERFORM 0020-SEND-BUFFER
  6782                                 THRU 0020-EXIT
  6783           PERFORM 0025-CLOSE-SOCKET
  6784                                 THRU 0025-EXIT
  6785           GO TO 0010-RETURN
  6786        END-IF
  6787*       IF NOT PDEF-FOUND
  6788*          MOVE ER-9999          TO EMI-ERROR
  6789*          PERFORM 9700-ERROR-FORMAT
  6790*                                THRU 9799-EXIT
  6791*          GO TO 8200-SEND-DATAONLY
  6792*       END-IF
  6793        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6794                                 TO CP-DDF-LO-FACT
  6795        MOVE PD-UEP-FACTOR (P1 P2)
  6796                                 TO CP-DDF-HI-FACT
  6797        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6798        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6799        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 119
* SOCK03.cbl
  6800        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6801           + PD-1ST-YR-ADMIN-ALLOW
  6802        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6803*       IF PI-CLP-YN = 'Y'
  6804*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6805*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6806*                                   CP-DDF-CLP
  6807*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6808*       END-IF
  6809        IF DD-IU-PRESENT
  6810           MOVE 'I'              TO CP-EARNING-METHOD
  6811        END-IF
  6812        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6813                                    CP-CLP-RATE-UP
  6814        IF (CP-CALC-GROSS-FEE)
  6815           AND (CP-IU-RATE-UP NOT = ZEROS)
  6816           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6817              / CP-ORIGINAL-PREMIUM)
  6818           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6819              / (1 - TEX-FACT-8)
  6820        END-IF
  6821     END-IF
  6822     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6823     IF (CP-ERROR-RATE-IS-ZERO)
  6824        OR (CP-ERROR-RATE-NOT-FOUND)
  6825        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6826        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6827          DELIMITED BY SIZE INTO WS-COMMENT
  6828        END-STRING
  6829        IF WS-AH-STATUS NOT = 'H'
  6830           MOVE 'X'                 TO WS-AH-STATUS
  6831        END-IF
  6832        GO TO 0500-EXIT
  6833*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6834*       IF NOT ALREADY-SENT
  6835*          PERFORM 0020-SEND-BUFFER
  6836*                                THRU 0020-EXIT
  6837*          SET ALREADY-SENT      TO TRUE
  6838*       END-IF
  6839*       PERFORM 0025-CLOSE-SOCKET
  6840*                                THRU 0025-EXIT
  6841*       GO TO 0010-RETURN
  6842     END-IF
  6843     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6844                                    WS-TOT-AH-RFND
  6845     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6846     IF ((WS-AH-STATUS = SPACES)
  6847        OR (CP-CALC-REFUND > ZEROS))
  6848                  AND
  6849          (WS-AH-STATUS NOT = 'H')
  6850        MOVE 'A'                 TO WS-AH-STATUS
  6851     END-IF
  6852     IF WS-COMP-ID = 'DCC' or 'VPP'
  6853        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6854        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6855        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6856        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6857        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 120
* SOCK03.cbl
  6858        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6859        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6860        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6861        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6862     END-IF
  6863     EVALUATE TRUE
  6864        WHEN CP-R-AS-R78
  6865           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6866        WHEN CP-R-AS-PRORATA
  6867           MOVE 'PRORATA'          TO  WS-AH-METHOD
  6868        WHEN CP-REFUND-TYPE-USED = '3'
  6869           MOVE 'CALIF'            TO  WS-AH-METHOD
  6870        WHEN CP-R-AS-TEXAS
  6871           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6872        WHEN CP-R-AS-FARM-PLAN
  6873           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6874        WHEN CP-R-AS-NET-PAY
  6875           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6876        WHEN CP-R-AS-ANTICIPATION
  6877           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6878        WHEN CP-R-AS-MEAN
  6879           MOVE 'MEAN'             TO  WS-AH-METHOD
  6880        WHEN CP-R-AS-SUM-OF-DIGITS
  6881           MOVE 'SUM OF DIGITS'    TO  WS-AH-METHOD
  6882        WHEN CP-GAP-ACTUARIAL
  6883           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6884        WHEN CP-R-AS-REPOSSESSION
  6885           MOVE 'REPOSSESSION'     TO WS-AH-METHOD
  6886     END-EVALUATE
  6887     IF WS-TOT-AH-RFND > ZEROS
  6888        IF (ws-comp-id = 'DCC' or 'VPP')
  6889           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6890           compute ws-work-factor rounded =
  6891              ws-ah-rfnd-clp / cm-ah-clp
  6892        else
  6893           COMPUTE WS-WORK-FACTOR ROUNDED =
  6894              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6895        end-if
  6896        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6897           WS-TOT-AH-COMM
  6898     END-IF
  6899     IF ERACCT-FOUND
  6900        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6901           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6902        END-IF
  6903        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6904           IF (AM-COMM-CHARGEBACK (1) = 99)
  6905                     OR
  6906              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6907                     OR
  6908              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6909              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6910              MOVE ZEROS         TO WS-AH-UEC
  6911           END-IF
  6912        END-IF
  6913     END-IF
  6914     .
  6915 0500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 121
* SOCK03.cbl
  6916     EXIT.
  6917 0610-GET-ERMAIL.
  6918
  6919     move cm-control-primary     to ws-ma-key
  6920*    MOVE WS-CM-KEY              TO WS-MA-KEY
  6921
  6922* EXEC CICS READ
  6923*       INTO    (MAILING-DATA)
  6924*       DATASET ('ERMAIL')
  6925*       RIDFLD  (WS-MA-KEY)
  6926*       RESP    (WS-RESPONSE)
  6927*    END-EXEC
  6928     MOVE LENGTH OF
  6929      MAILING-DATA
  6930       TO DFHEIV11
  6931     MOVE 'ERMAIL' TO DFHEIV1
  6932*    MOVE '&"IL       E          (  N#00006413' TO DFHEIV0
  6933     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6934     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6935     MOVE X'204E233030303036343133' TO DFHEIV0(25:11)
  6936     CALL 'kxdfhei1' USING DFHEIV0,
  6937           DFHEIV1,
  6938           MAILING-DATA,
  6939           DFHEIV11,
  6940           WS-MA-KEY,
  6941           DFHEIV99,
  6942           DFHEIV99,
  6943           DFHEIV99
  6944     MOVE EIBRESP  TO WS-RESPONSE
  6945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6946
  6947     IF RESP-NORMAL
  6948        MOVE MA-CRED-BENE-NAME   to ws-cred-bene-name
  6949     else
  6950        move spaces              to ws-cred-bene-name
  6951     end-if
  6952
  6953     .
  6954 0610-EXIT.
  6955     EXIT.
  6956 0620-GET-ELCRTT.
  6957
  6958     move cm-control-primary     to ws-cs-key
  6959*    MOVE WS-CM-KEY              TO WS-CS-KEY
  6960     move 'C'                    to WS-CS-TRLR-TYPE
  6961
  6962
  6963* EXEC CICS READ
  6964*       INTO    (CERTIFICATE-TRAILERS)
  6965*       DATASET ('ELCRTT')
  6966*       RIDFLD  (WS-CS-KEY)
  6967*       RESP    (WS-RESPONSE)
  6968*    END-EXEC
  6969     MOVE LENGTH OF
  6970      CERTIFICATE-TRAILERS
  6971       TO DFHEIV11
  6972     MOVE 'ELCRTT' TO DFHEIV1
  6973*    MOVE '&"IL       E          (  N#00006435' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 122
* SOCK03.cbl
  6974     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6975     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6976     MOVE X'204E233030303036343335' TO DFHEIV0(25:11)
  6977     CALL 'kxdfhei1' USING DFHEIV0,
  6978           DFHEIV1,
  6979           CERTIFICATE-TRAILERS,
  6980           DFHEIV11,
  6981           WS-CS-KEY,
  6982           DFHEIV99,
  6983           DFHEIV99,
  6984           DFHEIV99
  6985     MOVE EIBRESP  TO WS-RESPONSE
  6986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6987
  6988     IF RESP-NORMAL
  6989        MOVE cs-vin-number       to ws-vin
  6990     else
  6991        move spaces              to ws-vin
  6992     end-if
  6993
  6994     .
  6995 0620-EXIT.
  6996     EXIT.
  6997 0700-LINK-REM-TERM.
  6998
  6999* EXEC CICS LINK
  7000*        PROGRAM   ('ELRTRM')
  7001*        COMMAREA  (CALCULATION-PASS-AREA)
  7002*        LENGTH    (CP-COMM-LENGTH)
  7003*    END-EXEC.
  7004     MOVE 'ELRTRM' TO DFHEIV1
  7005*    MOVE '."C                   (   #00006452' TO DFHEIV0
  7006     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7008     MOVE X'2020233030303036343532' TO DFHEIV0(25:11)
  7009     CALL 'kxdfhei1' USING DFHEIV0,
  7010           DFHEIV1,
  7011           CALCULATION-PASS-AREA,
  7012           CP-COMM-LENGTH,
  7013           DFHEIV99,
  7014           DFHEIV99,
  7015           DFHEIV99,
  7016           DFHEIV99
  7017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7018
  7019 0700-EXIT.
  7020     EXIT.
  7021 0710-LINK-REM-AMOUNT.
  7022
  7023* EXEC CICS LINK
  7024*        PROGRAM   ('ELRAMT')
  7025*        COMMAREA  (CALCULATION-PASS-AREA)
  7026*        LENGTH    (CP-COMM-LENGTH)
  7027*    END-EXEC
  7028     MOVE 'ELRAMT' TO DFHEIV1
  7029*    MOVE '."C                   (   #00006460' TO DFHEIV0
  7030     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 123
* SOCK03.cbl
  7032     MOVE X'2020233030303036343630' TO DFHEIV0(25:11)
  7033     CALL 'kxdfhei1' USING DFHEIV0,
  7034           DFHEIV1,
  7035           CALCULATION-PASS-AREA,
  7036           CP-COMM-LENGTH,
  7037           DFHEIV99,
  7038           DFHEIV99,
  7039           DFHEIV99,
  7040           DFHEIV99
  7041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7042     .
  7043 0710-EXIT.
  7044     EXIT.
  7045 0720-LINK-REFUND.
  7046
  7047* EXEC CICS LINK
  7048*        PROGRAM   ('ELRFND')
  7049*        COMMAREA  (CALCULATION-PASS-AREA)
  7050*        LENGTH    (CP-COMM-LENGTH)
  7051*    END-EXEC
  7052     MOVE 'ELRFND' TO DFHEIV1
  7053*    MOVE '."C                   (   #00006469' TO DFHEIV0
  7054     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7055     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7056     MOVE X'2020233030303036343639' TO DFHEIV0(25:11)
  7057     CALL 'kxdfhei1' USING DFHEIV0,
  7058           DFHEIV1,
  7059           CALCULATION-PASS-AREA,
  7060           CP-COMM-LENGTH,
  7061           DFHEIV99,
  7062           DFHEIV99,
  7063           DFHEIV99,
  7064           DFHEIV99
  7065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7066     .
  7067 0720-EXIT.
  7068     EXIT.
  7069 0730-GET-DDF-FACTORS.
  7070     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7071     MOVE WS-COMP-CD             TO ERPDEF-KEY
  7072     MOVE CM-STATE               TO ERPDEF-STATE
  7073     if cm-clp-state not = cm-state and spaces and zeros
  7074        move cm-clp-state        to erpdef-state
  7075     end-if
  7076     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7077     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7078     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7079     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7080     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7081
  7082* EXEC CICS STARTBR
  7083*        DATASET  ('ERPDEF')
  7084*        RIDFLD   (ERPDEF-KEY)
  7085*        GTEQ
  7086*        RESP     (WS-RESPONSE)
  7087*    END-EXEC
  7088     MOVE 'ERPDEF' TO DFHEIV1
  7089     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 124
* SOCK03.cbl
  7090       TO DFHEIV11
  7091*    MOVE '&,         G          &  N#00006489' TO DFHEIV0
  7092     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7093     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7094     MOVE X'204E233030303036343839' TO DFHEIV0(25:11)
  7095     CALL 'kxdfhei1' USING DFHEIV0,
  7096           DFHEIV1,
  7097           ERPDEF-KEY,
  7098           DFHEIV99,
  7099           DFHEIV11,
  7100           DFHEIV99
  7101     MOVE EIBRESP  TO WS-RESPONSE
  7102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7103     IF NOT RESP-NORMAL
  7104        GO TO 0730-EXIT
  7105     END-IF
  7106     .
  7107 0730-READNEXT.
  7108
  7109* EXEC CICS READNEXT
  7110*       DATASET  ('ERPDEF')
  7111*       INTO     (PRODUCT-MASTER)
  7112*       RIDFLD   (ERPDEF-KEY)
  7113*       RESP     (WS-RESPONSE)
  7114*    END-EXEC
  7115     MOVE LENGTH OF
  7116      PRODUCT-MASTER
  7117       TO DFHEIV12
  7118     MOVE 'ERPDEF' TO DFHEIV1
  7119     MOVE 0
  7120       TO DFHEIV11
  7121*    MOVE '&.IL                  )  N#00006500' TO DFHEIV0
  7122     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7123     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7124     MOVE X'204E233030303036353030' TO DFHEIV0(25:11)
  7125     CALL 'kxdfhei1' USING DFHEIV0,
  7126           DFHEIV1,
  7127           PRODUCT-MASTER,
  7128           DFHEIV12,
  7129           ERPDEF-KEY,
  7130           DFHEIV99,
  7131           DFHEIV11,
  7132           DFHEIV99,
  7133           DFHEIV99
  7134     MOVE EIBRESP  TO WS-RESPONSE
  7135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7136     IF NOT RESP-NORMAL
  7137        GO TO 0730-ENDBR
  7138     END-IF
  7139     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7140        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7141           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7142        ELSE
  7143           GO TO 0730-READNEXT
  7144        END-IF
  7145     ELSE
  7146        GO TO 0730-ENDBR
  7147     END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 125
* SOCK03.cbl
  7148     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7149        (P1 > +8)
  7150        OR (PD-PROD-CODE (P1) = 'I')
  7151     END-PERFORM
  7152     IF P1 < +9
  7153        SET DD-IU-PRESENT        TO TRUE
  7154     END-IF
  7155     IF CM-LOAN-TERM = ZEROS
  7156        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7157     END-IF
  7158     IF PD-TRUNCATED = 'Y'
  7159        MOVE CM-LOAN-TERM        TO WS-TERM
  7160     ELSE
  7161        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7162     END-IF
  7163     EVALUATE TRUE
  7164        WHEN WS-TERM > +168
  7165           MOVE 15               TO P1
  7166        WHEN WS-TERM > +156
  7167           MOVE 14               TO P1
  7168        WHEN WS-TERM > +144
  7169           MOVE 13               TO P1
  7170        WHEN WS-TERM > +132
  7171           MOVE 12               TO P1
  7172        WHEN WS-TERM > +120
  7173           MOVE 11               TO P1
  7174        WHEN WS-TERM > +108
  7175           MOVE 10               TO P1
  7176        WHEN WS-TERM > +96
  7177           MOVE 9                TO P1
  7178        WHEN WS-TERM > +84
  7179           MOVE 8                TO P1
  7180        WHEN WS-TERM > +72
  7181           MOVE 7                TO P1
  7182        WHEN WS-TERM > +60
  7183           MOVE 6                TO P1
  7184        WHEN WS-TERM > +48
  7185           MOVE 5                TO P1
  7186        WHEN WS-TERM > +36
  7187           MOVE 4                TO P1
  7188        WHEN WS-TERM > +24
  7189           MOVE 3                TO P1
  7190        WHEN WS-TERM > +12
  7191           MOVE 2                TO P1
  7192        WHEN OTHER
  7193           MOVE 1                TO P1
  7194     END-EVALUATE
  7195     EVALUATE TRUE
  7196*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7197*          AND (DD-IU-PRESENT)
  7198*          MOVE 2                TO P2
  7199*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7200*          MOVE 1                TO P2
  7201        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7202           MOVE 2                TO P2
  7203        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7204           MOVE 3                TO P2
  7205        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 126
* SOCK03.cbl
  7206           MOVE 4                TO P2
  7207        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7208           MOVE 5                TO P2
  7209        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7210           MOVE 6                TO P2
  7211        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7212           MOVE 7                TO P2
  7213        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7214           MOVE 8                TO P2
  7215        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7216           MOVE 9                TO P2
  7217        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7218           MOVE 10               TO P2
  7219        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7220           MOVE 11               TO P2
  7221        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7222           MOVE 12               TO P2
  7223        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7224           MOVE 13               TO P2
  7225        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7226           MOVE 14               TO P2
  7227        WHEN OTHER
  7228           MOVE 15               TO P2
  7229     END-EVALUATE
  7230     .
  7231 0730-ENDBR.
  7232
  7233* EXEC CICS ENDBR
  7234*       DATASET  ('ERPDEF')
  7235*    END-EXEC
  7236     MOVE 'ERPDEF' TO DFHEIV1
  7237     MOVE 0
  7238       TO DFHEIV11
  7239*    MOVE '&2                    $   #00006602' TO DFHEIV0
  7240     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7241     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7242     MOVE X'2020233030303036363032' TO DFHEIV0(25:11)
  7243     CALL 'kxdfhei1' USING DFHEIV0,
  7244           DFHEIV1,
  7245           DFHEIV11,
  7246           DFHEIV99
  7247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7248     .
  7249 0730-EXIT.
  7250     EXIT.
  7251 0740-GET-ERCTBL.
  7252     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7253     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7254     MOVE 'A'                    TO CTBL-BEN-TYPE
  7255     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7256     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7257     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7258     IF RESP-NORMAL
  7259        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7260     ELSE
  7261        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7262        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7263        MOVE 'A'                    TO CTBL-BEN-TYPE
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 127
* SOCK03.cbl
  7264        MOVE 'AA'                   TO CTBL-BEN-CODE
  7265        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7266        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7267        IF RESP-NORMAL
  7268           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7269        END-IF
  7270     END-IF
  7271     .
  7272 0740-EXIT.
  7273     EXIT.
  7274 0750-READ-ERCTBL.
  7275
  7276* EXEC CICS READ
  7277*         INTO    (COMM-TABLE-RECORD)
  7278*         DATASET ('ERCTBL')
  7279*         RIDFLD  (CTBL-KEY)
  7280*         RESP    (WS-RESPONSE)
  7281*    END-EXEC
  7282     MOVE LENGTH OF
  7283      COMM-TABLE-RECORD
  7284       TO DFHEIV11
  7285     MOVE 'ERCTBL' TO DFHEIV1
  7286*    MOVE '&"IL       E          (  N#00006632' TO DFHEIV0
  7287     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7288     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7289     MOVE X'204E233030303036363332' TO DFHEIV0(25:11)
  7290     CALL 'kxdfhei1' USING DFHEIV0,
  7291           DFHEIV1,
  7292           COMM-TABLE-RECORD,
  7293           DFHEIV11,
  7294           CTBL-KEY,
  7295           DFHEIV99,
  7296           DFHEIV99,
  7297           DFHEIV99
  7298     MOVE EIBRESP  TO WS-RESPONSE
  7299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7300     .
  7301 0750-EXIT.
  7302     EXIT.
  7303 0760-FIND-COMM.
  7304     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7305        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7306        OR (C1 > +3)
  7307     END-PERFORM
  7308     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7309        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7310        OR (C2 > +3)
  7311     END-PERFORM
  7312     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7313        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7314        OR (C3 > +3)
  7315     END-PERFORM
  7316     IF C1 > +3
  7317        MOVE +1                  TO C1
  7318     END-IF
  7319     IF C2 > +3
  7320        MOVE +1                  TO C2
  7321     END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 128
* SOCK03.cbl
  7322     IF C3 > +3
  7323        MOVE +1                  TO C3
  7324     END-IF
  7325     IF C1 = +3
  7326        MOVE +18                 TO C0
  7327     ELSE
  7328        IF C1 = +2
  7329           MOVE +9               TO C0
  7330        END-IF
  7331     END-IF
  7332     IF C2 = +3
  7333        ADD +6                   TO C0
  7334     ELSE
  7335        IF C2 = +2
  7336           ADD +3                TO C0
  7337        END-IF
  7338     END-IF
  7339     ADD C3                      TO C0
  7340     MOVE CT-RT (C0)             TO WS-COMM-PCT
  7341     .
  7342 0760-EXIT.
  7343     EXIT.
  7344 9700-DATE-LINK.
  7345
  7346* EXEC CICS LINK
  7347*         PROGRAM  ('ELDATCV')
  7348*         COMMAREA (DATE-CONVERSION-DATA)
  7349*         LENGTH   (DC-COMM-LENGTH)
  7350*    END-EXEC.
  7351     MOVE 'ELDATCV' TO DFHEIV1
  7352*    MOVE '."C                   (   #00006683' TO DFHEIV0
  7353     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7355     MOVE X'2020233030303036363833' TO DFHEIV0(25:11)
  7356     CALL 'kxdfhei1' USING DFHEIV0,
  7357           DFHEIV1,
  7358           DATE-CONVERSION-DATA,
  7359           DC-COMM-LENGTH,
  7360           DFHEIV99,
  7361           DFHEIV99,
  7362           DFHEIV99,
  7363           DFHEIV99
  7364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7365
  7366 9700-EXIT.
  7367      EXIT.
  7368
  7369 9999-DFHBACK SECTION.
  7370     MOVE '9%                    "   ' TO DFHEIV0
  7371     MOVE 'SOCK03' TO DFHEIV1
  7372     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7373     GOBACK.
  7374 9999-DFHEXIT.
  7375     IF DFHEIGDJ EQUAL 0001
  7376         NEXT SENTENCE.
  7377     MOVE '9%                    "   ' TO DFHEIV0
  7378     MOVE 'SOCK03' TO DFHEIV1
  7379     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 07-Aug-19 12:57 Page 129
* SOCK03.cbl
  7380     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       20048     Code:       30922
