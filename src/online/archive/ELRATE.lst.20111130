* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   1
* ELRATE.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"ELRATE.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   2
* ELRATE.cbl
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192******************************************************************
   193
   194 01  NET-PAY-WORK-AREA.
   195     12  OPTION-SW               PIC X   VALUE 'X'.
   196        88  NPO-STD         VALUE SPACE.
   197        88  NPO-ALT         VALUE 'A'.
   198        88  NPO-SIMPLE      VALUE 'S'.
   199        88  NPO-2MO         VALUE 'I'.
   200        88  NPO-3MO         VALUE 'J'.
   201        88  NPO-4MO         VALUE 'K'.
   202        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   203        88  NPO-TRUNC-0     VALUE 'T'.
   204        88  NPO-TRUNC-1     VALUE 'U'.
   205        88  NPO-TRUNC-2     VALUE 'V'.
   206        88  NPO-TRUNC-3     VALUE 'W'.
   207        88  NPO-TRUNC-4     VALUE 'X'.
   208        88  NPO-REFUND      VALUE 'R'.
   209        88  NPO-PRUDENTIAL  VALUE 'P'.
   210
   211     12  TYPE-SW             PIC X   VALUE 'N'.
   212        88  NET-STD             VALUE 'N'.
   213        88  NET-SMP             VALUE 'S'.
   214
   215     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   216        88  NP-RATING           VALUE '1'.
   217        88  NP-REFUND           VALUE '2'.
   218        88  NP-REMAIN-AMT       VALUE '3'.
   219
   220     12  COMP-3-WORK-AREA         COMP-3.
   221         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   222         16  V               PIC SV9(13)       VALUE +.0.
   223         16  J               PIC SV9(9)        VALUE +0.
   224         16  K               PIC SV9(9)        VALUE +0.
   225         16  I               PIC SV9(10)       VALUE +.0.
   226         16  D               PIC S9(5)         VALUE +.0.
   227         16  APR100          PIC SV9(9)        VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   6
* ELRATE.cbl
   228         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   229         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   230         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   232         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   233         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   234         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   235         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   236         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   237         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   238         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   239         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   240         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   241         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   242         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   243         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   244         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   246         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   247         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   248         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   251         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   252         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   253         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   254         16  K1              PIC S999          VALUE +1.
   255         16  K12             PIC S999          VALUE +12.
   256         16  K100            PIC S999          VALUE +100.
   257         16  K1000           PIC S9(7)         VALUE +1000.
   258         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   259         16  Y REDEFINES NC-LR
   260                             PIC S99V9(5).
   261         16  TI              PIC S999V9(5)     VALUE +0.
   262         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   263         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   264         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   265         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   266         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   267         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   268         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   269         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   270
   271         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   272         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   273         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   274         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   275         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   276         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   277         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   278         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   279         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   280         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   281         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   282         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   283         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   284
   285         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   7
* ELRATE.cbl
   286
   287         16  ORIGINAL-TERM   PIC S999.
   288         16  M              REDEFINES ORIGINAL-TERM
   289                             PIC S999.
   290
   291         16  REMAINING-TERM  PIC S999.
   292         16  R              REDEFINES REMAINING-TERM
   293                             PIC S999.
   294
   295         16  LOAN-TERM       PIC S999.
   296         16  N              REDEFINES LOAN-TERM
   297                             PIC S999.
   298
   299         16  EXPIRED-TERM    PIC S999.
   300         16  E              REDEFINES EXPIRED-TERM
   301                             PIC S999.
   302
   303         16  PRUDENTIAL-WORK-AMT
   304                             PIC S9(7)V9(8).
   305         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   306                             PIC S9(7)V9(8).
   307
   308         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   309         16  VX              PIC S9V9(13)      VALUE +0.0.
   310         16  SV              PIC S9V9(13)      VALUE +0.0.
   311         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   312         16  SX              PIC S9V9(13)      VALUE +0.0.
   313         16  SE              PIC S9V9(10)      VALUE +0.0.
   314         16  N2              PIC S9(7)         VALUE +0.
   315         16  N3              PIC S9(7)         VALUE +0.
   316         16  K-I             PIC S9V9(8)       VALUE +0.0.
   317
   318     12  BINARY-WORK-AREA        COMP.
   319         16  X1              PIC S999        VALUE +0.
   320         16  X2              PIC S999        VALUE +0.
   321         16  MAX-X           PIC S9(5)       VALUE +0.
   322         16  B1              PIC S9(5)       VALUE +1.
   323         16  LINDX           PIC S999        VALUE ZEROS.
   324         16  AHNDX           PIC S999        VALUE ZEROS.
   325
   326     12  CSO-RATE-WORK-AREAS.
   327         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   328         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   329         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   330     12  WS-WORK-MISC.
   331         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   332         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   333*        16  WS-AGE              PIC 99           VALUE ZEROS.
   334         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   335         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   336         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   337         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   338         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   339         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   340         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   341         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   342         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   343         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   8
* ELRATE.cbl
   344         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   345         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   346******************************************************************
   347
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   9
* ELRATE.cbl
   349*                            COPY ELCDATE.
   350******************************************************************
   351*                                                                *
   352*                                                                *
   353*                            ELCDATE.                            *
   354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   355*                            VMOD=2.003
   356*                                                                *
   357*                                                                *
   358*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   359*                 LENGTH = 200                                   *
   360******************************************************************
   361
   362 01  DATE-CONVERSION-DATA.
   363     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   364     12  DC-OPTION-CODE                PIC X.
   365         88  BIN-TO-GREG                VALUE ' '.
   366         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   367         88  EDIT-GREG-TO-BIN           VALUE '2'.
   368         88  YMD-GREG-TO-BIN            VALUE '3'.
   369         88  MDY-GREG-TO-BIN            VALUE '4'.
   370         88  JULIAN-TO-BIN              VALUE '5'.
   371         88  BIN-PLUS-ELAPSED           VALUE '6'.
   372         88  FIND-CENTURY               VALUE '7'.
   373         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   374         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   375         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   376         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   377         88  JULIAN-TO-BIN-3            VALUE 'C'.
   378         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   379         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   380         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   381         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   382         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   383         88  CHECK-LEAP-YEAR            VALUE 'H'.
   384         88  BIN-3-TO-GREG              VALUE 'I'.
   385         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   386         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   387         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   388         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   389         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   390         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   391         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   392         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   393         88  THREE-CHARACTER-BIN
   394                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   395         88  GREGORIAN-TO-BIN
   396                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   397         88  BIN-TO-GREGORIAN
   398                  VALUES ' ' '1' 'I' '8' 'G'.
   399         88  JULIAN-TO-BINARY
   400                  VALUES '5' 'C' 'E' 'F'.
   401     12  DC-ERROR-CODE                 PIC X.
   402         88  NO-CONVERSION-ERROR        VALUE ' '.
   403         88  DATE-CONVERSION-ERROR
   404                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   405         88  DATE-IS-ZERO               VALUE '1'.
   406         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  10
* ELRATE.cbl
   407         88  DATE-IS-INVALID            VALUE '3'.
   408         88  DATE1-GREATER-DATE2        VALUE '4'.
   409         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   410         88  DATE-INVALID-OPTION        VALUE '9'.
   411         88  INVALID-CENTURY            VALUE 'A'.
   412         88  ONLY-CENTURY               VALUE 'B'.
   413         88  ONLY-LEAP-YEAR             VALUE 'C'.
   414         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   415     12  DC-END-OF-MONTH               PIC X.
   416         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   417     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   418         88  USE-NORMAL-PROCESS         VALUE ' '.
   419         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   420         88  ADJUST-UP-100-YRS          VALUE '2'.
   421     12  FILLER                        PIC X.
   422     12  DC-CONVERSION-DATES.
   423         16  DC-BIN-DATE-1             PIC XX.
   424         16  DC-BIN-DATE-2             PIC XX.
   425         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   426         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   427                       DC-GREG-DATE-1-EDIT.
   428             20  DC-EDIT1-MONTH        PIC 99.
   429             20  SLASH1-1              PIC X.
   430             20  DC-EDIT1-DAY          PIC 99.
   431             20  SLASH1-2              PIC X.
   432             20  DC-EDIT1-YEAR         PIC 99.
   433         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   434         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   435                     DC-GREG-DATE-2-EDIT.
   436             20  DC-EDIT2-MONTH        PIC 99.
   437             20  SLASH2-1              PIC X.
   438             20  DC-EDIT2-DAY          PIC 99.
   439             20  SLASH2-2              PIC X.
   440             20  DC-EDIT2-YEAR         PIC 99.
   441         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   442         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   443                     DC-GREG-DATE-1-YMD.
   444             20  DC-YMD-YEAR           PIC 99.
   445             20  DC-YMD-MONTH          PIC 99.
   446             20  DC-YMD-DAY            PIC 99.
   447         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   448         16  DC-GREG-DATE-1-MDY-R REDEFINES
   449                      DC-GREG-DATE-1-MDY.
   450             20  DC-MDY-MONTH          PIC 99.
   451             20  DC-MDY-DAY            PIC 99.
   452             20  DC-MDY-YEAR           PIC 99.
   453         16  DC-GREG-DATE-1-ALPHA.
   454             20  DC-ALPHA-MONTH        PIC X(10).
   455             20  DC-ALPHA-DAY          PIC 99.
   456             20  FILLER                PIC XX.
   457             20  DC-ALPHA-CENTURY.
   458                 24 DC-ALPHA-CEN-N     PIC 99.
   459             20  DC-ALPHA-YEAR         PIC 99.
   460         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   461         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   462         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   463         16  DC-JULIAN-DATE            PIC 9(05).
   464         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  11
* ELRATE.cbl
   465                                       PIC 9(05).
   466         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   467             20  DC-JULIAN-YEAR        PIC 99.
   468             20  DC-JULIAN-DAYS        PIC 999.
   469         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   470         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   471         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   472     12  DATE-CONVERSION-VARIBLES.
   473         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   474         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   475             20  FILLER                PIC 9(3).
   476             20  HOLD-CEN-1-CCYY.
   477                 24  HOLD-CEN-1-CC     PIC 99.
   478                 24  HOLD-CEN-1-YY     PIC 99.
   479             20  HOLD-CEN-1-MO         PIC 99.
   480             20  HOLD-CEN-1-DA         PIC 99.
   481         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   482             20  HOLD-CEN-1-R-MO       PIC 99.
   483             20  HOLD-CEN-1-R-DA       PIC 99.
   484             20  HOLD-CEN-1-R-CCYY.
   485                 24  HOLD-CEN-1-R-CC   PIC 99.
   486                 24  HOLD-CEN-1-R-YY   PIC 99.
   487             20  FILLER                PIC 9(3).
   488         16  HOLD-CENTURY-1-X.
   489             20  FILLER                PIC X(3)  VALUE SPACES.
   490             20  HOLD-CEN-1-X-CCYY.
   491                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   492                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   493             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   494             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   495         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   496             20  HOLD-CEN-1-R-X-MO     PIC XX.
   497             20  HOLD-CEN-1-R-X-DA     PIC XX.
   498             20  HOLD-CEN-1-R-X-CCYY.
   499                 24  HOLD-CEN-1-R-X-CC PIC XX.
   500                 24  HOLD-CEN-1-R-X-YY PIC XX.
   501             20  FILLER                PIC XXX.
   502         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   503         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   504         16  DC-JULIAN-DATE-1          PIC 9(07).
   505         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   506             20  DC-JULIAN-1-CCYY.
   507                 24  DC-JULIAN-1-CC    PIC 99.
   508                 24  DC-JULIAN-1-YR    PIC 99.
   509             20  DC-JULIAN-DA-1        PIC 999.
   510         16  DC-JULIAN-DATE-2          PIC 9(07).
   511         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   512             20  DC-JULIAN-2-CCYY.
   513                 24  DC-JULIAN-2-CC    PIC 99.
   514                 24  DC-JULIAN-2-YR    PIC 99.
   515             20  DC-JULIAN-DA-2        PIC 999.
   516         16  DC-GREG-DATE-A-EDIT.
   517             20  DC-EDITA-MONTH        PIC 99.
   518             20  SLASHA-1              PIC X VALUE '/'.
   519             20  DC-EDITA-DAY          PIC 99.
   520             20  SLASHA-2              PIC X VALUE '/'.
   521             20  DC-EDITA-CCYY.
   522                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  12
* ELRATE.cbl
   523                 24  DC-EDITA-YEAR     PIC 99.
   524         16  DC-GREG-DATE-B-EDIT.
   525             20  DC-EDITB-MONTH        PIC 99.
   526             20  SLASHB-1              PIC X VALUE '/'.
   527             20  DC-EDITB-DAY          PIC 99.
   528             20  SLASHB-2              PIC X VALUE '/'.
   529             20  DC-EDITB-CCYY.
   530                 24  DC-EDITB-CENT     PIC 99.
   531                 24  DC-EDITB-YEAR     PIC 99.
   532         16  DC-GREG-DATE-CYMD         PIC 9(08).
   533         16  DC-GREG-DATE-CYMD-R REDEFINES
   534                              DC-GREG-DATE-CYMD.
   535             20  DC-CYMD-CEN           PIC 99.
   536             20  DC-CYMD-YEAR          PIC 99.
   537             20  DC-CYMD-MONTH         PIC 99.
   538             20  DC-CYMD-DAY           PIC 99.
   539         16  DC-GREG-DATE-MDCY         PIC 9(08).
   540         16  DC-GREG-DATE-MDCY-R REDEFINES
   541                              DC-GREG-DATE-MDCY.
   542             20  DC-MDCY-MONTH         PIC 99.
   543             20  DC-MDCY-DAY           PIC 99.
   544             20  DC-MDCY-CEN           PIC 99.
   545             20  DC-MDCY-YEAR          PIC 99.
   546    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   547        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   548    12  DC-EL310-DATE                  PIC X(21).
   549    12  FILLER                         PIC X(28).
   550
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  13
* ELRATE.cbl
   552*                            COPY ELCCALC.
   553******************************************************************
   554*                                                                *
   555*                           ELCCALC.                            *
   556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   557*                            VMOD=2.025                          *
   558*                                                                *
   559*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   560*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   561*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   562*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   563*                                                                *
   564*  PASSED TO ELRTRM                                              *
   565*  -----------------                                             *
   566*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   567*  ORIGINAL TERM                                                 *
   568*  BEGINNING DATE                                                *
   569*  ENDING DATE                                                   *
   570*  COMPANY I.D.                                                  *
   571*  ACCOUNT MASTER USER FIELD                                     *
   572*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   573*  FREE LOOK DAYS                                                *
   574*                                                                *
   575*  RETURNED FROM ELRTRM                                          *
   576*  ---------------------                                         *
   577*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   578*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   579*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   580*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   581*----------------------------------------------------------------*
   582*  PASSED TO ELRAMT                                              *
   583*  ----------------                                              *
   584*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   585*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   586*  ORIGINAL AMOUNT                                               *
   587*  ALTERNATE BENEFIT (BALLON)                                    *
   588*  A.P.R. - NET PAY ONLY                                         *
   589*  METHOD
   590*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   591*  COMPANY I.D.                                                  *
   592*  BENEFIT TYPE                                                  *
   593*                                                                *
   594*  RETURNED FROM ELRAMT                                          *
   595*  --------------------                                          *
   596*  REMAINING AMOUNT 1 - CURRENT                                  *
   597*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   598*  REMAINING AMOUNT FACTOR
   599*----------------------------------------------------------------*
   600*  PASSED TO ELRESV                                              *
   601*  -----------------                                             *
   602*  CERTIFICATE EFFECTIVE DATE                                    *
   603*  VALUATION DATE                                                *
   604*  PAID THRU DATE                                                *
   605*  BENEFIT                                                       *
   606*  INCURRED DATE                                                 *
   607*  REPORTED DATE                                                 *
   608*  ISSUE AGE                                                     *
   609*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  14
* ELRATE.cbl
   610*  CDT PERCENT                                                   *
   611*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   612* *CLAIM TYPE (LIFE, A/H)                                        *
   613* *REMAINING BENEFIT (FROM ELRAMT)                               *
   614* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   615*                                                                *
   616*  RETURNED FROM ELRESV                                          *
   617*  --------------------                                          *
   618*  CDT TABLE USED                                                *
   619*  CDT FACTOR USED                                               *
   620*  PAY TO CURRENT RESERVE                                        *
   621*  I.B.N.R. - A/H ONLY                                           *
   622*  FUTURE (ACCRUED) AH ONLY                                      *
   623*----------------------------------------------------------------*
   624*  PASSED TO ELRATE                                              *
   625*  ----------------                                              *
   626*  CERT ISSUE DATE                                               *
   627*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   628*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   629*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   630*  STATE CODE (CLIENT DEFINED)                                   *
   631*  STATE CODE (STANDARD P.O. ABBRV)                              *
   632*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   633*  DEVIATION CODE                                                *
   634*  ISSUE AGE                                                     *
   635*  ORIGINAL BENEFIT AMOUNT                                       *
   636*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   637*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   638*  BENEFIT KIND (LIFE OR A/H)                                    *
   639*  A.P.R.                                                        *
   640*  METHOD
   641*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   642*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   643*  COMPANY I.D. (3 CHARACTER)                                    *
   644*  BENEFIT CODE                                                  *
   645*  BENEFIT OVERRIDE CODE                                         *
   646*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   647*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   648*  JOINT INDICATOR (CSL ONLY)                                    *
   649*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   650*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   651*                                                                *
   652*  RETURNED FROM ELRATE                                          *
   653*  --------------------                                          *
   654*  CALCULATED PREMIUM                                            *
   655*  PREMIUM RATE                                                  *
   656*  MORTALITY CODE                                                *
   657*  MAX ATTAINED AGE                                              *
   658*  MAX AGE                                                       *
   659*  MAX TERM                                                      *
   660*  MAX MONTHLY BENEFIT                                           *
   661*  MAX TOTAL BENIFIT                                             *
   662*  COMPOSITE RATE (OPEN-END ONLY)                                *
   663*----------------------------------------------------------------*
   664*  PASSED TO ELRFND                                              *
   665*  ----------------                                              *
   666*  CERT ISSUE DATE                                               *
   667*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  15
* ELRATE.cbl
   668*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   669*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   670*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   671*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   672*  STATE CODE (CLIENT DEFINED)                                   *
   673*  STATE CODE (STANDARD P.O. ABBRV)                              *
   674*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   675*  DEVIATION CODE                                                *
   676*  ISSUE AGE                                                     *
   677*  ORIGINAL BENEFIT AMOUNT                                       *
   678*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   679*  PROCESS TYPE (CANCEL)                                         *
   680*  BENEFIT KIND (LIFE OR A/H)                                    *
   681*  A.P.R.                                                        *
   682*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   683*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   684*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   685*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   686*  COMPANY I.D. (3 CHARACTER)                                    *
   687*  BENEFIT CODE                                                  *
   688*  BENEFIT OVERRIDE CODE                                         *
   689*                                                                *
   690*  RETURNED FROM ELRFND                                          *
   691*  --------------------                                          *
   692*  CALCULATED REFUND                                             *
   693*----------------------------------------------------------------*
   694*  PASSED TO ELEARN                                              *
   695*  ----------------                                              *
   696*  CERT ISSUE DATE                                               *
   697*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   698*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   699*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   700*  STATE CODE (CLIENT DEFINED)                                   *
   701*  STATE CODE (STANDARD P.O. ABBRV)                              *
   702*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   703*  DEVIATION CODE                                                *
   704*  ISSUE AGE                                                     *
   705*  ORIGINAL BENEFIT AMOUNT                                       *
   706*  BENEFIT KIND (LIFE OR A/H)                                    *
   707*  A.P.R.                                                        *
   708*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   709*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   710*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   711*  COMPANY I.D. (3 CHARACTER)                                    *
   712*  BENEFIT CODE                                                  *
   713*  BENEFIT OVERRIDE CODE                                         *
   714*                                                                *
   715*  RETURNED FROM ELEARN                                          *
   716*  --------------------                                          *
   717*  INDICATED  EARNINGS                                           *
   718*----------------------------------------------------------------*
   719*                 LENGTH = 450                                   *
   720*                                                                *
   721******************************************************************
   722******************************************************************
   723*                   C H A N G E   L O G
   724*
   725* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  16
* ELRATE.cbl
   726*-----------------------------------------------------------------
   727*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   728* EFFECTIVE    NUMBER
   729*-----------------------------------------------------------------
   730* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   731* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   732* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   733* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   734* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   735* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   736* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   737* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   738* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   739******************************************************************
   740
   741 01  CALCULATION-PASS-AREA.
   742     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   743                                     COMP.
   744
   745     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   746       88  NO-CP-ERROR                             VALUE ZERO.
   747       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   748                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   749       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   750       88  CP-ERROR-IN-DATES                       VALUE '2'.
   751       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   752       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   753       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   754       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   755       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   756       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   757       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   758       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   759       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   760       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   761       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   762       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   763       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   764       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   765       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   766
   767     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   768       88  NO-CP-ERROR-2                           VALUE ZERO.
   769***********************  INPUT AREAS ****************************
   770
   771     12  CP-CALCULATION-AREA.
   772         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   773         16  CP-CERT-EFF-DT        PIC XX.
   774         16  CP-VALUATION-DT       PIC XX.
   775         16  CP-PAID-THRU-DT       PIC XX.
   776         16  CP-BENEFIT-TYPE       PIC X.
   777           88  CP-AH                               VALUE 'A' 'D'
   778                                                   'I' 'U'.
   779           88  CP-REDUCING-LIFE                    VALUE 'R'.
   780           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   781         16  CP-INCURRED-DT        PIC XX.
   782         16  CP-REPORTED-DT        PIC XX.
   783         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  17
* ELRATE.cbl
   784         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   785         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   786                                     COMP-3.
   787         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   788                                     COMP-3.
   789         16  CP-CDT-METHOD         PIC X.
   790           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   791           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   792           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   793         16  CP-CLAIM-TYPE         PIC X.
   794           88  CP-AH-CLAIM                         VALUE 'A'.
   795           88  CP-LIFE-CLAIM                       VALUE 'L'.
   796         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   797                                     COMP-3.
   798         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   799                                     COMP-3.
   800         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   801                                     COMP-3.
   802         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   803                                     COMP-3.
   804         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   805                                     COMP-3.
   806         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   807                                     COMP-3.
   808         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   809                                     COMP-3.
   810         16  CP-REM-TERM-METHOD    PIC X.
   811           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   812           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   813           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   814           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   815           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   816           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   817           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   818         16  CP-EARNING-METHOD     PIC X.
   819           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   820           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   821           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   822           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   823           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   824           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   825           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   826           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   827           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   828           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   829           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   830           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   831           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   832           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   833         16  CP-PROCESS-TYPE       PIC X.
   834           88  CP-CLAIM                            VALUE '1'.
   835           88  CP-CANCEL                           VALUE '2'.
   836           88  CP-ISSUE                            VALUE '3'.
   837         16  CP-SPECIAL-CALC-CD    PIC X.
   838           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   839           88  CP-1-MTH-INTEREST               VALUE ' '.
   840           88  CP-0-MTH-INTEREST               VALUE 'A'.
   841           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  18
* ELRATE.cbl
   842           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   843           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   844           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   845           88  CP-FARM-PLAN                    VALUE 'F'.
   846           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   847           88  CP-2-MTH-INTEREST               VALUE 'I'.
   848           88  CP-3-MTH-INTEREST               VALUE 'J'.
   849           88  CP-4-MTH-INTEREST               VALUE 'K'.
   850           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   851           88  CP-MORTGAGE-REC                 VALUE 'M'.
   852           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   853           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   854           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   855           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   856                                                     'W' 'X'.
   857           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   858           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   859           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   860           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   861           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   862           88  CP-SUMMARY-REC                  VALUE 'Z'.
   863           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   864           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   865           88  CP-AD-D-BENEFIT                 VALUE '4'.
   866           88  CP-CSL-METH-1                   VALUE '5'.
   867           88  CP-CSL-METH-2                   VALUE '6'.
   868           88  CP-CSL-METH-3                   VALUE '7'.
   869           88  CP-CSL-METH-4                   VALUE '8'.
   870
   871         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   872                                     COMP-3.
   873         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   874         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   875         16  CP-STATE              PIC XX          VALUE SPACE.
   876         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   877         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   878           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   879               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   880         16  CP-R78-OPTION         PIC X.
   881           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   882           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   883
   884         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   885         16  CP-IBNR-RESERVE-SW    PIC X.
   886         16  CP-CLAIM-STATUS       PIC X.
   887         16  CP-RATE-FILE          PIC X.
   888         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   889                                     COMP-3.
   890
   891         16  CP-LIFE-OVERRIDE-CODE PIC X.
   892         16  CP-AH-OVERRIDE-CODE   PIC X.
   893
   894         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   895                                     COMP-3.
   896         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   897                                   PIC S9(5)V99 COMP-3.
   898         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   899                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  19
* ELRATE.cbl
   900         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   901                                     COMP-3.
   902         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   903                                     COMP-3.
   904         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   905                                  PIC S9(7)V99 COMP-3.
   906
   907         16  CP-PAID-FROM-DATE     PIC X(02).
   908         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   909         16  CP-EXT-DAYS-CALC      PIC X.
   910           88  CP-EXT-NO-CHG                   VALUE ' '.
   911           88  CP-EXT-CHG-LF                   VALUE '1'.
   912           88  CP-EXT-CHG-AH                   VALUE '2'.
   913           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   914         16  CP-DOMICILE-STATE     PIC XX.
   915         16  CP-CARRIER            PIC X.
   916         16  CP-REIN-FLAG          PIC X.
   917         16  CP-REM-TRM-CALC-OPTION PIC X.
   918           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   919                      '2' '3' '4' '5'.
   920           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   921           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   922           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   923           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   924           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   925           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   926           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   927           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   928         16  CP-SIG-SWITCH         PIC X.
   929         16  CP-RATING-METHOD      PIC X.
   930           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   931           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   932           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   933           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   934           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   935           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   936           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   937           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   938           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   939         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   940                                     COMP-3.
   941         16  CP-BEN-CATEGORY       PIC X.
   942         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   943         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   944                                   PIC S99V9(5) COMP-3.
   945         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   946         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   947                                   PIC S99V9(5) COMP-3.
   948         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   949         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   950         16  CP-EXPIRE-DT          PIC XX.
   951         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   952         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   953         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   954         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   955         16  CP-DDF-SPEC-CALC      PIC X.
   956             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   957             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  20
* ELRATE.cbl
   958         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   959         16  CP-CANCEL-REASON      PIC X.
   960         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   961         16  CP-PMT-MODE           PIC X.
   962         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   963         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   964         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   965         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   966         16  FILLER                PIC X.
   967
   968***************    OUTPUT FROM ELRESV   ************************
   969
   970         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   971
   972         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   973                                     COMP-3.
   974         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   975                                     COMP-3.
   976         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   977                                     COMP-3.
   978         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   979                                     COMP-3.
   980         16  FILLER                PIC X(09).
   981***************    OUTPUT FROM ELRTRM   *************************
   982
   983         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   984                                     COMP-3.
   985         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   986                                     COMP-3.
   987         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   988                                     COMP-3.
   989         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   990                                     COMP-3.
   991         16  FILLER                PIC X(12).
   992
   993***************    OUTPUT FROM ELRAMT   *************************
   994
   995         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   996                                     COMP-3.
   997         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   998                                     COMP-3.
   999         16  FILLER                PIC X(12).
  1000
  1001***************    OUTPUT FROM ELRATE   *************************
  1002
  1003         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1004                                     COMP-3.
  1005         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1006                                     COMP-3.
  1007         16  CP-MORTALITY-CODE     PIC X(4).
  1008         16  CP-RATE-EDIT-FLAG     PIC X.
  1009             88  CP-RATES-NEED-APR                  VALUE '1'.
  1010         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1011                                     COMP-3.
  1012         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1013         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1014         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1015                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  21
* ELRATE.cbl
  1016         16  FILLER                PIC X(07).
  1017
  1018***************    OUTPUT FROM ELRFND   *************************
  1019
  1020         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1021                                     COMP-3.
  1022         16  CP-REFUND-TYPE-USED   PIC X.
  1023           88  CP-R-AS-R78                         VALUE '1'.
  1024           88  CP-R-AS-PRORATA                     VALUE '2'.
  1025           88  CP-R-AS-CALIF                       VALUE '3'.
  1026           88  CP-R-AS-TEXAS                       VALUE '4'.
  1027           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1028           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1029           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1030           88  CP-R-AS-MEAN                        VALUE '8'.
  1031           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1032           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1033           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1034           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1035           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1036           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1037         16  FILLER                PIC X(12).
  1038
  1039***************    OUTPUT FROM ELEARN   *************************
  1040
  1041         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1042                                     COMP-3.
  1043         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1044                                     COMP-3.
  1045         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1046                                     COMP-3.
  1047         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1048                                     COMP-3.
  1049         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1050                                     COMP-3.
  1051         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1052                                     COMP-3.
  1053         16  CP-EARNING-TYPE-USED  PIC X.
  1054           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1055           88  CP-E-AS-R78                         VALUE '1'.
  1056           88  CP-E-AS-PRORATA                     VALUE '2'.
  1057           88  CP-E-AS-TEXAS                       VALUE '4'.
  1058           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1059           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1060           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1061           88  CP-E-AS-MEAN                        VALUE '8'.
  1062           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1063         16  FILLER                PIC X(12).
  1064
  1065***************    OUTPUT FROM ELPMNT   *************************
  1066
  1067         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1068                                     COMP-3.
  1069         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1070                                     COMP-3.
  1071         16  FILLER                PIC X(12).
  1072
  1073***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  22
* ELRATE.cbl
  1074         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1075                                     COMP-3.
  1076         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1077                                     COMP-3.
  1078         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1081                                     COMP-3.
  1082         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1083                                     COMP-3.
  1084         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1085                                     COMP-3.
  1086         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1087             88  OPEN-RATE-FILE                   VALUE 'O'.
  1088             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1089             88  IO-ERROR                         VALUE 'E'.
  1090
  1091         16  CP-FIRST-PAY-DATE     PIC XX.
  1092
  1093         16  CP-JOINT-INDICATOR    PIC X.
  1094
  1095         16  CP-RESERVE-REMAINING-TERM
  1096                                   PIC S9(4)V9    VALUE ZERO
  1097                                     COMP-3.
  1098
  1099         16  CP-INSURED-BIRTH-DT   PIC XX.
  1100
  1101         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1102                                     COMP-3.
  1103
  1104         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1105                                     COMP-3.
  1106
  1107         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1108                                     COMP-3.
  1109
  1110         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1111                                     COMP-3.
  1112
  1113         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1114                                     COMP-3.
  1115
  1116         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1117                                     COMP-3.
  1118
  1119         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1120                                     COMP-3.
  1121
  1122         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1123             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1124
  1125         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1126                                     COMP-3.
  1127         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1128                                     COMP-3.
  1129         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1130         16  FILLER                PIC X(15).
  1131******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  23
* ELRATE.cbl
  1132
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  24
* ELRATE.cbl
  1134****************************************************************
  1135*
  1136* Copyright (c) 2007 by Clerity Solutions, Inc.
  1137* All rights reserved.
  1138*
  1139****************************************************************
  1140 01  DFHEIV.
  1141   02  DFHEIV0               PIC X(35).
  1142   02  DFHEIV1               PIC X(08).
  1143   02  DFHEIV2               PIC X(08).
  1144   02  DFHEIV3               PIC X(08).
  1145   02  DFHEIV4               PIC X(06).
  1146   02  DFHEIV5               PIC X(04).
  1147   02  DFHEIV6               PIC X(04).
  1148   02  DFHEIV7               PIC X(02).
  1149   02  DFHEIV8               PIC X(02).
  1150   02  DFHEIV9               PIC X(01).
  1151   02  DFHEIV10              PIC S9(7) COMP-3.
  1152   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1153   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1154   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1155   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1156   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1157   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1158   02  DFHEIV17              PIC X(04).
  1159   02  DFHEIV18              PIC X(04).
  1160   02  DFHEIV19              PIC X(04).
  1161   02  DFHEIV20              USAGE IS POINTER.
  1162   02  DFHEIV21              USAGE IS POINTER.
  1163   02  DFHEIV22              USAGE IS POINTER.
  1164   02  DFHEIV23              USAGE IS POINTER.
  1165   02  DFHEIV24              USAGE IS POINTER.
  1166   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1167   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1168   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1169   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1170   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1171   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1172   02  FILLER                PIC X(02).
  1173   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1174   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1175   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1176   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1177   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1178 LINKAGE  SECTION.
  1179*****************************************************************
  1180*                                                               *
  1181* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1182* All rights reserved.                                          *
  1183*                                                               *
  1184*****************************************************************
  1185 01  dfheiblk.
  1186     02  eibtime          pic s9(7) comp-3.
  1187     02  eibdate          pic s9(7) comp-3.
  1188     02  eibtrnid         pic x(4).
  1189     02  eibtaskn         pic s9(7) comp-3.
  1190     02  eibtrmid         pic x(4).
  1191     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  25
* ELRATE.cbl
  1192     02  eibcposn         pic s9(4) comp.
  1193     02  eibcalen         pic s9(4) comp.
  1194     02  eibaid           pic x(1).
  1195     02  eibfiller1       pic x(1).
  1196     02  eibfn            pic x(2).
  1197     02  eibfiller2       pic x(2).
  1198     02  eibrcode         pic x(6).
  1199     02  eibfiller3       pic x(2).
  1200     02  eibds            pic x(8).
  1201     02  eibreqid         pic x(8).
  1202     02  eibrsrce         pic x(8).
  1203     02  eibsync          pic x(1).
  1204     02  eibfree          pic x(1).
  1205     02  eibrecv          pic x(1).
  1206     02  eibsend          pic x(1).
  1207     02  eibatt           pic x(1).
  1208     02  eibeoc           pic x(1).
  1209     02  eibfmh           pic x(1).
  1210     02  eibcompl         pic x(1).
  1211     02  eibsig           pic x(1).
  1212     02  eibconf          pic x(1).
  1213     02  eiberr           pic x(1).
  1214     02  eibrldbk         pic x(1).
  1215     02  eiberrcd         pic x(4).
  1216     02  eibsynrb         pic x(1).
  1217     02  eibnodat         pic x(1).
  1218     02  eibfiller5       pic x(2).
  1219     02  eibresp          pic 9(09) comp.
  1220     02  eibresp2         pic 9(09) comp.
  1221     02  dfheigdj         pic s9(4) comp.
  1222     02  dfheigdk         pic s9(4) comp.
  1223 01  DFHCOMMAREA             PIC X(450).
  1224
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  26
* ELRATE.cbl
  1226*01 PARMLIST              COMP.
  1227*    02  FILLER              PIC S9(8).
  1228*    02  ERRATE-POINTER      PIC S9(8).
  1229
  1230*                                COPY ERCRATE.
  1231******************************************************************
  1232*                                                                *
  1233*                                                                *
  1234*                            ERCRATE                             *
  1235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1236*                            VMOD=2.008                          *
  1237*                                                                *
  1238*   ONLINE CREDIT SYSTEM                                         *
  1239*                                                                *
  1240*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1241*                                                                *
  1242*   FILE TYPE = VSAM,KSDS                                        *
  1243*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1244*                                                                *
  1245*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1246*       ALTERNATE PATH = NONE                                    *
  1247*                                                                *
  1248*   LOG = NO                                                     *
  1249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1250*                                                                *
  1251******************************************************************
  1252
  1253 01  RATE-RECORD.
  1254     12  RT-RECORD-ID                      PIC XX.
  1255         88  VALID-RT-ID                      VALUE 'RT'.
  1256
  1257     12  RT-CONTROL-PRIMARY.
  1258         16  RT-COMPANY-CD                 PIC X.
  1259         16  RT-STATE-CODE.
  1260             20  RT-ST-CODE                PIC XX.
  1261             20  RT-ST-CLASS               PIC XX.
  1262             20  RT-ST-DEV                 PIC XXX.
  1263         16  RT-L-AH-CODE.
  1264             20  RT-L-AH                   PIC X.
  1265             20  RT-LAH-NUM                PIC XX.
  1266         16  RT-LIMITS.
  1267             20  RT-HIGH-AGE               PIC 99.
  1268             20  RT-HIGH-AMT               PIC 9(6).
  1269             20  RT-FUTURE                 PIC XX.
  1270             20  RT-SEX                    PIC X.
  1271         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1272
  1273     12  RT-MAINT-INFORMATION.
  1274         16  RT-LAST-MAINT-DT              PIC XX.
  1275         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1276         16  RT-LAST-MAINT-USER            PIC X(4).
  1277         16  FILLER                        PIC X(10).
  1278
  1279     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1280     12  RT-RATE-COMMENT                   PIC X(50).
  1281
  1282     12  CSL-RESERVED                      PIC X(10).
  1283     12  FILLER                            PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  27
* ELRATE.cbl
  1284
  1285     12  RT-MAX-AGE                        PIC 99.
  1286
  1287     12  RT-LIFE-LIMS-FLDS.
  1288         16  RT-LIFE-MORT-CODE             PIC X(4).
  1289         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1290             20  RT-L-EX-AGE               PIC 99.
  1291             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1292             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1293         16  FILLER                        PIC X(20).
  1294
  1295     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1296         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1297             20  RT-AH-AGE                 PIC 99.
  1298             20  RT-AH-TERM                PIC S999       COMP-3.
  1299             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1300             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1301
  1302     12  RT-LIFE-RATES.
  1303         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1304
  1305     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1306         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1307
  1308     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1309
  1310     12  RT-DISCOUNT-OPTION                PIC X.
  1311         88  RT-DO-NOT-USE                     VALUE ' '.
  1312         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1313         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1314
  1315     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1316     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1317
  1318     12  RT-COMPOSITE-OPTION               PIC X.
  1319         88  RT-NO-COMPOSITE                   VALUE ' '.
  1320         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1321
  1322     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1323
  1324     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.
  1325     12  FILLER                            PIC X(13).
  1326
  1327     12  RT-TYPE-RATE                      PIC X.
  1328         88  RT-IS-STND                        VALUE ' ' 'S'.
  1329         88  RT-IS-OB                          VALUE 'O'.
  1330
  1331     12  RT-SRT-ALPHA                      PIC X.
  1332
  1333     12  RT-CONTROL-2.
  1334         16  RTC-1                         PIC X(7).
  1335         16  RTC-3                         PIC X(11).
  1336         16  RTC-4                         PIC 9(11) COMP-3.
  1337         16  RTC-2                         PIC X(3).
  1338******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  28
* ELRATE.cbl
  1340 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1341 0000-DFHEXIT SECTION.
  1342     MOVE '9#                    $   ' TO DFHEIV0.
  1343     MOVE 'ELRATE' TO DFHEIV1.
  1344     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1345
  1346     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1347
  1348 000-START-PREMIUM-CALC.
  1349     MOVE ZERO                   TO CP-RETURN-CODE
  1350                                    CP-CALC-PREMIUM
  1351                                    CP-PREMIUM-RATE
  1352                                    CP-POLICY-FEE.
  1353
  1354     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1355     MOVE ALL '9'                TO ERRATE-KEY.
  1356
  1357*    IF CP-RATE-FILE = 'O'
  1358*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1359
  1360     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1361     MOVE CP-STATE               TO RATE-ST-CODE.
  1362     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1363     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1364     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1365
  1366     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1367        CP-RATING-BENEFIT-AMT = ZEROS
  1368         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1369     ELSE
  1370         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1371
  1372     IF CP-AH
  1373         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1374     ELSE
  1375         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1376
  1377     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1378     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1379     MOVE SPACE                  TO DC-OPTION-CODE.
  1380
  1381     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1382
  1383*** Y2K, PROJ 7744
  1384     IF NO-CONVERSION-ERROR
  1385         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1386                                       WS-HOLD-RATE-EXP-DT
  1387         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1388         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1389         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1390     ELSE
  1391         MOVE '2'                   TO CP-RETURN-CODE
  1392         GO TO 9999-CALC-RATE-PREM-X
  1393     END-IF.
  1394*** Y2K, PROJ 7744
  1395
  1396
  1397* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  29
* ELRATE.cbl
  1398*        NOTFND   (9999-RATE-NOTFND)
  1399*        NOTOPEN  (9999-RATE-NOTOPEN)
  1400*        ENDFILE  (9999-RATE-NOTFND)
  1401*    END-EXEC.
  1402*    MOVE '"$IJ''                 ! " #00001392' TO DFHEIV0
  1403     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1405     MOVE X'2220233030303031333932' TO DFHEIV0(25:11)
  1406     CALL 'kxdfhei1' USING DFHEIV0
  1407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1408
  1409
  1410 0050-RATE-START-BROWSE.
  1411
  1412* EXEC CICS STARTBR
  1413*        DATASET  (ERRATE-FILE-ID)
  1414*        RIDFLD   (ERRATE-KEY)
  1415*        GTEQ
  1416*    END-EXEC.
  1417     MOVE 0
  1418       TO DFHEIV11
  1419*    MOVE '&,         G          &   #00001399' TO DFHEIV0
  1420     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1422     MOVE X'2020233030303031333939' TO DFHEIV0(25:11)
  1423     CALL 'kxdfhei1' USING DFHEIV0,
  1424           ERRATE-FILE-ID,
  1425           ERRATE-KEY,
  1426           DFHEIV99,
  1427           DFHEIV11,
  1428           DFHEIV99
  1429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1430
  1431
  1432     MOVE 'Y'                  TO WS-BROWSE-SW.
  1433
  1434 0100-READ-RATE-LOOP.
  1435
  1436* EXEC CICS READNEXT
  1437*        DATASET  (ERRATE-FILE-ID)
  1438*        SET      (ADDRESS OF RATE-RECORD)
  1439*        RIDFLD   (ERRATE-KEY)
  1440*    END-EXEC.
  1441     MOVE 0
  1442       TO DFHEIV11
  1443*    MOVE '&.S                   )   #00001408' TO DFHEIV0
  1444     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1445     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1446     MOVE X'2020233030303031343038' TO DFHEIV0(25:11)
  1447     CALL 'kxdfhei1' USING DFHEIV0,
  1448           ERRATE-FILE-ID,
  1449           DFHEIV20,
  1450           DFHEIV99,
  1451           ERRATE-KEY,
  1452           DFHEIV99,
  1453           DFHEIV11,
  1454           DFHEIV99,
  1455           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  30
* ELRATE.cbl
  1456     SET ADDRESS OF RATE-RECORD TO
  1457         DFHEIV20
  1458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1459
  1460
  1461 0110-CHECK-KEYS.
  1462*                            COPY ELCRATPD.
  1463******************************************************************
  1464*                                                                *
  1465*                                                                *
  1466*                            ELCRATPD                            *
  1467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1468*                            VMOD=2.061                          *
  1469*                                                                *
  1470******************************************************************
  1471******************************************************************
  1472*                   C H A N G E   L O G
  1473*
  1474* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1475*-----------------------------------------------------------------
  1476*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1477* EFFECTIVE    NUMBER
  1478*-----------------------------------------------------------------
  1479* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1480* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1481* 032603                   PEMA  ADD SPECIAL AZ CALC
  1482* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1483* 120403                   PEMA  ADD SPECIAL TX CALC
  1484* 092205                   PEMA  FIX CRIT PER FOR DCC
  1485* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1486* 021207                   PEMA  ADD PA NP
  1487* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1488* 032807                   PEMA  ADD VT NP PLUS 2
  1489* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1490* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1491* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1492* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1493* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1494* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1495* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1496* 071211    2010012700001  PEMA  ADD SPPDD
  1497* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1498* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1499******************************************************************
  1500
  1501 0110-CHECK-KEY.
  1502     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1503        SVRT-ST-CODE    = RT-ST-CODE     AND
  1504        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1505        SVRT-ST-DEV     = RT-ST-DEV      AND
  1506        SVRT-L-AH       = RT-L-AH        AND
  1507        SVRT-LAH-NUM    = RT-LAH-NUM
  1508         NEXT SENTENCE
  1509     ELSE
  1510         GO TO 9999-RATE-NOTFND.
  1511
  1512     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1513         GO TO 9999-RATE-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  31
* ELRATE.cbl
  1514
  1515     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1516        GO TO 0100-READ-RATE-LOOP.
  1517
  1518     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1519         GO TO 0100-READ-RATE-LOOP.
  1520
  1521     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1522         GO TO 0100-READ-RATE-LOOP.
  1523
  1524     IF RT-MAX-AGE = ZEROS
  1525         NEXT SENTENCE
  1526     ELSE
  1527         COMPUTE WS-AGE =
  1528             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1529         IF WS-AGE >= RT-MAX-AGE
  1530             MOVE 'B'               TO CP-RETURN-CODE.
  1531
  1532     IF CP-LOAN-TERM NOT NUMERIC
  1533         MOVE +0                    TO CP-LOAN-TERM.
  1534
  1535     IF CP-LOAN-TERM = ZERO
  1536         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1537
  1538     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1539         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1540
  1541     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1542     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1543
  1544     IF CP-AH
  1545         GO TO 2000-TYPE-IS-AH.
  1546
  1547     IF ((RT-IS-OB)
  1548        AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1549                      OR
  1550        ((CP-COMPANY-ID = 'DCC')
  1551        AND (CP-BENEFIT-CD (1:1) = 'P'))
  1552        MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1553     ELSE
  1554        MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1555     END-IF
  1556
  1557     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1558     MOVE SPACE                     TO DC-OPTION-CODE.
  1559
  1560     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1561
  1562 1000-TYPE-IS-LIFE.
  1563     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1564
  1565     MOVE ZERO                      TO CP-R-MAX-AGE
  1566                                       CP-R-MAX-TERM
  1567                                       CP-R-MAX-MON-BEN
  1568                                       CP-R-MAX-TOT-BEN.
  1569
  1570     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1571
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  32
* ELRATE.cbl
  1572     IF RT-POLICY-FEE NUMERIC
  1573        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1574
  1575     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1576
  1577     IF (RT-DISCOUNT-OPTION EQUAL
  1578                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1579        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1580        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1581         NEXT SENTENCE
  1582     ELSE
  1583         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1584            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1585             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1586                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1587                 GO TO 1050-REGULAR-RATES
  1588             ELSE
  1589                 GO TO 1050-REGULAR-RATES
  1590         ELSE
  1591             GO TO 1050-REGULAR-RATES.
  1592
  1593*    display ' discount option ' rt-discount-option
  1594     IF RT-DISCOUNT-RATE NOT NUMERIC
  1595        MOVE +0                  TO RT-DISCOUNT-RATE.
  1596
  1597     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1598        NEXT SENTENCE
  1599     ELSE
  1600        MOVE +0                  TO CP-PREMIUM-RATE
  1601                                    CP-COMPOSITE-RATE
  1602                                    CP-CALC-PREMIUM
  1603         MOVE '4'                TO CP-RETURN-CODE
  1604         GO TO 9999-CALC-RATE-PREM-X.
  1605
  1606     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1607        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1608     ELSE
  1609        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1610
  1611*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1612*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1613*       GO TO 1075-BYPASS-REGULAR-RATE.
  1614
  1615     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1616        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1617        COMPUTE WS-WORK-DIS-RATE EQUAL
  1618                WS-WORK-DIS-RATE / +100
  1619        GO TO 1075-BYPASS-REGULAR-RATE.
  1620
  1621     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1622        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1623        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1624        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1625        GO TO 1075-BYPASS-REGULAR-RATE.
  1626
  1627     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1628        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1629        (CP-TRUNCATED-LIFE)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  33
* ELRATE.cbl
  1630        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1631        GO TO 1075-BYPASS-REGULAR-RATE.
  1632
  1633     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1634        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1635        (CP-EARN-AS-NET-PAY)
  1636*       (CP-TRUNCATED-LIFE)
  1637        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1638        GO TO 1075-BYPASS-REGULAR-RATE.
  1639
  1640     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1641        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1642                   AND
  1643        ((CP-EARN-AS-NET-PAY)
  1644               OR
  1645        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1646        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1647        GO TO 1075-BYPASS-REGULAR-RATE.
  1648
  1649     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1650        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1651        (CP-EARN-AS-NET-PAY) AND
  1652        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1653        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1654        GO TO 1075-BYPASS-REGULAR-RATE.
  1655
  1656     IF (CP-COMPANY-ID = 'CID')
  1657        AND (CP-STATE-STD-ABBRV = 'MN')
  1658        AND (RT-DISCOUNT-OPTION = '1')
  1659        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1660                     OR
  1661            (CP-LEVEL-LIFE)
  1662            AND (CP-CERT-EFF-DT > X'A4FF'))
  1663        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1664        GO TO 1075-BYPASS-REGULAR-RATE
  1665     END-IF
  1666     IF (CP-COMPANY-ID EQUAL 'CID')
  1667        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1668                      OR
  1669            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1670        AND (CP-EARN-AS-NET-PAY)
  1671        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1672        GO TO 1075-BYPASS-REGULAR-RATE
  1673     END-IF
  1674     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1675        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1676        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1677         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1678         GO TO 1075-BYPASS-REGULAR-RATE.
  1679
  1680     IF CP-COMPANY-ID = 'CID'
  1681        CONTINUE
  1682     ELSE
  1683        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1684           (CP-EARN-AS-NET-PAY ) AND
  1685           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1686            GO TO 1075-BYPASS-REGULAR-RATE
  1687        END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  34
* ELRATE.cbl
  1688     END-IF
  1689     IF (CP-COMPANY-ID = 'CID') AND
  1690        (CP-EARN-AS-NET-PAY) AND
  1691        (CP-LEVEL-LIFE) AND
  1692        (CP-STATE-STD-ABBRV = 'CA') AND
  1693        (CP-STATE-STD-ABBRV = CP-STATE)
  1694        COMPUTE WS-WORK-DIS-RATE =
  1695             RT-DISCOUNT-RATE / +100
  1696        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1697        GO TO 1075-BYPASS-REGULAR-RATE
  1698     END-IF
  1699
  1700     IF (CP-COMPANY-ID = 'CID')
  1701        AND (CP-EARN-AS-NET-PAY)
  1702        AND (CP-STATE-STD-ABBRV = 'ME')
  1703        COMPUTE WS-WORK-DIS-RATE =
  1704             RT-DISCOUNT-RATE / +100
  1705        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1706        GO TO 1075-BYPASS-REGULAR-RATE
  1707     END-IF
  1708     IF (CP-COMPANY-ID = 'CID')
  1709        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1710           OR 'IN' OR 'AZ')
  1711        AND (CP-FARM-PLAN)
  1712        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1713        GO TO 1075-BYPASS-REGULAR-RATE
  1714     END-IF
  1715     IF (CP-COMPANY-ID = 'DCC')
  1716        AND (CP-BEN-CATEGORY = 'D')
  1717        AND (CP-EARN-AS-NET-PAY)
  1718        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1719        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1720           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1721*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1722*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1723*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1724*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1725        GO TO 1075-BYPASS-REGULAR-RATE
  1726     END-IF
  1727     IF (CP-COMPANY-ID = 'CID') AND
  1728        (CP-EARN-AS-NET-PAY) AND
  1729        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1730                            OR 'VT')
  1731                   OR
  1732        ((CP-STATE-STD-ABBRV = 'IN') AND
  1733        (CP-CERT-EFF-DT > X'9A7F'))
  1734                   OR
  1735        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1736        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1737        (CP-STATE-STD-ABBRV = CP-STATE)
  1738        COMPUTE WS-WORK-DIS-RATE =
  1739             RT-DISCOUNT-RATE / +100
  1740        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1741        GO TO 1075-BYPASS-REGULAR-RATE
  1742     END-IF
  1743
  1744     IF (CP-COMPANY-ID = 'CID') AND
  1745        (CP-EARN-AS-NET-PAY) AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  35
* ELRATE.cbl
  1746        (CP-STATE-STD-ABBRV = 'TX') AND
  1747        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1748        (WS-DISCOUNT-OPTION NOT = ' ')
  1749        COMPUTE WS-WORK-DIS-RATE =
  1750             RT-DISCOUNT-RATE / +100
  1751        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1752        GO TO 1075-BYPASS-REGULAR-RATE
  1753     END-IF
  1754
  1755     IF (CP-COMPANY-ID = 'CID') AND
  1756        (CP-EARN-AS-NET-PAY) AND
  1757        (CP-TRUNCATED-LIFE) AND
  1758        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1759        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1760        (WS-DISCOUNT-OPTION NOT = ' ')
  1761        COMPUTE WS-WORK-DIS-RATE =
  1762             RT-DISCOUNT-RATE / +100
  1763        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1764        GO TO 1075-BYPASS-REGULAR-RATE
  1765     END-IF
  1766
  1767     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1768        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1769           COMPUTE WS-WORK-DIS-RATE EQUAL
  1770                   WS-WORK-DIS-RATE / +100.
  1771
  1772     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1773        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1774           IF CP-MONTHLY-PAYMENT EQUAL +0
  1775            IF CP-LOAN-APR GREATER THAN +2
  1776              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1777              CP-ORIGINAL-BENEFIT /
  1778               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1779               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1780            ELSE
  1781             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1782               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1783
  1784     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1785        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1786          IF WS-WORK-DIS-RATE GREATER THAN +0
  1787           COMPUTE WK1 ROUNDED EQUAL
  1788           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1789                              (WS-RATE-TERM - +1)) /
  1790                        (WS-WORK-DIS-RATE / +12)
  1791           COMPUTE WK2 ROUNDED EQUAL
  1792           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1793                              (WS-RATE-TERM)) /
  1794                        (WS-WORK-DIS-RATE / +12)
  1795           COMPUTE WK3 EQUAL
  1796                RT-DISCOUNT-OB-RATE *
  1797                (1 + WS-WORK-DIS-RATE / +12)
  1798                MOVE WK3 TO CP-PREMIUM-RATE
  1799                COMPUTE WK5 EQUAL WK3 / +1000
  1800           GO TO 1075-BYPASS-REGULAR-RATE.
  1801*               (RT-DISCOUNT-OB-RATE / +1000) *
  1802*               (1 + WS-WORK-DIS-RATE / +12)
  1803*          GO TO 1075-BYPASS-REGULAR-RATE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  36
* ELRATE.cbl
  1804
  1805     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1806        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1807           COMPUTE WK3 EQUAL
  1808           RT-DISCOUNT-OB-RATE *
  1809           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1810           MOVE WK3 TO CP-PREMIUM-RATE
  1811           COMPUTE WK5 EQUAL WK3 / +1000
  1812           GO TO 1075-BYPASS-REGULAR-RATE.
  1813
  1814     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1815        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1816        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1817        GO TO 1075-BYPASS-REGULAR-RATE.
  1818
  1819     COMPUTE WS-SIN-PREM-RATE =
  1820             (RT-DISCOUNT-OB-RATE / +1000) *
  1821             ((WS-RATE-TERM + +1) / +2).
  1822
  1823     COMPUTE CP-PREMIUM-RATE =
  1824             WS-SIN-PREM-RATE /
  1825             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1826             WS-RATE-TERM) / +24)).
  1827
  1828     IF CP-PREMIUM-RATE NOT = +0
  1829        MULTIPLY +100 BY CP-PREMIUM-RATE
  1830        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1831        GO TO 1075-BYPASS-REGULAR-RATE.
  1832
  1833 1050-REGULAR-RATES.
  1834
  1835     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1836        COMPUTE WK5 EQUAL
  1837        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1838        (6 * (WS-RATE-TERM + 1))
  1839        MOVE WK5 TO CP-PREMIUM-RATE
  1840        GO TO 1075-BYPASS-REGULAR-RATE.
  1841
  1842     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1843        (CP-CSL-VALID-NP-BENEFIT-CD)
  1844        IF CP-JOINT-INDICATOR EQUAL 'J'
  1845           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1846           GO TO 1075-BYPASS-REGULAR-RATE
  1847        ELSE
  1848           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1849           GO TO 1075-BYPASS-REGULAR-RATE.
  1850
  1851     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1852        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1853        (CP-EARN-AS-NET-PAY )
  1854        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1855        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1856        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1857        MOVE '1'                 TO DC-OPTION-CODE
  1858        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1859        IF DATE-CONVERSION-ERROR
  1860            MOVE '2'                TO CP-RETURN-CODE
  1861            GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  37
* ELRATE.cbl
  1862        ELSE
  1863            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1864                                         DC-ODD-DAYS-OVER
  1865            GO TO 1075-BYPASS-REGULAR-RATE.
  1866
  1867     IF RT-COMPOSITE-RATE NOT NUMERIC
  1868         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1869
  1870*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1871     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1872         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1873                                              WS-PREMIUM-RATE
  1874         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1875     ELSE
  1876         MOVE +0                           TO CP-PREMIUM-RATE
  1877                                              CP-COMPOSITE-RATE
  1878                                              CP-CALC-PREMIUM
  1879         GO TO 9999-CALC-RATE-PREM-X.
  1880
  1881     IF (CP-COMPANY-ID EQUAL 'CID')
  1882        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1883        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1884        AND (CP-EARN-AS-NET-PAY)
  1885        GO TO 1075-BYPASS-REGULAR-RATE
  1886     END-IF
  1887******************************************************
  1888*    IF CP-COMPANY-ID NOT = 'LBL'
  1889     IF CP-COMPANY-ID NOT = 'LBL' AND 'CID'
  1890         GO TO 1075-BYPASS-REGULAR-RATE.
  1891
  1892     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1893     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1894     MOVE '1'                    TO DC-OPTION-CODE.
  1895     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1896     IF DATE-CONVERSION-ERROR
  1897         MOVE '2'                TO CP-RETURN-CODE
  1898         GO TO 9999-CALC-RATE-PREM-X
  1899       ELSE
  1900         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1901         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1902
  1903     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1904        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1905        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1906
  1907     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1908        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1909           NEXT SENTENCE
  1910         ELSE
  1911           GO TO 1075-BYPASS-REGULAR-RATE
  1912       ELSE
  1913        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1914           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1915           NEXT SENTENCE
  1916         ELSE
  1917           GO TO 1075-BYPASS-REGULAR-RATE.
  1918
  1919     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  38
* ELRATE.cbl
  1920        COMPUTE CP-PREMIUM-RATE =
  1921        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1922         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1923         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1924
  1925     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1926        COMPUTE CP-PREMIUM-RATE =
  1927        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1928        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1929        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1930        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1931         * (CP-ORIGINAL-TERM - 1)).
  1932******************************************************
  1933
  1934 1075-BYPASS-REGULAR-RATE.
  1935
  1936     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1937
  1938     MOVE +1 TO LINDX.
  1939
  1940     IF CP-COMPANY-ID EQUAL 'CRI'
  1941        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1942           MOVE +5               TO LINDX
  1943           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1944              MOVE 'F'           TO CP-RETURN-CODE
  1945              GO TO 1200-CALCULATE-PREMIUMS.
  1946
  1947     IF RT-L-EX-AGE (LINDX) = ZERO
  1948          GO TO 1200-CALCULATE-PREMIUMS.
  1949
  1950 1100-SEARCH-LIFE-LIMITS.
  1951
  1952     IF CP-COMPANY-ID EQUAL 'CRI'
  1953        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1954           IF LINDX GREATER THAN +4
  1955              MOVE 'A'           TO CP-RETURN-CODE
  1956              GO TO 1200-CALCULATE-PREMIUMS.
  1957
  1958     IF LINDX GREATER +8
  1959         MOVE 'A'                TO CP-RETURN-CODE
  1960         GO TO 1200-CALCULATE-PREMIUMS.
  1961
  1962     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  1963         IF RT-L-EX-AGE (LINDX) = ZEROS
  1964             ADD +1              TO LINDX
  1965             GO TO 1100-SEARCH-LIFE-LIMITS
  1966         ELSE
  1967             MOVE RT-L-EX-AGE (LINDX)
  1968                                 TO CP-R-MAX-AGE
  1969             MOVE RT-L-EX-TERM (LINDX)
  1970                                 TO CP-R-MAX-TERM
  1971             MOVE RT-L-EX-FACE (LINDX)
  1972                                 TO CP-R-MAX-TOT-BEN
  1973             ADD +1              TO LINDX
  1974             GO TO 1100-SEARCH-LIFE-LIMITS
  1975     ELSE
  1976         MOVE RT-L-EX-AGE (LINDX)
  1977                                 TO CP-R-MAX-AGE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  39
* ELRATE.cbl
  1978         MOVE RT-L-EX-TERM (LINDX)
  1979                                 TO CP-R-MAX-TERM
  1980         MOVE RT-L-EX-FACE (LINDX)
  1981                                 TO CP-R-MAX-TOT-BEN.
  1982
  1983     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  1984         MOVE '9'                TO CP-RETURN-CODE.
  1985
  1986     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  1987         MOVE '8'                TO CP-RETURN-CODE.
  1988
  1989 1200-CALCULATE-PREMIUMS.
  1990
  1991     IF CP-COMPANY-ID = 'CSL'
  1992        IF CP-CSL-VALID-NP-BENEFIT-CD
  1993           GO TO 1240-NET-PAY-CONT
  1994        ELSE
  1995           GO TO 1250-CSL-CALC.
  1996
  1997     IF CP-COMPANY-ID = 'WDS'
  1998        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  1999           IF CP-EARN-AS-REG-BALLOON
  2000              GO TO 1240-NET-PAY-CONT.
  2001
  2002     IF (CP-COMPANY-ID = 'CID')
  2003        AND (CP-STATE-STD-ABBRV = 'MN')
  2004        AND (CP-EARN-AS-REG-BALLOON)
  2005        AND (CP-CERT-EFF-DT > X'A4FF')
  2006        GO TO 1240-NET-PAY-CONT
  2007     END-IF
  2008     IF (CP-COMPANY-ID = 'CID')
  2009        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2010           OR 'IN' OR 'AZ')
  2011        AND (CP-FARM-PLAN)
  2012***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2013***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2014        MOVE +1.0                TO CP-LOAN-APR
  2015        GO TO 1240-NET-PAY-CONT
  2016     END-IF
  2017     IF CP-RATE-AS-STANDARD
  2018         GO TO 1210-REGULAR-RATE.
  2019
  2020     IF CP-CRITICAL-PERIOD
  2021         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2022
  2023     IF CP-EARN-AS-TEXAS
  2024         GO TO 1230-TEXAS-CONT.
  2025
  2026     IF CP-EARN-AS-NET-PAY
  2027        IF CP-STATE-STD-ABBRV = 'MD'
  2028          IF CP-COMPANY-ID = 'MON'
  2029            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2030                               '14' OR '26' OR '47'
  2031              GO TO 1210-REGULAR-RATE.
  2032
  2033     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2034        IF CP-MONTHLY-PAYMENT EQUAL +0
  2035           COMPUTE CP-MONTHLY-PAYMENT EQUAL
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  40
* ELRATE.cbl
  2036                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2037
  2038     IF CP-COMPANY-ID EQUAL 'GTL'
  2039        NEXT SENTENCE
  2040     ELSE
  2041     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2042        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2043           COMPUTE WK3 ROUNDED EQUAL
  2044           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2045           CP-MONTHLY-PAYMENT
  2046           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2047           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2048           CP-ALTERNATE-BENEFIT)
  2049           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2050           WK3 * WK5
  2051           GO TO 9999-CALC-RATE-PREM-X
  2052        ELSE
  2053           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2054           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2055           (WS-WORK-DIS-RATE / +12)
  2056           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2057           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2058                               WK5
  2059           GO TO 9999-CALC-RATE-PREM-X.
  2060
  2061     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2062        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2063        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2064        CP-ORIGINAL-TERM LESS THAN +61
  2065        COMPUTE CP-CALC-PREMIUM EQUAL
  2066                        (CP-ORIGINAL-BENEFIT *
  2067           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2068           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2069        COMPUTE CP-CALC-PREMIUM EQUAL
  2070                CP-CALC-PREMIUM +
  2071              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2072        (CP-ORIGINAL-TERM + 1)) /
  2073        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2074        GO TO 9999-CALC-RATE-PREM-X.
  2075
  2076     IF CP-COMPANY-ID = 'GTL'     AND
  2077        CP-STATE-STD-ABBRV = 'PA' AND
  2078        CP-SPECIAL-CALC-CD = 'H'
  2079         GO TO 1260-GTL-PA-LEASE.
  2080
  2081     IF (CP-EARN-AS-NET-PAY)
  2082        AND (CP-LOAN-APR > ZEROS)
  2083        GO TO 1240-NET-PAY-CONT
  2084     END-IF
  2085
  2086     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2087         GO TO 1210-REGULAR-RATE.
  2088
  2089**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2090**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2091****
  2092     IF CP-DEVIATION-CODE = 'LEV' AND
  2093        CP-LOAN-APR = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  41
* ELRATE.cbl
  2094         GO TO 1210-REGULAR-RATE.
  2095
  2096     IF (CP-STATE-STD-ABBRV = 'OH')
  2097        AND (CP-CLASS-CODE NOT = 'L ')
  2098        AND (CP-ORIGINAL-TERM > 60)
  2099        AND (DC-GREG-DATE-CYMD > 19831031)
  2100        AND (CP-LOAN-APR > ZEROS)
  2101        GO TO 1240-NET-PAY-CONT
  2102     END-IF
  2103
  2104     IF (CP-STATE-STD-ABBRV = 'UT')
  2105        AND (CP-ORIGINAL-TERM > 62)
  2106        AND (DC-GREG-DATE-CYMD > 19810831)
  2107        AND (DC-GREG-DATE-CYMD < 19830901)
  2108        AND (CP-LOAN-APR > ZEROS)
  2109        GO TO 1240-NET-PAY-CONT
  2110     END-IF
  2111
  2112     IF (CP-STATE-STD-ABBRV = 'RI')
  2113        AND (CP-ORIGINAL-TERM > 60)
  2114        AND (DC-GREG-DATE-CYMD > 19831231)
  2115        AND (CP-LOAN-APR > ZEROS)
  2116        GO TO 1240-NET-PAY-CONT
  2117     END-IF
  2118     .
  2119 1210-REGULAR-RATE.
  2120
  2121     IF (CP-COMPANY-ID = 'CID')
  2122        AND (CP-EARN-AS-NET-PAY)
  2123        AND (CP-LOAN-APR = 0)
  2124        IF RT-L-RATE (WS-RATE-TERM) = 0
  2125           COMPUTE WS-SIN-PREM-RATE =
  2126              (RT-DISCOUNT-OB-RATE / +1000) *
  2127              ((WS-RATE-TERM + +1) / +2)
  2128           COMPUTE CP-PREMIUM-RATE =
  2129              WS-SIN-PREM-RATE /
  2130              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2131              WS-RATE-TERM) / +24))
  2132        ELSE
  2133           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2134        END-IF
  2135     END-IF
  2136*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2137*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2138*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2139*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2140*
  2141*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2142*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2143*          COMPUTE WK3 ROUNDED EQUAL
  2144*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2145*          CP-MONTHLY-PAYMENT
  2146*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2147*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2148*          CP-ALTERNATE-BENEFIT)
  2149*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2150*          WK3 * WK5
  2151*          GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  42
* ELRATE.cbl
  2152*       ELSE
  2153*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2154*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2155*          (WS-WORK-DIS-RATE / +12)
  2156*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2157*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2158*                              WK5
  2159*          GO TO 9999-CALC-RATE-PREM-X.
  2160
  2161     IF CP-TERM-IS-DAYS
  2162         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2163             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2164         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2165             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2166                          * CP-TERM-OR-EXT-DAYS
  2167           GO TO 9999-CALC-RATE-PREM-X.
  2168
  2169     IF NOT CP-TRUNCATED-LIFE
  2170         GO TO 1212-GROSS-NOT-TRUNCATED.
  2171
  2172****  GROSS TRUNCATED CALCULATION
  2173
  2174     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2175         MOVE 'H'                TO  CP-RETURN-CODE
  2176         GO TO 9999-CALC-RATE-PREM-X.
  2177
  2178     IF CP-COMPANY-ID = 'NCL'
  2179         COMPUTE WK-MONTHLY-RATE =
  2180               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2181                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2182                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2183                                 /
  2184                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2185                                 *
  2186                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2187         COMPUTE CP-CALC-PREMIUM =
  2188                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2189     ELSE
  2190         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2191                                 CP-ORIGINAL-TERM
  2192         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2193                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2194                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2195                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2196     END-IF
  2197     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2198        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2199           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2200           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2201     END-IF
  2202     GO TO 9999-CALC-RATE-PREM-X
  2203     .
  2204 1212-GROSS-NOT-TRUNCATED.
  2205*    DISPLAY ' ELCRATPD '
  2206*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2207*    display ' premium rate ' cp-premium-rate
  2208
  2209     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  43
* ELRATE.cbl
  2210        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2211           OR 'IN')
  2212        AND (CP-BENEFIT-CD = '55' OR '56')
  2213        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2214          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2215          (CP-ORIGINAL-TERM) *
  2216          ((CP-ORIGINAL-TERM) / 12) *
  2217          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2218          GO TO 9999-CALC-RATE-PREM-X
  2219     END-IF
  2220     IF (CP-COMPANY-ID = 'CID')
  2221        AND (CP-STATE-STD-ABBRV = 'GA')
  2222        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2223        COMPUTE WK3 ROUNDED =
  2224          CP-ORIGINAL-BENEFIT *
  2225          ((CP-ORIGINAL-TERM + 1) / 2) *
  2226          (RT-DISCOUNT-OB-RATE / 1000)
  2227          MOVE WK3 TO CP-CALC-PREMIUM
  2228          GO TO 9999-CALC-RATE-PREM-X
  2229     END-IF
  2230     IF (CP-COMPANY-ID EQUAL 'CID')
  2231        AND (CP-STATE-STD-ABBRV = 'MN')
  2232        AND (CP-LEVEL-LIFE)
  2233        AND (CP-CERT-EFF-DT > X'A4FF')
  2234        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2235        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2236        MOVE '1'                 TO DC-OPTION-CODE
  2237        PERFORM 9100-CONVERT-DATE
  2238                                 THRU 9100-EXIT
  2239        IF DATE-CONVERSION-ERROR
  2240           MOVE '2'              TO CP-RETURN-CODE
  2241           MOVE ZEROS            TO FACTOR
  2242                                 CP-CALC-PREMIUM
  2243           GO TO 9999-CALC-RATE-PREM-X
  2244        END-IF
  2245        MOVE DC-ELAPSED-DAYS     TO D
  2246        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2247           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2248           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2249        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2250           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2251        GO TO 9999-CALC-RATE-PREM-X
  2252     END-IF
  2253     IF (CP-COMPANY-ID = 'CID')
  2254        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2255        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2256           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2257     ELSE
  2258        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2259                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2260     END-IF
  2261*    display ' calc premium ' cp-calc-premium
  2262
  2263*    IF CP-COMPANY-ID = 'LBL'
  2264     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2265        AND (NOT CP-EARN-AS-NET-PAY)
  2266        GO TO 9999-CALC-RATE-PREM-X
  2267     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  44
* ELRATE.cbl
  2268
  2269*    display ' fell through to ext days '
  2270     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2271         GO TO 9999-CALC-RATE-PREM-X.
  2272
  2273     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2274         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2275            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2276               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2277
  2278     GO TO 9999-CALC-RATE-PREM-X.
  2279
  2280 1220-CRITICAL-PERIOD-LF-CONT.
  2281     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2282               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2283
  2284     GO TO 9999-CALC-RATE-PREM-X.
  2285
  2286 1230-TEXAS-CONT.
  2287     IF CP-FARM-PLAN
  2288         GO TO 1235-TEXAS-FARM-CONT.
  2289
  2290     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2291               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2292
  2293     COMPUTE TEX-FACT-9 =
  2294                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2295                 (CP-ORIGINAL-TERM + 1).
  2296
  2297     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2298                 CP-CALC-PREMIUM * TEX-FACT-9.
  2299
  2300     GO TO 9999-CALC-RATE-PREM-X.
  2301
  2302 1235-TEXAS-FARM-CONT.
  2303     COMPUTE WS-FARM-TERM =
  2304               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2305
  2306     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2307     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2308
  2309
  2310     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2311              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2312
  2313     GO TO 9999-CALC-RATE-PREM-X.
  2314
  2315 1240-NET-PAY-CONT.
  2316
  2317     MOVE CP-LOAN-APR             TO N-P-APR.
  2318     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2319                                     N-P-REM
  2320                                     N-P-LOAN.
  2321
  2322     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2323
  2324     IF CP-TRUNCATED-LIFE
  2325         MOVE CP-LOAN-TERM        TO N-P-LOAN.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  45
* ELRATE.cbl
  2326
  2327     IF CP-COMPANY-ID EQUAL 'NCL'
  2328        NEXT SENTENCE
  2329     ELSE
  2330        GO TO 1241-NET-PAY-CONT.
  2331
  2332     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2333     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2334     MOVE '1'                    TO DC-OPTION-CODE
  2335     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2336     IF DATE-CONVERSION-ERROR
  2337         MOVE '2'                TO CP-RETURN-CODE
  2338         GO TO 9999-CALC-RATE-PREM-X
  2339     ELSE
  2340        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2341        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2342
  2343     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2344        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2345        NEXT SENTENCE
  2346     ELSE
  2347        MOVE +1                  TO ODF
  2348        GO TO 1241-NET-PAY-CONT.
  2349
  2350     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2351        COMPUTE CP-PREMIUM-RATE EQUAL
  2352        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2353        CP-PREMIUM-RATE) *
  2354        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2355
  2356     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2357        COMPUTE CP-PREMIUM-RATE EQUAL
  2358        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2359        N-P-LOAN * (N-P-LOAN - 1))) *
  2360        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2361        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2362
  2363     COMPUTE ODF EQUAL
  2364     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2365     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2366
  2367 1241-NET-PAY-CONT.
  2368
  2369     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2370
  2371*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2372     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2373        NEXT SENTENCE
  2374     ELSE
  2375        GO TO 9999-CALC-RATE-PREM-X.
  2376
  2377     IF RT-DISCOUNT-OPTION EQUAL '6'
  2378         GO TO 9999-CALC-RATE-PREM-X.
  2379
  2380     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2381        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2382        GO TO 9999-CALC-RATE-PREM-X.
  2383
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  46
* ELRATE.cbl
  2384     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2385
  2386     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2387        GO TO 9999-CALC-RATE-PREM-X.
  2388
  2389     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2390        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2391        (CP-TRUNCATED-LIFE)
  2392        GO TO 9999-CALC-RATE-PREM-X.
  2393
  2394     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2395        (CP-CSL-VALID-NP-BENEFIT-CD)
  2396        GO TO 9999-CALC-RATE-PREM-X.
  2397
  2398     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2399        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2400        (CP-EARN-AS-NET-PAY)
  2401        GO TO 9999-CALC-RATE-PREM-X.
  2402
  2403*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2404*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2405*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2406*       GO TO 9999-CALC-RATE-PREM-X.
  2407
  2408     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2409        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2410        (CP-EARN-AS-NET-PAY)
  2411        GO TO 9999-CALC-RATE-PREM-X.
  2412
  2413     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2414        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2415        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2416        GO TO 9999-CALC-RATE-PREM-X.
  2417
  2418     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2419        (CP-EARN-AS-NET-PAY)
  2420        GO TO 9999-CALC-RATE-PREM-X.
  2421
  2422     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2423        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2424        (CP-TRUNCATED-LIFE)
  2425        GO TO 9999-CALC-RATE-PREM-X.
  2426
  2427     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2428        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2429        (CP-EARN-AS-NET-PAY)
  2430*       (CP-TRUNCATED-LIFE)
  2431        GO TO 9999-CALC-RATE-PREM-X.
  2432
  2433     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2434        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2435                   AND
  2436        ((CP-EARN-AS-NET-PAY)
  2437               OR
  2438        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2439        GO TO 9999-CALC-RATE-PREM-X.
  2440
  2441     IF (CP-COMPANY-ID EQUAL 'GTL') AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  47
* ELRATE.cbl
  2442        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2443        (CP-EARN-AS-NET-PAY) AND
  2444        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2445        GO TO 9999-CALC-RATE-PREM-X.
  2446
  2447     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2448        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2449        (CP-EARN-AS-NET-PAY)
  2450        GO TO 9999-CALC-RATE-PREM-X.
  2451
  2452     IF CP-COMPANY-ID = 'CID'
  2453        CONTINUE
  2454     ELSE
  2455        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2456           (CP-EARN-AS-NET-PAY) AND
  2457           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2458           GO TO 9999-CALC-RATE-PREM-X
  2459        END-IF
  2460     END-IF
  2461
  2462     IF (CP-COMPANY-ID = 'CID')
  2463        AND (CP-EARN-AS-NET-PAY)
  2464        AND (CP-STATE-STD-ABBRV = 'ME')
  2465        GO TO 9999-CALC-RATE-PREM-X
  2466     END-IF
  2467     IF (CP-COMPANY-ID = 'DCC')
  2468        AND (CP-BEN-CATEGORY = 'D')
  2469        AND (CP-EARN-AS-NET-PAY)
  2470        GO TO 9999-CALC-RATE-PREM-X
  2471     END-IF
  2472     IF (CP-COMPANY-ID = 'CID')
  2473        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2474           OR 'IN' OR 'AZ')
  2475        AND (CP-FARM-PLAN)
  2476        GO TO 9999-CALC-RATE-PREM-X
  2477     END-IF
  2478     IF (CP-COMPANY-ID = 'CID') AND
  2479        (CP-EARN-AS-NET-PAY) AND
  2480        (CP-LEVEL-LIFE) AND
  2481        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2482        (CP-STATE-STD-ABBRV = CP-STATE)
  2483        GO TO 9999-CALC-RATE-PREM-X
  2484     END-IF
  2485
  2486     IF (CP-COMPANY-ID = 'CID') AND
  2487        (CP-EARN-AS-NET-PAY) AND
  2488        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2489                            OR 'VT')
  2490                   OR
  2491        ((CP-STATE-STD-ABBRV = 'IN') AND
  2492        (CP-CERT-EFF-DT > X'9A7F'))
  2493                   OR
  2494        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2495        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2496        (CP-STATE-STD-ABBRV = CP-STATE)
  2497        GO TO 9999-CALC-RATE-PREM-X
  2498     END-IF
  2499
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  48
* ELRATE.cbl
  2500     IF (CP-COMPANY-ID = 'CID') AND
  2501        (CP-EARN-AS-NET-PAY) AND
  2502        (CP-STATE-STD-ABBRV = 'TX') AND
  2503        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2504        (WS-DISCOUNT-OPTION NOT = ' ')
  2505        GO TO 9999-CALC-RATE-PREM-X
  2506     END-IF
  2507
  2508     IF (CP-COMPANY-ID = 'CID')
  2509        AND (CP-STATE-STD-ABBRV = 'MN')
  2510        AND (RT-DISCOUNT-OPTION = '1')
  2511        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2512        GO TO 9999-CALC-RATE-PREM-X
  2513     END-IF
  2514     IF (CP-COMPANY-ID = 'CID')
  2515        AND (CP-EARN-AS-NET-PAY)
  2516        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2517                      OR
  2518            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2519        GO TO 9999-CALC-RATE-PREM-X
  2520     END-IF
  2521     IF (CP-COMPANY-ID = 'CID')
  2522        AND (CP-EARN-AS-NET-PAY)
  2523        AND (CP-STATE-STD-ABBRV = 'SC')
  2524        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2525        GO TO 9999-CALC-RATE-PREM-X
  2526     END-IF
  2527     IF (CP-COMPANY-ID = 'CID') AND
  2528        (CP-EARN-AS-NET-PAY) AND
  2529        (CP-TRUNCATED-LIFE) AND
  2530        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2531        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2532        (WS-DISCOUNT-OPTION NOT = ' ')
  2533        GO TO 9999-CALC-RATE-PREM-X
  2534     END-IF
  2535
  2536     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2537        (CP-EARN-AS-NET-PAY)
  2538        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2539        GO TO 9999-CALC-RATE-PREM-X
  2540     END-IF
  2541
  2542     IF (CP-COMPANY-ID EQUAL 'CID')
  2543        AND (CP-EARN-AS-NET-PAY)
  2544        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2545        GO TO 9999-CALC-RATE-PREM-X
  2546     END-IF
  2547
  2548     IF (RT-IS-OB) AND
  2549        (CP-COMPANY-ID NOT EQUAL 'CID')
  2550        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2551               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2552      ELSE
  2553         IF (CP-COMPANY-ID = 'DCC')
  2554            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2555            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2556*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2557             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  49
* ELRATE.cbl
  2558               CP-ORIGINAL-TERM
  2559             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2560             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2561        ELSE
  2562           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2563               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2564        END-IF
  2565     END-IF
  2566
  2567     IF CP-ROA-PREM-AT-REFUND
  2568         COMPUTE NET-BEN ROUNDED =
  2569             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2570     ELSE
  2571         COMPUTE NET-BEN ROUNDED =
  2572              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2573
  2574     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2575        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2576          COMPUTE NET-BEN ROUNDED =
  2577              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2578                         (CP-TERM-OR-EXT-DAYS / 30)).
  2579
  2580     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2581*       OR 'DCC'
  2582*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2583     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2584       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2585       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2586                        * CP-ORIGINAL-TERM / 1200))
  2587     ELSE
  2588     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2589       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2590       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2591
  2592****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2593****** INTEREST IS CHARGED ON PREMIUM.
  2594
  2595*    IF CP-STATE-STD-ABBRV = 'MI'
  2596*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2597*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2598
  2599     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2600
  2601     GO TO 9999-CALC-RATE-PREM-X.
  2602
  2603******
  2604****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2605******
  2606
  2607 1250-CSL-CALC.
  2608     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2609     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2610     MOVE '1' TO DC-OPTION-CODE.
  2611     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2612
  2613     IF DATE-CONVERSION-ERROR
  2614         MOVE '2' TO CP-RETURN-CODE
  2615         GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  50
* ELRATE.cbl
  2616
  2617     IF CP-JOINT-INDICATOR = 'J'
  2618         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2619     ELSE
  2620         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2621
  2622     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2623     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2624
  2625     IF CP-PAY-FREQUENCY = 12
  2626         MOVE 01               TO WS-PAY-SCH.
  2627     IF CP-PAY-FREQUENCY = 04
  2628         MOVE 03               TO WS-PAY-SCH.
  2629     IF CP-PAY-FREQUENCY = 02
  2630         MOVE 06               TO WS-PAY-SCH.
  2631     IF CP-PAY-FREQUENCY = 01
  2632         MOVE 12               TO WS-PAY-SCH.
  2633
  2634     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2635     IF CP-PAY-FREQUENCY NOT = 12
  2636         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2637                                WS-NUM-PAYMTS.
  2638
  2639     IF CP-STATE = 'SC'  AND
  2640       (CP-BENEFIT-CD = '07'  OR  '08')
  2641         GO TO 1250-CSL-CALC-LIFE-6.
  2642
  2643     IF CP-CSL-METH-1
  2644         GO TO 1250-CSL-CALC-LIFE-1.
  2645
  2646     IF CP-CSL-METH-2
  2647         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2648                          WS-MAX-TOT-BEN
  2649             GO TO 1250-CSL-CALC-LIFE-2
  2650         ELSE
  2651             GO TO 1250-CSL-CALC-LIFE-1.
  2652
  2653     IF CP-CSL-METH-3
  2654         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2655             GO TO 1250-CSL-CALC-LIFE-2
  2656         ELSE
  2657             GO TO 1250-CSL-CALC-LIFE-3.
  2658
  2659     IF CP-CSL-METH-4
  2660         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2661                          WS-MAX-TOT-BEN
  2662             GO TO 1250-CSL-CALC-LIFE-5
  2663         ELSE
  2664             GO TO 1250-CSL-CALC-LIFE-4.
  2665
  2666 1250-CSL-CALC-LIFE-1.
  2667     IF CP-JOINT-INDICATOR = 'J'
  2668         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2669     ELSE
  2670         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2671
  2672     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2673                    365) - 1) * 365 / 12.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  51
* ELRATE.cbl
  2674     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2675                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2676                    4380.
  2677     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2678                    WS-NUM-PAYMTS * WK-S.
  2679
  2680     GO TO 9999-CALC-RATE-PREM-X.
  2681
  2682 1250-CSL-CALC-LIFE-2.
  2683     IF CP-JOINT-INDICATOR = 'J'
  2684         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2685     ELSE
  2686         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2687
  2688     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2689     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2690     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2691                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2692                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2693     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2694                    WK-S) + WK-D.
  2695
  2696     GO TO 9999-CALC-RATE-PREM-X.
  2697
  2698 1250-CSL-CALC-LIFE-3.
  2699     IF CP-JOINT-INDICATOR = 'J'
  2700         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2701     ELSE
  2702         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2703
  2704     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2705     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2706     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2707                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2708                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2709     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2710                    WK-S) + WK-D.
  2711
  2712     GO TO 9999-CALC-RATE-PREM-X.
  2713
  2714 1250-CSL-CALC-LIFE-4.
  2715     IF CP-JOINT-INDICATOR = 'J'
  2716         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2717     ELSE
  2718         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2719
  2720     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2721     COMPUTE WK-S ROUNDED =
  2722                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2723                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2724                    CP-PAY-FREQUENCY.
  2725     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2726                    WS-NUM-PAYMTS * WK-S.
  2727
  2728     GO TO 9999-CALC-RATE-PREM-X.
  2729
  2730 1250-CSL-CALC-LIFE-5.
  2731     IF CP-JOINT-INDICATOR = 'J'
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  52
* ELRATE.cbl
  2732         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2733     ELSE
  2734         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2735
  2736     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2737     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2738                    CP-PAY-FREQUENCY.
  2739     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2740                    - 1) + WS-NUM-PAYMTS) * 12) /
  2741                    CP-PAY-FREQUENCY.
  2742     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2743     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2744                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2745
  2746     GO TO 9999-CALC-RATE-PREM-X.
  2747
  2748 1250-CSL-CALC-LIFE-6.
  2749
  2750     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2751                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2752
  2753     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2754                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2755
  2756     GO TO 9999-CALC-RATE-PREM-X.
  2757
  2758******
  2759****** END OF PREMIUM CALCULATIONS FOR CSL
  2760******
  2761
  2762 1260-GTL-PA-LEASE.
  2763
  2764     IF CP-REDUCING-LIFE
  2765         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2766                                 TO  CP-PREMIUM-RATE
  2767         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2768                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2769     ELSE
  2770         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2771                                 TO  CP-PREMIUM-RATE
  2772         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2773                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2774                 (+1 + CP-SALES-TAX) / +100.
  2775
  2776     GO TO 9999-CALC-RATE-PREM-X.
  2777
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  53
* ELRATE.cbl
  2779******************************************************************
  2780 2000-TYPE-IS-AH.
  2781     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2782
  2783     MOVE ZERO                      TO CP-R-MAX-AGE
  2784                                       CP-R-MAX-TERM
  2785                                       CP-R-MAX-MON-BEN
  2786                                       CP-R-MAX-TOT-BEN.
  2787
  2788     IF RT-POLICY-FEE NUMERIC
  2789        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2790
  2791     IF RT-COMPOSITE-RATE NOT NUMERIC
  2792        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2793
  2794     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2795        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2796                                 TO CP-PREMIUM-RATE
  2797                                    WS-PREMIUM-RATE
  2798        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2799     ELSE
  2800         MOVE +0                 TO CP-PREMIUM-RATE
  2801                                    CP-CALC-PREMIUM
  2802         GO TO 9999-CALC-RATE-PREM-X
  2803     END-IF
  2804
  2805     IF (CP-COMPANY-ID = 'DCC')
  2806        AND (CP-BENEFIT-CD (1:1) = 'P')
  2807        AND (CP-LOAN-TERM > ZERO AND < 361)
  2808        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2809                                 TO CP-PREMIUM-RATE
  2810                                    WS-PREMIUM-RATE
  2811     END-IF
  2812     MOVE +1 TO AHNDX.
  2813
  2814     IF CP-COMPANY-ID EQUAL 'CRI'
  2815        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2816           MOVE +5               TO AHNDX
  2817           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2818              MOVE 'F'           TO CP-RETURN-CODE
  2819              GO TO 2200-CALCULATE-PREMIUMS.
  2820
  2821     IF RT-AH-AGE (AHNDX) = ZERO
  2822          GO TO 2200-CALCULATE-PREMIUMS.
  2823
  2824 2100-SEARCH-AH-LIMITS.
  2825
  2826     IF CP-COMPANY-ID EQUAL 'CRI'
  2827        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2828           IF AHNDX GREATER THAN +4
  2829              MOVE 'A'             TO CP-RETURN-CODE
  2830              GO TO 2200-CALCULATE-PREMIUMS.
  2831
  2832     IF AHNDX GREATER +8
  2833         MOVE 'A'                TO CP-RETURN-CODE
  2834         GO TO 2200-CALCULATE-PREMIUMS.
  2835
  2836     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  54
* ELRATE.cbl
  2837         IF RT-AH-AGE (AHNDX) = ZEROS
  2838             ADD +1               TO AHNDX
  2839             GO TO 2100-SEARCH-AH-LIMITS
  2840         ELSE
  2841             MOVE RT-AH-AGE (AHNDX)
  2842                                 TO CP-R-MAX-AGE
  2843             MOVE RT-AH-TERM (AHNDX)
  2844                                 TO CP-R-MAX-TERM
  2845             MOVE RT-AH-BEN-M (AHNDX)
  2846                                 TO CP-R-MAX-MON-BEN
  2847             ADD +1               TO AHNDX
  2848             GO TO 2100-SEARCH-AH-LIMITS
  2849     ELSE
  2850         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2851         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2852         MOVE RT-AH-BEN-M (AHNDX)
  2853                                 TO CP-R-MAX-MON-BEN.
  2854
  2855     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2856         MOVE '9'                 TO CP-RETURN-CODE.
  2857
  2858     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2859         MOVE '8'                 TO CP-RETURN-CODE.
  2860
  2861     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2862         GIVING WS-AH-FACE-BENEFIT.
  2863
  2864     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2865         MOVE 'C'                 TO CP-RETURN-CODE.
  2866
  2867 2200-CALCULATE-PREMIUMS.
  2868
  2869     IF CP-COMPANY-ID = 'CSL'
  2870         GO TO 2250-CSL-CALC.
  2871
  2872*    IF CP-CRITICAL-PERIOD
  2873*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2874
  2875     IF CP-CRITICAL-PERIOD
  2876        IF (CP-COMPANY-ID = 'DCC')
  2877           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  2878               OR 'S' OR 'P')
  2879                          OR
  2880                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2881           CONTINUE
  2882        ELSE
  2883           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  2884        END-IF
  2885     END-IF
  2886
  2887     IF (CP-COMPANY-ID = 'DCC')
  2888        AND (CP-BEN-CATEGORY = 'D')
  2889        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2890           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2891     END-IF
  2892     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2893        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  2894        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  55
* ELRATE.cbl
  2895                                     CP-PREMIUM-RATE
  2896        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2897        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  2898        CP-PREMIUM-RATE) / +100
  2899     ELSE
  2900        IF (CP-COMPANY-ID = 'DCC')
  2901           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  2902           MOVE CP-PREMIUM-RATE  TO WK-S
  2903*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  2904           IF CP-RATE-DEV-PCT NOT = ZEROS
  2905              COMPUTE WK-S ROUNDED =
  2906                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  2907           END-IF
  2908           IF CP-BENEFIT-CD (1:1) = 'M'
  2909              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2910              CP-ORIGINAL-BENEFIT * WK-S / 100
  2911           ELSE
  2912              IF CP-BENEFIT-CD (1:1) = 'H'
  2913                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2914                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2915                    WK-S) / 1000
  2916              ELSE
  2917                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  2918                    GO TO 2300-CALC-DCC-MOB-NET-AH
  2919                 ELSE
  2920                    IF CP-BEN-CATEGORY = 'D'
  2921                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2922                        CP-ORIGINAL-BENEFIT *
  2923                        CP-ORIGINAL-TERM * WK-S / 100
  2924                    ELSE
  2925                      IF CP-BENEFIT-CD (1:1) = 'P'
  2926                         GO TO 2300-CALC-DCC-BEN-P-AH
  2927                      ELSE
  2928                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2929                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2930                        WK-S) / 100
  2931                      END-IF
  2932                    END-IF
  2933                 END-IF
  2934              END-IF
  2935           END-IF
  2936           MOVE ZEROS            TO CP-RATE-DEV-PCT
  2937        ELSE
  2938           IF CP-BENEFIT-CD (1:1) = 'M'
  2939              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2940                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  2941           ELSE
  2942              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  2943                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2944                    (CP-NET-BENEFIT-AMT *
  2945                    CP-PREMIUM-RATE) / 1000
  2946              ELSE
  2947                 IF CP-AH-BALLOON-SW = 'Y'
  2948                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  2949                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  2950                      CP-PREMIUM-RATE) / 100
  2951                 ELSE
  2952                   COMPUTE CP-CALC-PREMIUM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  56
* ELRATE.cbl
  2953                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  2954                    CP-PREMIUM-RATE) / 100
  2955                 END-IF
  2956              END-IF
  2957           END-IF
  2958        END-IF
  2959     END-IF
  2960
  2961     IF (CP-COMPANY-ID = 'DCC')
  2962        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  2963        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  2964     END-IF
  2965     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2966         GO TO 9999-CALC-RATE-PREM-X.
  2967
  2968     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  2969         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2970             CP-CALC-PREMIUM +
  2971                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  2972                                       * CP-TERM-OR-EXT-DAYS).
  2973
  2974     GO TO 9999-CALC-RATE-PREM-X.
  2975
  2976 2200-CRITICAL-PERIOD-AH-CONT.
  2977
  2978     IF CP-COMPANY-ID = 'WDS'
  2979         IF CP-ORIGINAL-TERM GREATER THAN 60
  2980             MOVE 60              TO CP-LOAN-TERM.
  2981
  2982     IF CP-COMPANY-ID EQUAL 'CVL'
  2983         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2984           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  2985                                       * CP-PREMIUM-RATE
  2986         GO TO 9999-CALC-RATE-PREM-X.
  2987
  2988     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2989           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  2990                                       * CP-PREMIUM-RATE.
  2991
  2992     GO TO 9999-CALC-RATE-PREM-X.
  2993
  2994 2250-CSL-CALC.
  2995
  2996     IF RT-DAILY-RATE NOT NUMERIC OR
  2997        RT-DAILY-RATE = ZEROS
  2998            MOVE ZEROS TO CP-CALC-PREMIUM
  2999            MOVE '7' TO CP-RETURN-CODE
  3000            GO TO 9999-CALC-RATE-PREM-X.
  3001
  3002     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  3003     COMPUTE WK-MONTHLY-RATE =
  3004          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3005
  3006     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3007     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3008     MOVE '1' TO DC-OPTION-CODE.
  3009     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3010     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  57
* ELRATE.cbl
  3011         MOVE '2' TO CP-RETURN-CODE
  3012         GO TO 9999-CALC-RATE-PREM-X.
  3013
  3014     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3015     IF CP-CSL-METH-1
  3016         GO TO 2250-CSL-CALC-AH-1.
  3017     IF CP-CSL-METH-2
  3018         GO TO 2250-CSL-CALC-AH-2.
  3019     IF CP-CSL-METH-3
  3020         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3021             GO TO 2250-CSL-CALC-AH-4
  3022         ELSE
  3023             GO TO 2250-CSL-CALC-AH-3.
  3024
  3025 2250-CSL-CALC-AH-1.
  3026
  3027     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3028     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3029                    + WK-MONTHLY-RATE.
  3030     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3031                    CP-ORIGINAL-TERM * WK-D.
  3032
  3033     GO TO 9999-CALC-RATE-PREM-X.
  3034
  3035
  3036 2250-CSL-CALC-AH-2.
  3037     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3038     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3039                    + WK-MONTHLY-RATE.
  3040     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3041                    CP-ORIGINAL-TERM * WK-D.
  3042
  3043     GO TO 9999-CALC-RATE-PREM-X.
  3044
  3045 2250-CSL-CALC-AH-3.
  3046
  3047     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3048     COMPUTE WK-T = WK-K + 1.
  3049     COMPUTE WK-MONTHLY-RATE-T =
  3050          RT-AH-RATE (WK-T) / 100.
  3051     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3052
  3053     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3054     IF WK-T1 EQUAL ZEROS
  3055         MOVE ZEROS TO CP-CALC-PREMIUM
  3056         MOVE 'G' TO CP-RETURN-CODE
  3057         GO TO 9999-CALC-RATE-PREM-X.
  3058
  3059     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3060                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3061                    - WK-T)).
  3062     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3063     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3064                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3065                       WS-MAX-TOT-BEN).
  3066     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3067                    WK-MONTHLY-RATE-T) + WK-PREM.
  3068
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  58
* ELRATE.cbl
  3069     GO TO 9999-CALC-RATE-PREM-X.
  3070
  3071 2250-CSL-CALC-AH-4.
  3072     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3073     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3074     COMPUTE WK-MONTHLY-RATE-J =
  3075          RT-AH-RATE (WK-J) / 100.
  3076     COMPUTE WK-T = WK-J + 1.
  3077     COMPUTE WK-MONTHLY-RATE-T =
  3078          RT-AH-RATE (WK-T) / 100.
  3079     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3080     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3081                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3082                    (CP-ORIGINAL-TERM - WK-T)).
  3083     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3084     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3085                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3086                       WS-MAX-TOT-BEN).
  3087     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3088                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3089
  3090     GO TO 9999-CALC-RATE-PREM-X.
  3091
  3092 2300-CALC-DCC-BEN-P-AH.
  3093     IF CP-NO-OF-PMTS NOT NUMERIC
  3094        MOVE +0                  TO CP-NO-OF-PMTS
  3095     END-IF
  3096     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3097        AND ' ' AND 'M'
  3098        MOVE ' '                 TO CP-PMT-MODE
  3099     END-IF
  3100     EVALUATE CP-PMT-MODE
  3101        WHEN 'W'
  3102           MOVE +7               TO C-DAYS-IN-PMT-PER
  3103           MOVE +52              TO C-PMTS-PER-YEAR
  3104           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3105        WHEN 'B'
  3106           MOVE +14              TO C-DAYS-IN-PMT-PER
  3107           MOVE +26              TO C-PMTS-PER-YEAR
  3108           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3109        WHEN OTHER
  3110           MOVE +30              TO C-DAYS-IN-PMT-PER
  3111           MOVE +12              TO C-PMTS-PER-YEAR
  3112           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  3113     END-EVALUATE
  3114     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3115     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3116        C-DAYS-IN-PMT-PER)) / (1 + I)
  3117     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3118     COMPUTE ANGLEN-1 = ANGLEN / Y
  3119     COMPUTE WK3 = CP-NET-BENEFIT-AMT / ANGLEN-1
  3120     if cp-net-benefit-amt = zeros
  3121        compute wk3 = cp-original-benefit - cp-original-premium
  3122     end-if
  3123     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3124     GO TO 9999-CALC-RATE-PREM-X
  3125     .
  3126 2300-CALC-DCC-MOB-NET-AH.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  59
* ELRATE.cbl
  3127     IF CP-ALTERNATE-BENEFIT = ZEROS
  3128        CONTINUE
  3129     ELSE
  3130        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3131     END-IF
  3132     MOVE CP-ORIGINAL-TERM       TO M
  3133     MOVE CP-LOAN-TERM           TO N
  3134     IF N = ZEROS
  3135        MOVE M                   TO N
  3136     END-IF
  3137     COMPUTE I = CP-LOAN-APR / +1200
  3138     IF CP-BENEFIT-CD (1:1) = 'S'
  3139        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3140        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3141        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3142          (WK-S / 1000)
  3143          * 1
  3144        MOVE WK3                 TO CP-CALC-PREMIUM
  3145        GO TO 9999-CALC-RATE-PREM-X
  3146     END-IF
  3147     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3148        / (1 + I)
  3149     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3150          ** ((N - M) * -1))) / I)
  3151     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3152     COMPUTE J = I + (WK-S / +1000)
  3153     COMPUTE WK2 = (1 + J) ** (M * -1)
  3154     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3155     COMPUTE ANGLEM = ((1 - ((1 + J)
  3156          ** (M * -1))) / J) / OD
  3157     IF CP-NET-BENEFIT-AMT = ZEROS
  3158        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3159           * ANGLEM
  3160     END-IF
  3161     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3162     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3163          ** ((N - M) * -1))) / I)
  3164     MOVE +0                     TO WK3
  3165     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3166        (WS-COUNTER > M)
  3167        COMPUTE ANGLEM = (1 - ((1 + J)
  3168          ** ((M - WS-COUNTER + 1) * -1))) / J
  3169        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3170        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3171        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3172     END-PERFORM
  3173     MOVE WK3                    TO CP-CALC-PREMIUM
  3174     GO TO 9999-CALC-RATE-PREM-X
  3175     .
  3176 2300-CALC-DCC-MOB-BAL-AH.
  3177     IF CP-BENEFIT-CD (1:1) = 'S'
  3178        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3179     END-IF
  3180     MOVE CP-ORIGINAL-TERM       TO M
  3181     MOVE CP-LOAN-TERM           TO N
  3182     IF N = ZEROS
  3183        MOVE M                   TO N
  3184     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  60
* ELRATE.cbl
  3185     COMPUTE I = CP-LOAN-APR / +1200
  3186     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3187        / (1 + I)
  3188     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3189     COMPUTE J = I + (WK-S / +1000)
  3190     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3191     MOVE I TO K
  3192     COMPUTE WK2 = (1 + J) ** (M * -1)
  3193     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3194     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3195          ** ((M - 1) * -1))) / J)
  3196     COMPUTE ANGLEM = ((1 - ((1 + J)
  3197          ** (M * -1))) / J) / OD
  3198     IF CP-NET-BENEFIT-AMT = ZEROS
  3199        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3200           * ANGLEM
  3201     END-IF
  3202     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3203        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3204        / ANGLEM-1
  3205     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3206          ** ((N - M) * -1))) / I)
  3207     MOVE +0                     TO WK3
  3208     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3209        (WS-COUNTER > M)
  3210        COMPUTE ANGLEM = (1 - ((1 + J)
  3211          ** ((M - WS-COUNTER) * -1))) / J
  3212        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3213        COMPUTE WK5-CSL = (RA * ANGLEM)
  3214        + (CP-ALTERNATE-BENEFIT * WK2)
  3215        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3216          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3217          (WK-S / 1000)
  3218     END-PERFORM
  3219     MOVE WK3                    TO CP-CALC-PREMIUM
  3220     GO TO 9999-CALC-RATE-PREM-X
  3221     .
  3222 2300-CALC-DCC-MOB-BAL-AHSUM.
  3223     MOVE CP-ORIGINAL-TERM       TO M
  3224     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3225        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3226        * WK-S / 1000
  3227*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3228*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3229*       * WK-S / 1000
  3230     MOVE WK3                    TO CP-CALC-PREMIUM
  3231     GO TO 9999-CALC-RATE-PREM-X
  3232     .
  3233 9999-RATE-NOTFND.
  3234     MOVE '6'                    TO CP-RETURN-CODE.
  3235     GO TO 9999-CALC-RATE-PREM-X.
  3236
  3237 9999-RATE-NOTOPEN.
  3238     MOVE 'D'                    TO CP-RETURN-CODE.
  3239     GO TO 9999-CALC-RATE-PREM-X.
  3240
  3241 9999-CALC-RATE-PREM-X.
  3242     IF (CP-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  61
* ELRATE.cbl
  3243        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3244        CONTINUE
  3245     ELSE
  3246        IF CP-RATE-DEV-PCT NOT = ZERO
  3247           COMPUTE CP-CALC-PREMIUM =
  3248              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3249
  3250
  3251     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3252
  3253     IF WS-BROWSE-STARTED
  3254
  3255* EXEC CICS ENDBR
  3256*            DATASET  (ERRATE-FILE-ID)
  3257*       END-EXEC.
  3258     MOVE 0
  3259       TO DFHEIV11
  3260*    MOVE '&2                    $   #00003207' TO DFHEIV0
  3261     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3262     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3263     MOVE X'2020233030303033323037' TO DFHEIV0(25:11)
  3264     CALL 'kxdfhei1' USING DFHEIV0,
  3265           ERRATE-FILE-ID,
  3266           DFHEIV11,
  3267           DFHEIV99
  3268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3269
  3270
  3271
  3272* EXEC CICS RETURN
  3273*    END-EXEC.
  3274*    MOVE '.(                    &   #00003211' TO DFHEIV0
  3275     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3276     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3277     MOVE X'2020233030303033323131' TO DFHEIV0(25:11)
  3278     CALL 'kxdfhei1' USING DFHEIV0,
  3279           DFHEIV99,
  3280           DFHEIV99,
  3281           DFHEIV99,
  3282           DFHEIV99,
  3283           DFHEIV99
  3284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3285
  3286
  3287 9100-CONVERT-DATE.
  3288
  3289* EXEC CICS LINK
  3290*        PROGRAM  ('ELDATCV')
  3291*        COMMAREA (DATE-CONVERSION-DATA)
  3292*        LENGTH   (DC-COMM-LENGTH)
  3293*    END-EXEC.
  3294     MOVE 'ELDATCV' TO DFHEIV1
  3295*    MOVE '."C                   ''   #00003215' TO DFHEIV0
  3296     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3297     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3298     MOVE X'2020233030303033323135' TO DFHEIV0(25:11)
  3299     CALL 'kxdfhei1' USING DFHEIV0,
  3300           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  62
* ELRATE.cbl
  3301           DATE-CONVERSION-DATA,
  3302           DC-COMM-LENGTH,
  3303           DFHEIV99,
  3304           DFHEIV99,
  3305           DFHEIV99
  3306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3307
  3308
  3309 9100-EXIT.
  3310     EXIT.
  3311
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  63
* ELRATE.cbl
  3313 10000-NET-TERM SECTION.
  3314*                         COPY ERCNETP.
  3315*****************************************************************
  3316*                                                               *
  3317*                            ERCNETP                            *
  3318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3319*                            VMOD=2.029                         *
  3320*                                                               *
  3321*****************************************************************.
  3322*
  3323*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3324*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3325*                                   ORIGINAL TERM (S999)
  3326*                                   REMAINING TERM (S999)
  3327*                                   NET PAY OPTION (X)
  3328*                                   LOAN TERM (S999)
  3329*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3330*
  3331*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3332*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3333*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3334*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3335*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3336*    CHARGED.
  3337*
  3338*    OPTIONS - S = NET SIMPLE
  3339*          SPACE = NET PAY  (1 MO. INTEREST)
  3340*              A = NET PAY  (0 MO. INTEREST)
  3341*              I = NET PAY  (2 MO. INTEREST)
  3342*              J = NET PAY  (3 MO. INTEREST)
  3343*              K = NET PAY  (4 MO. INTEREST)
  3344*              T = TRUNCATED  (0 MO. INTEREST)
  3345*              U = TRUNCATED  (1 MO. INTEREST)
  3346*              V = TRUNCATED  (2 MO. INTEREST)
  3347*              W = TRUNCATED  (3 MO. INTEREST)
  3348*              X = TRUNCATED  (4 MO. INTEREST)
  3349*              R = REFUNDS (REGULAR OR TRUNCATED)
  3350******************************************************************
  3351*                   C H A N G E   L O G
  3352*
  3353* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3354*-----------------------------------------------------------------
  3355*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3356* EFFECTIVE    NUMBER
  3357*-----------------------------------------------------------------
  3358* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3359* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3360* 120403                   PEMA  ADD SPECIAL TX CALC
  3361* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3362* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3363* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3364* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3365* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3366* 021207                   PEMA  ADD PA NP
  3367* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3368* 032807                   PEMA  ADD VT NP PLUS 2
  3369* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3370* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  64
* ELRATE.cbl
  3371* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3372* 110207      TO 'AL' NET PAY CALC
  3373* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3374* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3375* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3376* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3377* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3378* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3379* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3380* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3381* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3382* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3383* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3384******************************************************************
  3385
  3386     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3387     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3388     MOVE N-P-LOAN    TO LOAN-TERM.
  3389     MOVE N-P-REM     TO REMAINING-TERM.
  3390     MOVE N-P-OPT     TO OPTION-SW.
  3391
  3392     MOVE +0 TO FACTOR.
  3393
  3394     IF ANNUAL-INT-RATE = ZERO
  3395         GO TO 99000-ERROR.
  3396     IF ORIGINAL-TERM = ZERO
  3397         GO TO 99999-RETURN.
  3398     IF REMAINING-TERM = ZERO
  3399         GO TO 99999-RETURN.
  3400     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3401         GO TO 99000-ERROR.
  3402     IF LOAN-TERM = ZERO
  3403         GO TO 99999-RETURN.
  3404     IF LOAN-TERM LESS ORIGINAL-TERM
  3405         GO TO 99000-ERROR.
  3406
  3407*    IF ANNUAL-INT-RATE LESS +2
  3408*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3409*    IF ANNUAL-INT-RATE LESS +2
  3410*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3411*    IF ANNUAL-INT-RATE LESS +2
  3412*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3413
  3414     IF NPO-REFUND
  3415         MOVE '2' TO NP-PROCESS-SW
  3416       ELSE
  3417         IF ORIGINAL-TERM = REMAINING-TERM
  3418            MOVE '1'   TO NP-PROCESS-SW
  3419           ELSE
  3420            MOVE '3'   TO NP-PROCESS-SW.
  3421
  3422     IF NPO-SIMPLE
  3423         MOVE 'S' TO TYPE-SW
  3424     ELSE
  3425         MOVE 'N' TO TYPE-SW.
  3426
  3427     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3428
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  65
* ELRATE.cbl
  3429     COMPUTE V ROUNDED = K1 / (K1 + I).
  3430
  3431     MOVE V     TO VX
  3432                   SV.
  3433
  3434     MOVE +1    TO X1
  3435                   SX.
  3436
  3437     MOVE LOAN-TERM TO MAX-X.
  3438
  3439     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3440
  3441     IF MAX-X = +1
  3442        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3443
  3444     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3445
  3446     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3447         OR 'DCC'        OR 'NCL') AND
  3448        (NOT NP-REFUND)
  3449        NEXT SENTENCE
  3450     ELSE
  3451     IF LOAN-TERM NOT = ORIGINAL-TERM
  3452        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3453
  3454     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3455
  3456 10500-VX-LOOP.
  3457
  3458***  VX = AMORT. LOAN TERM.
  3459***  SV = AMORT. INSURANCE TERM.
  3460***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3461***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3462***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3463
  3464     IF X2 = 1
  3465        MOVE V         TO SX
  3466     END-IF
  3467     COMPUTE VX ROUNDED = VX * V.
  3468
  3469     ADD B1 TO X1.
  3470
  3471     IF X1 = REMAINING-TERM
  3472          MOVE VX    TO SV.
  3473
  3474     IF X1 EQUAL SV-MINUS-ONE
  3475        MOVE VX      TO SV-MINUS-ONE.
  3476
  3477     IF X1 = X2
  3478          MOVE VX    TO SX.
  3479
  3480     IF X1 NOT = MAX-X
  3481          GO TO 10500-VX-LOOP.
  3482
  3483 10700-COMPUTE-REMAINING-FACTOR.
  3484*****  WK1 = LOAN TERM AMORT
  3485     COMPUTE WK1 = K1 - VX.
  3486*****  WK2 = INS TERM AMORT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  66
* ELRATE.cbl
  3487     COMPUTE WK2 = K1 - SV.
  3488*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3489     COMPUTE WK5 = K1 - SX.
  3490*****  WK6 = INS TERM - 1
  3491     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3492
  3493     IF NP-RATING
  3494         GO TO 12000-PREMIUM-RATE.
  3495
  3496     IF NP-REFUND
  3497         GO TO 11000-REFUND-CALC.
  3498
  3499     IF NET-STD
  3500         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3501
  3502     IF NET-SMP
  3503         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3504         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3505         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3506         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3507
  3508     IF REMAINING-TERM LESS THAN X2
  3509         MOVE +0 TO WK3.
  3510
  3511     MOVE WK3 TO FACTOR.
  3512
  3513     GO TO 99999-RETURN.
  3514
  3515 11000-REFUND-CALC.
  3516     IF REMAINING-TERM NOT LESS MAX-X
  3517        MOVE +1 TO FACTOR
  3518        GO TO 99999-RETURN.
  3519
  3520     IF REMAINING-TERM LESS +1
  3521        MOVE 0 TO FACTOR
  3522        GO TO 99999-RETURN.
  3523
  3524     COMPUTE WK2 ROUNDED = WK2 / I.
  3525     COMPUTE WK5 ROUNDED = WK5 / I.
  3526     COMPUTE WK1 ROUNDED = WK1 / I.
  3527
  3528     IF (CP-COMPANY-ID EQUAL 'CID')
  3529        AND (CP-STATE-STD-ABBRV = 'MN')
  3530        AND (CP-CERT-EFF-DT > X'A4FF')
  3531        AND (CP-RATE-AS-REG-BALLOON)
  3532        AND (CP-EARN-AS-NET-PAY)
  3533        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3534        CONTINUE
  3535     ELSE
  3536        GO TO 11000-CHECK-MN-LEV-BALLOON
  3537     END-IF
  3538
  3539     COMPUTE R = M - E
  3540     COMPUTE FACTOR = (R - WK2 + WK5) /
  3541        (M - WK1 + WK5)
  3542
  3543     GO TO 99999-RETURN
  3544
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  67
* ELRATE.cbl
  3545      .
  3546 11000-CHECK-MN-LEV-BALLOON.
  3547
  3548     IF (CP-COMPANY-ID EQUAL 'CID')
  3549        AND (CP-STATE-STD-ABBRV = 'MN')
  3550        AND (CP-CERT-EFF-DT > X'A4FF')
  3551        AND (CP-RATE-AS-REG-BALLOON)
  3552        AND (CP-EARN-AS-NET-PAY)
  3553        AND (CP-DEVIATION-CODE = 'LEV')
  3554        CONTINUE
  3555     ELSE
  3556        GO TO 11000-CONTINUE-REFUND
  3557     END-IF
  3558
  3559     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3560     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3561        ** (M - E)) / I
  3562
  3563     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3564
  3565     GO TO 99999-RETURN
  3566
  3567     .
  3568 11000-CONTINUE-REFUND.
  3569*    IF CP-GAP-ACTUARIAL
  3570*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3571*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3572*       COMPUTE WK3 = WK2 / ANGLEN
  3573*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3574     IF CP-GAP-ACTUARIAL
  3575        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3576           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3577        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3578     ELSE
  3579        COMPUTE WK3 ROUNDED =
  3580          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3581     END-IF
  3582
  3583     MOVE WK3  TO FACTOR.
  3584
  3585     GO TO 99999-RETURN.
  3586
  3587 12000-PREMIUM-RATE.
  3588*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3589*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3590*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3591*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3592*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3593*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3594
  3595     COMPUTE K-I = K1 + I.
  3596     MOVE K-I TO ONE-PLUS-I.
  3597
  3598     IF NPO-ALT OR NPO-TRUNC-0
  3599         MOVE K1 TO K-I.
  3600
  3601     IF NPO-2MO OR NPO-TRUNC-2
  3602         COMPUTE K-I = K1 + (2 * I).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  68
* ELRATE.cbl
  3603
  3604     IF NPO-3MO OR NPO-TRUNC-3
  3605         COMPUTE K-I = K1 + (3 * I).
  3606
  3607     IF NPO-4MO OR NPO-TRUNC-4
  3608         COMPUTE K-I = K1 + (4 * I).
  3609
  3610     COMPUTE RA ROUNDED = 1 -
  3611             ((X2 * (X2 + 1)) /
  3612              (N *  (N  + 1))).
  3613
  3614     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3615        (CP-CSL-VALID-NP-BENEFIT-CD)
  3616        NEXT SENTENCE
  3617     ELSE
  3618        GO TO XXXX-CHECK-DISCOUNT-5.
  3619
  3620     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3621     MOVE ' ' TO DC-OPTION-CODE.
  3622     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3623
  3624     IF DATE-CONVERSION-ERROR
  3625        MOVE '2'                 TO CP-RETURN-CODE
  3626        MOVE ZEROS               TO FACTOR
  3627                                    CP-CALC-PREMIUM
  3628         GO TO 99999-RETURN.
  3629
  3630     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3631     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3632     MOVE ' ' TO DC-OPTION-CODE
  3633     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3634
  3635     IF DATE-CONVERSION-ERROR
  3636        MOVE '2'                 TO CP-RETURN-CODE
  3637        MOVE ZEROS               TO FACTOR
  3638                                    CP-CALC-PREMIUM
  3639         GO TO 99999-RETURN.
  3640
  3641     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3642
  3643     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3644
  3645     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3646        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3647        CP-PAY-FREQUENCY / 365) * I
  3648     ELSE
  3649        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3650        CP-PAY-FREQUENCY / 365) * I.
  3651
  3652     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3653     13).
  3654
  3655     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3656     (N - ( ANGLEN-1 / WK3)).
  3657
  3658     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3659
  3660     COMPUTE WS-CALC-FREQ-RATE EQUAL
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  69
* ELRATE.cbl
  3661       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3662
  3663     COMPUTE WS-Y-X-FACTOR EQUAL
  3664       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3665       WS-CALC-FREQ-RATE).
  3666
  3667     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3668       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3669
  3670     COMPUTE WS-X-Y-FACTOR EQUAL
  3671       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3672
  3673     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3674       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3675       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3676
  3677     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3678
  3679     GO TO 99999-RETURN.
  3680
  3681 XXXX-CHECK-DISCOUNT-5.
  3682
  3683     IF WS-DISCOUNT-OPTION EQUAL '5'
  3684        NEXT SENTENCE
  3685     ELSE
  3686        GO TO 12000-CHECK-CLIENT.
  3687
  3688      COMPUTE ANGLEN EQUAL WK1 / I.
  3689
  3690      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3691
  3692      COMPUTE WK3 EQUAL
  3693        (12 *
  3694        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3695        CP-ORIGINAL-BENEFIT)) /
  3696        APR100.
  3697
  3698     COMPUTE WK3 EQUAL
  3699        (WK3 * CP-PREMIUM-RATE) / +1000.
  3700
  3701     COMPUTE WK3 EQUAL
  3702        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3703
  3704      MOVE WK3 TO CP-CALC-PREMIUM.
  3705
  3706     GO TO 99999-RETURN.
  3707
  3708 12000-CHECK-CLIENT.
  3709
  3710     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3711        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3712        (CP-TRUNCATED-LIFE)
  3713        NEXT SENTENCE
  3714     ELSE
  3715        GO TO 12000-CHECK-NEXT.
  3716
  3717     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3718
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  70
* ELRATE.cbl
  3719     COMPUTE ANGLEN EQUAL WK1 / I.
  3720     COMPUTE ANGLEM EQUAL WK2 / I.
  3721
  3722     COMPUTE FM EQUAL
  3723                    (((ONE-PLUS-I ** M) * I * M) /
  3724                    ((ONE-PLUS-I ** M) - 1))
  3725                    - 1.
  3726
  3727     COMPUTE FN EQUAL
  3728                    (((ONE-PLUS-I ** N) * I * N) /
  3729                    ((ONE-PLUS-I ** N) - 1))
  3730                    - 1.
  3731
  3732     COMPUTE FNM EQUAL
  3733                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3734                    ((ONE-PLUS-I ** (N - M)) - 1))
  3735                    - 1.
  3736
  3737     COMPUTE GR EQUAL
  3738                    (WS-WORK-RATE * ANGLEM * I) /
  3739                    (M - ANGLEM).
  3740
  3741     COMPUTE ODF EQUAL
  3742                     (1 +
  3743                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3744                     360)) /
  3745                     ONE-PLUS-I.
  3746
  3747     COMPUTE OD EQUAL
  3748                    (1 + (ODF * (FN / I - 1))) +
  3749                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3750
  3751     COMPUTE WK3 EQUAL
  3752*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3753                    ((1 + FN) * ODF *
  3754                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3755                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3756                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3757
  3758     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3759     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  3760
  3761     COMPUTE WK3 EQUAL
  3762                    (WK3 / (ODF * (1 + FN))) -
  3763*                   CP-ORIGINAL-BENEFIT.
  3764                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  3765
  3766      MOVE WK3 TO CP-CALC-PREMIUM.
  3767
  3768     GO TO 99999-RETURN.
  3769
  3770 12000-CHECK-NEXT.
  3771
  3772     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  3773        NEXT SENTENCE
  3774     ELSE
  3775        GO TO 12000-CHECK-PA-TRUNC.
  3776
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  71
* ELRATE.cbl
  3777      IF WS-WORK-DIS-RATE EQUAL +0
  3778         MOVE '7'                TO CP-RETURN-CODE
  3779         MOVE ZEROS              TO FACTOR
  3780                                    CP-CALC-PREMIUM
  3781         GO TO 99999-RETURN.
  3782
  3783      COMPUTE ANGLEN EQUAL WK1 / I.
  3784
  3785      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3786
  3787      IF WS-WORK-DIS-RATE EQUAL APR100
  3788         ADD .00001 TO APR100.
  3789
  3790      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  3791      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  3792
  3793     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3794        / (1 + I)
  3795     COMPUTE ANGLEN-1 = ANGLEN / Y
  3796      IF CP-COMPANY-ID EQUAL 'CDL'
  3797         COMPUTE WK3 EQUAL
  3798
  3799          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  3800          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  3801
  3802          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3803
  3804          ((WK8 ** N) /
  3805          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3806
  3807          ((WK9 ** N) /
  3808          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  3809
  3810      ELSE
  3811         COMPUTE WK3 EQUAL
  3812
  3813          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3814          (12 + WS-WORK-DIS-RATE) * 12) *
  3815
  3816          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3817
  3818          ((WK8 ** N) /
  3819          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3820
  3821          ((WK9 ** N) /
  3822          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3823
  3824      COMPUTE WK3 EQUAL
  3825          (WK3 * CP-PREMIUM-RATE) / +1000.
  3826
  3827      MOVE WK3 TO CP-CALC-PREMIUM.
  3828
  3829     GO TO 99999-RETURN.
  3830
  3831 12000-CHECK-PA-TRUNC.
  3832
  3833     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3834        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  72
* ELRATE.cbl
  3835        (CP-EARN-AS-NET-PAY) AND
  3836        (CP-TRUNCATED-LIFE)
  3837        NEXT SENTENCE
  3838     ELSE
  3839        GO TO 12000-CHECK-MD-TRUNC.
  3840
  3841     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3842
  3843     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3844     COMPUTE ANGLEN EQUAL WK1 / I.
  3845
  3846     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3847
  3848     COMPUTE WK3 EQUAL
  3849        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  3850        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  3851
  3852     MOVE WK3 TO CP-CALC-PREMIUM.
  3853
  3854     GO TO 99999-RETURN.
  3855
  3856 12000-CHECK-MD-TRUNC.
  3857
  3858     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3859        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3860        (CP-EARN-AS-NET-PAY) AND
  3861        (CP-TRUNCATED-LIFE)
  3862        NEXT SENTENCE
  3863     ELSE
  3864        GO TO 12000-CHECK-MD.
  3865
  3866     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3867
  3868     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3869     COMPUTE ANGLEM EQUAL WK2 / I.
  3870     COMPUTE ANGLEN EQUAL WK1 / I.
  3871
  3872     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3873
  3874     COMPUTE WK3 EQUAL
  3875        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3876        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3877        (ANGLEN-1 * (M - ANGLEM))).
  3878
  3879     MOVE WK3 TO CP-CALC-PREMIUM.
  3880
  3881     GO TO 99999-RETURN.
  3882
  3883 12000-CHECK-MD.
  3884
  3885     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3886        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3887        (CP-EARN-AS-NET-PAY)
  3888        NEXT SENTENCE
  3889     ELSE
  3890        GO TO 12000-CHECK-ME-TRUNC.
  3891
  3892     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  73
* ELRATE.cbl
  3893
  3894     COMPUTE WK3 EQUAL
  3895        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3896
  3897     MOVE WK3 TO CP-CALC-PREMIUM.
  3898
  3899     GO TO 99999-RETURN.
  3900
  3901 12000-CHECK-ME-TRUNC.
  3902
  3903     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3904        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3905        AND (CP-EARN-AS-NET-PAY)
  3906        AND (CP-TRUNCATED-LIFE)
  3907        CONTINUE
  3908     ELSE
  3909        GO TO 12000-CHECK-CID-FARMPLAN
  3910     END-IF
  3911
  3912     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3913     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3914     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3915     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3916     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3917     COMPUTE ANGLEN-1 = ANGLEN / Y
  3918     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3919     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3920     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3921     COMPUTE WK3
  3922        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3923        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3924            * (1 / (1.0635 ** (M / 12))))
  3925*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3926*    COMPUTE WK9 EQUAL
  3927*       1 / (1 + (.045 * (N - M) / 24))
  3928*    COMPUTE WK7 EQUAL
  3929*       WS-WORK-RATE * 20 / (M + 1).
  3930*    COMPUTE WK3 EQUAL
  3931*       ((( N - ANGLEN) * WK7 * WK8) /
  3932*       (10 * ANGLEN-1 * I)) -
  3933*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3934*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3935*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3936*
  3937     MOVE WK3 TO CP-CALC-PREMIUM.
  3938
  3939     GO TO 99999-RETURN.
  3940 12000-CHECK-CID-FARMPLAN.
  3941     IF (CP-COMPANY-ID EQUAL 'CID')
  3942        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3943           OR 'IN' OR 'AZ')
  3944        AND (CP-FARM-PLAN)
  3945        CONTINUE
  3946     ELSE
  3947        GO TO 12000-CHECK-SC-CID
  3948     END-IF
  3949     COMPUTE N = M / CP-PAY-FREQUENCY
  3950     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  74
* ELRATE.cbl
  3951     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3952        ** CP-PAY-FREQUENCY) - 1
  3953     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3954     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3955        ** TI) / WS-WORK-DIS-RATE
  3956     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3957     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3958     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3959        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3960     COMPUTE WK2 = WK2 * (1 + J)
  3961     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3962     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3963     COMPUTE WK3 = WK3 * (1 + J)
  3964     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3965        ** (N - 1))) / J
  3966     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3967        ((N * WK2) - WK5)) + (N * WK1)) *
  3968        (CP-PREMIUM-RATE / 1000)
  3969     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3970     COMPUTE WK6 = (WK7 * GR)
  3971     MOVE WK6 TO CP-CALC-PREMIUM
  3972     GO TO 99999-RETURN
  3973     .
  3974 12000-CHECK-SC-CID.
  3975     IF (CP-COMPANY-ID EQUAL 'CID')
  3976        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  3977        AND (CP-EARN-AS-NET-PAY)
  3978        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3979        CONTINUE
  3980     ELSE
  3981        GO TO 12000-CHECK-AL-CID
  3982     END-IF
  3983     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3984     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3985     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3986     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3987     COMPUTE ANGLEN-1 = ANGLEN / Y
  3988     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3989        / 12)) / ((M + 1) / 2)
  3990     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3991     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3992        + 6 * M) * (WK2 / 100) * (1 + I)
  3993     MOVE WK3 TO CP-CALC-PREMIUM
  3994     GO TO 99999-RETURN
  3995     .
  3996 12000-CHECK-AL-CID.
  3997     IF (CP-COMPANY-ID EQUAL 'CID')
  3998        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3999        AND (CP-EARN-AS-NET-PAY)
  4000        CONTINUE
  4001     ELSE
  4002        GO TO 12000-CHECK-NH-CID
  4003     END-IF
  4004     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4005     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4006     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4007     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4008                   / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  75
* ELRATE.cbl
  4009     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4010     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4011     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4012        (CP-PREMIUM-RATE / 1000)
  4013     MOVE WK3 TO CP-CALC-PREMIUM
  4014     GO TO 99999-RETURN
  4015     .
  4016 12000-CHECK-NH-CID.
  4017     IF (CP-COMPANY-ID EQUAL 'CID')
  4018        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4019        AND (CP-EARN-AS-NET-PAY)
  4020        CONTINUE
  4021     ELSE
  4022        GO TO 12000-CHECK-PA-CID
  4023     END-IF
  4024     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4025     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4026     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4027                   / (1 + I)
  4028     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4029     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4030     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4031        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4032     MOVE WK3 TO CP-CALC-PREMIUM
  4033     GO TO 99999-RETURN
  4034     .
  4035 12000-CHECK-PA-CID.
  4036     IF (CP-COMPANY-ID EQUAL 'CID')
  4037        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4038        AND (CP-EARN-AS-NET-PAY)
  4039        CONTINUE
  4040     ELSE
  4041        GO TO 12000-CHECK-ME-CID
  4042     END-IF
  4043
  4044     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4045     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4046     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4047     COMPUTE ANGLEN-1 = ANGLEN / Y
  4048     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4049     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4050     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4051     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4052        * WK5
  4053     MOVE WK3 TO CP-CALC-PREMIUM
  4054     GO TO 99999-RETURN
  4055     .
  4056 12000-CHECK-ME-CID.
  4057     IF (CP-COMPANY-ID EQUAL 'CID')
  4058        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4059        AND (CP-EARN-AS-NET-PAY)
  4060        CONTINUE
  4061     ELSE
  4062        GO TO 12000-CHECK-VT-TRUNC
  4063     END-IF
  4064     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4065     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4066     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  76
* ELRATE.cbl
  4067     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4068     COMPUTE ANGLEN-1 = ANGLEN / Y
  4069     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4070     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4071     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4072        * WK5
  4073     MOVE WK3 TO CP-CALC-PREMIUM
  4074     GO TO 99999-RETURN
  4075     .
  4076 12000-CHECK-VT-TRUNC.
  4077
  4078     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4079        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4080        (CP-EARN-AS-NET-PAY) AND
  4081        (CP-TRUNCATED-LIFE)
  4082        NEXT SENTENCE
  4083     ELSE
  4084        GO TO 12000-CHECK-VT.
  4085
  4086      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4087
  4088      COMPUTE ANGLEN EQUAL WK1 / I.
  4089
  4090      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4091
  4092      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4093      COMPUTE WK9 EQUAL
  4094        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4095        ((.0054 - I) / (1 + I)).
  4096      COMPUTE WK7 EQUAL
  4097        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4098      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4099        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4100
  4101      MOVE WK3 TO CP-CALC-PREMIUM.
  4102
  4103     GO TO 99999-RETURN.
  4104
  4105 12000-CHECK-VT.
  4106
  4107     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4108        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4109        (CP-EARN-AS-NET-PAY)
  4110        NEXT SENTENCE
  4111     ELSE
  4112        GO TO 12000-CHECK-MINN-WDS.
  4113
  4114      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4115
  4116      COMPUTE ANGLEN EQUAL WK1 / I.
  4117
  4118      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4119
  4120      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4121                        (ANGLEN-1 * I)) *
  4122
  4123                        (((1.0054 ** N - 1) /
  4124                        (1.0054 ** (N - 1) * .0054)) -
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  77
* ELRATE.cbl
  4125
  4126                        ((V * (1 - 1.0054 ** N * VX)) /
  4127                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4128
  4129      MOVE WK3 TO CP-CALC-PREMIUM.
  4130
  4131     GO TO 99999-RETURN.
  4132
  4133 12000-CHECK-MINN-WDS.
  4134
  4135     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4136        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4137        (CP-EARN-AS-NET-PAY)
  4138        NEXT SENTENCE
  4139     ELSE
  4140        GO TO 12000-CHECK-MINN-BALL-LEV.
  4141
  4142     COMPUTE ANGLEN EQUAL WK1 / I.
  4143     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4144              (N / +12) * (2 / (N + 1)).
  4145     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4146         WK3 * ((N - ANGLEN) / I).
  4147
  4148      MOVE WK3 TO CP-CALC-PREMIUM.
  4149
  4150     GO TO 99999-RETURN.
  4151
  4152 12000-CHECK-MINN-BALL-LEV.
  4153
  4154     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4155        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4156        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4157        (CP-EARN-AS-REG-BALLOON)
  4158        NEXT SENTENCE
  4159     ELSE
  4160        GO TO 12000-CHECK-MINN-BALL.
  4161
  4162     COMPUTE ANGLEN EQUAL WK1 / I.
  4163
  4164     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4165
  4166     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4167        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4168
  4169     MOVE WK3 TO CP-CALC-PREMIUM.
  4170
  4171     GO TO 99999-RETURN.
  4172
  4173 12000-CHECK-MINN-BALL.
  4174
  4175     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4176        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4177        (CP-EARN-AS-REG-BALLOON)
  4178        NEXT SENTENCE
  4179     ELSE
  4180        GO TO 12000-CHECK-CID-MN-BALL.
  4181
  4182     COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  78
* ELRATE.cbl
  4183     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4184
  4185     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4186     / +100 * (N - 1) / 12 * 2 / N *
  4187     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4188
  4189      MOVE WK3 TO CP-CALC-PREMIUM.
  4190
  4191     GO TO 99999-RETURN.
  4192
  4193 12000-CHECK-CID-MN-BALL.
  4194     IF (CP-COMPANY-ID EQUAL 'CID')
  4195        AND (CP-STATE-STD-ABBRV = 'MN')
  4196        AND (CP-CERT-EFF-DT > X'A4FF')
  4197        AND (CP-EARN-AS-REG-BALLOON)
  4198        CONTINUE
  4199     ELSE
  4200        GO TO 12000-CHECK-NC-WDS
  4201     END-IF
  4202     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4203     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4204     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4205     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4206     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4207     COMPUTE V = 1 / (1 + I)
  4208     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4209     COMPUTE Y = (1 + (D * I) / +30)
  4210        / (1 + I)
  4211     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4212        * CP-PREMIUM-RATE / 1000
  4213*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4214*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4215*    ELSE
  4216*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4217*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4218*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4219*       DISPLAY ' BALLOON TOP ' WK6
  4220*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4221*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4222*          / 100
  4223*       DISPLAY ' BALLOON BOTTOM ' WK7
  4224*       COMPUTE GR = WK6 / WK7
  4225*       DISPLAY ' BALLOON PAYMENT ' GR
  4226*    END-IF
  4227     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4228     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4229        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4230     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4231     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4232        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4233           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4234           * CP-PREMIUM-RATE / 1000
  4235     MOVE WK3                    TO CP-CALC-PREMIUM
  4236     GO TO 99999-RETURN.
  4237     .
  4238 12000-CHECK-NC-WDS.
  4239
  4240     IF (CP-COMPANY-ID EQUAL 'WDS') AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  79
* ELRATE.cbl
  4241        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4242        (CP-EARN-AS-NET-PAY)
  4243        NEXT SENTENCE
  4244     ELSE
  4245        GO TO 12000-CHECK-NC-BALL-LEV.
  4246
  4247     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4248     COMPUTE ANGLEN EQUAL WK1 / I.
  4249     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4250              CP-PREMIUM-RATE / +100 *
  4251              N / +12 * 2 / (N + 1) *
  4252              (WK4 - ANGLEN) / (I * ANGLEN).
  4253
  4254      MOVE WK3 TO CP-CALC-PREMIUM.
  4255
  4256     GO TO 99999-RETURN.
  4257
  4258 12000-CHECK-NC-BALL-LEV.
  4259
  4260     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4261        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4262        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4263        (CP-EARN-AS-REG-BALLOON)
  4264        NEXT SENTENCE
  4265     ELSE
  4266        GO TO 12000-CHECK-NC-BALL.
  4267
  4268     COMPUTE ANGLEN EQUAL WK1 / I.
  4269
  4270**** VX = 1 / (1 + I)**N.
  4271
  4272     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4273        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4274
  4275     MOVE WK3 TO CP-CALC-PREMIUM.
  4276
  4277     GO TO 99999-RETURN.
  4278
  4279 12000-CHECK-NC-BALL.
  4280
  4281     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4282        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4283        (CP-EARN-AS-REG-BALLOON)
  4284        NEXT SENTENCE
  4285     ELSE
  4286        GO TO 12000-CHECK-MINN-TRUNC.
  4287
  4288     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4289     COMPUTE ANGLEN EQUAL WK1 / I.
  4290     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4291**** VX = 1 / (1 + I)**N.
  4292
  4293     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4294     / +100 * (N - 1) / 12 * 2 / N *
  4295     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4296
  4297      MOVE WK3 TO CP-CALC-PREMIUM.
  4298
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  80
* ELRATE.cbl
  4299     GO TO 99999-RETURN.
  4300
  4301 12000-CHECK-MINN-TRUNC.
  4302
  4303     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4304        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4305        (M GREATER THAN +63) AND
  4306        (CP-EARN-AS-NET-PAY) AND
  4307        (CP-TRUNCATED-LIFE)
  4308        NEXT SENTENCE
  4309     ELSE
  4310        GO TO 12000-CHECK-MINN.
  4311
  4312      COMPUTE ANGLEN EQUAL WK1 / I.
  4313      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4314
  4315      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4316
  4317      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4318       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4319       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4320
  4321      MOVE WK3 TO CP-CALC-PREMIUM.
  4322
  4323     GO TO 99999-RETURN.
  4324
  4325 12000-CHECK-MINN.
  4326
  4327     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4328        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4329        (M GREATER THAN +63) AND
  4330        (CP-EARN-AS-NET-PAY)
  4331        NEXT SENTENCE
  4332     ELSE
  4333        GO TO 12000-CHECK-MONTANA-TRUNC.
  4334
  4335      COMPUTE ANGLEN EQUAL WK1 / I.
  4336
  4337      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4338
  4339      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4340       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4341       (((N - ANGLEN) / I) + (2 * N)).
  4342
  4343      MOVE WK3 TO CP-CALC-PREMIUM.
  4344
  4345     GO TO 99999-RETURN.
  4346
  4347 12000-CHECK-MONTANA-TRUNC.
  4348
  4349     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4350        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4351        (M GREATER THAN +63) AND
  4352        (CP-EARN-AS-NET-PAY) AND
  4353        (CP-TRUNCATED-LIFE)
  4354        NEXT SENTENCE
  4355     ELSE
  4356        GO TO 12000-CHECK-MONTANA.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  81
* ELRATE.cbl
  4357
  4358      COMPUTE ANGLEN EQUAL WK1 / I.
  4359      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4360
  4361      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4362
  4363      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4364      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4365       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4366
  4367      MOVE WK3 TO CP-CALC-PREMIUM.
  4368
  4369     GO TO 99999-RETURN.
  4370
  4371 12000-CHECK-MONTANA.
  4372
  4373     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4374        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4375        (M GREATER THAN +63) AND
  4376        (CP-EARN-AS-NET-PAY)
  4377        NEXT SENTENCE
  4378     ELSE
  4379        GO TO 12001-CONTINUE-NCL-TRUNC.
  4380
  4381      COMPUTE ANGLEN EQUAL WK1 / I.
  4382
  4383      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4384
  4385      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4386       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4387       (((N - ANGLEN) / I) + (4 * N)).
  4388
  4389      MOVE WK3 TO CP-CALC-PREMIUM.
  4390
  4391     GO TO 99999-RETURN.
  4392
  4393 12001-CONTINUE-NCL-TRUNC.
  4394
  4395     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4396        (CP-EARN-AS-NET-PAY) AND
  4397        (CP-TRUNCATED-LIFE)
  4398        NEXT SENTENCE
  4399     ELSE
  4400        GO TO 12001-CONTINUE-NCL.
  4401
  4402      COMPUTE ANGLEN EQUAL WK1 / I.
  4403      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4404
  4405      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4406
  4407      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4408      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4409      (ANGLEN-1 * (N + 1) * I).
  4410
  4411      MOVE WK3 TO CP-CALC-PREMIUM.
  4412
  4413     GO TO 99999-RETURN.
  4414
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  82
* ELRATE.cbl
  4415 12001-CONTINUE-NCL.
  4416
  4417     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4418        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4419        (CP-EARN-AS-NET-PAY)
  4420        GO TO 12001-CHECK-NC-NET-PLUS3.
  4421
  4422     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4423        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4424        (CP-EARN-AS-NET-PAY)
  4425        GO TO 12001-CHECK-CA.
  4426
  4427     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4428        (CP-EARN-AS-NET-PAY)
  4429        NEXT SENTENCE
  4430     ELSE
  4431        GO TO 12000-CONTINUE-NET.
  4432
  4433      COMPUTE ANGLEN EQUAL WK1 / I.
  4434      MOVE ANGLEN                TO ANGLEN-1.
  4435
  4436      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4437
  4438      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4439       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4440       ((N - ANGLEN) / I).
  4441
  4442      MOVE WK3 TO CP-CALC-PREMIUM.
  4443
  4444     GO TO 99999-RETURN.
  4445
  4446 12000-CONTINUE-NET.
  4447
  4448     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4449        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4450        (CP-EARN-AS-NET-PAY)
  4451        NEXT SENTENCE
  4452     ELSE
  4453        GO TO 12001-CONTINUE-MINN.
  4454
  4455      COMPUTE ANGLEN EQUAL WK6 / I.
  4456      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  4457
  4458      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  4459      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  4460      COMPUTE WK3 EQUAL (WK3 / I) *
  4461       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  4462
  4463      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  4464         MOVE +0 TO CP-R-MAX-TOT-BEN.
  4465
  4466      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  4467
  4468      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  4469         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  4470         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  4471
  4472      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  83
* ELRATE.cbl
  4473
  4474     GO TO 99999-RETURN.
  4475
  4476 12001-CONTINUE-MINN.
  4477
  4478     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4479        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  4480        (CP-TRUNCATED-LIFE)
  4481        NEXT SENTENCE
  4482     ELSE
  4483        GO TO 12001-CHECK-RI-GTL.
  4484
  4485      COMPUTE ANGLEN EQUAL WK1 / I.
  4486      COMPUTE ANGLEM EQUAL WK2 / I.
  4487
  4488      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  4489       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  4490       * M / 2400) * 1000 + .5) / 1000000.
  4491
  4492      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  4493       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  4494
  4495     GO TO 99999-RETURN.
  4496
  4497 12001-CHECK-RI-GTL.
  4498
  4499     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4500        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4501        (CP-EARN-AS-NET-PAY)
  4502        NEXT SENTENCE
  4503     ELSE
  4504        GO TO 12001-CHECK-RI-LEASE-GTL.
  4505
  4506      COMPUTE ANGLEN EQUAL WK1 / I.
  4507*     COMPUTE ANGLEM EQUAL WK2 / I.
  4508
  4509      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4510               (1 + WS-WORK-DIS-RATE * N).
  4511      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4512         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4513
  4514
  4515     GO TO 99999-RETURN.
  4516
  4517 12001-CHECK-RI-LEASE-GTL.
  4518
  4519     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4520        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4521        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4522        NEXT SENTENCE
  4523     ELSE
  4524        GO TO 12001-CHECK-OR-GTL.
  4525
  4526     COMPUTE ANGLEN EQUAL WK1 / I.
  4527
  4528     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4529        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  4530                        /
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  84
* ELRATE.cbl
  4531        (1000 * I * (1 + .0021 * N)).
  4532     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  4533       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4534                            /
  4535       (1000 * (1 + .0027 * (N + 1))).
  4536
  4537     GO TO 99999-RETURN.
  4538
  4539 12001-CHECK-OR-GTL.
  4540
  4541     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4542        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4543        (CP-EARN-AS-NET-PAY)
  4544        NEXT SENTENCE
  4545     ELSE
  4546        GO TO 12001-CHECK-GA-GTL.
  4547
  4548     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4549     COMPUTE ANGLEN EQUAL WK1 / I.
  4550
  4551     IF M LESS THAN +64
  4552        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4553         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4554                   /
  4555         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4556        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4557     ELSE
  4558        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4559        CP-PREMIUM-RATE * (1 + I))
  4560                  /
  4561        (+1000 * I * ANGLEN)
  4562        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4563*    MOVE WK3 TO CP-CALC-PREMIUM.
  4564     GO TO 99999-RETURN.
  4565
  4566 12001-CHECK-GA-GTL.
  4567
  4568     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4569        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4570        (CP-EARN-AS-NET-PAY)
  4571*       (CP-TRUNCATED-LIFE)
  4572        NEXT SENTENCE
  4573     ELSE
  4574        GO TO 12001-CHECK-MA-GTL.
  4575
  4576     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4577     COMPUTE ANGLEN EQUAL WK1 / I.
  4578
  4579     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4580     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4581      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4582     MOVE WK3 TO CP-CALC-PREMIUM.
  4583
  4584     GO TO 99999-RETURN.
  4585
  4586 12001-CHECK-MA-GTL.
  4587
  4588     IF (CP-COMPANY-ID EQUAL 'GTL') AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  85
* ELRATE.cbl
  4589        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  4590        (CP-EARN-AS-NET-PAY) AND
  4591        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4592        NEXT SENTENCE
  4593     ELSE
  4594        GO TO 12001-CHECK-NV-NET.
  4595
  4596     COMPUTE ANGLEN EQUAL WK1 / I.
  4597
  4598     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  4599      CP-ALTERNATE-BENEFIT * N.
  4600
  4601     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  4602     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  4603
  4604     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  4605     WK7 * (N - ANGLEN) / I.
  4606     MOVE WK3 TO CP-CALC-PREMIUM.
  4607
  4608     GO TO 99999-RETURN.
  4609
  4610 12001-CHECK-NV-NET.
  4611     IF (CP-COMPANY-ID EQUAL 'CID')
  4612        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4613        AND (CP-EARN-AS-NET-PAY)
  4614        CONTINUE
  4615     ELSE
  4616        GO TO 12001-CHECK-MN-NET
  4617     END-IF
  4618     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4619     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4620     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4621                   / (1 + I)
  4622     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4623     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4624     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4625        (CP-PREMIUM-RATE * K-I / 1000)
  4626     MOVE WK3                    TO CP-CALC-PREMIUM
  4627     GO TO 99999-RETURN
  4628      .
  4629 12001-CHECK-MN-NET.
  4630     IF (CP-COMPANY-ID EQUAL 'CID')
  4631        AND (CP-STATE-STD-ABBRV = 'MN')
  4632        AND (CP-EARN-AS-NET-PAY)
  4633        AND (NOT CP-LEVEL-LIFE)
  4634        AND (WS-DISCOUNT-OPTION = '1')
  4635        CONTINUE
  4636     ELSE
  4637        GO TO 12001-CHECK-NC-NET
  4638     END-IF
  4639     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4640     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4641     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4642                   / (1 + I)
  4643     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4644     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4645     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4646        (CP-PREMIUM-RATE / 1000) * (1 + I)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  86
* ELRATE.cbl
  4647     MOVE WK3                    TO CP-CALC-PREMIUM
  4648     GO TO 99999-RETURN
  4649      .
  4650 12001-CHECK-NC-NET.
  4651
  4652     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  4653        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4654        (CP-EARN-AS-NET-PAY)
  4655        NEXT SENTENCE
  4656     ELSE
  4657        GO TO 12001-CHECK-NC-NET-PLUS3.
  4658
  4659      COMPUTE ANGLEN EQUAL WK1 / I.
  4660      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4661
  4662      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  4663          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  4664          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  4665          N * (CP-PREMIUM-RATE / 1000)).
  4666
  4667      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  4668          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  4669
  4670      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  4671          ((N - ANGLEN) / I + 3) / ANGLEN) /
  4672          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  4673          (ANGLEN * 2))
  4674
  4675      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  4676
  4677      IF ANGLEN IS NOT LESS THAN WK7
  4678          COMPUTE CP-PREMIUM-RATE ROUNDED =
  4679              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  4680          COMPUTE WK3 ROUNDED =
  4681              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  4682
  4683     MOVE WK3 TO CP-CALC-PREMIUM.
  4684
  4685     GO TO 99999-RETURN.
  4686
  4687 12001-CHECK-NC-NET-PLUS3.
  4688
  4689     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4690        (CP-EARN-AS-NET-PAY) AND
  4691        (CP-COMPANY-ID NOT = 'CID' AND 'DCC')
  4692        NEXT SENTENCE
  4693     ELSE
  4694        GO TO 12001-CHECK-CA.
  4695
  4696     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  4697     MOVE ' ' TO DC-OPTION-CODE.
  4698     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  4699
  4700     IF DATE-CONVERSION-ERROR
  4701        MOVE '2'                 TO CP-RETURN-CODE
  4702        MOVE ZEROS               TO FACTOR
  4703                                    CP-CALC-PREMIUM
  4704         GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  87
* ELRATE.cbl
  4705
  4706     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  4707        NEXT SENTENCE
  4708     ELSE
  4709        GO TO 12001-CONTINUE-NET.
  4710
  4711     COMPUTE ANGLEN EQUAL WK1 / I.
  4712     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4713
  4714     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  4715
  4716     COMPUTE NC-R = 20 *
  4717                    ((NC-LR * ORIGINAL-TERM) / 12)
  4718                          / (ORIGINAL-TERM + 1).
  4719
  4720     COMPUTE NC-OB = NC-R / 1000.
  4721
  4722     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  4723                    (NC-OB * ORIGINAL-TERM * 3).
  4724
  4725     IF CP-EXT-CHG-LF
  4726         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  4727     ELSE
  4728         MOVE 30                 TO  NC-BIG-D.
  4729
  4730     COMPUTE NC-LITTLE-D = (1 + I) /
  4731             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  4732
  4733     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  4734             (ANGLEN * NC-LITTLE-D ).
  4735
  4736     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  4737
  4738     GO TO 99999-RETURN.
  4739
  4740 12001-CHECK-CA.
  4741
  4742     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4743        (WS-DISCOUNT-OPTION = '6')
  4744        NEXT SENTENCE
  4745     ELSE
  4746        GO TO 12001-CHECK-GTL-IA.
  4747
  4748     COMPUTE CA-J = CA-DISCOUNT / 12.
  4749     COMPUTE ANGLEN EQUAL WK1 / I.
  4750     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4751     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4752     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4753     COMPUTE CA-VI = (1 + I)** -1.
  4754     COMPUTE CP-CALC-PREMIUM =
  4755         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4756         ((1 + CA-J) / I) *
  4757         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4758         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4759         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4760
  4761     GO TO 99999-RETURN.
  4762
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  88
* ELRATE.cbl
  4763 12001-CHECK-GTL-IA.
  4764
  4765     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4766        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4767        (CP-EARN-AS-NET-PAY)
  4768        NEXT SENTENCE
  4769     ELSE
  4770        GO TO 12001-CHECK-CID-TRN-VA.
  4771
  4772***************************************************************
  4773
  4774     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  4775
  4776     IF GTL-IA-ODD-DAYS = ZEROS
  4777         MOVE ZERO               TO  GTL-IA-SGN
  4778     ELSE
  4779         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  4780             MOVE +1             TO  GTL-IA-SGN
  4781         ELSE
  4782             MOVE -1             TO  GTL-IA-SGN.
  4783
  4784     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  4785     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  4786
  4787     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  4788                          GTL-IA-SGN.
  4789
  4790     COMPUTE ANGLEN EQUAL WK1 / I.
  4791     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4792
  4793     IF GTL-IA-ODF NOT = ZERO
  4794         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  4795         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  4796
  4797     COMPUTE GTL-IA-DIVIDEND =
  4798           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  4799                             (ANGLEN - ANGLEN-M))) *
  4800           ((K1 + I) * CP-PREMIUM-RATE *
  4801                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  4802
  4803     COMPUTE GTL-IA-DIVISOR =
  4804      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  4805
  4806     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  4807
  4808     COMPUTE CP-CALC-PREMIUM =
  4809                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  4810     GO TO 99999-RETURN.
  4811
  4812
  4813 12001-CHECK-CID-TRN-VA.
  4814
  4815     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4816        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  4817        (CP-EARN-AS-NET-PAY) AND
  4818        (CP-TRUNCATED-LIFE) AND
  4819        (CP-STATE-STD-ABBRV = CP-STATE)
  4820        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  89
* ELRATE.cbl
  4821     ELSE
  4822        GO TO 12001-CHECK-CID-TX
  4823     END-IF
  4824
  4825     COMPUTE ANGLEN EQUAL WK1 / I
  4826     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4827     IF WS-WORK-DIS-RATE = ZEROS
  4828        CONTINUE
  4829     ELSE
  4830        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4831        COMPUTE WK7 = (1 / I) *
  4832              (((WK4 ** M - 1) / (WK4 - 1)) -
  4833              ((WK4 ** M * SX - VX) /
  4834              (WK4 * (1 + I) - 1))) *
  4835              (CP-PREMIUM-RATE / 1000)
  4836        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4837        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4838        COMPUTE CP-CALC-PREMIUM =
  4839           WK8 *  ((WK4 * ANGLEN) / 100)
  4840     END-IF
  4841
  4842     GO TO 99999-RETURN
  4843
  4844     .
  4845
  4846 12001-CHECK-CID-TX.
  4847     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4848        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4849        (CP-EARN-AS-NET-PAY) AND
  4850        (WS-WORK-DIS-RATE > ZEROS) AND
  4851        (CP-STATE-STD-ABBRV = CP-STATE)
  4852        CONTINUE
  4853     ELSE
  4854        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4855     END-IF
  4856* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4857     COMPUTE K-I = 1 + (1 * I)
  4858     COMPUTE ANGLEN EQUAL WK1 / I
  4859     COMPUTE ANGLEM EQUAL WK2 / I
  4860     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4861     IF WS-WORK-DIS-RATE = ZEROS
  4862        CONTINUE
  4863     ELSE
  4864        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4865        COMPUTE WK7 = (K-I / I) *
  4866              (((WK4 ** M - 1) / (WK4 - 1)) -
  4867*             ((WK4 ** M * SX - VX) /
  4868              ((WK4 ** M * SX) - VX) /
  4869*             (WK4 * (1 + I) - 1))) *
  4870              (WK4 * (1 + I) - 1)) *
  4871              (CP-PREMIUM-RATE / 1000)
  4872        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4873        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4874        COMPUTE CP-CALC-PREMIUM =
  4875           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4876     END-IF
  4877
  4878     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  90
* ELRATE.cbl
  4879     .
  4880 12001-CHECK-CID-LEV-MN-NEW.
  4881*    IF (CP-COMPANY-ID EQUAL 'CID')
  4882*       AND (CP-STATE-STD-ABBRV = 'MN')
  4883*       AND (CP-EARN-AS-NET-PAY)
  4884*       AND (CP-LEVEL-LIFE)
  4885*       AND (CP-CERT-EFF-DT > X'A4FF')
  4886*       CONTINUE
  4887*    ELSE
  4888*       GO TO 12001-CHECK-CID-LEV-MN
  4889*    END-IF
  4890*
  4891*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4892*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4893*    MOVE '1'                    TO DC-OPTION-CODE
  4894*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4895*
  4896*    IF DATE-CONVERSION-ERROR
  4897*       MOVE '2'                 TO CP-RETURN-CODE
  4898*       MOVE ZEROS               TO FACTOR
  4899*                                   CP-CALC-PREMIUM
  4900*       GO TO 99999-RETURN
  4901*    END-IF
  4902*
  4903*    COMPUTE I = CP-LOAN-APR / 100
  4904*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4905*
  4906*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4907*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4908*      * 12 / 360 * D)
  4909*
  4910*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4911*       * 12 / 360 * D
  4912*
  4913*    GO TO 99999-RETURN
  4914      .
  4915 12001-CHECK-CID-LEV-MN.
  4916
  4917     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4918        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4919        (CP-EARN-AS-NET-PAY) AND
  4920        (CP-LEVEL-LIFE) AND
  4921        (CP-STATE-STD-ABBRV = CP-STATE)
  4922        CONTINUE
  4923     ELSE
  4924        GO TO 12001-CHECK-CID-LEV-CA
  4925     END-IF
  4926
  4927     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4928         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4929         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4930
  4931     GO TO 99999-RETURN
  4932
  4933      .
  4934 12001-CHECK-CID-LEV-CA.
  4935
  4936     IF (CP-COMPANY-ID EQUAL 'CID')     AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  91
* ELRATE.cbl
  4937        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4938        (CP-EARN-AS-NET-PAY) AND
  4939        (CP-LEVEL-LIFE) AND
  4940        (CP-STATE-STD-ABBRV = CP-STATE)
  4941        CONTINUE
  4942     ELSE
  4943        GO TO 12001-CHECK-CID-TRN-CA
  4944     END-IF
  4945
  4946     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4947     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4948     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4949     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4950     COMPUTE CP-CALC-PREMIUM =
  4951          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4952          (CP-PREMIUM-RATE / 1000)) /
  4953          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4954
  4955     GO TO 99999-RETURN
  4956
  4957      .
  4958 12001-CHECK-CID-TRN-CA.
  4959
  4960     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4961        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4962        (CP-EARN-AS-NET-PAY) AND
  4963        (CP-TRUNCATED-LIFE) AND
  4964        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4965        (WS-DISCOUNT-OPTION NOT = ' ')
  4966        CONTINUE
  4967     ELSE
  4968        GO TO 12001-CHECK-CID-TRN-MT
  4969     END-IF
  4970
  4971     COMPUTE ANGLEN EQUAL WK1 / I
  4972     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4973     IF WS-WORK-DIS-RATE = ZEROS
  4974        CONTINUE
  4975     ELSE
  4976        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4977        COMPUTE WK7 = (1 / I) *
  4978              (((WK4 ** M - 1) / (WK4 - 1)) -
  4979              ((WK4 ** M * SX - VX) /
  4980              (WK4 * (1 + I) - 1))) *
  4981              (CP-PREMIUM-RATE / 1000)
  4982        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4983        COMPUTE CP-CALC-PREMIUM =
  4984           WK4 *  WK7
  4985     END-IF
  4986
  4987     GO TO 99999-RETURN
  4988
  4989      .
  4990 12001-CHECK-CID-TRN-MT.
  4991
  4992     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4993        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4994                   OR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  92
* ELRATE.cbl
  4995        ((CP-STATE-STD-ABBRV = 'IN') AND
  4996        (CP-CERT-EFF-DT > X'9A7F'))
  4997                   OR
  4998        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4999        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5000        (CP-EARN-AS-NET-PAY) AND
  5001        (CP-TRUNCATED-LIFE) AND
  5002        (CP-STATE-STD-ABBRV = CP-STATE)
  5003        CONTINUE
  5004     ELSE
  5005        GO TO 12001-CHECK-CID-MT
  5006     END-IF
  5007
  5008* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5009     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5010        MOVE 0                   TO K-I
  5011     ELSE
  5012        MOVE 2                   TO K-I
  5013     END-IF
  5014     COMPUTE CP-TERM-OR-EXT-DAYS =
  5015           CP-TERM-OR-EXT-DAYS + 30
  5016
  5017     COMPUTE ANGLEN EQUAL WK1 / I
  5018     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5019     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5020                   / (1 + I)
  5021     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5022     IF WS-WORK-DIS-RATE = ZEROS
  5023        CONTINUE
  5024     ELSE
  5025        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5026*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5027        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5028              (((WK4 ** M - 1) / (WK4 - 1)) -
  5029              ((WK4 ** M * SX - VX) /
  5030              (WK4 * (1 + I) - 1))) *
  5031              (CP-PREMIUM-RATE / 1000)
  5032        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5033*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5034        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5035        COMPUTE CP-CALC-PREMIUM =
  5036           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5037*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5038     END-IF
  5039
  5040     GO TO 99999-RETURN
  5041
  5042     .
  5043 12001-CHECK-CID-MT.
  5044
  5045     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5046        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5047                                OR 'VT')
  5048                   OR
  5049        ((CP-STATE-STD-ABBRV = 'IN') AND
  5050        (CP-CERT-EFF-DT > X'9A7F'))
  5051                   OR
  5052        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  93
* ELRATE.cbl
  5053        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5054        (CP-EARN-AS-NET-PAY) AND
  5055        (CP-STATE-STD-ABBRV = CP-STATE)
  5056        CONTINUE
  5057     ELSE
  5058        GO TO 12001-CHECK-DCC-DD
  5059     END-IF
  5060
  5061     COMPUTE CP-TERM-OR-EXT-DAYS =
  5062           CP-TERM-OR-EXT-DAYS + 30
  5063
  5064* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5065     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5066        MOVE 0                   TO K-I
  5067     ELSE
  5068        IF CP-STATE-STD-ABBRV = 'NJ'
  5069           MOVE 1                TO K-I
  5070        ELSE
  5071           MOVE 2                TO K-I
  5072        END-IF
  5073     END-IF
  5074     COMPUTE ANGLEN EQUAL WK1 / I
  5075     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5076     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5077                   / (1 + I)
  5078     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5079     IF WS-WORK-DIS-RATE = ZEROS
  5080        CONTINUE
  5081     ELSE
  5082        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5083*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5084        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5085              (((WK4 ** N - 1) / (WK4 - 1)) -
  5086              ((WK4 ** N - SV) /
  5087              (WK4 * (1 + I) - 1))) *
  5088              (CP-PREMIUM-RATE / 1000)
  5089        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5090*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5091        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5092        COMPUTE CP-CALC-PREMIUM =
  5093           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5094*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5095     END-IF
  5096
  5097     GO TO 99999-RETURN
  5098
  5099     .
  5100 12001-CHECK-DCC-DD.
  5101     IF (CP-COMPANY-ID EQUAL 'DCC')
  5102        AND (CP-EARN-AS-NET-PAY)
  5103        AND (CP-BEN-CATEGORY = 'D')
  5104        CONTINUE
  5105     ELSE
  5106        GO TO 12001-CHECK-DCC-NET
  5107     END-IF
  5108
  5109     COMPUTE CP-TERM-OR-EXT-DAYS =
  5110           CP-TERM-OR-EXT-DAYS + 30
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  94
* ELRATE.cbl
  5111
  5112     COMPUTE ANGLEN EQUAL WK1 / I.
  5113     COMPUTE ANGLEM EQUAL WK2 / I.
  5114     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5115
  5116     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5117           / (1 + I)
  5118     COMPUTE GR     = ANGLEN / ODF
  5119*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5120*      CP-RATE-DEV-PCT
  5121     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5122     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5123       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5124     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5125     MOVE WK3                    TO CP-CALC-PREMIUM
  5126
  5127     GO TO 99999-RETURN
  5128
  5129     .
  5130 12001-CHECK-DCC-NET.
  5131
  5132     IF (CP-COMPANY-ID EQUAL 'DCC')
  5133        AND (CP-EARN-AS-NET-PAY)
  5134        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5135             AND 'H' AND 'S' AND 'P')
  5136        CONTINUE
  5137     ELSE
  5138        GO TO 12001-CHECK-DCC-PNET
  5139     END-IF
  5140
  5141     COMPUTE CP-TERM-OR-EXT-DAYS =
  5142           CP-TERM-OR-EXT-DAYS + 30
  5143
  5144     COMPUTE ANGLEN EQUAL WK1 / I.
  5145     COMPUTE ANGLEM EQUAL WK2 / I.
  5146     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5147
  5148     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5149           / (1 + I)
  5150     COMPUTE GR     = ANGLEN / ODF
  5151     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5152     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5153       CP-RATE-DEV-PCT
  5154     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5155*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5156
  5157     COMPUTE WK8 = CP-PREMIUM-RATE *
  5158        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5159     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5160     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5161     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5162       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5163     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5164     MOVE WK3                    TO CP-CALC-PREMIUM
  5165
  5166     GO TO 99999-RETURN
  5167
  5168     .
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  95
* ELRATE.cbl
  5169 12001-CHECK-DCC-PNET.
  5170     IF (CP-COMPANY-ID EQUAL 'DCC')
  5171        AND (CP-EARN-AS-NET-PAY)
  5172        AND (CP-BENEFIT-CD (1:1) = 'P')
  5173        CONTINUE
  5174     ELSE
  5175        GO TO 12001-CHECK-DCC-MNET
  5176     END-IF
  5177     IF CP-NO-OF-PMTS NOT NUMERIC
  5178        MOVE +0                  TO CP-NO-OF-PMTS
  5179     END-IF
  5180     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5181        AND ' ' AND 'M'
  5182        MOVE ' '                 TO CP-PMT-MODE
  5183     END-IF
  5184     EVALUATE CP-PMT-MODE
  5185        WHEN 'W'
  5186           MOVE +7               TO C-DAYS-IN-PMT-PER
  5187           MOVE +52              TO C-PMTS-PER-YEAR
  5188           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  5189        WHEN 'B'
  5190           MOVE +14              TO C-DAYS-IN-PMT-PER
  5191           MOVE +26              TO C-PMTS-PER-YEAR
  5192           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  5193        WHEN OTHER
  5194           MOVE +30              TO C-DAYS-IN-PMT-PER
  5195           MOVE +12              TO C-PMTS-PER-YEAR
  5196           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  5197     END-EVALUATE
  5198     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5199     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5200        C-DAYS-IN-PMT-PER)) / (1 + I)
  5201     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5202     COMPUTE ANGLEN-1 = ANGLEN / Y
  5203     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5204     IF CP-RATE-DEV-PCT NOT = ZEROS
  5205        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5206           CP-PREMIUM-RATE
  5207     END-IF
  5208     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5209     GO TO 99999-RETURN
  5210     .
  5211 12001-CHECK-DCC-MNET.
  5212
  5213     IF (CP-COMPANY-ID EQUAL 'DCC')
  5214        AND (CP-EARN-AS-NET-PAY)
  5215        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5216        CONTINUE
  5217     ELSE
  5218        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5219     END-IF
  5220
  5221*    COMPUTE ANGLEN EQUAL WK1 / I.
  5222*    COMPUTE ANGLEM EQUAL WK2 / I.
  5223*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5224
  5225     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5226     MOVE WK3                    TO CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  96
* ELRATE.cbl
  5227
  5228     GO TO 99999-RETURN
  5229
  5230     .
  5231 12001-CHECK-DCC-MNET-LF-BAL.
  5232
  5233     IF (CP-COMPANY-ID EQUAL 'DCC')
  5234        AND (CP-EARN-AS-NET-PAY)
  5235        AND (CP-BENEFIT-CD (1:1) = 'N')
  5236        AND (CP-BEN-CATEGORY NOT = 'N')
  5237        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5238        CONTINUE
  5239     ELSE
  5240        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5241     END-IF
  5242
  5243     IF CP-RATE-DEV-PCT NOT = ZEROS
  5244        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5245           CP-PREMIUM-RATE
  5246     END-IF
  5247*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5248     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5249        / (1 + I)
  5250     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5251     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5252     COMPUTE WK2 = (1 + J) ** (M * -1)
  5253     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5254     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5255          ** ((M - 1) * -1))) / J)
  5256     COMPUTE ANGLEM = ((1 - ((1 + J)
  5257          ** (M * -1))) / J) / OD
  5258     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5259        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5260        / ANGLEM-1
  5261     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5262          ** ((N - M) * -1))) / I)
  5263     MOVE +0                     TO WK3
  5264     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5265        (WS-COUNTER > M)
  5266        COMPUTE ANGLEM = (1 - ((1 + J)
  5267          ** ((M - WS-COUNTER) * -1))) / J
  5268        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5269        COMPUTE WK5-CSL = (RA * ANGLEM)
  5270        + (CP-ALTERNATE-BENEFIT * WK2)
  5271        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5272     END-PERFORM
  5273     MOVE WK3                    TO CP-CALC-PREMIUM
  5274
  5275     GO TO 99999-RETURN
  5276
  5277     .
  5278 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5279
  5280     IF (CP-COMPANY-ID EQUAL 'DCC')
  5281        AND (CP-EARN-AS-NET-PAY)
  5282        AND (CP-BENEFIT-CD (1:1) = 'S')
  5283        AND (CP-BEN-CATEGORY NOT = 'N')
  5284        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  97
* ELRATE.cbl
  5285        CONTINUE
  5286     ELSE
  5287        GO TO 12001-CHECK-DCC-MNET-LF
  5288     END-IF
  5289
  5290     IF CP-RATE-DEV-PCT NOT = ZEROS
  5291        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5292           CP-PREMIUM-RATE
  5293     END-IF
  5294     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5295     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5296          ** ((M - 1) * -1))) / K)
  5297     COMPUTE ANGLEM = ((1 - ((1 + K)
  5298          ** (M * -1))) / K)
  5299     MOVE CP-MONTHLY-PAYMENT     TO RA
  5300     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5301        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5302        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5303        CP-PREMIUM-RATE / 1000
  5304     MOVE WK3                    TO CP-CALC-PREMIUM
  5305
  5306     GO TO 99999-RETURN
  5307
  5308     .
  5309 12001-CHECK-DCC-MNET-LF.
  5310
  5311     IF (CP-COMPANY-ID EQUAL 'DCC')
  5312        AND (CP-EARN-AS-NET-PAY)
  5313        AND (CP-BENEFIT-CD (1:1) = 'N')
  5314        AND (CP-BEN-CATEGORY NOT = 'N')
  5315        CONTINUE
  5316     ELSE
  5317        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5318     END-IF
  5319
  5320     IF CP-RATE-DEV-PCT NOT = ZEROS
  5321        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5322           CP-PREMIUM-RATE
  5323     END-IF
  5324*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5325     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5326        / (1 + I)
  5327     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5328     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5329     COMPUTE WK2 = (1 + J) ** (M * -1)
  5330     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5331     COMPUTE ANGLEM = ((1 - ((1 + J)
  5332          ** (M * -1))) / J) / OD
  5333     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5334     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5335          ** ((N - M) * -1))) / I)
  5336     MOVE +0                     TO WK3
  5337     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5338        (WS-COUNTER > M)
  5339        COMPUTE ANGLEM = (1 - ((1 + J)
  5340          ** ((M - WS-COUNTER + 1) * -1))) / J
  5341        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5342        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  98
* ELRATE.cbl
  5343        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5344     END-PERFORM
  5345     MOVE WK3                    TO CP-CALC-PREMIUM
  5346
  5347     GO TO 99999-RETURN
  5348
  5349     .
  5350 12001-CHECK-DCC-MNET-SUMLF.
  5351
  5352     IF (CP-COMPANY-ID EQUAL 'DCC')
  5353        AND (CP-EARN-AS-NET-PAY)
  5354        AND (CP-BENEFIT-CD (1:1) = 'S')
  5355        AND (CP-BEN-CATEGORY NOT = 'N')
  5356        CONTINUE
  5357     ELSE
  5358        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5359     END-IF
  5360
  5361     IF CP-RATE-DEV-PCT NOT = ZEROS
  5362        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5363           CP-PREMIUM-RATE
  5364     END-IF
  5365     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5366     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5367        / (1 + K)
  5368     COMPUTE ANGLEN-M = (WK5 / I)
  5369     COMPUTE WK2 = (1 + K) ** (M * -1)
  5370     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5371     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5372     COMPUTE ANGLEM = ((1 - ((1 + K)
  5373          ** (M * -1))) / K) / Y
  5374     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5375     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5376        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5377        - 1)) / K) * RA
  5378     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5379        + (CP-DAYS-TO-1ST-PMT - +30)
  5380        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5381        +0 / 1000 * 12 / 12)
  5382     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5383        * (12 / 12)
  5384     MOVE WK3                    TO CP-CALC-PREMIUM
  5385
  5386     GO TO 99999-RETURN
  5387
  5388     .
  5389 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5390
  5391     IF (CP-COMPANY-ID EQUAL 'DCC')
  5392        AND (CP-EARN-AS-NET-PAY)
  5393        AND (CP-BENEFIT-CD (1:1) = 'N')
  5394        AND (CP-BEN-CATEGORY = 'N')
  5395        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5396        CONTINUE
  5397     ELSE
  5398        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5399     END-IF
  5400
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  99
* ELRATE.cbl
  5401*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5402     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5403        / (1 + I)
  5404     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5405     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5406     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5407     COMPUTE WK2 = (1 + J) ** (M * -1)
  5408     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5409     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5410          ** ((M - 1) * -1))) / J)
  5411     COMPUTE ANGLEM = ((1 - ((1 + J)
  5412          ** (M * -1))) / J) / OD
  5413     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5414        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5415        / ANGLEM-1
  5416     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5417          ** ((N - M) * -1))) / I)
  5418     MOVE +0                     TO WK3
  5419     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5420        (WS-COUNTER > M)
  5421        COMPUTE ANGLEM = (1 - ((1 + J)
  5422          ** ((M - WS-COUNTER) * -1))) / J
  5423        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5424        COMPUTE WK5-CSL = (RA * ANGLEM)
  5425        + (CP-ALTERNATE-BENEFIT * WK2)
  5426        COMPUTE WK3 = WK3 +
  5427         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5428        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5429          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5430          (CP-DCC-AH-RATE / 1000)
  5431     END-PERFORM
  5432     MOVE WK3                    TO CP-CALC-PREMIUM
  5433
  5434     GO TO 99999-RETURN
  5435
  5436     .
  5437 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5438
  5439     IF (CP-COMPANY-ID EQUAL 'DCC')
  5440        AND (CP-EARN-AS-NET-PAY)
  5441        AND (CP-BENEFIT-CD (1:1) = 'S')
  5442        AND (CP-BEN-CATEGORY = 'N')
  5443        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5444        CONTINUE
  5445     ELSE
  5446        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5447     END-IF
  5448
  5449     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5450     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5451          ** ((M - 1) * -1))) / K)
  5452     COMPUTE ANGLEM = ((1 - ((1 + K)
  5453          ** (M * -1))) / K)
  5454     MOVE CP-MONTHLY-PAYMENT     TO RA
  5455     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5456        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5457        * CP-DCC-AH-RATE / 1000))
  5458        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 100
* ELRATE.cbl
  5459        CP-DCC-LF-RATE / 1000
  5460     MOVE WK3                    TO CP-LF-PREM
  5461     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5462        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5463        * CP-DCC-AH-RATE / 1000
  5464     COMPUTE WK3 = WK3 + WK5-CSL
  5465     MOVE WK3                    TO CP-CALC-PREMIUM
  5466
  5467     GO TO 99999-RETURN
  5468      .
  5469 12001-CHECK-DCC-MNET-TOT-N.
  5470
  5471     IF (CP-COMPANY-ID EQUAL 'DCC')
  5472        AND (CP-EARN-AS-NET-PAY)
  5473        AND (CP-BENEFIT-CD (1:1) = 'N')
  5474        AND (CP-BEN-CATEGORY = 'N')
  5475        CONTINUE
  5476     ELSE
  5477        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5478     END-IF
  5479
  5480*    I = APR/1200
  5481*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5482*    RA = PAYMENT AMOUNT
  5483*    WK5-CSL = THE BALANCE (PAY OFF )
  5484*    WK3 = THE ACCUMULATED PREMIUM
  5485*    WK2 = (1 + I) ^ (m * -1)
  5486*    OD  = GAMMA
  5487*
  5488*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5489     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5490        / (1 + I)
  5491     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5492     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5493        (CP-DCC-AH-RATE / +1000)
  5494     COMPUTE WK2 = (1 + J) ** (M * -1)
  5495     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5496     COMPUTE ANGLEM = ((1 - ((1 + J)
  5497          ** (M * -1))) / J) / OD
  5498     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5499     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5500          ** ((N - M) * -1))) / I)
  5501     MOVE +0                     TO WK3
  5502     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5503        (WS-COUNTER > M)
  5504        COMPUTE ANGLEM = (1 - ((1 + J)
  5505          ** ((M - WS-COUNTER + 1) * -1))) / J
  5506        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5507        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5508        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5509           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5510     END-PERFORM
  5511     MOVE WK3                    TO CP-CALC-PREMIUM
  5512
  5513     GO TO 99999-RETURN
  5514
  5515     .
  5516 12001-CHECK-DCC-MNET-TOT-S.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 101
* ELRATE.cbl
  5517
  5518     IF (CP-COMPANY-ID EQUAL 'DCC')
  5519        AND (CP-EARN-AS-NET-PAY)
  5520        AND (CP-BENEFIT-CD (1:1) = 'S')
  5521        AND (CP-BEN-CATEGORY = 'N')
  5522        CONTINUE
  5523     ELSE
  5524        GO TO 12001-CONTINUE-NET
  5525     END-IF
  5526
  5527*    I = APR/1200
  5528*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5529*    RA = PAYMENT AMOUNT
  5530*    WK5-CSL = THE BALANCE (PAY OFF )
  5531*    WK3 = THE ACCUMULATED PREMIUM
  5532*    WK2 = (1 + I) ^ (m * -1)
  5533*    OD  = GAMMA
  5534*
  5535     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5536     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5537        / (1 + J)
  5538     COMPUTE ANGLEM = ((1 - ((1 + J)
  5539          ** (M * -1))) / J) / OD
  5540     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5541          ** ((N - M) * -1))) / I)
  5542          * (1 + J) ** (-1 * M)
  5543     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5544     MOVE CP-MONTHLY-PAYMENT     TO RA
  5545     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5546        / +30)
  5547     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5548        ** (WK1) - 1)) / J) * RA
  5549     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5550        + (CP-DAYS-TO-1ST-PMT - +30)
  5551        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5552        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5553     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5554        (12 / 12)
  5555     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5556        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5557        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5558     COMPUTE WK3 = WK3 + WK5-CSL
  5559     MOVE WK3                    TO CP-CALC-PREMIUM
  5560     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5561     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5562        / (1 + K)
  5563     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5564          ** ((N - M) * -1))) / I)
  5565     COMPUTE WK2 = (1 + K) ** (M * -1)
  5566     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5567     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5568     COMPUTE ANGLEM = ((1 - ((1 + K)
  5569          ** (M * -1))) / K) / Y
  5570*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5571     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5572        ((1 + K) ** (M + 1 / Y
  5573        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5574        - 1)) / K) * RA
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 102
* ELRATE.cbl
  5575     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5576        + (CP-DAYS-TO-1ST-PMT - +30)
  5577        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5578        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5579     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5580        * (12 / 12)
  5581     MOVE WK3                    TO CP-LF-PREM
  5582
  5583     GO TO 99999-RETURN
  5584
  5585     .
  5586 12001-CONTINUE-NET.
  5587
  5588     IF NET-STD
  5589        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  5590*          OR 'DCC'
  5591         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5592         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5593         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5594         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5595                               * ((1 + N) / (1 + M))
  5596        ELSE
  5597         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5598         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5599         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5600         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  5601
  5602     IF NET-SMP
  5603         COMPUTE N2 = N * N
  5604         COMPUTE N3 = N2 * N
  5605         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  5606         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  5607         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  5608         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  5609         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  5610
  5611     IF NPO-PRUDENTIAL
  5612       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  5613           VARYING WS-COUNTER FROM 1 BY 1
  5614               UNTIL WS-COUNTER = N
  5615       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  5616       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  5617
  5618     MOVE WK3 TO FACTOR.
  5619
  5620     GO TO 99999-RETURN.
  5621
  5622 12100-PRU-CALC.
  5623     IF WS-COUNTER = 1
  5624         COMPUTE PWK = (I + 1)
  5625     ELSE
  5626         COMPUTE PWK = PWK * (I + 1).
  5627
  5628 12199-EXIT.
  5629      EXIT.
  5630
  5631 99000-ERROR.
  5632     MOVE +9999.999999999 TO N-P-FACTOR.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 103
* ELRATE.cbl
  5633     MOVE '4'             TO CP-RETURN-CODE.
  5634
  5635     GO TO 99999-EXIT.
  5636
  5637 99999-RETURN.
  5638     MOVE FACTOR          TO N-P-FACTOR.
  5639
  5640 99999-EXIT.
  5641      EXIT.
  5642 99999-DUMMY-STOP-RUN.
  5643
  5644* GOBACK.
  5645     MOVE '9%                    "   ' TO DFHEIV0
  5646     MOVE 'ELRATE' TO DFHEIV1
  5647     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5648     GOBACK.
  5649
  5650
  5651 9999-DFHBACK SECTION.
  5652     MOVE '9%                    "   ' TO DFHEIV0
  5653     MOVE 'ELRATE' TO DFHEIV1
  5654     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5655     GOBACK.
  5656 9999-DFHEXIT.
  5657     IF DFHEIGDJ EQUAL 0001
  5658         NEXT SENTENCE
  5659     ELSE IF DFHEIGDJ EQUAL 2
  5660         GO TO 9999-RATE-NOTFND,
  5661               9999-RATE-NOTOPEN,
  5662               9999-RATE-NOTFND
  5663         DEPENDING ON DFHEIGDI.
  5664     MOVE '9%                    "   ' TO DFHEIV0
  5665     MOVE 'ELRATE' TO DFHEIV1
  5666     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5667     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        2556     Code:       48989
