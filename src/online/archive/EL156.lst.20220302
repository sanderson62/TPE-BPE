* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65* 102617    2017101800003  TANA  Fix family leave auth level
    66* 022718    2017100200004  TANA  Set hold & pays > than 30 days
    67* 031218    2018030800002  TANA  Handle offline pmts w/ hold & pay
    68* 082218  CR2018051400001  TANA  Hold and Pay
    69* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    70* 112018  CR2018102900001  TANA  REQUIRE EOB NOTE STARTING WITH F
    71* 040819  IR2019030400004  TANA  ADD EDITS FOR HOLD AND PAY
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page   3
* EL156.cbl
    72* 043019  IR2019041900001  TANA  Correct total claim pymts msg
    73* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    74******************************************************************
    75
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page   4
* EL156.cbl
    77 ENVIRONMENT DIVISION.
    78
    79 DATA DIVISION.
    80
    81 WORKING-STORAGE SECTION.
    82 01  DFH-START PIC X(04).
    83
    84 77  FILLER  PIC X(32)  VALUE '********************************'.
    85 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    86 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    87 77  WS-SSN  PIC X(9) VALUE ZEROS.
    88 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    89 77  C0                          PIC S999 COMP-3 VALUE +0.
    90 77  C1                          PIC S999 COMP-3 VALUE +0.
    91 77  C2                          PIC S999 COMP-3 VALUE +0.
    92 77  C3                          PIC S999 COMP-3 VALUE +0.
    93 77  s1                          PIC S999 COMP-3 VALUE +0.
    94 77  s2                          pic s999 comp-3 value +0.
    95 77  P1                          PIC S999 COMP-3 VALUE +0.
    96 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    97 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    98 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    99 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   100 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   101 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   102 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   103 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   104 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
   105 77  ws-max-bens                 pic s999 comp-3 value +0.
   106 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
   107 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
   108 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   109 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   110 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   111 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   112
   113*    COPY ELCSCTM.
   114******************************************************************
   115*                                                                *
   116*                                                                *
   117*                            ELCSCTM                             *
   118*                            VMOD=2.001                          *
   119*                                                                *
   120*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   121*                                                                *
   122******************************************************************
   123 01  SECURITY-MESSAGE.
   124     12  FILLER                          PIC X(30)
   125            VALUE '** LOGIC SECURITY VIOLATION -'.
   126     12  SM-READ                         PIC X(6).
   127     12  FILLER                          PIC X(5)
   128            VALUE ' PGM='.
   129     12  SM-PGM                          PIC X(6).
   130     12  FILLER                          PIC X(5)
   131            VALUE ' OPR='.
   132     12  SM-PROCESSOR-ID                 PIC X(4).
   133     12  FILLER                          PIC X(6)
   134            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page   5
* EL156.cbl
   135     12  SM-TERMID                       PIC X(4).
   136     12  FILLER                          PIC XX   VALUE SPACE.
   137     12  SM-JUL-DATE                     PIC 9(5).
   138     12  FILLER                          PIC X    VALUE SPACE.
   139     12  SM-TIME                         PIC 99.99.
   140
   141
   142*    COPY ELCSCRTY.
   143******************************************************************
   144*                                                                *
   145*                                                                *
   146*                            ELCSCRTY                            *
   147*                            VMOD=2.001                          *
   148*                                                                *
   149*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   150*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   151*        SAVED IN PI-SECURITY-ADDRESS.                           *
   152*                                                                *
   153******************************************************************
   154 01  SECURITY-CONTROL.
   155     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   156     12  FILLER                       PIC XX    VALUE 'SC'.
   157     12  SC-CREDIT-CODES.
   158         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   159             20  SC-CREDIT-DISPLAY    PIC X.
   160             20  SC-CREDIT-UPDATE     PIC X.
   161     12  SC-CLAIMS-CODES.
   162         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   163             20  SC-CLAIMS-DISPLAY    PIC X.
   164             20  SC-CLAIMS-UPDATE     PIC X.
   165
   166 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   167 01  WS-DATE-AREA.
   168     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   169     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   170     12  SAVE-DATE-CCYYMMDD.
   171         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   172         16  SAVE-DATE-YMD.
   173             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   174             20  FILLER              PIC X(04)   VALUE SPACES.
   175
   176 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   177 01  STANDARD-AREAS.
   178     12  WS-RESPONSE         PIC S9(8)   COMP.
   179         88  WS-RESP-NORMAL              VALUE +00.
   180         88  WS-RESP-ERROR               VALUE +01.
   181         88  WS-RESP-NOTFND              VALUE +13.
   182         88  WS-RESP-DUPREC              VALUE +14.
   183         88  WS-RESP-ENDFILE             VALUE +20.
   184     12  PMT-HEAD-A.
   185         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   186         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   187         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   188-        '     RESERVES  TYPE    AMOUNT'.
   189     12  PMT-HEAD-B.
   190         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   191         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   192         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page   6
* EL156.cbl
   193     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   194     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   195     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   196     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   197     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   198     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   199     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   200     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   201     12  PGM-NAME            PIC X(8).
   202     12  TIME-IN             PIC S9(7).
   203     12  TIME-OUT-R  REDEFINES TIME-IN.
   204         16  FILLER          PIC X.
   205         16  TIME-OUT        PIC 99V99.
   206         16  FILLER          PIC XX.
   207     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   208     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   209     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   210     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   211     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   212     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   213     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   214     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   215     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   216     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   217     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   218     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   219     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   220     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   221     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   222     12  WS-BLANK            PIC X       VALUE ' '.
   223
   224 01  MISC-WORK-AREAS.
   225     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   226     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   227     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   228     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   229     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   230     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   231     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   232     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   233     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   234     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   235     12  W-CALLED-NAME           PIC X(08).
   236     12  W-EOB-CODES.
   237         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   238             20  W-EOB-CODE      PIC XXX.
   239             20  W-EOB-FILLER    PIC X.
   240     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   241     12  W-NAME-LAST             PIC X(15).
   242     12  W-NAME-FIRST            PIC X(15).
   243     12  W-NAME-MIDDLE.
   244         16  FILLER              PIC X.
   245         16  W-NAME-MIDDLE-2     PIC X.
   246         16  FILLER              PIC X(13).
   247     12  W-DMD-CHECK-NO.
   248         16  W-DMD-CHECK-NO-1    PIC X(4).
   249         16  W-DMD-CHECK-NO-2    PIC X.
   250         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page   7
* EL156.cbl
   251
   252     12  WS-COMPUTE-FROM-DT  PIC XX.
   253     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   254     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   255     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   256     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   257     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   258     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   259         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   260         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   261     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   262         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   263     12  WS-UPDATE-SW        PIC X VALUE ' '.
   264     12  WS-GROUPING.
   265         16  WS-GROUP-1      PIC X VALUE SPACES.
   266         16  FILLER          PIC X(05) VALUE SPACES.
   267     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   268     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   269     12  WS-WORK-STATE-ACCT.
   270         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   271         16  FILLER          PIC X       VALUE '/'.
   272         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   273     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   274     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   275     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   276     12  QID.
   277         16  QID-TERM        PIC X(4)    VALUE SPACES.
   278         16  FILLER          PIC X(4)    VALUE '156A'.
   279     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   280     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   281     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   282     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   283     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   284     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   285     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   286     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   287     12  WS-STATUS           PIC X       VALUE SPACES.
   288     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   289     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   290     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   291     12  ws-extended-exp-dt  pic xx      value low-values.
   292     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   293     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   294     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   295     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   296     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   297     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   298     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   299     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   300     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   301     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   302     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   303     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   304     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   305     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   306     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   307     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   308     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page   8
* EL156.cbl
   309     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   310     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   311     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   312     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   313     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   314     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   315     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   316     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   317     12  WORK-DATE-FROM.
   318         16  WDF-MONTH       PIC 99        VALUE ZERO.
   319         16  WDF-DAY         PIC 99        VALUE ZERO.
   320         16  WDF-YEAR        PIC 99        VALUE ZERO.
   321     12  WORK-DATE-THRU.
   322         16  WDT-MONTH       PIC 99        VALUE ZERO.
   323         16  WDT-DAY         PIC 99        VALUE ZERO.
   324         16  WDT-YEAR        PIC 99        VALUE ZERO.
   325     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   326     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   327     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   328     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   329     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   330     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   331     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   332     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   333     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   334     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   335     12  WS-PY-WK REDEFINES WS-PY-WORK.
   336         16  WS-PY-NUM       PIC S9(7)V99.
   337         16  WS-PY-SIGN      PIC X.
   338     12  WS-DY-WORK          PIC S9(5).
   339     12  WS-DY-WK REDEFINES WS-DY-WORK.
   340         16  WS-DY-NUM       PIC S9(4).
   341         16  WS-DY-SIGN      PIC X.
   342     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   343         88  COMP-REC-FOUND              VALUE 'Y'.
   344     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   345         88  BENEFIT-FOUND       VALUE 'Y'.
   346         88  NO-BENEFIT-FOUND    VALUE 'N'.
   347     12  WS-TERMS.
   348         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   349         16  FILLER          PIC X       VALUE '/'.
   350         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   351         16  WST-REM-DAYS-GRP.
   352             20  WST-SLASH   PIC X       VALUE '/'.
   353             20  WST-REM-DAYS
   354                             PIC --9.
   355     12  WS-ACCESS.
   356         16  FILLER          PIC XX      VALUE SPACES.
   357         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   358     12  WS-STATE-ACCESS.
   359         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   360         16  FILLER          PIC XX      VALUE SPACES.
   361     12  WS-CARR-ACCESS.
   362         16  FILLER          PIC X(3)    VALUE SPACES.
   363         16  WS-CARR         PIC X       VALUE SPACES.
   364     12  DATE-WORK.
   365         16  FILLER          PIC XX      VALUE SPACES.
   366         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page   9
* EL156.cbl
   367     12  WS-SAVE-INPUT.
   368         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   369         16  WS-PAYEE        PIC XX      VALUE SPACE.
   370         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   371         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   372         16  WS-OFFLINE      PIC X       VALUE SPACE.
   373         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   374         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   375         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   376         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   377         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   378         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   379         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   380         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   381         16  WS-ETYPE        PIC X       VALUE SPACE.
   382         16  WS-CASH         PIC X       VALUE SPACE.
   383         16  WS-GROUPED      PIC X       VALUE SPACE.
   384         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   385         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   386         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   387         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   388         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   389         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   390         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   391         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   392         16  ws-int-to-rem-borr pic x value spaces.
   393     12  LAST-ERROR-LINE.
   394         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   395         16  FILLER              PIC X(30)
   396             VALUE ' FATAL ERRORS ENCOUNTERED'.
   397         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   398         16  FILLER              PIC X(28)
   399             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   400     12  WS-CHECK-AREA.
   401         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   402         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   403     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   404     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   405         16  FILLER              PIC XX.
   406         16  WS-A-CHECK-NUM-5    PIC 9(5).
   407     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   408         16  FILLER              PIC X.
   409         16  WS-A-CHECK-NUM-6    PIC 9(6).
   410     12  OPTION-1-SAVE-AREA.
   411         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   412         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   413     12  WS-WORK-ZIP.
   414         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   415         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   416     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   417                                 PIC 9(9).
   418     12  WS-FLI-PMTNOTE.
   419         16  WS-PMTOPTION        PIC XX.
   420         16  WS-DOCNAME          PIC X(28).
   421         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   422             20  WS-AMOUNT       PIC X(8).
   423             20  FILLER          PIC X(20).
   424         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  10
* EL156.cbl
   425             20  WS-NUM-AMT      PIC 9(6)V99.
   426             20  FILLER          PIC X(20).
   427
   428     12  WS-HAN-PMTNOTE.
   429         16  WS-HAN-PMT-CODE     PIC X.
   430         16  WS-HAN-PMT-NOTE     PIC X(39).
   431
   432     12  WS-NCL-PMT-OPTION       PIC XX.
   433         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   434
   435     12  WS-CLAIM-SEQUENCE.
   436         16  FILLER              PIC X VALUE '('.
   437         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   438         16  FILLER              PIC X(04) VALUE ' OF '.
   439         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   440         16  FILLER              PIC X VALUE ')'.
   441
   442     12  WS-REFUND-AMT           PIC Z(7).99.
   443     12  WS-CALC-INT             PIC S9(7)V99.
   444     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   445
   446     12  SUB                     PIC 99 VALUE ZEROS.
   447
   448     12  WS-BOANOTE1.
   449         16  WS-BOANOTE1-DESC    PIC X(11).
   450         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   451         16  FILLER              PIC X(17).
   452     12  WS-BOANOTE2.
   453         16  WS-BOANOTE2-DESC    PIC X(11).
   454         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   455         16  FILLER              PIC X(17).
   456
   457     12  WS-NCLNOTE1.
   458         16  WS-NCLNOTE1-DESC    PIC X(11).
   459         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   460         16  FILLER              PIC X(17).
   461     12  WS-NCLNOTE2.
   462         16  WS-NCLNOTE2-DESC    PIC X(11).
   463         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   464         16  FILLER              PIC X(17).
   465
   466     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   467     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   468     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   469     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   470     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   471     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   472     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   473     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   474     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   475     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   476
   477     12  WS-AIG-WORK-AREAS.
   478         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   479             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   480         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   481             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   482         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  11
* EL156.cbl
   483             20  WS-FROM-MO      PIC 99.
   484             20  WS-FROM-DA      PIC 99.
   485             20  WS-FROM-YR      PIC 99.
   486         16  WS-TEMP-DATE-MDY.
   487             20  WS-TEMP-MO      PIC 99.
   488             20  WS-TEMP-DA      PIC 99.
   489             20  WS-TEMP-YR      PIC 99.
   490         16  WS-BIN-FROM-DT      PIC XX.
   491         16  WS-TEMP-INC-MDY.
   492             20  WS-TEMP-INC-MO  PIC 99.
   493             20  WS-TEMP-INC-DA  PIC 99.
   494             20  WS-TEMP-INC-YR  PIC 99.
   495         16  WS-PMT-DUE-MDY.
   496             20  WS-PMT-DUE-MO   PIC 99.
   497             20  WS-PMT-DUE-DA   PIC 99.
   498             20  WS-PMT-DUE-YR   PIC 99.
   499         16  WS-PMT-DUE-DT       PIC XX.
   500         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   501         16  WS-RETRO-ELIM-DT    PIC XX.
   502         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   503             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   504         16  WS-SAVE-DUE-DA      PIC 99.
   505         16  WS-CDAYS            PIC S9(05).
   506         16  WS-DAYS-OFF         PIC S9(05).
   507         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   508             88  ELIM-SATISFIED            VALUE 'Y'.
   509         16  WS-AIG-CHECKNO.
   510             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   511             20  WS-A-CHECKNO-3-7.
   512                 24  FILLER              PIC X(3)    VALUE SPACES.
   513                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   514                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   515         16  WS-AIG-GROUPING.
   516             20  WS-A-BENE               PIC XXX.
   517             20  FILLER                  PIC XXX.
   518         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   519             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   520             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   521         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   522                 VALUE 'UNEMPLOYMENT PAYMENT'.
   523         16  WS-CHK-THRU-DT              PIC XX.
   524         16  WS-HOLD-BIN-DATE-1          PIC XX.
   525
   526 01  MISC-CSO-AREA.
   527     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   528     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   529     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   530         88  APPROVAL-NEEDED                        VALUE 'Y'.
   531     12  WS-APPROV-NOTE                  PIC X(43)
   532         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   533     12  WS-3550-APPROV-NOTE             PIC X(43)
   534         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   535     12  WS-DUPE-APPROV-NOTE             PIC X(43)
   536         VALUE 'APPROVAL NEEDED - DUPLICATE PAYMENT EXISTS '.
   537     12  WS-REAUDIT-NOTE                 PIC X(43)
   538         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   539     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   540     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  12
* EL156.cbl
   541     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   542     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   543     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   544     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   545     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   546         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   547     12  WS-PAYEE-CITY-STATE     PIC X(30).
   548     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   549         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   550     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   551     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   552     12  WS-WORK-NAME            PIC X(30).
   553     12  FILLER  REDEFINES WS-WORK-NAME.
   554         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   555     12  WS-INSURED-NAME         PIC X(30).
   556     12  FILLER  REDEFINES WS-INSURED-NAME.
   557         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   558     12  WS-PAYEE-NAME           PIC X(30).
   559     12  FILLER  REDEFINES WS-PAYEE-NAME.
   560         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   561     12  WS-HOLD-UNTIL-SW        PIC X VALUE SPACES.
   562         88  HOLD-UNTIL-CHK            VALUE 'Y'.
   563         88  HOLD-UNTIL-PMT            VALUE 'P'.
   564     12  WS-HOLD-UNTIL-DT        PIC X(02) VALUE ZERO.
   565     12  WS-UNPAID-HOLD-UNTIL-SW PIC X VALUE SPACES.
   566         88  UNPAID-HOLD-UNTIL-EXISTS  VALUE 'Y'.
   567     12  WS-DUPE-VOID-PMT-SW     PIC X VALUE SPACES.
   568         88  DUPE-VOID-PMT-EXISTS      VALUE 'Y'.
   569     12  WS-CHECK-ALL-PMTS-SW    PIC X VALUE SPACES.
   570         88  CHECK-ALL-PMTS            VALUE 'Y'.
   571     12  WS-TOT-AMOUNT-PAID      PIC S9(7)V99  COMP-3 VALUE ZERO.
   572     12  WS-UNPD-HOLD-UNTIL-DT   PIC X(02) VALUE ZERO.
   573
   574 01  ERROR-MESSAGES.
   575     12  ER-0000                 PIC X(4)  VALUE '0000'.
   576     12  ER-0004                 PIC X(4)  VALUE '0004'.
   577     12  ER-0008                 PIC X(4)  VALUE '0008'.
   578     12  ER-0019                 PIC X(4)  VALUE '0019'.
   579     12  ER-0029                 PIC X(4)  VALUE '0029'.
   580     12  ER-0042                 PIC X(4)  VALUE '0042'.
   581     12  ER-0070                 PIC X(4)  VALUE '0070'.
   582     12  ER-0130                 PIC X(4)  VALUE '0130'.
   583     12  ER-0149                 PIC X(4)  VALUE '0149'.
   584     12  ER-0154                 PIC X(4)  VALUE '0154'.
   585     12  ER-0168                 PIC X(4)  VALUE '0168'.
   586     12  ER-0169                 PIC X(4)  VALUE '0169'.
   587     12  ER-0172                 PIC X(4)  VALUE '0174'.
   588     12  ER-0198                 PIC X(4)  VALUE '0198'.
   589     12  ER-0204                 PIC X(4)  VALUE '0204'.
   590     12  ER-0206                 PIC X(4)  VALUE '0206'.
   591     12  ER-0252                 PIC X(4)  VALUE '0252'.
   592     12  ER-0254                 PIC X(4)  VALUE '0254'.
   593     12  ER-0282                 PIC X(4)  VALUE '0282'.
   594     12  ER-0283                 PIC X(4)  VALUE '0283'.
   595     12  ER-0294                 PIC X(4)  VALUE '0294'.
   596     12  ER-0338                 PIC X(4)  VALUE '0338'.
   597     12  ER-0419                 PIC X(4)  VALUE '0419'.
   598     12  ER-0420                 PIC X(4)  VALUE '0420'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  13
* EL156.cbl
   599     12  ER-0421                 PIC X(4)  VALUE '0421'.
   600     12  ER-0422                 PIC X(4)  VALUE '0422'.
   601     12  ER-0433                 PIC X(4)  VALUE '0433'.
   602     12  ER-0436                 PIC X(4)  VALUE '0436'.
   603     12  ER-0437                 PIC X(4)  VALUE '0437'.
   604     12  ER-0438                 PIC X(4)  VALUE '0438'.
   605     12  ER-0439                 PIC X(4)  VALUE '0439'.
   606     12  ER-0440                 PIC X(4)  VALUE '0440'.
   607     12  ER-0441                 PIC X(4)  VALUE '0441'.
   608     12  ER-0442                 PIC X(4)  VALUE '0442'.
   609     12  ER-0443                 PIC X(4)  VALUE '0443'.
   610     12  ER-0444                 PIC X(4)  VALUE '0444'.
   611     12  ER-0445                 PIC X(4)  VALUE '0445'.
   612     12  ER-0446                 PIC X(4)  VALUE '0446'.
   613     12  ER-0447                 PIC X(4)  VALUE '0447'.
   614     12  ER-0448                 PIC X(4)  VALUE '0448'.
   615     12  ER-0449                 PIC X(4)  VALUE '0449'.
   616     12  ER-0452                 PIC X(4)  VALUE '0452'.
   617     12  ER-0458                 PIC X(4)  VALUE '0458'.
   618     12  ER-0459                 PIC X(4)  VALUE '0459'.
   619     12  ER-0460                 PIC X(4)  VALUE '0460'.
   620     12  ER-0461                 PIC X(4)  VALUE '0461'.
   621     12  ER-0462                 PIC X(4)  VALUE '0462'.
   622     12  ER-0463                 PIC X(4)  VALUE '0463'.
   623     12  ER-0464                 PIC X(4)  VALUE '0464'.
   624     12  ER-0465                 PIC X(4)  VALUE '0465'.
   625     12  ER-0466                 PIC X(4)  VALUE '0466'.
   626     12  ER-0467                 PIC X(4)  VALUE '0467'.
   627     12  ER-0468                 PIC X(4)  VALUE '0468'.
   628     12  ER-0469                 PIC X(4)  VALUE '0469'.
   629     12  ER-0473                 PIC X(4)  VALUE '0473'.
   630     12  ER-0474                 PIC X(4)  VALUE '0474'.
   631     12  ER-0475                 PIC X(4)  VALUE '0475'.
   632     12  ER-0476                 PIC X(4)  VALUE '0476'.
   633     12  ER-0477                 PIC X(4)  VALUE '0477'.
   634     12  ER-0478                 PIC X(4)  VALUE '0478'.
   635     12  ER-0479                 PIC X(4)  VALUE '0479'.
   636     12  ER-0481                 PIC X(4)  VALUE '0481'.
   637     12  ER-0491                 PIC X(4)  VALUE '0491'.
   638     12  ER-0492                 PIC X(4)  VALUE '0492'.
   639     12  ER-0493                 PIC X(4)  VALUE '0493'.
   640     12  ER-0494                 PIC X(4)  VALUE '0494'.
   641     12  ER-0495                 PIC X(4)  VALUE '0495'.
   642     12  ER-0499                 PIC X(4)  VALUE '0499'.
   643     12  ER-0500                 PIC X(4)  VALUE '0500'.
   644     12  ER-0501                 PIC X(4)  VALUE '0501'.
   645     12  ER-0502                 PIC X(4)  VALUE '0502'.
   646     12  ER-0508                 PIC X(4)  VALUE '0508'.
   647     12  ER-0513                 PIC X(4)  VALUE '0513'.
   648     12  ER-0518                 PIC X(4)  VALUE '0518'.
   649     12  ER-0524                 PIC X(4)  VALUE '0524'.
   650     12  ER-0525                 PIC X(4)  VALUE '0525'.
   651     12  ER-0526                 PIC X(4)  VALUE '0526'.
   652     12  ER-0530                 PIC X(4)  VALUE '0530'.
   653     12  ER-0540                 PIC X(4)  VALUE '0540'.
   654     12  ER-0541                 PIC X(4)  VALUE '0541'.
   655     12  ER-0542                 PIC X(4)  VALUE '0542'.
   656     12  ER-0543                 PIC X(4)  VALUE '0543'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  14
* EL156.cbl
   657     12  ER-0545                 PIC X(4)  VALUE '0545'.
   658     12  ER-0552                 PIC X(4)  VALUE '0552'.
   659     12  ER-0555                 PIC X(4)  VALUE '0555'.
   660     12  ER-0556                 PIC X(4)  VALUE '0556'.
   661     12  ER-0557                 PIC X(4)  VALUE '0557'.
   662     12  ER-0572                 PIC X(4)  VALUE '0572'.
   663     12  ER-0573                 PIC X(4)  VALUE '0573'.
   664     12  ER-0594                 PIC X(4)  VALUE '0594'.
   665     12  ER-0616                 PIC X(4)  VALUE '0616'.
   666     12  ER-0617                 PIC X(4)  VALUE '0617'.
   667     12  ER-0618                 PIC X(4)  VALUE '0618'.
   668     12  ER-0657                 PIC X(4)  VALUE '0657'.
   669     12  ER-0658                 PIC X(4)  VALUE '0658'.
   670     12  ER-0699                 PIC X(4)  VALUE '0699'.
   671     12  ER-0730                 PIC X(4)  VALUE '0730'.
   672     12  ER-0737                 PIC X(4)  VALUE '0737'.
   673     12  ER-0760                 PIC X(4)  VALUE '0760'.
   674     12  ER-0768                 PIC X(4)  VALUE '0768'.
   675     12  ER-0769                 PIC X(4)  VALUE '0769'.
   676     12  ER-0770                 PIC X(4)  VALUE '0770'.
   677     12  ER-0802                 PIC X(4)  VALUE '0802'.
   678     12  ER-0803                 PIC X(4)  VALUE '0803'.
   679     12  ER-0819                 PIC X(4)  VALUE '0819'.
   680     12  ER-0834                 PIC X(4)  VALUE '0834'.
   681     12  ER-0836                 PIC X(4)  VALUE '0836'.
   682     12  ER-0844                 PIC X(4)  VALUE '0844'.
   683     12  ER-0845                 PIC X(4)  VALUE '0845'.
   684     12  ER-0846                 PIC X(4)  VALUE '0846'.
   685     12  ER-0849                 PIC X(4)  VALUE '0849'.
   686     12  ER-0851                 PIC X(4)  VALUE '0851'.
   687     12  ER-0872                 PIC X(4)  VALUE '0872'.
   688     12  ER-0873                 PIC X(4)  VALUE '0873'.
   689     12  ER-0874                 PIC X(4)  VALUE '0874'.
   690     12  ER-0879                 PIC X(4)  VALUE '0879'.
   691     12  ER-0919                 PIC X(4)  VALUE '0919'.
   692     12  ER-0921                 PIC X(4)  VALUE '0921'.
   693     12  ER-0923                 PIC X(4)  VALUE '0923'.
   694     12  ER-0925                 PIC X(4)  VALUE '0925'.
   695     12  ER-0944                 PIC X(4)  VALUE '0944'.
   696     12  ER-0945                 PIC X(4)  VALUE '0945'.
   697     12  ER-0946                 PIC X(4)  VALUE '0946'.
   698     12  ER-0947                 PIC X(4)  VALUE '0947'.
   699     12  ER-0948                 PIC X(4)  VALUE '0948'.
   700     12  ER-0949                 PIC X(4)  VALUE '0949'.
   701     12  ER-0950                 PIC X(4)  VALUE '0950'.
   702     12  ER-0951                 PIC X(4)  VALUE '0951'.
   703     12  ER-0954                 PIC X(4)  VALUE '0954'.
   704     12  ER-0956                 PIC X(4)  VALUE '0956'.
   705     12  ER-0967                 PIC X(4)  VALUE '0967'.
   706     12  ER-0968                 PIC X(4)  VALUE '0968'.
   707     12  ER-0974                 PIC X(4)  VALUE '0974'.
   708     12  ER-0975                 PIC X(4)  VALUE '0975'.
   709     12  ER-1561                 PIC X(4)  VALUE '1561'.
   710     12  ER-1566                 PIC X(4)  VALUE '1566'.
   711     12  ER-1567                 PIC X(4)  VALUE '1567'.
   712     12  ER-1569                 PIC X(4)  VALUE '1569'.
   713     12  er-1582                 pic x(4)  value '1582'.
   714     12  er-1657                 pic x(4)  value '1657'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  15
* EL156.cbl
   715     12  er-1658                 pic x(4)  value '1658'.
   716     12  er-1667                 pic x(4)  value '1667'.
   717     12  er-1670                 pic x(4)  value '1670'.
   718     12  er-1671                 pic x(4)  value '1671'.
   719     12  er-1672                 pic x(4)  value '1672'.
   720     12  er-1673                 pic x(4)  value '1673'.
   721     12  er-1674                 pic x(4)  value '1674'.
   722     12  er-1677                 pic x(4)  value '1677'.
   723     12  ER-1775                 PIC X(4)  VALUE '1775'.
   724     12  ER-1880                 PIC X(4)  VALUE '1880'.
   725     12  ER-1930                 PIC X(4)  VALUE '1930'.
   726     12  ER-2044                 PIC X(4)  VALUE '2044'.
   727     12  ER-3140                 PIC X(4)  VALUE '3140'.
   728     12  ER-3141                 PIC X(4)  VALUE '3141'.
   729     12  ER-3255                 PIC X(4)  VALUE '3255'.
   730     12  ER-3272                 PIC X(4)  VALUE '3272'.
   731     12  ER-3276                 PIC X(4)  VALUE '3276'.
   732     12  ER-3277                 PIC X(4)  VALUE '3277'.
   733     12  ER-3278                 PIC X(4)  VALUE '3278'.
   734     12  ER-3279                 PIC X(4)  VALUE '3279'.
   735     12  ER-3280                 PIC X(4)  VALUE '3280'.
   736     12  ER-3516                 PIC X(4)  VALUE '3516'.
   737     12  ER-3527                 PIC X(4)  VALUE '3527'.
   738     12  ER-3528                 PIC X(4)  VALUE '3528'.
   739     12  ER-3529                 PIC X(4)  VALUE '3529'.
   740     12  ER-3530                 PIC X(4)  VALUE '3530'.
   741     12  ER-3531                 PIC X(4)  VALUE '3531'.
   742     12  ER-3532                 PIC X(4)  VALUE '3532'.
   743     12  ER-3533                 PIC X(4)  VALUE '3533'.
   744     12  ER-3534                 PIC X(4)  VALUE '3534'.
   745     12  ER-3535                 PIC X(4)  VALUE '3535'.
   746     12  ER-3536                 PIC X(4)  VALUE '3536'.
   747     12  ER-3537                 PIC X(4)  VALUE '3537'.
   748     12  ER-3538                 PIC X(4)  VALUE '3538'.
   749     12  ER-3539                 PIC X(4)  VALUE '3539'.
   750     12  ER-3540                 PIC X(4)  VALUE '3540'.
   751     12  ER-3541                 PIC X(4)  VALUE '3541'.
   752     12  ER-3542                 PIC X(4)  VALUE '3542'.
   753     12  ER-3543                 PIC X(4)  VALUE '3543'.
   754     12  ER-3546                 PIC X(4)  VALUE '3546'.
   755     12  ER-3549                 PIC X(4)  VALUE '3549'.
   756     12  ER-3551                 PIC X(4)  VALUE '3551'.
   757     12  ER-3818                 PIC X(4)  VALUE '3818'.
   758     12  ER-7540                 PIC X(4)  VALUE '7540'.
   759     12  ER-7576                 PIC X(4)  VALUE '7576'.
   760     12  ER-7579                 PIC X(4)  VALUE '7579'.
   761     12  ER-7580                 PIC X(4)  VALUE '7580'.
   762     12  ER-7583                 PIC X(4)  VALUE '7583'.
   763     12  ER-7585                 PIC X(4)  VALUE '7585'.
   764     12  ER-7830                 PIC X(4)  VALUE '7830'.
   765     12  ER-7831                 PIC X(4)  VALUE '7831'.
   766     12  ER-7832                 PIC X(4)  VALUE '7832'.
   767     12  ER-7833                 PIC X(4)  VALUE '7833'.
   768     12  ER-7834                 PIC X(4)  VALUE '7834'.
   769     12  ER-7835                 PIC X(4)  VALUE '7835'.
   770     12  ER-7836                 PIC X(4)  VALUE '7836'.
   771     12  ER-7837                 PIC X(4)  VALUE '7837'.
   772     12  ER-7838                 PIC X(4)  VALUE '7838'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  16
* EL156.cbl
   773     12  ER-7841                 PIC X(4)  VALUE '7841'.
   774     12  ER-7844                 PIC X(4)  VALUE '7844'.
   775     12  ER-7845                 PIC X(4)  VALUE '7845'.
   776     12  ER-8000                 PIC X(4)  VALUE '8000'.
   777     12  ER-8051                 PIC X(4)  VALUE '8051'.
   778     12  ER-8052                 PIC X(4)  VALUE '8052'.
   779     12  ER-8053                 PIC X(4)  VALUE '8053'.
   780     12  ER-8054                 PIC X(4)  VALUE '8054'.
   781     12  ER-8055                 PIC X(4)  VALUE '8055'.
   782     12  ER-8056                 PIC X(4)  VALUE '8056'.
   783     12  ER-8057                 PIC X(4)  VALUE '8057'.
   784     12  ER-8058                 PIC X(4)  VALUE '8058'.
   785     12  ER-8059                 PIC X(4)  VALUE '8059'.
   786     12  ER-8060                 PIC X(4)  VALUE '8060'.
   787     12  ER-8061                 PIC X(4)  VALUE '8061'.
   788     12  ER-8062                 PIC X(4)  VALUE '8062'.
   789     12  ER-8063                 PIC X(4)  VALUE '8063'.
   790     12  ER-8064                 PIC X(4)  VALUE '8064'.
   791     12  ER-8065                 PIC X(4)  VALUE '8065'.
   792     12  ER-8066                 PIC X(4)  VALUE '8066'.
   793     12  ER-8146                 PIC X(4)  VALUE '8146'.
   794     12  ER-8147                 PIC X(4)  VALUE '8147'.
   795     12  ER-8152                 PIC X(4)  VALUE '8152'.
   796     12  ER-8153                 PIC X(4)  VALUE '8153'.
   797     12  ER-8154                 PIC X(4)  VALUE '8154'.
   798     12  ER-8155                 PIC X(4)  VALUE '8155'.
   799     12  ER-8310                 PIC X(4)  VALUE '8310'.
   800     12  ER-8311                 PIC X(4)  VALUE '8311'.
   801     12  ER-8312                 PIC X(4)  VALUE '8312'.
   802     12  ER-8313                 PIC X(4)  VALUE '8313'.
   803     12  ER-8314                 PIC X(4)  VALUE '8314'.
   804     12  ER-8315                 PIC X(4)  VALUE '8315'.
   805     12  ER-8316                 PIC X(4)  VALUE '8316'.
   806     12  ER-8317                 PIC X(4)  VALUE '8317'.
   807
   808 01  CSO-WORK-FIELDS.
   809     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   810       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   811
   812     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   813     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   814         88  CERT-NOTE-ADDED           VALUE 'Y'.
   815     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   816         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   817     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   818
   819     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   820
   821 01  SC-NP6-CERT-NOTE.
   822     12  FILLER                  PIC X(12)
   823               VALUE 'REM BENEFIT '.
   824     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   825     12  SC-NP6-COMM             PIC X(8)
   826               VALUE ' + 6 MO '.
   827     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   828     12  FILLER                  PIC X(12)
   829               VALUE ' = AMT PAID '.
   830     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  17
* EL156.cbl
   831
   832 01  SC-NP6-ORIG-NOTE.
   833     12  FILLER                  PIC X(63)  VALUE
   834         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   835 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   836     88  PDEF-FOUND                   VALUE 'Y'.
   837 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   838     88  ACCT-FOUND                   VALUE 'Y'.
   839 01  CTBL-KEY-SAVE               PIC X(5).
   840 01  CTBL-KEY.
   841     05  CTBL-COMPANY-CD         PIC X.
   842     05  CTBL-TABLE              PIC XXX.
   843     05  CTBL-BEN-TYPE           PIC X.
   844     05  CTBL-BEN-CODE           PIC XX.
   845 01  ERPDEF-KEY-SAVE             PIC X(18).
   846 01  ERPDEF-KEY.
   847     12  ERPDEF-COMPANY-CD       PIC X.
   848     12  ERPDEF-STATE            PIC XX.
   849     12  ERPDEF-PROD-CD          PIC XXX.
   850     12  F                       PIC X(7).
   851     12  ERPDEF-BEN-TYPE         PIC X.
   852     12  ERPDEF-BEN-CODE         PIC XX.
   853     12  ERPDEF-EXP-DT           PIC XX.
   854 01  ELCRTT-KEY.
   855     05  CTRLR-COMP-CD       PIC X.
   856     05  CTRLR-CARRIER       PIC X.
   857     05  CTRLR-GROUPING      PIC X(6).
   858     05  CTRLR-STATE         PIC X(2).
   859     05  CTRLR-ACCOUNT       PIC X(10).
   860     05  CTRLR-EFF-DT        PIC XX.
   861     05  CTRLR-CERT-NO       PIC X(11).
   862     05  CTRLR-REC-TYPE      PIC X.
   863 01  ACCESS-KEYS.
   864     12  ELARCH-KEY.
   865         16  ARCH-CO             PIC X.
   866         16  ARCH-NUMBER         PIC S9(08) COMP.
   867         16  ARCH-REC-TYPE       PIC X.
   868         16  ARCH-SEQ            PIC S9(04) COMP.
   869     12  ELMSTR-KEY.
   870         16  MSTR-COMP-CD        PIC X.
   871         16  MSTR-CARRIER        PIC X.
   872         16  MSTR-CLAIM-NO       PIC X(7).
   873         16  MSTR-CERT-NO        PIC X(11).
   874     12  ELCNTL-KEY.
   875         16  CNTL-COMP-ID        PIC X(3).
   876         16  CNTL-REC-TYPE       PIC X.
   877         16  CNTL-ACCESS         PIC X(4).
   878         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   879     12  ELCERT-KEY.
   880         16  CERT-COMP-CD        PIC X.
   881         16  CERT-CARRIER        PIC X.
   882         16  CERT-GROUPING       PIC X(6).
   883         16  CERT-STATE          PIC XX.
   884         16  CERT-ACCOUNT        PIC X(10).
   885         16  CERT-EFF-DT         PIC XX.
   886         16  CERT-CERT-NO        PIC X(11).
   887     12  ELTRLR-KEY.
   888         16  TRLR-COMP-CD        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  18
* EL156.cbl
   889         16  TRLR-CARRIER        PIC X.
   890         16  TRLR-CLAIM-NO       PIC X(7).
   891         16  TRLR-CERT-NO        PIC X(11).
   892         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   893     12  ELACTQ-KEY.
   894         16  ACTQ-COMP-CD        PIC X.
   895         16  ACTQ-CARRIER        PIC X.
   896         16  ACTQ-CLAIM-NO       PIC X(7).
   897         16  ACTQ-CERT-NO        PIC X(11).
   898     12  W-NOTE-KEY.
   899         16  W-NOTE-COMP-CD      PIC X.
   900         16  W-NOTE-CERT-KEY.
   901             20  W-NOTE-CARRIER  PIC X.
   902             20  W-NOTE-GROUPING PIC X(6).
   903             20  W-NOTE-STATE    PIC XX.
   904             20  W-NOTE-ACCOUNT  PIC X(10).
   905             20  W-NOTE-EFF-DT   PIC XX.
   906             20  W-NOTE-CERT-NO  PIC X(11).
   907     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   908     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   909     12  ERACCT-KEY.
   910         16  ERACCT-PARTIAL-KEY.
   911             20  ACCT-COMP-CD    PIC X.
   912             20  ACCT-CARRIER    PIC X.
   913             20  ACCT-GROUPING   PIC X(6).
   914             20  ACCT-STATE      PIC XX.
   915             20  ACCT-ACCOUNT    PIC X(10).
   916         16  ACCT-EXP-DT         PIC XX.
   917         16  FILLER              PIC X(4) VALUE SPACES.
   918     12  ELCHKQ-KEY.
   919         16  CHKQ-COMP-CD        PIC X.
   920         16  CHKQ-CONTROL        PIC S9(8) COMP.
   921         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   922     12  ELBENE-KEY.
   923         16  BENE-COMP-CD         PIC X.
   924         16  BENE-RECORD-TYPE     PIC X.
   925         16  BENE-NUMBER          PIC X(10).
   926     12  ERCOMP-KEY.
   927         16  COMP-COMP-CD        PIC X.
   928         16  COMP-CARRIER        PIC X.
   929         16  COMP-GROUP          PIC X(06).
   930         16  COMP-FIN-RESP       PIC X(10).
   931         16  COMP-ACCOUNT        PIC X(10).
   932         16  COMP-TYPE           PIC X.
   933
   934     12  DLO035-KEY.
   935         16  DL35-PROCESS-TYPE   PIC X.
   936         16  DL35-CREDIT-CARD    PIC X(20).
   937         16  DL35-BEN-TYPE       PIC XX.
   938         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   939         16  DL35-RETURN-CODE    PIC XX.
   940
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  19
* EL156.cbl
   942*    COPY ELCDATE.
   943******************************************************************
   944*                                                                *
   945*                                                                *
   946*                            ELCDATE.                            *
   947*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   948*                            VMOD=2.003
   949*                                                                *
   950*                                                                *
   951*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   952*                 LENGTH = 200                                   *
   953******************************************************************
   954
   955 01  DATE-CONVERSION-DATA.
   956     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   957     12  DC-OPTION-CODE                PIC X.
   958         88  BIN-TO-GREG                VALUE ' '.
   959         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   960         88  EDIT-GREG-TO-BIN           VALUE '2'.
   961         88  YMD-GREG-TO-BIN            VALUE '3'.
   962         88  MDY-GREG-TO-BIN            VALUE '4'.
   963         88  JULIAN-TO-BIN              VALUE '5'.
   964         88  BIN-PLUS-ELAPSED           VALUE '6'.
   965         88  FIND-CENTURY               VALUE '7'.
   966         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   967         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   968         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   969         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   970         88  JULIAN-TO-BIN-3            VALUE 'C'.
   971         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   972         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   973         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   974         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   975         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   976         88  CHECK-LEAP-YEAR            VALUE 'H'.
   977         88  BIN-3-TO-GREG              VALUE 'I'.
   978         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   979         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   980         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   981         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   982         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   983         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   984         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   985         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   986         88  THREE-CHARACTER-BIN
   987                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   988         88  GREGORIAN-TO-BIN
   989                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   990         88  BIN-TO-GREGORIAN
   991                  VALUES ' ' '1' 'I' '8' 'G'.
   992         88  JULIAN-TO-BINARY
   993                  VALUES '5' 'C' 'E' 'F'.
   994     12  DC-ERROR-CODE                 PIC X.
   995         88  NO-CONVERSION-ERROR        VALUE ' '.
   996         88  DATE-CONVERSION-ERROR
   997                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   998         88  DATE-IS-ZERO               VALUE '1'.
   999         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  20
* EL156.cbl
  1000         88  DATE-IS-INVALID            VALUE '3'.
  1001         88  DATE1-GREATER-DATE2        VALUE '4'.
  1002         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1003         88  DATE-INVALID-OPTION        VALUE '9'.
  1004         88  INVALID-CENTURY            VALUE 'A'.
  1005         88  ONLY-CENTURY               VALUE 'B'.
  1006         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1007         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1008     12  DC-END-OF-MONTH               PIC X.
  1009         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1010     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1011         88  USE-NORMAL-PROCESS         VALUE ' '.
  1012         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1013         88  ADJUST-UP-100-YRS          VALUE '2'.
  1014     12  FILLER                        PIC X.
  1015     12  DC-CONVERSION-DATES.
  1016         16  DC-BIN-DATE-1             PIC XX.
  1017         16  DC-BIN-DATE-2             PIC XX.
  1018         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1019         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1020                       DC-GREG-DATE-1-EDIT.
  1021             20  DC-EDIT1-MONTH        PIC 99.
  1022             20  SLASH1-1              PIC X.
  1023             20  DC-EDIT1-DAY          PIC 99.
  1024             20  SLASH1-2              PIC X.
  1025             20  DC-EDIT1-YEAR         PIC 99.
  1026         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1027         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1028                     DC-GREG-DATE-2-EDIT.
  1029             20  DC-EDIT2-MONTH        PIC 99.
  1030             20  SLASH2-1              PIC X.
  1031             20  DC-EDIT2-DAY          PIC 99.
  1032             20  SLASH2-2              PIC X.
  1033             20  DC-EDIT2-YEAR         PIC 99.
  1034         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1035         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1036                     DC-GREG-DATE-1-YMD.
  1037             20  DC-YMD-YEAR           PIC 99.
  1038             20  DC-YMD-MONTH          PIC 99.
  1039             20  DC-YMD-DAY            PIC 99.
  1040         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1041         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1042                      DC-GREG-DATE-1-MDY.
  1043             20  DC-MDY-MONTH          PIC 99.
  1044             20  DC-MDY-DAY            PIC 99.
  1045             20  DC-MDY-YEAR           PIC 99.
  1046         16  DC-GREG-DATE-1-ALPHA.
  1047             20  DC-ALPHA-MONTH        PIC X(10).
  1048             20  DC-ALPHA-DAY          PIC 99.
  1049             20  FILLER                PIC XX.
  1050             20  DC-ALPHA-CENTURY.
  1051                 24 DC-ALPHA-CEN-N     PIC 99.
  1052             20  DC-ALPHA-YEAR         PIC 99.
  1053         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1054         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1055         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1056         16  DC-JULIAN-DATE            PIC 9(05).
  1057         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  21
* EL156.cbl
  1058                                       PIC 9(05).
  1059         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1060             20  DC-JULIAN-YEAR        PIC 99.
  1061             20  DC-JULIAN-DAYS        PIC 999.
  1062         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1063         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1064         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1065     12  DATE-CONVERSION-VARIBLES.
  1066         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1067         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1068             20  FILLER                PIC 9(3).
  1069             20  HOLD-CEN-1-CCYY.
  1070                 24  HOLD-CEN-1-CC     PIC 99.
  1071                 24  HOLD-CEN-1-YY     PIC 99.
  1072             20  HOLD-CEN-1-MO         PIC 99.
  1073             20  HOLD-CEN-1-DA         PIC 99.
  1074         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1075             20  HOLD-CEN-1-R-MO       PIC 99.
  1076             20  HOLD-CEN-1-R-DA       PIC 99.
  1077             20  HOLD-CEN-1-R-CCYY.
  1078                 24  HOLD-CEN-1-R-CC   PIC 99.
  1079                 24  HOLD-CEN-1-R-YY   PIC 99.
  1080             20  FILLER                PIC 9(3).
  1081         16  HOLD-CENTURY-1-X.
  1082             20  FILLER                PIC X(3)  VALUE SPACES.
  1083             20  HOLD-CEN-1-X-CCYY.
  1084                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1085                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1086             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1087             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1088         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1089             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1090             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1091             20  HOLD-CEN-1-R-X-CCYY.
  1092                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1093                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1094             20  FILLER                PIC XXX.
  1095         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1096         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1097         16  DC-JULIAN-DATE-1          PIC 9(07).
  1098         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1099             20  DC-JULIAN-1-CCYY.
  1100                 24  DC-JULIAN-1-CC    PIC 99.
  1101                 24  DC-JULIAN-1-YR    PIC 99.
  1102             20  DC-JULIAN-DA-1        PIC 999.
  1103         16  DC-JULIAN-DATE-2          PIC 9(07).
  1104         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1105             20  DC-JULIAN-2-CCYY.
  1106                 24  DC-JULIAN-2-CC    PIC 99.
  1107                 24  DC-JULIAN-2-YR    PIC 99.
  1108             20  DC-JULIAN-DA-2        PIC 999.
  1109         16  DC-GREG-DATE-A-EDIT.
  1110             20  DC-EDITA-MONTH        PIC 99.
  1111             20  SLASHA-1              PIC X VALUE '/'.
  1112             20  DC-EDITA-DAY          PIC 99.
  1113             20  SLASHA-2              PIC X VALUE '/'.
  1114             20  DC-EDITA-CCYY.
  1115                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  22
* EL156.cbl
  1116                 24  DC-EDITA-YEAR     PIC 99.
  1117         16  DC-GREG-DATE-B-EDIT.
  1118             20  DC-EDITB-MONTH        PIC 99.
  1119             20  SLASHB-1              PIC X VALUE '/'.
  1120             20  DC-EDITB-DAY          PIC 99.
  1121             20  SLASHB-2              PIC X VALUE '/'.
  1122             20  DC-EDITB-CCYY.
  1123                 24  DC-EDITB-CENT     PIC 99.
  1124                 24  DC-EDITB-YEAR     PIC 99.
  1125         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1126         16  DC-GREG-DATE-CYMD-R REDEFINES
  1127                              DC-GREG-DATE-CYMD.
  1128             20  DC-CYMD-CEN           PIC 99.
  1129             20  DC-CYMD-YEAR          PIC 99.
  1130             20  DC-CYMD-MONTH         PIC 99.
  1131             20  DC-CYMD-DAY           PIC 99.
  1132         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1133         16  DC-GREG-DATE-MDCY-R REDEFINES
  1134                              DC-GREG-DATE-MDCY.
  1135             20  DC-MDCY-MONTH         PIC 99.
  1136             20  DC-MDCY-DAY           PIC 99.
  1137             20  DC-MDCY-CEN           PIC 99.
  1138             20  DC-MDCY-YEAR          PIC 99.
  1139    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1140        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1141    12  DC-EL310-DATE                  PIC X(21).
  1142    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  23
* EL156.cbl
  1144*    COPY ELCLOGOF.
  1145******************************************************************
  1146*                                                                *
  1147*                                                                *
  1148*                            ELCLOGOF.                           *
  1149*                            VMOD=2.001                          *
  1150*                                                                *
  1151*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1152*                                                                *
  1153******************************************************************
  1154 01  CLASIC-LOGOFF.
  1155     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1156     12  LOGOFF-TEXT.
  1157         16  FILLER          PIC X(5)    VALUE SPACES.
  1158         16  LOGOFF-MSG.
  1159             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1160             20  FILLER      PIC X       VALUE SPACES.
  1161             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1162         16  FILLER          PIC X(80)
  1163           VALUE '* YOU ARE NOW LOGGED OFF'.
  1164         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1165         16  FILLER          PIC X       VALUE QUOTE.
  1166         16  LOGOFF-SYS-MSG  PIC X(17)
  1167           VALUE 'S CLAS-IC SYSTEM '.
  1168     12  TEXT-MESSAGES.
  1169         16  UNACCESS-MSG    PIC X(29)
  1170             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1171         16  PGMIDERR-MSG    PIC X(17)
  1172             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  24
* EL156.cbl
  1174*    COPY ELCCALC.
  1175******************************************************************
  1176*                                                                *
  1177*                           ELCCALC.                            *
  1178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1179*                            VMOD=2.025                          *
  1180*                                                                *
  1181*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1182*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1183*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1184*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1185*                                                                *
  1186*  PASSED TO ELRTRM                                              *
  1187*  -----------------                                             *
  1188*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1189*  ORIGINAL TERM                                                 *
  1190*  BEGINNING DATE                                                *
  1191*  ENDING DATE                                                   *
  1192*  COMPANY I.D.                                                  *
  1193*  ACCOUNT MASTER USER FIELD                                     *
  1194*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1195*  FREE LOOK DAYS                                                *
  1196*                                                                *
  1197*  RETURNED FROM ELRTRM                                          *
  1198*  ---------------------                                         *
  1199*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1200*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1201*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1202*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1203*----------------------------------------------------------------*
  1204*  PASSED TO ELRAMT                                              *
  1205*  ----------------                                              *
  1206*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1207*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1208*  ORIGINAL AMOUNT                                               *
  1209*  ALTERNATE BENEFIT (BALLON)                                    *
  1210*  A.P.R. - NET PAY ONLY                                         *
  1211*  METHOD
  1212*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1213*  COMPANY I.D.                                                  *
  1214*  BENEFIT TYPE                                                  *
  1215*                                                                *
  1216*  RETURNED FROM ELRAMT                                          *
  1217*  --------------------                                          *
  1218*  REMAINING AMOUNT 1 - CURRENT                                  *
  1219*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1220*  REMAINING AMOUNT FACTOR
  1221*----------------------------------------------------------------*
  1222*  PASSED TO ELRESV                                              *
  1223*  -----------------                                             *
  1224*  CERTIFICATE EFFECTIVE DATE                                    *
  1225*  VALUATION DATE                                                *
  1226*  PAID THRU DATE                                                *
  1227*  BENEFIT                                                       *
  1228*  INCURRED DATE                                                 *
  1229*  REPORTED DATE                                                 *
  1230*  ISSUE AGE                                                     *
  1231*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  25
* EL156.cbl
  1232*  CDT PERCENT                                                   *
  1233*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1234* *CLAIM TYPE (LIFE, A/H)                                        *
  1235* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1236* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1237*                                                                *
  1238*  RETURNED FROM ELRESV                                          *
  1239*  --------------------                                          *
  1240*  CDT TABLE USED                                                *
  1241*  CDT FACTOR USED                                               *
  1242*  PAY TO CURRENT RESERVE                                        *
  1243*  I.B.N.R. - A/H ONLY                                           *
  1244*  FUTURE (ACCRUED) AH ONLY                                      *
  1245*----------------------------------------------------------------*
  1246*  PASSED TO ELRATE                                              *
  1247*  ----------------                                              *
  1248*  CERT ISSUE DATE                                               *
  1249*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1250*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1251*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1252*  STATE CODE (CLIENT DEFINED)                                   *
  1253*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1254*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1255*  DEVIATION CODE                                                *
  1256*  ISSUE AGE                                                     *
  1257*  ORIGINAL BENEFIT AMOUNT                                       *
  1258*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1259*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1260*  BENEFIT KIND (LIFE OR A/H)                                    *
  1261*  A.P.R.                                                        *
  1262*  METHOD
  1263*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1264*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1265*  COMPANY I.D. (3 CHARACTER)                                    *
  1266*  BENEFIT CODE                                                  *
  1267*  BENEFIT OVERRIDE CODE                                         *
  1268*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1269*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1270*  JOINT INDICATOR (CSL ONLY)                                    *
  1271*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1272*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1273*                                                                *
  1274*  RETURNED FROM ELRATE                                          *
  1275*  --------------------                                          *
  1276*  CALCULATED PREMIUM                                            *
  1277*  PREMIUM RATE                                                  *
  1278*  MORTALITY CODE                                                *
  1279*  MAX ATTAINED AGE                                              *
  1280*  MAX AGE                                                       *
  1281*  MAX TERM                                                      *
  1282*  MAX MONTHLY BENEFIT                                           *
  1283*  MAX TOTAL BENIFIT                                             *
  1284*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1285*----------------------------------------------------------------*
  1286*  PASSED TO ELRFND                                              *
  1287*  ----------------                                              *
  1288*  CERT ISSUE DATE                                               *
  1289*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  26
* EL156.cbl
  1290*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1291*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1292*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1293*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1294*  STATE CODE (CLIENT DEFINED)                                   *
  1295*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1296*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1297*  DEVIATION CODE                                                *
  1298*  ISSUE AGE                                                     *
  1299*  ORIGINAL BENEFIT AMOUNT                                       *
  1300*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1301*  PROCESS TYPE (CANCEL)                                         *
  1302*  BENEFIT KIND (LIFE OR A/H)                                    *
  1303*  A.P.R.                                                        *
  1304*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1305*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1306*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1307*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1308*  COMPANY I.D. (3 CHARACTER)                                    *
  1309*  BENEFIT CODE                                                  *
  1310*  BENEFIT OVERRIDE CODE                                         *
  1311*                                                                *
  1312*  RETURNED FROM ELRFND                                          *
  1313*  --------------------                                          *
  1314*  CALCULATED REFUND                                             *
  1315*----------------------------------------------------------------*
  1316*  PASSED TO ELEARN                                              *
  1317*  ----------------                                              *
  1318*  CERT ISSUE DATE                                               *
  1319*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1320*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1321*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1322*  STATE CODE (CLIENT DEFINED)                                   *
  1323*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1324*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1325*  DEVIATION CODE                                                *
  1326*  ISSUE AGE                                                     *
  1327*  ORIGINAL BENEFIT AMOUNT                                       *
  1328*  BENEFIT KIND (LIFE OR A/H)                                    *
  1329*  A.P.R.                                                        *
  1330*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1331*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1332*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1333*  COMPANY I.D. (3 CHARACTER)                                    *
  1334*  BENEFIT CODE                                                  *
  1335*  BENEFIT OVERRIDE CODE                                         *
  1336*                                                                *
  1337*  RETURNED FROM ELEARN                                          *
  1338*  --------------------                                          *
  1339*  INDICATED  EARNINGS                                           *
  1340*----------------------------------------------------------------*
  1341*                 LENGTH = 450                                   *
  1342*                                                                *
  1343******************************************************************
  1344******************************************************************
  1345*                   C H A N G E   L O G
  1346*
  1347* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  27
* EL156.cbl
  1348*-----------------------------------------------------------------
  1349*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1350* EFFECTIVE    NUMBER
  1351*-----------------------------------------------------------------
  1352* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1353* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1354* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1355* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1356* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1357* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1358* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1359* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1360* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1361* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1362* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1363* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  1364******************************************************************
  1365
  1366 01  CALCULATION-PASS-AREA.
  1367     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1368                                     COMP.
  1369
  1370     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1371       88  NO-CP-ERROR                             VALUE ZERO.
  1372       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1373                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  1374       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1375       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1376       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1377       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1378       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1379       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1380       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1381       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1382       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1383       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1384       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1385       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1386       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1387       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1388       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1389       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1390       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1391       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  1392
  1393     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1394       88  NO-CP-ERROR-2                           VALUE ZERO.
  1395***********************  INPUT AREAS ****************************
  1396
  1397     12  CP-CALCULATION-AREA.
  1398         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1399         16  CP-CERT-EFF-DT        PIC XX.
  1400         16  CP-VALUATION-DT       PIC XX.
  1401         16  CP-PAID-THRU-DT       PIC XX.
  1402         16  CP-BENEFIT-TYPE       PIC X.
  1403           88  CP-AH                               VALUE 'A' 'D'
  1404                                                   'I' 'U'.
  1405           88  CP-REDUCING-LIFE                    VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  28
* EL156.cbl
  1406           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1407         16  CP-INCURRED-DT        PIC XX.
  1408         16  CP-REPORTED-DT        PIC XX.
  1409         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1410         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1411         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1412                                     COMP-3.
  1413         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1414                                     COMP-3.
  1415         16  CP-CDT-METHOD         PIC X.
  1416           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1417           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1418           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1419         16  CP-CLAIM-TYPE         PIC X.
  1420           88  CP-AH-CLAIM                         VALUE 'A'.
  1421           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1422         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1423                                     COMP-3.
  1424         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1425                                     COMP-3.
  1426         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1427                                     COMP-3.
  1428         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1429                                     COMP-3.
  1430         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1431                                     COMP-3.
  1432         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1433                                     COMP-3.
  1434         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1435                                     COMP-3.
  1436         16  CP-REM-TERM-METHOD    PIC X.
  1437           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1438           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1439           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1440           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1441           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1442           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1443           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1444         16  CP-EARNING-METHOD     PIC X.
  1445           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1446           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1447           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1448           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1449           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1450           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1451           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1452           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1453           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1454           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1455           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1456           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1457           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1458           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1459         16  CP-PROCESS-TYPE       PIC X.
  1460           88  CP-CLAIM                            VALUE '1'.
  1461           88  CP-CANCEL                           VALUE '2'.
  1462           88  CP-ISSUE                            VALUE '3'.
  1463         16  CP-SPECIAL-CALC-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  29
* EL156.cbl
  1464           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1465           88  CP-1-MTH-INTEREST               VALUE ' '.
  1466           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1467           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1468           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1469           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1470           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1471           88  CP-FARM-PLAN                    VALUE 'F'.
  1472           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1473           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1474           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1475           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1476           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1477           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1478           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1479           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1480           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1481           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1482                                                     'W' 'X'.
  1483           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1484           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1485           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1486           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1487           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1488           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1489           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1490           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1491           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1492           88  CP-CSL-METH-1                   VALUE '5'.
  1493           88  CP-CSL-METH-2                   VALUE '6'.
  1494           88  CP-CSL-METH-3                   VALUE '7'.
  1495           88  CP-CSL-METH-4                   VALUE '8'.
  1496
  1497         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1498                                     COMP-3.
  1499         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1500         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1501         16  CP-STATE              PIC XX          VALUE SPACE.
  1502         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1503         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1504           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1505               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1506         16  CP-R78-OPTION         PIC X.
  1507           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1508           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1509
  1510         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1511         16  CP-IBNR-RESERVE-SW    PIC X.
  1512         16  CP-CLAIM-STATUS       PIC X.
  1513         16  CP-RATE-FILE          PIC X.
  1514         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1515                                     COMP-3.
  1516
  1517         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1518         16  CP-AH-OVERRIDE-CODE   PIC X.
  1519
  1520         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1521                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  30
* EL156.cbl
  1522         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1523                                   PIC S9(5)V99 COMP-3.
  1524         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1525                                     COMP-3.
  1526         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1527                                     COMP-3.
  1528         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1529                                     COMP-3.
  1530         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1531                                  PIC S9(7)V99 COMP-3.
  1532
  1533         16  CP-PAID-FROM-DATE     PIC X(02).
  1534         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1535         16  CP-EXT-DAYS-CALC      PIC X.
  1536           88  CP-EXT-NO-CHG                   VALUE ' '.
  1537           88  CP-EXT-CHG-LF                   VALUE '1'.
  1538           88  CP-EXT-CHG-AH                   VALUE '2'.
  1539           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1540         16  CP-DOMICILE-STATE     PIC XX.
  1541         16  CP-CARRIER            PIC X.
  1542         16  CP-REIN-FLAG          PIC X.
  1543         16  CP-REM-TRM-CALC-OPTION PIC X.
  1544           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1545                      '2' '3' '4' '5'.
  1546           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1547           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1548           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1549           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1550           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1551           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1552           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1553           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1554         16  CP-SIG-SWITCH         PIC X.
  1555         16  CP-RATING-METHOD      PIC X.
  1556           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1557           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1558           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1559           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1560           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1561           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1562           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1563           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1564           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1565         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1566                                     COMP-3.
  1567         16  CP-BEN-CATEGORY       PIC X.
  1568         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1569         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1570                                   PIC S99V9(5) COMP-3.
  1571         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1572         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1573                                   PIC S99V9(5) COMP-3.
  1574         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1575         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1576         16  CP-EXPIRE-DT          PIC XX.
  1577         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1578         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1579         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  31
* EL156.cbl
  1580         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1581         16  CP-DDF-SPEC-CALC      PIC X.
  1582             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1583             88  CP-CALC-CLP              VALUE 'C'.
  1584         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1585         16  CP-CANCEL-REASON      PIC X.
  1586         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1587         16  CP-PMT-MODE           PIC X.
  1588         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1589         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1590         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1591         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1592         16  FILLER                PIC X.
  1593
  1594***************    OUTPUT FROM ELRESV   ************************
  1595
  1596         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1597
  1598         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1599                                     COMP-3.
  1600         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1601                                     COMP-3.
  1602         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1603                                     COMP-3.
  1604         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1605                                     COMP-3.
  1606         16  FILLER                PIC X(09).
  1607***************    OUTPUT FROM ELRTRM   *************************
  1608
  1609         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1610                                     COMP-3.
  1611         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1612                                     COMP-3.
  1613         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1614                                     COMP-3.
  1615         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1616                                     COMP-3.
  1617         16  FILLER                PIC X(12).
  1618
  1619***************    OUTPUT FROM ELRAMT   *************************
  1620
  1621         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1622                                     COMP-3.
  1623         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1624                                     COMP-3.
  1625         16  FILLER                PIC X(12).
  1626
  1627***************    OUTPUT FROM ELRATE   *************************
  1628
  1629         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1630                                     COMP-3.
  1631         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1632                                     COMP-3.
  1633         16  CP-MORTALITY-CODE     PIC X(4).
  1634         16  CP-RATE-EDIT-FLAG     PIC X.
  1635             88  CP-RATES-NEED-APR                  VALUE '1'.
  1636         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1637                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  32
* EL156.cbl
  1638         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1639         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1640         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1641                                   PIC S9(7)V99 COMP-3.
  1642         16  FILLER                PIC X(07).
  1643
  1644***************    OUTPUT FROM ELRFND   *************************
  1645
  1646         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1647                                     COMP-3.
  1648         16  CP-REFUND-TYPE-USED   PIC X.
  1649           88  CP-R-AS-R78                         VALUE '1'.
  1650           88  CP-R-AS-PRORATA                     VALUE '2'.
  1651           88  CP-R-AS-CALIF                       VALUE '3'.
  1652           88  CP-R-AS-TEXAS                       VALUE '4'.
  1653           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1654           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1655           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1656           88  CP-R-AS-MEAN                        VALUE '8'.
  1657           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1658           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1659           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1660           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1661           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1662           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1663         16  FILLER                PIC X(12).
  1664
  1665***************    OUTPUT FROM ELEARN   *************************
  1666
  1667         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1668                                     COMP-3.
  1669         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1670                                     COMP-3.
  1671         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1672                                     COMP-3.
  1673         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1674                                     COMP-3.
  1675         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1676                                     COMP-3.
  1677         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1678                                     COMP-3.
  1679         16  CP-EARNING-TYPE-USED  PIC X.
  1680           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1681           88  CP-E-AS-R78                         VALUE '1'.
  1682           88  CP-E-AS-PRORATA                     VALUE '2'.
  1683           88  CP-E-AS-TEXAS                       VALUE '4'.
  1684           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1685           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1686           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1687           88  CP-E-AS-MEAN                        VALUE '8'.
  1688           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1689         16  FILLER                PIC X(12).
  1690
  1691***************    OUTPUT FROM ELPMNT   *************************
  1692
  1693         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1694                                     COMP-3.
  1695         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  33
* EL156.cbl
  1696                                     COMP-3.
  1697         16  FILLER                PIC X(12).
  1698
  1699***************   MISC WORK AREAS    *****************************
  1700         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1701                                     COMP-3.
  1702         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1703                                     COMP-3.
  1704         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1705                                     COMP-3.
  1706         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1707                                     COMP-3.
  1708         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1709                                     COMP-3.
  1710         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1711                                     COMP-3.
  1712         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1713             88  OPEN-RATE-FILE                   VALUE 'O'.
  1714             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1715             88  IO-ERROR                         VALUE 'E'.
  1716
  1717         16  CP-FIRST-PAY-DATE     PIC XX.
  1718
  1719         16  CP-JOINT-INDICATOR    PIC X.
  1720
  1721         16  CP-RESERVE-REMAINING-TERM
  1722                                   PIC S9(4)V9    VALUE ZERO
  1723                                     COMP-3.
  1724
  1725         16  CP-INSURED-BIRTH-DT   PIC XX.
  1726
  1727         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1728                                     COMP-3.
  1729
  1730         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1731                                     COMP-3.
  1732
  1733         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1734                                     COMP-3.
  1735
  1736         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1737                                     COMP-3.
  1738
  1739         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1740                                     COMP-3.
  1741
  1742         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1743                                     COMP-3.
  1744
  1745         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1746                                     COMP-3.
  1747
  1748         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1749             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1750
  1751         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1752                                     COMP-3.
  1753         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  34
* EL156.cbl
  1754                                     COMP-3.
  1755         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1756         16  cp-extra-periods      pic 9 value zeros.
  1757         16  cp-net-only-state     pic x value spaces.
  1758         16  FILLER                PIC X(13).
  1759******************************************************************
  1760*    COPY ELCICALC.
  1761******************************************************************
  1762*                                                                *
  1763*                           ELCCICALC.                           *
  1764*                            VMOD=2.001                          *
  1765*                                                                *
  1766*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1767*                 CALCULATION MODULE                             *
  1768*                                                                *
  1769*  PASSED TO ELCLMI                                              *
  1770*  -----------------                                             *
  1771*  STATE                                                         *
  1772*  PRODUCT                                                       *
  1773*  COVERAGE                                                      *
  1774*  EFFECTIVE DATE                                                *
  1775*  INCURRED DATE                                                 *
  1776*  ESTABLISHED DATE                                              *
  1777*  LAST PAID DATE                                                *
  1778*  REPORTED DATE                                                 *
  1779*  CLAIM PAYMENT AMOUNT                                          *
  1780*                                                                *
  1781*  RETURNED FROM ELRTRM                                          *
  1782*  ---------------------                                         *
  1783*  RETURN CODE                                                   *
  1784*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1785*  CLAIM INTEREST AMOUNT                                         *
  1786*----------------------------------------------------------------*
  1787*----------------------------------------------------------------*
  1788*                 LENGTH = 100                                   *
  1789*                                                                *
  1790******************************************************************
  1791******************************************************************
  1792*                   C H A N G E   L O G
  1793*
  1794* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1795*-----------------------------------------------------------------
  1796*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1797* EFFECTIVE    NUMBER
  1798*-----------------------------------------------------------------
  1799* 120905    2004040700004  PEMA  NEW COPYBOOK
  1800* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1801******************************************************************
  1802
  1803 01  CLAIM-INT-PASS-AREA.
  1804     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1805                                     COMP.
  1806
  1807     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1808       88  NO-CI-ERROR                             VALUE ZERO.
  1809       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1810       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1811       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  35
* EL156.cbl
  1812       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1813       88  CP-AMT-LT-5000                          VALUE '4'.
  1814       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1815       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1816       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1817       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1818***********************  INPUT AREAS ****************************
  1819
  1820     12  CP-CALCULATION-AREA.
  1821         16  CP-COMPANY-CD         PIC X.
  1822         16  CP-STATE              PIC XX.
  1823         16  CP-PRODUCT            PIC XX.
  1824         16  CP-COVERAGE           PIC XX.
  1825         16  CP-INC-DT             PIC XX.
  1826         16  CP-EST-DT             PIC XX.
  1827         16  CP-LSTPD-DT           PIC XX.
  1828         16  CP-RPT-DT             PIC XX.
  1829         16  CP-PRF-DT             PIC XX.
  1830         16  CP-EFF-DT             PIC XX.
  1831         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1832         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1833         16  FILLER                PIC X(37).
  1834
  1835***************    OUTPUT FROM ELCLMI   ************************
  1836
  1837         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1838
  1839         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1840         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1841         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1842         16  FILLER                PIC X(19).
  1843******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  36
* EL156.cbl
  1845*    COPY ELCATTR.
  1846******************************************************************
  1847*                                                                *
  1848*                            ELCATTR.                            *
  1849*                            VMOD=2.001                          *
  1850*                                                                *
  1851*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1852*                                                                *
  1853*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1854*                                                                *
  1855*                   POS 1   P=PROTECTED                          *
  1856*                           U=UNPROTECTED                        *
  1857*                           S=ASKIP                              *
  1858*                   POS 2   A=ALPHA/NUMERIC                      *
  1859*                           N=NUMERIC                            *
  1860*                   POS 3   N=NORMAL                             *
  1861*                           B=BRIGHT                             *
  1862*                           D=DARK                               *
  1863*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1864*                           OF=MODIFIED DATA TAG OFF             *
  1865*                                                                *
  1866*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1867******************************************************************
  1868 01  ATTRIBUTE-LIST.
  1869     12  AL-PABOF            PIC X       VALUE 'Y'.
  1870     12  AL-PABON            PIC X       VALUE 'Z'.
  1871     12  AL-PADOF            PIC X       VALUE '%'.
  1872     12  AL-PADON            PIC X       VALUE '_'.
  1873     12  AL-PANOF            PIC X       VALUE '-'.
  1874     12  AL-PANON            PIC X       VALUE '/'.
  1875     12  AL-SABOF            PIC X       VALUE '8'.
  1876     12  AL-SABON            PIC X       VALUE '9'.
  1877     12  AL-SADOF            PIC X       VALUE '@'.
  1878     12  AL-SADON            PIC X       VALUE QUOTE.
  1879     12  AL-SANOF            PIC X       VALUE '0'.
  1880     12  AL-SANON            PIC X       VALUE '1'.
  1881     12  AL-UABOF            PIC X       VALUE 'H'.
  1882     12  AL-UABON            PIC X       VALUE 'I'.
  1883     12  AL-UADOF            PIC X       VALUE '<'.
  1884     12  AL-UADON            PIC X       VALUE '('.
  1885     12  AL-UANOF            PIC X       VALUE ' '.
  1886     12  AL-UANON            PIC X       VALUE 'A'.
  1887     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1888     12  AL-UNBON            PIC X       VALUE 'R'.
  1889     12  AL-UNDOF            PIC X       VALUE '*'.
  1890     12  AL-UNDON            PIC X       VALUE ')'.
  1891     12  AL-UNNOF            PIC X       VALUE '&'.
  1892     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  37
* EL156.cbl
  1894*    COPY ELCEMIB.
  1895******************************************************************
  1896*                                                                *
  1897*                                                                *
  1898*                            ELCEMIB.                            *
  1899*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1900*                            VMOD=2.005                          *
  1901*                                                                *
  1902*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1903*                                                                *
  1904******************************************************************
  1905 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1906     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1907     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1908     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1909     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1910     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1911     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1912     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1913     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1914     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1915         88  EMI-NO-ERRORS                    VALUE '1'.
  1916         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1917         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1918     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1919         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1920     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1921         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1922         88  EMI-AREA1-FULL                   VALUE '2'.
  1923     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1924         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1925         88  EMI-AREA2-FULL                   VALUE '2'.
  1926     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1927         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1928         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1929         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1930         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1931         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1932     12  EMI-ERROR-LINES.
  1933         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1934         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1935         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1936         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1937             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1938                 24  EMI-ERR-NUM         PIC X(4).
  1939                 24  EMI-FILLER          PIC X.
  1940                 24  EMI-SEV             PIC X.
  1941                 24  FILLER              PIC X.
  1942             20  FILLER                  PIC X(02).
  1943     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1944         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1945             20  EMI-ERROR-NUMBER    PIC X(4).
  1946             20  EMI-FILL            PIC X.
  1947             20  EMI-SEVERITY        PIC X.
  1948             20  FILLER              PIC X.
  1949             20  EMI-ERROR-TEXT.
  1950                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1951                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  38
* EL156.cbl
  1952     12  EMI-SEVERITY-SAVE           PIC X.
  1953         88  EMI-NOTE                    VALUE 'N'.
  1954         88  EMI-WARNING                 VALUE 'W'.
  1955         88  EMI-FORCABLE                VALUE 'F'.
  1956         88  EMI-FATAL                   VALUE 'X'.
  1957     12  EMI-MESSAGE-FLAG            PIC X.
  1958         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1959         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1960     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1961     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1962         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1963         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1964         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1965     12  emi-claim-no                pic x(7).
  1966     12  emi-claim-type              pic x(6).
  1967     12  FILLER                      PIC X(124)  VALUE SPACES.
  1968     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1969     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1970     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1971     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  39
* EL156.cbl
  1973*    COPY ELCLNKLT.
  1974******************************************************************
  1975*                                                                *
  1976*                                                                *
  1977*                           ELCLNKLT                             *
  1978*                            VMOD=2.003                          *
  1979*                                                                *
  1980*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1981*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1982*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1983*                                                                *
  1984*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1985*   COMPLETING THE REQUIRED FIELDS.                              *
  1986*                                                                *
  1987*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1988*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1989*                              9999 INDICATES AN UNKNOWN ABEND   *
  1990*                                   WAS DETECTED.                *
  1991*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1992*                              CODES FOUND IN THE ERROR FILE.    *
  1993******************************************************************
  1994 01  W-1523-LINKDATA.
  1995     12  W-1523-COMMON-PI-DATA.
  1996         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1997         16  FILLER              PIC  X(67).
  1998         16  W-1523-COMPANY-CD   PIC  X(01).
  1999         16  FILLER              PIC  X(10).
  2000         16  W-1523-CONTROL-IN-PROGRESS.
  2001             20  W-1523-CARRIER  PIC  X(01).
  2002             20  W-1523-GROUPING PIC  X(06).
  2003             20  W-1523-STATE    PIC  X(02).
  2004             20  W-1523-ACCOUNT  PIC  X(10).
  2005             20  W-1523-CLAIM-CERT-GRP.
  2006                 24  W-1523-CLAIM-NO
  2007                                 PIC  X(07).
  2008                 24  W-1523-CERT-NO.
  2009                     28  W-1523-CERT-PRIME
  2010                                 PIC  X(10).
  2011                     28  W-1523-CERT-SFX
  2012                                 PIC  X(01).
  2013                 24  W-1523-CERT-EFF-DT
  2014                                 PIC  X(02).
  2015         16  FILLER              PIC X(265).
  2016
  2017     12  W-1523-WORK-AREA.
  2018         16  W-1523-FORM-NUMBER  PIC  X(04).
  2019         16  W-1523-NUMBER-COPIES
  2020                                 PIC  9(01).
  2021         16  W-1523-ADDR-TYPE    PIC  X(02).
  2022         16  W-1523-FOLLOW-UP-DATE
  2023                                 PIC  X(02).
  2024         16  W-1523-RESEND-DATE  PIC  X(02).
  2025         16  W-1523-ERROR-CODE   PIC  9(04).
  2026             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  2027             88  W-1523-FATAL-ERROR
  2028                                    VALUES  0006 0013 0042
  2029                                            0154 0168 0169
  2030                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  40
* EL156.cbl
  2031                                            0179 0186 0281
  2032                                            0332 2055 3697
  2033                                            3698 3699 3770
  2034                                            3771 3772 7675
  2035                                            9106 9808 9883
  2036                                            9887.
  2037             88  W-1523-STOP-ERRORS
  2038                                    VALUES  0013 0042 0154
  2039                                            0168 0169 0172
  2040                                            0281 0332 2055
  2041                                            3698 3699 7675
  2042                                            9106 9808 9883
  2043                                            9999.
  2044         16  W-1523-REASON       PIC  X(70).
  2045         16  W-1523-ARCHIVE-NUMBER
  2046                                 PIC  9(08).
  2047     12  W-1523-POINTER-AREA.
  2048         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2049         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2050         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2051         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2052         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  41
* EL156.cbl
  2054*    COPY ELCNWA.
  2055*****************************************************************
  2056*                                                               *
  2057*                                                               *
  2058*                            ELCNWA.                            *
  2059*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2060*                            VMOD=2.003                         *
  2061*                                                               *
  2062*            M O V E   N A M E   W O R K   A R E A.             *
  2063*                                                               *
  2064*****************************************************************.
  2065
  2066 01  WS-NAME-WORK-AREA.
  2067     05  WS-INSURED-LAST-NAME        PIC X(15).
  2068     05  WS-INSURED-1ST-NAME         PIC X(12).
  2069     05  WS-INSURED-MID-INIT         PIC X.
  2070
  2071     05  WS-NAME-WORK.
  2072         10  WS-NW                   PIC X
  2073             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2074
  2075     05  WS-NAME-WORK2.
  2076         10  WS-NW2                  PIC X
  2077             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2078                                        NWA-INDEX0.
  2079
  2080     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2081                                     COMP-3.
  2082
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  42
* EL156.cbl
  2084*    COPY ELCDMO.
  2085******************************************************************
  2086*                                                                *
  2087*                                                                *
  2088*                            ELCDMO.                             *
  2089*                            VMOD=2.004                          *
  2090*                                                                *
  2091*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2092*        COMMUNICATION AREA                                      *
  2093*   FILE TYPE = NA                                               *
  2094*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2095*                                                                *
  2096******************************************************************
  2097 01  DMO-COMMUNICATION-AREA.
  2098     12  DM-RECORD-TYPE                  PIC  X(02).
  2099             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2100             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2101             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2102     12  DM-DIST-CODE                    PIC  X(04).
  2103     12  DM-MAIL-CODE                    PIC  X(05).
  2104     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2105     12  DM-INSURED-NAME                 PIC  X(30).
  2106     12  DM-CLAIM-NO                     PIC  X(07).
  2107     12  DM-CLAIM-TYPE                   PIC  X.
  2108
  2109     12  DM-STATUS-DATA-AREA.
  2110         16  DM-CLAIM-STATUS             PIC  X.
  2111             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2112             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2113             88  DM-CLOSED                        VALUE '3'.
  2114             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2115             88  DM-DEFAULT                       VALUE '9'.
  2116         16  DM-STATUS-DATE              PIC  X(08).
  2117******YYYYMMDD
  2118         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2119             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2120             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2121             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2122             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2123             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2124             88  DM-RE-OPENED                     VALUE 'R'.
  2125             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2126             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2127             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2128         16  DM-STAT-CARRIER             PIC X.
  2129
  2130     12  DM-DRAFT-DATA-AREA.
  2131         16  DM-PAYMENT-TYPE             PIC  X.
  2132             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2133         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2134         16  DM-PAYMENT-DATE             PIC  X(08).
  2135******YYYYMMDD
  2136         16  DM-CERT-NO                  PIC  X(11).
  2137         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2138         16  DM-CARRIER                  PIC  X.
  2139
  2140     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  43
* EL156.cbl
  2142*    COPY ELCDMDCD.
  2143******************************************************************
  2144*                                                                *
  2145*                                                                *
  2146*                            ELCDMDCD.                           *
  2147*                            VMOD=2.001                          *
  2148*                                                                *
  2149*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2150*       COMMUNICATIONS AREA                                      *
  2151*                                                                *
  2152******************************************************************
  2153 01  CD-COMMUNICATION-AREA.
  2154     12  CD-SYSTEM-ID            PIC  X(02).
  2155         88 CD-CLAIMS                      VALUE 'CL'.
  2156         88 CD-CREDIT                      VALUE 'CR'.
  2157     12  CD-RECORD-TYPE          PIC  X(02).
  2158         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2159         88 CD-EOB-CODE                    VALUE 'EO'.
  2160         88 CD-ICD9-CODE                   VALUE 'I9'.
  2161         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2162         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2163         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2164         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2165         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2166     12  CD-RECORD-KEY           PIC  X(06).
  2167         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2168     12  CD-RETURN-CODE          PIC  X(02).
  2169     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2170     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2171     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2172     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  44
* EL156.cbl
  2174*    COPY ELCDCTB.
  2175******************************************************************
  2176*                                                                *
  2177*                                                                *
  2178*                            ELCDCTB.                            *
  2179*                            VMOD=2.002                          *
  2180*                                                                *
  2181*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2182*       COMMUNICATIONS AREA                                      *
  2183*                                                                *
  2184******************************************************************
  2185 01  DCT-COMMUNICATION-AREA.
  2186     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2187     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2188     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2189     12  DCT-PRODUCT-CODE         PIC  X(02).
  2190     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2191     12  DCT-RETURN-CODE          PIC  X(02).
  2192     12  DCT-MAIL-CODE            PIC  X(05).
  2193     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2194     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  45
* EL156.cbl
  2196 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2197 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2198 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2199 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  46
* EL156.cbl
  2201*    COPY ELCINTF.
  2202******************************************************************
  2203*                                                                *
  2204*                                                                *
  2205*                            ELCINTF.                            *
  2206*                            VMOD=2.017                          *
  2207*                                                                *
  2208*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2209*                                                                *
  2210*       LENGTH = 1024                                            *
  2211*                                                                *
  2212******************************************************************
  2213*                   C H A N G E   L O G
  2214*
  2215* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2216*-----------------------------------------------------------------
  2217*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2218* EFFECTIVE    NUMBER
  2219*-----------------------------------------------------------------
  2220* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2221******************************************************************
  2222 01  PROGRAM-INTERFACE-BLOCK.
  2223     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2224     12  PI-CALLING-PROGRAM              PIC X(8).
  2225     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2226     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2227     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2228     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2229     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2230     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2231     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2232     12  PI-COMPANY-ID                   PIC XXX.
  2233     12  PI-COMPANY-CD                   PIC X.
  2234
  2235     12  PI-COMPANY-PASSWORD             PIC X(8).
  2236
  2237     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2238
  2239     12  PI-CONTROL-IN-PROGRESS.
  2240         16  PI-CARRIER                  PIC X.
  2241         16  PI-GROUPING                 PIC X(6).
  2242         16  PI-STATE                    PIC XX.
  2243         16  PI-ACCOUNT                  PIC X(10).
  2244         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2245                                         PIC X(10).
  2246         16  PI-CLAIM-CERT-GRP.
  2247             20  PI-CLAIM-NO             PIC X(7).
  2248             20  PI-CERT-NO.
  2249                 25  PI-CERT-PRIME       PIC X(10).
  2250                 25  PI-CERT-SFX         PIC X.
  2251             20  PI-CERT-EFF-DT          PIC XX.
  2252         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2253             20  PI-PLAN-CODE            PIC X(2).
  2254             20  PI-REVISION-NUMBER      PIC X(3).
  2255             20  PI-PLAN-EFF-DT          PIC X(2).
  2256             20  PI-PLAN-EXP-DT          PIC X(2).
  2257             20  FILLER                  PIC X(11).
  2258         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  47
* EL156.cbl
  2259             20  PI-OE-REFERENCE-1.
  2260                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2261                 25  PI-OE-REF-1-SUFF    PIC XX.
  2262
  2263     12  PI-SESSION-IN-PROGRESS          PIC X.
  2264         88  CLAIM-SESSION                   VALUE '1'.
  2265         88  CREDIT-SESSION                  VALUE '2'.
  2266         88  WARRANTY-SESSION                VALUE '3'.
  2267         88  MORTGAGE-SESSION                VALUE '4'.
  2268         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2269
  2270
  2271*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2272
  2273     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2274     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2275
  2276     12  PI-CREDIT-USER                  PIC X.
  2277         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2278         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2279
  2280     12  PI-CLAIM-USER                   PIC X.
  2281         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2282         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2283
  2284     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2285         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2286         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2287         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2288         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2289         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2290
  2291     12  PI-PROCESSOR-ID                 PIC X(4).
  2292
  2293     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2294
  2295     12  PI-MEMBER-CAPTION               PIC X(10).
  2296
  2297     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2298         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2299
  2300     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2301     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2302     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2303     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2304
  2305     12  PI-AH-OVERRIDE-L1               PIC X.
  2306     12  PI-AH-OVERRIDE-L2               PIC XX.
  2307     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2308     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2309
  2310     12  PI-NEW-SYSTEM                   PIC X(2).
  2311
  2312     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2313     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2314         88  PI-USES-PAID-TO                 VALUE '1'.
  2315     12  PI-CRDTCRD-SYSTEM.
  2316         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  48
* EL156.cbl
  2317             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2318             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2319         16  PI-CC-MONTH-END-DT          PIC XX.
  2320     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2321
  2322     12  PI-OE-REFERENCE-2.
  2323         16  PI-OE-REF-2-PRIME           PIC X(10).
  2324         16  PI-OE-REF-2-SUFF            PIC X.
  2325
  2326     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2327
  2328     12  PI-LANGUAGE-TYPE                PIC X.
  2329             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2330             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2331             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2332
  2333     12  PI-POLICY-LINKAGE-IND           PIC X.
  2334         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2335         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2336                                                   LOW-VALUES.
  2337
  2338     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2339     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2340         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2341         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2342
  2343     12  PI-PROCESSOR-CSR-IND            PIC X.
  2344         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2345         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2346
  2347     12  FILLER                          PIC X(3).
  2348
  2349     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2350
  2351     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2352         PI-SYSTEM-LEVEL.
  2353
  2354         16  PI-ENTRY-CODES.
  2355             20  PI-ENTRY-CD-1           PIC X.
  2356             20  PI-ENTRY-CD-2           PIC X.
  2357
  2358         16  PI-RETURN-CODES.
  2359             20  PI-RETURN-CD-1          PIC X.
  2360             20  PI-RETURN-CD-2          PIC X.
  2361
  2362         16  PI-UPDATE-STATUS-SAVE.
  2363             20  PI-UPDATE-BY            PIC X(4).
  2364             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2365
  2366         16  PI-LOWER-CASE-LETTERS       PIC X.
  2367             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2368
  2369*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2370*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2371*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2372
  2373         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2374             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  49
* EL156.cbl
  2375             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2376             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2377             88  ACCNT-CNTL                  VALUE '3'.
  2378             88  CARR-ACCNT-CNTL             VALUE '4'.
  2379
  2380         16  PI-PROCESSOR-CAP-LIST.
  2381             20  PI-SYSTEM-CONTROLS.
  2382                24 PI-SYSTEM-DISPLAY     PIC X.
  2383                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2384                24 PI-SYSTEM-MODIFY      PIC X.
  2385                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2386             20  FILLER                  PIC XX.
  2387             20  PI-DISPLAY-CAP          PIC X.
  2388                 88  DISPLAY-CAP             VALUE 'Y'.
  2389             20  PI-MODIFY-CAP           PIC X.
  2390                 88  MODIFY-CAP              VALUE 'Y'.
  2391             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2392                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2393             20  PI-FORCE-CAP            PIC X.
  2394                 88  FORCE-CAP               VALUE 'Y'.
  2395
  2396         16  PI-PROGRAM-CONTROLS.
  2397             20  PI-PGM-PRINT-OPT        PIC X.
  2398             20  PI-PGM-FORMAT-OPT       PIC X.
  2399             20  PI-PGM-PROCESS-OPT      PIC X.
  2400             20  PI-PGM-TOTALS-OPT       PIC X.
  2401
  2402         16  PI-HELP-INTERFACE.
  2403             20  PI-LAST-ERROR-NO        PIC X(4).
  2404             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2405
  2406         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2407             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2408
  2409         16  PI-CR-CONTROL-IN-PROGRESS.
  2410             20  PI-CR-CARRIER           PIC X.
  2411             20  PI-CR-GROUPING          PIC X(6).
  2412             20  PI-CR-STATE             PIC XX.
  2413             20  PI-CR-ACCOUNT           PIC X(10).
  2414             20  PI-CR-FIN-RESP          PIC X(10).
  2415             20  PI-CR-TYPE              PIC X.
  2416
  2417         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2418
  2419         16  PI-CR-MONTH-END-DT          PIC XX.
  2420
  2421         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2422             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2423             88  PI-ZERO-CARRIER             VALUE '1'.
  2424             88  PI-ZERO-GROUPING            VALUE '2'.
  2425             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2426
  2427         16  PI-CARRIER-SECURITY         PIC X.
  2428             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2429
  2430         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2431             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2432             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  50
* EL156.cbl
  2433
  2434         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2435             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2436                                         INDEXED BY PI-ACCESS-NDX
  2437                                         PIC X.
  2438
  2439         16  PI-GA-BILLING-CONTROL       PIC X.
  2440             88  PI-GA-BILLING               VALUE '1'.
  2441
  2442         16  PI-MAIL-PROCESSING          PIC X.
  2443             88  PI-MAIL-YES                 VALUE 'Y'.
  2444
  2445         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2446
  2447         16  PI-AR-SYSTEM.
  2448             20  PI-AR-PROCESSING-CNTL   PIC X.
  2449                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2450             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2451             20  PI-AR-MONTH-END-DT      PIC XX.
  2452
  2453         16  PI-MP-SYSTEM.
  2454             20  PI-MORTGAGE-USER            PIC X.
  2455                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2456                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2457             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2458                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2459                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2460                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2461                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2462                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2463             20  PI-MP-MONTH-END-DT          PIC XX.
  2464             20  PI-MP-REFERENCE-NO.
  2465                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2466                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2467
  2468         16  PI-LABEL-CONTROL            PIC X(01).
  2469             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2470             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2471
  2472         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2473             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2474
  2475         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2476             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2477             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2478
  2479         16  FILLER                      PIC X(14).
  2480
  2481     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2482******************************************************************
  2483     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2484         16  PI-SAVE-FORM        PIC X(12).
  2485         16  PI-ACCT-KEY         PIC X(26).
  2486         16  PI-PAYEE-NAME       PIC X(30).
  2487         16  PI-DAILY-RATE       PIC S9(3)V99.
  2488         16  PI-MONTH-END-SAVE   PIC XX.
  2489         16  PI-BENEFIT-SAVE.
  2490             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  51
* EL156.cbl
  2491             20  PI-BEN-TYPE     PIC X.
  2492         16  PI-MANUAL-SW        PIC 9.
  2493         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2494         16  PI-PASS-SW          PIC X.
  2495         16  PI-PFKEY-USED       PIC X.
  2496         16  PI-CK-ASSIGN        PIC X.
  2497         16  PI-FATAL-COUNT      PIC 99.
  2498         16  PI-FORCE-COUNT      PIC 99.
  2499         16  PI-SAVE-INPUT.
  2500             20  PI-PMTTYPE      PIC X.
  2501             20  PI-PAYEE.
  2502                 24  PI-PAYEE-TYPE PIC X.
  2503                 24  PI-PAYEE-SEQ  PIC X.
  2504                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2505                   PI-PAYEE-SEQ    PIC S9.
  2506             20  PI-PMTNOTE1     PIC X(60).
  2507             20  PI-PMTNOTE2     PIC X(60).
  2508             20  PI-OFFLINE      PIC X.
  2509             20  PI-ECHECKNO     PIC X(7).
  2510             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2511                 28  PI-ECHECKNO-N     PIC X.
  2512                 28  PI-ECHECKNO-6     PIC X(6).
  2513             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2514                 24  PI-ECHECKNO-CR    PIC XX.
  2515                 24  PI-ECHECKNO-5     PIC X(5).
  2516             20  PI-HOLDTIL      PIC 9(6).
  2517             20  PI-EPYFROM      PIC 9(6).
  2518             20  PI-EPYTHRU      PIC 9(6).
  2519             20  PI-EDAYS        PIC S9(5).
  2520             20  PI-EPYAMT       PIC S9(7)V99.
  2521             20  PI-ERESV        PIC S9(7)V99.
  2522             20  PI-EEXPENS      PIC 9(6)V99.
  2523             20  PI-ETYPE        PIC X.
  2524             20  PI-CASH         PIC X.
  2525             20  PI-GROUPED      PIC X.
  2526             20  PI-INT-RATE     PIC S99V9(5).
  2527             20  PI-AIGFROM      PIC 9(6).
  2528             20  PI-LOAN-NO      PIC X(20).
  2529             20  PI-PROOF-DATE   PIC 9(6).
  2530             20  PI-PRINT-EOB-YN PIC X.
  2531             20  PI-PRINT-CLM-FRM-YN PIC X.
  2532             20  PI-PRINT-SURVEY-YN PIC X.
  2533             20  PI-SPECIAL-RELEASE-YN PIC X.
  2534             20  pi-int-to-rem-borr pic x.
  2535         16  PI-SAVE-COMPUTED.
  2536             20  PI-CCHECKNO     PIC X(7).
  2537             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2538                 28  PI-CCHECKNO-N     PIC X.
  2539                 28  PI-CCHECKNO-6     PIC X(6).
  2540             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2541                 24  PI-CCHECKNO-CR    PIC XX.
  2542                 24  PI-CCHECKNO-5     PIC X(5).
  2543             20  PI-CPYFROM      PIC XX.
  2544             20  PI-CPYTHRU      PIC XX.
  2545             20  PI-CDAYS        PIC S9(5).
  2546             20  PI-CPYAMT       PIC S9(7)V99.
  2547             20  PI-CRESV        PIC 9(6)V99.
  2548             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  52
* EL156.cbl
  2549             20  PI-PMT-APPR-SW  PIC X.
  2550                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2551                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2552                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2553         16  PI-PREV-CLMNO       PIC X(7).
  2554         16  PI-LF-COVERAGE-TYPE PIC X.
  2555         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2556         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2557         16  PI-PROVISIONAL-IND  PIC X.
  2558             88 PI-PROV-PMT      VALUE 'P'.
  2559         16  PI-PREV-TRLR-KEY    PIC X(22).
  2560         16  PI-SPLIT-PMT-SW     PIC X.
  2561         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2562         16  PI-ACTIVITY-CODE    PIC 99.
  2563         16  PI-RESET-SW         PIC X.
  2564         16  PI-SPECIAL-BEN-SW   PIC X.
  2565             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2566         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2567         16  PI-EXP-DT           PIC XX.
  2568         16  PI-LOAN-DUE-DAY     PIC 99.
  2569         16  PI-3RD-PARTY-SW     PIC X.
  2570         16  PI-LOAN-UPDATE-SW   PIC X.
  2571
  2572         16  PI-DMD-DATA.
  2573             20  PI-SV-CERT-KEY       PIC X(21).
  2574             20  PI-SV-CERT-NO        PIC X(11).
  2575             20  PI-SV-BEN            PIC X(10).
  2576             20  PI-SV-CCN            PIC X(16).
  2577             20  PI-INTEREST-PAID-IND PIC X.
  2578                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2579             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2580             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2581             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2582             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2583         16  PI-AT-EOB-CODES.
  2584             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2585         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2586         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2587         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2588         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2589         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2590         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2591         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2592         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2593         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2594         16  PI-LF-BENEFIT-CD         PIC X(2).
  2595         16  PI-EOB-CODES-EXIST PIC X.
  2596         16  PI-SET-NOTE2-MDT   PIC X.
  2597         16  PI-VFY-2ND-BENE          PIC X.
  2598         16  PI-CLM-TYPE              PIC X.
  2599         16  PI-APPROVAL-LEVEL        PIC X.
  2600         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2601         16  PI-REAUDIT-NEEDED        PIC X.
  2602         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2603         16  PI-AH-BENEFIT-CD         PIC XX.
  2604         16  pi-ah-term               pic s999 comp-3.
  2605         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2606         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  53
* EL156.cbl
  2607         16  pi-max-ext-used          pic x.
  2608         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2609         16  PI-JOINT-COV-IND         PIC X.
  2610             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2611             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2612         16  PI-JOINT-INSURED-IND     PIC X.
  2613             88  PI-JOINT-INSURED        VALUE 'Y'.
  2614             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2615         16  pi-int-payees-name       pic x(30).
  2616         16  PI-RB-JOINT-COV-IND      PIC X.
  2617             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2618             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2619         16  pi-ach-payment           pic x.
  2620         16  PI-DUPE-APPROVAL-NEEDED  PIC X.
  2621*00781          16  FILLER                   PIC X(176).
  2622*052506         16  FILLER                   PIC X(161).
  2623*031808         16  FILLER                   PIC X(154).
  2624*091808         16  FILLER                   PIC X(152).
  2625*041710         16  FILLER                   PIC X(94).
  2626         16  FILLER                   PIC X(33).
  2627
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  54
* EL156.cbl
  2629*    COPY ELCJPFX.
  2630******************************************************************
  2631*                                                                *
  2632*                                                                *
  2633*                            ELCJPFX.                            *
  2634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2635*                            VMOD=2.002                          *
  2636*                                                                *
  2637*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2638*                                                                *
  2639*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2640*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2641*        ELCNTL - CONTROL FILE                                   *
  2642*        ELMSTR - CLAIM MASTERS                                  *
  2643*        ELTRLR - ACTIVITY TRAILERS                              *
  2644*        ELCHKQ - CHECK QUE                                      *
  2645******************************************************************
  2646 01  JOURNAL-RECORD.
  2647     12  jp-date                     pic s9(5) comp-3.
  2648     12  jp-time                     pic s9(7) comp-3.
  2649     12  JP-USER-ID                  PIC X(4).
  2650     12  JP-FILE-ID                  PIC X(8).
  2651     12  JP-PROGRAM-ID               PIC X(8).
  2652     12  JP-RECORD-TYPE              PIC X.
  2653         88 JP-ADD              VALUE 'A'.
  2654         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2655         88 JP-AFTER-CHANGE     VALUE 'C'.
  2656         88 JP-DELETE           VALUE 'D'.
  2657         88 JP-GENERIC-DELETE   VALUE 'G'.
  2658         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2659         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2660     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2661     12  JP-RECORD-AREA
  2662
  2663
  2664                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  55
* EL156.cbl
  2666*    COPY ELCAID.
  2667******************************************************************
  2668*                                                                *
  2669*                            ELCAID.                             *
  2670*                            VMOD=2.001                          *
  2671*                                                                *
  2672*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2673*                                                                *
  2674*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2675*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2676******************************************************************
  2677
  2678 01  DFHAID.
  2679   02  DFHNULL   PIC  X  VALUE  ' '.
  2680   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2681   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2682   02  DFHPEN    PIC  X  VALUE  '='.
  2683   02  DFHOPID   PIC  X  VALUE  'W'.
  2684   02  DFHPA1    PIC  X  VALUE  '%'.
  2685   02  DFHPA2    PIC  X  VALUE  '>'.
  2686   02  DFHPA3    PIC  X  VALUE  ','.
  2687   02  DFHPF1    PIC  X  VALUE  '1'.
  2688   02  DFHPF2    PIC  X  VALUE  '2'.
  2689   02  DFHPF3    PIC  X  VALUE  '3'.
  2690   02  DFHPF4    PIC  X  VALUE  '4'.
  2691   02  DFHPF5    PIC  X  VALUE  '5'.
  2692   02  DFHPF6    PIC  X  VALUE  '6'.
  2693   02  DFHPF7    PIC  X  VALUE  '7'.
  2694   02  DFHPF8    PIC  X  VALUE  '8'.
  2695   02  DFHPF9    PIC  X  VALUE  '9'.
  2696   02  DFHPF10   PIC  X  VALUE  ':'.
  2697   02  DFHPF11   PIC  X  VALUE  '#'.
  2698   02  DFHPF12   PIC  X  VALUE  '@'.
  2699   02  DFHPF13   PIC  X  VALUE  'A'.
  2700   02  DFHPF14   PIC  X  VALUE  'B'.
  2701   02  DFHPF15   PIC  X  VALUE  'C'.
  2702   02  DFHPF16   PIC  X  VALUE  'D'.
  2703   02  DFHPF17   PIC  X  VALUE  'E'.
  2704   02  DFHPF18   PIC  X  VALUE  'F'.
  2705   02  DFHPF19   PIC  X  VALUE  'G'.
  2706   02  DFHPF20   PIC  X  VALUE  'H'.
  2707   02  DFHPF21   PIC  X  VALUE  'I'.
  2708*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2709   02  DFHPF22   PIC  X  VALUE  '['.
  2710   02  DFHPF23   PIC  X  VALUE  '.'.
  2711   02  DFHPF24   PIC  X  VALUE  '<'.
  2712   02  DFHMSRE   PIC  X  VALUE  'X'.
  2713   02  DFHSTRF   PIC  X  VALUE  'h'.
  2714   02  DFHTRIG   PIC  X  VALUE  '"'.
  2715 01  FILLER    REDEFINES DFHAID.
  2716     12  FILLER              PIC X(8).
  2717     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  56
* EL156.cbl
  2719*    COPY EL156S.
  2720 01  EL156AI.
  2721     05  FILLER            PIC  X(0012).
  2722*    -------------------------------
  2723     05  RUNDTEAL PIC S9(0004) COMP.
  2724     05  RUNDTEAF PIC  X(0001).
  2725     05  FILLER REDEFINES RUNDTEAF.
  2726         10  RUNDTEAA PIC  X(0001).
  2727     05  RUNDTEAI PIC  X(0008).
  2728*    -------------------------------
  2729     05  RUNTIMAL PIC S9(0004) COMP.
  2730     05  RUNTIMAF PIC  X(0001).
  2731     05  FILLER REDEFINES RUNTIMAF.
  2732         10  RUNTIMAA PIC  X(0001).
  2733     05  RUNTIMAI PIC  X(0005).
  2734*    -------------------------------
  2735     05  SEQUL PIC S9(0004) COMP.
  2736     05  SEQUF PIC  X(0001).
  2737     05  FILLER REDEFINES SEQUF.
  2738         10  SEQUA PIC  X(0001).
  2739     05  SEQUI PIC  X(0010).
  2740*    -------------------------------
  2741     05  CLMNOL PIC S9(0004) COMP.
  2742     05  CLMNOF PIC  X(0001).
  2743     05  FILLER REDEFINES CLMNOF.
  2744         10  CLMNOA PIC  X(0001).
  2745     05  CLMNOI PIC  X(0007).
  2746*    -------------------------------
  2747     05  CARRL PIC S9(0004) COMP.
  2748     05  CARRF PIC  X(0001).
  2749     05  FILLER REDEFINES CARRF.
  2750         10  CARRA PIC  X(0001).
  2751     05  CARRI PIC  X(0001).
  2752*    -------------------------------
  2753     05  CERTNOL PIC S9(0004) COMP.
  2754     05  CERTNOF PIC  X(0001).
  2755     05  FILLER REDEFINES CERTNOF.
  2756         10  CERTNOA PIC  X(0001).
  2757     05  CERTNOI PIC  X(0010).
  2758*    -------------------------------
  2759     05  SUFXL PIC S9(0004) COMP.
  2760     05  SUFXF PIC  X(0001).
  2761     05  FILLER REDEFINES SUFXF.
  2762         10  SUFXA PIC  X(0001).
  2763     05  SUFXI PIC  X(0001).
  2764*    -------------------------------
  2765     05  CLMTYPL PIC S9(0004) COMP.
  2766     05  CLMTYPF PIC  X(0001).
  2767     05  FILLER REDEFINES CLMTYPF.
  2768         10  CLMTYPA PIC  X(0001).
  2769     05  CLMTYPI PIC  X(0006).
  2770*    -------------------------------
  2771     05  CLMSTATL PIC S9(0004) COMP.
  2772     05  CLMSTATF PIC  X(0001).
  2773     05  FILLER REDEFINES CLMSTATF.
  2774         10  CLMSTATA PIC  X(0001).
  2775     05  CLMSTATI PIC  X(0006).
  2776*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  57
* EL156.cbl
  2777     05  LSTNMEL PIC S9(0004) COMP.
  2778     05  LSTNMEF PIC  X(0001).
  2779     05  FILLER REDEFINES LSTNMEF.
  2780         10  LSTNMEA PIC  X(0001).
  2781     05  LSTNMEI PIC  X(0015).
  2782*    -------------------------------
  2783     05  FSTNMEL PIC S9(0004) COMP.
  2784     05  FSTNMEF PIC  X(0001).
  2785     05  FILLER REDEFINES FSTNMEF.
  2786         10  FSTNMEA PIC  X(0001).
  2787     05  FSTNMEI PIC  X(0012).
  2788*    -------------------------------
  2789     05  MINITL PIC S9(0004) COMP.
  2790     05  MINITF PIC  X(0001).
  2791     05  FILLER REDEFINES MINITF.
  2792         10  MINITA PIC  X(0001).
  2793     05  MINITI PIC  X(0001).
  2794*    -------------------------------
  2795     05  PRIMHDGL PIC S9(0004) COMP.
  2796     05  PRIMHDGF PIC  X(0001).
  2797     05  FILLER REDEFINES PRIMHDGF.
  2798         10  PRIMHDGA PIC  X(0001).
  2799     05  PRIMHDGI PIC  X(0012).
  2800*    -------------------------------
  2801     05  PCERTNOL PIC S9(0004) COMP.
  2802     05  PCERTNOF PIC  X(0001).
  2803     05  FILLER REDEFINES PCERTNOF.
  2804         10  PCERTNOA PIC  X(0001).
  2805     05  PCERTNOI PIC  X(0010).
  2806*    -------------------------------
  2807     05  PSUFXL PIC S9(0004) COMP.
  2808     05  PSUFXF PIC  X(0001).
  2809     05  FILLER REDEFINES PSUFXF.
  2810         10  PSUFXA PIC  X(0001).
  2811     05  PSUFXI PIC  X(0001).
  2812*    -------------------------------
  2813     05  STATUSL PIC S9(0004) COMP.
  2814     05  STATUSF PIC  X(0001).
  2815     05  FILLER REDEFINES STATUSF.
  2816         10  STATUSA PIC  X(0001).
  2817     05  STATUSI PIC  X(0010).
  2818*    -------------------------------
  2819     05  LOANHL PIC S9(0004) COMP.
  2820     05  LOANHF PIC  X(0001).
  2821     05  FILLER REDEFINES LOANHF.
  2822         10  LOANHA PIC  X(0001).
  2823     05  LOANHI PIC  X(0014).
  2824*    -------------------------------
  2825     05  LOANNOL PIC S9(0004) COMP.
  2826     05  LOANNOF PIC  X(0001).
  2827     05  FILLER REDEFINES LOANNOF.
  2828         10  LOANNOA PIC  X(0001).
  2829     05  LOANNOI PIC  X(0025).
  2830*    -------------------------------
  2831     05  DUEDAYHL PIC S9(0004) COMP.
  2832     05  DUEDAYHF PIC  X(0001).
  2833     05  FILLER REDEFINES DUEDAYHF.
  2834         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  58
* EL156.cbl
  2835     05  DUEDAYHI PIC  X(0008).
  2836*    -------------------------------
  2837     05  DUEDAYL PIC S9(0004) COMP.
  2838     05  DUEDAYF PIC  X(0001).
  2839     05  FILLER REDEFINES DUEDAYF.
  2840         10  DUEDAYA PIC  X(0001).
  2841     05  DUEDAYI PIC  X(0002).
  2842*    -------------------------------
  2843     05  ZINTHL PIC S9(0004) COMP.
  2844     05  ZINTHF PIC  X(0001).
  2845     05  FILLER REDEFINES ZINTHF.
  2846         10  ZINTHA PIC  X(0001).
  2847     05  ZINTHI PIC  X(0009).
  2848*    -------------------------------
  2849     05  ZINTL PIC S9(0004) COMP.
  2850     05  ZINTF PIC  X(0001).
  2851     05  FILLER REDEFINES ZINTF.
  2852         10  ZINTA PIC  X(0001).
  2853     05  ZINTI PIC  99V99999.
  2854*    -------------------------------
  2855     05  PTHRHDGL PIC S9(0004) COMP.
  2856     05  PTHRHDGF PIC  X(0001).
  2857     05  FILLER REDEFINES PTHRHDGF.
  2858         10  PTHRHDGA PIC  X(0001).
  2859     05  PTHRHDGI PIC  X(0014).
  2860*    -------------------------------
  2861     05  PDTHRUL PIC S9(0004) COMP.
  2862     05  PDTHRUF PIC  X(0001).
  2863     05  FILLER REDEFINES PDTHRUF.
  2864         10  PDTHRUA PIC  X(0001).
  2865     05  PDTHRUI PIC  X(0008).
  2866*    -------------------------------
  2867     05  TOTPAIDL PIC S9(0004) COMP.
  2868     05  TOTPAIDF PIC  X(0001).
  2869     05  FILLER REDEFINES TOTPAIDF.
  2870         10  TOTPAIDA PIC  X(0001).
  2871     05  TOTPAIDI PIC  X(0010).
  2872*    -------------------------------
  2873     05  COVERL PIC S9(0004) COMP.
  2874     05  COVERF PIC  X(0001).
  2875     05  FILLER REDEFINES COVERF.
  2876         10  COVERA PIC  X(0001).
  2877     05  COVERI PIC  X(0010).
  2878*    -------------------------------
  2879     05  INCURL PIC S9(0004) COMP.
  2880     05  INCURF PIC  X(0001).
  2881     05  FILLER REDEFINES INCURF.
  2882         10  INCURA PIC  X(0001).
  2883     05  INCURI PIC  X(0008).
  2884*    -------------------------------
  2885     05  LSTDTEL PIC S9(0004) COMP.
  2886     05  LSTDTEF PIC  X(0001).
  2887     05  FILLER REDEFINES LSTDTEF.
  2888         10  LSTDTEA PIC  X(0001).
  2889     05  LSTDTEI PIC  X(0008).
  2890*    -------------------------------
  2891     05  CRTSTATL PIC S9(0004) COMP.
  2892     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  59
* EL156.cbl
  2893     05  FILLER REDEFINES CRTSTATF.
  2894         10  CRTSTATA PIC  X(0001).
  2895     05  CRTSTATI PIC  X(0010).
  2896*    -------------------------------
  2897     05  EFFECTL PIC S9(0004) COMP.
  2898     05  EFFECTF PIC  X(0001).
  2899     05  FILLER REDEFINES EFFECTF.
  2900         10  EFFECTA PIC  X(0001).
  2901     05  EFFECTI PIC  X(0008).
  2902*    -------------------------------
  2903     05  TERMSL PIC S9(0004) COMP.
  2904     05  TERMSF PIC  X(0001).
  2905     05  FILLER REDEFINES TERMSF.
  2906         10  TERMSA PIC  X(0001).
  2907     05  TERMSI PIC  X(0011).
  2908*    -------------------------------
  2909     05  STACCTL PIC S9(0004) COMP.
  2910     05  STACCTF PIC  X(0001).
  2911     05  FILLER REDEFINES STACCTF.
  2912         10  STACCTA PIC  X(0001).
  2913     05  STACCTI PIC  X(0013).
  2914*    -------------------------------
  2915     05  EXPDTEHL PIC S9(0004) COMP.
  2916     05  EXPDTEHF PIC  X(0001).
  2917     05  FILLER REDEFINES EXPDTEHF.
  2918         10  EXPDTEHA PIC  X(0001).
  2919     05  EXPDTEHI PIC  X(0014).
  2920*    -------------------------------
  2921     05  EXPDTEL PIC S9(0004) COMP.
  2922     05  EXPDTEF PIC  X(0001).
  2923     05  FILLER REDEFINES EXPDTEF.
  2924         10  EXPDTEA PIC  X(0001).
  2925     05  EXPDTEI PIC  X(0008).
  2926*    -------------------------------
  2927     05  BENECAPL PIC S9(0004) COMP.
  2928     05  BENECAPF PIC  X(0001).
  2929     05  FILLER REDEFINES BENECAPF.
  2930         10  BENECAPA PIC  X(0001).
  2931     05  BENECAPI PIC  X(0013).
  2932*    -------------------------------
  2933     05  BENEL PIC S9(0004) COMP.
  2934     05  BENEF PIC  X(0001).
  2935     05  FILLER REDEFINES BENEF.
  2936         10  BENEA PIC  X(0001).
  2937     05  BENEI PIC  X(0009).
  2938*    -------------------------------
  2939     05  FORMTYPL PIC S9(0004) COMP.
  2940     05  FORMTYPF PIC  X(0001).
  2941     05  FILLER REDEFINES FORMTYPF.
  2942         10  FORMTYPA PIC  X(0001).
  2943     05  FORMTYPI PIC  X(0001).
  2944*    -------------------------------
  2945     05  PMTTYPEL PIC S9(0004) COMP.
  2946     05  PMTTYPEF PIC  X(0001).
  2947     05  FILLER REDEFINES PMTTYPEF.
  2948         10  PMTTYPEA PIC  X(0001).
  2949     05  PMTTYPEI PIC  X(0001).
  2950*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  60
* EL156.cbl
  2951     05  PAYEEL PIC S9(0004) COMP.
  2952     05  PAYEEF PIC  X(0001).
  2953     05  FILLER REDEFINES PAYEEF.
  2954         10  PAYEEA PIC  X(0001).
  2955     05  PAYEEI PIC  X(0002).
  2956*    -------------------------------
  2957     05  CHECKNOL PIC S9(0004) COMP.
  2958     05  CHECKNOF PIC  X(0001).
  2959     05  FILLER REDEFINES CHECKNOF.
  2960         10  CHECKNOA PIC  X(0001).
  2961     05  CHECKNOI PIC  X(0007).
  2962*    -------------------------------
  2963     05  OFFLINEL PIC S9(0004) COMP.
  2964     05  OFFLINEF PIC  X(0001).
  2965     05  FILLER REDEFINES OFFLINEF.
  2966         10  OFFLINEA PIC  X(0001).
  2967     05  OFFLINEI PIC  X(0001).
  2968*    -------------------------------
  2969     05  HOLDTILL PIC S9(0004) COMP.
  2970     05  HOLDTILF PIC  X(0001).
  2971     05  FILLER REDEFINES HOLDTILF.
  2972         10  HOLDTILA PIC  X(0001).
  2973     05  HOLDTILI PIC  X(0008).
  2974*    -------------------------------
  2975     05  NOTE1L PIC S9(0004) COMP.
  2976     05  NOTE1F PIC  X(0001).
  2977     05  FILLER REDEFINES NOTE1F.
  2978         10  NOTE1A PIC  X(0001).
  2979     05  NOTE1I PIC  X(0060).
  2980*    -------------------------------
  2981     05  ITRB1L PIC S9(0004) COMP.
  2982     05  ITRB1F PIC  X(0001).
  2983     05  FILLER REDEFINES ITRB1F.
  2984         10  ITRB1A PIC  X(0001).
  2985     05  ITRB1I PIC  X(0008).
  2986*    -------------------------------
  2987     05  NOTE2L PIC S9(0004) COMP.
  2988     05  NOTE2F PIC  X(0001).
  2989     05  FILLER REDEFINES NOTE2F.
  2990         10  NOTE2A PIC  X(0001).
  2991     05  NOTE2I PIC  X(0060).
  2992*    -------------------------------
  2993     05  ITRB2L PIC S9(0004) COMP.
  2994     05  ITRB2F PIC  X(0001).
  2995     05  FILLER REDEFINES ITRB2F.
  2996         10  ITRB2A PIC  X(0001).
  2997     05  ITRB2I PIC  X(0010).
  2998*    -------------------------------
  2999     05  EOBYNL PIC S9(0004) COMP.
  3000     05  EOBYNF PIC  X(0001).
  3001     05  FILLER REDEFINES EOBYNF.
  3002         10  EOBYNA PIC  X(0001).
  3003     05  EOBYNI PIC  X(0001).
  3004*    -------------------------------
  3005     05  CLMFMYNL PIC S9(0004) COMP.
  3006     05  CLMFMYNF PIC  X(0001).
  3007     05  FILLER REDEFINES CLMFMYNF.
  3008         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  61
* EL156.cbl
  3009     05  CLMFMYNI PIC  X(0001).
  3010*    -------------------------------
  3011     05  SURVYYNL PIC S9(0004) COMP.
  3012     05  SURVYYNF PIC  X(0001).
  3013     05  FILLER REDEFINES SURVYYNF.
  3014         10  SURVYYNA PIC  X(0001).
  3015     05  SURVYYNI PIC  X(0001).
  3016*    -------------------------------
  3017     05  SPRELYNL PIC S9(0004) COMP.
  3018     05  SPRELYNF PIC  X(0001).
  3019     05  FILLER REDEFINES SPRELYNF.
  3020         10  SPRELYNA PIC  X(0001).
  3021     05  SPRELYNI PIC  X(0001).
  3022*    -------------------------------
  3023     05  PINTHL PIC S9(0004) COMP.
  3024     05  PINTHF PIC  X(0001).
  3025     05  FILLER REDEFINES PINTHF.
  3026         10  PINTHA PIC  X(0001).
  3027     05  PINTHI PIC  X(0004).
  3028*    -------------------------------
  3029     05  PINTL PIC S9(0004) COMP.
  3030     05  PINTF PIC  X(0001).
  3031     05  FILLER REDEFINES PINTF.
  3032         10  PINTA PIC  X(0001).
  3033     05  PINTI PIC  X(0008).
  3034*    -------------------------------
  3035     05  ITRBYNL PIC S9(0004) COMP.
  3036     05  ITRBYNF PIC  X(0001).
  3037     05  FILLER REDEFINES ITRBYNF.
  3038         10  ITRBYNA PIC  X(0001).
  3039     05  ITRBYNI PIC  X(0001).
  3040*    -------------------------------
  3041     05  PROOFDTL PIC S9(0004) COMP.
  3042     05  PROOFDTF PIC  X(0001).
  3043     05  FILLER REDEFINES PROOFDTF.
  3044         10  PROOFDTA PIC  X(0001).
  3045     05  PROOFDTI PIC  X(0008).
  3046*    -------------------------------
  3047     05  AIGFRMHL PIC S9(0004) COMP.
  3048     05  AIGFRMHF PIC  X(0001).
  3049     05  FILLER REDEFINES AIGFRMHF.
  3050         10  AIGFRMHA PIC  X(0001).
  3051     05  AIGFRMHI PIC  X(0012).
  3052*    -------------------------------
  3053     05  AIGFROML PIC S9(0004) COMP.
  3054     05  AIGFROMF PIC  X(0001).
  3055     05  FILLER REDEFINES AIGFROMF.
  3056         10  AIGFROMA PIC  X(0001).
  3057     05  AIGFROMI PIC  X(0008).
  3058*    -------------------------------
  3059     05  PMTHDGAL PIC S9(0004) COMP.
  3060     05  PMTHDGAF PIC  X(0001).
  3061     05  FILLER REDEFINES PMTHDGAF.
  3062         10  PMTHDGAA PIC  X(0001).
  3063     05  PMTHDGAI PIC  X(0066).
  3064*    -------------------------------
  3065     05  EPYFROML PIC S9(0004) COMP.
  3066     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  62
* EL156.cbl
  3067     05  FILLER REDEFINES EPYFROMF.
  3068         10  EPYFROMA PIC  X(0001).
  3069     05  EPYFROMI PIC  X(0008).
  3070*    -------------------------------
  3071     05  EPYTHRUL PIC S9(0004) COMP.
  3072     05  EPYTHRUF PIC  X(0001).
  3073     05  FILLER REDEFINES EPYTHRUF.
  3074         10  EPYTHRUA PIC  X(0001).
  3075     05  EPYTHRUI PIC  X(0008).
  3076*    -------------------------------
  3077     05  EDAYSL PIC S9(0004) COMP.
  3078     05  EDAYSF PIC  X(0001).
  3079     05  FILLER REDEFINES EDAYSF.
  3080         10  EDAYSA PIC  X(0001).
  3081     05  EDAYSI PIC  S9(6).
  3082*    -------------------------------
  3083     05  EPYAMTL PIC S9(0004) COMP.
  3084     05  EPYAMTF PIC  X(0001).
  3085     05  FILLER REDEFINES EPYAMTF.
  3086         10  EPYAMTA PIC  X(0001).
  3087     05  EPYAMTI PIC  S9(8)V99.
  3088*    -------------------------------
  3089     05  ERESVL PIC S9(0004) COMP.
  3090     05  ERESVF PIC  X(0001).
  3091     05  FILLER REDEFINES ERESVF.
  3092         10  ERESVA PIC  X(0001).
  3093     05  ERESVI PIC  S9(7)V99.
  3094*    -------------------------------
  3095     05  ETYPEL PIC S9(0004) COMP.
  3096     05  ETYPEF PIC  X(0001).
  3097     05  FILLER REDEFINES ETYPEF.
  3098         10  ETYPEA PIC  X(0001).
  3099     05  ETYPEI PIC  X(0001).
  3100*    -------------------------------
  3101     05  EEXPENSL PIC S9(0004) COMP.
  3102     05  EEXPENSF PIC  X(0001).
  3103     05  FILLER REDEFINES EEXPENSF.
  3104         10  EEXPENSA PIC  X(0001).
  3105     05  EEXPENSI PIC  9(6)V99.
  3106*    -------------------------------
  3107     05  CPYFROML PIC S9(0004) COMP.
  3108     05  CPYFROMF PIC  X(0001).
  3109     05  FILLER REDEFINES CPYFROMF.
  3110         10  CPYFROMA PIC  X(0001).
  3111     05  CPYFROMI PIC  X(0008).
  3112*    -------------------------------
  3113     05  CPYTHRUL PIC S9(0004) COMP.
  3114     05  CPYTHRUF PIC  X(0001).
  3115     05  FILLER REDEFINES CPYTHRUF.
  3116         10  CPYTHRUA PIC  X(0001).
  3117     05  CPYTHRUI PIC  X(0008).
  3118*    -------------------------------
  3119     05  CDAYSL PIC S9(0004) COMP.
  3120     05  CDAYSF PIC  X(0001).
  3121     05  FILLER REDEFINES CDAYSF.
  3122         10  CDAYSA PIC  X(0001).
  3123     05  CDAYSI PIC  9(6).
  3124*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  63
* EL156.cbl
  3125     05  CPYAMTL PIC S9(0004) COMP.
  3126     05  CPYAMTF PIC  X(0001).
  3127     05  FILLER REDEFINES CPYAMTF.
  3128         10  CPYAMTA PIC  X(0001).
  3129     05  CPYAMTI PIC  S9(8)V99.
  3130*    -------------------------------
  3131     05  CRESVL PIC S9(0004) COMP.
  3132     05  CRESVF PIC  X(0001).
  3133     05  FILLER REDEFINES CRESVF.
  3134         10  CRESVA PIC  X(0001).
  3135     05  CRESVI PIC  9(6)V99.
  3136*    -------------------------------
  3137     05  CEXPENSL PIC S9(0004) COMP.
  3138     05  CEXPENSF PIC  X(0001).
  3139     05  FILLER REDEFINES CEXPENSF.
  3140         10  CEXPENSA PIC  X(0001).
  3141     05  CEXPENSI PIC  9(6)V99.
  3142*    -------------------------------
  3143     05  ERRMSG0L PIC S9(0004) COMP.
  3144     05  ERRMSG0F PIC  X(0001).
  3145     05  FILLER REDEFINES ERRMSG0F.
  3146         10  ERRMSG0A PIC  X(0001).
  3147     05  ERRMSG0I PIC  X(0072).
  3148*    -------------------------------
  3149     05  ERRMSG1L PIC S9(0004) COMP.
  3150     05  ERRMSG1F PIC  X(0001).
  3151     05  FILLER REDEFINES ERRMSG1F.
  3152         10  ERRMSG1A PIC  X(0001).
  3153     05  ERRMSG1I PIC  X(0072).
  3154*    -------------------------------
  3155     05  ERRMSG2L PIC S9(0004) COMP.
  3156     05  ERRMSG2F PIC  X(0001).
  3157     05  FILLER REDEFINES ERRMSG2F.
  3158         10  ERRMSG2A PIC  X(0001).
  3159     05  ERRMSG2I PIC  X(0072).
  3160*    -------------------------------
  3161     05  ENTERPFL PIC S9(0004) COMP.
  3162     05  ENTERPFF PIC  X(0001).
  3163     05  FILLER REDEFINES ENTERPFF.
  3164         10  ENTERPFA PIC  X(0001).
  3165     05  ENTERPFI PIC  99.
  3166*    -------------------------------
  3167     05  PF6TITL PIC S9(0004) COMP.
  3168     05  PF6TITF PIC  X(0001).
  3169     05  FILLER REDEFINES PF6TITF.
  3170         10  PF6TITA PIC  X(0001).
  3171     05  PF6TITI PIC  X(0016).
  3172 01  EL156AO REDEFINES EL156AI.
  3173     05  FILLER            PIC  X(0012).
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  RUNDTEAO PIC  X(0008).
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  RUNTIMAO PIC  99.99.
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  64
* EL156.cbl
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  CLMNOO PIC  X(0007).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  CARRO PIC  X(0001).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  CERTNOO PIC  X(0010).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  SUFXO PIC  X(0001).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  CLMTYPO PIC  X(0006).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  CLMSTATO PIC  X(0006).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  LSTNMEO PIC  X(0015).
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
  3206     05  FSTNMEO PIC  X(0012).
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  MINITO PIC  X(0001).
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  PRIMHDGO PIC  X(0012).
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  PCERTNOO PIC  X(0010).
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  PSUFXO PIC  X(0001).
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  STATUSO PIC  X(0010).
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  LOANHO PIC  X(0014).
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  LOANNOO PIC  X(0025).
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  DUEDAYHO PIC  X(0008).
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  DUEDAYO PIC  X(0002).
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  ZINTHO PIC  X(0009).
  3237*    -------------------------------
  3238     05  FILLER            PIC  X(0003).
  3239     05  ZINTO PIC  9.99999.
  3240*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  65
* EL156.cbl
  3241     05  FILLER            PIC  X(0003).
  3242     05  PTHRHDGO PIC  X(0014).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  PDTHRUO PIC  X(0008).
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  TOTPAIDO PIC  Z(6).99-.
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  COVERO PIC  X(0010).
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  INCURO PIC  X(0008).
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  LSTDTEO PIC  X(0008).
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  CRTSTATO PIC  X(0010).
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  EFFECTO PIC  X(0008).
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  TERMSO PIC  X(0011).
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  STACCTO PIC  X(0013).
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  EXPDTEHO PIC  X(0014).
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  EXPDTEO PIC  X(0008).
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  BENECAPO PIC  X(0013).
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  BENEO PIC  Z(6).99.
  3282*    -------------------------------
  3283     05  FILLER            PIC  X(0003).
  3284     05  FORMTYPO PIC  X(0001).
  3285*    -------------------------------
  3286     05  FILLER            PIC  X(0003).
  3287     05  PMTTYPEO PIC  X(0001).
  3288*    -------------------------------
  3289     05  FILLER            PIC  X(0003).
  3290     05  PAYEEO PIC  X(0002).
  3291*    -------------------------------
  3292     05  FILLER            PIC  X(0003).
  3293     05  CHECKNOO PIC  X(0007).
  3294*    -------------------------------
  3295     05  FILLER            PIC  X(0003).
  3296     05  OFFLINEO PIC  X(0001).
  3297*    -------------------------------
  3298     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  66
* EL156.cbl
  3299     05  HOLDTILO PIC  99B99B99.
  3300*    -------------------------------
  3301     05  FILLER            PIC  X(0003).
  3302     05  NOTE1O PIC  X(0060).
  3303*    -------------------------------
  3304     05  FILLER            PIC  X(0003).
  3305     05  ITRB1O PIC  X(0008).
  3306*    -------------------------------
  3307     05  FILLER            PIC  X(0003).
  3308     05  NOTE2O PIC  X(0060).
  3309*    -------------------------------
  3310     05  FILLER            PIC  X(0003).
  3311     05  ITRB2O PIC  X(0010).
  3312*    -------------------------------
  3313     05  FILLER            PIC  X(0003).
  3314     05  EOBYNO PIC  X(0001).
  3315*    -------------------------------
  3316     05  FILLER            PIC  X(0003).
  3317     05  CLMFMYNO PIC  X(0001).
  3318*    -------------------------------
  3319     05  FILLER            PIC  X(0003).
  3320     05  SURVYYNO PIC  X(0001).
  3321*    -------------------------------
  3322     05  FILLER            PIC  X(0003).
  3323     05  SPRELYNO PIC  X(0001).
  3324*    -------------------------------
  3325     05  FILLER            PIC  X(0003).
  3326     05  PINTHO PIC  X(0004).
  3327*    -------------------------------
  3328     05  FILLER            PIC  X(0003).
  3329     05  PINTO PIC  Z,ZZ9.99.
  3330*    -------------------------------
  3331     05  FILLER            PIC  X(0003).
  3332     05  ITRBYNO PIC  X(0001).
  3333*    -------------------------------
  3334     05  FILLER            PIC  X(0003).
  3335     05  PROOFDTO PIC  99B99B99.
  3336*    -------------------------------
  3337     05  FILLER            PIC  X(0003).
  3338     05  AIGFRMHO PIC  X(0012).
  3339*    -------------------------------
  3340     05  FILLER            PIC  X(0003).
  3341     05  AIGFROMO PIC  99B99B99.
  3342*    -------------------------------
  3343     05  FILLER            PIC  X(0003).
  3344     05  PMTHDGAO PIC  X(0066).
  3345*    -------------------------------
  3346     05  FILLER            PIC  X(0003).
  3347     05  EPYFROMO PIC  99B99B99.
  3348*    -------------------------------
  3349     05  FILLER            PIC  X(0003).
  3350     05  EPYTHRUO PIC  99B99B99.
  3351*    -------------------------------
  3352     05  FILLER            PIC  X(0003).
  3353     05  EDAYSO PIC  Z(4)9-.
  3354*    -------------------------------
  3355     05  FILLER            PIC  X(0003).
  3356     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  67
* EL156.cbl
  3357*    -------------------------------
  3358     05  FILLER            PIC  X(0003).
  3359     05  ERESVO PIC  Z(5).99-.
  3360*    -------------------------------
  3361     05  FILLER            PIC  X(0003).
  3362     05  ETYPEO PIC  X(0001).
  3363*    -------------------------------
  3364     05  FILLER            PIC  X(0003).
  3365     05  EEXPENSO PIC  Z(5).99.
  3366*    -------------------------------
  3367     05  FILLER            PIC  X(0003).
  3368     05  CPYFROMO PIC  99B99B99.
  3369*    -------------------------------
  3370     05  FILLER            PIC  X(0003).
  3371     05  CPYTHRUO PIC  99B99B99.
  3372*    -------------------------------
  3373     05  FILLER            PIC  X(0003).
  3374     05  CDAYSO PIC  Z(4)9-.
  3375*    -------------------------------
  3376     05  FILLER            PIC  X(0003).
  3377     05  CPYAMTO PIC  Z(6).99-.
  3378*    -------------------------------
  3379     05  FILLER            PIC  X(0003).
  3380     05  CRESVO PIC  Z(5).99.
  3381*    -------------------------------
  3382     05  FILLER            PIC  X(0003).
  3383     05  CEXPENSO PIC  Z(5).99.
  3384*    -------------------------------
  3385     05  FILLER            PIC  X(0003).
  3386     05  ERRMSG0O PIC  X(0072).
  3387*    -------------------------------
  3388     05  FILLER            PIC  X(0003).
  3389     05  ERRMSG1O PIC  X(0072).
  3390*    -------------------------------
  3391     05  FILLER            PIC  X(0003).
  3392     05  ERRMSG2O PIC  X(0072).
  3393*    -------------------------------
  3394     05  FILLER            PIC  X(0003).
  3395     05  ENTERPFO PIC  X(0002).
  3396*    -------------------------------
  3397     05  FILLER            PIC  X(0003).
  3398     05  PF6TITO PIC  X(0016).
  3399*    -------------------------------
  3400 01  EL156BI REDEFINES EL156AI.
  3401     05  FILLER            PIC  X(0012).
  3402*    -------------------------------
  3403     05  RUNDTEBL PIC S9(0004) COMP.
  3404     05  RUNDTEBF PIC  X(0001).
  3405     05  FILLER REDEFINES RUNDTEBF.
  3406         10  RUNDTEBA PIC  X(0001).
  3407     05  RUNDTEBI PIC  X(0008).
  3408*    -------------------------------
  3409     05  RUNTIMBL PIC S9(0004) COMP.
  3410     05  RUNTIMBF PIC  X(0001).
  3411     05  FILLER REDEFINES RUNTIMBF.
  3412         10  RUNTIMBA PIC  X(0001).
  3413     05  RUNTIMBI PIC  X(0005).
  3414*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  68
* EL156.cbl
  3415     05  PAYDTBL PIC S9(0004) COMP.
  3416     05  PAYDTBF PIC  X(0001).
  3417     05  FILLER REDEFINES PAYDTBF.
  3418         10  PAYDTBA PIC  X(0001).
  3419     05  PAYDTBI PIC  X(0008).
  3420*    -------------------------------
  3421     05  PAYTYPBL PIC S9(0004) COMP.
  3422     05  PAYTYPBF PIC  X(0001).
  3423     05  FILLER REDEFINES PAYTYPBF.
  3424         10  PAYTYPBA PIC  X(0001).
  3425     05  PAYTYPBI PIC  X(0015).
  3426*    -------------------------------
  3427     05  PAYAMTBL PIC S9(0004) COMP.
  3428     05  PAYAMTBF PIC  X(0001).
  3429     05  FILLER REDEFINES PAYAMTBF.
  3430         10  PAYAMTBA PIC  X(0001).
  3431     05  PAYAMTBI PIC  X(0011).
  3432*    -------------------------------
  3433     05  LOANHBL PIC S9(0004) COMP.
  3434     05  LOANHBF PIC  X(0001).
  3435     05  FILLER REDEFINES LOANHBF.
  3436         10  LOANHBA PIC  X(0001).
  3437     05  LOANHBI PIC  X(0012).
  3438*    -------------------------------
  3439     05  LOANNBL PIC S9(0004) COMP.
  3440     05  LOANNBF PIC  X(0001).
  3441     05  FILLER REDEFINES LOANNBF.
  3442         10  LOANNBA PIC  X(0001).
  3443     05  LOANNBI PIC  X(0025).
  3444*    -------------------------------
  3445     05  CKNUMHDL PIC S9(0004) COMP.
  3446     05  CKNUMHDF PIC  X(0001).
  3447     05  FILLER REDEFINES CKNUMHDF.
  3448         10  CKNUMHDA PIC  X(0001).
  3449     05  CKNUMHDI PIC  X(0012).
  3450*    -------------------------------
  3451     05  CKNUMBL PIC S9(0004) COMP.
  3452     05  CKNUMBF PIC  X(0001).
  3453     05  FILLER REDEFINES CKNUMBF.
  3454         10  CKNUMBA PIC  X(0001).
  3455     05  CKNUMBI PIC  X(0007).
  3456*    -------------------------------
  3457     05  AGTHDGL PIC S9(0004) COMP.
  3458     05  AGTHDGF PIC  X(0001).
  3459     05  FILLER REDEFINES AGTHDGF.
  3460         10  AGTHDGA PIC  X(0001).
  3461     05  AGTHDGI PIC  X(0016).
  3462*    -------------------------------
  3463     05  NAMEBL PIC S9(0004) COMP.
  3464     05  NAMEBF PIC  X(0001).
  3465     05  FILLER REDEFINES NAMEBF.
  3466         10  NAMEBA PIC  X(0001).
  3467     05  NAMEBI PIC  X(0030).
  3468*    -------------------------------
  3469     05  NAMEB2L PIC S9(0004) COMP.
  3470     05  NAMEB2F PIC  X(0001).
  3471     05  FILLER REDEFINES NAMEB2F.
  3472         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  69
* EL156.cbl
  3473     05  NAMEB2I PIC  X(0030).
  3474*    -------------------------------
  3475     05  ADDR1BL PIC S9(0004) COMP.
  3476     05  ADDR1BF PIC  X(0001).
  3477     05  FILLER REDEFINES ADDR1BF.
  3478         10  ADDR1BA PIC  X(0001).
  3479     05  ADDR1BI PIC  X(0030).
  3480*    -------------------------------
  3481     05  ADDR1B2L PIC S9(0004) COMP.
  3482     05  ADDR1B2F PIC  X(0001).
  3483     05  FILLER REDEFINES ADDR1B2F.
  3484         10  ADDR1B2A PIC  X(0001).
  3485     05  ADDR1B2I PIC  X(0030).
  3486*    -------------------------------
  3487     05  ADDR2BL PIC S9(0004) COMP.
  3488     05  ADDR2BF PIC  X(0001).
  3489     05  FILLER REDEFINES ADDR2BF.
  3490         10  ADDR2BA PIC  X(0001).
  3491     05  ADDR2BI PIC  X(0030).
  3492*    -------------------------------
  3493     05  ADDR2B2L PIC S9(0004) COMP.
  3494     05  ADDR2B2F PIC  X(0001).
  3495     05  FILLER REDEFINES ADDR2B2F.
  3496         10  ADDR2B2A PIC  X(0001).
  3497     05  ADDR2B2I PIC  X(0030).
  3498*    -------------------------------
  3499     05  CITYSTBL PIC S9(0004) COMP.
  3500     05  CITYSTBF PIC  X(0001).
  3501     05  FILLER REDEFINES CITYSTBF.
  3502         10  CITYSTBA PIC  X(0001).
  3503     05  CITYSTBI PIC  X(0030).
  3504*    -------------------------------
  3505     05  CITYST2L PIC S9(0004) COMP.
  3506     05  CITYST2F PIC  X(0001).
  3507     05  FILLER REDEFINES CITYST2F.
  3508         10  CITYST2A PIC  X(0001).
  3509     05  CITYST2I PIC  X(0030).
  3510*    -------------------------------
  3511     05  ZIPBL PIC S9(0004) COMP.
  3512     05  ZIPBF PIC  X(0001).
  3513     05  FILLER REDEFINES ZIPBF.
  3514         10  ZIPBA PIC  X(0001).
  3515     05  ZIPBI PIC  X(0009).
  3516*    -------------------------------
  3517     05  ZIPB2L PIC S9(0004) COMP.
  3518     05  ZIPB2F PIC  X(0001).
  3519     05  FILLER REDEFINES ZIPB2F.
  3520         10  ZIPB2A PIC  X(0001).
  3521     05  ZIPB2I PIC  X(0009).
  3522*    -------------------------------
  3523     05  INTHDBL PIC S9(0004) COMP.
  3524     05  INTHDBF PIC  X(0001).
  3525     05  FILLER REDEFINES INTHDBF.
  3526         10  INTHDBA PIC  X(0001).
  3527     05  INTHDBI PIC  X(0012).
  3528*    -------------------------------
  3529     05  INTAMTBL PIC S9(0004) COMP.
  3530     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  70
* EL156.cbl
  3531     05  FILLER REDEFINES INTAMTBF.
  3532         10  INTAMTBA PIC  X(0001).
  3533     05  INTAMTBI PIC  X(0011).
  3534*    -------------------------------
  3535     05  PMTHDGBL PIC S9(0004) COMP.
  3536     05  PMTHDGBF PIC  X(0001).
  3537     05  FILLER REDEFINES PMTHDGBF.
  3538         10  PMTHDGBA PIC  X(0001).
  3539     05  PMTHDGBI PIC  X(0034).
  3540*    -------------------------------
  3541     05  CLMNOBL PIC S9(0004) COMP.
  3542     05  CLMNOBF PIC  X(0001).
  3543     05  FILLER REDEFINES CLMNOBF.
  3544         10  CLMNOBA PIC  X(0001).
  3545     05  CLMNOBI PIC  X(0007).
  3546*    -------------------------------
  3547     05  CARRBL PIC S9(0004) COMP.
  3548     05  CARRBF PIC  X(0001).
  3549     05  FILLER REDEFINES CARRBF.
  3550         10  CARRBA PIC  X(0001).
  3551     05  CARRBI PIC  X(0001).
  3552*    -------------------------------
  3553     05  CERTNOBL PIC S9(0004) COMP.
  3554     05  CERTNOBF PIC  X(0001).
  3555     05  FILLER REDEFINES CERTNOBF.
  3556         10  CERTNOBA PIC  X(0001).
  3557     05  CERTNOBI PIC  X(0010).
  3558*    -------------------------------
  3559     05  SUFXBL PIC S9(0004) COMP.
  3560     05  SUFXBF PIC  X(0001).
  3561     05  FILLER REDEFINES SUFXBF.
  3562         10  SUFXBA PIC  X(0001).
  3563     05  SUFXBI PIC  X(0001).
  3564*    -------------------------------
  3565     05  CLMTYPBL PIC S9(0004) COMP.
  3566     05  CLMTYPBF PIC  X(0001).
  3567     05  FILLER REDEFINES CLMTYPBF.
  3568         10  CLMTYPBA PIC  X(0001).
  3569     05  CLMTYPBI PIC  X(0006).
  3570*    -------------------------------
  3571     05  INCURBL PIC S9(0004) COMP.
  3572     05  INCURBF PIC  X(0001).
  3573     05  FILLER REDEFINES INCURBF.
  3574         10  INCURBA PIC  X(0001).
  3575     05  INCURBI PIC  X(0008).
  3576*    -------------------------------
  3577     05  PYFROMBL PIC S9(0004) COMP.
  3578     05  PYFROMBF PIC  X(0001).
  3579     05  FILLER REDEFINES PYFROMBF.
  3580         10  PYFROMBA PIC  X(0001).
  3581     05  PYFROMBI PIC  X(0008).
  3582*    -------------------------------
  3583     05  PYTHRUBL PIC S9(0004) COMP.
  3584     05  PYTHRUBF PIC  X(0001).
  3585     05  FILLER REDEFINES PYTHRUBF.
  3586         10  PYTHRUBA PIC  X(0001).
  3587     05  PYTHRUBI PIC  X(0008).
  3588*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  71
* EL156.cbl
  3589     05  DAYSBL PIC S9(0004) COMP.
  3590     05  DAYSBF PIC  X(0001).
  3591     05  FILLER REDEFINES DAYSBF.
  3592         10  DAYSBA PIC  X(0001).
  3593     05  DAYSBI PIC  X(0005).
  3594*    -------------------------------
  3595     05  BYBL PIC S9(0004) COMP.
  3596     05  BYBF PIC  X(0001).
  3597     05  FILLER REDEFINES BYBF.
  3598         10  BYBA PIC  X(0001).
  3599     05  BYBI PIC  X(0004).
  3600*    -------------------------------
  3601     05  PROOFDBL PIC S9(0004) COMP.
  3602     05  PROOFDBF PIC  X(0001).
  3603     05  FILLER REDEFINES PROOFDBF.
  3604         10  PROOFDBA PIC  X(0001).
  3605     05  PROOFDBI PIC  X(0008).
  3606*    -------------------------------
  3607     05  ACCTBL PIC S9(0004) COMP.
  3608     05  ACCTBF PIC  X(0001).
  3609     05  FILLER REDEFINES ACCTBF.
  3610         10  ACCTBA PIC  X(0001).
  3611     05  ACCTBI PIC  X(0010).
  3612*    -------------------------------
  3613     05  STATEBL PIC S9(0004) COMP.
  3614     05  STATEBF PIC  X(0001).
  3615     05  FILLER REDEFINES STATEBF.
  3616         10  STATEBA PIC  X(0001).
  3617     05  STATEBI PIC  X(0002).
  3618*    -------------------------------
  3619     05  GROUPBL PIC S9(0004) COMP.
  3620     05  GROUPBF PIC  X(0001).
  3621     05  FILLER REDEFINES GROUPBF.
  3622         10  GROUPBA PIC  X(0001).
  3623     05  GROUPBI PIC  X(0006).
  3624*    -------------------------------
  3625     05  ACARRBL PIC S9(0004) COMP.
  3626     05  ACARRBF PIC  X(0001).
  3627     05  FILLER REDEFINES ACARRBF.
  3628         10  ACARRBA PIC  X(0001).
  3629     05  ACARRBI PIC  X(0001).
  3630*    -------------------------------
  3631     05  ACCTNMBL PIC S9(0004) COMP.
  3632     05  ACCTNMBF PIC  X(0001).
  3633     05  FILLER REDEFINES ACCTNMBF.
  3634         10  ACCTNMBA PIC  X(0001).
  3635     05  ACCTNMBI PIC  X(0030).
  3636*    -------------------------------
  3637     05  UNDISBL PIC S9(0004) COMP.
  3638     05  UNDISBF PIC  X(0001).
  3639     05  FILLER REDEFINES UNDISBF.
  3640         10  UNDISBA PIC  X(0001).
  3641     05  UNDISBI PIC  X(0010).
  3642*    -------------------------------
  3643     05  RATEBL PIC S9(0004) COMP.
  3644     05  RATEBF PIC  X(0001).
  3645     05  FILLER REDEFINES RATEBF.
  3646         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  72
* EL156.cbl
  3647     05  RATEBI PIC  X(0006).
  3648*    -------------------------------
  3649     05  ERMSG1BL PIC S9(0004) COMP.
  3650     05  ERMSG1BF PIC  X(0001).
  3651     05  FILLER REDEFINES ERMSG1BF.
  3652         10  ERMSG1BA PIC  X(0001).
  3653     05  ERMSG1BI PIC  X(0072).
  3654*    -------------------------------
  3655     05  ENTPFBL PIC S9(0004) COMP.
  3656     05  ENTPFBF PIC  X(0001).
  3657     05  FILLER REDEFINES ENTPFBF.
  3658         10  ENTPFBA PIC  X(0001).
  3659     05  ENTPFBI PIC  99.
  3660 01  EL156BO REDEFINES EL156AI.
  3661     05  FILLER            PIC  X(0012).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  RUNDTEBO PIC  X(0008).
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  RUNTIMBO PIC  99.99.
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  PAYDTBO PIC  99B99B99.
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
  3673     05  PAYTYPBO PIC  X(0015).
  3674*    -------------------------------
  3675     05  FILLER            PIC  X(0003).
  3676     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3677*    -------------------------------
  3678     05  FILLER            PIC  X(0003).
  3679     05  LOANHBO PIC  X(0012).
  3680*    -------------------------------
  3681     05  FILLER            PIC  X(0003).
  3682     05  LOANNBO PIC  X(0025).
  3683*    -------------------------------
  3684     05  FILLER            PIC  X(0003).
  3685     05  CKNUMHDO PIC  X(0012).
  3686*    -------------------------------
  3687     05  FILLER            PIC  X(0003).
  3688     05  CKNUMBO PIC  X(0007).
  3689*    -------------------------------
  3690     05  FILLER            PIC  X(0003).
  3691     05  AGTHDGO PIC  X(0016).
  3692*    -------------------------------
  3693     05  FILLER            PIC  X(0003).
  3694     05  NAMEBO PIC  X(0030).
  3695*    -------------------------------
  3696     05  FILLER            PIC  X(0003).
  3697     05  NAMEB2O PIC  X(0030).
  3698*    -------------------------------
  3699     05  FILLER            PIC  X(0003).
  3700     05  ADDR1BO PIC  X(0030).
  3701*    -------------------------------
  3702     05  FILLER            PIC  X(0003).
  3703     05  ADDR1B2O PIC  X(0030).
  3704*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  73
* EL156.cbl
  3705     05  FILLER            PIC  X(0003).
  3706     05  ADDR2BO PIC  X(0030).
  3707*    -------------------------------
  3708     05  FILLER            PIC  X(0003).
  3709     05  ADDR2B2O PIC  X(0030).
  3710*    -------------------------------
  3711     05  FILLER            PIC  X(0003).
  3712     05  CITYSTBO PIC  X(0030).
  3713*    -------------------------------
  3714     05  FILLER            PIC  X(0003).
  3715     05  CITYST2O PIC  X(0030).
  3716*    -------------------------------
  3717     05  FILLER            PIC  X(0003).
  3718     05  ZIPBO PIC  ZZZZ99999.
  3719*    -------------------------------
  3720     05  FILLER            PIC  X(0003).
  3721     05  ZIPB2O PIC  ZZZZZZZZZ.
  3722*    -------------------------------
  3723     05  FILLER            PIC  X(0003).
  3724     05  INTHDBO PIC  X(0012).
  3725*    -------------------------------
  3726     05  FILLER            PIC  X(0003).
  3727     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3728*    -------------------------------
  3729     05  FILLER            PIC  X(0003).
  3730     05  PMTHDGBO PIC  X(0034).
  3731*    -------------------------------
  3732     05  FILLER            PIC  X(0003).
  3733     05  CLMNOBO PIC  X(0007).
  3734*    -------------------------------
  3735     05  FILLER            PIC  X(0003).
  3736     05  CARRBO PIC  X(0001).
  3737*    -------------------------------
  3738     05  FILLER            PIC  X(0003).
  3739     05  CERTNOBO PIC  X(0010).
  3740*    -------------------------------
  3741     05  FILLER            PIC  X(0003).
  3742     05  SUFXBO PIC  X(0001).
  3743*    -------------------------------
  3744     05  FILLER            PIC  X(0003).
  3745     05  CLMTYPBO PIC  X(0006).
  3746*    -------------------------------
  3747     05  FILLER            PIC  X(0003).
  3748     05  INCURBO PIC  X(0008).
  3749*    -------------------------------
  3750     05  FILLER            PIC  X(0003).
  3751     05  PYFROMBO PIC  99B99B99.
  3752*    -------------------------------
  3753     05  FILLER            PIC  X(0003).
  3754     05  PYTHRUBO PIC  99B99B99.
  3755*    -------------------------------
  3756     05  FILLER            PIC  X(0003).
  3757     05  DAYSBO PIC  X(0005).
  3758*    -------------------------------
  3759     05  FILLER            PIC  X(0003).
  3760     05  BYBO PIC  X(0004).
  3761*    -------------------------------
  3762     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  74
* EL156.cbl
  3763     05  PROOFDBO PIC  99B99B99.
  3764*    -------------------------------
  3765     05  FILLER            PIC  X(0003).
  3766     05  ACCTBO PIC  X(0010).
  3767*    -------------------------------
  3768     05  FILLER            PIC  X(0003).
  3769     05  STATEBO PIC  X(0002).
  3770*    -------------------------------
  3771     05  FILLER            PIC  X(0003).
  3772     05  GROUPBO PIC  X(0006).
  3773*    -------------------------------
  3774     05  FILLER            PIC  X(0003).
  3775     05  ACARRBO PIC  X(0001).
  3776*    -------------------------------
  3777     05  FILLER            PIC  X(0003).
  3778     05  ACCTNMBO PIC  X(0030).
  3779*    -------------------------------
  3780     05  FILLER            PIC  X(0003).
  3781     05  UNDISBO PIC  ZZZ,Z99.99.
  3782*    -------------------------------
  3783     05  FILLER            PIC  X(0003).
  3784     05  RATEBO PIC  ZZZ.99.
  3785*    -------------------------------
  3786     05  FILLER            PIC  X(0003).
  3787     05  ERMSG1BO PIC  X(0072).
  3788*    -------------------------------
  3789     05  FILLER            PIC  X(0003).
  3790     05  ENTPFBO PIC  X(0002).
  3791*    -------------------------------
  3792****************************************************************
  3793*
  3794* Copyright (c) 2007-2013 Dell Inc.
  3795* All rights reserved.
  3796*
  3797****************************************************************
  3798 01  DFHEIV.
  3799   02  DFHEIV0               PIC X(35).
  3800   02  DFHEIV1               PIC X(08).
  3801   02  DFHEIV2               PIC X(08).
  3802   02  DFHEIV3               PIC X(08).
  3803   02  DFHEIV4               PIC X(06).
  3804   02  DFHEIV5               PIC X(04).
  3805   02  DFHEIV6               PIC X(04).
  3806   02  DFHEIV7               PIC X(02).
  3807   02  DFHEIV8               PIC X(02).
  3808   02  DFHEIV9               PIC X(01).
  3809   02  DFHEIV10              PIC S9(7) COMP-3.
  3810   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3811   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3812   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3813   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3814   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3815   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3816   02  DFHEIV17              PIC X(04).
  3817   02  DFHEIV18              PIC X(04).
  3818   02  DFHEIV19              PIC X(04).
  3819   02  DFHEIV20              USAGE IS POINTER.
  3820   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  75
* EL156.cbl
  3821   02  DFHEIV22              USAGE IS POINTER.
  3822   02  DFHEIV23              USAGE IS POINTER.
  3823   02  DFHEIV24              USAGE IS POINTER.
  3824   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3825   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3826   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3827   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3828   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3829   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3830   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3831   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3832   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3833   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3834   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3835   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3836   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3837   02  FILLER                PIC X(02).
  3838   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3839   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3840   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3841   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3842   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3843   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3844   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3845 LINKAGE  SECTION.
  3846*****************************************************************
  3847*                                                               *
  3848* Copyright (c) 2007-2013 Dell Inc.                             *
  3849* All rights reserved.                                          *
  3850*                                                               *
  3851*****************************************************************
  3852 01  dfheiblk.
  3853     02  eibtime          pic s9(7) comp-3.
  3854     02  eibdate          pic s9(7) comp-3.
  3855     02  eibtrnid         pic x(4).
  3856     02  eibtaskn         pic s9(7) comp-3.
  3857     02  eibtrmid         pic x(4).
  3858     02  dfheigdi         pic s9(4) comp.
  3859     02  eibcposn         pic s9(4) comp.
  3860     02  eibcalen         pic s9(4) comp.
  3861     02  eibaid           pic x(1).
  3862     02  eibfiller1       pic x(1).
  3863     02  eibfn            pic x(2).
  3864     02  eibfiller2       pic x(2).
  3865     02  eibrcode         pic x(6).
  3866     02  eibfiller3       pic x(2).
  3867     02  eibds            pic x(8).
  3868     02  eibreqid         pic x(8).
  3869     02  eibrsrce         pic x(8).
  3870     02  eibsync          pic x(1).
  3871     02  eibfree          pic x(1).
  3872     02  eibrecv          pic x(1).
  3873     02  eibsend          pic x(1).
  3874     02  eibatt           pic x(1).
  3875     02  eibeoc           pic x(1).
  3876     02  eibfmh           pic x(1).
  3877     02  eibcompl         pic x(1).
  3878     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  76
* EL156.cbl
  3879     02  eibconf          pic x(1).
  3880     02  eiberr           pic x(1).
  3881     02  eibrldbk         pic x(1).
  3882     02  eiberrcd         pic x(4).
  3883     02  eibsynrb         pic x(1).
  3884     02  eibnodat         pic x(1).
  3885     02  eibfiller5       pic x(2).
  3886     02  eibresp          pic s9(8) comp.
  3887     02  eibresp2         pic s9(8) comp.
  3888     02  dfheigdj         pic s9(4) comp.
  3889     02  dfheigdk         pic s9(4) comp.
  3890 01  DFHCOMMAREA             PIC X(1024).
  3891
  3892*    COPY ELCMSTR.
  3893******************************************************************
  3894*                                                                *
  3895*                            ELCMSTR.                            *
  3896*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3897*                            VMOD=2.012                          *
  3898*                                                                *
  3899*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3900*                                                                *
  3901*   FILE TYPE = VSAM,KSDS                                        *
  3902*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3903*                                                                *
  3904*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3905*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3906*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3907*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3908*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3909*                                                 RKP=75,LEN=21  *
  3910*                                                                *
  3911*   **** NOTE ****                                               *
  3912*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3913*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3914*                                                                *
  3915*   LOG = YES                                                    *
  3916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3917******************************************************************
  3918*                   C H A N G E   L O G
  3919*
  3920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3921*-----------------------------------------------------------------
  3922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3923* EFFECTIVE    NUMBER
  3924*-----------------------------------------------------------------
  3925* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3926* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3927* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3928* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3929* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3930* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3931* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3932******************************************************************
  3933 01  CLAIM-MASTER.
  3934     12  CL-RECORD-ID                PIC XX.
  3935         88  VALID-CL-ID         VALUE 'CL'.
  3936
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  77
* EL156.cbl
  3937     12  CL-CONTROL-PRIMARY.
  3938         16  CL-COMPANY-CD           PIC X.
  3939         16  CL-CARRIER              PIC X.
  3940         16  CL-CLAIM-NO             PIC X(7).
  3941         16  CL-CERT-NO.
  3942             20  CL-CERT-PRIME       PIC X(10).
  3943             20  CL-CERT-SFX         PIC X.
  3944
  3945     12  CL-CONTROL-BY-NAME.
  3946         16  CL-COMPANY-CD-A1        PIC X.
  3947         16  CL-INSURED-LAST-NAME    PIC X(15).
  3948         16  CL-INSURED-NAME.
  3949             20  CL-INSURED-1ST-NAME PIC X(12).
  3950             20  CL-INSURED-MID-INIT PIC X.
  3951
  3952     12  CL-CONTROL-BY-SSN.
  3953         16  CL-COMPANY-CD-A2        PIC X.
  3954         16  CL-SOC-SEC-NO.
  3955             20  CL-SSN-STATE        PIC XX.
  3956             20  CL-SSN-ACCOUNT      PIC X(6).
  3957             20  CL-SSN-LN3          PIC X(3).
  3958
  3959     12  CL-CONTROL-BY-CERT-NO.
  3960         16  CL-COMPANY-CD-A4        PIC X.
  3961         16  CL-CERT-NO-A4.
  3962             20  CL-CERT-A4-PRIME    PIC X(10).
  3963             20  CL-CERT-A4-SFX      PIC X.
  3964
  3965     12  CL-CONTROL-BY-CCN.
  3966         16  CL-COMPANY-CD-A5        PIC X.
  3967         16  CL-CCN-A5.
  3968             20  CL-CCN.
  3969                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3970                 24  CL-CCN-PRIME-A5 PIC X(12).
  3971             20  CL-CCN-FILLER-A5    PIC X(4).
  3972
  3973     12  CL-INSURED-PROFILE-DATA.
  3974         16  CL-INSURED-BIRTH-DT     PIC XX.
  3975         16  CL-INSURED-SEX-CD       PIC X.
  3976             88  INSURED-IS-MALE        VALUE 'M'.
  3977             88  INSURED-IS-FEMALE      VALUE 'F'.
  3978             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3979         16  CL-INSURED-OCC-CD       PIC X(6).
  3980         16  FILLER                  PIC X(5).
  3981
  3982     12  CL-PROCESSING-INFO.
  3983         16  CL-PROCESSOR-ID         PIC X(4).
  3984         16  CL-CLAIM-STATUS         PIC X.
  3985             88  CLAIM-IS-OPEN          VALUE 'O'.
  3986             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3987         16  CL-CLAIM-TYPE           PIC X.
  3988*            88  AH-CLAIM               VALUE 'A'.
  3989*            88  LIFE-CLAIM             VALUE 'L'.
  3990*            88  PROPERTY-CLAIM         VALUE 'P'.
  3991*            88  IUI-CLAIM              VALUE 'I'.
  3992*            88  GAP-CLAIM              VALUE 'G'.
  3993*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3994*            88  OTHER-CLAIM            VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  78
* EL156.cbl
  3995         16  CL-CLAIM-PREM-TYPE      PIC X.
  3996             88  SINGLE-PREMIUM         VALUE '1'.
  3997             88  O-B-COVERAGE           VALUE '2'.
  3998             88  OPEN-END-COVERAGE      VALUE '3'.
  3999         16  CL-INCURRED-DT          PIC XX.
  4000         16  CL-REPORTED-DT          PIC XX.
  4001         16  CL-FILE-ESTABLISH-DT    PIC XX.
  4002         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  4003         16  CL-LAST-PMT-DT          PIC XX.
  4004         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  4005         16  CL-PAID-THRU-DT         PIC XX.
  4006         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  4007         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  4008         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  4009         16  CL-PMT-CALC-METHOD      PIC X.
  4010             88  CL-360-DAY-YR          VALUE '1'.
  4011             88  CL-365-DAY-YR          VALUE '2'.
  4012             88  CL-FULL-MONTHS         VALUE '3'.
  4013         16  CL-CAUSE-CD             PIC X(6).
  4014
  4015         16  CL-PRIME-CERT-NO.
  4016             20  CL-PRIME-CERT-PRIME PIC X(10).
  4017             20  CL-PRIME-CERT-SFX   PIC X.
  4018
  4019         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  4020             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  4021             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  4022
  4023         16  CL-MICROFILM-NO         PIC X(10).
  4024         16  FILLER REDEFINES CL-MICROFILM-NO.
  4025             20  CL-BENEFIT-PERIOD   PIC 99.
  4026             20  FILLER              PIC X(8).
  4027         16  CL-PROG-FORM-TYPE       PIC X.
  4028         16  CL-LAST-ADD-ON-DT       PIC XX.
  4029
  4030         16  CL-LAST-REOPEN-DT       PIC XX.
  4031         16  CL-LAST-CLOSE-DT        PIC XX.
  4032         16  CL-LAST-CLOSE-REASON    PIC X(01).
  4033             88  FINAL-PAID             VALUE '1'.
  4034             88  CLAIM-DENIED           VALUE '2'.
  4035             88  AUTO-CLOSE             VALUE '3'.
  4036             88  MANUAL-CLOSE           VALUE '4'.
  4037             88  BENEFITS-CHANGED       VALUE 'C'.
  4038             88  SETUP-ERRORS           VALUE 'E'.
  4039         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4040         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4041         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4042             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4043         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4044         16  FILLER                  PIC X.
  4045
  4046     12  CL-CERTIFICATE-DATA.
  4047         16  CL-CERT-ORIGIN          PIC X.
  4048             88  CERT-WAS-ONLINE        VALUE '1'.
  4049             88  CERT-WAS-CREATED       VALUE '2'.
  4050             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4051         16  CL-CERT-KEY-DATA.
  4052             20  CL-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  79
* EL156.cbl
  4053             20  CL-CERT-GROUPING    PIC X(6).
  4054             20  CL-CERT-STATE       PIC XX.
  4055             20  CL-CERT-ACCOUNT.
  4056                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4057                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4058             20  CL-CERT-EFF-DT      PIC XX.
  4059
  4060     12  CL-STATUS-CONTROLS.
  4061         16  CL-PRIORITY-CD          PIC X.
  4062             88  CONFIDENTIAL-DATA      VALUE '8'.
  4063             88  HIGHEST-PRIORITY       VALUE '9'.
  4064         16  CL-SUPV-ATTN-CD         PIC X.
  4065             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4066             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4067         16  CL-PURGED-DT            PIC XX.
  4068         16  CL-RESTORED-DT          PIC XX.
  4069         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4070         16  CL-NEXT-RESEND-DT       PIC XX.
  4071         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4072         16  CL-CRITICAL-PERIOD      PIC 99.
  4073*        16  FILLER                  PIC XX.
  4074         16  CL-LAST-MAINT-DT        PIC XX.
  4075         16  CL-LAST-MAINT-USER      PIC X(4).
  4076         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4077         16  CL-LAST-MAINT-TYPE      PIC X.
  4078             88  CLAIM-SET-UP           VALUE ' '.
  4079             88  PAYMENT-MADE           VALUE '1'.
  4080             88  LETTER-SENT            VALUE '2'.
  4081             88  MASTER-WAS-ALTERED     VALUE '3'.
  4082             88  MASTER-WAS-RESTORED    VALUE '4'.
  4083             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4084             88  FILE-CONVERTED         VALUE '6'.
  4085             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4086             88  ERROR-CORRECTION       VALUE 'E'.
  4087         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4088         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4089         16  CL-BENEFICIARY          PIC X(10).
  4090         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4091         16  CL-DENIAL-TYPE          PIC X.
  4092             88  CL-TYPE-DENIAL          VALUE '1'.
  4093             88  CL-TYPE-RESCISSION      VALUE '2'.
  4094             88  CL-TYPE-REFORMATION     VALUE '3'.
  4095             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4096             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4097         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4098         16  filler                  pic x(3).
  4099*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4100*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4101*        16  CL-RTW-DT               PIC XX.
  4102
  4103     12  CL-TRAILER-CONTROLS.
  4104         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4105             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4106             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4107             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4108         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4109         16  FILLER                  PIC XX.
  4110         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  80
* EL156.cbl
  4111         16  CL-ADDRESS-TRAILER-CNT.
  4112             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4113                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4114             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4115                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4116             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4117                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4118             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4119                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4120             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4121                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4122             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4123                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4124             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4125                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4126
  4127     12  CL-CV-REFERENCE-NO.
  4128         16  CL-CV-REFNO-PRIME       PIC X(18).
  4129         16  CL-CV-REFNO-SFX         PIC XX.
  4130
  4131     12  CL-FILE-LOCATION            PIC X(4).
  4132
  4133     12  CL-PROCESS-ERRORS.
  4134         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4135             88  NO-FATAL-ERRORS        VALUE ZERO.
  4136         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4137             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4138
  4139     12  CL-PRODUCT-CD               PIC X.
  4140
  4141     12  CL-CURRENT-KEY-DATA.
  4142         16  CL-CURRENT-CARRIER      PIC X.
  4143         16  CL-CURRENT-GROUPING     PIC X(6).
  4144         16  CL-CURRENT-STATE        PIC XX.
  4145         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4146
  4147     12  CL-ASSOCIATES               PIC X.
  4148         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4149         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4150         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4151         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4152
  4153     12  CL-ACTIVITY-CODE            PIC 99.
  4154     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4155     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4156
  4157     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4158     12  CL-LAG-REPORT-CODE          PIC 9.
  4159     12  CL-LOAN-TYPE                PIC XX.
  4160     12  CL-LEGAL-STATE              PIC XX.
  4161
  4162     12  CL-YESNOSW                  PIC X.
  4163     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4164         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4165         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4166         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4167     12  cl-insured-type             pic x.
  4168         88  cl-claim-on-primary         value 'P'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  81
* EL156.cbl
  4169         88  cl-claim-on-co-borrower     value 'C'.
  4170     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  82
* EL156.cbl
  4172*    COPY ELCCNTL.
  4173******************************************************************
  4174*                                                                *
  4175*                                                                *
  4176*                            ELCCNTL.                            *
  4177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4178*                            VMOD=2.059                          *
  4179*                                                                *
  4180*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4181*                                                                *
  4182*   FILE TYPE = VSAM,KSDS                                        *
  4183*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4184*                                                                *
  4185*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4186*       ALTERNATE INDEX = NONE                                   *
  4187*                                                                *
  4188*   LOG = YES                                                    *
  4189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4190******************************************************************
  4191*                   C H A N G E   L O G
  4192*
  4193* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4194*-----------------------------------------------------------------
  4195*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4196* EFFECTIVE    NUMBER
  4197*-----------------------------------------------------------------
  4198* 082503                   PEMA  ADD BENEFIT GROUP
  4199* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4200* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4201* 092705    2005050300006  PEMA  ADD SPP LEASES
  4202* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4203* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4204* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4205* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4206* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4207* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4208* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4209* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4210* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4211* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4212* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4213******************************************************************
  4214*
  4215 01  CONTROL-FILE.
  4216     12  CF-RECORD-ID                       PIC XX.
  4217         88  VALID-CF-ID                        VALUE 'CF'.
  4218
  4219     12  CF-CONTROL-PRIMARY.
  4220         16  CF-COMPANY-ID                  PIC XXX.
  4221         16  CF-RECORD-TYPE                 PIC X.
  4222             88  CF-COMPANY-MASTER              VALUE '1'.
  4223             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4224             88  CF-STATE-MASTER                VALUE '3'.
  4225             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4226             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4227             88  CF-CARRIER-MASTER              VALUE '6'.
  4228             88  CF-MORTALITY-MASTER            VALUE '7'.
  4229             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  83
* EL156.cbl
  4230             88  CF-TERMINAL-MASTER             VALUE '9'.
  4231             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4232             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4233             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4234             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4235             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4236             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4237             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4238             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4239             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4240         16  CF-ACCESS-CD-GENL              PIC X(4).
  4241         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4242             20  CF-PROCESSOR               PIC X(4).
  4243         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4244             20  CF-STATE-CODE              PIC XX.
  4245             20  FILLER                     PIC XX.
  4246         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4247             20  FILLER                     PIC XX.
  4248             20  CF-HI-BEN-IN-REC           PIC XX.
  4249         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4250             20  FILLER                     PIC XXX.
  4251             20  CF-CARRIER-CNTL            PIC X.
  4252         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4253             20  FILLER                     PIC XX.
  4254             20  CF-HI-TYPE-IN-REC          PIC 99.
  4255         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4256             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4257                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4258             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4259             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4260         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4261             20  FILLER                     PIC X.
  4262             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4263         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4264             20  FILLER                     PIC XX.
  4265             20  CF-MORTGAGE-PLAN           PIC XX.
  4266         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4267
  4268     12  CF-LAST-MAINT-DT                   PIC XX.
  4269     12  CF-LAST-MAINT-BY                   PIC X(4).
  4270     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4271
  4272     12  CF-RECORD-BODY                     PIC X(728).
  4273
  4274
  4275****************************************************************
  4276*             COMPANY MASTER RECORD                            *
  4277****************************************************************
  4278
  4279     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4280         16  CF-COMPANY-ADDRESS.
  4281             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4282             20  CF-CL-IN-CARE-OF           PIC X(30).
  4283             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4284             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4285             20  CF-CL-CITY-STATE           PIC X(30).
  4286             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4287             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  84
* EL156.cbl
  4288         16  CF-COMPANY-CD                  PIC X.
  4289         16  CF-COMPANY-PASSWORD            PIC X(8).
  4290         16  CF-SECURITY-OPTION             PIC X.
  4291             88  ALL-SECURITY                   VALUE '1'.
  4292             88  COMPANY-VERIFY                 VALUE '2'.
  4293             88  PROCESSOR-VERIFY               VALUE '3'.
  4294             88  NO-SECURITY                    VALUE '4'.
  4295             88  ALL-BUT-TERM                   VALUE '5'.
  4296         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4297             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4298         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4299             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4300         16  CF-INFORCE-LOCATION            PIC X.
  4301             88  CERTS-ARE-ONLINE               VALUE '1'.
  4302             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4303             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4304         16  CF-LOWER-CASE-LETTERS          PIC X.
  4305         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4306             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4307             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4308             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4309             88  CF-ACCNT-CNTL                  VALUE '3'.
  4310             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4311
  4312         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4313         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4314
  4315         16  CF-LGX-CREDIT-USER             PIC X.
  4316             88  CO-IS-NOT-USER                 VALUE 'N'.
  4317             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4318
  4319         16 CF-CREDIT-CALC-CODES.
  4320             20  CF-CR-REM-TERM-CALC PIC X.
  4321               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4322               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4323               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4324               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4325               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4326               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4327               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4328             20  CF-CR-R78-METHOD           PIC X.
  4329               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4330               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4331
  4332         16  CF-CLAIM-CONTROL-COUNTS.
  4333             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4334                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4335
  4336             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4337                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4338
  4339             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4340                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4341
  4342             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4343                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4344
  4345         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  85
* EL156.cbl
  4346
  4347         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4348             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4349             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4350             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4351             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4352                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4353                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4354             20  CF-CO-PREM-REJECT-SW       PIC X.
  4355                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4356                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4357             20  CF-CO-REF-REJECT-SW        PIC X.
  4358                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4359                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4360
  4361         16  CF-CO-REPORTING-DT             PIC XX.
  4362         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4363         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4364           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4365           88  CF-CO-MONTH-END                  VALUE '1'.
  4366
  4367         16  CF-LGX-CLAIM-USER              PIC X.
  4368             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4369             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4370
  4371         16  CF-CREDIT-EDIT-CONTROLS.
  4372             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4373             20  CF-MIN-AGE                 PIC 99.
  4374             20  CF-DEFAULT-AGE             PIC 99.
  4375             20  CF-MIN-TERM                PIC S999      COMP-3.
  4376             20  CF-MAX-TERM                PIC S999      COMP-3.
  4377             20  CF-DEFAULT-SEX             PIC X.
  4378             20  CF-JOINT-AGE-INPUT         PIC X.
  4379                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4380             20  CF-BIRTH-DATE-INPUT        PIC X.
  4381                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4382             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4383                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4384                 88  CF-ZERO-CARRIER            VALUE '1'.
  4385                 88  CF-ZERO-GROUPING           VALUE '2'.
  4386                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4387             20  CF-EDIT-SW                 PIC X.
  4388                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4389             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4390             20  CF-CR-PR-METHOD            PIC X.
  4391               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4392               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4393             20  FILLER                     PIC X.
  4394
  4395         16  CF-CREDIT-MISC-CONTROLS.
  4396             20  CF-REIN-TABLE-SW           PIC X.
  4397                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4398             20  CF-COMP-TABLE-SW           PIC X.
  4399                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4400             20  CF-EXPERIENCE-RETENTION-AGE
  4401                                            PIC S9        COMP-3.
  4402             20  CF-CONVERSION-DT           PIC XX.
  4403             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  86
* EL156.cbl
  4404             20  CF-RUN-FREQUENCY-SW        PIC X.
  4405                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4406                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4407
  4408             20  CF-CR-CHECK-NO-CONTROL.
  4409                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4410                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4411                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4412                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4413                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4414                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4415
  4416                 24  CF-CR-CHECK-COUNT       REDEFINES
  4417                     CF-CR-CHECK-COUNTER      PIC X(4).
  4418
  4419                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4420                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4421
  4422                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4423                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4424                 24  CF-MAIL-PROCESSING       PIC X.
  4425                     88  MAIL-PROCESSING          VALUE 'Y'.
  4426
  4427         16  CF-MISC-SYSTEM-CONTROL.
  4428             20  CF-SYSTEM-C                 PIC X.
  4429                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4430             20  CF-SYSTEM-D                 PIC X.
  4431                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4432             20  CF-SOC-SEC-NO-SW            PIC X.
  4433                 88  SOC-SEC-NO-USED             VALUE '1'.
  4434             20  CF-MEMBER-NO-SW             PIC X.
  4435                 88  MEMBER-NO-USED              VALUE '1'.
  4436             20  CF-TAX-ID-NUMBER            PIC X(11).
  4437             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4438             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4439                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4440                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4441                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4442                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4443             20  CF-SYSTEM-E                 PIC X.
  4444                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4445
  4446         16  CF-LGX-LIFE-USER               PIC X.
  4447             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4448             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4449
  4450         16  CF-CR-MONTH-END-DT             PIC XX.
  4451
  4452         16  CF-FILE-MAINT-DATES.
  4453             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4454                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4455             20  CF-LAST-BATCH       REDEFINES
  4456                 CF-LAST-BATCH-NO               PIC X(4).
  4457             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4458             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4459             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4460             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4461             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  87
* EL156.cbl
  4462             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4463             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4464             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4465             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4466             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4467
  4468         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4469         16  FILLER                         PIC X.
  4470
  4471         16  CF-ALT-MORT-CODE               PIC X(4).
  4472         16  CF-MEMBER-CAPTION              PIC X(10).
  4473
  4474         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4475             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4476             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4477             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4478             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4479             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4480
  4481         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4482
  4483         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4484         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4485         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4486         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4487
  4488         16  CF-AH-OVERRIDE-L1              PIC X.
  4489         16  CF-AH-OVERRIDE-L2              PIC XX.
  4490         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4491         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4492
  4493         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4494         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4495
  4496         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4497         16  CF-AR-LAST-EL860-DT            PIC XX.
  4498         16  CF-MP-MONTH-END-DT             PIC XX.
  4499
  4500         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4501         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4502             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4503
  4504         16  CF-AR-MONTH-END-DT             PIC XX.
  4505
  4506         16  CF-CRDTCRD-USER                PIC X.
  4507             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4508             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4509
  4510         16  CF-CC-MONTH-END-DT             PIC XX.
  4511
  4512         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4513
  4514         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4515             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4516             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4517             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4518         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4519         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  88
* EL156.cbl
  4520         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4521         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4522             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4523             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4524         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4525         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4526         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4527             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4528         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4529
  4530         16  CF-CL-ZIP-CODE.
  4531             20  CF-CL-ZIP-PRIME.
  4532                 24  CF-CL-ZIP-1ST          PIC X.
  4533                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4534                 24  FILLER                 PIC X(4).
  4535             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4536         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4537             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4538             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4539             20  FILLER                     PIC XXX.
  4540
  4541         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4542         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4543         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4544         16  CF-CO-OPTION-START-DATE        PIC XX.
  4545         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4546           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4547                                                      '3' '4'.
  4548           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4549           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4550           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4551           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4552           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4553           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4554
  4555         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4556
  4557         16  CF-PAYMENT-APPROVAL-LEVELS.
  4558             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4559             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4560             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4561             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4562             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4563             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4564
  4565         16  CF-END-USER-REPORTING-USER     PIC X.
  4566             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4567             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4568
  4569         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4570             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4571             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4572
  4573         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4574
  4575         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4576         16  FILLER                         PIC X.
  4577
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  89
* EL156.cbl
  4578         16  CF-CREDIT-ARCHIVE-CNTL.
  4579             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4580             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4581             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4582
  4583         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4584
  4585         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4586             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4587             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4588
  4589         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4590             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4591             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4592
  4593         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4594
  4595         16  CF-CO-ACH-ID-CODE              PIC  X.
  4596             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4597             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4598             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4599         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4600         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4601         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4602         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4603         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4604         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4605         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4606         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4607         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4608                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4609         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4610                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4611
  4612         16  CF-CO-OVER-SHORT.
  4613             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4614             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4615
  4616*         16  FILLER                         PIC X(102).
  4617         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4618             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4619             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4620
  4621         16  CF-AH-APPROVAL-DAYS.
  4622             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4623             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4624             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4625             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4626
  4627         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4628
  4629         16  CF-APPROV-LEV-5.
  4630             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4631             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4632             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4633
  4634         16  FILLER                         PIC X(68).
  4635****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  90
* EL156.cbl
  4636*             PROCESSOR/USER RECORD                            *
  4637****************************************************************
  4638
  4639     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4640         16  CF-PROCESSOR-NAME              PIC X(30).
  4641         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4642         16  CF-PROCESSOR-TITLE             PIC X(26).
  4643         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4644                 88  MESSAGE-YES                VALUE 'Y'.
  4645                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4646
  4647*****************************************************
  4648****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4649****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4650****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4651****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4652*****************************************************
  4653
  4654         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4655             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4656             20  CF-APPLICATION-FORCE       PIC X.
  4657             20  CF-INDIVIDUAL-APP.
  4658                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4659                     28  CF-BROWSE-APP      PIC X.
  4660                     28  CF-UPDATE-APP      PIC X.
  4661
  4662         16  CF-CURRENT-TERM-ON             PIC X(4).
  4663         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4664             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4665             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4666             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4667             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4668             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4669             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4670             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4671         16  CF-PROCESSOR-CARRIER           PIC X.
  4672             88  NO-CARRIER-SECURITY            VALUE ' '.
  4673         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4674             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4675         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4676             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4677         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4678             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4679
  4680         16  CF-PROC-SYS-ACCESS-SW.
  4681             20  CF-PROC-CREDIT-CLAIMS-SW.
  4682                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4683                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4684                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4685                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4686             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4687                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4688                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4689             20  CF-PROC-LIFE-GNRLDGR-SW.
  4690                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4691                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4692                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4693                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  91
* EL156.cbl
  4694             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4695                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4696                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4697         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4698             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4699             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4700         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4701
  4702         16  CF-APPROVAL-LEVEL                  PIC X.
  4703             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4704             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4705             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4706             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4707             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4708
  4709         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4710
  4711         16  CF-LANGUAGE-TYPE                   PIC X.
  4712             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4713             88  CF-LANG-IS-FR                      VALUE 'F'.
  4714
  4715         16  CF-CSR-IND                         PIC X.
  4716         16  FILLER                             PIC X(239).
  4717
  4718****************************************************************
  4719*             PROCESSOR/REMINDERS RECORD                       *
  4720****************************************************************
  4721
  4722     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4723         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4724             20  CF-START-REMIND-DT         PIC XX.
  4725             20  CF-END-REMIND-DT           PIC XX.
  4726             20  CF-REMINDER-TEXT           PIC X(50).
  4727         16  FILLER                         PIC X(296).
  4728
  4729
  4730****************************************************************
  4731*             STATE MASTER RECORD                              *
  4732****************************************************************
  4733
  4734     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4735         16  CF-STATE-ABBREVIATION          PIC XX.
  4736         16  CF-STATE-NAME                  PIC X(25).
  4737         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4738         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4739             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4740             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4741             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4742             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4743                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4744                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4745             20  CF-ST-PREM-REJECT-SW       PIC X.
  4746                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4747                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4748             20  CF-ST-REF-REJECT-SW        PIC X.
  4749                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4750                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4751         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  92
* EL156.cbl
  4752         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4753         16  CF-ST-REFUND-RULES.
  4754             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4755             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4756             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4757         16  CF-ST-FST-PMT-EXTENSION.
  4758             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4759             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4760                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4761                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4762                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4763                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4764         16  CF-ST-STATE-CALL.
  4765             20  CF-ST-CALL-UNEARNED        PIC X.
  4766             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4767             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4768         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4769             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4770             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4771         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4772         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4773         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4774         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4775         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4776         16  FILLER                         PIC X.
  4777         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4778             20  CF-ST-BENEFIT-CD           PIC XX.
  4779             20  CF-ST-BENEFIT-KIND         PIC X.
  4780                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4781                 88  CF-ST-AH-KIND              VALUE 'A'.
  4782             20  CF-ST-REM-TERM-CALC        PIC X.
  4783                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4784                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4785                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4786                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4787                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4788                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4789                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4790                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4791
  4792             20  CF-ST-REFUND-CALC          PIC X.
  4793                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4794                 88  ST-REFD-BY-R78             VALUE '1'.
  4795                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4796                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4797                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4798                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4799                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4800                 88  ST-REFD-UTAH               VALUE '7'.
  4801                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4802                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4803                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4804
  4805             20  CF-ST-EARNING-CALC         PIC X.
  4806                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4807                 88  ST-EARN-BY-R78             VALUE '1'.
  4808                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4809                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  93
* EL156.cbl
  4810                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4811                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4812                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4813                 88  ST-EARN-MEAN               VALUE '8'.
  4814                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4815
  4816             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4817                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4818                 88  ST-OVRD-BY-R78             VALUE '1'.
  4819                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4820                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4821                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4822                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4823                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4824                 88  ST-OVRD-MEAN               VALUE '8'.
  4825                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4826             20  cf-st-extra-periods        pic 9.
  4827*            20  FILLER                     PIC X.
  4828
  4829         16  CF-ST-COMMISSION-CAPS.
  4830             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4831             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4832             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4833             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4834         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4835                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4836                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4837                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4838
  4839         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4840
  4841         16  CF-ST-STATUTORY-INTEREST.
  4842             20  CF-ST-STAT-DATE-FROM       PIC X.
  4843                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4844                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4845             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4846             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4847             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4848             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4849             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4850
  4851         16  CF-ST-OVER-SHORT.
  4852             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4853             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4854
  4855         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4856
  4857         16  CF-ST-RT-CALC                  PIC X.
  4858
  4859         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4860         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4861         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4862         16  CF-ST-RF-LR-CALC               PIC X.
  4863         16  CF-ST-RF-LL-CALC               PIC X.
  4864         16  CF-ST-RF-LN-CALC               PIC X.
  4865         16  CF-ST-RF-AH-CALC               PIC X.
  4866         16  CF-ST-RF-CP-CALC               PIC X.
  4867*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  94
* EL156.cbl
  4868*CIDMOD         16  FILLER                         PIC X(192).
  4869         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4870             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4871         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4872         16  CF-ST-VFY-2ND-BENE             PIC X.
  4873         16  CF-ST-CAUSAL-STATE             PIC X.
  4874         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4875         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4876         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4877             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4878         16  CF-ST-NET-ONLY-STATE           PIC X.
  4879             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4880         16  cf-commission-cap-required     pic x.
  4881         16  CF-ST-GA-COMMISSION-CAPS.
  4882             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4883             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4884             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4885             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4886         16  CF-ST-TOT-COMMISSION-CAPS.
  4887             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4888             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4889             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4890             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4891         16  FILLER                         PIC X(156).
  4892
  4893****************************************************************
  4894*             BENEFIT MASTER RECORD                            *
  4895****************************************************************
  4896
  4897     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4898         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4899             20  CF-BENEFIT-CODE            PIC XX.
  4900             20  CF-BENEFIT-NUMERIC  REDEFINES
  4901                 CF-BENEFIT-CODE            PIC XX.
  4902             20  CF-BENEFIT-ALPHA           PIC XXX.
  4903             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4904             20  CF-BENEFIT-COMMENT         PIC X(10).
  4905
  4906             20  CF-LF-COVERAGE-TYPE        PIC X.
  4907                 88  CF-REDUCING                VALUE 'R'.
  4908                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4909
  4910             20  CF-SPECIAL-CALC-CD         PIC X.
  4911                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4912                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4913                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4914                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4915                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4916                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4917                 88  CF-FARM-PLAN               VALUE 'F'.
  4918                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4919                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4920                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4921                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4922                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4923                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4924                 88  CF-PRUDENTIAL              VALUE 'P'.
  4925                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  95
* EL156.cbl
  4926                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4927                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4928                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4929                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4930                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4931
  4932             20  CF-JOINT-INDICATOR         PIC X.
  4933                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4934
  4935*            20  FILLER                     PIC X(12).
  4936             20  cf-maximum-benefits        pic s999 comp-3.
  4937             20  FILLER                     PIC X(09).
  4938             20  CF-BENEFIT-CATEGORY        PIC X.
  4939             20  CF-LOAN-TYPE               PIC X(8).
  4940
  4941             20  CF-CO-REM-TERM-CALC        PIC X.
  4942                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4943                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4944                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4945                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4946                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4947
  4948             20  CF-CO-EARNINGS-CALC        PIC X.
  4949                 88  CO-EARN-BY-R78             VALUE '1'.
  4950                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4951                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4952                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4953                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4954                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4955                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4956                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4957
  4958             20  CF-CO-REFUND-CALC          PIC X.
  4959                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4960                 88  CO-REFD-BY-R78             VALUE '1'.
  4961                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4962                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4963                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4964                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4965                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4966                 88  CO-REFD-MEAN               VALUE '8'.
  4967                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4968                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4969                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4970
  4971             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4972                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4973                 88  CO-OVRD-BY-R78             VALUE '1'.
  4974                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4975                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4976                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4977                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4978                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4979                 88  CO-OVRD-MEAN               VALUE '8'.
  4980                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4981
  4982             20  CF-CO-BEN-I-G-CD           PIC X.
  4983                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  96
* EL156.cbl
  4984                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4985                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4986
  4987         16  FILLER                         PIC X(304).
  4988
  4989
  4990****************************************************************
  4991*             CARRIER MASTER RECORD                            *
  4992****************************************************************
  4993
  4994     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4995         16  CF-ADDRESS-DATA.
  4996             20  CF-MAIL-TO-NAME            PIC X(30).
  4997             20  CF-IN-CARE-OF              PIC X(30).
  4998             20  CF-ADDRESS-LINE-1          PIC X(30).
  4999             20  CF-ADDRESS-LINE-2          PIC X(30).
  5000             20  CF-CITY-STATE              PIC X(30).
  5001             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5002             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5003
  5004         16  CF-CLAIM-NO-CONTROL.
  5005             20  CF-CLAIM-NO-METHOD         PIC X.
  5006                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5007                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5008                 88  CLAIM-NO-SEQ               VALUE '3'.
  5009                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5010             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5011                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5012                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5013                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5014
  5015         16  CF-CHECK-NO-CONTROL.
  5016             20  CF-CHECK-NO-METHOD         PIC X.
  5017                 88  CHECK-NO-MANUAL            VALUE '1'.
  5018                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5019                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5020                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5021             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5022                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5023
  5024         16  CF-DOMICILE-STATE              PIC XX.
  5025
  5026         16  CF-EXPENSE-CONTROLS.
  5027             20  CF-EXPENSE-METHOD          PIC X.
  5028                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5029                 88  DOLLARS-PER-PMT            VALUE '2'.
  5030                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5031                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5032             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5033             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5034
  5035         16  CF-CORRESPONDENCE-CONTROL.
  5036             20  CF-LETTER-RESEND-OPT       PIC X.
  5037                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5038                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5039             20  FILLER                     PIC X(4).
  5040
  5041         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  97
* EL156.cbl
  5042             20  CF-MANUAL-SW               PIC X.
  5043                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5044             20  CF-FUTURE-SW               PIC X.
  5045                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5046             20  CF-PTC-SW                  PIC X.
  5047                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5048             20  CF-IBNR-SW                 PIC X.
  5049                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5050             20  CF-PTC-LF-SW               PIC X.
  5051                 88  CF-LF-PTC-USED             VALUE '1'.
  5052             20  CF-CDT-ACCESS-METHOD       PIC X.
  5053                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5054                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5055                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5056             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5057
  5058         16  CF-CLAIM-CALC-METHOD           PIC X.
  5059             88  360-PLUS-MONTHS                VALUE '1'.
  5060             88  365-PLUS-MONTHS                VALUE '2'.
  5061             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5062             88  360-DAILY                      VALUE '4'.
  5063             88  365-DAILY                      VALUE '5'.
  5064
  5065         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5066         16  FILLER                         PIC X(11).
  5067
  5068         16  CF-LIMIT-AMOUNTS.
  5069             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5070             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5071             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5072             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5073             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5074             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5075             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5076             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5077             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5078             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5079
  5080         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5081         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5082         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5083
  5084         16  CF-ZIP-CODE.
  5085             20  CF-ZIP-PRIME.
  5086                 24  CF-ZIP-1ST             PIC X.
  5087                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5088                 24  FILLER                 PIC X(4).
  5089             20  CF-ZIP-PLUS4               PIC X(4).
  5090         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5091             20  CF-CAN-POSTAL-1            PIC XXX.
  5092             20  CF-CAN-POSTAL-2            PIC XXX.
  5093             20  FILLER                     PIC XXX.
  5094
  5095         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5096         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5097         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5098
  5099         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  98
* EL156.cbl
  5100             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5101             88  CF-NO-RATING                   VALUE 'N'.
  5102
  5103         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5104
  5105         16  CF-CARRIER-OVER-SHORT.
  5106             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5107             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5108
  5109         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5110         16  CF-SECPAY-SWITCH               PIC X.
  5111             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5112             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5113         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5114         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5115         16  FILLER                         PIC X(444).
  5116*        16  FILLER                         PIC X(452).
  5117
  5118
  5119****************************************************************
  5120*             MORTALITY MASTER RECORD                          *
  5121****************************************************************
  5122
  5123     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5124         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5125                                INDEXED BY CF-MORT-NDX.
  5126             20  CF-MORT-TABLE              PIC X(5).
  5127             20  CF-MORT-TABLE-TYPE         PIC X.
  5128                 88  CF-MORT-JOINT              VALUE 'J'.
  5129                 88  CF-MORT-SINGLE             VALUE 'S'.
  5130                 88  CF-MORT-COMBINED           VALUE 'C'.
  5131                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5132                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5133             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5134             20  CF-MORT-AGE-METHOD         PIC XX.
  5135                 88  CF-AGE-LAST                VALUE 'AL'.
  5136                 88  CF-AGE-NEAR                VALUE 'AN'.
  5137             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5138             20  CF-MORT-ADJUSTMENT-DIRECTION
  5139                                            PIC X.
  5140                 88  CF-MINUS                   VALUE '-'.
  5141                 88  CF-PLUS                    VALUE '+'.
  5142             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5143             20  CF-MORT-JOINT-CODE         PIC X.
  5144                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5145             20  CF-MORT-PC-Q               PIC X.
  5146                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5147             20  CF-MORT-TABLE-CODE         PIC X(4).
  5148             20  CF-MORT-COMMENTS           PIC X(15).
  5149             20  FILLER                     PIC X(14).
  5150
  5151         16  FILLER                         PIC X(251).
  5152
  5153
  5154****************************************************************
  5155*             BUSSINESS TYPE MASTER RECORD                     *
  5156****************************************************************
  5157
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page  99
* EL156.cbl
  5158     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5159* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5160* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5161* AND RECORD 05 IS TYPES 81-99
  5162         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5163             20  CF-BUSINESS-TITLE          PIC  X(19).
  5164             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5165                                            PIC S9V9(4) COMP-3.
  5166             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5167             20  FILLER                     PIC  X.
  5168         16  FILLER                         PIC  X(248).
  5169
  5170
  5171****************************************************************
  5172*             TERMINAL MASTER RECORD                           *
  5173****************************************************************
  5174
  5175     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5176
  5177         16  CF-COMPANY-TERMINALS.
  5178             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5179                                  PIC X(4).
  5180         16  FILLER               PIC X(248).
  5181
  5182
  5183****************************************************************
  5184*             LIFE EDIT MASTER RECORD                          *
  5185****************************************************************
  5186
  5187     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5188         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5189             20  CF-LIFE-CODE-IN            PIC XX.
  5190             20  CF-LIFE-CODE-OUT           PIC XX.
  5191         16  FILLER                         PIC X(248).
  5192
  5193
  5194****************************************************************
  5195*             AH EDIT MASTER RECORD                            *
  5196****************************************************************
  5197
  5198     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5199         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5200             20  CF-AH-CODE-IN              PIC XXX.
  5201             20  CF-AH-CODE-OUT             PIC XX.
  5202         16  FILLER                         PIC X(248).
  5203
  5204
  5205****************************************************************
  5206*             CREDIBILITY TABLES                               *
  5207****************************************************************
  5208
  5209     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5210         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5211                             INDEXED BY CF-CRDB-NDX.
  5212             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5213             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5214             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5215         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 100
* EL156.cbl
  5216
  5217
  5218****************************************************************
  5219*             REPORT CUSTOMIZATION RECORD                      *
  5220****************************************************************
  5221
  5222     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5223         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5224             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5225             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5226             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5227**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5228****       A T-TRANSFER.                                   ****
  5229             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5230
  5231         16  FILLER                         PIC XX.
  5232
  5233         16  CF-CARRIER-CNTL-OPT.
  5234             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5235                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5236                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5237             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5238                                            PIC X.
  5239         16  CF-GROUP-CNTL-OPT.
  5240             20  CF-GROUP-OPT-SEQ           PIC 9.
  5241                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5242                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5243             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5244                                            PIC X(6).
  5245         16  CF-STATE-CNTL-OPT.
  5246             20  CF-STATE-OPT-SEQ           PIC 9.
  5247                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5248                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5249             20  CF-STATE-SELECT OCCURS 3 TIMES
  5250                                            PIC XX.
  5251         16  CF-ACCOUNT-CNTL-OPT.
  5252             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5253                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5254                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5255             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5256                                            PIC X(10).
  5257         16  CF-BUS-TYP-CNTL-OPT.
  5258             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5259                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5260                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5261             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5262                                            PIC XX.
  5263         16  CF-LF-TYP-CNTL-OPT.
  5264             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5265                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5266                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5267             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5268                                            PIC XX.
  5269         16  CF-AH-TYP-CNTL-OPT.
  5270             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5271                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5272                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5273             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 101
* EL156.cbl
  5274                                            PIC XX.
  5275         16  CF-REPTCD1-CNTL-OPT.
  5276             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5277                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5278                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5279             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5280                                            PIC X(10).
  5281         16  CF-REPTCD2-CNTL-OPT.
  5282             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5283                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5284                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5285             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5286                                            PIC X(10).
  5287         16  CF-USER1-CNTL-OPT.
  5288             20  CF-USER1-OPT-SEQ           PIC 9.
  5289                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5290                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5291             20  CF-USER1-SELECT OCCURS 3 TIMES
  5292                                            PIC X(10).
  5293         16  CF-USER2-CNTL-OPT.
  5294             20  CF-USER2-OPT-SEQ           PIC 9.
  5295                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5296                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5297             20  CF-USER2-SELECT OCCURS 3 TIMES
  5298                                            PIC X(10).
  5299         16  CF-USER3-CNTL-OPT.
  5300             20  CF-USER3-OPT-SEQ           PIC 9.
  5301                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5302                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5303             20  CF-USER3-SELECT OCCURS 3 TIMES
  5304                                            PIC X(10).
  5305         16  CF-USER4-CNTL-OPT.
  5306             20  CF-USER4-OPT-SEQ           PIC 9.
  5307                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5308                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5309             20  CF-USER4-SELECT OCCURS 3 TIMES
  5310                                            PIC X(10).
  5311         16  CF-USER5-CNTL-OPT.
  5312             20  CF-USER5-OPT-SEQ           PIC 9.
  5313                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5314                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5315             20  CF-USER5-SELECT OCCURS 3 TIMES
  5316                                            PIC X(10).
  5317         16  CF-REINS-CNTL-OPT.
  5318             20  CF-REINS-OPT-SEQ           PIC 9.
  5319                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5320                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5321             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5322                 24  CF-REINS-PRIME         PIC XXX.
  5323                 24  CF-REINS-SUB           PIC XXX.
  5324
  5325         16  CF-AGENT-CNTL-OPT.
  5326             20  CF-AGENT-OPT-SEQ           PIC 9.
  5327                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5328                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5329             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5330                                            PIC X(10).
  5331
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 102
* EL156.cbl
  5332         16  FILLER                         PIC X(43).
  5333
  5334         16  CF-LOSS-RATIO-SELECT.
  5335             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5336             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5337         16  CF-ENTRY-DATE-SELECT.
  5338             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5339             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5340         16  CF-EFFECTIVE-DATE-SELECT.
  5341             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5342             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5343
  5344         16  CF-EXCEPTION-LIST-IND          PIC X.
  5345             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5346
  5347         16  FILLER                         PIC X(318).
  5348
  5349****************************************************************
  5350*                  EXCEPTION REPORTING RECORD                  *
  5351****************************************************************
  5352
  5353     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5354         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5355             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5356
  5357         16  CF-COMBINED-LIFE-AH-OPT.
  5358             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5359             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5360             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5361             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5362
  5363         16  CF-LIFE-OPT.
  5364             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5365             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5366             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5367             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5368             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5369             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5370             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5371             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5372             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5373             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5374
  5375         16  CF-AH-OPT.
  5376             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5377             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5378             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5379             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5380             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5381             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5382             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5383             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5384             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5385             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5386
  5387         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5388             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5389             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 103
* EL156.cbl
  5390             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5391
  5392         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5393
  5394         16  FILLER                         PIC X(673).
  5395
  5396
  5397****************************************************************
  5398*             MORTGAGE SYSTEM PLAN RECORD                      *
  5399****************************************************************
  5400
  5401     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5402         16  CF-PLAN-TYPE                   PIC X.
  5403             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5404             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5405             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5406         16  CF-PLAN-ABBREV                 PIC XXX.
  5407         16  CF-PLAN-DESCRIPT               PIC X(10).
  5408         16  CF-PLAN-NOTES                  PIC X(20).
  5409         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5410         16  CF-PLAN-UNDERWRITING.
  5411             20  CF-PLAN-TERM-DATA.
  5412                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5413                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5414             20  CF-PLAN-AGE-DATA.
  5415                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5416                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5417                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5418             20  CF-PLAN-BENEFIT-DATA.
  5419                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5420                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5421                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5422                                            PIC S9(7)V99  COMP-3.
  5423         16  CF-PLAN-POLICY-FORMS.
  5424             20  CF-POLICY-FORM             PIC X(12).
  5425             20  CF-MASTER-APPLICATION      PIC X(12).
  5426             20  CF-MASTER-POLICY           PIC X(12).
  5427         16  CF-PLAN-RATING.
  5428             20  CF-RATE-CODE               PIC X(5).
  5429             20  CF-SEX-RATING              PIC X.
  5430                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5431                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5432             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5433             20  CF-SUB-STD-TYPE            PIC X.
  5434                 88  CF-PCT-OF-PREM            VALUE '1'.
  5435                 88  CF-PCT-OF-BENE            VALUE '2'.
  5436         16  CF-PLAN-PREM-TOLERANCES.
  5437             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5438             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5439         16  CF-PLAN-PYMT-TOLERANCES.
  5440             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5441             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5442         16  CF-PLAN-MISC-DATA.
  5443             20  FILLER                     PIC X.
  5444             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5445             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5446         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5447         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 104
* EL156.cbl
  5448             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5449                                                     '1'.
  5450             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5451                                                     '2'.
  5452         16  CF-MIB-SEARCH-SW               PIC X.
  5453             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5454             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5455             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5456             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5457         16  CF-ALPHA-SEARCH-SW             PIC X.
  5458             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5459             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5460             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5461             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5462             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5463             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5464             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5465             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5466             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5467             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5468                                                     'A' 'B' 'C'
  5469                                                     'X' 'Y' 'Z'.
  5470         16  CF-EFF-DT-RULE-SW              PIC X.
  5471             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5472             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5473             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5474             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5475             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5476         16  FILLER                         PIC X(4).
  5477         16  CF-HEALTH-QUESTIONS            PIC X.
  5478             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5479         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5480         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5481         16  CF-PLAN-SNGL-JNT               PIC X.
  5482             88  CF-COMBINED-PLAN              VALUE 'C'.
  5483             88  CF-JNT-PLAN                   VALUE 'J'.
  5484             88  CF-SNGL-PLAN                  VALUE 'S'.
  5485         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5486         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5487         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5488         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5489         16  CF-RERATE-CNTL                 PIC  X.
  5490             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5491             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5492             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5493             88  CF-AUTO-RECALC                 VALUE '4'.
  5494         16  CF-BENEFIT-TYPE                PIC  X.
  5495             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5496             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5497         16  CF-POLICY-FEE                  PIC S999V99
  5498                                                    COMP-3.
  5499         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5500         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5501         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5502         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5503         16  FILLER                         PIC  X(32).
  5504         16  CF-TERMINATION-FORM            PIC  X(04).
  5505         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 105
* EL156.cbl
  5506         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5507                                                       COMP-3.
  5508         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5509         16  CF-ISSUE-LETTER                PIC  X(4).
  5510         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5511         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5512             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5513             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5514         16  CF-MP-REFUND-CALC              PIC X.
  5515             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5516             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5517             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5518             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5519             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5520             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5521             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5522             88  CF-MP-REFD-MEAN                VALUE '8'.
  5523         16  CF-ALT-RATE-CODE               PIC  X(5).
  5524
  5525
  5526         16  FILLER                         PIC X(498).
  5527****************************************************************
  5528*             MORTGAGE COMPANY MASTER RECORD                   *
  5529****************************************************************
  5530
  5531     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5532         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5533         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5534             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5535             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5536             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5537             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5538             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5539
  5540         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5541         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5542         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5543         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5544         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5545
  5546         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5547             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5548         16  CF-MP-RECON-USE-IND            PIC X(1).
  5549             88  CF-MP-USE-RECON             VALUE 'Y'.
  5550         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5551             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5552         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5553             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5554             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5555         16  FILLER                         PIC X(1).
  5556         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5557             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5558         16  CF-MORTG-MIB-VERSION           PIC X.
  5559             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5560             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5561             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5562         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5563             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 106
* EL156.cbl
  5564                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5565             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5566                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5567             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5568                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5569             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5570                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5571             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5572                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5573             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5574                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5575         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5576         16  FILLER                         PIC X(7).
  5577         16  CF-MORTG-DESTINATION-SYMBOL.
  5578             20  CF-MORTG-MIB-COMM          PIC X(5).
  5579             20  CF-MORTG-MIB-TERM          PIC X(5).
  5580         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5581             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5582         16  FILLER                         PIC X(03).
  5583         16  CF-MP-CHECK-NO-CONTROL.
  5584             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5585                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5586                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5587                                                ' ' LOW-VALUES.
  5588                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5589                                               VALUE '3'.
  5590         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5591         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5592         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5593             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5594                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5595             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5596                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5597             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5598                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5599             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5600                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5601             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5602                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5603             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5604                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5605         16  CF-MORTG-BILLING-AREA.
  5606             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5607                                            PIC X.
  5608         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5609         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5610         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5611         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5612             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5613             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5614         16  FILLER                         PIC X.
  5615         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5616             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5617             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5618         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5619         16  FILLER                         PIC X(8).
  5620         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5621         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 107
* EL156.cbl
  5622         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5623         16  CF-ACH-COMPANY-ID.
  5624             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5625                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5626                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5627                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5628             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5629         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5630             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5631         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5632             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5633             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5634         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5635         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5636         16  FILLER                         PIC X(536).
  5637
  5638****************************************************************
  5639*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5640****************************************************************
  5641
  5642     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5643         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5644             20  CF-FEMALE-HEIGHT.
  5645                 24  CF-FEMALE-FT           PIC 99.
  5646                 24  CF-FEMALE-IN           PIC 99.
  5647             20  CF-FEMALE-MIN-WT           PIC 999.
  5648             20  CF-FEMALE-MAX-WT           PIC 999.
  5649         16  FILLER                         PIC X(428).
  5650
  5651     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5652         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5653             20  CF-MALE-HEIGHT.
  5654                 24  CF-MALE-FT             PIC 99.
  5655                 24  CF-MALE-IN             PIC 99.
  5656             20  CF-MALE-MIN-WT             PIC 999.
  5657             20  CF-MALE-MAX-WT             PIC 999.
  5658         16  FILLER                         PIC X(428).
  5659******************************************************************
  5660*             AUTOMATIC ACTIVITY RECORD                          *
  5661******************************************************************
  5662     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5663         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5664             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5665             20  CF-SYS-LETTER-ID           PIC X(04).
  5666             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5667             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5668             20  CF-SYS-RESET-SW            PIC X(01).
  5669             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5670             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5671
  5672         16  FILLER                         PIC X(50).
  5673
  5674         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5675             20  CF-USER-ACTIVE-SW          PIC X(01).
  5676             20  CF-USER-LETTER-ID          PIC X(04).
  5677             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5678             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5679             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 108
* EL156.cbl
  5680             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5681             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5682             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5683
  5684         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 109
* EL156.cbl
  5686*    COPY ELCCERT.
  5687******************************************************************
  5688*                                                                *
  5689*                            ELCCERT.                            *
  5690*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5691*                            VMOD=2.013                          *
  5692*                                                                *
  5693*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5694*                                                                *
  5695*   FILE TYPE = VSAM,KSDS                                        *
  5696*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5697*                                                                *
  5698*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5699*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5700*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5701*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5702*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5703*                                                                *
  5704*   LOG = YES                                                    *
  5705*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5706******************************************************************
  5707*                   C H A N G E   L O G
  5708*
  5709* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5710*-----------------------------------------------------------------
  5711*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5712* EFFECTIVE    NUMBER
  5713*-----------------------------------------------------------------
  5714* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5715* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5716* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5717* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5718* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5719* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5720* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5721* 032612  CR2011110200001  PEMA  AHL CHANGES
  5722* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5723* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5724* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5725******************************************************************
  5726
  5727 01  CERTIFICATE-MASTER.
  5728     12  CM-RECORD-ID                      PIC XX.
  5729         88  VALID-CM-ID                      VALUE 'CM'.
  5730
  5731     12  CM-CONTROL-PRIMARY.
  5732         16  CM-COMPANY-CD                 PIC X.
  5733         16  CM-CARRIER                    PIC X.
  5734         16  CM-GROUPING.
  5735             20  CM-GROUPING-PREFIX        PIC X(3).
  5736             20  CM-GROUPING-PRIME         PIC X(3).
  5737         16  CM-STATE                      PIC XX.
  5738         16  CM-ACCOUNT.
  5739             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5740             20  CM-ACCOUNT-PRIME          PIC X(6).
  5741         16  CM-CERT-EFF-DT                PIC XX.
  5742         16  CM-CERT-NO.
  5743             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 110
* EL156.cbl
  5744             20  CM-CERT-SFX               PIC X.
  5745
  5746     12  CM-CONTROL-BY-NAME.
  5747         16  CM-COMPANY-CD-A1              PIC X.
  5748         16  CM-INSURED-LAST-NAME          PIC X(15).
  5749         16  CM-INSURED-INITIALS.
  5750             20  CM-INSURED-INITIAL1       PIC X.
  5751             20  CM-INSURED-INITIAL2       PIC X.
  5752
  5753     12  CM-CONTROL-BY-SSN.
  5754         16  CM-COMPANY-CD-A2              PIC X.
  5755         16  CM-SOC-SEC-NO.
  5756             20  CM-SSN-STATE              PIC XX.
  5757             20  CM-SSN-ACCOUNT            PIC X(6).
  5758             20  CM-SSN-LN3.
  5759                 25  CM-INSURED-INITIALS-A2.
  5760                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5761                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5762                 25 CM-PART-LAST-NAME-A2         PIC X.
  5763
  5764     12  CM-CONTROL-BY-CERT-NO.
  5765         16  CM-COMPANY-CD-A4              PIC X.
  5766         16  CM-CERT-NO-A4                 PIC X(11).
  5767
  5768     12  CM-CONTROL-BY-MEMB.
  5769         16  CM-COMPANY-CD-A5              PIC X.
  5770         16  CM-MEMBER-NO.
  5771             20  CM-MEMB-STATE             PIC XX.
  5772             20  CM-MEMB-ACCOUNT           PIC X(6).
  5773             20  CM-MEMB-LN4.
  5774                 25  CM-INSURED-INITIALS-A5.
  5775                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5776                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5777                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5778
  5779     12  CM-INSURED-PROFILE-DATA.
  5780         16  CM-INSURED-FIRST-NAME.
  5781             20  CM-INSURED-1ST-INIT       PIC X.
  5782             20  FILLER                    PIC X(9).
  5783         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5784         16  CM-INSURED-SEX                PIC X.
  5785             88  CM-SEX-MALE                  VALUE 'M'.
  5786             88  CM-SEX-FEMAL                 VALUE 'F'.
  5787         16  CM-INSURED-JOINT-AGE          PIC 99.
  5788         16  CM-JOINT-INSURED-NAME.
  5789             20  CM-JT-LAST-NAME           PIC X(15).
  5790             20  CM-JT-FIRST-NAME.
  5791                 24  CM-JT-1ST-INIT        PIC X.
  5792                 24  FILLER                PIC X(9).
  5793             20  CM-JT-INITIAL             PIC X.
  5794
  5795     12  CM-LIFE-DATA.
  5796         16  CM-LF-BENEFIT-CD              PIC XX.
  5797         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5798         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5799         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5800         16  CM-LF-DEV-CODE                PIC XXX.
  5801         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 111
* EL156.cbl
  5802         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5803         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5804         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5805         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5806         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5807         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5808         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5809         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5810         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5811         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5812         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5813         16  cm-temp-epiq                  pic xx.
  5814             88  EPIQ-CLASS                  value 'EQ'.
  5815*        16  FILLER                        PIC XX.
  5816
  5817     12  CM-AH-DATA.
  5818         16  CM-AH-BENEFIT-CD              PIC XX.
  5819         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5820         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5821         16  CM-AH-DEV-CODE                PIC XXX.
  5822         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5823         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5824         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5825         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5826         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5827         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5828         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5829         16  CM-AH-PAID-THRU-DT            PIC XX.
  5830             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5831         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5832         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5833         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5834         16  FILLER                        PIC X.
  5835
  5836     12  CM-LOAN-INFORMATION.
  5837         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5838         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5839                                           PIC S9(5)V99  COMP-3.
  5840         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5841         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5842         16  CM-PAY-FREQUENCY              PIC S99.
  5843         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5844         16  CM-RATE-CLASS                 PIC XX.
  5845         16  CM-BENEFICIARY                PIC X(25).
  5846         16  CM-POLICY-FORM-NO             PIC X(12).
  5847         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5848         16  CM-LAST-ADD-ON-DT             PIC XX.
  5849         16  CM-DEDUCTIBLE-AMOUNTS.
  5850             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5851             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5852         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5853             20  CM-RESIDENT-STATE         PIC XX.
  5854             20  CM-RATE-CODE              PIC X(4).
  5855             20  FILLER                    PIC XX.
  5856         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5857             20  CM-LOAN-OFFICER           PIC X(5).
  5858             20  FILLER                    PIC XXX.
  5859         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 112
* EL156.cbl
  5860         16  CM-UNDERWRITING-CODE          PIC X.
  5861             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5862         16  CM-POST-CARD-IND              PIC X.
  5863         16  CM-REF-INTERFACE-SW           PIC X.
  5864         16  CM-PREMIUM-TYPE               PIC X.
  5865             88  CM-SING-PRM                  VALUE '1'.
  5866             88  CM-O-B-COVERAGE              VALUE '2'.
  5867             88  CM-OPEN-END                  VALUE '3'.
  5868         16  CM-IND-GRP-TYPE               PIC X.
  5869             88  CM-INDIVIDUAL                VALUE 'I'.
  5870             88  CM-GROUP                     VALUE 'G'.
  5871         16  CM-SKIP-CODE                  PIC X.
  5872             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5873             88  SKIP-JULY                    VALUE '1'.
  5874             88  SKIP-AUGUST                  VALUE '2'.
  5875             88  SKIP-SEPTEMBER               VALUE '3'.
  5876             88  SKIP-JULY-AUG                VALUE '4'.
  5877             88  SKIP-AUG-SEPT                VALUE '5'.
  5878             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5879             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5880             88  SKIP-JUNE                    VALUE '8'.
  5881             88  SKIP-JUNE-JULY               VALUE '9'.
  5882             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5883             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5884         16  CM-PAYMENT-MODE               PIC X.
  5885             88  PAY-MONTHLY                  VALUE SPACE.
  5886             88  PAY-WEEKLY                   VALUE '1'.
  5887             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5888             88  PAY-BI-WEEKLY                VALUE '3'.
  5889             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5890         16  CM-LOAN-NUMBER                PIC X(8).
  5891         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5892         16  CM-OLD-LOF                    PIC XXX.
  5893*        16  CM-LOAN-OFFICER               PIC XXX.
  5894         16  CM-REIN-TABLE                 PIC XXX.
  5895         16  CM-SPECIAL-REIN-CODE          PIC X.
  5896         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5897         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5898         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5899
  5900     12  CM-STATUS-DATA.
  5901         16  CM-ENTRY-STATUS               PIC X.
  5902         16  CM-ENTRY-DT                   PIC XX.
  5903
  5904         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5905         16  CM-LF-CANCEL-DT               PIC XX.
  5906         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5907
  5908         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5909         16  CM-LF-DEATH-DT                PIC XX.
  5910         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5911
  5912         16  CM-LF-CURRENT-STATUS          PIC X.
  5913             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5914                                                'M' '4' '5' '9'.
  5915             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5916             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5917             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 113
* EL156.cbl
  5918             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5919             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5920             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5921             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5922             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5923             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5924             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5925             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5926             88  CM-LF-DECLINED               VALUE 'D'.
  5927             88  CM-LF-VOIDED                 VALUE 'V'.
  5928
  5929         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5930         16  CM-AH-CANCEL-DT               PIC XX.
  5931         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5932
  5933         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5934         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5935         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5936
  5937         16  CM-AH-CURRENT-STATUS          PIC X.
  5938             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5939                                                'M' '4' '5' '9'.
  5940             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5941             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5942             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5943             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5944             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5945             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5946             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5947             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5948             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5949             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5950             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5951             88  CM-AH-DECLINED               VALUE 'D'.
  5952             88  CM-AH-VOIDED                 VALUE 'V'.
  5953
  5954         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5955             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5956             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5957             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5958         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5959
  5960         16  CM-ENTRY-BATCH                PIC X(6).
  5961         16  CM-LF-EXIT-BATCH              PIC X(6).
  5962         16  CM-AH-EXIT-BATCH              PIC X(6).
  5963         16  CM-LAST-MONTH-END             PIC XX.
  5964
  5965     12  CM-NOTE-SW                        PIC X.
  5966         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5967         88  CERT-NOTES-PRESENT               VALUE '1'.
  5968         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5969         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5970         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5971         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5972         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5973         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5974     12  CM-COMP-EXCP-SW                   PIC X.
  5975         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 114
* EL156.cbl
  5976         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5977     12  CM-INSURED-ADDRESS-SW             PIC X.
  5978         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5979         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5980
  5981*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5982     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5983     12  FILLER                            PIC X.
  5984
  5985*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5986     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5987     12  FILLER                            PIC X.
  5988*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5989     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5990
  5991     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5992         88  CERT-ADDED-BATCH                 VALUE ' '.
  5993         88  CERT-ADDED-ONLINE                VALUE '1'.
  5994         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5995         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5996         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5997     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5998         88  CERT-AS-LOADED                   VALUE ' '.
  5999         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6000         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6001         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6002         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6003         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6004         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6005         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6006
  6007     12  CM-ACCOUNT-COMM-PCTS.
  6008         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6009         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6010
  6011     12  CM-USER-FIELD                     PIC X.
  6012     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6013     12  CM-CLP-STATE                      PIC XX.
  6014     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6015     12  CM-USER-RESERVED                  PIC XXX.
  6016     12  FILLER REDEFINES CM-USER-RESERVED.
  6017         16  CM-AH-CLASS-CD                PIC XX.
  6018         16  F                             PIC X.
  6019******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 115
* EL156.cbl
  6021*    COPY ELCTRLR.
  6022******************************************************************
  6023*                                                                *
  6024*                            ELCTRLR.                            *
  6025*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6026*                            VMOD=2.014                          *
  6027*                                                                *
  6028*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  6029*                                                                *
  6030*   FILE TYPE = VSAM,KSDS                                        *
  6031*   RECORD SIZE = 200    RECFORM = FIXED                         *
  6032*                                                                *
  6033*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  6034*       ALTERNATE INDEX = NONE                                   *
  6035*                                                                *
  6036*   LOG = YES                                                    *
  6037*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6038******************************************************************
  6039*                   C H A N G E   L O G
  6040*
  6041* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6042*-----------------------------------------------------------------
  6043*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6044* EFFECTIVE    NUMBER
  6045*-----------------------------------------------------------------
  6046* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  6047* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  6048* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  6049* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  6050* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  6051* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6052* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6053* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6054* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6055* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6056* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6057* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6058* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6059* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6060* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6061* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6062* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6063* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6064* 040814    2014030500002  AJRA  ADD ICD CODES
  6065* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6066* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6067* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6068* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  6069* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  6070******************************************************************
  6071 01  ACTIVITY-TRAILERS.
  6072     12  AT-RECORD-ID                    PIC XX.
  6073         88  VALID-AT-ID                       VALUE 'AT'.
  6074
  6075     12  AT-CONTROL-PRIMARY.
  6076         16  AT-COMPANY-CD               PIC X.
  6077         16  AT-CARRIER                  PIC X.
  6078         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 116
* EL156.cbl
  6079         16  AT-CERT-NO.
  6080             20  AT-CERT-PRIME           PIC X(10).
  6081             20  AT-CERT-SFX             PIC X.
  6082         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6083             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6084             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6085             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6086             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6087             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6088             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6089             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6090             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6091             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6092             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6093             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6094             88  AT-BENEFICIARY-TRL           VALUE +91.
  6095             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6096             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6097             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6098             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6099
  6100     12  AT-TRAILER-TYPE                 PIC X.
  6101         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6102         88  PAYMENT-TR                       VALUE '2'.
  6103         88  AUTO-PAY-TR                      VALUE '3'.
  6104         88  CORRESPONDENCE-TR                VALUE '4'.
  6105         88  ADDRESS-TR                       VALUE '5'.
  6106         88  GENERAL-INFO-TR                  VALUE '6'.
  6107         88  AUTO-PROMPT-TR                   VALUE '7'.
  6108         88  DENIAL-TR                        VALUE '8'.
  6109         88  INCURRED-CHG-TR                  VALUE '9'.
  6110         88  FORM-CONTROL-TR                  VALUE 'A'.
  6111
  6112     12  AT-RECORDED-DT                  PIC XX.
  6113     12  AT-RECORDED-BY                  PIC X(4).
  6114     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6115
  6116     12  AT-TRAILER-BODY                 PIC X(165).
  6117
  6118     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6119         16  AT-RESERVE-CONTROLS.
  6120             20  AT-MANUAL-SW            PIC X.
  6121                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6122             20  AT-FUTURE-SW            PIC X.
  6123                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6124             20  AT-PTC-SW               PIC X.
  6125                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6126             20  AT-IBNR-SW              PIC X.
  6127                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6128             20  AT-PTC-LF-SW            PIC X.
  6129                 88  AT-LF-PTC-USED          VALUE '1'.
  6130             20  AT-CDT-ACCESS-METHOD    PIC X.
  6131                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6132                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6133                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6134             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6135         16  AT-LAST-COMPUTED-DT         PIC XX.
  6136         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 117
* EL156.cbl
  6137         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6138         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6139         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6140         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6141         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6142         16  AT-EXPENSE-CONTROLS.
  6143             20  AT-EXPENSE-METHOD       PIC X.
  6144                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6145                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6146                 88  PERCENT-OF-PMT           VALUE '3'.
  6147                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6148             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6149             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6150         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6151         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6152
  6153         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6154         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6155
  6156*        16  FILLER                      PIC X(53).
  6157         16  FILLER                      PIC X(47).
  6158
  6159         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6160         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6161
  6162         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6163             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6164             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6165*                    C = CLOSED
  6166*                    O = OPEN
  6167             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6168*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6169
  6170     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6171         16  AT-PAYMENT-TYPE             PIC X.
  6172             88  PARTIAL-PAYMENT                VALUE '1'.
  6173             88  FINAL-PAYMENT                  VALUE '2'.
  6174             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6175             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6176             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6177             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6178             88  VOIDED-PAYMENT                 VALUE '9'.
  6179             88  TRANSFER                       VALUE 'T'.
  6180             88  LIFE-INTEREST                  VALUE 'I'.
  6181
  6182         16  AT-CLAIM-TYPE               PIC X.
  6183             88  PAID-FOR-AH                    VALUE 'A'.
  6184             88  PAID-FOR-LIFE                  VALUE 'L'.
  6185             88  PAID-FOR-IUI                   VALUE 'I'.
  6186             88  PAID-FOR-GAP                   VALUE 'G'.
  6187             88  PAID-FOR-FAM                   VALUE 'F'.
  6188             88  PAID-FOR-OTH                   VALUE 'O'.
  6189         16  AT-CLAIM-PREM-TYPE          PIC X.
  6190             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6191             88  AT-O-B-COVERAGE                VALUE '2'.
  6192             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6193         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6194         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 118
* EL156.cbl
  6195         16  AT-PAID-FROM-DT             PIC XX.
  6196         16  AT-PAID-THRU-DT             PIC XX.
  6197         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6198         16  AT-ACH-PAYMENT              PIC X.
  6199*        16  FILLER                      PIC X.
  6200         16  AT-PAYEES-NAME              PIC X(30).
  6201         16  AT-PAYMENT-ORIGIN           PIC X.
  6202             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6203             88  ONLINE-AUTO-PMT                VALUE '2'.
  6204             88  OFFLINE-PMT                    VALUE '3'.
  6205         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6206         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6207         16  AT-VOID-DATA.
  6208             20  AT-VOID-DT              PIC XX.
  6209*00144       20  AT-VOID-REASON          PIC X(30).
  6210             20  AT-VOID-REASON          PIC X(26).
  6211         16  AT-PMT-APPROVED-BY          PIC X(04).
  6212         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6213         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6214         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6215                                         PIC S99V9(5)  COMP-3.
  6216         16  AT-CREDIT-INTERFACE.
  6217             20  AT-PMT-SELECT-DT        PIC XX.
  6218                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6219             20  AT-PMT-ACCEPT-DT        PIC XX.
  6220                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6221             20  AT-VOID-SELECT-DT       PIC XX.
  6222                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6223             20  AT-VOID-ACCEPT-DT       PIC XX.
  6224                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6225
  6226         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6227                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6228                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6229         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6230
  6231         16  AT-FORCE-CONTROL            PIC X.
  6232             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6233         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6234         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6235         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6236         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6237         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6238         16  AT-BENEFIT-TYPE             PIC X.
  6239
  6240         16  AT-EXPENSE-TYPE             PIC X.
  6241         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6242
  6243         16  AT-PAYEE-TYPE-CD.
  6244             20  AT-PAYEE-TYPE           PIC X.
  6245                 88  INSURED-PAID           VALUE 'I'.
  6246                 88  BENEFICIARY-PAID       VALUE 'B'.
  6247                 88  ACCOUNT-PAID           VALUE 'A'.
  6248                 88  OTHER-1-PAID           VALUE 'O'.
  6249                 88  OTHER-2-PAID           VALUE 'Q'.
  6250                 88  DOCTOR-PAID            VALUE 'P'.
  6251                 88  EMPLOYER-PAID          VALUE 'E'.
  6252             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 119
* EL156.cbl
  6253
  6254         16  AT-CASH-PAYMENT             PIC X.
  6255         16  AT-GROUPED-PAYMENT          PIC X.
  6256         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6257         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6258         16  AT-APPROVED-LEVEL           PIC X.
  6259         16  AT-VOID-TYPE                PIC X.
  6260             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6261             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6262         16  AT-AIG-UNEMP-IND            PIC X.
  6263             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6264         16  AT-ASSOCIATES               PIC X.
  6265             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6266             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6267
  6268         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6269         16  AT-CV-PMT-CODE              PIC X.
  6270             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6271             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6272             88  FULL-ADD-PAYMENT           VALUE '3'.
  6273             88  HALF-ADD-PAYMENT           VALUE '4'.
  6274             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6275             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6276             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6277             88  ADDL-PAYMENT               VALUE '8'.
  6278
  6279         16  AT-EOB-CODE1                PIC XXX.
  6280         16  AT-EOB-CODE2                PIC XXX.
  6281         16  AT-EOB-CODE3                PIC XXX.
  6282         16  FILLER REDEFINES AT-EOB-CODE3.
  6283             20  AT-PRINT-CLM-FORM       PIC X.
  6284             20  AT-PRINT-SURVEY         PIC X.
  6285             20  AT-SPECIAL-RELEASE      PIC X.
  6286         16  AT-EOB-CODE4                PIC XXX.
  6287         16  FILLER REDEFINES AT-EOB-CODE4.
  6288             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6289             20  FILLER                  PIC X.
  6290         16  AT-EOB-CODE5                PIC XXX.
  6291         16  FILLER REDEFINES AT-EOB-CODE5.
  6292             20  AT-PMT-PROOF-DT         PIC XX.
  6293             20  FILLER                  PIC X.
  6294
  6295         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6296             88  AT-PRINT-EOB            VALUE 'Y'.
  6297
  6298         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6299         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6300
  6301     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6302         16  AT-SCHEDULE-START-DT        PIC XX.
  6303         16  AT-SCHEDULE-END-DT          PIC XX.
  6304         16  AT-TERMINATED-DT            PIC XX.
  6305         16  AT-LAST-PMT-TYPE            PIC X.
  6306             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6307             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6308         16  AT-FIRST-PMT-DATA.
  6309             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6310             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 120
* EL156.cbl
  6311             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6312         16  AT-REGULAR-PMT-DATA.
  6313             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6314             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6315             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6316         16  AT-AUTO-PAYEE-CD.
  6317             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6318                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6319                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6320                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6321                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6322                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6323             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6324         16  AT-AUTO-PAY-DAY             PIC 99.
  6325         16  AT-AUTO-CASH                PIC X.
  6326             88  AT-CASH                      VALUE 'Y'.
  6327             88  AT-NON-CASH                  VALUE 'N'.
  6328*        16  FILLER                      PIC X(129).
  6329         16  AT-AUTO-END-LETTER          PIC X(4).
  6330         16  FILLER                      PIC X(125).
  6331
  6332         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6333         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6334
  6335     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6336         16  AT-LETTER-SENT-DT           PIC XX.
  6337         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6338         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6339         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6340         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6341         16  AT-LETTER-ORIGIN            PIC X.
  6342             88  ONLINE-CREATION              VALUE '1' '3'.
  6343             88  OFFLINE-CREATION             VALUE '2' '4'.
  6344             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6345             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6346         16  AT-STD-LETTER-FORM          PIC X(4).
  6347         16  AT-REASON-TEXT              PIC X(70).
  6348         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6349         16  AT-ADDRESEE-TYPE            PIC X.
  6350              88  INSURED-ADDRESEE            VALUE 'I'.
  6351              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6352              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6353              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6354              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6355              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6356              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6357         16  AT-ADDRESSEE-NAME           PIC X(30).
  6358         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6359         16  AT-RESEND-PRINT-DATE        PIC XX.
  6360         16  AT-CORR-SOL-UNSOL           PIC X.
  6361         16  AT-LETTER-PURGED-DT         PIC XX.
  6362*
  6363*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6364*
  6365         16  AT-CSO-REDEFINITION.
  6366             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6367             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6368             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 121
* EL156.cbl
  6369             20  AT-STOP-LETTER-DT       PIC X(2).
  6370             20  AT-AUTH-RCVD            PIC X(1).
  6371             20  FILLER                  PIC X(18).
  6372*             20  FILLER                  PIC X(27).
  6373             20  AT-CSO-LETTER-STATUS    PIC X.
  6374                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6375                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6376                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6377             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6378             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6379*
  6380*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6381*
  6382*        16  FILLER                      PIC X(26).
  6383*
  6384*        16  AT-DMD-BSR-CODE             PIC X.
  6385*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6386*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6387*
  6388*        16  AT-DMD-LETTER-STATUS        PIC X.
  6389*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6390*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6391*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6392*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6393*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6394
  6395         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6396         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6397
  6398     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6399         16  AT-ADDRESS-TYPE             PIC X.
  6400             88  INSURED-ADDRESS               VALUE 'I'.
  6401             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6402             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6403             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6404             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6405             88  OTHER-ADDRESS-1               VALUE 'O'.
  6406             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6407         16  AT-MAIL-TO-NAME             PIC X(30).
  6408         16  AT-ADDRESS-LINE-1           PIC X(30).
  6409         16  AT-ADDRESS-LINE-2           PIC X(30).
  6410         16  AT-CITY-STATE.
  6411             20  AT-CITY                 PIC X(28).
  6412             20  AT-STATE                PIC XX.
  6413         16  AT-ZIP.
  6414             20  AT-ZIP-CODE.
  6415                 24  AT-ZIP-1ST          PIC X.
  6416                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6417                 24  FILLER              PIC X(4).
  6418             20  AT-ZIP-PLUS4            PIC X(4).
  6419         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6420             20  AT-CAN-POSTAL-1         PIC XXX.
  6421             20  AT-CAN-POSTAL-2         PIC XXX.
  6422             20  FILLER                  PIC XXX.
  6423         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6424*         16  FILLER                      PIC X(23).
  6425         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6426         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 122
* EL156.cbl
  6427         16  FILLER                      PIC X(13).
  6428         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6429         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6430
  6431     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6432         16  AT-INFO-LINE-1              PIC X(60).
  6433         16  FILLER REDEFINES AT-INFO-LINE-1.
  6434             20  AT-NOTE-ERROR-NO OCCURS 15
  6435                                         PIC X(4).
  6436         16  AT-INFO-LINE-2              PIC X(60).
  6437         16  FILLER REDEFINES AT-INFO-LINE-2.
  6438             20  AT-ICD-CODE-1           PIC X(8).
  6439             20  AT-ICD-CODE-2           PIC X(8).
  6440             20  FILLER                  PIC X(44).
  6441         16  AT-INFO-TRAILER-TYPE        PIC X.
  6442             88  AT-ERRORS-NOTE          VALUE 'E'.
  6443             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6444             88  AT-CALL-NOTE            VALUE 'C'.
  6445             88  AT-MAINT-NOTE           VALUE 'M'.
  6446             88  AT-CERT-CHANGE          VALUE 'X'.
  6447             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6448             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6449             88  AT-CERT-CANCELLED       VALUE 'T'.
  6450         16  AT-CALL-TYPE                PIC X.
  6451             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6452             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  6453             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6454         16  AT-NOTE-CONTINUATION        PIC X.
  6455             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6456         16  AT-EOB-CODES-EXIST          PIC X.
  6457             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6458         16  FILLER                      PIC X(35).
  6459         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6460         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6461
  6462     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6463         16  AT-PROMPT-LINE-1            PIC X(60).
  6464         16  AT-PROMPT-LINE-2            PIC X(60).
  6465         16  AT-PROMPT-START-DT          PIC XX.
  6466         16  AT-PROMPT-END-DT            PIC XX.
  6467         16  FILLER                      PIC X(35).
  6468         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6469         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6470
  6471     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6472         16  AT-DENIAL-INFO-1            PIC X(60).
  6473         16  AT-DENIAL-INFO-2            PIC X(60).
  6474         16  AT-DENIAL-DT                PIC XX.
  6475         16  AT-RETRACTION-DT            PIC XX.
  6476         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6477*         16  FILLER                      PIC X(31).
  6478         16  AT-DENIAL-PROOF-DT          PIC XX.
  6479         16  FILLER                      PIC X(29).
  6480         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6481         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6482
  6483     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6484         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 123
* EL156.cbl
  6485         16  AT-OLD-REPORTED-DT          PIC XX.
  6486         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6487         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6488         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6489         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6490         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6491         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6492         16  FILLER                      PIC X(26).
  6493         16  AT-OLD-DIAG-CODE            PIC X(6).
  6494         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6495         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6496         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6497         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6498         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6499         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6500         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6501         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6502         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6503         16  FILLER                      PIC X(9).
  6504         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6505
  6506     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6507         16  AT-FORM-SEND-ON-DT          PIC XX.
  6508         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6509         16  AT-FORM-RE-SEND-DT          PIC XX.
  6510         16  AT-FORM-ANSWERED-DT         PIC XX.
  6511         16  AT-FORM-PRINTED-DT          PIC XX.
  6512         16  AT-FORM-REPRINT-DT          PIC XX.
  6513         16  AT-FORM-TYPE                PIC X.
  6514             88  INITIAL-FORM                  VALUE '1'.
  6515             88  PROGRESS-FORM                 VALUE '2'.
  6516         16  AT-INSTRUCT-LN-1            PIC X(28).
  6517         16  AT-INSTRUCT-LN-2            PIC X(28).
  6518         16  AT-INSTRUCT-LN-3            PIC X(28).
  6519         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6520         16  AT-FORM-ADDRESS             PIC X.
  6521             88  FORM-TO-INSURED              VALUE 'I'.
  6522             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6523             88  FORM-TO-OTHER-1              VALUE 'O'.
  6524             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6525         16  AT-RELATED-1.
  6526             20 AT-REL-CARR-1            PIC X.
  6527             20 AT-REL-CLAIM-1           PIC X(7).
  6528             20 AT-REL-CERT-1            PIC X(11).
  6529         16  AT-RELATED-2.
  6530             20 AT-REL-CARR-2            PIC X.
  6531             20 AT-REL-CLAIM-2           PIC X(7).
  6532             20 AT-REL-CERT-2            PIC X(11).
  6533         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6534         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6535         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6536         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6537         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6538         16  AT-STOP-FORM-DT             PIC X(2).
  6539
  6540         16  FILLER                      PIC X(09).
  6541         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6542         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 124
* EL156.cbl
  6543******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 125
* EL156.cbl
  6545*    COPY ELCACTQ.
  6546******************************************************************
  6547*                                                                *
  6548*                            ELCACTQ.                            *
  6549*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6550*                            VMOD=2.004                          *
  6551*                                                                *
  6552*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6553*                                                                *
  6554*   FILE TYPE = VSAM,KSDS                                        *
  6555*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6556*                                                                *
  6557*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6558*       ALTERNATE INDEX = NONE                                   *
  6559*                                                                *
  6560*   LOG = YES                                                    *
  6561*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6562*                                                                *
  6563*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6564******************************************************************
  6565
  6566 01  ACTIVITY-QUE.
  6567     12  AQ-RECORD-ID                PIC XX.
  6568         88  VALID-AQ-ID                VALUE 'AQ'.
  6569
  6570     12  AQ-CONTROL-PRIMARY.
  6571         16  AQ-COMPANY-CD           PIC X.
  6572         16  AQ-CARRIER              PIC X.
  6573         16  AQ-CLAIM-NO             PIC X(7).
  6574         16  AQ-CERT-NO.
  6575             20  AQ-CERT-PRIME       PIC X(10).
  6576             20  AQ-CERT-SFX         PIC X.
  6577
  6578     12  AQ-PENDING-ACTIVITY-FLAGS.
  6579         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6580         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6581             88  PENDING-PAYMENTS       VALUE '1'.
  6582         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6583             88  PENDING-FULL-PRINT     VALUE '1'.
  6584             88  PENDING-PART-PRINT     VALUE '2'.
  6585         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6586             88  PENDING-LETTERS        VALUE '1'.
  6587         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6588             88  PENDING-RESTORE        VALUE 'C'.
  6589             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6590
  6591     12  FILLER                      PIC X(20).
  6592
  6593     12  AQ-RESEND-DATE              PIC XX.
  6594     12  AQ-FOLLOWUP-DATE            PIC XX.
  6595     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6596     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6597     12  AQ-AUTO-LETTER              PIC X(4).
  6598     12  FILLER                      PIC XX.
  6599     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6600*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 126
* EL156.cbl
  6602*    COPY ERCACCT.
  6603******************************************************************
  6604*                                                                *
  6605*                                                                *
  6606*                            ERCACCT                             *
  6607*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6608*                            VMOD=2.031                          *
  6609*                                                                *
  6610*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6611*                                                                *
  6612*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6613*   VSAM ACCOUNT MASTER FILES.                                   *
  6614*                                                                *
  6615*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6616*                                                                *
  6617*   FILE TYPE = VSAM,KSDS                                        *
  6618*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6619*                                                                *
  6620*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6621*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6622*                                                                *
  6623*   LOG = NO                                                     *
  6624*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6625*                                                                *
  6626*                                                                *
  6627******************************************************************
  6628*                   C H A N G E   L O G
  6629*
  6630* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6631*-----------------------------------------------------------------
  6632*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6633* EFFECTIVE    NUMBER
  6634*-----------------------------------------------------------------
  6635* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6636* 092705    2005050300006  PEMA  ADD SPP LEASES
  6637* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6638* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6639* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6640* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6641* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6642* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6643******************************************************************
  6644
  6645 01  ACCOUNT-MASTER.
  6646     12  AM-RECORD-ID                      PIC XX.
  6647         88  VALID-AM-ID                      VALUE 'AM'.
  6648
  6649     12  AM-CONTROL-PRIMARY.
  6650         16  AM-COMPANY-CD                 PIC X.
  6651         16  AM-MSTR-CNTRL.
  6652             20  AM-CONTROL-A.
  6653                 24  AM-CARRIER            PIC X.
  6654                 24  AM-GROUPING.
  6655                     28 AM-GROUPING-PREFIX PIC XXX.
  6656                     28 AM-GROUPING-PRIME  PIC XXX.
  6657                 24  AM-STATE              PIC XX.
  6658                 24  AM-ACCOUNT.
  6659                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 127
* EL156.cbl
  6660                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6661             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6662                                           PIC X(19).
  6663             20  AM-CNTRL-B.
  6664                 24  AM-EXPIRATION-DT      PIC XX.
  6665                 24  FILLER                PIC X(4).
  6666             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6667                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6668
  6669     12  AM-CONTROL-BY-VAR-GRP.
  6670         16  AM-COMPANY-CD-A1              PIC X.
  6671         16  AM-VG-CARRIER                 PIC X.
  6672         16  AM-VG-GROUPING                PIC X(6).
  6673         16  AM-VG-STATE                   PIC XX.
  6674         16  AM-VG-ACCOUNT                 PIC X(10).
  6675         16  AM-VG-DATE.
  6676             20  AM-VG-EXPIRATION-DT       PIC XX.
  6677             20  FILLER                    PIC X(4).
  6678         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6679                                           PIC 9(11)      COMP-3.
  6680     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6681         16  FILLER                        PIC X(10).
  6682         16  AM-VG-KEY3.
  6683             20  AM-VG3-ACCOUNT            PIC X(10).
  6684             20  AM-VG3-EXP-DT             PIC XX.
  6685         16  FILLER                        PIC X(4).
  6686     12  AM-MAINT-INFORMATION.
  6687         16  AM-LAST-MAINT-DT              PIC XX.
  6688         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6689         16  AM-LAST-MAINT-USER            PIC X(4).
  6690         16  FILLER                        PIC XX.
  6691
  6692     12  AM-EFFECTIVE-DT                   PIC XX.
  6693     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6694
  6695     12  AM-PREV-DATES  COMP-3.
  6696         16  AM-PREV-EXP-DT                PIC 9(11).
  6697         16  AM-PREV-EFF-DT                PIC 9(11).
  6698
  6699     12  AM-REPORT-CODE-1                  PIC X(10).
  6700     12  AM-REPORT-CODE-2                  PIC X(10).
  6701
  6702     12  AM-CITY-CODE                      PIC X(4).
  6703     12  AM-COUNTY-PARISH                  PIC X(6).
  6704
  6705     12  AM-NAME                           PIC X(30).
  6706     12  AM-PERSON                         PIC X(30).
  6707     12  AM-ADDRS                          PIC X(30).
  6708     12  AM-CITY.
  6709         16  AM-ADDR-CITY                  PIC X(28).
  6710         16  AM-ADDR-STATE                 PIC XX.
  6711     12  AM-ZIP.
  6712         16  AM-ZIP-PRIME.
  6713             20  AM-ZIP-PRI-1ST            PIC X.
  6714                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6715             20  FILLER                    PIC X(4).
  6716         16  AM-ZIP-PLUS4                  PIC X(4).
  6717     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 128
* EL156.cbl
  6718         16  AM-CAN-POSTAL-1               PIC XXX.
  6719         16  AM-CAN-POSTAL-2               PIC XXX.
  6720         16  FILLER                        PIC XXX.
  6721     12  AM-TEL-NO.
  6722         16  AM-AREA-CODE                  PIC 999.
  6723         16  AM-TEL-PRE                    PIC 999.
  6724         16  AM-TEL-NBR                    PIC 9(4).
  6725     12  AM-TEL-LOC                        PIC X.
  6726         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6727         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6728
  6729     12  AM-COMM-STRUCTURE.
  6730         16  AM-DEFN-1.
  6731             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6732                 24  AM-AGT.
  6733                     28  AM-AGT-PREFIX     PIC X(4).
  6734                     28  AM-AGT-PRIME      PIC X(6).
  6735                 24  AM-COM-TYP            PIC X.
  6736                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6737                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6738                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6739                 24  AM-RECALC-LV-INDIC    PIC X.
  6740                 24  AM-RETRO-LV-INDIC     PIC X.
  6741                 24  AM-GL-CODES           PIC X.
  6742                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6743                 24  FILLER                PIC X(01).
  6744         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6745             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6746                 24  FILLER                PIC X(11).
  6747                 24  AM-L-COMA             PIC XXX.
  6748                 24  AM-J-COMA             PIC XXX.
  6749                 24  AM-A-COMA             PIC XXX.
  6750                 24  FILLER                PIC X(6).
  6751
  6752     12  AM-COMM-CHANGE-STATUS             PIC X.
  6753         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6754
  6755     12  AM-CSR-CODE                       PIC X(4).
  6756
  6757     12  AM-BILLING-STATUS                 PIC X.
  6758         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6759         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6760     12  AM-AUTO-REFUND-SW                 PIC X.
  6761         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6762         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6763     12  AM-GPCD                           PIC 99.
  6764     12  AM-IG                             PIC X.
  6765         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6766         88  AM-HAS-GROUP                     VALUE '2'.
  6767     12  AM-STATUS                         PIC X.
  6768         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6769         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6770         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6771         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6772         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6773         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6774         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6775         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 129
* EL156.cbl
  6776         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6777         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6778     12  AM-REMIT-TO                       PIC 99.
  6779     12  AM-ID-NO                          PIC X(11).
  6780
  6781     12  AM-CAL-TABLE                      PIC XX.
  6782     12  AM-LF-DEVIATION                   PIC XXX.
  6783     12  AM-AH-DEVIATION                   PIC XXX.
  6784     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6785     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6786     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6787     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6788     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6789     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6790
  6791     12  AM-USER-FIELDS.
  6792         16  AM-FLD-1                      PIC XX.
  6793         16  AM-FLD-2                      PIC XX.
  6794         16  AM-FLD-3                      PIC XX.
  6795         16  AM-FLD-4                      PIC XX.
  6796         16  AM-FLD-5                      PIC XX.
  6797
  6798     12  AM-1ST-PROD-DATE.
  6799         16  AM-1ST-PROD-YR                PIC XX.
  6800         16  AM-1ST-PROD-MO                PIC XX.
  6801         16  AM-1ST-PROD-DA                PIC XX.
  6802     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6803     12  AM-CERTS-PURGED-DATE.
  6804         16  AM-PUR-YR                     PIC XX.
  6805         16  AM-PUR-MO                     PIC XX.
  6806         16  AM-PUR-DA                     PIC XX.
  6807     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6808     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6809     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6810     12  AM-INACTIVE-DATE.
  6811         16  AM-INA-MO                     PIC 99.
  6812         16  AM-INA-DA                     PIC 99.
  6813         16  AM-INA-YR                     PIC 99.
  6814     12  AM-AR-HI-CERT-DATE                PIC XX.
  6815
  6816     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6817     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6818
  6819     12  AM-OB-PAYMENT-MODE                PIC X.
  6820         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6821         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6822         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6823         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6824
  6825     12  AM-AH-ONLY-INDICATOR              PIC X.
  6826         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6827         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6828
  6829     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6830
  6831     12  AM-OVER-SHORT.
  6832         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6833         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 130
* EL156.cbl
  6834
  6835     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6836     12  AM-DCC-CLP-STATE                  PIC XX.
  6837
  6838     12  AM-RECALC-COMM                    PIC X.
  6839     12  AM-RECALC-REIN                    PIC X.
  6840
  6841     12  AM-REI-TABLE                      PIC XXX.
  6842     12  AM-REI-ET-LF                      PIC X.
  6843     12  AM-REI-ET-AH                      PIC X.
  6844     12  AM-REI-PE-LF                      PIC X.
  6845     12  AM-REI-PE-AH                      PIC X.
  6846     12  AM-REI-PRT-ST                     PIC X.
  6847     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6848     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6849     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6850     12  AM-REI-GROUP-A                    PIC X(6).
  6851     12  AM-REI-MORT                       PIC X(4).
  6852     12  AM-REI-PRT-OW                     PIC X.
  6853     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6854     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6855     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6856     12  AM-REI-GROUP-B                    PIC X(6).
  6857
  6858     12  AM-TRUST-TYPE                     PIC X(2).
  6859
  6860     12  AM-EMPLOYER-STMT-USED             PIC X.
  6861     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6862
  6863     12  AM-STD-AH-TYPE                    PIC XX.
  6864     12  AM-EARN-METHODS.
  6865         16  AM-EARN-METHOD-R              PIC X.
  6866             88 AM-REF-RL-R78                 VALUE 'R'.
  6867             88 AM-REF-RL-PR                  VALUE 'P'.
  6868             88 AM-REF-RL-MEAN                VALUE 'M'.
  6869             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6870         16  AM-EARN-METHOD-L              PIC X.
  6871             88 AM-REF-LL-R78                 VALUE 'R'.
  6872             88 AM-REF-LL-PR                  VALUE 'P'.
  6873             88 AM-REF-LL-MEAN                VALUE 'M'.
  6874             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6875         16  AM-EARN-METHOD-A              PIC X.
  6876             88 AM-REF-AH-R78                 VALUE 'R'.
  6877             88 AM-REF-AH-PR                  VALUE 'P'.
  6878             88 AM-REF-AH-MEAN                VALUE 'M'.
  6879             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6880             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6881             88 AM-REF-AH-NET                 VALUE 'N'.
  6882
  6883     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6884     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6885     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6886
  6887     12  AM-RET-Y-N                        PIC X.
  6888     12  AM-RET-P-E                        PIC X.
  6889     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6890     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6891     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 131
* EL156.cbl
  6892     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6893         16  AM-POOL-PRIME                 PIC XXX.
  6894         16  AM-POOL-SUB                   PIC XXX.
  6895     12  AM-RETRO-EARNINGS.
  6896         16  AM-RET-EARN-R                 PIC X.
  6897         16  AM-RET-EARN-L                 PIC X.
  6898         16  AM-RET-EARN-A                 PIC X.
  6899     12  AM-RET-ST-TAX-USE                 PIC X.
  6900         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6901         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6902     12  AM-RETRO-BEG-EARNINGS.
  6903         16  AM-RET-BEG-EARN-R             PIC X.
  6904         16  AM-RET-BEG-EARN-L             PIC X.
  6905         16  AM-RET-BEG-EARN-A             PIC X.
  6906     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6907     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6908
  6909     12  AM-USER-SELECT-OPTIONS.
  6910         16  AM-USER-SELECT-1              PIC X(10).
  6911         16  AM-USER-SELECT-2              PIC X(10).
  6912         16  AM-USER-SELECT-3              PIC X(10).
  6913         16  AM-USER-SELECT-4              PIC X(10).
  6914         16  AM-USER-SELECT-5              PIC X(10).
  6915
  6916     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6917
  6918     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6919
  6920     12  AM-RPT045A-SWITCH                 PIC X.
  6921         88  RPT045A-OFF                   VALUE 'N'.
  6922
  6923     12  AM-INSURANCE-LIMITS.
  6924         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6925         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6926
  6927     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6928         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6929
  6930     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6931         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6932         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6933
  6934     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6935
  6936     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6937     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6938     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6939     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6940     12  AM-DCC-UEF-STATE                  PIC XX.
  6941     12  FILLER                            PIC XXX.
  6942     12  AM-REPORT-CODE-3                  PIC X(10).
  6943*    12  FILLER                            PIC X(22).
  6944
  6945     12  AM-RESERVE-DATE.
  6946         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6947         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6948         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6949
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 132
* EL156.cbl
  6950     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6951     12  AM-NOTIFICATION-TYPES.
  6952         16  AM-NOTIF-OF-LETTERS           PIC X.
  6953         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6954         16  AM-NOTIF-OF-REPORTS           PIC X.
  6955         16  AM-NOTIF-OF-STATUS            PIC X.
  6956
  6957     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6958         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6959         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6960         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6961         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6962
  6963     12  AM-BENEFIT-CONTROLS.
  6964         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6965             20  AM-BENEFIT-CODE           PIC XX.
  6966             20  AM-BENEFIT-TYPE           PIC X.
  6967             20  AM-BENEFIT-REVISION       PIC XXX.
  6968             20  AM-BENEFIT-REM-TERM       PIC X.
  6969             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6970             20  FILLER                    PIC XX.
  6971         16  FILLER                        PIC X(80).
  6972
  6973     12  AM-TRANSFER-DATA.
  6974         16  AM-TRANSFERRED-FROM.
  6975             20  AM-TRNFROM-CARRIER        PIC X.
  6976             20  AM-TRNFROM-GROUPING.
  6977                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6978                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6979             20  AM-TRNFROM-STATE          PIC XX.
  6980             20  AM-TRNFROM-ACCOUNT.
  6981                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6982                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6983             20  AM-TRNFROM-DTE            PIC XX.
  6984         16  AM-TRANSFERRED-TO.
  6985             20  AM-TRNTO-CARRIER          PIC X.
  6986             20  AM-TRNTO-GROUPING.
  6987                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6988                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6989             20  AM-TRNTO-STATE            PIC XX.
  6990             20  AM-TRNTO-ACCOUNT.
  6991                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6992                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6993             20  AM-TRNTO-DTE              PIC XX.
  6994         16  FILLER                        PIC X(10).
  6995
  6996     12  AM-SAVED-REMIT-TO                 PIC 99.
  6997
  6998     12  AM-COMM-STRUCTURE-SAVED.
  6999         16  AM-DEFN-1-SAVED.
  7000             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7001                 24  AM-AGT-SV             PIC X(10).
  7002                 24  AM-COM-TYP-SV         PIC X.
  7003                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7004                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7005                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7006                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7007                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 133
* EL156.cbl
  7008                 24  AM-GL-CODES-SV        PIC X.
  7009                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7010                 24  FILLER                PIC X.
  7011         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7012             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7013                 24  FILLER                PIC X(11).
  7014                 24  AM-L-COMA-SV          PIC XXX.
  7015                 24  AM-J-COMA-SV          PIC XXX.
  7016                 24  AM-A-COMA-SV          PIC XXX.
  7017                 24  FILLER                PIC X(6).
  7018
  7019     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7020         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7021            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7022            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7023            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7024
  7025     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7026     12  FILLER                            PIC X(120).
  7027
  7028     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7029         16  AM-CONTROL-NAME               PIC X(30).
  7030         16  AM-EXECUTIVE-ONE.
  7031             20  AM-EXEC1-NAME             PIC X(15).
  7032             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7033                                                          COMP-3.
  7034             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7035                                                          COMP-3.
  7036         16  AM-EXECUTIVE-TWO.
  7037             20  AM-EXEC2-NAME             PIC X(15).
  7038             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7039                                                          COMP-3.
  7040             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7041                                                          COMP-3.
  7042
  7043     12  AM-RETRO-ADDITIONAL-DATA.
  7044         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7045         16  AM-RETRO-PREM-P-E             PIC X.
  7046         16  AM-RETRO-CLMS-P-I             PIC X.
  7047         16  AM-RETRO-RET-BRACKET-LF.
  7048             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7049                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7050                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7051             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7052                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7053                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7054             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7055                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7056                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7057         16  AM-RETRO-RET-BRACKET-AH.
  7058             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7059                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7060                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7061                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7062             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7063                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7064                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7065             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 134
* EL156.cbl
  7066                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7067                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7068
  7069     12  AM-COMMENTS.
  7070         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7071
  7072     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7073         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7074         16  AM-FLI-BILLING-CODE           PIC X.
  7075         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7076         16  AM-FLI-UNITED-IDENT           PIC X.
  7077         16  AM-FLI-INTEREST-LOST-DATA.
  7078             20  AM-FLI-BANK-NO            PIC X(5).
  7079             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7080             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7081             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7082         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7083             20  AM-FLI-AGT                PIC X(9).
  7084             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7085             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7086         16  FILLER                        PIC X(102).
  7087
  7088     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7089         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7090             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7091             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7092             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7093             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7094             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7095         16  FILLER                          PIC X(10).
  7096******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 135
* EL156.cbl
  7098*    COPY ELCCHKQ.
  7099******************************************************************
  7100*                                                                *
  7101*                                                                *
  7102*                            ELCCHKQ.                            *
  7103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7104*                            VMOD=2.007                          *
  7105*                                                                *
  7106*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7107*                                                                *
  7108*   FILE TYPE = VSAM,KSDS                                        *
  7109*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7110*                                                                *
  7111*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7112*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7113*                                                                *
  7114*   LOG = YES                                                    *
  7115*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7116******************************************************************
  7117 01  CHECK-QUE.
  7118     12  CQ-RECORD-ID                PIC XX.
  7119         88  VALID-CQ-ID         VALUE 'CQ'.
  7120
  7121     12  CQ-CONTROL-PRIMARY.
  7122         16  CQ-COMPANY-CD           PIC X.
  7123         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7124         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7125
  7126     12  CQ-CONTROL-BY-PAYEE.
  7127         16  CQ-CONTROL-BY-NUMBER.
  7128             20  CQ-COMPANY-CD-A1     PIC X.
  7129             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7130         16  CQ-PAYEE-CARRIER        PIC X.
  7131         16  CQ-PAYEE-GROUPING       PIC X(6).
  7132         16  CQ-PAYEE-STATE          PIC XX.
  7133         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7134         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7135
  7136     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7137         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7138         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7139         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7140         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7141         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7142         16  FILLER                  PIC X(3).
  7143
  7144     12  CQ-ENTRY-TYPE               PIC X.
  7145             88  CHECK-ON-QUE           VALUE 'Q'.
  7146             88  ALIGNMENT-CHECK        VALUE 'A'.
  7147             88  SPOILED-CHECK          VALUE 'S'.
  7148             88  PAYMENT-ABORTED        VALUE 'X'.
  7149
  7150     12  CQ-CLAIM-MAST-CNTL.
  7151         16  CQ-CARRIER              PIC X.
  7152         16  CQ-CLAIM-NO             PIC X(7).
  7153         16  CQ-CERT-NO.
  7154             20  CQ-CERT-PRIME       PIC X(10).
  7155             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 136
* EL156.cbl
  7156         16  CQ-CLAIM-TYPE           PIC X.
  7157             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7158             88  CQ-AH-CLAIM            VALUE 'A'.
  7159         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7160             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7161             88  CQ-O-B-COVERAGE        VALUE '2'.
  7162             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7163
  7164     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7165     12  CQ-CHECK-NUMBER             PIC X(7).
  7166     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7167     12  CQ-PAYMENT-TYPE             PIC X.
  7168             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7169             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7170             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7171             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7172             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7173             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7174             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7175             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7176     12  CQ-VOID-INDICATOR           PIC X.
  7177             88  CHECK-IS-STOPPED          VALUE 'S'.
  7178             88  CHECK-IS-VOID             VALUE 'V'.
  7179     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7180     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7181     12  CQ-CHECK-BY-USER            PIC X(4).
  7182     12  CQ-PRE-NUMBERING-SW         PIC X.
  7183       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7184       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7185
  7186     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7187     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7188     12  CQ-LEDGER-FLAG              PIC X(01).
  7189     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7190     12  CQ-LAST-UPDATED-DT          PIC XX.
  7191     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7192     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7193
  7194     12  FILLER                      PIC X(04).
  7195
  7196******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 137
* EL156.cbl
  7198*    COPY ELCBENE.
  7199******************************************************************
  7200*                                                                *
  7201*                            ELCBENE.                            *
  7202*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7203*                            VMOD=2.006                          *
  7204*                                                                *
  7205*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7206*                                                                *
  7207*   FILE TYPE = VSAM,KSDS                                        *
  7208*   RECORD SIZE = 500   RECFORM = FIX                            *
  7209*                                                                *
  7210*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7211*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7212*                                                                *
  7213*   LOG = YES                                                    *
  7214*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7215*                                                                *
  7216*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7217******************************************************************
  7218*                   C H A N G E   L O G
  7219*
  7220* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7221*-----------------------------------------------------------------
  7222*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7223* EFFECTIVE    NUMBER
  7224*-----------------------------------------------------------------
  7225* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7226* 082317  CR2017082100003  PEMA  Add sub type
  7227* 032019  CR2019011400002  PEMA  Add email address for ach report
  7228******************************************************************
  7229
  7230 01  BENEFICIARY-MASTER.
  7231     12  BE-RECORD-ID                PIC XX.
  7232         88  VALID-BE-ID                VALUE 'BE'.
  7233
  7234     12  BE-CONTROL-PRIMARY.
  7235         16  BE-COMPANY-CD           PIC X.
  7236         16  BE-RECORD-TYPE          PIC X.
  7237             88  BENEFICIARY-RECORD  VALUE 'B'.
  7238             88  ADJUSTOR-RECORD     VALUE 'A'.
  7239         16  BE-BENEFICIARY          PIC X(10).
  7240     12  BE-CONTROL-BY-NAME.
  7241         16  BE-COMPANY-CD-A1        PIC X.
  7242         16  BE-RECORD-TYPE-A1       PIC X.
  7243         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7244         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7245
  7246     12  BE-LAST-MAINT-DT            PIC XX.
  7247     12  BE-LAST-MAINT-BY            PIC X(4).
  7248     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7249
  7250     12  BE-ADDRESS-DATA.
  7251         16  BE-MAIL-TO-NAME         PIC X(30).
  7252         16  BE-ADDRESS-LINE-1       PIC X(30).
  7253         16  BE-ADDRESS-LINE-2       PIC X(30).
  7254         16  BE-ADDRESS-LINE-3       PIC X(30).
  7255         16  BE-CITY-STATE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 138
* EL156.cbl
  7256             20  BE-CITY             PIC X(28).
  7257             20  BE-STATE            PIC XX.
  7258         16  BE-ZIP-CODE.
  7259             20  BE-ZIP-PRIME.
  7260                 24  BE-ZIP-1ST      PIC X.
  7261                     88  BE-CANADIAN-POST-CODE
  7262                                         VALUE 'A' THRU 'Z'.
  7263                 24  FILLER          PIC X(4).
  7264             20  BE-ZIP-PLUS4        PIC X(4).
  7265         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7266             20  BE-CAN-POSTAL-1     PIC XXX.
  7267             20  BE-CAN-POSTAL-2     PIC XXX.
  7268             20  FILLER              PIC XXX.
  7269         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7270         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7271
  7272******************************************************************
  7273*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7274*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7275******************************************************************
  7276     12  BE-CARRIER                  PIC X.
  7277
  7278     12  BE-ADDRESS-DATA2.
  7279         16  BE-MAIL-TO-NAME2        PIC X(30).
  7280         16  BE-ADDRESS-LINE-12      PIC X(30).
  7281         16  BE-ADDRESS-LINE-22      PIC X(30).
  7282         16  BE-ADDRESS-LINE-32      PIC X(30).
  7283         16  BE-CITY-STATE2.
  7284             20  BE-CITY2            PIC X(28).
  7285             20  BE-STATE2           PIC XX.
  7286         16  BE-ZIP-CODE2.
  7287             20  BE-ZIP-PRIME2.
  7288                 24  BE-ZIP-1ST2     PIC X.
  7289                     88  BE-CANADIAN-POST-CODE2
  7290                                         VALUE 'A' THRU 'Z'.
  7291                 24  FILLER          PIC X(4).
  7292             20  BE-ZIP-PLUS42       PIC X(4).
  7293         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7294             20  BE-CAN-POSTAL-12    PIC XXX.
  7295             20  BE-CAN-POSTAL-22    PIC XXX.
  7296             20  FILLER              PIC XXX.
  7297         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7298         16  BE-ACH-DATA.
  7299             20  BE-ACH-YES-OR-NO    PIC X.
  7300                 88  BE-ON-ACH       VALUE 'Y'.
  7301                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7302             20  BE-ACH-ABA-ROUTING-NUMBER
  7303                                     PIC X(15).
  7304             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7305                                     PIC X(20).
  7306             20  BE-ACH-SUB-TYPE     PIC XX.
  7307             20  BE-ACH-EMAIL-YN     PIC X.
  7308                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.
  7309             20  be-ach-email-addr   PIC X(40).
  7310         16  BE-BILLING-STMT-DATA.
  7311*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7312             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7313             20  BE-OUTPUT-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 139
* EL156.cbl
  7314                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7315                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7316
  7317     12  filler                      PIC X(16).
  7318******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 140
* EL156.cbl
  7320*    COPY ELCARCH.
  7321******************************************************************
  7322*                                                                *
  7323*                            ELCARCH.                            *
  7324*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7325*                            VMOD=2.007                          *
  7326*                                                                *
  7327*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7328*                                                                *
  7329*   FILE TYPE = VSAM,KSDS                                        *
  7330*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7331*                                                                *
  7332*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7333*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7334*                                                                *
  7335*   LOG = NO                                                     *
  7336*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7337*                                                                *
  7338*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7339******************************************************************
  7340 01  LETTER-ARCHIVE.
  7341     12  LA-RECORD-ID                PIC XX.
  7342         88  VALID-LA-ID                VALUE 'LA'.
  7343
  7344     12  LA-CONTROL-PRIMARY.
  7345         16  LA-COMPANY-CD           PIC X.
  7346         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7347         16  LA-RECORD-TYPE          PIC X.
  7348             88  LA-HEADER-DATA         VALUE '1'.
  7349             88  LA-ADDRESS-DATA        VALUE '2'.
  7350             88  LA-TEXT-DATA           VALUE '3'.
  7351             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7352         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7353
  7354     12  LA-CONTROL-BY-TYPE.
  7355         16  LA-COMPANY-CD-A1        PIC X.
  7356         16  LA-RECORD-TYPE-A1       PIC X.
  7357         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7358         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7359
  7360     12  LA-TEXT-RECORD.
  7361         16  LA-SKIP-CONTROL         PIC XX.
  7362             88  NO-LINES-SKIPPED       VALUE SPACES.
  7363             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7364         16  LA-TEXT-LINE            PIC X(70).
  7365
  7366     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7367         16  FILLER                  PIC XX.
  7368         16  LA-ADDRESS-LINE         PIC X(30).
  7369         16  FILLER                  PIC X(40).
  7370
  7371     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7372         16  FILLER                  PIC XX.
  7373         16  LA-CARRIER              PIC X.
  7374         16  LA-CLAIM-NO             PIC X(7).
  7375         16  LA-CERT-NO.
  7376             20  LA-CERT-PRIME       PIC X(10).
  7377             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 141
* EL156.cbl
  7378         16  LA-NO-OF-COPIES         PIC S9.
  7379         16  LA-RESEND-DATE          PIC XX.
  7380         16  LA-PROCESSOR-CD         PIC X(4).
  7381         16  LA-CREATION-DT          PIC XX.
  7382         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7383         16  LA-RESEND-PRINT-DATE    PIC XX.
  7384         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7385         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7386*
  7387* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7388*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7389*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7390*   I        20  LA-DMD-RES-ST           PIC XX.
  7391*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7392*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7393*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7394*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7395*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7396*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7397*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7398*   I        20  LA-DMD-UND-CODE         PIC XX.
  7399*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7400*   V    16  FILLER                  PIC X(15).
  7401* -----
  7402*
  7403* REINSERTED  CSO  MODS
  7404*
  7405         16  FILLER.
  7406             20  FILLER                  PIC X(29).
  7407             20  LA-CSO-LETTER-STATUS    PIC X.
  7408                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7409                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7410                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7411             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7412             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7413*
  7414
  7415     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7416         16  FILLER                  PIC XX.
  7417         16  LA4-CARRIER             PIC X.
  7418         16  LA4-CLAIM-NO            PIC X(7).
  7419         16  LA4-CERT-NO.
  7420             20  LA4-CERT-PRIME      PIC X(10).
  7421             20  LA4-CERT-SFX        PIC X.
  7422         16  LA4-NO-OF-COPIES        PIC S9.
  7423         16  LA4-RESEND-DATE         PIC XX.
  7424         16  LA4-PROCESSOR-CD        PIC X(4).
  7425         16  LA4-CREATION-DT         PIC XX.
  7426         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7427         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7428         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7429         16  LA4-FORM-TYPE           PIC X.
  7430             88  LA4-INITIAL-FORM    VALUE '1'.
  7431             88  LA4-PROGRESS-FORM   VALUE '2'.
  7432         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7433         16  LA4-STATE               PIC X(02).
  7434         16  FILLER                  PIC X(31).
  7435******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 142
* EL156.cbl
  7437*    COPY ELCDAR.
  7438******************************************************************
  7439*                                                                *
  7440*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7441*   FILE TYPE = VSAM,KSDS                                        *
  7442*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7443*   BASE CLUSTER = DLYACTV                                       *
  7444*   LOG = YES                                                    *
  7445*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7446*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7447*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7448*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7449*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7450*               BY PROGRAM "LGINFCE".                            *
  7451*                                                                *
  7452******************************************************************
  7453 01  DAILY-ACTIVITY-RECORD.
  7454     05  DA-KEY.
  7455         10  DA-COMP-CD          PIC X.
  7456         10  DA-CARRIER          PIC X.
  7457         10  DA-CLAIM-NO         PIC X(7).
  7458         10  DA-CERT-NO.
  7459             15  DA-CERT-PRIME   PIC X(10).
  7460             15  DA-CERT-SFX     PIC X.
  7461     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7462     05  DA-RECORD-TYPE          PIC X.
  7463     05  FILLER                  PIC X(2).
  7464******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 143
* EL156.cbl
  7466*    COPY ERCCOMP.
  7467******************************************************************
  7468*                                                                *
  7469*                                                                *
  7470*                            ERCCOMP                             *
  7471*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7472*                            VMOD=2.019                          *
  7473*                                                                *
  7474*   ONLINE CREDIT SYSTEM                                         *
  7475*                                                                *
  7476*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7477*                                                                *
  7478*   FILE TYPE = VSAM,KSDS                                        *
  7479*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7480*                                                                *
  7481*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7482*       ALTERNATE PATH = NONE                                    *
  7483*                                                                *
  7484*   LOG = NO                                                     *
  7485*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7486*                                                                *
  7487******************************************************************
  7488*                   C H A N G E   L O G
  7489*
  7490* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7491*-----------------------------------------------------------------
  7492*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7493* EFFECTIVE    NUMBER
  7494*-----------------------------------------------------------------
  7495* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7496* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7497* 092205    2005050300006  PEMA  ADD LEASE FEE
  7498* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7499* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7500* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7501* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7502* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7503* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7504******************************************************************
  7505
  7506 01  COMPENSATION-MASTER.
  7507     12  CO-RECORD-ID                          PIC XX.
  7508         88  VALID-CO-ID                          VALUE 'CO'.
  7509
  7510     12  CO-CONTROL-PRIMARY.
  7511         16  CO-COMPANY-CD                     PIC X.
  7512         16  CO-CONTROL.
  7513             20  CO-CTL-1.
  7514                 24  CO-CARR-GROUP.
  7515                     28  CO-CARRIER            PIC X.
  7516                     28  CO-GROUPING.
  7517                         32  CO-GROUP-PREFIX   PIC XXX.
  7518                         32  CO-GROUP-PRIME    PIC XXX.
  7519                 24  CO-RESP-NO.
  7520                     28  CO-RESP-PREFIX        PIC X(4).
  7521                     28  CO-RESP-PRIME         PIC X(6).
  7522             20  CO-CTL-2.
  7523                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 144
* EL156.cbl
  7524                     28  CO-ACCT-PREFIX        PIC X(4).
  7525                     28  CO-ACCT-PRIME         PIC X(6).
  7526         16  CO-TYPE                           PIC X.
  7527             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7528             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7529             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7530
  7531     12  CO-MAINT-INFORMATION.
  7532         16  CO-LAST-MAINT-DT                  PIC XX.
  7533         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7534         16  CO-LAST-MAINT-USER                PIC X(4).
  7535     12  FILLER                                PIC XX.
  7536     12  CO-STMT-TYPE                          PIC XXX.
  7537     12  CO-COMP-TYPE                          PIC X.
  7538         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7539     12  CO-STMT-OWNER                         PIC X(4).
  7540     12  CO-BALANCE-CONTROL                    PIC X.
  7541         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7542         88  CO-NO-BALANCE                        VALUE 'N'.
  7543
  7544     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7545         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7546         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7547         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7548
  7549     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7550         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7551         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7552
  7553     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7554     12  CO-GA-DIRECT-DEP                      PIC X.
  7555     12  CO-FUTURE-SPACE                       PIC X.
  7556         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7557
  7558     12  CO-ACCT-NAME                          PIC X(30).
  7559     12  CO-MAIL-NAME                          PIC X(30).
  7560     12  CO-ADDR-1                             PIC X(30).
  7561     12  CO-ADDR-2                             PIC X(30).
  7562     12  CO-ADDR-3.
  7563         16  CO-ADDR-CITY                      PIC X(27).
  7564         16  CO-ADDR-STATE                     PIC XX.
  7565     12  CO-CSO-1099                           PIC X.
  7566     12  CO-ZIP.
  7567         16  CO-ZIP-PRIME.
  7568             20  CO-ZIP-PRI-1ST                PIC X.
  7569                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7570             20  FILLER                        PIC X(4).
  7571         16  CO-ZIP-PLUS4                      PIC X(4).
  7572     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7573         16  CO-CAN-POSTAL-1                   PIC XXX.
  7574         16  CO-CAN-POSTAL-2                   PIC XXX.
  7575         16  FILLER                            PIC XXX.
  7576     12  CO-SOC-SEC                            PIC X(13).
  7577     12  CO-TELEPHONE.
  7578         16  CO-AREA-CODE                      PIC XXX.
  7579         16  CO-PREFIX                         PIC XXX.
  7580         16  CO-PHONE                          PIC X(4).
  7581
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 145
* EL156.cbl
  7582     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7583
  7584     12  CO-AR-BAL-LEVEL                       PIC X.
  7585         88  CO-AR-REF-LVL                        VALUE '1'.
  7586         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7587         88  CO-AR-BILL-LVL                       VALUE '2'.
  7588         88  CO-AR-AGT-LVL                        VALUE '3'.
  7589         88  CO-AR-FR-LVL                         VALUE '4'.
  7590
  7591     12  CO-AR-NORMAL-PRINT                    PIC X.
  7592         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7593         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7594
  7595     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7596
  7597     12  CO-AR-REPORTING                       PIC X.
  7598         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7599         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7600
  7601     12  CO-AR-PULL-CHECK                      PIC X.
  7602         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7603         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7604
  7605     12  CO-AR-BALANCE-PRINT                   PIC X.
  7606         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7607
  7608     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7609         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7610         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7611         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7612
  7613     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7614
  7615     12  CO-USER-CODE                          PIC X.
  7616     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7617
  7618******************************************************************
  7619*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7620*    THE LAST MONTH END RUN.
  7621******************************************************************
  7622
  7623     12  CO-LAST-ACTIVITY-DATE.
  7624         16  CO-ACT-YEAR                       PIC 99.
  7625         16  CO-ACT-MONTH                      PIC 99.
  7626         16  CO-ACT-DAY                        PIC 99.
  7627
  7628     12  CO-LAST-STMT-DT.
  7629         16  CO-LAST-STMT-YEAR                 PIC 99.
  7630         16  CO-LAST-STMT-MONTH                PIC 99.
  7631         16  CO-LAST-STMT-DAY                  PIC 99.
  7632
  7633     12  CO-MO-END-TOTALS.
  7634         16  CO-MONTHLY-TOTALS.
  7635             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7636             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7637             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7638             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7639             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 146
* EL156.cbl
  7640
  7641         16  CO-AGING-TOTALS.
  7642             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7643             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7644             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7645             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7646
  7647         16  CO-YTD-TOTALS.
  7648             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7649             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7650
  7651         16  CO-OVER-UNDER-TOTALS.
  7652             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7653             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7654
  7655     12  CO-MISCELLANEOUS-TOTALS.
  7656         16  CO-FICA-TOTALS.
  7657             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7658             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7659
  7660         16  CO-CLAIM-TOTALS.
  7661             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7662             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7663
  7664******************************************************************
  7665*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7666*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7667******************************************************************
  7668
  7669     12  CO-CURRENT-TOTALS.
  7670         16  CO-CURRENT-LAST-STMT-DT.
  7671             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7672             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7673             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7674
  7675         16  CO-CURRENT-MONTHLY-TOTALS.
  7676             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7677             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7678             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7679             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7680             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7681
  7682         16  CO-CURRENT-AGING-TOTALS.
  7683             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7684             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7685             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7686             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7687
  7688         16  CO-CURRENT-YTD-TOTALS.
  7689             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7690             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7691
  7692     12  CO-PAID-COMM-TOTALS.
  7693         16  CO-YTD-PAID-COMMS.
  7694             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7695             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7696
  7697     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 147
* EL156.cbl
  7698         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7699         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7700
  7701     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7702         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7703         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7704         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7705         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7706         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7707         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7708         88  CO-FINAL-LETTER                  VALUE 'F'.
  7709         88  CO-RECONCILING                   VALUE 'R'.
  7710         88  CO-PHONE-CALL                    VALUE 'P'.
  7711         88  CO-LEGAL                         VALUE 'L'.
  7712         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7713         88  CO-WRITE-OFF                     VALUE 'W'.
  7714         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7715
  7716     12  CO-CSR-CODE                       PIC X(4).
  7717
  7718     12  CO-GA-STATUS-INFO.
  7719         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7720         16  CO-GA-TERMINATION-DT          PIC XX.
  7721         16  CO-GA-STATUS-CODE             PIC X.
  7722             88  CO-GA-ACTIVE                 VALUE 'A'.
  7723             88  CO-GA-INACTIVE               VALUE 'I'.
  7724             88  CO-GA-PENDING                VALUE 'P'.
  7725         16  CO-GA-COMMENTS.
  7726             20  CO-GA-COMMENT-1           PIC X(40).
  7727             20  CO-GA-COMMENT-2           PIC X(40).
  7728             20  CO-GA-COMMENT-3           PIC X(40).
  7729             20  CO-GA-COMMENT-4           PIC X(40).
  7730
  7731     12  CO-RPTCD2                         PIC X(10).
  7732     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7733         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7734         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7735
  7736     12  CO-TYPE-AGENT                     PIC X(01).
  7737         88  CO-CORPORATION                   VALUE 'C'.
  7738         88  CO-PARTNERSHIP                   VALUE 'P'.
  7739         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7740         88  CO-TRUST                         VALUE 'T'.
  7741         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7742
  7743     12  CO-FAXNO.
  7744         16  CO-FAX-AREA-CODE                  PIC XXX.
  7745         16  CO-FAX-PREFIX                     PIC XXX.
  7746         16  CO-FAX-PHONE                      PIC X(4).
  7747
  7748     12  CO-BANK-INFORMATION.
  7749         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7750         16  CO-BANK-TRANSIT-NON REDEFINES
  7751             CO-BANK-TRANSIT-NO                PIC 9(8).
  7752
  7753         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7754     12  CO-MISC-DEDUCT-INFO REDEFINES
  7755                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 148
* EL156.cbl
  7756         16  CO-MD-GL-ACCT                     PIC X(10).
  7757         16  CO-MD-DIV                         PIC XX.
  7758         16  CO-MD-CENTER                      PIC X(4).
  7759         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7760         16  CO-CREATE-AP-CHECK                PIC X.
  7761         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7762         16  FILLER                            PIC XXX.
  7763     12  CO-ACH-STATUS                         PIC X.
  7764         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7765         88  CO-ACH-PENDING                        VALUE 'P'.
  7766
  7767     12  CO-BILL-SW                            PIC X.
  7768     12  CO-CONTROL-NAME                       PIC X(30).
  7769     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7770     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7771     12  CO-CLP-STATE                          PIC XX.
  7772     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7773     12  CO-SPP-REFUND-EDIT                    PIC X.
  7774
  7775******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 149
* EL156.cbl
  7777*    COPY ERCDMDNT.
  7778******************************************************************
  7779*                                                                *
  7780*                            ERCDMDNT                            *
  7781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7782*                            VMOD=2.005                          *
  7783*                                                                *
  7784*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7785*                                                                *
  7786*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7787*                                                                *
  7788*        FILE TYPE= VSAM,KSDS                                    *
  7789*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7790*                                                                *
  7791*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7792*                                                                *
  7793*        LOG = YES                                               *
  7794*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7795*                                                                *
  7796******************************************************************
  7797
  7798 01  CERTIFICATE-NOTE.
  7799     12  CN-RECORD-ID                     PIC  XX.
  7800         88  VALID-CN-ID                      VALUE 'CN'.
  7801
  7802     12  CN-CONTROL-PRIMARY.
  7803         16  CN-COMPANY-CD                PIC X.
  7804         16  CN-CERT-KEY.
  7805             20  CN-CARRIER               PIC X.
  7806             20  CN-GROUPING.
  7807                 24  CN-GROUPING-PREFIX   PIC XXX.
  7808                 24  CN-GROUPING-PRIME    PIC XXX.
  7809             20  CN-STATE                 PIC XX.
  7810             20  CN-ACCOUNT.
  7811                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7812                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7813             20  CN-CERT-EFF-DT           PIC XX.
  7814             20  CN-CERT-NO.
  7815                 24  CN-CERT-PRIME        PIC X(10).
  7816                 24  CN-CERT-SFX          PIC X.
  7817
  7818     12  CN-BILLING-START-LINE-NO         PIC 99.
  7819     12  CN-BILLING-END-LINE-NO           PIC 99.
  7820
  7821     12  CN-LINES.
  7822         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7823
  7824     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7825         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7826         16  CN-CSI-GENERAL-DATA-AREA.
  7827             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7828
  7829         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7830             CN-CSI-GENERAL-DATA-AREA.
  7831             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7832             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7833             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7834             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 150
* EL156.cbl
  7835             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7836             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7837             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7838             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7839             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7840             20  FILLER                       PIC XX.
  7841             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7842             20  FILLER                       PIC X(38).
  7843
  7844         16  CN-CSI-PRODUCT-DATA-AREA.
  7845             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7846
  7847         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7848             CN-CSI-PRODUCT-DATA-AREA.
  7849             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7850             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7851             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7852             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7853             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7854             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7855             20  FILLER                   PIC XX.
  7856             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7857             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7858             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7859             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7860             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7861             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7862             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7863             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7864             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7865             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7866             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7867             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7868             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7869             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7870             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7871             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7872             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7873             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7874             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7875             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7876             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7877             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7878             20  FILLER                   PIC X(25).
  7879
  7880         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7881             CN-CSI-CREDIT-CARD-DATA.
  7882             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7883             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7884             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7885             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7886             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7887             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7888             20  FILLER                   PIC XX.
  7889             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7890             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7891             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7892             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 151
* EL156.cbl
  7893             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7894             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7895             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7896             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7897             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7898             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7899             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7900             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7901             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7902             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7903             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7904             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7905             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7906             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7907             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7908             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7909             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7910             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7911             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7912             20  FILLER                   PIC X(17).
  7913
  7914         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7915             CN-CSI-FAMILY-LEAVE-DATA.
  7916             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7917             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7918             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7919             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7920             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7921             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7922             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7923             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7924             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7925             20  CN-CSI-SL-INT-ON-PROCEEDS
  7926                                          PIC S9(5)V99  COMP-3.
  7927             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7928             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7929             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7930             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7931             20  CN-CSI-SL-POLICY-BENEFITS
  7932                                          PIC S9(5)V99  COMP-3.
  7933             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7934             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7935             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7936             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7937             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7938             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7939             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7940             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7941             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7942             20  CN-CSI-SL-STATE-NOT      PIC X.
  7943             20  FILLER                   PIC XX.
  7944
  7945         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7946             CN-CSI-SENIOR-LIFE-DATA.
  7947             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7948             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7949             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7950                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 152
* EL156.cbl
  7951             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7952             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7953             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7954             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7955             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7956             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7957             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7958             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7959             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7960             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7961             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7962             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7963             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7964             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7965             20  CN-CSI-PP-REPAIR         PIC X.
  7966             20  CN-CSI-PP-REPLACE        PIC X.
  7967             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7968             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7969             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7970             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7971             20  FILLER                   PIC X(5).
  7972
  7973         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7974             CN-CSI-PURCH-PROP-DATA.
  7975             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7976             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7977             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7978             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7979             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7980             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7981             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7982             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7983             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7984             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7985             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7986             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7987             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7988             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7989             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7990             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7991             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7992             20  CN-CSI-EW-REPLACE        PIC X.
  7993             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7994             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7995             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7996             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7997             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7998             20  FILLER                   PIC X(4).
  7999
  8000     12  CN-LAST-MAINT-DT                 PIC XX.
  8001     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  8002     12  CN-LAST-MAINT-USER               PIC X(4).
  8003     12  FILLER                           PIC X(6).
  8004
  8005******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 153
* EL156.cbl
  8007*    COPY ERCCNOT.
  8008******************************************************************
  8009*                                                                *
  8010*                            ERCCNOT                             *
  8011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8012*                            VMOD=2.003                          *
  8013*                                                                *
  8014*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  8015*                                                                *
  8016*        FILE TYPE= VSAM,KSDS                                    *
  8017*        RECORD SIZE = 150    RECFORM = FIXED                    *
  8018*                                                                *
  8019*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  8020*                                                                *
  8021*        LOG = YES                                               *
  8022*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8023*                                                                *
  8024******************************************************************
  8025*                   C H A N G E   L O G
  8026*
  8027* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8028*-----------------------------------------------------------------
  8029*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8030* EFFECTIVE    NUMBER
  8031*-----------------------------------------------------------------
  8032* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  8033******************************************************************
  8034
  8035 01  CERT-NOTE-FILE.
  8036     12  CZ-RECORD-ID                PIC  XX.
  8037         88  VALID-CZ-ID                  VALUE 'CZ'.
  8038
  8039     12  CZ-CONTROL-PRIMARY.
  8040         16  CZ-COMPANY-CD           PIC X.
  8041         16  CZ-CARRIER              PIC X.
  8042         16  CZ-GROUPING.
  8043             20 CZ-GROUPING-PREFIX   PIC XXX.
  8044             20 CZ-GROUPING-PRIME    PIC XXX.
  8045         16  CZ-STATE                PIC XX.
  8046         16  CZ-ACCOUNT.
  8047             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  8048             20 CZ-ACCOUNT-PRIME     PIC X(6).
  8049         16  CZ-CERT-EFF-DT          PIC XX.
  8050         16  CZ-CERT-NO.
  8051             20  CZ-CERT-PRIME       PIC X(10).
  8052             20  CZ-CERT-SFX         PIC X.
  8053         16  CZ-RECORD-TYPE          PIC X.
  8054             88  CERT-NOTE           VALUE '1'.
  8055             88  CLAIM-CERT-NOTE     VALUE '2'.
  8056         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8057
  8058     12  CZ-LAST-MAINT-DT            PIC XX.
  8059     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8060     12  CZ-LAST-MAINT-USER          PIC X(4).
  8061
  8062     12  CZ-NOTE-INFORMATION.
  8063         16  CZ-NOTE                 PIC X(63).
  8064         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 154
* EL156.cbl
  8065******************************************************************
  8066*                            COPY ERCPDEF.
  8067******************************************************************
  8068*                                                                *
  8069*                                                                *
  8070*                            ERCPDEF.                            *
  8071*                                                                *
  8072*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8073*                                                                *
  8074*    FILE TYPE = VSAM,KSDS                                       *
  8075*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8076*                                                                *
  8077*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8078*                                                                *
  8079*    LOG = YES                                                   *
  8080*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8081******************************************************************
  8082*                   C H A N G E   L O G
  8083*
  8084* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8085*-----------------------------------------------------------------
  8086*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8087* EFFECTIVE    NUMBER
  8088*-----------------------------------------------------------------
  8089* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8090* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8091* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8092* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8093******************************************************************
  8094 01  PRODUCT-MASTER.
  8095    12  PD-RECORD-ID                 PIC X(02).
  8096        88  VALID-PD-ID                  VALUE 'PD'.
  8097    12  PD-CONTROL-PRIMARY.
  8098        16  PD-COMPANY-CD            PIC X.
  8099        16  PD-STATE                 PIC XX.
  8100        16  PD-PRODUCT-CD            PIC XXX.
  8101        16  PD-FILLER                PIC X(7).
  8102        16  PD-BEN-TYPE              PIC X.
  8103        16  PD-BEN-CODE              PIC XX.
  8104        16  PD-PROD-EXP-DT           PIC XX.
  8105    12  FILLER                       PIC X(50).
  8106    12  PD-PRODUCT-DATA OCCURS 8.
  8107        16  PD-PROD-CODE             PIC X.
  8108            88  PD-PROD-LIFE           VALUE 'L'.
  8109            88  PD-PROD-PROP           VALUE 'P'.
  8110            88  PD-PROD-AH             VALUE 'A'.
  8111            88  PD-PROD-IU             VALUE 'I'.
  8112            88  PD-PROD-GAP            VALUE 'G'.
  8113            88  PD-PROD-FAML           VALUE 'F'.
  8114            88  PD-PROD-OTH            VALUE 'O'.
  8115        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8116        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8117        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8118        16  PD-MAX-TERM              PIC S999        COMP-3.
  8119        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8120        16  FILLER                   PIC X.
  8121        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8122        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 155
* EL156.cbl
  8123        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8124        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  8125        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8126        16  PD-REC-CRIT-PERIOD       PIC 99.
  8127        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8128            20  PD-RECURRING-YN      PIC X.
  8129            20  FILLER               PIC X.
  8130        16  PD-RTW-MOS               PIC 99.
  8131        16  PD-MAX-EXTENSION         PIC 99.
  8132        16  pd-ben-pct               pic sv999 comp-3.
  8133*       16  FILLER                   PIC XX.
  8134    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8135    12  PD-TERM-LIMITS OCCURS 15.
  8136        16  PD-LOW-TERM              PIC S999        COMP-3.
  8137        16  PD-HI-TERM               PIC S999        COMP-3.
  8138*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8139    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8140        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8141        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8142    12  PD-EARN-FACTORS.
  8143        16  FILLER OCCURS 15.
  8144            20  FILLER OCCURS 15.
  8145                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8146    12  PD-PRODUCT-DESC              PIC X(80).
  8147    12  PD-TRUNCATED                 PIC X.
  8148    12  FILLER                       PIC X(59).
  8149    12  PD-MAINT-INFORMATION.
  8150        16  PD-LAST-MAINT-DT         PIC X(02).
  8151        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8152        16  PD-LAST-MAINT-BY         PIC X(04).
  8153*                            COPY ELCCRTT.
  8154******************************************************************
  8155*                                                                *
  8156*                            ELCCRTT.                            *
  8157*                                                                *
  8158*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8159*                                                                *
  8160*   FILE TYPE = VSAM,KSDS                                        *
  8161*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8162*                                                                *
  8163*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8164*                                                                *
  8165*   LOG = YES                                                    *
  8166*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8167******************************************************************
  8168*                   C H A N G E   L O G
  8169*
  8170* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8171*-----------------------------------------------------------------
  8172*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8173* EFFECTIVE    NUMBER
  8174*-----------------------------------------------------------------
  8175* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8176* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8177* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8178* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8179* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8180* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 156
* EL156.cbl
  8181* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8182* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8183* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8184* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8185* 091318  CR2018073000001  PEMA  ADD Refund methods
  8186* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8187******************************************************************
  8188
  8189 01  CERTIFICATE-TRAILERS.
  8190     12  CS-RECORD-ID                      PIC XX.
  8191         88  VALID-CS-ID                      VALUE 'CS'.
  8192
  8193     12  CS-CONTROL-PRIMARY.
  8194         16  CS-COMPANY-CD                 PIC X.
  8195         16  CS-CARRIER                    PIC X.
  8196         16  CS-GROUPING                   PIC X(6).
  8197         16  CS-STATE                      PIC XX.
  8198         16  CS-ACCOUNT                    PIC X(10).
  8199         16  CS-CERT-EFF-DT                PIC XX.
  8200         16  CS-CERT-NO.
  8201             20  CS-CERT-PRIME             PIC X(10).
  8202             20  CS-CERT-SFX               PIC X.
  8203         16  CS-TRAILER-TYPE               PIC X.
  8204             88  COMM-TRLR           VALUE 'A'.
  8205             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8206             88  CERT-DATA-TRLR      VALUE 'C'.
  8207
  8208     12  CS-DATA-AREA                      PIC X(516).
  8209
  8210     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8211         16  CS-BANK-COMMISSION-AREA.
  8212             20  CS-BANK-COMMS       OCCURS 10.
  8213                 24  CS-AGT                PIC X(10).
  8214                 24  CS-COM-TYP            PIC X.
  8215                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8216                 24  CS-RECALC-LV-INDIC    PIC X.
  8217                 24  FILLER                PIC X(10).
  8218         16  FILLER                        PIC X(256).
  8219
  8220     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8221****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8222         16  CS-MB-CLAIM-DATA OCCURS 24.
  8223             20  CS-CLAIM-NO               PIC X(7).
  8224             20  CS-CLAIM-TYPE             PIC X.
  8225                 88  CS-AH-CLM               VALUE 'A'.
  8226                 88  CS-IU-CLM               VALUE 'I'.
  8227                 88  CS-GP-CLM               VALUE 'G'.
  8228                 88  CS-LF-CLM               VALUE 'L'.
  8229                 88  CS-PR-CLM               VALUE 'P'.
  8230                 88  CS-FL-CLM               VALUE 'F'.
  8231                 88  CS-OT-CLM               VALUE 'O'.
  8232             20  CS-INSURED-TYPE           PIC X.
  8233                 88  CS-PRIM-INSURED          VALUE 'P'.
  8234                 88  CS-CO-BORROWER           VALUE 'C'.
  8235             20  CS-BENEFIT-PERIOD         PIC 99.
  8236             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8237             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8238             20  CS-REMAINING-BENS         PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 157
* EL156.cbl
  8239         16  FILLER                        PIC X(12).
  8240     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8241         16  CS-VIN-NUMBER                 PIC X(17).
  8242         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8243         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8244         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8245         16  cs-agent-name.
  8246             20  cs-agent-fname            pic x(20).
  8247             20  cs-agent-mi               pic x.
  8248             20  cs-agent-lname            pic x(25).
  8249         16  cs-license-no                 pic x(15).
  8250         16  cs-npn-number                 pic x(10).
  8251         16  cs-agent-edit-status          pic x.
  8252             88  cs-ae-refer-to-manager      value 'M'.
  8253             88  cs-ae-cover-sheet           value 'C'.
  8254             88  cs-ae-sig-form              value 'S'.
  8255             88  cs-ae-verified              value 'V'.
  8256             88  cs-unidentified-signature   value 'U'.
  8257             88  cs-cert-returned            value 'R'.
  8258             88  cs-accept-no-commission     value 'N'.
  8259         16  cs-year                       pic 9999.
  8260         16  cs-make                       pic x(20).
  8261         16  cs-model                      pic x(20).
  8262         16  cs-future                     pic x(20).
  8263         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8264         16  cs-claim-verification-status  pic x.
  8265             88  cs-clm-ver-eligible         value 'A'.
  8266             88  cs-clm-ver-partial-elig     value 'B'.
  8267             88  cs-clm-ver-not-eligible     value 'C'.
  8268             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8269             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8270             88  cs-clm-ver-ND-CERT          value 'F'.
  8271             88  cs-clm-ver-spec-other       value 'G'.
  8272             88  cs-clam-ver-pratial-corrected
  8273                                             value 'H'.
  8274             88  cs-clm-ver-no-matches       value 'I'.
  8275             88  cs-clm-ver-not-elig-corrected
  8276                                             value 'J'.
  8277             88  cs-clm-ver-needs-review     value 'R'.
  8278             88  cs-clm-ver-sent-to-claims   value 'W'.
  8279         16  CS-LF-REFUND-METHOD           PIC X.
  8280         16  CS-AH-REFUND-METHOD           PIC X.
  8281         16  FILLER                        PIC X(353). *> was 420
  8282*        16  FILLER                        PIC X(496).
  8283 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8284                          CONTROL-FILE CERTIFICATE-MASTER
  8285                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8286                          ACCOUNT-MASTER CHECK-QUE
  8287                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8288                          DAILY-ACTIVITY-RECORD
  8289                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8290                          CERT-NOTE-FILE PRODUCT-MASTER
  8291                          CERTIFICATE-TRAILERS.
  8292 0000-DFHEXIT SECTION.
  8293     MOVE '9#                    $   ' TO DFHEIV0.
  8294     MOVE 'EL156' TO DFHEIV1.
  8295     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8296
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 158
* EL156.cbl
  8297     IF EIBCALEN = 0
  8298         GO TO 8800-UNAUTHORIZED-ACCESS.
  8299
  8300     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8301     MOVE EIBTRMID               TO QID-TERM.
  8302     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8303     MOVE '2'                    TO EMI-SWITCH2.
  8304     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8305     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8306
  8307     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8308     MOVE '5'                    TO DC-OPTION-CODE.
  8309     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8310     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8311                                    SAVE-BIN-DATE.
  8312     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8313     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8314
  8315     IF SAVE-DATE-YY > 70
  8316         MOVE 19                 TO SAVE-DATE-CC
  8317     ELSE
  8318         MOVE 20                 TO SAVE-DATE-CC.
  8319
  8320     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8321         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8322     END-IF.
  8323
  8324     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8325        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8326     ELSE
  8327        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8328     END-IF
  8329
  8330     IF PI-PRINT-CLM-FRM-YN = 'N'
  8331         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8332     ELSE
  8333         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8334     END-IF
  8335
  8336     IF PI-PRINT-SURVEY-YN = 'N'
  8337         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8338     ELSE
  8339         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8340     END-IF
  8341
  8342     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8343         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8344     ELSE
  8345         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8346     END-IF
  8347
  8348* EXEC CICS HANDLE CONDITION
  8349*        NOTOPEN   (9990-ABEND)
  8350*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8351*        MAPFAIL   (0400-FIRST-TIME)
  8352*        DUPREC    (6180-DUPREC)
  8353*        ERROR     (9990-ABEND)
  8354*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 159
* EL156.cbl
  8355*    MOVE '"$JL?%.               ! " #00008343' TO DFHEIV0
  8356     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8358     MOVE X'2220233030303038333433' TO DFHEIV0(25:11)
  8359     CALL 'kxdfhei1' USING DFHEIV0
  8360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8361
  8362
  8363     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8364         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8365
  8366     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8367         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8368             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8369             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8370             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8371             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8372             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8373             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8374             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8375             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8376             MOVE LOW-VALUES           TO EL156AI
  8377             MOVE 'Y'                  TO FIRST-ENTRY
  8378         ELSE
  8379             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8380             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8381             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8382             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8383             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8384             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8385             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8386             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8387
  8388     IF RETURNED-FROM NOT = SPACES
  8389        IF (RETURNED-FROM = 'EL614')
  8390           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8391           IF WS-SAVED-EOB-CODES NOT = SPACES
  8392              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8393           ELSE
  8394              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8395           END-IF
  8396        END-IF
  8397         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8398            MOVE 'Y'             TO FIRST-ENTRY
  8399            IF RETURNED-FROM = 'EL614'
  8400               AND (PI-PASS-SW NOT = 'C')
  8401               IF WS-SAVED-EOB-CODES NOT = SPACES
  8402                  MOVE WS-SAVED-EOB-CODES
  8403                                 TO PI-PMTNOTE2
  8404                                    WS-PMTNOTE2
  8405                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8406               ELSE
  8407                  MOVE SPACES    TO PI-PMTNOTE2
  8408                                    WS-PMTNOTE2
  8409                                    PI-EOB-CODES-EXIST
  8410               END-IF
  8411            END-IF
  8412            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 160
* EL156.cbl
  8413            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8414            IF RETURNED-FROM = 'EL614'
  8415               GO TO 1000-EDIT-DATA
  8416            END-IF
  8417            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8418               (PAYEEI   = LOW-VALUES OR SPACES)
  8419               GO TO 8100-SEND-INITIAL-MAP
  8420            ELSE
  8421               GO TO 1000-EDIT-DATA.
  8422
  8423     IF EIBTRNID NOT = TRANS-ID
  8424         GO TO 0400-FIRST-TIME.
  8425
  8426     IF EIBAID = DFHCLEAR
  8427        IF PI-PASS-SW = 'C'
  8428           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8429           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8430           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8431           MOVE 'Y'            TO RETURNED-FROM-B
  8432           GO TO 1000-EDIT-DATA
  8433        ELSE
  8434           GO TO 9400-CLEAR.
  8435
  8436     IF PI-PASS-SW = 'C'
  8437         MOVE MAP-NAMEB          TO MAP-NAME
  8438         IF EIBAID = DFHPF1 OR DFHPF13
  8439             GO TO 5000-UPDATE
  8440           ELSE
  8441             IF EIBAID NOT = DFHENTER
  8442                 MOVE LOW-VALUES TO EL156BI
  8443                 MOVE MAP-NAMEB  TO MAP-NAME
  8444                 MOVE ER-0029    TO EMI-ERROR
  8445                 MOVE -1         TO  ENTPFBL
  8446                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8447                 GO TO 8200-SEND-DATAONLY.
  8448
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 161
* EL156.cbl
  8450 0200-RECEIVE.
  8451     MOVE LOW-VALUES             TO EL156AI.
  8452     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8453         MOVE ER-0008            TO EMI-ERROR
  8454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8455         IF PI-PASS-SW = 'C'
  8456             MOVE -1             TO ENTPFBL
  8457             GO TO 8200-SEND-DATAONLY
  8458         ELSE
  8459             MOVE -1             TO PMTTYPEL
  8460             GO TO 8200-SEND-DATAONLY.
  8461
  8462     IF PI-COMPANY-ID = 'DMD'
  8463         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8464
  8465     IF PI-PASS-SW = 'C'
  8466         MOVE MAP-NAMEB          TO MAP-NAME.
  8467
  8468
  8469* EXEC CICS RECEIVE
  8470*        MAP   (MAP-NAME)
  8471*        MAPSET(MAPSET-NAME)
  8472*        ASIS
  8473*        INTO  (EL156AI)
  8474*    END-EXEC.
  8475     MOVE LENGTH OF
  8476      EL156AI
  8477       TO DFHEIV11
  8478*    MOVE '8"TAI  L              ''   #00008456' TO DFHEIV0
  8479     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8480     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8481     MOVE X'2020233030303038343536' TO DFHEIV0(25:11)
  8482     CALL 'kxdfhei1' USING DFHEIV0,
  8483           MAP-NAME,
  8484           EL156AI,
  8485           DFHEIV11,
  8486           MAPSET-NAME,
  8487           DFHEIV99,
  8488           DFHEIV99
  8489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8490
  8491
  8492     IF PI-PASS-SW NOT = 'C'
  8493         GO TO 0250-MAPA.
  8494
  8495     IF ENTPFBL NOT > ZERO
  8496         MOVE MAP-NAMEB          TO MAP-NAME
  8497         MOVE ER-0029            TO EMI-ERROR
  8498         MOVE -1                 TO  ENTPFBL
  8499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8500         GO TO 8200-SEND-DATAONLY.
  8501
  8502     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8503         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8504       ELSE
  8505         MOVE MAP-NAMEB           TO MAP-NAME
  8506         MOVE ER-0029             TO EMI-ERROR
  8507         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 162
* EL156.cbl
  8508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8509         GO TO 8200-SEND-DATAONLY.
  8510
  8511     IF EIBAID = DFHPF1 OR DFHPF13
  8512         IF MODIFY-CAP
  8513            GO TO 5000-UPDATE
  8514          ELSE
  8515            MOVE 'UPDATE'           TO SM-READ
  8516            PERFORM 9995-SECURITY-VIOLATION
  8517            MOVE MAP-NAMEB          TO MAP-NAME
  8518            MOVE ER-0070            TO EMI-ERROR
  8519            MOVE -1                 TO  ENTPFBL
  8520            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8521            GO TO 8200-SEND-DATAONLY.
  8522
  8523 0250-MAPA.
  8524     IF ENTERPFL = 0
  8525         GO TO 0300-CHECK-PFKEYS.
  8526
  8527     IF EIBAID NOT = DFHENTER
  8528         MOVE ER-0004            TO EMI-ERROR
  8529         GO TO 0320-INPUT-ERROR.
  8530
  8531     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8532         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8533     ELSE
  8534         MOVE ER-0029            TO EMI-ERROR
  8535         GO TO 0320-INPUT-ERROR.
  8536
  8537 0300-CHECK-PFKEYS.
  8538     IF EIBAID = DFHPF7 OR DFHPF8
  8539         GO TO 8820-PF7-8.
  8540
  8541     IF EIBAID = DFHPF23
  8542         GO TO 8810-PF23.
  8543
  8544     IF EIBAID = DFHPF24
  8545         GO TO 9200-RETURN-MAIN-MENU.
  8546
  8547     IF EIBAID = DFHPF12
  8548         GO TO 9500-PF12.
  8549
  8550     IF EIBAID = DFHPF1
  8551        IF PI-PASS-SW = 'A' OR 'B'
  8552          GO TO 0330-BROWSE-FORWARD.
  8553
  8554     IF EIBAID = DFHPF2
  8555        IF PI-PASS-SW = 'A' OR 'B'
  8556          GO TO 0350-BROWSE-BACKWARD.
  8557
  8558     IF EIBAID = DFHPF6
  8559        IF PI-EOB-CODES-EXIST = 'Y'
  8560           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8561        ELSE
  8562           MOVE SPACES              TO WS-PMTNOTE2
  8563        END-IF
  8564         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8565         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 163
* EL156.cbl
  8566            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8567         END-IF
  8568         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8569         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  8570               OR 'FNL'
  8571             MOVE 'EL614'        TO PGM-NAME
  8572             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8573             GO TO 9300-XCTL
  8574         ELSE
  8575             MOVE XCTL-157       TO PGM-NAME
  8576             GO TO 9300-XCTL.
  8577
  8578     IF EIBAID = DFHPF9
  8579        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8580        MOVE XCTL-141            TO PGM-NAME
  8581        GO TO 9300-XCTL.
  8582
  8583     IF EIBAID = DFHPF10
  8584        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8585        MOVE XCTL-155            TO PGM-NAME
  8586        GO TO 9300-XCTL.
  8587
  8588     MOVE SPACES                 TO ERRMSG0O
  8589                                    ERRMSG1O
  8590                                    ERRMSG2O.
  8591
  8592     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8593         IF PI-PASS-SW NOT = 'B'
  8594             MOVE ER-0422        TO EMI-ERROR
  8595             GO TO 0320-INPUT-ERROR
  8596           ELSE
  8597             GO TO 0700-TEST-FOR-CHANGES.
  8598
  8599     IF EIBAID = DFHPF11
  8600        IF PI-PASS-SW = 'C'
  8601           MOVE ER-0029          TO EMI-ERROR
  8602           GO TO 0320-INPUT-ERROR.
  8603
  8604     IF EIBAID = DFHENTER OR DFHPF11
  8605        NEXT SENTENCE
  8606     ELSE
  8607        MOVE ER-0029             TO EMI-ERROR
  8608        GO TO 0320-INPUT-ERROR.
  8609
  8610     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8611
  8612     if pi-epyfrom not = zeros
  8613        if pi-epyfrom not = ws-epyfrom
  8614           move zeros        to ws-edays
  8615        end-if
  8616     end-if
  8617
  8618     if pi-epythru not = zeros
  8619        if pi-epythru not = ws-epythru
  8620           move zeros        to ws-edays
  8621        end-if
  8622     end-if
  8623
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 164
* EL156.cbl
  8624     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8625         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8626         GO TO 1000-EDIT-DATA
  8627     ELSE
  8628         IF PI-FATAL-COUNT NOT = 0 OR
  8629            PI-FORCE-COUNT NOT = 0
  8630             GO TO 1000-EDIT-DATA
  8631         ELSE
  8632             GO TO 2000-EDIT-DONE.
  8633
  8634 0320-INPUT-ERROR.
  8635     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8636
  8637     IF ENTERPFL = 0
  8638         MOVE -1                 TO PMTTYPEL
  8639     ELSE
  8640         MOVE AL-UNBON           TO ENTERPFA
  8641         MOVE -1                 TO ENTERPFL.
  8642
  8643     GO TO 8200-SEND-DATAONLY.
  8644
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 165
* EL156.cbl
  8646 0330-BROWSE-FORWARD.
  8647
  8648     MOVE CLMNOI            TO PI-CLAIM-NO.
  8649     MOVE CARRI             TO PI-CARRIER.
  8650     MOVE CERTNOI           TO PI-CERT-PRIME.
  8651     MOVE SUFXI             TO PI-CERT-SFX.
  8652
  8653     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8654     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8655     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8656     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8657
  8658     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8659
  8660
  8661* EXEC CICS HANDLE CONDITION
  8662*         NOTFND   (0380-CLAIM-END-FILE)
  8663*         ENDFILE  (0380-CLAIM-END-FILE)
  8664*    END-EXEC.
  8665*    MOVE '"$I''                  ! # #00008631' TO DFHEIV0
  8666     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8668     MOVE X'2320233030303038363331' TO DFHEIV0(25:11)
  8669     CALL 'kxdfhei1' USING DFHEIV0
  8670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8671
  8672
  8673
  8674* EXEC CICS STARTBR
  8675*         DATASET    ('ELMSTR')
  8676*         RIDFLD     (ELMSTR-KEY)
  8677*         GTEQ
  8678*    END-EXEC.
  8679     MOVE 'ELMSTR' TO DFHEIV1
  8680     MOVE 0
  8681       TO DFHEIV11
  8682*    MOVE '&,         G          &   #00008636' TO DFHEIV0
  8683     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8684     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8685     MOVE X'2020233030303038363336' TO DFHEIV0(25:11)
  8686     CALL 'kxdfhei1' USING DFHEIV0,
  8687           DFHEIV1,
  8688           ELMSTR-KEY,
  8689           DFHEIV99,
  8690           DFHEIV11,
  8691           DFHEIV99
  8692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8693
  8694
  8695     MOVE 'Y' TO WS-BROWSE-START-SW.
  8696
  8697 0335-READNEXT.
  8698
  8699
  8700* EXEC CICS READNEXT
  8701*         DATASET    ('ELMSTR')
  8702*         RIDFLD     (ELMSTR-KEY)
  8703*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 166
* EL156.cbl
  8704*    END-EXEC.
  8705     MOVE 'ELMSTR' TO DFHEIV1
  8706     MOVE 0
  8707       TO DFHEIV11
  8708*    MOVE '&.S                   )   #00008646' TO DFHEIV0
  8709     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8710     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8711     MOVE X'2020233030303038363436' TO DFHEIV0(25:11)
  8712     CALL 'kxdfhei1' USING DFHEIV0,
  8713           DFHEIV1,
  8714           DFHEIV20,
  8715           DFHEIV99,
  8716           ELMSTR-KEY,
  8717           DFHEIV99,
  8718           DFHEIV11,
  8719           DFHEIV99,
  8720           DFHEIV99
  8721     SET ADDRESS OF CLAIM-MASTER TO
  8722         DFHEIV20
  8723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8724
  8725
  8726     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8727        GO TO 0380-CLAIM-END-FILE.
  8728
  8729     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8730        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8731        GO TO 0335-READNEXT.
  8732
  8733     IF PI-COMPANY-ID = 'CRI'
  8734         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8735            GO TO 0380-CLAIM-END-FILE.
  8736
  8737     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8738         GO TO 0335-READNEXT.
  8739
  8740     IF PI-CARRIER-SECURITY > SPACES
  8741         IF CL-CARRIER = PI-CARRIER-SECURITY
  8742             NEXT SENTENCE
  8743         ELSE
  8744             GO TO 0335-READNEXT.
  8745
  8746     IF PI-ACCOUNT-SECURITY > SPACES
  8747         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8748             NEXT SENTENCE
  8749         ELSE
  8750             GO TO 0335-READNEXT.
  8751
  8752     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8753     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8754     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8755
  8756     GO TO 0400-FIRST-TIME.
  8757
  8758 0350-BROWSE-BACKWARD.
  8759
  8760     MOVE CLMNOI            TO PI-CLAIM-NO
  8761                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 167
* EL156.cbl
  8762     MOVE CARRI             TO PI-CARRIER.
  8763     MOVE CERTNOI           TO PI-CERT-PRIME.
  8764     MOVE SUFXI             TO PI-CERT-SFX.
  8765
  8766     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8767
  8768     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8769     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8770     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8771
  8772
  8773* EXEC CICS HANDLE CONDITION
  8774*         NOTFND   (0380-CLAIM-END-FILE)
  8775*         ENDFILE  (0380-CLAIM-END-FILE)
  8776*    END-EXEC.
  8777*    MOVE '"$I''                  ! $ #00008698' TO DFHEIV0
  8778     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8780     MOVE X'2420233030303038363938' TO DFHEIV0(25:11)
  8781     CALL 'kxdfhei1' USING DFHEIV0
  8782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8783
  8784
  8785
  8786* EXEC CICS STARTBR
  8787*         DATASET    ('ELMSTR')
  8788*         RIDFLD     (ELMSTR-KEY)
  8789*         GTEQ
  8790*    END-EXEC.
  8791     MOVE 'ELMSTR' TO DFHEIV1
  8792     MOVE 0
  8793       TO DFHEIV11
  8794*    MOVE '&,         G          &   #00008703' TO DFHEIV0
  8795     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8796     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8797     MOVE X'2020233030303038373033' TO DFHEIV0(25:11)
  8798     CALL 'kxdfhei1' USING DFHEIV0,
  8799           DFHEIV1,
  8800           ELMSTR-KEY,
  8801           DFHEIV99,
  8802           DFHEIV11,
  8803           DFHEIV99
  8804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8805
  8806
  8807     MOVE 'Y' TO WS-BROWSE-START-SW.
  8808
  8809
  8810* EXEC CICS READNEXT
  8811*         DATASET    ('ELMSTR')
  8812*         RIDFLD     (ELMSTR-KEY)
  8813*         SET        (ADDRESS OF CLAIM-MASTER)
  8814*    END-EXEC.
  8815     MOVE 'ELMSTR' TO DFHEIV1
  8816     MOVE 0
  8817       TO DFHEIV11
  8818*    MOVE '&.S                   )   #00008711' TO DFHEIV0
  8819     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 168
* EL156.cbl
  8820     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8821     MOVE X'2020233030303038373131' TO DFHEIV0(25:11)
  8822     CALL 'kxdfhei1' USING DFHEIV0,
  8823           DFHEIV1,
  8824           DFHEIV20,
  8825           DFHEIV99,
  8826           ELMSTR-KEY,
  8827           DFHEIV99,
  8828           DFHEIV11,
  8829           DFHEIV99,
  8830           DFHEIV99
  8831     SET ADDRESS OF CLAIM-MASTER TO
  8832         DFHEIV20
  8833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8834
  8835
  8836
  8837* EXEC CICS READPREV
  8838*         DATASET    ('ELMSTR')
  8839*         RIDFLD     (ELMSTR-KEY)
  8840*         SET        (ADDRESS OF CLAIM-MASTER)
  8841*    END-EXEC.
  8842     MOVE 'ELMSTR' TO DFHEIV1
  8843     MOVE 0
  8844       TO DFHEIV11
  8845*    MOVE '&0S                   )   #00008717' TO DFHEIV0
  8846     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8847     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8848     MOVE X'2020233030303038373137' TO DFHEIV0(25:11)
  8849     CALL 'kxdfhei1' USING DFHEIV0,
  8850           DFHEIV1,
  8851           DFHEIV20,
  8852           DFHEIV99,
  8853           ELMSTR-KEY,
  8854           DFHEIV99,
  8855           DFHEIV11,
  8856           DFHEIV99,
  8857           DFHEIV99
  8858     SET ADDRESS OF CLAIM-MASTER TO
  8859         DFHEIV20
  8860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8861
  8862
  8863 0360-BROWSE-BACKWARD.
  8864
  8865
  8866* EXEC CICS READPREV
  8867*         DATASET    ('ELMSTR')
  8868*         RIDFLD     (ELMSTR-KEY)
  8869*         SET        (ADDRESS OF CLAIM-MASTER)
  8870*    END-EXEC.
  8871     MOVE 'ELMSTR' TO DFHEIV1
  8872     MOVE 0
  8873       TO DFHEIV11
  8874*    MOVE '&0S                   )   #00008725' TO DFHEIV0
  8875     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8876     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8877     MOVE X'2020233030303038373235' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 169
* EL156.cbl
  8878     CALL 'kxdfhei1' USING DFHEIV0,
  8879           DFHEIV1,
  8880           DFHEIV20,
  8881           DFHEIV99,
  8882           ELMSTR-KEY,
  8883           DFHEIV99,
  8884           DFHEIV11,
  8885           DFHEIV99,
  8886           DFHEIV99
  8887     SET ADDRESS OF CLAIM-MASTER TO
  8888         DFHEIV20
  8889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8890
  8891
  8892     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8893        GO TO 0380-CLAIM-END-FILE.
  8894
  8895     IF PI-COMPANY-ID = 'CRI'
  8896         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8897            GO TO 0380-CLAIM-END-FILE.
  8898
  8899     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8900         GO TO 0360-BROWSE-BACKWARD.
  8901
  8902     IF PI-CARRIER-SECURITY > SPACES
  8903         IF CL-CARRIER = PI-CARRIER-SECURITY
  8904             NEXT SENTENCE
  8905         ELSE
  8906             GO TO 0360-BROWSE-BACKWARD.
  8907
  8908     IF PI-ACCOUNT-SECURITY > SPACES
  8909         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8910             NEXT SENTENCE
  8911         ELSE
  8912             GO TO 0360-BROWSE-BACKWARD.
  8913
  8914     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8915     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8916     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8917
  8918     GO TO 0400-FIRST-TIME.
  8919
  8920 0380-CLAIM-END-FILE.
  8921
  8922     MOVE ER-0130     TO EMI-ERROR.
  8923     MOVE -1          TO CLMNOL.
  8924     MOVE AL-UABON    TO CARRA
  8925                         CLMNOA
  8926                         CERTNOA
  8927                         SUFXA.
  8928
  8929     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8930
  8931     GO TO 8200-SEND-DATAONLY.
  8932
  8933 0400-FIRST-TIME.
  8934
  8935     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 170
* EL156.cbl
  8936        MOVE 'N'         TO WS-BROWSE-START-SW
  8937
  8938* EXEC CICS ENDBR
  8939*            DATASET    ('ELMSTR')
  8940*       END-EXEC.
  8941     MOVE 'ELMSTR' TO DFHEIV1
  8942     MOVE 0
  8943       TO DFHEIV11
  8944*    MOVE '&2                    $   #00008776' TO DFHEIV0
  8945     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8946     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8947     MOVE X'2020233030303038373736' TO DFHEIV0(25:11)
  8948     CALL 'kxdfhei1' USING DFHEIV0,
  8949           DFHEIV1,
  8950           DFHEIV11,
  8951           DFHEIV99
  8952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8953
  8954
  8955     IF PI-PROCESSOR-ID = 'LGXX'
  8956         NEXT SENTENCE
  8957     ELSE
  8958
  8959* EXEC CICS READQ TS
  8960*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8961*            INTO    (SECURITY-CONTROL)
  8962*            LENGTH  (SC-COMM-LENGTH)
  8963*            ITEM    (SC-ITEM)
  8964*        END-EXEC
  8965*    MOVE '*$II   L              ''   #00008783' TO DFHEIV0
  8966     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8967     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8968     MOVE X'2020233030303038373833' TO DFHEIV0(25:11)
  8969     CALL 'kxdfhei1' USING DFHEIV0,
  8970           PI-SECURITY-TEMP-STORE-ID,
  8971           SECURITY-CONTROL,
  8972           SC-COMM-LENGTH,
  8973           SC-ITEM,
  8974           DFHEIV99,
  8975           DFHEIV99
  8976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8977         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8978         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8979
  8980     MOVE LOW-VALUES             TO EL156AI.
  8981     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8982     MOVE 'Y'                    TO FIRST-ENTRY.
  8983     GO TO 7000-SHOW-CLAIM.
  8984
  8985 0500-CREATE-TEMP-STORAGE.
  8986     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8987
  8988
  8989* EXEC CICS WRITEQ TS
  8990*        QUEUE (QID)
  8991*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8992*        LENGTH(PI-COMM-LENGTH)
  8993*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 171
* EL156.cbl
  8994*    MOVE '*"     L              ''   #00008800' TO DFHEIV0
  8995     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8996     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8997     MOVE X'2020233030303038383030' TO DFHEIV0(25:11)
  8998     CALL 'kxdfhei1' USING DFHEIV0,
  8999           QID,
  9000           PROGRAM-INTERFACE-BLOCK,
  9001           PI-COMM-LENGTH,
  9002           DFHEIV99,
  9003           DFHEIV99,
  9004           DFHEIV99
  9005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9006
  9007
  9008
  9009* EXEC CICS WRITEQ TS
  9010*        QUEUE (QID)
  9011*        FROM  (EL156AI)
  9012*        LENGTH(MAP-LENGTH)
  9013*    END-EXEC.
  9014*    MOVE '*"     L              ''   #00008806' TO DFHEIV0
  9015     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  9016     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9017     MOVE X'2020233030303038383036' TO DFHEIV0(25:11)
  9018     CALL 'kxdfhei1' USING DFHEIV0,
  9019           QID,
  9020           EL156AI,
  9021           MAP-LENGTH,
  9022           DFHEIV99,
  9023           DFHEIV99,
  9024           DFHEIV99
  9025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9026
  9027
  9028 0599-EXIT.
  9029      EXIT.
  9030
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 172
* EL156.cbl
  9032 0600-RECOVER-TEMP-STORAGE.
  9033
  9034* EXEC CICS READQ TS
  9035*        QUEUE (QID)
  9036*        INTO  (PROGRAM-INTERFACE-BLOCK)
  9037*        LENGTH(PI-COMM-LENGTH)
  9038*    END-EXEC.
  9039*    MOVE '*$I    L              ''   #00008817' TO DFHEIV0
  9040     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9041     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9042     MOVE X'2020233030303038383137' TO DFHEIV0(25:11)
  9043     CALL 'kxdfhei1' USING DFHEIV0,
  9044           QID,
  9045           PROGRAM-INTERFACE-BLOCK,
  9046           PI-COMM-LENGTH,
  9047           DFHEIV99,
  9048           DFHEIV99,
  9049           DFHEIV99
  9050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9051
  9052
  9053
  9054* EXEC CICS READQ TS
  9055*        QUEUE (QID)
  9056*        INTO  (EL156AI)
  9057*        LENGTH(MAP-LENGTH)
  9058*    END-EXEC.
  9059*    MOVE '*$I    L              ''   #00008823' TO DFHEIV0
  9060     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9061     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9062     MOVE X'2020233030303038383233' TO DFHEIV0(25:11)
  9063     CALL 'kxdfhei1' USING DFHEIV0,
  9064           QID,
  9065           EL156AI,
  9066           MAP-LENGTH,
  9067           DFHEIV99,
  9068           DFHEIV99,
  9069           DFHEIV99
  9070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9071
  9072
  9073     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  9074
  9075     IF PMTTYPEI NOT = LOW-VALUES
  9076         MOVE AL-UANON           TO PMTTYPEA.
  9077
  9078     IF PAYEEI NOT = LOW-VALUES
  9079         MOVE AL-UANON           TO PAYEEA.
  9080
  9081     IF NOTE1I NOT = LOW-VALUES
  9082         MOVE AL-UANON           TO NOTE1A.
  9083
  9084     IF (RETURNED-FROM = 'EL614')
  9085        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9086     END-IF
  9087*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9088*       AND (PI-EOB-CODES-EXIST = 'Y')
  9089*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 173
* EL156.cbl
  9090*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9091     IF PI-SET-NOTE2-MDT = 'Y'
  9092         MOVE AL-SANON           TO NOTE2A
  9093     END-IF
  9094
  9095     IF OFFLINEI NOT = LOW-VALUES
  9096         MOVE AL-UANON           TO OFFLINEA.
  9097
  9098*    IF GROUPEDI NOT = LOW-VALUES
  9099*        MOVE AL-UANON           TO GROUPEDA.
  9100
  9101*    IF CASHI NOT = LOW-VALUES
  9102*        MOVE AL-UANON           TO CASHA.
  9103
  9104     IF CHECKNOI NOT = LOW-VALUES
  9105         MOVE AL-UANON           TO CHECKNOA.
  9106
  9107     IF HOLDTILI NOT = LOW-VALUES
  9108         MOVE AL-UANON           TO HOLDTILA.
  9109
  9110     IF EPYFROMI NOT = LOW-VALUES
  9111         MOVE AL-UANON           TO EPYFROMA.
  9112
  9113     IF AIGFROMI NOT = LOW-VALUES
  9114         MOVE AL-UANON           TO AIGFROMA.
  9115
  9116     IF EPYTHRUI NOT = LOW-VALUES
  9117         MOVE AL-UANON           TO EPYTHRUA.
  9118
  9119     IF EDAYSI NOT = LOW-VALUES
  9120         MOVE AL-UNNON           TO EDAYSA.
  9121
  9122     IF EPYAMTL NOT = +0
  9123         MOVE AL-UNNON           TO EPYAMTA.
  9124
  9125     IF ERESVL NOT = +0
  9126         MOVE AL-UNNON           TO ERESVA.
  9127
  9128     IF EEXPENSL NOT = +0
  9129         MOVE AL-UNNON           TO EEXPENSA.
  9130
  9131     IF ETYPEI NOT = LOW-VALUES
  9132         MOVE AL-UNNON           TO ETYPEA.
  9133
  9134     IF PROOFDTI NOT = 0
  9135         MOVE AL-UNNON           TO PROOFDTA.
  9136
  9137     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9138        MOVE AL-UANON            TO EOBYNA
  9139     END-IF
  9140     IF CLMFMYNI = 'Y' OR 'N'
  9141        MOVE AL-UANON            TO CLMFMYNA
  9142     END-IF
  9143
  9144     IF SURVYYNI = 'Y' OR 'N'
  9145        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9146           MOVE AL-UANON         TO SURVYYNA
  9147        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 174
* EL156.cbl
  9148     END-IF
  9149
  9150     IF SPRELYNI = 'Y' OR 'N'
  9151        MOVE AL-UANON            TO SPRELYNA
  9152     END-IF
  9153
  9154     .
  9155 0699-EXIT.
  9156      EXIT.
  9157
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 175
* EL156.cbl
  9159 0700-TEST-FOR-CHANGES.
  9160     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9161         MOVE ER-0433            TO EMI-ERROR
  9162         GO TO 0750-FUNCTION-ERROR.
  9163
  9164     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9165
  9166     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9167         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9168         MOVE 'A'                TO PI-PASS-SW
  9169         GO TO 1000-EDIT-DATA.
  9170
  9171     IF PI-FATAL-COUNT NOT = 0
  9172         MOVE ER-0499            TO EMI-ERROR
  9173         GO TO 0750-FUNCTION-ERROR.
  9174
  9175     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9176         MOVE ER-0500            TO EMI-ERROR
  9177         GO TO 0750-FUNCTION-ERROR.
  9178
  9179     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9180        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9181           MOVE ER-0542          TO EMI-ERROR
  9182           MOVE -1               TO EPYAMTL
  9183           GO TO 0750-FUNCTION-ERROR.
  9184
  9185     IF PI-OFFLINE = 'Y'  OR
  9186        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9187        MOVE EIBAID              TO PI-PFKEY-USED
  9188        GO TO 5000-UPDATE.
  9189
  9190     GO TO 6000-BUILD-SCREEN-B.
  9191
  9192 0750-FUNCTION-ERROR.
  9193     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9194
  9195     IF ENTERPFL > 0
  9196         MOVE -1                 TO ENTERPFL
  9197         MOVE AL-UNBON           TO ENTERPFA
  9198         GO TO 8200-SEND-DATAONLY
  9199     ELSE
  9200         MOVE -1                 TO ENTERPFL
  9201         MOVE AL-UNNOF           TO ENTERPFA
  9202         GO TO 8200-SEND-DATAONLY.
  9203
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 176
* EL156.cbl
  9205 0800-DELETE-TS.
  9206
  9207* EXEC CICS HANDLE CONDITION
  9208*        QIDERR(0800-EXIT)
  9209*    END-EXEC.
  9210*    MOVE '"$N                   ! % #00008962' TO DFHEIV0
  9211     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9213     MOVE X'2520233030303038393632' TO DFHEIV0(25:11)
  9214     CALL 'kxdfhei1' USING DFHEIV0
  9215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9216
  9217
  9218
  9219* EXEC CICS DELETEQ TS
  9220*        QUEUE(QID)
  9221*    END-EXEC.
  9222*    MOVE '*&                    #   #00008966' TO DFHEIV0
  9223     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9224     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9225     MOVE X'2020233030303038393636' TO DFHEIV0(25:11)
  9226     CALL 'kxdfhei1' USING DFHEIV0,
  9227           QID,
  9228           DFHEIV99
  9229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9230
  9231
  9232 0800-EXIT.
  9233      EXIT.
  9234 0900-GET-DDF-LIMITS.
  9235
  9236     if cm-clp-state = zeros or spaces or low-values
  9237        move cm-state            to cm-clp-state
  9238     end-if
  9239     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9240     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9241     MOVE cm-clp-state           TO ERPDEF-STATE
  9242     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9243     evaluate true
  9244        when (cl-claim-type = 'L' or 'P')
  9245           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9246             and 'CU')
  9247           move 'L'              to erpdef-ben-type
  9248           move pi-lf-benefit-cd to erpdef-ben-code
  9249        when (cl-claim-type not = 'L' and 'P')
  9250           and (pi-ah-benefit-cd not = '00' and '  ')
  9251           move 'A'              to erpdef-ben-type
  9252           move pi-ah-benefit-cd to erpdef-ben-code
  9253        when (cl-claim-type not = 'L' and 'P')
  9254           and (pi-ah-benefit-cd = '00' or '  ')
  9255           move 'L'              to erpdef-ben-type
  9256           move pi-lf-benefit-cd to erpdef-ben-code
  9257        when (cl-claim-type = 'L' or 'P')
  9258           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9259           move 'A'              to erpdef-ben-type
  9260           move pi-ah-benefit-cd to erpdef-ben-code
  9261        when other
  9262           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 177
* EL156.cbl
  9263           move pi-ah-benefit-cd to erpdef-ben-code
  9264     end-evaluate
  9265*    if (cl-claim-type = 'L' or 'P')
  9266*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9267*          and 'CU')
  9268*       move 'L'                 to erpdef-ben-type
  9269*       move pi-lf-benefit-cd    to erpdef-ben-code
  9270*    else
  9271*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9272*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9273*    end-if
  9274     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9275
  9276     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9277
  9278
  9279* EXEC CICS STARTBR
  9280*        DATASET  ('ERPDEF')
  9281*        RIDFLD   (ERPDEF-KEY)
  9282*        GTEQ
  9283*        RESP     (WS-RESPONSE)
  9284*    END-EXEC
  9285     MOVE 'ERPDEF' TO DFHEIV1
  9286     MOVE 0
  9287       TO DFHEIV11
  9288*    MOVE '&,         G          &  N#00009016' TO DFHEIV0
  9289     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9290     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9291     MOVE X'204E233030303039303136' TO DFHEIV0(25:11)
  9292     CALL 'kxdfhei1' USING DFHEIV0,
  9293           DFHEIV1,
  9294           ERPDEF-KEY,
  9295           DFHEIV99,
  9296           DFHEIV11,
  9297           DFHEIV99
  9298     MOVE EIBRESP  TO WS-RESPONSE
  9299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9300
  9301     IF NOT WS-RESP-NORMAL
  9302        GO TO 0900-EXIT
  9303     END-IF
  9304
  9305     .
  9306 0900-READNEXT.
  9307
  9308
  9309* EXEC CICS READNEXT
  9310*       DATASET  ('ERPDEF')
  9311*       SET      (ADDRESS OF PRODUCT-MASTER)
  9312*       RIDFLD   (ERPDEF-KEY)
  9313*       RESP     (WS-RESPONSE)
  9314*    END-EXEC
  9315     MOVE 'ERPDEF' TO DFHEIV1
  9316     MOVE 0
  9317       TO DFHEIV11
  9318*    MOVE '&.S                   )  N#00009030' TO DFHEIV0
  9319     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9320     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 178
* EL156.cbl
  9321     MOVE X'204E233030303039303330' TO DFHEIV0(25:11)
  9322     CALL 'kxdfhei1' USING DFHEIV0,
  9323           DFHEIV1,
  9324           DFHEIV20,
  9325           DFHEIV99,
  9326           ERPDEF-KEY,
  9327           DFHEIV99,
  9328           DFHEIV11,
  9329           DFHEIV99,
  9330           DFHEIV99
  9331     SET ADDRESS OF PRODUCT-MASTER TO
  9332         DFHEIV20
  9333     MOVE EIBRESP  TO WS-RESPONSE
  9334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9335
  9336     IF NOT WS-RESP-NORMAL
  9337        GO TO 0900-ENDBR
  9338     END-IF
  9339
  9340     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9341        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9342           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9343        ELSE
  9344           GO TO 0900-READNEXT
  9345        END-IF
  9346     ELSE
  9347        GO TO 0900-ENDBR
  9348     END-IF
  9349
  9350     IF CM-LOAN-TERM = ZEROS
  9351        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9352     END-IF
  9353
  9354     .
  9355 0900-ENDBR.
  9356
  9357
  9358* EXEC CICS ENDBR
  9359*       DATASET  ('ERPDEF')
  9360*    END-EXEC
  9361     MOVE 'ERPDEF' TO DFHEIV1
  9362     MOVE 0
  9363       TO DFHEIV11
  9364*    MOVE '&2                    $   #00009058' TO DFHEIV0
  9365     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9366     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9367     MOVE X'2020233030303039303538' TO DFHEIV0(25:11)
  9368     CALL 'kxdfhei1' USING DFHEIV0,
  9369           DFHEIV1,
  9370           DFHEIV11,
  9371           DFHEIV99
  9372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9373
  9374     .
  9375 0900-EXIT.
  9376     EXIT.
  9377 1000-EDIT-DATA.
  9378
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 179
* EL156.cbl
  9379     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9380         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9381         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9382
  9383     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9384
  9385     IF NOT MODIFY-CAP
  9386         MOVE ER-0070            TO EMI-ERROR
  9387         MOVE -1                 TO PMTTYPEL
  9388         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9389         GO TO 2000-EDIT-DONE.
  9390
  9391     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9392                         '5' AND '6'
  9393         MOVE ER-0420            TO EMI-ERROR
  9394         MOVE -1                 TO PMTTYPEL
  9395         MOVE AL-UABON           TO PMTTYPEA
  9396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9397     ELSE
  9398         MOVE AL-UANON           TO PMTTYPEA.
  9399
  9400*    IF PI-OFFLINE = 'Y'
  9401*       IF PI-GROUPED = 'Y'
  9402*          MOVE ER-1880         TO EMI-ERROR
  9403*          MOVE -1              TO GROUPEDL
  9404*          MOVE AL-UABON        TO GROUPEDA
  9405*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9406*
  9407*    IF GROUPEDL > +0
  9408*       IF PI-GROUPED = 'Y' OR 'N'
  9409*          MOVE AL-UANON TO GROUPEDA
  9410*       ELSE
  9411*          MOVE ER-3140            TO EMI-ERROR
  9412*          MOVE -1                 TO GROUPEDL
  9413*          MOVE AL-UABON           TO GROUPEDA
  9414*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9415*
  9416*    IF CASHL > +0
  9417*       IF PI-CASH = 'Y' OR 'N'
  9418*          MOVE AL-UANON           TO CASHA
  9419*       ELSE
  9420*          MOVE ER-3141            TO EMI-ERROR
  9421*          MOVE -1                 TO CASHL
  9422*          MOVE AL-UABON           TO CASHA
  9423*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9424
  9425     IF LOANNOL > +0
  9426         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9427
  9428 1000-EDIT-PAYEE.
  9429
  9430     IF PI-PAYEE-SEQ NOT NUMERIC
  9431         MOVE ER-0294            TO  EMI-ERROR
  9432         MOVE -1                 TO  PAYEEL
  9433         MOVE AL-UABON           TO  PAYEEA
  9434         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9435         GO TO 1000-CONT-EDIT.
  9436
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 180
* EL156.cbl
  9437     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9438                         'E' OR 'O' OR 'Q'
  9439         NEXT SENTENCE
  9440     ELSE
  9441         MOVE ER-0294            TO  EMI-ERROR
  9442         MOVE -1                 TO  PAYEEL
  9443         MOVE AL-UABON           TO  PAYEEA
  9444         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9445         GO TO 1000-CONT-EDIT.
  9446
  9447     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9448        (PI-PAYEE-SEQ NOT < '1' AND
  9449         PI-PAYEE-SEQ NOT > '9'))
  9450      OR
  9451        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9452         (PI-PAYEE-SEQ NOT > '9'))
  9453         MOVE AL-UANON            TO PAYEEA
  9454     ELSE
  9455         MOVE ER-0294            TO EMI-ERROR
  9456         MOVE -1                 TO PAYEEL
  9457         MOVE AL-UABON           TO PAYEEA
  9458         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9459
  9460     IF PI-COMPANY-ID = 'DMD'
  9461         IF PI-PAYEE-TYPE = 'B' AND
  9462            PI-PAYEE-SEQ NOT = '0'
  9463               MOVE ER-7841            TO EMI-ERROR
  9464               MOVE -1                 TO PAYEEL
  9465               MOVE AL-UABON           TO PAYEEA
  9466               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9467
  9468     IF PI-COMPANY-ID = 'JHL'
  9469         IF PI-PAYEE = 'B0'
  9470             NEXT SENTENCE
  9471           ELSE
  9472
  9473* EXEC CICS HANDLE CONDITION
  9474*            ENDFILE(1950-NOT-FOUND)
  9475*            NOTFND (1950-NOT-FOUND)
  9476*        END-EXEC
  9477*    MOVE '"$''I                  ! & #00009160' TO DFHEIV0
  9478     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9480     MOVE X'2620233030303039313630' TO DFHEIV0(25:11)
  9481     CALL 'kxdfhei1' USING DFHEIV0
  9482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9483         MOVE 'N'                    TO FOUND-TOL-SW
  9484         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9485         MOVE '2'                    TO CNTL-REC-TYPE
  9486         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9487         MOVE +0                     TO CNTL-SEQ-NO
  9488         MOVE 'PROC'                 TO FILE-SWITCH
  9489         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9490         IF PI-PAYEE = 'I1' AND
  9491            APPROVAL-LEVEL-2
  9492             NEXT SENTENCE
  9493           ELSE
  9494         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 181
* EL156.cbl
  9495             MOVE ER-3546        TO EMI-ERROR
  9496             MOVE -1             TO PAYEEL
  9497             MOVE AL-UABON       TO PAYEEA
  9498             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9499
  9500     IF PI-PAYEE-TYPE = 'E'
  9501        IF PI-PMTTYPE = '5' OR '6'
  9502            NEXT SENTENCE
  9503        ELSE
  9504            MOVE ER-3539            TO EMI-ERROR
  9505            MOVE -1                 TO PAYEEL
  9506            MOVE AL-UABON           TO PAYEEA
  9507            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9508
  9509 1000-CONT-EDIT.
  9510
  9511     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9512        IF PI-EPYAMT NOT NEGATIVE
  9513            MOVE ER-0421         TO EMI-ERROR
  9514            MOVE -1              TO OFFLINEL
  9515            MOVE AL-UABON        TO OFFLINEA
  9516            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9517        ELSE
  9518            MOVE AL-UANON        TO OFFLINEA.
  9519
  9520     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  9521           OR 'FNL'
  9522        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9523           CONTINUE
  9524        ELSE
  9525           IF PI-PRINT-EOB-YN = 'S' AND
  9526              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
  9527                CONTINUE
  9528           ELSE
  9529              MOVE ER-1561       TO EMI-ERROR
  9530              MOVE -1            TO EOBYNL
  9531              MOVE AL-UABON      TO EOBYNA
  9532              PERFORM 9900-ERROR-FORMAT
  9533                                 THRU 9900-EXIT
  9534           END-IF
  9535        END-IF
  9536
  9537        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9538            MOVE ER-1566        TO EMI-ERROR
  9539            MOVE -1             TO CLMFMYNL
  9540            MOVE AL-UABON       TO CLMFMYNA
  9541            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9542        END-IF
  9543
  9544        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9545            MOVE ER-1567        TO EMI-ERROR
  9546            MOVE -1             TO SURVYYNL
  9547            MOVE AL-UABON       TO SURVYYNA
  9548            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9549        END-IF
  9550
  9551        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9552            MOVE ER-1569        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 182
* EL156.cbl
  9553            MOVE -1             TO SPRELYNL
  9554            MOVE AL-UABON       TO SPRELYNA
  9555            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9556        END-IF
  9557
  9558     END-IF
  9559     IF PI-EPYAMT IS NEGATIVE
  9560         IF PI-OFFLINE NOT = 'Y'
  9561             MOVE ER-0836        TO  EMI-ERROR
  9562             MOVE -1             TO  OFFLINEL
  9563             MOVE AL-UABON       TO  OFFLINEA
  9564             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9565
  9566     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9567        MOVE ER-0872             TO EMI-ERROR
  9568        MOVE -1                  TO PROOFDTL
  9569        MOVE AL-UABON            TO PROOFDTA
  9570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9571     ELSE
  9572        MOVE '4'                TO DC-OPTION-CODE
  9573        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9574        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9575        IF DATE-CONVERSION-ERROR
  9576            MOVE ER-0873        TO EMI-ERROR
  9577            MOVE -1                  TO PROOFDTL
  9578            MOVE AL-UABON            TO PROOFDTA
  9579            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9580        ELSE
  9581            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9582            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9583                MOVE ER-0873    TO EMI-ERROR
  9584                MOVE -1                  TO PROOFDTL
  9585                MOVE AL-UABON            TO PROOFDTA
  9586                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9587            END-IF
  9588        END-IF
  9589     END-IF.
  9590
  9591     IF PI-COMPANY-ID = 'DMD'
  9592        IF NOTE1L NOT = ZEROS
  9593            MOVE ER-7844        TO  EMI-ERROR
  9594            MOVE -1             TO  NOTE1L
  9595            MOVE AL-UABON       TO  NOTE1A
  9596            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9597
  9598     IF PI-COMPANY-ID = 'DMD'
  9599        IF NOTE2L NOT = ZEROS
  9600          GO TO 1004-DMD-EOB-CHECKS.
  9601
  9602     IF NOTE1L NOT > +0
  9603         GO TO 1005-CHECK-ERRORS.
  9604
  9605     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9606         GO TO 1005-CHECK-ERRORS.
  9607
  9608     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9609         GO TO 1003-HAN-PMT-NOTES.
  9610
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 183
* EL156.cbl
  9611     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  9612
  9613     IF WS-PMTOPTION NUMERIC
  9614        IF WS-PMTOPTION > '00' AND < '17'
  9615           NEXT SENTENCE
  9616        ELSE
  9617           MOVE ER-0618          TO EMI-ERROR
  9618           MOVE -1               TO NOTE1L
  9619           MOVE AL-UABON         TO NOTE1A
  9620           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9621     ELSE
  9622        GO TO 1005-CHECK-ERRORS.
  9623
  9624     IF WS-PMTOPTION = '05' AND
  9625        WS-DOCNAME = SPACES
  9626          MOVE ER-0616             TO EMI-ERROR
  9627          MOVE -1                  TO NOTE1L
  9628          MOVE AL-UABON            TO NOTE1A
  9629          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9630
  9631     IF WS-PMTOPTION = '15' OR '16'
  9632
  9633* EXEC CICS BIF DEEDIT
  9634*            FIELD (WS-AMOUNT)
  9635*            LENGTH(08)
  9636*        END-EXEC
  9637     MOVE 08
  9638       TO DFHEIV11
  9639*    MOVE '@"L                   #   #00009313' TO DFHEIV0
  9640     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9641     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9642     MOVE X'2020233030303039333133' TO DFHEIV0(25:11)
  9643     CALL 'kxdfhei1' USING DFHEIV0,
  9644           WS-AMOUNT,
  9645           DFHEIV11
  9646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9647        IF (WS-NUM-AMT = ZEROS) OR
  9648           (WS-AMOUNT NOT NUMERIC)
  9649           MOVE ER-0617          TO EMI-ERROR
  9650           MOVE -1               TO NOTE1L
  9651           MOVE AL-UABON         TO NOTE1A
  9652           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9653
  9654     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9655
  9656     GO TO 1005-CHECK-ERRORS.
  9657
  9658 1003-HAN-PMT-NOTES.
  9659
  9660     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9661
  9662     IF WS-HAN-PMT-CODE = SPACE
  9663         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9664     ELSE
  9665     IF WS-HAN-PMT-CODE = 'A'
  9666         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9667                                 TO WS-HAN-PMT-NOTE
  9668     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 184
* EL156.cbl
  9669     IF WS-HAN-PMT-CODE = 'B'
  9670         MOVE ':FINAL PAYMENT / DECEASED'
  9671                                 TO WS-HAN-PMT-NOTE
  9672     ELSE
  9673     IF WS-HAN-PMT-CODE = 'C'
  9674         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9675                                 TO WS-HAN-PMT-NOTE
  9676     ELSE
  9677     IF WS-HAN-PMT-CODE = 'D'
  9678         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9679                                 TO WS-HAN-PMT-NOTE
  9680     ELSE
  9681     IF WS-HAN-PMT-CODE = 'E'
  9682         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9683                                 TO WS-HAN-PMT-NOTE
  9684     ELSE
  9685     IF WS-HAN-PMT-CODE = 'F'
  9686         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9687                                 TO WS-HAN-PMT-NOTE
  9688     ELSE
  9689     IF WS-HAN-PMT-CODE = 'P'
  9690         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9691
  9692     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9693     GO TO 1005-CHECK-ERRORS.
  9694
  9695 1004-DMD-EOB-CHECKS.
  9696
  9697     INITIALIZE PI-AT-EOB-CODES.
  9698
  9699     IF NOTE2I (20:21) > SPACES
  9700         MOVE ER-7845          TO EMI-ERROR
  9701         MOVE -1               TO NOTE2L
  9702         MOVE AL-UABON         TO NOTE2A
  9703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9704         GO TO 1005-CHECK-ERRORS
  9705      ELSE
  9706         MOVE NOTE2I             TO W-EOB-CODES.
  9707
  9708     MOVE +1                     TO W-EOB-NDX.
  9709
  9710 1004-CHECK-EACH-EOB.
  9711
  9712     IF W-EOB-NDX > +5
  9713             OR
  9714        W-EOB-CODE (W-EOB-NDX) = SPACES
  9715         GO TO 1004-CHECK-DUP-EOB.
  9716
  9717     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9718         MOVE ER-0956            TO EMI-ERROR
  9719         MOVE -1                 TO NOTE2L
  9720         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9721         GO TO 1005-CHECK-ERRORS.
  9722
  9723     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9724     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9725     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9726     MOVE 'DLO023'               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 185
* EL156.cbl
  9727
  9728
  9729* EXEC CICS LINK
  9730*        PROGRAM    (PGM-NAME)
  9731*        COMMAREA   (CD-COMMUNICATION-AREA)
  9732*        LENGTH     (CD-RCRD-LENGTH)
  9733*    END-EXEC.
  9734*    MOVE '."C                   (   #00009398' TO DFHEIV0
  9735     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9737     MOVE X'2020233030303039333938' TO DFHEIV0(25:11)
  9738     CALL 'kxdfhei1' USING DFHEIV0,
  9739           PGM-NAME,
  9740           CD-COMMUNICATION-AREA,
  9741           CD-RCRD-LENGTH,
  9742           DFHEIV99,
  9743           DFHEIV99,
  9744           DFHEIV99,
  9745           DFHEIV99
  9746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9747
  9748
  9749     IF CD-RETURN-CODE = 'OK'
  9750         GO TO 1004-CONT.
  9751
  9752     MOVE -1                     TO NOTE2L.
  9753
  9754     IF CD-RETURN-CODE = '01'
  9755         MOVE ER-8310            TO EMI-ERROR
  9756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9757         GO TO 1005-CHECK-ERRORS.
  9758
  9759     IF CD-RETURN-CODE = '02'
  9760         MOVE ER-8311            TO EMI-ERROR
  9761         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9762         GO TO 1005-CHECK-ERRORS.
  9763
  9764     IF CD-RETURN-CODE = '03'
  9765         MOVE ER-8312            TO EMI-ERROR
  9766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9767         GO TO 1005-CHECK-ERRORS.
  9768
  9769     IF CD-RETURN-CODE = '04'
  9770         MOVE ER-8313            TO EMI-ERROR
  9771         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9772         GO TO 1005-CHECK-ERRORS.
  9773
  9774     IF CD-RETURN-CODE = '05'
  9775         MOVE ER-8314            TO EMI-ERROR
  9776         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9777         GO TO 1005-CHECK-ERRORS.
  9778
  9779     IF CD-RETURN-CODE = '06'
  9780         MOVE ER-8315            TO EMI-ERROR
  9781         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9782         GO TO 1005-CHECK-ERRORS.
  9783
  9784     IF CD-RETURN-CODE = 'E1'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 186
* EL156.cbl
  9785         MOVE ER-8316            TO EMI-ERROR
  9786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9787         GO TO 1005-CHECK-ERRORS.
  9788
  9789     IF CD-RETURN-CODE = 'N1'
  9790         MOVE ER-8317            TO EMI-ERROR
  9791         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9792         GO TO 1005-CHECK-ERRORS.
  9793
  9794 1004-CONT.
  9795     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9796
  9797     ADD +1 TO W-EOB-NDX.
  9798     GO TO 1004-CHECK-EACH-EOB.
  9799
  9800 1004-CHECK-DUP-EOB.
  9801     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9802         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9803                               PI-AT-EOB-CODE (3) OR
  9804                               PI-AT-EOB-CODE (4) OR
  9805                               PI-AT-EOB-CODE (5)))
  9806                  OR
  9807        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9808         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9809                               PI-AT-EOB-CODE (4) OR
  9810                               PI-AT-EOB-CODE (5)))
  9811                  OR
  9812        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9813         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9814                               PI-AT-EOB-CODE (5)))
  9815                  OR
  9816        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9817         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9818            MOVE ER-8000            TO EMI-ERROR
  9819            MOVE AL-UABON           TO NOTE2A
  9820            MOVE -1                 TO NOTE2L
  9821            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9822            GO TO 1005-CHECK-ERRORS.
  9823
  9824 1005-CHECK-ERRORS.
  9825*    IF PI-COMPANY-ID NOT = 'DMD'
  9826        GO TO 1006-CHECK-ERRORS.
  9827
  9828*********  DMD CODE START ******************
  9829*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9830*       GO TO 1006-CHECK-ERRORS.
  9831*
  9832*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9833*
  9834*    COMPUTE W-PAYMENT-TOTAL
  9835*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9836*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9837*               AND
  9838*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9839*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9840*          MOVE ER-0967    TO EMI-ERROR
  9841*          MOVE -1         TO PMTTYPEL
  9842*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 187
* EL156.cbl
  9843*
  9844*    GO TO 1006-CHECK-ERRORS.
  9845*********  DMD CODE END ******************
  9846
  9847 1006-CHECK-ERRORS.
  9848     if emi-forcable-ctr = zeros
  9849        and emi-fatal-ctr = zeros
  9850        continue
  9851     else
  9852        IF NOT EMI-NO-ERRORS
  9853           GO TO 2000-EDIT-DONE
  9854        end-if
  9855     end-if
  9856
  9857* EXEC CICS HANDLE CONDITION
  9858*        NOTFND(1950-NOT-FOUND)
  9859*    END-EXEC.
  9860*    MOVE '"$I                   ! '' #00009511' TO DFHEIV0
  9861     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9862     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9863     MOVE X'2720233030303039353131' TO DFHEIV0(25:11)
  9864     CALL 'kxdfhei1' USING DFHEIV0
  9865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9866
  9867
  9868     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9869     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9870     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9871     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9872     MOVE 'MSTR'                 TO FILE-SWITCH.
  9873
  9874     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9875
  9876     IF PI-COMPANY-ID = 'DMD'
  9877         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9878
  9879     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9880        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9881           MOVE ER-0873    TO EMI-ERROR
  9882           MOVE -1                  TO PROOFDTL
  9883           MOVE AL-UABON            TO PROOFDTA
  9884           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9885        END-IF
  9886     END-IF
  9887     if cl-benefit-period = zeros
  9888        move er-1667             to emi-error
  9889        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9890     end-if
  9891     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9892     MOVE +95                    TO TRLR-SEQ-NO
  9893
  9894* EXEC CICS READ
  9895*       DATASET  ('ELTRLR')
  9896*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9897*       RIDFLD   (ELTRLR-KEY)
  9898*       RESP     (WS-RESPONSE)
  9899*    END-EXEC
  9900     MOVE 'ELTRLR' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 188
* EL156.cbl
  9901*    MOVE '&"S        E          (  N#00009540' TO DFHEIV0
  9902     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9903     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9904     MOVE X'204E233030303039353430' TO DFHEIV0(25:11)
  9905     CALL 'kxdfhei1' USING DFHEIV0,
  9906           DFHEIV1,
  9907           DFHEIV20,
  9908           DFHEIV99,
  9909           ELTRLR-KEY,
  9910           DFHEIV99,
  9911           DFHEIV99,
  9912           DFHEIV99
  9913     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9914         DFHEIV20
  9915     MOVE EIBRESP  TO WS-RESPONSE
  9916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9917
  9918     if ws-resp-normal
  9919        perform varying s1 from +1 by +1 until
  9920           at-note-error-no (s1) = spaces
  9921           if at-note-error-no (s1) = '1662'
  9922              continue
  9923           else
  9924              move at-note-error-no (s1)
  9925                                 to emi-error
  9926              if at-note-error-no (s1) = '1653'
  9927                 evaluate true
  9928                    when cl-claim-type = 'L'
  9929                       move '  LF  '
  9930                                 to emi-claim-type
  9931                    when cl-claim-type = 'I'
  9932                       move '  IU  '
  9933                                 to emi-claim-type
  9934                    when cl-claim-type = 'A'
  9935                       move '  AH  '
  9936                                 to emi-claim-type
  9937                    when cl-claim-type = 'O'
  9938                       move '  OT  '
  9939                                 to emi-claim-type
  9940                    when other
  9941                       move ' FMLA '
  9942                                 to emi-claim-type
  9943                 end-evaluate
  9944              end-if
  9945              PERFORM 9900-ERROR-FORMAT
  9946                                 THRU 9900-EXIT
  9947           end-if
  9948        end-perform
  9949     end-if
  9950     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9951         IF PI-PMTTYPE = '5' OR '6'
  9952             NEXT SENTENCE
  9953         ELSE
  9954             MOVE ER-0555             TO EMI-ERROR
  9955             MOVE -1                  TO PMTTYPEL
  9956             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9957
  9958     IF CL-LAST-CLOSE-REASON = '2'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 189
* EL156.cbl
  9959         IF CL-CLAIM-STATUS = 'C'
  9960             MOVE ER-0760        TO  EMI-ERROR
  9961             MOVE -1             TO  PMTTYPEL
  9962             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9963
  9964     IF PI-ACTIVITY-CODE = 9
  9965         MOVE ER-3538            TO  EMI-ERROR
  9966         MOVE -1                 TO  PMTTYPEL
  9967         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9968
  9969     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9970         GO TO 1008-READ-CERT.
  9971**********************AIG LOGIC STARTS *********************
  9972     IF CL-CERT-PRIME = 'INCOMPLETE'
  9973         MOVE ER-3540            TO  EMI-ERROR
  9974         MOVE -1                 TO  PMTTYPEL
  9975         MOVE AL-UABON           TO  PMTTYPEA
  9976         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9977         GO TO 2000-EDIT-DONE.
  9978
  9979     IF PI-PMTTYPE = '4'
  9980         IF PI-EPYAMT IS NEGATIVE
  9981             IF PI-ECHECKNO-CR = 'CR'
  9982                 NEXT SENTENCE
  9983             ELSE
  9984                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9985
  9986     IF PI-PMTTYPE = '4'
  9987         IF PI-ECHECKNO-CR = 'CR'
  9988             IF PI-EPYAMT IS NEGATIVE
  9989                 NEXT SENTENCE
  9990             ELSE
  9991                 MOVE ER-0834    TO  EMI-ERROR
  9992                 MOVE -1         TO  EPYAMTL
  9993                 MOVE AL-UNBON   TO  EPYAMTA
  9994                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9995
  9996     IF PI-PMTTYPE = '4'
  9997         IF PI-EPYAMT IS NEGATIVE
  9998             IF PI-OFFLINE = 'Y'
  9999                 NEXT SENTENCE
 10000             ELSE
 10001                 MOVE 'Y'        TO  PI-OFFLINE
 10002                                     WS-OFFLINE
 10003                                     OFFLINEO
 10004                 MOVE AL-UANON   TO  OFFLINEA.
 10005
 10006*    IF PI-PMTTYPE = '4'
 10007*        IF PI-EPYAMT IS NEGATIVE
 10008*            IF PI-CASH = 'Y'
 10009*                NEXT SENTENCE
 10010*            ELSE
 10011*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
 10012*                MOVE AL-UANON   TO  CASHA
 10013*                GO TO 1007-DEFAULT-AIG-CHECKNO.
 10014*
 10015*    IF PI-CASH NOT = 'Y' AND 'N'
 10016*         IF PI-OFFLINE = 'Y'  AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 190
* EL156.cbl
 10017*            PI-ECHECKNO-CR = 'CR'
 10018*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
 10019*              MOVE AL-UANON     TO  CASHA
 10020*              GO TO 1007-DEFAULT-AIG-CHECKNO.
 10021*
 10022*    IF PI-CASH NOT = 'Y' AND 'N'
 10023*        IF PI-PMTTYPE = '5' OR '6'
 10024*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
 10025*            MOVE AL-UANON       TO  CASHA
 10026*            GO TO 1007-DEFAULT-AIG-CHECKNO.
 10027*
 10028*    IF PI-CASH NOT = 'Y' AND 'N'
 10029*       IF CL-ASSOCIATES = 'N' OR 'A'
 10030*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
 10031*           MOVE AL-UANON        TO  CASHA
 10032*       ELSE
 10033*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
 10034*           MOVE AL-UANON        TO  CASHA.
 10035*
 10036*    IF PI-PMTTYPE = '5' OR '6'
 10037*        IF PI-CASH = 'N'
 10038*            MOVE ER-0819        TO  EMI-ERROR
 10039*            MOVE AL-UANON       TO  CASHA
 10040*            MOVE -1             TO  CASHL
 10041*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10042*
 10043*    IF CL-ASSOCIATES = 'N' OR 'A'
 10044*       IF CASHI = 'N'
 10045*        MOVE ER-3537            TO  EMI-ERROR
 10046*        MOVE AL-UANON           TO  CASHA
 10047*        MOVE -1                 TO  CASHL
 10048*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10049
 10050 1007-DEFAULT-AIG-CHECKNO.
 10051
 10052     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
 10053         MOVE ER-3532            TO  EMI-ERROR
 10054         MOVE -1                 TO  PMTTYPEL
 10055         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10056**********************AIG LOGIC ENDS ***********************
 10057
 10058 1008-READ-CERT.
 10059
 10060     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 10061     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 10062     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 10063     MOVE CL-CERT-STATE          TO CERT-STATE.
 10064     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 10065     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 10066     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 10067     MOVE 'CERT'                 TO FILE-SWITCH.
 10068
 10069     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 10070
 10071     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10072        MOVE CM-LF-LOAN-EXPIRE-DT
 10073                                 TO WS-EXP-DT PI-EXP-DT
 10074                                    ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 191
* EL156.cbl
 10075     ELSE
 10076        MOVE CM-AH-LOAN-EXPIRE-DT
 10077                                 TO WS-EXP-DT PI-EXP-DT
 10078                                    ws-extended-exp-dt
 10079     end-if
 10080     MOVE '6'           TO DC-OPTION-CODE
 10081     if pi-dcc-product-code not = spaces
 10082        move cm-ah-benefit-cd    to pi-ah-benefit-cd
 10083        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10084        PERFORM 0900-GET-DDF-limits
 10085                                 THRU 0900-EXIT
 10086        IF PDEF-FOUND
 10087         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 10088           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10089              (P1 > +8)
 10090              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10091           END-PERFORM
 10092           IF P1 < +9
 10093              MOVE '6'           TO DC-OPTION-CODE
 10094              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10095              IF CL-NO-OF-EXTENSIONS NUMERIC
 10096               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10097                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10098                                             PI-MAX-EXT
 10099              ELSE
 10100                 MOVE PD-MAX-EXTENSION (P1)
 10101                                 TO DC-ELAPSED-MONTHS
 10102              END-IF
 10103              PERFORM 9700-LINK-DATE-CONVERT
 10104                                 THRU 9700-EXIT
 10105              if no-conversion-error
 10106                 move dc-bin-date-2 to ws-extended-exp-dt
 10107              end-if
 10108           else
 10109              move er-1674       to emi-error
 10110              PERFORM 9900-ERROR-FORMAT
 10111                                 THRU 9900-EXIT
 10112           end-if
 10113        ELSE
 10114           IF CL-NO-OF-EXTENSIONS NUMERIC
 10115              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10116                                          PI-MAX-EXT
 10117           ELSE
 10118              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10119           END-IF
 10120           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10121           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10122           if no-conversion-error
 10123              move dc-bin-date-2 to ws-extended-exp-dt
 10124           end-if
 10125        end-if
 10126     ELSE
 10127        IF CL-NO-OF-EXTENSIONS NUMERIC
 10128           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10129                                       PI-MAX-EXT
 10130        ELSE
 10131           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10132        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 192
* EL156.cbl
 10133        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10134        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10135        if no-conversion-error
 10136           move dc-bin-date-2 to ws-extended-exp-dt
 10137        end-if
 10138     end-if
 10139*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10140*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10141
 10142     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10143         MOVE ER-0458            TO EMI-ERROR
 10144         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10145
 10146     IF (CL-INCURRED-DT > WS-EXP-DT)
 10147        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10148        MOVE ER-1677             TO EMI-ERROR
 10149        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10150     END-IF
 10151     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10152     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10153         MOVE ER-0459            TO EMI-ERROR
 10154         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10155
 10156     IF CL-REPORTED-DT = LOW-VALUES
 10157        MOVE ER-0530             TO EMI-ERROR
 10158        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10159
 10160     IF PI-COMPANY-ID = 'NCL'
 10161        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10162            MOVE ER-0770            TO EMI-ERROR
 10163            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10164
 10165     IF PI-COMPANY-ID = 'NCL'
 10166        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10167            MOVE ER-0737            TO EMI-ERROR
 10168            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10169
 10170     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10171         MOVE ER-0768            TO  EMI-ERROR
 10172         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10173
 10174     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10175         MOVE ER-0769            TO  EMI-ERROR
 10176         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10177
 10178     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10179         GO TO 1020-DO-LIFE-EDITS
 10180     ELSE
 10181         GO TO 1030-DO-AH-EDITS.
 10182
 10183 1010-GENERAL-ERROR.
 10184     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10185
 10186     IF EMI-MESSAGE-FORMATTED
 10187         MOVE -1                 TO PMTTYPEL.
 10188
 10189 1010-EXIT.
 10190     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 193
* EL156.cbl
 10191
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 194
* EL156.cbl
 10193 1020-DO-LIFE-EDITS.
 10194     IF CM-LF-BENEFIT-CD = '00'
 10195         IF PI-PMTTYPE = '5' OR '6'
 10196             MOVE ER-0658        TO EMI-ERROR
 10197             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10198         ELSE
 10199            if (pi-company-id = 'DCC' or 'VPP')
 10200               and (pi-dcc-product-code not = spaces)
 10201               continue
 10202            else
 10203               MOVE ER-1775      TO EMI-ERROR
 10204               PERFORM 1040-PMTTYPE-ERROR
 10205                                 THRU 1040-EXIT
 10206            end-if
 10207         end-if
 10208     end-if
 10209
 10210     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10211     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10212         MOVE ER-0460            TO EMI-ERROR
 10213         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10214
 10215     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10216     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10217     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10218     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10219     MOVE '4'                    TO  CNTL-REC-TYPE.
 10220     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10221     MOVE 'BENE'                 TO  FILE-SWITCH.
 10222     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10223     IF NO-BENEFIT-FOUND
 10224         GO TO 1950-NOT-FOUND.
 10225
 10226     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10227
 10228     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10229       AND NOT CM-LF-LUMP-SUM-DISAB
 10230         IF PI-PMTTYPE = '4'
 10231             IF (PI-LIFE-OVERRIDE-L1 = 'P' OR
 10232                PI-LF-COVERAGE-TYPE = 'P')
 10233               AND NOT CM-LF-LUMP-SUM-DISAB
 10234                 NEXT SENTENCE
 10235             ELSE
 10236                 MOVE ER-0461        TO EMI-ERROR
 10237                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10238         ELSE
 10239            NEXT SENTENCE
 10240     ELSE
 10241         IF PI-PMTTYPE = '2'
 10242            IF NOT CM-O-B-COVERAGE
 10243              AND CM-LF-CURRENT-STATUS = '7'
 10244                MOVE ER-0462     TO EMI-ERROR
 10245                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10246
 10247     IF PI-PMTTYPE = '2'
 10248         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10249            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10250             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 195
* EL156.cbl
 10251             MOVE ER-0730            TO  EMI-ERROR
 10252             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10253             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10254
 10255     IF PI-PMTTYPE = '2'
 10256         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10257            PI-LF-COVERAGE-TYPE = 'P'
 10258             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10259                 MOVE ER-0462    TO  EMI-ERROR
 10260                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10261
 10262     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10263       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10264         MOVE ER-0466            TO EMI-ERROR
 10265         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10266
 10267     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10268         IF PI-PMTTYPE = '3'
 10269             MOVE 0436           TO EMI-ERROR
 10270             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10271             GO TO 1045-EDIT-PAYEE-ADDR
 10272         ELSE
 10273             GO TO 1045-EDIT-PAYEE-ADDR.
 10274
 10275     IF CL-CLAIM-TYPE = 'O'
 10276         IF PI-PMTTYPE = '1' OR '2'
 10277             MOVE ER-1930          TO EMI-ERROR
 10278             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10279         END-IF
 10280     ELSE
 10281     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10282        PI-LF-COVERAGE-TYPE = 'P'
 10283         IF PI-PMTTYPE = '3'
 10284             MOVE ER-0436          TO  EMI-ERROR
 10285             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10286         ELSE
 10287             NEXT SENTENCE
 10288     ELSE
 10289         IF PI-PMTTYPE = '1' OR '3'
 10290             MOVE ER-0436            TO EMI-ERROR
 10291             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10292*
 10293     IF PI-COMPANY-ID = 'CID' AND
 10294        CL-CERT-STATE = 'SC'  AND
 10295        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10296           MOVE ER-0879    TO  EMI-ERROR
 10297           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10298           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10299     END-IF.
 10300     IF PI-COMPANY-ID = 'AHL'
 10301        evaluate true
 10302           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10303              MOVE ER-0879       TO  EMI-ERROR
 10304              PERFORM 1040-PMTTYPE-ERROR
 10305                                 THRU 1040-EXIT
 10306              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10307           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10308                 '6D' OR '6H' OR '6R'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 196
* EL156.cbl
 10309              MOVE ER-0879       TO  EMI-ERROR
 10310              PERFORM 1040-PMTTYPE-ERROR
 10311                                 THRU 1040-EXIT
 10312              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10313           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10314              MOVE ER-0879       TO  EMI-ERROR
 10315              PERFORM 1040-PMTTYPE-ERROR
 10316                                 THRU 1040-EXIT
 10317              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10318        end-evaluate
 10319     END-IF
 10320     GO TO 1045-EDIT-PAYEE-ADDR.
 10321
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 197
* EL156.cbl
 10323 1030-DO-AH-EDITS.
 10324     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10325     IF CM-AH-BENEFIT-CD = '00'
 10326         IF PI-PMTTYPE = '5' OR '6'
 10327             MOVE ER-0658        TO EMI-ERROR
 10328             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10329         ELSE
 10330             MOVE ER-1775        TO EMI-ERROR
 10331             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10332
 10333     IF CL-TOTAL-PAID-AMT = ZEROS
 10334         IF PI-PMTTYPE = '4'
 10335             MOVE ER-0438        TO EMI-ERROR
 10336             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10337
 10338     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10339         IF PI-PMTTYPE = '3'
 10340             MOVE ER-0463        TO EMI-ERROR
 10341             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10342         ELSE
 10343             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10344              AND CM-LF-CURRENT-STATUS = '7'
 10345                 MOVE ER-0465    TO EMI-ERROR
 10346                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10347
 10348     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10349         IF PI-PMTTYPE = '3'
 10350             MOVE ER-0464        TO EMI-ERROR
 10351             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10352         ELSE
 10353             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10354                 MOVE ER-0469    TO EMI-ERROR
 10355                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10356
 10357     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10358         IF PI-PMTTYPE = '3'
 10359             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10360                 MOVE ER-0467    TO EMI-ERROR
 10361                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10362             ELSE
 10363                 NEXT SENTENCE
 10364         ELSE
 10365             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10366                 MOVE ER-0468    TO EMI-ERROR
 10367                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10368
 10369     IF PI-PMTTYPE = '2'
 10370        PERFORM WITH TEST AFTER
 10371         VARYING SUB FROM +1 BY +5
 10372          UNTIL SUB > +60
 10373            OR PI-PMTNOTE2(SUB:1) = 'F'
 10374            OR PI-PMTNOTE2(SUB:1) NOT > SPACES
 10375        END-PERFORM
 10376        IF PI-PMTNOTE2(SUB:1) NOT = 'F'
 10377           MOVE ER-3551    TO EMI-ERROR
 10378           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10379        END-IF
 10380     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 198
* EL156.cbl
 10381     GO TO 1045-EDIT-PAYEE-ADDR.
 10382
 10383 1040-PMTTYPE-ERROR.
 10384     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10385
 10386     IF EMI-MESSAGE-FORMATTED
 10387         MOVE -1                 TO PMTTYPEL
 10388         MOVE AL-UABON           TO PMTTYPEA.
 10389
 10390 1040-EXIT.
 10391     EXIT.
 10392
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 199
* EL156.cbl
 10394 1045-EDIT-PAYEE-ADDR.
 10395
 10396     IF PI-OFFLINE = 'N' AND
 10397        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10398           < PI-PAYEE-SEQ-NUM)
 10399        OR
 10400         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10401         (PI-PAYEE-TYPE = 'B')                 AND
 10402         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10403        OR
 10404         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10405           < PI-PAYEE-SEQ-NUM)
 10406        OR
 10407         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10408           < PI-PAYEE-SEQ-NUM)
 10409        OR
 10410         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10411           < PI-PAYEE-SEQ-NUM)
 10412        OR
 10413         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10414           < PI-PAYEE-SEQ-NUM)
 10415        OR
 10416         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10417           < PI-PAYEE-SEQ-NUM))
 10418             MOVE ER-0437        TO EMI-ERROR
 10419             MOVE -1             TO PAYEEL
 10420             MOVE AL-UABON       TO PAYEEA
 10421             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10422
 10423     IF PI-OFFLINE    = 'N' AND
 10424        PI-PAYEE-TYPE = 'B' AND
 10425        PI-PAYEE-SEQ  = '0'
 10426         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10427         IF BENE-FOUND-SW = 'N'
 10428             MOVE ER-0437        TO EMI-ERROR
 10429             MOVE -1             TO PAYEEL
 10430             MOVE AL-UABON       TO PAYEEA
 10431             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10432
 10433     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10434        IF PI-OFFLINE    = 'N'  AND
 10435           PI-PAYEE-TYPE = 'B'  AND
 10436           PI-PAYEE-SEQ  = '9'
 10437             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10438             IF BENE-FOUND-SW = 'N'
 10439                MOVE ER-0437        TO EMI-ERROR
 10440                MOVE -1             TO PAYEEL
 10441                MOVE AL-UABON       TO PAYEEA
 10442                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10443
 10444*    IF PI-COMPANY-ID = 'CRI'
 10445*        IF CL-CLAIM-TYPE = 'L'
 10446*            MOVE 'N'                TO  WS-GROUPED
 10447*                                        PI-GROUPED
 10448*                                        GROUPEDI
 10449*            MOVE AL-UANON           TO  GROUPEDA
 10450*            GO TO 1050-EDIT-CHECK-NO
 10451*        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 200
* EL156.cbl
 10452*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10453*            IF WS-GROUP-1 = 'C'
 10454*                NEXT SENTENCE
 10455*            ELSE
 10456*                MOVE 'N'            TO  WS-GROUPED
 10457*                                        PI-GROUPED
 10458*                                        GROUPEDI
 10459*                MOVE AL-UANON       TO  GROUPEDA
 10460*                GO TO 1050-EDIT-CHECK-NO.
 10461
 10462*     IF PI-GROUPED = 'Y'
 10463*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10464*           NEXT SENTENCE
 10465*        ELSE
 10466*           MOVE ER-0437        TO EMI-ERROR
 10467*           MOVE -1             TO PAYEEL
 10468**02180            MOVE AL-UABON       TO PAYEEA
 10469*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10470*
 10471*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10472*        (PI-GROUPED    = ' ')
 10473*        NEXT SENTENCE
 10474*     ELSE
 10475*
 10476     GO TO 1050-EDIT-CHECK-NO.
 10477*     IF PI-COMPANY-ID = 'CRI'
 10478*        MOVE 'N'           TO GROUPEDI
 10479*                              PI-GROUPED
 10480*                              WS-GROUPED
 10481*        MOVE AL-UANON      TO GROUPEDA.
 10482*
 10483*     IF PI-COMPANY-ID = 'CRI'
 10484*        IF PI-PAYEE-TYPE = 'B'
 10485*           IF BENE-FOUND-SW = 'Y'
 10486*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10487*                 MOVE 'Y'           TO GROUPEDI
 10488*                                       PI-GROUPED
 10489*                                       WS-GROUPED
 10490*                 MOVE AL-UANON      TO GROUPEDA
 10491*              ELSE
 10492*                 NEXT SENTENCE
 10493*           ELSE
 10494*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10495*              IF BENE-FOUND-SW = 'Y'
 10496*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10497*                    MOVE 'Y'      TO GROUPEDI
 10498*                                     PI-GROUPED
 10499*                                     WS-GROUPED
 10500*                    MOVE AL-UANON TO GROUPEDA.
 10501*
 10502
 10503     IF PI-COMPANY-ID NOT = 'CRI'
 10504        GO TO 1050-EDIT-CHECK-NO.
 10505
 10506*************** CRI CODE START ******************
 10507     IF PI-PAYEE-TYPE NOT = 'A'
 10508        GO TO 1050-EDIT-CHECK-NO.
 10509
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 201
* EL156.cbl
 10510     MOVE LOW-VALUES             TO ERACCT-KEY.
 10511     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10512     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10513     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10514     MOVE PI-STATE               TO ACCT-STATE.
 10515     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10516     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10517     MOVE 'ACCT'                 TO FILE-SWITCH.
 10518
 10519     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10520     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10521
 10522
 10523* EXEC CICS HANDLE CONDITION
 10524*         NOTFND   (1950-NOT-FOUND)
 10525*         ENDFILE  (1950-NOT-FOUND)
 10526*    END-EXEC.
 10527*    MOVE '"$I''                  ! ( #00010151' TO DFHEIV0
 10528     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10530     MOVE X'2820233030303130313531' TO DFHEIV0(25:11)
 10531     CALL 'kxdfhei1' USING DFHEIV0
 10532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10533
 10534
 10535
 10536* EXEC CICS STARTBR
 10537*         DATASET   ('ERACCT')
 10538*         RIDFLD    (ERACCT-KEY)
 10539*         GTEQ
 10540*    END-EXEC.
 10541     MOVE 'ERACCT' TO DFHEIV1
 10542     MOVE 0
 10543       TO DFHEIV11
 10544*    MOVE '&,         G          &   #00010156' TO DFHEIV0
 10545     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10546     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10547     MOVE X'2020233030303130313536' TO DFHEIV0(25:11)
 10548     CALL 'kxdfhei1' USING DFHEIV0,
 10549           DFHEIV1,
 10550           ERACCT-KEY,
 10551           DFHEIV99,
 10552           DFHEIV11,
 10553           DFHEIV99
 10554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10555
 10556
 10557 1046-READNEXT-ERACCT.
 10558
 10559
 10560* EXEC CICS READNEXT
 10561*         DATASET   ('ERACCT')
 10562*         RIDFLD    (ERACCT-KEY)
 10563*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10564*    END-EXEC.
 10565     MOVE 'ERACCT' TO DFHEIV1
 10566     MOVE 0
 10567       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 202
* EL156.cbl
 10568*    MOVE '&.S                   )   #00010164' TO DFHEIV0
 10569     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10570     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10571     MOVE X'2020233030303130313634' TO DFHEIV0(25:11)
 10572     CALL 'kxdfhei1' USING DFHEIV0,
 10573           DFHEIV1,
 10574           DFHEIV20,
 10575           DFHEIV99,
 10576           ERACCT-KEY,
 10577           DFHEIV99,
 10578           DFHEIV11,
 10579           DFHEIV99,
 10580           DFHEIV99
 10581     SET ADDRESS OF ACCOUNT-MASTER TO
 10582         DFHEIV20
 10583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10584
 10585
 10586     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10587        IF WS-ERACCT-HOLD-RECORD = SPACES
 10588           GO TO 1950-NOT-FOUND
 10589        ELSE
 10590           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10591           GO TO 1048-CONTINUE.
 10592
 10593     IF ACCT-EXP-DT = HIGH-VALUES
 10594        NEXT SENTENCE
 10595     ELSE
 10596        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10597        GO TO 1046-READNEXT-ERACCT.
 10598
 10599 1048-CONTINUE.
 10600
 10601*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10602*       MOVE 'Y'                 TO GROUPEDI
 10603*                                   PI-GROUPED
 10604*                                   WS-GROUPED
 10605*       MOVE AL-UANON            TO GROUPEDA.
 10606*************** CRI CODE END ******************
 10607
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 203
* EL156.cbl
 10609 1050-EDIT-CHECK-NO.
 10610
 10611     IF PI-OFFLINE = 'Y'
 10612         IF PI-ECHECKNO = SPACES
 10613              MOVE ER-0439        TO EMI-ERROR
 10614              GO TO 1090-CHECK-NO-ERROR
 10615           ELSE
 10616*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10617*           IF PI-ECHECKNO-N = 'N' AND
 10618*              PI-CASH       = 'Y'
 10619*                MOVE ER-3535        TO EMI-ERROR
 10620*                GO TO 1090-CHECK-NO-ERROR
 10621*             ELSE
 10622*                MOVE AL-UANON    TO CHECKNOA
 10623*                GO TO 1100-EDIT-HOLDTIL
 10624*         ELSE
 10625            MOVE AL-UANON    TO CHECKNOA
 10626            GO TO 1100-EDIT-HOLDTIL.
 10627
 10628     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10629     MOVE '6'                    TO CNTL-REC-TYPE.
 10630
 10631     IF CONTROL-IS-ACTUAL-CARRIER
 10632         MOVE PI-CARRIER         TO WS-CARR
 10633     ELSE
 10634         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10635
 10636     IF PI-COMPANY-ID = 'FIA'
 10637         MOVE PI-CARRIER         TO WS-CARR.
 10638
 10639     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10640     MOVE 0                      TO CNTL-SEQ-NO.
 10641     MOVE 'CARR'                 TO FILE-SWITCH.
 10642
 10643     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10644
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 204
* EL156.cbl
 10646     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10647         GO TO 1051-EDIT-CHECKNO-CONT.
 10648
 10649**********************AIG LOGIC STARTS**********************
 10650     IF PI-ECHECKNO = SPACES
 10651         IF CHECK-NO-MANUAL
 10652             MOVE ER-0441        TO EMI-ERROR
 10653             GO TO 1090-CHECK-NO-ERROR
 10654         ELSE
 10655             MOVE AL-UANOF       TO CHECKNOA
 10656             GO TO 1100-EDIT-HOLDTIL.
 10657
 10658     IF PI-ECHECKNO NOT = SPACES
 10659         IF CHECK-NO-MANUAL
 10660             MOVE AL-UANON       TO CHECKNOA
 10661             GO TO 1100-EDIT-HOLDTIL.
 10662
 10663     IF PI-ECHECKNO-CR = 'CR'
 10664        IF PI-OFFLINE = 'Y'
 10665            MOVE AL-UANON       TO CHECKNOA
 10666            GO TO 1100-EDIT-HOLDTIL
 10667        ELSE
 10668            MOVE ER-3534        TO EMI-ERROR
 10669            GO TO 1090-CHECK-NO-ERROR.
 10670
 10671     IF PI-ECHECKNO-N = 'N'
 10672        IF PI-CASH = 'N'
 10673            MOVE AL-UANON       TO CHECKNOA
 10674            GO TO 1100-EDIT-HOLDTIL
 10675        ELSE
 10676            MOVE ER-3535          TO EMI-ERROR
 10677            GO TO 1090-CHECK-NO-ERROR.
 10678
 10679     MOVE ER-0442        TO EMI-ERROR
 10680     GO TO 1090-CHECK-NO-ERROR.
 10681**********************AIG LOGIC ENDS************************
 10682
 10683 1051-EDIT-CHECKNO-CONT.
 10684
 10685     IF PI-COMPANY-ID = 'DMD'
 10686        IF PI-ECHECKNO NOT = SPACES
 10687           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10688              MOVE ER-0442        TO EMI-ERROR
 10689              GO TO 1090-CHECK-NO-ERROR
 10690            ELSE
 10691              GO TO 1100-EDIT-HOLDTIL
 10692          ELSE
 10693           GO TO 1100-EDIT-HOLDTIL.
 10694
 10695     IF PI-ECHECKNO = SPACES
 10696         IF CHECK-NO-MANUAL
 10697             MOVE ER-0441        TO EMI-ERROR
 10698             GO TO 1090-CHECK-NO-ERROR
 10699         ELSE
 10700             MOVE AL-UANOF       TO CHECKNOA
 10701             GO TO 1100-EDIT-HOLDTIL
 10702     ELSE
 10703         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 205
* EL156.cbl
 10704             MOVE AL-UANON       TO CHECKNOA
 10705             GO TO 1100-EDIT-HOLDTIL
 10706         ELSE
 10707             MOVE ER-0442        TO EMI-ERROR
 10708             GO TO 1090-CHECK-NO-ERROR.
 10709
 10710 1090-CHECK-NO-ERROR.
 10711     MOVE -1                     TO CHECKNOL.
 10712     MOVE AL-UABON               TO CHECKNOA.
 10713     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10714
 10715     GO TO 2000-EDIT-DONE.
 10716
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 206
* EL156.cbl
 10718 1100-EDIT-HOLDTIL.
 10719     MOVE ZERO TO WS-TOT-AMOUNT-PAID
 10720                  WS-UNPD-HOLD-UNTIL-DT
 10721     SET HOLD-UNTIL-CHK TO TRUE
 10722     MOVE CL-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 10723     PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10724     IF CL-TOTAL-PAID-AMT NOT = WS-TOT-AMOUNT-PAID
 10725         MOVE ER-3277            TO EMI-ERROR
 10726         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10727     END-IF
 10728
 10729     MOVE SPACE TO WS-HOLD-UNTIL-SW
 10730
 10731     MOVE AL-UANON               TO HOLDTILA.
 10732
 10733     IF PI-HOLDTIL = ZEROS
 10734        IF PI-OFFLINE = 'Y'
 10735           MOVE ER-0572          TO EMI-ERROR
 10736           GO TO 1105-HOLDTIL-ERROR
 10737        ELSE
 10738           GO TO 1110-EDIT-PAID-FROM.
 10739
 10740     MOVE '4'                    TO DC-OPTION-CODE.
 10741     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10742     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10743
 10744     IF DATE-CONVERSION-ERROR
 10745         MOVE ER-0446            TO EMI-ERROR
 10746         GO TO 1105-HOLDTIL-ERROR
 10747     END-IF
 10748     IF PI-OFFLINE = 'Y'
 10749        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10750           MOVE ER-0446            TO EMI-ERROR
 10751           GO TO 1105-HOLDTIL-ERROR
 10752        END-IF
 10753     END-IF
 10754
 10755     IF DC-BIN-DATE-1 < WS-UNPD-HOLD-UNTIL-DT
 10756        MOVE ER-3278          TO EMI-ERROR
 10757        GO TO 1105-HOLDTIL-ERROR
 10758     END-IF
 10759
 10760     IF PI-OFFLINE = 'Y'
 10761        GO TO 1110-EDIT-PAID-FROM.
 10762
 10763     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10764     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10765     MOVE '1'                    TO DC-OPTION-CODE.
 10766     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10767
 10768*    IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10769     IF DC-ELAPSED-DAYS > 60 OR DATE-CONVERSION-ERROR
 10770         MOVE ER-0447            TO EMI-ERROR
 10771         GO TO 1105-HOLDTIL-ERROR.
 10772
 10773     GO TO 1110-EDIT-PAID-FROM.
 10774
 10775 1105-HOLDTIL-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 207
* EL156.cbl
 10776     MOVE -1                     TO HOLDTILL.
 10777     MOVE AL-UNBON               TO HOLDTILA.
 10778     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10779
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 208
* EL156.cbl
 10781 1110-EDIT-PAID-FROM.
 10782     MOVE AL-UANON               TO EPYFROMA.
 10783
 10784     IF PI-EPYFROM = ZEROS
 10785         GO TO 1120-CALCULATE-PAID-FROM.
 10786
 10787     IF PI-PMTTYPE = '5' OR '6'
 10788         MOVE ER-0448            TO EMI-ERROR
 10789         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10790         MOVE AL-UNBON           TO EPYFROMA
 10791         MOVE -1                 TO EPYFROML
 10792         GO TO 1150-EDIT-PAID-THRU.
 10793
 10794     MOVE '4'                    TO DC-OPTION-CODE.
 10795     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10796     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10797
 10798     IF DATE-CONVERSION-ERROR
 10799         MOVE ER-0449            TO EMI-ERROR
 10800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10801         MOVE AL-UNBON           TO EPYFROMA
 10802         MOVE -1                 TO EPYFROML
 10803     ELSE
 10804         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10805
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 209
* EL156.cbl
 10807 1120-CALCULATE-PAID-FROM.
 10808     IF PI-PMTTYPE = '5' OR '6'
 10809         GO TO 1150-EDIT-PAID-THRU.
 10810
 10811*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10812*       IF PI-PMTTYPE = '4'
 10813*         GO TO 1150-EDIT-PAID-THRU.
 10814
 10815     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10816         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10817         MOVE ' '                TO DC-OPTION-CODE
 10818         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10819         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10820         GO TO 1145-TEST-PAID-FROM.
 10821
 10822     IF PI-PMTTYPE = '4'
 10823        GO TO 1150-EDIT-PAID-THRU.
 10824
 10825     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10826     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10827     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10828     MOVE '5'                    TO CNTL-REC-TYPE.
 10829     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10830     MOVE 'BENE'                 TO FILE-SWITCH.
 10831
 10832     IF WS-BEN-CD = ZEROS
 10833         GO TO 1950-NOT-FOUND.
 10834
 10835     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10836
 10837     IF NO-BENEFIT-FOUND
 10838         GO TO 1950-NOT-FOUND.
 10839
 10840     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10841     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10842
 10843     IF PI-BEN-DAYS NOT NUMERIC
 10844        MOVE ZEROS               TO PI-BEN-DAYS.
 10845
 10846     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10847
 10848     IF WS-HOLD-UNTIL-DT > CL-PAID-THRU-DT
 10849         MOVE WS-HOLD-UNTIL-DT     TO DC-BIN-DATE-1
 10850         MOVE '6'                 TO DC-OPTION-CODE
 10851         MOVE +0                  TO DC-ELAPSED-MONTHS
 10852         MOVE +1                  TO DC-ELAPSED-DAYS
 10853         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10854         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10855         GO TO 1145-TEST-PAID-FROM.
 10856
 10857     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10858        (CL-TOTAL-PAID-AMT > ZEROS)
 10859         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10860         MOVE '6'                 TO DC-OPTION-CODE
 10861         MOVE +0                  TO DC-ELAPSED-MONTHS
 10862         MOVE +1                  TO DC-ELAPSED-DAYS
 10863         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10864         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 210
* EL156.cbl
 10865         GO TO 1145-TEST-PAID-FROM.
 10866
 10867******************************************************************
 10868****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10869****** SPECIAL ENTERED DATE.
 10870******************************************************************
 10871
 10872     IF PI-AIGFROM = ZEROS
 10873         GO TO 1130-CONTINUE-PAID-FROM.
 10874
 10875     MOVE AL-UANON TO AIGFROMA.
 10876
 10877     MOVE '4'                    TO DC-OPTION-CODE.
 10878     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10879     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10880
 10881     IF DATE-CONVERSION-ERROR
 10882         MOVE ER-0449            TO EMI-ERROR
 10883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10884         MOVE AL-UNBON           TO AIGFROMA
 10885         MOVE -1                 TO AIGFROML
 10886         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10887     ELSE
 10888         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10889         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10890
 10891     GO TO 1140-CONTINUE-PAID-FROM.
 10892
 10893 1130-CONTINUE-PAID-FROM.
 10894
 10895     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10896        (CL-TOTAL-PAID-AMT = ZEROS)
 10897           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10898
 10899 1140-CONTINUE-PAID-FROM.
 10900
 10901     IF PI-BEN-TYPE = 'R'
 10902         IF PI-BEN-DAYS = ZEROS
 10903             NEXT SENTENCE
 10904         ELSE
 10905         IF PI-COMPANY-ID NOT = 'DMD'
 10906             SUBTRACT 1 FROM PI-BEN-DAYS.
 10907
 10908     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10909
 10910     IF PI-COMPANY-ID = 'DMD'
 10911         MOVE -1                 TO DC-ELAPSED-DAYS
 10912         MOVE +0                 TO DC-ELAPSED-MONTHS
 10913         MOVE '6'                TO DC-OPTION-CODE
 10914         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10915         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10916         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10917                               REMAINDER DC-ELAPSED-DAYS
 10918      ELSE
 10919         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10920         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10921
 10922     MOVE '6'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 211
* EL156.cbl
 10923     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10924     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10925
 10926     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10927
 10928     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10929         MOVE ER-0541            TO EMI-ERROR
 10930         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10931         MOVE -1                 TO EPYFROML
 10932         MOVE AL-UNBON           TO EPYFROMA.
 10933
 10934     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10935        (PI-BENEFIT-SAVE = '60E')
 10936        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10937           (CL-TOTAL-PAID-AMT = ZEROS)
 10938             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10939             MOVE 30                  TO DC-ELAPSED-DAYS
 10940             MOVE +0                  TO DC-ELAPSED-MONTHS
 10941             MOVE '6'                 TO DC-OPTION-CODE
 10942             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10943
 10944     IF PI-BEN-TYPE = 'R'
 10945         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10946     ELSE
 10947         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10948         IF WS-SV-EPYFROM = LOW-VALUES
 10949            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10950
 10951     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10952         IF WS-USE-AIG-PAYFROM   OR
 10953            WS-AIG-RECALC-PAYFROM
 10954              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10955                                      DC-BIN-DATE-1
 10956              MOVE ' '            TO  DC-OPTION-CODE
 10957              MOVE +0             TO  DC-ELAPSED-MONTHS
 10958                                      DC-ELAPSED-DAYS
 10959              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10960              IF NO-CONVERSION-ERROR
 10961                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10962
 10963     IF PI-CPYFROM < CL-INCURRED-DT
 10964        MOVE -1                  TO EPYFROML
 10965        MOVE ER-3542             TO EMI-ERROR
 10966        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10967
 10968     IF CM-ENTRY-DT < CL-INCURRED-DT
 10969        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10970        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10971        MOVE +0                     TO DC-ELAPSED-DAYS
 10972        MOVE +0                     TO DC-ELAPSED-MONTHS
 10973        MOVE '1'                    TO DC-OPTION-CODE
 10974        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10975        ELSE
 10976        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10977
 10978     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10979         NEXT SENTENCE
 10980     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 212
* EL156.cbl
 10981         IF DC-ELAPSED-MONTHS < 2
 10982             MOVE ER-3255        TO EMI-ERROR
 10983             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10984
 10985 1145-TEST-PAID-FROM.
 10986     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10987         GO TO 1150-EDIT-PAID-THRU.
 10988
 10989     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10990         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10991         MOVE ' '                TO DC-OPTION-CODE
 10992         MOVE +0                 TO DC-ELAPSED-MONTHS
 10993                                    DC-ELAPSED-DAYS
 10994         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10995         IF NO-CONVERSION-ERROR
 10996             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10997         ELSE
 10998             MOVE SPACES             TO EMI-DATE-FIELD.
 10999
 11000     IF PI-HOLDTIL NOT = ZEROS
 11001        CONTINUE
 11002     ELSE
 11003     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 11004         IF CL-TOTAL-PAID-AMT = ZEROS
 11005             MOVE ER-3543            TO EMI-ERROR
 11006             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 11007             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11008             IF EMI-MESSAGE-FORMATTED
 11009                MOVE -1             TO EPYFROML
 11010                MOVE AL-UNBON       TO EPYFROMA
 11011             ELSE
 11012                NEXT SENTENCE
 11013         ELSE
 11014             MOVE ER-0452            TO EMI-ERROR
 11015             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 11016             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11017             IF EMI-MESSAGE-FORMATTED
 11018                MOVE -1             TO EPYFROML
 11019                MOVE AL-UNBON       TO EPYFROMA.
 11020
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 213
* EL156.cbl
 11022 1150-EDIT-PAID-THRU.
 11023
 11024     MOVE AL-UANON               TO EPYTHRUA.
 11025
 11026     IF PI-EPYTHRU = ZEROS
 11027*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 11028         IF PI-PMTTYPE = '5' OR '6'
 11029           OR (CL-CLAIM-TYPE NOT = 'L' AND 'O'
 11030             AND PI-PMTTYPE = '4')
 11031             GO TO 1200-EDIT-FIND-TOLERANCES
 11032         ELSE
 11033            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 11034               (PI-PMTTYPE = '2' AND
 11035                 CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 11036               GO TO 1152-CHECK-TYPE
 11037            ELSE
 11038               MOVE ER-0473      TO EMI-ERROR
 11039               GO TO 1170-PAID-THRU-FATAL-ERROR
 11040     ELSE
 11041         IF PI-PMTTYPE = '5' OR '6'
 11042             MOVE ER-0474        TO EMI-ERROR
 11043             GO TO 1170-PAID-THRU-FATAL-ERROR.
 11044
 11045     MOVE '4'                    TO DC-OPTION-CODE.
 11046     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 11047     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11048
 11049     IF DATE-CONVERSION-ERROR
 11050         MOVE ER-0475            TO EMI-ERROR
 11051         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11052
 11053     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 11054
 11055     IF PI-COMPANY-ID = 'DMD'
 11056         IF PI-PMTTYPE NOT = '2'
 11057                 AND
 11058            WS-EXP-DT > WS-SV-EPYTHRU
 11059             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 11060             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 11061             MOVE '1'              TO DC-OPTION-CODE
 11062             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11063             IF DATE-CONVERSION-ERROR
 11064                 MOVE ER-0944      TO EMI-ERROR
 11065                 GO TO 1170-PAID-THRU-FATAL-ERROR
 11066             ELSE
 11067                 IF DC-ELAPSED-MONTHS = ZEROS AND
 11068                    DC-ELAPSED-DAYS   = 1
 11069                     MOVE ER-0945  TO EMI-ERROR
 11070                     MOVE -1       TO EPYTHRUL
 11071                     MOVE AL-UABON TO EPYTHRUA
 11072                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11073
 11074     IF PI-PMTTYPE = '4'
 11075         NEXT SENTENCE
 11076     ELSE
 11077         IF WS-SV-EPYTHRU = WS-EXP-DT
 11078             IF PI-PMTTYPE NOT = '2' AND '3'
 11079                 MOVE ER-3541    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 214
* EL156.cbl
 11080                 MOVE -1         TO PMTTYPEL
 11081                 MOVE AL-UABON   TO PMTTYPEA
 11082                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11083
 11084     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 11085         MOVE ER-0501            TO EMI-ERROR
 11086         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11087
 11088     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 11089        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 11090*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11091*              MOVE ER-0540         TO EMI-ERROR
 11092*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11093*              MOVE -1              TO EPYTHRUL
 11094*              MOVE AL-UNBON        TO EPYTHRUA
 11095*          ELSE
 11096*          IF PI-COMPANY-ID = 'DMD'
 11097*              MOVE ER-7540         TO EMI-ERROR
 11098*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11099*              MOVE -1              TO EPYTHRUL
 11100*              MOVE AL-UNBON        TO EPYTHRUA
 11101*          ELSE
 11102               IF PI-PMTTYPE NOT = '2' AND '3'
 11103                  IF PI-COMPANY-ID = '???'
 11104                      MOVE ER-7540  TO EMI-ERROR
 11105                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11106                      MOVE -1       TO EPYTHRUL
 11107                      MOVE AL-UNBON TO EPYTHRUA
 11108                  ELSE
 11109                      MOVE ER-0540  TO EMI-ERROR
 11110                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11111                      MOVE -1       TO EPYTHRUL
 11112                      MOVE AL-UNBON TO EPYTHRUA.
 11113
 11114     MOVE 'N' TO PI-DUPE-APPROVAL-NEEDED
 11115     IF ((WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11116            OR
 11117        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 11118         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11119            OR
 11120        (PI-CPYFROM NOT = LOW-VALUES AND
 11121         PI-CPYFROM < CL-PAID-THRU-DT))
 11122       AND NOT PI-PMTTYPE = '4'
 11123        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT
 11124     ELSE
 11125     IF WS-SV-EPYTHRU NOT = LOW-VALUES
 11126       AND WS-SV-EPYFROM NOT = LOW-VALUES
 11127        SET CHECK-ALL-PMTS TO TRUE
 11128        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 11129
 11130     IF PI-HOLDTIL = ZEROS
 11131       AND UNPAID-HOLD-UNTIL-EXISTS
 11132       AND NOT DUPE-VOID-PMT-EXISTS
 11133        MOVE ER-3276    TO EMI-ERROR
 11134        MOVE -1         TO HOLDTILL
 11135        MOVE AL-UABON   TO HOLDTILA
 11136        GO TO 1170-PAID-THRU-FATAL-ERROR
 11137     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 215
* EL156.cbl
 11138
 11139 1152-CHECK-TYPE.
 11140     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11141        OR (PI-PMTTYPE = '5' OR '6')
 11142         GO TO 1160-EDIT-PAID-THRU-AH.
 11143
 11144 1155-EDIT-PAID-THRU-LIFE.
 11145     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11146     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11147     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11148     MOVE '4'                    TO CNTL-REC-TYPE.
 11149     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11150     MOVE 'BENE'                 TO FILE-SWITCH.
 11151
 11152     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11153
 11154     IF NO-BENEFIT-FOUND
 11155         GO TO 1950-NOT-FOUND.
 11156
 11157     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11158
 11159     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11160
 11161     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11162        PI-LF-COVERAGE-TYPE = 'P'
 11163         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11164         GO TO 1200-EDIT-FIND-TOLERANCES.
 11165
 11166     IF PI-EPYTHRU = ZEROS
 11167        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11168
 11169     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11170         MOVE ER-0476            TO EMI-ERROR
 11171         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11172
 11173     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11174*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11175     move cl-critical-period    to dc-elapsed-months
 11176     MOVE +0                    TO DC-ELAPSED-DAYS.
 11177     MOVE '6'                   TO DC-OPTION-CODE.
 11178     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11179
 11180     IF (NO-CONVERSION-ERROR AND
 11181         WS-SPECIAL-CALC-CD = 'C')
 11182        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11183            MOVE ER-0657 TO EMI-ERROR
 11184            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11185
 11186     IF PI-COMPANY-ID = 'NCL'
 11187         IF WS-SPECIAL-CALC-CD = 'C' AND
 11188            cl-critical-period = zeros
 11189*           CM-LF-CRITICAL-PERIOD = +0
 11190             MOVE ER-0844       TO EMI-ERROR
 11191             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11192
 11193     GO TO 1200-EDIT-FIND-TOLERANCES.
 11194
 11195 1160-EDIT-PAID-THRU-AH.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 216
* EL156.cbl
 11196     IF PI-EPYTHRU = ZEROS
 11197        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11198                                    WS-SV-EPYTHRU
 11199     ELSE
 11200        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11201
 11202     IF WS-SV-EPYTHRU < PI-CPYFROM
 11203         MOVE ER-0508            TO EMI-ERROR
 11204         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11205
 11206     perform 7975-read-acct      thru 7975-exit
 11207     move zeros                  to pi-max-ext
 11208     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11209        PERFORM 0900-GET-DDF-LIMITS
 11210                                 THRU 0900-EXIT
 11211        IF PDEF-FOUND
 11212           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11213              (P1 > +8)
 11214              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11215           END-PERFORM
 11216           IF P1 < +9
 11217              MOVE PD-MAX-extension (P1)
 11218                                 TO pi-max-ext
 11219           else
 11220              move er-1674       to emi-error
 11221              PERFORM 9900-ERROR-FORMAT
 11222                                 THRU 9900-EXIT
 11223           END-IF
 11224        else
 11225           move er-1672          to emi-error
 11226           PERFORM 9900-ERROR-FORMAT
 11227                                 THRU 9900-EXIT
 11228        END-IF
 11229     end-if
 11230     move spaces                 to pi-max-ext-used
 11231     IF PI-PMTTYPE = '3'
 11232        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11233        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11234           MOVE ER-0477          TO EMI-ERROR
 11235           PERFORM 1165-PAID-THRU-ERROR
 11236                                 THRU 1165-EXIT
 11237        ELSE
 11238           continue
 11239        end-if
 11240     ELSE
 11241        IF WS-SV-EPYTHRU > WS-EXP-DT
 11242         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11243           move ws-exp-dt        to dc-bin-date-1
 11244           move ws-sv-epythru    to dc-bin-date-2
 11245           MOVE '1'              TO DC-OPTION-CODE
 11246           MOVE +0               TO DC-ELAPSED-DAYS
 11247                                    DC-ELAPSED-MONTHS
 11248           PERFORM 9700-LINK-DATE-CONVERT
 11249                                 THRU 9700-EXIT
 11250           if no-conversion-error
 11251              if dc-elapsed-days > zeros
 11252                 add +1 to dc-elapsed-months
 11253              end-if
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 217
* EL156.cbl
 11254              if dc-elapsed-months > pi-max-ext
 11255                 MOVE ER-0557    TO EMI-ERROR
 11256                 PERFORM 1165-PAID-THRU-ERROR
 11257                                 THRU 1165-EXIT
 11258              else
 11259                 move 'Y'        to pi-max-ext-used
 11260                 move er-1670    to emi-error
 11261                 perform 9900-error-format
 11262                                 thru 9900-exit
 11263              end-if
 11264           end-if
 11265         ELSE
 11266            MOVE ER-0557    TO EMI-ERROR
 11267            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11268         END-IF
 11269        end-if
 11270     end-if
 11271
 11272     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11273         PI-PMTTYPE NOT = '3'
 11274         MOVE ER-0541        TO EMI-ERROR
 11275         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11276
 11277     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11278        (PI-PMTTYPE NOT = '3')
 11279         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11280             MOVE ER-0478        TO EMI-ERROR
 11281             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11282
 11283     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11284        (PI-PMTTYPE NOT = '4')
 11285         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11286             MOVE ER-0479        TO EMI-ERROR
 11287             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11288
 11289     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11290         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11291             MOVE ER-0545        TO EMI-ERROR
 11292             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11293
 11294     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11295         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11296             MOVE ER-0481        TO EMI-ERROR
 11297             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11298
 11299*    IF PI-COMPANY-ID = 'NCL'
 11300*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11301*           CM-AH-CRITICAL-PERIOD = +0
 11302*            MOVE ER-0844        TO  EMI-ERROR
 11303*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11304
 11305*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11306     if (cl-critical-period = zeros)
 11307        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11308          GO TO 1200-EDIT-FIND-TOLERANCES.
 11309
 11310     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11311     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 218
* EL156.cbl
 11312     MOVE '1'        TO DC-OPTION-CODE.
 11313     MOVE +0         TO DC-ELAPSED-DAYS
 11314                        DC-ELAPSED-MONTHS.
 11315     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11316
 11317*    IF NO-CONVERSION-ERROR
 11318*       COMPUTE ws-benefits-paid =
 11319*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11320*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11321*           MOVE ER-0657 TO EMI-ERROR
 11322*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11323
 11324     GO TO 1200-EDIT-FIND-TOLERANCES.
 11325
 11326 1165-PAID-THRU-ERROR.
 11327     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11328
 11329     IF EMI-MESSAGE-FORMATTED
 11330         MOVE -1                 TO EPYTHRUL
 11331         MOVE AL-UNBON           TO EPYTHRUA.
 11332
 11333 1165-EXIT.
 11334     EXIT.
 11335
 11336 1166-CHECK-ALL-TRLRS.
 11337
 11338     IF PI-PMTTYPE = '4'
 11339       AND NOT HOLD-UNTIL-CHK
 11340       AND NOT CHECK-ALL-PMTS
 11341        GO TO 1166-TRLR-EXIT.
 11342
 11343     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11344
 11345     IF HOLD-UNTIL-CHK
 11346        CONTINUE
 11347     ELSE
 11348     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11349        WS-SV-EPYFROM = LOW-VALUES
 11350          GO TO 1166-END-CHECK.
 11351
 11352
 11353* EXEC CICS HANDLE CONDITION
 11354*        ENDFILE   (1166-END-CHECK)
 11355*        NOTFND    (1166-END-CHECK)
 11356*    END-EXEC.
 11357*    MOVE '"$''I                  ! ) #00010936' TO DFHEIV0
 11358     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11359     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11360     MOVE X'2920233030303130393336' TO DFHEIV0(25:11)
 11361     CALL 'kxdfhei1' USING DFHEIV0
 11362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11363
 11364
 11365     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11366     MOVE +100                   TO TRLR-SEQ-NO.
 11367
 11368
 11369* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 219
* EL156.cbl
 11370*         DATASET    ('ELTRLR')
 11371*         RIDFLD     (ELTRLR-KEY)
 11372*         GTEQ
 11373*    END-EXEC.
 11374     MOVE 'ELTRLR' TO DFHEIV1
 11375     MOVE 0
 11376       TO DFHEIV11
 11377*    MOVE '&,         G          &   #00010944' TO DFHEIV0
 11378     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11379     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11380     MOVE X'2020233030303130393434' TO DFHEIV0(25:11)
 11381     CALL 'kxdfhei1' USING DFHEIV0,
 11382           DFHEIV1,
 11383           ELTRLR-KEY,
 11384           DFHEIV99,
 11385           DFHEIV11,
 11386           DFHEIV99
 11387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11388
 11389
 11390     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11391
 11392 1166-READ-TRLR-NEXT.
 11393
 11394
 11395* EXEC CICS READNEXT
 11396*         DATASET    ('ELTRLR')
 11397*         RIDFLD     (ELTRLR-KEY)
 11398*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11399*    END-EXEC.
 11400     MOVE 'ELTRLR' TO DFHEIV1
 11401     MOVE 0
 11402       TO DFHEIV11
 11403*    MOVE '&.S                   )   #00010954' TO DFHEIV0
 11404     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11405     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11406     MOVE X'2020233030303130393534' TO DFHEIV0(25:11)
 11407     CALL 'kxdfhei1' USING DFHEIV0,
 11408           DFHEIV1,
 11409           DFHEIV20,
 11410           DFHEIV99,
 11411           ELTRLR-KEY,
 11412           DFHEIV99,
 11413           DFHEIV11,
 11414           DFHEIV99,
 11415           DFHEIV99
 11416     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11417         DFHEIV20
 11418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11419
 11420
 11421     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11422        TRLR-CARRIER  = MSTR-CARRIER  AND
 11423        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11424        TRLR-CERT-NO  = MSTR-CERT-NO
 11425          NEXT SENTENCE
 11426      ELSE
 11427          GO TO 1166-END-CHECK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 220
* EL156.cbl
 11428
 11429* **  BYPASS ALL NON-PAYMENT TRAILERS
 11430
 11431     IF AT-TRAILER-TYPE = '2'
 11432        NEXT SENTENCE
 11433     ELSE
 11434        GO TO 1166-READ-TRLR-NEXT.
 11435
 11436* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11437
 11438     IF (HOLD-UNTIL-CHK
 11439       OR CHECK-ALL-PMTS)
 11440       AND AT-PAYMENT-TYPE <= '4'
 11441        NEXT SENTENCE
 11442     ELSE
 11443     IF AT-PAYMENT-TYPE = '1' OR '2'
 11444        NEXT SENTENCE
 11445     ELSE
 11446        GO TO 1166-READ-TRLR-NEXT.
 11447
 11448     IF ((AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11449        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES))
 11450        AND NOT HOLD-UNTIL-CHK
 11451          GO TO 1166-READ-TRLR-NEXT.
 11452* **  BYPASS ALL VOID PAYMENTS
 11453
 11454     IF AT-VOID-DT NOT = LOW-VALUES
 11455        IF WS-SV-EPYTHRU = AT-PAID-THRU-DT
 11456          AND WS-SV-EPYFROM = AT-PAID-FROM-DT
 11457            SET DUPE-VOID-PMT-EXISTS TO TRUE
 11458        END-IF
 11459        GO TO 1166-READ-TRLR-NEXT.
 11460
 11461     IF HOLD-UNTIL-CHK
 11462        IF AT-PAID-THRU-DT > WS-HOLD-UNTIL-DT
 11463          AND AT-TO-BE-WRITTEN-DT > ZERO
 11464           MOVE AT-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 11465        END-IF
 11466        IF AT-TO-BE-WRITTEN-DT > ZERO
 11467          AND AT-CHECK-WRITTEN-DT = LOW-VALUES
 11468           SET UNPAID-HOLD-UNTIL-EXISTS TO TRUE
 11469           IF AT-TO-BE-WRITTEN-DT > WS-UNPD-HOLD-UNTIL-DT
 11470              MOVE AT-TO-BE-WRITTEN-DT TO WS-UNPD-HOLD-UNTIL-DT
 11471           END-IF
 11472        END-IF
 11473        IF AT-AMOUNT-PAID NUMERIC
 11474          AND (AT-CHECK-WRITTEN-DT > LOW-VALUES
 11475             OR AT-TO-BE-WRITTEN-DT < ZERO)
 11476          AND AT-PAYMENT-TYPE  <= '4'
 11477           ADD AT-AMOUNT-PAID TO WS-TOT-AMOUNT-PAID
 11478        END-IF
 11479     END-IF
 11480
 11481     IF HOLD-UNTIL-CHK
 11482        CONTINUE
 11483     ELSE
 11484     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11485         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 221
* EL156.cbl
 11486            OR
 11487        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11488         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11489        NEXT SENTENCE
 11490     ELSE
 11491         IF WS-SV-EPYTHRU = AT-PAID-THRU-DT
 11492          AND WS-SV-EPYFROM = AT-PAID-FROM-DT
 11493          AND (PI-OFFLINE NOT EQUAL 'Y')
 11494          AND (CL-CLAIM-TYPE NOT = 'L' AND 'O')
 11495            IF PI-PMTTYPE = '4'
 11496               MOVE 'Y' TO PI-DUPE-APPROVAL-NEEDED
 11497               MOVE ER-3280            TO EMI-ERROR
 11498               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11499               MOVE -1                 TO EPYTHRUL
 11500               MOVE AL-UNBON           TO EPYTHRUA
 11501            ELSE
 11502               MOVE ER-3279            TO EMI-ERROR
 11503               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11504               MOVE -1                 TO EPYTHRUL
 11505               MOVE AL-UNBON           TO EPYTHRUA
 11506         ELSE
 11507         IF CL-TOTAL-PAID-AMT > ZEROS
 11508           AND NOT CHECK-ALL-PMTS
 11509             MOVE ER-0502            TO EMI-ERROR
 11510             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11511             MOVE -1                 TO EPYTHRUL
 11512             MOVE AL-UNBON           TO EPYTHRUA.
 11513
 11514     GO TO 1166-READ-TRLR-NEXT.
 11515
 11516 1166-END-CHECK.
 11517
 11518     IF WS-BROWSE-TRLR-SW = 'Y'
 11519
 11520* EXEC CICS ENDBR
 11521*            DATASET   ('ELTRLR')
 11522*       END-EXEC.
 11523     MOVE 'ELTRLR' TO DFHEIV1
 11524     MOVE 0
 11525       TO DFHEIV11
 11526*    MOVE '&2                    $   #00011058' TO DFHEIV0
 11527     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11528     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11529     MOVE X'2020233030303131303538' TO DFHEIV0(25:11)
 11530     CALL 'kxdfhei1' USING DFHEIV0,
 11531           DFHEIV1,
 11532           DFHEIV11,
 11533           DFHEIV99
 11534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11535
 11536
 11537     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11538
 11539 1166-TRLR-EXIT.
 11540     EXIT.
 11541
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 222
* EL156.cbl
 11543 1170-PAID-THRU-FATAL-ERROR.
 11544     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11545
 11546     MOVE -1                     TO EPYTHRUL.
 11547     MOVE AL-UNBON               TO EPYTHRUA.
 11548
 11549 1200-EDIT-FIND-TOLERANCES.
 11550
 11551* EXEC CICS HANDLE CONDITION
 11552*        ENDFILE(1950-NOT-FOUND)
 11553*        NOTFND (1950-NOT-FOUND)
 11554*    END-EXEC.
 11555*    MOVE '"$''I                  ! * #00011075' TO DFHEIV0
 11556     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11558     MOVE X'2A20233030303131303735' TO DFHEIV0(25:11)
 11559     CALL 'kxdfhei1' USING DFHEIV0
 11560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11561
 11562
 11563     IF PI-PROCESSOR-ID = 'LGXX'
 11564        GO TO 1240-FIND-ACCT-TOLERANCES.
 11565
 11566     MOVE 'N'                    TO FOUND-TOL-SW.
 11567     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11568     MOVE '2'                    TO CNTL-REC-TYPE.
 11569     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11570     MOVE +0                     TO CNTL-SEQ-NO.
 11571     MOVE 'PROC'                 TO FILE-SWITCH.
 11572
 11573     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11574
 11575     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11576     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11577                                    PI-MAX-PMT-TOL.
 11578     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11579
 11580     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11581         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11582
 11583     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11584     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11585                                    PI-MAX-LF-PMT-TOL.
 11586
 11587     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11588         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11589
 11590     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11591                                    PI-MAX-EXP-PMT.
 11592
 11593 1240-FIND-ACCT-TOLERANCES.
 11594
 11595     IF WS-PMT-TOL NOT = +0
 11596         MOVE 'Y'                TO FOUND-TOL-SW.
 11597
 11598     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11599         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11600         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 223
* EL156.cbl
 11601         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11602         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11603         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11604         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11605     ELSE
 11606         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11607         MOVE PI-CARRIER             TO ACCT-CARRIER
 11608         MOVE PI-GROUPING            TO ACCT-GROUPING
 11609         MOVE PI-STATE               TO ACCT-STATE
 11610         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11611         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11612
 11613     MOVE 'ACCT'                 TO FILE-SWITCH.
 11614
 11615     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11616     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11617
 11618
 11619* EXEC CICS HANDLE CONDITION
 11620*         NOTFND   (1950-NOT-FOUND)
 11621*         ENDFILE  (1950-NOT-FOUND)
 11622*    END-EXEC.
 11623*    MOVE '"$I''                  ! + #00011135' TO DFHEIV0
 11624     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11626     MOVE X'2B20233030303131313335' TO DFHEIV0(25:11)
 11627     CALL 'kxdfhei1' USING DFHEIV0
 11628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11629
 11630
 11631
 11632* EXEC CICS STARTBR
 11633*        DATASET('ERACCT')
 11634*        RIDFLD (ERACCT-KEY)
 11635*        GTEQ
 11636*    END-EXEC.
 11637     MOVE 'ERACCT' TO DFHEIV1
 11638     MOVE 0
 11639       TO DFHEIV11
 11640*    MOVE '&,         G          &   #00011140' TO DFHEIV0
 11641     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11642     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11643     MOVE X'2020233030303131313430' TO DFHEIV0(25:11)
 11644     CALL 'kxdfhei1' USING DFHEIV0,
 11645           DFHEIV1,
 11646           ERACCT-KEY,
 11647           DFHEIV99,
 11648           DFHEIV11,
 11649           DFHEIV99
 11650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11651
 11652
 11653 1245-FIND-ACCT-TOLERANCES-LOOP.
 11654
 11655
 11656* EXEC CICS READNEXT
 11657*        DATASET('ERACCT')
 11658*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 224
* EL156.cbl
 11659*        RIDFLD (ERACCT-KEY)
 11660*    END-EXEC.
 11661     MOVE 'ERACCT' TO DFHEIV1
 11662     MOVE 0
 11663       TO DFHEIV11
 11664*    MOVE '&.S                   )   #00011148' TO DFHEIV0
 11665     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11666     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11667     MOVE X'2020233030303131313438' TO DFHEIV0(25:11)
 11668     CALL 'kxdfhei1' USING DFHEIV0,
 11669           DFHEIV1,
 11670           DFHEIV20,
 11671           DFHEIV99,
 11672           ERACCT-KEY,
 11673           DFHEIV99,
 11674           DFHEIV11,
 11675           DFHEIV99,
 11676           DFHEIV99
 11677     SET ADDRESS OF ACCOUNT-MASTER TO
 11678         DFHEIV20
 11679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11680
 11681
 11682     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11683        IF WS-ERACCT-HOLD-RECORD = SPACES
 11684           GO TO 1950-NOT-FOUND
 11685        ELSE
 11686           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11687           GO TO 1250-CONTINUE.
 11688
 11689     IF ACCT-EXP-DT = HIGH-VALUES
 11690        NEXT SENTENCE
 11691     ELSE
 11692        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11693        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11694
 11695 1250-CONTINUE.
 11696
 11697     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11698
 11699     IF FOUND-TOL-SW = 'N'
 11700         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11701
 11702********* 1260-FIND-STATE-TOLERANCES.
 11703
 11704     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11705     MOVE PI-STATE               TO WS-ST-ACCESS.
 11706     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11707     MOVE '3'                    TO CNTL-REC-TYPE.
 11708     MOVE +0                     TO CNTL-SEQ-NO.
 11709     MOVE 'STAT'                 TO FILE-SWITCH.
 11710
 11711     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11712
 11713     IF WS-PMT-TOL = +0
 11714         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11715
 11716     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 225
* EL156.cbl
 11717     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11718     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11719     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11720     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11721
 11722****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11723****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11724     IF PI-PAYEE-TYPE <> 'B'
 11725           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11726     END-IF.
 11727
 11728     IF PI-PMTTYPE      = '2'  AND
 11729        PI-SPLIT-PMT-SW = 'Y'  AND
 11730        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 11731          MOVE ER-3530                TO EMI-ERROR
 11732          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11733
 11734********* 1280-FIND-BENEFIT-TOLERANCES.
 11735
 11736     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11737        OR (PI-PMTTYPE = '5' OR '6')
 11738         GO TO 1300-FIND-CARR-TOLERANCES.
 11739
 11740     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11741     MOVE '4'                    TO CNTL-REC-TYPE.
 11742     MOVE +0                     TO CNTL-SEQ-NO.
 11743     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11744     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11745     MOVE 'BENE'                 TO FILE-SWITCH.
 11746
 11747     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11748
 11749     IF NO-BENEFIT-FOUND
 11750         GO TO 1950-NOT-FOUND.
 11751
 11752     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11753     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11754     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11755
 11756
 11757* EXEC CICS HANDLE CONDITION
 11758*        NOTFND(1950-NOT-FOUND)
 11759*    END-EXEC.
 11760*    MOVE '"$I                   ! , #00011228' TO DFHEIV0
 11761     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11762     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11763     MOVE X'2C20233030303131323238' TO DFHEIV0(25:11)
 11764     CALL 'kxdfhei1' USING DFHEIV0
 11765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11766
 11767
 11768 1300-FIND-CARR-TOLERANCES.
 11769     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11770     MOVE '6'                    TO CNTL-REC-TYPE.
 11771
 11772     IF CONTROL-IS-ACTUAL-CARRIER
 11773         MOVE PI-CARRIER               TO WS-CARR
 11774     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 226
* EL156.cbl
 11775         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11776
 11777     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11778     MOVE +0                     TO CNTL-SEQ-NO.
 11779     MOVE 'CARR'                 TO FILE-SWITCH.
 11780
 11781     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11782
 11783     IF WS-DAYS-TOL = +0
 11784         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11785
 11786     IF WS-PMT-TOL = +0
 11787         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11788
 11789     IF WS-MAX-DAYS-TOL = +0
 11790         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11791
 11792     IF WS-MAX-PMT-TOL = +0
 11793         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11794                                    PI-MAX-PMT-TOL.
 11795
 11796     IF WS-MAX-LF-PMT-TOL = +0
 11797        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11798                                    PI-MAX-LF-PMT-TOL.
 11799
 11800     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11801
 11802********* 1320-FIND-COMP-TOLERANCES.
 11803
 11804     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11805     MOVE '1'                    TO CNTL-REC-TYPE.
 11806     MOVE SPACES                 TO CNTL-ACCESS.
 11807     MOVE +0                     TO CNTL-SEQ-NO.
 11808     MOVE 'COMP'                 TO FILE-SWITCH.
 11809
 11810     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11811
 11812     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11813     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11814
 11815     IF WS-PMT-TOL NOT = +0
 11816        IF WS-TOL-SEVERITY NOT = ' '
 11817         GO TO 1360-EDIT-DAYS.
 11818
 11819     IF WS-PMT-TOL = +0
 11820         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11821
 11822     IF WS-TOL-SEVERITY = ' '
 11823         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11824
 11825 1360-EDIT-DAYS.
 11826     IF PI-PMTTYPE NOT = '4'
 11827        IF PI-EDAYS NEGATIVE OR
 11828           PI-EPYAMT NEGATIVE
 11829          MOVE ER-0513             TO EMI-ERROR
 11830          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11831          MOVE -1                  TO PMTTYPEL.
 11832
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 227
* EL156.cbl
 11833     IF PI-PMTTYPE = '5' OR '6'
 11834        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11835
 11836     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11837        IF PI-PMTTYPE = '4'
 11838          MOVE PI-EDAYS          TO PI-CDAYS.
 11839
 11840     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 11841         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11842
 11843     IF PI-PMTTYPE = '4'
 11844        MOVE PI-EDAYS            TO PI-CDAYS
 11845        GO TO 1400-EDIT-PAYMENT.
 11846
 11847     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11848        GO TO 1500-EDIT-EXPENSES.
 11849
 11850*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11851*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11852*          CM-AH-BENEFIT-CD = '23'              AND
 11853*          CL-CERT-STATE    = '04'              AND
 11854*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11855*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11856*            GO TO 1362-CHECK-MAX-DAYS.
 11857
 11858     IF PI-EDAYS = ZEROS
 11859*        IF PI-COMPANY-ID = 'DMD'
 11860*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11861*            MOVE -1             TO DC-ELAPSED-DAYS
 11862*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11863*            MOVE '6'            TO DC-OPTION-CODE
 11864*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11865*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11866*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11867*            MOVE '1'            TO DC-OPTION-CODE
 11868*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11869*            IF NO-CONVERSION-ERROR
 11870*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11871*                                 + DC-ODD-DAYS-OVER
 11872*               MOVE 6           TO EDAYSL
 11873*               MOVE AL-UNNON    TO EDAYSA
 11874*            ELSE
 11875*                NEXT SENTENCE
 11876*       ELSE
 11877            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11878            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11879            MOVE '1'             TO DC-OPTION-CODE
 11880            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11881            IF NO-CONVERSION-ERROR
 11882                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11883                ADD 1                 TO PI-EDAYS
 11884                MOVE AL-UNNON         TO EDAYSA.
 11885
 11886*    IF PI-COMPANY-ID = 'DMD'
 11887*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11888*        MOVE -1                 TO DC-ELAPSED-DAYS
 11889*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11890*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 228
* EL156.cbl
 11891*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11892*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11893*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11894*        MOVE '1'                TO DC-OPTION-CODE
 11895*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11896*    ELSE
 11897         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11898         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11899         MOVE '1'                TO DC-OPTION-CODE.
 11900         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11901
 11902     IF NO-CONVERSION-ERROR
 11903        IF PI-COMPANY-ID = 'DMD'
 11904            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11905                             + DC-ODD-DAYS-OVER
 11906        ELSE
 11907            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11908            ADD 1                TO PI-CDAYS.
 11909
 11910     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11911        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11912        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11913
 11914     IF PI-EDAYS NOT NUMERIC
 11915         MOVE ER-0491            TO EMI-ERROR
 11916         GO TO 1370-DAYS-ERROR.
 11917
 11918     IF CL-NO-OF-PMTS-MADE = 0
 11919        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11920        AND CL-CERT-STATE = 'MI'
 11921        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11922            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11923     END-IF.
 11924
 11925 1362-CHECK-MAX-DAYS.
 11926
 11927     IF WS-MAX-DAYS-TOL = +999
 11928         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11929
 11930     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11931         IF PI-EDAYS = ZEROS
 11932             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11933         ELSE
 11934             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11935
 11936     IF WS-MAX-DAYS-TOL NOT = ZERO
 11937        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11938           PI-CDAYS > WS-MAX-DAYS-TOL
 11939             MOVE ER-0492          TO EMI-ERROR
 11940             GO TO 1370-DAYS-ERROR.
 11941
 11942 1365-SKIP-MAX-DAYS-EDIT.
 11943     IF PI-EDAYS = ZEROS
 11944        GO TO 1400-EDIT-PAYMENT.
 11945
 11946     IF WS-DAYS-TOL NOT = ZERO
 11947        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11948           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 229
* EL156.cbl
 11949                MOVE ER-0493     TO EMI-ERROR
 11950                GO TO 1370-DAYS-ERROR.
 11951
 11952     GO TO 1400-EDIT-PAYMENT.
 11953
 11954 1370-DAYS-ERROR.
 11955     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11956
 11957     IF EMI-MESSAGE-FORMATTED
 11958         MOVE -1                 TO EDAYSL
 11959         MOVE AL-UABON           TO EDAYSA.
 11960
 11961     GO TO 1400-EDIT-PAYMENT.
 11962
 11963 1380-EDIT-EXPENSE-PMT-AMT.
 11964     IF PI-PMTTYPE = '5' OR '6'
 11965         NEXT SENTENCE
 11966     ELSE
 11967         GO TO 1400-EDIT-PAYMENT.
 11968
 11969     IF WS-MAX-EXP-PMT NOT = ZEROS
 11970        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11971            MOVE ER-3529            TO EMI-ERROR
 11972            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11973
 11974     GO TO 1500-EDIT-EXPENSES.
 11975
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 230
* EL156.cbl
 11977
 11978 1390-CHECK-PAYMENT-DAYS.
 11979
 11980     IF PI-EDAYS = 0
 11981         MOVE PI-CDAYS TO WS-PD-DAYS
 11982     ELSE
 11983         MOVE PI-EDAYS TO WS-PD-DAYS
 11984     END-IF.
 11985
 11986     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11987         IF WS-PD-DAYS = 14
 11988            GO TO 1390-EXIT
 11989         END-IF
 11990     END-IF.
 11991
 11992     IF PI-COMPANY-ID = 'AHL'  AND
 11993        CM-AH-BENEFIT-CD = '1K'
 11994         IF WS-PD-DAYS = 14
 11995            GO TO 1390-EXIT
 11996         END-IF
 11997     END-IF.
 11998
 11999     IF WS-PD-DAYS < 30
 12000         MOVE ER-3549              TO EMI-ERROR
 12001         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12002     END-IF.
 12003
 12004 1390-EXIT.
 12005      EXIT.
 12006
 12007 1400-EDIT-PAYMENT.
 12008*    IF PI-COMPANY-ID = 'DMD'
 12009*       IF CL-CERT-NO (5:2) = '69' OR '70'
 12010*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 12011
 12012     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12013        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12014        MOVE PI-CARRIER          TO ACCT-CARRIER
 12015        MOVE PI-GROUPING         TO ACCT-GROUPING
 12016        MOVE PI-STATE            TO ACCT-STATE
 12017        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12018        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12019        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12020        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12021
 12022
 12023* EXEC CICS READ
 12024*          DATASET ('ERACCT')
 12025*          RIDFLD  (ERACCT-KEY)
 12026*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12027*          GTEQ
 12028*          resp    (WS-RESPONSE)
 12029*       END-EXEC
 12030     MOVE 'ERACCT' TO DFHEIV1
 12031*    MOVE '&"S        G          (  N#00011486' TO DFHEIV0
 12032     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12034     MOVE X'204E233030303131343836' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 231
* EL156.cbl
 12035     CALL 'kxdfhei1' USING DFHEIV0,
 12036           DFHEIV1,
 12037           DFHEIV20,
 12038           DFHEIV99,
 12039           ERACCT-KEY,
 12040           DFHEIV99,
 12041           DFHEIV99,
 12042           DFHEIV99
 12043     SET ADDRESS OF ACCOUNT-MASTER TO
 12044         DFHEIV20
 12045     MOVE EIBRESP  TO WS-RESPONSE
 12046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12047        IF WS-RESP-NORMAL
 12048           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 12049           and pi-cert-eff-dt < am-expiration-dt
 12050           and pi-cert-eff-dt >= am-effective-dt
 12051           move am-dcc-product-code to pi-dcc-product-code
 12052        else
 12053           move spaces           to pi-dcc-product-code
 12054        end-if
 12055        if PI-DCC-PRODUCT-CODE NOT = SPACES
 12056           PERFORM 0900-GET-DDF-LIMITS
 12057                                 THRU 0900-EXIT
 12058           IF PDEF-FOUND
 12059              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12060                 (P1 > +8)
 12061                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 12062              END-PERFORM
 12063              IF P1 < +9
 12064                 if pd-ben-pct (p1) not numeric
 12065                    move zeros   to pd-ben-pct (p1)
 12066                 end-if
 12067                 if pd-ben-pct (p1) = zeros
 12068                    move +1      to ws-work-ben-pct
 12069                 else
 12070                    move pd-ben-pct (p1)
 12071                                 to ws-work-ben-pct
 12072                 end-if
 12073                 compute cm-ah-benefit-amt =
 12074                    cm-ah-benefit-amt * ws-work-ben-pct
 12075                 if cm-ah-benefit-amt > pd-max-amt (p1)
 12076                    move pd-max-amt (p1) to cm-ah-benefit-amt
 12077                 end-if
 12078              else
 12079                 move er-1674    to emi-error
 12080                 PERFORM 9900-ERROR-FORMAT
 12081                                 THRU 9900-EXIT
 12082              END-IF
 12083           else
 12084              move er-1672       to emi-error
 12085              PERFORM 9900-ERROR-FORMAT
 12086                                 THRU 9900-EXIT
 12087           END-IF
 12088        end-if
 12089     END-IF
 12090     IF PI-PMTTYPE NOT = '4'
 12091        GO TO 1405-CALC-PAYMENT.
 12092     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 232
* EL156.cbl
 12093         MOVE PI-EPYAMT           TO PI-CPYAMT
 12094         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 12095         GO TO 1430-CHECK-AH-TOLERANCE.
 12096
 12097*    IF PI-COMPANY-ID = 'FIA'
 12098*       IF CERT-ACCOUNT = '0000011043'
 12099*        COMPUTE PI-DAILY-RATE ROUNDED =
 12100*                      (CM-AH-BENEFIT-AMT * 13) / 365
 12101*        COMPUTE PI-CPYAMT ROUNDED =
 12102*                          PI-DAILY-RATE * PI-EDAYS
 12103*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 12104*        GO TO 1430-CHECK-AH-TOLERANCE.
 12105
 12106     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 12107         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12108         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 12109         GO TO 1420-CHECK-AIG-BENEFIT.
 12110
 12111     IF WS-CALC-METHOD = '2' OR  '5'
 12112         COMPUTE PI-DAILY-RATE ROUNDED =
 12113                        (CM-AH-BENEFIT-AMT * 12) / 365
 12114         COMPUTE PI-CPYAMT ROUNDED =
 12115                           PI-DAILY-RATE * PI-EDAYS
 12116        GO TO 1420-CHECK-AIG-BENEFIT.
 12117
 12118     IF WS-CALC-METHOD = '3'
 12119         COMPUTE PI-DAILY-RATE =
 12120                         (CM-AH-BENEFIT-AMT * 12) / 365
 12121         COMPUTE PI-CPYAMT ROUNDED =
 12122                           PI-DAILY-RATE * PI-EDAYS
 12123        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 233
* EL156.cbl
 12125*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 12126
 12127****************************************************************
 12128****************************************************************
 12129*                  CALCULATED FROM      PAYMENT      PAYMENT
 12130*   DATES           DATE ROUTINE        OPT  1       OPT  6
 12131* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 12132*1-01-83  1-15-83    0    15     15        15           15
 12133*1-01-83  1-30-83    0    30     30        30           30
 12134*1-01-83  1-31-83    1     0     31        30           30
 12135*1-01-83  2-01-83    1     1     32        31           31
 12136*1-01-83  2-15-83    1    15     46        45           45
 12137*1-01-83  2-28-83    2     0     59        60           60
 12138*1-01-83  3-01-83    2     1     60        61           61
 12139*1-01-83  3-31-83    3     0     90        90           90
 12140*1-15-83  1-31-83    0    17     17        17           16
 12141*1-15-83  2-01-83    0    18     18        18           17
 12142*1-15-83  2-28-83    1    14     45        44           46
 12143*1-21-83  3-09-83    1    20     48        50           49
 12144*2-05-83  3-06-83    1     2     30        32           32
 12145*2-05-83  3-23-83    1    19     47        49           49
 12146*2-15-83  2-28-83    0    14     14        14           16
 12147*2-15-83  3-01-83    0    15     15        15           17
 12148*2-21-83  3-19-83    0    27     27        27           29
 12149*2-21-83  3-20-83    1     0     28        30           30
 12150*2-21-83  4-10-83    1    18     49        30           50
 12151*2-21-83  5-19-83    2    27     88        87           89
 12152*2-21-83  5-22-83    3     2     91        92           92
 12153*3-21-83  5-19-83    1    30     60        60           59
 12154****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 234
* EL156.cbl
 12156 1405-CALC-PAYMENT.
 12157     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12158     MOVE ' '                    TO DC-OPTION-CODE.
 12159     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12160     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 12161     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 12162
 12163     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12164     MOVE ' '                    TO DC-OPTION-CODE.
 12165     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12166     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 12167     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 12168
 12169     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12170     MOVE -1                     TO DC-ELAPSED-DAYS.
 12171     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12172     MOVE '6'                    TO DC-OPTION-CODE.
 12173     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12174     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 12175
 12176     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 12177     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 12178     MOVE '1'                    TO DC-OPTION-CODE.
 12179     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12180
 12181     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 12182     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 12183     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 12184
 12185******************************************************************
 12186*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 12187*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 12188*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 12189******************************************************************
 12190
 12191     IF WS-CALC-METHOD = '1'           AND
 12192        DC-ELAPSED-MONTHS > ZERO AND
 12193        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 12194        WDF-DAY > WDT-DAY
 12195          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12196          MOVE ZEROS               TO DC-ELAPSED-DAYS
 12197          MOVE -1                  TO DC-ELAPSED-MONTHS
 12198          MOVE '6'                 TO DC-OPTION-CODE
 12199          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12200          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 12201          COMPUTE WS-SAVE-ODD-DAYS =
 12202          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 12203          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 12204
 12205     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12206     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12207     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12208
 12209     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12210     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12211
 12212*    IF PI-COMPANY-ID = 'FIA'
 12213*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 235
* EL156.cbl
 12214*        COMPUTE PI-DAILY-RATE ROUNDED =
 12215*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12216*        COMPUTE PI-CPYAMT ROUNDED =
 12217*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12218*        GO TO 1420-CHECK-AIG-BENEFIT.
 12219
 12220*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12221*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12222*          CM-AH-BENEFIT-CD = '23'               AND
 12223*          CL-CERT-STATE    = '04'               AND
 12224*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12225*            COMPUTE WS-DAILY-RATE ROUNDED =
 12226*                               CM-AH-BENEFIT-AMT / 30
 12227*            COMPUTE PI-CPYAMT ROUNDED =
 12228*                               (WS-DAILY-RATE * PI-CDAYS)
 12229*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12230*            GO TO 1420-CHECK-AIG-BENEFIT.
 12231
 12232     IF WS-CALC-METHOD = '1'
 12233         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12234         COMPUTE PI-CPYAMT ROUNDED =
 12235             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12236             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12237         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12238         GO TO 1420-CHECK-AIG-BENEFIT.
 12239
 12240     IF WS-CALC-METHOD = '2'
 12241         COMPUTE PI-DAILY-RATE ROUNDED =
 12242                          (CM-AH-BENEFIT-AMT * 12) / 365
 12243         COMPUTE PI-CPYAMT ROUNDED =
 12244             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12245             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12246         GO TO 1420-CHECK-AIG-BENEFIT.
 12247
 12248     IF WS-CALC-METHOD = '4'
 12249         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12250         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12251         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12252         COMPUTE PI-CPYAMT ROUNDED =
 12253                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12254         GO TO 1420-CHECK-AIG-BENEFIT.
 12255
 12256     IF WS-CALC-METHOD = '5'
 12257         COMPUTE PI-DAILY-RATE ROUNDED =
 12258                            (CM-AH-BENEFIT-AMT * 12) / 365
 12259         COMPUTE PI-CPYAMT ROUNDED =
 12260                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12261         GO TO 1420-CHECK-AIG-BENEFIT.
 12262
 12263     IF WS-CALC-METHOD NOT = '3'
 12264        GO TO 1410-CHECK-PAYMENT.
 12265
 12266******   CALCULATION METHOD  3  ROUTINE
 12267     COMPUTE PI-DAILY-RATE =
 12268                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12269
 12270******CHECK TO SEE IF WITHIN SAME MONTH
 12271     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 236
* EL156.cbl
 12272        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12273                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12274         GO TO 1420-CHECK-AIG-BENEFIT.
 12275
 12276******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12277     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12278             SAVE-ODD-DAYS-OVER = ZEROS
 12279      COMPUTE PI-CPYAMT  ROUNDED =
 12280                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12281      GO TO 1420-CHECK-AIG-BENEFIT.
 12282
 12283******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12284******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12285     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12286        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12287        IF WDF-MONTH > 12
 12288           ADD 1                 TO WDF-YEAR
 12289           SUBTRACT 12         FROM WDF-MONTH.
 12290
 12291******CONVERT THE NEW FROM MONTH TO BINARY
 12292     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12293        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12294        MOVE '4'              TO DC-OPTION-CODE
 12295        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12296        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12297
 12298     IF WDF-MONTH = WDT-MONTH AND
 12299        WDF-YEAR  = WDT-YEAR
 12300          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12301                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12302                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12303        ELSE
 12304          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12305          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12306          COMPUTE PI-CPYAMT ROUNDED =
 12307       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12308       +
 12309       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12310       +
 12311       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12312
 12313     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 237
* EL156.cbl
 12315 1410-CHECK-PAYMENT.
 12316******PAYMENT OPTION 6
 12317******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12318     IF SAVE-ELAPSED-MONTHS > ZERO
 12319        IF SAVE-ODD-DAYS-OVER = ZEROS
 12320           GO TO 1412-CHECK-TO-DAY
 12321        ELSE
 12322           IF WDF-DAY > WDT-DAY
 12323              IF WDF-MONTH = 02
 12324                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12325                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12326                  GO TO 1412-CHECK-TO-DAY
 12327              ELSE
 12328                  IF FROM-DAYS-IN-MONTH = 31
 12329                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12330                     GO TO 1412-CHECK-TO-DAY
 12331                  ELSE
 12332                     GO TO 1412-CHECK-TO-DAY
 12333           ELSE
 12334               GO TO 1412-CHECK-TO-DAY.
 12335
 12336     IF WDF-MONTH NOT = WDT-MONTH
 12337        IF WDF-MONTH = 02
 12338           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12339           IF WDF-DAY = 29
 12340              ADD 1              TO SAVE-ODD-DAYS-OVER
 12341           ELSE
 12342              ADD 2              TO SAVE-ODD-DAYS-OVER
 12343        ELSE
 12344           IF FROM-DAYS-IN-MONTH = 31
 12345              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12346
 12347 1412-CHECK-TO-DAY.
 12348        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12349           IF WDT-DAY = 28
 12350              ADD 2              TO SAVE-ODD-DAYS-OVER
 12351           ELSE
 12352              IF WDT-DAY = 29
 12353                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12354              ELSE
 12355                 NEXT SENTENCE
 12356        ELSE
 12357           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12358              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12359
 12360     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12361     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12362     COMPUTE PI-CPYAMT ROUNDED =
 12363         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12364         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12365
 12366     GO TO 1420-CHECK-AIG-BENEFIT.
 12367
 12368 1415-CHECK-LEAP-YEAR.
 12369     IF FROM-DAYS-IN-MONTH = 29
 12370        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12371
 12372 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 238
* EL156.cbl
 12373     EXIT.
 12374
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 239
* EL156.cbl
 12376 1420-CHECK-AIG-BENEFIT.
 12377
 12378     IF WS-SPECIAL-CALC-CD = 'Q'
 12379         GO TO 1425-CHECK-WHOLE-MONTH.
 12380
 12381*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12382*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12383*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12384*       (PI-PMTTYPE = '1' OR '2')
 12385*        NEXT SENTENCE
 12386*    ELSE
 12387         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12388         GO TO 1430-CHECK-AH-TOLERANCE.
 12389
 12390******************AIG LOGIC STARTS**********************
 12391*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12392*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12393*    MOVE ER-3533      TO EMI-ERROR.
 12394*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12395*    GO TO 1430-CHECK-AH-TOLERANCE.
 12396******************AIG LOGIC ENDS************************
 12397
 12398 1425-CHECK-WHOLE-MONTH.
 12399******************************************************************
 12400****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12401****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12402****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12403****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12404****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12405****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12406****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12407****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12408****          PAID * MONTHLY BENEFIT.                         ****
 12409******************************************************************
 12410
 12411     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12412
 12413     IF CL-NO-OF-PMTS-MADE > +0
 12414         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12415
 12416     IF PI-CDAYS < WS-BEN-DAYS
 12417         GO TO 1430-CHECK-AH-TOLERANCE.
 12418
 12419     IF PI-CDAYS = WS-BEN-DAYS
 12420         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12421         GO TO 1430-CHECK-AH-TOLERANCE.
 12422
 12423*    IF PI-COMPANY-ID = 'ACM'
 12424*       NEXT SENTENCE
 12425*    ELSE
 12426        GO TO 1425-NOT-ACM-W15C.
 12427
 12428*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12429*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12430*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12431*    MOVE '6'                    TO  DC-OPTION-CODE.
 12432*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12433*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 240
* EL156.cbl
 12434*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12435*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12436*       MOVE '1'                 TO  DC-OPTION-CODE
 12437*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12438*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12439*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12440*       IF NO-CONVERSION-ERROR
 12441*          IF (DC-ELAPSED-MONTHS > +0) OR
 12442*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12443*             NEXT SENTENCE
 12444*          ELSE
 12445*             MOVE +0            TO  PI-CPYAMT
 12446*             MOVE ER-0846       TO  EMI-ERROR
 12447*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12448*             GO TO 1430-CHECK-AH-TOLERANCE
 12449*       ELSE
 12450*           MOVE ER-0846         TO  EMI-ERROR
 12451*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12452*           GO TO 1430-CHECK-AH-TOLERANCE.
 12453*
 12454*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12455*       ADD +1 TO DC-ELAPSED-MONTHS.
 12456*
 12457*    COMPUTE PI-CPYAMT ROUNDED =
 12458*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12459*
 12460*    GO TO 1430-CHECK-AH-TOLERANCE.
 12461
 12462 1425-NOT-ACM-W15C.
 12463
 12464     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12465     MOVE '6'                        TO  DC-OPTION-CODE.
 12466     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12467     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12468
 12469     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12470     IF NO-CONVERSION-ERROR
 12471         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12472     ELSE
 12473         MOVE ER-0846                TO  EMI-ERROR
 12474         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12475         GO TO 1430-CHECK-AH-TOLERANCE.
 12476
 12477     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12478     MOVE '1'                        TO  DC-OPTION-CODE.
 12479     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12480     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12481     IF NO-CONVERSION-ERROR
 12482         IF DC-ODD-DAYS-OVER = +0
 12483             NEXT SENTENCE
 12484         ELSE
 12485             MOVE ER-0846            TO  EMI-ERROR
 12486             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12487             GO TO 1430-CHECK-AH-TOLERANCE
 12488     ELSE
 12489         MOVE ER-0846                TO  EMI-ERROR
 12490         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12491         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 241
* EL156.cbl
 12492
 12493     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12494         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12495
 12496     GO TO 1430-CHECK-AH-TOLERANCE.
 12497
 12498 1425-CONT-WHOLE-MONTH-PMTS.
 12499******************************************************************
 12500****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12501****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12502****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12503******************************************************************
 12504
 12505     IF PI-COMPANY-ID = 'ACM'
 12506        NEXT SENTENCE
 12507     ELSE
 12508        IF DC-ODD-DAYS-OVER = +0
 12509            NEXT SENTENCE
 12510        ELSE
 12511            MOVE ER-0845            TO  EMI-ERROR
 12512            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12513            GO TO 1430-CHECK-AH-TOLERANCE.
 12514
 12515     COMPUTE PI-CPYAMT ROUNDED =
 12516                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12517
 12518 1430-CHECK-AH-TOLERANCE.
 12519     IF PI-PMT-APPR-SW = 'G'
 12520         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12521
 12522*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12523*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12524*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12525*
 12526*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12527*      IF WDF-MONTH = 02
 12528*        IF SAVE-ELAPSED-MONTHS = 0
 12529*          NEXT SENTENCE
 12530*        ELSE
 12531*          IF SAVE-ODD-DAYS-OVER > 0
 12532*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12533*            COMPUTE WS-PMT-MOS ROUNDED =
 12534*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12535*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12536*                                     WS-PMT-MOS
 12537*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12538*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12539*          ELSE
 12540*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12541*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12542*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12543*                                     WS-PMT-MOS.
 12544
 12545     IF WS-MAX-PMT-TOL NOT = ZERO
 12546        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12547           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12548            MOVE ER-0494         TO  EMI-ERROR
 12549            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 242
* EL156.cbl
 12550            GO TO 1500-EDIT-EXPENSES.
 12551
 12552 1430-CONT-CHECK-AH-TOLERANCE.
 12553
 12554     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12555        GO TO 1500-EDIT-EXPENSES.
 12556
 12557     IF CM-O-B-COVERAGE
 12558        GO TO 1500-EDIT-EXPENSES.
 12559
 12560     IF PI-COMPANY-ID = 'NCL'
 12561       IF FOUND-TOL-SW = 'Y'
 12562         IF WS-PMT-TOL NOT = ZERO
 12563           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12564              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12565                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12566                  IF WS-NCL-PMT-OPTION = SPACES
 12567                      MOVE ER-0699 TO EMI-ERROR
 12568                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12569                  ELSE
 12570                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12571                      NEXT SENTENCE
 12572                  ELSE
 12573                  IF NOT WS-VALID-NCL-OPTION
 12574                      MOVE ER-0699 TO EMI-ERROR
 12575                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12576
 12577     IF WS-PMT-TOL NOT = ZERO
 12578        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12579           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12580           MOVE ER-0495          TO EMI-ERROR
 12581           PERFORM 1490-PAYMENT-ERROR
 12582                                 THRU 1490-EXIT
 12583        end-if
 12584     end-if
 12585
 12586     GO TO 1500-EDIT-EXPENSES.
 12587
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 243
* EL156.cbl
 12589 1440-COMPUTE-LIFE-REMAINING.
 12590
 12591     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12592        IF PI-PMTTYPE = '4'
 12593          MOVE PI-EPYAMT TO PI-CPYAMT
 12594          GO TO 1460-TEST-TYPE.
 12595
 12596     IF WS-LF-COVERAGE-TYPE = 'L'
 12597        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12598                          - CL-TOTAL-PAID-AMT
 12599        GO TO 1450-CHECK-MAX.
 12600
 12601     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12602        PI-LF-COVERAGE-TYPE = 'P'
 12603          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12604                              CM-LF-ITD-DEATH-AMT
 12605          GO TO 1450-CHECK-MAX.
 12606
 12607     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12608     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12609     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12610     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12611     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12612     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12613     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12614     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12615     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12616
 12617     PERFORM 9800-LINK-REM-TERM.
 12618
 12619     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12620     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12621     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12622     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12623     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12624     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12625     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12626     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12627     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12628     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12629     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12630     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12631     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12632     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12633     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12634     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12635     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12636        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12637        MOVE PI-CARRIER          TO ACCT-CARRIER
 12638        MOVE PI-GROUPING         TO ACCT-GROUPING
 12639        MOVE PI-STATE            TO ACCT-STATE
 12640        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12641        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12642        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12643        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12644
 12645
 12646* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 244
* EL156.cbl
 12647*          DATASET ('ERACCT')
 12648*          RIDFLD  (ERACCT-KEY)
 12649*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12650*          GTEQ
 12651*          resp    (WS-RESPONSE)
 12652*       END-EXEC
 12653     MOVE 'ERACCT' TO DFHEIV1
 12654*    MOVE '&"S        G          (  N#00012091' TO DFHEIV0
 12655     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12657     MOVE X'204E233030303132303931' TO DFHEIV0(25:11)
 12658     CALL 'kxdfhei1' USING DFHEIV0,
 12659           DFHEIV1,
 12660           DFHEIV20,
 12661           DFHEIV99,
 12662           ERACCT-KEY,
 12663           DFHEIV99,
 12664           DFHEIV99,
 12665           DFHEIV99
 12666     SET ADDRESS OF ACCOUNT-MASTER TO
 12667         DFHEIV20
 12668     MOVE EIBRESP  TO WS-RESPONSE
 12669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12670        IF WS-RESP-NORMAL
 12671           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12672           and (pi-cert-eff-dt < am-expiration-dt)
 12673           and (pi-cert-eff-dt >= am-effective-dt)
 12674           move am-dcc-product-code to pi-dcc-product-code
 12675        else
 12676           move spaces           to pi-dcc-product-code
 12677        end-if
 12678        if pi-dcc-product-code not = spaces
 12679           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12680           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12681           PERFORM 0900-GET-DDF-limits
 12682                                 THRU 0900-EXIT
 12683           IF PDEF-FOUND
 12684              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12685                 (P1 > +8)
 12686                 OR (PD-PROD-CODE (P1) = 'L')
 12687              END-PERFORM
 12688              IF P1 < +9
 12689                 MOVE PD-MAX-AMT (P1)
 12690                                 TO CP-R-MAX-TOT-BEN
 12691              else
 12692                 move er-1674    to emi-error
 12693                 PERFORM 9900-ERROR-FORMAT
 12694                                 THRU 9900-EXIT
 12695              END-IF
 12696           else
 12697              move er-1672       to emi-error
 12698              PERFORM 9900-ERROR-FORMAT
 12699                                 THRU 9900-EXIT
 12700           END-IF
 12701        end-if
 12702     END-IF
 12703
 12704* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 245
* EL156.cbl
 12705*       PROGRAM  (LINK-REMAMT)
 12706*       COMMAREA (CALCULATION-PASS-AREA)
 12707*       LENGTH   (CP-COMM-LENGTH)
 12708*    END-EXEC.
 12709*    MOVE '."C                   (   #00012131' TO DFHEIV0
 12710     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12712     MOVE X'2020233030303132313331' TO DFHEIV0(25:11)
 12713     CALL 'kxdfhei1' USING DFHEIV0,
 12714           LINK-REMAMT,
 12715           CALCULATION-PASS-AREA,
 12716           CP-COMM-LENGTH,
 12717           DFHEIV99,
 12718           DFHEIV99,
 12719           DFHEIV99,
 12720           DFHEIV99
 12721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12722
 12723
 12724     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12725
 12726     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12727     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12728
 12729     IF PI-COMPANY-ID = 'BOA' AND
 12730        PI-PMTTYPE    = '2'   AND
 12731        PI-OFFLINE    = 'N'
 12732           GO TO 1441-COMPUTE-BOA-INTEREST.
 12733
 12734     IF PI-COMPANY-ID = 'NCL' AND
 12735        PI-PMTTYPE    = '2'   AND
 12736        PI-OFFLINE    = 'N'
 12737          GO TO 1442-COMPUTE-NCL-INTEREST
 12738       ELSE
 12739          GO TO 1445-CONTINUE.
 12740
 12741 1441-COMPUTE-BOA-INTEREST.
 12742     MOVE +0             TO WS-CALC-INT.
 12743
 12744     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12745     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12746     MOVE +0             TO DC-ELAPSED-MONTHS
 12747                            DC-ELAPSED-DAYS.
 12748     MOVE '1'            TO DC-OPTION-CODE.
 12749     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12750     IF NO-CONVERSION-ERROR
 12751         NEXT SENTENCE
 12752     ELSE
 12753         GO TO 1445-CONTINUE.
 12754
 12755     IF (PI-INT-RATE NOT > ZEROS)  AND
 12756        (DC-ELAPSED-DAYS > +30)
 12757         MOVE ER-3531            TO EMI-ERROR
 12758         MOVE -1                 TO PINTL
 12759         MOVE AL-UNBON           TO PINTA
 12760         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12761
 12762     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 246
* EL156.cbl
 12763         GO TO 1445-CONTINUE.
 12764
 12765     IF (PI-INT-RATE NOT > ZEROS)  OR
 12766        (DC-ELAPSED-DAYS NOT > +30)
 12767         MOVE PI-EPYAMT TO PI-CPYAMT
 12768         GO TO 1441-FORMAT-NOTE.
 12769
 12770     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12771                                 *  PI-INT-RATE
 12772                                 *  DC-ELAPSED-DAYS
 12773                                 /  365
 12774                                 /  100.
 12775
 12776     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12777
 12778 1441-FORMAT-NOTE.
 12779
 12780     MOVE SPACES        TO WS-BOANOTE1.
 12781     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12782     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12783     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12784     MOVE AL-UANON      TO NOTE1A.
 12785
 12786     IF WS-CALC-INT > ZEROS
 12787         MOVE SPACES        TO WS-BOANOTE2
 12788         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12789         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12790         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12791         MOVE AL-UANON      TO NOTE2A.
 12792
 12793     GO TO 1445-CONTINUE.
 12794
 12795 1442-COMPUTE-NCL-INTEREST.
 12796     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12797     MOVE PI-STATE               TO WS-ST-ACCESS.
 12798     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12799     MOVE '3'                    TO CNTL-REC-TYPE.
 12800     MOVE +0                     TO CNTL-SEQ-NO.
 12801     MOVE 'STAT'                 TO FILE-SWITCH.
 12802
 12803     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12804
 12805     MOVE +0                 TO WS-CALC-INT.
 12806
 12807     IF ST-STAT-FROM-INCURRED
 12808         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12809       ELSE
 12810     IF ST-STAT-FROM-REPORTED
 12811         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12812       ELSE
 12813         GO TO 1445-CONTINUE.
 12814
 12815     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12816     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12817     MOVE +0                 TO DC-ELAPSED-MONTHS
 12818                                DC-ELAPSED-DAYS.
 12819     MOVE '1'                TO DC-OPTION-CODE.
 12820     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 247
* EL156.cbl
 12821     IF NO-CONVERSION-ERROR
 12822         NEXT SENTENCE
 12823     ELSE
 12824         GO TO 1445-CONTINUE.
 12825
 12826     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12827        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12828         GO TO 1445-CONTINUE.
 12829
 12830     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12831                                 *  CF-ST-STAT-INTEREST.
 12832
 12833     MOVE SPACES              TO WS-NCLNOTE1.
 12834     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12835     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12836     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12837                                 PI-PMTNOTE1
 12838                                 NOTE1I.
 12839     MOVE AL-UANON            TO NOTE1A.
 12840
 12841     IF WS-CALC-INT > ZEROS
 12842         MOVE SPACES          TO WS-NCLNOTE2
 12843         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12844         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12845         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12846                                 PI-PMTNOTE2
 12847                                 NOTE2I
 12848         MOVE AL-UANON        TO NOTE2A.
 12849
 12850     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12851
 12852 1445-CONTINUE.
 12853
 12854     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12855        GO TO 1460-TEST-TYPE.
 12856
 12857     IF CM-O-B-COVERAGE
 12858        GO TO 1460-TEST-TYPE.
 12859
 12860     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12861         GO TO 1450-CHECK-MAX.
 12862
 12863     if (pi-company-id = 'DCC' or 'VPP')
 12864        and (pdef-found)
 12865        if pi-epyamt > pd-max-amt (p1)
 12866           move er-1657          to emi-error
 12867           perform 1490-payment-error
 12868                                 thru 1490-exit
 12869           go to 1460-test-type
 12870        end-if
 12871     else
 12872        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12873           > PI-EPYAMT)
 12874                         OR
 12875           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12876           < PI-EPYAMT)
 12877           MOVE ER-0594          TO EMI-ERROR
 12878           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 248
* EL156.cbl
 12879                                 THRU 1490-EXIT
 12880           GO TO 1460-TEST-TYPE
 12881        end-if
 12882     end-if
 12883     .
 12884 1450-CHECK-MAX.
 12885
 12886     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12887        PI-LF-COVERAGE-TYPE = 'P'
 12888         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12889                                   CM-LF-ITD-DEATH-AMT
 12890     ELSE
 12891         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12892                                   CL-TOTAL-PAID-AMT.
 12893
 12894     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12895          MOVE ER-0543           TO EMI-ERROR
 12896          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12897
 12898 1460-TEST-TYPE.
 12899
 12900     IF PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL'
 12901        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 12902           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12903                                   CM-LF-ALT-BENEFIT-AMT -
 12904                                   CL-TOTAL-PAID-AMT
 12905           IF PI-EPYAMT > WS-LF-BEN-AMT
 12906               MOVE ER-0543      TO EMI-ERROR
 12907               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12908           END-IF
 12909        END-IF
 12910     END-IF
 12911
 12912     IF PI-PMT-APPR-SW = 'G'
 12913       NEXT SENTENCE
 12914     ELSE
 12915       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12916         IF PI-EPYAMT = ZERO
 12917             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12918                 MOVE ER-0494    TO  EMI-ERROR
 12919                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12920                 GO TO 1500-EDIT-EXPENSES
 12921             ELSE
 12922                 NEXT SENTENCE
 12923         ELSE
 12924             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12925                 MOVE ER-0494    TO  EMI-ERROR
 12926                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12927                 GO TO 1500-EDIT-EXPENSES.
 12928
 12929     IF PI-PMTTYPE NOT = '2' OR
 12930        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12931         GO TO 1500-EDIT-EXPENSES.
 12932
 12933     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12934     MOVE ER-0526                TO EMI-ERROR.
 12935     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12936
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 249
* EL156.cbl
 12937     IF EMI-ERROR-NUMBER (1) = '0526'
 12938        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12939
 12940     IF EMI-ERROR-NUMBER (2) = '0526'
 12941        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12942
 12943     GO TO 1500-EDIT-EXPENSES.
 12944
 12945 1490-PAYMENT-ERROR.
 12946     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12947
 12948     IF EMI-MESSAGE-FORMATTED
 12949         MOVE -1                 TO EPYAMTL
 12950         MOVE AL-UNBON           TO EPYAMTA.
 12951
 12952 1490-EXIT.
 12953      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 250
* EL156.cbl
 12955 1500-EDIT-EXPENSES.
 12956     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12957         GO TO 1500-SKIP-ERROR-0556.
 12958
 12959 1500-CONTINUE-ON.
 12960
 12961     IF CM-O-B-COVERAGE
 12962        MOVE ER-0556             TO EMI-ERROR
 12963        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12964
 12965 1500-SKIP-ERROR-0556.
 12966     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12967        IF PI-EEXPENS NOT = ZEROS
 12968           MOVE ER-0524          TO EMI-ERROR
 12969           GO TO 1590-EXPENSE-ERROR
 12970        ELSE
 12971           GO TO 1600-EDIT-RESERVES.
 12972
 12973     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12974     MOVE '6'                    TO CNTL-REC-TYPE.
 12975
 12976     IF CONTROL-IS-ACTUAL-CARRIER
 12977         MOVE PI-CARRIER         TO WS-CARR
 12978     ELSE
 12979         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12980
 12981     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12982     MOVE +0                     TO CNTL-SEQ-NO.
 12983     MOVE 'CARR'                 TO FILE-SWITCH.
 12984
 12985     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12986
 12987     IF EXPENSE-CALC-MANUAL
 12988        GO TO 1600-EDIT-RESERVES.
 12989
 12990     IF DOLLARS-PER-PMT
 12991        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12992        GO TO 1600-EDIT-RESERVES.
 12993
 12994     IF DOLLARS-PER-MONTH AND
 12995        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12996       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12997       GO TO 1600-EDIT-RESERVES.
 12998
 12999     IF PERCENT-OF-PAYMENT
 13000        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 13001
 13002     GO TO 1600-EDIT-RESERVES.
 13003
 13004 1590-EXPENSE-ERROR.
 13005     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13006
 13007     IF EMI-MESSAGE-FORMATTED
 13008        MOVE -1                  TO EEXPENSL
 13009        MOVE AL-UNBON            TO EEXPENSA.
 13010
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 251
* EL156.cbl
 13012 1600-EDIT-RESERVES.
 13013     IF PI-PMTTYPE = '4' OR '5' OR '6'
 13014        IF PI-ERESV = ZEROS
 13015           GO TO 1700-EDIT-EXPENSE-TYPE
 13016        ELSE
 13017           MOVE ER-0525          TO EMI-ERROR
 13018           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 13019           GO TO 1700-EDIT-EXPENSE-TYPE.
 13020
 13021     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13022     MOVE ZEROS                  TO TRLR-SEQ-NO.
 13023     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13024
 13025     IF NOT AT-MANUAL-RESERVES-USED
 13026        IF PI-ERESV NOT = ZEROS
 13027           MOVE ER-0518          TO EMI-ERROR
 13028           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 13029
 13030     IF AT-MANUAL-RESERVES-USED
 13031        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 13032        GO TO 1700-EDIT-EXPENSE-TYPE.
 13033
 13034     IF AT-FUTURE-RESERVES-USED
 13035        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 13036
 13037     IF AT-FUTURE-RESERVES-USED
 13038        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 13039
 13040     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 13041        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 13042
 13043     IF AT-IBNR-RESERVES-USED
 13044        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 13045
 13046     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 13047     GO TO 1700-EDIT-EXPENSE-TYPE.
 13048
 13049 1690-RESERVE-ERROR.
 13050     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13051
 13052     IF EMI-MESSAGE-FORMATTED
 13053        MOVE AL-UNBON            TO ERESVA
 13054        MOVE -1                  TO ERESVL.
 13055
 13056 1690-EXIT.
 13057      EXIT.
 13058
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 252
* EL156.cbl
 13060 1700-EDIT-EXPENSE-TYPE.
 13061     IF PI-PMTTYPE NOT = '5' AND '6'
 13062        GO TO 2000-EDIT-DONE.
 13063
 13064     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 13065                   '6' OR '7' OR '8' OR '9'
 13066        GO TO 2000-EDIT-DONE.
 13067
 13068 1705-EXPENSE-ERROR.
 13069     MOVE ER-0573                TO EMI-ERROR.
 13070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13071
 13072     IF EMI-MESSAGE-FORMATTED
 13073        MOVE AL-UABON            TO ETYPEA
 13074        MOVE -1                  TO ETYPEL.
 13075
 13076     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 253
* EL156.cbl
 13078 1950-NOT-FOUND.
 13079     IF FILE-SWITCH = 'MSTR'
 13080        MOVE ER-0204             TO EMI-ERROR.
 13081
 13082     IF FILE-SWITCH = 'CARR'
 13083        MOVE ER-0252             TO EMI-ERROR.
 13084
 13085     IF FILE-SWITCH = 'COMP'
 13086        MOVE ER-0254             TO EMI-ERROR.
 13087
 13088     IF FILE-SWITCH = 'STAT'
 13089        MOVE ER-0149             TO EMI-ERROR.
 13090
 13091     IF FILE-SWITCH = 'PROC'
 13092        MOVE ER-0019             TO EMI-ERROR.
 13093
 13094     IF FILE-SWITCH = 'ACCT'
 13095        MOVE ER-0198             TO EMI-ERROR.
 13096
 13097     IF FILE-SWITCH = 'BENE'
 13098        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 13099           MOVE ER-0282          TO EMI-ERROR
 13100        ELSE
 13101           MOVE ER-0283          TO EMI-ERROR.
 13102
 13103     MOVE -1                     TO PMTTYPEL.
 13104     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13105
 13106     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 13107                                     WS-FORCE-CTR.
 13108
 13109     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 13110                                     WS-FATAL-CTR.
 13111
 13112     GO TO 8200-SEND-DATAONLY.
 13113
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 254
* EL156.cbl
 13115 2000-EDIT-DONE.
 13116     perform 2210-dcc-max-benes thru 2210-exit
 13117     if pi-company-id not = 'DCC' and 'VPP'
 13118        IF (WS-SPECIAL-CALC-CD = 'C')
 13119           and (cl-critical-period > 0)
 13120           IF CM-AH-BENEFIT-AMT NOT = ZERO
 13121              IF PI-EPYAMT > ZEROS
 13122                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13123                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 13124              ELSE
 13125                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13126                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 13127              END-IF
 13128              if ws-benefits-paid > cl-critical-period
 13129                 MOVE ER-0657          TO EMI-ERROR
 13130                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13131              END-IF
 13132           END-IF
 13133        END-IF
 13134     end-if
 13135     IF PI-HOLDTIL NOT = ZEROS
 13136        MOVE PI-HOLDTIL          TO HOLDTILO
 13137        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'
 13138        MOVE ER-3272          TO EMI-ERROR
 13139        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13140     END-IF
 13141
 13142     IF PI-EPYFROM NOT = ZEROS
 13143        MOVE PI-EPYFROM          TO EPYFROMO
 13144        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 13145
 13146     IF PI-EPYTHRU NOT = ZEROS
 13147        MOVE PI-EPYTHRU            TO EPYTHRUO
 13148        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 13149        IF PI-USES-PAID-TO
 13150           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13151           MOVE '4'                TO DC-OPTION-CODE
 13152           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13153           IF NO-CONVERSION-ERROR
 13154              MOVE +1              TO DC-ELAPSED-DAYS
 13155              MOVE +0              TO DC-ELAPSED-MONTHS
 13156              MOVE '6'             TO DC-OPTION-CODE
 13157              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13158              IF NO-CONVERSION-ERROR
 13159                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13160
 13161     MOVE PI-EDAYS               TO EDAYSO.
 13162
 13163     IF PI-AIGFROM NOT = ZEROS
 13164        MOVE PI-AIGFROM          TO AIGFROMO
 13165        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13166
 13167     MOVE PI-EPYAMT              TO EPYAMTO.
 13168     MOVE PI-ERESV               TO ERESVO.
 13169     MOVE PI-EEXPENS             TO EEXPENSO.
 13170
 13171     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13172     MOVE SPACES                 TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 255
* EL156.cbl
 13173     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13174
 13175     IF DATE-CONVERSION-ERROR
 13176        MOVE SPACES              TO CPYFROMI
 13177     ELSE
 13178        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 13179        IF PI-EPYFROM = ZEROS
 13180           MOVE AL-UANON             TO EPYFROMA
 13181           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 13182           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 13183
 13184     IF PI-USES-PAID-TO
 13185        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 13186        MOVE +1                            TO DC-ELAPSED-DAYS
 13187        MOVE +0                            TO DC-ELAPSED-MONTHS
 13188        MOVE '6'                           TO DC-OPTION-CODE
 13189        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13190        IF NO-CONVERSION-ERROR
 13191           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 13192           IF PI-EPYTHRU = ZEROS
 13193              MOVE AL-UANON                TO EPYTHRUA
 13194              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 13195              MOVE ' '                     TO DC-OPTION-CODE
 13196              MOVE +0                      TO DC-ELAPSED-DAYS
 13197                                              DC-ELAPSED-MONTHS
 13198              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13199              IF NO-CONVERSION-ERROR
 13200                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 13201                  GO TO 2001-CONTINUE
 13202              ELSE
 13203                  GO TO 2001-CONTINUE
 13204           ELSE
 13205              GO TO 2001-CONTINUE.
 13206
 13207     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13208     MOVE SPACES                 TO DC-OPTION-CODE.
 13209     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13210
 13211     IF DATE-CONVERSION-ERROR
 13212        MOVE SPACES              TO CPYTHRUI
 13213     ELSE
 13214        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13215        IF PI-EPYTHRU = ZEROS
 13216           MOVE AL-UANON TO EPYTHRUA
 13217           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13218           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13219
 13220 2001-CONTINUE.
 13221
 13222     MOVE PI-CDAYS               TO CDAYSO.
 13223
 13224     IF PI-EDAYS = ZEROS
 13225        MOVE AL-UNNON TO EDAYSA
 13226        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13227
 13228     MOVE PI-CPYAMT              TO CPYAMTO.
 13229
 13230     IF PI-EPYAMT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 256
* EL156.cbl
 13231        MOVE AL-UNNON            TO EPYAMTA
 13232        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13233
 13234     MOVE PI-CRESV               TO CRESVO.
 13235     MOVE PI-CEXPENS             TO CEXPENSO.
 13236
 13237     IF PI-EEXPENS = ZEROS
 13238        MOVE AL-UNNON TO EEXPENSA
 13239        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13240
 13241     IF (PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL')
 13242        AND (CL-CLAIM-TYPE = 'L')
 13243        AND (PI-OFFLINE NOT EQUAL 'Y')
 13244        IF PI-PMTTYPE = '2' OR '4'
 13245           PERFORM 2200-CALC-INTEREST
 13246                                 THRU 2200-EXIT
 13247        END-IF
 13248     END-IF
 13249     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13250     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13251     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13252
 13253     IF EMI-FATAL-CTR = ZEROS
 13254        MOVE 'B'                 TO PI-PASS-SW.
 13255
 13256     IF NOT EMI-MESSAGE-FORMATTED
 13257         MOVE -1                 TO EPYFROML
 13258     ELSE
 13259         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13260            EMI-ERROR-NUMBER (2) = SPACES
 13261             MOVE -1             TO EPYFROML.
 13262
 13263     GO TO 8200-SEND-DATAONLY.
 13264
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 257
* EL156.cbl
 13266 2200-CALC-INTEREST.
 13267     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13268        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13269        MOVE '4'                 TO DC-OPTION-CODE
 13270        PERFORM 9700-LINK-DATE-CONVERT
 13271        IF DATE-CONVERSION-ERROR
 13272            MOVE LOW-VALUES      TO CP-PRF-DT
 13273        ELSE
 13274           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13275        END-IF
 13276     END-IF
 13277     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13278        if pi-rb-joint-coverage
 13279           move 'Y'              to pi-int-to-rem-borr
 13280        end-if
 13281     end-if
 13282     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13283        IN CLAIM-INT-PASS-AREA
 13284     MOVE CL-CERT-STATE          TO CP-STATE
 13285        IN CLAIM-INT-PASS-AREA
 13286     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13287     MOVE 'LF'                   TO CP-COVERAGE
 13288     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13289     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13290     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13291     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13292     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13293     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13294
 13295* EXEC CICS LINK
 13296*       PROGRAM   ('ELCLMI')
 13297*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13298*       LENGTH    (CP-CLAIM-LENGTH)
 13299*    END-EXEC
 13300     MOVE 'ELCLMI' TO DFHEIV1
 13301*    MOVE '."C                   (   #00012707' TO DFHEIV0
 13302     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13304     MOVE X'2020233030303132373037' TO DFHEIV0(25:11)
 13305     CALL 'kxdfhei1' USING DFHEIV0,
 13306           DFHEIV1,
 13307           CLAIM-INT-PASS-AREA,
 13308           CP-CLAIM-LENGTH,
 13309           DFHEIV99,
 13310           DFHEIV99,
 13311           DFHEIV99,
 13312           DFHEIV99
 13313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13314     MOVE AL-PANOF               TO PINTHA
 13315                                    PINTA
 13316     if cp-clm-int-amt = zeros
 13317        move ' ' to pi-int-to-rem-borr
 13318     end-if
 13319     IF NO-CI-ERROR
 13320        MOVE CP-CLM-INT-AMT      TO PINTO
 13321                                    PI-INT-AMT
 13322        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13323        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 258
* EL156.cbl
 13324        MOVE AL-PANOF            TO PINTHA
 13325                                    PINTA
 13326        if pi-rb-joint-coverage
 13327           and pi-int-amt > zeros
 13328           move '  INT TO'       to itrb1o
 13329           move ' REM BORR?'     to itrb2o
 13330           move pi-int-to-rem-borr
 13331                                 to itrbyno
 13332           move al-uanon         to itrbyna
 13333           move +1               to itrbynl
 13334        else
 13335           move ' '              to pi-int-to-rem-borr
 13336        end-if
 13337     ELSE
 13338        IF CI-RETURN-CODE = '8'
 13339           MOVE ER-3818          TO EMI-ERROR
 13340           MOVE -1               TO ZINTL
 13341           PERFORM 9900-ERROR-FORMAT
 13342                                 THRU 9900-EXIT
 13343           GO TO 2200-EXIT
 13344        ELSE
 13345           MOVE ZEROS            TO PINTO
 13346                                    PI-INT-AMT
 13347                                    PI-INT-DAYS
 13348                                    PI-INT-RATE-USED
 13349        END-IF
 13350     END-IF
 13351     IF PI-INT-AMT NOT = ZEROS
 13352        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13353           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13354           CONTINUE
 13355        ELSE
 13356           MOVE CL-SOC-SEC-NO (1:3)
 13357                                 TO WS-SSN (1:3)
 13358           MOVE CL-SOC-SEC-NO (5:2)
 13359                                 TO WS-SSN (4:2)
 13360           MOVE CL-SOC-SEC-NO (8:4)
 13361                                 TO WS-SSN (6:4)
 13362           IF (WS-SSN NUMERIC)
 13363              AND (WS-SSN NOT = ZEROS)
 13364              CONTINUE
 13365           ELSE
 13366              MOVE ER-2044       TO EMI-ERROR
 13367              PERFORM 9900-ERROR-FORMAT
 13368                                 THRU 9900-EXIT
 13369           END-IF
 13370        END-IF
 13371        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13372        if pi-int-to-rem-borr = 'Y'
 13373           move +61              to trlr-seq-no
 13374        else
 13375           MOVE +51              TO TRLR-SEQ-NO
 13376        end-if
 13377
 13378* EXEC CICS READ
 13379*          DATASET  ('ELTRLR')
 13380*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13381*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 259
* EL156.cbl
 13382*          RESP     (WS-RESPONSE)
 13383*       END-EXEC
 13384     MOVE 'ELTRLR' TO DFHEIV1
 13385*    MOVE '&"S        E          (  N#00012775' TO DFHEIV0
 13386     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13388     MOVE X'204E233030303132373735' TO DFHEIV0(25:11)
 13389     CALL 'kxdfhei1' USING DFHEIV0,
 13390           DFHEIV1,
 13391           DFHEIV20,
 13392           DFHEIV99,
 13393           ELTRLR-KEY,
 13394           DFHEIV99,
 13395           DFHEIV99,
 13396           DFHEIV99
 13397     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13398         DFHEIV20
 13399     MOVE EIBRESP  TO WS-RESPONSE
 13400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13401        IF (NOT WS-RESP-NORMAL)
 13402                    OR
 13403           ((WS-RESP-NORMAL)
 13404           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13405           OR (AT-CITY-STATE = SPACES)))
 13406           MOVE ER-0874          TO EMI-ERROR
 13407           if pi-rb-joint-coverage
 13408              move -1            to itrbynl
 13409           end-if
 13410           PERFORM 9900-ERROR-FORMAT
 13411                                 THRU 9900-EXIT
 13412        else
 13413           move at-mail-to-name  to pi-int-payees-name
 13414        END-IF
 13415     END-IF
 13416     .
 13417 2200-EXIT.
 13418     EXIT.
 13419 2210-dcc-max-benes.
 13420
 13421     move pi-ah-term             to ws-max-bens
 13422     if cl-critical-period not = zeros and spaces
 13423        move cl-critical-period  to ws-max-bens
 13424     end-if
 13425     move cm-ah-benefit-amt      to ws-monthly-benefit
 13426     if pdef-found
 13427        and (pd-max-amt (p1) not = zeros)
 13428        if pd-ben-pct (p1) not numeric
 13429           move zeros            to pd-ben-pct (p1)
 13430        end-if
 13431        if pd-ben-pct (p1) = zeros
 13432           move +1               to ws-work-ben-pct
 13433        else
 13434           move pd-ben-pct (p1)  to ws-work-ben-pct
 13435        end-if
 13436*       compute ws-monthly-benefit =
 13437*          ws-monthly-benefit * ws-work-ben-pct
 13438*       if ws-monthly-benefit > pd-max-amt (p1)
 13439*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 260
* EL156.cbl
 13440*       end-if
 13441     end-if
 13442
 13443     move cl-cert-key-data       to elcrtt-key (2:21)
 13444     move cl-company-cd          to ctrlr-comp-cd
 13445     move cl-cert-no             to ctrlr-cert-no
 13446     move 'B'                    to ctrlr-rec-type
 13447
 13448
 13449* EXEC CICS READ
 13450*       DATASET  ('ELCRTT')
 13451*       set      (address of CERTIFICATE-TRAILERS)
 13452*       RIDFLD   (ELCRTT-KEY)
 13453*       RESP     (WS-RESPONSE)
 13454*    END-EXEC
 13455     MOVE 'ELCRTT' TO DFHEIV1
 13456*    MOVE '&"S        E          (  N#00012828' TO DFHEIV0
 13457     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13459     MOVE X'204E233030303132383238' TO DFHEIV0(25:11)
 13460     CALL 'kxdfhei1' USING DFHEIV0,
 13461           DFHEIV1,
 13462           DFHEIV20,
 13463           DFHEIV99,
 13464           ELCRTT-KEY,
 13465           DFHEIV99,
 13466           DFHEIV99,
 13467           DFHEIV99
 13468     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13469         DFHEIV20
 13470     MOVE EIBRESP  TO WS-RESPONSE
 13471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13472     IF not WS-RESP-NORMAL
 13473        go to 2210-exit
 13474     end-if
 13475
 13476*    if instypei = 'P'
 13477*       move +1 to s1
 13478*    else
 13479*       MOVE +2 to s1
 13480*    end-if
 13481
 13482*    move +1 to s1
 13483*    evaluate cl-claim-type
 13484*       when 'A'
 13485*          move +1 to s2
 13486*       when 'I'
 13487*          move +2 to s2
 13488*       when 'G'
 13489*          move +3 to s2
 13490*       when 'L'
 13491*          move +4 to s2
 13492*       when 'P'
 13493*          move +5 to s2
 13494*    end-evaluate
 13495
 13496     move zeros                  to ws-prev-days-paid
 13497                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 261
* EL156.cbl
 13498                                    ws-prev-amt-paid
 13499     perform varying s1 from +1 by +1 until
 13500        (s1 > +24)
 13501        or (cs-claim-type (s1) = spaces)
 13502        if pi-company-id not = 'DCC' and 'VPP'
 13503           if cs-claim-type (s1) = cl-claim-type
 13504              compute ws-prev-days-paid =
 13505                 ws-prev-days-paid + cs-days-paid (s1)
 13506              compute ws-prev-amt-paid =
 13507                 ws-prev-amt-paid + cs-total-paid (s1)
 13508           end-if
 13509        else
 13510           if (cs-claim-type (s1) = cl-claim-type)
 13511              and (cs-benefit-period (s1) = cl-benefit-period)
 13512              and (cs-insured-type (s1) = cl-insured-type)
 13513              compute ws-prev-days-paid =
 13514                 ws-prev-days-paid + cs-days-paid (s1)
 13515              compute ws-prev-amt-paid =
 13516                 ws-prev-amt-paid + cs-total-paid (s1)
 13517           end-if
 13518        end-if
 13519     end-perform
 13520     if pi-epyamt > zeros
 13521        compute ws-benefits-paid =
 13522           (ws-prev-amt-paid + pi-epyamt)
 13523           / ws-monthly-benefit
 13524     else
 13525        compute ws-benefits-paid =
 13526           (ws-prev-amt-paid + pi-cpyamt)
 13527           / ws-monthly-benefit
 13528     end-if
 13529*    if pi-company-id = 'DCC'
 13530     if cl-claim-type not = 'L' and 'O' and 'P'
 13531        if ws-benefits-paid > ws-max-bens
 13532           move er-1658          to emi-error
 13533           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13534        end-if
 13535     end-if
 13536*    end-if
 13537*     if s1 < +25
 13538*        if pi-epyamt > zeros
 13539*           compute ws-benefits-paid =
 13540*              (cs-total-paid (s1) + PI-EPYAMT)
 13541*              / ws-monthly-benefit
 13542*        else
 13543*           compute ws-benefits-paid =
 13544*              (cs-total-paid (s1) + PI-CPYAMT)
 13545*              / ws-monthly-benefit
 13546*        end-if
 13547
 13548*       if ws-benefits-paid > pd-crit-period (p1)
 13549*        if ws-benefits-paid > ws-max-bens
 13550*           move er-1658          to emi-error
 13551*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13552*        end-if
 13553*     end-if
 13554     .
 13555 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 262
* EL156.cbl
 13556     exit.
 13557
 13558 2220-update-elcrtt.
 13559
 13560
 13561* EXEC CICS GETMAIN
 13562*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13563*       LENGTH   (ELCRTT-LENGTH)
 13564*       INITIMG  (GETMAIN-SPACE)
 13565*    END-EXEC
 13566*    MOVE ',"IL                  $   #00012922' TO DFHEIV0
 13567     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13568     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13569     MOVE X'2020233030303132393232' TO DFHEIV0(25:11)
 13570     CALL 'kxdfhei1' USING DFHEIV0,
 13571           DFHEIV20,
 13572           ELCRTT-LENGTH,
 13573           GETMAIN-SPACE
 13574     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13575         DFHEIV20
 13576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13577
 13578     move cl-cert-key-data       to elcrtt-key (2:21)
 13579     move cl-company-cd          to ctrlr-comp-cd
 13580     move cl-cert-no             to ctrlr-cert-no
 13581     move 'B'                    to ctrlr-rec-type
 13582
 13583
 13584* EXEC CICS READ
 13585*       UPDATE
 13586*       DATASET  (ELCRTT-DSID)
 13587*       into     (CERTIFICATE-TRAILERS)
 13588*       RIDFLD   (ELCRTT-KEY)
 13589*       RESP     (WS-RESPONSE)
 13590*    END-EXEC
 13591     MOVE LENGTH OF
 13592      CERTIFICATE-TRAILERS
 13593       TO DFHEIV11
 13594*    MOVE '&"IL       EU         (  N#00012933' TO DFHEIV0
 13595     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13596     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13597     MOVE X'204E233030303132393333' TO DFHEIV0(25:11)
 13598     CALL 'kxdfhei1' USING DFHEIV0,
 13599           ELCRTT-DSID,
 13600           CERTIFICATE-TRAILERS,
 13601           DFHEIV11,
 13602           ELCRTT-KEY,
 13603           DFHEIV99,
 13604           DFHEIV99,
 13605           DFHEIV99
 13606     MOVE EIBRESP  TO WS-RESPONSE
 13607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13608
 13609     IF WS-RESP-NORMAL
 13610        perform 2225-upd-crt-trlr thru 2225-exit
 13611
 13612* EXEC CICS REWRITE
 13613*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 263
* EL156.cbl
 13614*          from     (CERTIFICATE-TRAILERS)
 13615*          RESP     (WS-RESPONSE)
 13616*       END-EXEC
 13617     MOVE LENGTH OF
 13618      CERTIFICATE-TRAILERS
 13619       TO DFHEIV11
 13620*    MOVE '&& L                  %  N#00012943' TO DFHEIV0
 13621     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13622     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13623     MOVE X'204E233030303132393433' TO DFHEIV0(25:11)
 13624     CALL 'kxdfhei1' USING DFHEIV0,
 13625           ELCRTT-DSID,
 13626           CERTIFICATE-TRAILERS,
 13627           DFHEIV11,
 13628           DFHEIV99
 13629     MOVE EIBRESP  TO WS-RESPONSE
 13630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13631     else
 13632        if ws-resp-notfnd
 13633           move 'CS'             to certificate-trailers
 13634           move cl-company-cd    to cs-company-cd
 13635           move cl-cert-key-data to cs-control-primary (2:21)
 13636           move cl-cert-no       to cs-cert-no
 13637           move 'B'              to cs-trailer-type
 13638           perform varying s1 from +1 by +1 until s1 > +24
 13639              move zeros         to cs-benefit-period (s1)
 13640                                    cs-days-paid (s1)
 13641                                    cs-total-paid (s1)
 13642                                    cs-remaining-bens (s1)
 13643           end-perform
 13644           perform 2225-upd-crt-trlr
 13645                                 thru 2225-exit
 13646
 13647* EXEC CICS WRITE
 13648*             DATASET  (ELCRTT-DSID)
 13649*             from     (CERTIFICATE-TRAILERS)
 13650*             RIDFLD   (cs-control-primary)
 13651*             RESP     (WS-RESPONSE)
 13652*          END-EXEC
 13653     MOVE LENGTH OF
 13654      CERTIFICATE-TRAILERS
 13655       TO DFHEIV11
 13656*    MOVE '&$ L                  ''  N#00012963' TO DFHEIV0
 13657     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13658     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13659     MOVE X'204E233030303132393633' TO DFHEIV0(25:11)
 13660     CALL 'kxdfhei1' USING DFHEIV0,
 13661           ELCRTT-DSID,
 13662           CERTIFICATE-TRAILERS,
 13663           DFHEIV11,
 13664           cs-control-primary,
 13665           DFHEIV99,
 13666           DFHEIV99
 13667     MOVE EIBRESP  TO WS-RESPONSE
 13668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13669        end-if
 13670     END-IF
 13671
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 264
* EL156.cbl
 13672     .
 13673 2220-exit.
 13674     exit.
 13675
 13676 2225-upd-crt-trlr.
 13677
 13678*    if instypei = 'P'
 13679*       move +1 to s1
 13680*    else
 13681*       MOVE +2 to s1
 13682*    end-if
 13683
 13684*    move +1 to s1
 13685*    evaluate cl-claim-type
 13686*       when 'A'
 13687*          move +1 to s2
 13688*       when 'I'
 13689*          move +2 to s2
 13690*       when 'G'
 13691*          move +3 to s2
 13692*       when 'L'
 13693*          move +4 to s2
 13694*       when 'P'
 13695*          move +5 to s2
 13696*    end-evaluate
 13697     perform varying s1 from +1 by +1 until
 13698        (s1 > +24)
 13699        or (cl-claim-no = cs-claim-no (s1))
 13700     end-perform
 13701     if s1 < +25
 13702        compute cs-total-paid (s1) =
 13703           cs-total-paid (s1) + at-amount-paid
 13704        compute cs-days-paid (s1) =
 13705           cs-days-paid (s1) +  at-days-in-period
 13706*       compute cs-remaining-bens (s1) =
 13707*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13708        perform 2230-accum-bens-paid thru 2230-exit
 13709     end-if
 13710
 13711     .
 13712 2225-exit.
 13713     exit.
 13714 2230-accum-bens-paid.
 13715     if cl-claim-type not = 'L' and 'O' and 'P'
 13716        move pi-ah-term          to ws-max-bens
 13717        if cl-critical-period not = zeros and spaces
 13718           move cl-critical-period
 13719                                 to ws-max-bens
 13720        end-if
 13721     else
 13722        move 01                  to ws-max-bens
 13723     end-if
 13724     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13725     perform varying s2 from +1 by +1 until
 13726        (s2 > +24)
 13727        or (cs-claim-no (s2) = spaces)
 13728        if pi-company-id not = 'DCC' and 'VPP'
 13729           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 265
* EL156.cbl
 13730              compute ws-tot-days-paid =
 13731                 ws-tot-days-paid + cs-days-paid (s2)
 13732              compute ws-tot-amt-paid =
 13733                 ws-tot-amt-paid + cs-total-paid (s2)
 13734           end-if
 13735        else
 13736           if (cs-benefit-period (s2) = cl-benefit-period)
 13737              and (cs-claim-type (s2) = cl-claim-type)
 13738              and (cs-insured-type (s2) = cl-insured-type)
 13739              compute ws-tot-days-paid =
 13740                 ws-tot-days-paid + cs-days-paid (s2)
 13741              compute ws-tot-amt-paid =
 13742                 ws-tot-amt-paid + cs-total-paid (s2)
 13743           end-if
 13744        end-if
 13745     end-perform
 13746     if cl-claim-type = 'L' or 'P' or 'O'
 13747        if ws-tot-amt-paid > zeros
 13748           move zeros            to cs-remaining-bens (s1)
 13749        else
 13750           move 01               to cs-remaining-bens (s1)
 13751        end-if
 13752     else
 13753        compute ws-pd-bens rounded =
 13754           ws-tot-amt-paid / pi-ah-benefit-amt
 13755        compute cs-remaining-bens (s1) =
 13756           ws-max-bens - ws-pd-bens
 13757        if cs-remaining-bens (s1) < zeros
 13758           move zeros            to cs-remaining-bens (s1)
 13759        end-if
 13760     end-if
 13761     .
 13762 2230-exit.
 13763     exit.
 13764 3000-MOVE-INPUT-TO-SAVE-AREA.
 13765     IF PMTTYPEL > 0
 13766         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13767
 13768     if ws-pmttype = '4'
 13769        if pi-rb-joint-coverage
 13770           if payeel = +0
 13771              move +2            to payeel
 13772              move al-uanon      to payeea
 13773              move 'Q1'          to payeeo
 13774           else
 13775              if payeei not = 'Q1' and 'q1'
 13776                 move er-1582    to emi-error
 13777                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13778              end-if
 13779           end-if
 13780        end-if
 13781     end-if
 13782     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13783
 13784     IF WS-PMTTYPE = '9'
 13785         MOVE 'P'                TO PI-PROVISIONAL-IND
 13786         MOVE '1'                TO WS-PMTTYPE.
 13787
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 266
* EL156.cbl
 13788     IF PAYEEL > 0
 13789         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13790         MOVE PAYEEI             TO WS-PAYEE.
 13791
 13792     IF NOTE1L > +0
 13793         MOVE NOTE1I             TO WS-PMTNOTE1
 13794                                    WS-FLI-PMTNOTE
 13795                                    WS-HAN-PMTNOTE.
 13796
 13797     IF NOTE2L > +0
 13798         MOVE NOTE2I             TO WS-PMTNOTE2.
 13799
 13800     IF OFFLINEL > 0
 13801         MOVE OFFLINEI           TO WS-OFFLINE.
 13802
 13803     IF PROOFDTL > 0
 13804         MOVE PROOFDTI            TO DATE-WORK
 13805         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13806         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13807         MOVE '4'                 TO DC-OPTION-CODE
 13808         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13809         IF NO-CONVERSION-ERROR
 13810            MOVE NUM-WORK         TO PROOFDTO
 13811            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13812            MOVE NUM-WORK         TO WS-PROOF-DATE
 13813         ELSE
 13814            MOVE ZEROS            TO WS-PROOF-DATE
 13815         END-IF
 13816     END-IF.
 13817
 13818     IF EOBYNL > +0
 13819         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13820         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13821     END-IF
 13822
 13823     IF CLMFMYNL > +0
 13824         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13825         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13826     END-IF
 13827
 13828     IF SURVYYNL > +0
 13829         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13830         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13831     END-IF
 13832
 13833     IF SPRELYNL > +0
 13834         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13835         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13836     END-IF
 13837     if itrbynl <> +0
 13838        move function upper-case(itrbyni) to itrbyni
 13839        move itrbyni             to ws-int-to-rem-borr
 13840     end-if
 13841*    IF GROUPEDL > +0
 13842*        MOVE GROUPEDI           TO WS-GROUPED.
 13843*
 13844*    IF CASHL > +0
 13845*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 267
* EL156.cbl
 13846     IF LOANNOL > +0
 13847         MOVE LOANNOI            TO WS-LOAN-NO.
 13848
 13849     IF CHECKNOL > 0
 13850         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13851
 13852     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13853         IF WS-AIG-CREDIT-ENTERED
 13854             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13855             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13856             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13857             MOVE AL-UANON         TO CHECKNOA.
 13858
 13859     IF HOLDTILL > 0
 13860         MOVE HOLDTILI           TO DATE-WORK
 13861         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13862         MOVE NUM-WORK           TO WS-HOLDTIL.
 13863
 13864     IF ZINTL > +0
 13865
 13866* EXEC CICS BIF DEEDIT
 13867*           FIELD   (ZINTI)
 13868*           LENGTH  (07)
 13869*       END-EXEC
 13870     MOVE 07
 13871       TO DFHEIV11
 13872*    MOVE '@"L                   #   #00013165' TO DFHEIV0
 13873     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13874     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13875     MOVE X'2020233030303133313635' TO DFHEIV0(25:11)
 13876     CALL 'kxdfhei1' USING DFHEIV0,
 13877           ZINTI,
 13878           DFHEIV11
 13879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13880        IF ZINTI NOT NUMERIC
 13881           MOVE ER-0419          TO EMI-ERROR
 13882           PERFORM 9900-ERROR-FORMAT
 13883           MOVE AL-UABON         TO ZINTA
 13884           MOVE -1               TO ZINTL
 13885        ELSE
 13886           MOVE ZINTI            TO CP-INT-RATE
 13887                                    WS-INT-RATE
 13888           MOVE CP-INT-RATE      TO ZINTO
 13889           MOVE AL-UNNON         TO ZINTA
 13890        END-IF
 13891     ELSE
 13892        MOVE ZEROS               TO CP-INT-RATE
 13893     END-IF
 13894     IF EPYFROML > 0
 13895         MOVE EPYFROMI           TO DATE-WORK
 13896         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13897         MOVE NUM-WORK           TO WS-EPYFROM.
 13898
 13899     IF AIGFROML > 0
 13900         MOVE AIGFROMI           TO DATE-WORK
 13901         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13902         MOVE NUM-WORK           TO WS-AIGFROM
 13903     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 268
* EL156.cbl
 13904         IF (AIGFROMI = LOW-VALUES) AND
 13905            (PI-AIGFROM NOT = ZEROS)
 13906              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13907
 13908     IF EPYTHRUL > +0
 13909        MOVE EPYTHRUI           TO DATE-WORK
 13910        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13911        MOVE NUM-WORK           TO WS-EPYTHRU
 13912        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13913        MOVE '4'                TO DC-OPTION-CODE
 13914        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13915        IF NO-CONVERSION-ERROR
 13916           IF PI-USES-PAID-TO
 13917              MOVE '6'                TO DC-OPTION-CODE
 13918              MOVE -1                 TO DC-ELAPSED-DAYS
 13919              MOVE +0                 TO DC-ELAPSED-MONTHS
 13920              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13921              IF NO-CONVERSION-ERROR
 13922                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13923                 MOVE ' '             TO DC-OPTION-CODE
 13924                 MOVE +0              TO DC-ELAPSED-DAYS
 13925                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13926              IF NO-CONVERSION-ERROR
 13927                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13928
 13929*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13930*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13931     IF EDAYSL > 0
 13932
 13933* EXEC CICS BIF DEEDIT
 13934*            FIELD(EDAYSI)
 13935*            LENGTH(6)
 13936*        END-EXEC
 13937     MOVE 6
 13938       TO DFHEIV11
 13939*    MOVE '@"L                   #   #00013221' TO DFHEIV0
 13940     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13941     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13942     MOVE X'2020233030303133323231' TO DFHEIV0(25:11)
 13943     CALL 'kxdfhei1' USING DFHEIV0,
 13944           EDAYSI,
 13945           DFHEIV11
 13946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13947         MOVE EDAYSI             TO WS-DY-WORK
 13948         IF WS-DY-SIGN = SPACES
 13949            MOVE WS-DY-NUM       TO WS-EDAYS
 13950            ADD 0                TO WS-EDAYS
 13951         ELSE
 13952            MOVE EDAYSI          TO WS-EDAYS
 13953            ADD 0                TO WS-EDAYS.
 13954
 13955*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13956*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13957     IF EPYAMTL > 0
 13958
 13959* EXEC CICS BIF DEEDIT
 13960*            FIELD(EPYAMTI)
 13961*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 269
* EL156.cbl
 13962*        END-EXEC
 13963     MOVE 10
 13964       TO DFHEIV11
 13965*    MOVE '@"L                   #   #00013236' TO DFHEIV0
 13966     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13967     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13968     MOVE X'2020233030303133323336' TO DFHEIV0(25:11)
 13969     CALL 'kxdfhei1' USING DFHEIV0,
 13970           EPYAMTI,
 13971           DFHEIV11
 13972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13973         MOVE EPYAMTI            TO WS-PY-WORK
 13974         IF WS-PY-SIGN = SPACES
 13975            MOVE WS-PY-NUM       TO WS-EPYAMT
 13976            ADD 0                TO WS-EPYAMT
 13977         ELSE
 13978            MOVE EPYAMTI         TO WS-EPYAMT
 13979            ADD 0                TO WS-EPYAMT.
 13980
 13981     IF ERESVL > 0
 13982
 13983* EXEC CICS BIF DEEDIT
 13984*            FIELD(ERESVI)
 13985*            LENGTH(9)
 13986*        END-EXEC
 13987     MOVE 9
 13988       TO DFHEIV11
 13989*    MOVE '@"L                   #   #00013249' TO DFHEIV0
 13990     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13991     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13992     MOVE X'2020233030303133323439' TO DFHEIV0(25:11)
 13993     CALL 'kxdfhei1' USING DFHEIV0,
 13994           ERESVI,
 13995           DFHEIV11
 13996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13997         MOVE ERESVI TO WS-ERESV.
 13998
 13999     IF EEXPENSL > 0
 14000
 14001* EXEC CICS BIF DEEDIT
 14002*            FIELD(EEXPENSI)
 14003*            LENGTH(8)
 14004*        END-EXEC
 14005     MOVE 8
 14006       TO DFHEIV11
 14007*    MOVE '@"L                   #   #00013256' TO DFHEIV0
 14008     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14009     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14010     MOVE X'2020233030303133323536' TO DFHEIV0(25:11)
 14011     CALL 'kxdfhei1' USING DFHEIV0,
 14012           EEXPENSI,
 14013           DFHEIV11
 14014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14015         MOVE EEXPENSI           TO WS-EEXPENS.
 14016
 14017     IF ETYPEL > ZEROS
 14018         MOVE ETYPEI             TO WS-ETYPE.
 14019
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 270
* EL156.cbl
 14020     IF PI-COMPANY-ID = 'BOA'
 14021        IF PINTL > ZEROS
 14022
 14023* EXEC CICS BIF DEEDIT
 14024*            FIELD (PINTI)
 14025*            LENGTH(05)
 14026*          END-EXEC
 14027     MOVE 05
 14028       TO DFHEIV11
 14029*    MOVE '@"L                   #   #00013267' TO DFHEIV0
 14030     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14031     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14032     MOVE X'2020233030303133323637' TO DFHEIV0(25:11)
 14033     CALL 'kxdfhei1' USING DFHEIV0,
 14034           PINTI,
 14035           DFHEIV11
 14036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14037           IF PINTI NUMERIC
 14038               MOVE AL-UNNON     TO PINTA
 14039               MOVE PINTI        TO WS-INT-RATE
 14040               MOVE WS-INT-RATE  TO PINTO.
 14041
 14042 3000-EXIT.
 14043     EXIT.
 14044
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 271
* EL156.cbl
 14046 3050-REBUILD-ENTERED.
 14047
 14048     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 14049
 14050     IF PI-PROV-PMT
 14051         MOVE '9'           TO PMTTYPEO
 14052     ELSE
 14053         MOVE PI-PMTTYPE    TO PMTTYPEO.
 14054
 14055     MOVE PI-PAYEE          TO PAYEEO.
 14056     MOVE PI-PMTNOTE1       TO NOTE1O.
 14057     MOVE PI-PMTNOTE2       TO NOTE2O.
 14058     MOVE PI-OFFLINE        TO OFFLINEO.
 14059     IF PI-PROOF-DATE NOT = ZEROS
 14060         MOVE PI-PROOF-DATE TO PROOFDTO
 14061         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 14062     END-IF.
 14063*    MOVE PI-GROUPED        TO GROUPEDO.
 14064
 14065*    MOVE PI-CASH           TO CASHO.
 14066
 14067     IF PI-INT-RATE > ZEROS
 14068        MOVE PI-INT-RATE         TO PINTO
 14069     end-if
 14070     IF PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL'
 14071        IF PI-INT-AMT > ZEROS
 14072           MOVE PI-INT-AMT       TO PINTO
 14073           MOVE AL-PANOF         TO PINTA
 14074                                    PINTHA
 14075           if pi-rb-joint-coverage
 14076              move '  INT TO'    to itrb1o
 14077              move ' REM BORR?'  to itrb2o
 14078              move 'Y'           to itrbyno
 14079              move al-uanon      to itrbyna
 14080              move +1            to itrbynl
 14081           end-if
 14082        END-IF
 14083     END-IF
 14084     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 14085     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 14086     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 14087     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 14088     IF PI-HOLDTIL NOT = ZEROS
 14089        MOVE PI-HOLDTIL          TO HOLDTILO
 14090        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 14091
 14092     IF PI-EPYFROM NOT = ZEROS
 14093        MOVE PI-EPYFROM          TO EPYFROMO
 14094        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 14095
 14096     IF PI-AIGFROM NOT = ZEROS
 14097        MOVE PI-AIGFROM          TO AIGFROMO
 14098        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 14099
 14100     IF PI-EPYTHRU NOT = ZEROS
 14101        MOVE PI-EPYTHRU          TO EPYTHRUO
 14102        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 14103        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 272
* EL156.cbl
 14104           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 14105           MOVE '4'                TO DC-OPTION-CODE
 14106           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14107           IF NO-CONVERSION-ERROR
 14108              MOVE +1 TO DC-ELAPSED-DAYS
 14109              MOVE +0 TO DC-ELAPSED-MONTHS
 14110              MOVE '6' TO DC-OPTION-CODE
 14111              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14112              IF NO-CONVERSION-ERROR
 14113                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 14114
 14115     IF PI-EDAYS NOT = ZEROS
 14116        MOVE PI-EDAYS TO EDAYSO.
 14117
 14118     IF PI-EPYAMT NOT = ZEROS
 14119        MOVE PI-EPYAMT TO EPYAMTO.
 14120
 14121     IF PI-ERESV NOT = ZEROS
 14122        MOVE PI-ERESV TO ERESVO.
 14123
 14124     IF PI-EEXPENS NOT = ZEROS
 14125        MOVE PI-EEXPENS TO EEXPENSO.
 14126
 14127     MOVE PI-ETYPE TO ETYPEO.
 14128
 14129     IF PI-ECHECKNO NOT = SPACES
 14130        MOVE PI-ECHECKNO         TO CHECKNOO
 14131     ELSE
 14132        MOVE PI-CCHECKNO         TO CHECKNOO.
 14133
 14134     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 14135     MOVE SPACES                 TO DC-OPTION-CODE.
 14136     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14137
 14138     IF DATE-CONVERSION-ERROR
 14139        MOVE SPACES              TO CPYFROMI
 14140     ELSE
 14141        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 14142
 14143     IF PI-USES-PAID-TO
 14144        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 14145        MOVE +1                  TO DC-ELAPSED-DAYS
 14146        MOVE +0                  TO DC-ELAPSED-MONTHS
 14147        MOVE '6'                 TO DC-OPTION-CODE
 14148        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14149        IF NO-CONVERSION-ERROR
 14150           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 14151           GO TO 3051-CONTINUE.
 14152
 14153     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 14154     MOVE SPACES                 TO DC-OPTION-CODE.
 14155     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14156
 14157     IF DATE-CONVERSION-ERROR
 14158        MOVE SPACES              TO CPYTHRUI
 14159     ELSE
 14160        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 14161
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 273
* EL156.cbl
 14162 3051-CONTINUE.
 14163
 14164     IF PI-CDAYS NOT = ZEROS
 14165        MOVE PI-CDAYS TO CDAYSO.
 14166
 14167     IF PI-CPYAMT NOT = ZEROS
 14168        MOVE PI-CPYAMT TO CPYAMTO.
 14169
 14170     IF PI-CRESV NOT = ZEROS
 14171        MOVE PI-CRESV TO CRESVO.
 14172
 14173     IF PI-CEXPENS NOT = ZEROS
 14174        MOVE PI-CEXPENS TO CEXPENSO.
 14175
 14176 3059-EXIT.
 14177     EXIT.
 14178
 14179 3100-DEEDIT-DATE.
 14180
 14181* EXEC CICS BIF DEEDIT
 14182*        FIELD(DATE-WORK)
 14183*        LENGTH(8)
 14184*    END-EXEC.
 14185     MOVE 8
 14186       TO DFHEIV11
 14187*    MOVE '@"L                   #   #00013414' TO DFHEIV0
 14188     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14189     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14190     MOVE X'2020233030303133343134' TO DFHEIV0(25:11)
 14191     CALL 'kxdfhei1' USING DFHEIV0,
 14192           DATE-WORK,
 14193           DFHEIV11
 14194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14195
 14196
 14197 3100-EXIT.
 14198     EXIT.
 14199
 14200 3200-CALC-AIG-DAYS.
 14201
 14202     MOVE 'N'                    TO WS-DUE-DAY-SW.
 14203
 14204     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14205     MOVE ' '                    TO DC-OPTION-CODE.
 14206     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14207     IF NO-CONVERSION-ERROR
 14208         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14209     ELSE
 14210         GO TO 3290-ERROR.
 14211
 14212     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14213         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14214                                WS-BIN-FROM-DT
 14215     ELSE
 14216         IF CL-TOTAL-PAID-AMT > ZEROS
 14217             IF WS-SV-EPYFROM = LOW-VALUES
 14218                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14219                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 274
* EL156.cbl
 14220             ELSE
 14221                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14222                                        WS-BIN-FROM-DT
 14223         ELSE
 14224             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14225                                        WS-BIN-FROM-DT.
 14226
 14227 3210-CONTINUE.
 14228
 14229     MOVE ' '                    TO DC-OPTION-CODE.
 14230     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14231     IF DATE-CONVERSION-ERROR
 14232         GO TO 3290-ERROR.
 14233
 14234     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14235
 14236     IF PI-LOAN-DUE-DAY = 31
 14237         MOVE 30              TO WS-PMT-DUE-DA
 14238                                 WS-SAVE-DUE-DA
 14239     ELSE
 14240         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14241                                 WS-SAVE-DUE-DA.
 14242
 14243     IF (PI-LOAN-DUE-DAY > 28) AND
 14244        (WS-PMT-DUE-MO = 2)
 14245         MOVE 'Y'                TO WS-DUE-DAY-SW
 14246         MOVE 28                 TO WS-PMT-DUE-DA.
 14247
 14248     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14249     MOVE '4'                    TO DC-OPTION-CODE.
 14250     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14251     IF NO-CONVERSION-ERROR
 14252         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14253     ELSE
 14254         GO TO 3290-ERROR.
 14255
 14256*--------------------------------------------------------------*
 14257*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14258*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14259*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14260*                                                              *
 14261*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14262*             INCURRED DATE      - 04/15/91                    *
 14263*             PMT DUE DATE       - 04/03/91                    *
 14264*             PMT DUE DATE       - 05/03/91                    *
 14265*--------------------------------------------------------------*
 14266
 14267     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14268        (WS-SV-AIGFROM = LOW-VALUES)
 14269         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14270            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14271             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14272             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14273             IF NO-CONVERSION-ERROR
 14274                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14275                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14276             ELSE
 14277                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 275
* EL156.cbl
 14278
 14279     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14280        (WS-SV-AIGFROM = LOW-VALUES)
 14281         GO TO 3205-CONT-CALC-PMT.
 14282
 14283     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14284     MOVE ' '                    TO DC-OPTION-CODE.
 14285     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14286     IF NO-CONVERSION-ERROR
 14287         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14288     ELSE
 14289         GO TO 3290-ERROR.
 14290
 14291     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14292        (WS-PMT-DUE-DA < WS-FROM-DA)
 14293          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14294          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14295          IF NO-CONVERSION-ERROR
 14296              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14297              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14298          ELSE
 14299              GO TO 3290-ERROR.
 14300
 14301 3205-CONT-CALC-PMT.
 14302
 14303*--------------------------------------------------------------*
 14304*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14305*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14306*--------------------------------------------------------------*
 14307
 14308     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14309        PI-PMTTYPE = '2'
 14310          NEXT SENTENCE
 14311     ELSE
 14312        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14313           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14314             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14315             MOVE ER-3527            TO EMI-ERROR
 14316             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14317             MOVE -1                 TO EPYTHRUL
 14318             MOVE AL-UNBON           TO EPYTHRUA
 14319                                        EPYFROMA
 14320             GO TO 3299-EXIT.
 14321
 14322*--------------------------------------------------------------*
 14323*    CALCULATE RETRO ELIMINATION DATE                          *
 14324*--------------------------------------------------------------*
 14325
 14326     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14327         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14328     ELSE
 14329         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14330
 14331     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14332     MOVE +0             TO DC-ELAPSED-MONTHS.
 14333     MOVE '6'            TO DC-OPTION-CODE.
 14334     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14335     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 276
* EL156.cbl
 14336         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14337     ELSE
 14338         GO TO 3290-ERROR.
 14339
 14340 3210-CHECK-PMT-DATE.
 14341
 14342*--------------------------------------------------------------*
 14343*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14344*    THE ENTERED PAY FROM DATE                                 *
 14345*--------------------------------------------------------------*
 14346
 14347     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14348         NEXT SENTENCE
 14349     ELSE
 14350         GO TO 3220-COMPUTE-DAYS.
 14351
 14352     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14353     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14354     IF NO-CONVERSION-ERROR
 14355         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14356         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14357         GO TO 3210-CHECK-PMT-DATE
 14358     ELSE
 14359         GO TO 3290-ERROR.
 14360
 14361 3220-COMPUTE-DAYS.
 14362
 14363     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14364     MOVE ZEROS         TO WS-CDAYS.
 14365     MOVE 'N'           TO WS-ELIMINATION-SW.
 14366
 14367*--------------------------------------------------------------*
 14368*    COMPUTE CALIFORNIA DUE DAYS                               *
 14369*--------------------------------------------------------------*
 14370
 14371     IF CL-TOTAL-PAID-AMT > ZEROS
 14372         MOVE 'Y' TO WS-ELIMINATION-SW
 14373         GO TO 3240-FIRST-PMT-DUE
 14374     ELSE
 14375        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14376            NEXT SENTENCE
 14377        ELSE
 14378            GO TO 3240-FIRST-PMT-DUE.
 14379
 14380 3230-NEXT-PMT-DUE.
 14381
 14382     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14383     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14384     IF NO-CONVERSION-ERROR
 14385         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14386         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14387     ELSE
 14388         GO TO 3290-ERROR.
 14389
 14390 3240-FIRST-PMT-DUE.
 14391
 14392     IF CL-TOTAL-PAID-AMT > ZEROS
 14393         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 277
* EL156.cbl
 14394     ELSE
 14395        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14396            GO TO 3230-NEXT-PMT-DUE.
 14397
 14398     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14399         GO TO 3250-VERIFY-ELIMINATION.
 14400
 14401     ADD +30 TO WS-CDAYS.
 14402     MOVE 'Y' TO WS-ELIMINATION-SW.
 14403     GO TO 3230-NEXT-PMT-DUE.
 14404
 14405 3250-VERIFY-ELIMINATION.
 14406
 14407     IF ELIM-SATISFIED
 14408         GO TO 3260-END-CALC.
 14409
 14410     IF PI-PMTTYPE = '1'
 14411         MOVE ZEROS TO WS-CDAYS
 14412         GO TO 3260-END-CALC.
 14413
 14414     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14415         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14416     ELSE
 14417         IF CL-TOTAL-PAID-AMT > ZEROS
 14418             IF WS-SV-EPYFROM = LOW-VALUES
 14419                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14420             ELSE
 14421                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14422         ELSE
 14423             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14424
 14425     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14426     MOVE '1'                    TO DC-OPTION-CODE.
 14427     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14428     IF NO-CONVERSION-ERROR
 14429         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14430     ELSE
 14431         GO TO 3290-ERROR.
 14432
 14433     IF CL-TOTAL-PAID-AMT > ZEROS
 14434         MOVE WS-DAYS-OFF TO WS-CDAYS
 14435     ELSE
 14436         IF PI-BEN-DAYS > WS-DAYS-OFF
 14437             MOVE ZEROS TO WS-CDAYS
 14438         ELSE
 14439             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14440
 14441 3260-END-CALC.
 14442
 14443     MOVE WS-CDAYS TO PI-CDAYS.
 14444
 14445     IF PI-EDAYS = ZEROS
 14446         MOVE PI-CDAYS TO PI-EDAYS
 14447         MOVE AL-UNNON TO EDAYSA.
 14448
 14449     GO TO 3299-EXIT.
 14450
 14451 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 278
* EL156.cbl
 14452
 14453     MOVE ER-3528            TO EMI-ERROR.
 14454     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14455     MOVE -1                 TO CDAYSL.
 14456     MOVE AL-UNBON           TO CDAYSA.
 14457
 14458 3299-EXIT.
 14459     EXIT.
 14460
 14461 3300-BUMP-DATE.
 14462
 14463     IF WS-RESTORE-DUE-DAY
 14464         MOVE 'N'              TO WS-DUE-DAY-SW
 14465         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14466         ADD 1                 TO WS-PMT-DUE-MO
 14467         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14468         MOVE '4'              TO DC-OPTION-CODE
 14469         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14470         IF NO-CONVERSION-ERROR
 14471             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14472             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14473             GO TO 3399-EXIT
 14474         ELSE
 14475             MOVE '9'          TO DC-ERROR-CODE
 14476             GO TO 3399-EXIT.
 14477
 14478     IF (WS-PMT-DUE-MO = 1) AND
 14479        (WS-SAVE-DUE-DA > 28)
 14480           MOVE 'Y' TO WS-DUE-DAY-SW.
 14481
 14482     MOVE +0                 TO DC-ELAPSED-DAYS.
 14483     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14484     MOVE '6'                TO DC-OPTION-CODE.
 14485     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14486
 14487 3399-EXIT.
 14488     EXIT.
 14489
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 279
* EL156.cbl
 14491 3400-COMPUTE-EXPIRY.
 14492
 14493     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14494     MOVE +0                    TO DC-ELAPSED-DAYS
 14495                                   DC-ODD-DAYS-OVER.
 14496     MOVE '1'                   TO DC-END-OF-MONTH.
 14497     MOVE '6'                   TO DC-OPTION-CODE.
 14498
 14499     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 14500         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14501     ELSE
 14502         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14503
 14504     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14505     IF NO-CONVERSION-ERROR
 14506         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14507     ELSE
 14508         GO TO 3390-CONTINUE.
 14509
 14510     IF CL-CLAIM-TYPE NOT = (PI-LIFE-OVERRIDE-L1 OR 'O')
 14511         GO TO 3390-CONTINUE.
 14512
 14513     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14514     MOVE '4'                    TO CNTL-REC-TYPE.
 14515     MOVE +0                     TO CNTL-SEQ-NO.
 14516     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14517     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14518     MOVE 'BENE'                 TO FILE-SWITCH.
 14519
 14520     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14521
 14522     IF NO-BENEFIT-FOUND
 14523         GO TO 3390-CONTINUE.
 14524
 14525     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 14526           OR 'FNL'
 14527        IF (PI-OFFLINE = 'Y') OR
 14528           (PI-PMTTYPE = '7')
 14529           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14530                                     THRU 9870-EXIT
 14531           IF ERROR-ON-OUTPUT
 14532             MOVE -1                 TO ENTERPFL
 14533             MOVE AL-UANON           TO ENTERPFA
 14534             MOVE MAP-NAMEA          TO MAP-NAME
 14535             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14536             GO TO 8200-SEND-DATAONLY.
 14537
 14538     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')  AND
 14539        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14540        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14541          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14542          MOVE +0        TO DC-ELAPSED-DAYS
 14543          MOVE +1        TO DC-ELAPSED-MONTHS
 14544          MOVE 6         TO DC-OPTION-CODE
 14545          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14546          IF NO-CONVERSION-ERROR
 14547              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14548
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 280
* EL156.cbl
 14549 3390-CONTINUE.
 14550
 14551      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14552         MOVE CM-AH-LOAN-EXPIRE-DT
 14553                                 TO DC-BIN-DATE-1
 14554      ELSE
 14555         MOVE CM-LF-LOAN-EXPIRE-DT
 14556                                 TO DC-BIN-DATE-1
 14557      END-IF
 14558
 14559      MOVE ' '                    TO DC-OPTION-CODE.
 14560      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14561      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14562      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14563
 14564 3499-EXIT.
 14565     EXIT.
 14566
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 281
* EL156.cbl
 14568
 14569 3600-CHECK-VERIFICATION.
 14570
 14571     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14572
 14573     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14574
 14575     IF PI-PAYEE-TYPE = 'I'
 14576        GO TO 3600-READ-TRAILER.
 14577
 14578     IF PI-PAYEE-TYPE = 'B'
 14579        ADD +10                  TO TRLR-SEQ-NO
 14580        GO TO 3600-READ-TRAILER.
 14581
 14582     IF PI-PAYEE-TYPE = 'A'
 14583        ADD +20                  TO TRLR-SEQ-NO
 14584        GO TO 3600-READ-TRAILER.
 14585
 14586     IF PI-PAYEE-TYPE = 'O'
 14587        ADD +50                  TO TRLR-SEQ-NO
 14588        GO TO 3600-READ-TRAILER.
 14589
 14590     IF PI-PAYEE-TYPE = 'Q'
 14591        ADD +60                  TO TRLR-SEQ-NO
 14592        GO TO 3600-READ-TRAILER.
 14593
 14594     IF PI-PAYEE-TYPE = 'P'
 14595        ADD +30                  TO TRLR-SEQ-NO
 14596        GO TO 3600-READ-TRAILER.
 14597
 14598     IF PI-PAYEE-TYPE = 'E'
 14599        ADD +40                  TO TRLR-SEQ-NO.
 14600
 14601 3600-READ-TRAILER.
 14602
 14603
 14604* EXEC CICS HANDLE CONDITION
 14605*         NOTFND(3600-CONTINUE)
 14606*    END-EXEC.
 14607*    MOVE '"$I                   ! - #00013825' TO DFHEIV0
 14608     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14609     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14610     MOVE X'2D20233030303133383235' TO DFHEIV0(25:11)
 14611     CALL 'kxdfhei1' USING DFHEIV0
 14612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14613
 14614
 14615     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14616
 14617 3600-CONTINUE.
 14618
 14619     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 14620         GO TO 3600-AH-VERIFY
 14621     END-IF.
 14622
 14623     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14624       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14625         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 282
* EL156.cbl
 14626           MOVE ER-7576            TO EMI-ERROR
 14627           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14628           MOVE -1                 TO PAYEEL
 14629           MOVE AL-UABON           TO PAYEEA
 14630           GO TO 3600-EXIT
 14631         END-IF
 14632       END-IF
 14633     END-IF.
 14634
 14635     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14636     MOVE 1 TO WS-SUB2
 14637     MOVE SPACES TO WS-PAYEE-NAME
 14638     PERFORM VARYING WS-SUB FROM 1 BY 1
 14639             UNTIL WS-SUB > 30
 14640         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14641            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14642                 WS-PAYEE-NAME-X (WS-SUB2)
 14643            ADD +1 TO WS-SUB2
 14644         END-IF
 14645     END-PERFORM.
 14646
 14647     STRING CL-INSURED-1ST-NAME
 14648            CL-INSURED-MID-INIT
 14649            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14650     MOVE 1 TO WS-SUB2
 14651     MOVE SPACES TO WS-INSURED-NAME
 14652     PERFORM VARYING WS-SUB FROM 1 BY 1
 14653             UNTIL WS-SUB > 30
 14654         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14655            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14656                 WS-INSURED-NAME-X (WS-SUB2)
 14657            ADD +1 TO WS-SUB2
 14658         END-IF
 14659     END-PERFORM.
 14660
 14661     IF CL-CLAIM-TYPE = 'O'
 14662        IF WS-PAYEE-NAME (1:6) = 'ESTATE'
 14663           MOVE ER-7585            TO EMI-ERROR
 14664           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14665           MOVE -1                 TO PAYEEL
 14666           MOVE AL-UABON           TO PAYEEA
 14667        ELSE
 14668           GO TO 3600-EXIT
 14669        END-IF
 14670     END-IF.
 14671     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14672        MOVE ER-7579            TO EMI-ERROR
 14673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14674        MOVE -1                 TO PAYEEL
 14675        MOVE AL-UABON           TO PAYEEA
 14676     END-IF.
 14677
 14678     IF PI-PMTTYPE = '4'  AND
 14679        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14680        PI-PAYEE-TYPE <> 'I'
 14681          MOVE ER-7580          TO EMI-ERROR
 14682          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14683          MOVE -1               TO PAYEEL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 283
* EL156.cbl
 14684          MOVE AL-UABON         TO PAYEEA
 14685     END-IF.
 14686
 14687     GO TO 3600-EXIT.
 14688
 14689 3600-AH-VERIFY.
 14690
 14691     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14692        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14693           MOVE ER-7583            TO EMI-ERROR
 14694           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14695           MOVE -1                 TO PAYEEL
 14696           MOVE AL-UABON           TO PAYEEA
 14697        END-IF
 14698     END-IF.
 14699
 14700
 14701 3600-EXIT.
 14702     EXIT.
 14703
 14704 5000-UPDATE.
 14705
 14706     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14707
 14708     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14709
 14710     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14711        PI-OFFLINE = 'Y'
 14712        NEXT SENTENCE
 14713     ELSE
 14714        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14715
 14716*    IF PI-COMPANY-ID = 'CRI'
 14717*       IF PI-PMTTYPE = '1' OR  '2'
 14718*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14719*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14720*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14721
 14722*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14723*       IF PI-PMTTYPE = '1'
 14724*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14725*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14726
 14727     IF PI-PMTTYPE      = '2' AND
 14728        PI-SPLIT-PMT-SW = 'Y' AND
 14729        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 14730          MOVE ER-3530                TO EMI-ERROR
 14731          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14732
 14733     IF (PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL')
 14734        AND (CL-CLAIM-TYPE = 'L' OR 'O')
 14735        IF PI-PMTTYPE = '2' OR '4'
 14736           IF PI-INT-AMT NOT = ZEROS
 14737              PERFORM 7110-BUILD-PMT-TRLR
 14738                                 THRU 7130-EXIT
 14739           ELSE
 14740              IF PI-PMTTYPE = '2'
 14741                 PERFORM 7140-BUILD-NOTE-TRLR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 284
* EL156.cbl
 14742                                 THRU 7170-EXIT
 14743              END-IF
 14744           END-IF
 14745        END-IF
 14746     END-IF
 14747*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14748*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14749*            MOVE 'N'                 TO  WS-LETTER-SW.
 14750
 14751*    IF PI-COMPANY-ID = 'DMD'
 14752*        IF CL-NO-OF-PMTS-MADE = +1
 14753*                OR
 14754*           PI-PMTTYPE = '2'
 14755*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14756
 14757     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14758
 14759*    IF PI-COMPANY-ID = 'DMD'
 14760*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14761*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14762
 14763
 14764* EXEC CICS REWRITE
 14765*         DATASET('ELMSTR')
 14766*         FROM(CLAIM-MASTER)
 14767*     END-EXEC.
 14768     MOVE LENGTH OF
 14769      CLAIM-MASTER
 14770       TO DFHEIV11
 14771     MOVE 'ELMSTR' TO DFHEIV1
 14772*    MOVE '&& L                  %   #00013977' TO DFHEIV0
 14773     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14774     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14775     MOVE X'2020233030303133393737' TO DFHEIV0(25:11)
 14776     CALL 'kxdfhei1' USING DFHEIV0,
 14777           DFHEIV1,
 14778           CLAIM-MASTER,
 14779           DFHEIV11,
 14780           DFHEIV99
 14781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14782
 14783
 14784     IF WS-LETTER-SW = 'N'
 14785         GO TO 5000-END-UPDATE.
 14786
 14787 5000-GENERATE-AUTO-LETTER.
 14788
 14789
 14790* EXEC CICS LINK
 14791*        PROGRAM    (LINK-1523)
 14792*        COMMAREA   (W-1523-LINKDATA)
 14793*        LENGTH     (W-1523-COMM-LENGTH)
 14794*    END-EXEC.
 14795*    MOVE '."C                   (   #00013987' TO DFHEIV0
 14796     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14797     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14798     MOVE X'2020233030303133393837' TO DFHEIV0(25:11)
 14799     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 285
* EL156.cbl
 14800           LINK-1523,
 14801           W-1523-LINKDATA,
 14802           W-1523-COMM-LENGTH,
 14803           DFHEIV99,
 14804           DFHEIV99,
 14805           DFHEIV99,
 14806           DFHEIV99
 14807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14808
 14809
 14810     IF W-1523-FATAL-ERROR
 14811         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14812         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14813         MOVE ER-0802                TO  EMI-ERROR
 14814         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14815
 14816     IF W-1523-ERROR-CODE = 0191
 14817         MOVE ER-0803                TO  EMI-ERROR
 14818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14819
 14820     IF PI-COMPANY-ID      = 'HAN' AND
 14821        PI-PMTTYPE         = '1'   AND
 14822        PI-3RD-PARTY-SW    = 'Y'   AND
 14823        W-1523-FORM-NUMBER = 'EOB1'
 14824           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14825           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14826           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14827           GO TO 5000-GENERATE-AUTO-LETTER.
 14828
 14829 5000-END-UPDATE.
 14830
 14831     MOVE ER-0000                TO EMI-ERROR.
 14832     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14833     GO TO 7000-SHOW-CLAIM.
 14834
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 286
* EL156.cbl
 14836 5000-MOVE-NAME.
 14837     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14838     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14839     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14840
 14841 5000-EXIT.
 14842     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 287
* EL156.cbl
 14844 5300-CREATE-DMO.
 14845
 14846     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14847     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14848     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14849
 14850
 14851* EXEC CICS HANDLE CONDITION
 14852*         NOTFND   (5300-NOTE-NOT-FOUND)
 14853*    END-EXEC.
 14854*    MOVE '"$I                   ! . #00014033' TO DFHEIV0
 14855     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14857     MOVE X'2E20233030303134303333' TO DFHEIV0(25:11)
 14858     CALL 'kxdfhei1' USING DFHEIV0
 14859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14860
 14861
 14862
 14863* EXEC CICS READ
 14864*         DATASET('ERNOTE')
 14865*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14866*         RIDFLD (W-NOTE-KEY)
 14867*    END-EXEC.
 14868     MOVE 'ERNOTE' TO DFHEIV1
 14869*    MOVE '&"S        E          (   #00014037' TO DFHEIV0
 14870     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14871     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14872     MOVE X'2020233030303134303337' TO DFHEIV0(25:11)
 14873     CALL 'kxdfhei1' USING DFHEIV0,
 14874           DFHEIV1,
 14875           DFHEIV20,
 14876           DFHEIV99,
 14877           W-NOTE-KEY,
 14878           DFHEIV99,
 14879           DFHEIV99,
 14880           DFHEIV99
 14881     SET ADDRESS OF CERTIFICATE-NOTE TO
 14882         DFHEIV20
 14883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14884
 14885
 14886     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14887     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14888     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14889
 14890     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14891         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14892     ELSE
 14893         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14894
 14895     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14896     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14897     MOVE 'DLO006'               TO PGM-NAME.
 14898
 14899
 14900* EXEC CICS LINK
 14901*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 288
* EL156.cbl
 14902*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14903*        LENGTH     (DCT-RCRD-LENGTH)
 14904*    END-EXEC.
 14905*    MOVE '."C                   (   #00014056' TO DFHEIV0
 14906     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14907     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14908     MOVE X'2020233030303134303536' TO DFHEIV0(25:11)
 14909     CALL 'kxdfhei1' USING DFHEIV0,
 14910           PGM-NAME,
 14911           DCT-COMMUNICATION-AREA,
 14912           DCT-RCRD-LENGTH,
 14913           DFHEIV99,
 14914           DFHEIV99,
 14915           DFHEIV99,
 14916           DFHEIV99
 14917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14918
 14919
 14920     IF DCT-RETURN-CODE = 'OK'
 14921         GO TO 5300-CONT.
 14922
 14923     IF DCT-RETURN-CODE = '01' OR '02'
 14924         GO TO 5300-EXIT.
 14925
 14926     IF DCT-RETURN-CODE = '03'
 14927         MOVE ER-0951            TO EMI-ERROR
 14928         GO TO 5300-BAD-EXIT.
 14929
 14930     IF DCT-RETURN-CODE = '04'
 14931         MOVE ER-0946            TO EMI-ERROR
 14932         GO TO 5300-BAD-EXIT.
 14933
 14934     IF DCT-RETURN-CODE = '05'
 14935         MOVE ER-0947            TO EMI-ERROR
 14936         GO TO 5300-BAD-EXIT.
 14937
 14938     IF DCT-RETURN-CODE = '06'
 14939         MOVE ER-0921            TO EMI-ERROR
 14940         GO TO 5300-BAD-EXIT.
 14941
 14942     IF DCT-RETURN-CODE = '07'
 14943         MOVE ER-0849            TO EMI-ERROR
 14944         GO TO 5300-BAD-EXIT.
 14945
 14946     IF DCT-RETURN-CODE = '08'
 14947         MOVE ER-0948            TO EMI-ERROR
 14948         GO TO 5300-BAD-EXIT.
 14949
 14950     IF DCT-RETURN-CODE = 'N1'
 14951         MOVE ER-0950            TO EMI-ERROR
 14952         GO TO 5300-BAD-EXIT.
 14953
 14954     IF DCT-RETURN-CODE = 'E1'
 14955         MOVE ER-0974            TO EMI-ERROR
 14956         GO TO 5300-BAD-EXIT.
 14957
 14958     IF DCT-RETURN-CODE = 'E2'
 14959         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 289
* EL156.cbl
 14960         GO TO 5300-BAD-EXIT.
 14961
 14962     IF DCT-RETURN-CODE NOT = 'OK'
 14963         MOVE ER-0949            TO EMI-ERROR
 14964         GO TO 5300-BAD-EXIT.
 14965
 14966 5300-CONT.
 14967
 14968     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14969     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14970     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14971     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14972     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14973     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14974     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14975     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14976
 14977     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14978     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14979     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14980     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14981     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14982
 14983     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14984
 14985     IF PI-PMTTYPE = '2'
 14986         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14987         MOVE '4'                TO DM-CLAIM-STATUS
 14988     ELSE
 14989         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14990         MOVE '2'                TO DM-CLAIM-STATUS.
 14991
 14992     MOVE 'DLO025'               TO PGM-NAME.
 14993
 14994
 14995* EXEC CICS LINK
 14996*        PROGRAM    (PGM-NAME)
 14997*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14998*        LENGTH     (DM-DMO-LENGTH)
 14999*    END-EXEC.
 15000*    MOVE '."C                   (   #00014136' TO DFHEIV0
 15001     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15003     MOVE X'2020233030303134313336' TO DFHEIV0(25:11)
 15004     CALL 'kxdfhei1' USING DFHEIV0,
 15005           PGM-NAME,
 15006           DMO-COMMUNICATION-AREA,
 15007           DM-DMO-LENGTH,
 15008           DFHEIV99,
 15009           DFHEIV99,
 15010           DFHEIV99,
 15011           DFHEIV99
 15012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15013
 15014
 15015     IF DM-RETURN-CODE = 'OK'
 15016         GO TO 5300-EXIT.
 15017
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 290
* EL156.cbl
 15018     IF DM-RETURN-CODE = '01'
 15019         MOVE ER-8051            TO EMI-ERROR
 15020         GO TO 5300-BAD-EXIT.
 15021
 15022     IF DM-RETURN-CODE = '02'
 15023         MOVE ER-8052            TO EMI-ERROR
 15024         GO TO 5300-BAD-EXIT.
 15025
 15026     IF DM-RETURN-CODE = '03'
 15027         MOVE ER-8053            TO EMI-ERROR
 15028         GO TO 5300-BAD-EXIT.
 15029
 15030     IF DM-RETURN-CODE = '04'
 15031         MOVE ER-8054            TO EMI-ERROR
 15032         GO TO 5300-BAD-EXIT.
 15033
 15034     IF DM-RETURN-CODE = '05'
 15035         MOVE ER-8055            TO EMI-ERROR
 15036         GO TO 5300-BAD-EXIT.
 15037
 15038     IF DM-RETURN-CODE = '06'
 15039         MOVE ER-8056            TO EMI-ERROR
 15040         GO TO 5300-BAD-EXIT.
 15041
 15042     IF DM-RETURN-CODE = '07'
 15043         MOVE ER-8057            TO EMI-ERROR
 15044         GO TO 5300-BAD-EXIT.
 15045
 15046     IF DM-RETURN-CODE = '08'
 15047         MOVE ER-8058            TO EMI-ERROR
 15048         GO TO 5300-BAD-EXIT.
 15049
 15050     IF DM-RETURN-CODE = '09'
 15051         MOVE ER-8059            TO EMI-ERROR
 15052         GO TO 5300-BAD-EXIT.
 15053
 15054     IF DM-RETURN-CODE = '10'
 15055         MOVE ER-8060            TO EMI-ERROR
 15056         GO TO 5300-BAD-EXIT.
 15057
 15058     IF DM-RETURN-CODE = '11'
 15059         MOVE ER-8061            TO EMI-ERROR
 15060         GO TO 5300-BAD-EXIT.
 15061
 15062     IF DM-RETURN-CODE = '12'
 15063         MOVE ER-8062            TO EMI-ERROR
 15064         GO TO 5300-BAD-EXIT.
 15065
 15066     IF DM-RETURN-CODE = '13'
 15067         MOVE ER-8063            TO EMI-ERROR
 15068         GO TO 5300-BAD-EXIT.
 15069
 15070     IF DM-RETURN-CODE = '14'
 15071         MOVE ER-8064            TO EMI-ERROR
 15072         GO TO 5300-BAD-EXIT.
 15073
 15074     IF DM-RETURN-CODE = '15'
 15075         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 291
* EL156.cbl
 15076         GO TO 5300-BAD-EXIT.
 15077
 15078     IF DM-RETURN-CODE = '16'
 15079         MOVE ER-8154            TO EMI-ERROR
 15080         GO TO 5300-BAD-EXIT.
 15081
 15082     IF DM-RETURN-CODE = '17'
 15083         MOVE ER-8155            TO EMI-ERROR
 15084         GO TO 5300-BAD-EXIT.
 15085
 15086     IF DM-RETURN-CODE = 'N1'
 15087         MOVE ER-8152            TO EMI-ERROR
 15088         GO TO 5300-BAD-EXIT.
 15089
 15090     IF DM-RETURN-CODE = 'E1'
 15091         MOVE ER-8153            TO EMI-ERROR
 15092         GO TO 5300-BAD-EXIT.
 15093
 15094     MOVE ER-8066            TO EMI-ERROR.
 15095     GO TO 5300-BAD-EXIT.
 15096
 15097 5300-NOTE-NOT-FOUND.
 15098
 15099     MOVE ER-0954                TO EMI-ERROR.
 15100     GO TO 5300-BAD-EXIT.
 15101
 15102 5300-BAD-EXIT.
 15103
 15104* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15105*    MOVE '6"R                   !   #00014230' TO DFHEIV0
 15106     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15108     MOVE X'2020233030303134323330' TO DFHEIV0(25:11)
 15109     CALL 'kxdfhei1' USING DFHEIV0
 15110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15111
 15112     IF MAP-NAME = 'EL156A'
 15113         MOVE -1             TO ENTERPFL
 15114       ELSE
 15115         MOVE LOW-VALUES     TO EL156BI
 15116         MOVE -1             TO ENTPFBL.
 15117
 15118     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15119     GO TO 8200-SEND-DATAONLY.
 15120
 15121 5300-EXIT.
 15122     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 292
* EL156.cbl
 15124 5350-FORMAT-LAST-NAME-1ST.
 15125*****************************************************************
 15126*             M O V E   N A M E   R O U T I N E                 *
 15127*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15128*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15129*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15130*                  FIELD                   VALUE                *
 15131*           W-NAME-LAST    (CL15)      SMITH                    *
 15132*           W-NAME-FIRST   (CL15)      JOHN                     *
 15133*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 15134*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15135*     CONTAIN                                                   *
 15136*                SMITH, JOHN ALLEN                              *
 15137*     OR                                                        *
 15138*                SMITH, JOHN A.                                 *
 15139*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15140*     COPYBOOK, ELCNWA.                                         *
 15141*****************************************************************.
 15142
 15143     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 15144     MOVE ZERO                   TO  WS-NAME-SW.
 15145     SET NWA-INDEX               TO +1.
 15146
 15147     IF W-NAME-LAST   = SPACES AND
 15148        W-NAME-MIDDLE = SPACES
 15149         MOVE +1                 TO WS-NAME-SW.
 15150
 15151     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15152     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15153
 15154     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15155     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15156
 15157     SET NWA-INDEX UP BY +1.
 15158
 15159     IF W-NAME-MIDDLE NOT = SPACES
 15160         IF W-NAME-MIDDLE-2 = SPACES
 15161             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15162             SET NWA-INDEX UP BY +1
 15163             MOVE '.'            TO WS-NW (NWA-INDEX)
 15164             SET NWA-INDEX UP BY +2
 15165         ELSE
 15166             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15167             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15168
 15169 5350-EXIT.
 15170     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 293
* EL156.cbl
 15172 5360-MOVE-NAME.
 15173
 15174     IF WS-NAME-SW > +1
 15175         GO TO 5360-EXIT.
 15176
 15177     IF WS-NAME-WORK2 = SPACES
 15178         GO TO 5360-EXIT.
 15179
 15180     SET NWA-INDEX2            TO +1.
 15181     SET NWA-INDEX3            TO +2.
 15182
 15183 5360-MOVE-NAME-CYCLE.
 15184
 15185     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 15186
 15187     IF NWA-INDEX < +30
 15188         SET NWA-INDEX UP BY +1
 15189     ELSE
 15190         ADD +2                TO  WS-NAME-SW
 15191         GO TO 5360-EXIT.
 15192
 15193     IF NWA-INDEX2 < +20
 15194         SET NWA-INDEX3 UP BY +1
 15195         SET NWA-INDEX2 UP BY +1.
 15196
 15197     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 15198        WS-NW2 (NWA-INDEX3) = SPACES
 15199         IF WS-NAME-SW = ZERO
 15200             MOVE ','            TO  WS-NW (NWA-INDEX)
 15201             SET NWA-INDEX UP BY +2
 15202             MOVE +1             TO  WS-NAME-SW
 15203             GO TO 5360-EXIT
 15204         ELSE
 15205             GO TO 5360-EXIT.
 15206
 15207     GO TO 5360-MOVE-NAME-CYCLE.
 15208
 15209 5360-EXIT.
 15210     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 294
* EL156.cbl
 15212 6000-BUILD-SCREEN-B.
 15213     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15214     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15215     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15216     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15217
 15218     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15219
 15220 6050-BUILD-SCREEN.
 15221     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15222     MOVE LOW-VALUES             TO EL156BI.
 15223     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15224
 15225     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15226
 15227     IF PI-PAYEE-TYPE = 'I'
 15228        GO TO 6060-READ-TRAILER.
 15229
 15230     IF PI-PAYEE-TYPE = 'B'
 15231        ADD +10                  TO TRLR-SEQ-NO
 15232        GO TO 6060-READ-TRAILER.
 15233
 15234     IF PI-PAYEE-TYPE = 'A'
 15235        ADD +20                  TO TRLR-SEQ-NO
 15236        GO TO 6060-READ-TRAILER.
 15237
 15238     IF PI-PAYEE-TYPE = 'O'
 15239        ADD +50                  TO TRLR-SEQ-NO
 15240        GO TO 6060-READ-TRAILER.
 15241
 15242     IF PI-PAYEE-TYPE = 'Q'
 15243        ADD +60                  TO TRLR-SEQ-NO
 15244        GO TO 6060-READ-TRAILER.
 15245
 15246     IF PI-PAYEE-TYPE = 'P'
 15247        ADD +30                  TO TRLR-SEQ-NO
 15248        GO TO 6060-READ-TRAILER.
 15249
 15250     IF PI-PAYEE-TYPE = 'E'
 15251        ADD +40                  TO TRLR-SEQ-NO.
 15252
 15253 6060-READ-TRAILER.
 15254
 15255     IF PI-PAYEE-TYPE    = 'A' AND
 15256        PI-PAYEE-SEQ-NUM = 0
 15257          GO TO 6061-READ-ACCOUNT.
 15258
 15259     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15260        (PI-PAYEE-TYPE    = 'B')             AND
 15261        (PI-PAYEE-SEQ-NUM = 9)
 15262          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15263          IF BENE-FOUND-SW = 'N'
 15264            GO TO 6065-NOT-FOUND
 15265          ELSE
 15266            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15267            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15268            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15269*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 295
* EL156.cbl
 15270            STRING BE-CITY ' ' BE-STATE
 15271               DELIMITED BY '  ' INTO CITYSTBO
 15272            END-STRING
 15273            MOVE BE-ZIP-CODE       TO ZIPBO
 15274            GO TO 6061-READ-ACCOUNT.
 15275
 15276     IF PI-PAYEE-TYPE    = 'B' AND
 15277        PI-PAYEE-SEQ-NUM = 0
 15278          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15279          IF BENE-FOUND-SW = 'N'
 15280            GO TO 6065-NOT-FOUND
 15281          ELSE
 15282            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15283            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15284            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15285*           MOVE BE-CITY-STATE     TO CITYSTBO
 15286            STRING BE-CITY ' ' BE-STATE
 15287               DELIMITED BY '  ' INTO CITYSTBO
 15288            END-STRING
 15289            MOVE BE-ZIP-CODE       TO ZIPBO
 15290            if be-ach-yes-or-no = 'Y'
 15291               move 'Y'          to pi-ach-payment
 15292            else
 15293               move 'N'          to pi-ach-payment
 15294            end-if
 15295            GO TO 6061-READ-ACCOUNT.
 15296
 15297
 15298* EXEC CICS HANDLE CONDITION
 15299*         NOTFND(6065-NOT-FOUND)
 15300*     END-EXEC.
 15301*    MOVE '"$I                   ! / #00014416' TO DFHEIV0
 15302     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15304     MOVE X'2F20233030303134343136' TO DFHEIV0(25:11)
 15305     CALL 'kxdfhei1' USING DFHEIV0
 15306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15307
 15308
 15309     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15310
 15311     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15312     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15313     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15314     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15315*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15316     STRING AT-CITY ' ' AT-STATE
 15317        DELIMITED BY '  ' INTO CITYSTBO
 15318     END-STRING
 15319     MOVE AT-ZIP-CODE            TO ZIPBO.
 15320
 15321 6061-READ-ACCOUNT.
 15322
 15323* EXEC CICS HANDLE CONDITION
 15324*         NOTFND(6068-ACCT-NOT-FND)
 15325*     END-EXEC.
 15326*    MOVE '"$I                   ! 0 #00014433' TO DFHEIV0
 15327     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 296
* EL156.cbl
 15328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15329     MOVE X'3020233030303134343333' TO DFHEIV0(25:11)
 15330     CALL 'kxdfhei1' USING DFHEIV0
 15331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15332
 15333
 15334
 15335* EXEC CICS READ
 15336*         DATASET('ERACCT')
 15337*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15338*         RIDFLD (PI-ACCT-KEY)
 15339*     END-EXEC.
 15340     MOVE 'ERACCT' TO DFHEIV1
 15341*    MOVE '&"S        E          (   #00014437' TO DFHEIV0
 15342     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15344     MOVE X'2020233030303134343337' TO DFHEIV0(25:11)
 15345     CALL 'kxdfhei1' USING DFHEIV0,
 15346           DFHEIV1,
 15347           DFHEIV20,
 15348           DFHEIV99,
 15349           PI-ACCT-KEY,
 15350           DFHEIV99,
 15351           DFHEIV99,
 15352           DFHEIV99
 15353     SET ADDRESS OF ACCOUNT-MASTER TO
 15354         DFHEIV20
 15355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15356
 15357
 15358     MOVE AM-CARRIER             TO ACARRBO.
 15359     MOVE AM-GROUPING            TO GROUPBO.
 15360     MOVE AM-STATE               TO STATEBO.
 15361     MOVE AM-ACCOUNT             TO ACCTBO.
 15362     MOVE AM-NAME                TO ACCTNMBO.
 15363
 15364     IF PI-PAYEE-TYPE = 'A' AND
 15365        PI-PAYEE-SEQ-NUM = 0
 15366          MOVE AM-NAME             TO NAMEBO
 15367                                      PI-PAYEE-NAME
 15368          MOVE AM-ADDRS            TO ADDR1BO
 15369          MOVE SPACES              TO ADDR2BO
 15370*         MOVE AM-CITY             TO CITYSTBO
 15371          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15372             DELIMITED BY '  ' INTO CITYSTBO
 15373          END-STRING
 15374          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15375          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15376          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15377          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15378
 15379***  We don't really need the code below because we don't do the
 15380***  AK thing anymore.  However, we may have a state special
 15381***  of some sort in the future so why not just leave it??
 15382     IF CITYSTBO EQUAL SPACES
 15383         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15384         GO TO 6070-FORMAT-DATA
 15385     END-IF.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 297
* EL156.cbl
 15386
 15387     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15388     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15389     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15390     PERFORM VARYING WS-SUB FROM 30 BY -1
 15391          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15392        IF WS-END-SUB = 0  AND
 15393           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15394              OR LOW-VALUES  OR '.')
 15395            CONTINUE
 15396        ELSE
 15397            IF WS-END-SUB = 0
 15398                MOVE WS-SUB TO WS-END-SUB
 15399            ELSE
 15400                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15401                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15402                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15403                END-IF
 15404            END-IF
 15405        END-IF
 15406        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15407            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15408            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15409        END-IF
 15410     END-PERFORM.
 15411
 15412     IF WS-BEG-SUB > 0
 15413         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15414         IF WS-STATE-LENGTH = 2
 15415             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15416                  TO PI-CHECK-STATE-FOR-AK
 15417         ELSE
 15418             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15419                'ALASKA'
 15420                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15421             ELSE
 15422                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15423             END-IF
 15424         END-IF
 15425     ELSE
 15426         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15427     END-IF.
 15428
 15429     GO TO 6070-FORMAT-DATA.
 15430
 15431 6065-NOT-FOUND.
 15432     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15433     GO TO 6061-READ-ACCOUNT.
 15434
 15435 6068-ACCT-NOT-FND.
 15436     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15437
 15438 6070-FORMAT-DATA.
 15439     IF PI-HOLDTIL = ZEROS
 15440        MOVE SAVE-DATE           TO PAYDTBI
 15441       ELSE
 15442        MOVE PI-HOLDTIL          TO PAYDTBO
 15443        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 298
* EL156.cbl
 15444
 15445     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15446     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15447
 15448     IF EIBAID = DFHPF3 OR DFHPF4
 15449        NEXT SENTENCE
 15450     ELSE
 15451       GO TO 6071-CONTINUE.
 15452
 15453     MOVE PI-EPYFROM          TO PYFROMBO.
 15454     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15455
 15456     IF NOT PI-USES-PAID-TO
 15457        MOVE PI-EPYTHRU          TO PYTHRUBO
 15458        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15459     ELSE
 15460        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15461        MOVE '4'              TO DC-OPTION-CODE
 15462        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15463        IF NO-CONVERSION-ERROR
 15464           MOVE +1            TO DC-ELAPSED-DAYS
 15465           MOVE +0            TO DC-ELAPSED-MONTHS
 15466           MOVE '6'           TO DC-OPTION-CODE
 15467           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15468           IF NO-CONVERSION-ERROR
 15469              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15470
 15471     MOVE PI-EDAYS            TO DAYSBO.
 15472     MOVE PI-EPYAMT           TO PAYAMTBO.
 15473     IF PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL'
 15474        IF PI-INT-AMT > ZEROS
 15475           MOVE PI-INT-AMT       TO INTAMTBO
 15476        END-IF
 15477     END-IF
 15478     GO TO 6072-SET-TYPE.
 15479
 15480 6071-CONTINUE.
 15481
 15482     IF PI-CPYFROM NOT = LOW-VALUES
 15483        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15484        MOVE SPACES              TO DC-OPTION-CODE
 15485        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15486        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15487
 15488     IF PI-CPYTHRU NOT = LOW-VALUES
 15489        IF NOT PI-USES-PAID-TO
 15490           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15491           MOVE SPACES             TO DC-OPTION-CODE
 15492           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15493           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15494        ELSE
 15495           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15496           MOVE '6'                TO DC-OPTION-CODE
 15497           MOVE +1                 TO DC-ELAPSED-DAYS
 15498           MOVE +0                 TO DC-ELAPSED-MONTHS
 15499           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15500           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15501
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 299
* EL156.cbl
 15502     MOVE PI-CDAYS               TO DAYSBO.
 15503     MOVE PI-CPYAMT              TO PAYAMTBO.
 15504     IF PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL'
 15505        IF PI-INT-AMT > ZEROS
 15506           MOVE PI-INT-AMT       TO INTAMTBO
 15507        END-IF
 15508     END-IF
 15509     .
 15510 6072-SET-TYPE.
 15511     IF PI-PMTTYPE = '1'
 15512        MOVE 'PARTIAL'           TO PAYTYPBO.
 15513
 15514     IF PI-PMTTYPE = '2'
 15515        MOVE 'FINAL'             TO PAYTYPBO.
 15516
 15517     IF PI-PMTTYPE = '3'
 15518        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15519
 15520     IF PI-PMTTYPE = '4'
 15521        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15522
 15523     IF PI-PMTTYPE = '5'
 15524        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15525
 15526     IF PI-PMTTYPE = '6'
 15527        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15528
 15529     IF PI-PROV-PMT
 15530        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15531
 15532     IF PI-ECHECKNO NOT = SPACES
 15533        MOVE PI-ECHECKNO         TO CKNUMBO
 15534     ELSE
 15535        MOVE PI-CCHECKNO         TO CKNUMBO.
 15536
 15537     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 15538           OR 'FNL'
 15539        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15540        MOVE +91                 TO  TRLR-SEQ-NO
 15541
 15542* EXEC CICS READ
 15543*           DATASET  ('ELTRLR')
 15544*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15545*           RIDFLD   (ELTRLR-KEY)
 15546*           RESP     (WS-RESPONSE)
 15547*       END-EXEC
 15548     MOVE 'ELTRLR' TO DFHEIV1
 15549*    MOVE '&"S        E          (  N#00014626' TO DFHEIV0
 15550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15552     MOVE X'204E233030303134363236' TO DFHEIV0(25:11)
 15553     CALL 'kxdfhei1' USING DFHEIV0,
 15554           DFHEIV1,
 15555           DFHEIV20,
 15556           DFHEIV99,
 15557           ELTRLR-KEY,
 15558           DFHEIV99,
 15559           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 300
* EL156.cbl
 15560           DFHEIV99
 15561     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15562         DFHEIV20
 15563     MOVE EIBRESP  TO WS-RESPONSE
 15564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15565
 15566        IF WS-RESP-NORMAL
 15567           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15568        ELSE
 15569           MOVE SPACES           TO  LOANNBO
 15570        END-IF
 15571     END-IF
 15572
 15573*       MOVE PI-LOAN-NO          TO LOANNBO
 15574
 15575     IF CKNUMBO = SPACES
 15576         MOVE SPACES             TO CKNUMHDO.
 15577
 15578     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15579     MOVE CL-CARRIER             TO CARRBO.
 15580     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15581     MOVE CL-CERT-SFX            TO SUFXBO.
 15582
 15583     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15584        EVALUATE CL-CLAIM-TYPE
 15585           WHEN 'I'
 15586              MOVE '  IU  '      TO CLMTYPBO
 15587           WHEN 'G'
 15588              MOVE ' GAP  '      TO CLMTYPBO
 15589           WHEN 'F'
 15590              MOVE ' FMLA '      TO CLMTYPBO
 15591           WHEN OTHER
 15592              MOVE PI-AH-OVERRIDE-L6
 15593                                 TO CLMTYPBO
 15594        END-EVALUATE
 15595        MOVE ZEROS               TO UNDISBO
 15596*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15597        IF PI-PMTTYPE = '5' OR '6'
 15598           GO TO 6073-GET-NOTIFY-DATA
 15599        ELSE
 15600           MOVE PI-DAILY-RATE    TO RATEBO
 15601           GO TO 6073-GET-NOTIFY-DATA.
 15602
 15603     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15604
 15605     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15606        MOVE ZEROS               TO UNDISBO
 15607     ELSE
 15608        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15609
 15610 6073-GET-NOTIFY-DATA.
 15611
 15612     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15613
 15614     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15615         MOVE SPACES             TO  NAMEB2O
 15616                                     ADDR1B2O
 15617                                     ADDR2B2O
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 301
* EL156.cbl
 15618                                     CITYST2O
 15619                                     AGTHDGO
 15620         MOVE ZEROS              TO  ZIPB2O
 15621         GO TO 6080-SET-INCURRED.
 15622
 15623     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15624     MOVE +29                    TO  TRLR-SEQ-NO.
 15625
 15626
 15627* EXEC CICS HANDLE CONDITION
 15628*        NOTFND   (6074-GET-COMP-DATA)
 15629*    END-EXEC.
 15630*    MOVE '"$I                   ! 1 #00014693' TO DFHEIV0
 15631     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15633     MOVE X'3120233030303134363933' TO DFHEIV0(25:11)
 15634     CALL 'kxdfhei1' USING DFHEIV0
 15635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15636
 15637
 15638     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15639
 15640     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15641     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15642     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15643*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15644     STRING AT-CITY ' ' AT-STATE
 15645        DELIMITED BY '  ' INTO CITYST2O
 15646     END-STRING
 15647     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15648     GO TO 6080-SET-INCURRED.
 15649
 15650 6074-GET-COMP-DATA.
 15651
 15652     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15653         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15654
 15655     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15656         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15657                                         ADDR1B2O
 15658                                         ADDR2B2O
 15659                                         CITYST2O
 15660         MOVE ZEROS                  TO  ZIPB2O
 15661         GO TO 6080-SET-INCURRED.
 15662
 15663     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15664     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15665     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15666     MOVE AM-GROUPING            TO  COMP-GROUP.
 15667     MOVE 'A'                    TO  COMP-TYPE.
 15668     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15669                                 TO  COMP-FIN-RESP.
 15670
 15671     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15672         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15673                                       'G' OR 'B' or 'S'
 15674             MOVE 'G'            TO  COMP-TYPE
 15675             MOVE LOW-VALUES     TO  COMP-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 302
* EL156.cbl
 15676         ELSE
 15677             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15678                                 TO  COMP-ACCOUNT
 15679     ELSE
 15680         MOVE 'G'                TO  COMP-TYPE
 15681         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15682
 15683     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15684
 15685     IF COMP-REC-FOUND
 15686         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15687         MOVE CO-ADDR-1          TO  ADDR1B2O
 15688         MOVE CO-ADDR-2          TO  ADDR2B2O
 15689*        MOVE CO-ADDR-3          TO  CITYST2O
 15690         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15691            DELIMITED BY '  ' INTO CITYST2O
 15692         END-STRING
 15693         MOVE CO-ZIP             TO  ZIPB2O
 15694     ELSE
 15695         MOVE 'NO COMP ADDRESS AVAILABLE'
 15696                                 TO  NAMEB2O
 15697                                     ADDR1B2O
 15698                                     ADDR2B2O
 15699                                     CITYST2O
 15700         MOVE ZEROS               TO ZIPB2O.
 15701
 15702 6080-SET-INCURRED.
 15703     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15704     MOVE SPACES                 TO DC-OPTION-CODE.
 15705     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15706     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15707     MOVE PI-PROCESSOR-ID        TO BYBO.
 15708     MOVE MAP-NAMEB              TO MAP-NAME.
 15709     MOVE 'C'                    TO PI-PASS-SW.
 15710     MOVE EIBAID                 TO PI-PFKEY-USED.
 15711     MOVE -1                     TO ENTPFBL.
 15712     GO TO 8100-SEND-INITIAL-MAP.
 15713
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 303
* EL156.cbl
 15715 6100-BUILD-PAYMENT-TRAILER.
 15716
 15717     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15718     MOVE '6'                    TO CNTL-REC-TYPE.
 15719
 15720     IF CONTROL-IS-ACTUAL-CARRIER
 15721         MOVE PI-CARRIER         TO WS-CARR
 15722     ELSE
 15723         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15724
 15725     IF PI-COMPANY-ID = 'FIA'
 15726         MOVE PI-CARRIER         TO  WS-CARR.
 15727
 15728     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15729     MOVE 0                      TO CNTL-SEQ-NO.
 15730     MOVE 'CARR'                 TO FILE-SWITCH.
 15731
 15732     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15733
 15734     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15735         IF PI-OFFLINE     = 'Y' AND
 15736            PI-ECHECKNO-CR = 'CR'
 15737              GO TO 6110-READ-CONTROL
 15738         ELSE
 15739            IF PI-CASH = 'N'
 15740                GO TO 6110-READ-CONTROL.
 15741
 15742     IF CHECK-NO-MANUAL    OR
 15743        CHECK-NO-AT-PRINT  OR
 15744        PI-OFFLINE = 'Y'
 15745          GO TO 6130-BUILD-TRAILER.
 15746     IF PI-COMPANY-ID = 'FIA'
 15747         NEXT SENTENCE
 15748     ELSE
 15749         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15750             GO TO 6110-READ-CONTROL.
 15751
 15752     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15753
 15754     IF CHECK-CNT-RESET-VALUE
 15755        MOVE +1                  TO CF-CHECK-COUNTER
 15756     ELSE
 15757        ADD +1                   TO CF-CHECK-COUNTER.
 15758
 15759     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15760
 15761     IF CHECK-NO-CARR-SEQ
 15762        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15763
 15764     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15765
 15766     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15767     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15768        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15769         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15770         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15771            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15772         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 304
* EL156.cbl
 15773                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15774     END-IF.
 15775
 15776     GO TO 6120-REWRITE.
 15777
 15778 6105-STATE-CHECK-NUMBER.
 15779     IF CHECK-NO-MANUAL    OR
 15780        CHECK-NO-AT-PRINT  OR
 15781        PI-OFFLINE = 'Y'
 15782           GO TO 6130-BUILD-TRAILER
 15783     END-IF.
 15784
 15785     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15786     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15787     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15788     MOVE '3'                TO CNTL-REC-TYPE.
 15789     MOVE +0                 TO CNTL-SEQ-NO.
 15790     MOVE 'STAT'             TO FILE-SWITCH.
 15791     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15792
 15793     IF CF-ST-CHECK-CNT-RESET
 15794         MOVE +1             TO CF-ST-CHECK-COUNTER
 15795     ELSE
 15796         ADD +1              TO CF-ST-CHECK-COUNTER
 15797     END-IF.
 15798
 15799     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15800     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15801     GO TO 6120-REWRITE.
 15802
 15803 6110-READ-CONTROL.
 15804     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15805     MOVE '1'                    TO CNTL-REC-TYPE.
 15806     MOVE SPACES                 TO CNTL-ACCESS.
 15807     MOVE 0                      TO CNTL-SEQ-NO.
 15808
 15809     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15810
 15811     IF CO-CHECK-COUNT-RESET
 15812        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15813     ELSE
 15814        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15815
 15816     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15817
 15818     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15819         IF PI-OFFLINE     = 'Y'  AND
 15820            PI-ECHECKNO-CR = 'CR'
 15821              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15822              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15823              MOVE AL-UANON           TO CHECKNOA
 15824              GO TO 6120-REWRITE
 15825         ELSE
 15826         IF PI-CASH = 'N'
 15827             MOVE 'N'                TO PI-ECHECKNO-N
 15828             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15829             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15830             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 305
* EL156.cbl
 15831             GO TO 6120-REWRITE.
 15832
 15833     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15834
 15835 6120-REWRITE.
 15836
 15837* EXEC CICS REWRITE
 15838*         DATASET('ELCNTL')
 15839*         FROM(CONTROL-FILE)
 15840*     END-EXEC.
 15841     MOVE LENGTH OF
 15842      CONTROL-FILE
 15843       TO DFHEIV11
 15844     MOVE 'ELCNTL' TO DFHEIV1
 15845*    MOVE '&& L                  %   #00014895' TO DFHEIV0
 15846     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15847     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15848     MOVE X'2020233030303134383935' TO DFHEIV0(25:11)
 15849     CALL 'kxdfhei1' USING DFHEIV0,
 15850           DFHEIV1,
 15851           CONTROL-FILE,
 15852           DFHEIV11,
 15853           DFHEIV99
 15854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15855
 15856
 15857     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15858
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 306
* EL156.cbl
 15860 6130-BUILD-TRAILER.
 15861
 15862
 15863* EXEC CICS GETMAIN
 15864*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15865*         LENGTH    (200)
 15866*         INITIMG   (GETMAIN-SPACE)
 15867*     END-EXEC.
 15868     MOVE 200
 15869       TO DFHEIV11
 15870*    MOVE ',"IL                  $   #00014905' TO DFHEIV0
 15871     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15872     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15873     MOVE X'2020233030303134393035' TO DFHEIV0(25:11)
 15874     CALL 'kxdfhei1' USING DFHEIV0,
 15875           DFHEIV20,
 15876           DFHEIV11,
 15877           GETMAIN-SPACE
 15878     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15879         DFHEIV20
 15880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15881
 15882
 15883     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15884                                    AT-PREV-PAID-THRU-DT.
 15885     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15886     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15887     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15888     MOVE 'AT'                   TO AT-RECORD-ID.
 15889     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15890
 15891     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15892        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15893           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15894     ELSE
 15895           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15896           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15897
 15898     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15899         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15900             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15901             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15902           ELSE
 15903             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15904             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15905
 15906     MOVE '2'                    TO AT-TRAILER-TYPE.
 15907     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15908                                    AT-PAYMENT-LAST-MAINT-DT.
 15909     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15910                                    AT-PAYMENT-LAST-UPDATED-BY.
 15911     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15912     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15913     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15914     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15915
 15916     IF PI-PMT-APPROVED
 15917        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 307
* EL156.cbl
 15918           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15919
 15920     IF PI-PFKEY-USED = DFHPF5
 15921        GO TO 6140-PF5-ENTERED.
 15922
 15923     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15924     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15925
 15926     IF PI-AIG-SPECIAL-BENEFIT
 15927         IF WS-1ST-SPECIAL-PMT
 15928             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15929             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15930                                        AT-AMOUNT-PAID
 15931         ELSE
 15932             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15933
 15934     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15935
 15936     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15937     MOVE '4'                    TO DC-OPTION-CODE.
 15938     PERFORM 9700-LINK-DATE-CONVERT.
 15939
 15940     IF DATE-CONVERSION-ERROR
 15941        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15942     ELSE
 15943        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15944
 15945     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15946     MOVE '4'                    TO DC-OPTION-CODE.
 15947     PERFORM 9700-LINK-DATE-CONVERT.
 15948
 15949     IF DATE-CONVERSION-ERROR
 15950        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15951     ELSE
 15952        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15953
 15954     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15955     move pi-ach-payment         to at-ach-payment
 15956     GO TO 6150-FINISH-MOVE.
 15957
 15958 6140-PF5-ENTERED.
 15959     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15960     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15961
 15962     IF PI-AIG-SPECIAL-BENEFIT
 15963         IF WS-1ST-SPECIAL-PMT
 15964             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15965             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15966                                        AT-AMOUNT-PAID
 15967         ELSE
 15968             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15969
 15970     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15971     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15972     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15973
 15974 6150-FINISH-MOVE.
 15975
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 308
* EL156.cbl
 15976     IF PI-ECHECKNO = SPACES
 15977         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15978     ELSE
 15979         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15980
 15981     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15982     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15983
 15984*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15985*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15986
 15987     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15988         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15989
 15990     IF PI-OFFLINE = 'N'
 15991        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15992        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15993     ELSE
 15994        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15995        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15996
 15997     move pi-ach-payment         to at-ach-payment
 15998     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15999
 16000     IF WS-2ND-SPECIAL-PMT
 16001         MOVE 'Y'                TO AT-CASH-PAYMENT
 16002         MOVE SPACES             TO AT-CHECK-NO
 16003         MOVE '3'                TO AT-PAYMENT-ORIGIN
 16004         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 16005         MOVE 'U'                TO AT-AIG-UNEMP-IND
 16006         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 16007
 16008     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 16009                                    AT-TO-BE-WRITTEN-DT.
 16010
 16011     IF PI-HOLDTIL NOT = ZEROS
 16012        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 16013        MOVE '4'                 TO DC-OPTION-CODE
 16014        PERFORM 9700-LINK-DATE-CONVERT
 16015        IF PI-OFFLINE = 'N'
 16016           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 16017           MOVE 'P'              TO WS-HOLD-UNTIL-SW
 16018        ELSE
 16019           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 16020
 16021     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 16022     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 16023                                    AT-CHECK-QUE-SEQUENCE.
 16024
 16025     IF PI-PFKEY-USED = DFHPF4
 16026        MOVE '1'                 TO AT-FORCE-CONTROL.
 16027
 16028     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 16029        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 16030        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 16031        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 16032
 16033     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 309
* EL156.cbl
 16034                                    AT-VOID-SELECT-DT
 16035                                    AT-VOID-ACCEPT-DT
 16036                                    AT-VOID-DT.
 16037     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 16038        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 16039        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 16040        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 16041        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 16042     ELSE
 16043        MOVE ZEROS               TO AT-DAILY-RATE
 16044                                    AT-ELIMINATION-DAYS
 16045        MOVE SPACES              TO AT-BENEFIT-TYPE
 16046     END-IF
 16047     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 16048     MOVE '4'                    TO DC-OPTION-CODE.
 16049     PERFORM 9700-LINK-DATE-CONVERT.
 16050     IF DATE-CONVERSION-ERROR
 16051         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 16052     ELSE
 16053         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 16054     END-IF.
 16055     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 16056     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 16057     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 16058     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 16059     IF (PI-REAUDIT-NEEDED = 'Y')
 16060        or (pi-max-ext-used = 'Y')
 16061        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 16062        OR PI-DUPE-APPROVAL-NEEDED = 'Y'
 16063         PERFORM 6155-READ-CONTROL
 16064         PERFORM 6157-SET-APP-LEVEL
 16065         IF AT-APPROVAL-LEVEL-REQD < '4'
 16066            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 16067         END-IF
 16068         MOVE 'Y' TO WS-NEED-APPROVAL
 16069         GO TO 6170-WRITE
 16070     END-IF.
 16071*******************************************************
 16072     IF NOT PI-PMT-GRADUATED
 16073         GO TO 6170-WRITE.
 16074     PERFORM 6155-READ-CONTROL.
 16075
 16076     IF PAID-FOR-LIFE
 16077         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 16078             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16079                                     WS-PMT-APPROVAL-SW
 16080             GO TO 6170-WRITE.
 16081
 16082*05999      IF PAID-FOR-AH
 16083     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 16084         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 16085             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16086                                     WS-PMT-APPROVAL-SW
 16087             GO TO 6170-WRITE.
 16088
 16089     MOVE '1'                    TO AT-APPROVED-LEVEL.
 16090
 16091     PERFORM 6157-SET-APP-LEVEL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 310
* EL156.cbl
 16092
 16093     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 16094
 16095     IF NOT PI-PMT-GRADUATED
 16096         GO TO 6170-WRITE.
 16097
 16098
 16099* EXEC CICS HANDLE CONDITION
 16100*        NOTFND   (6170-WRITE)
 16101*    END-EXEC.
 16102*    MOVE '"$I                   ! 2 #00015126' TO DFHEIV0
 16103     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16105     MOVE X'3220233030303135313236' TO DFHEIV0(25:11)
 16106     CALL 'kxdfhei1' USING DFHEIV0
 16107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16108
 16109
 16110     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16111     MOVE '2'                    TO CNTL-REC-TYPE.
 16112     MOVE +0                     TO CNTL-SEQ-NO.
 16113     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16114
 16115
 16116* EXEC CICS READ
 16117*         DATASET  ('ELCNTL')
 16118*         SET      (ADDRESS OF CONTROL-FILE)
 16119*         RIDFLD   (ELCNTL-KEY)
 16120*    END-EXEC.
 16121     MOVE 'ELCNTL' TO DFHEIV1
 16122*    MOVE '&"S        E          (   #00015135' TO DFHEIV0
 16123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16125     MOVE X'2020233030303135313335' TO DFHEIV0(25:11)
 16126     CALL 'kxdfhei1' USING DFHEIV0,
 16127           DFHEIV1,
 16128           DFHEIV20,
 16129           DFHEIV99,
 16130           ELCNTL-KEY,
 16131           DFHEIV99,
 16132           DFHEIV99,
 16133           DFHEIV99
 16134     SET ADDRESS OF CONTROL-FILE TO
 16135         DFHEIV20
 16136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16137
 16138
 16139     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 16140
 16141     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 16142                         OR '4' OR '5'
 16143         NEXT SENTENCE
 16144     ELSE
 16145         MOVE 'Y' TO WS-NEED-APPROVAL
 16146         GO TO 6170-WRITE.
 16147
 16148     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 16149         MOVE 'Y' TO WS-NEED-APPROVAL
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 311
* EL156.cbl
 16150         IF WS-APPROVAL-LEVEL = '1'
 16151             MOVE '2'        TO  AT-APPROVED-LEVEL
 16152                            WS-SAVE-APPROVED-LEVEL
 16153             GO TO 6170-WRITE
 16154         ELSE
 16155             IF WS-APPROVAL-LEVEL = '2'
 16156                 MOVE '3'        TO  AT-APPROVED-LEVEL
 16157                                WS-SAVE-APPROVED-LEVEL
 16158                 GO TO 6170-WRITE
 16159             ELSE IF WS-APPROVAL-LEVEL = '3'
 16160                 MOVE '4'        TO  AT-APPROVED-LEVEL
 16161                                WS-SAVE-APPROVED-LEVEL
 16162                 GO TO 6170-WRITE
 16163             ELSE IF WS-APPROVAL-LEVEL = '4'
 16164                 MOVE '5'        TO  AT-APPROVED-LEVEL
 16165                                WS-SAVE-APPROVED-LEVEL
 16166                 GO TO 6170-WRITE.
 16167
 16168     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16169                             WS-PMT-APPROVAL-SW.
 16170     MOVE SPACES         TO  AT-APPROVED-LEVEL
 16171                             AT-APPROVAL-LEVEL-REQD.
 16172
 16173*******************************************************
 16174 6155-READ-CONTROL.
 16175     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16176     MOVE '1'                    TO CNTL-REC-TYPE.
 16177     MOVE SPACES                 TO CNTL-ACCESS.
 16178     MOVE +0                     TO CNTL-SEQ-NO.
 16179     MOVE 'COMP'                 TO FILE-SWITCH.
 16180
 16181     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16182 6157-SET-APP-LEVEL.
 16183******A&H Limits are set as a monthly payment.  Calculate the mont
 16184******equivalent of the amount paid today
 16185     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 16186        PI-SAVE-ODD-DAYS-OVER > 0
 16187           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 16188                               / 30) + PI-SAVE-ELAPSED-MONTHS
 16189           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 16190                                  WS-CALC-PMT-MONTHS
 16191     ELSE
 16192           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 16193     END-IF.
 16194*06007      IF ((PAID-FOR-AH) AND
 16195     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16196           OR PAID-FOR-FAM) AND
 16197*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16198        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 16199              OR
 16200        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16201        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16202            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16203       ELSE
 16204*06014      IF ((PAID-FOR-AH)  AND
 16205         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16206           OR PAID-FOR-FAM) AND
 16207*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 312
* EL156.cbl
 16208           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 16209              OR
 16210        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16211        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16212            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16213         ELSE
 16214*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 16215           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16216                OR PAID-FOR-FAM) AND
 16217               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 16218              OR
 16219          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16220          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 16221            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16222       ELSE
 16223           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16224                OR PAID-FOR-FAM) AND
 16225               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16226              OR
 16227          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16228          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16229            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16230       ELSE
 16231            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16232
 16233     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16234           OR PAID-FOR-FAM) AND
 16235        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16236        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16237            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16238        END-IF
 16239     ELSE
 16240     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16241           OR PAID-FOR-FAM) AND
 16242        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16243        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16244            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16245        END-IF
 16246     ELSE
 16247     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16248           OR PAID-FOR-FAM) AND
 16249        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16250        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16251            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16252        END-IF
 16253     ELSE
 16254     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16255           OR PAID-FOR-FAM) AND
 16256        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16257        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16258            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16259        END-IF
 16260     ELSE
 16261     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16262           OR PAID-FOR-FAM)
 16263            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16264
 16265 6170-WRITE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 313
* EL156.cbl
 16266
 16267     if pi-company-id = 'DCC' or 'VPP'
 16268        PERFORM 0900-GET-DDF-limits
 16269                                 THRU 0900-EXIT
 16270     end-if
 16271     perform 2220-update-elcrtt  thru 2220-exit
 16272     IF PI-COMPANY-ID = 'DMD'
 16273        IF PI-AT-EOB-CODES NOT = SPACES
 16274           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16275           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16276           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16277           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16278           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16279
 16280
 16281* EXEC CICS HANDLE CONDITION
 16282*        DUPREC    (6180-DUPREC)
 16283*    END-EXEC.
 16284*    MOVE '"$%                   ! 3 #00015282' TO DFHEIV0
 16285     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16286     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16287     MOVE X'3320233030303135323832' TO DFHEIV0(25:11)
 16288     CALL 'kxdfhei1' USING DFHEIV0
 16289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16290
 16291
 16292
 16293* EXEC CICS WRITE
 16294*         DATASET       ('ELTRLR')
 16295*         FROM          (ACTIVITY-TRAILERS)
 16296*         RIDFLD        (AT-CONTROL-PRIMARY)
 16297*     END-EXEC.
 16298     MOVE LENGTH OF
 16299      ACTIVITY-TRAILERS
 16300       TO DFHEIV11
 16301     MOVE 'ELTRLR' TO DFHEIV1
 16302*    MOVE '&$ L                  ''   #00015286' TO DFHEIV0
 16303     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16304     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16305     MOVE X'2020233030303135323836' TO DFHEIV0(25:11)
 16306     CALL 'kxdfhei1' USING DFHEIV0,
 16307           DFHEIV1,
 16308           ACTIVITY-TRAILERS,
 16309           DFHEIV11,
 16310           AT-CONTROL-PRIMARY,
 16311           DFHEIV99,
 16312           DFHEIV99
 16313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16314
 16315
 16316     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16317        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16318*06088           GO TO 6199-EXIT.
 16319           GO TO 6176-APPROVAL-NOTE.
 16320
 16321
 16322* EXEC CICS GETMAIN
 16323*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 314
* EL156.cbl
 16324*         LENGTH    (200)
 16325*         INITIMG   (GETMAIN-SPACE)
 16326*     END-EXEC.
 16327     MOVE 200
 16328       TO DFHEIV11
 16329*    MOVE ',"IL                  $   #00015297' TO DFHEIV0
 16330     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16331     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16332     MOVE X'2020233030303135323937' TO DFHEIV0(25:11)
 16333     CALL 'kxdfhei1' USING DFHEIV0,
 16334           DFHEIV20,
 16335           DFHEIV11,
 16336           GETMAIN-SPACE
 16337     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16338         DFHEIV20
 16339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16340
 16341
 16342     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16343
 16344     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16345     MOVE 'AT'                   TO AT-RECORD-ID.
 16346     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16347     MOVE '6'                    TO AT-TRAILER-TYPE.
 16348     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16349                                    AT-GEN-INFO-LAST-MAINT-DT
 16350     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16351                                    AT-GEN-INFO-LAST-UPDATED-BY
 16352     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16353
 16354     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16355     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16356     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16357
 16358     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16359
 16360 6175-WRITE.
 16361
 16362
 16363* EXEC CICS HANDLE CONDITION
 16364*        DUPREC    (6190-DUPREC)
 16365*    END-EXEC.
 16366*    MOVE '"$%                   ! 4 #00015323' TO DFHEIV0
 16367     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16368     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16369     MOVE X'3420233030303135333233' TO DFHEIV0(25:11)
 16370     CALL 'kxdfhei1' USING DFHEIV0
 16371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16372
 16373
 16374
 16375* EXEC CICS WRITE
 16376*         DATASET     ('ELTRLR')
 16377*         FROM        (ACTIVITY-TRAILERS)
 16378*         RIDFLD      (AT-CONTROL-PRIMARY)
 16379*     END-EXEC.
 16380     MOVE LENGTH OF
 16381      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 315
* EL156.cbl
 16382       TO DFHEIV11
 16383     MOVE 'ELTRLR' TO DFHEIV1
 16384*    MOVE '&$ L                  ''   #00015327' TO DFHEIV0
 16385     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16386     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16387     MOVE X'2020233030303135333237' TO DFHEIV0(25:11)
 16388     CALL 'kxdfhei1' USING DFHEIV0,
 16389           DFHEIV1,
 16390           ACTIVITY-TRAILERS,
 16391           DFHEIV11,
 16392           AT-CONTROL-PRIMARY,
 16393           DFHEIV99,
 16394           DFHEIV99
 16395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16396
 16397
 16398 6176-APPROVAL-NOTE.
 16399
 16400     IF NOT APPROVAL-NEEDED
 16401         GO TO 6199-EXIT.
 16402
 16403
 16404* EXEC CICS GETMAIN
 16405*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16406*        LENGTH    (200)
 16407*        INITIMG   (GETMAIN-SPACE)
 16408*    END-EXEC.
 16409     MOVE 200
 16410       TO DFHEIV11
 16411*    MOVE ',"IL                  $   #00015338' TO DFHEIV0
 16412     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16413     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16414     MOVE X'2020233030303135333338' TO DFHEIV0(25:11)
 16415     CALL 'kxdfhei1' USING DFHEIV0,
 16416           DFHEIV20,
 16417           DFHEIV11,
 16418           GETMAIN-SPACE
 16419     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16420         DFHEIV20
 16421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16422
 16423
 16424     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16425
 16426     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16427     MOVE 'AT'               TO AT-RECORD-ID
 16428     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16429     MOVE '6'                TO AT-TRAILER-TYPE
 16430     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16431                                AT-GEN-INFO-LAST-MAINT-DT
 16432     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16433                                AT-GEN-INFO-LAST-UPDATED-BY
 16434     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16435
 16436     IF PI-REAUDIT-NEEDED = 'Y'
 16437         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16438     ELSE
 16439         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 316
* EL156.cbl
 16440     END-IF
 16441     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16442         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16443     END-IF
 16444     IF PI-DUPE-APPROVAL-NEEDED = 'Y'
 16445         MOVE WS-DUPE-APPROV-NOTE TO AT-INFO-LINE-1
 16446     END-IF
 16447
 16448     MOVE SPACES             TO AT-INFO-LINE-2
 16449
 16450     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16451 6177-WRITE.
 16452
 16453
 16454* EXEC CICS HANDLE CONDITION
 16455*        DUPREC    (6185-DUPREC)
 16456*    END-EXEC.
 16457*    MOVE '"$%                   ! 5 #00015373' TO DFHEIV0
 16458     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16460     MOVE X'3520233030303135333733' TO DFHEIV0(25:11)
 16461     CALL 'kxdfhei1' USING DFHEIV0
 16462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16463
 16464
 16465
 16466* EXEC CICS WRITE
 16467*         DATASET     ('ELTRLR')
 16468*         FROM        (ACTIVITY-TRAILERS)
 16469*         RIDFLD      (AT-CONTROL-PRIMARY)
 16470*     END-EXEC.
 16471     MOVE LENGTH OF
 16472      ACTIVITY-TRAILERS
 16473       TO DFHEIV11
 16474     MOVE 'ELTRLR' TO DFHEIV1
 16475*    MOVE '&$ L                  ''   #00015377' TO DFHEIV0
 16476     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16477     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16478     MOVE X'2020233030303135333737' TO DFHEIV0(25:11)
 16479     CALL 'kxdfhei1' USING DFHEIV0,
 16480           DFHEIV1,
 16481           ACTIVITY-TRAILERS,
 16482           DFHEIV11,
 16483           AT-CONTROL-PRIMARY,
 16484           DFHEIV99,
 16485           DFHEIV99
 16486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16487
 16488
 16489
 16490     GO TO 6199-EXIT.
 16491
 16492 6180-DUPREC.
 16493
 16494     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16495     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16496     GO TO 6170-WRITE.
 16497
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 317
* EL156.cbl
 16498 6185-DUPREC.
 16499     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16500     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16501     GO TO 6177-WRITE.
 16502
 16503 6190-DUPREC.
 16504     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16505     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16506     GO TO 6175-WRITE.
 16507
 16508 6199-EXIT.
 16509      EXIT.
 16510
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 318
* EL156.cbl
 16512 6200-UPDATE-CLAIM-MSTR.
 16513     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16514     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16515     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16516     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16517
 16518     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16519
 16520     MOVE ZEROS                  TO W-INTEREST.
 16521
 16522     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 16523           OR 'FNL'
 16524        IF (PI-OFFLINE = 'Y') OR
 16525           (PI-PMTTYPE = '7')
 16526           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16527                                 THRU 9870-EXIT
 16528        END-IF
 16529     END-IF
 16530     IF NOT ERROR-ON-OUTPUT
 16531        CONTINUE
 16532     ELSE
 16533
 16534* EXEC CICS REWRITE
 16535*          DATASET('ELMSTR')
 16536*          FROM(CLAIM-MASTER)
 16537*       END-EXEC
 16538     MOVE LENGTH OF
 16539      CLAIM-MASTER
 16540       TO DFHEIV11
 16541     MOVE 'ELMSTR' TO DFHEIV1
 16542*    MOVE '&& L                  %   #00015427' TO DFHEIV0
 16543     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16544     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16545     MOVE X'2020233030303135343237' TO DFHEIV0(25:11)
 16546     CALL 'kxdfhei1' USING DFHEIV0,
 16547           DFHEIV1,
 16548           CLAIM-MASTER,
 16549           DFHEIV11,
 16550           DFHEIV99
 16551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16552
 16553        MOVE -1                  TO ENTPFBL
 16554        MOVE AL-UANON            TO ENTPFBA
 16555        MOVE MAP-NAMEB           TO MAP-NAME
 16556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16557        GO TO 8200-SEND-DATAONLY
 16558     END-IF
 16559
 16560     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16561
 16562     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16563
 16564     IF PI-AIG-SPECIAL-BENEFIT
 16565         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16566
 16567     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16568
 16569     IF PI-SPECIAL-BEN-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 319
* EL156.cbl
 16570         MOVE '2' TO WS-PAYMENT-TRAILER-SW
 16571         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16572
 16573     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16574         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16575     ELSE
 16576         IF PI-PMTTYPE NOT = '4'
 16577            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16578
 16579     IF PI-PMTTYPE = '5' OR '6'
 16580        GO TO  6250-SET-MAINT.
 16581
 16582     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16583                                         CL-LAG-REPORT-CODE.
 16584
 16585     IF CL-ACTIVITY-CODE = 09
 16586         GO TO 6200-CONT-UPDATE.
 16587
 16588     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16589         IF CL-ACTIVITY-CODE = 11
 16590             GO TO 6200-CONT-UPDATE.
 16591
 16592     IF WS-ACT-REC-FOUND-SW = 'N'
 16593         GO TO 6200-CONT-UPDATE.
 16594
 16595     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16596         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16597         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16598         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16599
 16600     IF WS-UPDATE-SW = 'Y'
 16601         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16602                                         CL-NEXT-FOLLOWUP-DT.
 16603
 16604 6200-CONT-UPDATE.
 16605
 16606     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16607       IF CLAIM-IS-CLOSED
 16608         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16609           IF WS-OPEN-CLOSE-SW = '2'
 16610             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16611                                        CL-LAST-CLOSE-DT.
 16612
 16613     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16614        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16615        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16616
 16617     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16618        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16619        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16620        MOVE 'C'                 TO CL-CLAIM-STATUS
 16621        IF PI-PMTTYPE = '2'
 16622           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16623              or 'F')
 16624           CONTINUE
 16625        ELSE
 16626           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16627        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 320
* EL156.cbl
 16628     ELSE
 16629        IF PI-PMTTYPE = '2' OR '3'
 16630           IF PI-PMTTYPE = '2' AND
 16631              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16632                 or 'F')
 16633              CONTINUE
 16634           ELSE
 16635              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16636           END-IF
 16637        END-IF
 16638     END-IF
 16639
 16640     IF PI-PMTTYPE = '4'
 16641        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16642
 16643     IF PI-COMPANY-ID = 'CVL'
 16644         IF PI-LOAN-UPDATE-SW = 'Y'
 16645             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16646             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16647             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16648             MOVE CL-CERT-STATE      TO  CERT-STATE
 16649             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16650             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16651             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16652             MOVE 'CERT'             TO  FILE-SWITCH
 16653             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16654             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16655             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16656
 16657     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16658        GO TO 6220-USE-COMPUTED.
 16659
 16660     IF (PI-PMTTYPE = '4')  AND
 16661        (PI-EPYAMT < ZEROS)
 16662          COMPUTE CL-NO-OF-DAYS-PAID =
 16663                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16664          IF CL-NO-OF-DAYS-PAID < +0
 16665              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16666          ELSE
 16667              NEXT SENTENCE
 16668     ELSE
 16669          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16670
 16671     IF HOLD-UNTIL-PMT
 16672        CONTINUE
 16673     ELSE
 16674     IF PI-PROCESSOR-ID = 'FIX '
 16675        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16676           NEXT SENTENCE
 16677        ELSE
 16678           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16679     ELSE
 16680        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16681
 16682     IF PI-PMTTYPE = '4'
 16683        GO TO 6250-SET-MAINT.
 16684
 16685     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 321
* EL156.cbl
 16686     MOVE '4'                    TO DC-OPTION-CODE.
 16687     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16688     IF HOLD-UNTIL-PMT
 16689        CONTINUE
 16690     ELSE
 16691     IF DATE-CONVERSION-ERROR
 16692        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16693     ELSE
 16694        ADD 1                 TO CL-NO-OF-PMTS-MADE
 16695        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16696           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16697           IF PI-AIG-SPECIAL-BENEFIT
 16698               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16699           ELSE
 16700               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16701
 16702     GO TO 6250-SET-MAINT.
 16703
 16704 6220-USE-COMPUTED.
 16705
 16706     IF (PI-PMTTYPE = '4')  AND
 16707        (PI-CPYAMT < ZEROS)
 16708          COMPUTE CL-NO-OF-DAYS-PAID =
 16709                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16710          IF CL-NO-OF-DAYS-PAID < +0
 16711              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16712          ELSE
 16713              NEXT SENTENCE
 16714     ELSE
 16715          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16716
 16717     IF NOT HOLD-UNTIL-PMT
 16718        ADD 1                    TO CL-NO-OF-PMTS-MADE
 16719        ADD PI-CPYAMT            TO CL-TOTAL-PAID-AMT.
 16720
 16721     IF PI-PMTTYPE = '4'
 16722        GO TO 6250-SET-MAINT.
 16723
 16724     IF PI-AIG-SPECIAL-BENEFIT
 16725         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16726     ELSE
 16727         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16728
 16729     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16730       AND NOT HOLD-UNTIL-PMT
 16731        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16732
 16733 6250-SET-MAINT.
 16734     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16735
 16736     IF PI-PROCESSOR-ID = 'FIX '
 16737        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16738           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16739        ELSE
 16740           NEXT SENTENCE
 16741     ELSE
 16742        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16743
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 322
* EL156.cbl
 16744     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16745     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16746     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16747
 16748 6299-EXIT.
 16749      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 323
* EL156.cbl
 16751 6300-UPDATE-CERT.
 16752
 16753*  ADD CERTNOTE FOR SC NP+6
 16754     IF PI-COMPANY-ID = 'CID' AND
 16755       (PI-PMTTYPE = '2' OR '3') AND
 16756        CL-CERT-STATE = 'SC'  AND
 16757        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16758           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16759     END-IF.
 16760
 16761     IF PI-COMPANY-ID = 'AHL' AND
 16762       (PI-PMTTYPE = '2' OR '3') AND
 16763        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16764           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16765           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16766     END-IF.
 16767
 16768     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16769     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16770     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16771     MOVE CL-CERT-STATE    TO CERT-STATE.
 16772     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16773     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16774     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16775     MOVE 'CERT'           TO FILE-SWITCH.
 16776
 16777     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16778
 16779     IF CERT-NOTE-ADDED
 16780        IF CM-NOTE-SW = ' '
 16781           MOVE '4'             TO CM-NOTE-SW
 16782        ELSE
 16783           IF CM-NOTE-SW = '1'
 16784               MOVE '5'           TO CM-NOTE-SW
 16785           ELSE
 16786              IF CM-NOTE-SW = '2'
 16787                 MOVE '6'         TO CM-NOTE-SW
 16788              ELSE
 16789                 IF CM-NOTE-SW = '3'
 16790                    MOVE '7'      TO CM-NOTE-SW
 16791                 END-IF
 16792              END-IF
 16793           END-IF
 16794        END-IF
 16795     END-IF.
 16796
 16797     IF PI-COMPANY-ID = 'CVL'
 16798         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16799         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16800
 16801     IF PI-PMTTYPE NOT = '4'
 16802        GO TO 6340-UPDATE-CERT.
 16803
 16804     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16805        IF PI-PFKEY-USED = DFHPF5
 16806           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16807        ELSE
 16808           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 324
* EL156.cbl
 16809
 16810*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16811*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16812*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16813*               PI-LF-COVERAGE-TYPE = 'P'
 16814*                GO TO 6350-REWRITE-CERT.
 16815
 16816     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16817       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16818          PI-LF-COVERAGE-TYPE = 'P'
 16819           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16820                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16821                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16822                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16823                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16824                GO TO 6350-REWRITE-CERT
 16825            ELSE
 16826                GO TO 6350-REWRITE-CERT.
 16827
 16828     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16829         GO TO 6350-REWRITE-CERT.
 16830
 16831     IF NOT CM-AH-LUMP-SUM-DISAB
 16832        GO TO 6380-UNLOCK-CERT.
 16833
 16834     IF PI-PFKEY-USED = DFHPF5
 16835        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16836                                    CM-AH-ITD-AH-PMT
 16837        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16838        GO TO 6350-REWRITE-CERT
 16839     ELSE
 16840        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16841                                    CM-AH-ITD-AH-PMT
 16842        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16843        GO TO 6350-REWRITE-CERT.
 16844
 16845 6340-UPDATE-CERT.
 16846
 16847     IF CL-CLAIM-TYPE = 'L' OR 'O'
 16848         IF PI-PFKEY-USED = DFHPF5
 16849             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16850         ELSE
 16851             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16852
 16853     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16854         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16855             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16856                PI-LF-COVERAGE-TYPE = 'P'
 16857                 GO TO 6350-REWRITE-CERT.
 16858
 16859     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16860       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16861          PI-LF-COVERAGE-TYPE = 'P'
 16862           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16863                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16864                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16865                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16866                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 325
* EL156.cbl
 16867                GO TO 6350-REWRITE-CERT.
 16868
 16869     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16870         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16871            PI-LF-COVERAGE-TYPE NOT = 'P'
 16872             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16873             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16874             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16875             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16876             GO TO 6350-REWRITE-CERT.
 16877
 16878     IF CL-CLAIM-TYPE = 'O'
 16879         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16880            PI-LF-COVERAGE-TYPE NOT = 'P'
 16881             MOVE CL-INCURRED-DT         TO CM-LF-CANCEL-DT
 16882             MOVE PI-MONTH-END-SAVE      TO CM-LF-CANCEL-EXIT-DT
 16883             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-CANCEL
 16884             MOVE '6'            TO CM-LF-CURRENT-STATUS
 16885             GO TO 6350-REWRITE-CERT.
 16886
 16887     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16888         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16889         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16890         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16891         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16892         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16893         IF PI-PFKEY-USED = DFHPF5
 16894             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16895                                        CM-AH-ITD-AH-PMT
 16896             GO TO 6350-REWRITE-CERT
 16897         ELSE
 16898             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16899                                        CM-AH-ITD-AH-PMT
 16900             GO TO 6350-REWRITE-CERT.
 16901
 16902 6350-REWRITE-CERT.
 16903
 16904
 16905* EXEC CICS REWRITE
 16906*         DATASET  ('ELCERT')
 16907*         FROM(CERTIFICATE-MASTER)
 16908*     END-EXEC.
 16909     MOVE LENGTH OF
 16910      CERTIFICATE-MASTER
 16911       TO DFHEIV11
 16912     MOVE 'ELCERT' TO DFHEIV1
 16913*    MOVE '&& L                  %   #00015783' TO DFHEIV0
 16914     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16915     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16916     MOVE X'2020233030303135373833' TO DFHEIV0(25:11)
 16917     CALL 'kxdfhei1' USING DFHEIV0,
 16918           DFHEIV1,
 16919           CERTIFICATE-MASTER,
 16920           DFHEIV11,
 16921           DFHEIV99
 16922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16923
 16924
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 326
* EL156.cbl
 16925     GO TO 6399-EXIT.
 16926
 16927 6380-UNLOCK-CERT.
 16928
 16929* EXEC CICS UNLOCK
 16930*         DATASET  ('ELCERT')
 16931*     END-EXEC.
 16932     MOVE 'ELCERT' TO DFHEIV1
 16933*    MOVE '&*                    #   #00015791' TO DFHEIV0
 16934     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16935     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16936     MOVE X'2020233030303135373931' TO DFHEIV0(25:11)
 16937     CALL 'kxdfhei1' USING DFHEIV0,
 16938           DFHEIV1,
 16939           DFHEIV99
 16940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16941
 16942
 16943 6399-EXIT.
 16944      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 327
* EL156.cbl
 16946 6400-UPDATE-ZERO-TRAILER.
 16947     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16948     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16949
 16950     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16951
 16952     IF PI-EPYAMT NOT = ZEROS
 16953         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16954     ELSE
 16955         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16956
 16957     IF PI-ERESV NOT = ZEROS
 16958        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16959
 16960     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16961        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16962
 16963     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16964        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16965     ELSE
 16966        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16967
 16968     IF PI-PMTTYPE = '5'
 16969        IF PI-EPYAMT = ZEROS
 16970           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16971        ELSE
 16972           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16973
 16974     IF PI-PMTTYPE = '6'
 16975        IF PI-EPYAMT = ZEROS
 16976           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16977        ELSE
 16978           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16979
 16980 6420-CHECK-OPEN-CLOSE.
 16981     IF PI-PMTTYPE = '5' OR '6'
 16982        GO TO 6450-REWRITE.
 16983
 16984     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16985         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16986             IF CLAIM-IS-CLOSED
 16987                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16988                 MOVE 1          TO  SUB-1
 16989                 GO TO 6440-AIG-LOOP.
 16990
 16991     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16992        GO TO 6450-REWRITE.
 16993
 16994     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16995        GO TO 6450-REWRITE.
 16996
 16997     MOVE 1                      TO SUB-1.
 16998
 16999 6430-LOOP.
 17000     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 17001        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 17002        IF PI-PMTTYPE = '1' OR '4'
 17003           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 328
* EL156.cbl
 17004           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 17005           GO TO 6450-REWRITE
 17006        ELSE
 17007           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 17008           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 17009           GO TO 6450-REWRITE.
 17010
 17011     IF SUB-1 = 6
 17012      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 17013      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 17014      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 17015      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 17016      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 17017      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 17018      GO TO 6430-LOOP.
 17019
 17020     ADD 1                       TO SUB-1.
 17021     GO TO 6430-LOOP.
 17022
 17023
 17024 6440-AIG-LOOP.
 17025
 17026     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 17027       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 17028       IF WS-OPEN-CLOSE-SW = '1'
 17029         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 17030         IF PI-PMTTYPE = '2'
 17031           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17032           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 17033         ELSE
 17034           IF PI-PMTTYPE = '3'
 17035             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17036             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 17037           ELSE
 17038             IF PI-PMTTYPE = '4'
 17039               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17040               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 17041             ELSE
 17042               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17043               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 17044       ELSE
 17045         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 17046         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17047         GO TO 6450-REWRITE.
 17048
 17049     IF SUB-1 = 6
 17050      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 17051      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 17052      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 17053      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 17054      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 17055      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 17056      GO TO 6440-AIG-LOOP.
 17057
 17058     ADD 1                       TO SUB-1.
 17059     GO TO 6440-AIG-LOOP.
 17060
 17061 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 329
* EL156.cbl
 17062     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 17063     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 17064     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 17065
 17066     IF PI-COMPANY-ID = 'DMD'
 17067         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 17068         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 17069         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 17070         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 17071         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 17072
 17073
 17074* EXEC CICS REWRITE
 17075*         DATASET  ('ELTRLR')
 17076*         FROM     (ACTIVITY-TRAILERS)
 17077*     END-EXEC.
 17078     MOVE LENGTH OF
 17079      ACTIVITY-TRAILERS
 17080       TO DFHEIV11
 17081     MOVE 'ELTRLR' TO DFHEIV1
 17082*    MOVE '&& L                  %   #00015925' TO DFHEIV0
 17083     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17084     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17085     MOVE X'2020233030303135393235' TO DFHEIV0(25:11)
 17086     CALL 'kxdfhei1' USING DFHEIV0,
 17087           DFHEIV1,
 17088           ACTIVITY-TRAILERS,
 17089           DFHEIV11,
 17090           DFHEIV99
 17091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17092
 17093
 17094 6499-EXIT.
 17095      EXIT.
 17096
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 330
* EL156.cbl
 17098 6500-READ-DLO035.
 17099     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 17100     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17101     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17102     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17103
 17104
 17105* EXEC CICS LINK
 17106*        PROGRAM    ('DLO035')
 17107*        COMMAREA   (DLO035-KEY)
 17108*        LENGTH     (DL35-LENGTH)
 17109*    END-EXEC.
 17110     MOVE 'DLO035' TO DFHEIV1
 17111*    MOVE '."C                   (   #00015940' TO DFHEIV0
 17112     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17113     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17114     MOVE X'2020233030303135393430' TO DFHEIV0(25:11)
 17115     CALL 'kxdfhei1' USING DFHEIV0,
 17116           DFHEIV1,
 17117           DLO035-KEY,
 17118           DL35-LENGTH,
 17119           DFHEIV99,
 17120           DFHEIV99,
 17121           DFHEIV99,
 17122           DFHEIV99
 17123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17124
 17125
 17126     IF DL35-RETURN-CODE = 'OK'
 17127         GO TO 6500-EXIT.
 17128
 17129     IF DL35-RETURN-CODE = '01'
 17130         MOVE ER-7830            TO EMI-ERROR
 17131         GO TO 6500-BAD-EXIT.
 17132
 17133     IF DL35-RETURN-CODE = '02'
 17134         MOVE ER-7831            TO EMI-ERROR
 17135         GO TO 6500-BAD-EXIT.
 17136
 17137     IF DL35-RETURN-CODE = '03'
 17138         MOVE ER-7832            TO EMI-ERROR
 17139         GO TO 6500-BAD-EXIT.
 17140
 17141     IF DL35-RETURN-CODE = '04'
 17142         MOVE ER-7833            TO EMI-ERROR
 17143         GO TO 6500-BAD-EXIT.
 17144
 17145     IF DL35-RETURN-CODE = '05'
 17146         MOVE ER-7834            TO EMI-ERROR
 17147         GO TO 6500-BAD-EXIT.
 17148
 17149     IF DL35-RETURN-CODE = '06'
 17150         MOVE ER-7835            TO EMI-ERROR
 17151         GO TO 6500-BAD-EXIT.
 17152
 17153     IF DL35-RETURN-CODE = '07'
 17154         MOVE ER-7836            TO EMI-ERROR
 17155         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 331
* EL156.cbl
 17156
 17157     IF DL35-RETURN-CODE = 'E1'
 17158         MOVE ER-7837            TO EMI-ERROR
 17159         GO TO 6500-BAD-EXIT.
 17160
 17161     IF DL35-RETURN-CODE NOT = 'OK'
 17162         MOVE ER-7838            TO EMI-ERROR
 17163         GO TO 6500-BAD-EXIT.
 17164
 17165 6500-EXIT.
 17166      EXIT.
 17167
 17168 6500-BAD-EXIT.
 17169
 17170* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17171*    MOVE '6"R                   !   #00015989' TO DFHEIV0
 17172     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17174     MOVE X'2020233030303135393839' TO DFHEIV0(25:11)
 17175     CALL 'kxdfhei1' USING DFHEIV0
 17176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17177
 17178     MOVE -1                 TO PMTTYPEL.
 17179     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17180     GO TO 8200-SEND-DATAONLY.
 17181
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 332
* EL156.cbl
 17183 6600-UPDATE-DLO035.
 17184     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 17185     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17186     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17187     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17188
 17189
 17190* EXEC CICS LINK
 17191*        PROGRAM    ('DLO035')
 17192*        COMMAREA   (DLO035-KEY)
 17193*        LENGTH     (DL35-LENGTH)
 17194*    END-EXEC.
 17195     MOVE 'DLO035' TO DFHEIV1
 17196*    MOVE '."C                   (   #00016001' TO DFHEIV0
 17197     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17198     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17199     MOVE X'2020233030303136303031' TO DFHEIV0(25:11)
 17200     CALL 'kxdfhei1' USING DFHEIV0,
 17201           DFHEIV1,
 17202           DLO035-KEY,
 17203           DL35-LENGTH,
 17204           DFHEIV99,
 17205           DFHEIV99,
 17206           DFHEIV99,
 17207           DFHEIV99
 17208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17209
 17210
 17211     IF DL35-RETURN-CODE = 'OK'
 17212         GO TO 6600-EXIT.
 17213
 17214     IF DL35-RETURN-CODE = '01'
 17215         MOVE ER-7830            TO EMI-ERROR
 17216         GO TO 6500-BAD-EXIT.
 17217
 17218     IF DL35-RETURN-CODE = '02'
 17219         MOVE ER-7831            TO EMI-ERROR
 17220         GO TO 6500-BAD-EXIT.
 17221
 17222     IF DL35-RETURN-CODE = '03'
 17223         MOVE ER-7832            TO EMI-ERROR
 17224         GO TO 6500-BAD-EXIT.
 17225
 17226     IF DL35-RETURN-CODE = '04'
 17227         MOVE ER-7833            TO EMI-ERROR
 17228         GO TO 6500-BAD-EXIT.
 17229
 17230     IF DL35-RETURN-CODE = '05'
 17231         MOVE ER-7834            TO EMI-ERROR
 17232         GO TO 6500-BAD-EXIT.
 17233
 17234     IF DL35-RETURN-CODE = '06'
 17235         MOVE ER-7835            TO EMI-ERROR
 17236         GO TO 6500-BAD-EXIT.
 17237
 17238     IF DL35-RETURN-CODE = '07'
 17239         MOVE ER-7836            TO EMI-ERROR
 17240         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 333
* EL156.cbl
 17241
 17242     IF DL35-RETURN-CODE = 'E1'
 17243         MOVE ER-7837            TO EMI-ERROR
 17244         GO TO 6500-BAD-EXIT.
 17245
 17246     IF DL35-RETURN-CODE NOT = 'OK'
 17247         MOVE ER-7838            TO EMI-ERROR
 17248         GO TO 6500-BAD-EXIT.
 17249
 17250 6600-EXIT.
 17251      EXIT.
 17252
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 334
* EL156.cbl
 17254 6700-UPDATE-ACTQ.
 17255***************************************************************
 17256*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17257*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17258*    ONE ALREADY THERE.                                       *
 17259***************************************************************
 17260
 17261
 17262* EXEC CICS HANDLE CONDITION
 17263*         NOTFND(6720-BUILD-NEW-RECORD)
 17264*     END-EXEC.
 17265*    MOVE '"$I                   ! 6 #00016057' TO DFHEIV0
 17266     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17267     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17268     MOVE X'3620233030303136303537' TO DFHEIV0(25:11)
 17269     CALL 'kxdfhei1' USING DFHEIV0
 17270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17271
 17272
 17273
 17274* EXEC CICS READ
 17275*         DATASET('ELACTQ')
 17276*         RIDFLD (ELMSTR-KEY)
 17277*         SET    (ADDRESS OF ACTIVITY-QUE)
 17278*         UPDATE
 17279*     END-EXEC.
 17280     MOVE 'ELACTQ' TO DFHEIV1
 17281*    MOVE '&"S        EU         (   #00016061' TO DFHEIV0
 17282     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17283     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17284     MOVE X'2020233030303136303631' TO DFHEIV0(25:11)
 17285     CALL 'kxdfhei1' USING DFHEIV0,
 17286           DFHEIV1,
 17287           DFHEIV20,
 17288           DFHEIV99,
 17289           ELMSTR-KEY,
 17290           DFHEIV99,
 17291           DFHEIV99,
 17292           DFHEIV99
 17293     SET ADDRESS OF ACTIVITY-QUE TO
 17294         DFHEIV20
 17295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17296
 17297
 17298     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17299
 17300     IF PI-AIG-SPECIAL-BENEFIT AND
 17301        PI-CASH = 'Y'
 17302         ADD 2                   TO AQ-PAYMENT-COUNTER
 17303     ELSE
 17304         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17305
 17306     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17307         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17308
 17309     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17310
 17311     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 335
* EL156.cbl
 17312         IF WS-PMT-APPROVAL-SW = 'A'
 17313             NEXT SENTENCE
 17314         ELSE
 17315            IF PI-AIG-SPECIAL-BENEFIT AND
 17316               PI-CASH = 'Y'
 17317                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17318                                     WS-PMT-UNAPPROVED-CNT
 17319            ELSE
 17320                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17321                                     WS-PMT-UNAPPROVED-CNT
 17322     ELSE
 17323         IF PI-PMT-APPR-SW = 'Y'
 17324            IF PI-AIG-SPECIAL-BENEFIT AND
 17325               PI-CASH = 'Y'
 17326                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17327                                     WS-PMT-UNAPPROVED-CNT
 17328            ELSE
 17329                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17330                                     WS-PMT-UNAPPROVED-CNT.
 17331
 17332     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17333         MOVE ER-3536 TO EMI-ERROR
 17334         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17335
 17336     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17337
 17338
 17339* EXEC CICS REWRITE
 17340*         DATASET('ELACTQ')
 17341*         FROM   (ACTIVITY-QUE)
 17342*     END-EXEC.
 17343     MOVE LENGTH OF
 17344      ACTIVITY-QUE
 17345       TO DFHEIV11
 17346     MOVE 'ELACTQ' TO DFHEIV1
 17347*    MOVE '&& L                  %   #00016108' TO DFHEIV0
 17348     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17349     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17350     MOVE X'2020233030303136313038' TO DFHEIV0(25:11)
 17351     CALL 'kxdfhei1' USING DFHEIV0,
 17352           DFHEIV1,
 17353           ACTIVITY-QUE,
 17354           DFHEIV11,
 17355           DFHEIV99
 17356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17357
 17358
 17359     GO TO 6799-EXIT.
 17360
 17361 6720-BUILD-NEW-RECORD.
 17362
 17363* EXEC CICS GETMAIN
 17364*         SET    (ADDRESS OF ACTIVITY-QUE)
 17365*         LENGTH (60)
 17366*         INITIMG(GETMAIN-SPACE)
 17367*     END-EXEC.
 17368     MOVE 60
 17369       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 336
* EL156.cbl
 17370*    MOVE ',"IL                  $   #00016116' TO DFHEIV0
 17371     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17372     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17373     MOVE X'2020233030303136313136' TO DFHEIV0(25:11)
 17374     CALL 'kxdfhei1' USING DFHEIV0,
 17375           DFHEIV20,
 17376           DFHEIV11,
 17377           GETMAIN-SPACE
 17378     SET ADDRESS OF ACTIVITY-QUE TO
 17379         DFHEIV20
 17380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17381
 17382
 17383     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17384
 17385     IF PI-AIG-SPECIAL-BENEFIT AND
 17386        PI-CASH = 'Y'
 17387         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17388     ELSE
 17389         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17390
 17391     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17392     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17393     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17394     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17395                                    AQ-FOLLOWUP-DATE.
 17396     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17397     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17398
 17399     IF PI-PMT-GRADUATED
 17400         IF WS-PMT-APPROVAL-SW = 'A'
 17401             NEXT SENTENCE
 17402         ELSE
 17403            IF PI-AIG-SPECIAL-BENEFIT AND
 17404               PI-CASH = 'Y'
 17405                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17406            ELSE
 17407                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17408     ELSE
 17409         IF PI-PMT-APPR-SW = 'Y'
 17410            IF PI-AIG-SPECIAL-BENEFIT AND
 17411               PI-CASH = 'Y'
 17412                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17413            ELSE
 17414                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17415
 17416     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17417         MOVE ER-3536 TO EMI-ERROR
 17418         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17419
 17420
 17421* EXEC CICS WRITE
 17422*         DATASET('ELACTQ')
 17423*         RIDFLD (ELMSTR-KEY)
 17424*         FROM   (ACTIVITY-QUE)
 17425*     END-EXEC.
 17426     MOVE LENGTH OF
 17427      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 337
* EL156.cbl
 17428       TO DFHEIV11
 17429     MOVE 'ELACTQ' TO DFHEIV1
 17430*    MOVE '&$ L                  ''   #00016159' TO DFHEIV0
 17431     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17432     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17433     MOVE X'2020233030303136313539' TO DFHEIV0(25:11)
 17434     CALL 'kxdfhei1' USING DFHEIV0,
 17435           DFHEIV1,
 17436           ACTIVITY-QUE,
 17437           DFHEIV11,
 17438           ELMSTR-KEY,
 17439           DFHEIV99,
 17440           DFHEIV99
 17441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17442
 17443
 17444 6799-EXIT.
 17445      EXIT.
 17446
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 338
* EL156.cbl
 17448 6800-BUILD-FORM-TRAILER.
 17449
 17450
 17451* EXEC CICS GETMAIN
 17452*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17453*         LENGTH   (200)
 17454*         INITIMG  (GETMAIN-SPACE)
 17455*    END-EXEC.
 17456     MOVE 200
 17457       TO DFHEIV11
 17458*    MOVE ',"IL                  $   #00016171' TO DFHEIV0
 17459     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17460     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17461     MOVE X'2020233030303136313731' TO DFHEIV0(25:11)
 17462     CALL 'kxdfhei1' USING DFHEIV0,
 17463           DFHEIV20,
 17464           DFHEIV11,
 17465           GETMAIN-SPACE
 17466     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17467         DFHEIV20
 17468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17469
 17470
 17471     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17472
 17473     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17474     MOVE 'AT'                   TO AT-RECORD-ID.
 17475     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17476
 17477     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17478     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17479                                    AT-FORM-LAST-MAINT-DT
 17480                                    AT-FORM-SEND-ON-DT.
 17481     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17482                                    AT-FORM-LAST-UPDATED-BY.
 17483     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17484     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17485     MOVE '6'                    TO DC-OPTION-CODE.
 17486     MOVE +29                    TO DC-ELAPSED-DAYS.
 17487     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17488     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17489     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17490
 17491     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17492         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17493
 17494     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17495                                    AT-FORM-RE-SEND-DT
 17496                                    AT-EMP-FORM-ANSWERED-DT
 17497                                    AT-PHY-FORM-ANSWERED-DT
 17498                                    AT-EMP-FORM-SEND-ON-DT
 17499                                    AT-PHY-FORM-SEND-ON-DT
 17500                                    AT-FORM-PRINTED-DT
 17501                                    AT-FORM-REPRINT-DT.
 17502     MOVE '2'                    TO AT-FORM-TYPE.
 17503
 17504     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17505     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 339
* EL156.cbl
 17506
 17507     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17508         NEXT SENTENCE
 17509     ELSE
 17510         IF CL-PROG-FORM-TYPE NOT = 'S'
 17511            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17512
 17513
 17514* EXEC CICS WRITE
 17515*         DATASET  ('ELTRLR')
 17516*         FROM     (ACTIVITY-TRAILERS)
 17517*         RIDFLD   (AT-CONTROL-PRIMARY)
 17518*     END-EXEC.
 17519     MOVE LENGTH OF
 17520      ACTIVITY-TRAILERS
 17521       TO DFHEIV11
 17522     MOVE 'ELTRLR' TO DFHEIV1
 17523*    MOVE '&$ L                  ''   #00016219' TO DFHEIV0
 17524     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17525     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17526     MOVE X'2020233030303136323139' TO DFHEIV0(25:11)
 17527     CALL 'kxdfhei1' USING DFHEIV0,
 17528           DFHEIV1,
 17529           ACTIVITY-TRAILERS,
 17530           DFHEIV11,
 17531           AT-CONTROL-PRIMARY,
 17532           DFHEIV99,
 17533           DFHEIV99
 17534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17535
 17536
 17537 6899-EXIT.
 17538      EXIT.
 17539
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 340
* EL156.cbl
 17541 6900-BUILD-ARCHIVE-HEADER.
 17542
 17543     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17544     MOVE '1'                    TO CNTL-REC-TYPE.
 17545     MOVE +0                     TO CNTL-SEQ-NO.
 17546     MOVE SPACES                 TO CNTL-ACCESS.
 17547
 17548
 17549* EXEC CICS READ
 17550*         DATASET  ('ELCNTL')
 17551*         SET      (ADDRESS OF CONTROL-FILE)
 17552*         RIDFLD   (ELCNTL-KEY)
 17553*         UPDATE
 17554*    END-EXEC.
 17555     MOVE 'ELCNTL' TO DFHEIV1
 17556*    MOVE '&"S        EU         (   #00016236' TO DFHEIV0
 17557     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17558     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17559     MOVE X'2020233030303136323336' TO DFHEIV0(25:11)
 17560     CALL 'kxdfhei1' USING DFHEIV0,
 17561           DFHEIV1,
 17562           DFHEIV20,
 17563           DFHEIV99,
 17564           ELCNTL-KEY,
 17565           DFHEIV99,
 17566           DFHEIV99,
 17567           DFHEIV99
 17568     SET ADDRESS OF CONTROL-FILE TO
 17569         DFHEIV20
 17570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17571
 17572
 17573     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17574     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17575
 17576
 17577* EXEC CICS REWRITE
 17578*         FROM     (CONTROL-FILE)
 17579*         DATASET  ('ELCNTL')
 17580*    END-EXEC.
 17581     MOVE LENGTH OF
 17582      CONTROL-FILE
 17583       TO DFHEIV11
 17584     MOVE 'ELCNTL' TO DFHEIV1
 17585*    MOVE '&& L                  %   #00016246' TO DFHEIV0
 17586     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17587     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17588     MOVE X'2020233030303136323436' TO DFHEIV0(25:11)
 17589     CALL 'kxdfhei1' USING DFHEIV0,
 17590           DFHEIV1,
 17591           CONTROL-FILE,
 17592           DFHEIV11,
 17593           DFHEIV99
 17594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17595
 17596
 17597
 17598* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 341
* EL156.cbl
 17599*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17600*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17601*    END-EXEC.
 17602*    MOVE '"$$%                  ! 7 #00016251' TO DFHEIV0
 17603     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17605     MOVE X'3720233030303136323531' TO DFHEIV0(25:11)
 17606     CALL 'kxdfhei1' USING DFHEIV0
 17607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17608
 17609
 17610
 17611* EXEC CICS GETMAIN
 17612*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17613*         LENGTH  (ELARCH-LENGTH)
 17614*         INITIMG (GETMAIN-SPACE)
 17615*    END-EXEC.
 17616*    MOVE ',"IL                  $   #00016256' TO DFHEIV0
 17617     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17618     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17619     MOVE X'2020233030303136323536' TO DFHEIV0(25:11)
 17620     CALL 'kxdfhei1' USING DFHEIV0,
 17621           DFHEIV20,
 17622           ELARCH-LENGTH,
 17623           GETMAIN-SPACE
 17624     SET ADDRESS OF LETTER-ARCHIVE TO
 17625         DFHEIV20
 17626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17627
 17628
 17629     MOVE 'LA'                   TO LA-RECORD-ID.
 17630     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17631                                    LA-ARCHIVE-NO-A1.
 17632     MOVE '4'                    TO LA-RECORD-TYPE
 17633                                    LA-RECORD-TYPE-A1.
 17634     MOVE +0                     TO LA-LINE-SEQ-NO
 17635                                    LA-LINE-SEQ-NO-A1.
 17636     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17637                                    LA-COMPANY-CD-A1.
 17638     MOVE CL-CARRIER             TO LA4-CARRIER.
 17639     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17640     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17641     MOVE CL-CERT-STATE          TO LA4-STATE.
 17642     MOVE +0                     TO LA4-NO-OF-COPIES.
 17643     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17644     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17645     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17646                                    LA4-INITIAL-PRINT-DATE
 17647                                    LA4-RESEND-PRINT-DATE
 17648                                    LA4-FORM-REM-PRINT-DT.
 17649     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17650     MOVE '2'                    TO LA4-FORM-TYPE.
 17651
 17652
 17653* EXEC CICS WRITE
 17654*         DATASET  ('ELARCH')
 17655*         FROM     (LETTER-ARCHIVE)
 17656*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 342
* EL156.cbl
 17657*    END-EXEC.
 17658     MOVE LENGTH OF
 17659      LETTER-ARCHIVE
 17660       TO DFHEIV11
 17661     MOVE 'ELARCH' TO DFHEIV1
 17662*    MOVE '&$ L                  ''   #00016285' TO DFHEIV0
 17663     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17664     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17665     MOVE X'2020233030303136323835' TO DFHEIV0(25:11)
 17666     CALL 'kxdfhei1' USING DFHEIV0,
 17667           DFHEIV1,
 17668           LETTER-ARCHIVE,
 17669           DFHEIV11,
 17670           LA-CONTROL-PRIMARY,
 17671           DFHEIV99,
 17672           DFHEIV99
 17673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17674
 17675
 17676 6999-EXIT.
 17677      EXIT.
 17678
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 343
* EL156.cbl
 17680 7000-SHOW-CLAIM.
 17681     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17682     MOVE 'A'                    TO PI-PASS-SW.
 17683     MOVE LOW-VALUES             TO PI-CPYFROM
 17684                                    PI-MONTH-END-SAVE
 17685                                    PI-CPYTHRU.
 17686
 17687     MOVE ZEROS                  TO PI-FATAL-COUNT
 17688                                    PI-DAILY-RATE
 17689                                    PI-BEN-DAYS
 17690                                    PI-MANUAL-SW
 17691                                    PI-SAVE-CURSOR
 17692                                    PI-FORCE-COUNT
 17693                                    PI-HOLDTIL
 17694                                    PI-EPYFROM
 17695                                    PI-EPYTHRU
 17696                                    PI-EDAYS
 17697                                    PI-EPYAMT
 17698                                    PI-ERESV
 17699                                    PI-EEXPENS
 17700                                    PI-CDAYS
 17701                                    PI-CPYAMT
 17702                                    PI-CRESV
 17703                                    PI-CEXPENS
 17704                                    PI-INT-RATE
 17705                                    PI-AIGFROM.
 17706     MOVE ZEROS                  TO PI-PROOF-DATE.
 17707     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17708                                    PI-REM-BEN-AMT
 17709                                    PI-MO-BEN-AMT
 17710                                    pi-ah-term.
 17711
 17712     MOVE LOW-VALUES             TO EL156AI.
 17713     MOVE MAP-NAMEA              TO MAP-NAME.
 17714
 17715* EXEC CICS HANDLE CONDITION
 17716*        NOTFND   (7010-BUILD-MAP)
 17717*    END-EXEC.
 17718*    MOVE '"$I                   ! 8 #00016329' TO DFHEIV0
 17719     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17721     MOVE X'3820233030303136333239' TO DFHEIV0(25:11)
 17722     CALL 'kxdfhei1' USING DFHEIV0
 17723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17724
 17725
 17726     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17727     MOVE '2'                    TO CNTL-REC-TYPE.
 17728     MOVE +0                     TO CNTL-SEQ-NO.
 17729     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17730
 17731
 17732* EXEC CICS READ
 17733*         DATASET  ('ELCNTL')
 17734*         SET      (ADDRESS OF CONTROL-FILE)
 17735*         RIDFLD   (ELCNTL-KEY)
 17736*    END-EXEC.
 17737     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 344
* EL156.cbl
 17738*    MOVE '&"S        E          (   #00016338' TO DFHEIV0
 17739     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17740     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17741     MOVE X'2020233030303136333338' TO DFHEIV0(25:11)
 17742     CALL 'kxdfhei1' USING DFHEIV0,
 17743           DFHEIV1,
 17744           DFHEIV20,
 17745           DFHEIV99,
 17746           ELCNTL-KEY,
 17747           DFHEIV99,
 17748           DFHEIV99,
 17749           DFHEIV99
 17750     SET ADDRESS OF CONTROL-FILE TO
 17751         DFHEIV20
 17752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17753
 17754
 17755     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17756
 17757     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17758         MOVE AL-UANON      TO SURVYYNA
 17759     END-IF.
 17760
 17761
 17762     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17763     MOVE '1'                    TO CNTL-REC-TYPE.
 17764     MOVE SPACES                 TO CNTL-ACCESS.
 17765     MOVE +0                     TO CNTL-SEQ-NO.
 17766
 17767
 17768* EXEC CICS READ
 17769*         DATASET  ('ELCNTL')
 17770*         SET      (ADDRESS OF CONTROL-FILE)
 17771*         RIDFLD   (ELCNTL-KEY)
 17772*    END-EXEC.
 17773     MOVE 'ELCNTL' TO DFHEIV1
 17774*    MOVE '&"S        E          (   #00016356' TO DFHEIV0
 17775     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17776     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17777     MOVE X'2020233030303136333536' TO DFHEIV0(25:11)
 17778     CALL 'kxdfhei1' USING DFHEIV0,
 17779           DFHEIV1,
 17780           DFHEIV20,
 17781           DFHEIV99,
 17782           ELCNTL-KEY,
 17783           DFHEIV99,
 17784           DFHEIV99,
 17785           DFHEIV99
 17786     SET ADDRESS OF CONTROL-FILE TO
 17787         DFHEIV20
 17788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17789
 17790
 17791     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17792
 17793 7010-BUILD-MAP.
 17794
 17795
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 345
* EL156.cbl
 17796* EXEC CICS HANDLE CONDITION
 17797*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17798*    END-EXEC.
 17799*    MOVE '"$I                   ! 9 #00016366' TO DFHEIV0
 17800     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17802     MOVE X'3920233030303136333636' TO DFHEIV0(25:11)
 17803     CALL 'kxdfhei1' USING DFHEIV0
 17804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17805
 17806
 17807     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17808     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17809     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17810     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17811     MOVE 'MSTR'                 TO FILE-SWITCH.
 17812
 17813     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17814
 17815     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17816     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17817     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17818     MOVE CL-CCN                 TO PI-SV-CCN.
 17819
 17820     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17821     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17822     MOVE CL-CLAIM-NO            TO CLMNOO.
 17823     MOVE CL-CARRIER             TO CARRO.
 17824     MOVE CL-CERT-PRIME          TO CERTNOO.
 17825     MOVE CL-CERT-SFX            TO SUFXO.
 17826
 17827     IF (PI-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL')
 17828        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 17829        CONTINUE
 17830     ELSE
 17831        MOVE AL-SADOF            TO ZINTHA
 17832                                    ZINTA
 17833                                    PINTHA
 17834                                    PINTA
 17835     END-IF
 17836     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17837     EVALUATE TRUE
 17838     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17839         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17840     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17841         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17842
 17843     WHEN CL-CLAIM-TYPE = 'I'
 17844         MOVE '  IU  '           TO CLMTYPO
 17845     WHEN CL-CLAIM-TYPE = 'G'
 17846         MOVE ' GAP  '           TO CLMTYPO
 17847     WHEN CL-CLAIM-TYPE = 'F'
 17848         MOVE ' FMLA '           TO CLMTYPO
 17849     WHEN CL-CLAIM-TYPE = 'O'
 17850         MOVE ' OTH '           TO CLMTYPO
 17851     END-EVALUATE.
 17852     IF CL-CLAIM-TYPE = 'O'
 17853        MOVE 'S' TO EOBYNO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 346
* EL156.cbl
 17854                    PI-PRINT-EOB-YN
 17855                    WS-PRINT-EOB-YN
 17856     END-IF
 17857     IF CLAIM-IS-OPEN
 17858         MOVE ' OPEN'            TO CLMSTATO
 17859     ELSE
 17860         MOVE 'CLOSED'           TO CLMSTATO.
 17861
 17862     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17863
 17864     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17865         MOVE SPACES             TO  PCERTNOO
 17866                                     PSUFXO
 17867                                     PRIMHDGO
 17868                                     SEQUO
 17869         MOVE AL-SADOF           TO  PCERTNOA
 17870                                     PSUFXA
 17871                                     PRIMHDGA
 17872                                     SEQUA
 17873     ELSE
 17874         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17875         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17876         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17877         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17878         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17879         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17880         MOVE AL-SANON               TO  PCERTNOA
 17881                                         PSUFXA
 17882                                         PRIMHDGA
 17883         MOVE AL-SABON               TO  SEQUA.
 17884
 17885     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17886
 17887     IF CL-NO-OF-PMTS-MADE = 0 AND
 17888        CL-TOTAL-PAID-AMT = 0
 17889         NEXT SENTENCE
 17890     ELSE
 17891         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17892             IF NOT PI-USES-PAID-TO
 17893                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17894                 MOVE ' '                 TO DC-OPTION-CODE
 17895                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17896                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17897             ELSE
 17898                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17899                 MOVE '6'                 TO DC-OPTION-CODE
 17900                 MOVE +1                  TO DC-ELAPSED-DAYS
 17901                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17902                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17903                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17904
 17905     IF MAP-NAME = 'EL156A'
 17906        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17907           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17908             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17909           end-if
 17910        end-if
 17911     end-if
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 347
* EL156.cbl
 17912     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17913         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17914         MOVE ' '                TO DC-OPTION-CODE
 17915         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17916         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17917
 17918     IF CL-INCURRED-DT NOT = LOW-VALUES
 17919         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17920         MOVE ' '                TO DC-OPTION-CODE
 17921         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17922         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17923
 17924     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17925
 17926     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17927         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17928         MOVE ' '                TO DC-OPTION-CODE
 17929         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17930         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17931
 17932     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17933         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17934         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17935     ELSE
 17936         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17937         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17938
 17939     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17940     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17941     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17942     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17943                                    PI-GROUPING.
 17944     MOVE CL-CERT-STATE          TO CERT-STATE
 17945                                    PI-STATE.
 17946     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17947                                    PI-ACCOUNT.
 17948     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17949     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17950     MOVE 'CERT'                 TO FILE-SWITCH.
 17951
 17952     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17953     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17954        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17955        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17956            MOVE 'N' TO PI-JOINT-INSURED-IND
 17957     ELSE
 17958            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17959     END-IF.
 17960
 17961     perform 7975-read-acct      thru 7975-exit
 17962     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17963     MOVE PI-STATE               TO WS-ST-ACCESS.
 17964     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17965     MOVE '3'                    TO CNTL-REC-TYPE.
 17966     MOVE +0                     TO CNTL-SEQ-NO.
 17967     MOVE 'STAT'                 TO FILE-SWITCH.
 17968
 17969     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 348
* EL156.cbl
 17970
 17971     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17972     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17973
 17974     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17975        GO TO 7020-BYPASS-BENEFIT.
 17976
 17977     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17978     MOVE '4'                    TO CNTL-REC-TYPE.
 17979     MOVE +0                     TO CNTL-SEQ-NO.
 17980     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17981     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17982     MOVE 'BENE'                 TO FILE-SWITCH.
 17983
 17984     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17985
 17986     IF NO-BENEFIT-FOUND
 17987        GO TO 7020-BYPASS-BENEFIT.
 17988
 17989     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17990     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17991     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17992
 17993 7020-BYPASS-BENEFIT.
 17994
 17995*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17996*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17997*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17998
 17999     move zeros                  to PI-MAX-BENEFIT-AMT
 18000     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 18001     move cm-ah-orig-term        to pi-ah-term
 18002     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 18003     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 18004          'G' and 'F'
 18005         GO TO 7021-GO-TO-LIFE.
 18006
 18007     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 18008        and (acct-found)
 18009        AND (PI-DCC-PRODUCT-CODE not = '   ')
 18010        PERFORM 0900-GET-DDF-limits
 18011                                 THRU 0900-EXIT
 18012        IF PDEF-FOUND
 18013           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 18014              (P1 > +8)
 18015              OR (PD-PROD-CODE (P1) = cl-claim-type)
 18016           END-PERFORM
 18017           IF P1 < +9
 18018              if pd-ben-pct (p1) not numeric
 18019                 move zeros      to pd-ben-pct (p1)
 18020              end-if
 18021              if pd-ben-pct (p1) = zeros
 18022                 move +1         to ws-work-ben-pct
 18023              else
 18024                 move pd-ben-pct (p1)
 18025                                 to ws-work-ben-pct
 18026              end-if
 18027              compute cm-ah-benefit-amt =
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 349
* EL156.cbl
 18028                 cm-ah-benefit-amt * ws-work-ben-pct
 18029              move pd-max-amt (p1) to pi-max-benefit-amt
 18030           END-IF
 18031        END-IF
 18032     end-if
 18033     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 18034     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 18035     if (pi-max-benefit-amt not = zeros)
 18036        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 18037        move pi-max-benefit-amt  to beneo
 18038     else
 18039        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 18040     end-if
 18041     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 18042     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 18043                                    CP-ORIGINAL-TERM.
 18044     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 18045
 18046*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18047*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 18048*    ELSE
 18049         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 18050
 18051     MOVE ' '                    TO DC-OPTION-CODE.
 18052     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 18053     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 18054
 18055     IF PI-COMPANY-ID = 'DMD'
 18056         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 18057         GO TO 7023-BYPASS-REMAINING-TERM.
 18058
 18059     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 18060     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 18061     GO TO 7022-AROUND-LIFE.
 18062
 18063 7021-GO-TO-LIFE.
 18064
 18065     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 18066     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 18067     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 18068                                    CP-ORIGINAL-TERM.
 18069     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 18070     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 18071     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 18072     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 18073
 18074     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18075         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 18076     ELSE
 18077         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 18078
 18079     MOVE ' '                    TO DC-OPTION-CODE.
 18080     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 18081     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 18082
 18083 7022-AROUND-LIFE.
 18084
 18085     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 350
* EL156.cbl
 18086     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 18087     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 18088     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 18089     MOVE '4'                    TO CP-REM-TERM-METHOD.
 18090     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 18091     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 18092
 18093     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 18094
 18095     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 18096        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 18097           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 18098
 18099     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18100        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 18101           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 18102
 18103 7023-BYPASS-REMAINING-TERM.
 18104     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18105       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 18106          MOVE ZEROS                  TO BENEO
 18107       ELSE
 18108          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 18109          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 18110          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 18111          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 18112          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 18113          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 18114          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 18115          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 18116          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 18117          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 18118          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 18119          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 18120          IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 18121             AND (PI-DCC-PRODUCT-CODE not = '   ')
 18122             PERFORM 0900-GET-DDF-limits
 18123                                 THRU 0900-EXIT
 18124             IF PDEF-FOUND
 18125                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 18126                   (P1 > +8)
 18127                   OR (PD-PROD-CODE (P1) = 'L')
 18128                END-PERFORM
 18129                IF P1 < +9
 18130                   MOVE PD-MAX-AMT (P1)
 18131                                 TO CP-R-MAX-TOT-BEN
 18132                END-IF
 18133             END-IF
 18134          END-IF
 18135
 18136* EXEC CICS LINK
 18137*            PROGRAM  (LINK-REMAMT)
 18138*            COMMAREA (CALCULATION-PASS-AREA)
 18139*            LENGTH   (CP-COMM-LENGTH)
 18140*         END-EXEC
 18141*    MOVE '."C                   (   #00016698' TO DFHEIV0
 18142     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18143     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 351
* EL156.cbl
 18144     MOVE X'2020233030303136363938' TO DFHEIV0(25:11)
 18145     CALL 'kxdfhei1' USING DFHEIV0,
 18146           LINK-REMAMT,
 18147           CALCULATION-PASS-AREA,
 18148           CP-COMM-LENGTH,
 18149           DFHEIV99,
 18150           DFHEIV99,
 18151           DFHEIV99,
 18152           DFHEIV99
 18153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18154          MOVE CP-REMAINING-AMT       TO BENEO
 18155       end-if
 18156     end-if
 18157     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18158     MOVE +95                    TO TRLR-SEQ-NO
 18159
 18160* EXEC CICS READ
 18161*       DATASET  ('ELTRLR')
 18162*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18163*       RIDFLD   (ELTRLR-KEY)
 18164*       RESP     (WS-RESPONSE)
 18165*    END-EXEC
 18166     MOVE 'ELTRLR' TO DFHEIV1
 18167*    MOVE '&"S        E          (  N#00016708' TO DFHEIV0
 18168     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18169     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18170     MOVE X'204E233030303136373038' TO DFHEIV0(25:11)
 18171     CALL 'kxdfhei1' USING DFHEIV0,
 18172           DFHEIV1,
 18173           DFHEIV20,
 18174           DFHEIV99,
 18175           ELTRLR-KEY,
 18176           DFHEIV99,
 18177           DFHEIV99,
 18178           DFHEIV99
 18179     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18180         DFHEIV20
 18181     MOVE EIBRESP  TO WS-RESPONSE
 18182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18183
 18184     if ws-resp-normal
 18185        perform varying s1 from +1 by +1 until
 18186           at-note-error-no (s1) = spaces
 18187           move at-note-error-no (s1)
 18188                                 to emi-error
 18189           if at-note-error-no (s1) = '1653'
 18190              evaluate true
 18191                 when cl-claim-type = 'L'
 18192                    move '  LF  '
 18193                                 to emi-claim-type
 18194                 when cl-claim-type = 'I'
 18195                    move '  IU  '
 18196                                 to emi-claim-type
 18197                 when cl-claim-type = 'F'
 18198                    move ' FMLA '
 18199                                 to emi-claim-type
 18200                 when cl-claim-type = 'O'
 18201                    move ' OTH '
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 352
* EL156.cbl
 18202                                 to emi-claim-type
 18203                 when other
 18204                    move '  AH  '
 18205                                 to emi-claim-type
 18206              end-evaluate
 18207           end-if
 18208           PERFORM 9900-ERROR-FORMAT
 18209                                 THRU 9900-EXIT
 18210        end-perform
 18211     end-if
 18212    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18213         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 18214            WS-LF-COVERAGE-TYPE = 'P'
 18215             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 18216                                        CM-LF-ITD-DEATH-AMT
 18217             MOVE WS-REMAINING-AMT  TO  BENEO.
 18218
 18219     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 18220     MOVE BENEO                  TO PI-REM-BEN-AMT.
 18221     MOVE WS-TERMS               TO TERMSO.
 18222
 18223     IF WS-STATUS = '6' OR '7' OR '8'
 18224         MOVE AL-SABOF           TO CRTSTATA.
 18225
 18226     IF WS-STATUS = '1' OR '4'
 18227        IF CP-REMAINING-TERM-3 = ZEROS
 18228           MOVE 'EXPIRED'        TO CRTSTATO
 18229        ELSE
 18230           MOVE 'ACTIVE  '       TO CRTSTATO.
 18231
 18232     IF WS-STATUS = '2'
 18233         MOVE 'PEND    '         TO CRTSTATO.
 18234
 18235     IF WS-STATUS = '3'
 18236         MOVE 'RESTORE '         TO CRTSTATO.
 18237
 18238     IF WS-STATUS = '5'
 18239         MOVE 'REISSUE '         TO CRTSTATO.
 18240
 18241     IF WS-STATUS = '6'
 18242         MOVE 'LMP DIS'          TO CRTSTATO.
 18243
 18244     IF WS-STATUS = '7'
 18245         MOVE 'DEATH'            TO CRTSTATO.
 18246
 18247     IF WS-STATUS = '8'
 18248         MOVE 'CANCEL'           TO CRTSTATO.
 18249
 18250     IF WS-STATUS = '9'
 18251         MOVE 'RE-ONLY '         TO CRTSTATO.
 18252
 18253     IF WS-STATUS = 'V'
 18254         MOVE 'VOID  '           TO CRTSTATO.
 18255
 18256     IF WS-STATUS = 'D'
 18257         MOVE 'DECLINE '         TO CRTSTATO.
 18258
 18259     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 353
* EL156.cbl
 18260         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18261         MOVE '5'                TO CNTL-REC-TYPE
 18262     ELSE
 18263         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18264         MOVE '4'                TO CNTL-REC-TYPE.
 18265
 18266     MOVE '** NONE **'           TO COVERO.
 18267     MOVE AL-SABON               TO COVERA.
 18268
 18269     IF PI-COMPANY-ID = 'CVL'
 18270         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18271             MOVE CM-BENEFICIARY TO LOANNOO
 18272             MOVE AL-UANON       TO LOANNOA.
 18273
 18274     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 18275           OR 'FNL'
 18276        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18277        MOVE +91                 TO  TRLR-SEQ-NO
 18278
 18279* EXEC CICS READ
 18280*           DATASET  ('ELTRLR')
 18281*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18282*           RIDFLD   (ELTRLR-KEY)
 18283*           RESP     (WS-RESPONSE)
 18284*       END-EXEC
 18285     MOVE 'ELTRLR' TO DFHEIV1
 18286*    MOVE '&"S        E          (  N#00016809' TO DFHEIV0
 18287     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18288     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18289     MOVE X'204E233030303136383039' TO DFHEIV0(25:11)
 18290     CALL 'kxdfhei1' USING DFHEIV0,
 18291           DFHEIV1,
 18292           DFHEIV20,
 18293           DFHEIV99,
 18294           ELTRLR-KEY,
 18295           DFHEIV99,
 18296           DFHEIV99,
 18297           DFHEIV99
 18298     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18299         DFHEIV20
 18300     MOVE EIBRESP  TO WS-RESPONSE
 18301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18302
 18303        IF WS-RESP-NORMAL
 18304           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18305        ELSE
 18306           MOVE SPACES           TO  LOANNOO
 18307        END-IF
 18308*052506
 18309*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18310*052506
 18311     END-IF
 18312
 18313     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18314        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18315
 18316     IF WS-BEN-CD = ZEROS
 18317         GO TO 7050-SHOW-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 354
* EL156.cbl
 18318
 18319     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18320     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18321     MOVE +0                     TO CNTL-SEQ-NO.
 18322     MOVE 'BENE'                 TO FILE-SWITCH.
 18323
 18324     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18325     IF BENEFIT-FOUND
 18326        MOVE CF-JOINT-INDICATOR (SUB-1)
 18327                                 TO PI-JOINT-COV-IND
 18328                                    PI-RB-JOINT-COV-IND
 18329        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18330                                 TO COVERO
 18331        MOVE AL-SANON            TO COVERA
 18332     END-IF
 18333     if (cntl-rec-type = '4')   *> Life claim
 18334        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18335        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18336        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18337        MOVE '5'              TO CNTL-REC-TYPE
 18338        MOVE WS-ACCESS        TO CNTL-ACCESS
 18339        MOVE +0               TO CNTL-SEQ-NO
 18340        MOVE 'BENE'           TO FILE-SWITCH
 18341        PERFORM 7200-FIND-BENEFIT
 18342                              THRU 7200-EXIT
 18343        IF (BENEFIT-FOUND)
 18344           and (pi-rb-joint-cov-ind) not = 'J'
 18345           MOVE CF-JOINT-INDICATOR (SUB-1)
 18346                              TO PI-rb-JOINT-COV-IND
 18347        end-if
 18348     end-if
 18349     .
 18350 7050-SHOW-CONTINUE.
 18351
 18352     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18353        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18354            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18355     END-IF
 18356
 18357     IF PI-COMPANY-ID = 'DMD'
 18358         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18359
 18360     MOVE -1                     TO PMTTYPEL.
 18361     GO TO 8100-SEND-INITIAL-MAP.
 18362
 18363 7100-SHOW-RECORD-NOT-FOUND.
 18364     IF FILE-SWITCH = 'MSTR'
 18365         MOVE ER-0204            TO EMI-ERROR.
 18366
 18367     IF FILE-SWITCH = 'CERT'
 18368         MOVE ER-0206            TO EMI-ERROR.
 18369
 18370     IF FILE-SWITCH = 'STAT'
 18371         MOVE ER-0149            TO EMI-ERROR.
 18372
 18373     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18374
 18375     MOVE -1                     TO PMTTYPEL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 355
* EL156.cbl
 18376     GO TO 8100-SEND-INITIAL-MAP
 18377
 18378     .
 18379 7110-BUILD-PMT-TRLR.
 18380     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18381     MOVE +51                    TO TRLR-SEQ-NO
 18382
 18383* EXEC CICS READ
 18384*        DATASET  ('ELTRLR')
 18385*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18386*        RIDFLD   (ELTRLR-KEY)
 18387*        RESP     (WS-RESPONSE)
 18388*    END-EXEC
 18389     MOVE 'ELTRLR' TO DFHEIV1
 18390*    MOVE '&"S        E          (  N#00016895' TO DFHEIV0
 18391     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18393     MOVE X'204E233030303136383935' TO DFHEIV0(25:11)
 18394     CALL 'kxdfhei1' USING DFHEIV0,
 18395           DFHEIV1,
 18396           DFHEIV20,
 18397           DFHEIV99,
 18398           ELTRLR-KEY,
 18399           DFHEIV99,
 18400           DFHEIV99,
 18401           DFHEIV99
 18402     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18403         DFHEIV20
 18404     MOVE EIBRESP  TO WS-RESPONSE
 18405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18406     IF WS-RESP-NORMAL
 18407        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18408     END-IF
 18409     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18410
 18411* EXEC CICS GETMAIN
 18412*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18413*         LENGTH    (200)
 18414*         INITIMG   (GETMAIN-SPACE)
 18415*     END-EXEC
 18416     MOVE 200
 18417       TO DFHEIV11
 18418*    MOVE ',"IL                  $   #00016905' TO DFHEIV0
 18419     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18420     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18421     MOVE X'2020233030303136393035' TO DFHEIV0(25:11)
 18422     CALL 'kxdfhei1' USING DFHEIV0,
 18423           DFHEIV20,
 18424           DFHEIV11,
 18425           GETMAIN-SPACE
 18426     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18427         DFHEIV20
 18428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18429     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18430                                    AT-PREV-PAID-THRU-DT
 18431     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18432     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18433     MOVE 'AT'                   TO AT-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 356
* EL156.cbl
 18434     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18435     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18436     MOVE '2'                    TO AT-TRAILER-TYPE
 18437     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18438                                    AT-PAYMENT-LAST-MAINT-DT
 18439     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18440                                    AT-PAYMENT-LAST-UPDATED-BY
 18441     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18442     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18443     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18444     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 18445     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18446     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18447     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18448     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18449     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18450     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18451     if pi-int-to-rem-borr = 'Y'
 18452        move 'Q1'                to at-payee-type-cd
 18453     else
 18454        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18455     end-if
 18456     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18457     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18458     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18459     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18460     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18461                                    AT-TO-BE-WRITTEN-DT
 18462     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18463                                    AT-CHECK-QUE-SEQUENCE
 18464                                    AT-ADDL-RESERVE
 18465     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18466                                    AT-VOID-SELECT-DT
 18467                                    AT-VOID-ACCEPT-DT
 18468                                    AT-VOID-DT
 18469                                    AT-PMT-PROOF-DT
 18470                                    AT-INT-PMT-SELECT-DT
 18471     MOVE ZEROS                  TO AT-DAILY-RATE
 18472                                    AT-ELIMINATION-DAYS
 18473     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18474*    EXEC CICS HANDLE CONDITION
 18475*        DUPREC    (7120-DUPREC)
 18476*    END-EXEC
 18477     .
 18478 7115-WRITE-INT-TRLR.
 18479
 18480* EXEC CICS WRITE
 18481*         DATASET       ('ELTRLR')
 18482*         FROM          (ACTIVITY-TRAILERS)
 18483*         RIDFLD        (AT-CONTROL-PRIMARY)
 18484*         RESP          (WS-RESPONSE)
 18485*     END-EXEC
 18486     MOVE LENGTH OF
 18487      ACTIVITY-TRAILERS
 18488       TO DFHEIV11
 18489     MOVE 'ELTRLR' TO DFHEIV1
 18490*    MOVE '&$ L                  ''  N#00016960' TO DFHEIV0
 18491     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 357
* EL156.cbl
 18492     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18493     MOVE X'204E233030303136393630' TO DFHEIV0(25:11)
 18494     CALL 'kxdfhei1' USING DFHEIV0,
 18495           DFHEIV1,
 18496           ACTIVITY-TRAILERS,
 18497           DFHEIV11,
 18498           AT-CONTROL-PRIMARY,
 18499           DFHEIV99,
 18500           DFHEIV99
 18501     MOVE EIBRESP  TO WS-RESPONSE
 18502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18503      IF WS-RESP-DUPREC
 18504         GO TO 7120-DUPREC
 18505      END-IF
 18506     GO TO 7130-EXIT
 18507     .
 18508 7120-DUPREC.
 18509     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18510     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18511     GO TO 7115-WRITE-INT-TRLR
 18512     .
 18513 7130-EXIT.
 18514      EXIT.
 18515 7140-BUILD-NOTE-TRLR.
 18516
 18517
 18518* EXEC CICS GETMAIN
 18519*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18520*         LENGTH    (200)
 18521*         INITIMG   (GETMAIN-SPACE)
 18522*     END-EXEC
 18523     MOVE 200
 18524       TO DFHEIV11
 18525*    MOVE ',"IL                  $   #00016980' TO DFHEIV0
 18526     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18527     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18528     MOVE X'2020233030303136393830' TO DFHEIV0(25:11)
 18529     CALL 'kxdfhei1' USING DFHEIV0,
 18530           DFHEIV20,
 18531           DFHEIV11,
 18532           GETMAIN-SPACE
 18533     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18534         DFHEIV20
 18535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18536     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18537     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18538     MOVE 'AT'                   TO AT-RECORD-ID
 18539     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18540     MOVE '6'                    TO AT-TRAILER-TYPE
 18541     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18542                                    AT-GEN-INFO-LAST-MAINT-DT
 18543     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18544                                    AT-GEN-INFO-LAST-UPDATED-BY
 18545     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18546     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18547     .
 18548 7150-WRITE.
 18549
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 358
* EL156.cbl
 18550* EXEC CICS HANDLE CONDITION
 18551*        DUPREC    (7160-DUPREC)
 18552*    END-EXEC
 18553*    MOVE '"$%                   ! : #00016998' TO DFHEIV0
 18554     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18556     MOVE X'3A20233030303136393938' TO DFHEIV0(25:11)
 18557     CALL 'kxdfhei1' USING DFHEIV0
 18558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18559
 18560* EXEC CICS WRITE
 18561*         DATASET     ('ELTRLR')
 18562*         FROM        (ACTIVITY-TRAILERS)
 18563*         RIDFLD      (AT-CONTROL-PRIMARY)
 18564*         RESP        (WS-RESPONSE)
 18565*     END-EXEC
 18566     MOVE LENGTH OF
 18567      ACTIVITY-TRAILERS
 18568       TO DFHEIV11
 18569     MOVE 'ELTRLR' TO DFHEIV1
 18570*    MOVE '&$ L                  ''  N#00017001' TO DFHEIV0
 18571     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18572     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18573     MOVE X'204E233030303137303031' TO DFHEIV0(25:11)
 18574     CALL 'kxdfhei1' USING DFHEIV0,
 18575           DFHEIV1,
 18576           ACTIVITY-TRAILERS,
 18577           DFHEIV11,
 18578           AT-CONTROL-PRIMARY,
 18579           DFHEIV99,
 18580           DFHEIV99
 18581     MOVE EIBRESP  TO WS-RESPONSE
 18582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18583      IF WS-RESP-DUPREC
 18584         GO TO 7160-DUPREC
 18585      END-IF
 18586     GO TO 7170-EXIT
 18587     .
 18588 7160-DUPREC.
 18589     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18590     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18591     GO TO 7150-WRITE
 18592     .
 18593 7170-EXIT.
 18594      EXIT.
 18595
 18596 7180-ADD-CERT-NOTE.
 18597*ADD CERT NOTE FOR SC NP+6
 18598
 18599
 18600* EXEC CICS GETMAIN
 18601*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18602*         LENGTH    (150)
 18603*         INITIMG   (GETMAIN-SPACE)
 18604*     END-EXEC.
 18605     MOVE 150
 18606       TO DFHEIV11
 18607*    MOVE ',"IL                  $   #00017023' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 359
* EL156.cbl
 18608     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18609     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18610     MOVE X'2020233030303137303233' TO DFHEIV0(25:11)
 18611     CALL 'kxdfhei1' USING DFHEIV0,
 18612           DFHEIV20,
 18613           DFHEIV11,
 18614           GETMAIN-SPACE
 18615     SET ADDRESS OF CERT-NOTE-FILE TO
 18616         DFHEIV20
 18617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18618
 18619
 18620     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18621     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18622     MOVE +1                     TO WRK-NOTE-SEQ.
 18623     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18624     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18625     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18626     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18627     MOVE CL-CERT-STATE          TO CZ-STATE.
 18628     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18629     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18630     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18631     MOVE '2'                    TO CZ-RECORD-TYPE.
 18632     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18633     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18634     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18635     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18636     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18637     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18638     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18639     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18640     IF PI-COMPANY-ID = 'AHL'
 18641        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18642           CONTINUE
 18643        ELSE
 18644           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18645              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18646           ELSE
 18647              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18648           END-IF
 18649        END-IF
 18650     END-IF
 18651     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18652     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18653
 18654 7181-WRITE.
 18655
 18656
 18657* EXEC CICS WRITE
 18658*         DATASET     ('ERCNOT')
 18659*         FROM        (CERT-NOTE-FILE)
 18660*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18661*         RESP        (WS-RESPONSE)
 18662*    END-EXEC.
 18663     MOVE LENGTH OF
 18664      CERT-NOTE-FILE
 18665       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 360
* EL156.cbl
 18666     MOVE 'ERCNOT' TO DFHEIV1
 18667*    MOVE '&$ L                  ''  N#00017065' TO DFHEIV0
 18668     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18669     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18670     MOVE X'204E233030303137303635' TO DFHEIV0(25:11)
 18671     CALL 'kxdfhei1' USING DFHEIV0,
 18672           DFHEIV1,
 18673           CERT-NOTE-FILE,
 18674           DFHEIV11,
 18675           CZ-CONTROL-PRIMARY,
 18676           DFHEIV99,
 18677           DFHEIV99
 18678     MOVE EIBRESP  TO WS-RESPONSE
 18679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18680
 18681
 18682     IF WS-RESP-DUPREC
 18683         GO TO 7182-DUPREC
 18684     END-IF.
 18685
 18686     SET CERT-NOTE-ADDED TO TRUE.
 18687
 18688     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18689         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18690     END-IF.
 18691
 18692     GO TO 7189-EXIT.
 18693
 18694 7182-DUPREC.
 18695
 18696     ADD +1                      TO  WRK-NOTE-SEQ.
 18697     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18698     GO TO 7181-WRITE.
 18699
 18700 7189-EXIT.
 18701      EXIT.
 18702
 18703 7190-ADD-ORIG-NOTE.
 18704
 18705
 18706* EXEC CICS GETMAIN
 18707*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18708*         LENGTH    (150)
 18709*         INITIMG   (GETMAIN-SPACE)
 18710*     END-EXEC.
 18711     MOVE 150
 18712       TO DFHEIV11
 18713*    MOVE ',"IL                  $   #00017095' TO DFHEIV0
 18714     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18715     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18716     MOVE X'2020233030303137303935' TO DFHEIV0(25:11)
 18717     CALL 'kxdfhei1' USING DFHEIV0,
 18718           DFHEIV20,
 18719           DFHEIV11,
 18720           GETMAIN-SPACE
 18721     SET ADDRESS OF CERT-NOTE-FILE TO
 18722         DFHEIV20
 18723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 361
* EL156.cbl
 18724
 18725
 18726     ADD +1                      TO WRK-NOTE-SEQ.
 18727     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18728     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18729     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18730     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18731     MOVE CL-CERT-STATE          TO CZ-STATE.
 18732     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18733     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18734     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18735     MOVE '2'                    TO CZ-RECORD-TYPE.
 18736     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18737     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18738     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18739     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18740     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18741     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18742
 18743 7191-WRITE.
 18744
 18745
 18746* EXEC CICS WRITE
 18747*         DATASET     ('ERCNOT')
 18748*         FROM        (CERT-NOTE-FILE)
 18749*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18750*         RESP        (WS-RESPONSE)
 18751*    END-EXEC.
 18752     MOVE LENGTH OF
 18753      CERT-NOTE-FILE
 18754       TO DFHEIV11
 18755     MOVE 'ERCNOT' TO DFHEIV1
 18756*    MOVE '&$ L                  ''  N#00017120' TO DFHEIV0
 18757     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18758     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18759     MOVE X'204E233030303137313230' TO DFHEIV0(25:11)
 18760     CALL 'kxdfhei1' USING DFHEIV0,
 18761           DFHEIV1,
 18762           CERT-NOTE-FILE,
 18763           DFHEIV11,
 18764           CZ-CONTROL-PRIMARY,
 18765           DFHEIV99,
 18766           DFHEIV99
 18767     MOVE EIBRESP  TO WS-RESPONSE
 18768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18769
 18770
 18771     IF WS-RESP-DUPREC
 18772         GO TO 7192-DUPREC
 18773     END-IF.
 18774
 18775     GO TO 7199-EXIT.
 18776
 18777 7192-DUPREC.
 18778
 18779     ADD +1                      TO  WRK-NOTE-SEQ.
 18780     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18781     GO TO 7191-WRITE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 362
* EL156.cbl
 18782
 18783 7199-EXIT.
 18784      EXIT.
 18785 7200-FIND-BENEFIT.
 18786     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18787
 18788
 18789* EXEC CICS HANDLE CONDITION
 18790*        ENDFILE(7200-EXIT)
 18791*        NOTFND(7200-EXIT)
 18792*    END-EXEC.
 18793*    MOVE '"$''I                  ! ; #00017144' TO DFHEIV0
 18794     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18795     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18796     MOVE X'3B20233030303137313434' TO DFHEIV0(25:11)
 18797     CALL 'kxdfhei1' USING DFHEIV0
 18798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18799
 18800
 18801
 18802* EXEC CICS READ
 18803*        DATASET('ELCNTL')
 18804*        SET(ADDRESS OF CONTROL-FILE)
 18805*        RIDFLD(ELCNTL-KEY)
 18806*        GTEQ
 18807*    END-EXEC.
 18808     MOVE 'ELCNTL' TO DFHEIV1
 18809*    MOVE '&"S        G          (   #00017149' TO DFHEIV0
 18810     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18811     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18812     MOVE X'2020233030303137313439' TO DFHEIV0(25:11)
 18813     CALL 'kxdfhei1' USING DFHEIV0,
 18814           DFHEIV1,
 18815           DFHEIV20,
 18816           DFHEIV99,
 18817           ELCNTL-KEY,
 18818           DFHEIV99,
 18819           DFHEIV99,
 18820           DFHEIV99
 18821     SET ADDRESS OF CONTROL-FILE TO
 18822         DFHEIV20
 18823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18824
 18825
 18826     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18827        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18828           GO TO 7200-EXIT.
 18829
 18830     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18831         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18832            ((SUB-1 > 8) OR
 18833            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18834
 18835     IF SUB-1 NOT = 9
 18836         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18837
 18838     GO TO 7200-EXIT.
 18839
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 363
* EL156.cbl
 18840 7200-BENEFIT-DUMMY.
 18841
 18842 7200-DUMMY-EXIT.
 18843     EXIT.
 18844
 18845 7200-EXIT.
 18846     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 364
* EL156.cbl
 18848*052506
 18849*052506 7250-FIND-LETTER-TRLR.
 18850*052506     EXEC CICS HANDLE CONDITION
 18851*052506         ENDFILE  (7250-END)
 18852*052506         NOTFND   (7250-END)
 18853*052506     END-EXEC.
 18854*052506
 18855*052506     EXEC CICS STARTBR
 18856*052506         DATASET   ('ELTRLR')
 18857*052506         RIDFLD    (ELTRLR-KEY)
 18858*052506         GTEQ
 18859*052506     END-EXEC.
 18860*052506
 18861*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18862*052506
 18863*052506 7250-FIND-LOOP.
 18864*052506     EXEC CICS READNEXT
 18865*052506         DATASET   ('ELTRLR')
 18866*052506         RIDFLD    (ELTRLR-KEY)
 18867*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18868*052506     END-EXEC.
 18869*052506
 18870*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18871*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18872*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18873*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18874*052506        GO TO 7250-END
 18875*052506     END-IF.
 18876*052506
 18877*052506     IF AT-TRAILER-TYPE NOT = '4'
 18878*052506         GO TO 7250-FIND-LOOP
 18879*052506     END-IF.
 18880*052506
 18881*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18882*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18883*052506     END-IF.
 18884*052506
 18885*052506     GO TO 7250-FIND-LOOP.
 18886*052506
 18887*052506 7250-END.
 18888*052506
 18889*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18890*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18891*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18892*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18893*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18894*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18895*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18896*052506     END-IF.
 18897*052506
 18898*052506     EXEC CICS ENDBR
 18899*052506          DATASET    ('ELTRLR')
 18900*052506     END-EXEC.
 18901*052506
 18902*052506 7250-EXIT.
 18903*052506     EXIT.
 18904*052506     EJECT
 18905*052506
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 365
* EL156.cbl
 18906 7300-CHECK-AUTO-ACTIVITY.
 18907
 18908     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18909         NEXT SENTENCE
 18910     ELSE
 18911         GO TO 7399-EXIT.
 18912
 18913     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18914
 18915     IF WS-ACT-REC-FOUND-SW = 'N'
 18916         GO TO 7399-EXIT.
 18917
 18918     IF PI-ACTIVITY-CODE = 09
 18919         GO TO 7300-CONT-AUTO-ACTIVITY.
 18920
 18921     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18922        (PI-ACTIVITY-CODE = 11)
 18923         GO TO 7300-CONT-AUTO-ACTIVITY.
 18924
 18925     IF PI-PROVISIONAL-IND = 'P'
 18926         IF PI-PMTTYPE = '1'
 18927             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18928                 MOVE 'N'    TO  PI-RESET-SW
 18929                 GO TO 7399-EXIT.
 18930
 18931     IF PI-PMTTYPE = '1'
 18932         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18933             MOVE 'N'        TO  PI-RESET-SW
 18934             GO TO 7399-EXIT.
 18935
 18936     IF PI-PMTTYPE = '2' OR '3'
 18937         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18938             MOVE 'N'        TO  PI-RESET-SW
 18939             GO TO 7399-EXIT.
 18940
 18941     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18942         IF PI-PROVISIONAL-IND = 'P'
 18943             NEXT SENTENCE
 18944         ELSE
 18945             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18946
 18947 7300-CONT-AUTO-ACTIVITY.
 18948
 18949     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18950         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18951         MOVE '4'            TO DC-OPTION-CODE
 18952         MOVE +0             TO DC-ELAPSED-DAYS
 18953                                DC-ELAPSED-MONTHS
 18954         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18955         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18956         IF PI-USES-PAID-TO
 18957             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18958             IF NO-CONVERSION-ERROR
 18959                 MOVE +1     TO DC-ELAPSED-DAYS
 18960                 MOVE +0     TO DC-ELAPSED-MONTHS
 18961                 MOVE '6'    TO DC-OPTION-CODE
 18962                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18963                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 366
* EL156.cbl
 18964                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18965
 18966     IF PI-PFKEY-USED = DFHPF5
 18967         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18968         IF PI-USES-PAID-TO
 18969             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18970             MOVE +1                  TO DC-ELAPSED-DAYS
 18971             MOVE +0                  TO DC-ELAPSED-MONTHS
 18972             MOVE '6'                 TO DC-OPTION-CODE
 18973             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18974             IF NO-CONVERSION-ERROR
 18975                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18976
 18977     IF WS-CHK-THRU-DT < PI-EXP-DT
 18978         NEXT SENTENCE
 18979     ELSE
 18980         MOVE 03                     TO  WS-ACTIVITY-CODE
 18981         GO TO 7390-PROCESS-ACTIVITY.
 18982
 18983     IF PI-PROV-PMT
 18984         MOVE 09                     TO  WS-ACTIVITY-CODE
 18985     ELSE
 18986        IF PI-PMTTYPE = '1'
 18987            MOVE 02                  TO  WS-ACTIVITY-CODE
 18988        ELSE
 18989        IF PI-PMTTYPE = '2' OR '3'
 18990            MOVE 07                  TO  WS-ACTIVITY-CODE
 18991        ELSE
 18992        IF PI-PMTTYPE = '4'
 18993            MOVE 00                  TO  WS-ACTIVITY-CODE
 18994        ELSE
 18995            MOVE 'N'                 TO  PI-RESET-SW
 18996            GO TO 7399-EXIT.
 18997
 18998 7390-PROCESS-ACTIVITY.
 18999
 19000     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 19001
 19002 7399-EXIT.
 19003     EXIT.
 19004
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 367
* EL156.cbl
 19006 7400-CHECK-AUTO-ACTIVITY.
 19007
 19008
 19009* EXEC CICS HANDLE CONDITION
 19010*        NOTFND   (7400-NOT-FOUND)
 19011*    END-EXEC.
 19012*    MOVE '"$I                   ! < #00017338' TO DFHEIV0
 19013     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19015     MOVE X'3C20233030303137333338' TO DFHEIV0(25:11)
 19016     CALL 'kxdfhei1' USING DFHEIV0
 19017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19018
 19019
 19020     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 19021     MOVE 'T'                    TO  CNTL-REC-TYPE.
 19022     MOVE SPACES                 TO  CNTL-ACCESS.
 19023     MOVE +0                     TO  CNTL-SEQ-NO.
 19024
 19025
 19026* EXEC CICS READ
 19027*        DATASET   ('ELCNTL')
 19028*        RIDFLD    (ELCNTL-KEY)
 19029*        SET       (ADDRESS OF CONTROL-FILE)
 19030*    END-EXEC.
 19031     MOVE 'ELCNTL' TO DFHEIV1
 19032*    MOVE '&"S        E          (   #00017347' TO DFHEIV0
 19033     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19035     MOVE X'2020233030303137333437' TO DFHEIV0(25:11)
 19036     CALL 'kxdfhei1' USING DFHEIV0,
 19037           DFHEIV1,
 19038           DFHEIV20,
 19039           DFHEIV99,
 19040           ELCNTL-KEY,
 19041           DFHEIV99,
 19042           DFHEIV99,
 19043           DFHEIV99
 19044     SET ADDRESS OF CONTROL-FILE TO
 19045         DFHEIV20
 19046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19047
 19048
 19049     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 19050     GO TO 7400-EXIT.
 19051
 19052 7400-NOT-FOUND.
 19053     MOVE 'N'                        TO  PI-RESET-SW
 19054                                         WS-LETTER-SW
 19055                                         WS-ACT-REC-FOUND-SW.
 19056
 19057     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19058
 19059 7400-EXIT.
 19060     EXIT.
 19061
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 368
* EL156.cbl
 19063 7450-FORMAT-AUTO-LETTER.
 19064
 19065     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 19066         MOVE 'Y'                    TO PI-RESET-SW
 19067         GO TO 7450-CONTINUE-PROCESS.
 19068
 19069     MOVE PI-ACTIVITY-CODE           TO  SUB.
 19070
 19071     IF SUB > 9
 19072         SUBTRACT 9 FROM SUB
 19073         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 19074     ELSE
 19075         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 19076
 19077 7450-CONTINUE-PROCESS.
 19078
 19079     IF WS-ACTIVITY-CODE = ZEROS
 19080         MOVE 'N'                    TO  WS-LETTER-SW
 19081         GO TO 7450-EXIT.
 19082
 19083     MOVE WS-ACTIVITY-CODE           TO  SUB.
 19084
 19085     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 19086         MOVE 'N'                    TO  PI-RESET-SW
 19087                                         WS-LETTER-SW
 19088         GO TO 7450-EXIT.
 19089
 19090     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 19091         MOVE 'N'                    TO  WS-LETTER-SW
 19092         GO TO 7450-EXIT.
 19093
 19094     MOVE 'Y'                        TO  WS-LETTER-SW.
 19095     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 19096     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 19097
 19098     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 19099
 19100     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 19101         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 19102         MOVE '6'                    TO  DC-OPTION-CODE
 19103         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 19104         MOVE +0                     TO  DC-ELAPSED-MONTHS
 19105         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19106         IF NO-CONVERSION-ERROR
 19107             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 19108         ELSE
 19109              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 19110
 19111     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 19112         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 19113         MOVE '6'                    TO  DC-OPTION-CODE
 19114         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 19115         MOVE +0                     TO  DC-ELAPSED-MONTHS
 19116         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19117         IF NO-CONVERSION-ERROR
 19118             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 19119         ELSE
 19120             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 369
* EL156.cbl
 19121
 19122 7450-EXIT.
 19123     EXIT.
 19124
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 370
* EL156.cbl
 19126 7500-RESET-AUTO-ACTIVITY.
 19127
 19128     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 19129     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 19130     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 19131     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 19132     MOVE +100                   TO  TRLR-SEQ-NO.
 19133
 19134 7500-STARTBR-TRLR.
 19135
 19136
 19137* EXEC CICS HANDLE CONDITION
 19138*        ENDFILE  (7590-END)
 19139*        NOTFND   (7590-END)
 19140*    END-EXEC.
 19141*    MOVE '"$''I                  ! = #00017440' TO DFHEIV0
 19142     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19144     MOVE X'3D20233030303137343430' TO DFHEIV0(25:11)
 19145     CALL 'kxdfhei1' USING DFHEIV0
 19146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19147
 19148
 19149
 19150* EXEC CICS STARTBR
 19151*        DATASET   ('ELTRLR')
 19152*        RIDFLD    (ELTRLR-KEY)
 19153*        GTEQ
 19154*    END-EXEC.
 19155     MOVE 'ELTRLR' TO DFHEIV1
 19156     MOVE 0
 19157       TO DFHEIV11
 19158*    MOVE '&,         G          &   #00017445' TO DFHEIV0
 19159     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19160     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19161     MOVE X'2020233030303137343435' TO DFHEIV0(25:11)
 19162     CALL 'kxdfhei1' USING DFHEIV0,
 19163           DFHEIV1,
 19164           ELTRLR-KEY,
 19165           DFHEIV99,
 19166           DFHEIV11,
 19167           DFHEIV99
 19168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19169
 19170
 19171     MOVE 'Y'                        TO  WS-BROWSE-SW.
 19172
 19173 7500-READ-NEXT.
 19174
 19175
 19176* EXEC CICS READNEXT
 19177*        DATASET   ('ELTRLR')
 19178*        RIDFLD    (ELTRLR-KEY)
 19179*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19180*    END-EXEC.
 19181     MOVE 'ELTRLR' TO DFHEIV1
 19182     MOVE 0
 19183       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 371
* EL156.cbl
 19184*    MOVE '&.S                   )   #00017455' TO DFHEIV0
 19185     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19186     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19187     MOVE X'2020233030303137343535' TO DFHEIV0(25:11)
 19188     CALL 'kxdfhei1' USING DFHEIV0,
 19189           DFHEIV1,
 19190           DFHEIV20,
 19191           DFHEIV99,
 19192           ELTRLR-KEY,
 19193           DFHEIV99,
 19194           DFHEIV11,
 19195           DFHEIV99,
 19196           DFHEIV99
 19197     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19198         DFHEIV20
 19199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19200
 19201
 19202     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 19203        PI-CARRIER    NOT = TRLR-CARRIER  OR
 19204        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 19205        PI-CERT-NO    NOT = TRLR-CERT-NO
 19206         GO TO 7590-END.
 19207
 19208     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 19209         GO TO 7500-READ-NEXT.
 19210
 19211     IF AT-TRAILER-TYPE NOT = '4'
 19212         GO TO 7500-READ-NEXT.
 19213
 19214     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 19215         GO TO 7500-READ-NEXT.
 19216
 19217     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 19218        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 19219         GO TO 7500-READ-NEXT.
 19220
 19221     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 19222        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 19223        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 19224         GO TO 7500-READ-NEXT.
 19225
 19226     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 19227                         AND
 19228        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 19229                         AND
 19230        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 19231            GO TO 7500-READ-NEXT.
 19232
 19233     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 19234
 19235
 19236* EXEC CICS ENDBR
 19237*        DATASET   ('ELTRLR')
 19238*    END-EXEC.
 19239     MOVE 'ELTRLR' TO DFHEIV1
 19240     MOVE 0
 19241       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 372
* EL156.cbl
 19242*    MOVE '&2                    $   #00017494' TO DFHEIV0
 19243     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19244     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19245     MOVE X'2020233030303137343934' TO DFHEIV0(25:11)
 19246     CALL 'kxdfhei1' USING DFHEIV0,
 19247           DFHEIV1,
 19248           DFHEIV11,
 19249           DFHEIV99
 19250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19251
 19252
 19253     MOVE 'N'                        TO  WS-BROWSE-SW.
 19254
 19255
 19256* EXEC CICS READ
 19257*        DATASET   ('ELTRLR')
 19258*        RIDFLD    (ELTRLR-KEY)
 19259*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19260*        UPDATE
 19261*    END-EXEC.
 19262     MOVE 'ELTRLR' TO DFHEIV1
 19263*    MOVE '&"S        EU         (   #00017500' TO DFHEIV0
 19264     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19265     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19266     MOVE X'2020233030303137353030' TO DFHEIV0(25:11)
 19267     CALL 'kxdfhei1' USING DFHEIV0,
 19268           DFHEIV1,
 19269           DFHEIV20,
 19270           DFHEIV99,
 19271           ELTRLR-KEY,
 19272           DFHEIV99,
 19273           DFHEIV99,
 19274           DFHEIV99
 19275     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19276         DFHEIV20
 19277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19278
 19279
 19280     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19281
 19282     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19283         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19284     ELSE
 19285         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19286             NEXT SENTENCE
 19287         ELSE
 19288             GO TO 7500-REWRITE-TRLR.
 19289
 19290     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19291
 19292     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19293     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19294     MOVE '1'                        TO  ARCH-REC-TYPE.
 19295     MOVE +0                         TO  ARCH-SEQ.
 19296
 19297     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19298
 19299 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 373
* EL156.cbl
 19300
 19301
 19302* EXEC CICS REWRITE
 19303*        DATASET   ('ELTRLR')
 19304*        FROM      (ACTIVITY-TRAILERS)
 19305*    END-EXEC.
 19306     MOVE LENGTH OF
 19307      ACTIVITY-TRAILERS
 19308       TO DFHEIV11
 19309     MOVE 'ELTRLR' TO DFHEIV1
 19310*    MOVE '&& L                  %   #00017528' TO DFHEIV0
 19311     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19312     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19313     MOVE X'2020233030303137353238' TO DFHEIV0(25:11)
 19314     CALL 'kxdfhei1' USING DFHEIV0,
 19315           DFHEIV1,
 19316           ACTIVITY-TRAILERS,
 19317           DFHEIV11,
 19318           DFHEIV99
 19319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19320
 19321
 19322     GO TO 7500-STARTBR-TRLR.
 19323
 19324 7590-END.
 19325
 19326     IF WS-BROWSE-SW = 'Y'
 19327         MOVE 'N'                    TO  WS-BROWSE-SW
 19328
 19329* EXEC CICS ENDBR
 19330*            DATASET   ('ELTRLR')
 19331*        END-EXEC.
 19332     MOVE 'ELTRLR' TO DFHEIV1
 19333     MOVE 0
 19334       TO DFHEIV11
 19335*    MOVE '&2                    $   #00017539' TO DFHEIV0
 19336     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19337     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19338     MOVE X'2020233030303137353339' TO DFHEIV0(25:11)
 19339     CALL 'kxdfhei1' USING DFHEIV0,
 19340           DFHEIV1,
 19341           DFHEIV11,
 19342           DFHEIV99
 19343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19344
 19345
 19346 7599-EXIT.
 19347     EXIT.
 19348
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 374
* EL156.cbl
 19350 7600-READ-ARCH-UPDATE.
 19351
 19352
 19353* EXEC CICS HANDLE CONDITION
 19354*        NOTFND   (7699-EXIT)
 19355*    END-EXEC.
 19356*    MOVE '"$I                   ! > #00017549' TO DFHEIV0
 19357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19359     MOVE X'3E20233030303137353439' TO DFHEIV0(25:11)
 19360     CALL 'kxdfhei1' USING DFHEIV0
 19361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19362
 19363
 19364
 19365* EXEC CICS READ
 19366*        DATASET   ('ELARCH')
 19367*        RIDFLD    (ELARCH-KEY)
 19368*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19369*        UPDATE
 19370*    END-EXEC.
 19371     MOVE 'ELARCH' TO DFHEIV1
 19372*    MOVE '&"S        EU         (   #00017553' TO DFHEIV0
 19373     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19374     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19375     MOVE X'2020233030303137353533' TO DFHEIV0(25:11)
 19376     CALL 'kxdfhei1' USING DFHEIV0,
 19377           DFHEIV1,
 19378           DFHEIV20,
 19379           DFHEIV99,
 19380           ELARCH-KEY,
 19381           DFHEIV99,
 19382           DFHEIV99,
 19383           DFHEIV99
 19384     SET ADDRESS OF LETTER-ARCHIVE TO
 19385         DFHEIV20
 19386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19387
 19388
 19389     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19390
 19391
 19392* EXEC CICS REWRITE
 19393*        DATASET   ('ELARCH')
 19394*        FROM      (LETTER-ARCHIVE)
 19395*    END-EXEC.
 19396     MOVE LENGTH OF
 19397      LETTER-ARCHIVE
 19398       TO DFHEIV11
 19399     MOVE 'ELARCH' TO DFHEIV1
 19400*    MOVE '&& L                  %   #00017562' TO DFHEIV0
 19401     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19402     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19403     MOVE X'2020233030303137353632' TO DFHEIV0(25:11)
 19404     CALL 'kxdfhei1' USING DFHEIV0,
 19405           DFHEIV1,
 19406           LETTER-ARCHIVE,
 19407           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 375
* EL156.cbl
 19408           DFHEIV99
 19409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19410
 19411
 19412 7699-EXIT.
 19413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 376
* EL156.cbl
 19415 7700-GET-DCT.
 19416
 19417     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19418     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19419     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19420     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19421                                    PI-MAX-BENEFIT-AMT
 19422                                    PI-MAX-BENEFIT-PYMT
 19423                                    PI-MIN-PAYMENT-AMT
 19424                                    PI-TIME-OF-LOSS-BAL.
 19425
 19426
 19427* EXEC CICS HANDLE CONDITION
 19428*         NOTFND (5300-NOTE-NOT-FOUND)
 19429*     END-EXEC.
 19430*    MOVE '"$I                   ! ? #00017581' TO DFHEIV0
 19431     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19433     MOVE X'3F20233030303137353831' TO DFHEIV0(25:11)
 19434     CALL 'kxdfhei1' USING DFHEIV0
 19435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19436
 19437
 19438
 19439* EXEC CICS READ
 19440*         DATASET('ERNOTE')
 19441*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19442*         RIDFLD (W-NOTE-KEY)
 19443*     END-EXEC.
 19444     MOVE 'ERNOTE' TO DFHEIV1
 19445*    MOVE '&"S        E          (   #00017585' TO DFHEIV0
 19446     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19448     MOVE X'2020233030303137353835' TO DFHEIV0(25:11)
 19449     CALL 'kxdfhei1' USING DFHEIV0,
 19450           DFHEIV1,
 19451           DFHEIV20,
 19452           DFHEIV99,
 19453           W-NOTE-KEY,
 19454           DFHEIV99,
 19455           DFHEIV99,
 19456           DFHEIV99
 19457     SET ADDRESS OF CERTIFICATE-NOTE TO
 19458         DFHEIV20
 19459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19460
 19461
 19462     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19463     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19464     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19465     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19466     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19467
 19468     IF PI-PAYEE-TYPE NOT = 'B'
 19469         GO TO 7700-EXIT.
 19470
 19471     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19472     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 377
* EL156.cbl
 19473     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19474
 19475     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19476         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19477     ELSE
 19478         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19479
 19480     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19481     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19482     MOVE 'DLO006'               TO PGM-NAME.
 19483
 19484
 19485* EXEC CICS LINK
 19486*        PROGRAM    (PGM-NAME)
 19487*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19488*        LENGTH     (DCT-RCRD-LENGTH)
 19489*    END-EXEC.
 19490*    MOVE '."C                   (   #00017613' TO DFHEIV0
 19491     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19492     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19493     MOVE X'2020233030303137363133' TO DFHEIV0(25:11)
 19494     CALL 'kxdfhei1' USING DFHEIV0,
 19495           PGM-NAME,
 19496           DCT-COMMUNICATION-AREA,
 19497           DCT-RCRD-LENGTH,
 19498           DFHEIV99,
 19499           DFHEIV99,
 19500           DFHEIV99,
 19501           DFHEIV99
 19502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19503
 19504
 19505     IF DCT-RETURN-CODE = 'OK'
 19506         GO TO 7700-CONT.
 19507
 19508     IF DCT-RETURN-CODE = '01' OR '02'
 19509         GO TO 7700-SET-TO-YES.
 19510
 19511     IF DCT-RETURN-CODE = '03'
 19512
 19513* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19514*    MOVE '6"R                   !   #00017626' TO DFHEIV0
 19515     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19516     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19517     MOVE X'2020233030303137363236' TO DFHEIV0(25:11)
 19518     CALL 'kxdfhei1' USING DFHEIV0
 19519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19520         MOVE ER-0951            TO EMI-ERROR
 19521         MOVE -1                 TO PMTTYPEL
 19522         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19523         GO TO 8200-SEND-DATAONLY.
 19524
 19525     IF DCT-RETURN-CODE = '04'
 19526
 19527* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19528*    MOVE '6"R                   !   #00017633' TO DFHEIV0
 19529     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 378
* EL156.cbl
 19531     MOVE X'2020233030303137363333' TO DFHEIV0(25:11)
 19532     CALL 'kxdfhei1' USING DFHEIV0
 19533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19534         MOVE ER-0946            TO EMI-ERROR
 19535         MOVE -1                 TO PMTTYPEL
 19536         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19537         GO TO 8200-SEND-DATAONLY.
 19538
 19539     IF DCT-RETURN-CODE = '05'
 19540
 19541* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19542*    MOVE '6"R                   !   #00017640' TO DFHEIV0
 19543     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19545     MOVE X'2020233030303137363430' TO DFHEIV0(25:11)
 19546     CALL 'kxdfhei1' USING DFHEIV0
 19547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19548         MOVE ER-0947            TO EMI-ERROR
 19549         MOVE -1                 TO PMTTYPEL
 19550         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19551         GO TO 8200-SEND-DATAONLY.
 19552
 19553     IF DCT-RETURN-CODE = '06'
 19554
 19555* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19556*    MOVE '6"R                   !   #00017647' TO DFHEIV0
 19557     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19558     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19559     MOVE X'2020233030303137363437' TO DFHEIV0(25:11)
 19560     CALL 'kxdfhei1' USING DFHEIV0
 19561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19562         MOVE ER-0921            TO EMI-ERROR
 19563         MOVE -1                 TO PMTTYPEL
 19564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19565         GO TO 8200-SEND-DATAONLY.
 19566
 19567     IF DCT-RETURN-CODE = '07'
 19568
 19569* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19570*    MOVE '6"R                   !   #00017654' TO DFHEIV0
 19571     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19573     MOVE X'2020233030303137363534' TO DFHEIV0(25:11)
 19574     CALL 'kxdfhei1' USING DFHEIV0
 19575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19576         MOVE ER-0919            TO EMI-ERROR
 19577         MOVE -1                 TO PMTTYPEL
 19578         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19579         GO TO 8200-SEND-DATAONLY.
 19580
 19581     IF DCT-RETURN-CODE = '08'
 19582
 19583* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19584*    MOVE '6"R                   !   #00017661' TO DFHEIV0
 19585     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19587     MOVE X'2020233030303137363631' TO DFHEIV0(25:11)
 19588     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 379
* EL156.cbl
 19589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19590         MOVE ER-0948            TO EMI-ERROR
 19591         MOVE -1                 TO PMTTYPEL
 19592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19593         GO TO 8200-SEND-DATAONLY.
 19594
 19595     IF DCT-RETURN-CODE = 'N1'
 19596
 19597* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19598*    MOVE '6"R                   !   #00017668' TO DFHEIV0
 19599     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19601     MOVE X'2020233030303137363638' TO DFHEIV0(25:11)
 19602     CALL 'kxdfhei1' USING DFHEIV0
 19603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19604         MOVE ER-0950            TO EMI-ERROR
 19605         MOVE -1                 TO PMTTYPEL
 19606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19607         GO TO 8200-SEND-DATAONLY.
 19608
 19609     IF DCT-RETURN-CODE = 'E1'
 19610
 19611* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19612*    MOVE '6"R                   !   #00017675' TO DFHEIV0
 19613     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19615     MOVE X'2020233030303137363735' TO DFHEIV0(25:11)
 19616     CALL 'kxdfhei1' USING DFHEIV0
 19617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19618         MOVE ER-0974            TO EMI-ERROR
 19619         MOVE -1                 TO PMTTYPEL
 19620         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19621         GO TO 8200-SEND-DATAONLY.
 19622
 19623     IF DCT-RETURN-CODE = 'E2'
 19624
 19625* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19626*    MOVE '6"R                   !   #00017682' TO DFHEIV0
 19627     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19629     MOVE X'2020233030303137363832' TO DFHEIV0(25:11)
 19630     CALL 'kxdfhei1' USING DFHEIV0
 19631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19632         MOVE ER-0975            TO EMI-ERROR
 19633         MOVE -1                 TO PMTTYPEL
 19634         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19635         GO TO 8200-SEND-DATAONLY.
 19636
 19637     IF DCT-RETURN-CODE NOT = 'OK'
 19638
 19639* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19640*    MOVE '6"R                   !   #00017689' TO DFHEIV0
 19641     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19643     MOVE X'2020233030303137363839' TO DFHEIV0(25:11)
 19644     CALL 'kxdfhei1' USING DFHEIV0
 19645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19646         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 380
* EL156.cbl
 19647         MOVE -1                 TO PMTTYPEL
 19648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19649         GO TO 8200-SEND-DATAONLY.
 19650
 19651 7700-CONT.
 19652
 19653*    MOVE 'N'                    TO CASHO.
 19654*    MOVE +1                     TO CASHL.
 19655*    MOVE AL-UANON               TO CASHA.
 19656
 19657     IF PI-OFFLINE = 'Y'
 19658         GO TO 7700-EXIT.
 19659
 19660     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19661     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19662     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19663     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19664     MOVE +7                     TO CHECKNOL.
 19665     MOVE AL-UANON               TO CHECKNOA.
 19666     GO TO 7700-EXIT.
 19667
 19668 7700-SET-TO-YES.
 19669
 19670*    MOVE 'Y'                    TO CASHO.
 19671*    MOVE +1                     TO CASHL.
 19672*    MOVE AL-UANON               TO CASHA.
 19673
 19674 7700-EXIT.
 19675     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 381
* EL156.cbl
 19677 7800-READ-COMP-MSTR.
 19678
 19679
 19680* EXEC CICS HANDLE CONDITION
 19681*        NOTFND   (7800-COMP-NOTFND)
 19682*    END-EXEC.
 19683*    MOVE '"$I                   ! @ #00017723' TO DFHEIV0
 19684     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19686     MOVE X'4020233030303137373233' TO DFHEIV0(25:11)
 19687     CALL 'kxdfhei1' USING DFHEIV0
 19688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19689
 19690
 19691
 19692* EXEC CICS READ
 19693*        DATASET   ('ERCOMP')
 19694*        RIDFLD    (ERCOMP-KEY)
 19695*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19696*    END-EXEC.
 19697     MOVE 'ERCOMP' TO DFHEIV1
 19698*    MOVE '&"S        E          (   #00017727' TO DFHEIV0
 19699     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19700     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19701     MOVE X'2020233030303137373237' TO DFHEIV0(25:11)
 19702     CALL 'kxdfhei1' USING DFHEIV0,
 19703           DFHEIV1,
 19704           DFHEIV20,
 19705           DFHEIV99,
 19706           ERCOMP-KEY,
 19707           DFHEIV99,
 19708           DFHEIV99,
 19709           DFHEIV99
 19710     SET ADDRESS OF COMPENSATION-MASTER TO
 19711         DFHEIV20
 19712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19713
 19714
 19715     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19716     GO TO 7800-COMP-EXIT.
 19717
 19718 7800-COMP-NOTFND.
 19719     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19720
 19721 7800-COMP-EXIT.
 19722     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 382
* EL156.cbl
 19724 7900-READ-CLAIM.
 19725
 19726* EXEC CICS READ
 19727*        DATASET  ('ELMSTR')
 19728*        SET      (ADDRESS OF CLAIM-MASTER)
 19729*        RIDFLD   (ELMSTR-KEY)
 19730*    END-EXEC.
 19731     MOVE 'ELMSTR' TO DFHEIV1
 19732*    MOVE '&"S        E          (   #00017743' TO DFHEIV0
 19733     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19735     MOVE X'2020233030303137373433' TO DFHEIV0(25:11)
 19736     CALL 'kxdfhei1' USING DFHEIV0,
 19737           DFHEIV1,
 19738           DFHEIV20,
 19739           DFHEIV99,
 19740           ELMSTR-KEY,
 19741           DFHEIV99,
 19742           DFHEIV99,
 19743           DFHEIV99
 19744     SET ADDRESS OF CLAIM-MASTER TO
 19745         DFHEIV20
 19746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19747
 19748
 19749 7900-EXIT.
 19750      EXIT.
 19751
 19752 7910-READ-CLAIM-UPDATE.
 19753
 19754* EXEC CICS READ
 19755*        DATASET  ('ELMSTR')
 19756*        SET      (ADDRESS OF CLAIM-MASTER)
 19757*        RIDFLD   (ELMSTR-KEY)
 19758*        UPDATE
 19759*    END-EXEC.
 19760     MOVE 'ELMSTR' TO DFHEIV1
 19761*    MOVE '&"S        EU         (   #00017753' TO DFHEIV0
 19762     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19763     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19764     MOVE X'2020233030303137373533' TO DFHEIV0(25:11)
 19765     CALL 'kxdfhei1' USING DFHEIV0,
 19766           DFHEIV1,
 19767           DFHEIV20,
 19768           DFHEIV99,
 19769           ELMSTR-KEY,
 19770           DFHEIV99,
 19771           DFHEIV99,
 19772           DFHEIV99
 19773     SET ADDRESS OF CLAIM-MASTER TO
 19774         DFHEIV20
 19775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19776
 19777
 19778 7910-EXIT.
 19779      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 383
* EL156.cbl
 19781 7920-READ-BENE.
 19782     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19783     MOVE 'B'                TO BENE-RECORD-TYPE.
 19784     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19785
 19786     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19787        IF PI-PAYEE-TYPE    = 'B' AND
 19788           PI-PAYEE-SEQ-NUM = 9
 19789             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19790             MOVE WS-A-BENE           TO BENE-NUMBER.
 19791
 19792
 19793* EXEC CICS HANDLE CONDITION
 19794*        NOTFND   (7920-NOT-FOUND)
 19795*    END-EXEC.
 19796*    MOVE '"$I                   ! A #00017774' TO DFHEIV0
 19797     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19799     MOVE X'4120233030303137373734' TO DFHEIV0(25:11)
 19800     CALL 'kxdfhei1' USING DFHEIV0
 19801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19802
 19803
 19804
 19805* EXEC CICS READ
 19806*        DATASET  ('ELBENE')
 19807*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19808*        RIDFLD   (ELBENE-KEY)
 19809*    END-EXEC.
 19810     MOVE 'ELBENE' TO DFHEIV1
 19811*    MOVE '&"S        E          (   #00017778' TO DFHEIV0
 19812     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19813     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19814     MOVE X'2020233030303137373738' TO DFHEIV0(25:11)
 19815     CALL 'kxdfhei1' USING DFHEIV0,
 19816           DFHEIV1,
 19817           DFHEIV20,
 19818           DFHEIV99,
 19819           ELBENE-KEY,
 19820           DFHEIV99,
 19821           DFHEIV99,
 19822           DFHEIV99
 19823     SET ADDRESS OF BENEFICIARY-MASTER TO
 19824         DFHEIV20
 19825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19826
 19827
 19828     MOVE 'Y' TO BENE-FOUND-SW.
 19829     GO TO 7920-EXIT.
 19830
 19831 7920-NOT-FOUND.
 19832     MOVE 'N'                    TO BENE-FOUND-SW.
 19833
 19834 7920-EXIT.
 19835      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 384
* EL156.cbl
 19837 7930-READ-CONTROL.
 19838
 19839* EXEC CICS READ
 19840*        DATASET  ('ELCNTL')
 19841*        SET      (ADDRESS OF CONTROL-FILE)
 19842*        RIDFLD   (ELCNTL-KEY)
 19843*    END-EXEC.
 19844     MOVE 'ELCNTL' TO DFHEIV1
 19845*    MOVE '&"S        E          (   #00017794' TO DFHEIV0
 19846     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19847     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19848     MOVE X'2020233030303137373934' TO DFHEIV0(25:11)
 19849     CALL 'kxdfhei1' USING DFHEIV0,
 19850           DFHEIV1,
 19851           DFHEIV20,
 19852           DFHEIV99,
 19853           ELCNTL-KEY,
 19854           DFHEIV99,
 19855           DFHEIV99,
 19856           DFHEIV99
 19857     SET ADDRESS OF CONTROL-FILE TO
 19858         DFHEIV20
 19859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19860
 19861
 19862 7930-EXIT.
 19863      EXIT.
 19864
 19865 7940-READ-CONTROL-UPDATE.
 19866
 19867* EXEC CICS READ
 19868*        DATASET  ('ELCNTL')
 19869*        SET      (ADDRESS OF CONTROL-FILE)
 19870*        RIDFLD   (ELCNTL-KEY)
 19871*        UPDATE
 19872*    END-EXEC.
 19873     MOVE 'ELCNTL' TO DFHEIV1
 19874*    MOVE '&"S        EU         (   #00017804' TO DFHEIV0
 19875     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19876     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19877     MOVE X'2020233030303137383034' TO DFHEIV0(25:11)
 19878     CALL 'kxdfhei1' USING DFHEIV0,
 19879           DFHEIV1,
 19880           DFHEIV20,
 19881           DFHEIV99,
 19882           ELCNTL-KEY,
 19883           DFHEIV99,
 19884           DFHEIV99,
 19885           DFHEIV99
 19886     SET ADDRESS OF CONTROL-FILE TO
 19887         DFHEIV20
 19888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19889
 19890
 19891 7940-EXIT.
 19892      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 385
* EL156.cbl
 19894 7950-READ-TRAILER.
 19895
 19896* EXEC CICS READ
 19897*        DATASET  ('ELTRLR')
 19898*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19899*        RIDFLD   (ELTRLR-KEY)
 19900*    END-EXEC.
 19901     MOVE 'ELTRLR' TO DFHEIV1
 19902*    MOVE '&"S        E          (   #00017815' TO DFHEIV0
 19903     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19904     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19905     MOVE X'2020233030303137383135' TO DFHEIV0(25:11)
 19906     CALL 'kxdfhei1' USING DFHEIV0,
 19907           DFHEIV1,
 19908           DFHEIV20,
 19909           DFHEIV99,
 19910           ELTRLR-KEY,
 19911           DFHEIV99,
 19912           DFHEIV99,
 19913           DFHEIV99
 19914     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19915         DFHEIV20
 19916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19917
 19918
 19919 7950-EXIT.
 19920      EXIT.
 19921
 19922 7960-READ-TRAILER-UPDATE.
 19923
 19924* EXEC CICS READ
 19925*        DATASET  ('ELTRLR')
 19926*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19927*        RIDFLD   (ELTRLR-KEY)
 19928*        UPDATE
 19929*    END-EXEC.
 19930     MOVE 'ELTRLR' TO DFHEIV1
 19931*    MOVE '&"S        EU         (   #00017825' TO DFHEIV0
 19932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19933     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19934     MOVE X'2020233030303137383235' TO DFHEIV0(25:11)
 19935     CALL 'kxdfhei1' USING DFHEIV0,
 19936           DFHEIV1,
 19937           DFHEIV20,
 19938           DFHEIV99,
 19939           ELTRLR-KEY,
 19940           DFHEIV99,
 19941           DFHEIV99,
 19942           DFHEIV99
 19943     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19944         DFHEIV20
 19945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19946
 19947
 19948 7960-EXIT.
 19949      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 386
* EL156.cbl
 19951 7970-READ-CERT.
 19952
 19953* EXEC CICS READ
 19954*        DATASET  ('ELCERT')
 19955*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19956*        RIDFLD   (ELCERT-KEY)
 19957*    END-EXEC.
 19958     MOVE 'ELCERT' TO DFHEIV1
 19959*    MOVE '&"S        E          (   #00017836' TO DFHEIV0
 19960     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19961     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19962     MOVE X'2020233030303137383336' TO DFHEIV0(25:11)
 19963     CALL 'kxdfhei1' USING DFHEIV0,
 19964           DFHEIV1,
 19965           DFHEIV20,
 19966           DFHEIV99,
 19967           ELCERT-KEY,
 19968           DFHEIV99,
 19969           DFHEIV99,
 19970           DFHEIV99
 19971     SET ADDRESS OF CERTIFICATE-MASTER TO
 19972         DFHEIV20
 19973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19974
 19975
 19976 7970-EXIT.
 19977      EXIT.
 19978 7975-read-acct.
 19979
 19980     move spaces              to WS-ACCT-RECORD-SW
 19981                                 pi-dcc-product-code
 19982
 19983     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19984     MOVE PI-CARRIER          TO ACCT-CARRIER
 19985     MOVE PI-GROUPING         TO ACCT-GROUPING
 19986     MOVE PI-STATE            TO ACCT-STATE
 19987     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19988     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19989     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19990     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19991
 19992
 19993* EXEC CICS READ
 19994*       DATASET ('ERACCT')
 19995*       RIDFLD  (ERACCT-KEY)
 19996*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19997*       GTEQ
 19998*       resp    (WS-RESPONSE)
 19999*    END-EXEC
 20000     MOVE 'ERACCT' TO DFHEIV1
 20001*    MOVE '&"S        G          (  N#00017858' TO DFHEIV0
 20002     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20004     MOVE X'204E233030303137383538' TO DFHEIV0(25:11)
 20005     CALL 'kxdfhei1' USING DFHEIV0,
 20006           DFHEIV1,
 20007           DFHEIV20,
 20008           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 387
* EL156.cbl
 20009           ERACCT-KEY,
 20010           DFHEIV99,
 20011           DFHEIV99,
 20012           DFHEIV99
 20013     SET ADDRESS OF ACCOUNT-MASTER TO
 20014         DFHEIV20
 20015     MOVE EIBRESP  TO WS-RESPONSE
 20016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20017     IF WS-RESP-NORMAL
 20018        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 20019        and pi-cert-eff-dt < am-expiration-dt
 20020        and pi-cert-eff-dt >= am-effective-dt
 20021        move am-dcc-product-code to pi-dcc-product-code
 20022        set acct-found to true
 20023     end-if
 20024
 20025     .
 20026 7975-exit.
 20027     exit.
 20028 7980-READ-CERT-UPDATE.
 20029
 20030* EXEC CICS READ
 20031*        DATASET  ('ELCERT')
 20032*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 20033*        RIDFLD   (ELCERT-KEY)
 20034*        UPDATE
 20035*    END-EXEC.
 20036     MOVE 'ELCERT' TO DFHEIV1
 20037*    MOVE '&"S        EU         (   #00017877' TO DFHEIV0
 20038     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20039     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20040     MOVE X'2020233030303137383737' TO DFHEIV0(25:11)
 20041     CALL 'kxdfhei1' USING DFHEIV0,
 20042           DFHEIV1,
 20043           DFHEIV20,
 20044           DFHEIV99,
 20045           ELCERT-KEY,
 20046           DFHEIV99,
 20047           DFHEIV99,
 20048           DFHEIV99
 20049     SET ADDRESS OF CERTIFICATE-MASTER TO
 20050         DFHEIV20
 20051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20052
 20053
 20054 7980-EXIT.
 20055      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 388
* EL156.cbl
 20057 8000-LOAD-ERROR-MESSAGES.
 20058     IF PI-PASS-SW = 'C'
 20059        MOVE EMI-LINE1           TO ERMSG1BO
 20060     ELSE
 20061        MOVE EMI-LINE1           TO ERRMSG1O
 20062        MOVE EMI-LINE2           TO ERRMSG2O.
 20063
 20064 8000-EXIT.
 20065     EXIT.
 20066
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 389
* EL156.cbl
 20068
 20069 8010-DMD-ERROR-CHECKS.
 20070     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 20071
 20072     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 20073         GO TO 8051-ISSUE-ERROR.
 20074
 20075     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 20076     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 20077     MOVE '3'                    TO DC-OPTION-CODE.
 20078     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 20079     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 20080         GO TO 8051-ISSUE-ERROR.
 20081
 20082     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 20083       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 20084                           OR
 20085          (CL-SSN-STATE   = CL-CERT-STATE  AND
 20086           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 20087             MOVE ER-0851         TO EMI-ERROR
 20088             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20089       END-IF
 20090       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 20091             MOVE ER-8147         TO EMI-ERROR
 20092             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20093
 20094     GO TO 8090-EXIT.
 20095
 20096 8051-ISSUE-ERROR.
 20097     MOVE ER-8146            TO EMI-ERROR.
 20098     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20099     GO TO 8090-EXIT.
 20100
 20101 8090-EXIT.
 20102      EXIT.
 20103
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 390
* EL156.cbl
 20105 8100-SEND-INITIAL-MAP.
 20106
 20107     MOVE SAVE-DATE              TO RUNDTEAO.
 20108     MOVE EIBTIME                TO TIME-IN.
 20109     MOVE TIME-OUT               TO RUNTIMAO.
 20110     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 20111
 20112     IF MAP-NAME = 'EL156A'
 20113        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20114              OR 'FNL'
 20115           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20116        END-IF
 20117        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 20118           MOVE 'N'     TO SURVYYNO
 20119        END-IF
 20120     END-IF
 20121*    IF MAP-NAME = 'EL156A'
 20122*       IF PI-COMPANY-ID = 'CRI'
 20123*          NEXT SENTENCE
 20124*       ELSE
 20125*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 20126
 20127     IF MAP-NAME = 'EL156A'
 20128        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL' OR 'FNL'
 20129           NEXT SENTENCE
 20130        ELSE
 20131           MOVE AL-SADOF TO  PINTA    PINTHA.
 20132
 20133     IF MAP-NAME = 'EL156A'
 20134        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 20135            NEXT SENTENCE
 20136        ELSE
 20137           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 20138
 20139*    IF MAP-NAME = 'EL156A'
 20140*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 20141*          NEXT SENTENCE
 20142*       ELSE
 20143*          MOVE AL-SADOF TO CASHHA CASHA.
 20144
 20145     IF MAP-NAME = 'EL156A'
 20146        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 20147                        or 'VPP' OR 'FNL'
 20148           NEXT SENTENCE
 20149        ELSE
 20150           MOVE AL-SADOF        TO  LOANHA
 20151                                    LOANNOA.
 20152
 20153     IF MAP-NAME = 'EL156A'
 20154        MOVE -1                 TO  ENTERPFL
 20155        IF PI-USES-PAID-TO
 20156           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20157           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20158           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20159        ELSE
 20160           NEXT SENTENCE
 20161     ELSE
 20162        IF MAP-NAME = 'EL156B'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 391
* EL156.cbl
 20163           IF PI-USES-PAID-TO
 20164              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20165              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20166
 20167
 20168* EXEC CICS SEND
 20169*        MAP   (MAP-NAME)
 20170*        MAPSET(MAPSET-NAME)
 20171*        FROM  (EL156AI)
 20172*        ERASE
 20173*        CURSOR
 20174*    END-EXEC.
 20175     MOVE LENGTH OF
 20176      EL156AI
 20177       TO DFHEIV12
 20178     MOVE -1
 20179       TO DFHEIV11
 20180*    MOVE '8$     CT  E    H L F ,   #00017997' TO DFHEIV0
 20181     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 20182     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20183     MOVE X'2020233030303137393937' TO DFHEIV0(25:11)
 20184     CALL 'kxdfhei1' USING DFHEIV0,
 20185           MAP-NAME,
 20186           EL156AI,
 20187           DFHEIV12,
 20188           MAPSET-NAME,
 20189           DFHEIV99,
 20190           DFHEIV99,
 20191           DFHEIV99,
 20192           DFHEIV11,
 20193           DFHEIV99,
 20194           DFHEIV99,
 20195           DFHEIV99
 20196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20197
 20198
 20199     GO TO 9100-RETURN-TRAN.
 20200
 20201 8200-SEND-DATAONLY.
 20202
 20203     IF FIRST-ENTRY = 'Y'
 20204         GO TO 8100-SEND-INITIAL-MAP.
 20205
 20206     IF RETURNED-FROM-B = 'Y'
 20207         GO TO 8100-SEND-INITIAL-MAP.
 20208
 20209     MOVE SAVE-DATE              TO RUNDTEAO.
 20210     MOVE EIBTIME                TO TIME-IN.
 20211     MOVE TIME-OUT               TO RUNTIMAO.
 20212
 20213     IF EIBAID = DFHPF11
 20214        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 20215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20216        MOVE 'EL001   '          TO RETURNED-FROM
 20217        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 20218        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 20219        GO TO 8100-SEND-INITIAL-MAP.
 20220
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 392
* EL156.cbl
 20221     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 20222
 20223     IF MAP-NAME =  'EL156A'
 20224        MOVE -1                 TO  ENTERPFL
 20225        IF PI-USES-PAID-TO
 20226           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20227           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20228           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20229        ELSE
 20230           NEXT SENTENCE
 20231     ELSE
 20232        IF MAP-NAME = 'EL156B'
 20233           IF PI-USES-PAID-TO
 20234              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20235              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20236
 20237     IF MAP-NAME =  'EL156A'
 20238        IF PI-COMPANY-ID = 'BOA'
 20239            IF PI-INT-RATE NUMERIC
 20240                MOVE PI-INT-RATE TO PINTO.
 20241     IF MAP-NAME = 'EL156A'
 20242        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20243              OR 'FNL'
 20244           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20245*          MOVE 'Y'              TO EOBYNO
 20246        END-IF
 20247     END-IF
 20248
 20249
 20250* EXEC CICS SEND
 20251*        MAP   (MAP-NAME)
 20252*        MAPSET(MAPSET-NAME)
 20253*        FROM  (EL156AI)
 20254*        DATAONLY
 20255*        CURSOR
 20256*    END-EXEC.
 20257     MOVE LENGTH OF
 20258      EL156AI
 20259       TO DFHEIV12
 20260     MOVE -1
 20261       TO DFHEIV11
 20262*    MOVE '8$D    CT       H L F ,   #00018055' TO DFHEIV0
 20263     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20264     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20265     MOVE X'2020233030303138303535' TO DFHEIV0(25:11)
 20266     CALL 'kxdfhei1' USING DFHEIV0,
 20267           MAP-NAME,
 20268           EL156AI,
 20269           DFHEIV12,
 20270           MAPSET-NAME,
 20271           DFHEIV99,
 20272           DFHEIV99,
 20273           DFHEIV99,
 20274           DFHEIV11,
 20275           DFHEIV99,
 20276           DFHEIV99,
 20277           DFHEIV99
 20278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 393
* EL156.cbl
 20279
 20280
 20281     GO TO 9100-RETURN-TRAN.
 20282
 20283 8300-SEND-TEXT.
 20284
 20285* EXEC CICS SEND TEXT
 20286*        FROM(LOGOFF-TEXT)
 20287*        LENGTH(LOGOFF-LENGTH)
 20288*        ERASE
 20289*        FREEKB
 20290*    END-EXEC.
 20291*    MOVE '8&      T  E F  H   F -   #00018066' TO DFHEIV0
 20292     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20293     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20294     MOVE X'2020233030303138303636' TO DFHEIV0(25:11)
 20295     CALL 'kxdfhei1' USING DFHEIV0,
 20296           LOGOFF-TEXT,
 20297           LOGOFF-LENGTH,
 20298           DFHEIV99,
 20299           DFHEIV99,
 20300           DFHEIV99,
 20301           DFHEIV99,
 20302           DFHEIV99,
 20303           DFHEIV99,
 20304           DFHEIV99,
 20305           DFHEIV99,
 20306           DFHEIV99,
 20307           DFHEIV99
 20308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20309
 20310
 20311
 20312* EXEC CICS RETURN
 20313*    END-EXEC.
 20314*    MOVE '.(                    ''   #00018073' TO DFHEIV0
 20315     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20316     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20317     MOVE X'2020233030303138303733' TO DFHEIV0(25:11)
 20318     CALL 'kxdfhei1' USING DFHEIV0,
 20319           DFHEIV99,
 20320           DFHEIV99,
 20321           DFHEIV99,
 20322           DFHEIV99,
 20323           DFHEIV99,
 20324           DFHEIV99
 20325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20326
 20327
 20328 8500-FILE-NOTOPEN.
 20329     IF FILE-SWITCH = 'MSTR'
 20330         MOVE ER-0154            TO EMI-ERROR.
 20331     IF FILE-SWITCH = 'TRLR'
 20332         MOVE ER-0172            TO EMI-ERROR.
 20333     IF FILE-SWITCH = 'CERT'
 20334         MOVE ER-0169            TO EMI-ERROR.
 20335     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20336                      'PROC' OR 'STAT'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 394
* EL156.cbl
 20337         MOVE ER-0042            TO EMI-ERROR.
 20338     IF FILE-SWITCH = 'ACTQ'
 20339         MOVE ER-0338            TO EMI-ERROR.
 20340     IF FILE-SWITCH = 'ACCT'
 20341         MOVE ER-0168            TO EMI-ERROR.
 20342
 20343     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20344     MOVE -1                     TO PMTTYPEL.
 20345
 20346     IF FIRST-ENTRY = 'Y'
 20347         GO TO 8100-SEND-INITIAL-MAP.
 20348
 20349     GO TO 8200-SEND-DATAONLY.
 20350
 20351 8600-PGRM-NOT-FOUND.
 20352
 20353     MOVE ER-0923                TO EMI-ERROR.
 20354     MOVE -1                     TO ENTPFBL.
 20355     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20356
 20357     IF FIRST-ENTRY = 'Y'
 20358         GO TO 8100-SEND-INITIAL-MAP
 20359     ELSE
 20360         GO TO 8200-SEND-DATAONLY.
 20361
 20362 8800-UNAUTHORIZED-ACCESS.
 20363     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20364     GO TO 8300-SEND-TEXT.
 20365
 20366 8810-PF23.
 20367     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20368     MOVE XCTL-005               TO PGM-NAME.
 20369     GO TO 9300-XCTL.
 20370
 20371 8820-PF7-8.
 20372     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20373     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20374                                    PI-SAVED-PROGRAM-2
 20375                                    PI-SAVED-PROGRAM-3
 20376                                    PI-SAVED-PROGRAM-4
 20377                                    PI-SAVED-PROGRAM-5
 20378                                    PI-SAVED-PROGRAM-6
 20379                                    PI-RETURN-TO-PROGRAM.
 20380     IF EIBAID = DFHPF8
 20381        MOVE XCTL-132            TO PGM-NAME
 20382     ELSE
 20383        MOVE XCTL-130            TO PGM-NAME.
 20384
 20385     GO TO 9300-XCTL.
 20386
 20387 9100-RETURN-TRAN.
 20388     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20389     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20390
 20391
 20392* EXEC CICS RETURN
 20393*        TRANSID(TRANS-ID)
 20394*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 395
* EL156.cbl
 20395*        LENGTH(PI-COMM-LENGTH)
 20396*    END-EXEC.
 20397*    MOVE '.(CT                  ''   #00018139' TO DFHEIV0
 20398     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20400     MOVE X'2020233030303138313339' TO DFHEIV0(25:11)
 20401     CALL 'kxdfhei1' USING DFHEIV0,
 20402           TRANS-ID,
 20403           PROGRAM-INTERFACE-BLOCK,
 20404           PI-COMM-LENGTH,
 20405           DFHEIV99,
 20406           DFHEIV99,
 20407           DFHEIV99
 20408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20409
 20410
 20411 9200-RETURN-MAIN-MENU.
 20412     MOVE XCTL-126               TO PGM-NAME.
 20413     GO TO 9300-XCTL.
 20414
 20415 9300-XCTL.
 20416
 20417* EXEC CICS XCTL
 20418*        PROGRAM(PGM-NAME)
 20419*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20420*        LENGTH(PI-COMM-LENGTH)
 20421*    END-EXEC.
 20422*    MOVE '.$C                   %   #00018150' TO DFHEIV0
 20423     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20424     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20425     MOVE X'2020233030303138313530' TO DFHEIV0(25:11)
 20426     CALL 'kxdfhei1' USING DFHEIV0,
 20427           PGM-NAME,
 20428           PROGRAM-INTERFACE-BLOCK,
 20429           PI-COMM-LENGTH,
 20430           DFHEIV99
 20431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20432
 20433
 20434 9400-CLEAR.
 20435     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20436     GO TO 9300-XCTL.
 20437
 20438 9500-PF12.
 20439     MOVE XCTL-010               TO PGM-NAME.
 20440     GO TO 9300-XCTL.
 20441
 20442 9700-LINK-DATE-CONVERT.
 20443     MOVE LINK-ELDATCV           TO PGM-NAME.
 20444
 20445* EXEC CICS LINK
 20446*        PROGRAM   (PGM-NAME)
 20447*        COMMAREA  (DATE-CONVERSION-DATA)
 20448*        LENGTH    (DC-COMM-LENGTH)
 20449*    END-EXEC.
 20450*    MOVE '."C                   (   #00018166' TO DFHEIV0
 20451     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 396
* EL156.cbl
 20453     MOVE X'2020233030303138313636' TO DFHEIV0(25:11)
 20454     CALL 'kxdfhei1' USING DFHEIV0,
 20455           PGM-NAME,
 20456           DATE-CONVERSION-DATA,
 20457           DC-COMM-LENGTH,
 20458           DFHEIV99,
 20459           DFHEIV99,
 20460           DFHEIV99,
 20461           DFHEIV99
 20462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20463
 20464
 20465 9700-EXIT.
 20466     EXIT.
 20467
 20468 9800-LINK-REM-TERM.
 20469     MOVE LINK-REMTERM TO PGM-NAME.
 20470
 20471
 20472* EXEC CICS LINK
 20473*        PROGRAM   (PGM-NAME)
 20474*        COMMAREA  (CALCULATION-PASS-AREA)
 20475*        LENGTH    (CP-COMM-LENGTH)
 20476*    END-EXEC.
 20477*    MOVE '."C                   (   #00018178' TO DFHEIV0
 20478     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20479     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20480     MOVE X'2020233030303138313738' TO DFHEIV0(25:11)
 20481     CALL 'kxdfhei1' USING DFHEIV0,
 20482           PGM-NAME,
 20483           CALCULATION-PASS-AREA,
 20484           CP-COMM-LENGTH,
 20485           DFHEIV99,
 20486           DFHEIV99,
 20487           DFHEIV99,
 20488           DFHEIV99
 20489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20490
 20491
 20492 9800-EXIT.
 20493     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 397
* EL156.cbl
 20495 9830-DMD-REMAINING-TERM.
 20496
 20497     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20498         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20499
 20500     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20501                              CM-PMT-EXTENSION-DAYS.
 20502
 20503     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20504                                  CL-NO-OF-DAYS-PAID.
 20505
 20506     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20507         GIVING W-REM REMAINDER W-REM-DAYS.
 20508
 20509     MOVE W-REM                  TO WST-REM.
 20510
 20511     IF W-REM-DAYS > ZEROS
 20512         MOVE '/'                TO WST-SLASH
 20513         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20514     ELSE
 20515         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20516
 20517 9830-EXIT.
 20518     EXIT.
 20519
 20520 9870-OUTPUT-ACTIVITY-RECORD.
 20521
 20522
 20523* EXEC CICS GETMAIN
 20524*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20525*         LENGTH(25)
 20526*         INITIMG(WS-BLANK)
 20527*    END-EXEC.
 20528     MOVE 25
 20529       TO DFHEIV11
 20530*    MOVE ',"IL                  $   #00018214' TO DFHEIV0
 20531     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20532     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20533     MOVE X'2020233030303138323134' TO DFHEIV0(25:11)
 20534     CALL 'kxdfhei1' USING DFHEIV0,
 20535           DFHEIV20,
 20536           DFHEIV11,
 20537           WS-BLANK
 20538     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20539         DFHEIV20
 20540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20541
 20542
 20543     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20544     MOVE ELMSTR-KEY             TO DA-KEY.
 20545     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20546
 20547     IF PI-PMTTYPE EQUAL '7'
 20548         MOVE 'V'                TO DA-RECORD-TYPE
 20549     ELSE
 20550         MOVE 'P'                TO DA-RECORD-TYPE.
 20551
 20552
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 398
* EL156.cbl
 20553* EXEC CICS HANDLE CONDITION
 20554*         NOTOPEN(9870-NOTOPEN)
 20555*         DUPREC(9870-EXIT)
 20556*    END-EXEC.
 20557*    MOVE '"$J%                  ! B #00018229' TO DFHEIV0
 20558     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20560     MOVE X'4220233030303138323239' TO DFHEIV0(25:11)
 20561     CALL 'kxdfhei1' USING DFHEIV0
 20562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20563
 20564
 20565
 20566* EXEC CICS WRITE
 20567*         DATASET('DLYACTV')
 20568*         RIDFLD(DA-KEY)
 20569*         FROM(DAILY-ACTIVITY-RECORD)
 20570*         LENGTH(25)
 20571*    END-EXEC.
 20572     MOVE 'DLYACTV' TO DFHEIV1
 20573     MOVE 25
 20574       TO DFHEIV11
 20575*    MOVE '&$ L                  ''   #00018234' TO DFHEIV0
 20576     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20577     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20578     MOVE X'2020233030303138323334' TO DFHEIV0(25:11)
 20579     CALL 'kxdfhei1' USING DFHEIV0,
 20580           DFHEIV1,
 20581           DAILY-ACTIVITY-RECORD,
 20582           DFHEIV11,
 20583           DA-KEY,
 20584           DFHEIV99,
 20585           DFHEIV99
 20586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20587
 20588     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20589     GO TO 9870-EXIT.
 20590
 20591 9870-NOTOPEN.
 20592
 20593     MOVE '2955'                 TO EMI-ERROR.
 20594     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20595
 20596 9870-EXIT.
 20597     EXIT.
 20598
 20599 9900-ERROR-FORMAT.
 20600
 20601     IF EMI-ERROR = ER-0923
 20602         MOVE PGM-NAME           TO W-CALLED-NAME.
 20603
 20604     MOVE LINK-001      TO PGM-NAME.
 20605     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20606
 20607
 20608* EXEC CICS LINK
 20609*        PROGRAM (PGM-NAME)
 20610*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 399
* EL156.cbl
 20611*        LENGTH  (EMI-COMM-LENGTH)
 20612*    END-EXEC.
 20613*    MOVE '."C                   (   #00018259' TO DFHEIV0
 20614     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20616     MOVE X'2020233030303138323539' TO DFHEIV0(25:11)
 20617     CALL 'kxdfhei1' USING DFHEIV0,
 20618           PGM-NAME,
 20619           ERROR-MESSAGE-INTERFACE-BLOCK,
 20620           EMI-COMM-LENGTH,
 20621           DFHEIV99,
 20622           DFHEIV99,
 20623           DFHEIV99,
 20624           DFHEIV99
 20625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20626
 20627
 20628     IF EMI-ERROR = ER-0923
 20629         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20630
 20631 9900-EXIT.
 20632     EXIT.
 20633
 20634 9990-ABEND.
 20635     MOVE LINK-004               TO PGM-NAME.
 20636     MOVE DFHEIBLK               TO EMI-LINE1.
 20637
 20638* EXEC CICS LINK
 20639*        PROGRAM   (PGM-NAME)
 20640*        COMMAREA  (EMI-LINE1)
 20641*        LENGTH    (64)
 20642*    END-EXEC.
 20643     MOVE 64
 20644       TO DFHEIV11
 20645*    MOVE '."C                   (   #00018274' TO DFHEIV0
 20646     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20648     MOVE X'2020233030303138323734' TO DFHEIV0(25:11)
 20649     CALL 'kxdfhei1' USING DFHEIV0,
 20650           PGM-NAME,
 20651           EMI-LINE1,
 20652           DFHEIV11,
 20653           DFHEIV99,
 20654           DFHEIV99,
 20655           DFHEIV99,
 20656           DFHEIV99
 20657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20658
 20659
 20660     MOVE 'EL156A'               TO  MAP-NAME.
 20661     MOVE LOW-VALUES             TO  EL156AO.
 20662     GO TO 8100-SEND-INITIAL-MAP.
 20663
 20664 9995-SECURITY-VIOLATION.
 20665*    COPY ELCSCTP.
 20666******************************************************************
 20667*                                                                *
 20668*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 400
* EL156.cbl
 20669*                            VMOD=2.001                          *
 20670*                                                                *
 20671*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20672******************************************************************
 20673
 20674
 20675     MOVE EIBDATE          TO SM-JUL-DATE.
 20676     MOVE EIBTRMID         TO SM-TERMID.
 20677     MOVE THIS-PGM         TO SM-PGM.
 20678     MOVE EIBTIME          TO TIME-IN.
 20679     MOVE TIME-OUT         TO SM-TIME.
 20680     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20681
 20682
 20683* EXEC CICS LINK
 20684*         PROGRAM  ('EL003')
 20685*         COMMAREA (SECURITY-MESSAGE)
 20686*         LENGTH   (80)
 20687*    END-EXEC.
 20688     MOVE 'EL003' TO DFHEIV1
 20689     MOVE 80
 20690       TO DFHEIV11
 20691*    MOVE '."C                   (   #00018302' TO DFHEIV0
 20692     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20694     MOVE X'2020233030303138333032' TO DFHEIV0(25:11)
 20695     CALL 'kxdfhei1' USING DFHEIV0,
 20696           DFHEIV1,
 20697           SECURITY-MESSAGE,
 20698           DFHEIV11,
 20699           DFHEIV99,
 20700           DFHEIV99,
 20701           DFHEIV99,
 20702           DFHEIV99
 20703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20704
 20705
 20706******************************************************************
 20707
 20708
 20709
 20710 9999-DFHBACK SECTION.
 20711     MOVE '9%                    "   ' TO DFHEIV0
 20712     MOVE 'EL156' TO DFHEIV1
 20713     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20714     GOBACK.
 20715 9999-DFHEXIT.
 20716     IF DFHEIGDJ EQUAL 0001
 20717         NEXT SENTENCE
 20718     ELSE IF DFHEIGDJ EQUAL 2
 20719         GO TO 9990-ABEND,
 20720               8600-PGRM-NOT-FOUND,
 20721               0400-FIRST-TIME,
 20722               6180-DUPREC,
 20723               9990-ABEND
 20724         DEPENDING ON DFHEIGDI
 20725     ELSE IF DFHEIGDJ EQUAL 3
 20726         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 401
* EL156.cbl
 20727               0380-CLAIM-END-FILE
 20728         DEPENDING ON DFHEIGDI
 20729     ELSE IF DFHEIGDJ EQUAL 4
 20730         GO TO 0380-CLAIM-END-FILE,
 20731               0380-CLAIM-END-FILE
 20732         DEPENDING ON DFHEIGDI
 20733     ELSE IF DFHEIGDJ EQUAL 5
 20734         GO TO 0800-EXIT
 20735         DEPENDING ON DFHEIGDI
 20736     ELSE IF DFHEIGDJ EQUAL 6
 20737         GO TO 1950-NOT-FOUND,
 20738               1950-NOT-FOUND
 20739         DEPENDING ON DFHEIGDI
 20740     ELSE IF DFHEIGDJ EQUAL 7
 20741         GO TO 1950-NOT-FOUND
 20742         DEPENDING ON DFHEIGDI
 20743     ELSE IF DFHEIGDJ EQUAL 8
 20744         GO TO 1950-NOT-FOUND,
 20745               1950-NOT-FOUND
 20746         DEPENDING ON DFHEIGDI
 20747     ELSE IF DFHEIGDJ EQUAL 9
 20748         GO TO 1166-END-CHECK,
 20749               1166-END-CHECK
 20750         DEPENDING ON DFHEIGDI
 20751     ELSE IF DFHEIGDJ EQUAL 10
 20752         GO TO 1950-NOT-FOUND,
 20753               1950-NOT-FOUND
 20754         DEPENDING ON DFHEIGDI
 20755     ELSE IF DFHEIGDJ EQUAL 11
 20756         GO TO 1950-NOT-FOUND,
 20757               1950-NOT-FOUND
 20758         DEPENDING ON DFHEIGDI
 20759     ELSE IF DFHEIGDJ EQUAL 12
 20760         GO TO 1950-NOT-FOUND
 20761         DEPENDING ON DFHEIGDI
 20762     ELSE IF DFHEIGDJ EQUAL 13
 20763         GO TO 3600-CONTINUE
 20764         DEPENDING ON DFHEIGDI
 20765     ELSE IF DFHEIGDJ EQUAL 14
 20766         GO TO 5300-NOTE-NOT-FOUND
 20767         DEPENDING ON DFHEIGDI
 20768     ELSE IF DFHEIGDJ EQUAL 15
 20769         GO TO 6065-NOT-FOUND
 20770         DEPENDING ON DFHEIGDI
 20771     ELSE IF DFHEIGDJ EQUAL 16
 20772         GO TO 6068-ACCT-NOT-FND
 20773         DEPENDING ON DFHEIGDI
 20774     ELSE IF DFHEIGDJ EQUAL 17
 20775         GO TO 6074-GET-COMP-DATA
 20776         DEPENDING ON DFHEIGDI
 20777     ELSE IF DFHEIGDJ EQUAL 18
 20778         GO TO 6170-WRITE
 20779         DEPENDING ON DFHEIGDI
 20780     ELSE IF DFHEIGDJ EQUAL 19
 20781         GO TO 6180-DUPREC
 20782         DEPENDING ON DFHEIGDI
 20783     ELSE IF DFHEIGDJ EQUAL 20
 20784         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:20 Page 402
* EL156.cbl
 20785         DEPENDING ON DFHEIGDI
 20786     ELSE IF DFHEIGDJ EQUAL 21
 20787         GO TO 6185-DUPREC
 20788         DEPENDING ON DFHEIGDI
 20789     ELSE IF DFHEIGDJ EQUAL 22
 20790         GO TO 6720-BUILD-NEW-RECORD
 20791         DEPENDING ON DFHEIGDI
 20792     ELSE IF DFHEIGDJ EQUAL 23
 20793         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20794               6900-BUILD-ARCHIVE-HEADER
 20795         DEPENDING ON DFHEIGDI
 20796     ELSE IF DFHEIGDJ EQUAL 24
 20797         GO TO 7010-BUILD-MAP
 20798         DEPENDING ON DFHEIGDI
 20799     ELSE IF DFHEIGDJ EQUAL 25
 20800         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20801         DEPENDING ON DFHEIGDI
 20802     ELSE IF DFHEIGDJ EQUAL 26
 20803         GO TO 7160-DUPREC
 20804         DEPENDING ON DFHEIGDI
 20805     ELSE IF DFHEIGDJ EQUAL 27
 20806         GO TO 7200-EXIT,
 20807               7200-EXIT
 20808         DEPENDING ON DFHEIGDI
 20809     ELSE IF DFHEIGDJ EQUAL 28
 20810         GO TO 7400-NOT-FOUND
 20811         DEPENDING ON DFHEIGDI
 20812     ELSE IF DFHEIGDJ EQUAL 29
 20813         GO TO 7590-END,
 20814               7590-END
 20815         DEPENDING ON DFHEIGDI
 20816     ELSE IF DFHEIGDJ EQUAL 30
 20817         GO TO 7699-EXIT
 20818         DEPENDING ON DFHEIGDI
 20819     ELSE IF DFHEIGDJ EQUAL 31
 20820         GO TO 5300-NOTE-NOT-FOUND
 20821         DEPENDING ON DFHEIGDI
 20822     ELSE IF DFHEIGDJ EQUAL 32
 20823         GO TO 7800-COMP-NOTFND
 20824         DEPENDING ON DFHEIGDI
 20825     ELSE IF DFHEIGDJ EQUAL 33
 20826         GO TO 7920-NOT-FOUND
 20827         DEPENDING ON DFHEIGDI
 20828     ELSE IF DFHEIGDJ EQUAL 34
 20829         GO TO 9870-NOTOPEN,
 20830               9870-EXIT
 20831         DEPENDING ON DFHEIGDI.
 20832     MOVE '9%                    "   ' TO DFHEIV0
 20833     MOVE 'EL156' TO DFHEIV1
 20834     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20835     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12852     Code:       78038
