* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47******************************************************************
    48 environment division.
    49 data division.
    50 working-storage section.
    51 01  DFH-START PIC X(04).
    52*
    53* program buffers
    54*
    55 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    56     88  ALREADY-SENT              VALUE 'Y'.
    57 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    58 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    59     88  ELCERT-FINISHED            VALUE 'Y'.
    60 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    61 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    62     88  ERACCT-FOUND               VALUE 'Y'.
    63 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    64 77 ws-send-msg-size           pic s9(8) comp value 4096.
    65 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    66 77 ws-recv-buf                pic x(4096).
    67 77 ws-send-buf                pic x(4096) VALUE SPACES.
    68 77 ws-recv-total              pic s9(8) comp value 0.
    69 77 ws-recv-left               pic s9(8) comp value 0.
    70 77 ws-seq-num                 pic s9(8) comp value 0.
    71 77 ws-flags                   pic s9(8) comp value 0.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page   3
* SOCK03.cbl
    72 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    73 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    74 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    75 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    76 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    77 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    78 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    79 77  ws-cancel-reason            pic x   value spaces.
    80 77  P1                          PIC S999 COMP-3 VALUE +0.
    81 77  P2                          PIC S999 COMP-3 VALUE +0.
    82 77  C0                          PIC S999 COMP-3 VALUE +0.
    83 77  C1                          PIC S999 COMP-3 VALUE +0.
    84 77  C2                          PIC S999 COMP-3 VALUE +0.
    85 77  C3                          PIC S999 COMP-3 VALUE +0.
    86 77 S1                           PIC S999 COMP-3 VALUE +0.
    87 77 S2                           PIC S999 COMP-3 VALUE +0.
    88 77 L1                           PIC S999 COMP-3 VALUE +0.
    89 77 L2                           PIC S999 COMP-3 VALUE +0.
    90 77 F1                           PIC S999 COMP-3 VALUE +0.
    91 77 WS-BUILD-SW                  PIC X.
    92    88  TIME-TO-BUILD               VALUE 'Y'.
    93 77 WS-SAVE-ERACCT               PIC X(2000).
    94 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    95 77 WS-STOP-SW                   PIC X  VALUE ' '.
    96    88  TOLD-TO-STOP               VALUE 'Y'.
    97 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    98    88  GET-RATES                    VALUE 'R'.
    99    88  GET-ACT-ACCTS                VALUE 'A'.
   100 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   101 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   102 77 ws-disp-rate                 pic z9.99999.
   103 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   104     88  END-OF-ERCTBL                 VALUE 'Y'.
   105 77  WS-STATUS                   PIC X.
   106 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   107 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   108 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   109 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   110 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   111 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   112 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   113 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   114 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   115 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   116 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   117 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   118     88  WS-ELCERT-FULL             VALUE '1'.
   119     88  WS-ELCERT-NAME             VALUE '2'.
   120     88  WS-ELCERT-CERT-NO          VALUE '3'.
   121     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   122 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   123 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   124     88  I-SAY-TO-STOP      VALUE 'Y'.
   125 77  WS-HEX-0A                   PIC X.
   126 77  WS-CALL-TYPE                PIC X(6).
   127 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   128 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   129 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page   4
* SOCK03.cbl
   130 77  DD-IU-SW                    PIC X   VALUE ' '.
   131     88  DD-IU-PRESENT                 VALUE 'Y'.
   132 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   133 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   134 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   135 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   136 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   137 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   138 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   139 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   140 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   141     88  PDEF-FOUND                              VALUE 'Y'.
   142 01  WS-STRING-DATA.
   143     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   144     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   145     05  WS-CARRIER              PIC X        VALUE SPACES.
   146     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   147     05  WS-STATE                PIC XX       VALUE SPACES.
   148     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   149     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   150     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   151     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   152     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   153     05  WS-MID-INIT             PIC X        VALUE SPACES.
   154     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   155     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   156     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   157     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   158     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   159     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   160     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   161     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   162     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   163     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   164     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   165     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   166     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   167     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   168     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   169     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   170     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   171     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   172     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   173     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   174     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   175     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   176     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   177     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   178     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   179     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   180     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   181     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   182     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   183     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   184     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   185     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   186     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   187     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page   5
* SOCK03.cbl
   188     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   189     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   190     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   191     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   192     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   193 01  ws-work-date.
   194     05  ws-work-ccyy            pic x(4).
   195     05  ws-work-mm              pic xx.
   196     05  ws-work-dd              pic xx.
   197 01  ws-work-date-num redefines ws-work-date
   198                                 pic 9(8).
   199 01  FILLER.
   200     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   201     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   202     12  WS-STATE-ABBREVIATION   PIC XX.
   203     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   204     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   205     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   206     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   207     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   208     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   209     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   210     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   211     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   212     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   213     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   214     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   215     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   216     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   217     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   218     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   219     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   220     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   221     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   222     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   223     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   224     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   225     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   226     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   227     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   228     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   229         88  WS-REDUCING                         VALUE 'R'.
   230         88  WS-LEVEL                            VALUE 'L'  'P'.
   231 01  ELMSTR-KEY.
   232     12  ELMSTR-COMP-CD          PIC X.
   233     12  ELMSTR-CERT-NO          PIC X(11).
   234 01  CTBL-KEY-SAVE               PIC X(5).
   235 01  CTBL-KEY.
   236     05  CTBL-COMPANY-CD         PIC X.
   237     05  CTBL-TABLE              PIC XXX.
   238     05  CTBL-BEN-TYPE           PIC X.
   239     05  CTBL-BEN-CODE           PIC XX.
   240 01  ERPDEF-KEY-SAVE             PIC X(18).
   241 01  ERPDEF-KEY.
   242     12  ERPDEF-COMPANY-CD       PIC X.
   243     12  ERPDEF-STATE            PIC XX.
   244     12  ERPDEF-PROD-CD          PIC XXX.
   245     12  F                       PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page   6
* SOCK03.cbl
   246     12  ERPDEF-BEN-TYPE         PIC X.
   247     12  ERPDEF-BEN-CODE         PIC XX.
   248     12  ERPDEF-EXP-DT           PIC XX.
   249 01  WS-AM3-KEY.
   250     12  WS-AM3-ACCOUNT          PIC X(10).
   251     12  WS-AM3-EXP-DT           PIC XX.
   252 01  WS-AM-KEY.
   253     12  WS-AM-COMPANY-CD        PIC X.
   254     12  WS-AM-CARRIER           PIC X.
   255     12  WS-AM-GROUPING          PIC X(6).
   256     12  WS-AM-STATE             PIC XX.
   257     12  WS-AM-ACCOUNT           PIC X(10).
   258     12  WS-AM-EXPIRATION-DT     PIC XX.
   259     12  WS-AM-FILLER            PIC XXXX.
   260 01  WS-CO-DATA.
   261     05  WS-CO-NUM               PIC X(10).
   262     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   263     05  WS-CO-NAME              PIC X(30).
   264     05  WS-CO-MAIL-NAME         PIC X(30).
   265     05  WS-CO-ADDR1             PIC X(30).
   266     05  WS-CO-ADDR2             PIC X(30).
   267     05  WS-CO-ADDR3             PIC X(30).
   268     05  WS-CO-ZIP               PIC X(9).
   269     05  WS-CO-PHONE             PIC X(10).
   270 01  WS-CF-KEY.
   271     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   272     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   273*        88  COMPANY-MASTER                      VALUE '1'.
   274*        88  STATE-MASTER                        VALUE '3'.
   275*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   276*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   277     12  WS-CF-ACCESS.
   278         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   279         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   280             20  FILLER          PIC  X(01).
   281             20  WS-CF-CARRIER   PIC  X(01).
   282     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   283 01  WS-CM-KEY.
   284     05  WS-CM-COMPANY-CD        PIC X.
   285     05  WS-CM-CARRIER           PIC X.
   286     05  WS-CM-GROUP             PIC X(6).
   287     05  WS-CM-STATE             PIC XX.
   288     05  WS-CM-ACCOUNT           PIC X(10).
   289     05  WS-CM-EFF-DT            PIC XX.
   290     05  WS-CM-CERT-NO           PIC X(11).
   291 01  WS-CM-KEY-A1.
   292     05  WS-CM-COMPANY-CD-A1     PIC X.
   293     05  WS-CM-LAST-NAME         PIC X(15).
   294     05  WS-CM-INITIALS          PIC XX.
   295 01  WS-CM-KEY-A4.
   296     05  WS-CM-COMPANY-CD-A4     PIC X.
   297     05  WS-CM-CERT-NO-A4        PIC X(11).
   298 01  WS-CID-NO                   PIC X(8).
   299 01  WS-DISP-RESP                PIC 9(5).
   300 01  WS-RESPONSE                 PIC S9(8)   COMP.
   301     88  RESP-NORMAL                  VALUE +00.
   302     88  RESP-NOTFND                  VALUE +13.
   303     88  RESP-DUPKEY                  VALUE +15.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page   7
* SOCK03.cbl
   304     88  RESP-NOTOPEN                 VALUE +19.
   305     88  RESP-ENDFILE                 VALUE +20.
   306*                                 COPY ELCCERT.
   307******************************************************************
   308*                                                                *
   309*                            ELCCERT.                            *
   310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   311*                            VMOD=2.013                          *
   312*                                                                *
   313*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   314*                                                                *
   315*   FILE TYPE = VSAM,KSDS                                        *
   316*   RECORD SIZE = 450  RECFORM = FIXED                           *
   317*                                                                *
   318*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   319*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   320*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   321*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   322*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   323*                                                                *
   324*   LOG = YES                                                    *
   325*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   326******************************************************************
   327*                   C H A N G E   L O G
   328*
   329* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   330*-----------------------------------------------------------------
   331*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   332* EFFECTIVE    NUMBER
   333*-----------------------------------------------------------------
   334* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   335* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   336* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   337* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   338* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   339* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   340* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   341* 032612  CR2011110200001  PEMA  AHL CHANGES
   342******************************************************************
   343
   344 01  CERTIFICATE-MASTER.
   345     12  CM-RECORD-ID                      PIC XX.
   346         88  VALID-CM-ID                      VALUE 'CM'.
   347
   348     12  CM-CONTROL-PRIMARY.
   349         16  CM-COMPANY-CD                 PIC X.
   350         16  CM-CARRIER                    PIC X.
   351         16  CM-GROUPING.
   352             20  CM-GROUPING-PREFIX        PIC X(3).
   353             20  CM-GROUPING-PRIME         PIC X(3).
   354         16  CM-STATE                      PIC XX.
   355         16  CM-ACCOUNT.
   356             20  CM-ACCOUNT-PREFIX         PIC X(4).
   357             20  CM-ACCOUNT-PRIME          PIC X(6).
   358         16  CM-CERT-EFF-DT                PIC XX.
   359         16  CM-CERT-NO.
   360             20  CM-CERT-PRIME             PIC X(10).
   361             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page   8
* SOCK03.cbl
   362
   363     12  CM-CONTROL-BY-NAME.
   364         16  CM-COMPANY-CD-A1              PIC X.
   365         16  CM-INSURED-LAST-NAME          PIC X(15).
   366         16  CM-INSURED-INITIALS.
   367             20  CM-INSURED-INITIAL1       PIC X.
   368             20  CM-INSURED-INITIAL2       PIC X.
   369
   370     12  CM-CONTROL-BY-SSN.
   371         16  CM-COMPANY-CD-A2              PIC X.
   372         16  CM-SOC-SEC-NO.
   373             20  CM-SSN-STATE              PIC XX.
   374             20  CM-SSN-ACCOUNT            PIC X(6).
   375             20  CM-SSN-LN3.
   376                 25  CM-INSURED-INITIALS-A2.
   377                     30 CM-INSURED-INITIAL1-A2   PIC X.
   378                     30 CM-INSURED-INITIAL2-A2   PIC X.
   379                 25 CM-PART-LAST-NAME-A2         PIC X.
   380
   381     12  CM-CONTROL-BY-CERT-NO.
   382         16  CM-COMPANY-CD-A4              PIC X.
   383         16  CM-CERT-NO-A4                 PIC X(11).
   384
   385     12  CM-CONTROL-BY-MEMB.
   386         16  CM-COMPANY-CD-A5              PIC X.
   387         16  CM-MEMBER-NO.
   388             20  CM-MEMB-STATE             PIC XX.
   389             20  CM-MEMB-ACCOUNT           PIC X(6).
   390             20  CM-MEMB-LN4.
   391                 25  CM-INSURED-INITIALS-A5.
   392                     30 CM-INSURED-INITIAL1-A5   PIC X.
   393                     30 CM-INSURED-INITIAL2-A5   PIC X.
   394                 25 CM-PART-LAST-NAME-A5         PIC XX.
   395
   396     12  CM-INSURED-PROFILE-DATA.
   397         16  CM-INSURED-FIRST-NAME.
   398             20  CM-INSURED-1ST-INIT       PIC X.
   399             20  FILLER                    PIC X(9).
   400         16  CM-INSURED-ISSUE-AGE          PIC 99.
   401         16  CM-INSURED-SEX                PIC X.
   402             88  CM-SEX-MALE                  VALUE 'M'.
   403             88  CM-SEX-FEMAL                 VALUE 'F'.
   404         16  CM-INSURED-JOINT-AGE          PIC 99.
   405         16  CM-JOINT-INSURED-NAME.
   406             20  CM-JT-LAST-NAME           PIC X(15).
   407             20  CM-JT-FIRST-NAME.
   408                 24  CM-JT-1ST-INIT        PIC X.
   409                 24  FILLER                PIC X(9).
   410             20  CM-JT-INITIAL             PIC X.
   411
   412     12  CM-LIFE-DATA.
   413         16  CM-LF-BENEFIT-CD              PIC XX.
   414         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   415         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   416         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   417         16  CM-LF-DEV-CODE                PIC XXX.
   418         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   419         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page   9
* SOCK03.cbl
   420         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   421         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   422         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   423         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   424         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   425         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   426         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   427         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   428         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   429         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   430         16  FILLER                        PIC XX.
   431
   432     12  CM-AH-DATA.
   433         16  CM-AH-BENEFIT-CD              PIC XX.
   434         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   435         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   436         16  CM-AH-DEV-CODE                PIC XXX.
   437         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   438         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   439         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   440         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   441         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   442         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   443         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   444         16  CM-AH-PAID-THRU-DT            PIC XX.
   445             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   446         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   447         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   448         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   449         16  FILLER                        PIC X.
   450
   451     12  CM-LOAN-INFORMATION.
   452         16  CM-LIVES                      PIC S9(7)     COMP-3.
   453         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   454                                           PIC S9(5)V99  COMP-3.
   455         16  CM-BILLED                     PIC S9(7)     COMP-3.
   456         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   457         16  CM-PAY-FREQUENCY              PIC S99.
   458         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   459         16  CM-RATE-CLASS                 PIC XX.
   460         16  CM-BENEFICIARY                PIC X(25).
   461         16  CM-POLICY-FORM-NO             PIC X(12).
   462         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   463         16  CM-LAST-ADD-ON-DT             PIC XX.
   464         16  CM-DEDUCTIBLE-AMOUNTS.
   465             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   466             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   467         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   468             20  CM-RESIDENT-STATE         PIC XX.
   469             20  CM-RATE-CODE              PIC X(4).
   470             20  FILLER                    PIC XX.
   471         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   472             20  CM-LOAN-OFFICER           PIC X(5).
   473             20  FILLER                    PIC XXX.
   474         16  CM-CSR-CODE                   PIC XXX.
   475         16  CM-UNDERWRITING-CODE          PIC X.
   476             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   477         16  CM-POST-CARD-IND              PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  10
* SOCK03.cbl
   478         16  CM-NH-INTERFACE-SW            PIC X.
   479         16  CM-PREMIUM-TYPE               PIC X.
   480             88  CM-SING-PRM                  VALUE '1'.
   481             88  CM-O-B-COVERAGE              VALUE '2'.
   482             88  CM-OPEN-END                  VALUE '3'.
   483         16  CM-IND-GRP-TYPE               PIC X.
   484             88  CM-INDIVIDUAL                VALUE 'I'.
   485             88  CM-GROUP                     VALUE 'G'.
   486         16  CM-SKIP-CODE                  PIC X.
   487             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   488             88  SKIP-JULY                    VALUE '1'.
   489             88  SKIP-AUGUST                  VALUE '2'.
   490             88  SKIP-SEPTEMBER               VALUE '3'.
   491             88  SKIP-JULY-AUG                VALUE '4'.
   492             88  SKIP-AUG-SEPT                VALUE '5'.
   493             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   494             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   495             88  SKIP-JUNE                    VALUE '8'.
   496             88  SKIP-JUNE-JULY               VALUE '9'.
   497             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   498             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   499         16  CM-PAYMENT-MODE               PIC X.
   500             88  PAY-MONTHLY                  VALUE SPACE.
   501             88  PAY-WEEKLY                   VALUE '1'.
   502             88  PAY-SEMI-MONTHLY             VALUE '2'.
   503             88  PAY-BI-WEEKLY                VALUE '3'.
   504             88  PAY-SEMI-ANUALLY             VALUE '4'.
   505         16  CM-LOAN-NUMBER                PIC X(8).
   506         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   507         16  CM-OLD-LOF                    PIC XXX.
   508*        16  CM-LOAN-OFFICER               PIC XXX.
   509         16  CM-REIN-TABLE                 PIC XXX.
   510         16  CM-SPECIAL-REIN-CODE          PIC X.
   511         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   512         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   513         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   514
   515     12  CM-STATUS-DATA.
   516         16  CM-ENTRY-STATUS               PIC X.
   517         16  CM-ENTRY-DT                   PIC XX.
   518
   519         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   520         16  CM-LF-CANCEL-DT               PIC XX.
   521         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   522
   523         16  CM-LF-STATUS-AT-DEATH         PIC X.
   524         16  CM-LF-DEATH-DT                PIC XX.
   525         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   526
   527         16  CM-LF-CURRENT-STATUS          PIC X.
   528             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   529                                                'M' '4' '5' '9'.
   530             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   531             88  CM-LF-POLICY-PENDING         VALUE '2'.
   532             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   533             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   534             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   535             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  11
* SOCK03.cbl
   536             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   537             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   538             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   539             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   540             88  CM-LF-DECLINED               VALUE 'D'.
   541             88  CM-LF-VOIDED                 VALUE 'V'.
   542
   543         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   544         16  CM-AH-CANCEL-DT               PIC XX.
   545         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   546
   547         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   548         16  CM-AH-SETTLEMENT-DT           PIC XX.
   549         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   550
   551         16  CM-AH-CURRENT-STATUS          PIC X.
   552             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   553                                                'M' '4' '5' '9'.
   554             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   555             88  CM-AH-POLICY-PENDING         VALUE '2'.
   556             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   557             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   558             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   559             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   560             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   561             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   562             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   563             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   564             88  CM-AH-DECLINED               VALUE 'D'.
   565             88  CM-AH-VOIDED                 VALUE 'V'.
   566
   567         16  CM-CLAIM-INTERFACE-SW         PIC X.
   568             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   569             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   570             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   571         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   572
   573         16  CM-ENTRY-BATCH                PIC X(6).
   574         16  CM-LF-EXIT-BATCH              PIC X(6).
   575         16  CM-AH-EXIT-BATCH              PIC X(6).
   576         16  CM-LAST-MONTH-END             PIC XX.
   577
   578     12  CM-NOTE-SW                        PIC X.
   579         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   580         88  CERT-NOTES-PRESENT               VALUE '1'.
   581         88  BILLING-NOTES-PRESENT            VALUE '2'.
   582         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   583         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   584         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   585         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   586         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   587     12  CM-COMP-EXCP-SW                   PIC X.
   588         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   589         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   590     12  CM-INSURED-ADDRESS-SW             PIC X.
   591         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   592         88  INSURED-ADDR-PRESENT             VALUE '1'.
   593
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  12
* SOCK03.cbl
   594*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   595     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   596     12  FILLER                            PIC X.
   597
   598*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   599     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   600     12  FILLER                            PIC X.
   601*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   602     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   603
   604     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   605         88  CERT-ADDED-BATCH                 VALUE ' '.
   606         88  CERT-ADDED-ONLINE                VALUE '1'.
   607         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   608         88  CERT-PURGED-OFFLINE              VALUE '3'.
   609         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   610     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   611         88  CERT-AS-LOADED                   VALUE ' '.
   612         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   613         88  CERT-CLAIM-ONLINE                VALUE '2'.
   614         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   615         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   616         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   617         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   618         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   619
   620     12  CM-ACCOUNT-COMM-PCTS.
   621         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   622         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   623
   624     12  CM-USER-FIELD                     PIC X.
   625     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   626     12  CM-CLP-STATE                      PIC XX.
   627     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   628     12  CM-USER-RESERVED                  PIC XXX.
   629     12  FILLER REDEFINES CM-USER-RESERVED.
   630         16  CM-AH-CLASS-CD                PIC XX.
   631         16  F                             PIC X.
   632******************************************************************
   633*                                 COPY ELCMSTR.
   634******************************************************************
   635*                                                                *
   636*                            ELCMSTR.                            *
   637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   638*                            VMOD=2.012                          *
   639*                                                                *
   640*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   641*                                                                *
   642*   FILE TYPE = VSAM,KSDS                                        *
   643*   RECORD SIZE = 350  RECFORM = FIXED                           *
   644*                                                                *
   645*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   646*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   647*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   648*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   649*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   650*                                                 RKP=75,LEN=21  *
   651*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  13
* SOCK03.cbl
   652*   **** NOTE ****                                               *
   653*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   654*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   655*                                                                *
   656*   LOG = YES                                                    *
   657*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   658******************************************************************
   659*                   C H A N G E   L O G
   660*
   661* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   662*-----------------------------------------------------------------
   663*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   664* EFFECTIVE    NUMBER
   665*-----------------------------------------------------------------
   666* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   667* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   668* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   669******************************************************************
   670 01  CLAIM-MASTER.
   671     12  CL-RECORD-ID                PIC XX.
   672         88  VALID-CL-ID         VALUE 'CL'.
   673
   674     12  CL-CONTROL-PRIMARY.
   675         16  CL-COMPANY-CD           PIC X.
   676         16  CL-CARRIER              PIC X.
   677         16  CL-CLAIM-NO             PIC X(7).
   678         16  CL-CERT-NO.
   679             20  CL-CERT-PRIME       PIC X(10).
   680             20  CL-CERT-SFX         PIC X.
   681
   682     12  CL-CONTROL-BY-NAME.
   683         16  CL-COMPANY-CD-A1        PIC X.
   684         16  CL-INSURED-LAST-NAME    PIC X(15).
   685         16  CL-INSURED-NAME.
   686             20  CL-INSURED-1ST-NAME PIC X(12).
   687             20  CL-INSURED-MID-INIT PIC X.
   688
   689     12  CL-CONTROL-BY-SSN.
   690         16  CL-COMPANY-CD-A2        PIC X.
   691         16  CL-SOC-SEC-NO.
   692             20  CL-SSN-STATE        PIC XX.
   693             20  CL-SSN-ACCOUNT      PIC X(6).
   694             20  CL-SSN-LN3          PIC X(3).
   695
   696     12  CL-CONTROL-BY-CERT-NO.
   697         16  CL-COMPANY-CD-A4        PIC X.
   698         16  CL-CERT-NO-A4.
   699             20  CL-CERT-A4-PRIME    PIC X(10).
   700             20  CL-CERT-A4-SFX      PIC X.
   701
   702     12  CL-CONTROL-BY-CCN.
   703         16  CL-COMPANY-CD-A5        PIC X.
   704         16  CL-CCN-A5.
   705             20  CL-CCN.
   706                 24  CL-CCN-PREFIX-A5 PIC X(4).
   707                 24  CL-CCN-PRIME-A5 PIC X(12).
   708             20  CL-CCN-FILLER-A5    PIC X(4).
   709
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  14
* SOCK03.cbl
   710     12  CL-INSURED-PROFILE-DATA.
   711         16  CL-INSURED-BIRTH-DT     PIC XX.
   712         16  CL-INSURED-SEX-CD       PIC X.
   713             88  INSURED-IS-MALE        VALUE 'M'.
   714             88  INSURED-IS-FEMALE      VALUE 'F'.
   715             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   716         16  CL-INSURED-OCC-CD       PIC X(6).
   717         16  FILLER                  PIC X(5).
   718
   719     12  CL-PROCESSING-INFO.
   720         16  CL-PROCESSOR-ID         PIC X(4).
   721         16  CL-CLAIM-STATUS         PIC X.
   722             88  CLAIM-IS-OPEN          VALUE 'O'.
   723             88  CLAIM-IS-CLOSED        VALUE 'C'.
   724         16  CL-CLAIM-TYPE           PIC X.
   725*            88  AH-CLAIM               VALUE 'A'.
   726*            88  LIFE-CLAIM             VALUE 'L'.
   727*            88  PROPERTY-CLAIM         VALUE 'P'.
   728*            88  IUI-CLAIM              VALUE 'I'.
   729*            88  GAP-CLAIM              VALUE 'G'.
   730         16  CL-CLAIM-PREM-TYPE      PIC X.
   731             88  SINGLE-PREMIUM         VALUE '1'.
   732             88  O-B-COVERAGE           VALUE '2'.
   733             88  OPEN-END-COVERAGE      VALUE '3'.
   734         16  CL-INCURRED-DT          PIC XX.
   735         16  CL-REPORTED-DT          PIC XX.
   736         16  CL-FILE-ESTABLISH-DT    PIC XX.
   737         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   738         16  CL-LAST-PMT-DT          PIC XX.
   739         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   740         16  CL-PAID-THRU-DT         PIC XX.
   741         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   742         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   743         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   744         16  CL-PMT-CALC-METHOD      PIC X.
   745             88  CL-360-DAY-YR          VALUE '1'.
   746             88  CL-365-DAY-YR          VALUE '2'.
   747             88  CL-FULL-MONTHS         VALUE '3'.
   748         16  CL-CAUSE-CD             PIC X(6).
   749
   750         16  CL-PRIME-CERT-NO.
   751             20  CL-PRIME-CERT-PRIME PIC X(10).
   752             20  CL-PRIME-CERT-SFX   PIC X.
   753
   754         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   755             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   756             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   757
   758         16  CL-MICROFILM-NO         PIC X(10).
   759         16  CL-PROG-FORM-TYPE       PIC X.
   760         16  CL-LAST-ADD-ON-DT       PIC XX.
   761
   762         16  CL-LAST-REOPEN-DT       PIC XX.
   763         16  CL-LAST-CLOSE-DT        PIC XX.
   764         16  CL-LAST-CLOSE-REASON    PIC X(01).
   765             88  FINAL-PAID             VALUE '1'.
   766             88  CLAIM-DENIED           VALUE '2'.
   767             88  AUTO-CLOSE             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  15
* SOCK03.cbl
   768             88  MANUAL-CLOSE           VALUE '4'.
   769             88  BENEFITS-CHANGED       VALUE 'C'.
   770             88  SETUP-ERRORS           VALUE 'E'.
   771         16  CL-ASSOC-CERT-SEQU      PIC S99.
   772         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   773         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   774             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   775         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   776         16  FILLER                  PIC X.
   777
   778     12  CL-CERTIFICATE-DATA.
   779         16  CL-CERT-ORIGIN          PIC X.
   780             88  CERT-WAS-ONLINE        VALUE '1'.
   781             88  CERT-WAS-CREATED       VALUE '2'.
   782             88  COVERAGE-WAS-ADDED     VALUE '3'.
   783         16  CL-CERT-KEY-DATA.
   784             20  CL-CERT-CARRIER     PIC X.
   785             20  CL-CERT-GROUPING    PIC X(6).
   786             20  CL-CERT-STATE       PIC XX.
   787             20  CL-CERT-ACCOUNT.
   788                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   789                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   790             20  CL-CERT-EFF-DT      PIC XX.
   791
   792     12  CL-STATUS-CONTROLS.
   793         16  CL-PRIORITY-CD          PIC X.
   794             88  CONFIDENTIAL-DATA      VALUE '8'.
   795             88  HIGHEST-PRIORITY       VALUE '9'.
   796         16  CL-SUPV-ATTN-CD         PIC X.
   797             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   798             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   799         16  CL-PURGED-DT            PIC XX.
   800         16  CL-RESTORED-DT          PIC XX.
   801         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   802         16  CL-NEXT-RESEND-DT       PIC XX.
   803         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   804         16  CL-CRITICAL-PERIOD      PIC 99.
   805*        16  FILLER                  PIC XX.
   806         16  CL-LAST-MAINT-DT        PIC XX.
   807         16  CL-LAST-MAINT-USER      PIC X(4).
   808         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   809         16  CL-LAST-MAINT-TYPE      PIC X.
   810             88  CLAIM-SET-UP           VALUE ' '.
   811             88  PAYMENT-MADE           VALUE '1'.
   812             88  LETTER-SENT            VALUE '2'.
   813             88  MASTER-WAS-ALTERED     VALUE '3'.
   814             88  MASTER-WAS-RESTORED    VALUE '4'.
   815             88  INCURRED-DATE-CHANGED  VALUE '5'.
   816             88  FILE-CONVERTED         VALUE '6'.
   817             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   818             88  ERROR-CORRECTION       VALUE 'E'.
   819         16  CL-RELATED-CLAIM-NO     PIC X(7).
   820         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   821         16  CL-BENEFICIARY          PIC X(10).
   822         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   823         16  CL-DENIAL-TYPE          PIC X.
   824             88  CL-TYPE-DENIAL          VALUE '1'.
   825             88  CL-TYPE-RESCISSION      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  16
* SOCK03.cbl
   826             88  CL-TYPE-REFORMATION     VALUE '3'.
   827             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   828             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   829         16  CL-CRIT-PER-RECURRENT   PIC X.
   830         16  CL-CRIT-PER-RTW-MOS     PIC 99.
   831         16  CL-RTW-DT               PIC XX.
   832
   833     12  CL-TRAILER-CONTROLS.
   834         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   835             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   836             88  CL-LAST-TRL-AVAIL      VALUE +100.
   837             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   838         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   839         16  FILLER                  PIC XX.
   840         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   841         16  CL-ADDRESS-TRAILER-CNT.
   842             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   843                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   844             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   845                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   846             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   847                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   848             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   849                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   850             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   851                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   852             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   853                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   854             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   855                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   856
   857     12  CL-CV-REFERENCE-NO.
   858         16  CL-CV-REFNO-PRIME       PIC X(18).
   859         16  CL-CV-REFNO-SFX         PIC XX.
   860
   861     12  CL-FILE-LOCATION            PIC X(4).
   862
   863     12  CL-PROCESS-ERRORS.
   864         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   865             88  NO-FATAL-ERRORS        VALUE ZERO.
   866         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   867             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   868
   869     12  CL-PRODUCT-CD               PIC X.
   870
   871     12  CL-CURRENT-KEY-DATA.
   872         16  CL-CURRENT-CARRIER      PIC X.
   873         16  CL-CURRENT-GROUPING     PIC X(6).
   874         16  CL-CURRENT-STATE        PIC XX.
   875         16  CL-CURRENT-ACCOUNT      PIC X(10).
   876
   877     12  CL-ASSOCIATES               PIC X.
   878         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   879         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   880         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   881         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   882
   883     12  CL-ACTIVITY-CODE            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  17
* SOCK03.cbl
   884     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   885     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   886
   887     12  CL-LAPSE-REPORT-CODE        PIC 9.
   888     12  CL-LAG-REPORT-CODE          PIC 9.
   889     12  CL-LOAN-TYPE                PIC XX.
   890     12  CL-LEGAL-STATE              PIC XX.
   891
   892     12  CL-YESNOSW                  PIC X.
   893     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   894         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   895         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   896         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   897     12  cl-insured-claim            pic x.
   898         88  cl-claim-on-primary         value 'P'.
   899         88  cl-claim-on-secondary       value 'S'.
   900     12  cl-benefit-expiration-dt    PIC XX.
   901*                                 COPY ERCPDEF.
   902******************************************************************
   903*                                                                *
   904*                                                                *
   905*                            ERCPDEF.                            *
   906*                                                                *
   907*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   908*                                                                *
   909*    FILE TYPE = VSAM,KSDS                                       *
   910*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   911*                                                                *
   912*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   913*                                                                *
   914*    LOG = YES                                                   *
   915*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   916******************************************************************
   917 01  PRODUCT-MASTER.
   918    12  PD-RECORD-ID                 PIC X(02).
   919        88  VALID-PD-ID                  VALUE 'PD'.
   920    12  PD-CONTROL-PRIMARY.
   921        16  PD-COMPANY-CD            PIC X.
   922        16  PD-STATE                 PIC XX.
   923        16  PD-PRODUCT-CD            PIC XXX.
   924        16  PD-FILLER                PIC X(7).
   925        16  PD-BEN-TYPE              PIC X.
   926        16  PD-BEN-CODE              PIC XX.
   927        16  PD-PROD-EXP-DT           PIC XX.
   928    12  FILLER                       PIC X(50).
   929    12  PD-PRODUCT-DATA OCCURS 8.
   930        16  PD-PROD-CODE             PIC X.
   931            88  PD-PROD-LIFE           VALUE 'L'.
   932            88  PD-PROD-PROP           VALUE 'P'.
   933            88  PD-PROD-AH             VALUE 'A'.
   934            88  PD-PROD-IU             VALUE 'I'.
   935            88  PD-PROD-GAP            VALUE 'G'.
   936        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   937        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   938        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   939        16  PD-MAX-TERM              PIC S999        COMP-3.
   940        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   941        16  FILLER                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  18
* SOCK03.cbl
   942        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   943        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   944        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   945        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   946        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   947        16  PD-REC-CRIT-PERIOD       PIC X.
   948        16  PD-RTW-MOS               PIC 99.
   949        16  FILLER                   PIC X(5).
   950    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   951    12  PD-TERM-LIMITS OCCURS 15.
   952        16  PD-LOW-TERM              PIC S999        COMP-3.
   953        16  PD-HI-TERM               PIC S999        COMP-3.
   954*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   955    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   956        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   957        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   958    12  PD-EARN-FACTORS.
   959        16  FILLER OCCURS 15.
   960            20  FILLER OCCURS 15.
   961                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   962    12  PD-PRODUCT-DESC              PIC X(80).
   963    12  PD-TRUNCATED                 PIC X.
   964    12  FILLER                       PIC X(59).
   965    12  PD-MAINT-INFORMATION.
   966        16  PD-LAST-MAINT-DT         PIC X(02).
   967        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   968        16  PD-LAST-MAINT-BY         PIC X(04).
   969*                                 COPY ERCCTBL.
   970******************************************************************
   971*                                                                *
   972*                                                                *
   973*                            ERCCTBL                             *
   974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   975*                            VMOD=2.003
   976*                                                                *
   977*   ONLINE CREDIT SYSTEM                                         *
   978*                                                                *
   979*   FILE DESCRIPTION = COMPENSATION TABLE                        *
   980*                                                                *
   981*   FILE TYPE = VSAM,KSDS                                        *
   982*   RECORD SIZE = 200   RECFORM = FIXED                          *
   983*                                                                *
   984*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
   985*       ALTERNATE PATH = NONE                                    *
   986*                                                                *
   987*   LOG = NO                                                     *
   988*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   989*                                                                *
   990*                                                                *
   991******************************************************************
   992
   993 01  COMM-TABLE-RECORD.
   994     12  CT-RECORD-ID                      PIC XX.
   995         88  VALID-CT-ID                      VALUE 'CT'.
   996
   997     12  CT-CONTROL-PRIMARY.
   998         16  CT-COMPANY-CD                 PIC X.
   999         16  CT-TABLE                      PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  19
* SOCK03.cbl
  1000         16  CT-CNTRL-2.
  1001             20  CT-BEN-TYPE               PIC X.
  1002             20  CT-BEN-CODE               PIC XX.
  1003
  1004     12  CT-MAINT-INFORMATION.
  1005         16  CT-LAST-MAINT-DT              PIC XX.
  1006         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1007         16  CT-LAST-MAINT-USER            PIC X(4).
  1008         16  FILLER                        PIC X(31).
  1009
  1010     12  CT-LIMITS.
  1011         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1012
  1013         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1014
  1015         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1016
  1017     12  CT-RATES.
  1018         16  CT-RTX          OCCURS 27 TIMES.
  1019             20  CT-RT                     PIC SV9(5)     COMP-3.
  1020             20  CT-RT-R   REDEFINES
  1021                 CT-RT                     PIC XXX.
  1022
  1023     12  FILLER                            PIC  X(42).
  1024
  1025******************************************************************
  1026*                                 COPY ELCCNTL.
  1027******************************************************************
  1028*                                                                *
  1029*                                                                *
  1030*                            ELCCNTL.                            *
  1031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1032*                            VMOD=2.059                          *
  1033*                                                                *
  1034*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1035*                                                                *
  1036*   FILE TYPE = VSAM,KSDS                                        *
  1037*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1038*                                                                *
  1039*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1040*       ALTERNATE INDEX = NONE                                   *
  1041*                                                                *
  1042*   LOG = YES                                                    *
  1043*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1044******************************************************************
  1045*                   C H A N G E   L O G
  1046*
  1047* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1048*-----------------------------------------------------------------
  1049*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1050* EFFECTIVE    NUMBER
  1051*-----------------------------------------------------------------
  1052* 082503                   PEMA  ADD BENEFIT GROUP
  1053* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1054* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1055* 092705    2005050300006  PEMA  ADD SPP LEASES
  1056* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1057* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  20
* SOCK03.cbl
  1058* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1059* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1060* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1061* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1062* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1063* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1064* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1065******************************************************************
  1066*
  1067 01  CONTROL-FILE.
  1068     12  CF-RECORD-ID                       PIC XX.
  1069         88  VALID-CF-ID                        VALUE 'CF'.
  1070
  1071     12  CF-CONTROL-PRIMARY.
  1072         16  CF-COMPANY-ID                  PIC XXX.
  1073         16  CF-RECORD-TYPE                 PIC X.
  1074             88  CF-COMPANY-MASTER              VALUE '1'.
  1075             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1076             88  CF-STATE-MASTER                VALUE '3'.
  1077             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1078             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1079             88  CF-CARRIER-MASTER              VALUE '6'.
  1080             88  CF-MORTALITY-MASTER            VALUE '7'.
  1081             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1082             88  CF-TERMINAL-MASTER             VALUE '9'.
  1083             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1084             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1085             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1086             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1087             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1088             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1089             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1090             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1091             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1092         16  CF-ACCESS-CD-GENL              PIC X(4).
  1093         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1094             20  CF-PROCESSOR               PIC X(4).
  1095         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1096             20  CF-STATE-CODE              PIC XX.
  1097             20  FILLER                     PIC XX.
  1098         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1099             20  FILLER                     PIC XX.
  1100             20  CF-HI-BEN-IN-REC           PIC XX.
  1101         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1102             20  FILLER                     PIC XXX.
  1103             20  CF-CARRIER-CNTL            PIC X.
  1104         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1105             20  FILLER                     PIC XX.
  1106             20  CF-HI-TYPE-IN-REC          PIC 99.
  1107         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1108             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1109                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1110             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1111             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1112         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1113             20  FILLER                     PIC X.
  1114             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1115         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  21
* SOCK03.cbl
  1116             20  FILLER                     PIC XX.
  1117             20  CF-MORTGAGE-PLAN           PIC XX.
  1118         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1119
  1120     12  CF-LAST-MAINT-DT                   PIC XX.
  1121     12  CF-LAST-MAINT-BY                   PIC X(4).
  1122     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1123
  1124     12  CF-RECORD-BODY                     PIC X(728).
  1125
  1126
  1127****************************************************************
  1128*             COMPANY MASTER RECORD                            *
  1129****************************************************************
  1130
  1131     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1132         16  CF-COMPANY-ADDRESS.
  1133             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1134             20  CF-CL-IN-CARE-OF           PIC X(30).
  1135             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1136             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1137             20  CF-CL-CITY-STATE           PIC X(30).
  1138             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1139             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1140         16  CF-COMPANY-CD                  PIC X.
  1141         16  CF-COMPANY-PASSWORD            PIC X(8).
  1142         16  CF-SECURITY-OPTION             PIC X.
  1143             88  ALL-SECURITY                   VALUE '1'.
  1144             88  COMPANY-VERIFY                 VALUE '2'.
  1145             88  PROCESSOR-VERIFY               VALUE '3'.
  1146             88  NO-SECURITY                    VALUE '4'.
  1147             88  ALL-BUT-TERM                   VALUE '5'.
  1148         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1149             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1150         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1151             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1152         16  CF-INFORCE-LOCATION            PIC X.
  1153             88  CERTS-ARE-ONLINE               VALUE '1'.
  1154             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1155             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1156         16  CF-LOWER-CASE-LETTERS          PIC X.
  1157         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1158             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1159             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1160             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1161             88  CF-ACCNT-CNTL                  VALUE '3'.
  1162             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1163
  1164         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1165         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1166
  1167         16  CF-LGX-CREDIT-USER             PIC X.
  1168             88  CO-IS-NOT-USER                 VALUE 'N'.
  1169             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1170
  1171         16 CF-CREDIT-CALC-CODES.
  1172             20  CF-CR-REM-TERM-CALC PIC X.
  1173               88  CR-EARN-AFTER-15TH           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  22
* SOCK03.cbl
  1174               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1175               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1176               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1177               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1178               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1179               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1180             20  CF-CR-R78-METHOD           PIC X.
  1181               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1182               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1183
  1184         16  CF-CLAIM-CONTROL-COUNTS.
  1185             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1186                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1187
  1188             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1189                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1190
  1191             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1192                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1193
  1194             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1195                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1196
  1197         16  CF-CURRENT-MONTH-END           PIC XX.
  1198
  1199         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1200             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1201             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1202             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1203             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1204                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1205                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1206             20  CF-CO-PREM-REJECT-SW       PIC X.
  1207                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1208                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1209             20  CF-CO-REF-REJECT-SW        PIC X.
  1210                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1211                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1212
  1213         16  CF-CO-REPORTING-DT             PIC XX.
  1214         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1215         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1216           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1217           88  CF-CO-MONTH-END                  VALUE '1'.
  1218
  1219         16  CF-LGX-CLAIM-USER              PIC X.
  1220             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1221             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1222
  1223         16  CF-CREDIT-EDIT-CONTROLS.
  1224             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1225             20  CF-MIN-AGE                 PIC 99.
  1226             20  CF-DEFAULT-AGE             PIC 99.
  1227             20  CF-MIN-TERM                PIC S999      COMP-3.
  1228             20  CF-MAX-TERM                PIC S999      COMP-3.
  1229             20  CF-DEFAULT-SEX             PIC X.
  1230             20  CF-JOINT-AGE-INPUT         PIC X.
  1231                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  23
* SOCK03.cbl
  1232             20  CF-BIRTH-DATE-INPUT        PIC X.
  1233                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1234             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1235                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1236                 88  CF-ZERO-CARRIER            VALUE '1'.
  1237                 88  CF-ZERO-GROUPING           VALUE '2'.
  1238                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1239             20  CF-EDIT-SW                 PIC X.
  1240                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1241             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1242             20  CF-CR-PR-METHOD            PIC X.
  1243               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1244               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1245             20  FILLER                     PIC X.
  1246
  1247         16  CF-CREDIT-MISC-CONTROLS.
  1248             20  CF-REIN-TABLE-SW           PIC X.
  1249                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1250             20  CF-COMP-TABLE-SW           PIC X.
  1251                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1252             20  CF-EXPERIENCE-RETENTION-AGE
  1253                                            PIC S9        COMP-3.
  1254             20  CF-CONVERSION-DT           PIC XX.
  1255             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1256             20  CF-RUN-FREQUENCY-SW        PIC X.
  1257                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1258                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1259
  1260             20  CF-CR-CHECK-NO-CONTROL.
  1261                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1262                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1263                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1264                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1265                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1266                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1267
  1268                 24  CF-CR-CHECK-COUNT       REDEFINES
  1269                     CF-CR-CHECK-COUNTER      PIC X(4).
  1270
  1271                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1272                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1273
  1274                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1275                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1276                 24  CF-MAIL-PROCESSING       PIC X.
  1277                     88  MAIL-PROCESSING          VALUE 'Y'.
  1278
  1279         16  CF-MISC-SYSTEM-CONTROL.
  1280             20  CF-SYSTEM-C                 PIC X.
  1281                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1282             20  CF-SYSTEM-D                 PIC X.
  1283                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1284             20  CF-SOC-SEC-NO-SW            PIC X.
  1285                 88  SOC-SEC-NO-USED             VALUE '1'.
  1286             20  CF-MEMBER-NO-SW             PIC X.
  1287                 88  MEMBER-NO-USED              VALUE '1'.
  1288             20  CF-TAX-ID-NUMBER            PIC X(11).
  1289             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  24
* SOCK03.cbl
  1290             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1291                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1292                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1293                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1294                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1295             20  CF-SYSTEM-E                 PIC X.
  1296                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1297
  1298         16  CF-LGX-LIFE-USER               PIC X.
  1299             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1300             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1301
  1302         16  CF-CR-MONTH-END-DT             PIC XX.
  1303
  1304         16  CF-FILE-MAINT-DATES.
  1305             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1306                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1307             20  CF-LAST-BATCH       REDEFINES
  1308                 CF-LAST-BATCH-NO               PIC X(4).
  1309             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1310             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1311             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1312             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1313             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1314             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1315             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1316             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1317             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1318             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1319
  1320         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1321         16  FILLER                         PIC X.
  1322
  1323         16  CF-ALT-MORT-CODE               PIC X(4).
  1324         16  CF-MEMBER-CAPTION              PIC X(10).
  1325
  1326         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1327             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1328             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1329             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1330             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1331             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1332
  1333         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1334
  1335         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1336         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1337         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1338         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1339
  1340         16  CF-AH-OVERRIDE-L1              PIC X.
  1341         16  CF-AH-OVERRIDE-L2              PIC XX.
  1342         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1343         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1344
  1345         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1346         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1347
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  25
* SOCK03.cbl
  1348         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1349         16  CF-AR-LAST-EL860-DT            PIC XX.
  1350         16  CF-MP-MONTH-END-DT             PIC XX.
  1351
  1352         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1353         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1354             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1355
  1356         16  CF-AR-MONTH-END-DT             PIC XX.
  1357
  1358         16  CF-CRDTCRD-USER                PIC X.
  1359             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1360             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1361
  1362         16  CF-CC-MONTH-END-DT             PIC XX.
  1363
  1364         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1365
  1366         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1367             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1368             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1369             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1370         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1371         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1372         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1373         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1374             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1375             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1376         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1377         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1378         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1379             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1380         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1381
  1382         16  CF-CL-ZIP-CODE.
  1383             20  CF-CL-ZIP-PRIME.
  1384                 24  CF-CL-ZIP-1ST          PIC X.
  1385                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1386                 24  FILLER                 PIC X(4).
  1387             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1388         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1389             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1390             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1391             20  FILLER                     PIC XXX.
  1392
  1393         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1394         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1395         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1396         16  CF-CO-OPTION-START-DATE        PIC XX.
  1397         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1398           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1399                                                      '3' '4'.
  1400           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1401           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1402           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1403           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1404           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1405           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  26
* SOCK03.cbl
  1406
  1407         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1408
  1409         16  CF-PAYMENT-APPROVAL-LEVELS.
  1410             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1411             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1412             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1413             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1414             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1415             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1416
  1417         16  CF-END-USER-REPORTING-USER     PIC X.
  1418             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1419             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1420
  1421         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1422             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1423             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1424
  1425         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1426
  1427         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1428         16  FILLER                         PIC X.
  1429
  1430         16  CF-CREDIT-ARCHIVE-CNTL.
  1431             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1432             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1433             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1434
  1435         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1436
  1437         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1438             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1439             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1440
  1441         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1442             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1443             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1444
  1445         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1446
  1447         16  CF-CO-ACH-ID-CODE              PIC  X.
  1448             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1449             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1450             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1451         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1452         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1453         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1454         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1455         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1456         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1457         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1458         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1459         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1460                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1461         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1462                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1463
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  27
* SOCK03.cbl
  1464         16  CF-CO-OVER-SHORT.
  1465             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1466             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1467
  1468*         16  FILLER                         PIC X(102).
  1469         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1470             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1471             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1472
  1473         16  CF-AH-APPROVAL-DAYS.
  1474             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1475             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1476             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1477             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1478
  1479         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1480
  1481         16  CF-APPROV-LEV-5.
  1482             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1483             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1484             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1485
  1486         16  FILLER                         PIC X(68).
  1487****************************************************************
  1488*             PROCESSOR/USER RECORD                            *
  1489****************************************************************
  1490
  1491     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1492         16  CF-PROCESSOR-NAME              PIC X(30).
  1493         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1494         16  CF-PROCESSOR-TITLE             PIC X(26).
  1495         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1496                 88  MESSAGE-YES                VALUE 'Y'.
  1497                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1498
  1499*****************************************************
  1500****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1501****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1502****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1503****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1504*****************************************************
  1505
  1506         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1507             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1508             20  CF-APPLICATION-FORCE       PIC X.
  1509             20  CF-INDIVIDUAL-APP.
  1510                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1511                     28  CF-BROWSE-APP      PIC X.
  1512                     28  CF-UPDATE-APP      PIC X.
  1513
  1514         16  CF-CURRENT-TERM-ON             PIC X(4).
  1515         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1516             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1517             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1518             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1519             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1520             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1521             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  28
* SOCK03.cbl
  1522             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1523         16  CF-PROCESSOR-CARRIER           PIC X.
  1524             88  NO-CARRIER-SECURITY            VALUE ' '.
  1525         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1526             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1527         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1528             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1529         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1530             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1531
  1532         16  CF-PROC-SYS-ACCESS-SW.
  1533             20  CF-PROC-CREDIT-CLAIMS-SW.
  1534                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1535                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1536                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1537                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1538             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1539                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1540                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1541             20  CF-PROC-LIFE-GNRLDGR-SW.
  1542                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1543                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1544                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1545                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1546             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1547                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1548                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1549         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1550             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1551             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1552         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1553
  1554         16  CF-APPROVAL-LEVEL                  PIC X.
  1555             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1556             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1557             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1558             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1559             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1560
  1561         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1562
  1563         16  CF-LANGUAGE-TYPE                   PIC X.
  1564             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1565             88  CF-LANG-IS-FR                      VALUE 'F'.
  1566
  1567         16  CF-CSR-IND                         PIC X.
  1568         16  FILLER                             PIC X(239).
  1569
  1570****************************************************************
  1571*             PROCESSOR/REMINDERS RECORD                       *
  1572****************************************************************
  1573
  1574     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1575         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1576             20  CF-START-REMIND-DT         PIC XX.
  1577             20  CF-END-REMIND-DT           PIC XX.
  1578             20  CF-REMINDER-TEXT           PIC X(50).
  1579         16  FILLER                         PIC X(296).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  29
* SOCK03.cbl
  1580
  1581
  1582****************************************************************
  1583*             STATE MASTER RECORD                              *
  1584****************************************************************
  1585
  1586     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1587         16  CF-STATE-ABBREVIATION          PIC XX.
  1588         16  CF-STATE-NAME                  PIC X(25).
  1589         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1590         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1591             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1592             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1593             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1594             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1595                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1596                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1597             20  CF-ST-PREM-REJECT-SW       PIC X.
  1598                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1599                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1600             20  CF-ST-REF-REJECT-SW        PIC X.
  1601                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1602                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1603         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1604         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1605         16  CF-ST-REFUND-RULES.
  1606             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1607             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1608             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1609         16  CF-ST-FST-PMT-EXTENSION.
  1610             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1611             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1612                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1613                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1614                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1615                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1616         16  CF-ST-STATE-CALL.
  1617             20  CF-ST-CALL-UNEARNED        PIC X.
  1618             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1619             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1620         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1621             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1622             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1623         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1624         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1625         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1626         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1627         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1628         16  FILLER                         PIC X.
  1629         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1630             20  CF-ST-BENEFIT-CD           PIC XX.
  1631             20  CF-ST-BENEFIT-KIND         PIC X.
  1632                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1633                 88  CF-ST-AH-KIND              VALUE 'A'.
  1634             20  CF-ST-REM-TERM-CALC        PIC X.
  1635                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1636                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1637                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  30
* SOCK03.cbl
  1638                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1639                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1640                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1641                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1642                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1643
  1644             20  CF-ST-REFUND-CALC          PIC X.
  1645                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1646                 88  ST-REFD-BY-R78             VALUE '1'.
  1647                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1648                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1649                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1650                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1651                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1652                 88  ST-REFD-UTAH               VALUE '7'.
  1653                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1654                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1655                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1656
  1657             20  CF-ST-EARNING-CALC         PIC X.
  1658                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1659                 88  ST-EARN-BY-R78             VALUE '1'.
  1660                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1661                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1662                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1663                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1664                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1665                 88  ST-EARN-MEAN               VALUE '8'.
  1666                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1667
  1668             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1669                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1670                 88  ST-OVRD-BY-R78             VALUE '1'.
  1671                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1672                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1673                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1674                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1675                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1676                 88  ST-OVRD-MEAN               VALUE '8'.
  1677                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1678             20  FILLER                     PIC X.
  1679
  1680         16  CF-ST-COMMISSION-CAPS.
  1681             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1682             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1683             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1684             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1685         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1686                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1687
  1688         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1689
  1690         16  CF-ST-STATUTORY-INTEREST.
  1691             20  CF-ST-STAT-DATE-FROM       PIC X.
  1692                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1693                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1694             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1695             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  31
* SOCK03.cbl
  1696             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1697             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1698             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1699
  1700         16  CF-ST-OVER-SHORT.
  1701             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1702             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1703
  1704         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1705
  1706         16  CF-ST-RT-CALC                  PIC X.
  1707
  1708         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1709         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1710         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1711         16  CF-ST-RF-LR-CALC               PIC X.
  1712         16  CF-ST-RF-LL-CALC               PIC X.
  1713         16  CF-ST-RF-LN-CALC               PIC X.
  1714         16  CF-ST-RF-AH-CALC               PIC X.
  1715         16  CF-ST-RF-CP-CALC               PIC X.
  1716*        16  FILLER                         PIC X(206).
  1717*CIDMOD         16  FILLER                         PIC X(192).
  1718         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1719             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1720         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1721         16  CF-ST-VFY-2ND-BENE             PIC X.
  1722         16  CF-ST-CAUSAL-STATE             PIC X.
  1723         16  FILLER                         PIC X(185).
  1724
  1725****************************************************************
  1726*             BENEFIT MASTER RECORD                            *
  1727****************************************************************
  1728
  1729     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1730         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1731             20  CF-BENEFIT-CODE            PIC XX.
  1732             20  CF-BENEFIT-NUMERIC  REDEFINES
  1733                 CF-BENEFIT-CODE            PIC XX.
  1734             20  CF-BENEFIT-ALPHA           PIC XXX.
  1735             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1736             20  CF-BENEFIT-COMMENT         PIC X(10).
  1737
  1738             20  CF-LF-COVERAGE-TYPE        PIC X.
  1739                 88  CF-REDUCING                VALUE 'R'.
  1740                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1741
  1742             20  CF-SPECIAL-CALC-CD         PIC X.
  1743                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1744                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1745                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1746                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1747                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1748                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1749                 88  CF-FARM-PLAN               VALUE 'F'.
  1750                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1751                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1752                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1753                 88  CF-4-MTH-INTEREST          VALUE 'K'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  32
* SOCK03.cbl
  1754                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1755                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1756                 88  CF-PRUDENTIAL              VALUE 'P'.
  1757                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1758                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1759                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1760                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1761                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1762                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1763
  1764             20  CF-JOINT-INDICATOR         PIC X.
  1765                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1766
  1767*            20  FILLER                     PIC X(12).
  1768             20  FILLER                     PIC X(11).
  1769             20  CF-BENEFIT-CATEGORY        PIC X.
  1770             20  CF-LOAN-TYPE               PIC X(8).
  1771
  1772             20  CF-CO-REM-TERM-CALC        PIC X.
  1773                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1774                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1775                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1776                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1777                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1778
  1779             20  CF-CO-EARNINGS-CALC        PIC X.
  1780                 88  CO-EARN-BY-R78             VALUE '1'.
  1781                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1782                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1783                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1784                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1785                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1786                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1787                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1788
  1789             20  CF-CO-REFUND-CALC          PIC X.
  1790                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1791                 88  CO-REFD-BY-R78             VALUE '1'.
  1792                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1793                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1794                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1795                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1796                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1797                 88  CO-REFD-MEAN               VALUE '8'.
  1798                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1799                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1800                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1801
  1802             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1803                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1804                 88  CO-OVRD-BY-R78             VALUE '1'.
  1805                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1806                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1807                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1808                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1809                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1810                 88  CO-OVRD-MEAN               VALUE '8'.
  1811                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  33
* SOCK03.cbl
  1812
  1813             20  CF-CO-BEN-I-G-CD           PIC X.
  1814                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1815                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1816                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1817
  1818         16  FILLER                         PIC X(304).
  1819
  1820
  1821****************************************************************
  1822*             CARRIER MASTER RECORD                            *
  1823****************************************************************
  1824
  1825     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1826         16  CF-ADDRESS-DATA.
  1827             20  CF-MAIL-TO-NAME            PIC X(30).
  1828             20  CF-IN-CARE-OF              PIC X(30).
  1829             20  CF-ADDRESS-LINE-1          PIC X(30).
  1830             20  CF-ADDRESS-LINE-2          PIC X(30).
  1831             20  CF-CITY-STATE              PIC X(30).
  1832             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1833             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1834
  1835         16  CF-CLAIM-NO-CONTROL.
  1836             20  CF-CLAIM-NO-METHOD         PIC X.
  1837                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1838                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1839                 88  CLAIM-NO-SEQ               VALUE '3'.
  1840                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1841             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1842                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1843                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1844                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1845
  1846         16  CF-CHECK-NO-CONTROL.
  1847             20  CF-CHECK-NO-METHOD         PIC X.
  1848                 88  CHECK-NO-MANUAL            VALUE '1'.
  1849                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1850                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1851                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1852             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1853                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1854
  1855         16  CF-DOMICILE-STATE              PIC XX.
  1856
  1857         16  CF-EXPENSE-CONTROLS.
  1858             20  CF-EXPENSE-METHOD          PIC X.
  1859                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1860                 88  DOLLARS-PER-PMT            VALUE '2'.
  1861                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1862                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1863             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1864             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1865
  1866         16  CF-CORRESPONDENCE-CONTROL.
  1867             20  CF-LETTER-RESEND-OPT       PIC X.
  1868                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1869                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  34
* SOCK03.cbl
  1870             20  FILLER                     PIC X(4).
  1871
  1872         16  CF-RESERVE-CONTROLS.
  1873             20  CF-MANUAL-SW               PIC X.
  1874                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1875             20  CF-FUTURE-SW               PIC X.
  1876                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1877             20  CF-PTC-SW                  PIC X.
  1878                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1879             20  CF-IBNR-SW                 PIC X.
  1880                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1881             20  CF-PTC-LF-SW               PIC X.
  1882                 88  CF-LF-PTC-USED             VALUE '1'.
  1883             20  CF-CDT-ACCESS-METHOD       PIC X.
  1884                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1885                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1886                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1887             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1888
  1889         16  CF-CLAIM-CALC-METHOD           PIC X.
  1890             88  360-PLUS-MONTHS                VALUE '1'.
  1891             88  365-PLUS-MONTHS                VALUE '2'.
  1892             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1893             88  360-DAILY                      VALUE '4'.
  1894             88  365-DAILY                      VALUE '5'.
  1895
  1896         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1897         16  FILLER                         PIC X(11).
  1898
  1899         16  CF-LIMIT-AMOUNTS.
  1900             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1901             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1902             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1903             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1904             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1905             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1906             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1907             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1908             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1909             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1910
  1911         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1912         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1913         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1914
  1915         16  CF-ZIP-CODE.
  1916             20  CF-ZIP-PRIME.
  1917                 24  CF-ZIP-1ST             PIC X.
  1918                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1919                 24  FILLER                 PIC X(4).
  1920             20  CF-ZIP-PLUS4               PIC X(4).
  1921         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1922             20  CF-CAN-POSTAL-1            PIC XXX.
  1923             20  CF-CAN-POSTAL-2            PIC XXX.
  1924             20  FILLER                     PIC XXX.
  1925
  1926         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1927         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  35
* SOCK03.cbl
  1928         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1929
  1930         16  CF-RATING-SWITCH               PIC X.
  1931             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1932             88  CF-NO-RATING                   VALUE 'N'.
  1933
  1934         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1935
  1936         16  CF-CARRIER-OVER-SHORT.
  1937             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1938             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1939
  1940         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1941         16  CF-SECPAY-SWITCH               PIC X.
  1942             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1943             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1944         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1945         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1946         16  FILLER                         PIC X(444).
  1947*        16  FILLER                         PIC X(452).
  1948
  1949
  1950****************************************************************
  1951*             MORTALITY MASTER RECORD                          *
  1952****************************************************************
  1953
  1954     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1955         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1956                                INDEXED BY CF-MORT-NDX.
  1957             20  CF-MORT-TABLE              PIC X(5).
  1958             20  CF-MORT-TABLE-TYPE         PIC X.
  1959                 88  CF-MORT-JOINT              VALUE 'J'.
  1960                 88  CF-MORT-SINGLE             VALUE 'S'.
  1961                 88  CF-MORT-COMBINED           VALUE 'C'.
  1962                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1963                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1964             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1965             20  CF-MORT-AGE-METHOD         PIC XX.
  1966                 88  CF-AGE-LAST                VALUE 'AL'.
  1967                 88  CF-AGE-NEAR                VALUE 'AN'.
  1968             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1969             20  CF-MORT-ADJUSTMENT-DIRECTION
  1970                                            PIC X.
  1971                 88  CF-MINUS                   VALUE '-'.
  1972                 88  CF-PLUS                    VALUE '+'.
  1973             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1974             20  CF-MORT-JOINT-CODE         PIC X.
  1975                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1976             20  CF-MORT-PC-Q               PIC X.
  1977                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1978             20  CF-MORT-TABLE-CODE         PIC X(4).
  1979             20  CF-MORT-COMMENTS           PIC X(15).
  1980             20  FILLER                     PIC X(14).
  1981
  1982         16  FILLER                         PIC X(251).
  1983
  1984
  1985****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  36
* SOCK03.cbl
  1986*             BUSSINESS TYPE MASTER RECORD                     *
  1987****************************************************************
  1988
  1989     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1990* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1991* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1992* AND RECORD 05 IS TYPES 81-99
  1993         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1994             20  CF-BUSINESS-TITLE          PIC  X(19).
  1995             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1996                                            PIC S9V9(4) COMP-3.
  1997             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1998             20  FILLER                     PIC  X.
  1999         16  FILLER                         PIC  X(248).
  2000
  2001
  2002****************************************************************
  2003*             TERMINAL MASTER RECORD                           *
  2004****************************************************************
  2005
  2006     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2007
  2008         16  CF-COMPANY-TERMINALS.
  2009             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2010                                  PIC X(4).
  2011         16  FILLER               PIC X(248).
  2012
  2013
  2014****************************************************************
  2015*             LIFE EDIT MASTER RECORD                          *
  2016****************************************************************
  2017
  2018     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2019         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2020             20  CF-LIFE-CODE-IN            PIC XX.
  2021             20  CF-LIFE-CODE-OUT           PIC XX.
  2022         16  FILLER                         PIC X(248).
  2023
  2024
  2025****************************************************************
  2026*             AH EDIT MASTER RECORD                            *
  2027****************************************************************
  2028
  2029     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2030         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2031             20  CF-AH-CODE-IN              PIC XXX.
  2032             20  CF-AH-CODE-OUT             PIC XX.
  2033         16  FILLER                         PIC X(248).
  2034
  2035
  2036****************************************************************
  2037*             CREDIBILITY TABLES                               *
  2038****************************************************************
  2039
  2040     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2041         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2042                             INDEXED BY CF-CRDB-NDX.
  2043             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  37
* SOCK03.cbl
  2044             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2045             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2046         16  FILLER                         PIC  X(332).
  2047
  2048
  2049****************************************************************
  2050*             REPORT CUSTOMIZATION RECORD                      *
  2051****************************************************************
  2052
  2053     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2054         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2055             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2056             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2057             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2058**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2059****       A T-TRANSFER.                                   ****
  2060             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2061
  2062         16  FILLER                         PIC XX.
  2063
  2064         16  CF-CARRIER-CNTL-OPT.
  2065             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2066                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2067                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2068             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2069                                            PIC X.
  2070         16  CF-GROUP-CNTL-OPT.
  2071             20  CF-GROUP-OPT-SEQ           PIC 9.
  2072                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2073                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2074             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2075                                            PIC X(6).
  2076         16  CF-STATE-CNTL-OPT.
  2077             20  CF-STATE-OPT-SEQ           PIC 9.
  2078                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2079                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2080             20  CF-STATE-SELECT OCCURS 3 TIMES
  2081                                            PIC XX.
  2082         16  CF-ACCOUNT-CNTL-OPT.
  2083             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2084                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2085                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2086             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2087                                            PIC X(10).
  2088         16  CF-BUS-TYP-CNTL-OPT.
  2089             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2090                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2091                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2092             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2093                                            PIC XX.
  2094         16  CF-LF-TYP-CNTL-OPT.
  2095             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2096                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2097                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2098             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2099                                            PIC XX.
  2100         16  CF-AH-TYP-CNTL-OPT.
  2101             20  CF-AH-TYP-OPT-SEQ          PIC 9.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  38
* SOCK03.cbl
  2102                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2103                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2104             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2105                                            PIC XX.
  2106         16  CF-REPTCD1-CNTL-OPT.
  2107             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2108                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2109                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2110             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2111                                            PIC X(10).
  2112         16  CF-REPTCD2-CNTL-OPT.
  2113             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2114                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2115                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2116             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2117                                            PIC X(10).
  2118         16  CF-USER1-CNTL-OPT.
  2119             20  CF-USER1-OPT-SEQ           PIC 9.
  2120                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2121                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2122             20  CF-USER1-SELECT OCCURS 3 TIMES
  2123                                            PIC X(10).
  2124         16  CF-USER2-CNTL-OPT.
  2125             20  CF-USER2-OPT-SEQ           PIC 9.
  2126                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2127                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2128             20  CF-USER2-SELECT OCCURS 3 TIMES
  2129                                            PIC X(10).
  2130         16  CF-USER3-CNTL-OPT.
  2131             20  CF-USER3-OPT-SEQ           PIC 9.
  2132                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2133                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2134             20  CF-USER3-SELECT OCCURS 3 TIMES
  2135                                            PIC X(10).
  2136         16  CF-USER4-CNTL-OPT.
  2137             20  CF-USER4-OPT-SEQ           PIC 9.
  2138                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2139                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2140             20  CF-USER4-SELECT OCCURS 3 TIMES
  2141                                            PIC X(10).
  2142         16  CF-USER5-CNTL-OPT.
  2143             20  CF-USER5-OPT-SEQ           PIC 9.
  2144                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2145                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2146             20  CF-USER5-SELECT OCCURS 3 TIMES
  2147                                            PIC X(10).
  2148         16  CF-REINS-CNTL-OPT.
  2149             20  CF-REINS-OPT-SEQ           PIC 9.
  2150                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2151                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2152             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2153                 24  CF-REINS-PRIME         PIC XXX.
  2154                 24  CF-REINS-SUB           PIC XXX.
  2155
  2156         16  CF-AGENT-CNTL-OPT.
  2157             20  CF-AGENT-OPT-SEQ           PIC 9.
  2158                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2159                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  39
* SOCK03.cbl
  2160             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2161                                            PIC X(10).
  2162
  2163         16  FILLER                         PIC X(43).
  2164
  2165         16  CF-LOSS-RATIO-SELECT.
  2166             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2167             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2168         16  CF-ENTRY-DATE-SELECT.
  2169             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2170             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2171         16  CF-EFFECTIVE-DATE-SELECT.
  2172             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2173             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2174
  2175         16  CF-EXCEPTION-LIST-IND          PIC X.
  2176             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2177
  2178         16  FILLER                         PIC X(318).
  2179
  2180****************************************************************
  2181*                  EXCEPTION REPORTING RECORD                  *
  2182****************************************************************
  2183
  2184     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2185         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2186             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2187
  2188         16  CF-COMBINED-LIFE-AH-OPT.
  2189             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2190             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2191             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2192             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2193
  2194         16  CF-LIFE-OPT.
  2195             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2196             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2197             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2198             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2199             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2200             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2201             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2202             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2203             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2204             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2205
  2206         16  CF-AH-OPT.
  2207             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2208             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2209             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2210             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2211             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2212             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2213             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2214             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2215             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2216             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2217
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  40
* SOCK03.cbl
  2218         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2219             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2220             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2221             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2222
  2223         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2224
  2225         16  FILLER                         PIC X(673).
  2226
  2227
  2228****************************************************************
  2229*             MORTGAGE SYSTEM PLAN RECORD                      *
  2230****************************************************************
  2231
  2232     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2233         16  CF-PLAN-TYPE                   PIC X.
  2234             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2235             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2236             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2237         16  CF-PLAN-ABBREV                 PIC XXX.
  2238         16  CF-PLAN-DESCRIPT               PIC X(10).
  2239         16  CF-PLAN-NOTES                  PIC X(20).
  2240         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2241         16  CF-PLAN-UNDERWRITING.
  2242             20  CF-PLAN-TERM-DATA.
  2243                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2244                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2245             20  CF-PLAN-AGE-DATA.
  2246                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2247                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2248                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2249             20  CF-PLAN-BENEFIT-DATA.
  2250                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2251                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2252                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2253                                            PIC S9(7)V99  COMP-3.
  2254         16  CF-PLAN-POLICY-FORMS.
  2255             20  CF-POLICY-FORM             PIC X(12).
  2256             20  CF-MASTER-APPLICATION      PIC X(12).
  2257             20  CF-MASTER-POLICY           PIC X(12).
  2258         16  CF-PLAN-RATING.
  2259             20  CF-RATE-CODE               PIC X(5).
  2260             20  CF-SEX-RATING              PIC X.
  2261                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2262                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2263             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2264             20  CF-SUB-STD-TYPE            PIC X.
  2265                 88  CF-PCT-OF-PREM            VALUE '1'.
  2266                 88  CF-PCT-OF-BENE            VALUE '2'.
  2267         16  CF-PLAN-PREM-TOLERANCES.
  2268             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2269             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2270         16  CF-PLAN-PYMT-TOLERANCES.
  2271             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2272             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2273         16  CF-PLAN-MISC-DATA.
  2274             20  FILLER                     PIC X.
  2275             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  41
* SOCK03.cbl
  2276             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2277         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2278         16  CF-PLAN-IND-GRP                PIC X.
  2279             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2280                                                     '1'.
  2281             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2282                                                     '2'.
  2283         16  CF-MIB-SEARCH-SW               PIC X.
  2284             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2285             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2286             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2287             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2288         16  CF-ALPHA-SEARCH-SW             PIC X.
  2289             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2290             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2291             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2292             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2293             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2294             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2295             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2296             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2297             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2298             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2299                                                     'A' 'B' 'C'
  2300                                                     'X' 'Y' 'Z'.
  2301         16  CF-EFF-DT-RULE-SW              PIC X.
  2302             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2303             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2304             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2305             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2306             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2307         16  FILLER                         PIC X(4).
  2308         16  CF-HEALTH-QUESTIONS            PIC X.
  2309             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2310         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2311         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2312         16  CF-PLAN-SNGL-JNT               PIC X.
  2313             88  CF-COMBINED-PLAN              VALUE 'C'.
  2314             88  CF-JNT-PLAN                   VALUE 'J'.
  2315             88  CF-SNGL-PLAN                  VALUE 'S'.
  2316         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2317         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2318         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2319         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2320         16  CF-RERATE-CNTL                 PIC  X.
  2321             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2322             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2323             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2324             88  CF-AUTO-RECALC                 VALUE '4'.
  2325         16  CF-BENEFIT-TYPE                PIC  X.
  2326             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2327             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2328         16  CF-POLICY-FEE                  PIC S999V99
  2329                                                    COMP-3.
  2330         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2331         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2332         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2333         16  CF-4TH-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  42
* SOCK03.cbl
  2334         16  FILLER                         PIC  X(32).
  2335         16  CF-TERMINATION-FORM            PIC  X(04).
  2336         16  FILLER                         PIC  X(08).
  2337         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2338                                                       COMP-3.
  2339         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2340         16  CF-ISSUE-LETTER                PIC  X(4).
  2341         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2342         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2343             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2344             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2345         16  CF-MP-REFUND-CALC              PIC X.
  2346             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2347             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2348             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2349             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2350             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2351             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2352             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2353             88  CF-MP-REFD-MEAN                VALUE '8'.
  2354         16  CF-ALT-RATE-CODE               PIC  X(5).
  2355
  2356
  2357         16  FILLER                         PIC X(498).
  2358****************************************************************
  2359*             MORTGAGE COMPANY MASTER RECORD                   *
  2360****************************************************************
  2361
  2362     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2363         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2364         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2365             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2366             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2367             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2368             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2369             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2370
  2371         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2372         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2373         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2374         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2375         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2376
  2377         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2378             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2379         16  CF-MP-RECON-USE-IND            PIC X(1).
  2380             88  CF-MP-USE-RECON             VALUE 'Y'.
  2381         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2382             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2383         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2384             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2385             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2386         16  FILLER                         PIC X(1).
  2387         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2388             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2389         16  CF-MORTG-MIB-VERSION           PIC X.
  2390             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2391             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  43
* SOCK03.cbl
  2392             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2393         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2394             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2395                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2396             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2397                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2398             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2399                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2400             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2401                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2402             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2403                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2404             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2405                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2406         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2407         16  FILLER                         PIC X(7).
  2408         16  CF-MORTG-DESTINATION-SYMBOL.
  2409             20  CF-MORTG-MIB-COMM          PIC X(5).
  2410             20  CF-MORTG-MIB-TERM          PIC X(5).
  2411         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2412             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2413         16  FILLER                         PIC X(03).
  2414         16  CF-MP-CHECK-NO-CONTROL.
  2415             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2416                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2417                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2418                                                ' ' LOW-VALUES.
  2419                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2420                                               VALUE '3'.
  2421         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2422         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2423         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2424             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2425                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2426             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2427                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2428             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2429                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2430             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2431                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2432             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2433                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2434             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2435                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2436         16  CF-MORTG-BILLING-AREA.
  2437             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2438                                            PIC X.
  2439         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2440         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2441         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2442         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2443             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2444             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2445         16  FILLER                         PIC X.
  2446         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2447             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2448             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2449         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  44
* SOCK03.cbl
  2450         16  FILLER                         PIC X(8).
  2451         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2452         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2453         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2454         16  CF-ACH-COMPANY-ID.
  2455             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2456                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2457                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2458                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2459             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2460         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2461             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2462         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2463             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2464             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2465         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2466         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2467         16  FILLER                         PIC X(536).
  2468
  2469****************************************************************
  2470*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2471****************************************************************
  2472
  2473     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2474         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2475             20  CF-FEMALE-HEIGHT.
  2476                 24  CF-FEMALE-FT           PIC 99.
  2477                 24  CF-FEMALE-IN           PIC 99.
  2478             20  CF-FEMALE-MIN-WT           PIC 999.
  2479             20  CF-FEMALE-MAX-WT           PIC 999.
  2480         16  FILLER                         PIC X(428).
  2481
  2482     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2483         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2484             20  CF-MALE-HEIGHT.
  2485                 24  CF-MALE-FT             PIC 99.
  2486                 24  CF-MALE-IN             PIC 99.
  2487             20  CF-MALE-MIN-WT             PIC 999.
  2488             20  CF-MALE-MAX-WT             PIC 999.
  2489         16  FILLER                         PIC X(428).
  2490******************************************************************
  2491*             AUTOMATIC ACTIVITY RECORD                          *
  2492******************************************************************
  2493     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2494         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2495             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2496             20  CF-SYS-LETTER-ID           PIC X(04).
  2497             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2498             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2499             20  CF-SYS-RESET-SW            PIC X(01).
  2500             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2501             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2502
  2503         16  FILLER                         PIC X(50).
  2504
  2505         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2506             20  CF-USER-ACTIVE-SW          PIC X(01).
  2507             20  CF-USER-LETTER-ID          PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  45
* SOCK03.cbl
  2508             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2509             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2510             20  CF-USER-RESET-SW           PIC X(01).
  2511             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2512             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2513             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2514
  2515         16  FILLER                         PIC X(246).
  2516*                                 COPY ERCACCT.
  2517******************************************************************
  2518*                                                                *
  2519*                                                                *
  2520*                            ERCACCT                             *
  2521*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2522*                            VMOD=2.031                          *
  2523*                                                                *
  2524*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2525*                                                                *
  2526*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2527*   VSAM ACCOUNT MASTER FILES.                                   *
  2528*                                                                *
  2529*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2530*                                                                *
  2531*   FILE TYPE = VSAM,KSDS                                        *
  2532*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2533*                                                                *
  2534*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2535*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2536*                                                                *
  2537*   LOG = NO                                                     *
  2538*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2539*                                                                *
  2540*                                                                *
  2541******************************************************************
  2542*                   C H A N G E   L O G
  2543*
  2544* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2545*-----------------------------------------------------------------
  2546*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2547* EFFECTIVE    NUMBER
  2548*-----------------------------------------------------------------
  2549* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2550* 092705    2005050300006  PEMA  ADD SPP LEASES
  2551* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2552* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2553* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2554* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2555* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2556******************************************************************
  2557
  2558 01  ACCOUNT-MASTER.
  2559     12  AM-RECORD-ID                      PIC XX.
  2560         88  VALID-AM-ID                      VALUE 'AM'.
  2561
  2562     12  AM-CONTROL-PRIMARY.
  2563         16  AM-COMPANY-CD                 PIC X.
  2564         16  AM-MSTR-CNTRL.
  2565             20  AM-CONTROL-A.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  46
* SOCK03.cbl
  2566                 24  AM-CARRIER            PIC X.
  2567                 24  AM-GROUPING.
  2568                     28 AM-GROUPING-PREFIX PIC XXX.
  2569                     28 AM-GROUPING-PRIME  PIC XXX.
  2570                 24  AM-STATE              PIC XX.
  2571                 24  AM-ACCOUNT.
  2572                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2573                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2574             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2575                                           PIC X(19).
  2576             20  AM-CNTRL-B.
  2577                 24  AM-EXPIRATION-DT      PIC XX.
  2578                 24  FILLER                PIC X(4).
  2579             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2580                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2581
  2582     12  AM-CONTROL-BY-VAR-GRP.
  2583         16  AM-COMPANY-CD-A1              PIC X.
  2584         16  AM-VG-CARRIER                 PIC X.
  2585         16  AM-VG-GROUPING                PIC X(6).
  2586         16  AM-VG-STATE                   PIC XX.
  2587         16  AM-VG-ACCOUNT                 PIC X(10).
  2588         16  AM-VG-DATE.
  2589             20  AM-VG-EXPIRATION-DT       PIC XX.
  2590             20  FILLER                    PIC X(4).
  2591         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2592                                           PIC 9(11)      COMP-3.
  2593     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2594         16  FILLER                        PIC X(10).
  2595         16  AM-VG-KEY3.
  2596             20  AM-VG3-ACCOUNT            PIC X(10).
  2597             20  AM-VG3-EXP-DT             PIC XX.
  2598         16  FILLER                        PIC X(4).
  2599     12  AM-MAINT-INFORMATION.
  2600         16  AM-LAST-MAINT-DT              PIC XX.
  2601         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2602         16  AM-LAST-MAINT-USER            PIC X(4).
  2603         16  FILLER                        PIC XX.
  2604
  2605     12  AM-EFFECTIVE-DT                   PIC XX.
  2606     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2607
  2608     12  AM-PREV-DATES  COMP-3.
  2609         16  AM-PREV-EXP-DT                PIC 9(11).
  2610         16  AM-PREV-EFF-DT                PIC 9(11).
  2611
  2612     12  AM-REPORT-CODE-1                  PIC X(10).
  2613     12  AM-REPORT-CODE-2                  PIC X(10).
  2614
  2615     12  AM-CITY-CODE                      PIC X(4).
  2616     12  AM-COUNTY-PARISH                  PIC X(6).
  2617
  2618     12  AM-NAME                           PIC X(30).
  2619     12  AM-PERSON                         PIC X(30).
  2620     12  AM-ADDRS                          PIC X(30).
  2621     12  AM-CITY.
  2622         16  AM-ADDR-CITY                  PIC X(28).
  2623         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  47
* SOCK03.cbl
  2624     12  AM-ZIP.
  2625         16  AM-ZIP-PRIME.
  2626             20  AM-ZIP-PRI-1ST            PIC X.
  2627                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2628             20  FILLER                    PIC X(4).
  2629         16  AM-ZIP-PLUS4                  PIC X(4).
  2630     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2631         16  AM-CAN-POSTAL-1               PIC XXX.
  2632         16  AM-CAN-POSTAL-2               PIC XXX.
  2633         16  FILLER                        PIC XXX.
  2634     12  AM-TEL-NO.
  2635         16  AM-AREA-CODE                  PIC 999.
  2636         16  AM-TEL-PRE                    PIC 999.
  2637         16  AM-TEL-NBR                    PIC 9(4).
  2638     12  AM-TEL-LOC                        PIC X.
  2639         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2640         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2641
  2642     12  AM-COMM-STRUCTURE.
  2643         16  AM-DEFN-1.
  2644             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2645                 24  AM-AGT.
  2646                     28  AM-AGT-PREFIX     PIC X(4).
  2647                     28  AM-AGT-PRIME      PIC X(6).
  2648                 24  AM-COM-TYP            PIC X.
  2649                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2650                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2651                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2652                 24  AM-RECALC-LV-INDIC    PIC X.
  2653                 24  AM-RETRO-LV-INDIC     PIC X.
  2654                 24  AM-GL-CODES           PIC X.
  2655                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2656                 24  FILLER                PIC X(01).
  2657         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2658             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2659                 24  FILLER                PIC X(11).
  2660                 24  AM-L-COMA             PIC XXX.
  2661                 24  AM-J-COMA             PIC XXX.
  2662                 24  AM-A-COMA             PIC XXX.
  2663                 24  FILLER                PIC X(6).
  2664
  2665     12  AM-COMM-CHANGE-STATUS             PIC X.
  2666         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2667
  2668     12  AM-CSR-CODE                       PIC X(4).
  2669
  2670     12  AM-BILLING-STATUS                 PIC X.
  2671         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2672         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2673     12  AM-AUTO-REFUND-SW                 PIC X.
  2674         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2675         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2676     12  AM-GPCD                           PIC 99.
  2677     12  AM-IG                             PIC X.
  2678         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2679         88  AM-HAS-GROUP                     VALUE '2'.
  2680     12  AM-STATUS                         PIC X.
  2681         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  48
* SOCK03.cbl
  2682         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2683         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2684         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2685         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2686         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2687     12  AM-REMIT-TO                       PIC 99.
  2688     12  AM-ID-NO                          PIC X(11).
  2689
  2690     12  AM-CAL-TABLE                      PIC XX.
  2691     12  AM-LF-DEVIATION                   PIC XXX.
  2692     12  AM-AH-DEVIATION                   PIC XXX.
  2693     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2694     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2695     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2696     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2697     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2698     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2699
  2700     12  AM-USER-FIELDS.
  2701         16  AM-FLD-1                      PIC XX.
  2702         16  AM-FLD-2                      PIC XX.
  2703         16  AM-FLD-3                      PIC XX.
  2704         16  AM-FLD-4                      PIC XX.
  2705         16  AM-FLD-5                      PIC XX.
  2706
  2707     12  AM-1ST-PROD-DATE.
  2708         16  AM-1ST-PROD-YR                PIC XX.
  2709         16  AM-1ST-PROD-MO                PIC XX.
  2710         16  AM-1ST-PROD-DA                PIC XX.
  2711     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2712     12  AM-CERTS-PURGED-DATE.
  2713         16  AM-PUR-YR                     PIC XX.
  2714         16  AM-PUR-MO                     PIC XX.
  2715         16  AM-PUR-DA                     PIC XX.
  2716     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2717     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2718     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2719     12  AM-INACTIVE-DATE.
  2720         16  AM-INA-MO                     PIC 99.
  2721         16  AM-INA-DA                     PIC 99.
  2722         16  AM-INA-YR                     PIC 99.
  2723     12  AM-AR-HI-CERT-DATE                PIC XX.
  2724
  2725     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2726     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2727
  2728     12  AM-OB-PAYMENT-MODE                PIC X.
  2729         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2730         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2731         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2732         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2733
  2734     12  AM-AH-ONLY-INDICATOR              PIC X.
  2735         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2736         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2737
  2738     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2739
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  49
* SOCK03.cbl
  2740     12  AM-OVER-SHORT.
  2741         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2742         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2743
  2744     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2745     12  AM-DCC-CLP-STATE                  PIC XX.
  2746
  2747     12  AM-RECALC-COMM                    PIC X.
  2748     12  AM-RECALC-REIN                    PIC X.
  2749
  2750     12  AM-REI-TABLE                      PIC XXX.
  2751     12  AM-REI-ET-LF                      PIC X.
  2752     12  AM-REI-ET-AH                      PIC X.
  2753     12  AM-REI-PE-LF                      PIC X.
  2754     12  AM-REI-PE-AH                      PIC X.
  2755     12  AM-REI-PRT-ST                     PIC X.
  2756     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2757     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2758     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2759     12  AM-REI-GROUP-A                    PIC X(6).
  2760     12  AM-REI-MORT                       PIC X(4).
  2761     12  AM-REI-PRT-OW                     PIC X.
  2762     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2763     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2764     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2765     12  AM-REI-GROUP-B                    PIC X(6).
  2766
  2767     12  AM-TRUST-TYPE                     PIC X(2).
  2768
  2769     12  AM-EMPLOYER-STMT-USED             PIC X.
  2770     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2771
  2772     12  AM-STD-AH-TYPE                    PIC XX.
  2773     12  AM-EARN-METHODS.
  2774         16  AM-EARN-METHOD-R              PIC X.
  2775             88 AM-REF-RL-R78                 VALUE 'R'.
  2776             88 AM-REF-RL-PR                  VALUE 'P'.
  2777             88 AM-REF-RL-MEAN                VALUE 'M'.
  2778             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2779         16  AM-EARN-METHOD-L              PIC X.
  2780             88 AM-REF-LL-R78                 VALUE 'R'.
  2781             88 AM-REF-LL-PR                  VALUE 'P'.
  2782             88 AM-REF-LL-MEAN                VALUE 'M'.
  2783             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2784         16  AM-EARN-METHOD-A              PIC X.
  2785             88 AM-REF-AH-R78                 VALUE 'R'.
  2786             88 AM-REF-AH-PR                  VALUE 'P'.
  2787             88 AM-REF-AH-MEAN                VALUE 'M'.
  2788             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2789             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2790             88 AM-REF-AH-NET                 VALUE 'N'.
  2791
  2792     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2793     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2794     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2795
  2796     12  AM-RET-Y-N                        PIC X.
  2797     12  AM-RET-P-E                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  50
* SOCK03.cbl
  2798     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2799     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2800     12  AM-RET-GRP                        PIC X(6).
  2801     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2802         16  AM-POOL-PRIME                 PIC XXX.
  2803         16  AM-POOL-SUB                   PIC XXX.
  2804     12  AM-RETRO-EARNINGS.
  2805         16  AM-RET-EARN-R                 PIC X.
  2806         16  AM-RET-EARN-L                 PIC X.
  2807         16  AM-RET-EARN-A                 PIC X.
  2808     12  AM-RET-ST-TAX-USE                 PIC X.
  2809         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2810         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2811     12  AM-RETRO-BEG-EARNINGS.
  2812         16  AM-RET-BEG-EARN-R             PIC X.
  2813         16  AM-RET-BEG-EARN-L             PIC X.
  2814         16  AM-RET-BEG-EARN-A             PIC X.
  2815     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2816     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2817
  2818     12  AM-USER-SELECT-OPTIONS.
  2819         16  AM-USER-SELECT-1              PIC X(10).
  2820         16  AM-USER-SELECT-2              PIC X(10).
  2821         16  AM-USER-SELECT-3              PIC X(10).
  2822         16  AM-USER-SELECT-4              PIC X(10).
  2823         16  AM-USER-SELECT-5              PIC X(10).
  2824
  2825     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2826
  2827     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2828
  2829     12  AM-RPT045A-SWITCH                 PIC X.
  2830         88  RPT045A-OFF                   VALUE 'N'.
  2831
  2832     12  AM-INSURANCE-LIMITS.
  2833         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2834         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2835
  2836     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2837         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2838
  2839     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2840         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2841         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2842
  2843     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2844
  2845     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2846     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2847     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2848     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2849     12  AM-DCC-UEF-STATE                  PIC XX.
  2850     12  FILLER                            PIC XXX.
  2851     12  AM-REPORT-CODE-3                  PIC X(10).
  2852*    12  FILLER                            PIC X(22).
  2853
  2854     12  AM-RESERVE-DATE.
  2855         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  51
* SOCK03.cbl
  2856         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2857         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2858
  2859     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2860     12  AM-NOTIFICATION-TYPES.
  2861         16  AM-NOTIF-OF-LETTERS           PIC X.
  2862         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2863         16  AM-NOTIF-OF-REPORTS           PIC X.
  2864         16  AM-NOTIF-OF-STATUS            PIC X.
  2865
  2866     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2867         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2868         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2869         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2870         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2871
  2872     12  AM-BENEFIT-CONTROLS.
  2873         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2874             20  AM-BENEFIT-CODE           PIC XX.
  2875             20  AM-BENEFIT-TYPE           PIC X.
  2876             20  AM-BENEFIT-REVISION       PIC XXX.
  2877             20  AM-BENEFIT-REM-TERM       PIC X.
  2878             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2879             20  FILLER                    PIC XX.
  2880         16  FILLER                        PIC X(80).
  2881
  2882     12  AM-TRANSFER-DATA.
  2883         16  AM-TRANSFERRED-FROM.
  2884             20  AM-TRNFROM-CARRIER        PIC X.
  2885             20  AM-TRNFROM-GROUPING.
  2886                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2887                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2888             20  AM-TRNFROM-STATE          PIC XX.
  2889             20  AM-TRNFROM-ACCOUNT.
  2890                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2891                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2892             20  AM-TRNFROM-DTE            PIC XX.
  2893         16  AM-TRANSFERRED-TO.
  2894             20  AM-TRNTO-CARRIER          PIC X.
  2895             20  AM-TRNTO-GROUPING.
  2896                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2897                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2898             20  AM-TRNTO-STATE            PIC XX.
  2899             20  AM-TRNTO-ACCOUNT.
  2900                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2901                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2902             20  AM-TRNTO-DTE              PIC XX.
  2903         16  FILLER                        PIC X(10).
  2904
  2905     12  AM-SAVED-REMIT-TO                 PIC 99.
  2906
  2907     12  AM-COMM-STRUCTURE-SAVED.
  2908         16  AM-DEFN-1-SAVED.
  2909             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2910                 24  AM-AGT-SV             PIC X(10).
  2911                 24  AM-COM-TYP-SV         PIC X.
  2912                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2913                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  52
* SOCK03.cbl
  2914                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2915                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2916                 24  FILLER                PIC X.
  2917                 24  AM-GL-CODES-SV        PIC X.
  2918                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2919                 24  FILLER                PIC X.
  2920         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2921             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2922                 24  FILLER                PIC X(11).
  2923                 24  AM-L-COMA-SV          PIC XXX.
  2924                 24  AM-J-COMA-SV          PIC XXX.
  2925                 24  AM-A-COMA-SV          PIC XXX.
  2926                 24  FILLER                PIC X(6).
  2927
  2928     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2929         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2930            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2931            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2932            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2933
  2934     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2935     12  FILLER                            PIC X(120).
  2936
  2937     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2938         16  AM-CONTROL-NAME               PIC X(30).
  2939         16  AM-EXECUTIVE-ONE.
  2940             20  AM-EXEC1-NAME             PIC X(15).
  2941             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2942                                                          COMP-3.
  2943             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2944                                                          COMP-3.
  2945         16  AM-EXECUTIVE-TWO.
  2946             20  AM-EXEC2-NAME             PIC X(15).
  2947             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2948                                                          COMP-3.
  2949             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2950                                                          COMP-3.
  2951
  2952     12  AM-RETRO-ADDITIONAL-DATA.
  2953         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2954         16  AM-RETRO-PREM-P-E             PIC X.
  2955         16  AM-RETRO-CLMS-P-I             PIC X.
  2956         16  AM-RETRO-RET-BRACKET-LF.
  2957             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2958                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2959                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2960             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2961                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2962                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2963             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2964                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2965                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2966         16  AM-RETRO-RET-BRACKET-AH.
  2967             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2968                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2969                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2970                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2971             20  AM-RETRO-RET-BASIS-AH     PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  53
* SOCK03.cbl
  2972                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2973                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2974             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2975                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2976                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2977
  2978     12  AM-COMMENTS.
  2979         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2980
  2981     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2982         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2983         16  AM-FLI-BILLING-CODE           PIC X.
  2984         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2985         16  AM-FLI-UNITED-IDENT           PIC X.
  2986         16  AM-FLI-INTEREST-LOST-DATA.
  2987             20  AM-FLI-BANK-NO            PIC X(5).
  2988             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2989             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2990             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2991         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2992             20  AM-FLI-AGT                PIC X(9).
  2993             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2994             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2995         16  FILLER                        PIC X(102).
  2996
  2997     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2998         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2999             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3000             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3001             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3002             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3003             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3004         16  FILLER                          PIC X(10).
  3005******************************************************************
  3006*                                 COPY ELCDATE.
  3007******************************************************************
  3008*                                                                *
  3009*                                                                *
  3010*                            ELCDATE.                            *
  3011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3012*                            VMOD=2.003
  3013*                                                                *
  3014*                                                                *
  3015*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3016*                 LENGTH = 200                                   *
  3017******************************************************************
  3018
  3019 01  DATE-CONVERSION-DATA.
  3020     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3021     12  DC-OPTION-CODE                PIC X.
  3022         88  BIN-TO-GREG                VALUE ' '.
  3023         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3024         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3025         88  YMD-GREG-TO-BIN            VALUE '3'.
  3026         88  MDY-GREG-TO-BIN            VALUE '4'.
  3027         88  JULIAN-TO-BIN              VALUE '5'.
  3028         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3029         88  FIND-CENTURY               VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  54
* SOCK03.cbl
  3030         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3031         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3032         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3033         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3034         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3035         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3036         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3037         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3038         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3039         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3040         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3041         88  BIN-3-TO-GREG              VALUE 'I'.
  3042         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3043         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3044         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3045         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3046         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3047         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3048         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3049         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3050         88  THREE-CHARACTER-BIN
  3051                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3052         88  GREGORIAN-TO-BIN
  3053                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3054         88  BIN-TO-GREGORIAN
  3055                  VALUES ' ' '1' 'I' '8' 'G'.
  3056         88  JULIAN-TO-BINARY
  3057                  VALUES '5' 'C' 'E' 'F'.
  3058     12  DC-ERROR-CODE                 PIC X.
  3059         88  NO-CONVERSION-ERROR        VALUE ' '.
  3060         88  DATE-CONVERSION-ERROR
  3061                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3062         88  DATE-IS-ZERO               VALUE '1'.
  3063         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3064         88  DATE-IS-INVALID            VALUE '3'.
  3065         88  DATE1-GREATER-DATE2        VALUE '4'.
  3066         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3067         88  DATE-INVALID-OPTION        VALUE '9'.
  3068         88  INVALID-CENTURY            VALUE 'A'.
  3069         88  ONLY-CENTURY               VALUE 'B'.
  3070         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3071         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3072     12  DC-END-OF-MONTH               PIC X.
  3073         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3074     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3075         88  USE-NORMAL-PROCESS         VALUE ' '.
  3076         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3077         88  ADJUST-UP-100-YRS          VALUE '2'.
  3078     12  FILLER                        PIC X.
  3079     12  DC-CONVERSION-DATES.
  3080         16  DC-BIN-DATE-1             PIC XX.
  3081         16  DC-BIN-DATE-2             PIC XX.
  3082         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3083         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3084                       DC-GREG-DATE-1-EDIT.
  3085             20  DC-EDIT1-MONTH        PIC 99.
  3086             20  SLASH1-1              PIC X.
  3087             20  DC-EDIT1-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  55
* SOCK03.cbl
  3088             20  SLASH1-2              PIC X.
  3089             20  DC-EDIT1-YEAR         PIC 99.
  3090         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3091         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3092                     DC-GREG-DATE-2-EDIT.
  3093             20  DC-EDIT2-MONTH        PIC 99.
  3094             20  SLASH2-1              PIC X.
  3095             20  DC-EDIT2-DAY          PIC 99.
  3096             20  SLASH2-2              PIC X.
  3097             20  DC-EDIT2-YEAR         PIC 99.
  3098         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3099         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3100                     DC-GREG-DATE-1-YMD.
  3101             20  DC-YMD-YEAR           PIC 99.
  3102             20  DC-YMD-MONTH          PIC 99.
  3103             20  DC-YMD-DAY            PIC 99.
  3104         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3105         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3106                      DC-GREG-DATE-1-MDY.
  3107             20  DC-MDY-MONTH          PIC 99.
  3108             20  DC-MDY-DAY            PIC 99.
  3109             20  DC-MDY-YEAR           PIC 99.
  3110         16  DC-GREG-DATE-1-ALPHA.
  3111             20  DC-ALPHA-MONTH        PIC X(10).
  3112             20  DC-ALPHA-DAY          PIC 99.
  3113             20  FILLER                PIC XX.
  3114             20  DC-ALPHA-CENTURY.
  3115                 24 DC-ALPHA-CEN-N     PIC 99.
  3116             20  DC-ALPHA-YEAR         PIC 99.
  3117         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3118         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3119         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3120         16  DC-JULIAN-DATE            PIC 9(05).
  3121         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3122                                       PIC 9(05).
  3123         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3124             20  DC-JULIAN-YEAR        PIC 99.
  3125             20  DC-JULIAN-DAYS        PIC 999.
  3126         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3127         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3128         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3129     12  DATE-CONVERSION-VARIBLES.
  3130         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3131         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3132             20  FILLER                PIC 9(3).
  3133             20  HOLD-CEN-1-CCYY.
  3134                 24  HOLD-CEN-1-CC     PIC 99.
  3135                 24  HOLD-CEN-1-YY     PIC 99.
  3136             20  HOLD-CEN-1-MO         PIC 99.
  3137             20  HOLD-CEN-1-DA         PIC 99.
  3138         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3139             20  HOLD-CEN-1-R-MO       PIC 99.
  3140             20  HOLD-CEN-1-R-DA       PIC 99.
  3141             20  HOLD-CEN-1-R-CCYY.
  3142                 24  HOLD-CEN-1-R-CC   PIC 99.
  3143                 24  HOLD-CEN-1-R-YY   PIC 99.
  3144             20  FILLER                PIC 9(3).
  3145         16  HOLD-CENTURY-1-X.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  56
* SOCK03.cbl
  3146             20  FILLER                PIC X(3)  VALUE SPACES.
  3147             20  HOLD-CEN-1-X-CCYY.
  3148                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3149                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3150             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3151             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3152         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3153             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3154             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3155             20  HOLD-CEN-1-R-X-CCYY.
  3156                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3157                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3158             20  FILLER                PIC XXX.
  3159         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3160         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3161         16  DC-JULIAN-DATE-1          PIC 9(07).
  3162         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3163             20  DC-JULIAN-1-CCYY.
  3164                 24  DC-JULIAN-1-CC    PIC 99.
  3165                 24  DC-JULIAN-1-YR    PIC 99.
  3166             20  DC-JULIAN-DA-1        PIC 999.
  3167         16  DC-JULIAN-DATE-2          PIC 9(07).
  3168         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3169             20  DC-JULIAN-2-CCYY.
  3170                 24  DC-JULIAN-2-CC    PIC 99.
  3171                 24  DC-JULIAN-2-YR    PIC 99.
  3172             20  DC-JULIAN-DA-2        PIC 999.
  3173         16  DC-GREG-DATE-A-EDIT.
  3174             20  DC-EDITA-MONTH        PIC 99.
  3175             20  SLASHA-1              PIC X VALUE '/'.
  3176             20  DC-EDITA-DAY          PIC 99.
  3177             20  SLASHA-2              PIC X VALUE '/'.
  3178             20  DC-EDITA-CCYY.
  3179                 24  DC-EDITA-CENT     PIC 99.
  3180                 24  DC-EDITA-YEAR     PIC 99.
  3181         16  DC-GREG-DATE-B-EDIT.
  3182             20  DC-EDITB-MONTH        PIC 99.
  3183             20  SLASHB-1              PIC X VALUE '/'.
  3184             20  DC-EDITB-DAY          PIC 99.
  3185             20  SLASHB-2              PIC X VALUE '/'.
  3186             20  DC-EDITB-CCYY.
  3187                 24  DC-EDITB-CENT     PIC 99.
  3188                 24  DC-EDITB-YEAR     PIC 99.
  3189         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3190         16  DC-GREG-DATE-CYMD-R REDEFINES
  3191                              DC-GREG-DATE-CYMD.
  3192             20  DC-CYMD-CEN           PIC 99.
  3193             20  DC-CYMD-YEAR          PIC 99.
  3194             20  DC-CYMD-MONTH         PIC 99.
  3195             20  DC-CYMD-DAY           PIC 99.
  3196         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3197         16  DC-GREG-DATE-MDCY-R REDEFINES
  3198                              DC-GREG-DATE-MDCY.
  3199             20  DC-MDCY-MONTH         PIC 99.
  3200             20  DC-MDCY-DAY           PIC 99.
  3201             20  DC-MDCY-CEN           PIC 99.
  3202             20  DC-MDCY-YEAR          PIC 99.
  3203    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  57
* SOCK03.cbl
  3204        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3205    12  DC-EL310-DATE                  PIC X(21).
  3206    12  FILLER                         PIC X(28).
  3207*                                 COPY ELCCALC.
  3208******************************************************************
  3209*                                                                *
  3210*                           ELCCALC.                            *
  3211*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3212*                            VMOD=2.025                          *
  3213*                                                                *
  3214*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3215*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3216*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3217*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3218*                                                                *
  3219*  PASSED TO ELRTRM                                              *
  3220*  -----------------                                             *
  3221*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3222*  ORIGINAL TERM                                                 *
  3223*  BEGINNING DATE                                                *
  3224*  ENDING DATE                                                   *
  3225*  COMPANY I.D.                                                  *
  3226*  ACCOUNT MASTER USER FIELD                                     *
  3227*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3228*  FREE LOOK DAYS                                                *
  3229*                                                                *
  3230*  RETURNED FROM ELRTRM                                          *
  3231*  ---------------------                                         *
  3232*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3233*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3234*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3235*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3236*----------------------------------------------------------------*
  3237*  PASSED TO ELRAMT                                              *
  3238*  ----------------                                              *
  3239*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3240*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3241*  ORIGINAL AMOUNT                                               *
  3242*  ALTERNATE BENEFIT (BALLON)                                    *
  3243*  A.P.R. - NET PAY ONLY                                         *
  3244*  METHOD
  3245*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3246*  COMPANY I.D.                                                  *
  3247*  BENEFIT TYPE                                                  *
  3248*                                                                *
  3249*  RETURNED FROM ELRAMT                                          *
  3250*  --------------------                                          *
  3251*  REMAINING AMOUNT 1 - CURRENT                                  *
  3252*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3253*  REMAINING AMOUNT FACTOR
  3254*----------------------------------------------------------------*
  3255*  PASSED TO ELRESV                                              *
  3256*  -----------------                                             *
  3257*  CERTIFICATE EFFECTIVE DATE                                    *
  3258*  VALUATION DATE                                                *
  3259*  PAID THRU DATE                                                *
  3260*  BENEFIT                                                       *
  3261*  INCURRED DATE                                                 *
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  58
* SOCK03.cbl
  3262*  REPORTED DATE                                                 *
  3263*  ISSUE AGE                                                     *
  3264*  TERM                                                          *
  3265*  CDT PERCENT                                                   *
  3266*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3267* *CLAIM TYPE (LIFE, A/H)                                        *
  3268* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3269* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3270*                                                                *
  3271*  RETURNED FROM ELRESV                                          *
  3272*  --------------------                                          *
  3273*  CDT TABLE USED                                                *
  3274*  CDT FACTOR USED                                               *
  3275*  PAY TO CURRENT RESERVE                                        *
  3276*  I.B.N.R. - A/H ONLY                                           *
  3277*  FUTURE (ACCRUED) AH ONLY                                      *
  3278*----------------------------------------------------------------*
  3279*  PASSED TO ELRATE                                              *
  3280*  ----------------                                              *
  3281*  CERT ISSUE DATE                                               *
  3282*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3283*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3284*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3285*  STATE CODE (CLIENT DEFINED)                                   *
  3286*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3287*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3288*  DEVIATION CODE                                                *
  3289*  ISSUE AGE                                                     *
  3290*  ORIGINAL BENEFIT AMOUNT                                       *
  3291*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3292*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3293*  BENEFIT KIND (LIFE OR A/H)                                    *
  3294*  A.P.R.                                                        *
  3295*  METHOD
  3296*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3297*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3298*  COMPANY I.D. (3 CHARACTER)                                    *
  3299*  BENEFIT CODE                                                  *
  3300*  BENEFIT OVERRIDE CODE                                         *
  3301*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3302*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3303*  JOINT INDICATOR (CSL ONLY)                                    *
  3304*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3305*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3306*                                                                *
  3307*  RETURNED FROM ELRATE                                          *
  3308*  --------------------                                          *
  3309*  CALCULATED PREMIUM                                            *
  3310*  PREMIUM RATE                                                  *
  3311*  MORTALITY CODE                                                *
  3312*  MAX ATTAINED AGE                                              *
  3313*  MAX AGE                                                       *
  3314*  MAX TERM                                                      *
  3315*  MAX MONTHLY BENEFIT                                           *
  3316*  MAX TOTAL BENIFIT                                             *
  3317*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3318*----------------------------------------------------------------*
  3319*  PASSED TO ELRFND                                              *
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  59
* SOCK03.cbl
  3320*  ----------------                                              *
  3321*  CERT ISSUE DATE                                               *
  3322*  REFUND DATE                                                   *
  3323*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3324*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3325*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3326*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3327*  STATE CODE (CLIENT DEFINED)                                   *
  3328*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3329*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3330*  DEVIATION CODE                                                *
  3331*  ISSUE AGE                                                     *
  3332*  ORIGINAL BENEFIT AMOUNT                                       *
  3333*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3334*  PROCESS TYPE (CANCEL)                                         *
  3335*  BENEFIT KIND (LIFE OR A/H)                                    *
  3336*  A.P.R.                                                        *
  3337*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3338*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3339*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3340*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3341*  COMPANY I.D. (3 CHARACTER)                                    *
  3342*  BENEFIT CODE                                                  *
  3343*  BENEFIT OVERRIDE CODE                                         *
  3344*                                                                *
  3345*  RETURNED FROM ELRFND                                          *
  3346*  --------------------                                          *
  3347*  CALCULATED REFUND                                             *
  3348*----------------------------------------------------------------*
  3349*  PASSED TO ELEARN                                              *
  3350*  ----------------                                              *
  3351*  CERT ISSUE DATE                                               *
  3352*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3353*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3354*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3355*  STATE CODE (CLIENT DEFINED)                                   *
  3356*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3357*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3358*  DEVIATION CODE                                                *
  3359*  ISSUE AGE                                                     *
  3360*  ORIGINAL BENEFIT AMOUNT                                       *
  3361*  BENEFIT KIND (LIFE OR A/H)                                    *
  3362*  A.P.R.                                                        *
  3363*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3364*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3365*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3366*  COMPANY I.D. (3 CHARACTER)                                    *
  3367*  BENEFIT CODE                                                  *
  3368*  BENEFIT OVERRIDE CODE                                         *
  3369*                                                                *
  3370*  RETURNED FROM ELEARN                                          *
  3371*  --------------------                                          *
  3372*  INDICATED  EARNINGS                                           *
  3373*----------------------------------------------------------------*
  3374*                 LENGTH = 450                                   *
  3375*                                                                *
  3376******************************************************************
  3377******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  60
* SOCK03.cbl
  3378*                   C H A N G E   L O G
  3379*
  3380* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3381*-----------------------------------------------------------------
  3382*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3383* EFFECTIVE    NUMBER
  3384*-----------------------------------------------------------------
  3385* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3386* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3387* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3388* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3389* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3390* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3391* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3392* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3393* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3394******************************************************************
  3395
  3396 01  CALCULATION-PASS-AREA.
  3397     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3398                                     COMP.
  3399
  3400     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3401       88  NO-CP-ERROR                             VALUE ZERO.
  3402       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3403                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3404       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3405       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3406       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3407       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3408       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3409       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3410       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3411       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3412       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3413       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3414       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3415       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3416       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3417       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3418       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3419       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3420       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3421
  3422     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3423       88  NO-CP-ERROR-2                           VALUE ZERO.
  3424***********************  INPUT AREAS ****************************
  3425
  3426     12  CP-CALCULATION-AREA.
  3427         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3428         16  CP-CERT-EFF-DT        PIC XX.
  3429         16  CP-VALUATION-DT       PIC XX.
  3430         16  CP-PAID-THRU-DT       PIC XX.
  3431         16  CP-BENEFIT-TYPE       PIC X.
  3432           88  CP-AH                               VALUE 'A' 'D'
  3433                                                   'I' 'U'.
  3434           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3435           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  61
* SOCK03.cbl
  3436         16  CP-INCURRED-DT        PIC XX.
  3437         16  CP-REPORTED-DT        PIC XX.
  3438         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3439         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3440         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3441                                     COMP-3.
  3442         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3443                                     COMP-3.
  3444         16  CP-CDT-METHOD         PIC X.
  3445           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3446           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3447           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3448         16  CP-CLAIM-TYPE         PIC X.
  3449           88  CP-AH-CLAIM                         VALUE 'A'.
  3450           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3451         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3452                                     COMP-3.
  3453         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3454                                     COMP-3.
  3455         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3456                                     COMP-3.
  3457         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3458                                     COMP-3.
  3459         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3460                                     COMP-3.
  3461         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3462                                     COMP-3.
  3463         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3464                                     COMP-3.
  3465         16  CP-REM-TERM-METHOD    PIC X.
  3466           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3467           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3468           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3469           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3470           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3471           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3472           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3473         16  CP-EARNING-METHOD     PIC X.
  3474           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3475           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3476           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3477           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3478           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3479           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3480           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3481           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3482           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3483           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3484           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3485           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3486           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3487           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3488         16  CP-PROCESS-TYPE       PIC X.
  3489           88  CP-CLAIM                            VALUE '1'.
  3490           88  CP-CANCEL                           VALUE '2'.
  3491           88  CP-ISSUE                            VALUE '3'.
  3492         16  CP-SPECIAL-CALC-CD    PIC X.
  3493           88  CP-OUTSTANDING-BAL              VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  62
* SOCK03.cbl
  3494           88  CP-1-MTH-INTEREST               VALUE ' '.
  3495           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3496           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3497           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3498           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3499           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3500           88  CP-FARM-PLAN                    VALUE 'F'.
  3501           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3502           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3503           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3504           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3505           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3506           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3507           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3508           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3509           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3510           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3511                                                     'W' 'X'.
  3512           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3513           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3514           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3515           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3516           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3517           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3518           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3519           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3520           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3521           88  CP-CSL-METH-1                   VALUE '5'.
  3522           88  CP-CSL-METH-2                   VALUE '6'.
  3523           88  CP-CSL-METH-3                   VALUE '7'.
  3524           88  CP-CSL-METH-4                   VALUE '8'.
  3525
  3526         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3527                                     COMP-3.
  3528         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3529         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3530         16  CP-STATE              PIC XX          VALUE SPACE.
  3531         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3532         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3533           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3534               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3535         16  CP-R78-OPTION         PIC X.
  3536           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3537           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3538
  3539         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3540         16  CP-IBNR-RESERVE-SW    PIC X.
  3541         16  CP-CLAIM-STATUS       PIC X.
  3542         16  CP-RATE-FILE          PIC X.
  3543         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3544                                     COMP-3.
  3545
  3546         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3547         16  CP-AH-OVERRIDE-CODE   PIC X.
  3548
  3549         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3550                                     COMP-3.
  3551         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  63
* SOCK03.cbl
  3552                                   PIC S9(5)V99 COMP-3.
  3553         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3554                                     COMP-3.
  3555         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3556                                     COMP-3.
  3557         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3558                                     COMP-3.
  3559         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3560                                  PIC S9(7)V99 COMP-3.
  3561
  3562         16  CP-PAID-FROM-DATE     PIC X(02).
  3563         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3564         16  CP-EXT-DAYS-CALC      PIC X.
  3565           88  CP-EXT-NO-CHG                   VALUE ' '.
  3566           88  CP-EXT-CHG-LF                   VALUE '1'.
  3567           88  CP-EXT-CHG-AH                   VALUE '2'.
  3568           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3569         16  CP-DOMICILE-STATE     PIC XX.
  3570         16  CP-CARRIER            PIC X.
  3571         16  CP-REIN-FLAG          PIC X.
  3572         16  CP-REM-TRM-CALC-OPTION PIC X.
  3573           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3574                      '2' '3' '4' '5'.
  3575           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3576           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3577           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3578           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3579           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3580           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3581           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3582           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3583         16  CP-SIG-SWITCH         PIC X.
  3584         16  CP-RATING-METHOD      PIC X.
  3585           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3586           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3587           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3588           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3589           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3590           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3591           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3592           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3593           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3594         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3595                                     COMP-3.
  3596         16  CP-BEN-CATEGORY       PIC X.
  3597         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3598         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3599                                   PIC S99V9(5) COMP-3.
  3600         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3601         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3602                                   PIC S99V9(5) COMP-3.
  3603         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3604         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3605         16  CP-EXPIRE-DT          PIC XX.
  3606         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3607         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3608         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3609         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  64
* SOCK03.cbl
  3610         16  CP-DDF-SPEC-CALC      PIC X.
  3611             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3612             88  CP-CALC-CLP              VALUE 'C'.
  3613         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3614         16  CP-CANCEL-REASON      PIC X.
  3615         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3616         16  CP-PMT-MODE           PIC X.
  3617         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3618         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3619         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3620         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3621         16  FILLER                PIC X.
  3622
  3623***************    OUTPUT FROM ELRESV   ************************
  3624
  3625         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3626
  3627         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3628                                     COMP-3.
  3629         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3630                                     COMP-3.
  3631         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3632                                     COMP-3.
  3633         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3634                                     COMP-3.
  3635         16  FILLER                PIC X(09).
  3636***************    OUTPUT FROM ELRTRM   *************************
  3637
  3638         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3639                                     COMP-3.
  3640         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3641                                     COMP-3.
  3642         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3643                                     COMP-3.
  3644         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3645                                     COMP-3.
  3646         16  FILLER                PIC X(12).
  3647
  3648***************    OUTPUT FROM ELRAMT   *************************
  3649
  3650         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3651                                     COMP-3.
  3652         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3653                                     COMP-3.
  3654         16  FILLER                PIC X(12).
  3655
  3656***************    OUTPUT FROM ELRATE   *************************
  3657
  3658         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3659                                     COMP-3.
  3660         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-MORTALITY-CODE     PIC X(4).
  3663         16  CP-RATE-EDIT-FLAG     PIC X.
  3664             88  CP-RATES-NEED-APR                  VALUE '1'.
  3665         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  65
* SOCK03.cbl
  3668         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3669         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3670                                   PIC S9(7)V99 COMP-3.
  3671         16  FILLER                PIC X(07).
  3672
  3673***************    OUTPUT FROM ELRFND   *************************
  3674
  3675         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-REFUND-TYPE-USED   PIC X.
  3678           88  CP-R-AS-R78                         VALUE '1'.
  3679           88  CP-R-AS-PRORATA                     VALUE '2'.
  3680           88  CP-R-AS-CALIF                       VALUE '3'.
  3681           88  CP-R-AS-TEXAS                       VALUE '4'.
  3682           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3683           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3684           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3685           88  CP-R-AS-MEAN                        VALUE '8'.
  3686           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3687           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3688           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3689           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3690           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3691           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3692         16  FILLER                PIC X(12).
  3693
  3694***************    OUTPUT FROM ELEARN   *************************
  3695
  3696         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3697                                     COMP-3.
  3698         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3699                                     COMP-3.
  3700         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3701                                     COMP-3.
  3702         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3703                                     COMP-3.
  3704         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3705                                     COMP-3.
  3706         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-EARNING-TYPE-USED  PIC X.
  3709           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3710           88  CP-E-AS-R78                         VALUE '1'.
  3711           88  CP-E-AS-PRORATA                     VALUE '2'.
  3712           88  CP-E-AS-TEXAS                       VALUE '4'.
  3713           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3714           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3715           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3716           88  CP-E-AS-MEAN                        VALUE '8'.
  3717           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3718         16  FILLER                PIC X(12).
  3719
  3720***************    OUTPUT FROM ELPMNT   *************************
  3721
  3722         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3725                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  66
* SOCK03.cbl
  3726         16  FILLER                PIC X(12).
  3727
  3728***************   MISC WORK AREAS    *****************************
  3729         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3730                                     COMP-3.
  3731         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3732                                     COMP-3.
  3733         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3734                                     COMP-3.
  3735         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3736                                     COMP-3.
  3737         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3740                                     COMP-3.
  3741         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3742             88  OPEN-RATE-FILE                   VALUE 'O'.
  3743             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3744             88  IO-ERROR                         VALUE 'E'.
  3745
  3746         16  CP-FIRST-PAY-DATE     PIC XX.
  3747
  3748         16  CP-JOINT-INDICATOR    PIC X.
  3749
  3750         16  CP-RESERVE-REMAINING-TERM
  3751                                   PIC S9(4)V9    VALUE ZERO
  3752                                     COMP-3.
  3753
  3754         16  CP-INSURED-BIRTH-DT   PIC XX.
  3755
  3756         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3757                                     COMP-3.
  3758
  3759         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3760                                     COMP-3.
  3761
  3762         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3763                                     COMP-3.
  3764
  3765         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3766                                     COMP-3.
  3767
  3768         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3769                                     COMP-3.
  3770
  3771         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3772                                     COMP-3.
  3773
  3774         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3775                                     COMP-3.
  3776
  3777         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3778             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3779
  3780         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3783                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  67
* SOCK03.cbl
  3784         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3785         16  FILLER                PIC X(15).
  3786******************************************************************
  3787****************************************************************
  3788*
  3789* Copyright (c) 2007 by Clerity Solutions, Inc.
  3790* All rights reserved.
  3791*
  3792****************************************************************
  3793 01  DFHEIV.
  3794   02  DFHEIV0               PIC X(35).
  3795   02  DFHEIV1               PIC X(08).
  3796   02  DFHEIV2               PIC X(08).
  3797   02  DFHEIV3               PIC X(08).
  3798   02  DFHEIV4               PIC X(06).
  3799   02  DFHEIV5               PIC X(04).
  3800   02  DFHEIV6               PIC X(04).
  3801   02  DFHEIV7               PIC X(02).
  3802   02  DFHEIV8               PIC X(02).
  3803   02  DFHEIV9               PIC X(01).
  3804   02  DFHEIV10              PIC S9(7) COMP-3.
  3805   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3806   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3807   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3808   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3809   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3810   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3811   02  DFHEIV17              PIC X(04).
  3812   02  DFHEIV18              PIC X(04).
  3813   02  DFHEIV19              PIC X(04).
  3814   02  DFHEIV20              USAGE IS POINTER.
  3815   02  DFHEIV21              USAGE IS POINTER.
  3816   02  DFHEIV22              USAGE IS POINTER.
  3817   02  DFHEIV23              USAGE IS POINTER.
  3818   02  DFHEIV24              USAGE IS POINTER.
  3819   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3820   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3821   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3822   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3823   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3824   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3825   02  FILLER                PIC X(02).
  3826   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3827   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3828   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3829   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3830   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3831 LINKAGE  SECTION.
  3832*****************************************************************
  3833*                                                               *
  3834* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3835* All rights reserved.                                          *
  3836*                                                               *
  3837*****************************************************************
  3838 01  dfheiblk.
  3839     02  eibtime          pic s9(7) comp-3.
  3840     02  eibdate          pic s9(7) comp-3.
  3841     02  eibtrnid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  68
* SOCK03.cbl
  3842     02  eibtaskn         pic s9(7) comp-3.
  3843     02  eibtrmid         pic x(4).
  3844     02  dfheigdi         pic s9(4) comp.
  3845     02  eibcposn         pic s9(4) comp.
  3846     02  eibcalen         pic s9(4) comp.
  3847     02  eibaid           pic x(1).
  3848     02  eibfiller1       pic x(1).
  3849     02  eibfn            pic x(2).
  3850     02  eibfiller2       pic x(2).
  3851     02  eibrcode         pic x(6).
  3852     02  eibfiller3       pic x(2).
  3853     02  eibds            pic x(8).
  3854     02  eibreqid         pic x(8).
  3855     02  eibrsrce         pic x(8).
  3856     02  eibsync          pic x(1).
  3857     02  eibfree          pic x(1).
  3858     02  eibrecv          pic x(1).
  3859     02  eibsend          pic x(1).
  3860     02  eibatt           pic x(1).
  3861     02  eibeoc           pic x(1).
  3862     02  eibfmh           pic x(1).
  3863     02  eibcompl         pic x(1).
  3864     02  eibsig           pic x(1).
  3865     02  eibconf          pic x(1).
  3866     02  eiberr           pic x(1).
  3867     02  eibrldbk         pic x(1).
  3868     02  eiberrcd         pic x(4).
  3869     02  eibsynrb         pic x(1).
  3870     02  eibnodat         pic x(1).
  3871     02  eibfiller5       pic x(2).
  3872     02  eibresp          pic 9(09) comp.
  3873     02  eibresp2         pic 9(09) comp.
  3874     02  dfheigdj         pic s9(4) comp.
  3875     02  dfheigdk         pic s9(4) comp.
  3876 01  DFHCOMMAREA.
  3877   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3878   05 LSTN-NAME                PIC X(8).
  3879   05 LSTN-SUBNAME             PIC X(8).
  3880   05 CLIENT-IN-DATA.
  3881      15  CLIENT-CAR           PIC X.
  3882      15  CLIENT-GRP           PIC X(6).
  3883      15  CLIENT-STATE         PIC XX.
  3884      15  CLIENT-ACCOUNT       PIC X(10).
  3885*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  3886      15  CLIENT-EFF-DT        PIC X(8).
  3887      15  CLIENT-CERT-NO       PIC X(11).
  3888      15  CLIENT-LAST-NAME     PIC X(15).
  3889      15  CLIENT-FIRST-NAME    PIC X(10).
  3890      15  CLIENT-VAL-DT        PIC X(8).
  3891      15  CLIENT-CAN-REASON    PIC X.
  3892   05 SOCKADDR-IN-PARM.
  3893     15 SIN-FAMILY             PIC 9(4) COMP.
  3894     15 SIN-PORT               PIC 9(4) COMP.
  3895     15 SIN-ADDRESS            PIC 9(8) COMP.
  3896     15 SIN-ZERO               PIC X(8).
  3897 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3898 0000-DFHEXIT SECTION.
  3899     MOVE '9#                    $   ' TO DFHEIV0.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  69
* SOCK03.cbl
  3900     MOVE 'SOCK03' TO DFHEIV1.
  3901     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3902     display '  BEGIN SOCK03 '
  3903     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  3904     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  3905     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  3906        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  3907        IF CLIENT-IN-DATA (8:3) = 'AHL'
  3908           MOVE X'06'            TO WS-COMP-CD
  3909           MOVE 'AHL'            TO WS-SEND-BUF (5:3)
  3910                                    WS-COMP-ID
  3911        ELSE
  3912           IF CLIENT-IN-DATA (8:3) = 'DCC'
  3913              MOVE X'05'         TO WS-COMP-CD
  3914              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  3915                                    WS-COMP-ID
  3916           ELSE
  3917              MOVE X'04'         TO WS-COMP-CD
  3918              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  3919                                    WS-COMP-ID
  3920           END-IF
  3921        END-IF
  3922        move 'CSO'               to ws-send-buf (1:3)
  3923        move +25                 to ws-send-msg-size
  3924     END-IF
  3925     display 'SOCK03:sequence number  =', ws-seq-num.
  3926     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  3927     call "send" using by value GIVE-TAKE-SOCKET,
  3928         by reference ws-send-buf,
  3929         by value ws-send-msg-size,
  3930         by value ws-flags.
  3931     if return-code <= zero
  3932         display 'SOCK03:send error ',
  3933         go to socket-error.
  3934     move low-values to ws-recv-buf.
  3935     set ws-recv-total to zero.
  3936     compute ws-recv-left = ws-recv-msg-size.
  3937     display 'SOCK03:About to recv '
  3938     call "recv" using by value GIVE-TAKE-SOCKET,
  3939         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3940         by value ws-recv-left,
  3941         by value ws-flags.
  3942     if return-code < zero
  3943        display 'SOCK03:recv error ',
  3944        go to socket-error.
  3945     if return-code = zero
  3946        display 'SOCK03:client disconnected',
  3947        go to socket-error.
  3948*
  3949     display 'SOCK03:Good recv  '
  3950     display 'SOCK03:return code      = ', return-code
  3951     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  3952     move +4096                  to ws-send-msg-size
  3953*    move +750                   to ws-send-msg-size
  3954     move ws-recv-buf (1:72)     to client-in-data
  3955     MOVE SPACES                 TO WS-ELCERT-SW
  3956     MOVE X'0A'                  TO WS-HEX-0A
  3957     EVALUATE TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  70
* SOCK03.cbl
  3958        WHEN (CLIENT-CAR NOT = SPACES)
  3959           AND (CLIENT-STATE NOT = SPACES)
  3960           AND (CLIENT-ACCOUNT NOT = SPACES)
  3961           AND (CLIENT-EFF-DT NOT = SPACES)
  3962           AND (CLIENT-CERT-NO NOT = SPACES)
  3963           SET WS-ELCERT-FULL    TO TRUE
  3964           DISPLAY ' SETTING FULL '
  3965        WHEN (CLIENT-CERT-NO NOT = SPACES)
  3966           SET WS-ELCERT-CERT-NO TO TRUE
  3967           DISPLAY ' SETTING CERT NO '
  3968*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  3969*          AND (CLIENT-LAST-NAME NOT = SPACES)
  3970        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  3971           AND (CLIENT-LAST-NAME NOT = SPACES)
  3972           SET WS-ELCERT-ACT-NAME TO TRUE
  3973        WHEN CLIENT-LAST-NAME NOT = SPACES
  3974           SET WS-ELCERT-NAME    TO TRUE
  3975           DISPLAY ' SETTING NAME '
  3976        WHEN OTHER
  3977           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  3978           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  3979           MOVE ZEROS            TO WS-RESP
  3980           PERFORM 0030-BUILD-BUFFER
  3981                                 THRU 0030-EXIT
  3982           PERFORM 0020-SEND-BUFFER
  3983                                 THRU 0020-EXIT
  3984           PERFORM 0025-CLOSE-SOCKET
  3985                                 THRU 0025-EXIT
  3986           GO TO 0010-RETURN
  3987     END-EVALUATE
  3988     IF CLIENT-CAN-REASON = 'R'
  3989        MOVE 'R'                 TO WS-CANCEL-REASON
  3990     ELSE
  3991        MOVE ' '                 TO WS-CANCEL-REASON
  3992     END-IF
  3993     IF WS-ELCERT-KEY-SW NOT = SPACES
  3994        PERFORM 0050-BEGIN-REFUND-PROCESS
  3995                                 THRU 0050-EXIT
  3996     END-IF
  3997     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  3998     .
  3999 0010-RETURN.
  4000
  4001* exec cics return end-exec.
  4002*    MOVE '.(                    ''   #00003996' TO DFHEIV0
  4003     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4004     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4005     MOVE X'2020233030303033393936' TO DFHEIV0(25:11)
  4006     CALL 'kxdfhei1' USING DFHEIV0,
  4007           DFHEIV99,
  4008           DFHEIV99,
  4009           DFHEIV99,
  4010           DFHEIV99,
  4011           DFHEIV99,
  4012           DFHEIV99
  4013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4014
  4015
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  71
* SOCK03.cbl
  4016* goback.
  4017     MOVE '9%                    "   ' TO DFHEIV0
  4018     MOVE 'SOCK03' TO DFHEIV1
  4019     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4020     goback.
  4021*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4022     .
  4023 0020-SEND-BUFFER.
  4024     display 'SOCK03:About to send      '
  4025     display 'SOCK03:sequence number  =', ws-seq-num.
  4026     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  4027     call "send" using by value GIVE-TAKE-SOCKET,
  4028         by reference ws-send-buf,
  4029         by value ws-send-msg-size,
  4030         by value ws-flags.
  4031     if return-code <= zero
  4032         display 'SOCK03:send error ' return-code,
  4033         go to socket-error.
  4034 0020-EXIT.
  4035     EXIT.
  4036 0025-CLOSE-SOCKET.
  4037     display 'SOCK03:closing socket'.
  4038     call "close" using by value GIVE-TAKE-SOCKET .
  4039     display 'SOCK03:done'.
  4040     .
  4041 0025-EXIT.
  4042     EXIT.
  4043*
  4044* set up the receive buffer
  4045*
  4046     move low-values to ws-recv-buf.
  4047     set ws-recv-total to zero.
  4048     compute ws-recv-left = ws-recv-msg-size.
  4049*
  4050* receive data
  4051*
  4052 recv-1.
  4053     call "recv" using by value GIVE-TAKE-SOCKET,
  4054         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4055         by value ws-recv-left,
  4056         by value ws-flags.
  4057*
  4058* test what was received and decide what we should do
  4059*
  4060     if return-code < zero
  4061        display 'SOCK03:recv error ',
  4062        go to socket-error.
  4063     if return-code = zero
  4064        display 'SOCK03:client disconnected',
  4065        go to socket-error.
  4066*
  4067* have we received all the data yet?
  4068*
  4069     compute ws-recv-total = ws-recv-total + return-code.
  4070     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4071*
  4072* not yet
  4073*
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  72
* SOCK03.cbl
  4074     if ws-recv-left > 0 go to recv-1.
  4075*
  4076* received all the data
  4077*
  4078     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4079*
  4080* make sure what we received was what we sent
  4081*
  4082*    if ws-recv-buf <> ws-send-buf
  4083*        display "SOCK03:data doesn't match",
  4084*        go to socket-error.
  4085*
  4086* end of pass
  4087*
  4088*loop-end.
  4089*    if ws-seq-num = 5 go to socket-error.
  4090*    go to loop-1.
  4091*
  4092* program end
  4093*
  4094 socket-error.
  4095     if ws-seq-num <> 0
  4096         display "SOCK03:did not complete".
  4097*
  4098* flush the send buffer and deallocate
  4099*
  4100*    display 'SOCK03:closing socket'.
  4101*    call "close" using by value GIVE-TAKE-SOCKET .
  4102*
  4103* finised return to cics
  4104*
  4105 socket-fin.
  4106     display 'SOCK03:closing socket'.
  4107     call "close" using by value GIVE-TAKE-SOCKET .
  4108     display 'SOCK03:done'.
  4109
  4110* exec cics return end-exec.
  4111*    MOVE '.(                    ''   #00004086' TO DFHEIV0
  4112     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4114     MOVE X'2020233030303034303836' TO DFHEIV0(25:11)
  4115     CALL 'kxdfhei1' USING DFHEIV0,
  4116           DFHEIV99,
  4117           DFHEIV99,
  4118           DFHEIV99,
  4119           DFHEIV99,
  4120           DFHEIV99,
  4121           DFHEIV99
  4122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4123
  4124
  4125* goback.
  4126     MOVE '9%                    "   ' TO DFHEIV0
  4127     MOVE 'SOCK03' TO DFHEIV1
  4128     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4129     goback.
  4130 0030-BUILD-BUFFER.
  4131     MOVE SPACES                 TO WS-SEND-BUF
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  73
* SOCK03.cbl
  4132     IF WS-CALL-TYPE = 'NEWBUS'
  4133        STRING
  4134           WS-COMMENT            ';'
  4135           WS-RESP               ';'
  4136           WS-CARRIER            ';'
  4137           WS-GROUPING           ';'
  4138           WS-STATE              ';'
  4139           WS-ACCOUNT            ';'
  4140           WS-CERT-EFF-DATE      ';'
  4141           WS-CERT-NO            ';'
  4142           WS-LAST-NAME          ';'
  4143           WS-FIRST-NAME         ';'
  4144           WS-MID-INIT           ';'
  4145           WS-LAST-JNAME         ';'
  4146           WS-FIRST-JNAME        ';'
  4147           WS-MID-JINIT          ';'
  4148           WS-POST-CARD-SW       ';'
  4149           ws-lf-coverage-type   ';'
  4150           WS-LF-STATUS          ';'
  4151           WS-LF-BEN-CODE        ';'
  4152           WS-LF-BEN-CODE-DESC   ';'
  4153           WS-LF-TERM            ';'
  4154           WS-LF-REM-TERM        ';'
  4155           WS-LF-PREM            ';'
  4156           WS-LF-REFUND          ';'
  4157           WS-LF-METHOD          ';'
  4158           WS-LF-ORIG-BENEFIT    ';'
  4159           WS-LF-REM-BEN         ';'
  4160           WS-LF-EXPIRE-DATE     ';'
  4161           WS-LF-COMM            ';'
  4162           WS-LF-UEC             ';'
  4163           WS-AH-COVERAGE-TYPE   ';'
  4164           WS-AH-STATUS          ';'
  4165           WS-AH-BEN-CODE        ';'
  4166           WS-AH-BEN-CODE-DESC   ';'
  4167           WS-AH-TERM            ';'
  4168           WS-AH-REM-TERM        ';'
  4169           WS-AH-PREM            ';'
  4170           WS-AH-REFUND          ';'
  4171           WS-AH-METHOD          ';'
  4172           WS-AH-ORIG-BENEFIT    ';'
  4173           WS-AH-REM-BEN         ';'
  4174           WS-AH-EXPIRE-DATE     ';'
  4175           WS-AH-COMM            ';'
  4176           WS-AH-UEC             ';'
  4177           WS-ACCOUNT-NAME       ';'
  4178           WS-REPORT-CODE-1      ';'
  4179           WS-REPORT-CODE-2      ';'
  4180           WS-REPORT-CODE-3      ';'
  4181           WS-CLM-PAID-THRU-DT   ';'
  4182           WS-HEX-0A
  4183            DELIMITED BY '  ' INTO WS-SEND-BUF
  4184        END-STRING
  4185     ELSE
  4186        STRING
  4187           WS-COMMENT            ';'
  4188           WS-RESP               ';'
  4189           WS-CARRIER            ';'
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  74
* SOCK03.cbl
  4190           WS-GROUPING           ';'
  4191           WS-STATE              ';'
  4192           WS-ACCOUNT            ';'
  4193           WS-CERT-EFF-DATE      ';'
  4194           WS-CERT-NO            ';'
  4195           WS-LAST-NAME          ';'
  4196           WS-FIRST-NAME         ';'
  4197           WS-MID-INIT           ';'
  4198           WS-LAST-JNAME         ';'
  4199           WS-FIRST-JNAME        ';'
  4200           WS-MID-JINIT          ';'
  4201           WS-POST-CARD-SW       ';'
  4202           WS-LF-STATUS          ';'
  4203           WS-LF-BEN-CODE        ';'
  4204           WS-LF-BEN-CODE-DESC   ';'
  4205           WS-LF-TERM            ';'
  4206           WS-LF-REM-TERM        ';'
  4207           WS-LF-PREM            ';'
  4208           WS-LF-REFUND          ';'
  4209           WS-LF-METHOD          ';'
  4210           WS-LF-ORIG-BENEFIT    ';'
  4211           WS-LF-REM-BEN         ';'
  4212           WS-LF-EXPIRE-DATE     ';'
  4213           WS-LF-COMM            ';'
  4214           WS-LF-UEC             ';'
  4215           WS-AH-STATUS          ';'
  4216           WS-AH-BEN-CODE        ';'
  4217           WS-AH-BEN-CODE-DESC   ';'
  4218           WS-AH-TERM            ';'
  4219           WS-AH-REM-TERM        ';'
  4220           WS-AH-PREM            ';'
  4221           WS-AH-REFUND          ';'
  4222           WS-AH-METHOD          ';'
  4223           WS-AH-ORIG-BENEFIT    ';'
  4224           WS-AH-REM-BEN         ';'
  4225           WS-AH-EXPIRE-DATE     ';'
  4226           WS-AH-COMM            ';'
  4227           WS-AH-UEC             ';'
  4228           WS-ACCOUNT-NAME       ';'
  4229           WS-REPORT-CODE-1      ';'
  4230           WS-REPORT-CODE-2      ';'
  4231           WS-REPORT-CODE-3      ';'
  4232           WS-CLM-PAID-THRU-DT   ';'
  4233           'E'                   ';'
  4234            DELIMITED BY '  ' INTO WS-SEND-BUF
  4235        END-STRING
  4236     END-IF
  4237     .
  4238 0030-EXIT.
  4239     EXIT.
  4240 0050-BEGIN-REFUND-PROCESS.
  4241     IF WS-ELCERT-ACT-NAME
  4242        PERFORM 0060-FIND-FULL-KEY
  4243                                 THRU 0060-EXIT
  4244        MOVE AM-CARRIER          TO CLIENT-CAR
  4245        MOVE AM-GROUPING         TO CLIENT-GRP
  4246        MOVE AM-STATE            TO CLIENT-STATE
  4247     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  75
* SOCK03.cbl
  4248     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4249     IF NOT RESP-NORMAL
  4250        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4251        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4252        MOVE WS-RESPONSE         TO WS-RESP
  4253        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4254        PERFORM 0020-SEND-BUFFER
  4255                                 THRU 0020-EXIT
  4256        PERFORM 0025-CLOSE-SOCKET
  4257                                 THRU 0025-EXIT
  4258        GO TO 0010-RETURN
  4259     END-IF
  4260     PERFORM 0150-READ-NEXT-ELCERT
  4261                                 THRU 0150-EXIT
  4262*    display ' came back from 0150 ' ws-response
  4263     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4264        DISPLAY ' CERT NOT FOUND '
  4265        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4266        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4267        MOVE WS-RESPONSE         TO WS-RESP
  4268        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4269        PERFORM 0020-SEND-BUFFER
  4270                                 THRU 0020-EXIT
  4271        PERFORM 0025-CLOSE-SOCKET
  4272                                 THRU 0025-EXIT
  4273        GO TO 0010-RETURN
  4274     END-IF
  4275     PERFORM 0200-BEGIN-REFUND-PROCESS
  4276                                 THRU 0200-EXIT UNTIL
  4277        ELCERT-FINISHED
  4278     .
  4279 0050-EXIT.
  4280     EXIT.
  4281 0060-FIND-FULL-KEY.
  4282     MOVE ' ' TO WS-STOP-SW
  4283     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4284     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4285
  4286* EXEC CICS STARTBR
  4287*       DATASET  ('ERACCT3')
  4288*       RIDFLD   (WS-AM3-KEY)
  4289*       GTEQ
  4290*       RESP (WS-RESPONSE)
  4291*    END-EXEC
  4292     MOVE 'ERACCT3' TO DFHEIV1
  4293     MOVE 0
  4294       TO DFHEIV11
  4295*    MOVE '&,         G          &  N#00004243' TO DFHEIV0
  4296     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4297     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4298     MOVE X'204E233030303034323433' TO DFHEIV0(25:11)
  4299     CALL 'kxdfhei1' USING DFHEIV0,
  4300           DFHEIV1,
  4301           WS-AM3-KEY,
  4302           DFHEIV99,
  4303           DFHEIV11,
  4304           DFHEIV99
  4305     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  76
* SOCK03.cbl
  4306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4307     IF RESP-NORMAL
  4308        PERFORM UNTIL TOLD-TO-STOP
  4309
  4310* EXEC CICS READNEXT
  4311*             DATASET  ('ERACCT3')
  4312*             INTO     (ACCOUNT-MASTER)
  4313*             RIDFLD   (WS-AM3-KEY)
  4314*          END-EXEC
  4315     MOVE LENGTH OF
  4316      ACCOUNT-MASTER
  4317       TO DFHEIV12
  4318     MOVE 'ERACCT3' TO DFHEIV1
  4319     MOVE 0
  4320       TO DFHEIV11
  4321*    MOVE '&.IL                  )   #00004251' TO DFHEIV0
  4322     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4323     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4324     MOVE X'2020233030303034323531' TO DFHEIV0(25:11)
  4325     CALL 'kxdfhei1' USING DFHEIV0,
  4326           DFHEIV1,
  4327           ACCOUNT-MASTER,
  4328           DFHEIV12,
  4329           WS-AM3-KEY,
  4330           DFHEIV99,
  4331           DFHEIV11,
  4332           DFHEIV99,
  4333           DFHEIV99
  4334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4335           EVALUATE TRUE
  4336              WHEN (RESP-NORMAL)
  4337                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4338                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4339                 SET TOLD-TO-STOP TO TRUE
  4340              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4341                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4342                 CONTINUE
  4343              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4344                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4345                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4346                 MOVE ZEROS      TO WS-RESP
  4347                 PERFORM 0030-BUILD-BUFFER
  4348                                 THRU 0030-EXIT
  4349                 PERFORM 0020-SEND-BUFFER
  4350                                 THRU 0020-EXIT
  4351                 PERFORM 0025-CLOSE-SOCKET
  4352                                 THRU 0025-EXIT
  4353                 GO TO 0010-RETURN
  4354           END-EVALUATE
  4355        END-PERFORM
  4356
  4357* EXEC CICS ENDBR
  4358*          DATASET   ('ERACCT3')
  4359*       END-EXEC
  4360     MOVE 'ERACCT3' TO DFHEIV1
  4361     MOVE 0
  4362       TO DFHEIV11
  4363*    MOVE '&2                    $   #00004277' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  77
* SOCK03.cbl
  4364     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4365     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4366     MOVE X'2020233030303034323737' TO DFHEIV0(25:11)
  4367     CALL 'kxdfhei1' USING DFHEIV0,
  4368           DFHEIV1,
  4369           DFHEIV11,
  4370           DFHEIV99
  4371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4372     ELSE
  4373        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4374        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4375        MOVE ZEROS      TO WS-RESP
  4376        PERFORM 0030-BUILD-BUFFER
  4377                                 THRU 0030-EXIT
  4378        PERFORM 0020-SEND-BUFFER
  4379                                 THRU 0020-EXIT
  4380        PERFORM 0025-CLOSE-SOCKET
  4381                                 THRU 0025-EXIT
  4382        GO TO 0010-RETURN
  4383     END-IF
  4384     .
  4385 0060-EXIT.
  4386     EXIT.
  4387 0100-START-ELCERT.
  4388*    DISPLAY ' MADE 0100 START '
  4389     MOVE SPACES                 TO WS-SEND-BUF
  4390     INITIALIZE WS-STRING-DATA
  4391     MOVE LOW-VALUES             TO WS-CM-KEY
  4392                                    WS-CM-KEY-A1
  4393                                    WS-CM-KEY-A4
  4394     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4395                                    WS-CM-COMPANY-CD-A1
  4396                                    WS-CM-COMPANY-CD-A4
  4397     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4398     MOVE 'L'                    TO DC-OPTION-CODE
  4399     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4400     IF NO-CONVERSION-ERROR
  4401        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4402     ELSE
  4403        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4404        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4405        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4406        PERFORM 0020-SEND-BUFFER
  4407                                 THRU 0020-EXIT
  4408        PERFORM 0025-CLOSE-SOCKET
  4409                                 THRU 0025-EXIT
  4410        GO TO 0010-RETURN
  4411     END-IF
  4412     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4413        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4414        MOVE 'L'                 TO DC-OPTION-CODE
  4415        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4416        IF NO-CONVERSION-ERROR
  4417           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4418        ELSE
  4419           MOVE 'BAD EFF DT CONVERT '
  4420                                 TO WS-COMMENT
  4421           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  78
* SOCK03.cbl
  4422           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4423           PERFORM 0020-SEND-BUFFER
  4424                                 THRU 0020-EXIT
  4425           PERFORM 0025-CLOSE-SOCKET
  4426                                 THRU 0025-EXIT
  4427           GO TO 0010-RETURN
  4428        END-IF
  4429     END-IF
  4430     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4431        (F1 > +10)
  4432        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4433     END-PERFORM
  4434     IF F1 > +1
  4435        SUBTRACT +1 FROM F1
  4436     END-IF
  4437     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4438        (L1 > +15)
  4439        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4440     END-PERFORM
  4441     IF L1 > +1
  4442        SUBTRACT +1 FROM L1
  4443     END-IF
  4444     EVALUATE TRUE
  4445        WHEN WS-ELCERT-FULL
  4446           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4447           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4448           MOVE CLIENT-STATE        TO WS-CM-STATE
  4449           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4450           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4451           MOVE CLIENT-CERT-NO (1:10)
  4452                                    TO WS-CM-CERT-NO
  4453
  4454* EXEC CICS READ
  4455*             INTO    (CERTIFICATE-MASTER)
  4456*             DATASET ('ELCERT')
  4457*             RIDFLD  (WS-CM-KEY)
  4458*             RESP    (WS-RESPONSE)
  4459*          END-EXEC
  4460     MOVE LENGTH OF
  4461      CERTIFICATE-MASTER
  4462       TO DFHEIV11
  4463     MOVE 'ELCERT' TO DFHEIV1
  4464*    MOVE '&"IL       E          (  N#00004361' TO DFHEIV0
  4465     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4466     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4467     MOVE X'204E233030303034333631' TO DFHEIV0(25:11)
  4468     CALL 'kxdfhei1' USING DFHEIV0,
  4469           DFHEIV1,
  4470           CERTIFICATE-MASTER,
  4471           DFHEIV11,
  4472           WS-CM-KEY,
  4473           DFHEIV99,
  4474           DFHEIV99,
  4475           DFHEIV99
  4476     MOVE EIBRESP  TO WS-RESPONSE
  4477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4478        WHEN WS-ELCERT-ACT-NAME
  4479           MOVE CLIENT-CAR          TO WS-CM-CARRIER
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  79
* SOCK03.cbl
  4480           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4481           MOVE CLIENT-STATE        TO WS-CM-STATE
  4482           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4483           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4484           MOVE ZEROS               TO WS-CM-CERT-NO
  4485
  4486* EXEC CICS STARTBR
  4487*             DATASET ('ELCERT')
  4488*             RIDFLD  (WS-CM-KEY)
  4489*             RESP    (WS-RESPONSE)
  4490*          END-EXEC
  4491     MOVE 'ELCERT' TO DFHEIV1
  4492     MOVE 0
  4493       TO DFHEIV11
  4494*    MOVE '&,         G          &  N#00004374' TO DFHEIV0
  4495     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4496     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4497     MOVE X'204E233030303034333734' TO DFHEIV0(25:11)
  4498     CALL 'kxdfhei1' USING DFHEIV0,
  4499           DFHEIV1,
  4500           WS-CM-KEY,
  4501           DFHEIV99,
  4502           DFHEIV11,
  4503           DFHEIV99
  4504     MOVE EIBRESP  TO WS-RESPONSE
  4505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4506        WHEN WS-ELCERT-NAME
  4507           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4508           MOVE SPACES           TO WS-CM-INITIALS
  4509           COMPUTE WS-LENGTH = L1 + +1
  4510
  4511* EXEC CICS STARTBR
  4512*             DATASET   ('ELCERT2')
  4513*             RIDFLD    (WS-CM-KEY-A1)
  4514*             GENERIC
  4515*             KEYLENGTH (WS-LENGTH)
  4516*             GTEQ
  4517*             RESP      (WS-RESPONSE)
  4518*          END-EXEC
  4519     MOVE 'ELCERT2' TO DFHEIV1
  4520     MOVE 0
  4521       TO DFHEIV11
  4522*    MOVE '&,   KG    G          &  N#00004383' TO DFHEIV0
  4523     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4524     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4525     MOVE X'204E233030303034333833' TO DFHEIV0(25:11)
  4526     CALL 'kxdfhei1' USING DFHEIV0,
  4527           DFHEIV1,
  4528           WS-CM-KEY-A1,
  4529           WS-LENGTH,
  4530           DFHEIV11,
  4531           DFHEIV99
  4532     MOVE EIBRESP  TO WS-RESPONSE
  4533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4534*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4535*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4536        WHEN WS-ELCERT-CERT-NO
  4537* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  80
* SOCK03.cbl
  4538           MOVE +11 TO WS-LENGTH
  4539           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4540
  4541* EXEC CICS STARTBR
  4542*             DATASET   ('ELCERT5')
  4543*             RIDFLD    (WS-CM-KEY-A4)
  4544*             GENERIC
  4545*             KEYLENGTH (WS-LENGTH)
  4546*             GTEQ
  4547*             RESP      (WS-RESPONSE)
  4548*          END-EXEC
  4549     MOVE 'ELCERT5' TO DFHEIV1
  4550     MOVE 0
  4551       TO DFHEIV11
  4552*    MOVE '&,   KG    G          &  N#00004397' TO DFHEIV0
  4553     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4554     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4555     MOVE X'204E233030303034333937' TO DFHEIV0(25:11)
  4556     CALL 'kxdfhei1' USING DFHEIV0,
  4557           DFHEIV1,
  4558           WS-CM-KEY-A4,
  4559           WS-LENGTH,
  4560           DFHEIV11,
  4561           DFHEIV99
  4562     MOVE EIBRESP  TO WS-RESPONSE
  4563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4564     END-EVALUATE
  4565     .
  4566 0100-EXIT.
  4567     EXIT.
  4568 0150-READ-NEXT-ELCERT.
  4569*    DISPLAY ' MADE 0150 NEXT '
  4570     EVALUATE TRUE
  4571        WHEN WS-ELCERT-ACT-NAME
  4572*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4573
  4574* EXEC CICS READNEXT
  4575*             DATASET   ('ELCERT')
  4576*             RIDFLD    (WS-CM-KEY)
  4577*             INTO      (CERTIFICATE-MASTER)
  4578*             RESP      (WS-RESPONSE)
  4579*          END-EXEC
  4580     MOVE LENGTH OF
  4581      CERTIFICATE-MASTER
  4582       TO DFHEIV12
  4583     MOVE 'ELCERT' TO DFHEIV1
  4584     MOVE 0
  4585       TO DFHEIV11
  4586*    MOVE '&.IL                  )  N#00004414' TO DFHEIV0
  4587     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4588     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4589     MOVE X'204E233030303034343134' TO DFHEIV0(25:11)
  4590     CALL 'kxdfhei1' USING DFHEIV0,
  4591           DFHEIV1,
  4592           CERTIFICATE-MASTER,
  4593           DFHEIV12,
  4594           WS-CM-KEY,
  4595           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  81
* SOCK03.cbl
  4596           DFHEIV11,
  4597           DFHEIV99,
  4598           DFHEIV99
  4599     MOVE EIBRESP  TO WS-RESPONSE
  4600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4601        WHEN WS-ELCERT-NAME
  4602*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4603
  4604* EXEC CICS READNEXT
  4605*             DATASET   ('ELCERT2')
  4606*             RIDFLD    (WS-CM-KEY-A1)
  4607*             INTO      (CERTIFICATE-MASTER)
  4608*             RESP      (WS-RESPONSE)
  4609*          END-EXEC
  4610     MOVE LENGTH OF
  4611      CERTIFICATE-MASTER
  4612       TO DFHEIV12
  4613     MOVE 'ELCERT2' TO DFHEIV1
  4614     MOVE 0
  4615       TO DFHEIV11
  4616*    MOVE '&.IL                  )  N#00004422' TO DFHEIV0
  4617     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4618     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4619     MOVE X'204E233030303034343232' TO DFHEIV0(25:11)
  4620     CALL 'kxdfhei1' USING DFHEIV0,
  4621           DFHEIV1,
  4622           CERTIFICATE-MASTER,
  4623           DFHEIV12,
  4624           WS-CM-KEY-A1,
  4625           DFHEIV99,
  4626           DFHEIV11,
  4627           DFHEIV99,
  4628           DFHEIV99
  4629     MOVE EIBRESP  TO WS-RESPONSE
  4630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4631        WHEN WS-ELCERT-CERT-NO
  4632
  4633* EXEC CICS READNEXT
  4634*             DATASET   ('ELCERT5')
  4635*             RIDFLD    (WS-CM-KEY-A4)
  4636*             INTO      (CERTIFICATE-MASTER)
  4637*             RESP      (WS-RESPONSE)
  4638*          END-EXEC
  4639     MOVE LENGTH OF
  4640      CERTIFICATE-MASTER
  4641       TO DFHEIV12
  4642     MOVE 'ELCERT5' TO DFHEIV1
  4643     MOVE 0
  4644       TO DFHEIV11
  4645*    MOVE '&.IL                  )  N#00004429' TO DFHEIV0
  4646     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4647     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4648     MOVE X'204E233030303034343239' TO DFHEIV0(25:11)
  4649     CALL 'kxdfhei1' USING DFHEIV0,
  4650           DFHEIV1,
  4651           CERTIFICATE-MASTER,
  4652           DFHEIV12,
  4653           WS-CM-KEY-A4,
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  82
* SOCK03.cbl
  4654           DFHEIV99,
  4655           DFHEIV11,
  4656           DFHEIV99,
  4657           DFHEIV99
  4658     MOVE EIBRESP  TO WS-RESPONSE
  4659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4660     END-EVALUATE
  4661     .
  4662 0150-EXIT.
  4663     EXIT.
  4664 0200-BEGIN-REFUND-PROCESS.
  4665*    DISPLAY ' MADE 0200 BEGIN '
  4666     MOVE SPACES                 TO WS-BUFF-SENT-SW
  4667                                    WS-ERACCT-SW
  4668     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  4669                                    WS-NCB-DIFF-ODD-DAYS
  4670     INITIALIZE WS-STRING-DATA
  4671     IF RESP-NORMAL OR RESP-DUPKEY
  4672        EVALUATE TRUE
  4673           WHEN WS-ELCERT-ACT-NAME
  4674              EVALUATE TRUE
  4675                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  4676                    OR (CM-CARRIER NOT = CLIENT-CAR)
  4677                    OR (CM-GROUPING NOT = CLIENT-GRP)
  4678                    OR (CM-STATE NOT = CLIENT-STATE)
  4679                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  4680                    SET ELCERT-FINISHED TO TRUE
  4681                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  4682                    CLIENT-LAST-NAME (1:L1))
  4683                    GO TO 0200-CONTINUE
  4684                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  4685                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4686                    GO TO 0200-CONTINUE
  4687                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  4688                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4689                     CLIENT-FIRST-NAME (1:F1)))
  4690                    GO TO 0200-CONTINUE
  4691                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  4692                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4693                    GO TO 0200-CONTINUE
  4694              END-EVALUATE
  4695           WHEN WS-ELCERT-CERT-NO
  4696              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4697                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  4698                 SET ELCERT-FINISHED TO TRUE
  4699              ELSE
  4700                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4701                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4702                              OR
  4703                    ((CLIENT-LAST-NAME NOT = SPACES)
  4704                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  4705                        CLIENT-LAST-NAME (1:L1)))
  4706                              OR
  4707                    ((CLIENT-FIRST-NAME NOT = SPACES)
  4708                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4709                        CLIENT-FIRST-NAME (1:F1)))
  4710                              OR
  4711                    ((CLIENT-ACCOUNT NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  83
* SOCK03.cbl
  4712                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4713                     GO TO 0200-CONTINUE
  4714                 END-IF
  4715              END-IF
  4716           WHEN WS-ELCERT-NAME
  4717              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4718                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  4719                    CLIENT-LAST-NAME (1:L1))
  4720                  SET ELCERT-FINISHED TO TRUE
  4721              ELSE
  4722                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4723                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4724                           OR
  4725                 ((CLIENT-FIRST-NAME NOT = SPACES)
  4726                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4727                     CLIENT-FIRST-NAME (1:F1)))
  4728                           OR
  4729                 ((CLIENT-ACCOUNT NOT = SPACES)
  4730                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4731                  GO TO 0200-CONTINUE
  4732                 END-IF
  4733              END-IF
  4734           WHEN OTHER
  4735              SET ELCERT-FINISHED   TO TRUE
  4736        END-EVALUATE
  4737     ELSE
  4738        SET ELCERT-FINISHED TO TRUE
  4739     END-IF
  4740*       IF WS-ELCERT-CERT-NO
  4741*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4742*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  4743*                          OR
  4744*                ((CLIENT-EFF-DT NOT = SPACES)
  4745*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4746*                          OR
  4747*                ((CLIENT-LAST-NAME NOT = SPACES)
  4748*                 AND (CM-INSURED-LAST-NAME NOT =
  4749*                    CLIENT-LAST-NAME))
  4750*                 SET ELCERT-FINISHED TO TRUE
  4751*          END-IF
  4752*          IF WS-ELCERT-NAME
  4753*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4754*                OR (CM-INSURED-LAST-NAME NOT =
  4755*                   CLIENT-LAST-NAME)
  4756*                            OR
  4757*                ((CLIENT-EFF-DT NOT = SPACES)
  4758*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4759*                 SET ELCERT-FINISHED TO TRUE
  4760*             END-IF
  4761*          ELSE
  4762*             SET ELCERT-FINISHED   TO TRUE
  4763*          END-IF
  4764     IF NOT WS-ELCERT-FULL
  4765        IF ELCERT-FINISHED
  4766           GO TO 0200-EXIT
  4767        END-IF
  4768     END-IF
  4769     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  84
* SOCK03.cbl
  4770        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  4771        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4772        PERFORM 0030-BUILD-BUFFER
  4773                                 THRU 0030-EXIT
  4774        PERFORM 0020-SEND-BUFFER
  4775                                 THRU 0020-EXIT
  4776        GO TO 0200-CONTINUE
  4777     END-IF
  4778     PERFORM 0300-GET-ELCNTL-RECORDS
  4779                                 THRU 0300-EXIT
  4780     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  4781     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  4782     MOVE +0                     TO DC-ELAPSED-MONTHS
  4783                                    DC-ELAPSED-DAYS
  4784     MOVE '1'                    TO DC-OPTION-CODE
  4785     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4786     IF NO-CONVERSION-ERROR
  4787        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  4788        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  4789     END-IF
  4790     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  4791     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  4792     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4793     IF NOT ALREADY-SENT
  4794        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  4795     END-IF
  4796     .
  4797 0200-CONTINUE.
  4798     PERFORM 0150-READ-NEXT-ELCERT
  4799                                 THRU 0150-EXIT
  4800     .
  4801 0200-EXIT.
  4802     EXIT.
  4803 0300-GET-ELCNTL-RECORDS.
  4804     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  4805     IF NOT RESP-NORMAL
  4806        MOVE ' COMPANY RECORD NOT FOUND '
  4807                                 TO WS-COMMENT
  4808        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4809        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4810        PERFORM 0020-SEND-BUFFER
  4811                                 THRU 0020-EXIT
  4812        PERFORM 0025-CLOSE-SOCKET
  4813                                 THRU 0025-EXIT
  4814        GO TO 0010-RETURN
  4815     END-IF
  4816     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  4817        PERFORM 0320-GET-LIFE-RECORD
  4818                                 THRU 0320-EXIT
  4819        IF NOT RESP-NORMAL
  4820           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  4821                                 TO WS-COMMENT
  4822           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4823           PERFORM 0030-BUILD-BUFFER
  4824                                 THRU 0030-EXIT
  4825           PERFORM 0020-SEND-BUFFER
  4826                                 THRU 0020-EXIT
  4827           PERFORM 0025-CLOSE-SOCKET
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  85
* SOCK03.cbl
  4828                                 THRU 0025-EXIT
  4829           GO TO 0010-RETURN
  4830        END-IF
  4831     END-IF
  4832     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  4833        PERFORM 0330-GET-AH-RECORD
  4834                                 THRU 0330-EXIT
  4835        IF NOT RESP-NORMAL
  4836           MOVE ' AH BENEFIT RECORD NOT FOUND '
  4837                                 TO WS-COMMENT
  4838           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4839           PERFORM 0030-BUILD-BUFFER
  4840                                 THRU 0030-EXIT
  4841           PERFORM 0020-SEND-BUFFER
  4842                                 THRU 0020-EXIT
  4843           PERFORM 0025-CLOSE-SOCKET
  4844                                 THRU 0025-EXIT
  4845           GO TO 0010-RETURN
  4846        END-IF
  4847     END-IF
  4848     PERFORM 0340-GET-STATE-RECORD
  4849                                 THRU 0340-EXIT
  4850     IF NOT RESP-NORMAL
  4851        MOVE ' STATE RECORD NOT FOUND '
  4852                                 TO WS-COMMENT
  4853        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4854        PERFORM 0030-BUILD-BUFFER
  4855                                 THRU 0030-EXIT
  4856        PERFORM 0020-SEND-BUFFER
  4857                                 THRU 0020-EXIT
  4858        PERFORM 0025-CLOSE-SOCKET
  4859                                 THRU 0025-EXIT
  4860        GO TO 0010-RETURN
  4861     END-IF
  4862     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  4863     IF NOT ERACCT-FOUND
  4864        MOVE ' ACCOUNT NOT FOUND '
  4865                                 TO WS-COMMENT
  4866        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4867        PERFORM 0030-BUILD-BUFFER
  4868                                 THRU 0030-EXIT
  4869        PERFORM 0020-SEND-BUFFER
  4870                                 THRU 0020-EXIT
  4871        PERFORM 0025-CLOSE-SOCKET
  4872                                 THRU 0025-EXIT
  4873        GO TO 0010-RETURN
  4874     ELSE
  4875        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  4876        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  4877        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  4878        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  4879     END-IF
  4880     .
  4881 0300-EXIT.
  4882     EXIT.
  4883 0310-GET-COMPANY.
  4884     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  4885     MOVE '1'                    TO  WS-CF-RECORD-TYPE
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  86
* SOCK03.cbl
  4886     MOVE SPACES                 TO  WS-CF-ACCESS
  4887     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  4888
  4889* EXEC CICS READ
  4890*       INTO    (CONTROL-FILE)
  4891*       DATASET ('ELCNTL')
  4892*       RIDFLD  (WS-CF-KEY)
  4893*       RESP    (WS-RESPONSE)
  4894*    END-EXEC
  4895     MOVE LENGTH OF
  4896      CONTROL-FILE
  4897       TO DFHEIV11
  4898     MOVE 'ELCNTL' TO DFHEIV1
  4899*    MOVE '&"IL       E          (  N#00004663' TO DFHEIV0
  4900     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4901     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4902     MOVE X'204E233030303034363633' TO DFHEIV0(25:11)
  4903     CALL 'kxdfhei1' USING DFHEIV0,
  4904           DFHEIV1,
  4905           CONTROL-FILE,
  4906           DFHEIV11,
  4907           WS-CF-KEY,
  4908           DFHEIV99,
  4909           DFHEIV99,
  4910           DFHEIV99
  4911     MOVE EIBRESP  TO WS-RESPONSE
  4912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4913     IF (RESP-NORMAL)
  4914        AND (CF-COMPANY-ID = WS-COMP-ID)
  4915        AND (CF-RECORD-TYPE = '1')
  4916        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  4917        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  4918        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  4919        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  4920        IF CF-DEFAULT-APR NUMERIC
  4921           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  4922        ELSE
  4923           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  4924        END-IF
  4925        IF CF-VALID-REM-TRM-OPTION
  4926           MOVE CF-REM-TRM-CALC-OPTION
  4927                                 TO WS-CF-REM-TRM-CALC-OPTION
  4928        ELSE
  4929           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  4930        END-IF
  4931     END-IF
  4932     .
  4933 0310-EXIT.
  4934     EXIT.
  4935 0320-GET-LIFE-RECORD.
  4936     MOVE '4'                    TO WS-CF-RECORD-TYPE
  4937     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4938                                    WS-LF-BEN-CODE
  4939     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4940
  4941* EXEC CICS READ
  4942*       INTO    (CONTROL-FILE)
  4943*       DATASET ('ELCNTL')
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  87
* SOCK03.cbl
  4944*       RIDFLD  (WS-CF-KEY)
  4945*       GTEQ
  4946*       RESP    (WS-RESPONSE)
  4947*    END-EXEC
  4948     MOVE LENGTH OF
  4949      CONTROL-FILE
  4950       TO DFHEIV11
  4951     MOVE 'ELCNTL' TO DFHEIV1
  4952*    MOVE '&"IL       G          (  N#00004696' TO DFHEIV0
  4953     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4955     MOVE X'204E233030303034363936' TO DFHEIV0(25:11)
  4956     CALL 'kxdfhei1' USING DFHEIV0,
  4957           DFHEIV1,
  4958           CONTROL-FILE,
  4959           DFHEIV11,
  4960           WS-CF-KEY,
  4961           DFHEIV99,
  4962           DFHEIV99,
  4963           DFHEIV99
  4964     MOVE EIBRESP  TO WS-RESPONSE
  4965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4966     IF RESP-NORMAL
  4967        AND (CF-COMPANY-ID  = WS-COMP-ID)
  4968        AND (CF-RECORD-TYPE = '4')
  4969        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4970           (S1 > +8)
  4971           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  4972        END-PERFORM
  4973        IF S1 > +8
  4974           CONTINUE
  4975        ELSE
  4976           MOVE CF-BENEFIT-DESCRIP (S1)
  4977                                 TO WS-LF-BEN-CODE-DESC
  4978           MOVE CF-LF-COVERAGE-TYPE (S1)
  4979                                 TO WS-CF-LF-COVERAGE-TYPE
  4980           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  4981              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  4982           ELSE
  4983              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  4984           END-IF
  4985           IF CF-CO-REM-TERM-CALC (S1) > '0'
  4986               MOVE CF-CO-REM-TERM-CALC (S1)
  4987                                 TO WS-LF-CO-REM-TERM-CALC
  4988           END-IF
  4989           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  4990               MOVE CF-CO-EARNINGS-CALC (S1)
  4991                                 TO WS-LF-CO-EARNINGS-CALC
  4992                                    WS-LF-CO-REFUND-CALC
  4993           END-IF
  4994           IF CF-SPECIAL-CALC-CD (S1) > ' '
  4995               MOVE CF-SPECIAL-CALC-CD (S1)
  4996                                 TO WS-LF-SPECIAL-CALC-CD
  4997           END-IF
  4998           IF CF-CO-REFUND-CALC (S1) > '0'
  4999               MOVE CF-CO-REFUND-CALC (S1)
  5000                                 TO WS-LF-CO-REFUND-CALC
  5001        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  88
* SOCK03.cbl
  5002     END-IF
  5003     .
  5004 0320-EXIT.
  5005     EXIT.
  5006 0330-GET-AH-RECORD.
  5007     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5008     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5009     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5010
  5011* EXEC CICS READ
  5012*       INTO    (CONTROL-FILE)
  5013*       DATASET ('ELCNTL')
  5014*       RIDFLD  (WS-CF-KEY)
  5015*       GTEQ
  5016*       RESP    (WS-RESPONSE)
  5017*    END-EXEC
  5018     MOVE LENGTH OF
  5019      CONTROL-FILE
  5020       TO DFHEIV11
  5021     MOVE 'ELCNTL' TO DFHEIV1
  5022*    MOVE '&"IL       G          (  N#00004747' TO DFHEIV0
  5023     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5024     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5025     MOVE X'204E233030303034373437' TO DFHEIV0(25:11)
  5026     CALL 'kxdfhei1' USING DFHEIV0,
  5027           DFHEIV1,
  5028           CONTROL-FILE,
  5029           DFHEIV11,
  5030           WS-CF-KEY,
  5031           DFHEIV99,
  5032           DFHEIV99,
  5033           DFHEIV99
  5034     MOVE EIBRESP  TO WS-RESPONSE
  5035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5036     IF RESP-NORMAL
  5037        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5038        AND (CF-RECORD-TYPE = '5')
  5039        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5040           (S1 > +8)
  5041           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5042        END-PERFORM
  5043        IF S1 > +8
  5044           CONTINUE
  5045        ELSE
  5046           MOVE CF-BENEFIT-DESCRIP (S1)
  5047                                 TO WS-AH-BEN-CODE-DESC
  5048           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5049              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5050           ELSE
  5051              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5052           END-IF
  5053           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5054              MOVE CF-CO-REM-TERM-CALC (S1)
  5055                                 TO WS-AH-CO-REM-TERM-CALC
  5056           END-IF
  5057           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5058              MOVE CF-CO-EARNINGS-CALC (S1)
  5059                                 TO WS-AH-CO-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  89
* SOCK03.cbl
  5060                                    WS-AH-CO-REFUND-CALC
  5061           END-IF
  5062           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5063              MOVE CF-SPECIAL-CALC-CD (S1)
  5064                                 TO WS-AH-SPECIAL-CALC-CD
  5065           END-IF
  5066           IF CF-CO-REFUND-CALC (S1) > '0'
  5067              MOVE CF-CO-REFUND-CALC (S1)
  5068                                 TO WS-AH-CO-REFUND-CALC
  5069           END-IF
  5070           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5071              MOVE CF-BENEFIT-CATEGORY (S1)
  5072                                 TO WS-AH-BEN-CATEGORY
  5073           END-IF
  5074        END-IF
  5075     END-IF
  5076     .
  5077 0330-EXIT.
  5078     EXIT.
  5079 0340-GET-STATE-RECORD.
  5080     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5081     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5082     MOVE CM-STATE               TO WS-CF-ACCESS
  5083     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5084
  5085* EXEC CICS READ
  5086*       INTO    (CONTROL-FILE)
  5087*       DATASET ('ELCNTL')
  5088*       RIDFLD  (WS-CF-KEY)
  5089*       RESP    (WS-RESPONSE)
  5090*    END-EXEC
  5091     MOVE LENGTH OF
  5092      CONTROL-FILE
  5093       TO DFHEIV11
  5094     MOVE 'ELCNTL' TO DFHEIV1
  5095*    MOVE '&"IL       E          (  N#00004802' TO DFHEIV0
  5096     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5097     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5098     MOVE X'204E233030303034383032' TO DFHEIV0(25:11)
  5099     CALL 'kxdfhei1' USING DFHEIV0,
  5100           DFHEIV1,
  5101           CONTROL-FILE,
  5102           DFHEIV11,
  5103           WS-CF-KEY,
  5104           DFHEIV99,
  5105           DFHEIV99,
  5106           DFHEIV99
  5107     MOVE EIBRESP  TO WS-RESPONSE
  5108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5109     IF (RESP-NORMAL)
  5110        AND (CF-COMPANY-ID = WS-COMP-ID)
  5111        AND (CF-RECORD-TYPE = '3')
  5112        AND (CF-STATE-CODE = CM-STATE)
  5113        MOVE CF-ST-FREE-LOOK-PERIOD
  5114                                 TO WS-FREE-LOOK
  5115        MOVE CF-STATE-ABBREVIATION
  5116                                 TO WS-STATE-ABBREVIATION
  5117        MOVE CF-ST-FST-PMT-DAYS-CHG
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  90
* SOCK03.cbl
  5118                                 TO  WS-STATE-EXT-DAYS-CHG
  5119        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5120           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5121           IF CF-ST-RT-CALC NOT = SPACES
  5122              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5123           END-IF
  5124           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5125              IF CF-ST-RF-LR-CALC > '0'
  5126                 MOVE CF-ST-RF-LR-CALC
  5127                                 TO WS-LF-ST-REFUND-CALC
  5128              END-IF
  5129              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5130                 IF CF-ST-RF-LN-CALC > '0'
  5131                    MOVE CF-ST-RF-LN-CALC
  5132                                 TO WS-LF-ST-REFUND-CALC
  5133                 END-IF
  5134              END-IF
  5135           ELSE
  5136              IF CF-ST-RF-LL-CALC > '0'
  5137                 MOVE CF-ST-RF-LL-CALC
  5138                                 TO WS-LF-ST-REFUND-CALC
  5139              END-IF
  5140           END-IF
  5141           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5142              (S1 > 50)
  5143              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5144                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5145           END-PERFORM
  5146           IF S1 < +51
  5147              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5148                 MOVE CF-ST-REM-TERM-CALC (S1)
  5149                                 TO WS-LF-ST-REM-TERM-CALC
  5150              END-IF
  5151              IF CF-ST-REFUND-CALC (S1) > '0'
  5152                 MOVE CF-ST-REFUND-CALC (S1)
  5153                                 TO WS-LF-ST-REFUND-CALC
  5154              END-IF
  5155           END-IF
  5156        END-IF
  5157        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5158           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5159           IF CF-ST-RT-CALC NOT = SPACES
  5160              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5161           END-IF
  5162           IF CF-ST-RF-AH-CALC > '0'
  5163              MOVE CF-ST-RF-AH-CALC
  5164                                 TO WS-AH-ST-REFUND-CALC
  5165           END-IF
  5166           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5167              IF CF-ST-RF-CP-CALC > '0'
  5168                 MOVE CF-ST-RF-CP-CALC
  5169                                 TO WS-AH-ST-REFUND-CALC
  5170              END-IF
  5171           END-IF
  5172           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5173              (S1 > 50)
  5174              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5175                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  91
* SOCK03.cbl
  5176           END-PERFORM
  5177           IF S1 < +51
  5178              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5179                 MOVE CF-ST-REM-TERM-CALC (S1)
  5180                                 TO WS-AH-ST-REM-TERM-CALC
  5181              END-IF
  5182              IF CF-ST-REFUND-CALC (S1) > '0'
  5183                 MOVE CF-ST-REFUND-CALC (S1)
  5184                                 TO WS-AH-ST-REFUND-CALC
  5185              END-IF
  5186           END-IF
  5187        END-IF
  5188     END-IF
  5189     .
  5190 0340-EXIT.
  5191     EXIT.
  5192 0350-GET-ERACCT.
  5193     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5194                                    WS-AM-EARN-METHOD-R
  5195                                    WS-AM-EARN-METHOD-A
  5196                                    WS-LF-AM-REM-TERM-CALC
  5197                                    WS-AH-AM-REM-TERM-CALC
  5198     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5199     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5200     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5201     MOVE CM-STATE               TO WS-AM-STATE
  5202     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5203     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5204     MOVE LOW-VALUES             TO WS-AM-FILLER
  5205     MOVE ' '                    TO WS-STOP-SW
  5206
  5207* EXEC CICS STARTBR
  5208*       DATASET  ('ERACCT')
  5209*       RIDFLD   (WS-AM-KEY)
  5210*       GTEQ
  5211*       RESP (WS-RESPONSE)
  5212*    END-EXEC
  5213     MOVE 'ERACCT' TO DFHEIV1
  5214     MOVE 0
  5215       TO DFHEIV11
  5216*    MOVE '&,         G          &  N#00004905' TO DFHEIV0
  5217     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5218     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5219     MOVE X'204E233030303034393035' TO DFHEIV0(25:11)
  5220     CALL 'kxdfhei1' USING DFHEIV0,
  5221           DFHEIV1,
  5222           WS-AM-KEY,
  5223           DFHEIV99,
  5224           DFHEIV11,
  5225           DFHEIV99
  5226     MOVE EIBRESP  TO WS-RESPONSE
  5227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5228     IF RESP-NORMAL
  5229        PERFORM UNTIL TOLD-TO-STOP
  5230
  5231* EXEC CICS READNEXT
  5232*             DATASET  ('ERACCT')
  5233*             INTO     (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  92
* SOCK03.cbl
  5234*             RIDFLD   (WS-AM-KEY)
  5235*          END-EXEC
  5236     MOVE LENGTH OF
  5237      ACCOUNT-MASTER
  5238       TO DFHEIV12
  5239     MOVE 'ERACCT' TO DFHEIV1
  5240     MOVE 0
  5241       TO DFHEIV11
  5242*    MOVE '&.IL                  )   #00004913' TO DFHEIV0
  5243     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5244     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5245     MOVE X'2020233030303034393133' TO DFHEIV0(25:11)
  5246     CALL 'kxdfhei1' USING DFHEIV0,
  5247           DFHEIV1,
  5248           ACCOUNT-MASTER,
  5249           DFHEIV12,
  5250           WS-AM-KEY,
  5251           DFHEIV99,
  5252           DFHEIV11,
  5253           DFHEIV99,
  5254           DFHEIV99
  5255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5256           IF RESP-NORMAL
  5257              EVALUATE TRUE
  5258                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5259                    CM-CONTROL-PRIMARY (1:20)
  5260                    SET TOLD-TO-STOP TO TRUE
  5261                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5262                    CM-CONTROL-PRIMARY (1:20))
  5263                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5264                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5265                    SET ERACCT-FOUND      TO TRUE
  5266                    SET TOLD-TO-STOP TO TRUE
  5267              END-EVALUATE
  5268           ELSE
  5269              SET TOLD-TO-STOP TO TRUE
  5270           END-IF
  5271        END-PERFORM
  5272
  5273* EXEC CICS ENDBR
  5274*          DATASET   ('ERACCT')
  5275*       END-EXEC
  5276     MOVE 'ERACCT' TO DFHEIV1
  5277     MOVE 0
  5278       TO DFHEIV11
  5279*    MOVE '&2                    $   #00004934' TO DFHEIV0
  5280     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5281     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5282     MOVE X'2020233030303034393334' TO DFHEIV0(25:11)
  5283     CALL 'kxdfhei1' USING DFHEIV0,
  5284           DFHEIV1,
  5285           DFHEIV11,
  5286           DFHEIV99
  5287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5288     END-IF
  5289     .
  5290 0350-EXIT.
  5291     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  93
* SOCK03.cbl
  5292 0400-PROCESS-LIFE.
  5293     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5294     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5295     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5296     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5297     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5298     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5299     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5300     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5301     MOVE CM-CARRIER             TO WS-CARRIER
  5302     MOVE CM-GROUPING            TO WS-GROUPING
  5303     MOVE CM-STATE               TO WS-STATE
  5304     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5305     MOVE CM-CERT-NO             TO WS-CERT-NO
  5306     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5307     MOVE ' '                    TO  DC-OPTION-CODE.
  5308     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5309     IF NO-CONVERSION-ERROR
  5310        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5311     ELSE
  5312        MOVE 99999999            TO WS-CERT-EFF-DATE
  5313     END-IF
  5314     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5315        GO TO 0400-EXIT
  5316     END-IF
  5317     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5318                                    WS-TOT-LF-PREM
  5319                                    WS-TOT-LF-COMM
  5320     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5321     MOVE ' '                    TO  DC-OPTION-CODE
  5322     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5323     IF NO-CONVERSION-ERROR
  5324        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5325     ELSE
  5326        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5327     END-IF
  5328     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5329     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5330     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5331     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5332     MOVE CM-STATE               TO CP-STATE
  5333     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5334     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5335     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5336     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5337     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5338     MOVE '2'                    TO CP-PROCESS-TYPE
  5339     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5340     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5341     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5342     MOVE WS-CF-REM-TRM-CALC-OPTION
  5343                                 TO CP-REM-TRM-CALC-OPTION
  5344     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5345     IF WS-LF-CO-REM-TERM-CALC > '0'
  5346        MOVE WS-LF-CO-REM-TERM-CALC
  5347                                 TO CP-REM-TERM-METHOD
  5348     END-IF
  5349     IF WS-LF-ST-REM-TERM-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  94
* SOCK03.cbl
  5350         MOVE WS-LF-ST-REM-TERM-CALC
  5351                                 TO  CP-REM-TERM-METHOD.
  5352     IF WS-LF-AM-REM-TERM-CALC > '0'
  5353         MOVE WS-LF-AM-REM-TERM-CALC
  5354                                 TO  CP-REM-TERM-METHOD.
  5355     IF (WS-COMP-ID = 'CID')
  5356        AND (CP-STATE-STD-ABBRV = 'WI')
  5357        MOVE '7'                 TO CP-REM-TERM-METHOD
  5358        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5359     END-IF
  5360     IF (WS-COMP-ID = 'CID')
  5361        AND (CP-STATE-STD-ABBRV = 'MO')
  5362        AND (CM-CERT-EFF-DT >= X'9B41')
  5363        AND (CM-CERT-EFF-DT <= X'A2FB')
  5364        MOVE '7'                 TO CP-REM-TERM-METHOD
  5365        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5366     END-IF
  5367     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5368                                    CP-LOAN-TERM
  5369                                    WS-LF-TERM
  5370     IF CP-TRUNCATED-LIFE
  5371         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5372     IF CP-TERM-IS-DAYS
  5373        IF CM-LF-TERM-IN-DAYS NUMERIC
  5374           MOVE CM-LF-TERM-IN-DAYS
  5375                                 TO CP-TERM-OR-EXT-DAYS
  5376        ELSE
  5377           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5378        END-IF
  5379     ELSE
  5380        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5381           MOVE CM-PMT-EXTENSION-DAYS
  5382                                 TO CP-TERM-OR-EXT-DAYS
  5383        ELSE
  5384           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5385        END-IF
  5386     END-IF
  5387     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5388     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5389        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5390        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5391     END-IF
  5392     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5393     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5394     MOVE ' '                    TO WS-CLM-STOP-SW
  5395     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5396     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5397
  5398* EXEC CICS STARTBR
  5399*       DATASET     ('ELMSTR5')
  5400*       RIDFLD      (ELMSTR-KEY)
  5401*       RESP        (WS-RESPONSE)
  5402*    END-EXEC
  5403     MOVE 'ELMSTR5' TO DFHEIV1
  5404     MOVE 0
  5405       TO DFHEIV11
  5406*    MOVE '&,         G          &  N#00005046' TO DFHEIV0
  5407     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  95
* SOCK03.cbl
  5408     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5409     MOVE X'204E233030303035303436' TO DFHEIV0(25:11)
  5410     CALL 'kxdfhei1' USING DFHEIV0,
  5411           DFHEIV1,
  5412           ELMSTR-KEY,
  5413           DFHEIV99,
  5414           DFHEIV11,
  5415           DFHEIV99
  5416     MOVE EIBRESP  TO WS-RESPONSE
  5417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5418     DISPLAY ' AFTER START ' WS-RESPONSE
  5419     IF RESP-NORMAL
  5420        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5421
  5422* EXEC CICS READNEXT
  5423*             DATASET   ('ELMSTR5')
  5424*             RIDFLD    (ELMSTR-KEY)
  5425*             INTO      (CLAIM-MASTER)
  5426*             RESP      (WS-RESPONSE)
  5427*          END-EXEC
  5428     MOVE LENGTH OF
  5429      CLAIM-MASTER
  5430       TO DFHEIV12
  5431     MOVE 'ELMSTR5' TO DFHEIV1
  5432     MOVE 0
  5433       TO DFHEIV11
  5434*    MOVE '&.IL                  )  N#00005054' TO DFHEIV0
  5435     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5436     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5437     MOVE X'204E233030303035303534' TO DFHEIV0(25:11)
  5438     CALL 'kxdfhei1' USING DFHEIV0,
  5439           DFHEIV1,
  5440           CLAIM-MASTER,
  5441           DFHEIV12,
  5442           ELMSTR-KEY,
  5443           DFHEIV99,
  5444           DFHEIV11,
  5445           DFHEIV99,
  5446           DFHEIV99
  5447     MOVE EIBRESP  TO WS-RESPONSE
  5448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5449        IF (RESP-NORMAL OR RESP-DUPKEY)
  5450           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5451           AND (CM-CERT-NO = CL-CERT-NO)
  5452           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5453              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5454              IF CL-CLAIM-TYPE = 'L'
  5455                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5456                    MOVE 'D'     TO WS-AH-STATUS
  5457                 END-IF
  5458                 IF CLAIM-IS-OPEN
  5459                    MOVE ' OPEN LIFE CLAIM '
  5460                                 TO WS-COMMENT
  5461                    MOVE 'L'     TO WS-LF-STATUS
  5462                    GO TO 0400-EXIT
  5463                 ELSE
  5464                    MOVE ' DEATH CLAIM APPLIED '
  5465                                 TO WS-COMMENT
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  96
* SOCK03.cbl
  5466                    MOVE 'D'     TO WS-LF-STATUS
  5467*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5468*                      MOVE CL-PAID-THRU-DT
  5469*                                TO WS-LF-BIN-PAID-THRU-DT
  5470*                   END-IF
  5471                 END-IF
  5472              END-IF
  5473           END-IF
  5474        ELSE
  5475           SET I-SAY-TO-STOP TO TRUE
  5476        END-IF
  5477        END-PERFORM
  5478
  5479* EXEC CICS ENDBR
  5480*          DATASET   ('ELMSTR5')
  5481*       END-EXEC
  5482     MOVE 'ELMSTR5' TO DFHEIV1
  5483     MOVE 0
  5484       TO DFHEIV11
  5485*    MOVE '&2                    $   #00005089' TO DFHEIV0
  5486     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5487     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5488     MOVE X'2020233030303035303839' TO DFHEIV0(25:11)
  5489     CALL 'kxdfhei1' USING DFHEIV0,
  5490           DFHEIV1,
  5491           DFHEIV11,
  5492           DFHEIV99
  5493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5494     END-IF
  5495     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5496*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5497        MOVE WS-LF-BIN-PAID-THRU-DT
  5498                                 TO DC-BIN-DATE-1
  5499        MOVE ' '                 TO DC-OPTION-CODE
  5500        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5501        IF NO-CONVERSION-ERROR
  5502           MOVE DC-GREG-DATE-CYMD
  5503                                 TO WS-CLM-PAID-THRU-DT
  5504        ELSE
  5505           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5506        END-IF
  5507*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5508*          MOVE 'CAN DT =< CLM PD THRU DT'
  5509*                                TO WS-COMMENT
  5510*          MOVE 'P'              TO WS-LF-STATUS
  5511*          GO TO 0400-EXIT
  5512*       END-IF
  5513        GO TO 0400-EXIT
  5514     END-IF
  5515     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5516     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5517        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5518        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5519        COMPUTE CP-REMAINING-TERM-1 =
  5520                CP-REMAINING-TERM-1 - +1
  5521        COMPUTE CP-REMAINING-TERM-2 =
  5522                CP-REMAINING-TERM-2 - +1
  5523     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  97
* SOCK03.cbl
  5524     IF CP-REMAINING-TERM-1 NEGATIVE
  5525        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5526     END-IF
  5527     IF CP-REMAINING-TERM-2 NEGATIVE
  5528        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5529     END-IF
  5530     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5531        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5532     END-IF
  5533     IF CM-LIFE-COMM-PCT > ZEROS
  5534        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5535           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5536     END-IF
  5537     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5538     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5539     IF CM-LF-CURRENT-STATUS = '8'
  5540        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5541           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5542                                 TO WS-COMMENT
  5543           MOVE 'C'              TO WS-LF-STATUS
  5544*          PERFORM 0030-BUILD-BUFFER
  5545*                                THRU 0030-EXIT
  5546*          PERFORM 0020-SEND-BUFFER
  5547*                                THRU 0020-EXIT
  5548*          SET ALREADY-SENT      TO TRUE
  5549*          MOVE SPACES           TO WS-COMMENT
  5550           GO TO 0400-EXIT
  5551*          PERFORM 0025-CLOSE-SOCKET
  5552*                                THRU 0025-EXIT
  5553*          GO TO 0010-RETURN
  5554        END-IF
  5555     END-IF
  5556     IF CM-LF-CURRENT-STATUS = '7'
  5557        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5558           MOVE ' DEATH CLAIM APPLIED '
  5559                                 TO WS-COMMENT
  5560           MOVE 'D'              TO WS-LF-STATUS
  5561*          PERFORM 0030-BUILD-BUFFER
  5562*                                THRU 0030-EXIT
  5563*          IF NOT ALREADY-SENT
  5564*             PERFORM 0020-SEND-BUFFER
  5565*                                THRU 0020-EXIT
  5566*             SET ALREADY-SENT   TO TRUE
  5567*          END-IF
  5568           GO TO 0400-EXIT
  5569*          PERFORM 0025-CLOSE-SOCKET
  5570*                                THRU 0025-EXIT
  5571*          GO TO 0010-RETURN
  5572        END-IF
  5573     END-IF
  5574     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5575        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  5576        MOVE 'LF COVERAGE EXPIRED '
  5577                                 TO WS-COMMENT
  5578        MOVE 'E'                 TO WS-LF-STATUS
  5579        GO TO 0400-EXIT
  5580     END-IF
  5581     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  98
* SOCK03.cbl
  5582        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5583        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5584     ELSE
  5585        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  5586     END-IF
  5587     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  5588     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  5589*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  5590     if ws-comp-id = 'AHL'
  5591        move cm-lf-class-cd      to cp-class-code
  5592        if cp-class-code = spaces
  5593           move zeros            to cp-class-code
  5594        end-if
  5595     else
  5596        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5597     end-if
  5598     IF (ws-comp-id = 'DCC')
  5599        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5600        MOVE ' '                 TO WS-PDEF-RECORD-SW
  5601        PERFORM 0730-GET-DDF-FACTORS
  5602                                 THRU 0730-EXIT
  5603        IF PDEF-FOUND
  5604           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5605              (P1 > +8)
  5606              OR (PD-PROD-CODE (P1) = 'L')
  5607           END-PERFORM
  5608           IF P1 < +9
  5609              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  5610           END-IF
  5611        END-IF
  5612     END-IF
  5613     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  5614*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  5615     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  5616        CM-LF-ALT-BENEFIT-AMT
  5617*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  5618     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  5619                                    WS-LF-REM-BEN
  5620     move cm-lf-premium-amt      to ws-tot-lf-prem
  5621     if ws-lf-co-earnings-calc = 'B'
  5622        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  5623           + CM-LF-ALT-PREMIUM-AMT
  5624     end-if
  5625     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  5626     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5627        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5628        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5629     ELSE
  5630        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  5631     END-IF
  5632     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5633     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5634     IF WS-LF-ST-REFUND-CALC > ZERO
  5635         MOVE WS-LF-ST-REFUND-CALC
  5636                                 TO  CP-EARNING-METHOD.
  5637     IF WS-LF-FO-REFUND-CALC > ZERO
  5638         MOVE WS-LF-FO-REFUND-CALC
  5639                                 TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page  99
* SOCK03.cbl
  5640     IF CP-RATING-METHOD = '4'
  5641        MOVE '4'                 TO CP-EARNING-METHOD
  5642     END-IF
  5643*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5644     if ws-comp-id = 'AHL'
  5645        move cm-lf-class-cd      to cp-class-code
  5646        if cp-class-code = spaces
  5647           move zeros            to cp-class-code
  5648        end-if
  5649     else
  5650        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5651     end-if
  5652     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5653     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5654                                     CP-RATING-BENEFIT-AMT.
  5655     IF CP-STATE-STD-ABBRV = 'OR'
  5656         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5657                                         CM-LF-ALT-BENEFIT-AMT.
  5658****   N O T E   ****
  5659*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  5660*      THE OH HARD CODING IN ELCRFNDP
  5661     IF WS-COMP-ID = 'CID'
  5662        IF CP-STATE-STD-ABBRV = 'OH'
  5663           MOVE WS-LF-CO-EARNINGS-CALC
  5664                                 TO CP-EARNING-METHOD
  5665        END-IF
  5666     END-IF
  5667****   N O T E   ****
  5668     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5669     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5670     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  5671     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5672     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5673     IF CP-EARN-AS-NET-PAY
  5674        IF CP-LOAN-APR <= ZEROS
  5675           IF WS-CF-DEFAULT-APR > ZEROS
  5676              MOVE WS-CF-DEFAULT-APR
  5677                                 TO  CP-LOAN-APR
  5678           END-IF
  5679        END-IF
  5680     END-IF
  5681*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  5682*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  5683*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  5684*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  5685*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  5686*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  5687*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  5688*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  5689*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  5690*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  5691*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  5692*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  5693*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  5694*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  5695*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  5696*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  5697*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 100
* SOCK03.cbl
  5698*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  5699     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5700     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  5701     DISPLAY ' MADE IT BACK FROM ELRFND '
  5702     IF (CP-ERROR-RATE-IS-ZERO)
  5703        OR (CP-ERROR-RATE-NOT-FOUND)
  5704        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5705        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  5706          DELIMITED BY SIZE INTO WS-COMMENT
  5707        END-STRING
  5708        MOVE 'X'                 TO WS-LF-STATUS
  5709        GO TO 0400-EXIT
  5710*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5711*       IF NOT ALREADY-SENT
  5712*          PERFORM 0020-SEND-BUFFER
  5713*                                THRU 0020-EXIT
  5714*          SET ALREADY-SENT      TO TRUE
  5715*       END-IF
  5716*       PERFORM 0025-CLOSE-SOCKET
  5717*                                THRU 0025-EXIT
  5718*       GO TO 0010-RETURN
  5719     END-IF
  5720     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  5721                                    WS-TOT-LF-RFND
  5722     IF (WS-LF-STATUS = SPACES)
  5723        OR (CP-CALC-REFUND > ZEROS)
  5724        MOVE 'A'                 TO WS-LF-STATUS
  5725     END-IF
  5726     EVALUATE TRUE
  5727        WHEN CP-R-AS-R78
  5728           MOVE 'RULE 78'          TO  WS-LF-METHOD
  5729        WHEN  CP-R-AS-PRORATA
  5730           MOVE 'PRO RATA'         TO  WS-LF-METHOD
  5731        WHEN CP-R-AS-CALIF
  5732           MOVE 'CALIF'            TO  WS-LF-METHOD
  5733        WHEN CP-R-AS-TEXAS
  5734           MOVE 'IRREG'            TO  WS-LF-METHOD
  5735        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  5736           MOVE 'UTAH'             TO  WS-LF-METHOD
  5737        WHEN CP-R-AS-FARM-PLAN
  5738           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  5739        WHEN CP-R-AS-NET-PAY
  5740           MOVE 'NET PAY'          TO  WS-LF-METHOD
  5741        WHEN CP-R-AS-ANTICIPATION
  5742           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  5743        WHEN CP-R-AS-MEAN
  5744           MOVE 'MEAN'             TO  WS-LF-METHOD
  5745        WHEN CP-R-AS-SUM-OF-DIGITS
  5746           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
  5747     END-EVALUATE
  5748     IF WS-TOT-LF-RFND > ZEROS
  5749        COMPUTE WS-WORK-FACTOR ROUNDED =
  5750           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  5751        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  5752           WS-TOT-LF-COMM
  5753     END-IF
  5754     IF ERACCT-FOUND
  5755        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 101
* SOCK03.cbl
  5756           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5757        END-IF
  5758        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5759           IF (AM-COMM-CHARGEBACK (1) = 99)
  5760                     OR
  5761              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5762                     OR
  5763              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5764              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5765              MOVE ZEROS         TO WS-LF-UEC
  5766           END-IF
  5767        END-IF
  5768     END-IF
  5769     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  5770        GO TO 0400-EXIT
  5771     END-IF
  5772     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  5773     MOVE '2'                    TO  CP-EARNING-METHOD
  5774                                     CP-RATING-METHOD.
  5775     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  5776                                     CP-REMAINING-BENEFIT
  5777                                     CP-RATING-BENEFIT-AMT.
  5778     IF CP-STATE-STD-ABBRV = 'OR'
  5779         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5780                                         CM-LF-ALT-BENEFIT-AMT.
  5781     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  5782     IF ws-comp-id = 'CID'
  5783        IF (CP-STATE-STD-ABBRV = 'MN')
  5784           AND (CM-CERT-EFF-DT > X'A4FF')
  5785           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  5786           MOVE '5'              TO CP-EARNING-METHOD
  5787           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  5788        END-IF
  5789     END-IF
  5790     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  5791     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  5792     IF (CP-ERROR-RATE-IS-ZERO)
  5793        OR (CP-ERROR-RATE-NOT-FOUND)
  5794        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5795        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  5796          DELIMITED BY SIZE INTO WS-COMMENT
  5797        END-STRING
  5798        MOVE 'X'              TO WS-LF-STATUS
  5799        GO TO 0400-EXIT
  5800*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5801*       IF NOT ALREADY-SENT
  5802*          PERFORM 0020-SEND-BUFFER
  5803*                                THRU 0020-EXIT
  5804*          SET ALREADY-SENT      TO TRUE
  5805*       END-IF
  5806*       PERFORM 0025-CLOSE-SOCKET
  5807*                                THRU 0025-EXIT
  5808*       GO TO 0010-RETURN
  5809     END-IF
  5810     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  5811     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  5812     IF WS-TOT-LF-RFND > ZEROS
  5813        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 102
* SOCK03.cbl
  5814           WS-TOT-LF-COMM
  5815     END-IF
  5816     IF ERACCT-FOUND
  5817        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5818           IF (AM-COMM-CHARGEBACK (1) = 99)
  5819                     OR
  5820              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5821                     OR
  5822              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5823              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5824              MOVE ZEROS         TO WS-LF-UEC
  5825           END-IF
  5826        END-IF
  5827     END-IF
  5828     .
  5829 0400-EXIT.
  5830     EXIT.
  5831 0500-PROCESS-AH.
  5832     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  5833        GO TO 0500-EXIT
  5834     END-IF
  5835     MOVE ZEROS                  TO WS-TOT-AH-RFND
  5836                                    WS-TOT-AH-PREM
  5837                                    WS-TOT-AH-COMM
  5838     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5839     MOVE ' '                    TO  DC-OPTION-CODE
  5840     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5841     IF NO-CONVERSION-ERROR
  5842        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  5843     ELSE
  5844        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  5845     END-IF
  5846     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  5847     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  5848     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  5849     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5850     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5851     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  5852     MOVE CM-STATE               TO  CP-STATE.
  5853     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5854     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  5855     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5856     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5857     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  5858     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5859     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5860     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  5861     MOVE WS-CF-CR-REM-TERM-CALC
  5862                                 TO  CP-REM-TERM-METHOD.
  5863     IF WS-AH-CO-REM-TERM-CALC > '0'
  5864         MOVE WS-AH-CO-REM-TERM-CALC
  5865                                 TO  CP-REM-TERM-METHOD.
  5866     IF WS-AH-ST-REM-TERM-CALC > '0'
  5867         MOVE WS-AH-ST-REM-TERM-CALC
  5868                                 TO  CP-REM-TERM-METHOD.
  5869     IF WS-AH-AM-REM-TERM-CALC > '0'
  5870         MOVE WS-AH-AM-REM-TERM-CALC
  5871                                 TO  CP-REM-TERM-METHOD.
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 103
* SOCK03.cbl
  5872     IF (WS-COMP-ID = 'CID')
  5873        AND (CP-STATE-STD-ABBRV = 'WI')
  5874        MOVE '7'                 TO CP-REM-TERM-METHOD
  5875        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5876     END-IF
  5877     IF (WS-COMP-ID = 'CID')
  5878        AND (CP-STATE-STD-ABBRV = 'MO')
  5879        AND (CM-CERT-EFF-DT >= X'9B41')
  5880        AND (CM-CERT-EFF-DT <= X'A2FB')
  5881        MOVE '7'                 TO CP-REM-TERM-METHOD
  5882        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5883     END-IF
  5884     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  5885                                     CP-LOAN-TERM.
  5886     IF  NOT  CP-TERM-IS-DAYS
  5887         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5888             MOVE CM-PMT-EXTENSION-DAYS
  5889                                 TO  CP-TERM-OR-EXT-DAYS
  5890         ELSE
  5891             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5892     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5893     IF CM-AH-COMM-PCT > ZEROS
  5894        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  5895           CM-AH-PREMIUM-AMT
  5896     END-IF
  5897     IF (ws-comp-id = 'DCC')
  5898        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5899        compute ws-tot-ah-comm = cm-ah-premium-amt -
  5900           (cm-ah-clp + cm-addl-clp)
  5901     end-if
  5902     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  5903     IF WS-AH-STATUS = 'D'
  5904        GO TO 0500-EXIT
  5905     END-IF
  5906     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  5907     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  5908     MOVE ' '                    TO WS-CLM-STOP-SW
  5909     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5910     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5911
  5912* EXEC CICS STARTBR
  5913*       DATASET     ('ELMSTR5')
  5914*       RIDFLD      (ELMSTR-KEY)
  5915*       RESP        (WS-RESPONSE)
  5916*    END-EXEC
  5917     MOVE 'ELMSTR5' TO DFHEIV1
  5918     MOVE 0
  5919       TO DFHEIV11
  5920*    MOVE '&,         G          &  N#00005509' TO DFHEIV0
  5921     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5922     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5923     MOVE X'204E233030303035353039' TO DFHEIV0(25:11)
  5924     CALL 'kxdfhei1' USING DFHEIV0,
  5925           DFHEIV1,
  5926           ELMSTR-KEY,
  5927           DFHEIV99,
  5928           DFHEIV11,
  5929           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 104
* SOCK03.cbl
  5930     MOVE EIBRESP  TO WS-RESPONSE
  5931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5932     DISPLAY ' AFTER START ' WS-RESPONSE
  5933     IF RESP-NORMAL
  5934        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5935           DISPLAY ' AH READNEXT '
  5936
  5937* EXEC CICS READNEXT
  5938*             DATASET   ('ELMSTR5')
  5939*             RIDFLD    (ELMSTR-KEY)
  5940*             INTO      (CLAIM-MASTER)
  5941*             RESP      (WS-RESPONSE)
  5942*          END-EXEC
  5943     MOVE LENGTH OF
  5944      CLAIM-MASTER
  5945       TO DFHEIV12
  5946     MOVE 'ELMSTR5' TO DFHEIV1
  5947     MOVE 0
  5948       TO DFHEIV11
  5949*    MOVE '&.IL                  )  N#00005518' TO DFHEIV0
  5950     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5951     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5952     MOVE X'204E233030303035353138' TO DFHEIV0(25:11)
  5953     CALL 'kxdfhei1' USING DFHEIV0,
  5954           DFHEIV1,
  5955           CLAIM-MASTER,
  5956           DFHEIV12,
  5957           ELMSTR-KEY,
  5958           DFHEIV99,
  5959           DFHEIV11,
  5960           DFHEIV99,
  5961           DFHEIV99
  5962     MOVE EIBRESP  TO WS-RESPONSE
  5963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5964        IF (RESP-NORMAL OR RESP-DUPKEY)
  5965           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5966           AND (CM-CERT-NO = CL-CERT-NO)
  5967           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5968              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5969              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G')
  5970                 IF CLAIM-IS-OPEN
  5971                    DISPLAY ' FOUND OPEN AH CLAIM '
  5972                    MOVE ' OPEN HEALTH CLAIM '
  5973                                 TO WS-COMMENT
  5974                    MOVE 'H'     TO WS-AH-STATUS
  5975                 ELSE
  5976                    DISPLAY ' FOUND CLOSED AH CLAIM '
  5977                    MOVE ' CLOSED HEALTH CLAIM '
  5978                                 TO WS-COMMENT
  5979                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  5980                       MOVE CL-PAID-THRU-DT
  5981                                 TO WS-AH-BIN-PAID-THRU-DT
  5982                    END-IF
  5983                 END-IF
  5984              END-IF
  5985           END-IF
  5986        ELSE
  5987           SET I-SAY-TO-STOP TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 105
* SOCK03.cbl
  5988        END-IF
  5989        END-PERFORM
  5990
  5991* EXEC CICS ENDBR
  5992*          DATASET   ('ELMSTR5')
  5993*       END-EXEC
  5994     MOVE 'ELMSTR5' TO DFHEIV1
  5995     MOVE 0
  5996       TO DFHEIV11
  5997*    MOVE '&2                    $   #00005550' TO DFHEIV0
  5998     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5999     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6000     MOVE X'2020233030303035353530' TO DFHEIV0(25:11)
  6001     CALL 'kxdfhei1' USING DFHEIV0,
  6002           DFHEIV1,
  6003           DFHEIV11,
  6004           DFHEIV99
  6005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6006     END-IF
  6007     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6008*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6009        MOVE WS-AH-BIN-PAID-THRU-DT
  6010                                 TO DC-BIN-DATE-1
  6011        MOVE ' '                 TO DC-OPTION-CODE
  6012        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6013        IF NO-CONVERSION-ERROR
  6014           MOVE DC-GREG-DATE-CYMD
  6015                                 TO WS-CLM-PAID-THRU-DT
  6016        ELSE
  6017           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6018        END-IF
  6019        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6020           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6021                                 TO WS-COMMENT
  6022           MOVE 'P'              TO WS-AH-STATUS
  6023           GO TO 0500-EXIT
  6024        END-IF
  6025     END-IF
  6026     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6027     IF CM-AH-CURRENT-STATUS = '8'
  6028        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6029           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6030                                 TO WS-COMMENT
  6031           MOVE 'C'              TO WS-AH-STATUS
  6032           GO TO 0500-EXIT
  6033        END-IF
  6034     END-IF
  6035     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6036        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6037           MOVE ' SETTLEMENT CLAIM APPLIED '
  6038                                 TO WS-COMMENT
  6039           MOVE 'S'              TO WS-AH-STATUS
  6040*          PERFORM 0030-BUILD-BUFFER
  6041*                                THRU 0030-EXIT
  6042*          IF NOT ALREADY-SENT
  6043*             PERFORM 0020-SEND-BUFFER
  6044*                                THRU 0020-EXIT
  6045*             SET ALREADY-SENT   TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 106
* SOCK03.cbl
  6046*          END-IF
  6047           GO TO 0500-EXIT
  6048*          PERFORM 0025-CLOSE-SOCKET
  6049*                                THRU 0025-EXIT
  6050*          GO TO 0010-RETURN
  6051        END-IF
  6052     END-IF
  6053     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6054        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6055        MOVE 'AH COVERAGE EXPIRED '
  6056                                 TO WS-COMMENT
  6057        MOVE 'E'                 TO WS-AH-STATUS
  6058        GO TO 0500-EXIT
  6059     END-IF
  6060     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6061                                    WS-AH-PREM
  6062     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6063     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6064        * CP-REMAINING-TERM-1
  6065     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6066                                     WS-AH-REM-TERM
  6067     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6068     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6069     IF WS-AH-ST-REFUND-CALC > ZERO
  6070         MOVE WS-AH-ST-REFUND-CALC
  6071                                 TO  CP-EARNING-METHOD.
  6072     IF WS-AH-FO-REFUND-CALC > ZERO
  6073         MOVE WS-AH-FO-REFUND-CALC
  6074                                 TO  CP-EARNING-METHOD.
  6075*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6076     if ws-comp-id = 'AHL'
  6077        move cm-ah-class-cd      to cp-class-code
  6078        if cp-class-code = spaces
  6079           move zeros            to cp-class-code
  6080        end-if
  6081     else
  6082        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6083     end-if
  6084     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6085     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6086                                     CP-RATING-BENEFIT-AMT.
  6087     IF CP-STATE-STD-ABBRV = 'OR'
  6088         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6089                                         CM-AH-ORIG-TERM.
  6090     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6091     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6092     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6093     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6094     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6095     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6096     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6097     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6098     MOVE ' '                    TO  DC-OPTION-CODE.
  6099     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6100     IF CP-STATE-STD-ABBRV = 'OH'
  6101        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6102         IF (CP-ORIGINAL-TERM > 60)
  6103           AND (DC-GREG-DATE-1-YMD > '831101')
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 107
* SOCK03.cbl
  6104           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6105             MOVE '6'            TO  CP-EARNING-METHOD
  6106         END-IF
  6107        END-IF
  6108        IF WS-COMP-ID = 'CID'
  6109           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6110                           LOW-VALUES)
  6111              IF CP-CRITICAL-PERIOD
  6112                 MOVE '2'       TO CP-EARNING-METHOD
  6113              ELSE
  6114                 MOVE '6'       TO CP-EARNING-METHOD
  6115              END-IF
  6116           ELSE
  6117              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6118                 MOVE '2'       TO CP-EARNING-METHOD
  6119              ELSE
  6120                 IF ((CM-LF-ORIG-TERM > 60) AND
  6121                    (CM-RATE-CLASS NOT = 'L '))
  6122                               OR
  6123                    (WS-LF-CO-EARNINGS-CALC = '5')
  6124                    IF CP-CRITICAL-PERIOD
  6125                       MOVE '2'  TO CP-EARNING-METHOD
  6126                    ELSE
  6127                       MOVE '6'  TO CP-EARNING-METHOD
  6128                    END-IF
  6129                 ELSE
  6130                    MOVE '1'     TO CP-EARNING-METHOD
  6131                 END-IF
  6132              END-IF
  6133           END-IF
  6134        END-IF
  6135     END-IF
  6136     IF CP-STATE-STD-ABBRV = 'VA'
  6137       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6138         IF DC-GREG-DATE-1-YMD > '921231'
  6139            IF CP-ORIGINAL-TERM > 61
  6140                MOVE '6'            TO  CP-EARNING-METHOD
  6141            ELSE
  6142                MOVE '1'            TO  CP-EARNING-METHOD.
  6143     IF CP-EARN-AS-NET-PAY
  6144        IF CP-LOAN-APR <= ZEROS
  6145           IF WS-CF-DEFAULT-APR > ZEROS
  6146              MOVE WS-CF-DEFAULT-APR
  6147                                 TO  CP-LOAN-APR
  6148           END-IF
  6149        END-IF
  6150     END-IF
  6151     IF WS-COMP-ID = 'DCC'
  6152        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6153           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6154           MOVE 'S'              TO CP-EARNING-METHOD
  6155        END-IF
  6156     END-IF
  6157     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6158     IF (WS-COMP-ID = 'DCC')
  6159        AND (CP-EARNING-METHOD = 'D')
  6160        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6161                                    WS-DDF-CSO-ADMIN-FEE
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 108
* SOCK03.cbl
  6162                                    WS-DDF-1ST-YR-TOT-EXP
  6163                                    WS-DDF-COMM-AND-MFEE
  6164        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6165           S1 > +10
  6166           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6167              IF (AM-A-COM (S1) NUMERIC)
  6168                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6169                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6170              ELSE
  6171                 MOVE +0         TO WS-COMM-PCT C0
  6172                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6173                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6174              END-IF
  6175              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6176                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6177                    + WS-COMM-PCT
  6178              END-IF
  6179              IF AM-COM-TYP (S1) = 'N'
  6180                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6181                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6182              END-IF
  6183              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6184                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6185                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6186              END-IF
  6187              IF AM-COM-TYP (S1) = 'I'
  6188                 COMPUTE WS-DDF-COMM-AND-MFEE
  6189                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6190              END-IF
  6191           END-IF
  6192        END-PERFORM
  6193        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6194        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6195        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6196           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6197     END-IF
  6198     IF (WS-COMP-ID = 'DCC')
  6199        AND (CP-EARNING-METHOD = 'D')
  6200        AND (ws-CANCEL-REASON NOT = 'R')
  6201        PERFORM 0730-GET-DDF-FACTORS
  6202                                 THRU 0730-EXIT
  6203        IF NOT PDEF-FOUND
  6204           MOVE ' DDF UE FACTORS  NOT FOUND '
  6205                                 TO WS-COMMENT
  6206           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6207           PERFORM 0030-BUILD-BUFFER
  6208                                 THRU 0030-EXIT
  6209           PERFORM 0020-SEND-BUFFER
  6210                                 THRU 0020-EXIT
  6211           PERFORM 0025-CLOSE-SOCKET
  6212                                 THRU 0025-EXIT
  6213           GO TO 0010-RETURN
  6214        END-IF
  6215*       IF NOT PDEF-FOUND
  6216*          MOVE ER-9999          TO EMI-ERROR
  6217*          PERFORM 9700-ERROR-FORMAT
  6218*                                THRU 9799-EXIT
  6219*          GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 109
* SOCK03.cbl
  6220*       END-IF
  6221        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6222                                 TO CP-DDF-LO-FACT
  6223        MOVE PD-UEP-FACTOR (P1 P2)
  6224                                 TO CP-DDF-HI-FACT
  6225        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6226        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6227        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6228        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6229           + PD-1ST-YR-ADMIN-ALLOW
  6230        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6231*       IF PI-CLP-YN = 'Y'
  6232*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6233*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6234*                                   CP-DDF-CLP
  6235*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6236*       END-IF
  6237        IF DD-IU-PRESENT
  6238           MOVE 'I'              TO CP-EARNING-METHOD
  6239        END-IF
  6240        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6241                                    CP-CLP-RATE-UP
  6242        IF (CP-CALC-GROSS-FEE)
  6243           AND (CP-IU-RATE-UP NOT = ZEROS)
  6244           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6245              / CP-ORIGINAL-PREMIUM)
  6246           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6247              / (1 - TEX-FACT-8)
  6248        END-IF
  6249     END-IF
  6250     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6251     IF (CP-ERROR-RATE-IS-ZERO)
  6252        OR (CP-ERROR-RATE-NOT-FOUND)
  6253        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6254        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6255          DELIMITED BY SIZE INTO WS-COMMENT
  6256        END-STRING
  6257        IF WS-AH-STATUS NOT = 'H'
  6258           MOVE 'X'                 TO WS-AH-STATUS
  6259        END-IF
  6260        GO TO 0500-EXIT
  6261*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6262*       IF NOT ALREADY-SENT
  6263*          PERFORM 0020-SEND-BUFFER
  6264*                                THRU 0020-EXIT
  6265*          SET ALREADY-SENT      TO TRUE
  6266*       END-IF
  6267*       PERFORM 0025-CLOSE-SOCKET
  6268*                                THRU 0025-EXIT
  6269*       GO TO 0010-RETURN
  6270     END-IF
  6271     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6272                                    WS-TOT-AH-RFND
  6273     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6274     IF ((WS-AH-STATUS = SPACES)
  6275        OR (CP-CALC-REFUND > ZEROS))
  6276                  AND
  6277          (WS-AH-STATUS NOT = 'H')
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 110
* SOCK03.cbl
  6278        MOVE 'A'                 TO WS-AH-STATUS
  6279     END-IF
  6280     IF WS-COMP-ID = 'DCC'
  6281        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6282        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6283        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6284        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6285        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6286        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6287        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6288        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6289        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6290     END-IF
  6291     EVALUATE TRUE
  6292        WHEN CP-R-AS-R78
  6293           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6294        WHEN CP-R-AS-PRORATA
  6295           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  6296        WHEN CP-REFUND-TYPE-USED = '3'
  6297           MOVE 'CALIF'            TO  WS-AH-METHOD
  6298        WHEN CP-R-AS-TEXAS
  6299           MOVE 'IRREG'            TO  WS-AH-METHOD
  6300        WHEN CP-R-AS-FARM-PLAN
  6301           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  6302        WHEN CP-R-AS-NET-PAY
  6303           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6304        WHEN CP-R-AS-ANTICIPATION
  6305           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6306        WHEN CP-R-AS-MEAN
  6307           MOVE 'MEAN'             TO  WS-AH-METHOD
  6308        WHEN CP-R-AS-SUM-OF-DIGITS
  6309           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  6310        WHEN CP-GAP-ACTUARIAL
  6311           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6312     END-EVALUATE
  6313     IF WS-TOT-AH-RFND > ZEROS
  6314        IF (ws-comp-id = 'DCC')
  6315           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6316           compute ws-work-factor rounded =
  6317              ws-ah-rfnd-clp / cm-ah-clp
  6318        else
  6319           COMPUTE WS-WORK-FACTOR ROUNDED =
  6320              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6321        end-if
  6322        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6323           WS-TOT-AH-COMM
  6324     END-IF
  6325     IF ERACCT-FOUND
  6326        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6327           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6328        END-IF
  6329        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6330           IF (AM-COMM-CHARGEBACK (1) = 99)
  6331                     OR
  6332              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6333                     OR
  6334              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6335              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 111
* SOCK03.cbl
  6336              MOVE ZEROS         TO WS-AH-UEC
  6337           END-IF
  6338        END-IF
  6339     END-IF
  6340     .
  6341 0500-EXIT.
  6342     EXIT.
  6343 0700-LINK-REM-TERM.
  6344
  6345* EXEC CICS LINK
  6346*        PROGRAM   ('ELRTRM')
  6347*        COMMAREA  (CALCULATION-PASS-AREA)
  6348*        LENGTH    (CP-COMM-LENGTH)
  6349*    END-EXEC.
  6350     MOVE 'ELRTRM' TO DFHEIV1
  6351*    MOVE '."C                   (   #00005891' TO DFHEIV0
  6352     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6353     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6354     MOVE X'2020233030303035383931' TO DFHEIV0(25:11)
  6355     CALL 'kxdfhei1' USING DFHEIV0,
  6356           DFHEIV1,
  6357           CALCULATION-PASS-AREA,
  6358           CP-COMM-LENGTH,
  6359           DFHEIV99,
  6360           DFHEIV99,
  6361           DFHEIV99,
  6362           DFHEIV99
  6363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6364
  6365 0700-EXIT.
  6366     EXIT.
  6367 0710-LINK-REM-AMOUNT.
  6368
  6369* EXEC CICS LINK
  6370*        PROGRAM   ('ELRAMT')
  6371*        COMMAREA  (CALCULATION-PASS-AREA)
  6372*        LENGTH    (CP-COMM-LENGTH)
  6373*    END-EXEC
  6374     MOVE 'ELRAMT' TO DFHEIV1
  6375*    MOVE '."C                   (   #00005899' TO DFHEIV0
  6376     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6378     MOVE X'2020233030303035383939' TO DFHEIV0(25:11)
  6379     CALL 'kxdfhei1' USING DFHEIV0,
  6380           DFHEIV1,
  6381           CALCULATION-PASS-AREA,
  6382           CP-COMM-LENGTH,
  6383           DFHEIV99,
  6384           DFHEIV99,
  6385           DFHEIV99,
  6386           DFHEIV99
  6387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6388     .
  6389 0710-EXIT.
  6390     EXIT.
  6391 0720-LINK-REFUND.
  6392
  6393* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 112
* SOCK03.cbl
  6394*        PROGRAM   ('ELRFND')
  6395*        COMMAREA  (CALCULATION-PASS-AREA)
  6396*        LENGTH    (CP-COMM-LENGTH)
  6397*    END-EXEC
  6398     MOVE 'ELRFND' TO DFHEIV1
  6399*    MOVE '."C                   (   #00005908' TO DFHEIV0
  6400     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6401     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6402     MOVE X'2020233030303035393038' TO DFHEIV0(25:11)
  6403     CALL 'kxdfhei1' USING DFHEIV0,
  6404           DFHEIV1,
  6405           CALCULATION-PASS-AREA,
  6406           CP-COMM-LENGTH,
  6407           DFHEIV99,
  6408           DFHEIV99,
  6409           DFHEIV99,
  6410           DFHEIV99
  6411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6412     .
  6413 0720-EXIT.
  6414     EXIT.
  6415 0730-GET-DDF-FACTORS.
  6416     MOVE ' '                    TO WS-PDEF-RECORD-SW
  6417     MOVE WS-COMP-CD             TO ERPDEF-KEY
  6418     MOVE CM-STATE               TO ERPDEF-STATE
  6419     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6420     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  6421     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  6422     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6423     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6424
  6425* EXEC CICS STARTBR
  6426*        DATASET  ('ERPDEF')
  6427*        RIDFLD   (ERPDEF-KEY)
  6428*        GTEQ
  6429*        RESP     (WS-RESPONSE)
  6430*    END-EXEC
  6431     MOVE 'ERPDEF' TO DFHEIV1
  6432     MOVE 0
  6433       TO DFHEIV11
  6434*    MOVE '&,         G          &  N#00005925' TO DFHEIV0
  6435     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6436     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6437     MOVE X'204E233030303035393235' TO DFHEIV0(25:11)
  6438     CALL 'kxdfhei1' USING DFHEIV0,
  6439           DFHEIV1,
  6440           ERPDEF-KEY,
  6441           DFHEIV99,
  6442           DFHEIV11,
  6443           DFHEIV99
  6444     MOVE EIBRESP  TO WS-RESPONSE
  6445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6446     IF NOT RESP-NORMAL
  6447        GO TO 0730-EXIT
  6448     END-IF
  6449     .
  6450 0730-READNEXT.
  6451
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 113
* SOCK03.cbl
  6452* EXEC CICS READNEXT
  6453*       DATASET  ('ERPDEF')
  6454*       INTO     (PRODUCT-MASTER)
  6455*       RIDFLD   (ERPDEF-KEY)
  6456*       RESP     (WS-RESPONSE)
  6457*    END-EXEC
  6458     MOVE LENGTH OF
  6459      PRODUCT-MASTER
  6460       TO DFHEIV12
  6461     MOVE 'ERPDEF' TO DFHEIV1
  6462     MOVE 0
  6463       TO DFHEIV11
  6464*    MOVE '&.IL                  )  N#00005936' TO DFHEIV0
  6465     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6466     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6467     MOVE X'204E233030303035393336' TO DFHEIV0(25:11)
  6468     CALL 'kxdfhei1' USING DFHEIV0,
  6469           DFHEIV1,
  6470           PRODUCT-MASTER,
  6471           DFHEIV12,
  6472           ERPDEF-KEY,
  6473           DFHEIV99,
  6474           DFHEIV11,
  6475           DFHEIV99,
  6476           DFHEIV99
  6477     MOVE EIBRESP  TO WS-RESPONSE
  6478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6479     IF NOT RESP-NORMAL
  6480        GO TO 0730-ENDBR
  6481     END-IF
  6482     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6483        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6484           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6485        ELSE
  6486           GO TO 0730-READNEXT
  6487        END-IF
  6488     ELSE
  6489        GO TO 0730-ENDBR
  6490     END-IF
  6491     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6492        (P1 > +8)
  6493        OR (PD-PROD-CODE (P1) = 'I')
  6494     END-PERFORM
  6495     IF P1 < +9
  6496        SET DD-IU-PRESENT        TO TRUE
  6497     END-IF
  6498     IF CM-LOAN-TERM = ZEROS
  6499        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  6500     END-IF
  6501     IF PD-TRUNCATED = 'Y'
  6502        MOVE CM-LOAN-TERM        TO WS-TERM
  6503     ELSE
  6504        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  6505     END-IF
  6506     EVALUATE TRUE
  6507        WHEN WS-TERM > +168
  6508           MOVE 15               TO P1
  6509        WHEN WS-TERM > +156
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 114
* SOCK03.cbl
  6510           MOVE 14               TO P1
  6511        WHEN WS-TERM > +144
  6512           MOVE 13               TO P1
  6513        WHEN WS-TERM > +132
  6514           MOVE 12               TO P1
  6515        WHEN WS-TERM > +120
  6516           MOVE 11               TO P1
  6517        WHEN WS-TERM > +108
  6518           MOVE 10               TO P1
  6519        WHEN WS-TERM > +96
  6520           MOVE 9                TO P1
  6521        WHEN WS-TERM > +84
  6522           MOVE 8                TO P1
  6523        WHEN WS-TERM > +72
  6524           MOVE 7                TO P1
  6525        WHEN WS-TERM > +60
  6526           MOVE 6                TO P1
  6527        WHEN WS-TERM > +48
  6528           MOVE 5                TO P1
  6529        WHEN WS-TERM > +36
  6530           MOVE 4                TO P1
  6531        WHEN WS-TERM > +24
  6532           MOVE 3                TO P1
  6533        WHEN WS-TERM > +12
  6534           MOVE 2                TO P1
  6535        WHEN OTHER
  6536           MOVE 1                TO P1
  6537     END-EVALUATE
  6538     EVALUATE TRUE
  6539*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  6540*          AND (DD-IU-PRESENT)
  6541*          MOVE 2                TO P2
  6542*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  6543*          MOVE 1                TO P2
  6544        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  6545           MOVE 2                TO P2
  6546        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  6547           MOVE 3                TO P2
  6548        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  6549           MOVE 4                TO P2
  6550        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  6551           MOVE 5                TO P2
  6552        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  6553           MOVE 6                TO P2
  6554        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  6555           MOVE 7                TO P2
  6556        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  6557           MOVE 8                TO P2
  6558        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  6559           MOVE 9                TO P2
  6560        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  6561           MOVE 10               TO P2
  6562        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  6563           MOVE 11               TO P2
  6564        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  6565           MOVE 12               TO P2
  6566        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  6567           MOVE 13               TO P2
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 115
* SOCK03.cbl
  6568        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  6569           MOVE 14               TO P2
  6570        WHEN OTHER
  6571           MOVE 15               TO P2
  6572     END-EVALUATE
  6573     .
  6574 0730-ENDBR.
  6575
  6576* EXEC CICS ENDBR
  6577*       DATASET  ('ERPDEF')
  6578*    END-EXEC
  6579     MOVE 'ERPDEF' TO DFHEIV1
  6580     MOVE 0
  6581       TO DFHEIV11
  6582*    MOVE '&2                    $   #00006038' TO DFHEIV0
  6583     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6584     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6585     MOVE X'2020233030303036303338' TO DFHEIV0(25:11)
  6586     CALL 'kxdfhei1' USING DFHEIV0,
  6587           DFHEIV1,
  6588           DFHEIV11,
  6589           DFHEIV99
  6590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6591     .
  6592 0730-EXIT.
  6593     EXIT.
  6594 0740-GET-ERCTBL.
  6595     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6596     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6597     MOVE 'A'                    TO CTBL-BEN-TYPE
  6598     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  6599     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6600     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6601     IF RESP-NORMAL
  6602        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6603     ELSE
  6604        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6605        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6606        MOVE 'A'                    TO CTBL-BEN-TYPE
  6607        MOVE 'AA'                   TO CTBL-BEN-CODE
  6608        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6609        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6610        IF RESP-NORMAL
  6611           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6612        END-IF
  6613     END-IF
  6614     .
  6615 0740-EXIT.
  6616     EXIT.
  6617 0750-READ-ERCTBL.
  6618
  6619* EXEC CICS READ
  6620*         INTO    (COMM-TABLE-RECORD)
  6621*         DATASET ('ERCTBL')
  6622*         RIDFLD  (CTBL-KEY)
  6623*         RESP    (WS-RESPONSE)
  6624*    END-EXEC
  6625     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 116
* SOCK03.cbl
  6626      COMM-TABLE-RECORD
  6627       TO DFHEIV11
  6628     MOVE 'ERCTBL' TO DFHEIV1
  6629*    MOVE '&"IL       E          (  N#00006068' TO DFHEIV0
  6630     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6632     MOVE X'204E233030303036303638' TO DFHEIV0(25:11)
  6633     CALL 'kxdfhei1' USING DFHEIV0,
  6634           DFHEIV1,
  6635           COMM-TABLE-RECORD,
  6636           DFHEIV11,
  6637           CTBL-KEY,
  6638           DFHEIV99,
  6639           DFHEIV99,
  6640           DFHEIV99
  6641     MOVE EIBRESP  TO WS-RESPONSE
  6642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6643     .
  6644 0750-EXIT.
  6645     EXIT.
  6646 0760-FIND-COMM.
  6647     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  6648        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  6649        OR (C1 > +3)
  6650     END-PERFORM
  6651     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  6652        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  6653        OR (C2 > +3)
  6654     END-PERFORM
  6655     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  6656        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  6657        OR (C3 > +3)
  6658     END-PERFORM
  6659     IF C1 > +3
  6660        MOVE +1                  TO C1
  6661     END-IF
  6662     IF C2 > +3
  6663        MOVE +1                  TO C2
  6664     END-IF
  6665     IF C3 > +3
  6666        MOVE +1                  TO C3
  6667     END-IF
  6668     IF C1 = +3
  6669        MOVE +18                 TO C0
  6670     ELSE
  6671        IF C1 = +2
  6672           MOVE +9               TO C0
  6673        END-IF
  6674     END-IF
  6675     IF C2 = +3
  6676        ADD +6                   TO C0
  6677     ELSE
  6678        IF C2 = +2
  6679           ADD +3                TO C0
  6680        END-IF
  6681     END-IF
  6682     ADD C3                      TO C0
  6683     MOVE CT-RT (C0)             TO WS-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 18-Oct-13 10:53 Page 117
* SOCK03.cbl
  6684     .
  6685 0760-EXIT.
  6686     EXIT.
  6687 9700-DATE-LINK.
  6688
  6689* EXEC CICS LINK
  6690*         PROGRAM  ('ELDATCV')
  6691*         COMMAREA (DATE-CONVERSION-DATA)
  6692*         LENGTH   (DC-COMM-LENGTH)
  6693*    END-EXEC.
  6694     MOVE 'ELDATCV' TO DFHEIV1
  6695*    MOVE '."C                   (   #00006119' TO DFHEIV0
  6696     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6697     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6698     MOVE X'2020233030303036313139' TO DFHEIV0(25:11)
  6699     CALL 'kxdfhei1' USING DFHEIV0,
  6700           DFHEIV1,
  6701           DATE-CONVERSION-DATA,
  6702           DC-COMM-LENGTH,
  6703           DFHEIV99,
  6704           DFHEIV99,
  6705           DFHEIV99,
  6706           DFHEIV99
  6707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6708
  6709 9700-EXIT.
  6710      EXIT.
  6711
  6712 9999-DFHBACK SECTION.
  6713     MOVE '9%                    "   ' TO DFHEIV0
  6714     MOVE 'SOCK03' TO DFHEIV1
  6715     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6716     GOBACK.
  6717 9999-DFHEXIT.
  6718     IF DFHEIGDJ EQUAL 0001
  6719         NEXT SENTENCE.
  6720     MOVE '9%                    "   ' TO DFHEIV0
  6721     MOVE 'SOCK03' TO DFHEIV1
  6722     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6723     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       18408     Code:       28414
