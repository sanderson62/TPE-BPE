* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   1
* EL633.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL633.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   2
* EL633.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52******************************************************************
    53
    54 ENVIRONMENT DIVISION.
    55 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   3
* EL633.cbl
    57 WORKING-STORAGE SECTION.
    58 01  DFH-START PIC X(04).
    59 77  FILLER  PIC X(32)  VALUE '********************************'.
    60 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    61 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    62
    63*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    64*77  SV-COFA PIC X(42)  VALUE SPACES.
    65*77  K-SPACE PIC X(11)  VALUE SPACES.
    66
    67 01  DATE-WORK-AREAS.
    68     05  WS-GREG-STORE.
    69         10  WS-GS-MM  PIC XX.
    70         10  FILLER    PIC X.
    71         10  WS-GS-DD  PIC XX.
    72         10  FILLER    PIC X.
    73         10  WS-GS-YY  PIC XX.
    74     05  WS-SDTE-STORE.
    75         10  WS-SS-MM  PIC XX.
    76         10  WS-SS-DD  PIC XX.
    77         10  WS-SS-YY  PIC XX.
    78*                            COPY ELCSCTM.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCSCTM                             *
    83*                            VMOD=2.001                          *
    84*                                                                *
    85*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-MESSAGE.
    89     12  FILLER                          PIC X(30)
    90            VALUE '** LOGIC SECURITY VIOLATION -'.
    91     12  SM-READ                         PIC X(6).
    92     12  FILLER                          PIC X(5)
    93            VALUE ' PGM='.
    94     12  SM-PGM                          PIC X(6).
    95     12  FILLER                          PIC X(5)
    96            VALUE ' OPR='.
    97     12  SM-PROCESSOR-ID                 PIC X(4).
    98     12  FILLER                          PIC X(6)
    99            VALUE ' TERM='.
   100     12  SM-TERMID                       PIC X(4).
   101     12  FILLER                          PIC XX   VALUE SPACE.
   102     12  SM-JUL-DATE                     PIC 9(5).
   103     12  FILLER                          PIC X    VALUE SPACE.
   104     12  SM-TIME                         PIC 99.99.
   105
   106*                            COPY ELCSCRTY.
   107******************************************************************
   108*                                                                *
   109*                                                                *
   110*                            ELCSCRTY                            *
   111*                            VMOD=2.001                          *
   112*                                                                *
   113*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   114*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   4
* EL633.cbl
   115*        SAVED IN PI-SECURITY-ADDRESS.                           *
   116*                                                                *
   117******************************************************************
   118 01  SECURITY-CONTROL.
   119     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   120     12  FILLER                       PIC XX    VALUE 'SC'.
   121     12  SC-CREDIT-CODES.
   122         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   123             20  SC-CREDIT-DISPLAY    PIC X.
   124             20  SC-CREDIT-UPDATE     PIC X.
   125     12  SC-CLAIMS-CODES.
   126         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   127             20  SC-CLAIMS-DISPLAY    PIC X.
   128             20  SC-CLAIMS-UPDATE     PIC X.
   129
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   5
* EL633.cbl
   131
   132 01  STANDARD-AREAS.
   133     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   134     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   135     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   136     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   137     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   138     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   139     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   140     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   141     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   142     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   143     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   144     12  PGM-NAME            PIC  X(8).
   145     12  TIME-IN             PIC S9(7).
   146     12  TIME-OUT-R  REDEFINES  TIME-IN.
   147         16  FILLER          PIC  X.
   148         16  TIME-OUT        PIC  99V99.
   149         16  FILLER          PIC  X(2).
   150     12  EL640               PIC  X(8)       VALUE 'EL640'.
   151     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   152     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   153     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   154     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   155     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   156     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   157     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   158     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   159     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   160     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   161     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   162     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   163     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   164     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   165     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   166     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   167     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   168         88  PYAJ-1ST-READ                   VALUE 'Y'.
   169     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   170         88  FIRST-ADD                       VALUE 'Y'.
   171     12  ZERO-NDX            PIC  9          VALUE ZERO.
   172     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   173     12  WORK-SEQ-TIME       PIC  9(6).
   174     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   175         16  WORK-SEQ-HHMMS  PIC  9(5).
   176         16  FILLER          PIC  9.
   177     12  WORK-DATE-JULIAN.
   178         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   179         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   180     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   181     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   182         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   183                                                    'S' 'T' 'U'
   184                                                    'X' 'Y' 'Z'
   185                                                    'F'.
   186     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   187         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   188     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   6
* EL633.cbl
   189         88  FORCE-SHOW                      VALUE  'Y'.
   190
   191     12  WS-EOM-DTS OCCURS 13  TIMES
   192                              INDEXED BY PINDEX.
   193         16  WS-EOM-DT               PIC XX.
   194*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   195
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   7
* EL633.cbl
   197     12  WS-ERROR-CODES.
   198         16  ER-0000         PIC  X(4)       VALUE '0000'.
   199         16  ER-0008         PIC  X(4)       VALUE '0008'.
   200         16  ER-0023         PIC  X(4)       VALUE '0023'.
   201         16  ER-0029         PIC  X(4)       VALUE '0029'.
   202         16  ER-0070         PIC  X(4)       VALUE '0070'.
   203         16  ER-0587         PIC  X(4)       VALUE '0587'.
   204         16  ER-2056         PIC  X(4)       VALUE '2056'.
   205         16  ER-2230         PIC  X(4)       VALUE '2230'.
   206         16  ER-2231         PIC  X(4)       VALUE '2231'.
   207         16  ER-2232         PIC  X(4)       VALUE '2232'.
   208         16  ER-2233         PIC  X(4)       VALUE '2233'.
   209         16  ER-2234         PIC  X(4)       VALUE '2234'.
   210         16  ER-2235         PIC  X(4)       VALUE '2235'.
   211         16  ER-2236         PIC  X(4)       VALUE '2236'.
   212         16  ER-2237         PIC  X(4)       VALUE '2237'.
   213         16  ER-2238         PIC  X(4)       VALUE '2238'.
   214         16  ER-2239         PIC  X(4)       VALUE '2239'.
   215         16  ER-2244         PIC  X(4)       VALUE '2244'.
   216         16  ER-2245         PIC  X(4)       VALUE '2245'.
   217         16  ER-2246         PIC  X(4)       VALUE '2246'.
   218         16  ER-2370         PIC  X(4)       VALUE '2370'.
   219         16  ER-2432         PIC  X(4)       VALUE '2432'.
   220         16  ER-2449         PIC  X(4)       VALUE '2449'.
   221         16  ER-2587         PIC  X(4)       VALUE '2587'.
   222         16  ER-2588         PIC  X(4)       VALUE '2588'.
   223         16  ER-2595         PIC  X(4)       VALUE '2595'.
   224         16  ER-2596         PIC  X(4)       VALUE '2596'.
   225         16  ER-2763         PIC  X(4)       VALUE '2763'.
   226         16  ER-2929         PIC  X(4)       VALUE '2929'.
   227         16  ER-2957         PIC  X(4)       VALUE '2957'.
   228         16  ER-2958         PIC  X(4)       VALUE '2958'.
   229*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   230         16  ER-2960         PIC  X(4)       VALUE '2960'.
   231         16  ER-3020         PIC  X(4)       VALUE '3020'.
   232
   233*************************************************************
   234*                      TABLE OF STATE NAMES
   235*************************************************************
   236
   237 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   238     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   239                                   'CD' 'CO' 'CT' 'DC' 'DE'
   240                                   'FL' 'GA' 'GM' 'HI' 'IA'
   241                                   'ID' 'IL' 'IN' 'KS' 'KY'
   242                                   'LA' 'MA' 'MD' 'ME' 'MI'
   243                                   'MN' 'MO' 'MS' 'MT' 'MX'
   244                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   245                                   'NM' 'NV' 'NY' 'OF' 'OH'
   246                                   'OK' 'OR' 'PA' 'PI' 'PR'
   247                                   'RI' 'SC' 'SD' 'TN' 'TX'
   248                                   'UT' 'VA' 'VI' 'VT' 'WA'
   249                                   'WI' 'WV' 'WY'.
   250
   251 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   252     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   253                                 '1108125100'
   254                                 '1721211400'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   8
* EL633.cbl
   255                                 '1825011200'
   256                                 '1825011300'
   257                                 '1825099050'
   258                                 '8505700033'
   259                                 '8506400030'
   260                                 '8507200020'
   261                                 '8507200010'.
   262     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   263                                     '2725040320'
   264                                     '2725040330'
   265                                     '2725040310'
   266                                     '8506400030'
   267                                     '8507200010'
   268                                     '1108121250'.
   269     88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   270                                     '2725040110'
   271                                     '2725040120'
   272                                     '2725040130'
   273                                     '2725020400'.
   274
   275     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   276                                     '1825013200'
   277                                     '1825013300'
   278                                     '1825013400'
   279                                     '8506400030'
   280                                     '8507200010'
   281                                     '8507200020'.
   282
   283*01  WS-ACCT-BREAK.
   284*    05  WS-ACCT-1               PIC X.
   285*    05  FILLER                  PIC X(6).
   286*
   287 01  WORK-AREA.
   288     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   289     12  QID.
   290         16  QID-TERM        PIC X(04).
   291         16  FILLER          PIC X(04)       VALUE '633A'.
   292     12  DEEDIT-FIELD        PIC X(11).
   293     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   294     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   295     12  DATE-TEST-AREA      PIC  9(6).
   296     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   297         16  DATE-TEST-MM    PIC  99.
   298         16  DATE-TEST-DD    PIC  99.
   299         16  DATE-TEST-YY    PIC  99.
   300     12  DIVIDE-RESULT       PIC  99.
   301     12  DIVIDE-REMAINDER    PIC  9.
   302     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   303     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   304     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   305     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   306     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   307     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   308     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   309     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   310
   311 01  ACCESS-KEYS.
   312     12  ERPYAJ-KEY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   9
* EL633.cbl
   313         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   314         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   315         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   316         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   317         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   318         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   319         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   320
   321     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   322     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   323
   324     12  ERCHKQ-KEY.
   325         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   326         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   327         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   328     12  ERCOMP-KEY.
   329         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   330         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   331         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   332         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   333         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   334         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   335*    12  COFA-KEY-X.
   336*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   337*        16  COFA-ACCOUNT.
   338*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   339*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   340*
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  10
* EL633.cbl
   342*                                    COPY ELCDATE.
   343******************************************************************
   344*                                                                *
   345*                                                                *
   346*                            ELCDATE.                            *
   347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   348*                            VMOD=2.003
   349*                                                                *
   350*                                                                *
   351*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   352*                 LENGTH = 200                                   *
   353******************************************************************
   354
   355 01  DATE-CONVERSION-DATA.
   356     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   357     12  DC-OPTION-CODE                PIC X.
   358         88  BIN-TO-GREG                VALUE ' '.
   359         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   360         88  EDIT-GREG-TO-BIN           VALUE '2'.
   361         88  YMD-GREG-TO-BIN            VALUE '3'.
   362         88  MDY-GREG-TO-BIN            VALUE '4'.
   363         88  JULIAN-TO-BIN              VALUE '5'.
   364         88  BIN-PLUS-ELAPSED           VALUE '6'.
   365         88  FIND-CENTURY               VALUE '7'.
   366         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   367         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   368         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   369         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   370         88  JULIAN-TO-BIN-3            VALUE 'C'.
   371         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   372         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   373         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   374         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   375         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   376         88  CHECK-LEAP-YEAR            VALUE 'H'.
   377         88  BIN-3-TO-GREG              VALUE 'I'.
   378         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   379         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   380         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   381         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   382         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   383         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   384         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   385         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   386         88  THREE-CHARACTER-BIN
   387                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   388         88  GREGORIAN-TO-BIN
   389                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   390         88  BIN-TO-GREGORIAN
   391                  VALUES ' ' '1' 'I' '8' 'G'.
   392         88  JULIAN-TO-BINARY
   393                  VALUES '5' 'C' 'E' 'F'.
   394     12  DC-ERROR-CODE                 PIC X.
   395         88  NO-CONVERSION-ERROR        VALUE ' '.
   396         88  DATE-CONVERSION-ERROR
   397                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   398         88  DATE-IS-ZERO               VALUE '1'.
   399         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  11
* EL633.cbl
   400         88  DATE-IS-INVALID            VALUE '3'.
   401         88  DATE1-GREATER-DATE2        VALUE '4'.
   402         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   403         88  DATE-INVALID-OPTION        VALUE '9'.
   404         88  INVALID-CENTURY            VALUE 'A'.
   405         88  ONLY-CENTURY               VALUE 'B'.
   406         88  ONLY-LEAP-YEAR             VALUE 'C'.
   407         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   408     12  DC-END-OF-MONTH               PIC X.
   409         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   410     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   411         88  USE-NORMAL-PROCESS         VALUE ' '.
   412         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   413         88  ADJUST-UP-100-YRS          VALUE '2'.
   414     12  FILLER                        PIC X.
   415     12  DC-CONVERSION-DATES.
   416         16  DC-BIN-DATE-1             PIC XX.
   417         16  DC-BIN-DATE-2             PIC XX.
   418         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   419         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   420                       DC-GREG-DATE-1-EDIT.
   421             20  DC-EDIT1-MONTH        PIC 99.
   422             20  SLASH1-1              PIC X.
   423             20  DC-EDIT1-DAY          PIC 99.
   424             20  SLASH1-2              PIC X.
   425             20  DC-EDIT1-YEAR         PIC 99.
   426         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   427         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   428                     DC-GREG-DATE-2-EDIT.
   429             20  DC-EDIT2-MONTH        PIC 99.
   430             20  SLASH2-1              PIC X.
   431             20  DC-EDIT2-DAY          PIC 99.
   432             20  SLASH2-2              PIC X.
   433             20  DC-EDIT2-YEAR         PIC 99.
   434         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   435         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   436                     DC-GREG-DATE-1-YMD.
   437             20  DC-YMD-YEAR           PIC 99.
   438             20  DC-YMD-MONTH          PIC 99.
   439             20  DC-YMD-DAY            PIC 99.
   440         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   441         16  DC-GREG-DATE-1-MDY-R REDEFINES
   442                      DC-GREG-DATE-1-MDY.
   443             20  DC-MDY-MONTH          PIC 99.
   444             20  DC-MDY-DAY            PIC 99.
   445             20  DC-MDY-YEAR           PIC 99.
   446         16  DC-GREG-DATE-1-ALPHA.
   447             20  DC-ALPHA-MONTH        PIC X(10).
   448             20  DC-ALPHA-DAY          PIC 99.
   449             20  FILLER                PIC XX.
   450             20  DC-ALPHA-CENTURY.
   451                 24 DC-ALPHA-CEN-N     PIC 99.
   452             20  DC-ALPHA-YEAR         PIC 99.
   453         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   454         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   455         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   456         16  DC-JULIAN-DATE            PIC 9(05).
   457         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  12
* EL633.cbl
   458                                       PIC 9(05).
   459         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   460             20  DC-JULIAN-YEAR        PIC 99.
   461             20  DC-JULIAN-DAYS        PIC 999.
   462         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   463         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   464         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   465     12  DATE-CONVERSION-VARIBLES.
   466         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   467         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   468             20  FILLER                PIC 9(3).
   469             20  HOLD-CEN-1-CCYY.
   470                 24  HOLD-CEN-1-CC     PIC 99.
   471                 24  HOLD-CEN-1-YY     PIC 99.
   472             20  HOLD-CEN-1-MO         PIC 99.
   473             20  HOLD-CEN-1-DA         PIC 99.
   474         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   475             20  HOLD-CEN-1-R-MO       PIC 99.
   476             20  HOLD-CEN-1-R-DA       PIC 99.
   477             20  HOLD-CEN-1-R-CCYY.
   478                 24  HOLD-CEN-1-R-CC   PIC 99.
   479                 24  HOLD-CEN-1-R-YY   PIC 99.
   480             20  FILLER                PIC 9(3).
   481         16  HOLD-CENTURY-1-X.
   482             20  FILLER                PIC X(3)  VALUE SPACES.
   483             20  HOLD-CEN-1-X-CCYY.
   484                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   485                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   486             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   487             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   488         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   489             20  HOLD-CEN-1-R-X-MO     PIC XX.
   490             20  HOLD-CEN-1-R-X-DA     PIC XX.
   491             20  HOLD-CEN-1-R-X-CCYY.
   492                 24  HOLD-CEN-1-R-X-CC PIC XX.
   493                 24  HOLD-CEN-1-R-X-YY PIC XX.
   494             20  FILLER                PIC XXX.
   495         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   496         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   497         16  DC-JULIAN-DATE-1          PIC 9(07).
   498         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   499             20  DC-JULIAN-1-CCYY.
   500                 24  DC-JULIAN-1-CC    PIC 99.
   501                 24  DC-JULIAN-1-YR    PIC 99.
   502             20  DC-JULIAN-DA-1        PIC 999.
   503         16  DC-JULIAN-DATE-2          PIC 9(07).
   504         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   505             20  DC-JULIAN-2-CCYY.
   506                 24  DC-JULIAN-2-CC    PIC 99.
   507                 24  DC-JULIAN-2-YR    PIC 99.
   508             20  DC-JULIAN-DA-2        PIC 999.
   509         16  DC-GREG-DATE-A-EDIT.
   510             20  DC-EDITA-MONTH        PIC 99.
   511             20  SLASHA-1              PIC X VALUE '/'.
   512             20  DC-EDITA-DAY          PIC 99.
   513             20  SLASHA-2              PIC X VALUE '/'.
   514             20  DC-EDITA-CCYY.
   515                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  13
* EL633.cbl
   516                 24  DC-EDITA-YEAR     PIC 99.
   517         16  DC-GREG-DATE-B-EDIT.
   518             20  DC-EDITB-MONTH        PIC 99.
   519             20  SLASHB-1              PIC X VALUE '/'.
   520             20  DC-EDITB-DAY          PIC 99.
   521             20  SLASHB-2              PIC X VALUE '/'.
   522             20  DC-EDITB-CCYY.
   523                 24  DC-EDITB-CENT     PIC 99.
   524                 24  DC-EDITB-YEAR     PIC 99.
   525         16  DC-GREG-DATE-CYMD         PIC 9(08).
   526         16  DC-GREG-DATE-CYMD-R REDEFINES
   527                              DC-GREG-DATE-CYMD.
   528             20  DC-CYMD-CEN           PIC 99.
   529             20  DC-CYMD-YEAR          PIC 99.
   530             20  DC-CYMD-MONTH         PIC 99.
   531             20  DC-CYMD-DAY           PIC 99.
   532         16  DC-GREG-DATE-MDCY         PIC 9(08).
   533         16  DC-GREG-DATE-MDCY-R REDEFINES
   534                              DC-GREG-DATE-MDCY.
   535             20  DC-MDCY-MONTH         PIC 99.
   536             20  DC-MDCY-DAY           PIC 99.
   537             20  DC-MDCY-CEN           PIC 99.
   538             20  DC-MDCY-YEAR          PIC 99.
   539    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   540        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   541    12  DC-EL310-DATE                  PIC X(21).
   542    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  14
* EL633.cbl
   544*                                    COPY ELCLOGOF.
   545******************************************************************
   546*                                                                *
   547*                                                                *
   548*                            ELCLOGOF.                           *
   549*                            VMOD=2.001                          *
   550*                                                                *
   551*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   552*                                                                *
   553******************************************************************
   554 01  CLASIC-LOGOFF.
   555     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   556     12  LOGOFF-TEXT.
   557         16  FILLER          PIC X(5)    VALUE SPACES.
   558         16  LOGOFF-MSG.
   559             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   560             20  FILLER      PIC X       VALUE SPACES.
   561             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   562         16  FILLER          PIC X(80)
   563           VALUE '* YOU ARE NOW LOGGED OFF'.
   564         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   565         16  FILLER          PIC X       VALUE QUOTE.
   566         16  LOGOFF-SYS-MSG  PIC X(17)
   567           VALUE 'S CLAS-IC SYSTEM '.
   568     12  TEXT-MESSAGES.
   569         16  UNACCESS-MSG    PIC X(29)
   570             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   571         16  PGMIDERR-MSG    PIC X(17)
   572             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  15
* EL633.cbl
   574*                                    COPY ELCATTR.
   575******************************************************************
   576*                                                                *
   577*                            ELCATTR.                            *
   578*                            VMOD=2.001                          *
   579*                                                                *
   580*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   581*                                                                *
   582*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   583*                                                                *
   584*                   POS 1   P=PROTECTED                          *
   585*                           U=UNPROTECTED                        *
   586*                           S=ASKIP                              *
   587*                   POS 2   A=ALPHA/NUMERIC                      *
   588*                           N=NUMERIC                            *
   589*                   POS 3   N=NORMAL                             *
   590*                           B=BRIGHT                             *
   591*                           D=DARK                               *
   592*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   593*                           OF=MODIFIED DATA TAG OFF             *
   594*                                                                *
   595*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   596******************************************************************
   597 01  ATTRIBUTE-LIST.
   598     12  AL-PABOF            PIC X       VALUE 'Y'.
   599     12  AL-PABON            PIC X       VALUE 'Z'.
   600     12  AL-PADOF            PIC X       VALUE '%'.
   601     12  AL-PADON            PIC X       VALUE '_'.
   602     12  AL-PANOF            PIC X       VALUE '-'.
   603     12  AL-PANON            PIC X       VALUE '/'.
   604     12  AL-SABOF            PIC X       VALUE '8'.
   605     12  AL-SABON            PIC X       VALUE '9'.
   606     12  AL-SADOF            PIC X       VALUE '@'.
   607     12  AL-SADON            PIC X       VALUE QUOTE.
   608     12  AL-SANOF            PIC X       VALUE '0'.
   609     12  AL-SANON            PIC X       VALUE '1'.
   610     12  AL-UABOF            PIC X       VALUE 'H'.
   611     12  AL-UABON            PIC X       VALUE 'I'.
   612     12  AL-UADOF            PIC X       VALUE '<'.
   613     12  AL-UADON            PIC X       VALUE '('.
   614     12  AL-UANOF            PIC X       VALUE ' '.
   615     12  AL-UANON            PIC X       VALUE 'A'.
   616     12  AL-UNBOF            PIC X       VALUE 'Q'.
   617     12  AL-UNBON            PIC X       VALUE 'R'.
   618     12  AL-UNDOF            PIC X       VALUE '*'.
   619     12  AL-UNDON            PIC X       VALUE ')'.
   620     12  AL-UNNOF            PIC X       VALUE '&'.
   621     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  16
* EL633.cbl
   623*                                    COPY ELCEMIB.
   624******************************************************************
   625*                                                                *
   626*                                                                *
   627*                            ELCEMIB.                            *
   628*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   629*                            VMOD=2.005                          *
   630*                                                                *
   631*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   632*                                                                *
   633******************************************************************
   634 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   635     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   636     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   637     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   638     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   639     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   640     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   641     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   642     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   643     12  EMI-SWITCH1             PIC X        VALUE '1'.
   644         88  EMI-NO-ERRORS                    VALUE '1'.
   645         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   646         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   647     12  EMI-SWITCH2             PIC X        VALUE '1'.
   648         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   649     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   650         88  EMI-AREA1-EMPTY                  VALUE '1'.
   651         88  EMI-AREA1-FULL                   VALUE '2'.
   652     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   653         88  EMI-AREA2-EMPTY                  VALUE '1'.
   654         88  EMI-AREA2-FULL                   VALUE '2'.
   655     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   656         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   657         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   658         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   659         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   660         88  EMI-BYPASS-FATALS                VALUE 'X'.
   661     12  EMI-ERROR-LINES.
   662         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   663         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   664         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   665         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   666             20  EMI-ERR-CODES OCCURS 10 TIMES.
   667                 24  EMI-ERR-NUM         PIC X(4).
   668                 24  EMI-FILLER          PIC X.
   669                 24  EMI-SEV             PIC X.
   670                 24  FILLER              PIC X.
   671             20  FILLER                  PIC X(02).
   672     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   673         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   674             20  EMI-ERROR-NUMBER    PIC X(4).
   675             20  EMI-FILL            PIC X.
   676             20  EMI-SEVERITY        PIC X.
   677             20  FILLER              PIC X.
   678             20  EMI-ERROR-TEXT.
   679                 24  EMI-TEXT-VARIABLE   PIC X(10).
   680                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  17
* EL633.cbl
   681     12  EMI-SEVERITY-SAVE           PIC X.
   682         88  EMI-NOTE                    VALUE 'N'.
   683         88  EMI-WARNING                 VALUE 'W'.
   684         88  EMI-FORCABLE                VALUE 'F'.
   685         88  EMI-FATAL                   VALUE 'X'.
   686     12  EMI-MESSAGE-FLAG            PIC X.
   687         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   688         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   689     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   690     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   691         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   692         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   693         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   694     12  FILLER                      PIC X(137)  VALUE SPACES.
   695     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   696     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   697     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   698     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  18
* EL633.cbl
   700*                                    COPY ELCINTF.
   701******************************************************************
   702*                                                                *
   703*                                                                *
   704*                            ELCINTF.                            *
   705*                            VMOD=2.017                          *
   706*                                                                *
   707*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   708*                                                                *
   709*       LENGTH = 1024                                            *
   710*                                                                *
   711******************************************************************
   712 01  PROGRAM-INTERFACE-BLOCK.
   713     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   714     12  PI-CALLING-PROGRAM              PIC X(8).
   715     12  PI-SAVED-PROGRAM-1              PIC X(8).
   716     12  PI-SAVED-PROGRAM-2              PIC X(8).
   717     12  PI-SAVED-PROGRAM-3              PIC X(8).
   718     12  PI-SAVED-PROGRAM-4              PIC X(8).
   719     12  PI-SAVED-PROGRAM-5              PIC X(8).
   720     12  PI-SAVED-PROGRAM-6              PIC X(8).
   721     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   722     12  PI-COMPANY-ID                   PIC XXX.
   723     12  PI-COMPANY-CD                   PIC X.
   724
   725     12  PI-COMPANY-PASSWORD             PIC X(8).
   726
   727     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   728
   729     12  PI-CONTROL-IN-PROGRESS.
   730         16  PI-CARRIER                  PIC X.
   731         16  PI-GROUPING                 PIC X(6).
   732         16  PI-STATE                    PIC XX.
   733         16  PI-ACCOUNT                  PIC X(10).
   734         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   735                                         PIC X(10).
   736         16  PI-CLAIM-CERT-GRP.
   737             20  PI-CLAIM-NO             PIC X(7).
   738             20  PI-CERT-NO.
   739                 25  PI-CERT-PRIME       PIC X(10).
   740                 25  PI-CERT-SFX         PIC X.
   741             20  PI-CERT-EFF-DT          PIC XX.
   742         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   743             20  PI-PLAN-CODE            PIC X(2).
   744             20  PI-REVISION-NUMBER      PIC X(3).
   745             20  PI-PLAN-EFF-DT          PIC X(2).
   746             20  PI-PLAN-EXP-DT          PIC X(2).
   747             20  FILLER                  PIC X(11).
   748         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   749             20  PI-OE-REFERENCE-1.
   750                 25  PI-OE-REF-1-PRIME   PIC X(18).
   751                 25  PI-OE-REF-1-SUFF    PIC XX.
   752
   753     12  PI-SESSION-IN-PROGRESS          PIC X.
   754         88  CLAIM-SESSION                   VALUE '1'.
   755         88  CREDIT-SESSION                  VALUE '2'.
   756         88  WARRANTY-SESSION                VALUE '3'.
   757         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  19
* EL633.cbl
   758         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   759
   760
   761*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   762
   763     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   764     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   765
   766     12  PI-CREDIT-USER                  PIC X.
   767         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   768         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   769
   770     12  PI-CLAIM-USER                   PIC X.
   771         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   772         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   773
   774     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   775         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   776         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   777         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   778         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   779         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   780
   781     12  PI-PROCESSOR-ID                 PIC X(4).
   782
   783     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   784
   785     12  PI-MEMBER-CAPTION               PIC X(10).
   786
   787     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   788         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   789
   790     12  PI-LIFE-OVERRIDE-L1             PIC X.
   791     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   792     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   793     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   794
   795     12  PI-AH-OVERRIDE-L1               PIC X.
   796     12  PI-AH-OVERRIDE-L2               PIC XX.
   797     12  PI-AH-OVERRIDE-L6               PIC X(6).
   798     12  PI-AH-OVERRIDE-L12              PIC X(12).
   799
   800     12  PI-NEW-SYSTEM                   PIC X(2).
   801
   802     12  PI-PRIMARY-CERT-NO              PIC X(11).
   803     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   804         88  PI-USES-PAID-TO                 VALUE '1'.
   805     12  PI-CRDTCRD-SYSTEM.
   806         16  PI-CRDTCRD-USER             PIC X.
   807             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   808             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   809         16  PI-CC-MONTH-END-DT          PIC XX.
   810     12  PI-PROCESSOR-PRINTER            PIC X(4).
   811
   812     12  PI-OE-REFERENCE-2.
   813         16  PI-OE-REF-2-PRIME           PIC X(10).
   814         16  PI-OE-REF-2-SUFF            PIC X.
   815
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  20
* EL633.cbl
   816     12  PI-REM-TRM-CALC-OPTION          PIC X.
   817
   818     12  PI-LANGUAGE-TYPE                PIC X.
   819             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   820             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   821             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   822
   823     12  PI-POLICY-LINKAGE-IND           PIC X.
   824         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   825         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   826                                                   LOW-VALUES.
   827
   828     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   829     12  PI-CLAIM-PW-SESSION             PIC X(1).
   830         88  PI-CLAIM-CREDIT                 VALUE '1'.
   831         88  PI-CLAIM-CONVEN                 VALUE '2'.
   832     12  FILLER                          PIC X(4).
   833
   834     12  PI-SYSTEM-LEVEL                 PIC X(145).
   835
   836     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   837         PI-SYSTEM-LEVEL.
   838
   839         16  PI-ENTRY-CODES.
   840             20  PI-ENTRY-CD-1           PIC X.
   841             20  PI-ENTRY-CD-2           PIC X.
   842
   843         16  PI-RETURN-CODES.
   844             20  PI-RETURN-CD-1          PIC X.
   845             20  PI-RETURN-CD-2          PIC X.
   846
   847         16  PI-UPDATE-STATUS-SAVE.
   848             20  PI-UPDATE-BY            PIC X(4).
   849             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   850
   851         16  PI-LOWER-CASE-LETTERS       PIC X.
   852             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   853
   854*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   855*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   856*            88  CARRIER-CLM-CNTL            VALUE '2'.
   857
   858         16  PI-CERT-ACCESS-CONTROL      PIC X.
   859             88  ST-ACCNT-CNTL               VALUE ' '.
   860             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   861             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   862             88  ACCNT-CNTL                  VALUE '3'.
   863             88  CARR-ACCNT-CNTL             VALUE '4'.
   864
   865         16  PI-PROCESSOR-CAP-LIST.
   866             20  PI-SYSTEM-CONTROLS.
   867                24 PI-SYSTEM-DISPLAY     PIC X.
   868                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   869                24 PI-SYSTEM-MODIFY      PIC X.
   870                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   871             20  FILLER                  PIC XX.
   872             20  PI-DISPLAY-CAP          PIC X.
   873                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  21
* EL633.cbl
   874             20  PI-MODIFY-CAP           PIC X.
   875                 88  MODIFY-CAP              VALUE 'Y'.
   876             20  PI-MSG-AT-LOGON-CAP     PIC X.
   877                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   878             20  PI-FORCE-CAP            PIC X.
   879                 88  FORCE-CAP               VALUE 'Y'.
   880
   881         16  PI-PROGRAM-CONTROLS.
   882             20  PI-PGM-PRINT-OPT        PIC X.
   883             20  PI-PGM-FORMAT-OPT       PIC X.
   884             20  PI-PGM-PROCESS-OPT      PIC X.
   885             20  PI-PGM-TOTALS-OPT       PIC X.
   886
   887         16  PI-HELP-INTERFACE.
   888             20  PI-LAST-ERROR-NO        PIC X(4).
   889             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   890
   891         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   892             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   893
   894         16  PI-CR-CONTROL-IN-PROGRESS.
   895             20  PI-CR-CARRIER           PIC X.
   896             20  PI-CR-GROUPING          PIC X(6).
   897             20  PI-CR-STATE             PIC XX.
   898             20  PI-CR-ACCOUNT           PIC X(10).
   899             20  PI-CR-FIN-RESP          PIC X(10).
   900             20  PI-CR-TYPE              PIC X.
   901
   902         16  PI-CR-BATCH-NUMBER          PIC X(6).
   903
   904         16  PI-CR-MONTH-END-DT          PIC XX.
   905
   906         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   907             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   908             88  PI-ZERO-CARRIER             VALUE '1'.
   909             88  PI-ZERO-GROUPING            VALUE '2'.
   910             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   911
   912         16  PI-CARRIER-SECURITY         PIC X.
   913             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   914
   915         16  PI-ACCOUNT-SECURITY         PIC X(10).
   916             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   917             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   918
   919         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   920             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   921                                         INDEXED BY PI-ACCESS-NDX
   922                                         PIC X.
   923
   924         16  PI-GA-BILLING-CONTROL       PIC X.
   925             88  PI-GA-BILLING               VALUE '1'.
   926
   927         16  PI-MAIL-PROCESSING          PIC X.
   928             88  PI-MAIL-YES                 VALUE 'Y'.
   929
   930         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   931
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  22
* EL633.cbl
   932         16  PI-AR-SYSTEM.
   933             20  PI-AR-PROCESSING-CNTL   PIC X.
   934                 88  PI-AR-PROCESSING        VALUE 'Y'.
   935             20  PI-AR-SUMMARY-CODE      PIC X(6).
   936             20  PI-AR-MONTH-END-DT      PIC XX.
   937
   938         16  PI-MP-SYSTEM.
   939             20  PI-MORTGAGE-USER            PIC X.
   940                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   941                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   942             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   943                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   944                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   945                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   946                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   947                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   948             20  PI-MP-MONTH-END-DT          PIC XX.
   949             20  PI-MP-REFERENCE-NO.
   950                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   951                 24  PI-MP-REFERENCE-SFX     PIC XX.
   952
   953         16  PI-LABEL-CONTROL            PIC X(01).
   954             88  PI-CREATE-LABELS                    VALUE 'Y'.
   955             88  PI-BYPASS-LABELS                    VALUE 'N'.
   956
   957         16  PI-BILL-GROUPING-CODE       PIC X(01).
   958             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   959
   960         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   961             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   962             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   963
   964         16  FILLER                      PIC X(14).
   965
   966     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   967******************************************************************
   968     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   969         16  PI-PYAJ-FILE-SW             PIC  X.
   970             88  END-OF-ACCT                 VALUE 'A'.
   971             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
   972             88  END-OF-FILE                 VALUE 'X'.
   973             88  TOP-OF-FILE                 VALUE 'T'.
   974             88  PAGE-FULL                   VALUE 'F'.
   975             88  NO-RECORDS                  VALUE 'Y'.
   976             88  NOT-OPEN                    VALUE 'Z'.
   977         16  PI-PREV-FUNCTION            PIC  X.
   978         16  PI-SAV-FUNCTION             PIC  X.
   979         16  PI-PREV-PFKEY               PIC  X.
   980         16  PI-SEQ-NOS.
   981             20  FILLER  OCCURS 13 TIMES
   982                             INDEXED BY NDX.
   983                 24  PI-REC-TYPE         PIC  X.
   984                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
   985         16  PI-SAV-ENDING-PYAJ-KEY.
   986             20  PI-SAV-COMP-CD          PIC  X.
   987             20  PI-SAV-COMP-CONTROL.
   988                 24  PI-SAV-CARRIER      PIC  X.
   989                 24  PI-SAV-GROUPING     PIC  X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  23
* EL633.cbl
   990                 24  PI-SAV-FIN-RESP     PIC  X(10).
   991                 24  PI-SAV-ACCOUNT      PIC  X(10).
   992                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
   993                 24  PI-SAV-RECORD-TYPE  PIC  X.
   994         16  PI-START-PYAJ-KEY           PIC  X(33).
   995         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
   996         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
   997         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
   998         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
   999         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1000             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1001         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1002         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1003         16  PI-FRST-RECORD-TYPE         PIC  X.
  1004         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1005         16  PI-PREV-RECORD-TYPE         PIC  X.
  1006         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1007         16  PI-LAST-RECORD-TYPE         PIC  X.
  1008         16  PI-PAGE-SW                  PIC  X.
  1009             88  FIRST-PAGE                          VALUE 'Y'.
  1010         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  24
* EL633.cbl
  1012*                            COPY ELCJPFX.
  1013******************************************************************
  1014*                                                                *
  1015*                                                                *
  1016*                            ELCJPFX.                            *
  1017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1018*                            VMOD=2.002                          *
  1019*                                                                *
  1020*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1021*                                                                *
  1022*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1023*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1024*        ELCNTL - CONTROL FILE                                   *
  1025*        ELMSTR - CLAIM MASTERS                                  *
  1026*        ELTRLR - ACTIVITY TRAILERS                              *
  1027*        ELCHKQ - CHECK QUE                                      *
  1028******************************************************************
  1029 01  JOURNAL-RECORD.
  1030     12  JP-USER-ID                  PIC X(4).
  1031     12  JP-FILE-ID                  PIC X(8).
  1032     12  JP-PROGRAM-ID               PIC X(8).
  1033     12  JP-RECORD-TYPE              PIC X.
  1034         88 JP-ADD              VALUE 'A'.
  1035         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1036         88 JP-AFTER-CHANGE     VALUE 'C'.
  1037         88 JP-DELETE           VALUE 'D'.
  1038         88 JP-GENERIC-DELETE   VALUE 'G'.
  1039         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1040         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1041     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1042     12  JP-RECORD-AREA
  1043
  1044
  1045                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  25
* EL633.cbl
  1047*                            COPY ELCAID.
  1048******************************************************************
  1049*                                                                *
  1050*                            ELCAID.                             *
  1051*                            VMOD=2.001                          *
  1052*                                                                *
  1053*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1054*                                                                *
  1055*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1056*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1057******************************************************************
  1058
  1059 01  DFHAID.
  1060   02  DFHNULL   PIC  X  VALUE  ' '.
  1061   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1062   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1063   02  DFHPEN    PIC  X  VALUE  '='.
  1064   02  DFHOPID   PIC  X  VALUE  'W'.
  1065   02  DFHPA1    PIC  X  VALUE  '%'.
  1066   02  DFHPA2    PIC  X  VALUE  '>'.
  1067   02  DFHPA3    PIC  X  VALUE  ','.
  1068   02  DFHPF1    PIC  X  VALUE  '1'.
  1069   02  DFHPF2    PIC  X  VALUE  '2'.
  1070   02  DFHPF3    PIC  X  VALUE  '3'.
  1071   02  DFHPF4    PIC  X  VALUE  '4'.
  1072   02  DFHPF5    PIC  X  VALUE  '5'.
  1073   02  DFHPF6    PIC  X  VALUE  '6'.
  1074   02  DFHPF7    PIC  X  VALUE  '7'.
  1075   02  DFHPF8    PIC  X  VALUE  '8'.
  1076   02  DFHPF9    PIC  X  VALUE  '9'.
  1077   02  DFHPF10   PIC  X  VALUE  ':'.
  1078   02  DFHPF11   PIC  X  VALUE  '#'.
  1079   02  DFHPF12   PIC  X  VALUE  '@'.
  1080   02  DFHPF13   PIC  X  VALUE  'A'.
  1081   02  DFHPF14   PIC  X  VALUE  'B'.
  1082   02  DFHPF15   PIC  X  VALUE  'C'.
  1083   02  DFHPF16   PIC  X  VALUE  'D'.
  1084   02  DFHPF17   PIC  X  VALUE  'E'.
  1085   02  DFHPF18   PIC  X  VALUE  'F'.
  1086   02  DFHPF19   PIC  X  VALUE  'G'.
  1087   02  DFHPF20   PIC  X  VALUE  'H'.
  1088   02  DFHPF21   PIC  X  VALUE  'I'.
  1089*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1090   02  DFHPF22   PIC  X  VALUE  '['.
  1091   02  DFHPF23   PIC  X  VALUE  '.'.
  1092   02  DFHPF24   PIC  X  VALUE  '<'.
  1093   02  DFHMSRE   PIC  X  VALUE  'X'.
  1094   02  DFHSTRF   PIC  X  VALUE  'h'.
  1095   02  DFHTRIG   PIC  X  VALUE  '"'.
  1096
  1097 01  FILLER  REDEFINES  DFHAID.
  1098     12  FILLER              PIC  X(8).
  1099     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  26
* EL633.cbl
  1101*                            COPY EL633S.
  1102 01  EL633AI.
  1103     05  FILLER            PIC  X(0012).
  1104*    -------------------------------
  1105     05  DATEL PIC S9(0004) COMP.
  1106     05  DATEF PIC  X(0001).
  1107     05  FILLER REDEFINES DATEF.
  1108         10  DATEA PIC  X(0001).
  1109     05  DATEI PIC  X(0008).
  1110*    -------------------------------
  1111     05  TIMEL PIC S9(0004) COMP.
  1112     05  TIMEF PIC  X(0001).
  1113     05  FILLER REDEFINES TIMEF.
  1114         10  TIMEA PIC  X(0001).
  1115     05  TIMEI PIC  X(0005).
  1116*    -------------------------------
  1117     05  CMPNYIDL PIC S9(0004) COMP.
  1118     05  CMPNYIDF PIC  X(0001).
  1119     05  FILLER REDEFINES CMPNYIDF.
  1120         10  CMPNYIDA PIC  X(0001).
  1121     05  CMPNYIDI PIC  X(0003).
  1122*    -------------------------------
  1123     05  USERIDL PIC S9(0004) COMP.
  1124     05  USERIDF PIC  X(0001).
  1125     05  FILLER REDEFINES USERIDF.
  1126         10  USERIDA PIC  X(0001).
  1127     05  USERIDI PIC  X(0004).
  1128*    -------------------------------
  1129     05  MAINTL PIC S9(0004) COMP.
  1130     05  MAINTF PIC  X(0001).
  1131     05  FILLER REDEFINES MAINTF.
  1132         10  MAINTA PIC  X(0001).
  1133     05  MAINTI PIC  X(0001).
  1134*    -------------------------------
  1135     05  CARRIERL PIC S9(0004) COMP.
  1136     05  CARRIERF PIC  X(0001).
  1137     05  FILLER REDEFINES CARRIERF.
  1138         10  CARRIERA PIC  X(0001).
  1139     05  CARRIERI PIC  X(0001).
  1140*    -------------------------------
  1141     05  GROUPL PIC S9(0004) COMP.
  1142     05  GROUPF PIC  X(0001).
  1143     05  FILLER REDEFINES GROUPF.
  1144         10  GROUPA PIC  X(0001).
  1145     05  GROUPI PIC  X(0006).
  1146*    -------------------------------
  1147     05  FINRESPL PIC S9(0004) COMP.
  1148     05  FINRESPF PIC  X(0001).
  1149     05  FILLER REDEFINES FINRESPF.
  1150         10  FINRESPA PIC  X(0001).
  1151     05  FINRESPI PIC  X(0010).
  1152*    -------------------------------
  1153     05  ACCTL PIC S9(0004) COMP.
  1154     05  ACCTF PIC  X(0001).
  1155     05  FILLER REDEFINES ACCTF.
  1156         10  ACCTA PIC  X(0001).
  1157     05  ACCTI PIC  X(0010).
  1158*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  27
* EL633.cbl
  1159     05  MSAAC1L PIC S9(0004) COMP.
  1160     05  MSAAC1F PIC  X(0001).
  1161     05  FILLER REDEFINES MSAAC1F.
  1162         10  MSAAC1A PIC  X(0001).
  1163     05  MSAAC1I PIC  X(0010).
  1164*    -------------------------------
  1165     05  MSAST1L PIC S9(0004) COMP.
  1166     05  MSAST1F PIC  X(0001).
  1167     05  FILLER REDEFINES MSAST1F.
  1168         10  MSAST1A PIC  X(0001).
  1169     05  MSAST1I PIC  X(0002).
  1170*    -------------------------------
  1171     05  MSACN1L PIC S9(0004) COMP.
  1172     05  MSACN1F PIC  X(0001).
  1173     05  FILLER REDEFINES MSACN1F.
  1174         10  MSACN1A PIC  X(0001).
  1175     05  MSACN1I PIC  X(0001).
  1176*    -------------------------------
  1177     05  MSACM1L PIC S9(0004) COMP.
  1178     05  MSACM1F PIC  X(0001).
  1179     05  FILLER REDEFINES MSACM1F.
  1180         10  MSACM1A PIC  X(0001).
  1181     05  MSACM1I PIC  X(0010).
  1182*    -------------------------------
  1183     05  TYPE1L PIC S9(0004) COMP.
  1184     05  TYPE1F PIC  X(0001).
  1185     05  FILLER REDEFINES TYPE1F.
  1186         10  TYPE1A PIC  X(0001).
  1187     05  TYPE1I PIC  X(0001).
  1188*    -------------------------------
  1189     05  AMT1L PIC S9(0004) COMP.
  1190     05  AMT1F PIC  X(0001).
  1191     05  FILLER REDEFINES AMT1F.
  1192         10  AMT1A PIC  X(0001).
  1193     05  AMT1I PIC  X(0011).
  1194*    -------------------------------
  1195     05  VOID1L PIC S9(0004) COMP.
  1196     05  VOID1F PIC  X(0001).
  1197     05  FILLER REDEFINES VOID1F.
  1198         10  VOID1A PIC  X(0001).
  1199     05  VOID1I PIC  X(0001).
  1200*    -------------------------------
  1201     05  MDT1L PIC S9(0004) COMP.
  1202     05  MDT1F PIC  X(0001).
  1203     05  FILLER REDEFINES MDT1F.
  1204         10  MDT1A PIC  X(0001).
  1205     05  MDT1I PIC  X(0006).
  1206*    -------------------------------
  1207     05  BDT1L PIC S9(0004) COMP.
  1208     05  BDT1F PIC  X(0001).
  1209     05  FILLER REDEFINES BDT1F.
  1210         10  BDT1A PIC  X(0001).
  1211     05  BDT1I PIC  X(0006).
  1212*    -------------------------------
  1213     05  SDT1L PIC S9(0004) COMP.
  1214     05  SDT1F PIC  X(0001).
  1215     05  FILLER REDEFINES SDT1F.
  1216         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  28
* EL633.cbl
  1217     05  SDT1I PIC  X(0006).
  1218*    -------------------------------
  1219     05  MSAAC2L PIC S9(0004) COMP.
  1220     05  MSAAC2F PIC  X(0001).
  1221     05  FILLER REDEFINES MSAAC2F.
  1222         10  MSAAC2A PIC  X(0001).
  1223     05  MSAAC2I PIC  X(0010).
  1224*    -------------------------------
  1225     05  MSAST2L PIC S9(0004) COMP.
  1226     05  MSAST2F PIC  X(0001).
  1227     05  FILLER REDEFINES MSAST2F.
  1228         10  MSAST2A PIC  X(0001).
  1229     05  MSAST2I PIC  X(0002).
  1230*    -------------------------------
  1231     05  MSACN2L PIC S9(0004) COMP.
  1232     05  MSACN2F PIC  X(0001).
  1233     05  FILLER REDEFINES MSACN2F.
  1234         10  MSACN2A PIC  X(0001).
  1235     05  MSACN2I PIC  X(0001).
  1236*    -------------------------------
  1237     05  MSACM2L PIC S9(0004) COMP.
  1238     05  MSACM2F PIC  X(0001).
  1239     05  FILLER REDEFINES MSACM2F.
  1240         10  MSACM2A PIC  X(0001).
  1241     05  MSACM2I PIC  X(0010).
  1242*    -------------------------------
  1243     05  TYPE2L PIC S9(0004) COMP.
  1244     05  TYPE2F PIC  X(0001).
  1245     05  FILLER REDEFINES TYPE2F.
  1246         10  TYPE2A PIC  X(0001).
  1247     05  TYPE2I PIC  X(0001).
  1248*    -------------------------------
  1249     05  AMT2L PIC S9(0004) COMP.
  1250     05  AMT2F PIC  X(0001).
  1251     05  FILLER REDEFINES AMT2F.
  1252         10  AMT2A PIC  X(0001).
  1253     05  AMT2I PIC  X(0011).
  1254*    -------------------------------
  1255     05  VOID2L PIC S9(0004) COMP.
  1256     05  VOID2F PIC  X(0001).
  1257     05  FILLER REDEFINES VOID2F.
  1258         10  VOID2A PIC  X(0001).
  1259     05  VOID2I PIC  X(0001).
  1260*    -------------------------------
  1261     05  MDT2L PIC S9(0004) COMP.
  1262     05  MDT2F PIC  X(0001).
  1263     05  FILLER REDEFINES MDT2F.
  1264         10  MDT2A PIC  X(0001).
  1265     05  MDT2I PIC  X(0006).
  1266*    -------------------------------
  1267     05  BDT2L PIC S9(0004) COMP.
  1268     05  BDT2F PIC  X(0001).
  1269     05  FILLER REDEFINES BDT2F.
  1270         10  BDT2A PIC  X(0001).
  1271     05  BDT2I PIC  X(0006).
  1272*    -------------------------------
  1273     05  SDT2L PIC S9(0004) COMP.
  1274     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  29
* EL633.cbl
  1275     05  FILLER REDEFINES SDT2F.
  1276         10  SDT2A PIC  X(0001).
  1277     05  SDT2I PIC  X(0006).
  1278*    -------------------------------
  1279     05  MSAAC3L PIC S9(0004) COMP.
  1280     05  MSAAC3F PIC  X(0001).
  1281     05  FILLER REDEFINES MSAAC3F.
  1282         10  MSAAC3A PIC  X(0001).
  1283     05  MSAAC3I PIC  X(0010).
  1284*    -------------------------------
  1285     05  MSAST3L PIC S9(0004) COMP.
  1286     05  MSAST3F PIC  X(0001).
  1287     05  FILLER REDEFINES MSAST3F.
  1288         10  MSAST3A PIC  X(0001).
  1289     05  MSAST3I PIC  X(0002).
  1290*    -------------------------------
  1291     05  MSACN3L PIC S9(0004) COMP.
  1292     05  MSACN3F PIC  X(0001).
  1293     05  FILLER REDEFINES MSACN3F.
  1294         10  MSACN3A PIC  X(0001).
  1295     05  MSACN3I PIC  X(0001).
  1296*    -------------------------------
  1297     05  MSACM3L PIC S9(0004) COMP.
  1298     05  MSACM3F PIC  X(0001).
  1299     05  FILLER REDEFINES MSACM3F.
  1300         10  MSACM3A PIC  X(0001).
  1301     05  MSACM3I PIC  X(0010).
  1302*    -------------------------------
  1303     05  TYPE3L PIC S9(0004) COMP.
  1304     05  TYPE3F PIC  X(0001).
  1305     05  FILLER REDEFINES TYPE3F.
  1306         10  TYPE3A PIC  X(0001).
  1307     05  TYPE3I PIC  X(0001).
  1308*    -------------------------------
  1309     05  AMT3L PIC S9(0004) COMP.
  1310     05  AMT3F PIC  X(0001).
  1311     05  FILLER REDEFINES AMT3F.
  1312         10  AMT3A PIC  X(0001).
  1313     05  AMT3I PIC  X(0011).
  1314*    -------------------------------
  1315     05  VOID3L PIC S9(0004) COMP.
  1316     05  VOID3F PIC  X(0001).
  1317     05  FILLER REDEFINES VOID3F.
  1318         10  VOID3A PIC  X(0001).
  1319     05  VOID3I PIC  X(0001).
  1320*    -------------------------------
  1321     05  MDT3L PIC S9(0004) COMP.
  1322     05  MDT3F PIC  X(0001).
  1323     05  FILLER REDEFINES MDT3F.
  1324         10  MDT3A PIC  X(0001).
  1325     05  MDT3I PIC  X(0006).
  1326*    -------------------------------
  1327     05  BDT3L PIC S9(0004) COMP.
  1328     05  BDT3F PIC  X(0001).
  1329     05  FILLER REDEFINES BDT3F.
  1330         10  BDT3A PIC  X(0001).
  1331     05  BDT3I PIC  X(0006).
  1332*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  30
* EL633.cbl
  1333     05  SDT3L PIC S9(0004) COMP.
  1334     05  SDT3F PIC  X(0001).
  1335     05  FILLER REDEFINES SDT3F.
  1336         10  SDT3A PIC  X(0001).
  1337     05  SDT3I PIC  X(0006).
  1338*    -------------------------------
  1339     05  MSAAC4L PIC S9(0004) COMP.
  1340     05  MSAAC4F PIC  X(0001).
  1341     05  FILLER REDEFINES MSAAC4F.
  1342         10  MSAAC4A PIC  X(0001).
  1343     05  MSAAC4I PIC  X(0010).
  1344*    -------------------------------
  1345     05  MSAST4L PIC S9(0004) COMP.
  1346     05  MSAST4F PIC  X(0001).
  1347     05  FILLER REDEFINES MSAST4F.
  1348         10  MSAST4A PIC  X(0001).
  1349     05  MSAST4I PIC  X(0002).
  1350*    -------------------------------
  1351     05  MSACN4L PIC S9(0004) COMP.
  1352     05  MSACN4F PIC  X(0001).
  1353     05  FILLER REDEFINES MSACN4F.
  1354         10  MSACN4A PIC  X(0001).
  1355     05  MSACN4I PIC  X(0001).
  1356*    -------------------------------
  1357     05  MSACM4L PIC S9(0004) COMP.
  1358     05  MSACM4F PIC  X(0001).
  1359     05  FILLER REDEFINES MSACM4F.
  1360         10  MSACM4A PIC  X(0001).
  1361     05  MSACM4I PIC  X(0010).
  1362*    -------------------------------
  1363     05  TYPE4L PIC S9(0004) COMP.
  1364     05  TYPE4F PIC  X(0001).
  1365     05  FILLER REDEFINES TYPE4F.
  1366         10  TYPE4A PIC  X(0001).
  1367     05  TYPE4I PIC  X(0001).
  1368*    -------------------------------
  1369     05  AMT4L PIC S9(0004) COMP.
  1370     05  AMT4F PIC  X(0001).
  1371     05  FILLER REDEFINES AMT4F.
  1372         10  AMT4A PIC  X(0001).
  1373     05  AMT4I PIC  X(0011).
  1374*    -------------------------------
  1375     05  VOID4L PIC S9(0004) COMP.
  1376     05  VOID4F PIC  X(0001).
  1377     05  FILLER REDEFINES VOID4F.
  1378         10  VOID4A PIC  X(0001).
  1379     05  VOID4I PIC  X(0001).
  1380*    -------------------------------
  1381     05  MDT4L PIC S9(0004) COMP.
  1382     05  MDT4F PIC  X(0001).
  1383     05  FILLER REDEFINES MDT4F.
  1384         10  MDT4A PIC  X(0001).
  1385     05  MDT4I PIC  X(0006).
  1386*    -------------------------------
  1387     05  BDT4L PIC S9(0004) COMP.
  1388     05  BDT4F PIC  X(0001).
  1389     05  FILLER REDEFINES BDT4F.
  1390         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  31
* EL633.cbl
  1391     05  BDT4I PIC  X(0006).
  1392*    -------------------------------
  1393     05  SDT4L PIC S9(0004) COMP.
  1394     05  SDT4F PIC  X(0001).
  1395     05  FILLER REDEFINES SDT4F.
  1396         10  SDT4A PIC  X(0001).
  1397     05  SDT4I PIC  X(0006).
  1398*    -------------------------------
  1399     05  MSAAC5L PIC S9(0004) COMP.
  1400     05  MSAAC5F PIC  X(0001).
  1401     05  FILLER REDEFINES MSAAC5F.
  1402         10  MSAAC5A PIC  X(0001).
  1403     05  MSAAC5I PIC  X(0010).
  1404*    -------------------------------
  1405     05  MSAST5L PIC S9(0004) COMP.
  1406     05  MSAST5F PIC  X(0001).
  1407     05  FILLER REDEFINES MSAST5F.
  1408         10  MSAST5A PIC  X(0001).
  1409     05  MSAST5I PIC  X(0002).
  1410*    -------------------------------
  1411     05  MSACN5L PIC S9(0004) COMP.
  1412     05  MSACN5F PIC  X(0001).
  1413     05  FILLER REDEFINES MSACN5F.
  1414         10  MSACN5A PIC  X(0001).
  1415     05  MSACN5I PIC  X(0001).
  1416*    -------------------------------
  1417     05  MSACM5L PIC S9(0004) COMP.
  1418     05  MSACM5F PIC  X(0001).
  1419     05  FILLER REDEFINES MSACM5F.
  1420         10  MSACM5A PIC  X(0001).
  1421     05  MSACM5I PIC  X(0010).
  1422*    -------------------------------
  1423     05  TYPE5L PIC S9(0004) COMP.
  1424     05  TYPE5F PIC  X(0001).
  1425     05  FILLER REDEFINES TYPE5F.
  1426         10  TYPE5A PIC  X(0001).
  1427     05  TYPE5I PIC  X(0001).
  1428*    -------------------------------
  1429     05  AMT5L PIC S9(0004) COMP.
  1430     05  AMT5F PIC  X(0001).
  1431     05  FILLER REDEFINES AMT5F.
  1432         10  AMT5A PIC  X(0001).
  1433     05  AMT5I PIC  X(0011).
  1434*    -------------------------------
  1435     05  VOID5L PIC S9(0004) COMP.
  1436     05  VOID5F PIC  X(0001).
  1437     05  FILLER REDEFINES VOID5F.
  1438         10  VOID5A PIC  X(0001).
  1439     05  VOID5I PIC  X(0001).
  1440*    -------------------------------
  1441     05  MDT5L PIC S9(0004) COMP.
  1442     05  MDT5F PIC  X(0001).
  1443     05  FILLER REDEFINES MDT5F.
  1444         10  MDT5A PIC  X(0001).
  1445     05  MDT5I PIC  X(0006).
  1446*    -------------------------------
  1447     05  BDT5L PIC S9(0004) COMP.
  1448     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  32
* EL633.cbl
  1449     05  FILLER REDEFINES BDT5F.
  1450         10  BDT5A PIC  X(0001).
  1451     05  BDT5I PIC  X(0006).
  1452*    -------------------------------
  1453     05  SDT5L PIC S9(0004) COMP.
  1454     05  SDT5F PIC  X(0001).
  1455     05  FILLER REDEFINES SDT5F.
  1456         10  SDT5A PIC  X(0001).
  1457     05  SDT5I PIC  X(0006).
  1458*    -------------------------------
  1459     05  MSAAC6L PIC S9(0004) COMP.
  1460     05  MSAAC6F PIC  X(0001).
  1461     05  FILLER REDEFINES MSAAC6F.
  1462         10  MSAAC6A PIC  X(0001).
  1463     05  MSAAC6I PIC  X(0010).
  1464*    -------------------------------
  1465     05  MSAST6L PIC S9(0004) COMP.
  1466     05  MSAST6F PIC  X(0001).
  1467     05  FILLER REDEFINES MSAST6F.
  1468         10  MSAST6A PIC  X(0001).
  1469     05  MSAST6I PIC  X(0002).
  1470*    -------------------------------
  1471     05  MSACN6L PIC S9(0004) COMP.
  1472     05  MSACN6F PIC  X(0001).
  1473     05  FILLER REDEFINES MSACN6F.
  1474         10  MSACN6A PIC  X(0001).
  1475     05  MSACN6I PIC  X(0001).
  1476*    -------------------------------
  1477     05  MSACM6L PIC S9(0004) COMP.
  1478     05  MSACM6F PIC  X(0001).
  1479     05  FILLER REDEFINES MSACM6F.
  1480         10  MSACM6A PIC  X(0001).
  1481     05  MSACM6I PIC  X(0010).
  1482*    -------------------------------
  1483     05  TYPE6L PIC S9(0004) COMP.
  1484     05  TYPE6F PIC  X(0001).
  1485     05  FILLER REDEFINES TYPE6F.
  1486         10  TYPE6A PIC  X(0001).
  1487     05  TYPE6I PIC  X(0001).
  1488*    -------------------------------
  1489     05  AMT6L PIC S9(0004) COMP.
  1490     05  AMT6F PIC  X(0001).
  1491     05  FILLER REDEFINES AMT6F.
  1492         10  AMT6A PIC  X(0001).
  1493     05  AMT6I PIC  X(0011).
  1494*    -------------------------------
  1495     05  VOID6L PIC S9(0004) COMP.
  1496     05  VOID6F PIC  X(0001).
  1497     05  FILLER REDEFINES VOID6F.
  1498         10  VOID6A PIC  X(0001).
  1499     05  VOID6I PIC  X(0001).
  1500*    -------------------------------
  1501     05  MDT6L PIC S9(0004) COMP.
  1502     05  MDT6F PIC  X(0001).
  1503     05  FILLER REDEFINES MDT6F.
  1504         10  MDT6A PIC  X(0001).
  1505     05  MDT6I PIC  X(0006).
  1506*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  33
* EL633.cbl
  1507     05  BDT6L PIC S9(0004) COMP.
  1508     05  BDT6F PIC  X(0001).
  1509     05  FILLER REDEFINES BDT6F.
  1510         10  BDT6A PIC  X(0001).
  1511     05  BDT6I PIC  X(0006).
  1512*    -------------------------------
  1513     05  SDT6L PIC S9(0004) COMP.
  1514     05  SDT6F PIC  X(0001).
  1515     05  FILLER REDEFINES SDT6F.
  1516         10  SDT6A PIC  X(0001).
  1517     05  SDT6I PIC  X(0006).
  1518*    -------------------------------
  1519     05  MSAAC7L PIC S9(0004) COMP.
  1520     05  MSAAC7F PIC  X(0001).
  1521     05  FILLER REDEFINES MSAAC7F.
  1522         10  MSAAC7A PIC  X(0001).
  1523     05  MSAAC7I PIC  X(0010).
  1524*    -------------------------------
  1525     05  MSAST7L PIC S9(0004) COMP.
  1526     05  MSAST7F PIC  X(0001).
  1527     05  FILLER REDEFINES MSAST7F.
  1528         10  MSAST7A PIC  X(0001).
  1529     05  MSAST7I PIC  X(0002).
  1530*    -------------------------------
  1531     05  MSACN7L PIC S9(0004) COMP.
  1532     05  MSACN7F PIC  X(0001).
  1533     05  FILLER REDEFINES MSACN7F.
  1534         10  MSACN7A PIC  X(0001).
  1535     05  MSACN7I PIC  X(0001).
  1536*    -------------------------------
  1537     05  MSACM7L PIC S9(0004) COMP.
  1538     05  MSACM7F PIC  X(0001).
  1539     05  FILLER REDEFINES MSACM7F.
  1540         10  MSACM7A PIC  X(0001).
  1541     05  MSACM7I PIC  X(0010).
  1542*    -------------------------------
  1543     05  TYPE7L PIC S9(0004) COMP.
  1544     05  TYPE7F PIC  X(0001).
  1545     05  FILLER REDEFINES TYPE7F.
  1546         10  TYPE7A PIC  X(0001).
  1547     05  TYPE7I PIC  X(0001).
  1548*    -------------------------------
  1549     05  AMT7L PIC S9(0004) COMP.
  1550     05  AMT7F PIC  X(0001).
  1551     05  FILLER REDEFINES AMT7F.
  1552         10  AMT7A PIC  X(0001).
  1553     05  AMT7I PIC  X(0011).
  1554*    -------------------------------
  1555     05  VOID7L PIC S9(0004) COMP.
  1556     05  VOID7F PIC  X(0001).
  1557     05  FILLER REDEFINES VOID7F.
  1558         10  VOID7A PIC  X(0001).
  1559     05  VOID7I PIC  X(0001).
  1560*    -------------------------------
  1561     05  MDT7L PIC S9(0004) COMP.
  1562     05  MDT7F PIC  X(0001).
  1563     05  FILLER REDEFINES MDT7F.
  1564         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  34
* EL633.cbl
  1565     05  MDT7I PIC  X(0006).
  1566*    -------------------------------
  1567     05  BDT7L PIC S9(0004) COMP.
  1568     05  BDT7F PIC  X(0001).
  1569     05  FILLER REDEFINES BDT7F.
  1570         10  BDT7A PIC  X(0001).
  1571     05  BDT7I PIC  X(0006).
  1572*    -------------------------------
  1573     05  SDT7L PIC S9(0004) COMP.
  1574     05  SDT7F PIC  X(0001).
  1575     05  FILLER REDEFINES SDT7F.
  1576         10  SDT7A PIC  X(0001).
  1577     05  SDT7I PIC  X(0006).
  1578*    -------------------------------
  1579     05  MSAAC8L PIC S9(0004) COMP.
  1580     05  MSAAC8F PIC  X(0001).
  1581     05  FILLER REDEFINES MSAAC8F.
  1582         10  MSAAC8A PIC  X(0001).
  1583     05  MSAAC8I PIC  X(0010).
  1584*    -------------------------------
  1585     05  MSAST8L PIC S9(0004) COMP.
  1586     05  MSAST8F PIC  X(0001).
  1587     05  FILLER REDEFINES MSAST8F.
  1588         10  MSAST8A PIC  X(0001).
  1589     05  MSAST8I PIC  X(0002).
  1590*    -------------------------------
  1591     05  MSACN8L PIC S9(0004) COMP.
  1592     05  MSACN8F PIC  X(0001).
  1593     05  FILLER REDEFINES MSACN8F.
  1594         10  MSACN8A PIC  X(0001).
  1595     05  MSACN8I PIC  X(0001).
  1596*    -------------------------------
  1597     05  MSACM8L PIC S9(0004) COMP.
  1598     05  MSACM8F PIC  X(0001).
  1599     05  FILLER REDEFINES MSACM8F.
  1600         10  MSACM8A PIC  X(0001).
  1601     05  MSACM8I PIC  X(0010).
  1602*    -------------------------------
  1603     05  TYPE8L PIC S9(0004) COMP.
  1604     05  TYPE8F PIC  X(0001).
  1605     05  FILLER REDEFINES TYPE8F.
  1606         10  TYPE8A PIC  X(0001).
  1607     05  TYPE8I PIC  X(0001).
  1608*    -------------------------------
  1609     05  AMT8L PIC S9(0004) COMP.
  1610     05  AMT8F PIC  X(0001).
  1611     05  FILLER REDEFINES AMT8F.
  1612         10  AMT8A PIC  X(0001).
  1613     05  AMT8I PIC  X(0011).
  1614*    -------------------------------
  1615     05  VOID8L PIC S9(0004) COMP.
  1616     05  VOID8F PIC  X(0001).
  1617     05  FILLER REDEFINES VOID8F.
  1618         10  VOID8A PIC  X(0001).
  1619     05  VOID8I PIC  X(0001).
  1620*    -------------------------------
  1621     05  MDT8L PIC S9(0004) COMP.
  1622     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  35
* EL633.cbl
  1623     05  FILLER REDEFINES MDT8F.
  1624         10  MDT8A PIC  X(0001).
  1625     05  MDT8I PIC  X(0006).
  1626*    -------------------------------
  1627     05  BDT8L PIC S9(0004) COMP.
  1628     05  BDT8F PIC  X(0001).
  1629     05  FILLER REDEFINES BDT8F.
  1630         10  BDT8A PIC  X(0001).
  1631     05  BDT8I PIC  X(0006).
  1632*    -------------------------------
  1633     05  SDT8L PIC S9(0004) COMP.
  1634     05  SDT8F PIC  X(0001).
  1635     05  FILLER REDEFINES SDT8F.
  1636         10  SDT8A PIC  X(0001).
  1637     05  SDT8I PIC  X(0006).
  1638*    -------------------------------
  1639     05  MSAAC9L PIC S9(0004) COMP.
  1640     05  MSAAC9F PIC  X(0001).
  1641     05  FILLER REDEFINES MSAAC9F.
  1642         10  MSAAC9A PIC  X(0001).
  1643     05  MSAAC9I PIC  X(0010).
  1644*    -------------------------------
  1645     05  MSAST9L PIC S9(0004) COMP.
  1646     05  MSAST9F PIC  X(0001).
  1647     05  FILLER REDEFINES MSAST9F.
  1648         10  MSAST9A PIC  X(0001).
  1649     05  MSAST9I PIC  X(0002).
  1650*    -------------------------------
  1651     05  MSACN9L PIC S9(0004) COMP.
  1652     05  MSACN9F PIC  X(0001).
  1653     05  FILLER REDEFINES MSACN9F.
  1654         10  MSACN9A PIC  X(0001).
  1655     05  MSACN9I PIC  X(0001).
  1656*    -------------------------------
  1657     05  MSACM9L PIC S9(0004) COMP.
  1658     05  MSACM9F PIC  X(0001).
  1659     05  FILLER REDEFINES MSACM9F.
  1660         10  MSACM9A PIC  X(0001).
  1661     05  MSACM9I PIC  X(0010).
  1662*    -------------------------------
  1663     05  TYPE9L PIC S9(0004) COMP.
  1664     05  TYPE9F PIC  X(0001).
  1665     05  FILLER REDEFINES TYPE9F.
  1666         10  TYPE9A PIC  X(0001).
  1667     05  TYPE9I PIC  X(0001).
  1668*    -------------------------------
  1669     05  AMT9L PIC S9(0004) COMP.
  1670     05  AMT9F PIC  X(0001).
  1671     05  FILLER REDEFINES AMT9F.
  1672         10  AMT9A PIC  X(0001).
  1673     05  AMT9I PIC  X(0011).
  1674*    -------------------------------
  1675     05  VOID9L PIC S9(0004) COMP.
  1676     05  VOID9F PIC  X(0001).
  1677     05  FILLER REDEFINES VOID9F.
  1678         10  VOID9A PIC  X(0001).
  1679     05  VOID9I PIC  X(0001).
  1680*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  36
* EL633.cbl
  1681     05  MDT9L PIC S9(0004) COMP.
  1682     05  MDT9F PIC  X(0001).
  1683     05  FILLER REDEFINES MDT9F.
  1684         10  MDT9A PIC  X(0001).
  1685     05  MDT9I PIC  X(0006).
  1686*    -------------------------------
  1687     05  BDT9L PIC S9(0004) COMP.
  1688     05  BDT9F PIC  X(0001).
  1689     05  FILLER REDEFINES BDT9F.
  1690         10  BDT9A PIC  X(0001).
  1691     05  BDT9I PIC  X(0006).
  1692*    -------------------------------
  1693     05  SDT9L PIC S9(0004) COMP.
  1694     05  SDT9F PIC  X(0001).
  1695     05  FILLER REDEFINES SDT9F.
  1696         10  SDT9A PIC  X(0001).
  1697     05  SDT9I PIC  X(0006).
  1698*    -------------------------------
  1699     05  MSAAC10L PIC S9(0004) COMP.
  1700     05  MSAAC10F PIC  X(0001).
  1701     05  FILLER REDEFINES MSAAC10F.
  1702         10  MSAAC10A PIC  X(0001).
  1703     05  MSAAC10I PIC  X(0010).
  1704*    -------------------------------
  1705     05  MSAST10L PIC S9(0004) COMP.
  1706     05  MSAST10F PIC  X(0001).
  1707     05  FILLER REDEFINES MSAST10F.
  1708         10  MSAST10A PIC  X(0001).
  1709     05  MSAST10I PIC  X(0002).
  1710*    -------------------------------
  1711     05  MSACN10L PIC S9(0004) COMP.
  1712     05  MSACN10F PIC  X(0001).
  1713     05  FILLER REDEFINES MSACN10F.
  1714         10  MSACN10A PIC  X(0001).
  1715     05  MSACN10I PIC  X(0001).
  1716*    -------------------------------
  1717     05  MSACM10L PIC S9(0004) COMP.
  1718     05  MSACM10F PIC  X(0001).
  1719     05  FILLER REDEFINES MSACM10F.
  1720         10  MSACM10A PIC  X(0001).
  1721     05  MSACM10I PIC  X(0010).
  1722*    -------------------------------
  1723     05  TYPE10L PIC S9(0004) COMP.
  1724     05  TYPE10F PIC  X(0001).
  1725     05  FILLER REDEFINES TYPE10F.
  1726         10  TYPE10A PIC  X(0001).
  1727     05  TYPE10I PIC  X(0001).
  1728*    -------------------------------
  1729     05  AMT10L PIC S9(0004) COMP.
  1730     05  AMT10F PIC  X(0001).
  1731     05  FILLER REDEFINES AMT10F.
  1732         10  AMT10A PIC  X(0001).
  1733     05  AMT10I PIC  X(0011).
  1734*    -------------------------------
  1735     05  VOID10L PIC S9(0004) COMP.
  1736     05  VOID10F PIC  X(0001).
  1737     05  FILLER REDEFINES VOID10F.
  1738         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  37
* EL633.cbl
  1739     05  VOID10I PIC  X(0001).
  1740*    -------------------------------
  1741     05  MDT10L PIC S9(0004) COMP.
  1742     05  MDT10F PIC  X(0001).
  1743     05  FILLER REDEFINES MDT10F.
  1744         10  MDT10A PIC  X(0001).
  1745     05  MDT10I PIC  X(0006).
  1746*    -------------------------------
  1747     05  BDT10L PIC S9(0004) COMP.
  1748     05  BDT10F PIC  X(0001).
  1749     05  FILLER REDEFINES BDT10F.
  1750         10  BDT10A PIC  X(0001).
  1751     05  BDT10I PIC  X(0006).
  1752*    -------------------------------
  1753     05  SDT10L PIC S9(0004) COMP.
  1754     05  SDT10F PIC  X(0001).
  1755     05  FILLER REDEFINES SDT10F.
  1756         10  SDT10A PIC  X(0001).
  1757     05  SDT10I PIC  X(0006).
  1758*    -------------------------------
  1759     05  MSAAC11L PIC S9(0004) COMP.
  1760     05  MSAAC11F PIC  X(0001).
  1761     05  FILLER REDEFINES MSAAC11F.
  1762         10  MSAAC11A PIC  X(0001).
  1763     05  MSAAC11I PIC  X(0010).
  1764*    -------------------------------
  1765     05  MSAST11L PIC S9(0004) COMP.
  1766     05  MSAST11F PIC  X(0001).
  1767     05  FILLER REDEFINES MSAST11F.
  1768         10  MSAST11A PIC  X(0001).
  1769     05  MSAST11I PIC  X(0002).
  1770*    -------------------------------
  1771     05  MSACN11L PIC S9(0004) COMP.
  1772     05  MSACN11F PIC  X(0001).
  1773     05  FILLER REDEFINES MSACN11F.
  1774         10  MSACN11A PIC  X(0001).
  1775     05  MSACN11I PIC  X(0001).
  1776*    -------------------------------
  1777     05  MSACM11L PIC S9(0004) COMP.
  1778     05  MSACM11F PIC  X(0001).
  1779     05  FILLER REDEFINES MSACM11F.
  1780         10  MSACM11A PIC  X(0001).
  1781     05  MSACM11I PIC  X(0010).
  1782*    -------------------------------
  1783     05  TYPE11L PIC S9(0004) COMP.
  1784     05  TYPE11F PIC  X(0001).
  1785     05  FILLER REDEFINES TYPE11F.
  1786         10  TYPE11A PIC  X(0001).
  1787     05  TYPE11I PIC  X(0001).
  1788*    -------------------------------
  1789     05  AMT11L PIC S9(0004) COMP.
  1790     05  AMT11F PIC  X(0001).
  1791     05  FILLER REDEFINES AMT11F.
  1792         10  AMT11A PIC  X(0001).
  1793     05  AMT11I PIC  X(0011).
  1794*    -------------------------------
  1795     05  VOID11L PIC S9(0004) COMP.
  1796     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  38
* EL633.cbl
  1797     05  FILLER REDEFINES VOID11F.
  1798         10  VOID11A PIC  X(0001).
  1799     05  VOID11I PIC  X(0001).
  1800*    -------------------------------
  1801     05  MDT11L PIC S9(0004) COMP.
  1802     05  MDT11F PIC  X(0001).
  1803     05  FILLER REDEFINES MDT11F.
  1804         10  MDT11A PIC  X(0001).
  1805     05  MDT11I PIC  X(0006).
  1806*    -------------------------------
  1807     05  BDT11L PIC S9(0004) COMP.
  1808     05  BDT11F PIC  X(0001).
  1809     05  FILLER REDEFINES BDT11F.
  1810         10  BDT11A PIC  X(0001).
  1811     05  BDT11I PIC  X(0006).
  1812*    -------------------------------
  1813     05  SDT11L PIC S9(0004) COMP.
  1814     05  SDT11F PIC  X(0001).
  1815     05  FILLER REDEFINES SDT11F.
  1816         10  SDT11A PIC  X(0001).
  1817     05  SDT11I PIC  X(0006).
  1818*    -------------------------------
  1819     05  MSAAC12L PIC S9(0004) COMP.
  1820     05  MSAAC12F PIC  X(0001).
  1821     05  FILLER REDEFINES MSAAC12F.
  1822         10  MSAAC12A PIC  X(0001).
  1823     05  MSAAC12I PIC  X(0010).
  1824*    -------------------------------
  1825     05  MSAST12L PIC S9(0004) COMP.
  1826     05  MSAST12F PIC  X(0001).
  1827     05  FILLER REDEFINES MSAST12F.
  1828         10  MSAST12A PIC  X(0001).
  1829     05  MSAST12I PIC  X(0002).
  1830*    -------------------------------
  1831     05  MSACN12L PIC S9(0004) COMP.
  1832     05  MSACN12F PIC  X(0001).
  1833     05  FILLER REDEFINES MSACN12F.
  1834         10  MSACN12A PIC  X(0001).
  1835     05  MSACN12I PIC  X(0001).
  1836*    -------------------------------
  1837     05  MSACM12L PIC S9(0004) COMP.
  1838     05  MSACM12F PIC  X(0001).
  1839     05  FILLER REDEFINES MSACM12F.
  1840         10  MSACM12A PIC  X(0001).
  1841     05  MSACM12I PIC  X(0010).
  1842*    -------------------------------
  1843     05  TYPE12L PIC S9(0004) COMP.
  1844     05  TYPE12F PIC  X(0001).
  1845     05  FILLER REDEFINES TYPE12F.
  1846         10  TYPE12A PIC  X(0001).
  1847     05  TYPE12I PIC  X(0001).
  1848*    -------------------------------
  1849     05  AMT12L PIC S9(0004) COMP.
  1850     05  AMT12F PIC  X(0001).
  1851     05  FILLER REDEFINES AMT12F.
  1852         10  AMT12A PIC  X(0001).
  1853     05  AMT12I PIC  X(0011).
  1854*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  39
* EL633.cbl
  1855     05  VOID12L PIC S9(0004) COMP.
  1856     05  VOID12F PIC  X(0001).
  1857     05  FILLER REDEFINES VOID12F.
  1858         10  VOID12A PIC  X(0001).
  1859     05  VOID12I PIC  X(0001).
  1860*    -------------------------------
  1861     05  MDT12L PIC S9(0004) COMP.
  1862     05  MDT12F PIC  X(0001).
  1863     05  FILLER REDEFINES MDT12F.
  1864         10  MDT12A PIC  X(0001).
  1865     05  MDT12I PIC  X(0006).
  1866*    -------------------------------
  1867     05  BDT12L PIC S9(0004) COMP.
  1868     05  BDT12F PIC  X(0001).
  1869     05  FILLER REDEFINES BDT12F.
  1870         10  BDT12A PIC  X(0001).
  1871     05  BDT12I PIC  X(0006).
  1872*    -------------------------------
  1873     05  SDT12L PIC S9(0004) COMP.
  1874     05  SDT12F PIC  X(0001).
  1875     05  FILLER REDEFINES SDT12F.
  1876         10  SDT12A PIC  X(0001).
  1877     05  SDT12I PIC  X(0006).
  1878*    -------------------------------
  1879     05  MSAAC13L PIC S9(0004) COMP.
  1880     05  MSAAC13F PIC  X(0001).
  1881     05  FILLER REDEFINES MSAAC13F.
  1882         10  MSAAC13A PIC  X(0001).
  1883     05  MSAAC13I PIC  X(0010).
  1884*    -------------------------------
  1885     05  MSAST13L PIC S9(0004) COMP.
  1886     05  MSAST13F PIC  X(0001).
  1887     05  FILLER REDEFINES MSAST13F.
  1888         10  MSAST13A PIC  X(0001).
  1889     05  MSAST13I PIC  X(0002).
  1890*    -------------------------------
  1891     05  MSACN13L PIC S9(0004) COMP.
  1892     05  MSACN13F PIC  X(0001).
  1893     05  FILLER REDEFINES MSACN13F.
  1894         10  MSACN13A PIC  X(0001).
  1895     05  MSACN13I PIC  X(0001).
  1896*    -------------------------------
  1897     05  MSACM13L PIC S9(0004) COMP.
  1898     05  MSACM13F PIC  X(0001).
  1899     05  FILLER REDEFINES MSACM13F.
  1900         10  MSACM13A PIC  X(0001).
  1901     05  MSACM13I PIC  X(0010).
  1902*    -------------------------------
  1903     05  TYPE13L PIC S9(0004) COMP.
  1904     05  TYPE13F PIC  X(0001).
  1905     05  FILLER REDEFINES TYPE13F.
  1906         10  TYPE13A PIC  X(0001).
  1907     05  TYPE13I PIC  X(0001).
  1908*    -------------------------------
  1909     05  AMT13L PIC S9(0004) COMP.
  1910     05  AMT13F PIC  X(0001).
  1911     05  FILLER REDEFINES AMT13F.
  1912         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  40
* EL633.cbl
  1913     05  AMT13I PIC  X(0011).
  1914*    -------------------------------
  1915     05  VOID13L PIC S9(0004) COMP.
  1916     05  VOID13F PIC  X(0001).
  1917     05  FILLER REDEFINES VOID13F.
  1918         10  VOID13A PIC  X(0001).
  1919     05  VOID13I PIC  X(0001).
  1920*    -------------------------------
  1921     05  MDT13L PIC S9(0004) COMP.
  1922     05  MDT13F PIC  X(0001).
  1923     05  FILLER REDEFINES MDT13F.
  1924         10  MDT13A PIC  X(0001).
  1925     05  MDT13I PIC  X(0006).
  1926*    -------------------------------
  1927     05  BDT13L PIC S9(0004) COMP.
  1928     05  BDT13F PIC  X(0001).
  1929     05  FILLER REDEFINES BDT13F.
  1930         10  BDT13A PIC  X(0001).
  1931     05  BDT13I PIC  X(0006).
  1932*    -------------------------------
  1933     05  SDT13L PIC S9(0004) COMP.
  1934     05  SDT13F PIC  X(0001).
  1935     05  FILLER REDEFINES SDT13F.
  1936         10  SDT13A PIC  X(0001).
  1937     05  SDT13I PIC  X(0006).
  1938*    -------------------------------
  1939     05  ERRMSG1L PIC S9(0004) COMP.
  1940     05  ERRMSG1F PIC  X(0001).
  1941     05  FILLER REDEFINES ERRMSG1F.
  1942         10  ERRMSG1A PIC  X(0001).
  1943     05  ERRMSG1I PIC  X(0079).
  1944*    -------------------------------
  1945     05  ERRMSG2L PIC S9(0004) COMP.
  1946     05  ERRMSG2F PIC  X(0001).
  1947     05  FILLER REDEFINES ERRMSG2F.
  1948         10  ERRMSG2A PIC  X(0001).
  1949     05  ERRMSG2I PIC  X(0079).
  1950*    -------------------------------
  1951     05  PFENTERL PIC S9(0004) COMP.
  1952     05  PFENTERF PIC  X(0001).
  1953     05  FILLER REDEFINES PFENTERF.
  1954         10  PFENTERA PIC  X(0001).
  1955     05  PFENTERI PIC  9(2).
  1956 01  EL633AO REDEFINES EL633AI.
  1957     05  FILLER            PIC  X(0012).
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  DATEO PIC  X(0008).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  TIMEO PIC  99.99.
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  CMPNYIDO PIC  X(0003).
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  USERIDO PIC  X(0004).
  1970*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  41
* EL633.cbl
  1971     05  FILLER            PIC  X(0003).
  1972     05  MAINTO PIC  X(0001).
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  CARRIERO PIC  X(0001).
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  GROUPO PIC  X(0006).
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  FINRESPO PIC  X(0010).
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  ACCTO PIC  X(0010).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  MSAAC1O PIC  X(0010).
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  MSAST1O PIC  X(0002).
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  MSACN1O PIC  X(0001).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  MSACM1O PIC  X(0010).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  TYPE1O PIC  X(0001).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  AMT1O PIC  X(0011).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  VOID1O PIC  X(0001).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  MDT1O PIC  X(0006).
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  BDT1O PIC  X(0006).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  SDT1O PIC  X(0006).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  MSAAC2O PIC  X(0010).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  MSAST2O PIC  X(0002).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  MSACN2O PIC  X(0001).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  MSACM2O PIC  X(0010).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  42
* EL633.cbl
  2029     05  TYPE2O PIC  X(0001).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  AMT2O PIC  X(0011).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  VOID2O PIC  X(0001).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  MDT2O PIC  X(0006).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  BDT2O PIC  X(0006).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  SDT2O PIC  X(0006).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  MSAAC3O PIC  X(0010).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  MSAST3O PIC  X(0002).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  MSACN3O PIC  X(0001).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  MSACM3O PIC  X(0010).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  TYPE3O PIC  X(0001).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  AMT3O PIC  X(0011).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  VOID3O PIC  X(0001).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  MDT3O PIC  X(0006).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  BDT3O PIC  X(0006).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  SDT3O PIC  X(0006).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  MSAAC4O PIC  X(0010).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  MSAST4O PIC  X(0002).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  MSACN4O PIC  X(0001).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  43
* EL633.cbl
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  TYPE4O PIC  X(0001).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  AMT4O PIC  X(0011).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  VOID4O PIC  X(0001).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  MDT4O PIC  X(0006).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  BDT4O PIC  X(0006).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  SDT4O PIC  X(0006).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  MSAAC5O PIC  X(0010).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  MSAST5O PIC  X(0002).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  MSACN5O PIC  X(0001).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  MSACM5O PIC  X(0010).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  TYPE5O PIC  X(0001).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  AMT5O PIC  X(0011).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  VOID5O PIC  X(0001).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  MDT5O PIC  X(0006).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  BDT5O PIC  X(0006).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  SDT5O PIC  X(0006).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  MSAAC6O PIC  X(0010).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  MSAST6O PIC  X(0002).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  MSACN6O PIC  X(0001).
  2144*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  44
* EL633.cbl
  2145     05  FILLER            PIC  X(0003).
  2146     05  MSACM6O PIC  X(0010).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  TYPE6O PIC  X(0001).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  AMT6O PIC  X(0011).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  VOID6O PIC  X(0001).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  MDT6O PIC  X(0006).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  BDT6O PIC  X(0006).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  SDT6O PIC  X(0006).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  MSAAC7O PIC  X(0010).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  MSAST7O PIC  X(0002).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  MSACN7O PIC  X(0001).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  MSACM7O PIC  X(0010).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  TYPE7O PIC  X(0001).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  AMT7O PIC  X(0011).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  VOID7O PIC  X(0001).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  MDT7O PIC  X(0006).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  BDT7O PIC  X(0006).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  SDT7O PIC  X(0006).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  MSAAC8O PIC  X(0010).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  MSAST8O PIC  X(0002).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  45
* EL633.cbl
  2203     05  MSACN8O PIC  X(0001).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  MSACM8O PIC  X(0010).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  TYPE8O PIC  X(0001).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  AMT8O PIC  X(0011).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  VOID8O PIC  X(0001).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  MDT8O PIC  X(0006).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  BDT8O PIC  X(0006).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  SDT8O PIC  X(0006).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  MSAAC9O PIC  X(0010).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  MSAST9O PIC  X(0002).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  MSACN9O PIC  X(0001).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  MSACM9O PIC  X(0010).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  TYPE9O PIC  X(0001).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  AMT9O PIC  X(0011).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  VOID9O PIC  X(0001).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  MDT9O PIC  X(0006).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  BDT9O PIC  X(0006).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  SDT9O PIC  X(0006).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  MSAAC10O PIC  X(0010).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  46
* EL633.cbl
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  MSACN10O PIC  X(0001).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  MSACM10O PIC  X(0010).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  TYPE10O PIC  X(0001).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  AMT10O PIC  X(0011).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  VOID10O PIC  X(0001).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  MDT10O PIC  X(0006).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  BDT10O PIC  X(0006).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  SDT10O PIC  X(0006).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  MSAAC11O PIC  X(0010).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  MSAST11O PIC  X(0002).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  MSACN11O PIC  X(0001).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  MSACM11O PIC  X(0010).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  TYPE11O PIC  X(0001).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  AMT11O PIC  X(0011).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  VOID11O PIC  X(0001).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  MDT11O PIC  X(0006).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  BDT11O PIC  X(0006).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  SDT11O PIC  X(0006).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  MSAAC12O PIC  X(0010).
  2318*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  47
* EL633.cbl
  2319     05  FILLER            PIC  X(0003).
  2320     05  MSAST12O PIC  X(0002).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  MSACN12O PIC  X(0001).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  MSACM12O PIC  X(0010).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  TYPE12O PIC  X(0001).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  AMT12O PIC  X(0011).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  VOID12O PIC  X(0001).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  MDT12O PIC  X(0006).
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  BDT12O PIC  X(0006).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  SDT12O PIC  X(0006).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  MSAAC13O PIC  X(0010).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
  2350     05  MSAST13O PIC  X(0002).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  MSACN13O PIC  X(0001).
  2354*    -------------------------------
  2355     05  FILLER            PIC  X(0003).
  2356     05  MSACM13O PIC  X(0010).
  2357*    -------------------------------
  2358     05  FILLER            PIC  X(0003).
  2359     05  TYPE13O PIC  X(0001).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  AMT13O PIC  X(0011).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  VOID13O PIC  X(0001).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  MDT13O PIC  X(0006).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  BDT13O PIC  X(0006).
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  SDT13O PIC  X(0006).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  48
* EL633.cbl
  2377     05  ERRMSG1O PIC  X(0079).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  ERRMSG2O PIC  X(0079).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  PFENTERO PIC  X(0002).
  2384*    -------------------------------
  2385
  2386 01  MAP-EL633A  REDEFINES  EL633AI.
  2387     12  FILLER                  PIC  X(87).
  2388     12  DATA-AREA       OCCURS 13 TIMES
  2389                             INDEXED BY PINDX.
  2390         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2391         16  GL-ACCT-ATTRB       PIC  X.
  2392         16  GL-ACCT             PIC  X(10).
  2393         16  WSL-COMM  REDEFINES GL-ACCT.
  2394             20  WSL-COMM-DTE.
  2395                 24  WSL-MO      PIC  X(2).
  2396                 24  WSL-DA      PIC  X(2).
  2397                 24  WSL-YR      PIC  X(2).
  2398             20  WSL-COMM-REST   PIC  X(4).
  2399         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2400         16  GL-STATE-ATTRB      PIC  X.
  2401         16  GL-STATE            PIC  X(02).
  2402         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2403         16  GL-CANC-ATTRB       PIC  X.
  2404         16  GL-CANC             PIC  X.
  2405         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2406         16  GL-COMM-ATTRB       PIC  X.
  2407         16  GL-COMM             PIC  X(10).
  2408         16  RTYPE-LEN           PIC S9(4)              COMP.
  2409         16  RTYPE-ATTRB         PIC  X.
  2410         16  RTYPE               PIC  X.
  2411         16  AMT-LEN             PIC S9(4)              COMP.
  2412         16  AMT-ATTRB           PIC  X.
  2413         16  AMT                 PIC S9(9)V9(2).
  2414         16  AMTO  REDEFINES
  2415             AMT                 PIC Z(7).9(2)-.
  2416         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2417         16  VOID-SW-ATTRB       PIC  X.
  2418         16  VOID-SW             PIC  X.
  2419         16  MDTE-LEN            PIC S9(4)              COMP.
  2420         16  MDTE-ATTRB          PIC  X.
  2421         16  MDTE                PIC  X(6).
  2422         16  BDTE-LEN            PIC S9(4)              COMP.
  2423         16  BDTE-ATTRB          PIC  X.
  2424         16  BDTE                PIC  X(6).
  2425         16  SDTE-LEN            PIC S9(4)              COMP.
  2426         16  SDTE-ATTRB          PIC  X.
  2427         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  49
* EL633.cbl
  2429****************************************************************
  2430*
  2431* Copyright (c) 2007 by Clerity Solutions, Inc.
  2432* All rights reserved.
  2433*
  2434****************************************************************
  2435 01  DFHEIV.
  2436   02  DFHEIV0               PIC X(35).
  2437   02  DFHEIV1               PIC X(08).
  2438   02  DFHEIV2               PIC X(08).
  2439   02  DFHEIV3               PIC X(08).
  2440   02  DFHEIV4               PIC X(06).
  2441   02  DFHEIV5               PIC X(04).
  2442   02  DFHEIV6               PIC X(04).
  2443   02  DFHEIV7               PIC X(02).
  2444   02  DFHEIV8               PIC X(02).
  2445   02  DFHEIV9               PIC X(01).
  2446   02  DFHEIV10              PIC S9(7) COMP-3.
  2447   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2448   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2449   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2450   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2451   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2452   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2453   02  DFHEIV17              PIC X(04).
  2454   02  DFHEIV18              PIC X(04).
  2455   02  DFHEIV19              PIC X(04).
  2456   02  DFHEIV20              USAGE IS POINTER.
  2457   02  DFHEIV21              USAGE IS POINTER.
  2458   02  DFHEIV22              USAGE IS POINTER.
  2459   02  DFHEIV23              USAGE IS POINTER.
  2460   02  DFHEIV24              USAGE IS POINTER.
  2461   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2462   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2463   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2464   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2465   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2466   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2467   02  FILLER                PIC X(02).
  2468   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2469   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2470   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2471   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2472   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2473 LINKAGE  SECTION.
  2474*****************************************************************
  2475*                                                               *
  2476* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2477* All rights reserved.                                          *
  2478*                                                               *
  2479*****************************************************************
  2480 01  dfheiblk.
  2481     02  eibtime          pic s9(7) comp-3.
  2482     02  eibdate          pic s9(7) comp-3.
  2483     02  eibtrnid         pic x(4).
  2484     02  eibtaskn         pic s9(7) comp-3.
  2485     02  eibtrmid         pic x(4).
  2486     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  50
* EL633.cbl
  2487     02  eibcposn         pic s9(4) comp.
  2488     02  eibcalen         pic s9(4) comp.
  2489     02  eibaid           pic x(1).
  2490     02  eibfiller1       pic x(1).
  2491     02  eibfn            pic x(2).
  2492     02  eibfiller2       pic x(2).
  2493     02  eibrcode         pic x(6).
  2494     02  eibfiller3       pic x(2).
  2495     02  eibds            pic x(8).
  2496     02  eibreqid         pic x(8).
  2497     02  eibrsrce         pic x(8).
  2498     02  eibsync          pic x(1).
  2499     02  eibfree          pic x(1).
  2500     02  eibrecv          pic x(1).
  2501     02  eibsend          pic x(1).
  2502     02  eibatt           pic x(1).
  2503     02  eibeoc           pic x(1).
  2504     02  eibfmh           pic x(1).
  2505     02  eibcompl         pic x(1).
  2506     02  eibsig           pic x(1).
  2507     02  eibconf          pic x(1).
  2508     02  eiberr           pic x(1).
  2509     02  eibrldbk         pic x(1).
  2510     02  eiberrcd         pic x(4).
  2511     02  eibsynrb         pic x(1).
  2512     02  eibnodat         pic x(1).
  2513     02  eibfiller5       pic x(2).
  2514     02  eibresp          pic 9(09) comp.
  2515     02  eibresp2         pic 9(09) comp.
  2516     02  dfheigdj         pic s9(4) comp.
  2517     02  dfheigdk         pic s9(4) comp.
  2518 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  51
* EL633.cbl
  2519/
  2520*                            COPY ERCCHKQ.
  2521******************************************************************
  2522*                                                                *
  2523*                                                                *
  2524*                            ERCCHKQ                             *
  2525*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2526*                            VMOD=2.005                          *
  2527*                                                                *
  2528*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2529*                                                                *
  2530*   FILE TYPE = VSAM,KSDS                                        *
  2531*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2532*                                                                *
  2533*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2534*       ALTERNATE PATH  = NONE                                   *
  2535*                                                                *
  2536*   LOG = YES                                                    *
  2537*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2538******************************************************************
  2539 01  CHECK-QUE.
  2540     12  CQ-RECORD-ID                PIC XX.
  2541         88  VALID-CQ-ID                     VALUE 'CQ'.
  2542
  2543     12  CQ-CONTROL-PRIMARY.
  2544         16  CQ-COMPANY-CD           PIC X.
  2545         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2546         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2547
  2548     12  CQ-ENTRY-TYPE               PIC X.
  2549             88  CHECK-ON-QUE           VALUE 'Q'.
  2550             88  ALIGNMENT-CHECK        VALUE 'A'.
  2551             88  MANUAL-CHECK           VALUE 'M'.
  2552             88  SPOILED-CHECK          VALUE 'S'.
  2553             88  VOIDED-CHECK           VALUE 'V'.
  2554             88  PAYMENT-ABORTED        VALUE 'X'.
  2555
  2556     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2557
  2558     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2559         CQ-CREDIT-MASTER-CNTL.
  2560         16  CQ-PYAJ-CARRIER         PIC X.
  2561         16  CQ-PYAJ-GROUPING        PIC X(6).
  2562         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2563         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2564         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2565         16  CQ-PYAJ-REC-TYPE        PIC X.
  2566         16  FILLER                  PIC X(18).
  2567
  2568     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2569         CQ-CREDIT-MASTER-CNTL.
  2570         16  CQ-CHEK-CARRIER         PIC X.
  2571         16  CQ-CHEK-GROUPING        PIC X(6).
  2572         16  CQ-CHEK-STATE           PIC XX.
  2573         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2574         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2575         16  CQ-CHEK-CERT-NO.
  2576             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  52
* EL633.cbl
  2577             20  CQ-CHEK-CERT-SFX    PIC X.
  2578         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2579         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2580         16  FILLER                  PIC X(06).
  2581
  2582     12  CQ-CHECK-NUMBER             PIC X(7).
  2583     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2584     12  CQ-PAYMENT-TYPE             PIC X.
  2585             88  CQ-BILLING-CREDIT         VALUE '1'.
  2586             88  CQ-REFUND-PMT             VALUE '2'.
  2587             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2588     12  CQ-VOID-INDICATOR           PIC X.
  2589             88  CHECK-IS-VOID             VALUE 'V'.
  2590     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2591     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2592     12  CQ-CHECK-BY-USER            PIC X(4).
  2593     12  CQ-PRE-NUMBERING-SW         PIC X.
  2594       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2595       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2596
  2597     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2598     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2599     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2600     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2601
  2602     12  CQ-LETTERS-IND              PIC X.
  2603         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2604
  2605******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  53
* EL633.cbl
  2606/
  2607*                            COPY ERCPYAJ.
  2608******************************************************************
  2609*                                                                *
  2610*                            ERCPYAJ                             *
  2611*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2612*                            VMOD=2.015                          *
  2613*                                                                *
  2614*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2615*                                                                *
  2616*                                                                *
  2617*   FILE TYPE = VSAM,KSDS                                        *
  2618*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2619*                                                                *
  2620*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2621*       ALTERNATE PATHS = NONE                                   *
  2622*                                                                *
  2623*   LOG = YES                                                    *
  2624*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2625******************************************************************
  2626******************************************************************
  2627*                   C H A N G E   L O G
  2628*
  2629* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2630*-----------------------------------------------------------------
  2631*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2632* EFFECTIVE    NUMBER
  2633*-----------------------------------------------------------------
  2634* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2635* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2636******************************************************************
  2637
  2638 01  PENDING-PAY-ADJ.
  2639     12  PY-RECORD-ID                     PIC XX.
  2640         88  VALID-PY-ID                        VALUE 'PY'.
  2641
  2642     12  PY-CONTROL-PRIMARY.
  2643         16  PY-COMPANY-CD                PIC X.
  2644         16  PY-CARRIER                   PIC X.
  2645         16  PY-GROUPING                  PIC X(6).
  2646         16  PY-FIN-RESP                  PIC X(10).
  2647         16  PY-ACCOUNT                   PIC X(10).
  2648         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2649                                          PIC X(10).
  2650         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2651         16  PY-RECORD-TYPE               PIC X.
  2652             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2653             88  PY-DEPOSIT                   VALUE 'D'.
  2654             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2655             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2656             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2657             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2658             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2659             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2660             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2661             88  PY-FICA-ENTRY                VALUE 'F'.
  2662             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2663             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  54
* EL633.cbl
  2664             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2665
  2666     12  PY-PYMT-TYPE                     PIC X.
  2667             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2668             88  PY-REINS-PYMT                VALUE 'R'.
  2669             88  PY-EXP-PYMT                  VALUE 'E'.
  2670
  2671     12  PY-BIL-INV                       PIC X(6).
  2672     12  PY-REF-NO                        PIC X(12).
  2673
  2674     12  PY-LAST-MAINT-DT                 PIC XX.
  2675     12  PY-LAST-MAINT-BY                 PIC X(4).
  2676     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2677
  2678     12  PY-PYADJ-RECORD.
  2679         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2680         16  PY-ENTRY-COMMENT             PIC X(30).
  2681         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2682             20  PY-GL-ACCOUNT            PIC X(10).
  2683             20  PY-GL-STATE              PIC X(02).
  2684             20  PY-GL-CANC-SW            PIC X(01).
  2685                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2686                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2687             20  PY-GL-COMMENT            PIC X(10).
  2688             20  FILLER      REDEFINES PY-GL-COMMENT.
  2689                 24  PY-GL-CHECK-NO       PIC 9(06).
  2690                 24  FILLER               PIC X(04).
  2691             20  FILLER                   PIC X(07).
  2692         16  PY-SAVE-ACCOUNT              PIC X(10).
  2693         16  PY-SAVE-TYPE                 PIC X(01).
  2694
  2695         16  PY-LETTERS.
  2696             20  PY-LETTER OCCURS 3 TIMES
  2697                           INDEXED BY PY-LET-NDX
  2698                                          PIC X(04).
  2699
  2700         16  PY-ERCOMP-TYPE               PIC X.
  2701             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2702             88  PY-GA-TYPE                   VALUE 'G'.
  2703             88  PY-BANK-TYPE                 VALUE 'B'.
  2704         16  FILLER                       PIC X(05).
  2705
  2706     12  PY-RECORD-STATUS.
  2707         16  PY-CREDIT-SELECT-DT          PIC XX.
  2708         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2709         16  PY-BILLED-DATE               PIC XX.
  2710         16  PY-REPORTED-DT               PIC XX.
  2711         16  PY-PMT-APPLIED               PIC X.
  2712             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2713             88  PY-GA-PMT                    VALUE 'G'.
  2714             88  PY-OVWRITE-PMT               VALUE 'O'.
  2715             88  PY-NON-AR-PMT                VALUE 'N'.
  2716         16  FILLER                       PIC X(5).
  2717         16  PY-INPUT-DT                  PIC XX.
  2718         16  PY-CHECK-NUMBER              PIC X(6).
  2719         16  PY-VOID-SW                   PIC X.
  2720             88  PY-CHECK-VOIDED              VALUE 'V'.
  2721         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  55
* EL633.cbl
  2722             88  PY-BILLING-CHECK             VALUE 'B'.
  2723             88  PY-REFUND-CHECK              VALUE 'R'.
  2724             88  PY-GA-CHECK                  VALUE 'G'.
  2725             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2726             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2727         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2728         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2729         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2730         16  PY-BILL-FLAG                 PIC X.
  2731             88  PY-BILLED                    VALUE 'B'.
  2732         16  PY-AR-FLAG                   PIC X.
  2733             88  PY-AR-CYCLE                  VALUE 'C'.
  2734             88  PY-AR-MONTH-END              VALUE 'M'.
  2735         16  PY-AR-DATE                   PIC XX.
  2736
  2737     12  PY-GL-CODES.
  2738         16  PY-GL-DB                     PIC X(14).
  2739         16  PY-GL-CR                     PIC X(14).
  2740         16  PY-GL-FLAG                   PIC X.
  2741         16  PY-GL-DATE                   PIC XX.
  2742
  2743     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2744     12  FILLER                           PIC X(3).
  2745******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  56
* EL633.cbl
  2746/
  2747*                            COPY ERCCOMP.
  2748******************************************************************
  2749*                                                                *
  2750*                                                                *
  2751*                            ERCCOMP                             *
  2752*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2753*                            VMOD=2.019                          *
  2754*                                                                *
  2755*   ONLINE CREDIT SYSTEM                                         *
  2756*                                                                *
  2757*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2758*                                                                *
  2759*   FILE TYPE = VSAM,KSDS                                        *
  2760*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2761*                                                                *
  2762*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2763*       ALTERNATE PATH = NONE                                    *
  2764*                                                                *
  2765*   LOG = NO                                                     *
  2766*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2767*                                                                *
  2768******************************************************************
  2769*                   C H A N G E   L O G
  2770*
  2771* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2772*-----------------------------------------------------------------
  2773*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2774* EFFECTIVE    NUMBER
  2775*-----------------------------------------------------------------
  2776* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2777* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2778* 092205    2005050300006  PEMA  ADD LEASE FEE
  2779* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2780* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2781* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2782* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2783* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2784******************************************************************
  2785
  2786 01  COMPENSATION-MASTER.
  2787     12  CO-RECORD-ID                          PIC XX.
  2788         88  VALID-CO-ID                          VALUE 'CO'.
  2789
  2790     12  CO-CONTROL-PRIMARY.
  2791         16  CO-COMPANY-CD                     PIC X.
  2792         16  CO-CONTROL.
  2793             20  CO-CTL-1.
  2794                 24  CO-CARR-GROUP.
  2795                     28  CO-CARRIER            PIC X.
  2796                     28  CO-GROUPING.
  2797                         32  CO-GROUP-PREFIX   PIC XXX.
  2798                         32  CO-GROUP-PRIME    PIC XXX.
  2799                 24  CO-RESP-NO.
  2800                     28  CO-RESP-PREFIX        PIC X(4).
  2801                     28  CO-RESP-PRIME         PIC X(6).
  2802             20  CO-CTL-2.
  2803                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  57
* EL633.cbl
  2804                     28  CO-ACCT-PREFIX        PIC X(4).
  2805                     28  CO-ACCT-PRIME         PIC X(6).
  2806         16  CO-TYPE                           PIC X.
  2807             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2808             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2809             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2810
  2811     12  CO-MAINT-INFORMATION.
  2812         16  CO-LAST-MAINT-DT                  PIC XX.
  2813         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2814         16  CO-LAST-MAINT-USER                PIC X(4).
  2815     12  FILLER                                PIC XX.
  2816     12  CO-STMT-TYPE                          PIC XXX.
  2817     12  CO-COMP-TYPE                          PIC X.
  2818         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2819     12  CO-STMT-OWNER                         PIC X(4).
  2820     12  CO-BALANCE-CONTROL                    PIC X.
  2821         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2822         88  CO-NO-BALANCE                        VALUE 'N'.
  2823
  2824     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2825         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2826         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2827         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2828
  2829     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2830         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2831         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2832
  2833     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2834     12  CO-GA-DIRECT-DEP                      PIC X.
  2835     12  CO-FUTURE-SPACE                       PIC X.
  2836         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2837
  2838     12  CO-ACCT-NAME                          PIC X(30).
  2839     12  CO-MAIL-NAME                          PIC X(30).
  2840     12  CO-ADDR-1                             PIC X(30).
  2841     12  CO-ADDR-2                             PIC X(30).
  2842     12  CO-ADDR-3.
  2843         16  CO-ADDR-CITY                      PIC X(27).
  2844         16  CO-ADDR-STATE                     PIC XX.
  2845     12  CO-CSO-1099                           PIC X.
  2846     12  CO-ZIP.
  2847         16  CO-ZIP-PRIME.
  2848             20  CO-ZIP-PRI-1ST                PIC X.
  2849                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2850             20  FILLER                        PIC X(4).
  2851         16  CO-ZIP-PLUS4                      PIC X(4).
  2852     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2853         16  CO-CAN-POSTAL-1                   PIC XXX.
  2854         16  CO-CAN-POSTAL-2                   PIC XXX.
  2855         16  FILLER                            PIC XXX.
  2856     12  CO-SOC-SEC                            PIC X(13).
  2857     12  CO-TELEPHONE.
  2858         16  CO-AREA-CODE                      PIC XXX.
  2859         16  CO-PREFIX                         PIC XXX.
  2860         16  CO-PHONE                          PIC X(4).
  2861
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  58
* EL633.cbl
  2862     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2863
  2864     12  CO-AR-BAL-LEVEL                       PIC X.
  2865         88  CO-AR-REF-LVL                        VALUE '1'.
  2866         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2867         88  CO-AR-BILL-LVL                       VALUE '2'.
  2868         88  CO-AR-AGT-LVL                        VALUE '3'.
  2869         88  CO-AR-FR-LVL                         VALUE '4'.
  2870
  2871     12  CO-AR-NORMAL-PRINT                    PIC X.
  2872         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2873         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2874
  2875     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2876
  2877     12  CO-AR-REPORTING                       PIC X.
  2878         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2879         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2880
  2881     12  CO-AR-PULL-CHECK                      PIC X.
  2882         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2883         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2884
  2885     12  CO-AR-BALANCE-PRINT                   PIC X.
  2886         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2887
  2888     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2889         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2890         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2891         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2892
  2893     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2894
  2895     12  CO-USER-CODE                          PIC X.
  2896     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2897
  2898******************************************************************
  2899*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2900*    THE LAST MONTH END RUN.
  2901******************************************************************
  2902
  2903     12  CO-LAST-ACTIVITY-DATE.
  2904         16  CO-ACT-YEAR                       PIC 99.
  2905         16  CO-ACT-MONTH                      PIC 99.
  2906         16  CO-ACT-DAY                        PIC 99.
  2907
  2908     12  CO-LAST-STMT-DT.
  2909         16  CO-LAST-STMT-YEAR                 PIC 99.
  2910         16  CO-LAST-STMT-MONTH                PIC 99.
  2911         16  CO-LAST-STMT-DAY                  PIC 99.
  2912
  2913     12  CO-MO-END-TOTALS.
  2914         16  CO-MONTHLY-TOTALS.
  2915             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2916             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2917             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2918             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2919             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  59
* EL633.cbl
  2920
  2921         16  CO-AGING-TOTALS.
  2922             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2923             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2924             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2925             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2926
  2927         16  CO-YTD-TOTALS.
  2928             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2929             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2930
  2931         16  CO-OVER-UNDER-TOTALS.
  2932             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2933             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2934
  2935     12  CO-MISCELLANEOUS-TOTALS.
  2936         16  CO-FICA-TOTALS.
  2937             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2938             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2939
  2940         16  CO-CLAIM-TOTALS.
  2941             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2942             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2943
  2944******************************************************************
  2945*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2946*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2947******************************************************************
  2948
  2949     12  CO-CURRENT-TOTALS.
  2950         16  CO-CURRENT-LAST-STMT-DT.
  2951             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2952             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2953             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2954
  2955         16  CO-CURRENT-MONTHLY-TOTALS.
  2956             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2957             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2958             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2959             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2960             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2961
  2962         16  CO-CURRENT-AGING-TOTALS.
  2963             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2964             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2965             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2966             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2967
  2968         16  CO-CURRENT-YTD-TOTALS.
  2969             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2970             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2971
  2972     12  CO-PAID-COMM-TOTALS.
  2973         16  CO-YTD-PAID-COMMS.
  2974             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2975             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2976
  2977     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  60
* EL633.cbl
  2978         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2979         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2980
  2981     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2982         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2983         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2984         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2985         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2986         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2987         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2988         88  CO-FINAL-LETTER                  VALUE 'F'.
  2989         88  CO-RECONCILING                   VALUE 'R'.
  2990         88  CO-PHONE-CALL                    VALUE 'P'.
  2991         88  CO-LEGAL                         VALUE 'L'.
  2992         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2993         88  CO-WRITE-OFF                     VALUE 'W'.
  2994         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2995
  2996     12  CO-CSR-CODE                       PIC X(4).
  2997
  2998     12  CO-GA-STATUS-INFO.
  2999         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3000         16  CO-GA-TERMINATION-DT          PIC XX.
  3001         16  CO-GA-STATUS-CODE             PIC X.
  3002             88  CO-GA-ACTIVE                 VALUE 'A'.
  3003             88  CO-GA-INACTIVE               VALUE 'I'.
  3004             88  CO-GA-PENDING                VALUE 'P'.
  3005         16  CO-GA-COMMENTS.
  3006             20  CO-GA-COMMENT-1           PIC X(40).
  3007             20  CO-GA-COMMENT-2           PIC X(40).
  3008             20  CO-GA-COMMENT-3           PIC X(40).
  3009             20  CO-GA-COMMENT-4           PIC X(40).
  3010
  3011     12  CO-RPTCD2                         PIC X(10).
  3012
  3013     12  CO-TYPE-AGENT                     PIC X(01).
  3014         88  CO-CORPORATION                   VALUE 'C'.
  3015         88  CO-PARTNERSHIP                   VALUE 'P'.
  3016         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3017         88  CO-TRUST                         VALUE 'T'.
  3018         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3019
  3020     12  CO-FAXNO.
  3021         16  CO-FAX-AREA-CODE                  PIC XXX.
  3022         16  CO-FAX-PREFIX                     PIC XXX.
  3023         16  CO-FAX-PHONE                      PIC X(4).
  3024
  3025     12  CO-BANK-INFORMATION.
  3026         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3027         16  CO-BANK-TRANSIT-NON REDEFINES
  3028             CO-BANK-TRANSIT-NO                PIC 9(8).
  3029
  3030         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3031     12  CO-MISC-DEDUCT-INFO REDEFINES
  3032                  CO-BANK-INFORMATION.
  3033         16  CO-MD-GL-ACCT                     PIC X(10).
  3034         16  CO-MD-DIV                         PIC XX.
  3035         16  CO-MD-CENTER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  61
* EL633.cbl
  3036         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3037         16  CO-CREATE-AP-CHECK                PIC X.
  3038         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3039         16  FILLER                            PIC XXX.
  3040     12  CO-ACH-STATUS                         PIC X.
  3041         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3042         88  CO-ACH-PENDING                        VALUE 'P'.
  3043
  3044     12  CO-BILL-SW                            PIC X.
  3045     12  CO-CONTROL-NAME                       PIC X(30).
  3046     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3047     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3048     12  CO-CLP-STATE                          PIC XX.
  3049     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3050     12  CO-SPP-REFUND-EDIT                    PIC X.
  3051
  3052******************************************************************
  3053*
  3054*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  62
* EL633.cbl
  3055/
  3056 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3057                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3058 0000-DFHEXIT SECTION.
  3059     MOVE '9#                    $   ' TO DFHEIV0.
  3060     MOVE 'EL633' TO DFHEIV1.
  3061     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3062
  3063     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3064     MOVE EIBTRMID               TO  QID-TERM.
  3065     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3066
  3067     IF EIBCALEN = ZERO
  3068         GO TO 8800-UNAUTHORIZED-ACCESS.
  3069
  3070     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3071         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3072
  3073     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3074     MOVE '5'                    TO  DC-OPTION-CODE.
  3075
  3076     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3077
  3078     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3079     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3080
  3081     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3082         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3083             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3084             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3085             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3086             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3087             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3088             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3089             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3090             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3091         ELSE
  3092             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3093             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3094             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3095             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3096             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3097             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3098             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3099             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3100
  3101     MOVE LOW-VALUES             TO  EL633AI.
  3102
  3103     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3104     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3105     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3106     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3107
  3108     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3109                                     TOTAL-ACCT-NET.
  3110
  3111     IF RETURNED-FROM = XCTL-6331 OR
  3112                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  63
* EL633.cbl
  3113                        XCTL-642  OR
  3114                        XCTL-652
  3115         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3116
  3117     IF EIBTRNID NOT = TRANS-ID
  3118         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3119         MOVE 'Y'                TO  PI-PAGE-SW
  3120         MOVE ZEROS              TO  PI-SEQ-NOS
  3121         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3122                                     PI-SAV-ACCT-NET
  3123                                     PI-SAV-PREV-AMT
  3124                                     PI-SAV-PREV-NET
  3125         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3126             EIBTRNID NOT = EL642-TRANS-ID  AND
  3127             EIBTRNID NOT = EL652-TRANS-ID) OR
  3128             PI-CR-FIN-RESP = SPACES
  3129             GO TO 8100-SEND-INITIAL-MAP
  3130         ELSE
  3131             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3132                            EL640-TRANS-ID   OR
  3133                            EL642-TRANS-ID)  AND
  3134                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3135                GO TO 8100-SEND-INITIAL-MAP
  3136             ELSE
  3137                 MOVE DFHENTER   TO  EIBAID
  3138                 MOVE 'S'        TO  MAINTI
  3139                 MOVE PI-CR-CARRIER
  3140                                 TO  CARRIERI
  3141                 MOVE PI-CR-GROUPING
  3142                                 TO  GROUPI
  3143                 MOVE PI-CR-FIN-RESP
  3144                                 TO  FINRESPI
  3145                 MOVE PI-CR-ACCOUNT
  3146                                 TO  ACCTI
  3147                 MOVE 1          TO  CARRIERL  MAINTA
  3148                 MOVE 3          TO  GROUPL
  3149                 MOVE 6          TO  FINRESPL  ACCTL
  3150                 GO TO 0400-VALIDATE-KEY-DATA.
  3151
  3152
  3153* EXEC CICS HANDLE CONDITION
  3154*        PGMIDERR  (9600-PGMID-ERROR)
  3155*        ERROR     (9990-ABEND)
  3156*    END-EXEC.
  3157*    MOVE '"$L.                  ! " #00003148' TO DFHEIV0
  3158     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3160     MOVE X'2220233030303033313438' TO DFHEIV0(25:11)
  3161     CALL 'kxdfhei1' USING DFHEIV0
  3162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3163
  3164
  3165     IF EIBAID = DFHCLEAR
  3166         GO TO 9400-CLEAR.
  3167
  3168     IF PI-PROCESSOR-ID = 'LGXX'
  3169         GO TO 0200-RECEIVE.
  3170
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  64
* EL633.cbl
  3171
  3172* EXEC CICS READQ TS
  3173*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3174*        INTO   (SECURITY-CONTROL)
  3175*        LENGTH (SC-COMM-LENGTH)
  3176*        ITEM   (SC-ITEM)
  3177*    END-EXEC.
  3178*    MOVE '*$II   L              ''   #00003159' TO DFHEIV0
  3179     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3180     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3181     MOVE X'2020233030303033313539' TO DFHEIV0(25:11)
  3182     CALL 'kxdfhei1' USING DFHEIV0,
  3183           PI-SECURITY-TEMP-STORE-ID,
  3184           SECURITY-CONTROL,
  3185           SC-COMM-LENGTH,
  3186           SC-ITEM,
  3187           DFHEIV99,
  3188           DFHEIV99
  3189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3190
  3191
  3192     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3193     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3194
  3195     IF NOT DISPLAY-CAP
  3196         MOVE 'READ'          TO SM-READ
  3197         PERFORM 9995-SECURITY-VIOLATION
  3198         MOVE ER-0070         TO  EMI-ERROR
  3199         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3200         GO TO 8100-SEND-INITIAL-MAP.
  3201
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  65
* EL633.cbl
  3203 0200-RECEIVE.
  3204
  3205     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3206         MOVE ER-0008            TO  EMI-ERROR
  3207         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3208         MOVE -1                 TO  MAINTL
  3209         GO TO 8200-SEND-DATAONLY.
  3210
  3211
  3212* EXEC CICS RECEIVE
  3213*        MAP     (MAP-NAME)
  3214*        MAPSET  (MAPSET-NAME)
  3215*        INTO    (EL633AI)
  3216*    END-EXEC.
  3217     MOVE LENGTH OF
  3218      EL633AI
  3219       TO DFHEIV11
  3220*    MOVE '8"T I  L              ''   #00003185' TO DFHEIV0
  3221     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3222     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3223     MOVE X'2020233030303033313835' TO DFHEIV0(25:11)
  3224     CALL 'kxdfhei1' USING DFHEIV0,
  3225           MAP-NAME,
  3226           EL633AI,
  3227           DFHEIV11,
  3228           MAPSET-NAME,
  3229           DFHEIV99,
  3230           DFHEIV99
  3231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3232
  3233
  3234     IF MAINTI = 'S' AND
  3235        EIBAID = DFHENTER
  3236         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3237                                     PI-SAV-ACCT-NET
  3238                                     PI-SAV-PREV-AMT
  3239                                     PI-SAV-PREV-NET
  3240                                     PI-FRST-FILE-SEQ-NO
  3241         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3242
  3243     IF PFENTERL = ZERO
  3244         GO TO 0300-CHECK-PFKEYS.
  3245
  3246     IF (PFENTERI  IS NUMERIC)
  3247       AND (PFENTERI GREATER 0 AND LESS 25)
  3248         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3249     ELSE
  3250         MOVE ER-0029               TO  EMI-ERROR
  3251         GO TO 0320-INPUT-ERROR.
  3252
  3253 0300-CHECK-PFKEYS.
  3254     IF EIBAID = DFHPF23
  3255         GO TO 8810-PF23.
  3256
  3257     IF EIBAID = DFHPF24
  3258         GO TO 9200-RETURN-MAIN-MENU.
  3259
  3260     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  66
* EL633.cbl
  3261         GO TO 9500-PF12.
  3262
  3263     IF EIBAID = DFHPF3
  3264         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3265             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3266             MOVE XCTL-652       TO  PGM-NAME
  3267             IF ERCOMP-KEY  NOT =      SPACES
  3268                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3269                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3270                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3271                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3272             END-IF
  3273
  3274             IF PI-CR-ACCOUNT = LOW-VALUES
  3275                 MOVE 'G'        TO  PI-CR-TYPE
  3276                 GO TO 9300-XCTL
  3277             ELSE
  3278                 MOVE 'A'        TO  PI-CR-TYPE
  3279                 GO TO 9300-XCTL
  3280         ELSE
  3281            MOVE ER-3020         TO  EMI-ERROR
  3282            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3283            GO TO 8100-SEND-INITIAL-MAP.
  3284
  3285     IF EIBAID = DFHPF4
  3286         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3287         MOVE XCTL-6331          TO  PGM-NAME
  3288         GO TO 9300-XCTL.
  3289
  3290     IF EIBAID = DFHPF5
  3291         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3292         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3293         MOVE XCTL-640           TO  PGM-NAME
  3294         IF PI-CR-ACCOUNT = LOW-VALUES
  3295             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3296             IF ACCTI = LOW-VALUES
  3297                MOVE 'G'         TO  PI-CR-TYPE
  3298             END-IF
  3299             GO TO 9300-XCTL
  3300         ELSE
  3301             MOVE 'A'        TO  PI-CR-TYPE
  3302             GO TO 9300-XCTL.
  3303
  3304     IF EIBAID = DFHPF6
  3305        IF PI-GA-BILLING
  3306            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3307            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3308            MOVE XCTL-642        TO  PGM-NAME
  3309            IF PI-CR-ACCOUNT = LOW-VALUES
  3310                 MOVE 'G'        TO  PI-CR-TYPE
  3311                 GO TO 9300-XCTL
  3312             ELSE
  3313                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3314                 GO TO 9300-XCTL
  3315        ELSE
  3316            MOVE ER-2929         TO  EMI-ERROR
  3317            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3318            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  67
* EL633.cbl
  3319            IF PFENTERL = ZERO
  3320                MOVE -1          TO  MAINTL
  3321                GO TO 8200-SEND-DATAONLY
  3322            ELSE
  3323                MOVE -1          TO  PFENTERL
  3324                GO TO 8200-SEND-DATAONLY.
  3325
  3326     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3327         GO TO 0400-VALIDATE-KEY-DATA.
  3328
  3329 0320-INPUT-ERROR.
  3330     MOVE ER-0029                TO  EMI-ERROR.
  3331
  3332     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3333
  3334     MOVE AL-UNBON               TO  PFENTERA.
  3335
  3336     IF PFENTERL = ZERO
  3337         MOVE -1                 TO  MAINTL
  3338     ELSE
  3339         MOVE -1                 TO  PFENTERL.
  3340
  3341     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  68
* EL633.cbl
  3343 0400-VALIDATE-KEY-DATA.
  3344     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3345         NEXT SENTENCE
  3346       ELSE
  3347        IF MAINTI NOT = 'S'
  3348         MOVE 'UPDATE'       TO SM-READ
  3349         PERFORM 9995-SECURITY-VIOLATION
  3350         MOVE ER-0070        TO EMI-ERROR
  3351         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3352         GO TO 8100-SEND-INITIAL-MAP.
  3353
  3354     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3355
  3356     IF EIBAID = DFHPF1
  3357         GO TO 4000-BROWSE-FRWD.
  3358
  3359     IF EIBAID   = DFHPF1   AND
  3360        CARRIERL = ZEROS    AND
  3361        GROUPL   = ZEROS    AND
  3362        FINRESPL = ZEROS    AND
  3363        ACCTL    = ZEROS
  3364         GO TO 4000-BROWSE-FRWD.
  3365
  3366     IF PI-PROCESSOR-ID = 'LGXX'
  3367         IF MAINTI = 'C'
  3368             MOVE AL-UANON       TO MAINTA
  3369             MOVE MAINTI         TO PI-SAV-FUNCTION
  3370             GO TO CSO-BRANCH
  3371         END-IF
  3372     END-IF.
  3373
  3374     IF MAINTI = 'C' OR  'S'
  3375         MOVE AL-UANON           TO  MAINTA
  3376         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3377     ELSE
  3378         MOVE -1                 TO  MAINTL
  3379         MOVE ER-0023            TO  EMI-ERROR
  3380         MOVE AL-UABON           TO  MAINTA
  3381         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3382
  3383 CSO-BRANCH.
  3384
  3385     IF MAINTI = 'C'
  3386       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3387         MOVE -1                 TO  MAINTL
  3388         MOVE ER-2056            TO  EMI-ERROR
  3389         MOVE AL-UABON           TO  MAINTA
  3390         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3391
  3392     IF CARRIERL = ZEROS  AND
  3393        GROUPL   = ZEROS  AND
  3394        FINRESPL = ZEROS  AND
  3395        ACCTL    = ZEROS
  3396         MOVE -1                 TO  CARRIERL
  3397         MOVE ER-2231            TO  EMI-ERROR
  3398         MOVE AL-UABON           TO  CARRIERA
  3399                                     GROUPA
  3400                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  69
* EL633.cbl
  3401                                     ACCTA
  3402         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3403         GO TO 8200-SEND-DATAONLY.
  3404
  3405     IF CARRIERL NOT = ZEROS
  3406         MOVE AL-UANON           TO  CARRIERA
  3407         MOVE CARRIERI           TO  COMP-CARRIER
  3408                                     PI-SAV-CARRIER
  3409                                     PI-CR-CARRIER
  3410         IF CARRIERI NOT = ZEROS
  3411           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3412             MOVE ER-2587        TO  EMI-ERROR
  3413             MOVE -1             TO  CARRIERL
  3414             MOVE AL-UABON       TO  CARRIERA
  3415             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3416         ELSE
  3417             NEXT SENTENCE
  3418     ELSE
  3419         MOVE LOW-VALUES          TO  COMP-CARRIER
  3420                                      PI-SAV-CARRIER.
  3421
  3422     IF CARRIERL NOT = ZEROS
  3423         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3424             IF PI-CARRIER-SECURITY = CARRIERI
  3425                 NEXT SENTENCE
  3426             ELSE
  3427                 MOVE -1         TO  CARRIERL
  3428                 MOVE ER-2370    TO  EMI-ERROR
  3429                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3430
  3431     IF GROUPL NOT = ZEROS
  3432         MOVE AL-UANON           TO  GROUPA
  3433         MOVE GROUPI             TO  COMP-GROUPING
  3434                                     PI-SAV-GROUPING
  3435                                     PI-CR-GROUPING
  3436         IF GROUPI NOT = ZEROS
  3437           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3438             MOVE ER-2588        TO  EMI-ERROR
  3439             MOVE -1             TO  GROUPL
  3440             MOVE AL-UABON       TO  GROUPA
  3441             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3442         ELSE
  3443             NEXT SENTENCE
  3444     ELSE
  3445         MOVE LOW-VALUES         TO  COMP-GROUPING
  3446                                     PI-SAV-GROUPING.
  3447
  3448     IF FINRESPL NOT = ZEROS
  3449         MOVE AL-UANON           TO  FINRESPA
  3450         MOVE FINRESPI           TO  COMP-FIN-RESP
  3451                                     PI-SAV-FIN-RESP
  3452                                     PI-CR-FIN-RESP
  3453     ELSE
  3454         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3455                                     PI-SAV-FIN-RESP.
  3456
  3457     IF ACCTL NOT = ZEROS
  3458         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  70
* EL633.cbl
  3459         MOVE ACCTI              TO  COMP-ACCOUNT
  3460                                     PI-SAV-ACCOUNT
  3461                                     PI-CR-ACCOUNT
  3462     ELSE
  3463         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3464                                     PI-SAV-ACCOUNT
  3465                                     PI-CR-ACCOUNT.
  3466
  3467     IF EMI-ERROR = ZEROS
  3468         NEXT SENTENCE
  3469     ELSE
  3470         IF EIBTRNID = EL640-TRANS-ID OR
  3471            EIBTRNID = EL642-TRANS-ID OR
  3472            EIBTRNID = EL6331-TRANS-ID
  3473             GO TO 8100-SEND-INITIAL-MAP
  3474         ELSE
  3475             GO TO 8200-SEND-DATAONLY.
  3476
  3477     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3478
  3479     IF MAINTI = 'S'
  3480         IF EIBAID = DFHPF1              OR  DFHENTER
  3481             GO TO 4000-BROWSE-FRWD
  3482         ELSE
  3483             GO TO 4100-BROWSE-BKWD.
  3484
  3485     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3486     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3487
  3488
  3489* EXEC CICS HANDLE CONDITION
  3490*        NOTFND   (0410-NO-COMP-MSTR)
  3491*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3492*        END-EXEC.
  3493*    MOVE '"$IJ                  ! # #00003445' TO DFHEIV0
  3494     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3495     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3496     MOVE X'2320233030303033343435' TO DFHEIV0(25:11)
  3497     CALL 'kxdfhei1' USING DFHEIV0
  3498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3499
  3500
  3501
  3502* EXEC CICS READ
  3503*        DATASET  (COMP-FILE-ID)
  3504*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3505*        RIDFLD   (ERCOMP-KEY)
  3506*        GTEQ
  3507*        END-EXEC.
  3508*    MOVE '&"S        G          (   #00003450' TO DFHEIV0
  3509     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3510     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3511     MOVE X'2020233030303033343530' TO DFHEIV0(25:11)
  3512     CALL 'kxdfhei1' USING DFHEIV0,
  3513           COMP-FILE-ID,
  3514           DFHEIV20,
  3515           DFHEIV99,
  3516           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  71
* EL633.cbl
  3517           DFHEIV99,
  3518           DFHEIV99,
  3519           DFHEIV99
  3520     SET ADDRESS OF COMPENSATION-MASTER TO
  3521         DFHEIV20
  3522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3523
  3524
  3525     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3526        COMP-CARRIER  = CO-CARRIER     AND
  3527        COMP-GROUPING = CO-GROUPING    AND
  3528        COMP-FIN-RESP = CO-RESP-NO    AND
  3529        COMP-ACCOUNT  = CO-ACCOUNT
  3530         NEXT SENTENCE
  3531     ELSE
  3532         GO TO 0410-NO-COMP-MSTR.
  3533
  3534     IF PI-COMPANY-ID = 'NCL'
  3535         IF CO-GA-INACTIVE
  3536             GO TO 0420-INACTIVE-COMP.
  3537
  3538     IF MAINTI = 'C'
  3539         GO TO 1000-EDIT-DATA.
  3540
  3541     IF EIBAID = DFHPF1
  3542       OR DFHENTER
  3543         GO TO 4000-BROWSE-FRWD.
  3544
  3545     IF EIBAID = DFHPF2
  3546         GO TO 4100-BROWSE-BKWD.
  3547
  3548 0410-NO-COMP-MSTR.
  3549     MOVE ER-2230                TO  EMI-ERROR.
  3550     MOVE -1                     TO  CARRIERL.
  3551     MOVE AL-UABON               TO  CARRIERA
  3552                                     GROUPA
  3553                                     FINRESPA
  3554                                     ACCTA.
  3555
  3556     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3557
  3558     GO TO 8200-SEND-DATAONLY.
  3559
  3560 0420-INACTIVE-COMP.
  3561     MOVE ER-2763                TO  EMI-ERROR.
  3562     MOVE -1                     TO  CARRIERL.
  3563     MOVE AL-UABON               TO  CARRIERA
  3564                                     GROUPA
  3565                                     FINRESPA
  3566                                     ACCTA.
  3567
  3568     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3569
  3570     GO TO 8200-SEND-DATAONLY.
  3571
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  72
* EL633.cbl
  3573 0500-CREATE-TEMP-STORAGE.
  3574
  3575     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3576
  3577
  3578* EXEC CICS WRITEQ TS
  3579*        QUEUE  (QID)
  3580*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3581*        LENGTH (PI-COMM-LENGTH)
  3582*    END-EXEC.
  3583*    MOVE '*"                    ''   #00003509' TO DFHEIV0
  3584     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3585     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3586     MOVE X'2020233030303033353039' TO DFHEIV0(25:11)
  3587     CALL 'kxdfhei1' USING DFHEIV0,
  3588           QID,
  3589           PROGRAM-INTERFACE-BLOCK,
  3590           PI-COMM-LENGTH,
  3591           DFHEIV99,
  3592           DFHEIV99,
  3593           DFHEIV99
  3594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3595
  3596
  3597 0590-EXIT.
  3598      EXIT.
  3599
  3600 0600-RECOVER-TEMP-STORAGE.
  3601
  3602* EXEC CICS READQ TS
  3603*        QUEUE  (QID)
  3604*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3605*        LENGTH (PI-COMM-LENGTH)
  3606*    END-EXEC.
  3607*    MOVE '*$I    L              ''   #00003519' TO DFHEIV0
  3608     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3609     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3610     MOVE X'2020233030303033353139' TO DFHEIV0(25:11)
  3611     CALL 'kxdfhei1' USING DFHEIV0,
  3612           QID,
  3613           PROGRAM-INTERFACE-BLOCK,
  3614           PI-COMM-LENGTH,
  3615           DFHEIV99,
  3616           DFHEIV99,
  3617           DFHEIV99
  3618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3619
  3620
  3621     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3622
  3623 0690-EXIT.
  3624      EXIT.
  3625
  3626 0800-DELETE-TS.
  3627
  3628* EXEC CICS HANDLE CONDITION
  3629*        QIDERR (0890-EXIT)
  3630*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  73
* EL633.cbl
  3631*    MOVE '"$N                   ! $ #00003531' TO DFHEIV0
  3632     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3633     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3634     MOVE X'2420233030303033353331' TO DFHEIV0(25:11)
  3635     CALL 'kxdfhei1' USING DFHEIV0
  3636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3637
  3638
  3639
  3640* EXEC CICS DELETEQ TS
  3641*        QUEUE  (QID)
  3642*    END-EXEC.
  3643*    MOVE '*&                    #   #00003535' TO DFHEIV0
  3644     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3645     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3646     MOVE X'2020233030303033353335' TO DFHEIV0(25:11)
  3647     CALL 'kxdfhei1' USING DFHEIV0,
  3648           QID,
  3649           DFHEIV99
  3650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3651
  3652
  3653
  3654* EXEC CICS SYNCPOINT
  3655*    END-EXEC.
  3656*    MOVE '6"                    !   #00003539' TO DFHEIV0
  3657     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3658     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3659     MOVE X'2020233030303033353339' TO DFHEIV0(25:11)
  3660     CALL 'kxdfhei1' USING DFHEIV0
  3661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3662
  3663
  3664 0890-EXIT.
  3665      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  74
* EL633.cbl
  3667
  3668 1000-EDIT-DATA.
  3669     SET PINDX                   TO  1.
  3670
  3671     .
  3672 1010-EDIT-LOOP.
  3673     SET NDX                     TO  PINDX.
  3674     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3675        GL-STATE-LEN (PINDX) = ZEROS   AND
  3676        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3677        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3678        RTYPE-LEN (PINDX)     = ZEROS  AND
  3679        AMT-LEN (PINDX)       = ZEROS  AND
  3680        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3681        SDTE-LEN (PINDX)      = ZEROS
  3682         GO TO 1020-INCREMENT-PINDX.
  3683
  3684     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3685         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3686         IF PI-COMPANY-ID NOT = 'WSL'
  3687             NEXT SENTENCE
  3688         ELSE
  3689             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3690             MOVE '4'                   TO  DC-OPTION-CODE
  3691             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3692             IF NO-CONVERSION-ERROR
  3693                 NEXT SENTENCE
  3694             ELSE
  3695                 MOVE ER-2595    TO  EMI-ERROR
  3696                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3697                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3698                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3699     ELSE
  3700         IF PI-COMPANY-ID = 'WSL'
  3701           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3702             MOVE ER-2596        TO  EMI-ERROR
  3703             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3704             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3705             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3706
  3707
  3708     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3709*        MOVE K-SPACE            TO COFA-FILLER
  3710*        MOVE '0001'             TO COFA-COMPANY-X
  3711*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3712         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3713     ELSE
  3714         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3715             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3716             MOVE ER-2957        TO EMI-ERROR
  3717             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3718             PERFORM 9900-ERROR-FORMAT THRU
  3719                     9900-EXIT
  3720             GO TO 1040-CONTINUE-EDIT
  3721         ELSE
  3722             GO TO 1040-CONTINUE-EDIT
  3723         END-IF
  3724     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  75
* EL633.cbl
  3725
  3726     IF (PI-COMPANY-ID = 'DCC')
  3727        AND (RTYPE (PINDX) = 'P')
  3728        GO TO 1040-CONTINUE-EDIT
  3729     ELSE
  3730        IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3731           MOVE GL-ACCT (PINDX)  TO CHECK-GL-ACCT
  3732           IF (PI-COMPANY-ID = 'DCC')
  3733              AND (CO-CARRIER NOT = '3' AND '4')
  3734              AND (CO-CARRIER NOT = '5' AND '6')
  3735              IF VALID-DCC-GL-ACCOUNT
  3736                 GO TO 1040-CONTINUE-EDIT
  3737              END-IF
  3738           ELSE
  3739              IF (PI-COMPANY-ID = 'DCC')
  3740               AND (CO-CARRIER NOT = '5' AND '6')
  3741                 IF VALID-CSI-GL-ACCOUNT
  3742                    GO TO 1040-CONTINUE-EDIT
  3743                 END-IF
  3744              ELSE
  3745               IF PI-COMPANY-ID = 'DCC'
  3746                 IF NOT VALID-CCC-GL-ACCOUNT
  3747                    GO TO 1040-CONTINUE-EDIT
  3748                 END-IF
  3749               ELSE
  3750                 IF VALID-GL-ACCOUNT
  3751                    GO TO 1040-CONTINUE-EDIT
  3752                 END-IF
  3753               END-IF
  3754              END-IF
  3755           END-IF
  3756        END-IF
  3757     END-IF
  3758
  3759*    EXEC CICS HANDLE CONDITION
  3760*         NOTFND (1040-NO-COFA-MSTR)
  3761*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3762*    END-EXEC.
  3763*
  3764*    EXEC CICS READ
  3765*         DATASET (COFA-FILE-ID)
  3766*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3767*         RIDFLD  (COFA-KEY-X)
  3768*    END-EXEC.
  3769*
  3770*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3771*    GO TO 1040-CONTINUE-EDIT.
  3772*
  3773*1040-NO-COFA-MSTR.
  3774
  3775     MOVE ER-2960                TO EMI-ERROR.
  3776     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3777     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3778     PERFORM 9900-ERROR-FORMAT THRU
  3779             9900-EXIT.
  3780
  3781 1040-CONTINUE-EDIT.
  3782
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  76
* EL633.cbl
  3783*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3784     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3785         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
  3786         IF NOT VALID-STATE-CODE
  3787             MOVE -1             TO GL-STATE-LEN (PINDX)
  3788             MOVE ER-2957        TO EMI-ERROR
  3789             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3790             PERFORM 9900-ERROR-FORMAT THRU
  3791                     9900-EXIT
  3792         ELSE
  3793             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3794         END-IF
  3795     END-IF.
  3796
  3797 1040-CSO-SKIP.
  3798
  3799     IF GL-CANC (PINDX) = LOW-VALUES
  3800         MOVE SPACES             TO GL-CANC (PINDX)
  3801     END-IF.
  3802
  3803     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3804         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3805         IF NOT VALID-CANC-TYPE
  3806             MOVE -1             TO GL-CANC-LEN (PINDX)
  3807             MOVE ER-2958        TO EMI-ERROR
  3808             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3809             PERFORM 9900-ERROR-FORMAT THRU
  3810                     9900-EXIT
  3811         ELSE
  3812             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3813         END-IF
  3814     END-IF.
  3815
  3816     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3817        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3818        IF (PI-COMPANY-ID = 'DCC')
  3819           AND (RTYPE (PINDX) = 'P')
  3820           SET VALID-REC-TYPE   TO TRUE
  3821        END-IF
  3822         IF NOT VALID-REC-TYPE
  3823             MOVE -1             TO  RTYPE-LEN (PINDX)
  3824             MOVE ER-2234        TO  EMI-ERROR
  3825             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3826             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3827         ELSE
  3828             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3829     ELSE
  3830         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3831             MOVE -1             TO  RTYPE-LEN (PINDX)
  3832             MOVE ER-2235        TO  EMI-ERROR
  3833             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3834             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3835
  3836     IF AMT-LEN (PINDX) NOT = ZEROS
  3837
  3838* EXEC CICS BIF DEEDIT
  3839*           FIELD (AMT (PINDX))
  3840*           LENGTH (11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  77
* EL633.cbl
  3841*       END-EXEC
  3842     MOVE 11
  3843       TO DFHEIV11
  3844*    MOVE '@"L                   #   #00003715' TO DFHEIV0
  3845     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3846     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3847     MOVE X'2020233030303033373135' TO DFHEIV0(25:11)
  3848     CALL 'kxdfhei1' USING DFHEIV0,
  3849           AMT(PINDX),
  3850           DFHEIV11
  3851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3852         IF AMT (PINDX) = ZEROS
  3853             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3854                 NEXT SENTENCE
  3855             ELSE
  3856                 MOVE ER-2245    TO  EMI-ERROR
  3857                 MOVE -1         TO  AMT-LEN(PINDX)
  3858                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3859                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3860         ELSE
  3861             IF AMT (PINDX) NUMERIC
  3862                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3863             ELSE
  3864                 MOVE ER-2245    TO  EMI-ERROR
  3865                 MOVE -1         TO  AMT-LEN(PINDX)
  3866                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3867                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3868     ELSE
  3869         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3870             MOVE -1             TO  AMT-LEN (PINDX)
  3871             MOVE ER-2236        TO  EMI-ERROR
  3872             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3873             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3874
  3875     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3876         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3877           AND (PI-REC-TYPE (NDX) = 'C')
  3878             IF VOID-SW (PINDX) = 'V'
  3879                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3880             ELSE
  3881                 MOVE ER-2246    TO  EMI-ERROR
  3882                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3883                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3884                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3885         ELSE
  3886             MOVE ER-2449        TO  EMI-ERROR
  3887             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3888             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3889             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3890
  3891     IF SDTE-LEN (PINDX) = ZEROS
  3892        GO TO 1020-INCREMENT-PINDX.
  3893
  3894     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3895
  3896     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3897     PERFORM 8600-DEEDIT.
  3898
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  78
* EL633.cbl
  3899     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3900        GO TO 1015-DAY-ERROR.
  3901
  3902     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3903     MOVE '4'                    TO  DC-OPTION-CODE.
  3904     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3905
  3906     IF NO-CONVERSION-ERROR
  3907        SET PINDEX               TO  PINDX
  3908        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3909     ELSE
  3910        GO TO 1015-DAY-ERROR.
  3911
  3912     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3913
  3914     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3915         IF DATE-TEST-DD  NOT = 30
  3916             GO TO 1015-DAY-ERROR
  3917         ELSE
  3918             GO TO 1020-INCREMENT-PINDX.
  3919
  3920     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3921                             8  OR  10  OR  12
  3922         IF DATE-TEST-DD  NOT = 31
  3923             GO TO 1015-DAY-ERROR
  3924         ELSE
  3925             GO TO 1020-INCREMENT-PINDX.
  3926
  3927     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3928         REMAINDER  DIVIDE-REMAINDER.
  3929
  3930     IF (DATE-TEST-YY = ZERO)
  3931       OR (DIVIDE-REMAINDER NOT = ZERO)
  3932         IF DATE-TEST-DD  NOT = 28
  3933             GO TO 1015-DAY-ERROR
  3934         ELSE
  3935             GO TO 1020-INCREMENT-PINDX
  3936     ELSE
  3937         IF DATE-TEST-DD = 29
  3938             GO TO 1020-INCREMENT-PINDX.
  3939
  3940 1015-DAY-ERROR.
  3941     MOVE -1                     TO  SDTE-LEN (PINDX).
  3942     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3943     MOVE ER-0587                TO  EMI-ERROR.
  3944
  3945     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3946
  3947 1020-INCREMENT-PINDX.
  3948     SET PINDX  UP  BY  1.
  3949
  3950     IF PINDX  IS NOT GREATER THAN  13
  3951         GO TO 1010-EDIT-LOOP.
  3952
  3953     IF EMI-ERROR = ZEROS
  3954         NEXT SENTENCE
  3955     ELSE
  3956         MOVE 'S'                TO  PI-PREV-FUNCTION
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  79
* EL633.cbl
  3957         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  80
* EL633.cbl
  3959 2000-UPDATE-THE-FILE.
  3960     SET PINDX                   TO  ZERO-NDX.
  3961*    SET NDX                     TO  ZERO-NDX.
  3962*    SET NDX  UP  BY  1.
  3963
  3964     IF PI-PYAJ-FILE-SW = 'B'
  3965         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  3966         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  3967     ELSE
  3968         MOVE PI-LAST-FILE-SEQ-NO
  3969                                 TO  PI-SAV-FILE-SEQ-NO
  3970         MOVE PI-LAST-RECORD-TYPE
  3971                                 TO  PI-SAV-RECORD-TYPE.
  3972
  3973 2100-UPDATE-LOOP.
  3974     SET PINDX  UP  BY  1.
  3975     SET NDX                     TO  PINDX.
  3976
  3977     IF PINDX  IS GREATER THAN  13
  3978         GO TO 2200-UPDATE-COMPLETE.
  3979
  3980     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  3981        GL-STATE-LEN (PINDX) = ZEROS AND
  3982        GL-CANC-LEN (PINDX)   = ZEROS AND
  3983        GL-COMM-LEN (PINDX)   = ZEROS AND
  3984        RTYPE-LEN (PINDX)   = ZEROS  AND
  3985        AMT-LEN (PINDX)     = ZEROS  AND
  3986        VOID-SW-LEN (PINDX) = ZEROS  AND
  3987        SDTE-LEN (PINDX)    = ZEROS
  3988         GO TO 2100-UPDATE-LOOP.
  3989
  3990
  3991* EXEC CICS BIF DEEDIT
  3992*         FIELD (AMT (PINDX))
  3993*         LENGTH (11)
  3994*    END-EXEC.
  3995     MOVE 11
  3996       TO DFHEIV11
  3997*    MOVE '@"L                   #   #00003857' TO DFHEIV0
  3998     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3999     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4000     MOVE X'2020233030303033383537' TO DFHEIV0(25:11)
  4001     CALL 'kxdfhei1' USING DFHEIV0,
  4002           AMT(PINDX),
  4003           DFHEIV11
  4004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4005
  4006
  4007     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4008         NEXT SENTENCE
  4009     ELSE
  4010         GO TO 2110-ADD-RECORD.
  4011
  4012
  4013* EXEC CICS HANDLE CONDITION
  4014*        NOTFND  (2110-ADD-RECORD)
  4015*    END-EXEC.
  4016*    MOVE '"$I                   ! % #00003867' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  81
* EL633.cbl
  4017     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4019     MOVE X'2520233030303033383637' TO DFHEIV0(25:11)
  4020     CALL 'kxdfhei1' USING DFHEIV0
  4021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4022
  4023
  4024     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4025     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4026     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4027
  4028
  4029* EXEC CICS READ
  4030*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4031*        DATASET  (PYAJ-FILE-ID)
  4032*        RIDFLD   (ERPYAJ-KEY)
  4033*        UPDATE
  4034*    END-EXEC.
  4035*    MOVE '&"S        EU         (   #00003875' TO DFHEIV0
  4036     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4037     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4038     MOVE X'2020233030303033383735' TO DFHEIV0(25:11)
  4039     CALL 'kxdfhei1' USING DFHEIV0,
  4040           PYAJ-FILE-ID,
  4041           DFHEIV20,
  4042           DFHEIV99,
  4043           ERPYAJ-KEY,
  4044           DFHEIV99,
  4045           DFHEIV99,
  4046           DFHEIV99
  4047     SET ADDRESS OF PENDING-PAY-ADJ TO
  4048         DFHEIV20
  4049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4050
  4051
  4052
  4053     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4054        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4055            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4056            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4057            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4058
  4059     IF AMT-LEN (PINDX) NOT = ZEROS
  4060         IF AMT (PINDX) = ZEROS
  4061             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4062                 GO TO 2120-DELETE-RECORD
  4063             ELSE
  4064                 MOVE ER-2244       TO  EMI-ERROR
  4065                 MOVE -1            TO  AMT-LEN (PINDX)
  4066                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4067                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4068                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4069
  4070* EXEC CICS UNLOCK
  4071*                    DATASET  (PYAJ-FILE-ID)
  4072*                END-EXEC
  4073*    MOVE '&*                    #   #00003899' TO DFHEIV0
  4074     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  82
* EL633.cbl
  4075     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4076     MOVE X'2020233030303033383939' TO DFHEIV0(25:11)
  4077     CALL 'kxdfhei1' USING DFHEIV0,
  4078           PYAJ-FILE-ID,
  4079           DFHEIV99
  4080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4081                 GO TO 8200-SEND-DATAONLY.
  4082
  4083     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4084     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4085     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4086
  4087     PERFORM 8400-LOG-JOURNAL-RECORD.
  4088
  4089     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4090     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4091     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4092
  4093     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4094         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4095     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4096         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4097     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4098         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4099     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4100         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4101     IF AMT-LEN (PINDX) NOT = ZEROS
  4102         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4103
  4104     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4105         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4106
  4107     IF SDTE-LEN (PINDX) NOT = ZEROS
  4108        SET PINDEX               TO  PINDX
  4109        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4110
  4111     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4112     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4113     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4114
  4115
  4116* EXEC CICS REWRITE
  4117*        DATASET  (PYAJ-FILE-ID)
  4118*        FROM     (PENDING-PAY-ADJ)
  4119*    END-EXEC.
  4120     MOVE LENGTH OF
  4121      PENDING-PAY-ADJ
  4122       TO DFHEIV11
  4123*    MOVE '&& L                  %   #00003936' TO DFHEIV0
  4124     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4125     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4126     MOVE X'2020233030303033393336' TO DFHEIV0(25:11)
  4127     CALL 'kxdfhei1' USING DFHEIV0,
  4128           PYAJ-FILE-ID,
  4129           PENDING-PAY-ADJ,
  4130           DFHEIV11,
  4131           DFHEIV99
  4132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  83
* EL633.cbl
  4133
  4134
  4135     PERFORM 8400-LOG-JOURNAL-RECORD.
  4136
  4137     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  84
* EL633.cbl
  4139 2110-ADD-RECORD.
  4140
  4141* EXEC CICS GETMAIN
  4142*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4143*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4144*        INITIMG  (GETMAIN-SPACE)
  4145*    END-EXEC.
  4146*    MOVE ',"IL                  $   #00003946' TO DFHEIV0
  4147     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4148     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4149     MOVE X'2020233030303033393436' TO DFHEIV0(25:11)
  4150     CALL 'kxdfhei1' USING DFHEIV0,
  4151           DFHEIV20,
  4152           ERPYAJ-RECORD-LENGTH,
  4153           GETMAIN-SPACE
  4154     SET ADDRESS OF PENDING-PAY-ADJ TO
  4155         DFHEIV20
  4156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4157
  4158
  4159     MOVE 'PY'                   TO  PY-RECORD-ID.
  4160     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4161     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4162     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4163     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4164     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4165
  4166     ADD +1                      TO  WORK-SEQ-NO.
  4167     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4168
  4169     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4170     MOVE GL-STATE (PINDX)       TO  PY-GL-STATE.
  4171     MOVE GL-CANC (PINDX)        TO  PY-GL-CANC-SW.
  4172     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4173
  4174     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4175     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4176     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4177        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4178     END-IF
  4179     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4180     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4181     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4182                                     PY-INPUT-DT.
  4183     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4184                                     PY-CHECK-QUE-SEQUENCE.
  4185     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4186                                     PY-BILLED-DATE
  4187                                     PY-AR-DATE
  4188                                     PY-REPORTED-DT
  4189                                     PY-CHECK-WRITTEN-DT.
  4190     IF SDTE-LEN (PINDX) = ZEROS
  4191         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4192         GO TO 2115-WRITE-REC
  4193     END-IF.
  4194
  4195     IF SDTE (PINDX) IS NUMERIC
  4196         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  85
* EL633.cbl
  4197         MOVE '4'            TO  DC-OPTION-CODE
  4198         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4199         IF DATE-CONVERSION-ERROR
  4200             MOVE PI-CR-MONTH-END-DT
  4201                             TO  PY-CREDIT-SELECT-DT
  4202         ELSE
  4203             MOVE DC-BIN-DATE-1
  4204                             TO  PY-CREDIT-SELECT-DT
  4205         END-IF
  4206     ELSE
  4207         MOVE PI-CR-MONTH-END-DT
  4208                             TO  PY-CREDIT-SELECT-DT
  4209     END-IF
  4210
  4211     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4212         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4213         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4214
  4215     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4216         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4217         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4218
  4219     MOVE 'N'                    TO  FIRST-ADD-SW.
  4220
  4221     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4222     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4223     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4224 2115-WRITE-REC.
  4225
  4226* EXEC CICS WRITE
  4227*        DATASET  (PYAJ-FILE-ID)
  4228*        FROM     (PENDING-PAY-ADJ)
  4229*        RIDFLD   (PY-CONTROL-PRIMARY)
  4230*    END-EXEC.
  4231     MOVE LENGTH OF
  4232      PENDING-PAY-ADJ
  4233       TO DFHEIV11
  4234*    MOVE '&$ L                  ''   #00004018' TO DFHEIV0
  4235     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4236     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4237     MOVE X'2020233030303034303138' TO DFHEIV0(25:11)
  4238     CALL 'kxdfhei1' USING DFHEIV0,
  4239           PYAJ-FILE-ID,
  4240           PENDING-PAY-ADJ,
  4241           DFHEIV11,
  4242           PY-CONTROL-PRIMARY,
  4243           DFHEIV99,
  4244           DFHEIV99
  4245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4246
  4247
  4248     PERFORM 8400-LOG-JOURNAL-RECORD.
  4249
  4250     GO TO 2100-UPDATE-LOOP.
  4251
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  86
* EL633.cbl
  4253 2120-DELETE-RECORD.
  4254     IF PY-RECORD-TYPE NOT = 'C'
  4255         GO TO 2120-DELETE-CONT.
  4256
  4257     IF PY-CHECK-QUE-CONTROL = ZEROS
  4258       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4259         GO TO 2120-DELETE-CONT.
  4260
  4261
  4262* EXEC CICS HANDLE CONDITION
  4263*        NOTFND  (2120-DELETE-CONT)
  4264*    END-EXEC.
  4265*    MOVE '"$I                   ! & #00004037' TO DFHEIV0
  4266     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4267     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4268     MOVE X'2620233030303034303337' TO DFHEIV0(25:11)
  4269     CALL 'kxdfhei1' USING DFHEIV0
  4270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4271
  4272
  4273     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4274     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4275     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4276
  4277
  4278* EXEC CICS READ
  4279*        SET      (ADDRESS OF CHECK-QUE)
  4280*        DATASET  (CHKQ-FILE-ID)
  4281*        RIDFLD   (ERCHKQ-KEY)
  4282*        UPDATE
  4283*    END-EXEC.
  4284*    MOVE '&"S        EU         (   #00004045' TO DFHEIV0
  4285     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4286     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4287     MOVE X'2020233030303034303435' TO DFHEIV0(25:11)
  4288     CALL 'kxdfhei1' USING DFHEIV0,
  4289           CHKQ-FILE-ID,
  4290           DFHEIV20,
  4291           DFHEIV99,
  4292           ERCHKQ-KEY,
  4293           DFHEIV99,
  4294           DFHEIV99,
  4295           DFHEIV99
  4296     SET ADDRESS OF CHECK-QUE TO
  4297         DFHEIV20
  4298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4299
  4300
  4301*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4302*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4303*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4304*
  4305*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4306
  4307
  4308* EXEC CICS DELETE
  4309*        DATASET  (CHKQ-FILE-ID)
  4310*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  87
* EL633.cbl
  4311*    MOVE '&(                    &   #00004058' TO DFHEIV0
  4312     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4313     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4314     MOVE X'2020233030303034303538' TO DFHEIV0(25:11)
  4315     CALL 'kxdfhei1' USING DFHEIV0,
  4316           CHKQ-FILE-ID,
  4317           DFHEIV99,
  4318           DFHEIV99,
  4319           DFHEIV99,
  4320           DFHEIV99
  4321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4322
  4323
  4324 2120-DELETE-CONT.
  4325*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4326*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4327*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4328*
  4329*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4330
  4331     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4332         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4333         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4334         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4335                                     PI-SAV-ACCT-NET
  4336                                     PI-SAV-PREV-AMT
  4337                                     PI-SAV-PREV-NET.
  4338
  4339
  4340* EXEC CICS DELETE
  4341*        DATASET(PYAJ-FILE-ID)
  4342*    END-EXEC.
  4343*    MOVE '&(                    &   #00004077' TO DFHEIV0
  4344     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4345     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4346     MOVE X'2020233030303034303737' TO DFHEIV0(25:11)
  4347     CALL 'kxdfhei1' USING DFHEIV0,
  4348           PYAJ-FILE-ID,
  4349           DFHEIV99,
  4350           DFHEIV99,
  4351           DFHEIV99,
  4352           DFHEIV99
  4353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4354
  4355
  4356     GO TO 2100-UPDATE-LOOP.
  4357
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  88
* EL633.cbl
  4359
  4360 2190-CHANGE-RECORD-TYPE.
  4361
  4362*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4363*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4364*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4365*
  4366*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4367
  4368
  4369* EXEC CICS DELETE
  4370*        DATASET(PYAJ-FILE-ID)
  4371*    END-EXEC.
  4372*    MOVE '&(                    &   #00004093' TO DFHEIV0
  4373     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4374     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4375     MOVE X'2020233030303034303933' TO DFHEIV0(25:11)
  4376     CALL 'kxdfhei1' USING DFHEIV0,
  4377           PYAJ-FILE-ID,
  4378           DFHEIV99,
  4379           DFHEIV99,
  4380           DFHEIV99,
  4381           DFHEIV99
  4382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4383
  4384
  4385
  4386* EXEC CICS GETMAIN
  4387*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4388*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4389*        INITIMG  (GETMAIN-SPACE)
  4390*    END-EXEC.
  4391*    MOVE ',"IL                  $   #00004097' TO DFHEIV0
  4392     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4393     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4394     MOVE X'2020233030303034303937' TO DFHEIV0(25:11)
  4395     CALL 'kxdfhei1' USING DFHEIV0,
  4396           DFHEIV20,
  4397           ERPYAJ-RECORD-LENGTH,
  4398           GETMAIN-SPACE
  4399     SET ADDRESS OF PENDING-PAY-ADJ TO
  4400         DFHEIV20
  4401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4402
  4403
  4404*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4405*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4406
  4407     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4408     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4409                                    PYAJ-RECORD-TYPE.
  4410
  4411
  4412* EXEC CICS HANDLE CONDITION
  4413*        DUPREC (2190-DUP-RECORD)
  4414*    END-EXEC.
  4415*    MOVE '"$%                   ! '' #00004110' TO DFHEIV0
  4416     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  89
* EL633.cbl
  4417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4418     MOVE X'2720233030303034313130' TO DFHEIV0(25:11)
  4419     CALL 'kxdfhei1' USING DFHEIV0
  4420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4421
  4422
  4423*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4424*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4425*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4426
  4427 2190-RETRY-WRITE.
  4428
  4429
  4430* EXEC CICS WRITE
  4431*        DATASET  (PYAJ-FILE-ID)
  4432*        FROM     (PENDING-PAY-ADJ)
  4433*        RIDFLD   (PY-CONTROL-PRIMARY)
  4434*    END-EXEC.
  4435     MOVE LENGTH OF
  4436      PENDING-PAY-ADJ
  4437       TO DFHEIV11
  4438*    MOVE '&$ L                  ''   #00004120' TO DFHEIV0
  4439     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4440     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4441     MOVE X'2020233030303034313230' TO DFHEIV0(25:11)
  4442     CALL 'kxdfhei1' USING DFHEIV0,
  4443           PYAJ-FILE-ID,
  4444           PENDING-PAY-ADJ,
  4445           DFHEIV11,
  4446           PY-CONTROL-PRIMARY,
  4447           DFHEIV99,
  4448           DFHEIV99
  4449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4450
  4451
  4452*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4453
  4454
  4455* EXEC CICS READ
  4456*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4457*        DATASET  (PYAJ-FILE-ID)
  4458*        RIDFLD   (ERPYAJ-KEY)
  4459*        UPDATE
  4460*    END-EXEC.
  4461*    MOVE '&"S        EU         (   #00004128' TO DFHEIV0
  4462     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4463     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4464     MOVE X'2020233030303034313238' TO DFHEIV0(25:11)
  4465     CALL 'kxdfhei1' USING DFHEIV0,
  4466           PYAJ-FILE-ID,
  4467           DFHEIV20,
  4468           DFHEIV99,
  4469           ERPYAJ-KEY,
  4470           DFHEIV99,
  4471           DFHEIV99,
  4472           DFHEIV99
  4473     SET ADDRESS OF PENDING-PAY-ADJ TO
  4474         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  90
* EL633.cbl
  4475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4476
  4477
  4478     GO TO 2190-EXIT.
  4479
  4480 2190-DUP-RECORD.
  4481
  4482     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4483
  4484     GO TO 2190-RETRY-WRITE.
  4485
  4486 2190-EXIT.
  4487     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  91
* EL633.cbl
  4489
  4490 2200-UPDATE-COMPLETE.
  4491     IF EIBAID = DFHPF1
  4492         GO TO 4000-BROWSE-FRWD.
  4493
  4494     IF EIBAID = DFHPF2
  4495         GO TO 4100-BROWSE-BKWD.
  4496
  4497     MOVE LOW-VALUES             TO  EL633AI.
  4498
  4499     MOVE ER-0000                TO  EMI-ERROR.
  4500     MOVE -1                     TO  MAINTL.
  4501
  4502     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4503
  4504     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4505     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4506
  4507*    GO TO 4000-BROWSE-FRWD.
  4508
  4509*    GO TO 8100-SEND-INITIAL-MAP.
  4510
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  92
* EL633.cbl
  4512 4000-BROWSE-FRWD.
  4513     MOVE '1'                     TO  PI-PREV-PFKEY.
  4514     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4515
  4516     IF EIBAID = DFHPF1
  4517         IF PAGE-FULL
  4518             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4519                                      TO  PYAJ-FILE-SEQ-NO
  4520             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4521             MOVE 'N'                 TO  PYAJ-READ-SW
  4522             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4523             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4524             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4525             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4526         ELSE
  4527             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4528                                          PI-SAV-ACCT-NET
  4529                                          PI-SAV-PREV-AMT
  4530                                          PI-SAV-PREV-NET
  4531             MOVE 'Y'                 TO  PI-PAGE-SW
  4532             IF NOT END-OF-FILE
  4533                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4534                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4535             END-IF
  4536             IF TOP-OF-FILE
  4537                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4538                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4539                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4540             ELSE
  4541                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4542                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4543     ELSE
  4544         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4545         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4546         IF MAINTI = 'S'
  4547             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4548             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4549
  4550
  4551     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4552
  4553     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4554         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4555
  4556 4000-BROWSE-FRWD-FOR-PREV.
  4557*    IF END-OF-FILE
  4558*        IF EIBAID = DFHPF1
  4559*           IF PI-TOTAL-DISPLAYED
  4560*              NEXT SENTENCE
  4561*           ELSE
  4562*              MOVE -1                 TO  MAINTL
  4563*              MOVE ER-2237            TO  EMI-ERROR
  4564*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4565*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4566*              SET PINDX               TO  +2
  4567*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4568*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4569*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  93
* EL633.cbl
  4570*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4571*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4572*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4573*                                          PI-SAV-ACCT-NET
  4574*              GO TO 8100-SEND-INITIAL-MAP.
  4575*
  4576*     IF END-OF-FILE
  4577*        IF EIBAID = DFHPF1
  4578*           MOVE -1             TO  MAINTL
  4579*           MOVE ER-2237        TO  EMI-ERROR
  4580*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4581*           GO TO 8200-SEND-DATAONLY.
  4582*
  4583     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4584
  4585     IF NO-RECORDS
  4586        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4587        MOVE LOW-VALUES         TO  EL633AO
  4588        MOVE ER-2239            TO  EMI-ERROR
  4589        MOVE -1                 TO  MAINTL
  4590        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4591        GO TO 8100-SEND-INITIAL-MAP.
  4592
  4593     IF NOT-OPEN
  4594         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4595
  4596     MOVE LOW-VALUES             TO  EL633AO.
  4597     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4598
  4599     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4600          VARYING  PINDX  FROM  1  BY  1
  4601             UNTIL  END-OF-ACCT
  4602                 OR  END-OF-FILE
  4603                     OR  PAGE-FULL
  4604                         OR  NO-RECORDS.
  4605
  4606     IF NO-RECORDS
  4607         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4608         MOVE LOW-VALUES         TO  EL633AO
  4609         MOVE ER-2239            TO  EMI-ERROR
  4610         MOVE -1                 TO  MAINTL
  4611         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4612         GO TO 8100-SEND-INITIAL-MAP.
  4613
  4614     IF END-OF-FILE
  4615         IF EIBAID = DFHPF2
  4616             MOVE ER-2238        TO  EMI-ERROR
  4617             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4618             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4619         ELSE
  4620             MOVE ER-2237        TO  EMI-ERROR
  4621             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4622
  4623     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4624                                     PI-SAV-FUNCTION.
  4625
  4626     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  94
* EL633.cbl
  4628 4100-BROWSE-BKWD.
  4629     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4630                                      PI-TOTAL-DISPLAYED-SW.
  4631     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4632     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4633     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4634     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4635                                      PI-SAV-ACCT-NET
  4636                                      PI-SAV-PREV-AMT
  4637                                      PI-SAV-PREV-NET.
  4638
  4639     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4640
  4641     IF NO-RECORDS
  4642         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4643         MOVE LOW-VALUES         TO  EL633AO
  4644         MOVE ER-2239            TO  EMI-ERROR
  4645         MOVE -1                 TO  MAINTL
  4646         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4647         GO TO 8100-SEND-INITIAL-MAP.
  4648
  4649     IF NOT-OPEN
  4650         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4651
  4652
  4653* EXEC CICS READNEXT
  4654*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4655*        DATASET  (PYAJ-FILE-ID)
  4656*        RIDFLD   (ERPYAJ-KEY)
  4657*    END-EXEC.
  4658     MOVE 0
  4659       TO DFHEIV11
  4660*    MOVE '&.S                   )   #00004309' TO DFHEIV0
  4661     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4662     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4663     MOVE X'2020233030303034333039' TO DFHEIV0(25:11)
  4664     CALL 'kxdfhei1' USING DFHEIV0,
  4665           PYAJ-FILE-ID,
  4666           DFHEIV20,
  4667           DFHEIV99,
  4668           ERPYAJ-KEY,
  4669           DFHEIV99,
  4670           DFHEIV11,
  4671           DFHEIV99,
  4672           DFHEIV99
  4673     SET ADDRESS OF PENDING-PAY-ADJ TO
  4674         DFHEIV20
  4675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4676
  4677
  4678     IF FIRST-PAGE OR
  4679        PI-PREV-PFKEY = '2'
  4680         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4681         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4682
  4683     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4684
  4685     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  95
* EL633.cbl
  4686     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4687     MOVE '2'                     TO  PI-PREV-PFKEY.
  4688
  4689     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  96
* EL633.cbl
  4691 5000-START-BROWSE.
  4692
  4693* EXEC CICS HANDLE CONDITION
  4694*        NOTOPEN  (5010-NOT-OPEN)
  4695*        NOTFND   (5020-NO-RECORDS)
  4696*        ENDFILE  (5020-NO-RECORDS)
  4697*    END-EXEC.
  4698*    MOVE '"$JI''                 ! ( #00004329' TO DFHEIV0
  4699     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4701     MOVE X'2820233030303034333239' TO DFHEIV0(25:11)
  4702     CALL 'kxdfhei1' USING DFHEIV0
  4703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4704
  4705
  4706
  4707* EXEC CICS STARTBR
  4708*        DATASET  (PYAJ-FILE-ID)
  4709*        RIDFLD   (ERPYAJ-KEY)
  4710*    END-EXEC.
  4711     MOVE 0
  4712       TO DFHEIV11
  4713*    MOVE '&,         G          &   #00004335' TO DFHEIV0
  4714     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4715     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4716     MOVE X'2020233030303034333335' TO DFHEIV0(25:11)
  4717     CALL 'kxdfhei1' USING DFHEIV0,
  4718           PYAJ-FILE-ID,
  4719           ERPYAJ-KEY,
  4720           DFHEIV99,
  4721           DFHEIV11,
  4722           DFHEIV99
  4723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4724
  4725
  4726     GO TO 5030-EXIT.
  4727
  4728 5010-NOT-OPEN.
  4729     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4730
  4731     GO TO 5030-EXIT.
  4732
  4733 5020-NO-RECORDS.
  4734     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4735     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4736
  4737 5030-EXIT.
  4738     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  97
* EL633.cbl
  4740 5100-READ-PREVIOUS.
  4741
  4742* EXEC CICS HANDLE CONDITION
  4743*        ENDFILE  (5110-END-OF-FILE)
  4744*        NOTFND   (5110-END-OF-FILE)
  4745*    END-EXEC.
  4746*    MOVE '"$''I                  ! ) #00004355' TO DFHEIV0
  4747     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4748     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4749     MOVE X'2920233030303034333535' TO DFHEIV0(25:11)
  4750     CALL 'kxdfhei1' USING DFHEIV0
  4751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4752
  4753
  4754
  4755* EXEC CICS READPREV
  4756*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4757*        DATASET  (PYAJ-FILE-ID)
  4758*        RIDFLD   (ERPYAJ-KEY)
  4759*    END-EXEC.
  4760     MOVE 0
  4761       TO DFHEIV11
  4762*    MOVE '&0S                   )   #00004360' TO DFHEIV0
  4763     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4764     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4765     MOVE X'2020233030303034333630' TO DFHEIV0(25:11)
  4766     CALL 'kxdfhei1' USING DFHEIV0,
  4767           PYAJ-FILE-ID,
  4768           DFHEIV20,
  4769           DFHEIV99,
  4770           ERPYAJ-KEY,
  4771           DFHEIV99,
  4772           DFHEIV11,
  4773           DFHEIV99,
  4774           DFHEIV99
  4775     SET ADDRESS OF PENDING-PAY-ADJ TO
  4776         DFHEIV20
  4777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4778
  4779
  4780     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4781         IF PI-CARRIER-SECURITY = PY-CARRIER
  4782             NEXT SENTENCE
  4783         ELSE
  4784             GO TO 5110-END-OF-FILE.
  4785
  4786     GO TO 5120-EXIT.
  4787
  4788 5110-END-OF-FILE.
  4789     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4790     MOVE ER-2238                TO  EMI-ERROR.
  4791     MOVE -1                     TO  PFENTERL.
  4792
  4793     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4794
  4795     GO TO 8200-SEND-DATAONLY.
  4796
  4797 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  98
* EL633.cbl
  4798     EXIT.
  4799
  4800 5200-END-BROWSE.
  4801
  4802* EXEC CICS ENDBR
  4803*        DATASET  (PYAJ-FILE-ID)
  4804*    END-EXEC.
  4805     MOVE 0
  4806       TO DFHEIV11
  4807*    MOVE '&2                    $   #00004387' TO DFHEIV0
  4808     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4809     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4810     MOVE X'2020233030303034333837' TO DFHEIV0(25:11)
  4811     CALL 'kxdfhei1' USING DFHEIV0,
  4812           PYAJ-FILE-ID,
  4813           DFHEIV11,
  4814           DFHEIV99
  4815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4816
  4817
  4818 5200-EXIT.
  4819     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  99
* EL633.cbl
  4821 6000-READ-AND-FORMAT-SCREEN.
  4822
  4823* EXEC CICS HANDLE CONDITION
  4824*        ENDFILE  (6100-END-OF-FILE)
  4825*        NOTFND   (6100-END-OF-FILE)
  4826*    END-EXEC.
  4827*    MOVE '"$''I                  ! * #00004395' TO DFHEIV0
  4828     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4830     MOVE X'2A20233030303034333935' TO DFHEIV0(25:11)
  4831     CALL 'kxdfhei1' USING DFHEIV0
  4832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4833
  4834
  4835*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4836*    INITIALIZE  PI-SEQ-NOS.
  4837
  4838 6010-READ-NEXT.
  4839
  4840
  4841* EXEC CICS READNEXT
  4842*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4843*        DATASET  (PYAJ-FILE-ID)
  4844*        RIDFLD   (ERPYAJ-KEY)
  4845*    END-EXEC.
  4846     MOVE 0
  4847       TO DFHEIV11
  4848*    MOVE '&.S                   )   #00004405' TO DFHEIV0
  4849     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4850     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4851     MOVE X'2020233030303034343035' TO DFHEIV0(25:11)
  4852     CALL 'kxdfhei1' USING DFHEIV0,
  4853           PYAJ-FILE-ID,
  4854           DFHEIV20,
  4855           DFHEIV99,
  4856           ERPYAJ-KEY,
  4857           DFHEIV99,
  4858           DFHEIV11,
  4859           DFHEIV99,
  4860           DFHEIV99
  4861     SET ADDRESS OF PENDING-PAY-ADJ TO
  4862         DFHEIV20
  4863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4864
  4865
  4866     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4867       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4868         GO TO 6100-END-OF-FILE.
  4869
  4870     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4871         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4872             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4873                 GO TO 6100-END-OF-FILE.
  4874
  4875     IF PYAJ-1ST-READ
  4876       AND EIBAID NOT = DFHENTER
  4877       AND NOT PAGE-FULL
  4878         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 100
* EL633.cbl
  4879         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4880         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4881         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4882         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4883
  4884     IF PYAJ-1ST-READ
  4885         MOVE PI-SAV-ENDING-PYAJ-KEY
  4886                                 TO  PI-START-PYAJ-KEY.
  4887
  4888     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4889        PI-SAV-CARRIER  = PY-CARRIER     AND
  4890        PI-SAV-GROUPING = PY-GROUPING    AND
  4891        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4892        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4893         NEXT SENTENCE
  4894     ELSE
  4895         IF PYAJ-1ST-READ
  4896             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4897             MOVE SPACE          TO  PYAJ-READ-SW
  4898             GO TO 6200-EXIT
  4899         ELSE
  4900             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4901             IF PINDX  IS LESS THAN  12
  4902                 SET PINDX  UP  BY  1
  4903                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4904                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4905                 SET PINDX  UP  BY  1
  4906                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4907                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4908                     GO TO 6200-EXIT
  4909             ELSE
  4910                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4911                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4912                 SET PINDX  UP  BY  1
  4913                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4914                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4915                 GO TO 6200-EXIT.
  4916
  4917*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4918
  4919     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4920         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4921
  4922*    SET PINDX  UP  BY +1.
  4923
  4924     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4925
  4926     IF PINDX  IS GREATER THAN  13
  4927         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4928         MOVE +13                TO  PI-FULL-INDX
  4929         MOVE PI-FRST-FILE-SEQ-NO
  4930                                 TO  PI-LAST-FILE-SEQ-NO
  4931         MOVE PI-FRST-RECORD-TYPE
  4932                                 TO  PI-LAST-RECORD-TYPE
  4933         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4934         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4935         GO TO 6200-EXIT.
  4936
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 101
* EL633.cbl
  4937     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4938     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4939
  4940     IF PYAJ-1ST-READ
  4941         MOVE SPACE              TO  PYAJ-READ-SW.
  4942
  4943     IF PINDX = 1
  4944         MOVE PI-PREV-FILE-SEQ-NO
  4945                                 TO  PI-FRST-FILE-SEQ-NO
  4946         MOVE PI-PREV-RECORD-TYPE
  4947                                 TO  PI-FRST-RECORD-TYPE
  4948         MOVE PI-PREV-FILE-SEQ-NO
  4949                                 TO  PI-LAST-FILE-SEQ-NO
  4950         MOVE PI-PREV-RECORD-TYPE
  4951                                 TO  PI-LAST-RECORD-TYPE.
  4952
  4953     SET NDX                     TO  PINDX.
  4954     SET WS-SAVE-NDX-VALUE       TO  NDX.
  4955
  4956     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  4957
  4958     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  4959     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  4960     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  4961     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  4962     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  4963
  4964     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  4965
  4966     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  4967         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  4968     ELSE
  4969         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  4970
  4971     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  4972                                     PI-REC-TYPE (NDX).
  4973
  4974     IF PY-VOID-SW NOT = SPACE
  4975         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  4976
  4977     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  4978         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  4979     ELSE
  4980         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  4981                                     PREV-BIN-MAINT-DT
  4982         MOVE SPACE              TO  DC-OPTION-CODE
  4983         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4984* DAN    MOVE DC-GREG-DATE-1-EDIT
  4985         MOVE DC-GREG-DATE-1-MDY
  4986                                 TO  MDTE (PINDX)
  4987                                     PREV-MAINT-DT.
  4988
  4989*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  4990     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  4991         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  4992         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  4993*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  4994*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 102
* EL633.cbl
  4995     END-IF.
  4996
  4997     IF PY-BILLED-DATE NOT = LOW-VALUES
  4998         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  4999                                     AMT-ATTRB (PINDX)
  5000                                     VOID-SW-ATTRB (PINDX)
  5001         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  5002             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5003         ELSE
  5004             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5005                                     PREV-BIN-BL-DT
  5006             MOVE SPACE          TO  DC-OPTION-CODE
  5007             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5008* DAN        MOVE DC-GREG-DATE-1-EDIT
  5009             MOVE DC-GREG-DATE-1-MDY
  5010                                 TO  BDTE (PINDX)
  5011                                     PREV-BL-DT.
  5012
  5013     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5014         NEXT SENTENCE
  5015     ELSE
  5016         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5017                                     AMT-ATTRB     (PINDX).
  5018
  5019     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5020         MOVE PY-CREDIT-SELECT-DT
  5021                                 TO  DC-BIN-DATE-1
  5022         MOVE SPACE              TO  DC-OPTION-CODE
  5023         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5024
  5025         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5026         MOVE WS-GS-MM             TO  WS-SS-MM
  5027         MOVE WS-GS-DD             TO  WS-SS-DD
  5028         MOVE WS-GS-YY             TO  WS-SS-YY
  5029         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5030     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5031        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5032         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5033                                    AMT-ATTRB      (PINDX)
  5034                                    GL-ACCT-ATTRB  (PINDX)
  5035                                    GL-COMM-ATTRB  (PINDX)
  5036                                    VOID-SW-ATTRB  (PINDX)
  5037                                    GL-STATE-ATTRB (PINDX)
  5038                                    GL-CANC-ATTRB  (PINDX)
  5039                                    SDTE-ATTRB     (PINDX)
  5040
  5041     END-IF
  5042
  5043*    GO TO 6010-READ-NEXT.
  5044     GO TO 6200-EXIT.
  5045
  5046 6100-END-OF-FILE.
  5047     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5048
  5049     IF PINDX  IS LESS THAN  12
  5050         SET PINDX  UP  BY  1
  5051         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5052         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 103
* EL633.cbl
  5053         SET PINDX  UP  BY  1
  5054         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5055         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5056         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5057     ELSE
  5058         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5059         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5060         SET PINDX  UP  BY  1
  5061         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5062         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5063
  5064 6200-EXIT.
  5065     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 104
* EL633.cbl
  5067 7000-PYAJ-FILE-NOTOPEN.
  5068     MOVE -1                     TO  MAINTL.
  5069     MOVE ER-2232                TO  EMI-ERROR.
  5070
  5071     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5072
  5073     GO TO 8200-SEND-DATAONLY.
  5074
  5075 7100-COMP-FILE-NOTOPEN.
  5076     MOVE -1                     TO  MAINTL.
  5077     MOVE ER-2233                TO  EMI-ERROR.
  5078
  5079     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5080
  5081     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 105
* EL633.cbl
  5083*
  5084*7100-COFA-FILE-NOTOPEN.
  5085*    MOVE -1                     TO PFENTERL.
  5086*    MOVE ER-2959                TO EMI-ERROR.
  5087*    PERFORM 9900-ERROR-FORMAT THRU
  5088*            9900-EXIT.
  5089*    GO TO 8200-SEND-DATAONLY.
  5090*
  5091 8100-SEND-INITIAL-MAP.
  5092     MOVE WS-CURRENT-DT          TO  DATEO.
  5093     MOVE EIBTIME                TO  TIME-IN.
  5094     MOVE TIME-OUT               TO  TIMEO.
  5095     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5096     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5097     MOVE -1                     TO  MAINTL.
  5098     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5099     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5100
  5101     IF EIBTRNID = TRANS-ID
  5102       OR EL640-TRANS-ID
  5103       OR EL642-TRANS-ID
  5104       OR EL652-TRANS-ID
  5105       OR EL6331-TRANS-ID
  5106         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5107             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5108             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5109             MOVE PI-SAV-GROUPING  TO  GROUPO
  5110             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5111             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5112             MOVE AL-UANON         TO  MAINTA
  5113                                       CARRIERA
  5114                                       GROUPA
  5115                                       FINRESPA
  5116                                       ACCTA
  5117         ELSE
  5118             NEXT SENTENCE.
  5119
  5120
  5121* EXEC CICS SEND
  5122*        MAP     (MAP-NAME)
  5123*        MAPSET  (MAPSET-NAME)
  5124*        FROM    (EL633AO)
  5125*        ERASE
  5126*        CURSOR
  5127*        END-EXEC.
  5128     MOVE LENGTH OF
  5129      EL633AO
  5130       TO DFHEIV12
  5131     MOVE -1
  5132       TO DFHEIV11
  5133*    MOVE '8$     CT  E    H L F ,   #00004665' TO DFHEIV0
  5134     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5135     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5136     MOVE X'2020233030303034363635' TO DFHEIV0(25:11)
  5137     CALL 'kxdfhei1' USING DFHEIV0,
  5138           MAP-NAME,
  5139           EL633AO,
  5140           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 106
* EL633.cbl
  5141           MAPSET-NAME,
  5142           DFHEIV99,
  5143           DFHEIV99,
  5144           DFHEIV99,
  5145           DFHEIV11,
  5146           DFHEIV99,
  5147           DFHEIV99,
  5148           DFHEIV99
  5149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5150
  5151
  5152     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 107
* EL633.cbl
  5154 8200-SEND-DATAONLY.
  5155     MOVE WS-CURRENT-DT          TO  DATEO.
  5156     MOVE EIBTIME                TO  TIME-IN.
  5157     MOVE TIME-OUT               TO  TIMEO.
  5158     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5159     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5160     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5161     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5162
  5163
  5164* EXEC CICS SEND
  5165*        MAP     (MAP-NAME)
  5166*        MAPSET  (MAPSET-NAME)
  5167*        FROM    (EL633AO)
  5168*        DATAONLY
  5169*        CURSOR
  5170*    END-EXEC.
  5171     MOVE LENGTH OF
  5172      EL633AO
  5173       TO DFHEIV12
  5174     MOVE -1
  5175       TO DFHEIV11
  5176*    MOVE '8$D    CT       H L F ,   #00004684' TO DFHEIV0
  5177     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5178     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5179     MOVE X'2020233030303034363834' TO DFHEIV0(25:11)
  5180     CALL 'kxdfhei1' USING DFHEIV0,
  5181           MAP-NAME,
  5182           EL633AO,
  5183           DFHEIV12,
  5184           MAPSET-NAME,
  5185           DFHEIV99,
  5186           DFHEIV99,
  5187           DFHEIV99,
  5188           DFHEIV11,
  5189           DFHEIV99,
  5190           DFHEIV99,
  5191           DFHEIV99
  5192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5193
  5194
  5195     GO TO 9100-RETURN-TRAN.
  5196
  5197 8300-SEND-TEXT.
  5198
  5199* EXEC CICS SEND TEXT
  5200*        FROM    (LOGOFF-TEXT)
  5201*        LENGTH  (LOGOFF-LENGTH)
  5202*        ERASE
  5203*        FREEKB
  5204*    END-EXEC.
  5205*    MOVE '8&      T  E F  H   F -   #00004695' TO DFHEIV0
  5206     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5207     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5208     MOVE X'2020233030303034363935' TO DFHEIV0(25:11)
  5209     CALL 'kxdfhei1' USING DFHEIV0,
  5210           LOGOFF-TEXT,
  5211           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 108
* EL633.cbl
  5212           DFHEIV99,
  5213           DFHEIV99,
  5214           DFHEIV99,
  5215           DFHEIV99,
  5216           DFHEIV99,
  5217           DFHEIV99,
  5218           DFHEIV99,
  5219           DFHEIV99,
  5220           DFHEIV99,
  5221           DFHEIV99
  5222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5223
  5224
  5225
  5226* EXEC CICS RETURN
  5227*    END-EXEC.
  5228*    MOVE '.(                    &   #00004702' TO DFHEIV0
  5229     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5230     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5231     MOVE X'2020233030303034373032' TO DFHEIV0(25:11)
  5232     CALL 'kxdfhei1' USING DFHEIV0,
  5233           DFHEIV99,
  5234           DFHEIV99,
  5235           DFHEIV99,
  5236           DFHEIV99,
  5237           DFHEIV99
  5238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5239
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 109
* EL633.cbl
  5241 8400-LOG-JOURNAL-RECORD.
  5242*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5243*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5244
  5245*    EXEC CICS JOURNAL
  5246*        JFILEID  (PI-JOURNAL-FILE-ID)
  5247*        JTYPEID  ('EL')
  5248*        FROM     (JOURNAL-RECORD)
  5249*        LENGTH   (223)
  5250*        END-EXEC.
  5251
  5252 8500-DATE-CONVERT.
  5253
  5254* EXEC CICS LINK
  5255*        PROGRAM   (LINK-CLDATCV)
  5256*        COMMAREA  (DATE-CONVERSION-DATA)
  5257*        LENGTH    (DC-COMM-LENGTH)
  5258*    END-EXEC.
  5259*    MOVE '."C                   ''   #00004717' TO DFHEIV0
  5260     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5261     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5262     MOVE X'2020233030303034373137' TO DFHEIV0(25:11)
  5263     CALL 'kxdfhei1' USING DFHEIV0,
  5264           LINK-CLDATCV,
  5265           DATE-CONVERSION-DATA,
  5266           DC-COMM-LENGTH,
  5267           DFHEIV99,
  5268           DFHEIV99,
  5269           DFHEIV99
  5270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5271
  5272
  5273 8500-EXIT.
  5274     EXIT.
  5275
  5276 8600-DEEDIT.
  5277
  5278* EXEC CICS BIF DEEDIT
  5279*        FIELD   (DEEDIT-FIELD)
  5280*        LENGTH  (11)
  5281*    END-EXEC.
  5282     MOVE 11
  5283       TO DFHEIV11
  5284*    MOVE '@"L                   #   #00004727' TO DFHEIV0
  5285     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5286     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5287     MOVE X'2020233030303034373237' TO DFHEIV0(25:11)
  5288     CALL 'kxdfhei1' USING DFHEIV0,
  5289           DEEDIT-FIELD,
  5290           DFHEIV11
  5291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5292
  5293
  5294 8600-EXIT.
  5295     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 110
* EL633.cbl
  5297 8800-UNAUTHORIZED-ACCESS.
  5298     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5299
  5300     GO TO 8300-SEND-TEXT.
  5301
  5302 8810-PF23.
  5303     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5304     MOVE XCTL-005               TO  PGM-NAME.
  5305
  5306     GO TO 9300-XCTL.
  5307
  5308 9100-RETURN-TRAN.
  5309     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5310     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5311
  5312
  5313* EXEC CICS RETURN
  5314*        TRANSID   (TRANS-ID)
  5315*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5316*        LENGTH    (PI-COMM-LENGTH)
  5317*    END-EXEC.
  5318*    MOVE '.(CT                  &   #00004750' TO DFHEIV0
  5319     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5320     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5321     MOVE X'2020233030303034373530' TO DFHEIV0(25:11)
  5322     CALL 'kxdfhei1' USING DFHEIV0,
  5323           TRANS-ID,
  5324           PROGRAM-INTERFACE-BLOCK,
  5325           PI-COMM-LENGTH,
  5326           DFHEIV99,
  5327           DFHEIV99
  5328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5329
  5330
  5331 9200-RETURN-MAIN-MENU.
  5332     MOVE XCTL-626               TO  PGM-NAME.
  5333
  5334     GO TO 9300-XCTL.
  5335
  5336 9300-XCTL.
  5337
  5338* EXEC CICS XCTL
  5339*        PROGRAM   (PGM-NAME)
  5340*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5341*        LENGTH    (PI-COMM-LENGTH)
  5342*    END-EXEC.
  5343*    MOVE '.$C                   $   #00004762' TO DFHEIV0
  5344     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5345     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5346     MOVE X'2020233030303034373632' TO DFHEIV0(25:11)
  5347     CALL 'kxdfhei1' USING DFHEIV0,
  5348           PGM-NAME,
  5349           PROGRAM-INTERFACE-BLOCK,
  5350           PI-COMM-LENGTH
  5351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5352
  5353
  5354 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 111
* EL633.cbl
  5355     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5356
  5357     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5358     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5359                                     PI-SAV-COMP-CONTROL.
  5360
  5361     GO TO 9300-XCTL.
  5362
  5363 9500-PF12.
  5364     MOVE XCTL-010               TO  PGM-NAME.
  5365
  5366     GO TO 9300-XCTL.
  5367
  5368 9600-PGMID-ERROR.
  5369
  5370* EXEC CICS HANDLE CONDITION
  5371*        PGMIDERR  (8300-SEND-TEXT)
  5372*    END-EXEC.
  5373*    MOVE '"$L                   ! + #00004783' TO DFHEIV0
  5374     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5376     MOVE X'2B20233030303034373833' TO DFHEIV0(25:11)
  5377     CALL 'kxdfhei1' USING DFHEIV0
  5378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5379
  5380
  5381     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5382     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5383     MOVE XCTL-005               TO  PGM-NAME.
  5384     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5385     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5386
  5387     GO TO 9300-XCTL.
  5388
  5389 9900-ERROR-FORMAT.
  5390     IF NOT EMI-ERRORS-COMPLETE
  5391         MOVE LINK-001           TO  PGM-NAME
  5392
  5393* EXEC CICS LINK
  5394*            PROGRAM   (PGM-NAME)
  5395*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5396*            LENGTH    (EMI-COMM-LENGTH)
  5397*        END-EXEC.
  5398*    MOVE '."C                   ''   #00004798' TO DFHEIV0
  5399     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5400     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5401     MOVE X'2020233030303034373938' TO DFHEIV0(25:11)
  5402     CALL 'kxdfhei1' USING DFHEIV0,
  5403           PGM-NAME,
  5404           ERROR-MESSAGE-INTERFACE-BLOCK,
  5405           EMI-COMM-LENGTH,
  5406           DFHEIV99,
  5407           DFHEIV99,
  5408           DFHEIV99
  5409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5410
  5411
  5412 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 112
* EL633.cbl
  5413     EXIT.
  5414
  5415 9990-ABEND.
  5416     MOVE LINK-004               TO  PGM-NAME.
  5417     MOVE DFHEIBLK               TO  EMI-LINE1.
  5418
  5419
  5420* EXEC CICS LINK
  5421*        PROGRAM   (PGM-NAME)
  5422*        COMMAREA  (EMI-LINE1)
  5423*        LENGTH    (72)
  5424*    END-EXEC.
  5425     MOVE 72
  5426       TO DFHEIV11
  5427*    MOVE '."C                   ''   #00004811' TO DFHEIV0
  5428     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5429     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5430     MOVE X'2020233030303034383131' TO DFHEIV0(25:11)
  5431     CALL 'kxdfhei1' USING DFHEIV0,
  5432           PGM-NAME,
  5433           EMI-LINE1,
  5434           DFHEIV11,
  5435           DFHEIV99,
  5436           DFHEIV99,
  5437           DFHEIV99
  5438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5439
  5440
  5441     MOVE -1                     TO  PFENTERL.
  5442
  5443     GO TO 8200-SEND-DATAONLY.
  5444
  5445 9995-SECURITY-VIOLATION.
  5446*                            COPY ELCSCTP.
  5447******************************************************************
  5448*                                                                *
  5449*                            ELCSCTP                             *
  5450*                            VMOD=2.001                          *
  5451*                                                                *
  5452*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5453******************************************************************
  5454
  5455
  5456     MOVE EIBDATE          TO SM-JUL-DATE.
  5457     MOVE EIBTRMID         TO SM-TERMID.
  5458     MOVE THIS-PGM         TO SM-PGM.
  5459     MOVE EIBTIME          TO TIME-IN.
  5460     MOVE TIME-OUT         TO SM-TIME.
  5461     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5462
  5463
  5464* EXEC CICS LINK
  5465*         PROGRAM  ('EL003')
  5466*         COMMAREA (SECURITY-MESSAGE)
  5467*         LENGTH   (80)
  5468*    END-EXEC.
  5469     MOVE 'EL003' TO DFHEIV1
  5470     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 113
* EL633.cbl
  5471       TO DFHEIV11
  5472*    MOVE '."C                   ''   #00004839' TO DFHEIV0
  5473     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5474     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5475     MOVE X'2020233030303034383339' TO DFHEIV0(25:11)
  5476     CALL 'kxdfhei1' USING DFHEIV0,
  5477           DFHEIV1,
  5478           SECURITY-MESSAGE,
  5479           DFHEIV11,
  5480           DFHEIV99,
  5481           DFHEIV99,
  5482           DFHEIV99
  5483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5484
  5485
  5486******************************************************************
  5487
  5488
  5489 9995-EXIT.
  5490     EXIT.
  5491
  5492
  5493 9999-DFHBACK SECTION.
  5494     MOVE '9%                    "   ' TO DFHEIV0
  5495     MOVE 'EL633' TO DFHEIV1
  5496     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5497     GOBACK.
  5498 9999-DFHEXIT.
  5499     IF DFHEIGDJ EQUAL 0001
  5500         NEXT SENTENCE
  5501     ELSE IF DFHEIGDJ EQUAL 2
  5502         GO TO 9600-PGMID-ERROR,
  5503               9990-ABEND
  5504         DEPENDING ON DFHEIGDI
  5505     ELSE IF DFHEIGDJ EQUAL 3
  5506         GO TO 0410-NO-COMP-MSTR,
  5507               7100-COMP-FILE-NOTOPEN
  5508         DEPENDING ON DFHEIGDI
  5509     ELSE IF DFHEIGDJ EQUAL 4
  5510         GO TO 0890-EXIT
  5511         DEPENDING ON DFHEIGDI
  5512     ELSE IF DFHEIGDJ EQUAL 5
  5513         GO TO 2110-ADD-RECORD
  5514         DEPENDING ON DFHEIGDI
  5515     ELSE IF DFHEIGDJ EQUAL 6
  5516         GO TO 2120-DELETE-CONT
  5517         DEPENDING ON DFHEIGDI
  5518     ELSE IF DFHEIGDJ EQUAL 7
  5519         GO TO 2190-DUP-RECORD
  5520         DEPENDING ON DFHEIGDI
  5521     ELSE IF DFHEIGDJ EQUAL 8
  5522         GO TO 5010-NOT-OPEN,
  5523               5020-NO-RECORDS,
  5524               5020-NO-RECORDS
  5525         DEPENDING ON DFHEIGDI
  5526     ELSE IF DFHEIGDJ EQUAL 9
  5527         GO TO 5110-END-OF-FILE,
  5528               5110-END-OF-FILE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 114
* EL633.cbl
  5529         DEPENDING ON DFHEIGDI
  5530     ELSE IF DFHEIGDJ EQUAL 10
  5531         GO TO 6100-END-OF-FILE,
  5532               6100-END-OF-FILE
  5533         DEPENDING ON DFHEIGDI
  5534     ELSE IF DFHEIGDJ EQUAL 11
  5535         GO TO 8300-SEND-TEXT
  5536         DEPENDING ON DFHEIGDI.
  5537     MOVE '9%                    "   ' TO DFHEIV0
  5538     MOVE 'EL633' TO DFHEIV1
  5539     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5540     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        5632     Code:       17539
