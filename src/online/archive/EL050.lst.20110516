* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page   1
* EL050.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL050.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page   2
* EL050.cbl
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37******************************************************************
    38 ENVIRONMENT DIVISION.
    39
    40 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page   3
* EL050.cbl
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44
    45 77  FILLER   PIC X(32) VALUE '********************************'.
    46 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    47 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    48
    49 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    50 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    51                                   USAGE POINTER.
    52 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    53 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    54 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    55                                   USAGE IS POINTER.
    56 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    57 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    58                                   USAGE IS POINTER.
    59 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    60 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    61                                   USAGE IS POINTER.
    62
    63 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    64 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    65                                   USAGE IS POINTER.
    66
    67*    COPY ELC50WS.
    68*****************************************************************
    69*                                                               *
    70*                            ELC50WS.                           *
    71*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    72*                            VMOD=2.061.                        *
    73*                                                               *
    74*   THIS IS THE WORKING STORAGE FOR EL050                       *
    75*                                   EL517                       *
    76*****************************************************************
    77******************************************************************
    78*                   C H A N G E   L O G
    79*
    80* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    81*-----------------------------------------------------------------
    82*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    83* EFFECTIVE    NUMBER
    84*-----------------------------------------------------------------
    85* 123102                   PEMA  ADD DCC PROCESSING
    86* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    87* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    88* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    89* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    90* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    91* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    92* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    93* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
    94* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
    95* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    96* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
    97* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    98* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    99* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page   4
* EL050.cbl
   100* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   101* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   102* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   103* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   104* 030309  CR2009021700001  PEMA  ADD ER-2883
   105* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   106* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   107* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   108* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   109* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   110* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   111* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   112* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   113*-----------------------------------------------------------------
   114
   115 01  WORK-AREAS.
   116
   117*****************************************************************
   118*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   119*****************************************************************
   120
   121     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   122     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   123     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   124     12  WS-NAME-EDIT-WORK-AREA.
   125         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   126         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   127             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   128         16  WS-WORK-NAME.
   129             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   130             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   131             20  FILLER           PIC X(10)     VALUE SPACES.
   132         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   133             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   134
   135*****************************************************************
   136*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   137*****************************************************************
   138
   139     12  WS-ERRESC-KEY.
   140         16 WS-ERRESC-SEARCH-KEY.
   141             20  WS-ERRESC-COMPANY-CD PIC  X.
   142             20  WS-ERRESC-CARRIER    PIC  X.
   143             20  WS-ERRESC-GROUP      PIC X(6).
   144             20  WS-ERRESC-STATE      PIC XX.
   145             20  WS-ERRESC-ACCOUNT    PIC X(10).
   146         16 WS-ERRESC-RESIDUAL-KEY.
   147             20  WS-ERRESC-AGENT      PIC X(10).
   148             20  WS-ERRESC-RES-STATE  PIC XX.
   149             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   150*                                          YYYYMMDD
   151     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   152     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   153
   154*RESIDENT STATE TAX MASTER(ERRESS)
   155*
   156     12  WS-ERRESS-KEY.
   157         16  WS-ERRESS-COMPANY-CD      PIC  X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page   5
* EL050.cbl
   158         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   159         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   160         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   161*                                          YYYYMMDD
   162
   163     12  WS-CONTRACT-DATE              PIC 9(8).
   164*                                          YYYYMMDD
   165     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   166     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   167         16 WS-YEAR-YY                 PIC   9999.
   168         16 FILLER                     PIC 9(4).
   169*                                          YYYYMMDD
   170     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   171     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   172     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   173     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   174
   175     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   176         88  DPRB-1ST-TIME                      VALUE ' '.
   177
   178*****************************************************************
   179*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   180*****************************************************************
   181
   182     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   183     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   184     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   185     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   186     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   187     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   188     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   189     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   190     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   191     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   192         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   193         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   194     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   195         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   196         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   197     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   198
   199     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   200     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   201
   202     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   203     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   204     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   205     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   206     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   207     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   208     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   209     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   210     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   211     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   212     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   213     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   214     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   215     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page   6
* EL050.cbl
   216     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   217     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   218     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   219     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   220     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   225     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   226     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   227     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   228     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   233     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   234     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   235     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   236     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   238     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   239     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   240     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   241     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   242     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   243     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   244     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   245     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   246     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   247     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   248     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   249     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   250     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   251     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   252     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   253     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   254     12  WS-2671-SW               PIC X         VALUE SPACE.
   255     12  WS-2672-SW               PIC X         VALUE SPACE.
   256     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   257         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   258     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   259         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   260     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   261
   262     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   263         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   264         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   265         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   266         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   267
   268     12  WS-CREDIT-EDIT-CONTROLS.
   269         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   270         16  WS-MIN-AGE           PIC 99                VALUE  0.
   271         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   272         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   273         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page   7
* EL050.cbl
   274         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   275
   276     12  WS-SAVE-ALLOWABLE-BENEFIT.
   277         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   278         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   279         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   280         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   281         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   282         16  FILLER                      PIC XX.
   283
   284     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   285     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   286     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   287     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   288     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   289     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   290     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   291     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   292     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   293     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   294
   295     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   296     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   297     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   298     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   299     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   300     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   301     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   302     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   303         88  WS-REDUCING              VALUE 'R'.
   304         88  WS-LEVEL                 VALUE 'L' 'P'.
   305     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   306
   307     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   308     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   309     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   310     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   311     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   312     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   313     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   314     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   315
   316     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   317     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   318     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   319     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   320     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   321     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   322     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   323     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   324     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   325     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   326     12  WS-ACCT-SIG-SW.
   327         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   328         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   329     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   330     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   331     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page   8
* EL050.cbl
   332     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   333     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   334     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   335     12  WS-INITIALS.
   336         16  WS-INIT-1            PIC X         VALUE SPACES.
   337         16  WS-INIT-2            PIC X         VALUE SPACES.
   338
   339     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   340     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   341     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   342     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   343     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   344*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   345     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   346     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   347     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   348     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   349     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   350     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   351     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   352     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   353     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   354     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   355     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   356     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   357     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   358     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   359     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   360     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   361     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   362     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   363     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   364     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   365     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   366     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   367******** FLA
   368     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   369     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   370     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   371     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   372     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   373********
   374     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   375     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   376     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   377     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   378     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   379     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   380     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   381     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   382     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   383     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   384
   385     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   386         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   387                                         '0' THRU '9'.
   388
   389     12  NUMBER-OF-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page   9
* EL050.cbl
   390         16  SK-MO OCCURS 12 TIMES PIC X.
   391
   392     12  WS-WORK-DATE.
   393         16  WS-YEAR            PIC 99    VALUE 00.
   394         16  WS-MONTH           PIC 99    VALUE 00.
   395         16  WS-DAY             PIC 99    VALUE 00.
   396
   397     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   398     12  WS-WORK-CRIT-DEV       REDEFINES
   399         WS-WORK-LF-CRIT-PER    PIC X(03).
   400
   401     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   402     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   403
   404     12  WS-WORK-DATE-FROM.
   405         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   406         16  FILLER             PIC X  VALUE SPACE.
   407         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   408         16  FILLER             PIC X         VALUE SPACE.
   409         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   410
   411     12  WS-WORK-DATE-THRU.
   412         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   413         16  FILLER             PIC X         VALUE SPACE.
   414         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   415         16  FILLER             PIC X         VALUE SPACE.
   416         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   417
   418     12  WS-LF-INPUT-CD.
   419         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   420         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   421
   422     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   423     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   424         16  WS-AH-INPUT-CD-1   PIC X.
   425         16  WS-AH-INPUT-CD-2-3 PIC XX.
   426
   427     12  WS-SWITCHES.
   428         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   429         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   430             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   431         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   432             88  BANK-ACCT-FOUND          VALUE 'Y'.
   433         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   434             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   435         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   436             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   437         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   438             88  COMP-MASTER-FOUND        VALUE 'Y'.
   439         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   440             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   441         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   442             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   443         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   444             88  STAT-MASTER-FOUND        VALUE 'Y'.
   445         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   446             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   447         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  10
* EL050.cbl
   448             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   449         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   450             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   451         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   452             88  FORM-MASTER-FOUND        VALUE 'Y'.
   453         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   454             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   455         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   456             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   457         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   458             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   459         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   460             88  NO-BENEFIT-FOUND         VALUE 'N'.
   461         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   462             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   463         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   464             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   465         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   466             88  AH-BENEFIT-FOUND         VALUE ' '.
   467             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   468         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   469             88  LF-BENEFIT-FOUND         VALUE ' '.
   470             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   471         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   472             88  NO-STATE-RECORD          VALUE '1'.
   473         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   474             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   475         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   476             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   477         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   478             88  CERT-WAS-FOUND           VALUE ' '.
   479             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   480         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   481             88  BROWSE-STARTED           VALUE 'Y'.
   482         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   483             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   484         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   485             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   486         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   487             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   488         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   489             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   490         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   491             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   492         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   493             88  APP-CERT-USED            VALUE 'Y' 'A'.
   494         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   495             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   496             88  FIRST-TIME-THROUGH       VALUE '1'.
   497             88  CTBL-NOT-FOUND           VALUE '2'.
   498
   499         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   500             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   501
   502         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   503             88  DLO-ERROR-FOUND          VALUE 'Y'.
   504
   505********FLA
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  11
* EL050.cbl
   506     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   507     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   508********
   509     12  RC-SW-1                  PIC X           VALUE '0'.
   510     12  RC-SW-2                  PIC X           VALUE '0'.
   511     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   512     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   513     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   514     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   515     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   516     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   517     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   518     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   519     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   520     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   521     12  LIT-SPACES               PIC X           VALUE SPACES.
   522     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   523     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   524     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   525     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   526     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   527     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   528     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   529         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   530         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   531     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   532         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   533
   534 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   535     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   536     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   537 01  WS-CRI-SSN-WORK-AREA.
   538     05  WS-CRI-SOC-SEC-NO.
   539         10  WS-SS-REPT-CD       PIC X(5).
   540         10  WS-SS-LAST-NAME     PIC X(5).
   541         10  WS-SS-INITIAL       PIC X.
   542
   543     05  WS-CRI-REPORT-CODE.
   544         10  FILLER              PIC X(5).
   545         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   546
   547     05  WS-CRI-LAST-NAME.
   548         10  WS-CRI-NAME-MOVE    PIC X(5).
   549         10  FILLER              PIC X(10).
   550
   551 01  WS-NUM-TABLE                PIC X(26)  VALUE
   552     '12345678012345070923456789'.
   553 01  FILLER REDEFINES WS-NUM-TABLE.
   554     05  WS-NUM OCCURS 26        PIC 9.
   555 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   556 01  V1                          PIC S999 COMP-3.
   557 01  V2                          PIC S999 COMP-3.
   558 01  V3                          PIC S999 COMP-3.
   559 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   560 01  FILLER REDEFINES WS-WORK-VIN.
   561     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   562 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   563 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  12
* EL050.cbl
   564 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   565 01  WS-HEX-WORK.
   566     05  FILLER                  PIC X  VALUE LOW-VALUES.
   567     05  WS-HEX-BYTE             PIC X.
   568 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   569 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   570 01  WS-WORK-HIN-ROW-B.
   571     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   572
   573 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   574 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   575     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   576 01  WS-ROW-D-TABLE.
   577     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   578
   579 01  WS-HIN-TABLE-B.
   580     05  F                       PIC XX VALUE 'A2'.
   581     05  F                       PIC XX VALUE 'B3'.
   582     05  F                       PIC XX VALUE 'C4'.
   583     05  F                       PIC XX VALUE 'D5'.
   584     05  F                       PIC XX VALUE 'E6'.
   585     05  F                       PIC XX VALUE 'F7'.
   586     05  F                       PIC XX VALUE 'G8'.
   587     05  F                       PIC XX VALUE 'H9'.
   588     05  F                       PIC XX VALUE 'I1'.
   589     05  F                       PIC XX VALUE 'J2'.
   590     05  F                       PIC XX VALUE 'K3'.
   591     05  F                       PIC XX VALUE 'L4'.
   592     05  F                       PIC XX VALUE 'M5'.
   593     05  F                       PIC XX VALUE 'N6'.
   594     05  F                       PIC XX VALUE 'O0'.
   595     05  F                       PIC XX VALUE 'P7'.
   596     05  F                       PIC XX VALUE 'Q0'.
   597     05  F                       PIC XX VALUE 'R8'.
   598     05  F                       PIC XX VALUE 'S9'.
   599     05  F                       PIC XX VALUE 'T2'.
   600     05  F                       PIC XX VALUE 'U3'.
   601     05  F                       PIC XX VALUE 'V4'.
   602     05  F                       PIC XX VALUE 'W5'.
   603     05  F                       PIC XX VALUE 'X6'.
   604     05  F                       PIC XX VALUE 'Y7'.
   605     05  F                       PIC XX VALUE 'Z8'.
   606 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   607     05  WS-VAL-IN               PIC X.
   608     05  WS-VAL-OUT              PIC 9.
   609 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   610 01  WS-COMPARE-BINARY-DATES.
   611     05  WS-971231                PIC XX VALUE X'92FF'.
   612     05  WS-931231                PIC XX VALUE X'8CFF'.
   613     05  WS-791231                PIC XX VALUE X'77FF'.
   614     05  WS-771001                PIC XX VALUE X'74A1'.
   615     05  WS-820301                PIC XX VALUE X'7B41'.
   616     05  WS-831031                PIC XX VALUE X'7DBF'.
   617     05  WS-831231                PIC XX VALUE X'7DFF'.
   618     05  WS-810831                PIC XX VALUE X'7A7F'.
   619     05  WS-830901                PIC XX VALUE X'7D81'.
   620
   621 01  FILE-ACCESS-IDS.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  13
* EL050.cbl
   622     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   623     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   624     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   625     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   626     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   627     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   628     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   629     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   630     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   631     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   632     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   633     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   634     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   635     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   636     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   637     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   638     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   639 01  DD-IU-SW                    PIC X   VALUE ' '.
   640     88  DD-IU-PRESENT                 VALUE 'Y'.
   641
   642 01  ACCESS-KEYS.
   643     12  ELMSTR-KEY.
   644         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   645         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   646     12  W-CLAIM-KEY.
   647         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   648         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   649
   650     12  ELCNTL-KEY.
   651         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   652         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   653         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   654         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   655
   656     12  ELCERT-KEY.
   657         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   658         16  CERT-CARRIER         PIC X       VALUE SPACE.
   659         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   660         16  CERT-STATE           PIC XX      VALUE SPACES.
   661         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   662         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   663         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   664
   665     12  ELCERT2-KEY.
   666         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   667         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   668
   669     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   670
   671     12  ELCERT-SAVE.
   672         16  FILLER                      PIC XX    VALUE SPACES.
   673
   674         16  WCS-CONTROL-PRIMARY.
   675             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   676             20  WCS-CARRIER             PIC X     VALUE SPACE.
   677             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   678             20  WCS-STATE               PIC XX    VALUE SPACES.
   679             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  14
* EL050.cbl
   680             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   681             20  WCS-CERT-NO.
   682                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   683                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   684
   685         16  CS-CONTROL-BY-NAME.
   686             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   687             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   688             20  CS-INSURED-INITIALS.
   689                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   690                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   691
   692         16  CS-CONTROL-BY-SSN.
   693             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   694             20  CS-SOC-SEC-NO.
   695                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   696                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   697                 24  CS-SSN-LN3.
   698                     28 CS-INSURED-INITIALS-A2   PIC XX
   699                                     VALUE SPACES.
   700                     28 CS-PART-LAST-NAME-A2     PIC X
   701                                     VALUE SPACE.
   702
   703         16  CS-CONTROL-BY-CERT-NO.
   704             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   705             20  CS-CERT-NO-A4           PIC X(11)
   706                                     VALUE SPACES.
   707
   708         16  CS-CONTROL-BY-MEMB.
   709             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   710             20  CS-MEMBER-NO.
   711                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   712                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   713                 24  CS-MEMB-LN4.
   714                     28 CS-INSURED-INITIALS-A5   PIC XX
   715                                      VALUE SPACES.
   716                     28 CS-PART-LAST-NAME-A5     PIC XX
   717                                      VALUE SPACES.
   718
   719         16  FILLER              PIC X(360) VALUE SPACES.
   720
   721     12  ERACCT-KEY.
   722         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   723         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   724         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   725         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   726         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   727         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   728
   729     12  ERCOMP-KEY.
   730         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   731         16  COMP-CARRIER         PIC X     VALUE SPACES.
   732         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   733         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   734         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   735         16  COMP-TYPE            PIC X     VALUE SPACES.
   736
   737     12  ERLOFC-KEY.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  15
* EL050.cbl
   738         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   739         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   740         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   741         16  LOFC-STATE           PIC XX    VALUE SPACES.
   742         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   743         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   744
   745     12  WS-ELCRTT-KEY.
   746         16  WS-ELCRTT-PRIMARY       PIC X(33).
   747         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   748
   749     12  ERBXRF-KEY.
   750         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   751         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   752         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   753         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   754
   755     12  ERAGTC-KEY.
   756         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   757         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   758         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   759         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   760         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   761         16  AGTC-TYPE            PIC X     VALUE SPACES.
   762
   763     12  ERPLAN-KEY.
   764         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   765         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   766         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   767         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   768         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   769         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   770         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   771         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   772
   773     12  ERFORM-KEY.
   774         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   775         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   776         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   777         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   778
   779     12  ERREIN-KEY.
   780         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   781         16  REIN-TYPE            PIC X     VALUE SPACES.
   782         16  REIN-TABLE-CO.
   783             20  REIN-CODE-1      PIC X     VALUE SPACE.
   784             20  REIN-CODE-2      PIC X     VALUE SPACE.
   785             20  REIN-CODE-3      PIC X     VALUE SPACE.
   786         16  FILLER               PIC X(3)  VALUE SPACES.
   787
   788     12  ERCTBL-KEY.
   789         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   790         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   791         16  CTBL-CNTRL-2.
   792             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   793             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   794
   795     12  WS-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  16
* EL050.cbl
   796         16  FILLER               PIC XX    VALUE SPACES.
   797         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   798
   799     12  WS-CARR-ACCESS.
   800         16  FILLER               PIC X(3)  VALUE SPACES.
   801         16  WS-CARR              PIC X     VALUE SPACE.
   802*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   803*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   804     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   805         88  WS-DMD-LF-RATING   VALUE 'Y'.
   806         88  WS-DMD-AH-RATING   VALUE 'Y'.
   807         88  WS-DMD-NO-RATING   VALUE 'N'.
   808
   809     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   810         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   811                                         'NJ' 'NL'
   812                                         'SJ' 'SL'.
   813     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   814         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   815                                         'NI' 'NJ' 'NL' 'NU'
   816                                         'SI' 'SJ' 'SL' 'SU'
   817                                         'MX' 'MY' 'MZ'.
   818 01  ERPDEF-KEY-SAVE             PIC X(18).
   819 01  ERPDEF-KEY.
   820     12  ERPDEF-COMPANY-CD       PIC X.
   821     12  ERPDEF-STATE            PIC XX.
   822     12  ERPDEF-PROD-CD          PIC XXX.
   823     12  F                       PIC X(7).
   824     12  ERPDEF-BEN-TYPE         PIC X.
   825     12  ERPDEF-BEN-CODE         PIC XX.
   826     12  ERPDEF-EXP-DT           PIC XX.
   827
   828 01  ELSTAT-KEY-SAVE             PIC X(20).
   829 01  ELSTAT-KEY.
   830     12  ELSTAT-COMPANY-ID       PIC XXX.
   831     12  ELSTAT-CARRIER          PIC X.
   832     12  ELSTAT-GROUP            PIC X(6).
   833     12  ELSTAT-STATE            PIC XX.
   834     12  ELSTAT-EXP-DT           PIC 9(8).
   835 01  WS-ERROR-VALUES.
   836     12  ER-1570                     PIC S9(4)   VALUE +1570.
   837     12  ER-1571                     PIC S9(4)   VALUE +1571.
   838     12  ER-1575                     PIC S9(4)   VALUE +1575.
   839     12  ER-1891                     PIC S9(4)   VALUE +1891.
   840     12  ER-1892                     PIC S9(4)   VALUE +1892.
   841     12  ER-1893                     PIC S9(4)   VALUE +1893.
   842     12  ER-1894                     PIC S9(4)   VALUE +1894.
   843     12  ER-1895                     PIC S9(4)   VALUE +1895.
   844     12  ER-1896                     PIC S9(4)   VALUE +1896.
   845     12  ER-1897                     PIC S9(4)   VALUE +1897.
   846     12  ER-1898                     PIC S9(4)   VALUE +1898.
   847     12  ER-1899                     PIC S9(4)   VALUE +1899.
   848     12  ER-1900                     PIC S9(4)   VALUE +1900.
   849     12  ER-1901                     PIC S9(4)   VALUE +1901.
   850     12  ER-1902                     PIC S9(4)   VALUE +1902.
   851     12  ER-1903                     PIC S9(4)   VALUE +1903.
   852     12  ER-1904                     PIC S9(4)   VALUE +1904.
   853     12  ER-1905                     PIC S9(4)   VALUE +1905.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  17
* EL050.cbl
   854     12  ER-1906                     PIC S9(4)   VALUE +1906.
   855     12  ER-1907                     PIC S9(4)   VALUE +1907.
   856     12  ER-1909                     PIC S9(4)   VALUE +1909.
   857     12  ER-1910                     PIC S9(4)   VALUE +1910.
   858     12  ER-1911                     PIC S9(4)   VALUE +1911.
   859     12  ER-1912                     PIC S9(4)   VALUE +1912.
   860     12  ER-1913                     PIC S9(4)   VALUE +1913.
   861     12  ER-1914                     PIC S9(4)   VALUE +1914.
   862     12  ER-1915                     PIC S9(4)   VALUE +1915.
   863     12  ER-1916                     PIC S9(4)   VALUE +1916.
   864     12  ER-1917                     PIC S9(4)   VALUE +1917.
   865     12  ER-1918                     PIC S9(4)   VALUE +1918.
   866     12  ER-1919                     PIC S9(4)   VALUE +1919.
   867     12  ER-1920                     PIC S9(4)   VALUE +1920.
   868     12  ER-1921                     PIC S9(4)   VALUE +1921.
   869     12  ER-1922                     PIC S9(4)   VALUE +1922.
   870     12  ER-1923                     PIC S9(4)   VALUE +1923.
   871     12  ER-1924                     PIC S9(4)   VALUE +1924.
   872     12  ER-1925                     PIC S9(4)   VALUE +1925.
   873     12  ER-1926                     PIC S9(4)   VALUE +1926.
   874     12  ER-1927                     PIC S9(4)   VALUE +1927.
   875     12  ER-2393                     PIC S9(4)   VALUE +2393.
   876     12  ER-2600                     PIC S9(4)   VALUE +2600.
   877     12  ER-2601                     PIC S9(4)   VALUE +2601.
   878     12  ER-2602                     PIC S9(4)   VALUE +2602.
   879     12  ER-2603                     PIC S9(4)   VALUE +2603.
   880     12  ER-2604                     PIC S9(4)   VALUE +2604.
   881     12  ER-2605                     PIC S9(4)   VALUE +2605.
   882     12  ER-2606                     PIC S9(4)   VALUE +2606.
   883     12  ER-2607                     PIC S9(4)   VALUE +2607.
   884     12  ER-2608                     PIC S9(4)   VALUE +2608.
   885     12  ER-2609                     PIC S9(4)   VALUE +2609.
   886     12  ER-2610                     PIC S9(4)   VALUE +2610.
   887     12  ER-2611                     PIC S9(4)   VALUE +2611.
   888     12  ER-2612                     PIC S9(4)   VALUE +2612.
   889     12  ER-2613                     PIC S9(4)   VALUE +2613.
   890     12  ER-2614                     PIC S9(4)   VALUE +2614.
   891     12  ER-2615                     PIC S9(4)   VALUE +2615.
   892     12  ER-2616                     PIC S9(4)   VALUE +2616.
   893     12  ER-2617                     PIC S9(4)   VALUE +2617.
   894     12  ER-2618                     PIC S9(4)   VALUE +2618.
   895     12  ER-2619                     PIC S9(4)   VALUE +2619.
   896     12  ER-2620                     PIC S9(4)   VALUE +2620.
   897     12  ER-2621                     PIC S9(4)   VALUE +2621.
   898     12  ER-2622                     PIC S9(4)   VALUE +2622.
   899     12  ER-2623                     PIC S9(4)   VALUE +2623.
   900     12  ER-2624                     PIC S9(4)   VALUE +2624.
   901     12  ER-2625                     PIC S9(4)   VALUE +2625.
   902     12  ER-2626                     PIC S9(4)   VALUE +2626.
   903     12  ER-2627                     PIC S9(4)   VALUE +2627.
   904     12  ER-2628                     PIC S9(4)   VALUE +2628.
   905     12  ER-2629                     PIC S9(4)   VALUE +2629.
   906     12  ER-2630                     PIC S9(4)   VALUE +2630.
   907     12  ER-2631                     PIC S9(4)   VALUE +2631.
   908     12  ER-2632                     PIC S9(4)   VALUE +2632.
   909     12  ER-2633                     PIC S9(4)   VALUE +2633.
   910     12  ER-2634                     PIC S9(4)   VALUE +2634.
   911     12  ER-2635                     PIC S9(4)   VALUE +2635.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  18
* EL050.cbl
   912     12  ER-2636                     PIC S9(4)   VALUE +2636.
   913     12  ER-2637                     PIC S9(4)   VALUE +2637.
   914     12  ER-2638                     PIC S9(4)   VALUE +2638.
   915     12  ER-2639                     PIC S9(4)   VALUE +2639.
   916     12  ER-2640                     PIC S9(4)   VALUE +2640.
   917     12  ER-2641                     PIC S9(4)   VALUE +2641.
   918     12  ER-2642                     PIC S9(4)   VALUE +2642.
   919     12  ER-2643                     PIC S9(4)   VALUE +2643.
   920     12  ER-2644                     PIC S9(4)   VALUE +2644.
   921     12  ER-2645                     PIC S9(4)   VALUE +2645.
   922     12  ER-2646                     PIC S9(4)   VALUE +2646.
   923     12  ER-2647                     PIC S9(4)   VALUE +2647.
   924     12  ER-2648                     PIC S9(4)   VALUE +2648.
   925     12  ER-2649                     PIC S9(4)   VALUE +2649.
   926     12  ER-2650                     PIC S9(4)   VALUE +2650.
   927     12  ER-2651                     PIC S9(4)   VALUE +2651.
   928     12  ER-2652                     PIC S9(4)   VALUE +2652.
   929     12  ER-2653                     PIC S9(4)   VALUE +2653.
   930     12  ER-2654                     PIC S9(4)   VALUE +2654.
   931     12  ER-2655                     PIC S9(4)   VALUE +2655.
   932     12  ER-2656                     PIC S9(4)   VALUE +2656.
   933     12  ER-2657                     PIC S9(4)   VALUE +2657.
   934     12  ER-2658                     PIC S9(4)   VALUE +2658.
   935     12  ER-2659                     PIC S9(4)   VALUE +2659.
   936     12  ER-2660                     PIC S9(4)   VALUE +2660.
   937     12  ER-2661                     PIC S9(4)   VALUE +2661.
   938     12  ER-2662                     PIC S9(4)   VALUE +2662.
   939     12  ER-2663                     PIC S9(4)   VALUE +2663.
   940     12  ER-2664                     PIC S9(4)   VALUE +2664.
   941     12  ER-2665                     PIC S9(4)   VALUE +2665.
   942     12  ER-2666                     PIC S9(4)   VALUE +2666.
   943     12  ER-2667                     PIC S9(4)   VALUE +2667.
   944     12  ER-2668                     PIC S9(4)   VALUE +2668.
   945     12  ER-2669                     PIC S9(4)   VALUE +2669.
   946     12  ER-2670                     PIC S9(4)   VALUE +2670.
   947     12  ER-2671                     PIC S9(4)   VALUE +2671.
   948     12  ER-2672                     PIC S9(4)   VALUE +2672.
   949     12  ER-2673                     PIC S9(4)   VALUE +2673.
   950     12  ER-2674                     PIC S9(4)   VALUE +2674.
   951     12  ER-2675                     PIC S9(4)   VALUE +2675.
   952     12  ER-2676                     PIC S9(4)   VALUE +2676.
   953     12  ER-2677                     PIC S9(4)   VALUE +2677.
   954     12  ER-2678                     PIC S9(4)   VALUE +2678.
   955     12  ER-2679                     PIC S9(4)   VALUE +2679.
   956     12  ER-2680                     PIC S9(4)   VALUE +2680.
   957     12  ER-2681                     PIC S9(4)   VALUE +2681.
   958     12  ER-2682                     PIC S9(4)   VALUE +2682.
   959     12  ER-2683                     PIC S9(4)   VALUE +2683.
   960     12  ER-2684                     PIC S9(4)   VALUE +2684.
   961     12  ER-2685                     PIC S9(4)   VALUE +2685.
   962     12  ER-2686                     PIC S9(4)   VALUE +2686.
   963     12  ER-2687                     PIC S9(4)   VALUE +2687.
   964     12  ER-2688                     PIC S9(4)   VALUE +2688.
   965     12  ER-2689                     PIC S9(4)   VALUE +2689.
   966     12  ER-2690                     PIC S9(4)   VALUE +2690.
   967     12  ER-2691                     PIC S9(4)   VALUE +2691.
   968     12  ER-2692                     PIC S9(4)   VALUE +2692.
   969     12  ER-2693                     PIC S9(4)   VALUE +2693.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  19
* EL050.cbl
   970     12  ER-2694                     PIC S9(4)   VALUE +2694.
   971     12  ER-2695                     PIC S9(4)   VALUE +2695.
   972     12  ER-2696                     PIC S9(4)   VALUE +2696.
   973     12  ER-2697                     PIC S9(4)   VALUE +2697.
   974     12  ER-2698                     PIC S9(4)   VALUE +2698.
   975     12  ER-2699                     PIC S9(4)   VALUE +2699.
   976     12  ER-2700                     PIC S9(4)   VALUE +2700.
   977     12  ER-2701                     PIC S9(4)   VALUE +2701.
   978     12  ER-2702                     PIC S9(4)   VALUE +2702.
   979     12  ER-2703                     PIC S9(4)   VALUE +2703.
   980     12  ER-2704                     PIC S9(4)   VALUE +2704.
   981     12  ER-2707                     PIC S9(4)   VALUE +2707.
   982     12  ER-2720                     PIC S9(4)   VALUE +2720.
   983     12  ER-2709                     PIC S9(4)   VALUE +2709.
   984     12  ER-2717                     PIC S9(4)   VALUE +2717.
   985     12  ER-2718                     PIC S9(4)   VALUE +2718.
   986     12  ER-2719                     PIC S9(4)   VALUE +2719.
   987     12  ER-2721                     PIC S9(4)   VALUE +2721.
   988     12  ER-2722                     PIC S9(4)   VALUE +2722.
   989     12  ER-2723                     PIC S9(4)   VALUE +2723.
   990     12  ER-2724                     PIC S9(4)   VALUE +2724.
   991     12  ER-2725                     PIC S9(4)   VALUE +2725.
   992     12  ER-2726                     PIC S9(4)   VALUE +2726.
   993     12  ER-2727                     PIC S9(4)   VALUE +2727.
   994     12  ER-2728                     PIC S9(4)   VALUE +2728.
   995     12  ER-2729                     PIC S9(4)   VALUE +2729.
   996     12  ER-2730                     PIC S9(4)   VALUE +2730.
   997     12  ER-2731                     PIC S9(4)   VALUE +2731.
   998     12  ER-2732                     PIC S9(4)   VALUE +2732.
   999     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1000     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1001     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1002     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1003     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1004     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1005     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1006     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1007     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1008     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1009     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1010     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1011     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1012     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1013     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1014     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1015     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1016     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1017     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1018     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1019     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1020     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1021     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1022     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1023     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1024     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1025     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1026     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1027     12  ER-2761                     PIC S9(4)   VALUE +2761.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  20
* EL050.cbl
  1028     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1029     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1030     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1031     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1032     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1033     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1034     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1035     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1036     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1037     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1038     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1039     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1040     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1041     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1042     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1043     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1044     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1045     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1046     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1047     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1048     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1049     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1050     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1051     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1052     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1053     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1054     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1055     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1056     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1057     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1058     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1059     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1060     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1061     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1062     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1063     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1064     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1065     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1066     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1067     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1068     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1069     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1070     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1071     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1072     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1073     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1074     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1075     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1076     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1077     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1078     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1079     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1080     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1081     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1082     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1083     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1084     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1085     12  ER-3782                     PIC S9(4)   VALUE +3782.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  21
* EL050.cbl
  1086     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1087     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1088     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1089     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1090     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1091     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1092     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1093     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1094     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1095     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1096     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1097     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1098     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1099     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1100     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1101     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1102     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1103     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1104     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1105     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1106     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1107     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1108     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1109     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1110     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1111     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1112     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1113     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1114     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1115     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1116     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1117     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1118     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1119     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1120     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1121     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1122     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1123     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1124     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1125     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1126     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1127     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1128     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1129     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1130     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1131     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1132     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1133     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1134     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1135     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1136     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1137     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1138     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1139     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1140     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1141     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1142     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1143     12  ER-8095                     PIC S9(4)   VALUE +8095.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  22
* EL050.cbl
  1144     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1145     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1146     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1147     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1148     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1149     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1150     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1151     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1152     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1153     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1154     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1155     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1156     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1157     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1158     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1159     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1160     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1161     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1162     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1163     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1164     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1165     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1166     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1167     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1168     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1169     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1170     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1171     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1172     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1173     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1174******************************************************************
  1175***************   END OF ELC50WS     ****************************
  1176******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  23
* EL050.cbl
  1179 01  WORKING-STORAGE-WORK-AREAS.
  1180     12  WS-RESPONSE             PIC S9(8)  COMP.
  1181         88  WS-RESP-NORMAL           VALUE +00.
  1182         88  WS-RESP-ERROR            VALUE +01.
  1183         88  WS-RESP-NOTFND           VALUE +13.
  1184         88  WS-RESP-DUPREC           VALUE +14.
  1185         88  WS-RESP-ENDFILE          VALUE +20.
  1186     12  WORK-AREAS.
  1187         16  WK-CONV-GREG.
  1188             24  WCG-CENT             PIC XX.
  1189             24  WCG-REST             PIC X(4).
  1190         16  WORK-GREGORIAN-DATE.
  1191             24  WK-GREG-CENT         PIC XX.
  1192             24  WK-GREG-DATE-YYMMDD.
  1193                 28  WK-GREG-YYMM     PIC X(4).
  1194                 28  WK-GREG-DD       PIC XX.
  1195
  1196         16  WORK-SELECT-DATE.
  1197             24  WK-SELECT-CENT            PIC XX.
  1198             24  WK-SELECT-DATE-YYMMDD.
  1199                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1200                 28  FILLER                PIC XX.
  1201
  1202         16  WK-FORM-NO.
  1203             24  WK-FORM-BANK-ID       PIC X(5).
  1204             24  WK-FORM-UNDRWRTR      PIC X(1).
  1205             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1206
  1207         16  WK-MEMBER-NO.
  1208             24  WK-MEMBER-1-6        PIC X(6).
  1209             24  WK-MEMBER-7-12       PIC X(6).
  1210
  1211         16  WK-FULL-CERT-NO.
  1212             24  WK-CERT-POS-1-2      PIC X(2).
  1213             24  WK-CERT-POS-3        PIC X(1).
  1214             24  WK-CERT-POS-4        PIC X(1).
  1215             24  WK-CERT-POS-5-6      PIC X(2).
  1216             24  WK-CERT-POS-7        PIC X(1).
  1217             24  WK-CERT-POS-8-11     PIC X(4).
  1218
  1219         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1220             88  VALID-RATE-CODE        VALUE 'Y'.
  1221             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1222
  1223         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1224         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1225         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1226         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1227         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1228         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1229         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1230         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1231         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1232         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1233
  1234* DLO001
  1235 01  WS-DLO-MASTER-POLICY-FORM.
  1236     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  24
* EL050.cbl
  1237     12  DMPF-RETURN-CODE          PIC XX.
  1238         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1239         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1240         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1241         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1242         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1243         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1244
  1245* DLO002
  1246 01  WS-DLO-INTERNAL-POLICY-FORM.
  1247     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1248     12  DIPF-RETURN-CODE          PIC XX.
  1249         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1250         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1251         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1252         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1253         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1254         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1255
  1256* DLO003
  1257 01  WS-DLO-VALID-BANK-ID.
  1258     12  DVBI-BANK-ID              PIC X(5).
  1259     12  DVBI-BANK-ID-TYPE         PIC X.
  1260         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1261         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1262         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1263         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1264         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1265     12  DVBI-RETURN-CODE          PIC XX.
  1266         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1267         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1268         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1269         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1270         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1271         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1272         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1273         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1274         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1275
  1276* DLO007
  1277 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1278     12  DCUA-RES-STATE            PIC XX.
  1279     12  DCUA-BEN-TYPE             PIC XX.
  1280     12  DCUA-SYS-IDENT            PIC X.
  1281         88  DCUA-CLAIM                        VALUE 'C'.
  1282         88  DCUA-PREMIUM                      VALUE 'P'.
  1283     12  DCUA-COVERAGE-RULE        PIC X.
  1284     12  DCUA-CLIENT-ID            PIC X(10).
  1285     12  DCUA-EFF-DATE             PIC X(8).
  1286     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1287     12  DCUA-RETURN-CODE          PIC XX.
  1288         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1289     12  DCUA-CERT-NUMBER          PIC X(11).
  1290     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1291     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1292
  1293* DLO011
  1294 01  WS-DLO-PREM-RATES-BEN-TYPE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  25
* EL050.cbl
  1295     12  DPRB-RATE-CODE            PIC X(4).
  1296     12  DPRB-COVERAGE-CATEG       PIC X.
  1297     12  DPRB-RETURN-CODE          PIC XX.
  1298         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1299         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1300         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1301         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1302         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1303         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1304         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1305         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1306         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1307     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1308     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1309     12  DPRB-BEN-TYPE             PIC XX.
  1310
  1311* DLO017
  1312 01  WS-DLO-VALID-RATE-CODE.
  1313     12  DVRC-RATE-CODE            PIC X(4).
  1314     12  DVRC-RETURN-CODE          PIC XX.
  1315         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1316         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1317         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1318         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1319         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1320         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1321
  1322* DLO019
  1323 01  WS-DLO-ORIG-COV-CAT.
  1324     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1325     12  DOCC-RETURN-CODE          PIC XX.
  1326     12  DOCC-ORIG-COV-CAT         PIC X.
  1327     12  DOCC-UNDERWITER           PIC XX.
  1328     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1329     12  DOCC-FILLER               PIC X(6).
  1330
  1331* DLO021
  1332 01  WS-DLO-VALID-LOAN-OFFICER.
  1333     12  DVLO-LOAN-OFFICER.
  1334         16  DVLO-BILL-TYPE        PIC X.
  1335         16  DVLO-BILL-SOURCE      PIC X.
  1336         16  DVLO-BATCH-TYPE       PIC X.
  1337     12  DVLO-RETURN-CODE          PIC XX.
  1338         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1339         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1340         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1341         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1342         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1343         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1344
  1345* DLO022
  1346 01  WS-DLO-VALID-STATE-CODE.
  1347     12  DVSC-STATE-CODE           PIC XX.
  1348     12  DVSC-RETURN-CODE          PIC XX.
  1349         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1350
  1351* DLO023
  1352 01  WS-DLO-VALID-CODE-VALUES.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  26
* EL050.cbl
  1353     12  DVCV-SYSTEM-ID            PIC XX.
  1354         88  DVCV-CLAIMS                       VALUE 'CL'.
  1355         88  DVCV-CREDIT                       VALUE 'CR'.
  1356     12  DVCV-RECORD-TYPE          PIC XX.
  1357         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1358         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1359         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1360         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1361         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1362         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1363         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1364         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1365     12  DVCV-RECORD-KEY           PIC X(6).
  1366     12  DVCV-RETURN-CODE          PIC XX.
  1367         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1368         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1369         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1370         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1371         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1372         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1373         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1374     12  DVCV-CODE-DESC            PIC X(60).
  1375     12  DVCV-GEN-DESC-1           PIC X(20).
  1376     12  DVCV-GEN-DESC-2           PIC X(20).
  1377     12  DVCV-GEN-DESC-3           PIC X(20).
  1378
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  27
* EL050.cbl
  1380*    COPY ERCBXRF.
  1381******************************************************************
  1382*                                                                *
  1383*                                                                *
  1384*                            ERCBXRF                             *
  1385*                                                                *
  1386*   ONLINE CREDIT SYSTEM                                         *
  1387*                                                                *
  1388*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1389*                                                                *
  1390*   FILE TYPE = VSAM,KSDS                                        *
  1391*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1392*                                                                *
  1393*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1394*       ALTERNATE PATH = NONE                                    *
  1395*                                                                *
  1396*   LOG = NO                                                     *
  1397*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1398*                                                                *
  1399******************************************************************
  1400
  1401 01  BANK-CROSS-REFERENCE.
  1402     12  BK-RECORD-ID                PIC XX.
  1403         88  VALID-BK-ID             VALUE 'BK'.
  1404
  1405     12  BK-CONTROL-PRIMARY.
  1406         16  BK-COMPANY-CD           PIC X.
  1407         16  BK-CARRIER              PIC X.
  1408         16  BK-GROUPING             PIC X(6).
  1409         16  BK-BANK-NO              PIC X(10).
  1410
  1411     12  BK-MAINT-INFORMATION.
  1412         16  BK-LAST-MAINT-DT        PIC XX.
  1413         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1414         16  BK-LAST-MAINT-USER      PIC X(4).
  1415         16  FILLER                  PIC X(9).
  1416
  1417     12  FILLER                      PIC X(37).
  1418
  1419     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1420
  1421     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1422                            DEPENDING ON BK-BANK-POINTER-CNT.
  1423         16  BK-AM-ACCOUNT           PIC X(10).
  1424         16  BK-AM-EXP-DT            PIC XX.
  1425         16  BK-AM-EFF-DT            PIC XX.
  1426         16  BK-AM-STATE             PIC XX.
  1427         16  FILLER                  PIC X(20).
  1428
  1429******************************************************************
  1430
  1431*    COPY ERCCOMP.
  1432******************************************************************
  1433*                                                                *
  1434*                                                                *
  1435*                            ERCCOMP                             *
  1436*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1437*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  28
* EL050.cbl
  1438*                                                                *
  1439*   ONLINE CREDIT SYSTEM                                         *
  1440*                                                                *
  1441*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1442*                                                                *
  1443*   FILE TYPE = VSAM,KSDS                                        *
  1444*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1445*                                                                *
  1446*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1447*       ALTERNATE PATH = NONE                                    *
  1448*                                                                *
  1449*   LOG = NO                                                     *
  1450*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1451*                                                                *
  1452******************************************************************
  1453*                   C H A N G E   L O G
  1454*
  1455* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1456*-----------------------------------------------------------------
  1457*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1458* EFFECTIVE    NUMBER
  1459*-----------------------------------------------------------------
  1460* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1461* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1462* 092205    2005050300006  PEMA  ADD LEASE FEE
  1463* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1464* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1465* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1466* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1467* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1468******************************************************************
  1469
  1470 01  COMPENSATION-MASTER.
  1471     12  CO-RECORD-ID                          PIC XX.
  1472         88  VALID-CO-ID                          VALUE 'CO'.
  1473
  1474     12  CO-CONTROL-PRIMARY.
  1475         16  CO-COMPANY-CD                     PIC X.
  1476         16  CO-CONTROL.
  1477             20  CO-CTL-1.
  1478                 24  CO-CARR-GROUP.
  1479                     28  CO-CARRIER            PIC X.
  1480                     28  CO-GROUPING.
  1481                         32  CO-GROUP-PREFIX   PIC XXX.
  1482                         32  CO-GROUP-PRIME    PIC XXX.
  1483                 24  CO-RESP-NO.
  1484                     28  CO-RESP-PREFIX        PIC X(4).
  1485                     28  CO-RESP-PRIME         PIC X(6).
  1486             20  CO-CTL-2.
  1487                 24  CO-ACCOUNT.
  1488                     28  CO-ACCT-PREFIX        PIC X(4).
  1489                     28  CO-ACCT-PRIME         PIC X(6).
  1490         16  CO-TYPE                           PIC X.
  1491             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1492             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1493             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1494
  1495     12  CO-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  29
* EL050.cbl
  1496         16  CO-LAST-MAINT-DT                  PIC XX.
  1497         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1498         16  CO-LAST-MAINT-USER                PIC X(4).
  1499     12  FILLER                                PIC XX.
  1500     12  CO-STMT-TYPE                          PIC XXX.
  1501     12  CO-COMP-TYPE                          PIC X.
  1502         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1503     12  CO-STMT-OWNER                         PIC X(4).
  1504     12  CO-BALANCE-CONTROL                    PIC X.
  1505         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1506         88  CO-NO-BALANCE                        VALUE 'N'.
  1507
  1508     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1509         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1510         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1511         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1512
  1513     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1514         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1515         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1516
  1517     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1518     12  CO-GA-DIRECT-DEP                      PIC X.
  1519     12  CO-FUTURE-SPACE                       PIC X.
  1520         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1521
  1522     12  CO-ACCT-NAME                          PIC X(30).
  1523     12  CO-MAIL-NAME                          PIC X(30).
  1524     12  CO-ADDR-1                             PIC X(30).
  1525     12  CO-ADDR-2                             PIC X(30).
  1526     12  CO-ADDR-3.
  1527         16  CO-ADDR-CITY                      PIC X(27).
  1528         16  CO-ADDR-STATE                     PIC XX.
  1529     12  CO-CSO-1099                           PIC X.
  1530     12  CO-ZIP.
  1531         16  CO-ZIP-PRIME.
  1532             20  CO-ZIP-PRI-1ST                PIC X.
  1533                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1534             20  FILLER                        PIC X(4).
  1535         16  CO-ZIP-PLUS4                      PIC X(4).
  1536     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1537         16  CO-CAN-POSTAL-1                   PIC XXX.
  1538         16  CO-CAN-POSTAL-2                   PIC XXX.
  1539         16  FILLER                            PIC XXX.
  1540     12  CO-SOC-SEC                            PIC X(13).
  1541     12  CO-TELEPHONE.
  1542         16  CO-AREA-CODE                      PIC XXX.
  1543         16  CO-PREFIX                         PIC XXX.
  1544         16  CO-PHONE                          PIC X(4).
  1545
  1546     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1547
  1548     12  CO-AR-BAL-LEVEL                       PIC X.
  1549         88  CO-AR-REF-LVL                        VALUE '1'.
  1550         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1551         88  CO-AR-BILL-LVL                       VALUE '2'.
  1552         88  CO-AR-AGT-LVL                        VALUE '3'.
  1553         88  CO-AR-FR-LVL                         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  30
* EL050.cbl
  1554
  1555     12  CO-AR-NORMAL-PRINT                    PIC X.
  1556         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1557         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1558
  1559     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1560
  1561     12  CO-AR-REPORTING                       PIC X.
  1562         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1563         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1564
  1565     12  CO-AR-PULL-CHECK                      PIC X.
  1566         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1567         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1568
  1569     12  CO-AR-BALANCE-PRINT                   PIC X.
  1570         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1571
  1572     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1573         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1574         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1575         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1576
  1577     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1578
  1579     12  CO-USER-CODE                          PIC X.
  1580     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1581
  1582******************************************************************
  1583*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1584*    THE LAST MONTH END RUN.
  1585******************************************************************
  1586
  1587     12  CO-LAST-ACTIVITY-DATE.
  1588         16  CO-ACT-YEAR                       PIC 99.
  1589         16  CO-ACT-MONTH                      PIC 99.
  1590         16  CO-ACT-DAY                        PIC 99.
  1591
  1592     12  CO-LAST-STMT-DT.
  1593         16  CO-LAST-STMT-YEAR                 PIC 99.
  1594         16  CO-LAST-STMT-MONTH                PIC 99.
  1595         16  CO-LAST-STMT-DAY                  PIC 99.
  1596
  1597     12  CO-MO-END-TOTALS.
  1598         16  CO-MONTHLY-TOTALS.
  1599             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1600             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1601             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1602             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1603             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1604
  1605         16  CO-AGING-TOTALS.
  1606             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1607             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1608             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1609             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1610
  1611         16  CO-YTD-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  31
* EL050.cbl
  1612             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1613             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1614
  1615         16  CO-OVER-UNDER-TOTALS.
  1616             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1617             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1618
  1619     12  CO-MISCELLANEOUS-TOTALS.
  1620         16  CO-FICA-TOTALS.
  1621             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1622             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1623
  1624         16  CO-CLAIM-TOTALS.
  1625             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1626             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1627
  1628******************************************************************
  1629*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1630*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1631******************************************************************
  1632
  1633     12  CO-CURRENT-TOTALS.
  1634         16  CO-CURRENT-LAST-STMT-DT.
  1635             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1636             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1637             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1638
  1639         16  CO-CURRENT-MONTHLY-TOTALS.
  1640             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1641             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1642             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1643             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1644             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1645
  1646         16  CO-CURRENT-AGING-TOTALS.
  1647             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1648             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1649             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1650             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1651
  1652         16  CO-CURRENT-YTD-TOTALS.
  1653             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1654             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1655
  1656     12  CO-PAID-COMM-TOTALS.
  1657         16  CO-YTD-PAID-COMMS.
  1658             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1659             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1660
  1661     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1662         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1663         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1664
  1665     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1666         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1667         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1668         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1669         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  32
* EL050.cbl
  1670         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1671         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1672         88  CO-FINAL-LETTER                  VALUE 'F'.
  1673         88  CO-RECONCILING                   VALUE 'R'.
  1674         88  CO-PHONE-CALL                    VALUE 'P'.
  1675         88  CO-LEGAL                         VALUE 'L'.
  1676         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1677         88  CO-WRITE-OFF                     VALUE 'W'.
  1678         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1679
  1680     12  CO-CSR-CODE                       PIC X(4).
  1681
  1682     12  CO-GA-STATUS-INFO.
  1683         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1684         16  CO-GA-TERMINATION-DT          PIC XX.
  1685         16  CO-GA-STATUS-CODE             PIC X.
  1686             88  CO-GA-ACTIVE                 VALUE 'A'.
  1687             88  CO-GA-INACTIVE               VALUE 'I'.
  1688             88  CO-GA-PENDING                VALUE 'P'.
  1689         16  CO-GA-COMMENTS.
  1690             20  CO-GA-COMMENT-1           PIC X(40).
  1691             20  CO-GA-COMMENT-2           PIC X(40).
  1692             20  CO-GA-COMMENT-3           PIC X(40).
  1693             20  CO-GA-COMMENT-4           PIC X(40).
  1694
  1695     12  CO-RPTCD2                         PIC X(10).
  1696
  1697     12  CO-TYPE-AGENT                     PIC X(01).
  1698         88  CO-CORPORATION                   VALUE 'C'.
  1699         88  CO-PARTNERSHIP                   VALUE 'P'.
  1700         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1701         88  CO-TRUST                         VALUE 'T'.
  1702         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1703
  1704     12  CO-FAXNO.
  1705         16  CO-FAX-AREA-CODE                  PIC XXX.
  1706         16  CO-FAX-PREFIX                     PIC XXX.
  1707         16  CO-FAX-PHONE                      PIC X(4).
  1708
  1709     12  CO-BANK-INFORMATION.
  1710         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1711         16  CO-BANK-TRANSIT-NON REDEFINES
  1712             CO-BANK-TRANSIT-NO                PIC 9(8).
  1713
  1714         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1715     12  CO-MISC-DEDUCT-INFO REDEFINES
  1716                  CO-BANK-INFORMATION.
  1717         16  CO-MD-GL-ACCT                     PIC X(10).
  1718         16  CO-MD-DIV                         PIC XX.
  1719         16  CO-MD-CENTER                      PIC X(4).
  1720         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1721         16  CO-CREATE-AP-CHECK                PIC X.
  1722         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1723         16  FILLER                            PIC XXX.
  1724     12  CO-ACH-STATUS                         PIC X.
  1725         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1726         88  CO-ACH-PENDING                        VALUE 'P'.
  1727
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  33
* EL050.cbl
  1728     12  CO-BILL-SW                            PIC X.
  1729     12  CO-CONTROL-NAME                       PIC X(30).
  1730     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1731     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1732     12  CO-CLP-STATE                          PIC XX.
  1733     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1734     12  CO-SPP-REFUND-EDIT                    PIC X.
  1735
  1736******************************************************************
  1737
  1738*    COPY ERCAGTC.
  1739******************************************************************
  1740*                                                                *
  1741*                                                                *
  1742*                            ERCAGTC                             *
  1743*                            VMOD=2.001                          *
  1744*                                                                *
  1745*   ONLINE CREDIT SYSTEM                                         *
  1746*                                                                *
  1747*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1748*                                                                *
  1749*   FILE TYPE = VSAM,KSDS                                        *
  1750*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1751*                                                                *
  1752*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1753*       ALTERNATE PATH = NONE                                    *
  1754*                                                                *
  1755*   LOG = NO                                                     *
  1756*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1757*                                                                *
  1758******************************************************************
  1759*                   C H A N G E   L O G
  1760*
  1761* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1762*-----------------------------------------------------------------
  1763*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1764* EFFECTIVE    NUMBER
  1765*-----------------------------------------------------------------
  1766* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1767* 111004                         NEW FILE AND COPYBOOK
  1768* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1769******************************************************************
  1770 01  AGENT-COMMISSIONS.
  1771     12  AG-RECORD-ID                          PIC XX.
  1772         88  VALID-CO-ID                          VALUE 'AG'.
  1773     12  AG-CONTROL-PRIMARY.
  1774         16  AG-COMPANY-CD                     PIC X.
  1775         16  AG-CONTROL.
  1776             20  AG-CTL-1.
  1777                 24  AG-CARR-GROUP.
  1778                     28  AG-CARRIER            PIC X.
  1779                     28  AG-GROUPING           PIC X(6).
  1780                 24  AG-BANK                   PIC X(10).
  1781             20  AG-CTL-2.
  1782                 24  AG-EXP-DT                 PIC XX.
  1783         16  AG-TYPE                           PIC X.
  1784             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1785             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  34
* EL050.cbl
  1786     12  AG-MAINT-INFORMATION.
  1787         16  AG-LAST-MAINT-DT                  PIC XX.
  1788         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1789         16  AG-LAST-MAINT-USER                PIC X(4).
  1790         16  FILLER                            PIC X(10).
  1791     12  AG-EFF-DT                             PIC XX.
  1792     12  AG-COMM-STRUCTURE.
  1793         16  AG-AGT-COMMS OCCURS 10.
  1794             20  AG-AGT                PIC X(10).
  1795             20  AG-COM-TYP            PIC X.
  1796             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1797             20  AG-RECALC-LV-INDIC    PIC X.
  1798             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1799             20  AG-LRCALC-LV-INDIC    PIC X.
  1800             20  FILLER                PIC X(05).
  1801     12  FILLER                  PIC X(145).
  1802******************************************************************
  1803*    COPY ERCRESS.
  1804******************************************************************
  1805*                                                                *
  1806*                            ERCRESS                             *
  1807*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1808*                            VMOD=2.002                          *
  1809*                                                                *
  1810*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1811*                                                                *
  1812*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1813*   VSAM RESIDENT STATE TAX MASTER                              *
  1814*                                                                *
  1815*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1816*                                                                *
  1817*   FILE TYPE = VSAM,KSDS                                        *
  1818*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1819*                                                                *
  1820*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1821*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1822*                                                                *
  1823*   LOG = NO                                                     *
  1824*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1825*                                                                *
  1826*                                                                *
  1827******************************************************************
  1828
  1829 01  RESIDENT-STATE-TAX-MASTER.
  1830
  1831     10  ERRESS-PRIMARY-KEY.
  1832         15  RES-COMPANY-CD        PIC X.
  1833         15  RES-RESIDENT-STATE    PIC XX.
  1834         15  RES-COVERAGE-CATEGORY PIC X.
  1835         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1836*                                      YYYYMMDD
  1837*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1838
  1839     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
  1840
  1841         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1842         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1843         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  35
* EL050.cbl
  1844         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1845
  1846     10 RES-RECALC-SW              PIC   X.
  1847         88 RECALC                VALUE 'Y'.
  1848         88 NO-RECALC             VALUE 'N'.
  1849     10  RES-MAINT-BY              PIC X(4).
  1850     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1851     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1852*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  36
* EL050.cbl
  1854*    COPY ERCRESC.
  1855******************************************************************
  1856*                                                                *
  1857*                            ERCRESC                             *
  1858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1859*                            VMOD=2.003                          *
  1860*                                                                *
  1861*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1862*                                                                *
  1863*   FILE TYPE = VSAM,KSDS                                        *
  1864*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1865*                                                                *
  1866*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1867*       ALTERNATE PATH1 = NONE                                   *
  1868*                                                                *
  1869*   LOG = NO                                                     *
  1870*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1871*                                                                *
  1872******************************************************************
  1873
  1874 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1875
  1876     10  ERRESC-RECORD-KEY.
  1877         15  RESC-COMPANY-CD           PIC   X.
  1878         15  RESC-CARRIER              PIC   X.
  1879         15  RESC-GROUP                PIC   X(6).
  1880         15  RESC-STATE                PIC   XX.
  1881         15  RESC-ACCOUNT              PIC   X(10).
  1882         15  RESC-AGENT                PIC   X(10).
  1883         15  RESC-RESIDENT-STATE       PIC   XX.
  1884         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1885*                                           YYYYMMDD
  1886     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1887
  1888     10  RESC-COMM-RECORD-DATA.
  1889         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1890             20 RESC-COVERAGE-CAT      PIC    X.
  1891             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1892             20 RESC-COMMISSION-TAB REDEFINES
  1893                RESC-COMMISSION-PER    PIC  XXX.
  1894
  1895     10  RESC-MAINT-BY                 PIC X(4).
  1896     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1897     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1898*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  37
* EL050.cbl
  1900*    COPY ERCPLAN.
  1901******************************************************************
  1902*                                                                *
  1903*                                                                *
  1904*                            ERCPLAN                             *
  1905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1906*                            VMOD=2.003                          *
  1907*                                                                *
  1908*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1909*                                                                *
  1910*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1911*   PLAN MASTER                                                  *
  1912*                                                                *
  1913*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1914*                                                                *
  1915*   FILE TYPE = VSAM,KSDS                                        *
  1916*   RECORD SIZE = 420   RECFORM = FIX                            *
  1917*                                                                *
  1918*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1919*       ALTERNATE PATH1 = N/A                                    *
  1920*                                                                *
  1921*   LOG = NO                                                     *
  1922*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1923*                                                                *
  1924*                                                                *
  1925******************************************************************
  1926
  1927 01  PLAN-MASTER.
  1928     12  PL-RECORD-ID                      PIC XX.
  1929         88  VALID-PL-ID                      VALUE 'PL'.
  1930
  1931     12  PL-CONTROL-PRIMARY.
  1932         16  PL-COMPANY-CD                 PIC X.
  1933         16  PL-MSTR-CNTRL.
  1934             20  PL-CONTROL-A.
  1935                 24  PL-CARRIER            PIC X.
  1936                 24  PL-GROUPING           PIC X(6).
  1937                 24  PL-STATE              PIC XX.
  1938                 24  PL-ACCOUNT            PIC X(10).
  1939             20  PL-BENEFIT-TYPE           PIC X.
  1940             20  PL-BENEFIT-CODE           PIC XX.
  1941             20  PL-REVISION-NO            PIC X(3).
  1942
  1943     12  PL-CONTROL-BY-VAR-GRP.
  1944         16  PL-COMPANY-CD-A1              PIC X.
  1945         16  PL-VG-CARRIER                 PIC X.
  1946         16  PL-VG-GROUPING                PIC X(6).
  1947         16  PL-VG-STATE                   PIC XX.
  1948         16  PL-VG-ACCOUNT                 PIC X(10).
  1949         16  PL-BENEFIT-TYPE-A1            PIC X.
  1950         16  PL-BENEFIT-CODE-A1            PIC XX.
  1951         16  PL-REVISION-NO-A1             PIC 999.
  1952
  1953     12  PL-MAINT-INFORMATION.
  1954         16  PL-LAST-MAINT-DT              PIC XX.
  1955         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1956         16  PL-LAST-MAINT-USER            PIC X(4).
  1957         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  38
* EL050.cbl
  1958
  1959     12  PL-LIABILITY-LIMITS.
  1960         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1961         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1962             20  PL-LM-AGE                 PIC S99        COMP-3.
  1963             20  PL-LM-DUR                 PIC S999       COMP-3.
  1964             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  1965             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  1966
  1967     12  FILLER                            PIC X(30).
  1968
  1969     12  PL-GL-ACCOUNT-NOS.
  1970         16  PL-PREMIUM-GL                 PIC X(8).
  1971         16  PL-COMM-GL                    PIC X(8).
  1972         16  PL-CLAIM-GL                   PIC X(8).
  1973     12  FILLER                            PIC X(24).
  1974     12  PL-TOLERANCES.
  1975         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  1976         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  1977         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  1978         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  1979         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  1980         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  1981     12  PL-OVER-SHORT.
  1982         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  1983         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  1984     12  FILLER                            PIC X(24).
  1985     12  PLAN-MISC.
  1986         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  1987         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  1988         16  PL-IG                         PIC X.
  1989         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  1990         16  PL-POLICY-FORM                PIC X(12).
  1991         16  PL-EDIT-FOR-FORM              PIC X(01).
  1992         16  PL-DEV-CODE                   PIC XXX.
  1993         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  1994         16  PL-CALC-METHOD                PIC X.
  1995         16  PL-BENEFIT-GROUP              PIC X(05).
  1996         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  1997
  1998         16  FILLER                        PIC X(99).
  1999******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  39
* EL050.cbl
  2001*    COPY ELCCERT.
  2002******************************************************************
  2003*                                                                *
  2004*                            ELCCERT.                            *
  2005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2006*                            VMOD=2.013                          *
  2007*                                                                *
  2008*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2009*                                                                *
  2010*   FILE TYPE = VSAM,KSDS                                        *
  2011*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2012*                                                                *
  2013*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2014*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2015*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2016*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2017*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2018*                                                                *
  2019*   LOG = YES                                                    *
  2020*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2021******************************************************************
  2022*                   C H A N G E   L O G
  2023*
  2024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2025*-----------------------------------------------------------------
  2026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2027* EFFECTIVE    NUMBER
  2028*-----------------------------------------------------------------
  2029* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2030* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2031* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2032* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2033* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2034* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2035* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2036******************************************************************
  2037
  2038 01  CERTIFICATE-MASTER.
  2039     12  CM-RECORD-ID                      PIC XX.
  2040         88  VALID-CM-ID                      VALUE 'CM'.
  2041
  2042     12  CM-CONTROL-PRIMARY.
  2043         16  CM-COMPANY-CD                 PIC X.
  2044         16  CM-CARRIER                    PIC X.
  2045         16  CM-GROUPING.
  2046             20  CM-GROUPING-PREFIX        PIC X(3).
  2047             20  CM-GROUPING-PRIME         PIC X(3).
  2048         16  CM-STATE                      PIC XX.
  2049         16  CM-ACCOUNT.
  2050             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2051             20  CM-ACCOUNT-PRIME          PIC X(6).
  2052         16  CM-CERT-EFF-DT                PIC XX.
  2053         16  CM-CERT-NO.
  2054             20  CM-CERT-PRIME             PIC X(10).
  2055             20  CM-CERT-SFX               PIC X.
  2056
  2057     12  CM-CONTROL-BY-NAME.
  2058         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  40
* EL050.cbl
  2059         16  CM-INSURED-LAST-NAME          PIC X(15).
  2060         16  CM-INSURED-INITIALS.
  2061             20  CM-INSURED-INITIAL1       PIC X.
  2062             20  CM-INSURED-INITIAL2       PIC X.
  2063
  2064     12  CM-CONTROL-BY-SSN.
  2065         16  CM-COMPANY-CD-A2              PIC X.
  2066         16  CM-SOC-SEC-NO.
  2067             20  CM-SSN-STATE              PIC XX.
  2068             20  CM-SSN-ACCOUNT            PIC X(6).
  2069             20  CM-SSN-LN3.
  2070                 25  CM-INSURED-INITIALS-A2.
  2071                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2072                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2073                 25 CM-PART-LAST-NAME-A2         PIC X.
  2074
  2075     12  CM-CONTROL-BY-CERT-NO.
  2076         16  CM-COMPANY-CD-A4              PIC X.
  2077         16  CM-CERT-NO-A4                 PIC X(11).
  2078
  2079     12  CM-CONTROL-BY-MEMB.
  2080         16  CM-COMPANY-CD-A5              PIC X.
  2081         16  CM-MEMBER-NO.
  2082             20  CM-MEMB-STATE             PIC XX.
  2083             20  CM-MEMB-ACCOUNT           PIC X(6).
  2084             20  CM-MEMB-LN4.
  2085                 25  CM-INSURED-INITIALS-A5.
  2086                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2087                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2088                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2089
  2090     12  CM-INSURED-PROFILE-DATA.
  2091         16  CM-INSURED-FIRST-NAME.
  2092             20  CM-INSURED-1ST-INIT       PIC X.
  2093             20  FILLER                    PIC X(9).
  2094         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2095         16  CM-INSURED-SEX                PIC X.
  2096             88  CM-SEX-MALE                  VALUE 'M'.
  2097             88  CM-SEX-FEMAL                 VALUE 'F'.
  2098         16  CM-INSURED-JOINT-AGE          PIC 99.
  2099         16  CM-JOINT-INSURED-NAME.
  2100             20  CM-JT-LAST-NAME           PIC X(15).
  2101             20  CM-JT-FIRST-NAME.
  2102                 24  CM-JT-1ST-INIT        PIC X.
  2103                 24  FILLER                PIC X(9).
  2104             20  CM-JT-INITIAL             PIC X.
  2105
  2106     12  CM-LIFE-DATA.
  2107         16  CM-LF-BENEFIT-CD              PIC XX.
  2108         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2109         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2110         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2111         16  CM-LF-DEV-CODE                PIC XXX.
  2112         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2113         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2114         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2115         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2116         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  41
* EL050.cbl
  2117         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2118         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2119         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2120         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2121         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2122         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2123         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2124         16  FILLER                        PIC XX.
  2125
  2126     12  CM-AH-DATA.
  2127         16  CM-AH-BENEFIT-CD              PIC XX.
  2128         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2129         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2130         16  CM-AH-DEV-CODE                PIC XXX.
  2131         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2132         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2133         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2134         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2135         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2136         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2137         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2138         16  CM-AH-PAID-THRU-DT            PIC XX.
  2139             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2140         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2141         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2142         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2143         16  FILLER                        PIC X.
  2144
  2145     12  CM-LOAN-INFORMATION.
  2146         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2147         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2148         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2149         16  CM-PAY-FREQUENCY              PIC S99.
  2150         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2151         16  CM-RATE-CLASS                 PIC XX.
  2152         16  CM-BENEFICIARY                PIC X(25).
  2153         16  CM-POLICY-FORM-NO             PIC X(12).
  2154         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2155         16  CM-LAST-ADD-ON-DT             PIC XX.
  2156         16  CM-DEDUCTIBLE-AMOUNTS.
  2157             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2158             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2159         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2160             20  CM-RESIDENT-STATE         PIC XX.
  2161             20  CM-RATE-CODE              PIC X(4).
  2162             20  FILLER                    PIC XX.
  2163         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2164             20  CM-LOAN-OFFICER           PIC X(5).
  2165             20  FILLER                    PIC XXX.
  2166         16  CM-CSR-CODE                   PIC XXX.
  2167         16  CM-UNDERWRITING-CODE          PIC X.
  2168             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2169         16  CM-POST-CARD-IND              PIC X.
  2170         16  CM-NH-INTERFACE-SW            PIC X.
  2171         16  CM-PREMIUM-TYPE               PIC X.
  2172             88  CM-SING-PRM                  VALUE '1'.
  2173             88  CM-O-B-COVERAGE              VALUE '2'.
  2174             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  42
* EL050.cbl
  2175         16  CM-IND-GRP-TYPE               PIC X.
  2176             88  CM-INDIVIDUAL                VALUE 'I'.
  2177             88  CM-GROUP                     VALUE 'G'.
  2178         16  CM-SKIP-CODE                  PIC X.
  2179             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2180             88  SKIP-JULY                    VALUE '1'.
  2181             88  SKIP-AUGUST                  VALUE '2'.
  2182             88  SKIP-SEPTEMBER               VALUE '3'.
  2183             88  SKIP-JULY-AUG                VALUE '4'.
  2184             88  SKIP-AUG-SEPT                VALUE '5'.
  2185             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2186             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2187             88  SKIP-JUNE                    VALUE '8'.
  2188             88  SKIP-JUNE-JULY               VALUE '9'.
  2189             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2190             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2191         16  CM-PAYMENT-MODE               PIC X.
  2192             88  PAY-MONTHLY                  VALUE SPACE.
  2193             88  PAY-WEEKLY                   VALUE '1'.
  2194             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2195             88  PAY-BI-WEEKLY                VALUE '3'.
  2196             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2197         16  CM-LOAN-NUMBER                PIC X(8).
  2198         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2199         16  CM-OLD-LOF                    PIC XXX.
  2200*        16  CM-LOAN-OFFICER               PIC XXX.
  2201         16  CM-REIN-TABLE                 PIC XXX.
  2202         16  CM-SPECIAL-REIN-CODE          PIC X.
  2203         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2204         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2205         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2206
  2207     12  CM-STATUS-DATA.
  2208         16  CM-ENTRY-STATUS               PIC X.
  2209         16  CM-ENTRY-DT                   PIC XX.
  2210
  2211         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2212         16  CM-LF-CANCEL-DT               PIC XX.
  2213         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2214
  2215         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2216         16  CM-LF-DEATH-DT                PIC XX.
  2217         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2218
  2219         16  CM-LF-CURRENT-STATUS          PIC X.
  2220             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2221                                                'M' '4' '5' '9'.
  2222             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2223             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2224             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2225             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2226             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2227             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2228             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2229             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2230             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2231             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2232             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  43
* EL050.cbl
  2233             88  CM-LF-VOIDED                 VALUE 'V'.
  2234
  2235         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2236         16  CM-AH-CANCEL-DT               PIC XX.
  2237         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2238
  2239         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2240         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2241         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2242
  2243         16  CM-AH-CURRENT-STATUS          PIC X.
  2244             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2245                                                'M' '4' '5' '9'.
  2246             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2247             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2248             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2249             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2250             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2251             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2252             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2253             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2254             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2255             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2256             88  CM-AH-DECLINED               VALUE 'D'.
  2257             88  CM-AH-VOIDED                 VALUE 'V'.
  2258
  2259         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2260             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2261             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2262             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2263         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2264
  2265         16  CM-ENTRY-BATCH                PIC X(6).
  2266         16  CM-LF-EXIT-BATCH              PIC X(6).
  2267         16  CM-AH-EXIT-BATCH              PIC X(6).
  2268         16  CM-LAST-MONTH-END             PIC XX.
  2269
  2270     12  CM-NOTE-SW                        PIC X.
  2271         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2272         88  CERT-NOTES-PRESENT               VALUE '1'.
  2273         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2274         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2275         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2276         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2277         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2278         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2279     12  CM-COMP-EXCP-SW                   PIC X.
  2280         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2281         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2282     12  CM-INSURED-ADDRESS-SW             PIC X.
  2283         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2284         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2285
  2286*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2287     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2288     12  FILLER                            PIC X.
  2289
  2290*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  44
* EL050.cbl
  2291     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2292     12  FILLER                            PIC X.
  2293*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2294     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2295
  2296     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2297         88  CERT-ADDED-BATCH                 VALUE ' '.
  2298         88  CERT-ADDED-ONLINE                VALUE '1'.
  2299         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2300         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2301         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2302     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2303         88  CERT-AS-LOADED                   VALUE ' '.
  2304         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2305         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2306         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2307         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2308         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2309         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2310         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2311
  2312     12  CM-ACCOUNT-COMM-PCTS.
  2313         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2314         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2315
  2316     12  CM-USER-FIELD                     PIC X.
  2317     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2318     12  CM-CLP-STATE                      PIC XX.
  2319     12  CM-USER-RESERVED                  PIC XXX.
  2320******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  45
* EL050.cbl
  2322*    COPY ERCMAIL.
  2323******************************************************************
  2324*                                                                *
  2325*                                                                *
  2326*                            ERCMAIL                             *
  2327*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2328*                            VMOD=2.003                          *
  2329*                                                                *
  2330*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2331*                                                                *
  2332*   FILE TYPE = VSAM,KSDS                                        *
  2333*   RECORD SIZE = 374   RECFORM = FIX                            *
  2334*                                                                *
  2335*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2336*   ALTERNATE PATH    = NOT USED                                 *
  2337*                                                                *
  2338*   LOG = YES                                                    *
  2339*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2340******************************************************************
  2341*                   C H A N G E   L O G
  2342*
  2343* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2344*-----------------------------------------------------------------
  2345*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2346* EFFECTIVE    NUMBER
  2347*-----------------------------------------------------------------
  2348* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2349* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2350* 111108                   PEMA  ADD CRED BENE ADDR2
  2351******************************************************************
  2352
  2353 01  MAILING-DATA.
  2354     12  MA-RECORD-ID                      PIC XX.
  2355         88  VALID-MA-ID                       VALUE 'MA'.
  2356
  2357     12  MA-CONTROL-PRIMARY.
  2358         16  MA-COMPANY-CD                 PIC X.
  2359         16  MA-CARRIER                    PIC X.
  2360         16  MA-GROUPING.
  2361             20  MA-GROUPING-PREFIX        PIC XXX.
  2362             20  MA-GROUPING-PRIME         PIC XXX.
  2363         16  MA-STATE                      PIC XX.
  2364         16  MA-ACCOUNT.
  2365             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2366             20  MA-ACCOUNT-PRIME          PIC X(6).
  2367         16  MA-CERT-EFF-DT                PIC XX.
  2368         16  MA-CERT-NO.
  2369             20  MA-CERT-PRIME             PIC X(10).
  2370             20  MA-CERT-SFX               PIC X.
  2371
  2372     12  FILLER                            PIC XX.
  2373
  2374     12  MA-ACCESS-CONTROL.
  2375         16  MA-SOURCE-SYSTEM              PIC XX.
  2376             88  MA-FROM-CREDIT                VALUE 'CR'.
  2377             88  MA-FROM-VSI                   VALUE 'VS'.
  2378             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2379             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  46
* EL050.cbl
  2380         16  MA-RECORD-ADD-DT              PIC XX.
  2381         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2382         16  MA-LAST-MAINT-DT              PIC XX.
  2383         16  MA-LAST-MAINT-BY              PIC XXXX.
  2384         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2385
  2386     12  MA-PROFILE-INFO.
  2387         16  MA-QUALIFY-CODE-1             PIC XX.
  2388         16  MA-QUALIFY-CODE-2             PIC XX.
  2389         16  MA-QUALIFY-CODE-3             PIC XX.
  2390         16  MA-QUALIFY-CODE-4             PIC XX.
  2391         16  MA-QUALIFY-CODE-5             PIC XX.
  2392
  2393         16  MA-INSURED-LAST-NAME          PIC X(15).
  2394         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2395         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2396         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2397         16  MA-INSURED-BIRTH-DT           PIC XX.
  2398         16  MA-INSURED-SEX                PIC X.
  2399             88  MA-SEX-MALE                   VALUE 'M'.
  2400             88  MA-SEX-FEMALE                 VALUE 'F'.
  2401         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2402
  2403         16  MA-ADDRESS-CORRECTED          PIC X.
  2404         16  MA-JOINT-BIRTH-DT             PIC XX.
  2405*        16  FILLER                        PIC X(12).
  2406
  2407         16  MA-ADDRESS-LINE-1             PIC X(30).
  2408         16  MA-ADDRESS-LINE-2             PIC X(30).
  2409         16  MA-CITY-STATE.
  2410             20  MA-CITY                   PIC X(28).
  2411             20  MA-ADDR-STATE             PIC XX.
  2412         16  MA-ZIP.
  2413             20  MA-ZIP-CODE.
  2414                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2415                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2416                 24  FILLER                PIC X(4).
  2417             20  MA-ZIP-PLUS4              PIC X(4).
  2418         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2419             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2420             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2421             20  FILLER                    PIC X(3).
  2422
  2423         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2424
  2425         16  FILLER                        PIC XXX.
  2426*        16  FILLER                        PIC X(10).
  2427
  2428     12  MA-CRED-BENE-INFO.
  2429         16  MA-CRED-BENE-NAME                 PIC X(25).
  2430         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2431         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2432         16  MA-CRED-BENE-CTYST.
  2433             20  MA-CRED-BENE-CITY             PIC X(28).
  2434             20  MA-CRED-BENE-STATE            PIC XX.
  2435         16  MA-CRED-BENE-ZIP.
  2436             20  MA-CB-ZIP-CODE.
  2437                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  47
* EL050.cbl
  2438                     88  MA-CB-CANADIAN-POST-CODE
  2439                                           VALUE 'A' THRU 'Z'.
  2440                 24  FILLER                    PIC X(4).
  2441             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2442         16  MA-CB-CANADIAN-POSTAL-CODE
  2443                            REDEFINES MA-CRED-BENE-ZIP.
  2444             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2445             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2446             20  FILLER                        PIC X(3).
  2447     12  MA-POST-CARD-MAIL-DATA.
  2448         16  MA-MAIL-DATA OCCURS 7.
  2449             20  MA-MAIL-TYPE              PIC X.
  2450                 88  MA-12MO-MAILING           VALUE '1'.
  2451                 88  MA-EXP-MAILING            VALUE '2'.
  2452             20  MA-MAIL-STATUS            PIC X.
  2453                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2454                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2455                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2456             20  MA-MAIL-DATE              PIC XX.
  2457     12  FILLER                            PIC XX.
  2458     12  FILLER                            PIC XX.
  2459*    12  FILLER                            PIC X(30).
  2460******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  48
* EL050.cbl
  2462*    COPY ERCPNDM.
  2463******************************************************************
  2464*                                                                *
  2465*                                                                *
  2466*                            ERCPNDM                             *
  2467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2468*                            VMOD=2.003                          *
  2469*                                                                *
  2470*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2471*                                                                *
  2472*   FILE TYPE = VSAM,KSDS                                        *
  2473*   RECORD SIZE = 374   RECFORM = FIX                            *
  2474*                                                                *
  2475*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2476*   ALTERNATE PATH    = NOT USED                                 *
  2477*                                                                *
  2478*   LOG = YES                                                    *
  2479*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2480******************************************************************
  2481*                   C H A N G E   L O G
  2482*
  2483* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2484*-----------------------------------------------------------------
  2485*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2486* EFFECTIVE    NUMBER
  2487*-----------------------------------------------------------------
  2488* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2489* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2490* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2491******************************************************************
  2492
  2493 01  PENDING-MAILING-DATA.
  2494     12  PM-RECORD-ID                      PIC XX.
  2495         88  VALID-MA-ID                       VALUE 'PM'.
  2496
  2497     12  PM-CONTROL-PRIMARY.
  2498         16  PM-COMPANY-CD                 PIC X.
  2499         16  PM-ENTRY-BATCH                PIC X(6).
  2500         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2501         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2502
  2503     12  FILLER                            PIC X(14).
  2504
  2505     12  PM-ACCESS-CONTROL.
  2506         16  PM-SOURCE-SYSTEM              PIC XX.
  2507             88  PM-FROM-CREDIT                VALUE 'CR'.
  2508             88  PM-FROM-VSI                   VALUE 'VS'.
  2509             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2510             88  PM-FROM-OTHER                 VALUE 'OT'.
  2511         16  PM-RECORD-ADD-DT              PIC XX.
  2512         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2513         16  PM-LAST-MAINT-DT              PIC XX.
  2514         16  PM-LAST-MAINT-BY              PIC XXXX.
  2515         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2516
  2517     12  PM-PROFILE-INFO.
  2518         16  PM-QUALIFY-CODE-1             PIC XX.
  2519         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  49
* EL050.cbl
  2520         16  PM-QUALIFY-CODE-3             PIC XX.
  2521         16  PM-QUALIFY-CODE-4             PIC XX.
  2522         16  PM-QUALIFY-CODE-5             PIC XX.
  2523
  2524         16  PM-INSURED-LAST-NAME          PIC X(15).
  2525         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2526         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2527         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2528         16  PM-INSURED-BIRTH-DT           PIC XX.
  2529         16  PM-INSURED-SEX                PIC X.
  2530             88  PM-SEX-MALE                   VALUE 'M'.
  2531             88  PM-SEX-FEMALE                 VALUE 'F'.
  2532         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2533
  2534         16  PM-ADDRESS-CORRECTED          PIC X.
  2535         16  PM-JOINT-BIRTH-DT             PIC XX.
  2536*        16  FILLER                        PIC X(12).
  2537
  2538         16  PM-ADDRESS-LINE-1             PIC X(30).
  2539         16  PM-ADDRESS-LINE-2             PIC X(30).
  2540         16  PM-CITY-STATE.
  2541             20  PM-CITY                   PIC X(28).
  2542             20  PM-STATE                  PIC XX.
  2543         16  PM-ZIP.
  2544             20  PM-ZIP-CODE.
  2545                 24  PM-ZIP-1              PIC X.
  2546                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2547                 24  FILLER                PIC X(4).
  2548             20  PM-ZIP-PLUS4              PIC X(4).
  2549         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2550             20  PM-CAN-POST1              PIC XXX.
  2551             20  PM-CAN-POST2              PIC XXX.
  2552             20  FILLER                    PIC XXX.
  2553
  2554         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2555
  2556         16  FILLER                        PIC X(03).
  2557
  2558     12  PM-CRED-BENE-INFO.
  2559         16  PM-CRED-BENE-NAME             PIC X(25).
  2560         16  PM-CRED-BENE-ADDR             PIC X(30).
  2561         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2562         16  PM-CRED-BENE-CTYST.
  2563             20  PM-CRED-BENE-CITY         PIC X(28).
  2564             20  PM-CRED-BENE-STATE        PIC XX.
  2565         16  PM-CRED-BENE-ZIP.
  2566             20  PM-CB-ZIP-CODE.
  2567                 24  PM-CB-ZIP-1           PIC X.
  2568                     88  PM-CB-CANADIAN-POST-CODE
  2569                                  VALUE 'A' THRU 'Z'.
  2570                 24  FILLER                PIC X(4).
  2571             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2572         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2573             20  PM-CB-CAN-POST1           PIC XXX.
  2574             20  PM-CB-CAN-POST2           PIC XXX.
  2575             20  FILLER                    PIC XXX.
  2576     12  PM-POST-CARD-MAIL-DATA.
  2577         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  50
* EL050.cbl
  2578             20  PM-MAIL-TYPE              PIC X.
  2579                 88  PM-12MO-MAILING           VALUE '1'.
  2580                 88  PM-EXP-MAILING            VALUE '2'.
  2581             20  PM-MAIL-STATUS            PIC X.
  2582                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2583                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2584                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2585             20  PM-MAIL-DATE              PIC XX.
  2586     12  FILLER                            PIC XX.
  2587     12  FILLER                            PIC X(12).
  2588*    12  FILLER                            PIC X(30).
  2589
  2590******************************************************************
  2591*                                COPY ERCLOFC.
  2592******************************************************************
  2593*                                                                *
  2594*                                                                *
  2595*                            ERCLOFC                             *
  2596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2597*                            VMOD=2.003                          *
  2598*                                                                *
  2599*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2600*                                                                *
  2601*   FILE TYPE = VSAM,KSDS                                        *
  2602*   RECORD SIZE = 670   RECFORM = FIX                            *
  2603*                                                                *
  2604*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2605*                                                                *
  2606*   LOG = YES                                                    *
  2607*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2608*                                                                *
  2609******************************************************************
  2610
  2611 01  LOAN-OFFICER-MASTER.
  2612     12  LO-RECORD-ID                PIC XX.
  2613         88  VALID-LO-ID                VALUE 'LO'.
  2614
  2615     12  LO-CONTROL-PRIMARY.
  2616         16  LO-COMPANY-CD           PIC X.
  2617         16  LO-CARRIER              PIC X.
  2618         16  LO-GROUPING.
  2619             20  LO-GROUPING-PREFIX  PIC XXX.
  2620             20  LO-GROUPING-PRIME   PIC XXX.
  2621         16  LO-STATE                PIC XX.
  2622         16  LO-ACCOUNT.
  2623             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2624             20  LO-ACCOUNT-PRIME    PIC X(6).
  2625         16  LO-OFFICER-CODE         PIC X(5).
  2626
  2627     12  LO-OFFICER-NAME             PIC X(30).
  2628
  2629     12  LO-LAST-MAINT-DT            PIC XX.
  2630     12  LO-LAST-USER                PIC X(4).
  2631     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2632
  2633     12  LO-COMP-CONTROL             PIC X.
  2634             88  LO-SHOW-COMP           VALUE 'Y'.
  2635             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  51
* EL050.cbl
  2636     12  LO-DETAIL-CONTROL           PIC X.
  2637             88  LO-PRINT-DETAIL        VALUE 'D'.
  2638             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2639
  2640     12  LO-SV-CARRIER               PIC X.
  2641     12  LO-SV-GROUPING              PIC X(6).
  2642     12  LO-SV-STATE                 PIC XX.
  2643
  2644     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2645     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2646
  2647     12  LO-OFFICER-INFO.
  2648         16  FILLER OCCURS 12 TIMES.
  2649             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2650             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2651             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2652             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2653             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2654             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2655             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2656             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2657     12  FILLER                      PIC X(198).
  2658******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  52
* EL050.cbl
  2660*    COPY ELCCRTT.
  2661******************************************************************
  2662*                                                                *
  2663*                            ELCCRTT.                            *
  2664*                                                                *
  2665*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2666*                                                                *
  2667*   FILE TYPE = VSAM,KSDS                                        *
  2668*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2669*                                                                *
  2670*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2671*                                                                *
  2672*   LOG = YES                                                    *
  2673*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2674******************************************************************
  2675*                   C H A N G E   L O G
  2676*
  2677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2678*-----------------------------------------------------------------
  2679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2680* EFFECTIVE    NUMBER
  2681*-----------------------------------------------------------------
  2682* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2683* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2684* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2685******************************************************************
  2686
  2687 01  CERTIFICATE-TRAILERS.
  2688     12  CS-RECORD-ID                      PIC XX.
  2689         88  VALID-CS-ID                      VALUE 'CS'.
  2690
  2691     12  CS-CONTROL-PRIMARY.
  2692         16  CS-COMPANY-CD                 PIC X.
  2693         16  CS-CARRIER                    PIC X.
  2694         16  CS-GROUPING                   PIC X(6).
  2695         16  CS-STATE                      PIC XX.
  2696         16  CS-ACCOUNT                    PIC X(10).
  2697         16  CS-CERT-EFF-DT                PIC XX.
  2698         16  CS-CERT-NO.
  2699             20  CS-CERT-PRIME             PIC X(10).
  2700             20  CS-CERT-SFX               PIC X.
  2701         16  CS-TRAILER-TYPE               PIC X.
  2702             88  COMM-TRLR           VALUE 'A'.
  2703             88  FUTURE-TRLR         VALUE 'B'.
  2704             88  CERT-DATA-TRLR      VALUE 'C'.
  2705
  2706     12  CS-DATA-AREA                      PIC X(516).
  2707
  2708     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2709         16  CS-BANK-COMMISSION-AREA.
  2710             20  CS-BANK-COMMS       OCCURS 10.
  2711                 24  CS-AGT                PIC X(10).
  2712                 24  CS-COM-TYP            PIC X.
  2713                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2714                 24  CS-RECALC-LV-INDIC    PIC X.
  2715                 24  FILLER                PIC X(10).
  2716         16  FILLER                        PIC X(256).
  2717
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  53
* EL050.cbl
  2718     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2719         16  CS-VIN-NUMBER                 PIC X(17).
  2720         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2721         16  FILLER                        PIC X(498).
  2722******************************************************************
  2723
  2724*    COPY ELCDATE.
  2725******************************************************************
  2726*                                                                *
  2727*                                                                *
  2728*                            ELCDATE.                            *
  2729*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2730*                            VMOD=2.003
  2731*                                                                *
  2732*                                                                *
  2733*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2734*                 LENGTH = 200                                   *
  2735******************************************************************
  2736
  2737 01  DATE-CONVERSION-DATA.
  2738     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2739     12  DC-OPTION-CODE                PIC X.
  2740         88  BIN-TO-GREG                VALUE ' '.
  2741         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2742         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2743         88  YMD-GREG-TO-BIN            VALUE '3'.
  2744         88  MDY-GREG-TO-BIN            VALUE '4'.
  2745         88  JULIAN-TO-BIN              VALUE '5'.
  2746         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2747         88  FIND-CENTURY               VALUE '7'.
  2748         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2749         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2750         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2751         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2752         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2753         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2754         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2755         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2756         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2757         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2758         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2759         88  BIN-3-TO-GREG              VALUE 'I'.
  2760         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2761         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2762         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2763         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2764         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2765         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2766         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2767         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2768         88  THREE-CHARACTER-BIN
  2769                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2770         88  GREGORIAN-TO-BIN
  2771                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2772         88  BIN-TO-GREGORIAN
  2773                  VALUES ' ' '1' 'I' '8' 'G'.
  2774         88  JULIAN-TO-BINARY
  2775                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  54
* EL050.cbl
  2776     12  DC-ERROR-CODE                 PIC X.
  2777         88  NO-CONVERSION-ERROR        VALUE ' '.
  2778         88  DATE-CONVERSION-ERROR
  2779                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2780         88  DATE-IS-ZERO               VALUE '1'.
  2781         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2782         88  DATE-IS-INVALID            VALUE '3'.
  2783         88  DATE1-GREATER-DATE2        VALUE '4'.
  2784         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2785         88  DATE-INVALID-OPTION        VALUE '9'.
  2786         88  INVALID-CENTURY            VALUE 'A'.
  2787         88  ONLY-CENTURY               VALUE 'B'.
  2788         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2789         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2790     12  DC-END-OF-MONTH               PIC X.
  2791         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2792     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2793         88  USE-NORMAL-PROCESS         VALUE ' '.
  2794         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2795         88  ADJUST-UP-100-YRS          VALUE '2'.
  2796     12  FILLER                        PIC X.
  2797     12  DC-CONVERSION-DATES.
  2798         16  DC-BIN-DATE-1             PIC XX.
  2799         16  DC-BIN-DATE-2             PIC XX.
  2800         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2801         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2802                       DC-GREG-DATE-1-EDIT.
  2803             20  DC-EDIT1-MONTH        PIC 99.
  2804             20  SLASH1-1              PIC X.
  2805             20  DC-EDIT1-DAY          PIC 99.
  2806             20  SLASH1-2              PIC X.
  2807             20  DC-EDIT1-YEAR         PIC 99.
  2808         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2809         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2810                     DC-GREG-DATE-2-EDIT.
  2811             20  DC-EDIT2-MONTH        PIC 99.
  2812             20  SLASH2-1              PIC X.
  2813             20  DC-EDIT2-DAY          PIC 99.
  2814             20  SLASH2-2              PIC X.
  2815             20  DC-EDIT2-YEAR         PIC 99.
  2816         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2817         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2818                     DC-GREG-DATE-1-YMD.
  2819             20  DC-YMD-YEAR           PIC 99.
  2820             20  DC-YMD-MONTH          PIC 99.
  2821             20  DC-YMD-DAY            PIC 99.
  2822         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2823         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2824                      DC-GREG-DATE-1-MDY.
  2825             20  DC-MDY-MONTH          PIC 99.
  2826             20  DC-MDY-DAY            PIC 99.
  2827             20  DC-MDY-YEAR           PIC 99.
  2828         16  DC-GREG-DATE-1-ALPHA.
  2829             20  DC-ALPHA-MONTH        PIC X(10).
  2830             20  DC-ALPHA-DAY          PIC 99.
  2831             20  FILLER                PIC XX.
  2832             20  DC-ALPHA-CENTURY.
  2833                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  55
* EL050.cbl
  2834             20  DC-ALPHA-YEAR         PIC 99.
  2835         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2836         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2837         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2838         16  DC-JULIAN-DATE            PIC 9(05).
  2839         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2840                                       PIC 9(05).
  2841         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2842             20  DC-JULIAN-YEAR        PIC 99.
  2843             20  DC-JULIAN-DAYS        PIC 999.
  2844         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2845         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2846         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2847     12  DATE-CONVERSION-VARIBLES.
  2848         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2849         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2850             20  FILLER                PIC 9(3).
  2851             20  HOLD-CEN-1-CCYY.
  2852                 24  HOLD-CEN-1-CC     PIC 99.
  2853                 24  HOLD-CEN-1-YY     PIC 99.
  2854             20  HOLD-CEN-1-MO         PIC 99.
  2855             20  HOLD-CEN-1-DA         PIC 99.
  2856         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2857             20  HOLD-CEN-1-R-MO       PIC 99.
  2858             20  HOLD-CEN-1-R-DA       PIC 99.
  2859             20  HOLD-CEN-1-R-CCYY.
  2860                 24  HOLD-CEN-1-R-CC   PIC 99.
  2861                 24  HOLD-CEN-1-R-YY   PIC 99.
  2862             20  FILLER                PIC 9(3).
  2863         16  HOLD-CENTURY-1-X.
  2864             20  FILLER                PIC X(3)  VALUE SPACES.
  2865             20  HOLD-CEN-1-X-CCYY.
  2866                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2867                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2868             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2869             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2870         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2871             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2872             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2873             20  HOLD-CEN-1-R-X-CCYY.
  2874                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2875                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2876             20  FILLER                PIC XXX.
  2877         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2878         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2879         16  DC-JULIAN-DATE-1          PIC 9(07).
  2880         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2881             20  DC-JULIAN-1-CCYY.
  2882                 24  DC-JULIAN-1-CC    PIC 99.
  2883                 24  DC-JULIAN-1-YR    PIC 99.
  2884             20  DC-JULIAN-DA-1        PIC 999.
  2885         16  DC-JULIAN-DATE-2          PIC 9(07).
  2886         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2887             20  DC-JULIAN-2-CCYY.
  2888                 24  DC-JULIAN-2-CC    PIC 99.
  2889                 24  DC-JULIAN-2-YR    PIC 99.
  2890             20  DC-JULIAN-DA-2        PIC 999.
  2891         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  56
* EL050.cbl
  2892             20  DC-EDITA-MONTH        PIC 99.
  2893             20  SLASHA-1              PIC X VALUE '/'.
  2894             20  DC-EDITA-DAY          PIC 99.
  2895             20  SLASHA-2              PIC X VALUE '/'.
  2896             20  DC-EDITA-CCYY.
  2897                 24  DC-EDITA-CENT     PIC 99.
  2898                 24  DC-EDITA-YEAR     PIC 99.
  2899         16  DC-GREG-DATE-B-EDIT.
  2900             20  DC-EDITB-MONTH        PIC 99.
  2901             20  SLASHB-1              PIC X VALUE '/'.
  2902             20  DC-EDITB-DAY          PIC 99.
  2903             20  SLASHB-2              PIC X VALUE '/'.
  2904             20  DC-EDITB-CCYY.
  2905                 24  DC-EDITB-CENT     PIC 99.
  2906                 24  DC-EDITB-YEAR     PIC 99.
  2907         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2908         16  DC-GREG-DATE-CYMD-R REDEFINES
  2909                              DC-GREG-DATE-CYMD.
  2910             20  DC-CYMD-CEN           PIC 99.
  2911             20  DC-CYMD-YEAR          PIC 99.
  2912             20  DC-CYMD-MONTH         PIC 99.
  2913             20  DC-CYMD-DAY           PIC 99.
  2914         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2915         16  DC-GREG-DATE-MDCY-R REDEFINES
  2916                              DC-GREG-DATE-MDCY.
  2917             20  DC-MDCY-MONTH         PIC 99.
  2918             20  DC-MDCY-DAY           PIC 99.
  2919             20  DC-MDCY-CEN           PIC 99.
  2920             20  DC-MDCY-YEAR          PIC 99.
  2921    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2922        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2923    12  DC-EL310-DATE                  PIC X(21).
  2924    12  FILLER                         PIC X(28).
  2925
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  57
* EL050.cbl
  2927*    COPY ELCCALC.
  2928******************************************************************
  2929*                                                                *
  2930*                           ELCCALC.                            *
  2931*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2932*                            VMOD=2.025                          *
  2933*                                                                *
  2934*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2935*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2936*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2937*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2938*                                                                *
  2939*  PASSED TO ELRTRM                                              *
  2940*  -----------------                                             *
  2941*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2942*  ORIGINAL TERM                                                 *
  2943*  BEGINNING DATE                                                *
  2944*  ENDING DATE                                                   *
  2945*  COMPANY I.D.                                                  *
  2946*  ACCOUNT MASTER USER FIELD                                     *
  2947*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2948*  FREE LOOK DAYS                                                *
  2949*                                                                *
  2950*  RETURNED FROM ELRTRM                                          *
  2951*  ---------------------                                         *
  2952*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2953*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2954*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2955*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2956*----------------------------------------------------------------*
  2957*  PASSED TO ELRAMT                                              *
  2958*  ----------------                                              *
  2959*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2960*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2961*  ORIGINAL AMOUNT                                               *
  2962*  ALTERNATE BENEFIT (BALLON)                                    *
  2963*  A.P.R. - NET PAY ONLY                                         *
  2964*  METHOD
  2965*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2966*  COMPANY I.D.                                                  *
  2967*  BENEFIT TYPE                                                  *
  2968*                                                                *
  2969*  RETURNED FROM ELRAMT                                          *
  2970*  --------------------                                          *
  2971*  REMAINING AMOUNT 1 - CURRENT                                  *
  2972*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2973*  REMAINING AMOUNT FACTOR
  2974*----------------------------------------------------------------*
  2975*  PASSED TO ELRESV                                              *
  2976*  -----------------                                             *
  2977*  CERTIFICATE EFFECTIVE DATE                                    *
  2978*  VALUATION DATE                                                *
  2979*  PAID THRU DATE                                                *
  2980*  BENEFIT                                                       *
  2981*  INCURRED DATE                                                 *
  2982*  REPORTED DATE                                                 *
  2983*  ISSUE AGE                                                     *
  2984*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  58
* EL050.cbl
  2985*  CDT PERCENT                                                   *
  2986*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2987* *CLAIM TYPE (LIFE, A/H)                                        *
  2988* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2989* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2990*                                                                *
  2991*  RETURNED FROM ELRESV                                          *
  2992*  --------------------                                          *
  2993*  CDT TABLE USED                                                *
  2994*  CDT FACTOR USED                                               *
  2995*  PAY TO CURRENT RESERVE                                        *
  2996*  I.B.N.R. - A/H ONLY                                           *
  2997*  FUTURE (ACCRUED) AH ONLY                                      *
  2998*----------------------------------------------------------------*
  2999*  PASSED TO ELRATE                                              *
  3000*  ----------------                                              *
  3001*  CERT ISSUE DATE                                               *
  3002*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3003*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3004*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3005*  STATE CODE (CLIENT DEFINED)                                   *
  3006*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3007*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3008*  DEVIATION CODE                                                *
  3009*  ISSUE AGE                                                     *
  3010*  ORIGINAL BENEFIT AMOUNT                                       *
  3011*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3012*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3013*  BENEFIT KIND (LIFE OR A/H)                                    *
  3014*  A.P.R.                                                        *
  3015*  METHOD
  3016*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3017*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3018*  COMPANY I.D. (3 CHARACTER)                                    *
  3019*  BENEFIT CODE                                                  *
  3020*  BENEFIT OVERRIDE CODE                                         *
  3021*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3022*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3023*  JOINT INDICATOR (CSL ONLY)                                    *
  3024*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3025*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3026*                                                                *
  3027*  RETURNED FROM ELRATE                                          *
  3028*  --------------------                                          *
  3029*  CALCULATED PREMIUM                                            *
  3030*  PREMIUM RATE                                                  *
  3031*  MORTALITY CODE                                                *
  3032*  MAX ATTAINED AGE                                              *
  3033*  MAX AGE                                                       *
  3034*  MAX TERM                                                      *
  3035*  MAX MONTHLY BENEFIT                                           *
  3036*  MAX TOTAL BENIFIT                                             *
  3037*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3038*----------------------------------------------------------------*
  3039*  PASSED TO ELRFND                                              *
  3040*  ----------------                                              *
  3041*  CERT ISSUE DATE                                               *
  3042*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  59
* EL050.cbl
  3043*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3044*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3045*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3046*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3047*  STATE CODE (CLIENT DEFINED)                                   *
  3048*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3049*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3050*  DEVIATION CODE                                                *
  3051*  ISSUE AGE                                                     *
  3052*  ORIGINAL BENEFIT AMOUNT                                       *
  3053*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3054*  PROCESS TYPE (CANCEL)                                         *
  3055*  BENEFIT KIND (LIFE OR A/H)                                    *
  3056*  A.P.R.                                                        *
  3057*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3058*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3059*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3060*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3061*  COMPANY I.D. (3 CHARACTER)                                    *
  3062*  BENEFIT CODE                                                  *
  3063*  BENEFIT OVERRIDE CODE                                         *
  3064*                                                                *
  3065*  RETURNED FROM ELRFND                                          *
  3066*  --------------------                                          *
  3067*  CALCULATED REFUND                                             *
  3068*----------------------------------------------------------------*
  3069*  PASSED TO ELEARN                                              *
  3070*  ----------------                                              *
  3071*  CERT ISSUE DATE                                               *
  3072*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3073*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3074*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3075*  STATE CODE (CLIENT DEFINED)                                   *
  3076*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3077*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3078*  DEVIATION CODE                                                *
  3079*  ISSUE AGE                                                     *
  3080*  ORIGINAL BENEFIT AMOUNT                                       *
  3081*  BENEFIT KIND (LIFE OR A/H)                                    *
  3082*  A.P.R.                                                        *
  3083*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3084*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3085*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3086*  COMPANY I.D. (3 CHARACTER)                                    *
  3087*  BENEFIT CODE                                                  *
  3088*  BENEFIT OVERRIDE CODE                                         *
  3089*                                                                *
  3090*  RETURNED FROM ELEARN                                          *
  3091*  --------------------                                          *
  3092*  INDICATED  EARNINGS                                           *
  3093*----------------------------------------------------------------*
  3094*                 LENGTH = 450                                   *
  3095*                                                                *
  3096******************************************************************
  3097******************************************************************
  3098*                   C H A N G E   L O G
  3099*
  3100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  60
* EL050.cbl
  3101*-----------------------------------------------------------------
  3102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3103* EFFECTIVE    NUMBER
  3104*-----------------------------------------------------------------
  3105* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3106* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3107* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3108* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3109* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3110* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3111* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3112******************************************************************
  3113
  3114 01  CALCULATION-PASS-AREA.
  3115     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3116                                     COMP.
  3117
  3118     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3119       88  NO-CP-ERROR                             VALUE ZERO.
  3120       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3121                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3122       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3123       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3124       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3125       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3126       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3127       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3128       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3129       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3130       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3131       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3132       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3133       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3134       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3135       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3136       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3137       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3138       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3139
  3140     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3141       88  NO-CP-ERROR-2                           VALUE ZERO.
  3142***********************  INPUT AREAS ****************************
  3143
  3144     12  CP-CALCULATION-AREA.
  3145         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3146         16  CP-CERT-EFF-DT        PIC XX.
  3147         16  CP-VALUATION-DT       PIC XX.
  3148         16  CP-PAID-THRU-DT       PIC XX.
  3149         16  CP-BENEFIT-TYPE       PIC X.
  3150           88  CP-AH                               VALUE 'A' 'D'
  3151                                                   'I' 'U'.
  3152           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3153           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3154         16  CP-INCURRED-DT        PIC XX.
  3155         16  CP-REPORTED-DT        PIC XX.
  3156         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3157         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3158         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  61
* EL050.cbl
  3159                                     COMP-3.
  3160         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3161                                     COMP-3.
  3162         16  CP-CDT-METHOD         PIC X.
  3163           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3164           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3165           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3166         16  CP-CLAIM-TYPE         PIC X.
  3167           88  CP-AH-CLAIM                         VALUE 'A'.
  3168           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3169         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3170                                     COMP-3.
  3171         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3172                                     COMP-3.
  3173         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3174                                     COMP-3.
  3175         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3176                                     COMP-3.
  3177         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3178                                     COMP-3.
  3179         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3180                                     COMP-3.
  3181         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3182                                     COMP-3.
  3183         16  CP-REM-TERM-METHOD    PIC X.
  3184           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3185           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3186           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3187           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3188           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3189           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3190           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3191         16  CP-EARNING-METHOD     PIC X.
  3192           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3193           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3194           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3195           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3196           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3197           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3198           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3199           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3200           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3201           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3202           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3203           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3204         16  CP-PROCESS-TYPE       PIC X.
  3205           88  CP-CLAIM                            VALUE '1'.
  3206           88  CP-CANCEL                           VALUE '2'.
  3207           88  CP-ISSUE                            VALUE '3'.
  3208         16  CP-SPECIAL-CALC-CD    PIC X.
  3209           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3210           88  CP-1-MTH-INTEREST               VALUE ' '.
  3211           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3212           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3213           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3214           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3215           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3216           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  62
* EL050.cbl
  3217           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3218           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3219           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3220           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3221           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3222           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3223           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3224           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3225           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3226           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3227                                                     'W' 'X'.
  3228           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3229           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3230           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3231           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3232           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3233           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3234           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3235           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3236           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3237           88  CP-CSL-METH-1                   VALUE '5'.
  3238           88  CP-CSL-METH-2                   VALUE '6'.
  3239           88  CP-CSL-METH-3                   VALUE '7'.
  3240           88  CP-CSL-METH-4                   VALUE '8'.
  3241
  3242         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3243                                     COMP-3.
  3244         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3245         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3246         16  CP-STATE              PIC XX          VALUE SPACE.
  3247         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3248         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3249           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3250               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3251         16  CP-R78-OPTION         PIC X.
  3252           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3253           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3254
  3255         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3256         16  CP-IBNR-RESERVE-SW    PIC X.
  3257         16  CP-CLAIM-STATUS       PIC X.
  3258         16  CP-RATE-FILE          PIC X.
  3259         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3260                                     COMP-3.
  3261
  3262         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3263         16  CP-AH-OVERRIDE-CODE   PIC X.
  3264
  3265         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3266                                     COMP-3.
  3267         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3268                                     COMP-3.
  3269         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3270                                     COMP-3.
  3271         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3272                                     COMP-3.
  3273
  3274         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  63
* EL050.cbl
  3275         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3276         16  CP-EXT-DAYS-CALC      PIC X.
  3277           88  CP-EXT-NO-CHG                   VALUE ' '.
  3278           88  CP-EXT-CHG-LF                   VALUE '1'.
  3279           88  CP-EXT-CHG-AH                   VALUE '2'.
  3280           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3281         16  CP-DOMICILE-STATE     PIC XX.
  3282         16  CP-CARRIER            PIC X.
  3283         16  CP-REIN-FLAG          PIC X.
  3284         16  CP-REM-TRM-CALC-OPTION PIC X.
  3285           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3286                      '2' '3' '4' '5'.
  3287           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3288           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3289           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3290           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3291           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3292           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3293           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3294           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3295         16  CP-SIG-SWITCH         PIC X.
  3296         16  CP-RATING-METHOD      PIC X.
  3297           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3298           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3299           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3300           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3301           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3302           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3303           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3304           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3305           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3306         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3307                                     COMP-3.
  3308         16  CP-BEN-CATEGORY       PIC X.
  3309         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3310         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3311                                   PIC S99V9(5) COMP-3.
  3312         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3313         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3314                                   PIC S99V9(5) COMP-3.
  3315         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3316         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3317         16  CP-EXPIRE-DT          PIC XX.
  3318         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3319         16  FILLER                PIC X(35).
  3320*        16  FILLER                PIC X(50).
  3321
  3322***************    OUTPUT FROM ELRESV   ************************
  3323
  3324         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3325
  3326         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3327                                     COMP-3.
  3328         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3329                                     COMP-3.
  3330         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3331                                     COMP-3.
  3332         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  64
* EL050.cbl
  3333                                     COMP-3.
  3334         16  FILLER                PIC X(09).
  3335***************    OUTPUT FROM ELRTRM   *************************
  3336
  3337         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3338                                     COMP-3.
  3339         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3340                                     COMP-3.
  3341         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3342                                     COMP-3.
  3343         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3344                                     COMP-3.
  3345         16  FILLER                PIC X(12).
  3346
  3347***************    OUTPUT FROM ELRAMT   *************************
  3348
  3349         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3350                                     COMP-3.
  3351         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3352                                     COMP-3.
  3353         16  FILLER                PIC X(12).
  3354
  3355***************    OUTPUT FROM ELRATE   *************************
  3356
  3357         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3358                                     COMP-3.
  3359         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3360                                     COMP-3.
  3361         16  CP-MORTALITY-CODE     PIC X(4).
  3362         16  CP-RATE-EDIT-FLAG     PIC X.
  3363             88  CP-RATES-NEED-APR                  VALUE '1'.
  3364         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3365                                     COMP-3.
  3366         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3367         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3368         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3369                                   PIC S9(7)V99 COMP-3.
  3370         16  FILLER                PIC X(07).
  3371
  3372***************    OUTPUT FROM ELRFND   *************************
  3373
  3374         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3375                                     COMP-3.
  3376         16  CP-REFUND-TYPE-USED   PIC X.
  3377           88  CP-R-AS-R78                         VALUE '1'.
  3378           88  CP-R-AS-PRORATA                     VALUE '2'.
  3379           88  CP-R-AS-CALIF                       VALUE '3'.
  3380           88  CP-R-AS-TEXAS                       VALUE '4'.
  3381           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3382           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3383           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3384           88  CP-R-AS-MEAN                        VALUE '8'.
  3385           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3386           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3387           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3388         16  FILLER                PIC X(12).
  3389
  3390***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  65
* EL050.cbl
  3391
  3392         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3393                                     COMP-3.
  3394         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3395                                     COMP-3.
  3396         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3397                                     COMP-3.
  3398         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3399                                     COMP-3.
  3400         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3401                                     COMP-3.
  3402         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3403                                     COMP-3.
  3404         16  CP-EARNING-TYPE-USED  PIC X.
  3405           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3406           88  CP-E-AS-R78                         VALUE '1'.
  3407           88  CP-E-AS-PRORATA                     VALUE '2'.
  3408           88  CP-E-AS-TEXAS                       VALUE '4'.
  3409           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3410           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3411           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3412           88  CP-E-AS-MEAN                        VALUE '8'.
  3413           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3414         16  FILLER                PIC X(12).
  3415
  3416***************    OUTPUT FROM ELPMNT   *************************
  3417
  3418         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3419                                     COMP-3.
  3420         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3421                                     COMP-3.
  3422         16  FILLER                PIC X(12).
  3423
  3424***************   MISC WORK AREAS    *****************************
  3425         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3426                                     COMP-3.
  3427         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3428                                     COMP-3.
  3429         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3430                                     COMP-3.
  3431         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3432                                     COMP-3.
  3433         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3434                                     COMP-3.
  3435         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3436                                     COMP-3.
  3437         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3438             88  OPEN-RATE-FILE                   VALUE 'O'.
  3439             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3440             88  IO-ERROR                         VALUE 'E'.
  3441
  3442         16  CP-FIRST-PAY-DATE     PIC XX.
  3443
  3444         16  CP-JOINT-INDICATOR    PIC X.
  3445
  3446         16  CP-RESERVE-REMAINING-TERM
  3447                                   PIC S9(4)V9    VALUE ZERO
  3448                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  66
* EL050.cbl
  3449
  3450         16  CP-INSURED-BIRTH-DT   PIC XX.
  3451
  3452         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3453                                     COMP-3.
  3454
  3455         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3456                                     COMP-3.
  3457
  3458         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3459                                     COMP-3.
  3460
  3461         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3462                                     COMP-3.
  3463
  3464         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3465                                     COMP-3.
  3466
  3467         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3468                                     COMP-3.
  3469
  3470         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3471                                     COMP-3.
  3472
  3473         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3474             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3475
  3476         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3479                                     COMP-3.
  3480         16  FILLER                PIC X(17).
  3481******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  67
* EL050.cbl
  3483******************************************************************
  3484*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3485*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3486*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3487*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3488*** MODIFICATION.                                              ***
  3489*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3490*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3491******************************************************************
  3492*    COPY ERCPNDB.
  3493******************************************************************
  3494*                                                                *
  3495*                                                                *
  3496*                            ERCPNDB.                            *
  3497*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3498*                            VMOD=2.025                          *
  3499*                                                                *
  3500*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3501*                                                                *
  3502******************************************************************
  3503*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3504*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3505******************************************************************
  3506*                                                                *
  3507*                                                                *
  3508*   FILE TYPE = VSAM,KSDS                                        *
  3509*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3510*                                                                *
  3511*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3512*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3513*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3514*                                                 RKP=13,LEN=36  *
  3515*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3516*                                      AND CHG-SEQ.)             *
  3517*                                                RKP=49,LEN=11   *
  3518*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3519*                                      AND CHG-SEQ.)             *
  3520*                                                RKP=60,LEN=15   *
  3521*                                                                *
  3522*   LOG = NO                                                     *
  3523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3524******************************************************************
  3525******************************************************************
  3526*                   C H A N G E   L O G
  3527*
  3528* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3529*-----------------------------------------------------------------
  3530*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3531* EFFECTIVE    NUMBER
  3532*-----------------------------------------------------------------
  3533* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3534* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3535* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3536* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3537* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3538* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3539* 032306                   PEMA  ADD BOW LOAN NUMBER
  3540* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  68
* EL050.cbl
  3541* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3542* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3543* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3544* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3545* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3546* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3547******************************************************************
  3548
  3549 01  PENDING-BUSINESS.
  3550     12  PB-RECORD-ID                     PIC XX.
  3551         88  VALID-PB-ID                        VALUE 'PB'.
  3552
  3553     12  PB-CONTROL-PRIMARY.
  3554         16  PB-COMPANY-CD                PIC X.
  3555         16  PB-ENTRY-BATCH               PIC X(6).
  3556         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3557         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3558
  3559     12  PB-CONTROL-BY-ACCOUNT.
  3560         16  PB-COMPANY-CD-A1             PIC X.
  3561         16  PB-CARRIER                   PIC X.
  3562         16  PB-GROUPING.
  3563             20  PB-GROUPING-PREFIX       PIC XXX.
  3564             20  PB-GROUPING-PRIME        PIC XXX.
  3565         16  PB-STATE                     PIC XX.
  3566         16  PB-ACCOUNT.
  3567             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3568             20  PB-ACCOUNT-PRIME         PIC X(6).
  3569         16  PB-CERT-EFF-DT               PIC XX.
  3570         16  PB-CERT-NO.
  3571             20  PB-CERT-PRIME            PIC X(10).
  3572             20  PB-CERT-SFX              PIC X.
  3573         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3574
  3575         16  PB-RECORD-TYPE               PIC X.
  3576             88  PB-MAILING-DATA                VALUE '0'.
  3577             88  PB-ISSUE                       VALUE '1'.
  3578             88  PB-CANCELLATION                VALUE '2'.
  3579             88  PB-BATCH-TRAILER               VALUE '9'.
  3580
  3581     12  PB-CONTROL-BY-ORIG-BATCH.
  3582         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3583         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3584         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3585         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3586
  3587     12  PB-CONTROL-BY-CSR.
  3588         16  PB-CSR-COMPANY-CD            PIC X.
  3589         16  PB-CSR-ID                    PIC X(4).
  3590         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3591         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3592         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3593******************************************************************
  3594*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3595******************************************************************
  3596
  3597     12  PB-LAST-MAINT-DT                 PIC XX.
  3598     12  PB-LAST-MAINT-BY                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  69
* EL050.cbl
  3599     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3600
  3601     12  PB-RECORD-BODY                   PIC X(375).
  3602
  3603     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3604         16  PB-CERT-ORIGIN               PIC X.
  3605             88  CLASIC-CREATED-CERT         VALUE '1'.
  3606         16  PB-I-NAME.
  3607             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3608             20  PB-I-INSURED-FIRST-NAME.
  3609                 24  PB-I-INSURED-1ST-INIT PIC X.
  3610                 24  FILLER                PIC X(9).
  3611             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3612         16  PB-I-AGE                     PIC S99   COMP-3.
  3613         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3614         16  PB-I-BIRTHDAY                PIC XX.
  3615         16  PB-I-INSURED-SEX             PIC X.
  3616             88  PB-SEX-MALE     VALUE 'M'.
  3617             88  PB-SEX-FEMALE   VALUE 'F'.
  3618
  3619         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3620         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3621         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3622         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3623         16  PB-I-SKIP-CODE               PIC X.
  3624             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3625             88  PB-SKIP-JULY              VALUE '1'.
  3626             88  PB-SKIP-AUGUST            VALUE '2'.
  3627             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3628             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3629             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3630             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3631             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3632             88  PB-SKIP-JUNE              VALUE '8'.
  3633             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3634             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3635             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3636         16  PB-I-TERM-TYPE               PIC X.
  3637             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3638             88  PB-PAID-WEEKLY            VALUE 'W'.
  3639             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3640             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3641             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3642         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3643         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3644         16  PB-I-DATA-ENTRY-SW           PIC X.
  3645             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3646             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3647             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3648             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3649         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3650         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3651*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3652         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3653         16  FILLER                       PIC X.
  3654
  3655         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3656             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  70
* EL050.cbl
  3657             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3658                                                   '90' THRU '99'.
  3659         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3660                                          PIC XX.
  3661         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3662         16  PB-I-AMOUNT-FINANCED REDEFINES
  3663                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3664         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3665         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3666                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3667         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3668         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3669         16  PB-I-CLP-AMOUNT REDEFINES
  3670                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3671         16  PB-I-LF-CALC-FLAG            PIC X.
  3672             88 PB-COMP-LF-PREM               VALUE '?'.
  3673         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3674         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3675         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3676         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3677         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3678         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3679         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3680         16  PB-I-LF-ABBR                 PIC XXX.
  3681         16  PB-I-LF-INPUT-CD             PIC XX.
  3682
  3683         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3684             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3685             88  PB-INVALID-AH               VALUE '  ' '00'
  3686                                                   '90' THRU '99'.
  3687         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3688         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3689         16  PB-I-AH-CALC-FLAG            PIC X.
  3690             88 PB-COMP-AH-PREM                  VALUE '?'.
  3691         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3692         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3693         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3694         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3695         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3696         16  PB-I-AH-ABBR                 PIC XXX.
  3697         16  PB-I-AH-INPUT-CD             PIC XXX.
  3698
  3699         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3700         16  PB-I-REIN-TABLE              PIC XXX.
  3701         16  PB-I-BUSINESS-TYPE           PIC 99.
  3702         16  PB-I-INDV-GRP-CD             PIC X.
  3703         16  PB-I-MORT-CODE.
  3704             20  PB-I-TABLE               PIC X.
  3705             20  PB-I-INTEREST            PIC XX.
  3706             20  PB-I-MORT-TYP            PIC X.
  3707         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3708         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3709         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3710         16  PB-I-INDV-GRP-OVRD           PIC X.
  3711         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3712         16  PB-I-SIG-SW                  PIC X.
  3713             88  PB-POLICY-SIGNED             VALUE 'Y'.
  3714         16  PB-I-RATE-CLASS              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  71
* EL050.cbl
  3715         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3716         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3717         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3718         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3719         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3720         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3721         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3722         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3723         16  PB-I-OB-FLAG                 PIC X.
  3724             88  PB-I-OB                      VALUE 'B'.
  3725             88  PB-I-SUMMARY                 VALUE 'Z'.
  3726         16  PB-I-ENTRY-STATUS            PIC X.
  3727             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3728                                              'M' '5' '9' '2'.
  3729             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3730             88  PB-I-POLICY-PENDING          VALUE '2'.
  3731             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3732             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3733             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3734             88  PB-I-REIN-ONLY               VALUE '9'.
  3735             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3736             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3737             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3738             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3739         16  PB-I-INT-CODE                PIC X.
  3740             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3741             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3742         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3743         16  PB-I-SOC-SEC-NO              PIC X(11).
  3744         16  PB-I-MEMBER-NO               PIC X(12).
  3745         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3746*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3747         16  PB-I-OLD-LOF                 PIC XXX.
  3748         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3749         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3750         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3751         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3752         16  PB-I-LIFE-INDICATOR          PIC X.
  3753             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3754         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3755         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3756             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3757             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3758         16  PB-I-1ST-PMT-DT              PIC XX.
  3759         16  PB-I-JOINT-INSURED.
  3760             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3761             20 PB-I-JOINT-FIRST-NAME.
  3762                24  PB-I-JOINT-FIRST-INIT PIC X.
  3763                24  FILLER                PIC X(9).
  3764             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3765*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3766         16  PB-I-BENEFICIARY-NAME.
  3767             20  PB-I-BANK-NUMBER         PIC X(10).
  3768             20  FILLER                   PIC X(15).
  3769         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  3770         16  PB-I-REFERENCE               PIC X(12).
  3771         16  FILLER REDEFINES PB-I-REFERENCE.
  3772             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  72
* EL050.cbl
  3773             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3774             20  PB-I-CLP-STATE           PIC XX.
  3775         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3776             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3777             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3778             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3779         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3780         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3781         16  PB-I-RESIDENT-STATE          PIC XX.
  3782         16  PB-I-RATE-CODE               PIC X(4).
  3783         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3784         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3785         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3786         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3787         16  PB-I-BANK-NOCHRGB            PIC 99.
  3788         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3789         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3790
  3791     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3792         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3793             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3794         16  PB-C-CANCEL-ORIGIN           PIC X.
  3795             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3796         16  PB-C-LF-CANCEL-DT            PIC XX.
  3797         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3798         16  PB-C-LF-CALC-REQ             PIC X.
  3799             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3800         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3801         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3802         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3803             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3804         16  PB-C-AH-CANCEL-DT            PIC XX.
  3805         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3806         16  PB-C-AH-CALC-REQ             PIC X.
  3807             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3808         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3809         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  3810         16  PB-C-LAST-NAME               PIC X(15).
  3811         16  PB-C-REFUND-SW               PIC X.
  3812             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  3813             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  3814         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  3815         16  PB-C-PAYEE-CODE              PIC X(6).
  3816         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  3817         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  3818         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  3819         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  3820         16  PB-C-REFERENCE               PIC X(12).
  3821         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3822         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3823         16  PB-C-POST-CARD-IND           PIC X.
  3824         16  PB-C-CANCEL-REASON           PIC X.
  3825         16  PB-C-REF-INTERFACE-SW        PIC X.
  3826         16  FILLER                       PIC X(09).
  3827*        16  FILLER                       PIC X(18).
  3828         16  PB-C-POLICY-FORM-NO          PIC X(12).
  3829*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  3830         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  73
* EL050.cbl
  3831         16  PB-CANCELED-CERT-DATA.
  3832             20  PB-CI-INSURED-NAME.
  3833                 24  PB-CI-LAST-NAME      PIC X(15).
  3834                 24  PB-CI-INITIALS       PIC XX.
  3835             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  3836             20  PB-CI-INSURED-SEX        PIC X.
  3837             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  3838             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  3839             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  3840             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  3841             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3842             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  3843             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  3844             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  3845             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  3846             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3847             20  PB-CI-RATE-CLASS         PIC XX.
  3848             20  PB-CI-RATE-DEV-LF        PIC XXX.
  3849             20  PB-CI-RATE-DEV-AH        PIC XXX.
  3850             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  3851             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  3852             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  3853             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  3854             20  PB-CI-LF-ABBR            PIC X(3).
  3855             20  PB-CI-AH-ABBR            PIC X(3).
  3856             20  PB-CI-OB-FLAG            PIC X.
  3857                 88  PB-CI-OB                VALUE 'B'.
  3858             20  PB-CI-LF-POLICY-STATUS   PIC X.
  3859                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  3860                                           'M' '4' '5' '9' '2'.
  3861                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  3862                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  3863                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  3864                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  3865                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  3866                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3867                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  3868                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3869                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  3870                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  3871                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  3872                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  3873             20  PB-CI-AH-POLICY-STATUS   PIC X.
  3874                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  3875                                           'M' '4' '5' '9' '2'.
  3876                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  3877                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  3878                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  3879                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  3880                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  3881                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3882                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  3883                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3884                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  3885                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  3886                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  3887                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  3888             20  PB-CI-PAY-FREQUENCY      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  74
* EL050.cbl
  3889             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  3890             20  PB-CI-SOC-SEC-NO         PIC X(11).
  3891             20  PB-CI-MEMBER-NO          PIC X(12).
  3892             20  PB-CI-INT-CODE           PIC X.
  3893                 88  PB-CI-ADD-ON                  VALUE 'A'.
  3894                 88  PB-CI-SIMPLE                  VALUE 'S'.
  3895             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  3896             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  3897             20  PB-CI-COMP-EXCP-SW       PIC X.
  3898                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  3899                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  3900             20  PB-CI-ENTRY-STATUS       PIC X.
  3901             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  3902             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  3903             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  3904             20  PB-CI-DEATH-DT           PIC XX.
  3905             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  3906             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  3907             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3908             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3909             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  3910             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  3911             20  PB-CI-ENTRY-DT              PIC XX.
  3912             20  PB-CI-ENTRY-BATCH           PIC X(6).
  3913             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  3914             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  3915             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  3916             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  3917             20  PB-CI-OLD-LOF               PIC XXX.
  3918*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  3919             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  3920             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  3921             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  3922             20  PB-CI-INDV-GRP-CD           PIC X.
  3923             20  PB-CI-BENEFICIARY-NAME.
  3924                 24  PB-CI-BANK-NUMBER       PIC X(10).
  3925                 24  FILLER                  PIC X(15).
  3926             20  PB-CI-NOTE-SW               PIC X.
  3927             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  3928             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  3929             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  3930             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  3931             20  PB-CI-LOAN-OFFICER          PIC X(5).
  3932             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  3933             20  PB-CI-FIRST-NAME            PIC X(10).
  3934
  3935         16  FILLER                       PIC X(17).
  3936*032306  16  FILLER                       PIC X(27).
  3937*        16  FILLER                       PIC X(46).
  3938
  3939     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  3940         16  FILLER                       PIC X(10).
  3941         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  3942         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  3943         16  PB-M-INSURED-MID-INIT        PIC X.
  3944         16  PB-M-INSURED-AGE             PIC 99.
  3945         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  3946         16  PB-M-INSURED-SEX             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  75
* EL050.cbl
  3947         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  3948         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  3949         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  3950         16  PB-M-INSURED-CITY-STATE.
  3951             20  PB-M-INSURED-CITY        PIC X(28).
  3952             20  PB-M-INSURED-STATE       PIC XX.
  3953         16  PB-M-INSURED-ZIP-CODE.
  3954             20  PB-M-INSURED-ZIP-PRIME.
  3955                 24  PB-M-INSURED-ZIP-1   PIC X.
  3956                     88  PB-M-CANADIAN-POST-CODE
  3957                                             VALUE 'A' THRU 'Z'.
  3958                 24  FILLER               PIC X(4).
  3959             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  3960         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  3961                                        PB-M-INSURED-ZIP-CODE.
  3962             20  PM-M-INS-CAN-POST1       PIC XXX.
  3963             20  PM-M-INS-CAN-POST2       PIC XXX.
  3964             20  FILLER                   PIC XXX.
  3965         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  3966         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  3967         16  PB-M-CRED-BENE-NAME          PIC X(30).
  3968         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  3969         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  3970         16  PB-M-CRED-BENE-CITYST.
  3971             20  PB-M-CRED-BENE-CITY      PIC X(28).
  3972             20  PB-M-CRED-BENE-STATE     PIC XX.
  3973         16  FILLER                       PIC X(92).
  3974
  3975     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  3976         16  FILLER                       PIC X(10).
  3977         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3978         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3979         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3980         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3981         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3982         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3983         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3984         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3985         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3986         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3987         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3988         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3989         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  3990         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  3991         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  3992         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  3993         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  3994         16  PB-ACCOUNT-NAME              PIC X(30).
  3995         16  PB-PREM-REF-RPT-FLAG         PIC X.
  3996         16  PB-REFERENCE                 PIC X(12).
  3997         16  PB-B-RECEIVED-DT             PIC XX.
  3998         16  FILLER                       PIC X(234).
  3999
  4000     12  PB-RECORD-STATUS.
  4001         16  PB-CREDIT-SELECT-DT          PIC XX.
  4002         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4003         16  PB-BILLED-DT                 PIC XX.
  4004         16  PB-BILLING-STATUS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  76
* EL050.cbl
  4005             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4006             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4007             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4008         16  PB-RECORD-BILL               PIC X.
  4009             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4010             88  PB-RECORD-RETURNED           VALUE 'R'.
  4011             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4012             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4013             88  PB-OVERRIDE-AH               VALUE 'A'.
  4014             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4015         16  PB-BATCH-ENTRY               PIC X.
  4016             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4017             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4018             88  PB-REISSUED-CERT             VALUE 'E'.
  4019             88  PB-MONTHLY-CERT              VALUE 'M'.
  4020             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4021             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4022             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4023         16  PB-FORCE-CODE                PIC X.
  4024             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4025             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4026             88  PB-CANCEL-FORCE              VALUE '8'.
  4027             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4028             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4029             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4030             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4031             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4032             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4033             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4034         16  PB-FATAL-FLAG                PIC X.
  4035             88  PB-FATAL-ERRORS              VALUE 'X'.
  4036         16  PB-FORCE-ER-CD               PIC X.
  4037             88  PB-FORCE-ERRORS              VALUE 'F'.
  4038             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4039         16  PB-WARN-ER-CD                PIC X.
  4040             88  PB-WARNING-ERRORS            VALUE 'W'.
  4041         16  FILLER                       PIC X.
  4042         16  PB-OUT-BAL-CD                PIC X.
  4043             88  PB-OUT-OF-BAL                VALUE 'O'.
  4044         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4045         16  PB-AH-OVERRIDE-L1            PIC X.
  4046         16  PB-INPUT-DT                  PIC XX.
  4047         16  PB-INPUT-BY                  PIC X(4).
  4048         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4049         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4050         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4051         16  PB-LF-EARNING-METHOD         PIC X.
  4052         16  PB-AH-EARNING-METHOD         PIC X.
  4053         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4054         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4055         16  PB-REIN-CD                   PIC XXX.
  4056         16  PB-LF-REFUND-TYPE            PIC X.
  4057         16  PB-AH-REFUND-TYPE            PIC X.
  4058         16  PB-ACCT-EFF-DT               PIC XX.
  4059         16  PB-ACCT-EXP-DT               PIC XX.
  4060         16  PB-COMPANY-ID                PIC X(3).
  4061         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4062         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  77
* EL050.cbl
  4063         16  PB-SV-CARRIER                PIC X.
  4064         16  PB-SV-GROUPING               PIC X(6).
  4065         16  PB-SV-STATE                  PIC XX.
  4066         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4067         16  PB-GA-BILLING-INFO.
  4068             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4069                                          PIC XX.
  4070         16  PB-SV-REMIT-TO  REDEFINES
  4071             PB-GA-BILLING-INFO           PIC X(10).
  4072         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4073         16  PB-I-LOAN-OFFICER            PIC X(5).
  4074         16  PB-I-VIN                     PIC X(17).
  4075
  4076         16  FILLER                       PIC X(04).
  4077         16  IMNET-BYPASS-SW              PIC X.
  4078
  4079******************************************************************
  4080*                COMMON EDIT ERRORS                              *
  4081******************************************************************
  4082
  4083     12  PB-COMMON-ERRORS.
  4084         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4085                                           PIC S9(4)     COMP.
  4086
  4087******************************************************************
  4088
  4089* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4090*    COPY ELC50W1.
  4091******************************************************************
  4092*                                                                *
  4093*                                                                *
  4094*                             ELC50W1                            *
  4095*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4096*                            VMOD=2.004                          *
  4097*                                                                *
  4098*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4099*                                                                *
  4100*                                                                *
  4101******************************************************************
  4102
  4103     12  WK-WORK-AREA.
  4104         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4105         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4106         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4107         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4108         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4109         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4110         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4111         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4112         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4113         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4114         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4115         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4116         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4117         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4118         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4119         16  WK-CREDIT-EDIT-CONTROLS.
  4120             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  78
* EL050.cbl
  4121             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4122             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4123             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4124             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4125             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4126         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4127         16  WK-SAVE-REIN-DATA.
  4128             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4129             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4130             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4131         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4132             88  ENTRY-FROM-EL6311       VALUE '6'.
  4133         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4134         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4135     12  WK-RECORD-ADDRESSES.
  4136         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4137         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4138         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4139         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4140         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4141         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4142         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4143         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4144     12  WK-OVER-SHORT-AREA.
  4145         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4146         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4147         16  FILLER                   PIC X(6) VALUE SPACES.
  4148
  4149*    COPY ELCEDITC.
  4150******************************************************************
  4151*                                                                *
  4152*                                                                *
  4153*                            ELCEDITC                            *
  4154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4155*                            VMOD=2.012                          *
  4156*                                                                *
  4157*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4158*                     EL6313, EL050 AND EL517.                   *
  4159*                                                                *
  4160******************************************************************
  4161******************************************************************
  4162*                   C H A N G E   L O G
  4163*
  4164* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4165*-----------------------------------------------------------------
  4166*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4167* EFFECTIVE    NUMBER
  4168*-----------------------------------------------------------------
  4169* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4170******************************************************************
  4171
  4172     12  EDIT-CRITERIA-DATA.
  4173         16  EC-CO-MONTH-END-DT       PIC XX.
  4174         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4175         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4176         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4177         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4178         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  79
* EL050.cbl
  4179         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4180         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4181         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4182         16  EC-CO-REM-TERM-CALC      PIC X.
  4183               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4184               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4185               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4186               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4187
  4188         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4189               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4190               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4191               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4192               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4193               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4194               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4195               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4196               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4197               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4198               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4199
  4200         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4201               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4202               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4203               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4204               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4205               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4206               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4207               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4208               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4209
  4210         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4211                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4212                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4213
  4214         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4215                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4216                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4217                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4218                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4219                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4220                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4221                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4222                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4223
  4224         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4225               88  EC-BR-REDUCING                   VALUE 'R'.
  4226               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4227
  4228         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4229         16  EC-BR-LF-DESC             PIC X(10).
  4230         16  EC-BR-AH-DESC             PIC X(10).
  4231         16  EC-BR-LF-COMMENT          PIC X(10).
  4232         16  EC-BR-AH-COMMENT          PIC X(10).
  4233
  4234         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4235               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4236               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  80
* EL050.cbl
  4237               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4238               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4239
  4240         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4241               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4242               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4243               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4244               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4245
  4246         16  EC-BR-LF-REFUND-CALC      PIC X.
  4247                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4248                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4249                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4250                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4251                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4252                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4253                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4254
  4255         16  EC-BR-AH-REFUND-CALC      PIC X.
  4256                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4257                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4258                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4259                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4260                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4261                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4262                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4263                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4264
  4265         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4266                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4267                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4268                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4269
  4270         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4271                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4272                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4273                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4274
  4275         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4276         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4277         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4278         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4279
  4280         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4281         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4282                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4283                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4284                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4285                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4286
  4287         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4288               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4289               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4290               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4291               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4292               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4293
  4294         16  EC-ST-AH-REM-TERM-CALC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  81
* EL050.cbl
  4295               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4296               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4297               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4298               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4299               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4300
  4301         16  EC-ST-LF-REFUND-CALC      PIC X.
  4302                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4303                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4304                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4305                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4306                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4307                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4308                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4309                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4310
  4311         16  EC-ST-AH-REFUND-CALC      PIC X.
  4312                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4313                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4314                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4315                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4316                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4317                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4318                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4319                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4320
  4321         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4322         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4323         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4324         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4325         16  EC-AM-EXPIRATION-DT       PIC XX.
  4326         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4327         16  EC-AM-CLASS-CD            PIC XX.
  4328         16  EC-AM-LF-DEVIATION        PIC XXX.
  4329         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4330         16  EC-AM-AH-DEVIATION        PIC XXX.
  4331         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4332         16  EC-AM-PHONE-NO            PIC X(10).
  4333
  4334         16  EC-AM-LF-REFUND-CALC      PIC X.
  4335                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4336                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4337                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4338                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4339                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4340                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4341                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4342
  4343         16  EC-AM-AH-REFUND-CALC      PIC X.
  4344                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4345                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4346                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4347                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4348                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4349                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4350                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4351
  4352         16  EC-AM-BEN-I-G-CD          PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  82
* EL050.cbl
  4353                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4354                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4355                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4356
  4357         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4358         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4359         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4360         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4361         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4362         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4363         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4364         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4365         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4366
  4367         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4368         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4369         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4370         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4371         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4372         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4373         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4374         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4375         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4376         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4377         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4378         16  EC-RT-LF-NSP-ST           PIC XX.
  4379         16  EC-RT-AH-NSP-ST           PIC XX.
  4380         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4381         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4382
  4383         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4384             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4385                                             'M' '5' '9' '2'.
  4386             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4387             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4388             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4389             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4390             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4391             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4392             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4393             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4394             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4395             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4396
  4397         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4398             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4399                                             'M' '5' '9' '2'.
  4400             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4401             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4402             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4403             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4404             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4405             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4406             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4407             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4408             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4409             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4410
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  83
* EL050.cbl
  4411         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4412         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4413         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4414         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4415         16  EC-CM-DEATH-DT            PIC XX.
  4416
  4417*DMD CUSTOM CODING FIELDS BELOW
  4418*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4419         16  EC-BR-DMD-RATING-SW       PIC X.
  4420                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4421                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4422                 88  NO-DMD-RATING               VALUE 'N'.
  4423
  4424         16  EC-NEW-CERT               PIC X(11).
  4425         16  EC-NEW-STATE              PIC XX.
  4426         16  FILLER                    PIC X.
  4427*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4428         16  OVER-SHORT-EDIT-FIELDS.
  4429             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4430             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4431             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4432             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4433             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4434             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4435             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4436             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4437             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4438         16  FILLER                    PIC X(71).
  4439******************************************************************
  4440
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  84
* EL050.cbl
  4442*    COPY ELCDIFRD.
  4443******************************************************************
  4444*                                                                *
  4445*                                                                *
  4446*                            ELCDIFRD.                           *
  4447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4448*                            VMOD=2.004                          *
  4449*                                                                *
  4450*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4451*                                                                *
  4452******************************************************************
  4453*
  4454  01  WS-DIFFERENCE-CALCULATION.
  4455        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4456        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4457        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4458        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4459        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4460        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4461        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4462        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4463        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4464        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4465        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4466
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  85
* EL050.cbl
  4468****************************************************************
  4469*
  4470* Copyright (c) 2007 by Clerity Solutions, Inc.
  4471* All rights reserved.
  4472*
  4473****************************************************************
  4474 01  DFHEIV.
  4475   02  DFHEIV0               PIC X(35).
  4476   02  DFHEIV1               PIC X(08).
  4477   02  DFHEIV2               PIC X(08).
  4478   02  DFHEIV3               PIC X(08).
  4479   02  DFHEIV4               PIC X(06).
  4480   02  DFHEIV5               PIC X(04).
  4481   02  DFHEIV6               PIC X(04).
  4482   02  DFHEIV7               PIC X(02).
  4483   02  DFHEIV8               PIC X(02).
  4484   02  DFHEIV9               PIC X(01).
  4485   02  DFHEIV10              PIC S9(7) COMP-3.
  4486   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4487   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4488   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4489   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4490   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4491   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4492   02  DFHEIV17              PIC X(04).
  4493   02  DFHEIV18              PIC X(04).
  4494   02  DFHEIV19              PIC X(04).
  4495   02  DFHEIV20              USAGE IS POINTER.
  4496   02  DFHEIV21              USAGE IS POINTER.
  4497   02  DFHEIV22              USAGE IS POINTER.
  4498   02  DFHEIV23              USAGE IS POINTER.
  4499   02  DFHEIV24              USAGE IS POINTER.
  4500   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4501   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4502   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4503   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4504   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4505   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4506   02  FILLER                PIC X(02).
  4507   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4508   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4509   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4510   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4511   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4512 LINKAGE  SECTION.
  4513*****************************************************************
  4514*                                                               *
  4515* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4516* All rights reserved.                                          *
  4517*                                                               *
  4518*****************************************************************
  4519 01  dfheiblk.
  4520     02  eibtime          pic s9(7) comp-3.
  4521     02  eibdate          pic s9(7) comp-3.
  4522     02  eibtrnid         pic x(4).
  4523     02  eibtaskn         pic s9(7) comp-3.
  4524     02  eibtrmid         pic x(4).
  4525     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  86
* EL050.cbl
  4526     02  eibcposn         pic s9(4) comp.
  4527     02  eibcalen         pic s9(4) comp.
  4528     02  eibaid           pic x(1).
  4529     02  eibfiller1       pic x(1).
  4530     02  eibfn            pic x(2).
  4531     02  eibfiller2       pic x(2).
  4532     02  eibrcode         pic x(6).
  4533     02  eibfiller3       pic x(2).
  4534     02  eibds            pic x(8).
  4535     02  eibreqid         pic x(8).
  4536     02  eibrsrce         pic x(8).
  4537     02  eibsync          pic x(1).
  4538     02  eibfree          pic x(1).
  4539     02  eibrecv          pic x(1).
  4540     02  eibsend          pic x(1).
  4541     02  eibatt           pic x(1).
  4542     02  eibeoc           pic x(1).
  4543     02  eibfmh           pic x(1).
  4544     02  eibcompl         pic x(1).
  4545     02  eibsig           pic x(1).
  4546     02  eibconf          pic x(1).
  4547     02  eiberr           pic x(1).
  4548     02  eibrldbk         pic x(1).
  4549     02  eiberrcd         pic x(4).
  4550     02  eibsynrb         pic x(1).
  4551     02  eibnodat         pic x(1).
  4552     02  eibfiller5       pic x(2).
  4553     02  eibresp          pic 9(09) comp.
  4554     02  eibresp2         pic 9(09) comp.
  4555     02  dfheigdj         pic s9(4) comp.
  4556     02  dfheigdk         pic s9(4) comp.
  4557
  4558 01  DFHCOMMAREA                   PIC X(1036).
  4559
  4560*01 PARMLIST .
  4561*    02  FILLER                    PIC S9(8)   COMP.
  4562*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4563*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4564*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4565*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4566*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4567*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4568*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4569
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  87
* EL050.cbl
  4571*    COPY ELCCNTL.
  4572******************************************************************
  4573*                                                                *
  4574*                                                                *
  4575*                            ELCCNTL.                            *
  4576*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4577*                            VMOD=2.059                          *
  4578*                                                                *
  4579*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4580*                                                                *
  4581*   FILE TYPE = VSAM,KSDS                                        *
  4582*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4583*                                                                *
  4584*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4585*       ALTERNATE INDEX = NONE                                   *
  4586*                                                                *
  4587*   LOG = YES                                                    *
  4588*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4589******************************************************************
  4590*                   C H A N G E   L O G
  4591*
  4592* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4593*-----------------------------------------------------------------
  4594*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4595* EFFECTIVE    NUMBER
  4596*-----------------------------------------------------------------
  4597* 082503                   PEMA  ADD BENEFIT GROUP
  4598* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4599* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4600* 092705    2005050300006  PEMA  ADD SPP LEASES
  4601* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4602* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4603* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4604* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4605******************************************************************
  4606*
  4607 01  CONTROL-FILE.
  4608     12  CF-RECORD-ID                       PIC XX.
  4609         88  VALID-CF-ID                        VALUE 'CF'.
  4610
  4611     12  CF-CONTROL-PRIMARY.
  4612         16  CF-COMPANY-ID                  PIC XXX.
  4613         16  CF-RECORD-TYPE                 PIC X.
  4614             88  CF-COMPANY-MASTER              VALUE '1'.
  4615             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4616             88  CF-STATE-MASTER                VALUE '3'.
  4617             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4618             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4619             88  CF-CARRIER-MASTER              VALUE '6'.
  4620             88  CF-MORTALITY-MASTER            VALUE '7'.
  4621             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4622             88  CF-TERMINAL-MASTER             VALUE '9'.
  4623             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4624             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4625             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4626             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4627             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4628             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  88
* EL050.cbl
  4629             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4630             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4631             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4632         16  CF-ACCESS-CD-GENL              PIC X(4).
  4633         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4634             20  CF-PROCESSOR               PIC X(4).
  4635         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4636             20  CF-STATE-CODE              PIC XX.
  4637             20  FILLER                     PIC XX.
  4638         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4639             20  FILLER                     PIC XX.
  4640             20  CF-HI-BEN-IN-REC           PIC XX.
  4641         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4642             20  FILLER                     PIC XXX.
  4643             20  CF-CARRIER-CNTL            PIC X.
  4644         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4645             20  FILLER                     PIC XX.
  4646             20  CF-HI-TYPE-IN-REC          PIC 99.
  4647         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4648             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4649                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4650             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4651             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4652         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4653             20  FILLER                     PIC X.
  4654             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4655         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4656             20  FILLER                     PIC XX.
  4657             20  CF-MORTGAGE-PLAN           PIC XX.
  4658         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4659
  4660     12  CF-LAST-MAINT-DT                   PIC XX.
  4661     12  CF-LAST-MAINT-BY                   PIC X(4).
  4662     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4663
  4664     12  CF-RECORD-BODY                     PIC X(728).
  4665
  4666
  4667****************************************************************
  4668*             COMPANY MASTER RECORD                            *
  4669****************************************************************
  4670
  4671     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4672         16  CF-COMPANY-ADDRESS.
  4673             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4674             20  CF-CL-IN-CARE-OF           PIC X(30).
  4675             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4676             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4677             20  CF-CL-CITY-STATE           PIC X(30).
  4678             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4679             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4680         16  CF-COMPANY-CD                  PIC X.
  4681         16  CF-COMPANY-PASSWORD            PIC X(8).
  4682         16  CF-SECURITY-OPTION             PIC X.
  4683             88  ALL-SECURITY                   VALUE '1'.
  4684             88  COMPANY-VERIFY                 VALUE '2'.
  4685             88  PROCESSOR-VERIFY               VALUE '3'.
  4686             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  89
* EL050.cbl
  4687             88  ALL-BUT-TERM                   VALUE '5'.
  4688         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4689             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4690         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4691             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4692         16  CF-INFORCE-LOCATION            PIC X.
  4693             88  CERTS-ARE-ONLINE               VALUE '1'.
  4694             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4695             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4696         16  CF-LOWER-CASE-LETTERS          PIC X.
  4697         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4698             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4699             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4700             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4701             88  CF-ACCNT-CNTL                  VALUE '3'.
  4702             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4703
  4704         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4705         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4706
  4707         16  CF-LGX-CREDIT-USER             PIC X.
  4708             88  CO-IS-NOT-USER                 VALUE 'N'.
  4709             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4710
  4711         16 CF-CREDIT-CALC-CODES.
  4712             20  CF-CR-REM-TERM-CALC PIC X.
  4713               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4714               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4715               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4716               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4717               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4718               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4719               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4720             20  CF-CR-R78-METHOD           PIC X.
  4721               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4722               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4723
  4724         16  CF-CLAIM-CONTROL-COUNTS.
  4725             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4726                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4727
  4728             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4729                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4730
  4731             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4732                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4733
  4734             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4735                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4736
  4737         16  CF-CURRENT-MONTH-END           PIC XX.
  4738
  4739         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4740             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4741             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4742             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4743             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4744                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  90
* EL050.cbl
  4745                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4746             20  CF-CO-PREM-REJECT-SW       PIC X.
  4747                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4748                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4749             20  CF-CO-REF-REJECT-SW        PIC X.
  4750                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4751                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4752
  4753         16  CF-CO-REPORTING-DT             PIC XX.
  4754         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4755         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4756           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4757           88  CF-CO-MONTH-END                  VALUE '1'.
  4758
  4759         16  CF-LGX-CLAIM-USER              PIC X.
  4760             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4761             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4762
  4763         16  CF-CREDIT-EDIT-CONTROLS.
  4764             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4765             20  CF-MIN-AGE                 PIC 99.
  4766             20  CF-DEFAULT-AGE             PIC 99.
  4767             20  CF-MIN-TERM                PIC S999      COMP-3.
  4768             20  CF-MAX-TERM                PIC S999      COMP-3.
  4769             20  CF-DEFAULT-SEX             PIC X.
  4770             20  CF-JOINT-AGE-INPUT         PIC X.
  4771                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4772             20  CF-BIRTH-DATE-INPUT        PIC X.
  4773                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4774             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4775                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4776                 88  CF-ZERO-CARRIER            VALUE '1'.
  4777                 88  CF-ZERO-GROUPING           VALUE '2'.
  4778                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4779             20  CF-EDIT-SW                 PIC X.
  4780                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4781             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4782             20  CF-CR-PR-METHOD            PIC X.
  4783               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4784               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4785             20  FILLER                     PIC X.
  4786
  4787         16  CF-CREDIT-MISC-CONTROLS.
  4788             20  CF-REIN-TABLE-SW           PIC X.
  4789                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4790             20  CF-COMP-TABLE-SW           PIC X.
  4791                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4792             20  CF-EXPERIENCE-RETENTION-AGE
  4793                                            PIC S9        COMP-3.
  4794             20  CF-CONVERSION-DT           PIC XX.
  4795             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4796             20  CF-RUN-FREQUENCY-SW        PIC X.
  4797                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4798                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4799
  4800             20  CF-CR-CHECK-NO-CONTROL.
  4801                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4802                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  91
* EL050.cbl
  4803                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4804                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4805                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4806                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4807
  4808                 24  CF-CR-CHECK-COUNT       REDEFINES
  4809                     CF-CR-CHECK-COUNTER      PIC X(4).
  4810
  4811                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4812                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4813
  4814                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4815                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4816                 24  CF-MAIL-PROCESSING       PIC X.
  4817                     88  MAIL-PROCESSING          VALUE 'Y'.
  4818
  4819         16  CF-MISC-SYSTEM-CONTROL.
  4820             20  CF-SYSTEM-C                 PIC X.
  4821                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4822             20  CF-SYSTEM-D                 PIC X.
  4823                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4824             20  CF-SOC-SEC-NO-SW            PIC X.
  4825                 88  SOC-SEC-NO-USED             VALUE '1'.
  4826             20  CF-MEMBER-NO-SW             PIC X.
  4827                 88  MEMBER-NO-USED              VALUE '1'.
  4828             20  CF-TAX-ID-NUMBER            PIC X(11).
  4829             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4830             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4831                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4832                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4833                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4834                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4835             20  CF-SYSTEM-E                 PIC X.
  4836                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4837
  4838         16  CF-LGX-LIFE-USER               PIC X.
  4839             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4840             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4841
  4842         16  CF-CR-MONTH-END-DT             PIC XX.
  4843
  4844         16  CF-FILE-MAINT-DATES.
  4845             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4846                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4847             20  CF-LAST-BATCH       REDEFINES
  4848                 CF-LAST-BATCH-NO               PIC X(4).
  4849             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4850             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4851             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4852             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4853             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4854             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4855             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4856             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4857             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4858             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4859
  4860         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  92
* EL050.cbl
  4861         16  FILLER                         PIC X.
  4862
  4863         16  CF-ALT-MORT-CODE               PIC X(4).
  4864         16  CF-MEMBER-CAPTION              PIC X(10).
  4865
  4866         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4867             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4868             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4869             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4870             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4871             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4872
  4873         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4874
  4875         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4876         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4877         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4878         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4879
  4880         16  CF-AH-OVERRIDE-L1              PIC X.
  4881         16  CF-AH-OVERRIDE-L2              PIC XX.
  4882         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4883         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4884
  4885         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4886         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4887
  4888         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4889         16  CF-AR-LAST-EL860-DT            PIC XX.
  4890         16  CF-MP-MONTH-END-DT             PIC XX.
  4891
  4892         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4893         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4894             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4895
  4896         16  CF-AR-MONTH-END-DT             PIC XX.
  4897
  4898         16  CF-CRDTCRD-USER                PIC X.
  4899             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4900             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4901
  4902         16  CF-CC-MONTH-END-DT             PIC XX.
  4903
  4904         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4905
  4906         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4907             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4908             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4909             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4910         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4911         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4912         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4913         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4914             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4915             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4916         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4917         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4918         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  93
* EL050.cbl
  4919             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4920         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4921
  4922         16  CF-CL-ZIP-CODE.
  4923             20  CF-CL-ZIP-PRIME.
  4924                 24  CF-CL-ZIP-1ST          PIC X.
  4925                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4926                 24  FILLER                 PIC X(4).
  4927             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4928         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4929             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4930             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4931             20  FILLER                     PIC XXX.
  4932
  4933         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4934         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4935         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4936         16  CF-CO-OPTION-START-DATE        PIC XX.
  4937         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4938           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4939                                                      '3' '4'.
  4940           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4941           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4942           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4943           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4944           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4945           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4946
  4947         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4948
  4949         16  CF-PAYMENT-APPROVAL-LEVELS.
  4950             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4951             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4952             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4953             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4954             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4955             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4956
  4957         16  CF-END-USER-REPORTING-USER     PIC X.
  4958             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4959             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4960
  4961         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4962             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4963             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4964
  4965         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4966
  4967         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4968         16  FILLER                         PIC X.
  4969
  4970         16  CF-CREDIT-ARCHIVE-CNTL.
  4971             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4972             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4973             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4974
  4975         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4976
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  94
* EL050.cbl
  4977         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4978             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4979             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4980
  4981         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4982             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4983             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4984
  4985         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4986
  4987         16  CF-CO-ACH-ID-CODE              PIC  X.
  4988             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4989             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4990             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4991         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4992         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4993         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4994         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4995         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4996         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4997         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4998         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4999         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5000                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5001         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5002                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5003
  5004         16  CF-CO-OVER-SHORT.
  5005             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5006             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5007
  5008*         16  FILLER                         PIC X(102).
  5009         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5010             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5011             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5012
  5013         16  CF-AH-APPROVAL-DAYS.
  5014             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5015             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5016             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5017             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5018
  5019         16  FILLER                         PIC X(82).
  5020****************************************************************
  5021*             PROCESSOR/USER RECORD                            *
  5022****************************************************************
  5023
  5024     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5025         16  CF-PROCESSOR-NAME              PIC X(30).
  5026         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5027         16  CF-PROCESSOR-TITLE             PIC X(26).
  5028         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5029                 88  MESSAGE-YES                VALUE 'Y'.
  5030                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5031
  5032*****************************************************
  5033****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5034****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  95
* EL050.cbl
  5035****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5036****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5037*****************************************************
  5038
  5039         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5040             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5041             20  CF-APPLICATION-FORCE       PIC X.
  5042             20  CF-INDIVIDUAL-APP.
  5043                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5044                     28  CF-BROWSE-APP      PIC X.
  5045                     28  CF-UPDATE-APP      PIC X.
  5046
  5047         16  CF-CURRENT-TERM-ON             PIC X(4).
  5048         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5049             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5050             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5051             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5052             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5053             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5054             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5055             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5056         16  CF-PROCESSOR-CARRIER           PIC X.
  5057             88  NO-CARRIER-SECURITY            VALUE ' '.
  5058         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5059             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5060         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5061             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5062         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5063             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5064
  5065         16  CF-PROC-SYS-ACCESS-SW.
  5066             20  CF-PROC-CREDIT-CLAIMS-SW.
  5067                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5068                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5069                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5070                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5071             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5072                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5073                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5074             20  CF-PROC-LIFE-GNRLDGR-SW.
  5075                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5076                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5077                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5078                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5079             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5080                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5081                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5082         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5083             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5084             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5085         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5086
  5087         16  CF-APPROVAL-LEVEL                  PIC X.
  5088             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5089             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5090             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5091             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5092
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  96
* EL050.cbl
  5093         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5094
  5095         16  CF-LANGUAGE-TYPE                   PIC X.
  5096             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5097             88  CF-LANG-IS-FR                      VALUE 'F'.
  5098         16  FILLER                             PIC  X(240).
  5099
  5100****************************************************************
  5101*             PROCESSOR/REMINDERS RECORD                       *
  5102****************************************************************
  5103
  5104     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5105         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5106             20  CF-START-REMIND-DT         PIC XX.
  5107             20  CF-END-REMIND-DT           PIC XX.
  5108             20  CF-REMINDER-TEXT           PIC X(50).
  5109         16  FILLER                         PIC X(296).
  5110
  5111
  5112****************************************************************
  5113*             STATE MASTER RECORD                              *
  5114****************************************************************
  5115
  5116     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5117         16  CF-STATE-ABBREVIATION          PIC XX.
  5118         16  CF-STATE-NAME                  PIC X(25).
  5119         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5120         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5121             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5122             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5123             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5124             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5125                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5126                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5127             20  CF-ST-PREM-REJECT-SW       PIC X.
  5128                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5129                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5130             20  CF-ST-REF-REJECT-SW        PIC X.
  5131                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5132                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5133         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5134         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5135         16  CF-ST-REFUND-RULES.
  5136             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5137             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5138             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5139         16  CF-ST-FST-PMT-EXTENSION.
  5140             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5141             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5142                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5143                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5144                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5145                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5146         16  CF-ST-STATE-CALL.
  5147             20  CF-ST-CALL-UNEARNED        PIC X.
  5148             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5149             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5150         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  97
* EL050.cbl
  5151             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5152             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5153         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5154         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5155         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5156         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5157         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5158         16  FILLER                         PIC X.
  5159         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5160             20  CF-ST-BENEFIT-CD           PIC XX.
  5161             20  CF-ST-BENEFIT-KIND         PIC X.
  5162                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5163                 88  CF-ST-AH-KIND              VALUE 'A'.
  5164             20  CF-ST-REM-TERM-CALC        PIC X.
  5165                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5166                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5167                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5168                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5169                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5170                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5171                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5172                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5173
  5174             20  CF-ST-REFUND-CALC          PIC X.
  5175                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5176                 88  ST-REFD-BY-R78             VALUE '1'.
  5177                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5178                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5179                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5180                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5181                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5182                 88  ST-REFD-UTAH               VALUE '7'.
  5183                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5184                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5185                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5186
  5187             20  CF-ST-EARNING-CALC         PIC X.
  5188                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5189                 88  ST-EARN-BY-R78             VALUE '1'.
  5190                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5191                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5192                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5193                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5194                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5195                 88  ST-EARN-MEAN               VALUE '8'.
  5196                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5197
  5198             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5199                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5200                 88  ST-OVRD-BY-R78             VALUE '1'.
  5201                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5202                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5203                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5204                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5205                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5206                 88  ST-OVRD-MEAN               VALUE '8'.
  5207                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5208             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  98
* EL050.cbl
  5209
  5210         16  CF-ST-COMMISSION-CAPS.
  5211             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5212             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5213             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5214             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5215         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5216                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5217
  5218         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5219
  5220         16  CF-ST-STATUTORY-INTEREST.
  5221             20  CF-ST-STAT-DATE-FROM       PIC X.
  5222                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5223                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5224             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5225             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5226             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5227             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5228             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5229
  5230         16  CF-ST-OVER-SHORT.
  5231             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5232             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5233
  5234         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5235
  5236         16  CF-ST-RT-CALC                  PIC X.
  5237
  5238         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5239         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5240         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5241         16  CF-ST-RF-LR-CALC               PIC X.
  5242         16  CF-ST-RF-LL-CALC               PIC X.
  5243         16  CF-ST-RF-LN-CALC               PIC X.
  5244         16  CF-ST-RF-AH-CALC               PIC X.
  5245         16  CF-ST-RF-CP-CALC               PIC X.
  5246*        16  FILLER                         PIC X(206).
  5247*CIDMOD         16  FILLER                         PIC X(192).
  5248         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5249             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5250         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5251         16  FILLER                         PIC X(187).
  5252
  5253****************************************************************
  5254*             BENEFIT MASTER RECORD                            *
  5255****************************************************************
  5256
  5257     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5258         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5259             20  CF-BENEFIT-CODE            PIC XX.
  5260             20  CF-BENEFIT-NUMERIC  REDEFINES
  5261                 CF-BENEFIT-CODE            PIC XX.
  5262             20  CF-BENEFIT-ALPHA           PIC XXX.
  5263             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5264             20  CF-BENEFIT-COMMENT         PIC X(10).
  5265
  5266             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page  99
* EL050.cbl
  5267                 88  CF-REDUCING                VALUE 'R'.
  5268                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5269
  5270             20  CF-SPECIAL-CALC-CD         PIC X.
  5271                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5272                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5273                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5274                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5275                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5276                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5277                 88  CF-FARM-PLAN               VALUE 'F'.
  5278                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5279                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5280                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5281                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5282                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5283                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5284                 88  CF-PRUDENTIAL              VALUE 'P'.
  5285                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5286                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5287                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5288                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5289                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5290                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5291
  5292             20  CF-JOINT-INDICATOR         PIC X.
  5293                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5294
  5295*            20  FILLER                     PIC X(12).
  5296             20  FILLER                     PIC X(11).
  5297             20  CF-BENEFIT-CATEGORY        PIC X.
  5298             20  CF-LOAN-TYPE               PIC X(8).
  5299
  5300             20  CF-CO-REM-TERM-CALC        PIC X.
  5301                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5302                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5303                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5304                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5305                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5306
  5307             20  CF-CO-EARNINGS-CALC        PIC X.
  5308                 88  CO-EARN-BY-R78             VALUE '1'.
  5309                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5310                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5311                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5312                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5313                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5314                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5315                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5316
  5317             20  CF-CO-REFUND-CALC          PIC X.
  5318                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5319                 88  CO-REFD-BY-R78             VALUE '1'.
  5320                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5321                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5322                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5323                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5324                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 100
* EL050.cbl
  5325                 88  CO-REFD-MEAN               VALUE '8'.
  5326                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5327                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5328                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5329
  5330             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5331                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5332                 88  CO-OVRD-BY-R78             VALUE '1'.
  5333                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5334                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5335                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5336                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5337                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5338                 88  CO-OVRD-MEAN               VALUE '8'.
  5339                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5340
  5341             20  CF-CO-BEN-I-G-CD           PIC X.
  5342                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5343                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5344                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5345
  5346         16  FILLER                         PIC X(304).
  5347
  5348
  5349****************************************************************
  5350*             CARRIER MASTER RECORD                            *
  5351****************************************************************
  5352
  5353     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5354         16  CF-ADDRESS-DATA.
  5355             20  CF-MAIL-TO-NAME            PIC X(30).
  5356             20  CF-IN-CARE-OF              PIC X(30).
  5357             20  CF-ADDRESS-LINE-1          PIC X(30).
  5358             20  CF-ADDRESS-LINE-2          PIC X(30).
  5359             20  CF-CITY-STATE              PIC X(30).
  5360             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5361             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5362
  5363         16  CF-CLAIM-NO-CONTROL.
  5364             20  CF-CLAIM-NO-METHOD         PIC X.
  5365                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5366                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5367                 88  CLAIM-NO-SEQ               VALUE '3'.
  5368                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5369             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5370                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5371                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5372                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5373
  5374         16  CF-CHECK-NO-CONTROL.
  5375             20  CF-CHECK-NO-METHOD         PIC X.
  5376                 88  CHECK-NO-MANUAL            VALUE '1'.
  5377                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5378                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5379                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5380             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5381                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5382
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 101
* EL050.cbl
  5383         16  CF-DOMICILE-STATE              PIC XX.
  5384
  5385         16  CF-EXPENSE-CONTROLS.
  5386             20  CF-EXPENSE-METHOD          PIC X.
  5387                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5388                 88  DOLLARS-PER-PMT            VALUE '2'.
  5389                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5390                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5391             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5392             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5393
  5394         16  CF-CORRESPONDENCE-CONTROL.
  5395             20  CF-LETTER-RESEND-OPT       PIC X.
  5396                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5397                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5398             20  FILLER                     PIC X(4).
  5399
  5400         16  CF-RESERVE-CONTROLS.
  5401             20  CF-MANUAL-SW               PIC X.
  5402                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5403             20  CF-FUTURE-SW               PIC X.
  5404                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5405             20  CF-PTC-SW                  PIC X.
  5406                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5407             20  CF-IBNR-SW                 PIC X.
  5408                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5409             20  CF-PTC-LF-SW               PIC X.
  5410                 88  CF-LF-PTC-USED             VALUE '1'.
  5411             20  CF-CDT-ACCESS-METHOD       PIC X.
  5412                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5413                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5414                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5415             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5416
  5417         16  CF-CLAIM-CALC-METHOD           PIC X.
  5418             88  360-PLUS-MONTHS                VALUE '1'.
  5419             88  365-PLUS-MONTHS                VALUE '2'.
  5420             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5421             88  360-DAILY                      VALUE '4'.
  5422             88  365-DAILY                      VALUE '5'.
  5423
  5424         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5425         16  FILLER                         PIC X(11).
  5426
  5427         16  CF-LIMIT-AMOUNTS.
  5428             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5429             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5430             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5431             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5432             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5433             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5434             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5435             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5436             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5437             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5438
  5439         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5440         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 102
* EL050.cbl
  5441         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5442
  5443         16  CF-ZIP-CODE.
  5444             20  CF-ZIP-PRIME.
  5445                 24  CF-ZIP-1ST             PIC X.
  5446                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5447                 24  FILLER                 PIC X(4).
  5448             20  CF-ZIP-PLUS4               PIC X(4).
  5449         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5450             20  CF-CAN-POSTAL-1            PIC XXX.
  5451             20  CF-CAN-POSTAL-2            PIC XXX.
  5452             20  FILLER                     PIC XXX.
  5453
  5454         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5455         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5456         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5457
  5458         16  CF-RATING-SWITCH               PIC X.
  5459             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5460             88  CF-NO-RATING                   VALUE 'N'.
  5461
  5462         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5463
  5464         16  CF-CARRIER-OVER-SHORT.
  5465             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5466             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5467
  5468         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5469         16  CF-SECPAY-SWITCH               PIC X.
  5470             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5471             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5472         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5473         16  FILLER                         PIC X(448).
  5474*        16  FILLER                         PIC X(452).
  5475
  5476
  5477****************************************************************
  5478*             MORTALITY MASTER RECORD                          *
  5479****************************************************************
  5480
  5481     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5482         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5483                                INDEXED BY CF-MORT-NDX.
  5484             20  CF-MORT-TABLE              PIC X(5).
  5485             20  CF-MORT-TABLE-TYPE         PIC X.
  5486                 88  CF-MORT-JOINT              VALUE 'J'.
  5487                 88  CF-MORT-SINGLE             VALUE 'S'.
  5488                 88  CF-MORT-COMBINED           VALUE 'C'.
  5489                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5490                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5491             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5492             20  CF-MORT-AGE-METHOD         PIC XX.
  5493                 88  CF-AGE-LAST                VALUE 'AL'.
  5494                 88  CF-AGE-NEAR                VALUE 'AN'.
  5495             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5496             20  CF-MORT-ADJUSTMENT-DIRECTION
  5497                                            PIC X.
  5498                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 103
* EL050.cbl
  5499                 88  CF-PLUS                    VALUE '+'.
  5500             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5501             20  CF-MORT-JOINT-CODE         PIC X.
  5502                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5503             20  CF-MORT-PC-Q               PIC X.
  5504                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5505             20  CF-MORT-TABLE-CODE         PIC X(4).
  5506             20  CF-MORT-COMMENTS           PIC X(15).
  5507             20  FILLER                     PIC X(14).
  5508
  5509         16  FILLER                         PIC X(251).
  5510
  5511
  5512****************************************************************
  5513*             BUSSINESS TYPE MASTER RECORD                     *
  5514****************************************************************
  5515
  5516     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5517* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5518* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5519* AND RECORD 05 IS TYPES 81-99
  5520         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5521             20  CF-BUSINESS-TITLE          PIC  X(19).
  5522             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5523                                            PIC S9V9(4) COMP-3.
  5524             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5525             20  FILLER                     PIC  X.
  5526         16  FILLER                         PIC  X(248).
  5527
  5528
  5529****************************************************************
  5530*             TERMINAL MASTER RECORD                           *
  5531****************************************************************
  5532
  5533     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5534
  5535         16  CF-COMPANY-TERMINALS.
  5536             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5537                                  PIC X(4).
  5538         16  FILLER               PIC X(248).
  5539
  5540
  5541****************************************************************
  5542*             LIFE EDIT MASTER RECORD                          *
  5543****************************************************************
  5544
  5545     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5546         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5547             20  CF-LIFE-CODE-IN            PIC XX.
  5548             20  CF-LIFE-CODE-OUT           PIC XX.
  5549         16  FILLER                         PIC X(248).
  5550
  5551
  5552****************************************************************
  5553*             AH EDIT MASTER RECORD                            *
  5554****************************************************************
  5555
  5556     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 104
* EL050.cbl
  5557         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5558             20  CF-AH-CODE-IN              PIC XXX.
  5559             20  CF-AH-CODE-OUT             PIC XX.
  5560         16  FILLER                         PIC X(248).
  5561
  5562
  5563****************************************************************
  5564*             CREDIBILITY TABLES                               *
  5565****************************************************************
  5566
  5567     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5568         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5569                             INDEXED BY CF-CRDB-NDX.
  5570             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5571             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5572             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5573         16  FILLER                         PIC  X(332).
  5574
  5575
  5576****************************************************************
  5577*             REPORT CUSTOMIZATION RECORD                      *
  5578****************************************************************
  5579
  5580     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5581         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5582             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5583             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5584             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5585**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5586****       A T-TRANSFER.                                   ****
  5587             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5588
  5589         16  FILLER                         PIC XX.
  5590
  5591         16  CF-CARRIER-CNTL-OPT.
  5592             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5593                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5594                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5595             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5596                                            PIC X.
  5597         16  CF-GROUP-CNTL-OPT.
  5598             20  CF-GROUP-OPT-SEQ           PIC 9.
  5599                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5600                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5601             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5602                                            PIC X(6).
  5603         16  CF-STATE-CNTL-OPT.
  5604             20  CF-STATE-OPT-SEQ           PIC 9.
  5605                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5606                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5607             20  CF-STATE-SELECT OCCURS 3 TIMES
  5608                                            PIC XX.
  5609         16  CF-ACCOUNT-CNTL-OPT.
  5610             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5611                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5612                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5613             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5614                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 105
* EL050.cbl
  5615         16  CF-BUS-TYP-CNTL-OPT.
  5616             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5617                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5618                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5619             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5620                                            PIC XX.
  5621         16  CF-LF-TYP-CNTL-OPT.
  5622             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5623                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5624                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5625             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5626                                            PIC XX.
  5627         16  CF-AH-TYP-CNTL-OPT.
  5628             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5629                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5630                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5631             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5632                                            PIC XX.
  5633         16  CF-REPTCD1-CNTL-OPT.
  5634             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5635                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5636                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5637             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5638                                            PIC X(10).
  5639         16  CF-REPTCD2-CNTL-OPT.
  5640             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5641                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5642                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5643             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5644                                            PIC X(10).
  5645         16  CF-USER1-CNTL-OPT.
  5646             20  CF-USER1-OPT-SEQ           PIC 9.
  5647                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5648                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5649             20  CF-USER1-SELECT OCCURS 3 TIMES
  5650                                            PIC X(10).
  5651         16  CF-USER2-CNTL-OPT.
  5652             20  CF-USER2-OPT-SEQ           PIC 9.
  5653                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5654                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5655             20  CF-USER2-SELECT OCCURS 3 TIMES
  5656                                            PIC X(10).
  5657         16  CF-USER3-CNTL-OPT.
  5658             20  CF-USER3-OPT-SEQ           PIC 9.
  5659                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5660                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5661             20  CF-USER3-SELECT OCCURS 3 TIMES
  5662                                            PIC X(10).
  5663         16  CF-USER4-CNTL-OPT.
  5664             20  CF-USER4-OPT-SEQ           PIC 9.
  5665                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5666                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5667             20  CF-USER4-SELECT OCCURS 3 TIMES
  5668                                            PIC X(10).
  5669         16  CF-USER5-CNTL-OPT.
  5670             20  CF-USER5-OPT-SEQ           PIC 9.
  5671                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5672                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 106
* EL050.cbl
  5673             20  CF-USER5-SELECT OCCURS 3 TIMES
  5674                                            PIC X(10).
  5675         16  CF-REINS-CNTL-OPT.
  5676             20  CF-REINS-OPT-SEQ           PIC 9.
  5677                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5678                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5679             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5680                 24  CF-REINS-PRIME         PIC XXX.
  5681                 24  CF-REINS-SUB           PIC XXX.
  5682
  5683         16  CF-AGENT-CNTL-OPT.
  5684             20  CF-AGENT-OPT-SEQ           PIC 9.
  5685                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5686                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5687             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5688                                            PIC X(10).
  5689
  5690         16  FILLER                         PIC X(43).
  5691
  5692         16  CF-LOSS-RATIO-SELECT.
  5693             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5694             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5695         16  CF-ENTRY-DATE-SELECT.
  5696             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5697             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5698         16  CF-EFFECTIVE-DATE-SELECT.
  5699             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5700             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5701
  5702         16  CF-EXCEPTION-LIST-IND          PIC X.
  5703             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5704
  5705         16  FILLER                         PIC X(318).
  5706
  5707****************************************************************
  5708*                  EXCEPTION REPORTING RECORD                  *
  5709****************************************************************
  5710
  5711     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5712         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5713             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5714
  5715         16  CF-COMBINED-LIFE-AH-OPT.
  5716             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5717             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5718             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5719             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5720
  5721         16  CF-LIFE-OPT.
  5722             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5723             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5724             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5725             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5726             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5727             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5728             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5729             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5730             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 107
* EL050.cbl
  5731             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5732
  5733         16  CF-AH-OPT.
  5734             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5735             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5736             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5737             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5738             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5739             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5740             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5741             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5742             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5743             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5744
  5745         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5746             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5747             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5748             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5749
  5750         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5751
  5752         16  FILLER                         PIC X(673).
  5753
  5754
  5755****************************************************************
  5756*             MORTGAGE SYSTEM PLAN RECORD                      *
  5757****************************************************************
  5758
  5759     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5760         16  CF-PLAN-TYPE                   PIC X.
  5761             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5762             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5763             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5764         16  CF-PLAN-ABBREV                 PIC XXX.
  5765         16  CF-PLAN-DESCRIPT               PIC X(10).
  5766         16  CF-PLAN-NOTES                  PIC X(20).
  5767         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5768         16  CF-PLAN-UNDERWRITING.
  5769             20  CF-PLAN-TERM-DATA.
  5770                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5771                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5772             20  CF-PLAN-AGE-DATA.
  5773                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5774                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5775                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5776             20  CF-PLAN-BENEFIT-DATA.
  5777                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5778                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5779                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5780                                            PIC S9(7)V99  COMP-3.
  5781         16  CF-PLAN-POLICY-FORMS.
  5782             20  CF-POLICY-FORM             PIC X(12).
  5783             20  CF-MASTER-APPLICATION      PIC X(12).
  5784             20  CF-MASTER-POLICY           PIC X(12).
  5785         16  CF-PLAN-RATING.
  5786             20  CF-RATE-CODE               PIC X(5).
  5787             20  CF-SEX-RATING              PIC X.
  5788                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 108
* EL050.cbl
  5789                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5790             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5791             20  CF-SUB-STD-TYPE            PIC X.
  5792                 88  CF-PCT-OF-PREM            VALUE '1'.
  5793                 88  CF-PCT-OF-BENE            VALUE '2'.
  5794         16  CF-PLAN-PREM-TOLERANCES.
  5795             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5796             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5797         16  CF-PLAN-PYMT-TOLERANCES.
  5798             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5799             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5800         16  CF-PLAN-MISC-DATA.
  5801             20  FILLER                     PIC X.
  5802             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5803             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5804         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5805         16  CF-PLAN-IND-GRP                PIC X.
  5806             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5807                                                     '1'.
  5808             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5809                                                     '2'.
  5810         16  CF-MIB-SEARCH-SW               PIC X.
  5811             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5812             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5813             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5814             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5815         16  CF-ALPHA-SEARCH-SW             PIC X.
  5816             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5817             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5818             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5819             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5820             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5821             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5822             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5823             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5824             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5825             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5826                                                     'A' 'B' 'C'
  5827                                                     'X' 'Y' 'Z'.
  5828         16  CF-EFF-DT-RULE-SW              PIC X.
  5829             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5830             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5831             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5832             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5833             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5834         16  FILLER                         PIC X(4).
  5835         16  CF-HEALTH-QUESTIONS            PIC X.
  5836             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5837         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5838         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5839         16  CF-PLAN-SNGL-JNT               PIC X.
  5840             88  CF-COMBINED-PLAN              VALUE 'C'.
  5841             88  CF-JNT-PLAN                   VALUE 'J'.
  5842             88  CF-SNGL-PLAN                  VALUE 'S'.
  5843         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5844         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5845         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5846         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 109
* EL050.cbl
  5847         16  CF-RERATE-CNTL                 PIC  X.
  5848             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5849             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5850             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5851             88  CF-AUTO-RECALC                 VALUE '4'.
  5852         16  CF-BENEFIT-TYPE                PIC  X.
  5853             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5854             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5855         16  CF-POLICY-FEE                  PIC S999V99
  5856                                                    COMP-3.
  5857         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5858         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5859         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5860         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5861         16  FILLER                         PIC  X(32).
  5862         16  CF-TERMINATION-FORM            PIC  X(04).
  5863         16  FILLER                         PIC  X(08).
  5864         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5865                                                       COMP-3.
  5866         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5867         16  CF-ISSUE-LETTER                PIC  X(4).
  5868         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5869         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5870             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5871             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5872         16  CF-MP-REFUND-CALC              PIC X.
  5873             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5874             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5875             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5876             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5877             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5878             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5879             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5880             88  CF-MP-REFD-MEAN                VALUE '8'.
  5881         16  CF-ALT-RATE-CODE               PIC  X(5).
  5882
  5883
  5884         16  FILLER                         PIC X(498).
  5885****************************************************************
  5886*             MORTGAGE COMPANY MASTER RECORD                   *
  5887****************************************************************
  5888
  5889     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5890         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5891         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5892             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5893             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5894             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5895             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5896             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5897
  5898         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5899         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5900         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5901         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5902         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5903
  5904         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 110
* EL050.cbl
  5905             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5906         16  CF-MP-RECON-USE-IND            PIC X(1).
  5907             88  CF-MP-USE-RECON             VALUE 'Y'.
  5908         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5909             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5910         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5911             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5912             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5913         16  FILLER                         PIC X(1).
  5914         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5915             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5916         16  CF-MORTG-MIB-VERSION           PIC X.
  5917             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5918             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5919             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5920         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5921             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5922                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5923             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5924                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5925             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5926                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5927             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5928                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5929             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5930                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5931             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5932                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5933         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5934         16  FILLER                         PIC X(7).
  5935         16  CF-MORTG-DESTINATION-SYMBOL.
  5936             20  CF-MORTG-MIB-COMM          PIC X(5).
  5937             20  CF-MORTG-MIB-TERM          PIC X(5).
  5938         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5939             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5940         16  FILLER                         PIC X(03).
  5941         16  CF-MP-CHECK-NO-CONTROL.
  5942             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5943                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5944                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5945                                                ' ' LOW-VALUES.
  5946                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5947                                               VALUE '3'.
  5948         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5949         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5950         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5951             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5952                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5953             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5954                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5955             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5956                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5957             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5958                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5959             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5960                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5961             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5962                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 111
* EL050.cbl
  5963         16  CF-MORTG-BILLING-AREA.
  5964             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5965                                            PIC X.
  5966         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5967         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5968         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5969         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5970             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5971             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5972         16  FILLER                         PIC X.
  5973         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5974             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5975             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5976         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5977         16  FILLER                         PIC X(8).
  5978         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5979         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5980         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5981         16  CF-ACH-COMPANY-ID.
  5982             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5983                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5984                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5985                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5986             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5987         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5988             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5989         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5990             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5991             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5992         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5993         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5994         16  FILLER                         PIC X(536).
  5995
  5996****************************************************************
  5997*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5998****************************************************************
  5999
  6000     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6001         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6002             20  CF-FEMALE-HEIGHT.
  6003                 24  CF-FEMALE-FT           PIC 99.
  6004                 24  CF-FEMALE-IN           PIC 99.
  6005             20  CF-FEMALE-MIN-WT           PIC 999.
  6006             20  CF-FEMALE-MAX-WT           PIC 999.
  6007         16  FILLER                         PIC X(428).
  6008
  6009     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6010         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6011             20  CF-MALE-HEIGHT.
  6012                 24  CF-MALE-FT             PIC 99.
  6013                 24  CF-MALE-IN             PIC 99.
  6014             20  CF-MALE-MIN-WT             PIC 999.
  6015             20  CF-MALE-MAX-WT             PIC 999.
  6016         16  FILLER                         PIC X(428).
  6017******************************************************************
  6018*             AUTOMATIC ACTIVITY RECORD                          *
  6019******************************************************************
  6020     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 112
* EL050.cbl
  6021         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6022             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6023             20  CF-SYS-LETTER-ID           PIC X(04).
  6024             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6025             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6026             20  CF-SYS-RESET-SW            PIC X(01).
  6027             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6028             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6029
  6030         16  FILLER                         PIC X(50).
  6031
  6032         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6033             20  CF-USER-ACTIVE-SW          PIC X(01).
  6034             20  CF-USER-LETTER-ID          PIC X(04).
  6035             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6036             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6037             20  CF-USER-RESET-SW           PIC X(01).
  6038             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6039             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6040             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6041
  6042         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 113
* EL050.cbl
  6044*    COPY ERCACCT.
  6045******************************************************************
  6046*                                                                *
  6047*                                                                *
  6048*                            ERCACCT                             *
  6049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6050*                            VMOD=2.031                          *
  6051*                                                                *
  6052*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6053*                                                                *
  6054*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6055*   VSAM ACCOUNT MASTER FILES.                                   *
  6056*                                                                *
  6057*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6058*                                                                *
  6059*   FILE TYPE = VSAM,KSDS                                        *
  6060*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6061*                                                                *
  6062*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6063*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6064*                                                                *
  6065*   LOG = NO                                                     *
  6066*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6067*                                                                *
  6068*                                                                *
  6069******************************************************************
  6070*                   C H A N G E   L O G
  6071*
  6072* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6073*-----------------------------------------------------------------
  6074*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6075* EFFECTIVE    NUMBER
  6076*-----------------------------------------------------------------
  6077* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6078* 092705    2005050300006  PEMA  ADD SPP LEASES
  6079* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6080* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6081* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6082******************************************************************
  6083
  6084 01  ACCOUNT-MASTER.
  6085     12  AM-RECORD-ID                      PIC XX.
  6086         88  VALID-AM-ID                      VALUE 'AM'.
  6087
  6088     12  AM-CONTROL-PRIMARY.
  6089         16  AM-COMPANY-CD                 PIC X.
  6090         16  AM-MSTR-CNTRL.
  6091             20  AM-CONTROL-A.
  6092                 24  AM-CARRIER            PIC X.
  6093                 24  AM-GROUPING.
  6094                     28 AM-GROUPING-PREFIX PIC XXX.
  6095                     28 AM-GROUPING-PRIME  PIC XXX.
  6096                 24  AM-STATE              PIC XX.
  6097                 24  AM-ACCOUNT.
  6098                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6099                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6100             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6101                                           PIC X(19).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 114
* EL050.cbl
  6102             20  AM-CNTRL-B.
  6103                 24  AM-EXPIRATION-DT      PIC XX.
  6104                 24  FILLER                PIC X(4).
  6105             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6106                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6107
  6108     12  AM-CONTROL-BY-VAR-GRP.
  6109         16  AM-COMPANY-CD-A1              PIC X.
  6110         16  AM-VG-CARRIER                 PIC X.
  6111         16  AM-VG-GROUPING                PIC X(6).
  6112         16  AM-VG-STATE                   PIC XX.
  6113         16  AM-VG-ACCOUNT                 PIC X(10).
  6114         16  AM-VG-DATE.
  6115             20  AM-VG-EXPIRATION-DT       PIC XX.
  6116             20  FILLER                    PIC X(4).
  6117         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6118                                           PIC 9(11)      COMP-3.
  6119     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6120         16  FILLER                        PIC X(10).
  6121         16  AM-VG-KEY3.
  6122             20  AM-VG3-ACCOUNT            PIC X(10).
  6123             20  AM-VG3-EXP-DT             PIC XX.
  6124         16  FILLER                        PIC X(4).
  6125     12  AM-MAINT-INFORMATION.
  6126         16  AM-LAST-MAINT-DT              PIC XX.
  6127         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6128         16  AM-LAST-MAINT-USER            PIC X(4).
  6129         16  FILLER                        PIC XX.
  6130
  6131     12  AM-EFFECTIVE-DT                   PIC XX.
  6132     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6133
  6134     12  AM-PREV-DATES  COMP-3.
  6135         16  AM-PREV-EXP-DT                PIC 9(11).
  6136         16  AM-PREV-EFF-DT                PIC 9(11).
  6137
  6138     12  AM-REPORT-CODE-1                  PIC X(10).
  6139     12  AM-REPORT-CODE-2                  PIC X(10).
  6140
  6141     12  AM-CITY-CODE                      PIC X(4).
  6142     12  AM-COUNTY-PARISH                  PIC X(6).
  6143
  6144     12  AM-NAME                           PIC X(30).
  6145     12  AM-PERSON                         PIC X(30).
  6146     12  AM-ADDRS                          PIC X(30).
  6147     12  AM-CITY.
  6148         16  AM-ADDR-CITY                  PIC X(28).
  6149         16  AM-ADDR-STATE                 PIC XX.
  6150     12  AM-ZIP.
  6151         16  AM-ZIP-PRIME.
  6152             20  AM-ZIP-PRI-1ST            PIC X.
  6153                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6154             20  FILLER                    PIC X(4).
  6155         16  AM-ZIP-PLUS4                  PIC X(4).
  6156     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6157         16  AM-CAN-POSTAL-1               PIC XXX.
  6158         16  AM-CAN-POSTAL-2               PIC XXX.
  6159         16  FILLER                        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 115
* EL050.cbl
  6160     12  AM-TEL-NO.
  6161         16  AM-AREA-CODE                  PIC 999.
  6162         16  AM-TEL-PRE                    PIC 999.
  6163         16  AM-TEL-NBR                    PIC 9(4).
  6164     12  AM-TEL-LOC                        PIC X.
  6165         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6166         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6167
  6168     12  AM-COMM-STRUCTURE.
  6169         16  AM-DEFN-1.
  6170             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6171                 24  AM-AGT.
  6172                     28  AM-AGT-PREFIX     PIC X(4).
  6173                     28  AM-AGT-PRIME      PIC X(6).
  6174                 24  AM-COM-TYP            PIC X.
  6175                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6176                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6177                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6178                 24  AM-RECALC-LV-INDIC    PIC X.
  6179                 24  AM-RETRO-LV-INDIC     PIC X.
  6180                 24  AM-GL-CODES           PIC X.
  6181                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6182                 24  FILLER                PIC X(01).
  6183         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6184             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6185                 24  FILLER                PIC X(11).
  6186                 24  AM-L-COMA             PIC XXX.
  6187                 24  AM-J-COMA             PIC XXX.
  6188                 24  AM-A-COMA             PIC XXX.
  6189                 24  FILLER                PIC X(6).
  6190
  6191     12  AM-COMM-CHANGE-STATUS             PIC X.
  6192         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6193
  6194     12  AM-CSR-CODE                       PIC X(4).
  6195
  6196     12  AM-BILLING-STATUS                 PIC X.
  6197         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6198         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6199     12  AM-AUTO-REFUND-SW                 PIC X.
  6200         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6201         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6202     12  AM-GPCD                           PIC 99.
  6203     12  AM-IG                             PIC X.
  6204         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6205         88  AM-HAS-GROUP                     VALUE '2'.
  6206     12  AM-STATUS                         PIC X.
  6207         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6208         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6209         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6210         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6211         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6212     12  AM-REMIT-TO                       PIC 99.
  6213     12  AM-ID-NO                          PIC X(11).
  6214
  6215     12  AM-CAL-TABLE                      PIC XX.
  6216     12  AM-LF-DEVIATION                   PIC XXX.
  6217     12  AM-AH-DEVIATION                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 116
* EL050.cbl
  6218     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6219     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6220     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6221     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6222     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6223     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6224
  6225     12  AM-USER-FIELDS.
  6226         16  AM-FLD-1                      PIC XX.
  6227         16  AM-FLD-2                      PIC XX.
  6228         16  AM-FLD-3                      PIC XX.
  6229         16  AM-FLD-4                      PIC XX.
  6230         16  AM-FLD-5                      PIC XX.
  6231
  6232     12  AM-1ST-PROD-DATE.
  6233         16  AM-1ST-PROD-YR                PIC XX.
  6234         16  AM-1ST-PROD-MO                PIC XX.
  6235         16  AM-1ST-PROD-DA                PIC XX.
  6236     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6237     12  AM-CERTS-PURGED-DATE.
  6238         16  AM-PUR-YR                     PIC XX.
  6239         16  AM-PUR-MO                     PIC XX.
  6240         16  AM-PUR-DA                     PIC XX.
  6241     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6242     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6243     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6244     12  AM-INACTIVE-DATE.
  6245         16  AM-INA-MO                     PIC 99.
  6246         16  AM-INA-DA                     PIC 99.
  6247         16  AM-INA-YR                     PIC 99.
  6248     12  AM-AR-HI-CERT-DATE                PIC XX.
  6249
  6250     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6251     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6252
  6253     12  AM-OB-PAYMENT-MODE                PIC X.
  6254         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6255         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6256         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6257         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6258
  6259     12  AM-AH-ONLY-INDICATOR              PIC X.
  6260         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6261         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6262
  6263     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6264
  6265     12  AM-OVER-SHORT.
  6266         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6267         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6268
  6269     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6270     12  AM-DCC-CLP-STATE                  PIC XX.
  6271
  6272     12  AM-RECALC-COMM                    PIC X.
  6273     12  AM-RECALC-REIN                    PIC X.
  6274
  6275     12  AM-REI-TABLE                      PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 117
* EL050.cbl
  6276     12  AM-REI-ET-LF                      PIC X.
  6277     12  AM-REI-ET-AH                      PIC X.
  6278     12  AM-REI-PE-LF                      PIC X.
  6279     12  AM-REI-PE-AH                      PIC X.
  6280     12  AM-REI-PRT-ST                     PIC X.
  6281     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6282     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6283     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6284     12  AM-REI-GROUP-A                    PIC X(6).
  6285     12  AM-REI-MORT                       PIC X(4).
  6286     12  AM-REI-PRT-OW                     PIC X.
  6287     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6288     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6289     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6290     12  AM-REI-GROUP-B                    PIC X(6).
  6291
  6292     12  AM-TRUST-TYPE                     PIC X(2).
  6293
  6294     12  AM-EMPLOYER-STMT-USED             PIC X.
  6295     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6296
  6297     12  AM-STD-AH-TYPE                    PIC XX.
  6298     12  AM-EARN-METHODS.
  6299         16  AM-EARN-METHOD-R              PIC X.
  6300             88 AM-REF-RL-R78                 VALUE 'R'.
  6301             88 AM-REF-RL-PR                  VALUE 'P'.
  6302             88 AM-REF-RL-MEAN                VALUE 'M'.
  6303             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6304         16  AM-EARN-METHOD-L              PIC X.
  6305             88 AM-REF-LL-R78                 VALUE 'R'.
  6306             88 AM-REF-LL-PR                  VALUE 'P'.
  6307             88 AM-REF-LL-MEAN                VALUE 'M'.
  6308             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6309         16  AM-EARN-METHOD-A              PIC X.
  6310             88 AM-REF-AH-R78                 VALUE 'R'.
  6311             88 AM-REF-AH-PR                  VALUE 'P'.
  6312             88 AM-REF-AH-MEAN                VALUE 'M'.
  6313             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6314             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6315             88 AM-REF-AH-NET                 VALUE 'N'.
  6316
  6317     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6318     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6319     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6320
  6321     12  AM-RET-Y-N                        PIC X.
  6322     12  AM-RET-P-E                        PIC X.
  6323     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6324     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6325     12  AM-RET-GRP                        PIC X(6).
  6326     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6327         16  AM-POOL-PRIME                 PIC XXX.
  6328         16  AM-POOL-SUB                   PIC XXX.
  6329     12  AM-RETRO-EARNINGS.
  6330         16  AM-RET-EARN-R                 PIC X.
  6331         16  AM-RET-EARN-L                 PIC X.
  6332         16  AM-RET-EARN-A                 PIC X.
  6333     12  AM-RET-ST-TAX-USE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 118
* EL050.cbl
  6334         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6335         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6336     12  AM-RETRO-BEG-EARNINGS.
  6337         16  AM-RET-BEG-EARN-R             PIC X.
  6338         16  AM-RET-BEG-EARN-L             PIC X.
  6339         16  AM-RET-BEG-EARN-A             PIC X.
  6340     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6341     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6342
  6343     12  AM-USER-SELECT-OPTIONS.
  6344         16  AM-USER-SELECT-1              PIC X(10).
  6345         16  AM-USER-SELECT-2              PIC X(10).
  6346         16  AM-USER-SELECT-3              PIC X(10).
  6347         16  AM-USER-SELECT-4              PIC X(10).
  6348         16  AM-USER-SELECT-5              PIC X(10).
  6349
  6350     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6351
  6352     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6353
  6354     12  AM-RPT045A-SWITCH                 PIC X.
  6355         88  RPT045A-OFF                   VALUE 'N'.
  6356
  6357     12  AM-INSURANCE-LIMITS.
  6358         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6359         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6360
  6361     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6362         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6363
  6364     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6365         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6366         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6367
  6368     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6369
  6370     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6371     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6372     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6373     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6374     12  FILLER                            PIC X(5).
  6375     12  AM-REPORT-CODE-3                  PIC X(10).
  6376*    12  FILLER                            PIC X(22).
  6377
  6378     12  AM-RESERVE-DATE.
  6379         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6380         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6381         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6382
  6383     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6384     12  AM-NOTIFICATION-TYPES.
  6385         16  AM-NOTIF-OF-LETTERS           PIC X.
  6386         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6387         16  AM-NOTIF-OF-REPORTS           PIC X.
  6388         16  AM-NOTIF-OF-STATUS            PIC X.
  6389
  6390     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6391         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 119
* EL050.cbl
  6392         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6393         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6394         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6395
  6396     12  AM-BENEFIT-CONTROLS.
  6397         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6398             20  AM-BENEFIT-CODE           PIC XX.
  6399             20  AM-BENEFIT-TYPE           PIC X.
  6400             20  AM-BENEFIT-REVISION       PIC XXX.
  6401             20  AM-BENEFIT-REM-TERM       PIC X.
  6402             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6403             20  FILLER                    PIC XX.
  6404         16  FILLER                        PIC X(80).
  6405
  6406     12  AM-TRANSFER-DATA.
  6407         16  AM-TRANSFERRED-FROM.
  6408             20  AM-TRNFROM-CARRIER        PIC X.
  6409             20  AM-TRNFROM-GROUPING.
  6410                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6411                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6412             20  AM-TRNFROM-STATE          PIC XX.
  6413             20  AM-TRNFROM-ACCOUNT.
  6414                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6415                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6416             20  AM-TRNFROM-DTE            PIC XX.
  6417         16  AM-TRANSFERRED-TO.
  6418             20  AM-TRNTO-CARRIER          PIC X.
  6419             20  AM-TRNTO-GROUPING.
  6420                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6421                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6422             20  AM-TRNTO-STATE            PIC XX.
  6423             20  AM-TRNTO-ACCOUNT.
  6424                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6425                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6426             20  AM-TRNTO-DTE              PIC XX.
  6427         16  FILLER                        PIC X(10).
  6428
  6429     12  AM-SAVED-REMIT-TO                 PIC 99.
  6430
  6431     12  AM-COMM-STRUCTURE-SAVED.
  6432         16  AM-DEFN-1-SAVED.
  6433             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6434                 24  AM-AGT-SV             PIC X(10).
  6435                 24  AM-COM-TYP-SV         PIC X.
  6436                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6437                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6438                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6439                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6440                 24  FILLER                PIC X.
  6441                 24  AM-GL-CODES-SV        PIC X.
  6442                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6443                 24  FILLER                PIC X.
  6444         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6445             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6446                 24  FILLER                PIC X(11).
  6447                 24  AM-L-COMA-SV          PIC XXX.
  6448                 24  AM-J-COMA-SV          PIC XXX.
  6449                 24  AM-A-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 120
* EL050.cbl
  6450                 24  FILLER                PIC X(6).
  6451
  6452     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6453         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6454            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6455            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6456            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6457
  6458     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6459     12  FILLER                            PIC X(120).
  6460
  6461     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6462         16  AM-CONTROL-NAME               PIC X(30).
  6463         16  AM-EXECUTIVE-ONE.
  6464             20  AM-EXEC1-NAME             PIC X(15).
  6465             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6466                                                          COMP-3.
  6467             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6468                                                          COMP-3.
  6469         16  AM-EXECUTIVE-TWO.
  6470             20  AM-EXEC2-NAME             PIC X(15).
  6471             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6472                                                          COMP-3.
  6473             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6474                                                          COMP-3.
  6475
  6476     12  AM-RETRO-ADDITIONAL-DATA.
  6477         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6478         16  AM-RETRO-PREM-P-E             PIC X.
  6479         16  AM-RETRO-CLMS-P-I             PIC X.
  6480         16  AM-RETRO-RET-BRACKET-LF.
  6481             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6482                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6483                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6484             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6485                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6486                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6487             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6488                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6489                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6490         16  AM-RETRO-RET-BRACKET-AH.
  6491             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6492                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6493                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6494                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6495             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6496                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6497                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6498             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6499                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6500                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6501
  6502     12  AM-COMMENTS.
  6503         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6504
  6505     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6506         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6507         16  AM-FLI-BILLING-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 121
* EL050.cbl
  6508         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6509         16  AM-FLI-UNITED-IDENT           PIC X.
  6510         16  AM-FLI-INTEREST-LOST-DATA.
  6511             20  AM-FLI-BANK-NO            PIC X(5).
  6512             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6513             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6514             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6515         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6516             20  AM-FLI-AGT                PIC X(9).
  6517             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6518             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6519         16  FILLER                        PIC X(102).
  6520
  6521     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6522         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6523             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6524             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6525             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6526             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6527             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6528         16  FILLER                          PIC X(10).
  6529******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 122
* EL050.cbl
  6531*    COPY ERCREIN.
  6532******************************************************************
  6533*                                                                *
  6534*                            ERCREIN                             *
  6535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6536*                            VMOD=2.010                          *
  6537*                                                                *
  6538*   ONLINE CREDIT SYSTEM                                         *
  6539*                                                                *
  6540*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6541*                                                                *
  6542*   FILE TYPE = VSAM,KSDS                                        *
  6543*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6544*                                                                *
  6545*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6546*       ALTERNATE PATH = NONE                                    *
  6547*                                                                *
  6548*   LOG = NO                                                     *
  6549*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6550*                                                                *
  6551******************************************************************
  6552*                   C H A N G E   L O G
  6553*
  6554* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6555*-----------------------------------------------------------------
  6556*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6557* EFFECTIVE    NUMBER
  6558*-----------------------------------------------------------------
  6559* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6560* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6561******************************************************************
  6562 01  REINSURANCE-RECORD.
  6563     12  RE-RECORD-ID                      PIC XX.
  6564         88  VALID-RE-ID                      VALUE 'RE'.
  6565
  6566     12  RE-CONTROL-PRIMARY.
  6567         16  RE-COMPANY-CD                 PIC X.
  6568         16  RE-KEY.
  6569             20  RE-CODE                   PIC X.
  6570                 88  RE-TABLE-RECORD          VALUE 'A'.
  6571                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6572             20  RE-TABLE                  PIC XXX.
  6573             20  FILLER                    PIC XXX.
  6574         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6575             20  FILLER                    PIC X.
  6576             20  RE-COMPANY.
  6577                 24  RE-COMP-PRIME         PIC XXX.
  6578                 24  RE-COMP-SUB           PIC XXX.
  6579
  6580     12  RE-MAINT-INFORMATION.
  6581         16  RE-LAST-MAINT-DT              PIC XX.
  6582         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6583         16  RE-LAST-MAINT-USER            PIC X(4).
  6584         16  FILLER                        PIC X(10).
  6585
  6586     12  RE-TABLE-DATA.
  6587         16  RE-100-COMP                   PIC 99.
  6588
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 123
* EL050.cbl
  6589         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6590             20  RE-REI-COMP-NO.
  6591                 24  RE-REI-COMP           PIC XXX.
  6592                 24  RE-REI-COMP-SUB       PIC XXX.
  6593             20  RE-LF-QC                  PIC X.
  6594             20  RE-AH-QC                  PIC X.
  6595             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6596             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6597             20  RE-LFAGE-LO               PIC 99.
  6598             20  RE-LFAGE-HI               PIC 99.
  6599             20  RE-AHAGE-LO               PIC 99.
  6600             20  RE-AHAGE-HI               PIC 99.
  6601             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6602             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6603             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6604             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6605             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6606             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6607             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6608             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6609             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6610             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6611             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6612             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6613             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6614             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6615             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6616             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6617             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6618             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6619             20  RE-LF-BEN-CODE            PIC X.
  6620             20  RE-AH-BEN-CODE            PIC X.
  6621             20  RE-INTERACTIVE            PIC X.
  6622             20  RE-REMAINING              PIC X.
  6623             20  RE-LF-RUNOFF-SW           PIC X.
  6624             20  RE-AH-RUNOFF-SW           PIC X.
  6625             20  FILLER                    PIC X(19).
  6626
  6627         16  RE-COMP-INFO-END              PIC X(6).
  6628         16  RE-NSP-ST-CD-LF               PIC XX.
  6629         16  RE-NSP-ST-CD-AH               PIC XX.
  6630         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6631             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6632
  6633         16  FILLER                        PIC X(27).
  6634
  6635     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6636         16  RE-NAME                       PIC X(30).
  6637         16  RE-LF-PE                      PIC X.
  6638         16  RE-AH-PE                      PIC X.
  6639         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6640         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6641         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6642         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6643         16  RE-PRT-ST                     PIC X.
  6644         16  RE-PRT-OW                     PIC X.
  6645         16  RE-MORT-CODE                  PIC X(4).
  6646         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 124
* EL050.cbl
  6647         16  RE-ZERO-LF-FEE                PIC X.
  6648         16  RE-ZERO-AH-FEE                PIC X.
  6649         16  RE-CEDE-NAME                  PIC X(30).
  6650         16  RE-LF-COMM                    PIC X.
  6651         16  RE-AH-COMM                    PIC X.
  6652         16  RE-LF-TAX                     PIC X.
  6653         16  RE-AH-TAX                     PIC X.
  6654         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6655         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6656         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6657
  6658         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6659             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6660
  6661         16  RE-LF-CEDING-FEE-BRACKETS.
  6662             20  RE-LF-FEE-METHOD          PIC X.
  6663                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6664                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6665                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6666                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6667             20  RE-LF-FEE-BASIS           PIC X.
  6668                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6669                 88  RE-LF-NET-CEDED               VALUE '2'.
  6670                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6671                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6672                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6673                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6674                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6675                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6676             20  FILLER                    PIC XXX.
  6677             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6678                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6679                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6680
  6681         16  RE-AH-CEDING-FEE-BRACKETS.
  6682             20  RE-AH-FEE-METHOD          PIC X.
  6683                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6684                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6685                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6686                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6687             20  RE-AH-FEE-BASIS           PIC X.
  6688                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6689                 88  RE-AH-NET-CEDED               VALUE '2'.
  6690                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6691                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6692                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6693                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6694                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6695                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6696             20  FILLER                    PIC XXX.
  6697             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6698                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6699                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6700
  6701         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6702
  6703         16  RE-OLD-CEDING-STMT            PIC X.
  6704
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 125
* EL050.cbl
  6705         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6706         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6707         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6708         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6709         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6710         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6711         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6712         16  RE-MORT-SW                    PIC X.
  6713         16  RE-CEDING-TYPE-FLAG           PIC X.
  6714             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6715             88  RE-CEDED                          VALUE 'C'.
  6716             88  RE-ASSUMED                        VALUE 'A'.
  6717             88  RE-PHANTOM                        VALUE 'P'.
  6718
  6719         16  RE-CEDING-STMT-OPT-A          PIC X.
  6720             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6721         16  RE-CEDING-STMT-OPT-B          PIC X.
  6722             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6723         16  RE-CEDING-STMT-OPT-C          PIC X.
  6724             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6725         16  RE-CEDING-STMT-OPT-D          PIC X.
  6726             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6727         16  RE-CEDING-STMT-OPT-E          PIC X.
  6728             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6729
  6730         16  RE-PRT-CRSV                   PIC X.
  6731
  6732         16  RE-GL-CENTER                  PIC X(4).
  6733
  6734         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6735
  6736         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6737
  6738         16  RE-EARN-STOP-CODE             PIC X.
  6739             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6740             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6741
  6742         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6743             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6744
  6745         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6746         16  FILLER                        PIC X(2281).
  6747
  6748         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6749
  6750******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 126
* EL050.cbl
  6752*    COPY ERCCTBL.
  6753******************************************************************
  6754*                                                                *
  6755*                                                                *
  6756*                            ERCCTBL                             *
  6757*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6758*                            VMOD=2.003
  6759*                                                                *
  6760*   ONLINE CREDIT SYSTEM                                         *
  6761*                                                                *
  6762*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  6763*                                                                *
  6764*   FILE TYPE = VSAM,KSDS                                        *
  6765*   RECORD SIZE = 200   RECFORM = FIXED                          *
  6766*                                                                *
  6767*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  6768*       ALTERNATE PATH = NONE                                    *
  6769*                                                                *
  6770*   LOG = NO                                                     *
  6771*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6772*                                                                *
  6773*                                                                *
  6774******************************************************************
  6775
  6776 01  COMM-TABLE-RECORD.
  6777     12  CT-RECORD-ID                      PIC XX.
  6778         88  VALID-CT-ID                      VALUE 'CT'.
  6779
  6780     12  CT-CONTROL-PRIMARY.
  6781         16  CT-COMPANY-CD                 PIC X.
  6782         16  CT-TABLE                      PIC XXX.
  6783         16  CT-CNTRL-2.
  6784             20  CT-BEN-TYPE               PIC X.
  6785             20  CT-BEN-CODE               PIC XX.
  6786
  6787     12  CT-MAINT-INFORMATION.
  6788         16  CT-LAST-MAINT-DT              PIC XX.
  6789         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6790         16  CT-LAST-MAINT-USER            PIC X(4).
  6791         16  FILLER                        PIC X(31).
  6792
  6793     12  CT-LIMITS.
  6794         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  6795
  6796         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  6797
  6798         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  6799
  6800     12  CT-RATES.
  6801         16  CT-RTX          OCCURS 27 TIMES.
  6802             20  CT-RT                     PIC SV9(5)     COMP-3.
  6803             20  CT-RT-R   REDEFINES
  6804                 CT-RT                     PIC XXX.
  6805
  6806     12  FILLER                            PIC  X(42).
  6807
  6808******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 127
* EL050.cbl
  6810*    COPY ERCFORM.
  6811******************************************************************
  6812*                                                                *
  6813*                                                                *
  6814*                            ERCFORM.                            *
  6815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6816*                            VMOD=2.003                          *
  6817*                                                                *
  6818*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  6819*                                                                *
  6820*    FILE TYPE = VSAM,KSDS                                       *
  6821*    RECORD SIZE = 500  RECFORM = FIXED                          *
  6822*                                                                *
  6823*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  6824*                                                                *
  6825*    LOG = YES                                                   *
  6826*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6827******************************************************************
  6828 01  FORM-MASTER.
  6829    12  FO-RECORD-ID                 PIC X(02).
  6830        88  VALID-FO-ID                  VALUE 'FO'.
  6831
  6832    12  FO-CONTROL-PRIMARY.
  6833        16  FO-COMPANY-CD            PIC X(01).
  6834        16  FO-STATE                 PIC X(02).
  6835        16  FO-FORM-ID               PIC X(12).
  6836        16  FO-FORM-EXP-DT           PIC X(02).
  6837
  6838    12  FO-POLICY-FORM-DATA.
  6839        16  FO-IND-GRP-CD            PIC X(01).
  6840        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  6841        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  6842        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  6843        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  6844        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  6845        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  6846        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  6847        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  6848        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  6849        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  6850        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  6851        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  6852        16  FO-DIS-DEF-TYPE          PIC 9(02).
  6853        16  FO-DISMEMBERMENT-CD      PIC X(01).
  6854        16  FO-APP-CERT-USE-CD       PIC X(01).
  6855
  6856    12  FILLER                       PIC X(29).
  6857
  6858    12  FO-FORM-PLAN-TABLE.
  6859        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  6860            20  FO-PLAN-TYPE         PIC X(01).
  6861            20  FO-PLAN-ID           PIC X(02).
  6862            20  FO-PLAN-TERM         PIC 9(03).
  6863            20  FO-PLAN-REFUND-METHOD
  6864                                     PIC X.
  6865
  6866    12  FILLER                       PIC X(30).
  6867
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 128
* EL050.cbl
  6868    12  FO-COMMENTS-AREA.
  6869        16  FO-COMMENT-LINE-1        PIC X(78).
  6870
  6871    12  FILLER                       PIC X(20).
  6872
  6873    12  FO-MAINT-INFORMATION.
  6874        16  FO-LAST-MAINT-DT         PIC X(02).
  6875        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  6876        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 129
* EL050.cbl
  6878*    COPY ELCMSTR.
  6879******************************************************************
  6880*                                                                *
  6881*                            ELCMSTR.                            *
  6882*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6883*                            VMOD=2.012                          *
  6884*                                                                *
  6885*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  6886*                                                                *
  6887*   FILE TYPE = VSAM,KSDS                                        *
  6888*   RECORD SIZE = 350  RECFORM = FIXED                           *
  6889*                                                                *
  6890*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  6891*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  6892*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  6893*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  6894*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  6895*                                                 RKP=75,LEN=21  *
  6896*                                                                *
  6897*   **** NOTE ****                                               *
  6898*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  6899*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  6900*                                                                *
  6901*   LOG = YES                                                    *
  6902*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6903******************************************************************
  6904*                   C H A N G E   L O G
  6905*
  6906* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6907*-----------------------------------------------------------------
  6908*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6909* EFFECTIVE    NUMBER
  6910*-----------------------------------------------------------------
  6911* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  6912* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  6913******************************************************************
  6914 01  CLAIM-MASTER.
  6915     12  CL-RECORD-ID                PIC XX.
  6916         88  VALID-CL-ID         VALUE 'CL'.
  6917
  6918     12  CL-CONTROL-PRIMARY.
  6919         16  CL-COMPANY-CD           PIC X.
  6920         16  CL-CARRIER              PIC X.
  6921         16  CL-CLAIM-NO             PIC X(7).
  6922         16  CL-CERT-NO.
  6923             20  CL-CERT-PRIME       PIC X(10).
  6924             20  CL-CERT-SFX         PIC X.
  6925
  6926     12  CL-CONTROL-BY-NAME.
  6927         16  CL-COMPANY-CD-A1        PIC X.
  6928         16  CL-INSURED-LAST-NAME    PIC X(15).
  6929         16  CL-INSURED-NAME.
  6930             20  CL-INSURED-1ST-NAME PIC X(12).
  6931             20  CL-INSURED-MID-INIT PIC X.
  6932
  6933     12  CL-CONTROL-BY-SSN.
  6934         16  CL-COMPANY-CD-A2        PIC X.
  6935         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 130
* EL050.cbl
  6936             20  CL-SSN-STATE        PIC XX.
  6937             20  CL-SSN-ACCOUNT      PIC X(6).
  6938             20  CL-SSN-LN3          PIC X(3).
  6939
  6940     12  CL-CONTROL-BY-CERT-NO.
  6941         16  CL-COMPANY-CD-A4        PIC X.
  6942         16  CL-CERT-NO-A4.
  6943             20  CL-CERT-A4-PRIME    PIC X(10).
  6944             20  CL-CERT-A4-SFX      PIC X.
  6945
  6946     12  CL-CONTROL-BY-CCN.
  6947         16  CL-COMPANY-CD-A5        PIC X.
  6948         16  CL-CCN-A5.
  6949             20  CL-CCN.
  6950                 24  CL-CCN-PREFIX-A5 PIC X(4).
  6951                 24  CL-CCN-PRIME-A5 PIC X(12).
  6952             20  CL-CCN-FILLER-A5    PIC X(4).
  6953
  6954     12  CL-INSURED-PROFILE-DATA.
  6955         16  CL-INSURED-BIRTH-DT     PIC XX.
  6956         16  CL-INSURED-SEX-CD       PIC X.
  6957             88  INSURED-IS-MALE        VALUE 'M'.
  6958             88  INSURED-IS-FEMALE      VALUE 'F'.
  6959             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  6960         16  CL-INSURED-OCC-CD       PIC X(6).
  6961         16  FILLER                  PIC X(5).
  6962
  6963     12  CL-PROCESSING-INFO.
  6964         16  CL-PROCESSOR-ID         PIC X(4).
  6965         16  CL-CLAIM-STATUS         PIC X.
  6966             88  CLAIM-IS-OPEN          VALUE 'O'.
  6967             88  CLAIM-IS-CLOSED        VALUE 'C'.
  6968         16  CL-CLAIM-TYPE           PIC X.
  6969*            88  AH-CLAIM               VALUE 'A'.
  6970*            88  LIFE-CLAIM             VALUE 'L'.
  6971*            88  PROPERTY-CLAIM         VALUE 'P'.
  6972*            88  IUI-CLAIM              VALUE 'I'.
  6973*            88  GAP-CLAIM              VALUE 'G'.
  6974         16  CL-CLAIM-PREM-TYPE      PIC X.
  6975             88  SINGLE-PREMIUM         VALUE '1'.
  6976             88  O-B-COVERAGE           VALUE '2'.
  6977             88  OPEN-END-COVERAGE      VALUE '3'.
  6978         16  CL-INCURRED-DT          PIC XX.
  6979         16  CL-REPORTED-DT          PIC XX.
  6980         16  CL-FILE-ESTABLISH-DT    PIC XX.
  6981         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  6982         16  CL-LAST-PMT-DT          PIC XX.
  6983         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  6984         16  CL-PAID-THRU-DT         PIC XX.
  6985         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  6986         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  6987         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  6988         16  CL-PMT-CALC-METHOD      PIC X.
  6989             88  CL-360-DAY-YR          VALUE '1'.
  6990             88  CL-365-DAY-YR          VALUE '2'.
  6991             88  CL-FULL-MONTHS         VALUE '3'.
  6992         16  CL-CAUSE-CD             PIC X(6).
  6993
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 131
* EL050.cbl
  6994         16  CL-PRIME-CERT-NO.
  6995             20  CL-PRIME-CERT-PRIME PIC X(10).
  6996             20  CL-PRIME-CERT-SFX   PIC X.
  6997
  6998         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  6999             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7000             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7001
  7002         16  CL-MICROFILM-NO         PIC X(10).
  7003         16  CL-PROG-FORM-TYPE       PIC X.
  7004         16  CL-LAST-ADD-ON-DT       PIC XX.
  7005
  7006         16  CL-LAST-REOPEN-DT       PIC XX.
  7007         16  CL-LAST-CLOSE-DT        PIC XX.
  7008         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7009             88  FINAL-PAID             VALUE '1'.
  7010             88  CLAIM-DENIED           VALUE '2'.
  7011             88  AUTO-CLOSE             VALUE '3'.
  7012             88  MANUAL-CLOSE           VALUE '4'.
  7013             88  BENEFITS-CHANGED       VALUE 'C'.
  7014             88  SETUP-ERRORS           VALUE 'E'.
  7015         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7016         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7017         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7018             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7019         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7020         16  FILLER                  PIC X.
  7021
  7022     12  CL-CERTIFICATE-DATA.
  7023         16  CL-CERT-ORIGIN          PIC X.
  7024             88  CERT-WAS-ONLINE        VALUE '1'.
  7025             88  CERT-WAS-CREATED       VALUE '2'.
  7026             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7027         16  CL-CERT-KEY-DATA.
  7028             20  CL-CERT-CARRIER     PIC X.
  7029             20  CL-CERT-GROUPING    PIC X(6).
  7030             20  CL-CERT-STATE       PIC XX.
  7031             20  CL-CERT-ACCOUNT.
  7032                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7033                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7034             20  CL-CERT-EFF-DT      PIC XX.
  7035
  7036     12  CL-STATUS-CONTROLS.
  7037         16  CL-PRIORITY-CD          PIC X.
  7038             88  CONFIDENTIAL-DATA      VALUE '8'.
  7039             88  HIGHEST-PRIORITY       VALUE '9'.
  7040         16  CL-SUPV-ATTN-CD         PIC X.
  7041             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7042             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7043         16  CL-PURGED-DT            PIC XX.
  7044         16  CL-RESTORED-DT          PIC XX.
  7045         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7046         16  CL-NEXT-RESEND-DT       PIC XX.
  7047         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7048         16  FILLER                  PIC XX.
  7049         16  CL-LAST-MAINT-DT        PIC XX.
  7050         16  CL-LAST-MAINT-USER      PIC X(4).
  7051         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 132
* EL050.cbl
  7052         16  CL-LAST-MAINT-TYPE      PIC X.
  7053             88  CLAIM-SET-UP           VALUE ' '.
  7054             88  PAYMENT-MADE           VALUE '1'.
  7055             88  LETTER-SENT            VALUE '2'.
  7056             88  MASTER-WAS-ALTERED     VALUE '3'.
  7057             88  MASTER-WAS-RESTORED    VALUE '4'.
  7058             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7059             88  FILE-CONVERTED         VALUE '6'.
  7060             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7061             88  ERROR-CORRECTION       VALUE 'E'.
  7062         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7063         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7064         16  CL-BENEFICIARY          PIC X(10).
  7065         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7066         16  CL-DENIAL-TYPE          PIC X.
  7067             88  CL-TYPE-DENIAL          VALUE '1'.
  7068             88  CL-TYPE-RESCISSION      VALUE '2'.
  7069             88  CL-TYPE-REFORMATION     VALUE '3'.
  7070             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7071             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7072         16  FILLER                  PIC X(5).
  7073
  7074     12  CL-TRAILER-CONTROLS.
  7075         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7076             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7077             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7078             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7079         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7080         16  FILLER                  PIC XX.
  7081         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7082         16  CL-ADDRESS-TRAILER-CNT.
  7083             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7084                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7085             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7086                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7087             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7088                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7089             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7090                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7091             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7092                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7093             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7094                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7095             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7096                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7097
  7098     12  CL-CV-REFERENCE-NO.
  7099         16  CL-CV-REFNO-PRIME       PIC X(18).
  7100         16  CL-CV-REFNO-SFX         PIC XX.
  7101
  7102     12  CL-FILE-LOCATION            PIC X(4).
  7103
  7104     12  CL-PROCESS-ERRORS.
  7105         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7106             88  NO-FATAL-ERRORS        VALUE ZERO.
  7107         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7108             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7109
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 133
* EL050.cbl
  7110     12  CL-PRODUCT-CD               PIC X.
  7111
  7112     12  CL-CURRENT-KEY-DATA.
  7113         16  CL-CURRENT-CARRIER      PIC X.
  7114         16  CL-CURRENT-GROUPING     PIC X(6).
  7115         16  CL-CURRENT-STATE        PIC XX.
  7116         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7117
  7118     12  CL-ASSOCIATES               PIC X.
  7119         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7120         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7121         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7122         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7123
  7124     12  CL-ACTIVITY-CODE            PIC 99.
  7125     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7126     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7127
  7128     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7129     12  CL-LAG-REPORT-CODE          PIC 9.
  7130     12  CL-LOAN-TYPE                PIC XX.
  7131     12  CL-LEGAL-STATE              PIC XX.
  7132
  7133*    12  FILLER                      PIC X(5).
  7134     12  CL-YESNOSW                  PIC X.
  7135     12  FILLER                      PIC X(4).
  7136
  7137 01  PLAN-RECORDS.
  7138     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7139     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7140
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 134
* EL050.cbl
  7142 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7143                          ACCOUNT-MASTER REINSURANCE-RECORD
  7144                          COMM-TABLE-RECORD FORM-MASTER
  7145                          CLAIM-MASTER PLAN-RECORDS.
  7146 0000-DFHEXIT SECTION.
  7147     MOVE '9#                    $   ' TO DFHEIV0.
  7148     MOVE 'EL050' TO DFHEIV1.
  7149     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7150
  7151     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7152
  7153
  7154* EXEC CICS  HANDLE CONDITION
  7155*           ERROR    (9300-ABEND)
  7156*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7157*    END-EXEC.
  7158*    MOVE '"$.J                  ! " #00007149' TO DFHEIV0
  7159     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7160     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7161     MOVE X'2220233030303037313439' TO DFHEIV0(25:11)
  7162     CALL 'kxdfhei1' USING DFHEIV0
  7163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7164
  7165
  7166 0000-COPY-PROCEDURE-DIV.
  7167*                          COPY ELC50PD.
  7168******************************************************************
  7169*                                                                *
  7170*                            ELC50PD                             *
  7171*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7172*                            VMOD=2.188                          *
  7173*                                                                *
  7174******************************************************************
  7175*                   C H A N G E   L O G
  7176*
  7177* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7178*-----------------------------------------------------------------
  7179*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7180* EFFECTIVE    NUMBER
  7181*-----------------------------------------------------------------
  7182* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7183* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7184* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7185*                             2709 AND 2718
  7186* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7187* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7188* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7189* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7190* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7191*                                IS OPEN OR CNC DT < PD THRU
  7192* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7193* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7194* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7195* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7196* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7197* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7198* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7199* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 135
* EL050.cbl
  7200* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7201* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7202* 020906                   PEMA  EXPAND LOAN OFFICER
  7203* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7204* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7205* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7206* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7207* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7208* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7209* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7210* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7211* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7212* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7213* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7214* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7215* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7216* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7217* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7218* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7219* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7220* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7221* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7222* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7223* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7224* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7225* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7226* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7227* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7228*                                UPDATE VIN ON CERT TRAILER
  7229* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7230* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7231* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7232* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7233* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7234* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7235* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7236* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7237* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7238* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7239* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7240* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7241* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7242* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7243* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7244* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7245* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7246* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7247* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7248******************************************************************
  7249************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7250******************************************************************
  7251
  7252     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7253
  7254     MOVE SPACES                 TO PB-FATAL-FLAG
  7255                                    PB-FORCE-ER-CD
  7256                                    PB-WARN-ER-CD
  7257                                    PB-OUT-BAL-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 136
* EL050.cbl
  7258
  7259     MOVE SPACE                  TO WS-IG-OVRD-AH
  7260                                    WS-IG-OVRD-LF
  7261                                    WS-IG-OVRD-AM
  7262                                    WS-IG-OVRD
  7263                                    WS-IG-OVRD-AH-PL
  7264                                    WS-IG-OVRD-LF-PL
  7265                                    WS-IG-OVRD-AH-BEN
  7266                                    WS-IG-OVRD-LF-BEN.
  7267
  7268******************************************************************
  7269*************       INITIALIZE COMMON ERRORS       ***************
  7270******************************************************************
  7271
  7272     MOVE +0                     TO PB-NO-OF-ERRORS.
  7273     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7274
  7275******************************************************************
  7276
  7277     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7278     SET JULIAN-TO-BIN           TO TRUE.
  7279*    MOVE 5                      TO DC-OPTION-CODE.
  7280     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7281     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7282
  7283     MOVE ZERO                   TO  SUB4.
  7284
  7285 0040-INITIALIZE-GA-BILL-DT.
  7286
  7287     ADD +1                      TO  SUB4.
  7288
  7289     IF  SUB4 GREATER THAN +5
  7290         GO TO 0050-CHECK-CNTL-FOUND.
  7291
  7292     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7293         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7294
  7295     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7296
  7297 0050-CHECK-CNTL-FOUND.
  7298
  7299     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7300        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7301                                         WS-AH-REM-TERM-CALC
  7302                                         EC-CO-REM-TERM-CALC
  7303        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7304        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7305        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7306                                         WS-TOL-AH-CLAIM
  7307        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7308                                         WS-TOL-AH-PREM
  7309                                         EC-CO-TOL-PREM
  7310        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7311                                         WS-TOL-AH-REFUND
  7312                                         EC-CO-TOL-REFUND
  7313        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7314                                         WS-AH-REFUND-OVS-AMT
  7315                                         EC-CO-OVR-SHT-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 137
* EL050.cbl
  7316        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7317                                         WS-TOL-AH-PREM-PCT
  7318                                         EC-CO-TOL-PREM-PCT
  7319        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7320                                         WS-TOL-AH-REFUND-PCT
  7321                                         EC-CO-TOL-REFUND-PCT
  7322        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7323                                         WS-AH-REFUND-OVS-PCT
  7324                                         EC-CO-OVR-SHT-PCT
  7325        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7326        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7327        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7328        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7329        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7330        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7331        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7332        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7333        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7334        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7335        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7336        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7337                                         EC-CO-MONTH-END-DT
  7338        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7339          GO TO 0100-READ-ACCT.
  7340
  7341     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7342     MOVE SPACES                 TO CNTL-ACCESS.
  7343     MOVE '1'                    TO CNTL-REC-TYPE.
  7344     MOVE +0                     TO CNTL-SEQ-NO.
  7345
  7346     MOVE '1' TO RC-SW-1.
  7347     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7348     IF NOT CF-COMPANY-MASTER
  7349         MOVE ZEROS             TO WK-CO-TOL-PREM
  7350                                   WK-CO-TOL-CLAIM
  7351                                   WK-CO-TOL-REFUND
  7352                                   WK-REFUND-OVS-AMT
  7353                                   WK-REFUND-OVS-PCT
  7354                                   WK-CO-TOL-PREM-PCT
  7355                                   WK-CO-TOL-REFUND-PCT
  7356                                   WK-DEFAULT-APR
  7357                                   WK-CO-MAX-CAP
  7358        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7359                                   WK-CR-R78-METHOD
  7360                                   WK-CO-REF-REJECT-SW
  7361                                   WK-CO-PREM-REJECT-SW
  7362                                   WK-REM-TRM-CALC-OPTION
  7363                                   WK-BIRTH-DATE-INPUT
  7364                                   WK-JOINT-AGE-INPUT
  7365        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7366        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7367        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7368        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7369          GO TO 0099-COMPANY-NOT-FOUND.
  7370
  7371     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7372        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7373     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 138
* EL050.cbl
  7374        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7375     IF CF-CO-TOL-CAP NOT NUMERIC
  7376        MOVE +0                    TO CF-CO-TOL-CAP.
  7377     IF CF-DEFAULT-APR NOT NUMERIC
  7378        MOVE +0                    TO CF-DEFAULT-APR.
  7379
  7380     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7381     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7382     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7383     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7384     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7385     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7386     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7387     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7388     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7389     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7390     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7391     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7392
  7393     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7394          CF-CO-OVR-SHT-AMT > +0
  7395        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7396
  7397     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7398          CF-CO-OVR-SHT-PCT > +0
  7399        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7400
  7401     IF CF-VALID-REM-TRM-OPTION
  7402         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7403     ELSE
  7404         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7405
  7406     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7407     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7408     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7409     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7410
  7411     GO TO 0050-CHECK-CNTL-FOUND.
  7412
  7413 0099-COMPANY-NOT-FOUND.
  7414
  7415     MOVE ER-2616                TO WS-ERROR.
  7416     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7417
  7418 0100-READ-ACCT.
  7419
  7420     MOVE SPACES                 TO DATE-RANGE-SW.
  7421
  7422     IF WK-ACCT-ADDR = ZEROS
  7423        GO TO 0102-ACCT-GETMAIN.
  7424
  7425     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7426     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7427     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7428
  7429     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7430        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7431        GO TO 0105-READ-ACCT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 139
* EL050.cbl
  7432     END-IF
  7433
  7434     IF PB-CARRIER NOT = SPACES
  7435        IF PB-CARRIER NOT = AM-VG-CARRIER
  7436           GO TO 0105-READ-ACCT.
  7437
  7438     IF PB-STATE NOT = SPACES
  7439        IF PB-STATE NOT = AM-VG-STATE
  7440           GO TO 0105-READ-ACCT.
  7441
  7442     IF PB-GROUPING NOT = SPACES
  7443        IF PB-GROUPING NOT = AM-VG-GROUPING
  7444           GO TO 0105-READ-ACCT.
  7445
  7446     MOVE 'X'                 TO DATE-RANGE-SW.
  7447
  7448     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7449        MOVE 'X'                 TO DATE-RANGE-SW
  7450        GO TO 0105-READ-ACCT.
  7451
  7452     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7453        GO TO 0105-READ-ACCT.
  7454
  7455     GO TO 0180-ACCOUNT-FOUND.
  7456
  7457 0102-ACCT-GETMAIN.
  7458     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7459     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7460
  7461 0105-READ-ACCT.
  7462     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7463     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7464     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7465     MOVE PB-STATE               TO ACCT-STATE.
  7466     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7467     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7468
  7469     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7470
  7471     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7472
  7473 0110-FIND-ACCT-TOLERANCES-LOOP.
  7474     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7475
  7476     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7477        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7478        GO TO 0199-ACCT-NOT-FOUND
  7479     END-IF
  7480     IF PB-CARRIER NOT = SPACES
  7481        IF PB-CARRIER NOT = AM-VG-CARRIER
  7482           GO TO 0199-ACCT-NOT-FOUND.
  7483
  7484     IF PB-STATE NOT = SPACES
  7485        IF PB-STATE NOT = AM-VG-STATE
  7486           GO TO 0199-ACCT-NOT-FOUND.
  7487
  7488     IF PB-GROUPING NOT = SPACES
  7489        IF PB-GROUPING NOT = AM-VG-GROUPING
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 140
* EL050.cbl
  7490           GO TO 0199-ACCT-NOT-FOUND.
  7491
  7492     MOVE 'X'                    TO DATE-RANGE-SW.
  7493
  7494     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7495        MOVE 'X'                 TO DATE-RANGE-SW
  7496        GO TO 0199-ACCT-NOT-FOUND.
  7497
  7498     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7499        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7500
  7501 0180-ACCOUNT-FOUND.
  7502     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7503     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7504     MOVE AM-STATE               TO PB-SV-STATE.
  7505     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7506
  7507     IF AM-CANCEL-FEE  NOT NUMERIC
  7508        MOVE ZEROS TO AM-CANCEL-FEE.
  7509
  7510     IF AM-MAX-MON-BEN NOT NUMERIC
  7511        MOVE ZEROS TO AM-MAX-MON-BEN.
  7512
  7513     IF AM-MAX-TOT-BEN NOT NUMERIC
  7514        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7515
  7516     IF AM-CLP-TOL-PCT NOT NUMERIC
  7517        MOVE +0                  TO AM-CLP-TOL-PCT
  7518     END-IF
  7519     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7520        MOVE +0                  TO AM-SPP-LEASE-COMM
  7521     END-IF
  7522     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7523        MOVE ER-2611             TO   WS-ERROR
  7524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7525
  7526     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7527        MOVE ER-2621             TO   WS-ERROR
  7528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7529
  7530     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7531        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7532        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7533        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7534         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7535
  7536     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7537     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7538     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7539     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7540     IF AM-CLP-TOL-PCT NOT = ZEROS
  7541        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7542     END-IF
  7543     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7544        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7545     END-IF
  7546     IF PB-COMPANY-ID = 'DCC'
  7547        MOVE +0                  TO WS-ACCT-ADDL-CLP
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 141
* EL050.cbl
  7548                                    WS-ACCT-I-CLP
  7549        PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7550           (SUB5 > +10)
  7551           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J')
  7552              AND (AM-A-COM (SUB5) NUMERIC)
  7553              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7554                 + (AM-A-COM (SUB5) * 1000)
  7555              IF AM-COM-TYP (SUB5) = 'I'
  7556                 COMPUTE WS-ACCT-I-CLP = WS-ACCT-I-CLP
  7557                 + (AM-A-COM (SUB5) * 1000)
  7558              END-IF
  7559           END-IF
  7560        END-PERFORM
  7561     END-IF
  7562
  7563     IF PB-COMPANY-ID EQUAL 'CRI'
  7564         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7565
  7566     IF PB-COMPANY-ID EQUAL 'NCL'
  7567         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7568     END-IF
  7569
  7570     GO TO 0200-READ-CERT.
  7571
  7572 0199-ACCT-NOT-FOUND.
  7573
  7574     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7575
  7576     IF DATE-RANGE-SW NOT = SPACES
  7577        MOVE ER-2601             TO WS-ERROR
  7578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7579     ELSE
  7580        MOVE ER-2619             TO WS-ERROR
  7581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7582
  7583     GO TO 9990-RETURN.
  7584
  7585 0200-READ-CERT.
  7586
  7587     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7588     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7589     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7590     MOVE PB-SV-STATE            TO CERT-STATE.
  7591     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7592     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7593     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7594
  7595     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7596
  7597     IF CERT-WAS-NOT-FOUND
  7598        GO TO 0299-CERT-NOT-FOUND.
  7599
  7600     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7601        MOVE ER-2759             TO WS-ERROR
  7602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7603        GO TO 0298-UNLOCK-RETURN.
  7604
  7605     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 142
* EL050.cbl
  7606         MOVE ER-2758            TO WS-ERROR
  7607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7608         GO TO 0298-UNLOCK-RETURN.
  7609
  7610     IF PB-ISSUE
  7611        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7612           IF CERT-WAS-CREATED-FOR-CLAIM
  7613              NEXT SENTENCE
  7614            ELSE
  7615              MOVE ER-2626       TO WS-ERROR
  7616              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7617              GO TO 0298-UNLOCK-RETURN.
  7618
  7619     IF NOT PB-CANCELLATION
  7620        GO TO 0300-CONTINUE-EDIT.
  7621
  7622     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  7623     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  7624     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  7625     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  7626     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  7627     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  7628
  7629     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  7630     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  7631     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  7632     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  7633     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  7634     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  7635     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  7636     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  7637     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  7638
  7639     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  7640     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  7641     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  7642     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  7643     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  7644     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  7645     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  7646
  7647     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  7648     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  7649
  7650     MOVE CM-CREDIT-INTERFACE-SW-1
  7651                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  7652     MOVE CM-CREDIT-INTERFACE-SW-2
  7653                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  7654
  7655     IF CM-O-B-COVERAGE
  7656         MOVE 'B'                 TO PB-CI-OB-FLAG.
  7657
  7658     IF CM-LIVES NOT NUMERIC
  7659         MOVE ZERO                TO CM-LIVES.
  7660
  7661     IF CM-BILLED NOT NUMERIC
  7662         MOVE ZERO                TO CM-BILLED.
  7663
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 143
* EL050.cbl
  7664     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  7665         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  7666         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  7667         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  7668         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  7669         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  7670         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  7671         MOVE CM-LIVES             TO PB-CI-LIVES
  7672*The next line causes a problem with my change  I dont think it is
  7673*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  7674
  7675     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  7676     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  7677     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  7678     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  7679     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  7680     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  7681
  7682     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  7683     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  7684     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  7685     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  7686
  7687     IF CM-LIFE-COMM-PCT NUMERIC
  7688         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  7689     ELSE
  7690         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  7691
  7692     IF CM-AH-COMM-PCT NUMERIC
  7693         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  7694     ELSE
  7695         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  7696
  7697     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  7698
  7699     IF CM-LOAN-APR       NOT NUMERIC
  7700           MOVE ZERO               TO CM-LOAN-APR.
  7701
  7702     IF CM-PAY-FREQUENCY  NOT NUMERIC
  7703           MOVE ZERO               TO CM-PAY-FREQUENCY.
  7704
  7705     IF CM-LOAN-TERM      NOT NUMERIC
  7706           MOVE ZERO               TO CM-LOAN-TERM.
  7707
  7708     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  7709           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  7710
  7711     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  7712           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  7713
  7714     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  7715     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  7716     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  7717     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  7718     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  7719     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  7720     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  7721     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 144
* EL050.cbl
  7722     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  7723     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  7724     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  7725     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  7726
  7727     IF CM-STATE = CM-SSN-STATE
  7728         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  7729
  7730     IF CM-STATE NOT = CM-MEMB-STATE
  7731         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  7732
  7733     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  7734
  7735     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  7736        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  7737        IF CM-ADDL-CLP NOT NUMERIC
  7738           MOVE +0               TO CM-ADDL-CLP
  7739        END-IF
  7740        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  7741     END-IF
  7742
  7743     GO TO 0300-CONTINUE-EDIT.
  7744
  7745 0298-UNLOCK-RETURN.
  7746      PERFORM 9250-UNLOCK-RETURN
  7747      GO TO 9990-RETURN.
  7748
  7749 0299-CERT-NOT-FOUND.
  7750
  7751     MOVE '1'                     TO CERT-STATUS-SW.
  7752
  7753     IF PB-COMPANY-ID = 'UCL'
  7754         IF WS-ERROR = ER-2799
  7755             GO TO 3000-CONTINUE-EDIT.
  7756
  7757     IF NOT PB-CANCELLATION
  7758         GO TO 0300-CONTINUE-EDIT.
  7759
  7760     MOVE ER-2726                  TO  WS-ERROR.
  7761     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  7762     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  7763     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  7764                                    PB-CI-LF-TERM
  7765                                    PB-C-LF-REM-TERM
  7766                                    PB-CI-AH-TERM
  7767                                    PB-C-AH-REM-TERM
  7768                                    PB-CI-LF-BENEFIT-CD
  7769                                    PB-CI-LF-BENEFIT-AMT
  7770                                    PB-CI-LF-ALT-BENEFIT-AMT
  7771                                    PB-CI-LF-PREMIUM-AMT
  7772                                    PB-CI-LF-ALT-PREMIUM-AMT
  7773                                    PB-CI-AH-BENEFIT-CD
  7774                                    PB-CI-AH-BENEFIT-AMT
  7775                                    PB-CI-AH-PREMIUM-AMT
  7776                                    PB-CI-PAY-FREQUENCY
  7777                                    PB-CI-LOAN-APR
  7778                                    PB-CI-LOAN-TERM
  7779                                    PB-CI-LIFE-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 145
* EL050.cbl
  7780                                    PB-CI-AH-COMMISSION
  7781                                    PB-CI-CURR-SEQ
  7782                                    PB-CI-AH-CANCEL-AMT
  7783                                    PB-CI-LF-CANCEL-AMT
  7784                                    PB-CI-RATE-DEV-PCT-LF
  7785                                    PB-CI-RATE-DEV-PCT-AH
  7786                                    PB-CI-EXTENTION-DAYS
  7787                                    PB-CI-TERM-IN-DAYS
  7788                                    PB-CI-LIVES
  7789                                    PB-CI-LF-CRIT-PER
  7790                                    PB-CI-AH-CRIT-PER
  7791                                    PB-CI-ADDL-CLP.
  7792
  7793     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  7794                                    PB-CI-AH-SETTLEMENT-DT
  7795                                    PB-CI-DEATH-DT
  7796                                    PB-CI-LF-PRIOR-CANCEL-DT
  7797                                    PB-CI-AH-PRIOR-CANCEL-DT
  7798                                    PB-CI-ENTRY-DT
  7799                                    PB-CI-LF-EXPIRE-DT
  7800                                    PB-CI-AH-EXPIRE-DT
  7801                                    PB-CI-LOAN-1ST-PMT-DT.
  7802
  7803     IF ACCOUNT-MAST-FOUND
  7804        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  7805        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  7806
  7807     GO TO 3000-CONTINUE-EDIT.
  7808
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 146
* EL050.cbl
  7810
  7811 0300-CONTINUE-EDIT.
  7812
  7813     IF PB-ISSUE
  7814        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  7815            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  7816
  7817     IF PB-ISSUE
  7818        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  7819            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  7820
  7821     IF PB-ISSUE
  7822       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  7823          (AM-NO-AH-ONLY)
  7824           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  7825               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  7826                   MOVE ER-2679 TO WS-ERROR
  7827                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7828
  7829     IF PB-ISSUE
  7830        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  7831        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  7832        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  7833     ELSE
  7834        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  7835        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  7836        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  7837
  7838     MOVE 'N'                    TO PLAN-MASTER-SW
  7839                                    PLAN-MASTER-LIFE-SW
  7840                                    FORM-MASTER-SW
  7841                                    WS-APP-CERT-SW.
  7842
  7843     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  7844                                    WS-PL-TOL-LF-REFUND
  7845                                    WS-PL-REF-OVS-AMT
  7846                                    WS-PL-TOL-LF-PREM-PCT
  7847                                    WS-PL-TOL-LF-REFUND-PCT
  7848                                    WS-PL-REF-OVS-PCT
  7849                                    WS-PL-TOL-LF-CLAIM.
  7850
  7851     IF PB-COMPANY-ID = 'NCL'
  7852       IF PB-ISSUE
  7853         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  7854             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  7855             IF FORM-MASTER-FOUND
  7856                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  7857
  7858     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  7859        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  7860
  7861********************** MON CODE **********************
  7862     IF PB-COMPANY-ID = 'MON'
  7863     IF PB-ISSUE
  7864     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  7865        AND (PB-I-LOAN-APR NOT NUMERIC OR
  7866             PB-I-LOAN-APR = ZERO)
  7867               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 147
* EL050.cbl
  7868******************************************************
  7869
  7870     IF PB-COMPANY-ID = 'NCL'
  7871       IF PB-ISSUE
  7872           IF FORM-MASTER-FOUND
  7873             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  7874                AM-DISMBR-COVERAGE
  7875                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  7876                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  7877                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  7878                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  7879                                           PB-I-LIFE-BENEFIT-CD.
  7880
  7881     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  7882
  7883     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  7884         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  7885         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  7886         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  7887         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  7888         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  7889           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  7890             GO TO 0301-LIFE-BENEFIT-SEARCH
  7891         ELSE
  7892             NEXT SENTENCE
  7893     ELSE
  7894         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  7895
  7896     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7897     MOVE '4'                    TO CNTL-REC-TYPE.
  7898     MOVE +0                     TO CNTL-SEQ-NO.
  7899     MOVE WS-ACCESS              TO CNTL-ACCESS.
  7900
  7901     MOVE '1' TO RC-SW-2.
  7902     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  7903
  7904     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  7905        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  7906         GO TO 0305-BENEFIT-NOT-FOUND.
  7907
  7908     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  7909
  7910 0301-LIFE-BENEFIT-SEARCH.
  7911
  7912     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  7913
  7914     IF NO-BENEFIT-FOUND
  7915        GO TO 0305-BENEFIT-NOT-FOUND.
  7916
  7917     IF WS-BEN-CD = '99'
  7918        GO TO 0305-BENEFIT-NOT-FOUND.
  7919
  7920     IF PB-COMPANY-ID = 'NCL'
  7921         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  7922             GO TO 0304-LIFE-BENEFIT-FOUND.
  7923
  7924     MOVE +1                     TO SUB5.
  7925     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 148
* EL050.cbl
  7926
  7927* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  7928* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  7929     IF PB-COMPANY-ID = 'DMD'
  7930         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  7931
  7932 0302-EDIT-ACCT-LF-BENEFITS.
  7933
  7934     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  7935        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  7936           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  7937                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  7938           GO TO 03XX-GET-LIFE-ERPLAN.
  7939
  7940     IF SUB5 LESS THAN +20
  7941        ADD +1                   TO SUB5
  7942        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  7943
  7944     MOVE +1                     TO SUB5.
  7945
  7946     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  7947        GO TO 03XX-EDIT-FOR-NINETY-LF.
  7948
  7949 0303-EDIT-DMD-EXTRA-BENEFITS.
  7950
  7951     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  7952        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  7953           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  7954                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  7955           GO TO 03XX-GET-LIFE-ERPLAN.
  7956
  7957     IF SUB5 LESS THAN +30
  7958        ADD +1                   TO SUB5
  7959        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  7960
  7961     MOVE +1                     TO SUB5.
  7962
  7963 03XX-EDIT-FOR-NINETY-LF.
  7964
  7965***************************************************************
  7966*                                                             *
  7967*    NINETY BENEFIT PLAN TYPES:                               *
  7968*                                                             *
  7969*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  7970*      92 = ALL GROUP REDUCING BENEFITS                       *
  7971*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  7972*      94 = ALL GROUP LEVEL BENEFITS                          *
  7973*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  7974*           BENEFIT CONTROLS.                                 *
  7975*      99 = ALL BENEFITS                                      *
  7976*                                                             *
  7977***************************************************************
  7978
  7979     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  7980                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  7981
  7982     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  7983       AND
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 149
* EL050.cbl
  7984        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  7985        GO TO 03XX-GET-LIFE-ERPLAN.
  7986
  7987     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  7988       AND
  7989        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  7990        IF CF-REDUCING (SUB3)
  7991           IF (PB-I-INDV-GRP-OVRD = 'I')
  7992              OR
  7993           ((AM-IG = '1') AND
  7994           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  7995              OR
  7996           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  7997           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  7998           (AM-IG NOT = '2'))
  7999              GO TO 03XX-GET-LIFE-ERPLAN.
  8000
  8001     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8002       AND
  8003        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8004        IF CF-REDUCING (SUB3)
  8005           IF (PB-I-INDV-GRP-OVRD = 'G')
  8006              OR
  8007           ((AM-IG = '2') AND
  8008           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8009              OR
  8010           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8011           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8012           (AM-IG NOT = '1'))
  8013              GO TO 03XX-GET-LIFE-ERPLAN.
  8014
  8015     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8016       AND
  8017        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8018        IF CF-LEVEL    (SUB3)
  8019           IF (PB-I-INDV-GRP-OVRD = 'I')
  8020              OR
  8021           ((AM-IG = '1') AND
  8022           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8023              OR
  8024           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8025           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8026            (AM-IG NOT = '2'))
  8027              GO TO 03XX-GET-LIFE-ERPLAN.
  8028
  8029     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8030       AND
  8031        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8032        IF CF-LEVEL    (SUB3)
  8033           IF (PB-I-INDV-GRP-OVRD = 'G')
  8034              OR
  8035           ((AM-IG = '2') AND
  8036           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8037              OR
  8038           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8039           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8040           (AM-IG NOT = '1'))
  8041              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 150
* EL050.cbl
  8042
  8043     IF SUB5 LESS THAN +20
  8044        ADD +1                   TO SUB5
  8045        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8046
  8047     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8048
  8049     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8050        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8051
  8052     MOVE +1                     TO SUB5.
  8053
  8054 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8055
  8056     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8057                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8058
  8059     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8060       AND
  8061        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8062        GO TO 03XX-GET-LIFE-ERPLAN.
  8063
  8064     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8065       AND
  8066        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8067        IF CF-REDUCING (SUB3)
  8068           IF (PB-I-INDV-GRP-OVRD = 'I')
  8069              OR
  8070           ((AM-IG = '1') AND
  8071           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8072              OR
  8073           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8074           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8075           (AM-IG NOT = '2'))
  8076              GO TO 03XX-GET-LIFE-ERPLAN.
  8077
  8078     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8079       AND
  8080        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8081        IF CF-REDUCING (SUB3)
  8082           IF (PB-I-INDV-GRP-OVRD = 'G')
  8083              OR
  8084           ((AM-IG = '2') AND
  8085           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8086              OR
  8087           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8088           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8089           (AM-IG NOT = '1'))
  8090              GO TO 03XX-GET-LIFE-ERPLAN.
  8091
  8092     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8093       AND
  8094        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8095        IF CF-LEVEL    (SUB3)
  8096           IF (PB-I-INDV-GRP-OVRD = 'I')
  8097              OR
  8098           ((AM-IG = '1') AND
  8099           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 151
* EL050.cbl
  8100              OR
  8101           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8102           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8103            (AM-IG NOT = '2'))
  8104              GO TO 03XX-GET-LIFE-ERPLAN.
  8105
  8106     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8107       AND
  8108        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8109        IF CF-LEVEL    (SUB3)
  8110           IF (PB-I-INDV-GRP-OVRD = 'G')
  8111              OR
  8112           ((AM-IG = '2') AND
  8113           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8114              OR
  8115           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8116           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8117           (AM-IG NOT = '1'))
  8118              GO TO 03XX-GET-LIFE-ERPLAN.
  8119
  8120     IF SUB5 LESS THAN +30
  8121        ADD +1                   TO SUB5
  8122        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8123
  8124     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8125
  8126 03XX-EDIT-FOR-NINETY-LF-CONT.
  8127
  8128     MOVE +99                    TO SUB5.
  8129
  8130     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8131        IF PB-ISSUE
  8132           MOVE ER-1924          TO  WS-ERROR
  8133           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8134
  8135     GO TO 0304-LIFE-BENEFIT-FOUND.
  8136
  8137 03XX-GET-LIFE-ERPLAN.
  8138
  8139     IF WK-PLAN-ADDR EQUAL +0
  8140        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8141
  8142     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8143     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8144     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8145     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8146     MOVE 'Y'                    TO PLAN-MASTER-SW
  8147                                    PLAN-MASTER-LIFE-SW.
  8148     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8149
  8150 03XX-ERPLAN-LIFE-GETMAIN.
  8151
  8152     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8153     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8154
  8155 03XX-ERPLAN-LIFE-READ.
  8156
  8157     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 152
* EL050.cbl
  8158     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8159     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8160     MOVE PB-SV-STATE            TO PLAN-STATE.
  8161     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8162     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8163     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8164     MOVE WS-SAVE-BENEFIT-REVISION
  8165                                 TO PLAN-REVISION-NO.
  8166
  8167     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8168     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8169
  8170     IF PB-COMPANY-ID = 'NCL'
  8171       IF NOT LF-PLAN-MASTER-FOUND
  8172         IF NOT PB-POLICY-IS-DECLINED  AND
  8173            NOT PB-POLICY-IS-VOIDED
  8174             MOVE  ER-1921         TO  WS-ERROR
  8175             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8176             GO TO 0304-LIFE-BENEFIT-FOUND.
  8177
  8178     IF NOT LF-PLAN-MASTER-FOUND
  8179        GO TO 0304-LIFE-BENEFIT-FOUND.
  8180
  8181 XXXX-CHECK-LF-PLAN-KEY.
  8182
  8183     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8184        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8185        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8186        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8187        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8188        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8189        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8190        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8191        MOVE 'N'                 TO PLAN-MASTER-SW
  8192          GO TO 03XX-ERPLAN-LIFE-READ.
  8193
  8194     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8195
  8196     IF  PB-CANCELLATION
  8197         GO TO  0303-LF-ACCT-BEN-FOUND.
  8198
  8199     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8200        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8201           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8202           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8203              MOVE ER-2644             TO WS-ERROR
  8204              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8205           ELSE
  8206              NEXT SENTENCE
  8207        ELSE
  8208           IF PB-COMPANY-ID NOT = 'NCL'
  8209              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8210                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8211
  8212 0303-LF-ACCT-BEN-FOUND.
  8213
  8214     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8215
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 153
* EL050.cbl
  8216     IF PL-DEV-CODE NOT = SPACES
  8217        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8218
  8219     IF PL-DEV-PCT NUMERIC AND
  8220        PL-DEV-PCT NOT = ZEROS
  8221        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8222
  8223     IF PL-TOL-PREM-AMT GREATER THAN +0
  8224        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8225
  8226     IF PL-TOL-REF-AMT GREATER THAN +0
  8227        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8228
  8229     IF PL-TOL-PREM-PCT GREATER THAN +0
  8230        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8231
  8232     IF PL-TOL-REF-PCT GREATER THAN +0
  8233        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8234
  8235     IF PL-TOL-CLM-AMT GREATER THAN +0
  8236        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8237
  8238     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8239                          PL-OVER-SHORT-AMT > +0
  8240        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8241
  8242     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8243                          PL-OVER-SHORT-PCT > +0
  8244        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8245
  8246     IF PL-SALES-TAX NUMERIC AND
  8247                          PL-SALES-TAX > +0
  8248         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8249
  8250     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8251        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8252                                    WS-IG-OVRD-AM.
  8253
  8254 0304-LIFE-BENEFIT-FOUND.
  8255
  8256     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8257
  8258     IF PB-ISSUE
  8259        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8260     ELSE
  8261        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8262
  8263     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8264     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8265     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8266     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8267     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8268                                         WS-LF-REFUND-CALC.
  8269
  8270     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8271        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8272
  8273     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 154
* EL050.cbl
  8274        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8275     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8276
  8277     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8278     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8279     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8280     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8281     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8282     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8283
  8284     IF PB-COMPANY-ID = 'NCL'  AND
  8285        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8286         NEXT SENTENCE
  8287     ELSE
  8288         IF SUB5 NOT GREATER THAN +20
  8289            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8290               MOVE WS-SAVE-BENEFIT-REM-TERM
  8291                                      TO WS-AM-LF-BENE-REM-TERM
  8292                                         EC-BR-LF-REM-TERM-CALC.
  8293
  8294     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8295     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8296
  8297     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8298
  8299 0305-BENEFIT-NOT-FOUND.
  8300
  8301     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8302     MOVE ER-2604                TO WS-ERROR.
  8303     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8304
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 155
* EL050.cbl
  8306
  8307 0310-FIND-AH-BENEFIT-RECORD.
  8308
  8309     MOVE 'N'                    TO PLAN-MASTER-SW
  8310                                    PLAN-MASTER-AH-SW.
  8311
  8312     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8313                                    WS-PL-TOL-AH-REFUND
  8314                                    WS-AH-PL-REF-OVS-AMT
  8315                                    WS-PL-TOL-AH-PREM-PCT
  8316                                    WS-PL-TOL-AH-REFUND-PCT
  8317                                    WS-AH-PL-REF-OVS-PCT
  8318                                    WS-PL-TOL-AH-CLAIM.
  8319
  8320
  8321     IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8322        MOVE SPACES              TO PB-I-AH-INPUT-CD.
  8323
  8324     IF PB-I-AH-INPUT-CD NOT EQUAL SPACES AND
  8325       (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8326          GO TO 0399-BENEFIT-NOT-FOUND.
  8327
  8328     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8329        GO TO 0400-FIND-CARRIER.
  8330
  8331     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8332
  8333     IF WK-AH-BEN-ADDR NOT = ZEROS
  8334         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8335         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8336         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8337         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8338           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8339             GO TO 0311-AH-BENEFIT-SEARCH
  8340         ELSE
  8341             NEXT SENTENCE
  8342     ELSE
  8343         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8344
  8345     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8346     MOVE '5'                    TO CNTL-REC-TYPE.
  8347     MOVE +0                     TO CNTL-SEQ-NO.
  8348     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8349
  8350     MOVE '2' TO RC-SW-2.
  8351     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8352
  8353     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8354        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8355          GO TO 0399-BENEFIT-NOT-FOUND.
  8356
  8357     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8358
  8359 0311-AH-BENEFIT-SEARCH.
  8360
  8361     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8362
  8363     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 156
* EL050.cbl
  8364         GO TO 0399-BENEFIT-NOT-FOUND.
  8365
  8366     IF WS-BEN-CD = '99'
  8367        GO TO 0399-BENEFIT-NOT-FOUND.
  8368
  8369     IF PB-COMPANY-ID  =  'NCL'
  8370         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8371             GO TO 0314-A-H-BENEFIT-FOUND.
  8372
  8373     MOVE +1                     TO SUB5.
  8374     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8375
  8376* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8377* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8378     IF PB-COMPANY-ID = 'DMD'
  8379         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8380
  8381 0312-EDIT-ACCT-AH-BENEFITS.
  8382
  8383     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8384        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8385           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8386                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8387           GO TO 03XX-GET-AH-ERPLAN.
  8388
  8389     IF SUB5 LESS THAN +20
  8390        ADD +1                   TO SUB5
  8391        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8392
  8393     MOVE +1                     TO SUB5.
  8394
  8395     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8396        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8397
  8398 0313-EDIT-DMD-EXTRA-BENEFITS.
  8399
  8400     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8401        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8402           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8403                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8404           GO TO 03XX-GET-AH-ERPLAN.
  8405
  8406     IF SUB5 LESS THAN +30
  8407        ADD +1                   TO SUB5
  8408        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8409
  8410     MOVE +1                     TO SUB5.
  8411
  8412 03XX-EDIT-FOR-NINETY-AH.
  8413
  8414***************************************************************
  8415*                                                             *
  8416*    NINETY BENEFIT PLAN TYPES:                               *
  8417*                                                             *
  8418*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8419*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8420*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8421*           BENEFIT CONTROLS.                                 *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 157
* EL050.cbl
  8422*      99 = ALL BENEFITS.                                     *
  8423*                                                             *
  8424***************************************************************
  8425
  8426     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8427                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8428
  8429     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8430       AND
  8431        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8432        GO TO 03XX-GET-AH-ERPLAN.
  8433
  8434     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8435       AND
  8436        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8437           IF (PB-I-INDV-GRP-OVRD = 'I')
  8438              OR
  8439           ((AM-IG = '1') AND
  8440           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8441              OR
  8442           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8443           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8444           (AM-IG NOT = '2'))
  8445              GO TO 03XX-GET-AH-ERPLAN.
  8446
  8447     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8448       AND
  8449        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8450           IF (PB-I-INDV-GRP-OVRD = 'G')
  8451              OR
  8452           ((AM-IG = '2') AND
  8453           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8454              OR
  8455           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8456           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8457           (AM-IG NOT = '1'))
  8458              GO TO 03XX-GET-AH-ERPLAN.
  8459
  8460     IF SUB5 LESS THAN +20
  8461        ADD +1                   TO SUB5
  8462        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8463
  8464     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8465        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8466
  8467     MOVE +1                    TO SUB5.
  8468
  8469 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8470
  8471     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8472                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8473
  8474     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8475       AND
  8476        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8477        GO TO 03XX-GET-AH-ERPLAN.
  8478
  8479     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 158
* EL050.cbl
  8480       AND
  8481        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8482           IF (PB-I-INDV-GRP-OVRD = 'I')
  8483              OR
  8484           ((AM-IG = '1') AND
  8485           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8486              OR
  8487           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8488           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8489           (AM-IG NOT = '2'))
  8490              GO TO 03XX-GET-AH-ERPLAN.
  8491
  8492     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8493       AND
  8494        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8495           IF (PB-I-INDV-GRP-OVRD = 'G')
  8496              OR
  8497           ((AM-IG = '2') AND
  8498           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8499              OR
  8500           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8501           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8502           (AM-IG NOT = '1'))
  8503              GO TO 03XX-GET-AH-ERPLAN.
  8504
  8505     IF SUB5 LESS THAN +30
  8506        ADD +1                   TO SUB5
  8507        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8508
  8509 03XX-EDIT-FOR-NINETY-AH-CONT.
  8510
  8511     MOVE +99                    TO SUB5.
  8512
  8513     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8514
  8515     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8516        IF PB-ISSUE
  8517           MOVE ER-1925          TO  WS-ERROR
  8518           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8519
  8520     GO TO 0314-A-H-BENEFIT-FOUND.
  8521
  8522 03XX-GET-AH-ERPLAN.
  8523
  8524     IF WK-PLAN-ADDR EQUAL +0
  8525         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8526
  8527     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8528     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8529     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8530     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8531     MOVE 'Y'                    TO PLAN-MASTER-SW
  8532                                    PLAN-MASTER-AH-SW.
  8533*****GO TO XXXX-CHECK-AH-PLAN-KEY.
  8534     GO TO 03XX-ERPLAN-AH-READ.
  8535
  8536 03XX-ERPLAN-AH-GETMAIN.
  8537
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 159
* EL050.cbl
  8538     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8539     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8540
  8541 03XX-ERPLAN-AH-READ.
  8542
  8543     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8544     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8545     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8546     MOVE PB-SV-STATE            TO PLAN-STATE.
  8547     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8548     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  8549     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8550     MOVE WS-SAVE-BENEFIT-REVISION
  8551                                 TO PLAN-REVISION-NO.
  8552
  8553     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8554     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  8555
  8556     IF PB-COMPANY-ID = 'NCL'
  8557       IF NOT AH-PLAN-MASTER-FOUND
  8558         IF NOT PB-POLICY-IS-DECLINED  AND
  8559            NOT PB-POLICY-IS-VOIDED
  8560             MOVE  ER-1922         TO  WS-ERROR
  8561             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8562             GO TO 0314-A-H-BENEFIT-FOUND.
  8563
  8564     IF NOT AH-PLAN-MASTER-FOUND
  8565        GO TO 0314-A-H-BENEFIT-FOUND.
  8566
  8567 XXXX-CHECK-AH-PLAN-KEY.
  8568
  8569     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8570        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8571        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8572        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8573        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8574        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8575        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8576        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8577        MOVE 'N'                 TO PLAN-MASTER-SW
  8578          GO TO 03XX-ERPLAN-AH-READ.
  8579
  8580     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  8581
  8582     IF  PB-CANCELLATION
  8583         GO TO  0313-AH-ACCT-BEN-FOUND.
  8584
  8585     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8586       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8587          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8588          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8589             MOVE ER-2644             TO WS-ERROR
  8590             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8591          ELSE
  8592             NEXT SENTENCE
  8593       ELSE
  8594          IF PB-COMPANY-ID NOT = 'NCL'
  8595             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 160
* EL050.cbl
  8596                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8597
  8598 0313-AH-ACCT-BEN-FOUND.
  8599
  8600     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  8601
  8602     IF PL-DEV-CODE NOT = SPACES
  8603        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  8604
  8605     IF PL-DEV-PCT NUMERIC AND
  8606        PL-DEV-PCT NOT = ZEROS
  8607        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  8608
  8609     IF PL-TOL-PREM-AMT NOT EQUAL +0
  8610        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  8611
  8612     IF PL-TOL-REF-AMT NOT EQUAL +0
  8613        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  8614
  8615     IF PL-TOL-PREM-PCT GREATER THAN +0
  8616        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  8617
  8618     IF PL-TOL-REF-PCT GREATER THAN +0
  8619        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  8620
  8621     IF PL-TOL-CLM-AMT NOT EQUAL +0
  8622        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  8623
  8624     IF PL-OVER-SHORT-AMT NUMERIC AND
  8625                          PL-OVER-SHORT-AMT > +0
  8626        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  8627
  8628     IF PL-OVER-SHORT-PCT NUMERIC AND
  8629                          PL-OVER-SHORT-PCT > +0
  8630        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  8631
  8632     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8633        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  8634        IF WS-IG-OVRD-AM EQUAL SPACES
  8635            MOVE PL-IG           TO WS-IG-OVRD-AM.
  8636
  8637 0314-A-H-BENEFIT-FOUND.
  8638
  8639     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  8640
  8641     IF PB-ISSUE
  8642        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  8643       ELSE
  8644        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  8645
  8646     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  8647     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  8648     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  8649     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  8650                                         WS-AH-REFUND-CALC.
  8651
  8652     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8653        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 161
* EL050.cbl
  8654
  8655     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8656        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  8657     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  8658
  8659     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  8660     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  8661     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  8662     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  8663     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  8664     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  8665
  8666     IF PB-COMPANY-ID = 'NCL'  AND
  8667        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8668         NEXT SENTENCE
  8669     ELSE
  8670         IF SUB5 NOT GREATER THAN +20
  8671            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  8672                MOVE WS-SAVE-BENEFIT-REM-TERM
  8673                                      TO WS-AM-AH-BENE-REM-TERM
  8674                                         EC-BR-AH-REM-TERM-CALC.
  8675
  8676     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  8677     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  8678
  8679     GO TO 0400-FIND-CARRIER.
  8680
  8681 0399-BENEFIT-NOT-FOUND.
  8682
  8683     MOVE '1'                    TO AH-BENEFIT-ERROR.
  8684     MOVE ER-2605                TO WS-ERROR.
  8685     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8686
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 162
* EL050.cbl
  8688
  8689 0400-FIND-CARRIER.
  8690
  8691     MOVE PB-SV-CARRIER          TO WS-CARR.
  8692
  8693     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8694     MOVE ZEROS                  TO CNTL-SEQ-NO.
  8695     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  8696     MOVE '6'                    TO CNTL-REC-TYPE.
  8697
  8698*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  8699     MOVE SPACE                  TO WS-DMD-RATING-SW
  8700                                    EC-BR-DMD-RATING-SW.
  8701
  8702     MOVE '2'                    TO RC-SW-1.
  8703     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8704
  8705     IF NOT CF-CARRIER-MASTER
  8706        GO TO 0400-CARRIER-NOT-FOUND.
  8707
  8708 0400-BUILD-CARR-TOL.
  8709
  8710     IF CF-CR-TOL-PREM NUMERIC AND
  8711        CF-CR-TOL-PREM GREATER THAN +0
  8712        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  8713                                    WS-TOL-AH-PREM.
  8714
  8715     IF CF-CR-TOL-REFUND NUMERIC AND
  8716        CF-CR-TOL-REFUND GREATER THAN +0
  8717        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  8718                                    WS-TOL-AH-REFUND.
  8719
  8720     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  8721        CF-CR-OVR-SHT-AMT GREATER THAN +0
  8722        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  8723                                    WS-AH-REFUND-OVS-AMT.
  8724
  8725     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  8726        CF-CR-OVR-SHT-PCT GREATER THAN +0
  8727        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  8728                                    WS-AH-REFUND-OVS-PCT.
  8729
  8730     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  8731        CF-CR-TOL-PREM-PCT GREATER THAN +0
  8732        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  8733                                    WS-TOL-AH-PREM-PCT.
  8734
  8735     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  8736        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  8737        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  8738                                     WS-TOL-AH-REFUND-PCT.
  8739
  8740     IF CF-COMPANY-ID EQUAL 'DMD'
  8741         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  8742                                    EC-BR-DMD-RATING-SW.
  8743
  8744     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  8745     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 163
* EL050.cbl
  8746        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  8747     END-IF
  8748     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  8749        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  8750     END-IF
  8751     IF WS-TOL-CLP-PCT = ZEROS
  8752        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  8753     END-IF
  8754
  8755     IF WS-SPP-LEASE-COMM = ZEROS
  8756        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  8757     END-IF
  8758     GO TO 0400-FIND-ERCOMP.
  8759
  8760 0400-CARRIER-NOT-FOUND.
  8761
  8762     MOVE ER-2602                TO WS-ERROR.
  8763     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8764
  8765 0400-FIND-ERCOMP.
  8766     IF PB-COMPANY-ID = 'DCC'
  8767        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  8768           (WS-SUB1 > +10)
  8769           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  8770                 OR 'A'
  8771              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  8772              MOVE PB-CARRIER    TO COMP-CARRIER
  8773              MOVE PB-GROUPING   TO COMP-GROUPING
  8774              MOVE LOW-VALUES    TO COMP-ACCOUNT
  8775              MOVE AM-AGT (WS-SUB1)
  8776                                 TO COMP-FIN-RESP
  8777              MOVE 'G'           TO COMP-TYPE
  8778              PERFORM 8582-READ-COMPENSATION-MASTER
  8779                                 THRU 8582-EXIT
  8780              IF COMP-MASTER-FOUND
  8781                 IF CO-GA-INACTIVE
  8782                    MOVE ER-2763 TO WS-ERROR
  8783                    PERFORM 9900-ERROR-FORMAT
  8784                                 THRU 9900-EXIT
  8785                    MOVE +11     TO WS-SUB1
  8786                 END-IF
  8787                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  8788                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  8789                    MOVE ER-2788 TO WS-ERROR
  8790                    PERFORM 9900-ERROR-FORMAT
  8791                                 THRU 9900-EXIT
  8792                    MOVE +11     TO WS-SUB1
  8793                 END-IF
  8794              END-IF
  8795           END-IF
  8796        END-PERFORM
  8797     END-IF
  8798*    IF (PB-COMPANY-ID = 'DCC')
  8799*              AND
  8800*       ((WS-LF-BEN-CATEGORY = 'D')
  8801*       OR (WS-AH-BEN-CATEGORY = 'D'))
  8802*       IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  8803*          MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 164
* EL050.cbl
  8804*                                   WS-CLP-STATE
  8805*       ELSE
  8806*          MOVE SPACES           TO PB-I-CLP-STATE
  8807*                                   WS-CLP-STATE
  8808*       END-IF
  8809*    END-IF
  8810     IF (PB-COMPANY-ID = 'DCC')
  8811               AND
  8812        ((WS-LF-BEN-CATEGORY = 'G' OR 'L')
  8813        OR (WS-AH-BEN-CATEGORY = 'G' OR 'L'))
  8814        CONTINUE
  8815     ELSE
  8816        GO TO 0400-FIND-STATE-RECORD
  8817     END-IF
  8818     MOVE SPACES                 TO WS-CLP-STATE
  8819     MOVE +0                     TO WS-BANK-FEE
  8820                                    WS-BANK-LFEE
  8821                                    WS-BANK-NOCHRGB
  8822
  8823     MOVE LOW-VALUES             TO COMP-FIN-RESP
  8824     IF (PB-ISSUE)
  8825        AND (PB-I-BANK-NUMBER NOT =
  8826            SPACES AND ZEROS AND LOW-VALUES)
  8827        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  8828     ELSE
  8829        IF (PB-CANCELLATION)
  8830           AND (PB-CI-BANK-NUMBER NOT =
  8831                SPACES AND ZEROS AND LOW-VALUES)
  8832           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  8833        END-IF
  8834     END-IF
  8835     IF COMP-FIN-RESP NOT = LOW-VALUES
  8836        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  8837        MOVE PB-CARRIER          TO COMP-CARRIER
  8838        MOVE PB-GROUPING         TO COMP-GROUPING
  8839        MOVE LOW-VALUES          TO COMP-ACCOUNT
  8840        MOVE 'B'                 TO COMP-TYPE
  8841        PERFORM 8582-READ-COMPENSATION-MASTER
  8842                                 THRU 8582-EXIT
  8843        IF COMP-MASTER-FOUND
  8844           IF CO-MAX-BANK-FEE NOT NUMERIC
  8845              MOVE +0            TO CO-MAX-BANK-FEE
  8846           END-IF
  8847           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  8848              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  8849           END-IF
  8850           IF CO-GA-INACTIVE
  8851              MOVE ER-2763       TO WS-ERROR
  8852              PERFORM 9900-ERROR-FORMAT
  8853                                 THRU 9900-EXIT
  8854           END-IF
  8855           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  8856              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  8857              MOVE ER-2788 TO WS-ERROR
  8858              PERFORM 9900-ERROR-FORMAT
  8859                                 THRU 9900-EXIT
  8860              MOVE +11     TO WS-SUB1
  8861           END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 165
* EL050.cbl
  8862           IF WS-AH-BEN-CATEGORY = 'G'
  8863              MOVE CO-MAX-BANK-FEE
  8864                                 TO WS-BANK-FEE
  8865                                    PB-I-BANK-FEE
  8866           ELSE
  8867              MOVE CO-MAX-BANK-FEE-LEASE
  8868                                 TO WS-BANK-LFEE
  8869                                    PB-I-BANK-FEE
  8870           END-IF
  8871           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  8872              AND (WS-AH-REFUND-CALC = 'G'))
  8873                        OR
  8874              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  8875              AND (WS-AH-REFUND-CALC NOT = 'G'))
  8876              CONTINUE
  8877           ELSE
  8878              MOVE ER-2789 TO WS-ERROR
  8879              PERFORM 9900-ERROR-FORMAT
  8880                                 THRU 9900-EXIT
  8881           END-IF
  8882           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  8883                                    PB-I-CLP-STATE
  8884           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  8885           MOVE CO-CARRIER       TO BXRF-CARRIER
  8886           MOVE CO-GROUPING      TO BXRF-GROUPING
  8887           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  8888           MOVE BXRF-MAX-REC-LENGTH
  8889                                 TO BXRF-REC-LENGTH
  8890           PERFORM 8584-READ-BANK-CROSS-REF
  8891                                 THRU 8584-EXIT
  8892           IF BXRF-MASTER-FOUND
  8893              MOVE ' '           TO BANK-ACCT-SW
  8894              MOVE BK-BANK-POINTER-CNT
  8895                                 TO BK-BANK-POINTER-CNT
  8896              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  8897                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  8898                 OR (BANK-ACCT-FOUND)
  8899                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  8900                    AND (BK-AM-EXP-DT (WS-SUB1)
  8901                                 > PB-CERT-EFF-DT)
  8902                    AND (BK-AM-EFF-DT (WS-SUB1)
  8903                                 NOT > PB-CERT-EFF-DT)
  8904                    SET BANK-ACCT-FOUND TO TRUE
  8905                 END-IF
  8906              END-PERFORM
  8907              IF NOT BANK-ACCT-FOUND
  8908                 MOVE ZEROS      TO WS-BANK-FEE
  8909                                    WS-BANK-LFEE
  8910                 MOVE ER-2869    TO WS-ERROR
  8911                 PERFORM 9900-ERROR-FORMAT
  8912                                 THRU 9900-EXIT
  8913              ELSE
  8914                 PERFORM 5000-PROCESS-REPS
  8915                                 THRU 5000-EXIT
  8916                 IF AGENT-MASTER-FOUND
  8917                    MOVE +0      TO WS-BANK-FEE
  8918                                    WS-BANK-LFEE
  8919*                   MOVE AG-SPP-FEES (1)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 166
* EL050.cbl
  8920*                                TO PB-I-BANK-FEE
  8921*                                   WS-BANK-FEE
  8922                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  8923                       (WS-SUB1 > +10)
  8924                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  8925                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  8926                       END-IF
  8927                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  8928                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  8929                       END-IF
  8930                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  8931                          AG-SPP-FEES (WS-SUB1)
  8932                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  8933                          AG-SPP-LFEES (WS-SUB1)
  8934                    END-PERFORM
  8935                    IF WS-AH-BEN-CATEGORY = 'G'
  8936                       MOVE WS-BANK-FEE
  8937                                 TO PB-I-BANK-FEE
  8938                    ELSE
  8939                       MOVE WS-BANK-LFEE
  8940                                 TO PB-I-BANK-FEE
  8941                    END-IF
  8942                 END-IF
  8943              END-IF
  8944           END-IF
  8945        ELSE
  8946           MOVE ER-2879          TO WS-ERROR
  8947           PERFORM 9900-ERROR-FORMAT
  8948                                 THRU 9900-EXIT
  8949        END-IF
  8950     ELSE
  8951        MOVE ER-2879             TO WS-ERROR
  8952        PERFORM 9900-ERROR-FORMAT
  8953                                 THRU 9900-EXIT
  8954     END-IF
  8955     IF WS-AH-BEN-CATEGORY = 'G'
  8956        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8957        + WS-BANK-FEE
  8958     ELSE
  8959        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8960        + WS-BANK-LFEE
  8961     END-IF
  8962     .
  8963 0400-FIND-STATE-RECORD.
  8964
  8965     IF WK-STATE-ADDR NOT = ZEROS
  8966         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  8967         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8968         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8969         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  8970         IF PB-SV-STATE = CF-STATE-CODE
  8971             GO TO 0405-CONTINUE-EDIT
  8972         ELSE
  8973             NEXT SENTENCE
  8974     ELSE
  8975         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8976
  8977     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 167
* EL050.cbl
  8978     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  8979     MOVE '3'                    TO CNTL-REC-TYPE.
  8980     MOVE +0                     TO CNTL-SEQ-NO.
  8981
  8982     MOVE '3'                    TO RC-SW-2.
  8983     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8984
  8985     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  8986        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  8987        PB-SV-STATE   NOT = CF-STATE-CODE)
  8988        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  8989                                    WS-TOL-AH-CLAIM
  8990                                    WS-MINIMUM-REFUND
  8991                                    WS-TOL-LF-PREM
  8992                                    WS-TOL-AH-PREM
  8993                                    WS-TOL-LF-REFUND
  8994                                    WS-TOL-AH-REFUND
  8995                                    EC-ST-TOL-PREM-PCT
  8996                                    WS-TOL-LF-PREM-PCT
  8997                                    WS-TOL-AH-PREM-PCT
  8998                                    EC-ST-TOL-REFUND-PCT
  8999                                    WS-TOL-LF-REFUND-PCT
  9000                                    WS-TOL-AH-REFUND-PCT
  9001                                    EC-ST-TOL-PREM
  9002                                    EC-ST-TOL-REFUND
  9003                                    EC-ST-FST-PMT-DAYS-MAX
  9004                                    WS-FREE-LOOK-PERIOD
  9005                                    WS-ST-LF-PREM-TAX
  9006                                    WS-ST-AH-PREM-TAX-I
  9007                                    WS-ST-AH-PREM-TAX-G
  9008                                    WS-BANK-FEE
  9009                                    WS-BANK-LFEE
  9010                                    WS-TOL-CLP-PCT
  9011                                    WS-SPP-LEASE-COMM
  9012        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9013                                    EC-ST-FST-PMT-DAYS-CHG
  9014                                    WS-LF-REM-TERM-CALC
  9015                                    WS-LF-REFUND-CALC
  9016                                    EC-ST-LF-REM-TERM-CALC
  9017                                    EC-ST-LF-REFUND-CALC
  9018                                    WS-AH-REM-TERM-CALC
  9019                                    WS-AH-REFUND-CALC
  9020                                    WS-LF-BEN-CATEGORY
  9021                                    WS-AH-BEN-CATEGORY
  9022                                    WS-CLP-STATE
  9023                                    WS-ST-REFUND-CLAIM-FLAG
  9024                                    EC-ST-AH-REM-TERM-CALC
  9025                                    EC-ST-AH-REFUND-CALC
  9026          GO TO 0499-STATE-NOT-FOUND.
  9027
  9028     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9029
  9030 0405-CONTINUE-EDIT.
  9031
  9032     IF PB-CERT-PRIME NOT NUMERIC
  9033        MOVE ER-2722             TO WS-ERROR
  9034        PERFORM 9900-ERROR-FORMAT
  9035                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 168
* EL050.cbl
  9036     END-IF
  9037*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9038*       MOVE +0                  TO SUB3
  9039*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9040*       IF SUB3 > +0
  9041*          MOVE ER-2722          TO WS-ERROR
  9042*          PERFORM 9900-ERROR-FORMAT
  9043*                                THRU 9900-EXIT
  9044*       END-IF
  9045*    END-IF
  9046*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9047*       IF PB-CERT-PRIME NOT NUMERIC
  9048*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9049*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9050*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9051*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9052*
  9053*          MOVE ER-2722          TO WS-ERROR
  9054*          PERFORM 9900-ERROR-FORMAT
  9055*                                THRU 9900-EXIT
  9056*       END-IF
  9057*    END-IF
  9058
  9059     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9060
  9061     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9062        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9063                                    WS-TOL-AH-CLAIM.
  9064
  9065     IF CF-ST-REFUND-MIN NOT NUMERIC
  9066        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9067
  9068     IF CF-ST-REFUND-MIN NOT = ZEROS
  9069        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9070
  9071     IF CF-ST-TOL-PREM  NOT = ZEROS
  9072        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9073                                    WS-TOL-AH-PREM
  9074        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9075
  9076     IF CF-ST-TOL-REFUND NOT = ZEROS
  9077        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9078                                    WS-TOL-AH-REFUND
  9079        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9080
  9081     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9082        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9083        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9084                                    WS-AH-REFUND-OVS-AMT
  9085                                    EC-ST-OVR-SHT-AMT.
  9086
  9087     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9088        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9089        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9090                                    WS-TOL-LF-PREM-PCT
  9091                                    WS-TOL-AH-PREM-PCT.
  9092
  9093     IF CF-ST-TOL-REF-PCT NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 169
* EL050.cbl
  9094        CF-ST-TOL-REF-PCT GREATER THAN +0
  9095        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9096                                    WS-TOL-LF-REFUND-PCT
  9097                                    WS-TOL-AH-REFUND-PCT.
  9098
  9099     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9100        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9101        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9102                                    WS-AH-REFUND-OVS-PCT
  9103                                    EC-ST-OVR-SHT-PCT.
  9104
  9105     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9106     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9107
  9108     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9109          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9110
  9111     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9112     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9113
  9114     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9115
  9116     IF CF-ST-LF-PREM-TAX NUMERIC
  9117        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9118     END-IF
  9119     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9120        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9121     END-IF
  9122     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9123        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9124     END-IF
  9125
  9126     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9127         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9128     END-IF.
  9129
  9130     IF WS-LF-BENEFIT-CD = ZEROS
  9131        GO TO 0410-CHECK-AH.
  9132
  9133     IF CF-ST-RT-CALC NOT = SPACES
  9134        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9135                                    EC-ST-LF-REM-TERM-CALC
  9136     END-IF
  9137
  9138     IF WS-LF-COVERAGE-TYPE = 'R'
  9139        IF WS-LF-EARNINGS-CALC = '5'
  9140           IF CF-ST-RF-LN-CALC > '0'
  9141              MOVE CF-ST-RF-LN-CALC
  9142                                 TO WS-LF-REFUND-CALC
  9143                                    EC-ST-LF-REFUND-CALC
  9144           END-IF
  9145        ELSE
  9146           IF CF-ST-RF-LR-CALC > '0'
  9147              MOVE CF-ST-RF-LR-CALC
  9148                                 TO WS-LF-REFUND-CALC
  9149                                    EC-ST-LF-REFUND-CALC
  9150           END-IF
  9151        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 170
* EL050.cbl
  9152     ELSE
  9153        IF CF-ST-RF-LL-CALC > '0'
  9154           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9155                                    EC-ST-LF-REFUND-CALC
  9156        END-IF
  9157     END-IF
  9158
  9159     IF CF-ST-RT-CALC NOT = SPACES
  9160        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9161                                    EC-ST-LF-REM-TERM-CALC
  9162     END-IF
  9163
  9164     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9165     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9166
  9167     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9168
  9169     IF NO-BENEFIT-FOUND
  9170        GO TO 0410-CHECK-AH.
  9171
  9172     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9173        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9174                                 TO EC-ST-LF-REM-TERM-CALC
  9175                                    WS-LF-REM-TERM-CALC
  9176     END-IF
  9177
  9178     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9179        MOVE CF-ST-REFUND-CALC (SUB3)
  9180                                 TO WS-LF-REFUND-CALC
  9181                                    EC-ST-LF-REFUND-CALC
  9182     END-IF
  9183*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9184
  9185     .
  9186 0410-CHECK-AH.
  9187
  9188     IF WS-AH-BENEFIT-CD = ZEROS
  9189        GO TO 0500-SET-ACCOUNT.
  9190
  9191     IF CF-ST-RT-CALC NOT = SPACES
  9192        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9193                                    EC-ST-AH-REM-TERM-CALC
  9194     END-IF
  9195
  9196     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9197        IF CF-ST-RF-CP-CALC > '0'
  9198           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9199                                    EC-ST-AH-REFUND-CALC
  9200        END-IF
  9201     ELSE
  9202        IF CF-ST-RF-AH-CALC > '0'
  9203           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9204                                    EC-ST-AH-REFUND-CALC
  9205        END-IF
  9206     END-IF
  9207     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9208     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9209
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 171
* EL050.cbl
  9210     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9211
  9212     IF NO-BENEFIT-FOUND
  9213        GO TO 0500-SET-ACCOUNT.
  9214
  9215     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9216        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9217                                 TO WS-AH-REM-TERM-CALC
  9218                                    EC-ST-AH-REM-TERM-CALC
  9219     END-IF
  9220
  9221     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9222        MOVE CF-ST-REFUND-CALC (SUB3)
  9223                                 TO WS-AH-REFUND-CALC
  9224                                    EC-ST-AH-REFUND-CALC
  9225     END-IF
  9226
  9227*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9228
  9229     GO TO 0500-SET-ACCOUNT.
  9230
  9231 0499-STATE-NOT-FOUND.
  9232
  9233     MOVE ER-2603                TO WS-ERROR.
  9234     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9235
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 172
* EL050.cbl
  9237
  9238 0500-SET-ACCOUNT.
  9239*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CLP STATE
  9240     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9241        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9242        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9243        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9244        MOVE '3'                 TO CNTL-REC-TYPE
  9245        MOVE +0                  TO CNTL-SEQ-NO
  9246
  9247        MOVE '3'                 TO RC-SW-2
  9248        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9249
  9250        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9251           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9252           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9253           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9254                                    WS-ST-AH-PREM-TAX-I
  9255                                    WS-ST-AH-PREM-TAX-G
  9256        ELSE
  9257           IF CF-ST-LF-PREM-TAX NUMERIC
  9258              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9259           END-IF
  9260           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9261              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9262           END-IF
  9263           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9264              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9265           END-IF
  9266        END-IF
  9267        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9268     END-IF
  9269     IF (PB-COMPANY-ID = 'DCC')
  9270        AND (PB-ISSUE)
  9271*       AND (PB-CARRIER = '2' OR '4' OR '6')
  9272        AND ((WS-LF-BEN-CATEGORY = 'L' OR 'G')
  9273                      OR
  9274            (WS-AH-BEN-CATEGORY = 'L' OR 'G'))
  9275        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9276          MOVE PB-I-VIN          TO WS-WORK-VIN
  9277          MOVE +8                TO V2
  9278          MOVE ZEROS             TO WS-VIN-TOTAL
  9279          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9280           (V1 > 17)
  9281             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9282                MOVE ER-3825     TO WS-ERROR
  9283                PERFORM 9900-ERROR-FORMAT
  9284                                 THRU 9900-EXIT
  9285             ELSE
  9286                IF V1 = 8
  9287                   MOVE 10       TO V2
  9288                END-IF
  9289                IF V1 = 9
  9290                   MOVE 0        TO V2
  9291                END-IF
  9292                IF V1 = 10
  9293                   MOVE 9        TO V2
  9294                END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 173
* EL050.cbl
  9295                IF WS-WORK-VIN (V1:1) NUMERIC
  9296                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9297                    + (WS-WORK-VIN-N (V1) * V2)
  9298                ELSE
  9299                   MOVE WS-WORK-VIN (V1:1)
  9300                                 TO WS-HEX-BYTE
  9301                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9302                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9303                    + (WS-NUM (V3) * V2)
  9304                END-IF
  9305                COMPUTE V2 = V2 - 1
  9306             END-IF
  9307          END-PERFORM
  9308          MOVE ZEROS TO WS-VIN-REMAINDER
  9309          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9310             REMAINDER WS-VIN-REMAINDER
  9311          IF ((WS-WORK-VIN (9:1) = 'X')
  9312             AND (WS-VIN-REMAINDER = 10))
  9313                     OR
  9314             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9315             CONTINUE
  9316          ELSE
  9317             MOVE ER-3826        TO WS-ERROR
  9318             PERFORM 9900-ERROR-FORMAT
  9319                                 THRU 9900-EXIT
  9320          END-IF
  9321        ELSE
  9322          MOVE ER-3826           TO WS-ERROR
  9323          PERFORM 9900-ERROR-FORMAT
  9324                                 THRU 9900-EXIT
  9325        END-IF
  9326     END-IF
  9327******************************************************************
  9328******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9329******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9330******* METHODS.
  9331******************************************************************
  9332     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9333        IF PB-CANCELLATION
  9334           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9335              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9336                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9337                IF FORM-MASTER-FOUND
  9338                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9339******************************************************************
  9340
  9341     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9342     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9343
  9344     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9345     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9346     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9347     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9348
  9349
  9350     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9351     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9352     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 174
* EL050.cbl
  9353
  9354     IF AM-LF-OB-RATE NOT NUMERIC
  9355         MOVE ZERO               TO AM-LF-OB-RATE.
  9356
  9357     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9358         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9359
  9360     IF AM-AH-OB-RATE NOT NUMERIC
  9361         MOVE ZERO               TO AM-AH-OB-RATE.
  9362
  9363     IF WS-LF-JOINT-INDICATOR = 'J'
  9364         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9365     ELSE
  9366         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9367
  9368     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9369
  9370     IF WS-IG-OVRD-AM  EQUAL SPACE
  9371         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9372
  9373     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9374         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9375                                       WS-IG-OVRD
  9376     ELSE
  9377         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9378             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9379                                       WS-IG-OVRD
  9380         ELSE
  9381             MOVE AM-IG             TO WS-IG-OVRD-AH
  9382                                       WS-IG-OVRD.
  9383
  9384     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9385         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9386                                       WS-IG-OVRD
  9387     ELSE
  9388         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9389             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9390                                       WS-IG-OVRD
  9391         ELSE
  9392             MOVE AM-IG             TO WS-IG-OVRD-LF
  9393                                       WS-IG-OVRD.
  9394
  9395     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9396     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9397     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
  9398     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
  9399     INSPECT WS-ACCT-STATUS CONVERTING   '43210' TO 'FCTIA'.
  9400
  9401     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
  9402     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
  9403     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
  9404     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
  9405
  9406     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
  9407     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
  9408     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
  9409     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
  9410     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 175
* EL050.cbl
  9411     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
  9412     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
  9413
  9414     IF WS-ACCT-AH-DEV-PCT > +0
  9415        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
  9416     ELSE
  9417        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
  9418
  9419     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
  9420        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
  9421     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
  9422        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
  9423
  9424        IF AM-EARN-METHOD-L = 'S'
  9425            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9426                                        WS-LF-REFUND-CALC.
  9427
  9428        IF AM-EARN-METHOD-R = 'S'
  9429            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9430                                        WS-LF-REFUND-CALC.
  9431
  9432     IF WS-LF-COVERAGE-TYPE = 'R'
  9433         IF AM-EARN-METHOD-R = 'R'
  9434            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9435                                    WS-LF-REFUND-CALC.
  9436     IF WS-LF-COVERAGE-TYPE = 'R'
  9437         IF AM-EARN-METHOD-R = 'P'
  9438            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9439                                    WS-LF-REFUND-CALC.
  9440     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9441         IF AM-EARN-METHOD-L = 'R'
  9442            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9443                                    WS-LF-REFUND-CALC.
  9444     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9445         IF AM-EARN-METHOD-L = 'P'
  9446            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9447                                    WS-LF-REFUND-CALC.
  9448     IF WS-LF-COVERAGE-TYPE = 'R'
  9449         IF AM-EARN-METHOD-R = 'A'
  9450            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9451                                    WS-LF-REFUND-CALC.
  9452     IF WS-LF-COVERAGE-TYPE = 'R'
  9453         IF AM-EARN-METHOD-R = 'M'
  9454            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9455                                    WS-LF-REFUND-CALC.
  9456     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9457         IF AM-EARN-METHOD-L = 'A'
  9458            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9459                                    WS-LF-REFUND-CALC.
  9460     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9461         IF AM-EARN-METHOD-L = 'M'
  9462            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9463                                    WS-LF-REFUND-CALC.
  9464
  9465     IF AM-EARN-METHOD-A = 'R'
  9466        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
  9467                                    WS-AH-REFUND-CALC.
  9468     IF AM-EARN-METHOD-A = 'P'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 176
* EL050.cbl
  9469        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
  9470                                    WS-AH-REFUND-CALC.
  9471     IF AM-EARN-METHOD-A = 'C'
  9472        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
  9473                                    WS-AH-REFUND-CALC.
  9474     IF AM-EARN-METHOD-A = 'A'
  9475        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
  9476                                    WS-AH-REFUND-CALC.
  9477     IF AM-EARN-METHOD-A = 'M'
  9478        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
  9479                                    WS-AH-REFUND-CALC.
  9480     IF AM-EARN-METHOD-A = 'N'
  9481        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
  9482                                    WS-AH-REFUND-CALC.
  9483     IF AM-EARN-METHOD-A = 'S'
  9484        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
  9485                                    WS-AH-REFUND-CALC.
  9486
  9487     IF AM-TOL-PREM NOT = ZEROS
  9488        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
  9489                                    WS-TOL-AH-PREM.
  9490
  9491     IF AM-OVR-SHT-AMT NUMERIC AND
  9492                  AM-OVR-SHT-AMT > 0
  9493        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
  9494                                    EC-AM-LF-OVR-SHT-AMT
  9495                                    WS-AH-REFUND-OVS-AMT
  9496                                    EC-AM-AH-OVR-SHT-AMT.
  9497
  9498     IF AM-OVR-SHT-PCT NUMERIC AND
  9499                    AM-OVR-SHT-PCT > 0
  9500        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
  9501                                    EC-AM-LF-OVR-SHT-PCT
  9502                                    WS-AH-REFUND-OVS-PCT
  9503                                    EC-AM-AH-OVR-SHT-PCT.
  9504
  9505     IF AM-TOL-REF-PCT NUMERIC AND
  9506                  AM-TOL-REF-PCT > 0
  9507        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
  9508                                    WS-TOL-AH-REFUND-PCT.
  9509
  9510     IF AM-TOL-REF  NOT = ZEROS  AND
  9511                  AM-TOL-REF NUMERIC
  9512        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
  9513                                    EC-AM-LF-TOL-REFUND
  9514                                    WS-TOL-AH-REFUND
  9515                                    EC-AM-AH-TOL-REFUND.
  9516
  9517     IF AM-TOL-CLM  NOT = ZEROS
  9518        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
  9519                                    WS-TOL-AH-CLAIM.
  9520
  9521     IF AM-CLP-TOL-PCT NOT NUMERIC
  9522        MOVE +0                  TO AM-CLP-TOL-PCT
  9523     END-IF
  9524
  9525     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9526        MOVE +0                  TO AM-SPP-LEASE-COMM
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 177
* EL050.cbl
  9527     END-IF
  9528     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
  9529        MOVE WS-PL-TOL-LF-PREM-PCT
  9530                                 TO WS-TOL-LF-PREM-PCT.
  9531
  9532     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
  9533        MOVE WS-PL-TOL-AH-PREM-PCT
  9534                                 TO WS-TOL-AH-PREM-PCT.
  9535
  9536     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
  9537        MOVE WS-PL-TOL-LF-REFUND-PCT
  9538                                 TO WS-TOL-LF-REFUND-PCT.
  9539
  9540     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
  9541        MOVE WS-PL-TOL-AH-REFUND-PCT
  9542                                 TO WS-TOL-AH-REFUND-PCT.
  9543
  9544     IF WS-PL-REF-OVS-AMT > +0
  9545        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
  9546
  9547     IF WS-PL-REF-OVS-PCT > +0
  9548        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
  9549
  9550     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
  9551        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
  9552     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
  9553        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
  9554     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
  9555        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
  9556     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
  9557        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
  9558     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
  9559        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
  9560     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
  9561        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
  9562
  9563     IF WS-AH-PL-REF-OVS-AMT > +0
  9564        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
  9565
  9566     IF WS-AH-PL-REF-OVS-PCT > +0
  9567        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
  9568
  9569     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
  9570     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
  9571
  9572     IF PB-CANCELLATION
  9573        GO TO 3000-CONTINUE-EDIT.
  9574
  9575     MOVE +1 TO SUB1.
  9576     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
  9577     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
  9578
  9579     IF CF-COMPANY-ID = 'DMD'
  9580       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9581         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
  9582        ELSE
  9583         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
  9584
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 178
* EL050.cbl
  9585  0525-FIND-ACCT-COMM.
  9586     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
  9587        NEXT SENTENCE
  9588      ELSE
  9589         ADD +1 TO SUB1
  9590         IF SUB1 LESS +11
  9591            GO TO 0525-FIND-ACCT-COMM
  9592          ELSE
  9593             GO TO 0560-EDIT-CONTINUE.
  9594
  9595     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
  9596     MOVE ZERO                   TO PB-I-AH-COMMISSION
  9597                                    PB-I-LIFE-COMMISSION.
  9598***  IF PB-COMPANY-ID = 'CRI'
  9599     IF PB-PREM-ACCTNG-ONLY
  9600         GO TO 0560-EDIT-CONTINUE.
  9601
  9602     MOVE '0530' TO CTBL-SW.
  9603     MOVE ' '    TO WS-CTBL-READ-SW.
  9604
  9605
  9606 0530-GET-AH-COMP.
  9607     IF NO-AH-COVERAGE  OR
  9608        NO-AH-BENEFIT-MATCH
  9609           GO TO 0540-NEXT-READ-STEP.
  9610
  9611     IF AM-A-COM (SUB1) NUMERIC
  9612        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
  9613         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
  9614         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
  9615         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  9616         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
  9617     ELSE
  9618          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
  9619          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  9620          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  9621          MOVE ZEROS             TO WS-SUB1
  9622                                    WS-COMMISSION
  9623          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  9624          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
  9625          IF WS-COMMISSION > ZEROS
  9626             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
  9627             GO TO 0540-NEXT-READ-STEP
  9628          END-IF
  9629          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9630          IF CTBL-TABLE-FOUND
  9631             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
  9632                                        PB-I-AH-TERM
  9633             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
  9634             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
  9635             GO TO 0540-NEXT-READ-STEP
  9636          ELSE
  9637             IF FIRST-TIME-THROUGH
  9638                 GO TO 0530-GET-AH-COMP
  9639             ELSE
  9640                 MOVE ER-2609                TO WS-ERROR
  9641                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9642
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 179
* EL050.cbl
  9643 0540-NEXT-READ-STEP.
  9644     MOVE '0540' TO CTBL-SW.
  9645     MOVE ' '    TO WS-CTBL-READ-SW.
  9646
  9647 0540-GET-LF-COMP.
  9648     IF NO-LIFE-COVERAGE  OR
  9649        NO-LF-BENEFIT-MATCH
  9650           GO TO 0560-EDIT-CONTINUE.
  9651
  9652     IF WS-LF-JOINT-INDICATOR = 'J'
  9653        IF AM-J-COM (SUB1) NUMERIC
  9654           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
  9655           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
  9656           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
  9657           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  9658           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
  9659        ELSE
  9660           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
  9661           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
  9662           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
  9663           MOVE ZEROS                TO WS-SUB1
  9664                                        WS-COMMISSION
  9665           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  9666           IF WS-COMMISSION > ZEROS
  9667              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
  9668              GO TO 0560-EDIT-CONTINUE
  9669           END-IF
  9670           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
  9671           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9672           IF CTBL-TABLE-FOUND
  9673              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
  9674              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
  9675              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
  9676              GO TO 0560-EDIT-CONTINUE
  9677           ELSE
  9678              IF FIRST-TIME-THROUGH
  9679                  GO TO 0540-GET-LF-COMP
  9680              ELSE
  9681                  MOVE ER-2609                TO WS-ERROR
  9682                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9683                  GO TO 0560-EDIT-CONTINUE.
  9684
  9685     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
  9686        IF AM-L-COM (SUB1) NUMERIC
  9687           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
  9688           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
  9689           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
  9690           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  9691           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
  9692        ELSE
  9693           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
  9694           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
  9695           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
  9696           MOVE ZEROS                TO WS-SUB1
  9697                                        WS-COMMISSION
  9698           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
  9699           IF WS-COMMISSION IS GREATER THAN ZEROS
  9700              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 180
* EL050.cbl
  9701              GO TO 0560-EDIT-CONTINUE
  9702           END-IF
  9703           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
  9704           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  9705           IF CTBL-TABLE-FOUND
  9706              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
  9707              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
  9708              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
  9709              GO TO 0560-EDIT-CONTINUE
  9710           ELSE
  9711              IF FIRST-TIME-THROUGH
  9712                  GO TO 0540-GET-LF-COMP
  9713              ELSE
  9714                  MOVE ER-2609                TO WS-ERROR
  9715                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9716
  9717*    GO TO 0560-EDIT-CONTINUE.
  9718
  9719 0560-EDIT-CONTINUE.
  9720     MOVE ZEROS                  TO WS-LF-PMF-COMM
  9721                                    WS-AH-PMF-COMM
  9722*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
  9723*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
  9724     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
  9725        (SUB1 > +10)
  9726        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
  9727           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
  9728           MOVE '0530'           TO CTBL-SW
  9729           MOVE ' '              TO WS-CTBL-READ-SW
  9730           PERFORM 0561-CHECK-AH THRU 0561-EXIT
  9731           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
  9732           MOVE '0540'           TO CTBL-SW
  9733           MOVE ' '              TO WS-CTBL-READ-SW
  9734           PERFORM 0563-CHECK-LF THRU 0563-EXIT
  9735        END-IF
  9736     END-PERFORM
  9737     GO TO 0564-EDIT-CONTINUE
  9738     .
  9739 0561-CHECK-AH.
  9740     IF (NO-AH-COVERAGE)
  9741        OR (NO-AH-BENEFIT-MATCH)
  9742        CONTINUE
  9743     ELSE
  9744        IF (AM-A-COM (SUB1) NUMERIC)
  9745           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
  9746           IF (AM-COM-TYP (SUB1) = 'A')
  9747              AND (WS-AH-PMF-COMM = ZEROS)
  9748              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
  9749           END-IF
  9750           CONTINUE
  9751        ELSE
  9752           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
  9753           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
  9754           MOVE PB-AH-OVERRIDE-L1
  9755                                 TO CTBL-BEN-TYPE
  9756           MOVE ZEROS            TO WS-SUB1
  9757                                    WS-COMMISSION
  9758           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 181
* EL050.cbl
  9759           PERFORM 8300-READ-CTBL-TABLE
  9760                                 THRU 8300-EXIT
  9761           IF CTBL-TABLE-FOUND
  9762              IF (AM-COM-TYP (SUB1) = 'A')
  9763                 AND (WS-AH-PMF-COMM = ZEROS)
  9764                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
  9765                                        PB-I-AH-TERM
  9766                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
  9767                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
  9768              END-IF
  9769              CONTINUE
  9770           ELSE
  9771              IF FIRST-TIME-THROUGH
  9772                 GO TO 0561-CHECK-AH
  9773              ELSE
  9774                 MOVE ER-2609    TO WS-ERROR
  9775                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9776              END-IF
  9777           END-IF
  9778        END-IF
  9779     END-IF
  9780     .
  9781 0561-EXIT.
  9782     EXIT.
  9783 0563-CHECK-LF.
  9784     IF (NO-LIFE-COVERAGE)
  9785        OR (NO-LF-BENEFIT-MATCH)
  9786        CONTINUE
  9787     ELSE
  9788        IF WS-LF-JOINT-INDICATOR = 'J'
  9789           IF AM-J-COM (SUB1) NUMERIC
  9790              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
  9791              IF (AM-COM-TYP (SUB1) = 'A')
  9792                 AND (WS-LF-PMF-COMM = ZEROS)
  9793                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
  9794              END-IF
  9795              CONTINUE
  9796           ELSE
  9797              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
  9798              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
  9799              MOVE PB-LIFE-OVERRIDE-L1
  9800                                 TO CTBL-BEN-TYPE
  9801              MOVE ZEROS         TO WS-SUB1
  9802                                    WS-COMMISSION
  9803              MOVE AM-J-COMA (SUB1)
  9804                                 TO CTBL-TABLE
  9805              PERFORM 8300-READ-CTBL-TABLE
  9806                                 THRU 8300-EXIT
  9807              IF CTBL-TABLE-FOUND
  9808                 IF (AM-COM-TYP (SUB1) = 'A')
  9809                    AND (WS-LF-PMF-COMM = ZEROS)
  9810                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
  9811                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
  9812                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
  9813                 END-IF
  9814                 CONTINUE
  9815              ELSE
  9816                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 182
* EL050.cbl
  9817                    GO TO 0563-CHECK-LF
  9818                 ELSE
  9819                    MOVE ER-2609 TO WS-ERROR
  9820                    PERFORM 9900-ERROR-FORMAT
  9821                                 THRU 9900-EXIT
  9822*                   GO TO 0560-EDIT-CONTINUE
  9823                 END-IF
  9824              END-IF
  9825           END-IF
  9826        ELSE
  9827           IF AM-L-COM (SUB1) NUMERIC
  9828              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
  9829              IF (AM-COM-TYP (SUB1) = 'A')
  9830                 AND (WS-LF-PMF-COMM = ZEROS)
  9831                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
  9832              END-IF
  9833              CONTINUE
  9834           ELSE
  9835              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
  9836              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
  9837              MOVE PB-LIFE-OVERRIDE-L1
  9838                                 TO CTBL-BEN-TYPE
  9839              MOVE ZEROS         TO WS-SUB1
  9840                                    WS-COMMISSION
  9841              MOVE AM-L-COMA (SUB1)
  9842                                 TO CTBL-TABLE
  9843              PERFORM 8300-READ-CTBL-TABLE
  9844                                 THRU 8300-EXIT
  9845              IF CTBL-TABLE-FOUND
  9846                 CONTINUE
  9847              ELSE
  9848                 IF FIRST-TIME-THROUGH
  9849                    GO TO 0563-CHECK-LF
  9850                 ELSE
  9851                    MOVE ER-2609 TO WS-ERROR
  9852                    PERFORM 9900-ERROR-FORMAT
  9853                                 THRU 9900-EXIT
  9854                 END-IF
  9855              END-IF
  9856           END-IF
  9857        END-IF
  9858     END-IF
  9859     .
  9860 0563-EXIT.
  9861     EXIT.
  9862 0564-EDIT-CONTINUE.
  9863
  9864     IF  PB-COMPANY-ID EQUAL 'DMD'
  9865         IF PB-I-NUM-BILLED EQUAL ZEROS
  9866            MOVE ER-8148       TO WS-ERROR
  9867            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9868
  9869*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
  9870*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
  9871*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
  9872*         SET ELAPSED-BETWEEN-BIN TO TRUE
  9873*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  9874*         IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 183
* EL050.cbl
  9875*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
  9876*         ELSE
  9877*             IF PB-COMPANY-ID EQUAL 'HAN'
  9878*                 MOVE ZEROS     TO PB-I-AGE.
  9879     IF PB-I-BIRTHDAY > LOW-VALUES
  9880        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
  9881        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
  9882        SET ELAPSED-BETWEEN-BIN  TO TRUE
  9883        PERFORM 8500-DATE-CONVERT
  9884                                 THRU 8500-EXIT
  9885        IF NO-CONVERSION-ERROR
  9886           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
  9887           IF PB-I-AGE > ZEROS
  9888              IF WS-WORK-AGE NOT = PB-I-AGE
  9889                 MOVE ER-9501    TO WS-ERROR
  9890                 PERFORM 9900-ERROR-FORMAT
  9891                                 THRU 9900-EXIT
  9892              END-IF
  9893           ELSE
  9894              MOVE WS-WORK-AGE   TO PB-I-AGE
  9895           END-IF
  9896        END-IF
  9897     END-IF
  9898     IF PB-I-AGE = ZEROS
  9899        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
  9900           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
  9901
  9902     MOVE PB-I-AGE              TO WS-EDIT-AGE
  9903                                   WS-AH-EDIT-AGE.
  9904
  9905     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
  9906        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
  9907        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
  9908        SET ELAPSED-BETWEEN-BIN  TO TRUE
  9909        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  9910        IF NO-CONVERSION-ERROR
  9911           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
  9912           IF PB-I-JOINT-AGE > 0
  9913              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
  9914                 MOVE ER-9503    TO WS-ERROR
  9915                 PERFORM 9900-ERROR-FORMAT
  9916                                 THRU 9900-EXIT
  9917              END-IF
  9918           ELSE
  9919              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
  9920           END-IF
  9921        ELSE
  9922           MOVE ZEROS            TO PB-I-JOINT-AGE
  9923        END-IF
  9924     END-IF
  9925     IF PB-I-JOINT-AGE NOT NUMERIC
  9926        MOVE ZERO               TO PB-I-JOINT-AGE.
  9927
  9928     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC'
  9929        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
  9930           (WS-AH-JOINT-INDICATOR = 'J')
  9931           IF PB-I-JOINT-AGE = ZEROS
  9932               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 184
* EL050.cbl
  9933           END-IF
  9934        END-IF
  9935     END-IF
  9936
  9937     MOVE ' ' TO PB-I-LIFE-INDICATOR
  9938     IF WS-LF-JOINT-INDICATOR = 'J'
  9939        MOVE 'J'                TO PB-I-LIFE-INDICATOR
  9940        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
  9941            IF  PB-I-JOINT-AGE = ZERO
  9942                MOVE ER-2686       TO WS-ERROR
  9943                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9944            ELSE
  9945                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
  9946                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
  9947                    IF PB-COMPANY-ID NOT = 'LBL'
  9948                        MOVE ER-2685    TO WS-ERROR
  9949                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9950
  9951     IF WS-AH-JOINT-INDICATOR = 'J'
  9952        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
  9953            IF  PB-I-JOINT-AGE = ZERO
  9954                MOVE ER-2686       TO WS-ERROR
  9955                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9956            ELSE
  9957                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
  9958                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
  9959                                           WS-EDIT-AGE
  9960                    IF PB-COMPANY-ID NOT = 'LBL'
  9961                        MOVE ER-2685    TO WS-ERROR
  9962                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9963
  9964******************************************************************
  9965*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
  9966******************************************************************
  9967
  9968     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
  9969        (WS-AH-SPECIAL-CALC-CD = 'O')
  9970        NEXT SENTENCE
  9971     ELSE
  9972        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
  9973          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
  9974           (WS-LF-JOINT-INDICATOR = 'J'  OR
  9975            WS-AH-JOINT-INDICATOR = 'J')  AND
  9976           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
  9977            MOVE ER-2627             TO WS-ERROR
  9978            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9979
  9980     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
  9981        (WS-AH-SPECIAL-CALC-CD = 'O')
  9982         NEXT SENTENCE
  9983     ELSE
  9984         IF WS-LF-JOINT-INDICATOR = 'J'  OR
  9985            WS-AH-JOINT-INDICATOR = 'J'
  9986             IF PB-I-JOINT-INSURED = SPACES
  9987                 IF PB-COMPANY-ID NOT = 'JAL'
  9988                     MOVE ER-2696    TO WS-ERROR
  9989                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9990
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 185
* EL050.cbl
  9991     IF PB-COMPANY-ID NOT = 'BOA'
  9992        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
  9993           (WS-AH-JOINT-INDICATOR NOT = 'J')
  9994           IF (PB-I-JOINT-AGE NOT = ZEROS OR
  9995               PB-I-JOINT-INSURED NOT = SPACES)
  9996                MOVE ER-2691         TO WS-ERROR
  9997                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9998
  9999     IF PB-COMPANY-ID = 'BOA'
 10000        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10001           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10002            IF PB-I-JOINT-AGE NOT = ZEROS
 10003                MOVE ER-2691         TO WS-ERROR
 10004                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10005
 10006     IF PB-COMPANY-ID = 'CRI'
 10007        IF PB-I-SIG-SW = 'J'
 10008           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10009              WS-AH-JOINT-INDICATOR NOT = 'J'
 10010              MOVE ER-2675       TO WS-ERROR
 10011              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10012
 10013     IF PB-COMPANY-ID = 'CRI'
 10014        IF PB-I-SIG-SW = 'S'
 10015           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10016              WS-AH-JOINT-INDICATOR = 'J'
 10017              MOVE ER-2676       TO WS-ERROR
 10018              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10019
 10020     IF PB-COMPANY-ID = 'CVL'
 10021         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10022            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10023              MOVE ER-2783           TO WS-ERROR
 10024              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10025     IF (WS-LF-JOINT-INDICATOR = 'J')
 10026        AND (WS-AH-JOINT-INDICATOR = 'J')
 10027        AND (PB-I-LF-TERM > 120)
 10028        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10029        MOVE ER-2783             TO WS-ERROR
 10030        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10031     END-IF
 10032     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10033
 10034     IF PB-I-INDV-GRP-OVRD = 'I'
 10035        MOVE ER-2666             TO WS-ERROR
 10036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10037        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10038
 10039     IF PB-I-INDV-GRP-OVRD = 'G'
 10040        MOVE ER-2666             TO WS-ERROR
 10041        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10042        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10043
 10044     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10045        NEXT SENTENCE
 10046     ELSE
 10047        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10048
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 186
* EL050.cbl
 10049     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10050        IF WS-ERROR = ER-2666
 10051           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10052           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10053
 10054     IF PB-COMPANY-ID = 'CID'
 10055        IF PB-STATE = 'UT' OR 'MO'
 10056           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10057                 OR '76' OR '77')
 10058                      OR
 10059               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10060                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10061                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10062                   OR '2K' OR '2L'))
 10063              AND PB-I-INDV-GRP-CD = 'I'
 10064              MOVE ER-2721             TO WS-ERROR
 10065              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10066           END-IF
 10067        END-IF
 10068     END-IF
 10069
 10070     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10071     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10072        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10073     ELSE
 10074        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10075     END-IF
 10076
 10077*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10078*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10079     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10080                                    ACCOUNT-AH-CK-SW.
 10081
 10082     IF PB-REISSUED-CERT       OR
 10083        PB-REIN-ONLY-CERT      OR
 10084        PB-POLICY-IS-DECLINED  OR
 10085        PB-POLICY-IS-VOIDED
 10086*       OR PB-MONTHLY-CERT
 10087         GO TO 3000-CONTINUE-EDIT.
 10088
 10089     IF PB-COMPANY-ID = 'CID'
 10090        IF WS-EDIT-AGE           > +65
 10091           MOVE ER-2709          TO WS-ERROR
 10092           PERFORM 9900-ERROR-FORMAT
 10093                                 THRU 9900-EXIT
 10094        ELSE
 10095           IF WS-EDIT-AGE        > +55
 10096              MOVE ER-2718       TO WS-ERROR
 10097              PERFORM 9900-ERROR-FORMAT
 10098                                 THRU 9900-EXIT
 10099           END-IF
 10100        END-IF
 10101     IF PB-COMPANY-ID = 'DCC'
 10102        IF WS-EDIT-AGE           > +65
 10103           MOVE ER-2709          TO WS-ERROR
 10104           PERFORM 9900-ERROR-FORMAT
 10105                                 THRU 9900-EXIT
 10106        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 187
* EL050.cbl
 10107     END-IF
 10108     .
 10109
 10110 0565-LIFE-PLAN-LIMIT-EDITS.
 10111
 10112     IF NOT LF-PLAN-MASTER-FOUND
 10113        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10114
 10115     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10116
 10117     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10118         IF PL-LM-AGE (1) = ZEROS
 10119             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10120
 10121     IF NO-LF-BENEFIT-MATCH          OR
 10122        WS-LF-BENEFIT-CD = ZEROS     OR
 10123        WS-LF-SPECIAL-CALC-CD = 'M'
 10124        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10125
 10126     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10127     MOVE +1                     TO SUB2.
 10128
 10129     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10130        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10131           MOVE +5   TO SUB2
 10132           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10133              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10134              (PL-LM-AGE (SUB2) EQUAL +0)
 10135              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10136              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10137
 10138     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10139
 10140     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10141                               + PB-I-LF-ALT-BENEFIT-AMT.
 10142
 10143 0568-CHECK-LIFE-ATT-AGE.
 10144
 10145     IF PL-ATT-AGE NUMERIC AND
 10146        PL-ATT-AGE > +0
 10147        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10148     END-IF
 10149*    IF PL-ATT-AGE NUMERIC AND
 10150*       PL-ATT-AGE > +0
 10151*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10152*       IF PB-I-BIRTHDAY > LOW-VALUES
 10153*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10154*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10155*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10156*          SET BIN-PLUS-ELAPSED  TO TRUE
 10157*          PERFORM 8500-DATE-CONVERT
 10158*                                THRU 8500-EXIT
 10159*          IF NO-CONVERSION-ERROR
 10160*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10161*             MOVE ER-2669       TO WS-ERROR
 10162*             PERFORM 9900-ERROR-FORMAT
 10163*                                THRU 9900-EXIT
 10164*          END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 188
* EL050.cbl
 10165*       ELSE
 10166*          IF WS-ATT-AGE >= PL-ATT-AGE
 10167*             MOVE ER-2669       TO WS-ERROR
 10168*             PERFORM 9900-ERROR-FORMAT
 10169*                                THRU 9900-EXIT
 10170*          END-IF
 10171*       END-IF
 10172*    END-IF
 10173     .
 10174 0570-CHECK-LIFE-LIMITS.
 10175
 10176     IF PB-COMPANY-ID EQUAL 'CRI'
 10177        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10178           IF SUB2 GREATER THAN +4
 10179              MOVE ER-2637 TO WS-ERROR
 10180              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10181              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10182
 10183     IF PB-COMPANY-ID  =  'NCL'
 10184        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10185            SUB2 GREATER THAN +8
 10186             MOVE 'U'         TO PB-BATCH-ENTRY
 10187             MOVE ER-2637     TO WS-ERROR
 10188             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10189             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10190
 10191     IF SUB2 > +8
 10192        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10193           AND (PB-I-SIG-SW = 'Y')
 10194           CONTINUE
 10195        ELSE
 10196           MOVE ER-2637          TO WS-ERROR
 10197           PERFORM 9900-ERROR-FORMAT
 10198                                 THRU 9900-EXIT
 10199        END-IF
 10200        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10201     END-IF
 10202     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10203     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10204     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10205
 10206     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10207        ADD +1  TO SUB2
 10208        GO TO 0570-CHECK-LIFE-LIMITS.
 10209
 10210     IF PB-COMPANY-ID = 'NCL'
 10211         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10212
 10213     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10214        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10215        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10216           AND (PB-I-SIG-SW = 'Y')
 10217           CONTINUE
 10218        ELSE
 10219           MOVE ER-2637          TO WS-ERROR
 10220           PERFORM 9900-ERROR-FORMAT
 10221                                 THRU 9900-EXIT
 10222        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 189
* EL050.cbl
 10223     END-IF
 10224     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10225
 10226
 10227 0570-CHECK-NCL-LIFE-LIMITS.
 10228
 10229     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10230        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10231         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10232
 10233     IF APP-CERT-USED
 10234         IF SUB2  LESS THAN  +5
 10235             MOVE +5          TO SUB2
 10236             GO TO 0570-CHECK-LIFE-LIMITS.
 10237
 10238     MOVE ER-2637             TO WS-ERROR.
 10239     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10240
 10241     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10242
 10243 0575-CHECK-NCL-SIG-SWITCH.
 10244
 10245     IF NOT APP-CERT-USED
 10246         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10247
 10248     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10249        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10250        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10251        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10252         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10253
 10254     IF SUB2 GREATER THAN +4
 10255         IF PL-LM-AGE (5) = ZEROS  AND
 10256            PL-LM-AGE (6) = ZEROS  AND
 10257            PL-LM-AGE (7) = ZEROS  AND
 10258            PL-LM-AGE (8) = ZEROS
 10259             MOVE  ER-1927        TO WS-ERROR
 10260             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10261             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10262         ELSE
 10263             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10264                 MOVE  ER-1920    TO WS-ERROR
 10265                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10266
 10267     IF PB-I-SIG-SW  = 'Y'
 10268       IF NOT PB-I-POLICY-ACCEPTED  AND
 10269          NOT PB-I-POLICY-DECLINED
 10270           MOVE 'U'               TO PB-BATCH-ENTRY
 10271           MOVE  ER-1926          TO WS-ERROR
 10272           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10273
 10274
 10275 0580-AH-PLAN-LIMIT-EDITS.
 10276
 10277     IF PB-COMPANY-ID = 'CID'
 10278        IF PB-I-AH-BENEFIT-AMT > +1250
 10279           MOVE ER-2702          TO WS-ERROR
 10280           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 190
* EL050.cbl
 10281                                 THRU 9900-EXIT
 10282        END-IF
 10283     END-IF
 10284
 10285     IF (PB-COMPANY-ID = 'DCC')
 10286        AND (PB-MONTHLY-CERT)
 10287        IF PB-I-AH-BENEFIT-AMT > +1000
 10288           MOVE ER-2881          TO WS-ERROR
 10289           PERFORM 9900-ERROR-FORMAT
 10290                                 THRU 9900-EXIT
 10291        END-IF
 10292     END-IF
 10293     IF NOT AH-PLAN-MASTER-FOUND
 10294        GO TO 3000-CONTINUE-EDIT.
 10295
 10296     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10297
 10298     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10299         IF PL-LM-AGE (1) = ZEROS
 10300             GO TO 3000-CONTINUE-EDIT.
 10301
 10302     IF NO-AH-BENEFIT-MATCH          OR
 10303        WS-AH-BENEFIT-CD = ZEROS     OR
 10304        WS-AH-SPECIAL-CALC-CD = 'M'
 10305        GO TO 3000-CONTINUE-EDIT.
 10306
 10307     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10308     MOVE +1                     TO SUB2.
 10309
 10310     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10311        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10312           MOVE +5 TO SUB2
 10313           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10314              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10315              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10316              (PL-LM-AGE (SUB2) EQUAL +0)
 10317              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10318              GO TO 3000-CONTINUE-EDIT.
 10319
 10320     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10321
 10322 0590-CHECK-AH-ATT-AGE.
 10323
 10324     IF PL-ATT-AGE NUMERIC AND
 10325        PL-ATT-AGE GREATER THAN +0
 10326        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10327     END-IF
 10328*       IF WS-ATT-AGE >= PL-ATT-AGE
 10329*          MOVE ER-3054          TO WS-ERROR
 10330*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10331     .
 10332 0597-CHECK-AH-LIMITS.
 10333
 10334     IF PB-COMPANY-ID EQUAL 'CRI'
 10335        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10336           IF SUB2 GREATER THAN +4
 10337              MOVE ER-2638       TO WS-ERROR
 10338              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 191
* EL050.cbl
 10339              GO TO 3000-CONTINUE-EDIT.
 10340
 10341     IF PB-COMPANY-ID  =  'NCL'
 10342        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10343            SUB2 GREATER THAN +8
 10344             MOVE 'U'            TO PB-BATCH-ENTRY
 10345             MOVE ER-2638        TO WS-ERROR
 10346             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10347             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10348
 10349     IF SUB2 > +8
 10350        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10351           AND (PB-I-SIG-SW = 'Y')
 10352           CONTINUE
 10353        ELSE
 10354           MOVE ER-2638          TO WS-ERROR
 10355           PERFORM 9900-ERROR-FORMAT
 10356                                 THRU 9900-EXIT
 10357        END-IF
 10358        GO TO 3000-CONTINUE-EDIT
 10359     END-IF
 10360
 10361     IF PB-COMPANY-ID = 'CRI'
 10362        IF WS-ERROR = ER-2638
 10363           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10364
 10365     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10366     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10367     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10368     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10369
 10370     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10371        ADD +1                   TO SUB2
 10372        GO TO 0597-CHECK-AH-LIMITS.
 10373
 10374     IF PB-COMPANY-ID = 'NCL'
 10375         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10376
 10377     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10378        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10379        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10380                                 > PL-LM-AMT (SUB2))
 10381        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10382           AND (PB-I-SIG-SW = 'Y')
 10383           CONTINUE
 10384        ELSE
 10385           MOVE ER-2638          TO WS-ERROR
 10386           PERFORM 9900-ERROR-FORMAT
 10387                                 THRU 9900-EXIT
 10388        END-IF
 10389     END-IF
 10390
 10391     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10392         IF  WS-ERROR    EQUAL    ER-2638
 10393             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10394                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 10395                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10396                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 192
* EL050.cbl
 10397                MOVE  ER-1910    TO  WS-ERROR
 10398                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 10399
 10400     IF PB-COMPANY-ID = 'CRI'
 10401        IF WS-ERROR = ER-2638
 10402            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10403            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10404            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 10405
 10406     GO TO 3000-CONTINUE-EDIT.
 10407
 10408 0597-CHECK-NCL-AH-LIMITS.
 10409
 10410     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 10411        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 10412        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10413                            NOT GREATER THAN PL-LM-AMT (SUB2))
 10414         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10415
 10416     IF APP-CERT-USED
 10417         IF SUB2  LESS THAN  +5
 10418             MOVE +5             TO SUB2
 10419             GO TO 0597-CHECK-AH-LIMITS.
 10420
 10421     MOVE ER-2638                TO WS-ERROR.
 10422     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10423
 10424     MOVE 'U'                    TO PB-BATCH-ENTRY.
 10425
 10426 0599-CHECK-NCL-SIG-SWITCH.
 10427
 10428     IF NOT APP-CERT-USED
 10429         GO TO 3000-CONTINUE-EDIT.
 10430
 10431     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10432        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10433        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10434        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10435         GO TO 3000-CONTINUE-EDIT.
 10436
 10437     IF SUB2 GREATER THAN +4
 10438         IF PL-LM-AGE (5) = ZEROS  AND
 10439            PL-LM-AGE (6) = ZEROS  AND
 10440            PL-LM-AGE (7) = ZEROS  AND
 10441            PL-LM-AGE (8) = ZEROS
 10442             MOVE  ER-1927        TO WS-ERROR
 10443             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10444             GO TO 3000-CONTINUE-EDIT
 10445         ELSE
 10446             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10447                 MOVE  ER-1920    TO WS-ERROR
 10448                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10449
 10450     IF PB-I-SIG-SW  = 'Y'
 10451       IF NOT PB-I-POLICY-ACCEPTED  AND
 10452          NOT PB-I-POLICY-DECLINED
 10453           MOVE 'U'               TO PB-BATCH-ENTRY
 10454           MOVE  ER-1926          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 193
* EL050.cbl
 10455           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10456
 10457******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 194
* EL050.cbl
 10459
 10460 3000-CONTINUE-EDIT.
 10461
 10462     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10463     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 10464     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10465     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10466     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10467
 10468     IF BROWSE-STARTED
 10469        PERFORM 9990-RETURN THRU 9990-EXIT
 10470        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 10471
 10472     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 10473        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10474        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10475        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10476*       MOVE 1                   TO DC-OPTION-CODE
 10477        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10478        IF DATE-CONVERSION-ERROR
 10479           MOVE ER-2622          TO WS-ERROR
 10480           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10481        ELSE
 10482           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 10483              MOVE ER-2623       TO WS-ERROR
 10484              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10485           ELSE
 10486              MOVE ER-2622       TO WS-ERROR
 10487              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10488
 10489     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 10490     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 10491     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 10492*    MOVE 1                      TO DC-OPTION-CODE.
 10493     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10494     IF DATE-CONVERSION-ERROR
 10495        GO TO 3005-EDIT-CONTINUE
 10496     ELSE
 10497        IF DC-ELAPSED-DAYS GREATER +180
 10498           MOVE ER-2613          TO WS-ERROR
 10499           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10500        ELSE
 10501           IF DC-ELAPSED-DAYS GREATER +90
 10502              MOVE ER-2612       TO WS-ERROR
 10503              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10504           ELSE
 10505             IF DC-ELAPSED-DAYS GREATER +60
 10506                MOVE ER-2614     TO WS-ERROR
 10507                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10508
 10509 3005-EDIT-CONTINUE.
 10510
 10511     IF PB-CANCELLATION
 10512         GO TO 3700-EDIT-CANCEL.
 10513
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 195
* EL050.cbl
 10515******************************************************************
 10516*                  E D I T   I S S U E                           *
 10517******************************************************************
 10518
 10519 3020-EDIT-ISSUE.
 10520
 10521      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 10522      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 10523      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 10524      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 10525      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 10526
 10527     IF PB-ISSUE-FORCE
 10528        OR PB-ISSUE-DATE-FORCED
 10529        OR PB-FORCE-OFF
 10530        OR PB-OVERCHARGE-FORCE
 10531        CONTINUE
 10532     ELSE
 10533        MOVE ER-2670             TO WS-ERROR
 10534        PERFORM 9900-ERROR-FORMAT
 10535                                 THRU 9900-EXIT
 10536     END-IF
 10537     .
 10538 3022-SET-POLICY-STATUS.
 10539
 10540     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 10541
 10542     IF (PB-REISSUED-CERT)
 10543             OR
 10544        ((PB-COMPANY-ID NOT = 'DCC')
 10545         AND (PB-MONTHLY-CERT))
 10546         MOVE '5'                TO PB-I-ENTRY-STATUS
 10547         MOVE 'E'                TO PB-BATCH-ENTRY
 10548     END-IF
 10549
 10550     IF PB-COMPANY-ID = 'DCC'
 10551        IF PB-MONTHLY-CERT
 10552           MOVE 'M'              TO PB-I-ENTRY-STATUS
 10553        END-IF
 10554     END-IF
 10555     IF PB-POLICY-IS-DECLINED
 10556         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 10557     IF PB-POLICY-IS-VOIDED
 10558         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 10559     IF PB-NEEDS-UNDERWRITING
 10560         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 10561     IF PB-REIN-ONLY-CERT
 10562         MOVE '9'                TO PB-I-ENTRY-STATUS.
 10563     IF PB-PREM-ACCTNG-ONLY
 10564         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 10565
 10566     MOVE SPACE                  TO PB-I-OB-FLAG.
 10567
 10568     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 10569         MOVE ER-2665            TO WS-ERROR
 10570         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10571         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 10572
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 196
* EL050.cbl
 10573     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 10574        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 10575           MOVE 'Z'             TO PB-I-OB-FLAG.
 10576
 10577     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 10578        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 10579           MOVE 'Z'             TO PB-I-OB-FLAG.
 10580
 10581     IF ACCOUNT-MAST-FOUND
 10582         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 10583         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 10584         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 10585         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 10586         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 10587         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 10588         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 10589     END-IF
 10590
 10591     IF ACCOUNT-MAST-FOUND
 10592        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 10593         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 10594
 10595     IF (ACCOUNT-MAST-FOUND)
 10596        AND (WS-ACCT-STATUS = 'I' OR 'F')
 10597        IF PB-REISSUED-CERT
 10598           CONTINUE
 10599        ELSE
 10600           MOVE ER-2608          TO WS-ERROR
 10601           PERFORM 9900-ERROR-FORMAT
 10602                                 THRU 9900-EXIT
 10603         END-IF
 10604     END-IF
 10605
 10606     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 10607        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 10608        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 10609
 10610**********   DMD CUSTOM CODE FOLLOWS  **********
 10611 3024-EDIT-DMD-FIELDS.
 10612     IF PB-COMPANY-ID NOT = 'DMD'
 10613        GO TO 3025-EDIT-REINSURANCE.
 10614
 10615*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 10616*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 10617*** ERROR IF THEY ARE NOT EQUAL.
 10618
 10619     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 10620     SET BIN-TO-GREG               TO TRUE.
 10621     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10622     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 10623**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 10624
 10625     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 10626     SET BIN-TO-GREG               TO TRUE.
 10627     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10628     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 10629**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 10630
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 197
* EL050.cbl
 10631     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 10632        MOVE ER-8116               TO WS-ERROR
 10633        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10634
 10635     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 10636
 10637     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 10638                                      WK-FULL-CERT-NO.
 10639     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 10640
 10641     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 10642
 10643     IF PB-VALID-LIFE
 10644        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 10645     ELSE
 10646        IF PB-VALID-AH
 10647          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 10648
 10649
 10650     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 10651     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 10652     MOVE SPACES                   TO DCUA-CERT-NUMBER
 10653                                      DCUA-UNDRWRTR-CODE
 10654                                      DCUA-UNDRWRTR-GROUP-CODE
 10655                                      DCUA-RETURN-CODE.
 10656
 10657****************************************************************
 10658*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 10659***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 10660***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 10661***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 10662***   TO THIS RECORD.                                        ***
 10663****************************************************************
 10664     MOVE ' '                      TO WS-DLO-ERROR-SW.
 10665     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 10666     IF DCUA-SUCCESSFUL-PROCESS
 10667        GO TO 3024-EDIT-DL7-CONT.
 10668
 10669     IF DCUA-RETURN-CODE EQUAL '01'
 10670        MOVE ER-8110               TO WS-ERROR
 10671        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10672        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10673        GO TO 3024-EDIT-DL7-CONT.
 10674
 10675     IF DCUA-RETURN-CODE EQUAL '02'
 10676        MOVE ER-8111               TO WS-ERROR
 10677        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10679        GO TO 3024-EDIT-DL7-CONT.
 10680
 10681     IF DCUA-RETURN-CODE EQUAL '03'
 10682        MOVE ER-8074               TO WS-ERROR
 10683        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10684        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10685        GO TO 3024-EDIT-DL7-CONT.
 10686
 10687     IF DCUA-RETURN-CODE EQUAL '04'
 10688        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 198
* EL050.cbl
 10689        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10691        GO TO 3024-EDIT-DL7-CONT.
 10692
 10693     IF DCUA-RETURN-CODE EQUAL '05'
 10694        MOVE ER-8076               TO WS-ERROR
 10695        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10696        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10697        GO TO 3024-EDIT-DL7-CONT.
 10698
 10699     IF DCUA-RETURN-CODE EQUAL '06'
 10700        MOVE ER-8077               TO WS-ERROR
 10701        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10702        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10703        GO TO 3024-EDIT-DL7-CONT.
 10704
 10705     IF DCUA-RETURN-CODE EQUAL '07'
 10706        MOVE ER-8078               TO WS-ERROR
 10707        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10709        GO TO 3024-EDIT-DL7-CONT.
 10710
 10711     IF DCUA-RETURN-CODE EQUAL 'E1'
 10712        MOVE ER-8079               TO WS-ERROR
 10713        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10715        GO TO 3024-EDIT-DL7-CONT.
 10716
 10717     IF DCUA-RETURN-CODE EQUAL 'E2'
 10718        MOVE ER-8080               TO WS-ERROR
 10719        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10721        GO TO 3024-EDIT-DL7-CONT.
 10722
 10723     IF DCUA-RETURN-CODE EQUAL 'E3'
 10724        MOVE ER-8098               TO WS-ERROR
 10725        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10727        GO TO 3024-EDIT-DL7-CONT.
 10728
 10729     IF DCUA-RETURN-CODE EQUAL 'C1'
 10730        MOVE ER-8099               TO WS-ERROR
 10731        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10732        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10733        GO TO 3024-EDIT-DL7-CONT.
 10734
 10735     IF DCUA-RETURN-CODE EQUAL 'U1'
 10736        MOVE ER-8109               TO WS-ERROR
 10737        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10739        GO TO 3024-EDIT-DL7-CONT.
 10740
 10741     IF DCUA-RETURN-CODE EQUAL 'N1'
 10742        MOVE ER-8112               TO WS-ERROR
 10743        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10744        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10745        GO TO 3024-EDIT-DL7-CONT.
 10746
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 199
* EL050.cbl
 10747     IF DCUA-RETURN-CODE EQUAL 'N2'
 10748        MOVE ER-8113               TO WS-ERROR
 10749        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10750        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10751        GO TO 3024-EDIT-DL7-CONT.
 10752
 10753     IF DCUA-RETURN-CODE EQUAL 'N3'
 10754        MOVE ER-8114               TO WS-ERROR
 10755        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 10756        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10757        GO TO 3024-EDIT-DL7-CONT.
 10758
 10759     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 10760     MOVE ER-8097                  TO WS-ERROR.
 10761     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 10762     GO TO 3024-EDIT-DL7-CONT.
 10763
 10764 3024-EDIT-DL7-CONT.
 10765
 10766     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 10767     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 10768     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 10769        NEXT SENTENCE
 10770     ELSE
 10771        MOVE ER-9263               TO WS-ERROR
 10772        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10773
 10774******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 10775******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 10776     IF DCUA-CERT-NUMBER = PB-CERT-NO
 10777        NEXT SENTENCE
 10778     ELSE
 10779        MOVE ER-8039               TO WS-ERROR
 10780        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10781
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 200
* EL050.cbl
 10783****************************************************************
 10784*** VALIDATE STATE  : DLO022                                 ***
 10785****************************************************************
 10786     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 10787     MOVE SPACES                   TO DVSC-RETURN-CODE.
 10788
 10789     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 10790     IF DVSC-SUCCESSFUL-EDIT
 10791        GO TO 3024-EDIT-DL22-CONT.
 10792
 10793     IF DVSC-RETURN-CODE EQUAL '01'
 10794        MOVE ER-8300               TO WS-ERROR
 10795        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10796        GO TO 3024-EDIT-DL22-CONT.
 10797
 10798     IF DVSC-RETURN-CODE EQUAL '02'
 10799        MOVE ER-8301               TO WS-ERROR
 10800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10801        GO TO 3024-EDIT-DL22-CONT.
 10802
 10803     IF DVSC-RETURN-CODE EQUAL '03'
 10804        MOVE ER-8302               TO WS-ERROR
 10805        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10806        GO TO 3024-EDIT-DL22-CONT.
 10807
 10808     IF DVSC-RETURN-CODE EQUAL 'N1'
 10809        MOVE ER-8304               TO WS-ERROR
 10810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10811        GO TO 3024-EDIT-DL22-CONT.
 10812
 10813     MOVE ER-8303                  TO WS-ERROR
 10814     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10815
 10816 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 201
* EL050.cbl
 10818****************************************************************
 10819*** VALIDATE LOAN OFFICER : DLO021                           ***
 10820****************************************************************
 10821
 10822     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 10823     MOVE SPACES                    TO DVLO-RETURN-CODE.
 10824     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 10825     IF DVLO-SUCCESSFUL-EDIT
 10826        GO TO 3024-EDIT-DL21-CONT.
 10827
 10828     IF DVLO-RETURN-CODE EQUAL '01'
 10829        MOVE ER-8081               TO WS-ERROR
 10830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10831        GO TO 3024-EDIT-DL21-CONT.
 10832
 10833     IF DVLO-RETURN-CODE EQUAL '02'
 10834        MOVE ER-8082               TO WS-ERROR
 10835        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10836        GO TO 3024-EDIT-DL21-CONT.
 10837
 10838     IF DVLO-RETURN-CODE EQUAL '03'
 10839        MOVE ER-8083               TO WS-ERROR
 10840        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10841        GO TO 3024-EDIT-DL21-CONT.
 10842
 10843     IF DVLO-RETURN-CODE EQUAL '04'
 10844        MOVE ER-8084               TO WS-ERROR
 10845        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10846        GO TO 3024-EDIT-DL21-CONT.
 10847
 10848     IF DVLO-RETURN-CODE EQUAL '05'
 10849        MOVE ER-8085               TO WS-ERROR
 10850        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10851        GO TO 3024-EDIT-DL21-CONT.
 10852
 10853     MOVE ER-7825                  TO WS-ERROR
 10854     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 10855     GO TO 3024-EDIT-DL21-CONT.
 10856
 10857 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 202
* EL050.cbl
 10859
 10860****************************************************************
 10861*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 10862****************************************************************
 10863
 10864     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 10865     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 10866     MOVE SPACES                 TO DIPF-RETURN-CODE.
 10867     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 10868     IF DIPF-SUCCESSFUL-EDIT
 10869        GO TO 3024-EDIT-DL02-CONT.
 10870
 10871     IF DIPF-RETURN-CODE EQUAL '01'
 10872        MOVE ER-8086               TO WS-ERROR
 10873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10874        GO TO 3024-EDIT-DL02-CONT.
 10875
 10876     IF DIPF-RETURN-CODE EQUAL '02'
 10877        MOVE ER-8087               TO WS-ERROR
 10878        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10879        GO TO 3024-EDIT-DL02-CONT.
 10880
 10881     IF DIPF-RETURN-CODE EQUAL '03'
 10882        MOVE ER-8088               TO WS-ERROR
 10883        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10884        GO TO 3024-EDIT-DL02-CONT.
 10885
 10886     MOVE ER-8095                  TO WS-ERROR
 10887     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 10888     GO TO 3024-EDIT-DL02-CONT.
 10889
 10890 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 203
* EL050.cbl
 10892
 10893****************************************************************
 10894*** VALIDATE BANK ID : DLO003                                ***
 10895****************************************************************
 10896
 10897     MOVE WK-GREG-CENT           TO WCG-CENT.
 10898     MOVE WK-GREG-YYMM           TO WCG-REST.
 10899     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 10900        MOVE ER-8040               TO WS-ERROR
 10901        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10902
 10903     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 10904     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 10905     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 10906     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 10907     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 10908     IF DVBI-SUCCESSFUL-EDIT
 10909        GO TO 3024-EDIT-DL03-CONT.
 10910
 10911     IF DVBI-RETURN-CODE EQUAL '01'
 10912        MOVE ER-8089               TO WS-ERROR
 10913        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10914        GO TO 3024-EDIT-DL03-CONT.
 10915
 10916     IF DVBI-RETURN-CODE EQUAL '02'
 10917        MOVE ER-8090               TO WS-ERROR
 10918        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10919        GO TO 3024-EDIT-DL03-CONT.
 10920
 10921     IF DVBI-RETURN-CODE EQUAL '03'
 10922        MOVE ER-8091               TO WS-ERROR
 10923        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10924        GO TO 3024-EDIT-DL03-CONT.
 10925
 10926     IF DVBI-RETURN-CODE EQUAL '04'
 10927        MOVE ER-8092               TO WS-ERROR
 10928        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10929        GO TO 3024-EDIT-DL03-CONT.
 10930
 10931     IF DVBI-RETURN-CODE EQUAL '05'
 10932        MOVE ER-8093               TO WS-ERROR
 10933        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10934        GO TO 3024-EDIT-DL03-CONT.
 10935
 10936     IF DVBI-RETURN-CODE EQUAL '06'
 10937        MOVE ER-8094               TO WS-ERROR
 10938        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10939        GO TO 3024-EDIT-DL03-CONT.
 10940
 10941     MOVE ER-8096                  TO WS-ERROR
 10942     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 10943     GO TO 3024-EDIT-DL03-CONT.
 10944
 10945 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 204
* EL050.cbl
 10947
 10948     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 10949        NEXT SENTENCE
 10950     ELSE
 10951        MOVE ER-8042               TO WS-ERROR
 10952        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10953
 10954     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 10955     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 10956     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 10957
 10958     IF DMPF-RETURN-CODE = '01'
 10959        MOVE ER-8067               TO WS-ERROR
 10960        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10961        GO TO 3024-EDIT-DL01-CONT.
 10962
 10963     IF DMPF-RETURN-CODE = '02'
 10964        MOVE ER-8068               TO WS-ERROR
 10965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10966        GO TO 3024-EDIT-DL01-CONT.
 10967
 10968     IF DMPF-RETURN-CODE = '03'
 10969        MOVE ER-8069               TO WS-ERROR
 10970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10971        GO TO 3024-EDIT-DL01-CONT.
 10972
 10973     IF DMPF-RETURN-CODE = 'E1'
 10974        MOVE ER-8070               TO WS-ERROR
 10975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10976        GO TO 3024-EDIT-DL01-CONT.
 10977
 10978     IF DMPF-RETURN-CODE = 'N1'
 10979        MOVE ER-8071               TO WS-ERROR
 10980        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10981        GO TO 3024-EDIT-DL01-CONT.
 10982
 10983     IF DMPF-RETURN-CODE NOT = 'OK'
 10984        MOVE ER-8072               TO WS-ERROR
 10985        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10986
 10987 3024-EDIT-DL01-CONT.
 10988******************************************************************
 10989***  VALIDATES RATE CODES : DLO017                             ***
 10990******************************************************************
 10991
 10992      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 10993      MOVE SPACES                   TO DVRC-RETURN-CODE.
 10994      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 10995      IF DVRC-SUCCESSFUL-EDIT
 10996        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 10997        GO TO 3024-CHECK-VALID-RATE.
 10998
 10999      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11000
 11001      IF DVRC-RETURN-CODE EQUAL '01'
 11002         MOVE ER-7817                   TO WS-ERROR
 11003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11004         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 205
* EL050.cbl
 11005
 11006      IF DVRC-RETURN-CODE EQUAL '02'
 11007         MOVE ER-7818                   TO WS-ERROR
 11008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11009         GO TO 3025-EDIT-REINSURANCE.
 11010
 11011      IF DVRC-RETURN-CODE EQUAL '03'
 11012         MOVE ER-7819                   TO WS-ERROR
 11013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11014         GO TO 3025-EDIT-REINSURANCE.
 11015
 11016       MOVE ER-7820                     TO WS-ERROR.
 11017       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11018       GO TO 3025-EDIT-REINSURANCE.
 11019
 11020******************************************************************
 11021***  GET PREMIUM RATES : DLO011                                ***
 11022******************************************************************
 11023
 11024 3024-CHECK-VALID-RATE.
 11025
 11026     IF VALID-RATE-CODE
 11027        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11028        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11029        MOVE SPACES                TO DPRB-RETURN-CODE
 11030        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11031     ELSE
 11032         GO TO 3025-EDIT-REINSURANCE.
 11033
 11034      IF DPRB-SUCCESSFUL-PROCESS
 11035         IF PB-VALID-LIFE
 11036             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11037             GO TO 3025-EDIT-REINSURANCE
 11038         ELSE
 11039             IF PB-VALID-AH
 11040                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11041                 GO TO 3025-EDIT-REINSURANCE.
 11042
 11043      IF DPRB-RETURN-CODE EQUAL '01'
 11044         MOVE ER-7812                   TO WS-ERROR
 11045         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11046         GO TO 3025-EDIT-REINSURANCE.
 11047
 11048      IF DPRB-RETURN-CODE EQUAL '02'
 11049         MOVE ER-7813                   TO WS-ERROR
 11050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11051         GO TO 3025-EDIT-REINSURANCE.
 11052
 11053      IF DPRB-RETURN-CODE EQUAL '03'
 11054         MOVE ER-7814                   TO WS-ERROR
 11055         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11056         GO TO 3025-EDIT-REINSURANCE.
 11057
 11058      IF DPRB-RETURN-CODE EQUAL '04'
 11059         IF NOT DPRB-1ST-TIME
 11060            MOVE ER-7815                   TO WS-ERROR
 11061            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11062            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 206
* EL050.cbl
 11063          ELSE
 11064         IF PB-VALID-LIFE
 11065            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11066          ELSE
 11067            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11068         END-IF
 11069         MOVE SPACES                TO DOCC-RETURN-CODE
 11070         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11071         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11072         IF DOCC-RETURN-CODE = 'OK'
 11073             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11074             GO TO 3024-CHECK-VALID-RATE
 11075           ELSE
 11076             MOVE ER-7823               TO WS-ERROR
 11077             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11078             GO TO 3025-EDIT-REINSURANCE.
 11079
 11080       MOVE ER-7816                     TO WS-ERROR.
 11081       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11082       GO TO 3025-EDIT-REINSURANCE.
 11083
 11084**********   DMD CUSTOM CODE ABOVE    **********
 11085
 11086 3025-EDIT-REINSURANCE.
 11087     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11088         GO TO 3027-EDIT-CONTINUE.
 11089
 11090     MOVE LOW-VALUES               TO ERREIN-KEY.
 11091     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11092     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11093                                      REIN-CODE-2
 11094                                      REIN-CODE-3.
 11095     MOVE 'A'                      TO REIN-TYPE.
 11096
 11097     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11098
 11099     MOVE '3026' TO REIN-SW.
 11100     MOVE ' '                   TO WS-REIN-READ-SW.
 11101
 11102     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11103     IF REIN-TABLE-NOT-FOUND
 11104         GO TO 3026-NO-SPEC-TABLE.
 11105
 11106     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11107     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11108                                   WS-NSP-ST-CD-LF.
 11109     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11110                                   WS-NSP-ST-CD-AH.
 11111
 11112     GO TO 3040-EDIT-CONTINUE.
 11113
 11114 3026-NO-SPEC-TABLE.
 11115
 11116     MOVE ER-2664                TO WS-ERROR.
 11117     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11118     GO TO 3040-EDIT-CONTINUE.
 11119
 11120 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 207
* EL050.cbl
 11121
 11122     IF PB-I-REIN-TABLE = SPACES
 11123       GO TO 3040-EDIT-CONTINUE.
 11124
 11125     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11126          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11127          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11128           GO TO 3040-EDIT-CONTINUE.
 11129
 11130     MOVE LOW-VALUES            TO ERREIN-KEY.
 11131     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11132     MOVE 'A'                   TO REIN-TYPE.
 11133     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11134
 11135     MOVE '3028'                TO REIN-SW.
 11136     MOVE ' '                   TO WS-REIN-READ-SW.
 11137
 11138     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11139     IF REIN-TABLE-NOT-FOUND
 11140         GO TO 3028-NO-REIN-TABLE.
 11141
 11142     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11143     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11144                                   WS-NSP-ST-CD-LF.
 11145     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11146                                   WS-NSP-ST-CD-AH.
 11147
 11148     GO TO 3040-EDIT-CONTINUE.
 11149
 11150 3028-NO-REIN-TABLE.
 11151
 11152     MOVE ER-2615                TO WS-ERROR.
 11153     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11154     GO TO 3040-EDIT-CONTINUE.
 11155
 11156 3040-EDIT-CONTINUE.
 11157
 11158     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11159         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11160
 11161     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11162         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11163
 11164     IF (NOT PB-REISSUED-CERT)
 11165        AND (NOT PB-MONTHLY-CERT)
 11166        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11167            MOVE '001'           TO PB-I-LF-TERM
 11168            MOVE 'M'             TO PB-I-INSURED-SEX.
 11169
 11170     IF (NOT PB-REISSUED-CERT)
 11171        AND (NOT PB-MONTHLY-CERT)
 11172        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11173            MOVE '001'           TO PB-I-AH-TERM
 11174            MOVE 'M'             TO PB-I-INSURED-SEX.
 11175
 11176 3040-EDIT-1ST-PMT-DT.
 11177     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11178     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 208
* EL050.cbl
 11179         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11180
 11181******************************************************************
 11182*                                                                *
 11183*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11184*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11185*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11186*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11187*                                                                *
 11188******************************************************************
 11189
 11190     IF PB-EFF-DT-PROCESSING
 11191        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11192                                    PB-I-LF-EXPIRE-DT
 11193                                    PB-I-AH-EXPIRE-DT
 11194        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11195        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11196        MOVE ZERO                TO DC-ELAPSED-DAYS
 11197        MOVE +1                  TO DC-ELAPSED-MONTHS
 11198        SET BIN-PLUS-ELAPSED     TO TRUE
 11199*       MOVE 6                   TO DC-OPTION-CODE
 11200        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11201        IF NO-CONVERSION-ERROR
 11202           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11203
 11204******************************************************************
 11205*                                                                *
 11206*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11207*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11208*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11209*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11210*                                                                *
 11211******************************************************************
 11212
 11213     IF PB-EXT-DAYS-PROCESSING
 11214          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11215                                         PB-I-LF-EXPIRE-DT
 11216                                         PB-I-AH-EXPIRE-DT
 11217          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11218          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11219          MOVE +1                     TO DC-ELAPSED-MONTHS
 11220          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11221          SET BIN-PLUS-ELAPSED        TO TRUE
 11222*         MOVE 6                      TO DC-OPTION-CODE
 11223          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11224          IF NO-CONVERSION-ERROR
 11225             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11226
 11227******************************************************************
 11228*                                                                *
 11229*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11230*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11231*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11232*        (EXPIRE DATE - (TERM -1))  *  -1.
 11233*                                                                *
 11234******************************************************************
 11235
 11236     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 209
* EL050.cbl
 11237        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11238           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11239              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11240              MOVE PB-I-AH-TERM      TO WS-TERM
 11241           ELSE
 11242              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11243              MOVE PB-I-LF-TERM      TO WS-TERM
 11244        ELSE
 11245           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11246              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11247              MOVE PB-I-LF-TERM      TO WS-TERM
 11248           ELSE
 11249              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11250              MOVE PB-I-AH-TERM      TO WS-TERM.
 11251
 11252     IF PB-EXPIRE-DT-PROCESSING
 11253        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11254        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11255        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11256        MOVE ZERO                TO DC-ELAPSED-DAYS
 11257                                    DC-ODD-DAYS-OVER
 11258          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11259          SET BIN-PLUS-ELAPSED    TO TRUE
 11260*         MOVE 6                  TO DC-OPTION-CODE
 11261          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11262          IF NO-CONVERSION-ERROR
 11263             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11264
 11265******************************************************************
 11266*                                                                *
 11267*            1ST PAYMENT DATE PROCESSING                         *
 11268*                                                                *
 11269******************************************************************
 11270
 11271     IF PB-1ST-PMT-DT-PROCESSING
 11272        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11273                                    PB-I-AH-EXPIRE-DT
 11274        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11275
 11276     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11277         NEXT SENTENCE
 11278     ELSE
 11279         MOVE ER-2680                 TO WS-ERROR
 11280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11281         GO TO 3060-ORIG-TERM-CHECK.
 11282
 11283     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11284     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11285     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11286*    MOVE 1                      TO DC-OPTION-CODE.
 11287     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11288                                    DC-ELAPSED-DAYS
 11289                                    DC-ODD-DAYS-OVER.
 11290
 11291     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11292
 11293     IF DATE-CONVERSION-ERROR
 11294        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 210
* EL050.cbl
 11295
 11296     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11297     IF (PB-COMPANY-ID = 'CID')
 11298        AND (WS-LF-COVERAGE-TYPE = 'L')
 11299        IF (DC-ELAPSED-MONTHS > 1)
 11300                      OR
 11301           ((DC-ELAPSED-MONTHS = 1)
 11302           AND (DC-ODD-DAYS-OVER > 0))
 11303           MOVE ER-2882          TO WS-ERROR
 11304           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11305        END-IF
 11306     END-IF
 11307     IF PB-EXT-DAYS-PROCESSING
 11308        CONTINUE
 11309     ELSE
 11310        IF DC-ELAPSED-MONTHS = +0
 11311           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11312        ELSE
 11313           IF (WS-LF-EARNINGS-CALC = '4')
 11314              AND (DC-ELAPSED-MONTHS > ZERO)
 11315              AND (DC-ELAPSED-DAYS > ZERO)
 11316              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11317           ELSE
 11318              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11319                                 THRU 6499-EXIT
 11320              MOVE WS-ODD-DAYS-OVER
 11321                                 TO PB-I-EXTENTION-DAYS
 11322           END-IF
 11323        END-IF
 11324     END-IF
 11325******************************************************************
 11326*                                                                *
 11327*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11328*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11329*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11330*            AND ANY ODD DAYS.                                   *
 11331*                                                                *
 11332******************************************************************
 11333
 11334     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11335                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11336     IF WS-LF-EARNINGS-CALC NOT = '4'
 11337        IF DC-ELAPSED-DAYS > ZEROS
 11338           MOVE ER-2681          TO WS-ERROR
 11339           PERFORM 9900-ERROR-FORMAT
 11340                                 THRU 9900-EXIT
 11341        END-IF
 11342     END-IF
 11343
 11344     IF WS-LF-EARNINGS-CALC NOT = '4'
 11345        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11346           MOVE ER-2681          TO WS-ERROR
 11347           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11348
 11349     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11350        (PB-I-LF-TERM NOT = ZERO) AND
 11351         NOT NO-LIFE-COVERAGE
 11352          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 211
* EL050.cbl
 11353          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11354          IF WS-LF-EARNINGS-CALC = '4'
 11355             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11356             PB-I-PAY-FREQUENCY
 11357          END-IF
 11358          MOVE ZERO              TO DC-ELAPSED-DAYS
 11359                                    DC-ODD-DAYS-OVER
 11360          MOVE 1                 TO DC-END-OF-MONTH
 11361          SET BIN-PLUS-ELAPSED        TO TRUE
 11362*         MOVE 6                 TO DC-OPTION-CODE
 11363          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11364          IF NO-CONVERSION-ERROR
 11365             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11366             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11367                (WS-LF-SPECIAL-CALC-CD = 'L')
 11368                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11369                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11370                  MOVE +1             TO DC-ELAPSED-MONTHS
 11371                  SET BIN-PLUS-ELAPSED  TO TRUE
 11372*                 MOVE 6              TO DC-OPTION-CODE
 11373                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11374                  IF NO-CONVERSION-ERROR
 11375                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11376
 11377* okay, i had to move the new att age edit down here because the
 11378* expiration date could get recalculated and i need the exp date
 11379     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11380        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11381        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11382        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11383           AND ZEROS
 11384           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11385           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11386           SET ELAPSED-BETWEEN-BIN TO TRUE
 11387           PERFORM 8500-DATE-CONVERT
 11388                                 THRU 8500-EXIT
 11389           IF NO-CONVERSION-ERROR
 11390              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11391                 MOVE ER-2669       TO WS-ERROR
 11392*                PERFORM 9900-ERROR-FORMAT
 11393*                                THRU 9900-EXIT
 11394              END-IF
 11395           END-IF
 11396        ELSE
 11397           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 11398           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11399              MOVE ER-2669       TO WS-ERROR
 11400*             PERFORM 9900-ERROR-FORMAT
 11401*                                THRU 9900-EXIT
 11402           ELSE
 11403              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11404                 MOVE ER-1570    TO WS-ERROR
 11405                 PERFORM 9900-ERROR-FORMAT
 11406                                 THRU 9900-EXIT
 11407              END-IF
 11408           END-IF
 11409        END-IF
 11410        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 212
* EL050.cbl
 11411           AND ZEROS
 11412           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11413           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11414           SET ELAPSED-BETWEEN-BIN TO TRUE
 11415           PERFORM 8500-DATE-CONVERT
 11416                                 THRU 8500-EXIT
 11417           IF NO-CONVERSION-ERROR
 11418              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11419                 MOVE ER-2669       TO WS-ERROR
 11420*                PERFORM 9900-ERROR-FORMAT
 11421*                                THRU 9900-EXIT
 11422              END-IF
 11423           END-IF
 11424        ELSE
 11425           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11426             (PB-I-LF-TERM / 12)
 11427           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11428              MOVE ER-2669       TO WS-ERROR
 11429*             PERFORM 9900-ERROR-FORMAT
 11430*                                THRU 9900-EXIT
 11431           ELSE
 11432              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11433                 MOVE ER-1571    TO WS-ERROR
 11434                 PERFORM 9900-ERROR-FORMAT
 11435                                 THRU 9900-EXIT
 11436              END-IF
 11437           END-IF
 11438        END-IF
 11439        IF WS-ERROR = ER-2669
 11440           PERFORM 9900-ERROR-FORMAT
 11441                                 THRU 9900-EXIT
 11442        END-IF
 11443     END-IF
 11444     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 11445        (PB-I-AH-TERM NOT = ZERO) AND
 11446         NOT NO-AH-COVERAGE
 11447          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 11448             AND (PB-COMPANY-ID = 'DCC')
 11449             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11450             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 11451          ELSE
 11452             IF WS-LF-EARNINGS-CALC = '4'
 11453                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 11454                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 11455                PB-I-PAY-FREQUENCY
 11456             ELSE
 11457                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 11458                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 11459             END-IF
 11460          END-IF
 11461          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11462                                         DC-ODD-DAYS-OVER
 11463          MOVE 1                      TO DC-END-OF-MONTH
 11464          SET BIN-PLUS-ELAPSED        TO TRUE
 11465*         MOVE 6                      TO DC-OPTION-CODE
 11466          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11467          IF NO-CONVERSION-ERROR
 11468             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 213
* EL050.cbl
 11469     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 11470        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 11471        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 11472        IF PB-I-BIRTHDAY > LOW-VALUES
 11473           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11474           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11475           SET ELAPSED-BETWEEN-BIN TO TRUE
 11476           PERFORM 8500-DATE-CONVERT
 11477                                 THRU 8500-EXIT
 11478           IF NO-CONVERSION-ERROR
 11479              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11480                 MOVE ER-3054       TO WS-ERROR
 11481*                PERFORM 9900-ERROR-FORMAT
 11482*                                THRU 9900-EXIT
 11483              END-IF
 11484           END-IF
 11485        ELSE
 11486           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 11487           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11488              MOVE ER-3054       TO WS-ERROR
 11489*             PERFORM 9900-ERROR-FORMAT
 11490*                                THRU 9900-EXIT
 11491           END-IF
 11492        END-IF
 11493        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11494           AND ZEROS
 11495           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11496           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11497           SET ELAPSED-BETWEEN-BIN TO TRUE
 11498           PERFORM 8500-DATE-CONVERT
 11499                                 THRU 8500-EXIT
 11500           IF NO-CONVERSION-ERROR
 11501              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11502                 MOVE ER-3054       TO WS-ERROR
 11503*                PERFORM 9900-ERROR-FORMAT
 11504*                                THRU 9900-EXIT
 11505              END-IF
 11506           END-IF
 11507        ELSE
 11508           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11509             (PB-I-AH-TERM / 12)
 11510           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11511              MOVE ER-3054       TO WS-ERROR
 11512*             PERFORM 9900-ERROR-FORMAT
 11513*                                THRU 9900-EXIT
 11514           END-IF
 11515        END-IF
 11516        IF WS-ERROR = ER-3054
 11517           PERFORM 9900-ERROR-FORMAT
 11518                                 THRU 9900-EXIT
 11519        END-IF
 11520     END-IF
 11521     MOVE SPACE                       TO DC-END-OF-MONTH.
 11522
 11523     IF PB-COMPANY-ID = 'NCB'
 11524        GO TO 3040-EDIT-EXTENSION-DAYS.
 11525
 11526     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 214
* EL050.cbl
 11527       AND
 11528        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 11529        NEXT SENTENCE
 11530     ELSE
 11531        GO TO 3040-EDIT-EXTENSION-DAYS.
 11532
 11533     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 11534        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 11535        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 11536     ELSE
 11537        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 11538        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 11539
 11540     SET ELAPSED-BETWEEN-BIN TO TRUE.
 11541*    MOVE '1'      TO DC-OPTION-CODE
 11542     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11543     IF (NO-CONVERSION-ERROR)
 11544        AND (DC-ELAPSED-MONTHS > +1)
 11545        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 11546        MOVE ER-2668   TO WS-ERROR
 11547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11548
 11549 3040-EDIT-EXTENSION-DAYS.
 11550
 11551     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 11552        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 11553         GO TO 3050-EDIT-TERM-IN-DAYS
 11554     ELSE
 11555         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 11556
 11557     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 11558         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 11559     ELSE
 11560        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 11561           AND (WS-LF-EARNINGS-CALC NOT = '4')
 11562           MOVE ER-2681         TO WS-ERROR
 11563           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11564
 11565     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 11566        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 11567        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 11568         GO TO 3060-ORIG-TERM-CHECK.
 11569
 11570     GO TO 3060-ORIG-TERM-CHECK.
 11571
 11572 3050-EDIT-TERM-IN-DAYS.
 11573
 11574     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 11575
 11576     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 11577         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 11578     ELSE
 11579         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 11580            MOVE ER-2682         TO WS-ERROR
 11581            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11582
 11583     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 11584                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 215
* EL050.cbl
 11585     IF WS-WORK-TERM GREATER THAN ZERO
 11586         ADD +1 TO PB-I-LF-TERM.
 11587
 11588     IF NOT NO-AH-COVERAGE
 11589         MOVE ER-2684            TO WS-ERROR
 11590         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11591
 11592
 11593 3060-ORIG-TERM-CHECK.
 11594
 11595******************************************************************
 11596*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11597******************************************************************
 11598
 11599     IF WS-LF-SPECIAL-CALC-CD = 'O'
 11600        NEXT SENTENCE
 11601     ELSE
 11602        IF NOT NO-LIFE-COVERAGE
 11603           IF PB-I-LF-TERM NUMERIC
 11604              AND (PB-I-LF-TERM GREATER THAN ZERO)
 11605              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 11606              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 11607                  NEXT SENTENCE
 11608           ELSE
 11609              MOVE ER-2647       TO WS-ERROR
 11610              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11611
 11612     IF NOT NO-AH-COVERAGE
 11613         IF PB-I-AH-TERM NUMERIC
 11614            AND (PB-I-AH-TERM GREATER THAN ZERO)
 11615            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 11616            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 11617             NEXT SENTENCE
 11618          ELSE
 11619              MOVE ER-2658       TO WS-ERROR
 11620              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11621
 11622     IF PB-COMPANY-ID = 'NCB'
 11623        GO TO 3070-LOAN-TERM-CHECK.
 11624
 11625     IF POLICY-HAS-AH
 11626       AND
 11627        POLICY-HAS-LIFE
 11628       AND
 11629        PB-I-LF-TERM NUMERIC
 11630       AND
 11631        PB-I-AH-TERM NUMERIC
 11632        NEXT SENTENCE
 11633     ELSE
 11634        GO TO 3070-LOAN-TERM-CHECK.
 11635
 11636     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 11637     IF WS-TEX-FACT-2 LESS THAN +0
 11638        MULTIPLY +1 BY WS-TEX-FACT-2.
 11639
 11640     IF WS-TEX-FACT-2 GREATER THAN +1
 11641        MOVE ER-2668             TO WS-ERROR
 11642        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 216
* EL050.cbl
 11643
 11644 3070-LOAN-TERM-CHECK.
 11645
 11646     IF (WS-LF-BENEFIT-CD = ZERO)
 11647         OR (NO-LF-BENEFIT-MATCH)
 11648            GO TO 3125-EDIT-PMT-FREQ.
 11649
 11650     IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U' AND 'V' AND
 11651                                     'W' AND 'X'
 11652         GO TO 3125-EDIT-PMT-FREQ.
 11653
 11654     IF PB-I-LOAN-TERM NOT NUMERIC
 11655         MOVE ZEROS              TO PB-I-LOAN-TERM.
 11656
 11657     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 11658        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 11659        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 11660        PB-I-LOAN-TERM NOT GREATER THAN +360
 11661         NEXT SENTENCE
 11662     ELSE
 11663         MOVE ER-2648            TO WS-ERROR
 11664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11665
 11666     IF WS-STATE-ABBREVIATION = 'NC'
 11667        IF PB-I-LOAN-TERM > +59
 11668           CONTINUE
 11669        ELSE
 11670           MOVE ER-2792          TO WS-ERROR
 11671           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11672        END-IF
 11673     END-IF
 11674
 11675     .
 11676 3125-EDIT-PMT-FREQ.
 11677     IF (WS-LF-BENEFIT-CD = ZERO)
 11678         OR (NO-LF-BENEFIT-MATCH)
 11679            GO TO 3127-EDIT-LOAN-OFFICER.
 11680
 11681     IF WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 11682        CONTINUE
 11683     ELSE
 11684        IF (PB-I-LOAN-TERM > ZEROS)
 11685           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 11686           MOVE ER-1575          TO WS-ERROR
 11687           PERFORM 9900-ERROR-FORMAT
 11688                                 THRU 9900-EXIT
 11689        END-IF
 11690     END-IF
 11691     IF WS-LF-EARNINGS-CALC NOT = '4'
 11692         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 11693            MOVE ER-2653         TO WS-ERROR
 11694            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11695            GO TO 3127-EDIT-LOAN-OFFICER
 11696         ELSE
 11697            GO TO 3127-EDIT-LOAN-OFFICER.
 11698
 11699     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 11700         MOVE ER-2655            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 217
* EL050.cbl
 11701         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11702         GO TO 3127-EDIT-LOAN-OFFICER.
 11703
 11704     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 11705         MOVE ER-2654            TO WS-ERROR
 11706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11707         GO TO 3127-EDIT-LOAN-OFFICER.
 11708
 11709     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 11710         GIVING WS-TEX-FACT-2
 11711             REMAINDER WS-TEX-FACT-3.
 11712
 11713*    IF WS-TEX-FACT-3 NOT = ZERO
 11714*       MOVE ER-2654             TO WS-ERROR
 11715*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11716
 11717
 11718 3127-EDIT-LOAN-OFFICER.
 11719
 11720     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 11721        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 11722           MOVE ER-2690          TO WS-ERROR
 11723           PERFORM 9900-ERROR-FORMAT
 11724                                 THRU 9900-EXIT
 11725        ELSE
 11726           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 11727           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 11728           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 11729           MOVE PB-SV-STATE      TO LOFC-STATE
 11730           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 11731           MOVE PB-I-LOAN-OFFICER
 11732                                 TO LOFC-CODE
 11733           PERFORM 8586-READ-LOAN-OFFICER
 11734                                 THRU 8586-EXIT
 11735           IF (NOT LOFC-MASTER-FOUND)
 11736              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 11737              MOVE ER-3006       TO WS-ERROR
 11738              PERFORM 9900-ERROR-FORMAT
 11739                                 THRU 9900-EXIT
 11740           END-IF
 11741        END-IF
 11742     END-IF
 11743     .
 11744 3129-EDIT-APR.
 11745
 11746     IF (WS-LF-BENEFIT-CD = ZERO)
 11747        OR (NO-LF-BENEFIT-MATCH)
 11748        IF PB-COMPANY-ID NOT = 'DCC'
 11749           GO TO 3130-EDIT-AGE
 11750*       ELSE
 11751*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 11752*             GO TO 3130-EDIT-AGE
 11753*          END-IF
 11754        END-IF
 11755     END-IF
 11756
 11757     IF (WS-STATE-ABBREVIATION = 'OH')
 11758         AND (PB-I-RATE-CLASS NOT = 'L ')
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 218
* EL050.cbl
 11759         AND (PB-I-LF-TERM GREATER THAN 60)
 11760         AND (PB-CERT-EFF-DT GREATER WS-831031)
 11761         GO TO 3129-APR-CONT.
 11762
 11763     IF (WS-STATE-ABBREVIATION = 'RI')
 11764         AND (PB-I-LF-TERM GREATER THAN 60)
 11765         AND (PB-CERT-EFF-DT GREATER WS-831231)
 11766         GO TO 3129-APR-CONT.
 11767
 11768     IF (WS-STATE-ABBREVIATION = 'UT')
 11769         AND (PB-I-LF-TERM GREATER THAN 62)
 11770         AND (PB-CERT-EFF-DT GREATER WS-810831)
 11771         AND (PB-CERT-EFF-DT LESS WS-830901)
 11772         GO TO 3129-APR-CONT.
 11773
 11774     IF PB-COMPANY-ID = 'LAP'
 11775        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 11776           IF PB-I-LOAN-APR GREATER THAN ZEROS
 11777              MOVE ER-2656         TO WS-ERROR
 11778              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11779              GO TO 3130-EDIT-AGE.
 11780
 11781     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 11782        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 11783        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 11784        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 11785         GO TO 3130-EDIT-AGE.
 11786
 11787 3129-APR-CONT.
 11788     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 11789         (WS-LF-SPECIAL-CALC-CD = 'M'))
 11790         GO TO 3130-EDIT-AGE.
 11791
 11792     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 11793        AND (PB-COMPANY-ID = 'DCC')
 11794        AND (PB-I-LOAN-APR = ZERO)
 11795        MOVE ER-2657             TO WS-ERROR
 11796        PERFORM 9900-ERROR-FORMAT
 11797                                 THRU 9900-EXIT
 11798        GO TO 3130-EDIT-AGE
 11799     END-IF
 11800     IF PB-I-LOAN-APR = ZERO
 11801        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 11802     END-IF
 11803
 11804     IF PB-I-LOAN-APR = ZERO
 11805        MOVE ER-2656             TO WS-ERROR
 11806        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11807        GO TO 3130-EDIT-AGE.
 11808
 11809*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 11810     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 11811        MOVE ER-2657             TO WS-ERROR
 11812        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11813
 11814 3130-EDIT-AGE.
 11815
 11816******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 219
* EL050.cbl
 11817*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 11818******************************************************************
 11819
 11820     IF NOT NO-LIFE-COVERAGE
 11821        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 11822           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 11823               MOVE ER-2628             TO WS-ERROR
 11824               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11825
 11826     IF NOT NO-AH-COVERAGE
 11827        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 11828           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 11829               MOVE ER-2628         TO WS-ERROR
 11830               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11831
 11832 3133-SEX-CODE.
 11833     IF PB-I-INSURED-SEX = SPACE OR ZERO
 11834         IF WS-DEFAULT-SEX = 'M'
 11835             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 11836          ELSE
 11837             IF WS-DEFAULT-SEX = 'F'
 11838             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 11839
 11840     IF PB-I-INSURED-SEX = '1'
 11841         MOVE 'M' TO PB-I-INSURED-SEX.
 11842
 11843     IF PB-I-INSURED-SEX = '2'
 11844         MOVE 'F' TO PB-I-INSURED-SEX.
 11845
 11846 3134-SIG-SW-EDIT.
 11847     IF PB-I-SIG-SW = SPACE
 11848         MOVE 'N'                TO  PB-I-SIG-SW.
 11849
 11850     IF PB-COMPANY-ID = 'NCL'
 11851         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 11852             NEXT SENTENCE
 11853         ELSE
 11854             MOVE ER-1923        TO  WS-ERROR
 11855             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11856     ELSE
 11857     IF PB-COMPANY-ID = 'CRI'
 11858         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 11859             NEXT SENTENCE
 11860         ELSE
 11861             MOVE ER-2606        TO  WS-ERROR
 11862             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11863     ELSE
 11864     IF PB-COMPANY-ID = 'TMS'
 11865         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 11866             NEXT SENTENCE
 11867         ELSE
 11868             MOVE ER-2689        TO  WS-ERROR
 11869             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11870     ELSE
 11871         IF PB-I-SIG-SW = 'Y' OR 'N'
 11872             NEXT SENTENCE
 11873         ELSE
 11874             MOVE ER-2651        TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 220
* EL050.cbl
 11875             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11876
 11877     IF PB-COMPANY-ID = 'FLA'
 11878         IF (WS-EDIT-AGE GREATER 54  OR
 11879             WS-AH-EDIT-AGE GREATER 54)  AND
 11880            PB-I-SIG-SW = 'N'
 11881            MOVE ER-2651         TO  WS-ERROR
 11882            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11883
 11884 3135-NAME-EDIT.
 11885
 11886     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 11887        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 11888        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 11889           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 11890                                 TO PB-I-JOINT-FIRST-NAME
 11891        END-PERFORM
 11892     END-IF
 11893     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 11894        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 11895        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 11896           MOVE PB-I-JOINT-LAST-NAME (2:14)
 11897                                 TO PB-I-JOINT-LAST-NAME
 11898        END-PERFORM
 11899     END-IF
 11900     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 11901        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 11902        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 11903           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 11904                                 TO PB-I-INSURED-FIRST-NAME
 11905        END-PERFORM
 11906     END-IF
 11907     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 11908        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 11909        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 11910           MOVE PB-I-INSURED-LAST-NAME (2:14)
 11911                                 TO PB-I-INSURED-LAST-NAME
 11912        END-PERFORM
 11913     END-IF
 11914     IF PB-I-INSURED-LAST-NAME = SPACES
 11915       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 11916       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 11917           MOVE ER-2660    TO WS-ERROR
 11918           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11919
 11920 3136-EDIT-SEX.
 11921
 11922******************************************************************
 11923*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 11924******************************************************************
 11925
 11926     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11927        (WS-AH-SPECIAL-CALC-CD = 'O')
 11928        NEXT SENTENCE
 11929     ELSE
 11930        IF PB-I-INSURED-SEX = 'M' OR 'F'
 11931           NEXT SENTENCE
 11932        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 221
* EL050.cbl
 11933           MOVE ER-2629            TO WS-ERROR
 11934           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11935
 11936 3137-EDIT-EFF-DATE.
 11937
 11938     IF PB-REISSUED-CERT       OR
 11939        PB-POLICY-IS-DECLINED  OR
 11940        PB-POLICY-IS-VOIDED
 11941         GO TO 3139-EDIT-COVERAGE-CODES.
 11942
 11943     MOVE SPACE                  TO WS-2671-SW
 11944                                    WS-2672-SW.
 11945
 11946     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 11947         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 11948             MOVE ER-2703        TO WS-ERROR
 11949             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11950             GO TO 3139-EDIT-COVERAGE-CODES.
 11951
 11952     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 11953         GO TO 3139-EDIT-COVERAGE-CODES.
 11954
 11955     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11956     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 11957*    MOVE '1'                    TO DC-OPTION-CODE.
 11958     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11959     MOVE +0                     TO DC-ELAPSED-MONTHS
 11960                                    DC-ELAPSED-DAYS.
 11961     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11962
 11963     IF DATE-CONVERSION-ERROR
 11964         GO TO 3139-EDIT-COVERAGE-CODES.
 11965
 11966     IF DC-ELAPSED-DAYS GREATER +180
 11967         MOVE ER-2672            TO WS-ERROR
 11968         MOVE 'Y'                TO WS-2672-SW
 11969         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11970     END-IF
 11971
 11972     IF WS-ERROR = ER-2671  AND
 11973        PB-COMPANY-ID  = 'LBL'
 11974        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11975        MOVE SPACE               TO WS-2671-SW
 11976        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 11977
 11978     IF PB-ISSUE-DATE-FORCED  AND
 11979      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 11980         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 11981         MOVE ER-2673            TO WS-ERROR
 11982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11983         MOVE SPACE              TO WS-2671-SW
 11984                                    WS-2672-SW.
 11985
 11986     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 11987         IF PB-ISSUE-DATE-FORCED
 11988             MOVE ER-2600          TO  WS-ERROR
 11989             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11990         ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 222
* EL050.cbl
 11991             MOVE ER-2692          TO  WS-ERROR
 11992             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11993
 11994
 11995 3139-EDIT-COVERAGE-CODES.
 11996
 11997     IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 11998        PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 11999        MOVE ER-2787             TO WS-ERROR
 12000        PERFORM 9900-ERROR-FORMAT
 12001                                 THRU 9900-EXIT
 12002     END-IF
 12003     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12004        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12005                                 > 250000.00
 12006           MOVE ER-2719          TO WS-ERROR
 12007           PERFORM 9900-ERROR-FORMAT
 12008                                 THRU 9900-EXIT
 12009        END-IF
 12010     END-IF
 12011
 12012     IF PB-POLICY-IS-DECLINED  OR
 12013        PB-POLICY-IS-VOIDED
 12014         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12015
 12016     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12017        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12018         MOVE ER-2630                TO WS-ERROR
 12019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12020
 12021     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12022        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12023        PB-I-LF-PREMIUM-AMT = ZERO
 12024         GO TO 3140-CHECK-AH-FOR-ZERO.
 12025
 12026     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12027        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12028        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12029         GO TO 3140-CHECK-AH-FOR-ZERO.
 12030
 12031     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12032        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12033        MOVE ER-2631             TO WS-ERROR
 12034        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12035     END-IF
 12036
 12037
 12038******************************************************************
 12039*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12040******************************************************************
 12041
 12042     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12043        NEXT SENTENCE
 12044     ELSE
 12045        IF PB-I-LF-BENEFIT-AMT = ZERO
 12046           MOVE ER-2632             TO WS-ERROR
 12047           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12048
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 223
* EL050.cbl
 12049
 12050******************************************************************
 12051*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12052******************************************************************
 12053
 12054     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12055        CONTINUE
 12056     ELSE
 12057        IF PB-I-LF-PREMIUM-AMT = ZERO
 12058           IF (NOT PB-COMP-LF-PREM)
 12059              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12060              MOVE ER-2633       TO WS-ERROR
 12061              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12062           END-IF
 12063        END-IF
 12064     END-IF
 12065     .
 12066 3140-CHECK-AH-FOR-ZERO.
 12067
 12068     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12069        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12070        PB-I-AH-PREMIUM-AMT = ZERO
 12071         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12072
 12073     IF PB-COMPANY-ID = 'CSL'  AND
 12074        PB-I-AH-BENEFIT-CD = ZERO  AND
 12075        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12076        PB-I-AH-PREMIUM-AMT = ZERO
 12077         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12078
 12079     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12080        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12081        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12082         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12083
 12084     IF PB-I-AH-BENEFIT-CD = ZERO
 12085         MOVE ER-2634            TO WS-ERROR
 12086         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12087
 12088******************************************************************
 12089*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12090******************************************************************
 12091
 12092     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12093        NEXT SENTENCE
 12094     ELSE
 12095        IF PB-I-AH-BENEFIT-AMT = ZERO
 12096           MOVE ER-2635             TO WS-ERROR
 12097           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12098
 12099******************************************************************
 12100*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12101******************************************************************
 12102
 12103     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12104        NEXT SENTENCE
 12105     ELSE
 12106        IF PB-I-AH-PREMIUM-AMT = ZERO
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 224
* EL050.cbl
 12107            IF NOT PB-COMP-AH-PREM
 12108                MOVE ER-2636    TO WS-ERROR
 12109                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12110
 12111
 12112 3140-EDIT-MAX-AMT-SIZES.
 12113* CUSTOM CODE FOR CLIENT    'DMD'
 12114     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12115                                     WS-RES-MUNI-TAX
 12116                                     PB-I-STATE-TAX
 12117                                     PB-I-MUNI-TAX.
 12118
 12119     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12120
 12121     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12122        GO TO 3150-RATE-OUTSTAND-BAL.
 12123
 12124     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12125        GO TO 3150-RATE-OUTSTAND-BAL.
 12126
 12127     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12128        GO TO 3150-RATE-OUTSTAND-BAL.
 12129
 12130     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12131                             OR 'RIC')
 12132        GO TO 3150-RATE-OUTSTAND-BAL.
 12133
 12134     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12135        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12136            GO TO 3150-RATE-OUTSTAND-BAL
 12137        ELSE
 12138           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12139               GO TO 3150-RATE-OUTSTAND-BAL.
 12140
 12141     IF NOT PB-NO-MONTHS-SKIPPED
 12142        GO TO 3150-RATE-OUTSTAND-BAL.
 12143
 12144     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12145        GO TO 3150-RATE-OUTSTAND-BAL.
 12146
 12147     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12148        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12149           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12150             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12151           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12152           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12153              MOVE ER-2693     TO WS-ERROR
 12154              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12155              GO TO 3150-RATE-OUTSTAND-BAL
 12156           ELSE
 12157              GO TO 3150-RATE-OUTSTAND-BAL.
 12158
 12159 3150-RATE-OUTSTAND-BAL.
 12160
 12161* DMD RATING TEST
 12162     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12163         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12164         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 225
* EL050.cbl
 12165         MOVE ER-2687                 TO WS-ERROR
 12166         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12167         MOVE 'B'                     TO PB-I-OB-FLAG
 12168         GO TO 3260-EDIT-CONTINUE.
 12169
 12170     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12171         IF  WS-ERROR    EQUAL    ER-2693
 12172             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12173                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12174                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12175                 MOVE  +0            TO  WS-ERROR.
 12176
 12177     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12178         IF  WS-ERROR    EQUAL    ER-2693
 12179             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12180                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12181                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12182                 MOVE  +0            TO  WS-ERROR.
 12183
 12184     IF PLAN-MASTER-AH-SW = 'Y'
 12185        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12186            IF  WS-ERROR    EQUAL    ER-2693
 12187              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12188                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12189                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12190                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12191                 MOVE  ER-1910           TO  WS-ERROR
 12192                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12193
 12194     IF PLAN-MASTER-AH-SW = 'Y'
 12195        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12196            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12197               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12198               MOVE  ER-1910           TO  WS-ERROR
 12199               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12200
 12201     IF PLAN-MASTER-AH-SW = 'Y'
 12202        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12203            IF  WS-ERROR    EQUAL    ER-2693
 12204                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12205                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12206                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12207                 MOVE  +0       TO  WS-ERROR.
 12208
 12209     IF WS-ERROR = ER-2693
 12210        IF PB-COMPANY-ID = 'JAL' AND
 12211           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12212           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12213           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12214
 12215     IF WS-ERROR = ER-2693
 12216        IF PB-COMPANY-ID = 'NCL'  AND
 12217           PB-I-AH-BENEFIT-CD = 'OA'
 12218           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12219           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12220
 12221     IF WS-ERROR = ER-2693
 12222        IF PB-COMPANY-ID = 'CNL' AND
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 226
* EL050.cbl
 12223           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12224           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12225           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12226
 12227     IF WS-ERROR = ER-2693
 12228        IF PB-COMPANY-ID = 'HER'
 12229           IF WS-LEVEL
 12230              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12231              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12232
 12233     IF ((LF-BENEFIT-FOUND) AND
 12234         (NOT NO-LIFE-COVERAGE)  AND
 12235         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12236       OR   ((AH-BENEFIT-FOUND) AND
 12237             (NOT NO-AH-COVERAGE)    AND
 12238             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12239         NEXT SENTENCE
 12240     ELSE
 12241         GO TO 3215-EDIT-RATES.
 12242
 12243     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12244        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12245           MOVE ER-2674          TO WS-ERROR
 12246           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12247           GO TO 3215-EDIT-RATES.
 12248
 12249     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12250        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12251           MOVE ER-2674          TO WS-ERROR
 12252           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12253           GO TO 3215-EDIT-RATES.
 12254
 12255     MOVE 'B'                    TO PB-I-OB-FLAG.
 12256
 12257     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12258         NEXT SENTENCE
 12259     ELSE
 12260         IF NOT NO-LIFE-COVERAGE
 12261             IF WS-ACCT-LF-OB-RT = ZERO
 12262                MOVE ER-2641    TO WS-ERROR
 12263                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12264
 12265     IF PB-COMPANY-ID = 'CRI'
 12266       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12267         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12268         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12269         IF WS-ERROR = ER-2675
 12270            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12271            MOVE ER-2687              TO WS-ERROR
 12272            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12273         ELSE
 12274            MOVE ER-2687              TO WS-ERROR
 12275            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12276
 12277
 12278     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12279         NEXT SENTENCE
 12280     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 227
* EL050.cbl
 12281         IF NOT NO-AH-COVERAGE
 12282             IF WS-ACCT-AH-OB-RT = ZERO
 12283                MOVE ER-2642    TO WS-ERROR
 12284                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12285
 12286     IF PB-COMPANY-ID = 'CRI'
 12287       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12288         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12289         IF WS-ERROR = ER-2676
 12290            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12291            MOVE ER-2687              TO WS-ERROR
 12292            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12293         ELSE
 12294            MOVE ER-2687              TO WS-ERROR
 12295            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12296
 12297     IF PB-COMPANY-ID NOT = 'GIC'
 12298         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12299            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12300     ELSE
 12301         IF PB-I-LF-PREM-CALC = ZEROS
 12302             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12303                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12304
 12305     IF PB-COMPANY-ID NOT = 'GIC'
 12306         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12307            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12308     ELSE
 12309         IF PB-I-AH-PREM-CALC = ZEROS
 12310             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12311                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12312
 12313     MOVE ZEROS TO PB-I-MORT-CODE.
 12314
 12315     GO TO 3260-EDIT-CONTINUE.
 12316
 12317
 12318 3215-EDIT-RATES.
 12319     IF ACCOUNT-MAST-FOUND
 12320         NEXT SENTENCE
 12321     ELSE
 12322         GO TO 3999-END-EDIT.
 12323
 12324 3220-CHECK-LF-RATES.
 12325
 12326     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12327                                    PB-I-AH-PREM-CALC
 12328                                    PB-I-LF-ALT-PREM-CALC
 12329                                    PB-I-LF-ALT-RATE
 12330                                    PB-I-LF-REI-RATE
 12331                                    PB-I-LF-ALT-REI-RATE
 12332                                    PB-I-AH-REI-RATE
 12333                                    PB-I-TOT-FEES-CALC.
 12334
 12335     IF PB-COMPANY-ID EQUAL 'DMD'
 12336        NEXT SENTENCE
 12337     ELSE
 12338        MOVE ZEROS               TO PB-I-LF-RATE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 228
* EL050.cbl
 12339                                    PB-I-AH-RATE.
 12340
 12341     IF PB-I-TOT-FEES NOT NUMERIC
 12342        MOVE ZEROS               TO PB-I-TOT-FEES
 12343     END-IF
 12344     IF PB-I-LIVES NOT NUMERIC
 12345         MOVE ZERO               TO PB-I-LIVES.
 12346
 12347     IF PB-I-NUM-BILLED NOT NUMERIC
 12348         MOVE ZERO               TO PB-I-NUM-BILLED.
 12349
 12350     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12351        MOVE +0                  TO PB-I-LF-PREM-TAX
 12352     END-IF
 12353
 12354     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12355        MOVE +0                  TO PB-I-AH-PREM-TAX
 12356     END-IF
 12357
 12358     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 12359        PB-I-PAY-FREQUENCY = ZEROS
 12360            MOVE 12 TO CP-PAY-FREQUENCY
 12361     ELSE
 12362            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 12363
 12364     IF PB-I-STATE-TAX NOT NUMERIC
 12365         MOVE ZEROS               TO PB-I-STATE-TAX.
 12366
 12367     IF PB-I-MUNI-TAX NOT NUMERIC
 12368         MOVE ZEROS               TO PB-I-MUNI-TAX.
 12369
 12370     MOVE SPACES                 TO CP-BEN-CATEGORY
 12371     IF PB-COMPANY-ID  = 'CSL'  AND
 12372        PB-I-LF-TERM NOT = ZERO
 12373        COMPUTE WS-PAYMENT-AMT =
 12374             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 12375        COMPUTE WS-CSL-AMT1 =
 12376             PB-I-LF-TERM * AM-MAX-MON-BEN
 12377        COMPUTE WS-CSL-AMT2 =
 12378             WS-PAYMENT-AMT * PB-I-LF-TERM
 12379        IF CP-PAY-FREQUENCY NOT = 12
 12380           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 12381           MOVE '8' TO WS-CSL-CALC-CD
 12382        ELSE
 12383           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 12384              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 12385               AM-MAX-TOT-BEN
 12386               MOVE '6' TO WS-CSL-CALC-CD
 12387           ELSE
 12388              IF (WS-CSL-AMT1  GREATER THAN
 12389                 AM-MAX-TOT-BEN) AND
 12390                 (WS-CSL-AMT2  GREATER THAN
 12391                 AM-MAX-TOT-BEN)
 12392                 MOVE '7' TO WS-CSL-CALC-CD
 12393              ELSE
 12394                 MOVE '5' TO WS-CSL-CALC-CD.
 12395
 12396     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 229
* EL050.cbl
 12397         NEXT SENTENCE
 12398     ELSE
 12399         GO TO 3300-CHECK-AH-RATES.
 12400
 12401*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 12402
 12403     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12404        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 12405              OR
 12406           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 12407           MOVE ER-2618          TO WS-ERROR
 12408           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12409           GO TO 3300-CHECK-AH-RATES.
 12410
 12411     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12412           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 12413                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 12414
 12415     IF WS-LF-SPECIAL-CALC-CD = 'M'
 12416         MOVE ER-2687             TO WS-ERROR
 12417         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12418         MOVE 'Z000'              TO PB-I-MORT-CODE
 12419         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 12420         GO TO 3300-CHECK-AH-RATES.
 12421
 12422     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 12423        IF PB-I-LIVES = ZERO
 12424           MOVE ER-2688          TO WS-ERROR
 12425           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12426
 12427     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 12428
 12429     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 12430     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 12431     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 12432     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 12433     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 12434     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 12435     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12436     MOVE '3'                    TO CP-PROCESS-TYPE.
 12437     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 12438     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 12439
 12440******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 12441     IF PB-COMPANY-ID EQUAL 'CDL'
 12442         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12443            CP-EARN-AS-NET-PAY)
 12444             IF PB-CERT-EFF-DT GREATER  WS-931231
 12445                 MOVE '1'        TO CP-EARNING-METHOD.
 12446*******
 12447
 12448     MOVE PB-SV-STATE            TO CP-STATE.
 12449     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 12450     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 12451     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 12452     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 12453     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 12454                                    CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 230
* EL050.cbl
 12455     IF CP-STATE-STD-ABBRV = 'OR'
 12456         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 12457                                         PB-I-LF-ALT-BENEFIT-AMT.
 12458     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 12459     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 12460     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 12461     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12462     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 12463     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 12464     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 12465     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 12466     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 12467                                    CP-REMAINING-TERM
 12468                                    CP-LOAN-TERM.
 12469
 12470     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 12471         NEXT SENTENCE
 12472     ELSE
 12473         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 12474             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12475                                           PB-I-LF-PREMIUM-AMT.
 12476
 12477     IF PB-COMPANY-ID EQUAL 'CSL'
 12478        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 12479           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12480                                         PB-I-LF-PREMIUM-AMT.
 12481
 12482     IF PB-COMPANY-ID EQUAL 'NCB'
 12483         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12484            CP-EARN-AS-NET-PAY
 12485             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12486                 PB-I-LF-PREMIUM-AMT.
 12487
 12488     IF CP-TRUNCATED-LIFE
 12489        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 12490
 12491     IF PB-COMPANY-ID EQUAL 'CRI'
 12492        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 12493
 12494     IF CP-TERM-IS-DAYS
 12495         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 12496     ELSE
 12497         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12498     IF PB-COMPANY-ID = 'DCC'
 12499        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 12500        IF WS-LF-BEN-CATEGORY = 'D'
 12501           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 12502           MOVE PB-I-LIFE-COMMISSION
 12503                                 TO CP-DCC-ACT-COMM
 12504           MOVE WS-LF-BEN-CATEGORY
 12505                                 TO CP-BEN-CATEGORY
 12506        END-IF
 12507     END-IF
 12508     IF PB-COMPANY-ID = 'CSL'
 12509         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 12510         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 12511         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 12512
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 231
* EL050.cbl
 12513     IF PB-COMPANY-ID = 'CSL'
 12514        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 12515
 12516     IF (CP-SPECIAL-CALC-CD = 'H')
 12517        OR (PB-COMPANY-ID = 'DCC')
 12518         MOVE PB-I-LF-ALT-BENEFIT-AMT
 12519                                    TO CP-ALTERNATE-BENEFIT
 12520         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 12521
 12522     IF (PB-COMPANY-ID = 'CID')
 12523        AND (WS-LF-EARNINGS-CALC = 'B')
 12524        AND (CP-STATE-STD-ABBRV = 'MN')
 12525        MOVE PB-I-LF-ALT-BENEFIT-AMT
 12526                                 TO CP-ALTERNATE-BENEFIT
 12527        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 12528     END-IF
 12529     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 12530     MOVE 'R'                   TO CP-RATE-FILE.
 12531     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 12532
 12533     IF CP-ERROR-RATE-NOT-FOUND
 12534        MOVE ER-2641            TO WS-ERROR
 12535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12536        GO TO 3300-CHECK-AH-RATES.
 12537
 12538     IF PB-COMPANY-ID EQUAL 'CRI'
 12539        IF CP-ERROR-NO-LIMITS-CRI
 12540           IF NOT ACCOUNT-LIFE-CHECKED
 12541              MOVE ER-2607      TO WS-ERROR
 12542              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12543
 12544******************************************************************
 12545*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 12546*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 12547******************************************************************
 12548
 12549* CALC LIFE AGE AT EXPIRATION.
 12550
 12551     COMPUTE WS-AGE-AT-EXPIRE =
 12552          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 12553
 12554*    IF PB-STATE = 'CO' OR 'UT'
 12555*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 12556*        MOVE 'F'            TO PB-FATAL-FLAG
 12557*        MOVE ER-2709        TO WS-ERROR
 12558*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12559*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 12560
 12561*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 12562*        MOVE 'X'            TO PB-FATAL-FLAG
 12563*        MOVE ER-2718        TO WS-ERROR
 12564*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12565*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 12566
 12567* CALC A & H AGE AT EXPIRATION.
 12568
 12569     COMPUTE WS-AGE-AT-EXPIRE =
 12570          ((PB-I-AH-TERM / 12) + PB-I-AGE).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 232
* EL050.cbl
 12571
 12572*    IF PB-STATE = 'CO' OR 'UT'
 12573*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 12574*        MOVE 'F'            TO PB-FATAL-FLAG
 12575*        MOVE ER-2709        TO WS-ERROR
 12576*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12577*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 12578
 12579*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 12580*        MOVE 'X'            TO PB-FATAL-FLAG
 12581*        MOVE ER-2718        TO WS-ERROR
 12582*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12583*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 12584
 12585     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 12586        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 12587
 12588     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 12589        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 12590
 12591     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12592        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 12593
 12594     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 12595         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 12596         MOVE ER-2639        TO WS-ERROR
 12597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12598
 12599
 12600******************************************************************
 12601*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 12602******************************************************************
 12603
 12604 PREMIUM-EDITING-IS-BYPASSED.
 12605     IF (CP-R-MAX-ATT-AGE NUMERIC)
 12606        AND (CP-R-MAX-ATT-AGE > +0)
 12607        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12608        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12609           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12610           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12611           MOVE '1'              TO DC-OPTION-CODE
 12612           PERFORM 8500-DATE-CONVERT
 12613                                 THRU 8500-EXIT
 12614           IF NO-CONVERSION-ERROR
 12615              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 12616                 MOVE ER-2661       TO WS-ERROR
 12617*                PERFORM 9900-ERROR-FORMAT
 12618*                                THRU 9900-EXIT
 12619              END-IF
 12620           END-IF
 12621        ELSE
 12622           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12623           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 12624              MOVE ER-2661       TO WS-ERROR
 12625*             PERFORM 9900-ERROR-FORMAT
 12626*                                THRU 9900-EXIT
 12627           ELSE
 12628              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 233
* EL050.cbl
 12629                 MOVE ER-1570    TO WS-ERROR
 12630                 PERFORM 9900-ERROR-FORMAT
 12631                                 THRU 9900-EXIT
 12632              END-IF
 12633           END-IF
 12634        END-IF
 12635        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12636           MOVE PB-I-JOINT-BIRTHDAY
 12637                                 TO DC-BIN-DATE-1
 12638           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12639           MOVE '1'              TO DC-OPTION-CODE
 12640           PERFORM 8500-DATE-CONVERT
 12641                                 THRU 8500-EXIT
 12642           IF NO-CONVERSION-ERROR
 12643              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 12644                 MOVE ER-2661       TO WS-ERROR
 12645*                PERFORM 9900-ERROR-FORMAT
 12646*                                THRU 9900-EXIT
 12647              END-IF
 12648           ELSE
 12649              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 12650           END-IF
 12651        ELSE
 12652           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12653             (PB-I-LF-TERM / 12)
 12654           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 12655              MOVE ER-2661       TO WS-ERROR
 12656*             PERFORM 9900-ERROR-FORMAT
 12657*                                THRU 9900-EXIT
 12658           ELSE
 12659              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 12660                 MOVE ER-1571    TO WS-ERROR
 12661                 PERFORM 9900-ERROR-FORMAT
 12662                                 THRU 9900-EXIT
 12663              END-IF
 12664           END-IF
 12665        END-IF
 12666        IF WS-ERROR = ER-2661
 12667           PERFORM 9900-ERROR-FORMAT
 12668                                 THRU 9900-EXIT
 12669        END-IF
 12670     END-IF
 12671*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 12672*       MOVE ER-2661             TO WS-ERROR
 12673*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12674
 12675     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 12676        MOVE ER-2662             TO WS-ERROR
 12677        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12678
 12679     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 12680        MOVE ER-2677             TO WS-ERROR
 12681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12682
 12683     IF CP-ERROR-LOAN-TERM
 12684        MOVE ER-2648             TO WS-ERROR
 12685        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12686
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 234
* EL050.cbl
 12687 3221-CHECK-ERROR-RATE-OPEN.
 12688
 12689     IF CP-ERROR-RATE-FILE-NOTOPEN
 12690         GO TO 3990-FILES-NOT-OPEN.
 12691
 12692     IF PB-COMPANY-ID NOT = 'DMD'
 12693        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 12694     END-IF
 12695     .
 12696 3221-CONTINUE.
 12697     MOVE ZEROS                  TO WS-DCC-LF-RATE
 12698                                    WS-DCC-AH-RATE
 12699     IF PB-COMPANY-ID = 'DCC'
 12700        IF WS-LF-BEN-CATEGORY = 'D'
 12701           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 12702              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 12703        END-IF
 12704     END-IF
 12705     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 12706*   X'A4FF' = 12/31/2009
 12707     IF (PB-COMPANY-ID = 'CID')
 12708        AND (WS-LF-EARNINGS-CALC = 'B')
 12709        AND (CP-STATE-STD-ABBRV = 'MN')
 12710        AND (PB-CERT-EFF-DT > X'A4FF')
 12711        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 12712     END-IF
 12713     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 12714
 12715     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 12716     IF (PB-COMPANY-ID = 'DCC')
 12717        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 12718        AND (PB-I-POLICY-IS-MONTHLY)
 12719        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 12720        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 12721     END-IF
 12722     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 12723     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 12724     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 12725     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 12726     IF (PB-COMPANY-ID = 'DCC')
 12727        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 12728        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 12729        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 12730        MOVE ER-2786             TO WS-ERROR
 12731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12732     END-IF
 12733
 12734     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 12735
 12736******************************************************************
 12737*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 12738******************************************************************
 12739     IF WS-LF-SPECIAL-CALC-CD = 'E'
 12740        GO TO 3225-CHECK-ALT-LIFE-RATE.
 12741
 12742     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12743        GO TO 3225-CHECK-ALT-LIFE-RATE
 12744     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 235
* EL050.cbl
 12745       IF PB-I-LF-RATE = ZERO
 12746          MOVE ER-2641          TO WS-ERROR
 12747          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12748
 12749 3225-CHECK-ALT-LIFE-RATE.
 12750
 12751     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 12752        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 12753        (CP-SPECIAL-CALC-CD EQUAL 'H')
 12754         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 12755
 12756     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 12757         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 12758             AND PB-COMPANY-ID NOT = 'DCC')
 12759                   OR
 12760              (PB-I-LF-ALT-PREMIUM-AMT > +0  AND
 12761              WS-LF-SPECIAL-CALC-CD NOT = 'H')
 12762             MOVE ER-2720        TO  WS-ERROR
 12763             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12764             GO TO 3225-RATING-CONT
 12765         ELSE
 12766             GO TO 3225-RATING-CONT.
 12767     IF (PB-COMPANY-ID = 'CID')
 12768        AND (AM-GPCD = 01 OR 06 OR 15)
 12769        MOVE ER-2798             TO WS-ERROR
 12770        PERFORM 9900-ERROR-FORMAT
 12771                                 THRU 9900-EXIT
 12772*       GO TO 3225-RATING-CONT
 12773     END-IF
 12774     IF (PB-COMPANY-ID = 'CID')
 12775        AND (WS-LF-EARNINGS-CALC = 'B')
 12776        AND (CP-STATE-STD-ABBRV = 'MN')
 12777        AND (PB-CERT-EFF-DT > X'A4FF')
 12778        GO TO 3225-RATING-CONT
 12779     END-IF
 12780     IF PB-COMPANY-ID = 'DCC'
 12781        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 12782           AND (PB-I-POLICY-IS-MONTHLY)
 12783           GO TO 3225-RATING-CONT
 12784        END-IF
 12785     END-IF
 12786
 12787     IF PB-COMPANY-ID EQUAL 'WDS' AND
 12788        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 12789        CP-EARN-AS-REG-BALLOON
 12790        NEXT SENTENCE
 12791     ELSE
 12792        MOVE '2'                 TO CP-EARNING-METHOD.
 12793
 12794 3225-SET-ALT-LIFE-RATE-LOOKUP.
 12795
 12796     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 12797
 12798     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 12799        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 12800        (CP-SPECIAL-CALC-CD EQUAL 'H')
 12801         NEXT SENTENCE
 12802     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 236
* EL050.cbl
 12803         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 12804
 12805     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 12806     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 12807     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 12808                                     CP-RATING-BENEFIT-AMT.
 12809     IF CP-STATE-STD-ABBRV = 'OR'
 12810         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 12811                                         PB-I-LF-ALT-BENEFIT-AMT.
 12812     IF PB-COMPANY-ID = 'DCC'
 12813        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 12814     END-IF
 12815     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 12816     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 12817     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 12818                                    CP-REMAINING-TERM
 12819                                    CP-LOAN-TERM.
 12820     IF WS-LF-SPECIAL-CALC-CD = 'L'
 12821        ADD +1                   TO CP-ORIGINAL-TERM
 12822                                    CP-REMAINING-TERM
 12823                                    CP-LOAN-TERM.
 12824
 12825     MOVE 'R'                   TO CP-RATE-FILE.
 12826     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 12827
 12828     IF CP-ERROR-RATE-NOT-FOUND
 12829         MOVE ER-2641            TO WS-ERROR
 12830         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12831         GO TO 3300-CHECK-AH-RATES.
 12832
 12833     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 12834     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 12835
 12836     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 12837         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 12838
 12839     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 12840                               + PB-I-LF-ALT-BENEFIT-AMT.
 12841
 12842     IF ACCOUNT-LIFE-CHECKED  OR
 12843        PB-POLICY-IS-VOIDED   OR
 12844        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 12845        GO TO 3225-CONTINUE.
 12846
 12847     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12848        GO TO 3225-CONTINUE.
 12849
 12850     IF WS-LF-BENEFIT-AMT  GREATER THAN
 12851                             EC-RT-LF-MAX-TOT-BEN
 12852        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 12853        MOVE ER-2639       TO WS-ERROR
 12854        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12855
 12856 3225-CONTINUE.
 12857     IF PB-I-LF-ALT-RATE = ZERO
 12858         MOVE ER-2659            TO WS-ERROR
 12859         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12860
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 237
* EL050.cbl
 12861     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 12862        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 12863        MOVE ER-2698             TO WS-ERROR
 12864        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12865
 12866 3225-RATING-CONT.
 12867
 12868     IF WS-LF-SPECIAL-CALC-CD = 'E'
 12869         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12870         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12871         MOVE ER-2687             TO WS-ERROR
 12872         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12873         GO TO 3290-EDIT-LF-REIN-RATE.
 12874
 12875* DMD RATING TEST
 12876     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12877         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12878         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12879         MOVE ER-2687                 TO WS-ERROR
 12880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12881         GO TO 3290-EDIT-LF-REIN-RATE.
 12882
 12883 3230-CLIENT-MORT-CD-SPECIALS.
 12884
 12885     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 12886     SET BIN-TO-GREG          TO TRUE.
 12887*    MOVE ' '                 TO DC-OPTION-CODE.
 12888     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12889     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 12890
 12891 C-POS-3230-MORT-CD.
 12892     IF PB-COMPANY-ID = 'POS' AND
 12893        PB-SV-CARRIER = '2'
 12894         NEXT SENTENCE
 12895     ELSE
 12896         GO TO C-POS-3240-MORT-CD.
 12897
 12898     IF PB-SV-GROUPING = '030'
 12899        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 12900         MOVE '2350' TO PB-I-MORT-CODE
 12901      ELSE
 12902         MOVE '3300' TO PB-I-MORT-CODE.
 12903
 12904
 12905 C-POS-3240-MORT-CD.
 12906     IF PB-COMPANY-ID = 'POS' AND
 12907        PB-SV-CARRIER = '1'
 12908         NEXT SENTENCE
 12909     ELSE
 12910         GO TO 3230-CONTINUE.
 12911
 12912     IF PB-SV-STATE = '45' OR '47'
 12913        OR PB-CERT-EFF-DT LESS THAN WS-771001
 12914         MOVE '5200' TO PB-I-MORT-CODE
 12915     ELSE
 12916         MOVE '8300' TO PB-I-MORT-CODE.
 12917
 12918 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 238
* EL050.cbl
 12919
 12920     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 12921        GO TO 3240-CONTINUE
 12922     END-IF
 12923
 12924     IF PB-CERT-EFF-DT > WS-971231
 12925        GO TO 3240-CONTINUE
 12926     END-IF
 12927
 12928     IF LF-BENEFIT-FOUND AND
 12929        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 12930         MOVE 'F250'       TO PB-I-MORT-CODE
 12931     ELSE
 12932         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 12933             MOVE '7250'   TO PB-I-MORT-CODE
 12934         ELSE
 12935             MOVE '4251'   TO PB-I-MORT-CODE
 12936         END-IF
 12937     END-IF
 12938
 12939     .
 12940 3240-CONTINUE.
 12941
 12942     IF PB-COMPANY-ID NOT = 'GNL'
 12943         GO TO 3256-CONTINUE.
 12944
 12945     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 12946         MOVE 'A300' TO PB-I-MORT-CODE
 12947     ELSE
 12948         MOVE '8350' TO PB-I-MORT-CODE.
 12949
 12950 3256-CONTINUE.
 12951     IF PB-COMPANY-ID NOT = 'ABL'
 12952         GO TO 3260-EDIT-CONTINUE.
 12953
 12954     IF PB-I-LF-TERM GREATER THAN 59
 12955         MOVE 'F550' TO PB-I-MORT-CODE
 12956     ELSE
 12957         MOVE 'E550' TO PB-I-MORT-CODE.
 12958
 12959 3260-EDIT-CONTINUE.
 12960     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 12961
 12962 3290-EDIT-LF-REIN-RATE.
 12963     IF LF-REIN-NSP-NOT-USED
 12964         GO TO 3290-RATING-CONT.
 12965
 12966     IF PB-COMPANY-ID = 'DCC'
 12967        GO TO 3290-RATING-CONT.
 12968     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 12969     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 12970     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 12971     MOVE '3'                   TO CP-PROCESS-TYPE.
 12972     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 12973
 12974******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 12975     IF PB-COMPANY-ID EQUAL 'CDL'
 12976         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 239
* EL050.cbl
 12977            CP-EARN-AS-NET-PAY)
 12978             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 12979*            MOVE SPACE          TO DC-OPTION-CODE
 12980             SET BIN-TO-GREG     TO TRUE
 12981             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12982***  Y2K PROJ 7744
 12983             IF DC-GREG-DATE-CYMD GREATER 19931231
 12984                 MOVE '1'        TO CP-EARNING-METHOD.
 12985***  Y2K PROJ 7744
 12986*******
 12987
 12988     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 12989     MOVE PB-SV-STATE           TO CP-STATE.
 12990     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 12991     MOVE ZERO                  TO CP-DEVIATION-CODE
 12992                                   CP-RATE-DEV-PCT.
 12993     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 12994     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 12995                                   CP-RATING-BENEFIT-AMT.
 12996
 12997************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 12998     IF PB-COMPANY-ID EQUAL 'NCB'
 12999         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13000            CP-EARN-AS-NET-PAY
 13001             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13002                 PB-I-LF-PREMIUM-AMT.
 13003************
 13004
 13005     IF CP-STATE-STD-ABBRV = 'OR'
 13006         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13007                                         PB-I-LF-ALT-BENEFIT-AMT.
 13008     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13009     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13010     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13011     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13012     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13013     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13014     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13015     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13016                                   CP-REMAINING-TERM
 13017                                   CP-LOAN-TERM.
 13018     IF CP-TRUNCATED-LIFE
 13019        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13020
 13021     IF CP-TERM-IS-DAYS
 13022         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13023     ELSE
 13024         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13025
 13026     IF PB-COMPANY-ID = 'DCC'
 13027        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13028     END-IF
 13029     IF PB-COMPANY-ID NOT = 'TIC'
 13030          MOVE ZERO          TO CP-CLASS-CODE.
 13031
 13032     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13033
 13034     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 240
* EL050.cbl
 13035     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13036
 13037     IF CP-ERROR-RATE-NOT-FOUND
 13038        IF PB-I-OB
 13039           MOVE ER-2625      TO WS-ERROR
 13040           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13041           GO TO 3299-EDIT-CONTINUE
 13042        ELSE
 13043           MOVE ER-2643      TO WS-ERROR
 13044           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13045           GO TO 3299-EDIT-CONTINUE.
 13046
 13047     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13048
 13049     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13050     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13051
 13052     IF PB-I-LF-REI-RATE = ZERO
 13053         MOVE ER-2643        TO WS-ERROR
 13054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13055
 13056 3290-CHECK-ALT-REIN-RATE.
 13057
 13058     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13059        GO TO 3290-RATING-CONT.
 13060
 13061     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13062     MOVE '2'                    TO CP-EARNING-METHOD.
 13063     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13064     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13065     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13066     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13067                                     CP-RATING-BENEFIT-AMT.
 13068     IF CP-STATE-STD-ABBRV = 'OR'
 13069         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13070                                         PB-I-LF-ALT-BENEFIT-AMT.
 13071     IF PB-COMPANY-ID = 'DCC'
 13072        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13073     END-IF
 13074     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13075     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13076     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13077                                    CP-REMAINING-TERM
 13078                                    CP-LOAN-TERM.
 13079     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13080        ADD +1                   TO CP-ORIGINAL-TERM
 13081                                    CP-REMAINING-TERM
 13082                                    CP-LOAN-TERM.
 13083
 13084     MOVE 'R'                   TO CP-RATE-FILE.
 13085     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13086
 13087     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13088
 13089     IF PB-I-LF-ALT-REI-RATE = ZERO
 13090         MOVE ER-2643            TO WS-ERROR
 13091         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13092
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 241
* EL050.cbl
 13093 3290-RATING-CONT.
 13094
 13095     IF PB-I-OB
 13096*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13097        GO TO 3300-CHECK-AH-RATES.
 13098
 13099 3299-EDIT-CONTINUE.
 13100
 13101     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13102         NEXT SENTENCE
 13103     ELSE
 13104         MOVE ER-2620           TO WS-ERROR
 13105         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13106
 13107 3300-CHECK-AH-RATES.
 13108     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13109         NEXT SENTENCE
 13110     ELSE
 13111         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13112
 13113     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13114        ((CF-COMPANY-ID = 'DMD') AND
 13115                (NO-DMD-RATING))
 13116         MOVE ER-2687             TO WS-ERROR
 13117         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13118         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13119         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13120
 13121     IF PB-I-OB
 13122        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13123
 13124     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13125         MOVE ER-2687             TO WS-ERROR
 13126         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13127         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13128         GO TO 3999-END-EDIT.
 13129
 13130*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13131
 13132     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13133        IF PB-I-AH-CRIT-PER    EQUAL +0
 13134           MOVE ER-2618          TO WS-ERROR
 13135           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13136           GO TO 3999-END-EDIT.
 13137
 13138
 13139     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13140     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13141     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13142     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13143     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13144     MOVE PB-SV-STATE            TO CP-STATE.
 13145     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13146     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13147     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13148*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13149     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13150     MOVE '3'                    TO CP-PROCESS-TYPE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 242
* EL050.cbl
 13151     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13152     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13153                                    CP-RATING-BENEFIT-AMT.
 13154     IF PB-COMPANY-ID = 'CID'
 13155               OR
 13156        CP-STATE-STD-ABBRV = 'OR'
 13157         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13158                                         PB-I-AH-TERM.
 13159     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13160        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 13161           AND (PB-I-POLICY-IS-MONTHLY)
 13162           MOVE PB-I-LF-BENEFIT-AMT
 13163                                 TO CP-NET-BENEFIT-AMT
 13164        END-IF
 13165     END-IF
 13166     MOVE SPACES                 TO CP-BEN-CATEGORY
 13167     IF PB-COMPANY-ID = 'DCC'
 13168        IF WS-AH-BEN-CATEGORY = 'G'
 13169           MOVE WS-AH-BEN-CATEGORY
 13170                                 TO CP-BEN-CATEGORY
 13171           MOVE PB-I-UNPAID-CASH-PRICE
 13172                                 TO CP-RATING-BENEFIT-AMT
 13173        ELSE
 13174           IF WS-AH-BEN-CATEGORY = 'L'
 13175              MOVE WS-AH-BEN-CATEGORY
 13176                                 TO CP-BEN-CATEGORY
 13177           ELSE
 13178              IF WS-AH-BEN-CATEGORY = 'D'
 13179                 MOVE WS-AH-BEN-CATEGORY
 13180                                 TO CP-BEN-CATEGORY
 13181                 MOVE WS-AH-PMF-COMM
 13182                                 TO CP-DCC-PMF-COMM
 13183                 MOVE PB-I-AH-COMMISSION
 13184                                 TO CP-DCC-ACT-COMM
 13185              END-IF
 13186           END-IF
 13187        END-IF
 13188     END-IF
 13189     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13190     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13191     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13192     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13193     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13194     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13195     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13196                                    CP-REMAINING-TERM
 13197                                    WS-WORK-TERM.
 13198     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13199
 13200     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13201     SET BIN-TO-GREG             TO TRUE.
 13202*    MOVE ' '                    TO DC-OPTION-CODE.
 13203     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13204     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13205
 13206     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13207     IF NOT VALID-SKIP-CODE
 13208         MOVE ER-2683            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 243
* EL050.cbl
 13209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13210         GO TO 3320-RATE-CONTINUE.
 13211
 13212     IF PB-NO-MONTHS-SKIPPED
 13213         GO TO 3320-RATE-CONTINUE.
 13214
 13215     MOVE SPACE TO NUMBER-OF-MONTHS.
 13216
 13217     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13218         MOVE 'S'                TO SK-MO (6).
 13219     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13220         MOVE 'S'                TO SK-MO (7).
 13221     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13222         MOVE 'S'                TO SK-MO (8).
 13223     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13224         MOVE 'S'                TO SK-MO (9).
 13225     IF PB-I-SKIP-CODE = 'A'
 13226         MOVE 'S'                TO SK-MO (10).
 13227
 13228     MOVE 1                      TO SUB2.
 13229     MOVE PB-I-AH-TERM           TO SUB3.
 13230     MOVE WS-MONTH               TO SUB1.
 13231     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13232     GO TO 3320-RATE-CONTINUE.
 13233
 13234 3310-GET-SKIP-MO.
 13235     IF SUB1 = 13
 13236         MOVE 1                  TO SUB1.
 13237
 13238     IF SK-MO (SUB1) = 'S'
 13239         SUBTRACT 1 FROM WS-WORK-TERM.
 13240
 13241     ADD 1 TO SUB2
 13242              SUB1.
 13243
 13244 3320-RATE-CONTINUE.
 13245
 13246     IF WS-WORK-TERM = ZERO
 13247         MOVE 1                  TO WS-WORK-TERM.
 13248
 13249     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13250                                    CP-LOAN-TERM.
 13251
 13252     IF PB-COMPANY-ID EQUAL 'DMD'
 13253         NEXT SENTENCE
 13254     ELSE
 13255         MOVE ZERO               TO PB-I-AH-RATE
 13256                                    PB-I-AH-REI-RATE.
 13257
 13258
 13259     IF PB-COMPANY-ID EQUAL 'CRI'
 13260        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13261
 13262     IF PB-COMPANY-ID = 'CSL'
 13263         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13264         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13265         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13266         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 244
* EL050.cbl
 13267
 13268     IF PB-COMPANY-ID = 'DCC'
 13269        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13270           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13271              PB-I-RATE-DEV-PCT-LF
 13272        END-IF
 13273        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13274                                 TO CP-ALTERNATE-BENEFIT
 13275        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13276     END-IF
 13277     IF (PB-COMPANY-ID = 'CID')
 13278        AND (WS-LF-EARNINGS-CALC = 'B')
 13279        AND (CP-STATE-STD-ABBRV = 'MN')
 13280        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13281     ELSE
 13282        MOVE ' '                 TO CP-AH-BALLOON-SW
 13283     END-IF
 13284     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13285     MOVE 'R'                   TO CP-RATE-FILE.
 13286     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13287
 13288     IF CP-ERROR-RATE-NOT-FOUND
 13289        IF PB-I-OB
 13290           MOVE ER-2624          TO WS-ERROR
 13291           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13292           GO TO 3340-CALCULATE-PREMIUM-AMT
 13293        ELSE
 13294           MOVE ER-2642          TO WS-ERROR
 13295           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13296           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13297
 13298     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13299        CP-ERROR-DIV-BY-ZERO
 13300           MOVE ER-3782          TO WS-ERROR
 13301           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13302
 13303     IF PB-COMPANY-ID EQUAL 'CRI'
 13304        IF CP-ERROR-NO-LIMITS-CRI
 13305           IF NOT ACCOUNT-AH-CHECKED
 13306              MOVE ER-2607          TO WS-ERROR
 13307              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13308
 13309     IF ACCOUNT-AH-CHECKED
 13310        NEXT SENTENCE
 13311     ELSE
 13312       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13313          MOVE ER-2640           TO WS-ERROR
 13314          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13315
 13316     IF PB-COMPANY-ID = 'CRI'
 13317         IF WS-ERROR = ER-2640
 13318             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13319     IF ACCOUNT-AH-CHECKED
 13320        CONTINUE
 13321     ELSE
 13322        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13323           AND (CP-R-MAX-ATT-AGE > +0)
 13324           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 245
* EL050.cbl
 13325           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13326              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13327              MOVE PB-I-AH-EXPIRE-DT
 13328                                 TO DC-BIN-DATE-2
 13329              MOVE '1'           TO DC-OPTION-CODE
 13330              PERFORM 8500-DATE-CONVERT
 13331                                 THRU 8500-EXIT
 13332              IF NO-CONVERSION-ERROR
 13333                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13334                    MOVE ER-2661       TO WS-ERROR
 13335*                   PERFORM 9900-ERROR-FORMAT
 13336*                                THRU 9900-EXIT
 13337                 END-IF
 13338              END-IF
 13339           ELSE
 13340              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 13341              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13342                 MOVE ER-2661    TO WS-ERROR
 13343*                PERFORM 9900-ERROR-FORMAT
 13344*                                THRU 9900-EXIT
 13345              ELSE
 13346                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13347                    MOVE ER-1570 TO WS-ERROR
 13348                    PERFORM 9900-ERROR-FORMAT
 13349                                 THRU 9900-EXIT
 13350                 END-IF
 13351              END-IF
 13352           END-IF
 13353           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13354              MOVE PB-I-JOINT-BIRTHDAY
 13355                                    TO DC-BIN-DATE-1
 13356              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13357              MOVE '1'              TO DC-OPTION-CODE
 13358              PERFORM 8500-DATE-CONVERT
 13359                                    THRU 8500-EXIT
 13360              IF NO-CONVERSION-ERROR
 13361                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13362                    MOVE ER-2661       TO WS-ERROR
 13363*                   PERFORM 9900-ERROR-FORMAT
 13364*                                   THRU 9900-EXIT
 13365                 END-IF
 13366              END-IF
 13367           ELSE
 13368              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13369                (PB-I-AH-TERM / 12)
 13370              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13371                 MOVE ER-2661       TO WS-ERROR
 13372*                PERFORM 9900-ERROR-FORMAT
 13373*                                   THRU 9900-EXIT
 13374              ELSE
 13375                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13376                    MOVE ER-1571 TO WS-ERROR
 13377                    PERFORM 9900-ERROR-FORMAT
 13378                                 THRU 9900-EXIT
 13379                 END-IF
 13380              END-IF
 13381           END-IF
 13382           IF WS-ERROR = ER-2661
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 246
* EL050.cbl
 13383              PERFORM 9900-ERROR-FORMAT
 13384                                    THRU 9900-EXIT
 13385           END-IF
 13386        END-IF
 13387     END-IF
 13388*    IF ACCOUNT-AH-CHECKED
 13389*       NEXT SENTENCE
 13390*    ELSE
 13391*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13392*          MOVE ER-2661          TO WS-ERROR
 13393*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13394
 13395     IF ACCOUNT-AH-CHECKED
 13396        NEXT SENTENCE
 13397     ELSE
 13398        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13399           MOVE ER-2663          TO WS-ERROR
 13400           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13401
 13402     IF ACCOUNT-AH-CHECKED OR
 13403        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 13404         PB-POLICY-IS-VOIDED
 13405        NEXT SENTENCE
 13406     ELSE
 13407        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 13408           MOVE ER-2667            TO WS-ERROR
 13409           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13410
 13411     IF PB-COMPANY-ID = 'CRI'
 13412         IF WS-ERROR = ER-2667
 13413             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13414
 13415     IF ACCOUNT-AH-CHECKED
 13416        NEXT SENTENCE
 13417     ELSE
 13418        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13419           MOVE ER-2678            TO WS-ERROR
 13420           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13421
 13422     IF CP-ERROR-RATE-FILE-NOTOPEN
 13423         GO TO 3990-FILES-NOT-OPEN.
 13424
 13425 3321-CONTINUE.
 13426     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 13427     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 13428     IF (PB-COMPANY-ID = 'DCC')
 13429        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 13430        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 13431                                    PB-I-LF-ALT-PREM-CALC
 13432        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13433        IF WS-AH-BEN-CATEGORY = 'G'
 13434           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13435           + PB-I-ADDL-CLP)
 13436           * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 13437        ELSE
 13438           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13439           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 13440        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 247
* EL050.cbl
 13441        MOVE WS-TOL-LF-HIGH-PREM-AMT
 13442                                 TO PB-I-AH-PREM-CALC
 13443        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 13444           MOVE ER-8148          TO WS-ERROR
 13445           PERFORM 9900-ERROR-FORMAT
 13446                                 THRU 9900-EXIT
 13447        ELSE
 13448           IF PB-I-AH-PREMIUM-AMT < PB-I-CLP-AMOUNT
 13449              MOVE ER-8148       TO WS-ERROR
 13450              PERFORM 9900-ERROR-FORMAT
 13451                                 THRU 9900-EXIT
 13452           END-IF
 13453        END-IF
 13454     END-IF
 13455     IF (PB-COMPANY-ID = 'DCC')
 13456        AND (PB-I-POLICY-IS-MONTHLY)
 13457        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 13458        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 13459        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 13460           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 13461        END-IF
 13462     END-IF
 13463     IF (PB-COMPANY-ID = 'DCC')
 13464        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 13465        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13466        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 13467        MOVE ER-2786             TO WS-ERROR
 13468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13469     END-IF
 13470     IF PB-COMPANY-ID = 'DCC'
 13471        IF WS-AH-BEN-CATEGORY = 'D'
 13472           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 13473              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13474        END-IF
 13475     END-IF
 13476     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 13477
 13478     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 13479         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 13480
 13481     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 13482         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 13483
 13484     IF PB-COMPANY-ID = 'CRI'
 13485         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 13486            PB-I-PAYMENT-AMOUNT = ZERO
 13487             NEXT SENTENCE
 13488         ELSE
 13489             COMPUTE PB-I-AH-PREM-CALC =
 13490                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 13491                 (CP-PREMIUM-RATE / 100)
 13492             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 13493                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 13494                                             PB-I-RATE-DEV-PCT-AH.
 13495
 13496     IF PB-I-AH-RATE  = ZERO
 13497         MOVE ER-2642            TO WS-ERROR
 13498         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 248
* EL050.cbl
 13499
 13500     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 13501     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 13502     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 13503     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 13504     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 13505     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 13506
 13507 3335-EDIT-AH-REIN-NSP-RATE.
 13508     IF AH-REIN-NSP-NOT-USED
 13509         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13510
 13511     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 13512     IF PB-COMPANY-ID = 'DCC'
 13513         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13514     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13515     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13516     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13517     MOVE PB-SV-STATE            TO CP-STATE.
 13518     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13519     MOVE ZERO                   TO CP-DEVIATION-CODE
 13520                                    CP-RATE-DEV-PCT.
 13521*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13522     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13523     MOVE '3'                    TO CP-PROCESS-TYPE.
 13524     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13525     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13526                                    CP-RATING-BENEFIT-AMT.
 13527     IF CP-STATE-STD-ABBRV = 'OR'
 13528         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13529                                         PB-I-AH-TERM.
 13530     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13531     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13532     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13533     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13534     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13535     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13536                                    CP-REMAINING-TERM
 13537                                    WS-WORK-TERM.
 13538     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 13539     IF PB-COMPANY-ID = 'DCC'
 13540        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13541     END-IF
 13542     IF  PB-COMPANY-ID = 'TIC'
 13543         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 13544            MOVE ZERO TO CP-CLASS-CODE.
 13545
 13546     IF PB-COMPANY-ID NOT = 'TIC'
 13547          MOVE ZERO          TO CP-CLASS-CODE.
 13548
 13549     MOVE ZERO               TO CP-DEVIATION-CODE.
 13550
 13551     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 13552
 13553     MOVE ZERO               TO PB-I-AH-REI-RATE.
 13554
 13555     MOVE 'R'                   TO CP-RATE-FILE.
 13556     PERFORM 7000-GET-RATE THRU 7000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 249
* EL050.cbl
 13557
 13558     IF CP-ERROR-RATE-NOT-FOUND
 13559         MOVE ER-2645        TO WS-ERROR
 13560         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13561         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13562
 13563     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 13564
 13565     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 13566     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 13567
 13568     IF PB-I-AH-REI-RATE = ZERO
 13569         MOVE ER-2645        TO WS-ERROR
 13570         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13571
 13572
 13573 3340-CALCULATE-PREMIUM-AMT.
 13574
 13575     IF PB-COMPANY-ID = 'NCL'
 13576         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 13577             WS-AH-SPECIAL-CALC-CD = 'O')
 13578             GO TO 3999-END-EDIT.
 13579
 13580     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 13581                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 13582                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 13583         NEXT SENTENCE
 13584     ELSE
 13585         IF WS-STATE-ABBREVIATION = 'CT'
 13586             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 13587                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 13588                 COMPUTE PB-I-LF-PREM-CALC =
 13589                                     PB-I-LF-PREM-CALC * .90
 13590                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 13591                                     PB-I-LF-ALT-PREM-CALC * .90
 13592                 COMPUTE PB-I-AH-PREM-CALC =
 13593                                     PB-I-AH-PREM-CALC * .90.
 13594
 13595     IF PB-COMP-LF-PREM
 13596        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 13597        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 13598
 13599     IF PB-COMP-AH-PREM
 13600        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 13601
 13602 3340-CHECK-DCC-TOT-FEES.
 13603     IF (PB-COMPANY-ID = 'DCC')
 13604        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13605        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 13606        AND (PB-I-POLICY-IS-MONTHLY)
 13607        CONTINUE
 13608     ELSE
 13609        GO TO 3340-EDIT-LF-AH-TOL
 13610     END-IF
 13611     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 13612     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 13613     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13614        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 250
* EL050.cbl
 13615           PB-I-RATE-DEV-PCT-LF
 13616     END-IF
 13617     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 13618        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 13619           PB-I-RATE-DEV-PCT-AH
 13620     END-IF
 13621     MOVE 'N'                    TO CP-BEN-CATEGORY
 13622     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13623
 13624     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13625     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13626     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13627     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13628     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13629     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13630     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13631     MOVE '3'                    TO CP-PROCESS-TYPE.
 13632     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13633     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13634
 13635     MOVE PB-SV-STATE            TO CP-STATE.
 13636     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13637     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13638     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13639     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13640     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13641                                    CP-RATING-BENEFIT-AMT.
 13642     IF CP-STATE-STD-ABBRV = 'OR'
 13643         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13644                                         PB-I-LF-ALT-BENEFIT-AMT.
 13645     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13646     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13647     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13648     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13649     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13650     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13651     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13652     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13653     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13654                                    CP-REMAINING-TERM
 13655                                    CP-LOAN-TERM.
 13656
 13657     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13658         NEXT SENTENCE
 13659     ELSE
 13660         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13661             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13662                                           PB-I-LF-PREMIUM-AMT.
 13663
 13664     IF CP-TRUNCATED-LIFE
 13665        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13666
 13667     IF CP-TERM-IS-DAYS
 13668         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13669     ELSE
 13670         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13671
 13672     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 251
* EL050.cbl
 13673        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13674     END-IF
 13675     IF CP-SPECIAL-CALC-CD = 'H'
 13676         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13677                                    TO CP-ALTERNATE-BENEFIT
 13678         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13679     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 13680     MOVE 'R'                    TO CP-RATE-FILE
 13681     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 13682     IF NOT CP-ERROR-RATE-NOT-FOUND
 13683        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 13684        IF (CP-DCC-LF-RATE NOT = ZEROS)
 13685           AND (CP-BENEFIT-CD (1:1) = 'S')
 13686           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 13687                                    PB-I-LF-PREMIUM-AMT
 13688        END-IF
 13689     ELSE
 13690        MOVE +0                  TO PB-I-TOT-FEES-CALC
 13691     END-IF
 13692     .
 13693 3340-EDIT-LF-AH-TOL.
 13694
 13695***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 13696***    UNSIGN-WRK2    =    AH   DIFFERENCE
 13697***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 13698***
 13699     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 13700         PB-I-AH-PREMIUM-AMT
 13701          GIVING WS-CALC-WORK.
 13702
 13703     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 13704        AND WS-CALC-WORK NOT = ZERO
 13705         MOVE ER-2649            TO WS-ERROR
 13706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13707
 13708     SUBTRACT PB-I-LF-PREM-CALC
 13709             FROM PB-I-LF-PREMIUM-AMT
 13710                 GIVING WS-UNSIGN-WRK1.
 13711
 13712     SUBTRACT PB-I-LF-ALT-PREM-CALC
 13713             FROM PB-I-LF-ALT-PREMIUM-AMT
 13714                 GIVING WS-UNSIGN-WRK4.
 13715
 13716     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 13717                                + WS-UNSIGN-WRK4.
 13718
 13719     SUBTRACT PB-I-AH-PREM-CALC
 13720             FROM PB-I-AH-PREMIUM-AMT
 13721                 GIVING WS-UNSIGN-WRK2.
 13722
 13723******************************************************************
 13724*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 13725******************************************************************
 13726
 13727     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 13728         MOVE ZERO TO WS-UNSIGN-WRK1.
 13729
 13730     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 252
* EL050.cbl
 13731         MOVE ZERO TO WS-UNSIGN-WRK2.
 13732
 13733     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 13734             GIVING WS-UNSIGN-WRK3.
 13735
 13736 3342-CONTINUE.
 13737
 13738     IF (PB-I-LF-RATE = ZERO  AND
 13739         PB-I-AH-RATE = ZERO)
 13740         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 13741            WS-AH-SPECIAL-CALC-CD = 'O'
 13742              NEXT SENTENCE
 13743         ELSE
 13744             GO TO 3345-EDIT-CONTINUE.
 13745
 13746     IF  PB-RECORD-BILL   =  'B' OR  'L'
 13747         NEXT SENTENCE
 13748     ELSE
 13749     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 13750        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 13751           IF (PB-REISSUED-CERT         OR
 13752               PB-POLICY-IS-DECLINED    OR
 13753               PB-POLICY-IS-VOIDED)
 13754              NEXT SENTENCE
 13755           ELSE
 13756              IF WS-PREM-REJECT-SW = SPACE
 13757                 MOVE ER-2652    TO WS-ERROR
 13758                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13759                 GO TO 3344-CHECK-AH
 13760              ELSE
 13761                 MOVE ER-2650    TO WS-ERROR
 13762                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13763                 GO TO 3344-CHECK-AH.
 13764
 13765***
 13766***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 13767***
 13768
 13769     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 13770         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 13771            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 13772             (1 + WS-TOL-LF-PREM-PCT)
 13773         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 13774            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 13775             (1 - WS-TOL-LF-PREM-PCT)
 13776     ELSE
 13777         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 13778         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 13779
 13780***
 13781***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 13782***
 13783
 13784     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 13785         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 13786          WS-TOL-LF-PREM.
 13787
 13788     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 253
* EL050.cbl
 13789         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 13790          WS-TOL-LF-PREM.
 13791
 13792     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 13793        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 13794
 13795     IF (PB-REISSUED-CERT        OR
 13796         PB-POLICY-IS-DECLINED   OR
 13797         PB-POLICY-IS-VOIDED)
 13798        NEXT SENTENCE
 13799     ELSE
 13800     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 13801           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 13802       OR
 13803        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 13804           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 13805       AND
 13806        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 13807           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 13808         OR
 13809          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 13810           LESS WS-TOL-LF-LOW-PREM-PCT))
 13811              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 13812                  MOVE ER-2652   TO  WS-ERROR
 13813                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13814              ELSE
 13815                  MOVE ER-2650   TO  WS-ERROR
 13816                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13817
 13818*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 13819*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 13820*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13821*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 13822
 13823     IF WS-ERROR  =  ER-2650  OR  ER-2652
 13824        IF (PB-RECORD-BILL   =  'B' OR  'L')
 13825                      OR
 13826           ((PB-COMPANY-ID = 'DCC')
 13827           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 13828           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13829           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 13830        END-IF
 13831     END-IF
 13832
 13833     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 13834        IF WS-COMP-MAX-CAP GREATER THAN +0
 13835           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 13836              IF (PB-REISSUED-CERT         OR
 13837                  PB-POLICY-IS-DECLINED    OR
 13838                  PB-POLICY-IS-VOIDED)
 13839                 NEXT SENTENCE
 13840              ELSE
 13841                  MOVE ER-2646   TO  WS-ERROR
 13842                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13843
 13844 3344-CVL-TOLERANCE-CHECK.
 13845
 13846      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 254
* EL050.cbl
 13847          GO TO 3344-CHECK-AH.
 13848
 13849      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 13850          GO TO 3344-CHECK-AH.
 13851
 13852      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 13853                                     WS-UNSIGN-WRK6.
 13854
 13855      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 13856          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 13857                                 + PB-I-LF-PREMIUM-AMT
 13858                                 - PB-I-LF-PREM-CALC.
 13859
 13860      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 13861          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 13862                                 + PB-I-LF-ALT-PREMIUM-AMT
 13863                                 - PB-I-LF-ALT-PREM-CALC.
 13864
 13865      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 13866          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 13867              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 13868                 MOVE ER-2652    TO  WS-ERROR
 13869                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13870              ELSE
 13871                 MOVE ER-2650    TO  WS-ERROR
 13872                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13873
 13874      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 13875          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 13876              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 13877                 MOVE ER-2652    TO  WS-ERROR
 13878                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13879              ELSE
 13880                 MOVE ER-2650    TO  WS-ERROR
 13881                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13882
 13883 3344-CHECK-AH.
 13884
 13885****************************************************************
 13886***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 13887***
 13888
 13889     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 13890         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 13891             (1 + WS-TOL-AH-PREM-PCT)
 13892         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 13893             (1 - WS-TOL-AH-PREM-PCT)
 13894     ELSE
 13895         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 13896         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 13897
 13898***
 13899***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 13900***
 13901
 13902     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 13903         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 13904
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 255
* EL050.cbl
 13905     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 13906         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 13907
 13908     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 13909        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 13910
 13911     IF (PB-REISSUED-CERT         OR
 13912         PB-POLICY-IS-DECLINED    OR
 13913         PB-POLICY-IS-VOIDED)
 13914        NEXT SENTENCE
 13915     ELSE
 13916     IF ((PB-I-AH-PREMIUM-AMT GREATER THAN
 13917                             WS-TOL-AH-HIGH-PREM-AMT)
 13918       OR
 13919        (PB-I-AH-PREMIUM-AMT LESS THAN WS-TOL-AH-LOW-PREM-AMT))
 13920       AND
 13921        ((PB-I-AH-PREMIUM-AMT GREATER WS-TOL-AH-HIGH-PREM-PCT)
 13922         OR
 13923          (PB-I-AH-PREMIUM-AMT LESS WS-TOL-AH-LOW-PREM-PCT))
 13924              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 13925                 MOVE ER-3052   TO  WS-ERROR
 13926                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13927              ELSE
 13928                 MOVE ER-3050    TO  WS-ERROR
 13929                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13930
 13931     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 13932         IF  PB-RECORD-BILL   =  'B' OR 'A'
 13933             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13934             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 13935
 13936     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 13937        IF WS-COMP-MAX-CAP GREATER THAN +0
 13938           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 13939              IF (PB-REISSUED-CERT         OR
 13940                  PB-POLICY-IS-DECLINED    OR
 13941                  PB-POLICY-IS-VOIDED)
 13942                 NEXT SENTENCE
 13943              ELSE
 13944                  MOVE ER-2646   TO  WS-ERROR
 13945                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13946
 13947     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 13948        (WS-COMP-MAX-CAP EQUAL +0)
 13949           GO TO 3345-EDIT-CONTINUE.
 13950
 13951     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 13952        GREATER THAN WS-COMP-MAX-CAP
 13953           MOVE ER-2646          TO  WS-ERROR
 13954           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13955
 13956 3345-EDIT-CONTINUE.
 13957
 13958*    IF PB-COMPANY-ID    EQUAL    'NCL'
 13959*       IF PB-ENTRY-BATCH   NUMERIC
 13960*          IF PB-ISSUE
 13961*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 13962*          ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 256
* EL050.cbl
 13963*              IF PB-CANCELLATION
 13964*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 13965
 13966*    IF  PB-COMPANY-ID    EQUAL    'HER'
 13967*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 13968*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 13969*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 13970*        ELSE
 13971*            MOVE  ER-1909            TO  WS-ERROR
 13972*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13973
 13974     IF PB-I-POLICY-ACCEPTED
 13975        IF PB-POLICY-IS-DECLINED  OR
 13976           PB-REISSUED-CERT  OR
 13977           PB-REIN-ONLY-CERT  OR
 13978           PB-POLICY-IS-VOIDED
 13979            MOVE  ER-1891         TO  WS-ERROR
 13980            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 13981        ELSE
 13982            MOVE SPACE            TO  PB-BATCH-ENTRY
 13983            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 13984
 13985     IF PB-I-POLICY-DECLINED
 13986        IF PB-REISSUED-CERT  OR
 13987           PB-REIN-ONLY-CERT  OR
 13988           PB-POLICY-IS-VOIDED
 13989            MOVE  ER-1906         TO  WS-ERROR
 13990            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 13991        ELSE
 13992            MOVE  'D'             TO  PB-BATCH-ENTRY
 13993                                      PB-I-ENTRY-STATUS.
 13994
 13995     IF PB-I-NEEDS-UNDERWRITING
 13996        IF PB-POLICY-IS-DECLINED OR
 13997           PB-REISSUED-CERT  OR
 13998           PB-REIN-ONLY-CERT  OR
 13999           PB-POLICY-IS-VOIDED
 14000            MOVE  ER-1907         TO  WS-ERROR
 14001            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14002        ELSE
 14003            MOVE 'U'              TO  PB-BATCH-ENTRY
 14004                                      PB-I-ENTRY-STATUS.
 14005
 14006     IF PB-NEEDS-UNDERWRITING
 14007        MOVE  ER-1901             TO  WS-ERROR
 14008        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14009     IF PB-COMPANY-ID = 'DCC'
 14010        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14011        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14012        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S')
 14013           AND (NOT WS-LF-CASH))
 14014                           OR
 14015           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S')
 14016           AND (NOT WS-AH-CASH)))
 14017                       AND
 14018           (PB-I-ENTRY-STATUS NOT = '5')
 14019           MOVE 'M'              TO PB-BATCH-ENTRY
 14020                                    PB-I-ENTRY-STATUS
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 257
* EL050.cbl
 14021        END-IF
 14022     END-IF
 14023     IF  PB-COMPANY-ID NOT = 'NCL'
 14024         GO TO 3999-END-EDIT.
 14025
 14026     IF PB-REISSUED-CERT  OR
 14027        PB-POLICY-IS-DECLINED  OR
 14028        PB-POLICY-IS-VOIDED  OR
 14029        PB-I-OB
 14030         GO TO 3999-END-EDIT.
 14031
 14032     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14033         MOVE  ER-2644            TO  WS-ERROR
 14034         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14035         GO TO 3999-END-EDIT.
 14036
 14037     MOVE 'N'                     TO  FORM-MASTER-SW.
 14038     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14039
 14040     IF NOT FORM-MASTER-FOUND
 14041         GO TO 3999-END-EDIT.
 14042
 14043     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14044                                      FORM-MASTER-AH-SW.
 14045
 14046     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14047         MOVE  +1                 TO SUB6
 14048         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14049
 14050     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14051         MOVE  +1                 TO SUB6
 14052         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14053
 14054     IF LF-FORM-MASTER-FOUND  OR
 14055        AH-FORM-MASTER-FOUND
 14056         GO TO 3360-CHECK-FORM-LIMITS
 14057     ELSE
 14058         GO TO 3999-END-EDIT.
 14059
 14060******************************************************************
 14061*                  3350-GET-ERFORM                               *
 14062*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14063*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14064******************************************************************
 14065
 14066 3350-GET-ERFORM.
 14067
 14068     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14069         GO TO  3350-ERFORM-GETMAIN.
 14070
 14071     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14072     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14073     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14074     MOVE 'Y'                     TO FORM-MASTER-SW.
 14075
 14076     IF PB-CANCELLATION
 14077         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14078            PB-SV-STATE          EQUAL   FO-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 258
* EL050.cbl
 14079            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14080              GO TO 3350-EXIT
 14081         ELSE
 14082             NEXT SENTENCE
 14083     ELSE
 14084         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14085            PB-SV-STATE          EQUAL   FO-STATE       AND
 14086            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14087              GO TO 3350-EXIT.
 14088
 14089 3350-ERFORM-GETMAIN.
 14090
 14091     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14092     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14093
 14094 3350-ERFORM-READ.
 14095
 14096     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14097     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14098     IF PB-CANCELLATION
 14099         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14100     ELSE
 14101         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14102     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14103
 14104     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14105
 14106     IF FORM-MASTER-FOUND
 14107       IF PB-CANCELLATION
 14108          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14109             PB-SV-STATE          EQUAL   FO-STATE       AND
 14110             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14111              GO  TO 3350-EXIT
 14112          ELSE
 14113              NEXT SENTENCE
 14114       ELSE
 14115          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14116             PB-SV-STATE          EQUAL   FO-STATE       AND
 14117             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14118              GO  TO 3350-EXIT.
 14119
 14120     MOVE  'N'                    TO  FORM-MASTER-SW.
 14121     MOVE  ER-1895                TO  WS-ERROR.
 14122     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14123
 14124 3350-EXIT.
 14125      EXIT.
 14126
 14127******************************************************************
 14128*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14129*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14130*   VALID FOR THE POLICY FORM USED.                              *
 14131******************************************************************
 14132
 14133 3355-EDIT-FORM-LF-BENEFITS.
 14134
 14135     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14136        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 259
* EL050.cbl
 14137         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14138         GO TO   3355-EXIT.
 14139
 14140     IF  SUB6    LESS THAN   +40
 14141         ADD  +1      TO  SUB6
 14142         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14143
 14144     MOVE  ER-1896         TO  WS-ERROR.
 14145     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14146
 14147 3355-EXIT.
 14148      EXIT.
 14149
 14150******************************************************************
 14151*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14152*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14153*   VALID FOR THE POLICY FORM USED.                              *
 14154******************************************************************
 14155
 14156 3356-EDIT-FORM-AH-BENEFITS.
 14157
 14158     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14159        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14160         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14161         GO TO  3356-EXIT.
 14162
 14163      IF  SUB6    LESS THAN     +40
 14164          ADD  +1      TO  SUB6
 14165          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14166
 14167     MOVE  ER-1897         TO  WS-ERROR.
 14168     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14169
 14170 3356-EXIT.
 14171      EXIT.
 14172
 14173******************************************************************
 14174*                  3357-BENEFIT-SEARCH                           *
 14175*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14176*   CANCELLATIONS ONLY.                                          *
 14177******************************************************************
 14178 3357-BENEFIT-SEARCH.
 14179     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14180         MOVE +1                          TO SUB6
 14181         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14182
 14183     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14184         MOVE +1                          TO SUB6
 14185         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14186
 14187 3357-EXIT.
 14188     EXIT.
 14189
 14190******************************************************************
 14191*                  3358-BENEFIT-LIFE-SEARCH                      *
 14192*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14193*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14194*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 260
* EL050.cbl
 14195******************************************************************
 14196 3358-BENEFIT-LIFE-SEARCH.
 14197     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14198       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14199         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14200           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14201              IF FO-PLAN-REFUND-METHOD (SUB6)
 14202                     IS GREATER THAN SPACES
 14203                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14204                                          WS-LF-REFUND-CALC
 14205                 GO TO 3358-EXIT.
 14206
 14207     IF SUB6 LESS THAN +40
 14208         ADD +1                 TO SUB6
 14209         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14210
 14211 3358-EXIT.
 14212     EXIT.
 14213******************************************************************
 14214*                  3359-BENEFIT-AH-SEARCH                        *
 14215*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14216*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14217*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14218******************************************************************
 14219 3359-BENEFIT-AH-SEARCH.
 14220     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14221       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14222         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14223           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14224              IF FO-PLAN-REFUND-METHOD (SUB6)
 14225                      IS GREATER THAN SPACES
 14226                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14227                                          WS-AH-REFUND-CALC
 14228                 GO TO 3359-EXIT.
 14229
 14230     IF SUB6 LESS THAN +40
 14231         ADD +1                 TO SUB6
 14232         GO TO 3359-BENEFIT-AH-SEARCH.
 14233
 14234 3359-EXIT.
 14235     EXIT.
 14236
 14237******************************************************************
 14238*                  3360-CHECK-FORM-LIMITS                        *
 14239*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14240*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14241******************************************************************
 14242
 14243 3360-CHECK-FORM-LIMITS.
 14244
 14245     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14246         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14247
 14248     IF NOT LF-FORM-MASTER-FOUND
 14249         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14250
 14251 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14252
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 261
* EL050.cbl
 14253     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14254       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14255        WS-LF-JOINT-INDICATOR = 'J'  AND
 14256        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14257         IF PB-COMPANY-ID = 'NCL'
 14258            MOVE  ER-1911          TO  WS-ERROR
 14259            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14260         ELSE
 14261            MOVE  ER-1892          TO  WS-ERROR
 14262            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14263
 14264 3360-CHECK-FORM-LF-ATT-AGE.
 14265
 14266     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14267
 14268     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14269         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14270         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14271            IF PB-COMPANY-ID = 'NCL'
 14272                MOVE  ER-1913      TO  WS-ERROR
 14273                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14274            ELSE
 14275                MOVE  ER-1894      TO  WS-ERROR
 14276                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14277
 14278 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14279
 14280     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14281         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14282         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14283            IF PB-COMPANY-ID = 'NCL'
 14284                MOVE  ER-1914      TO  WS-ERROR
 14285                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14286            ELSE
 14287                MOVE  ER-1899      TO  WS-ERROR
 14288                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14289
 14290 3360-CHECK-FORM-LF-TERM-BAMT.
 14291
 14292     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14293         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 14294         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14295           IF  PB-COMPANY-ID = 'NCL'
 14296               MOVE  ER-1916       TO  WS-ERROR
 14297               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14298           ELSE
 14299               MOVE  ER-1902       TO  WS-ERROR
 14300               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14301
 14302     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 14303                                    PB-I-LF-ALT-BENEFIT-AMT.
 14304
 14305     IF  FO-MAX-LF-AMT   NUMERIC   AND
 14306         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 14307         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 14308             IF  PB-COMPANY-ID = 'NCL'
 14309                 MOVE  ER-1918     TO  WS-ERROR
 14310                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 262
* EL050.cbl
 14311             ELSE
 14312                 MOVE  ER-1904     TO  WS-ERROR
 14313                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14314
 14315******************************************************************
 14316*                  3360-CHECK-FORM-AH-LIMITS                     *
 14317*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14318*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14319******************************************************************
 14320
 14321 3360-CHECK-FORM-AH-LIMITS.
 14322
 14323     IF NOT AH-FORM-MASTER-FOUND
 14324         GO TO 3999-END-EDIT.
 14325
 14326 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 14327
 14328     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 14329       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 14330        WS-AH-JOINT-INDICATOR = 'J'  AND
 14331        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14332         IF PB-COMPANY-ID = 'NCL'
 14333            MOVE  ER-1912          TO  WS-ERROR
 14334            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14335         ELSE
 14336            MOVE  ER-1893          TO  WS-ERROR
 14337            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14338
 14339 3360-CHECK-FORM-AH-ATT-AGE.
 14340
 14341     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 14342
 14343     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 14344         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14345         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 14346            IF PB-COMPANY-ID = 'NCL'
 14347                MOVE  ER-1913      TO  WS-ERROR
 14348                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14349            ELSE
 14350                MOVE  ER-1894      TO  WS-ERROR
 14351                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14352
 14353 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 14354
 14355     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 14356         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 14357         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 14358            IF PB-COMPANY-ID = 'NCL'
 14359                MOVE  ER-1915      TO  WS-ERROR
 14360                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14361            ELSE
 14362                MOVE  ER-1900      TO  WS-ERROR
 14363                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14364
 14365 3360-CHECK-FORM-AH-TERM-BAMT.
 14366
 14367     IF  FO-AH-MAX-TERM    NUMERIC   AND
 14368         FO-AH-MAX-TERM    GREATER THAN  +0
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 263
* EL050.cbl
 14369         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 14370             IF  PB-COMPANY-ID = 'NCL'
 14371                 MOVE  ER-1917     TO  WS-ERROR
 14372                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14373             ELSE
 14374                  MOVE  ER-1903    TO  WS-ERROR
 14375                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14376
 14377     IF  FO-MAX-AH-AMT    NUMERIC   AND
 14378         FO-MAX-AH-AMT    GREATER THAN  +0
 14379         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 14380             IF  PB-COMPANY-ID = 'NCL'
 14381                 MOVE  ER-1919     TO  WS-ERROR
 14382                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14383             ELSE
 14384                 MOVE  ER-1905     TO  WS-ERROR
 14385                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14386
 14387     GO TO 3999-END-EDIT.
 14388
 14389******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 264
* EL050.cbl
 14391******************************************************************
 14392*                  E D I T   C A N C E L                         *
 14393******************************************************************
 14394
 14395 3700-EDIT-CANCEL.
 14396     IF PB-COMPANY-ID = 'DMD'
 14397         MOVE ZEROS                   TO WS-RES-STATE-TAX
 14398                                         WS-RES-MUNI-TAX
 14399                                         PB-CI-STATE-TAX
 14400                                         PB-CI-MUNI-TAX
 14401         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 14402
 14403*    IF PB-COMPANY-ID  EQUAL  'NCL'
 14404*       IF PB-ENTRY-BATCH  NUMERIC
 14405*          IF PB-CANCELLATION
 14406*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 14407*          ELSE
 14408*             IF PB-ISSUE
 14409*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 14410
 14411     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 14412        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 14413     END-IF
 14414*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 14415*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 14416
 14417     IF CM-ENTRY-STATUS = 'V'
 14418        MOVE ER-2780             TO WS-ERROR
 14419        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14420        GO TO 3999-END-EDIT.
 14421
 14422     IF CM-ENTRY-STATUS = 'D'
 14423        MOVE ER-2781             TO WS-ERROR
 14424        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14425        GO TO 3999-END-EDIT.
 14426
 14427     IF CM-ENTRY-STATUS = 'U'
 14428        MOVE ER-2782             TO WS-ERROR
 14429        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14430
 14431***************************************************************
 14432*                                                             *
 14433*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 14434*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 14435*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 14436*   OF ANOTHER COVERAGE.                                      *
 14437*                                                             *
 14438***************************************************************
 14439
 14440     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 14441                                    PB-C-AH-CANCEL-VOID-SW.
 14442
 14443     IF PB-C-LF-CANCEL-AMT = ZERO
 14444        NEXT SENTENCE
 14445     ELSE
 14446        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 14447           AND
 14448           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 265
* EL050.cbl
 14449               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 14450               MOVE ER-2745           TO WS-ERROR
 14451               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14452
 14453     IF PB-C-AH-CANCEL-AMT = ZERO
 14454        NEXT SENTENCE
 14455     ELSE
 14456        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 14457           AND
 14458           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 14459               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 14460               MOVE ER-2745           TO WS-ERROR
 14461               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14462
 14463     IF WS-LF-EARNINGS-CALC = '4'
 14464        MOVE '4'                   TO WS-LF-REFUND-CALC.
 14465
 14466     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 14467     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 14468     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 14469     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 14470     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 14471     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 14472
 14473     MOVE ZERO                     TO PB-C-LF-REF-CALC
 14474                                      PB-C-AH-REF-CALC.
 14475     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 14476
 14477******************************************************************
 14478*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 14479*             TO VALIDATE COVERAGE.                              *
 14480******************************************************************
 14481
 14482     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 14483        PB-C-LF-CANCEL-AMT = ZEROS
 14484          MOVE 'N'                 TO WS-LF-CANCEL-SW
 14485      ELSE
 14486          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 14487
 14488     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 14489        PB-C-AH-CANCEL-AMT = ZEROS
 14490          MOVE 'N'                 TO WS-AH-CANCEL-SW
 14491      ELSE
 14492          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 14493
 14494     EVALUATE TRUE
 14495         WHEN PB-CANCEL-FORCE             OR
 14496              PB-CANCEL-DATE-FORCED       OR
 14497              PB-FORCE-OFF
 14498                  IF PB-COMPANY-ID = 'ACE'
 14499                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 14500                  END-IF
 14501         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 14502               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 14503              (PB-COMPANY-ID = 'ACE' )
 14504                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 14505         WHEN OTHER
 14506              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 266
* EL050.cbl
 14507                 MOVE ER-2794              TO WS-ERROR
 14508              ELSE
 14509                 MOVE ER-2749              TO WS-ERROR
 14510              END-IF
 14511              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14512     END-EVALUATE.
 14513
 14514
 14515*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14516*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 14517*            MOVE  ER-1909            TO  WS-ERROR
 14518*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14519*        ELSE
 14520*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 14521
 14522     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 14523     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 14524        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 14525     ELSE
 14526        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 14527     END-IF
 14528     .
 14529 3705-EDIT-CANCEL-DT.
 14530
 14531     IF LF-COVERAGE-CANCELLED
 14532        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 14533         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 14534         MOVE WS-CURRENT-MONTH-END
 14535                                 TO DC-BIN-DATE-2
 14536         SET ELAPSED-BETWEEN-BIN TO TRUE
 14537*        MOVE 1                  TO DC-OPTION-CODE
 14538         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14539         IF DATE-CONVERSION-ERROR
 14540            NEXT SENTENCE
 14541          ELSE
 14542             IF DC-ELAPSED-DAYS GREATER +180
 14543                IF PB-CANCEL-DATE-FORCED  OR
 14544                   PB-CANCEL-DATE-FORCED-NO-FEE
 14545                      MOVE ER-2751  TO WS-ERROR
 14546                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14547                 ELSE
 14548                   MOVE ER-2752  TO WS-ERROR
 14549                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14550
 14551     IF AH-COVERAGE-CANCELLED
 14552        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 14553         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 14554         MOVE WS-CURRENT-MONTH-END
 14555                                 TO DC-BIN-DATE-2
 14556         SET ELAPSED-BETWEEN-BIN TO TRUE
 14557*        MOVE 1                  TO DC-OPTION-CODE
 14558         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14559         IF DATE-CONVERSION-ERROR
 14560            NEXT SENTENCE
 14561          ELSE
 14562             IF DC-ELAPSED-DAYS GREATER +180
 14563                IF PB-CANCEL-DATE-FORCED OR
 14564                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 267
* EL050.cbl
 14565                      MOVE ER-2751  TO WS-ERROR
 14566                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14567                 ELSE
 14568                   MOVE ER-2752  TO WS-ERROR
 14569                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14570
 14571     IF WS-ERROR = ER-2752
 14572        AND (PB-COMPANY-ID = 'ABL'
 14573         OR  PB-COMPANY-ID = 'FGL'
 14574         OR  PB-COMPANY-ID = 'IST'
 14575         OR  PB-COMPANY-ID = 'JHL'
 14576         OR  PB-COMPANY-ID = 'LAP'
 14577         OR  PB-COMPANY-ID = 'LBL'
 14578         OR  PB-COMPANY-ID = 'NCB'
 14579         OR  PB-COMPANY-ID = 'NLI'
 14580         OR  PB-COMPANY-ID = 'OFI'
 14581         OR  PB-COMPANY-ID = 'PLI'
 14582         OR  PB-COMPANY-ID = 'TAO'
 14583         OR  PB-COMPANY-ID = 'TIC'
 14584         OR  PB-COMPANY-ID = 'HER'
 14585         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 14586         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 14587            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 14588            MOVE ER-2762     TO WS-ERROR
 14589            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14590
 14591     IF LF-COVERAGE-CANCELLED
 14592        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 14593        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 14594             MOVE ER-2733         TO WS-ERROR
 14595             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14596
 14597     IF AH-COVERAGE-CANCELLED
 14598        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 14599        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 14600              MOVE ER-2733        TO WS-ERROR
 14601              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14602
 14603     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 14604        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 14605        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 14606           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 14607            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 14608              IF PB-COMPANY-ID NOT = 'LAP'
 14609               MOVE ER-2704            TO WS-ERROR
 14610               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 14611
 14612     IF CERT-WAS-NOT-FOUND
 14613         GO TO 3999-END-EDIT.
 14614
 14615     IF PB-COMPANY-ID EQUAL 'CDC'
 14616        IF LF-COVERAGE-CANCELLED
 14617           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 14618            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 14619            MOVE PB-C-LF-CANCEL-DT
 14620                                 TO DC-BIN-DATE-2
 14621            SET ELAPSED-BETWEEN-BIN TO TRUE
 14622*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 268
* EL050.cbl
 14623            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14624            IF DATE-CONVERSION-ERROR
 14625               NEXT SENTENCE
 14626             ELSE
 14627                IF DC-ELAPSED-DAYS GREATER +60
 14628                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 14629
 14630     IF PB-COMPANY-ID EQUAL 'CDC'
 14631        IF AH-COVERAGE-CANCELLED
 14632           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 14633            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 14634            MOVE PB-C-AH-CANCEL-DT
 14635                                 TO DC-BIN-DATE-2
 14636            MOVE +0              TO DC-ELAPSED-DAYS
 14637                                    DC-ELAPSED-MONTHS
 14638            SET ELAPSED-BETWEEN-BIN  TO TRUE
 14639*           MOVE 1               TO DC-OPTION-CODE
 14640            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14641            IF DATE-CONVERSION-ERROR
 14642               NEXT SENTENCE
 14643             ELSE
 14644                IF DC-ELAPSED-DAYS GREATER +60
 14645                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 14646
 14647     MOVE +0                     TO DC-ELAPSED-DAYS
 14648                                    DC-ELAPSED-MONTHS.
 14649
 14650     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 14651        (WS-AH-SPECIAL-CALC-CD = 'Z')
 14652          MOVE 'Z'                TO PB-CI-OB-FLAG
 14653          MOVE ER-2767            TO WS-ERROR
 14654          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14655          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 14656          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 14657          GO TO 3775-OVER-REF-CHK
 14658        ELSE
 14659          MOVE ZEROS              TO PB-CI-LIVES
 14660                                     PB-C-LIVES
 14661          IF PB-CI-OB-FLAG NOT = 'B'
 14662             MOVE SPACE           TO PB-CI-OB-FLAG.
 14663
 14664     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 14665         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 14666     ELSE
 14667         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 14668
 14669     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 14670        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 14671            MOVE ER-2760         TO WS-ERROR
 14672            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14673
 14674     IF LF-COVERAGE-CANCELLED
 14675        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 14676         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 14677            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 14678               MOVE ER-2774       TO WS-ERROR
 14679               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14680
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 269
* EL050.cbl
 14681     IF AH-COVERAGE-CANCELLED
 14682        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 14683         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 14684            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 14685               MOVE ER-2775       TO WS-ERROR
 14686               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14687
 14688     IF LF-COVERAGE-CANCELLED
 14689        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 14690         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 14691            MOVE ER-2776         TO WS-ERROR
 14692            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14693
 14694     IF AH-COVERAGE-CANCELLED
 14695        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 14696         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 14697            MOVE ER-2777         TO WS-ERROR
 14698            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14699
 14700     IF LF-COVERAGE-CANCELLED
 14701        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 14702         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 14703         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 14704         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 14705*        MOVE 6                    TO DC-OPTION-CODE
 14706         SET BIN-PLUS-ELAPSED      TO TRUE
 14707         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14708         IF DATE-CONVERSION-ERROR
 14709            NEXT SENTENCE
 14710          ELSE
 14711            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 14712              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 14713                             OR  'FIA'
 14714                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 14715               ELSE
 14716                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 14717                MOVE ER-2731       TO WS-ERROR
 14718                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14719
 14720 3705-EDIT-AH-CANCEL-DT.
 14721
 14722     IF AH-COVERAGE-CANCELLED
 14723        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 14724         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 14725         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 14726         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 14727*        MOVE 6                    TO DC-OPTION-CODE
 14728         SET BIN-PLUS-ELAPSED      TO TRUE
 14729         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14730         IF DATE-CONVERSION-ERROR
 14731            NEXT SENTENCE
 14732          ELSE
 14733            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 14734              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 14735                              OR 'FIA'
 14736                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 14737              ELSE
 14738               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 270
* EL050.cbl
 14739               MOVE ER-2771       TO WS-ERROR
 14740               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14741
 14742 3705-EDIT-CONTINUED.
 14743
 14744     IF LF-COVERAGE-CANCELLED
 14745       IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 14746          IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 14747             MOVE ER-2727         TO WS-ERROR
 14748             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14749
 14750     IF AH-COVERAGE-CANCELLED
 14751       IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 14752         IF PB-COMPANY-ID = 'ACE'
 14753            MOVE ER-2727        TO WS-ERROR
 14754            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14755         ELSE
 14756            IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 14757               MOVE ER-2727     TO WS-ERROR
 14758               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14759
 14760     IF PB-COMPANY-ID = 'ACE'
 14761       IF AH-COVERAGE-CANCELLED
 14762         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 14763           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 14764              MOVE ER-2732      TO WS-ERROR
 14765              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14766
 14767     IF PB-COMPANY-ID      EQUAL   'HER'
 14768        IF WS-ERROR        EQUAL   ER-2727
 14769            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 14770            MOVE  ER-2725          TO  WS-ERROR
 14771            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14772
 14773     IF PB-C-CLAIM-CREATED-CANCEL
 14774            MOVE ER-2748         TO WS-ERROR
 14775            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14776
 14777     IF PB-C-LAST-NAME NOT = SPACES
 14778         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 14779            MOVE ER-2747         TO WS-ERROR
 14780            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14781
 14782 3710-EDIT-LUMP-SUM-PRIOR.
 14783
 14784     IF AH-COVERAGE-CANCELLED
 14785         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 14786             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 14787                MOVE ER-2735    TO WS-ERROR
 14788                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14789
 14790     IF LF-COVERAGE-CANCELLED
 14791         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 14792             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 14793                MOVE ER-2735    TO WS-ERROR
 14794                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14795
 14796 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 271
* EL050.cbl
 14797
 14798     IF LF-COVERAGE-CANCELLED
 14799         IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 14800            (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 14801            (NOT PB-CI-OB)
 14802              IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 14803                 IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 14804                    MOVE ER-2732  TO WS-ERROR
 14805                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14806
 14807     IF AH-COVERAGE-CANCELLED
 14808         IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 14809            (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 14810            (NOT PB-CI-OB)
 14811              IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 14812                 IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 14813                    MOVE ER-2732  TO WS-ERROR
 14814                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14815
 14816     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 14817         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 14818            (NOT PB-COMP-LF-CANCEL)
 14819             NEXT SENTENCE
 14820         ELSE
 14821           IF PB-C-LF-CANCEL-VOIDED
 14822              NEXT SENTENCE
 14823           ELSE
 14824              MOVE ER-2753      TO WS-ERROR
 14825              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14826
 14827     IF CANCEL-FUTURE-DT
 14828         GO TO 3999-END-EDIT.
 14829
 14830 3715-GET-REMAIN-TERM-LF.
 14831
 14832     IF NO-LF-BENEFIT-MATCH  OR
 14833        WS-LF-BENEFIT-CD = ZEROS
 14834        GO TO 3730-GET-AH-REMAIN-TERM.
 14835
 14836     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14837     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14838     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 14839     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 14840     MOVE PB-SV-STATE            TO CP-STATE.
 14841     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14842     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14843     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14844     MOVE '2'                    TO CP-PROCESS-TYPE.
 14845     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14846     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14847     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 14848     IF (PB-COMPANY-ID = 'CID')
 14849        AND (CP-STATE-STD-ABBRV = 'WI')
 14850        MOVE '7'                 TO CP-REM-TERM-METHOD
 14851        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 14852     ELSE
 14853        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 14854        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 272
* EL050.cbl
 14855                                 TO CP-REM-TRM-CALC-OPTION
 14856     END-IF
 14857**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 14858     IF (PB-COMPANY-ID = 'CID')
 14859        AND (CP-STATE-STD-ABBRV = 'MO')
 14860        AND (PB-CERT-EFF-DT >= X'9B41')
 14861        AND (PB-CERT-EFF-DT <= X'A2FB')
 14862        MOVE '7'                 TO CP-REM-TERM-METHOD
 14863        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 14864     END-IF
 14865     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 14866                                    CP-LOAN-TERM.
 14867     IF CP-TRUNCATED-LIFE
 14868        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 14869
 14870     IF CP-TERM-IS-DAYS
 14871         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14872     ELSE
 14873         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14874
 14875     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 14876
 14877     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 14878
 14879     IF LF-COVERAGE-CANCELLED
 14880        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 14881        NEXT SENTENCE
 14882      ELSE
 14883          GO TO 3730-GET-AH-REMAIN-TERM.
 14884
 14885 3720-GET-LF-REFUND.
 14886
 14887     IF PB-C-LF-CANCEL-VOIDED OR
 14888        PB-C-AH-CANCEL-VOIDED
 14889        GO TO 3780-UPDATE-CANCEL-CERT.
 14890
 14891     IF PB-COMPANY-ID EQUAL 'BOA'
 14892         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 14893         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 14894         GO TO 3730-GET-AH-REMAIN-TERM.
 14895
 14896     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 14897        (WS-AH-SPECIAL-CALC-CD = 'M')
 14898         MOVE ER-2767            TO WS-ERROR
 14899         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14900         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 14901         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 14902         GO TO 3780-UPDATE-CANCEL-CERT.
 14903
 14904     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM.
 14905
 14906     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14907     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 14908     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 14909     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 14910     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 14911
 14912     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 273
* EL050.cbl
 14913
 14914     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 14915
 14916     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 14917                                    PB-C-LF-REM-TERM.
 14918
 14919     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 14920     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 14921
 14922     IF PB-COMPANY-ID EQUAL 'FLC'
 14923        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 14924           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 14925           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 14926                    + PB-CI-LF-ALT-PREMIUM-AMT)
 14927                    - CM-LF-ITD-DEATH-AMT
 14928           IF PB-C-LF-REF-CALC LESS THAN +0
 14929              MOVE +0            TO PB-C-LF-REF-CALC
 14930              GO TO 3730-GET-AH-REMAIN-TERM
 14931           ELSE
 14932              GO TO 3730-GET-AH-REMAIN-TERM.
 14933
 14934     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 14935                            OR '4' OR '5' OR '6' OR '8'
 14936                            OR '9' OR 'G'
 14937        MOVE PB-C-LF-REFUND-OVERRIDE
 14938                                 TO CP-EARNING-METHOD.
 14939
 14940     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 14941     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14942     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14943                                    CP-RATING-BENEFIT-AMT.
 14944     IF CP-STATE-STD-ABBRV = 'OR'
 14945         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 14946                                         PB-CI-LF-ALT-BENEFIT-AMT.
 14947     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14948     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 14949     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 14950     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 14951     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 14952     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 14953
 14954     IF WS-DEFAULT-APR NOT NUMERIC
 14955         MOVE ZEROS TO WS-DEFAULT-APR.
 14956****   N O T E   ****
 14957*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 14958*      THE OH HARD CODING IN ELCRFNDP
 14959
 14960     IF PB-COMPANY-ID = 'CID'
 14961        IF CP-STATE-STD-ABBRV = 'OH'
 14962           MOVE WS-LF-EARNINGS-CALC
 14963                                 TO CP-EARNING-METHOD
 14964        END-IF
 14965     END-IF
 14966
 14967****   N O T E   ****
 14968
 14969     IF CP-EARN-AS-NET-PAY
 14970         IF CP-LOAN-APR NOT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 274
* EL050.cbl
 14971            IF WS-DEFAULT-APR GREATER THAN ZEROS
 14972                MOVE WS-DEFAULT-APR
 14973                                 TO  CP-LOAN-APR
 14974                MOVE ER-3780     TO  WS-ERROR
 14975                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 14976            ELSE
 14977                MOVE ER-3781     TO  WS-ERROR
 14978                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 14979     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 14980     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 14981
 14982     IF CP-REFUND-TYPE-USED NOT = SPACE
 14983         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 14984
 14985     IF CP-ERROR-RATE-IS-ZERO OR
 14986        CP-ERROR-RATE-NOT-FOUND
 14987        MOVE ER-2740             TO WS-ERROR
 14988        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14989
 14990     IF CP-ERROR-RATE-FILE-NOTOPEN
 14991        MOVE ER-2617             TO WS-ERROR
 14992        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14993
 14994     IF PB-COMPANY-ID = 'DCC'
 14995        AND PB-CI-ENTRY-STATUS = 'M'
 14996        MOVE +0                  TO PB-C-LF-REF-CALC
 14997     ELSE
 14998        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 14999     END-IF
 15000
 15001     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15002         GO TO 3730-GET-AH-REMAIN-TERM.
 15003
 15004*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15005*       ADD +1                   TO PB-C-LF-REM-TERM
 15006*                                   CP-REMAINING-TERM
 15007*                                   CP-ORIGINAL-TERM.
 15008
 15009     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15010     MOVE '2'                    TO CP-EARNING-METHOD
 15011                                    CP-RATING-METHOD.
 15012     IF PB-COMPANY-ID = 'CID'
 15013        IF (CP-STATE-STD-ABBRV = 'MN')
 15014           AND (PB-CERT-EFF-DT > X'A4FF')
 15015           AND (WS-LF-EARNINGS-CALC = 'B')
 15016           MOVE '5'              TO CP-EARNING-METHOD
 15017           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15018        END-IF
 15019     END-IF
 15020     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15021                                        CP-REMAINING-BENEFIT
 15022                                        CP-RATING-BENEFIT-AMT.
 15023     IF CP-STATE-STD-ABBRV = 'OR'
 15024         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15025                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15026     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15027     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15028
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 275
* EL050.cbl
 15029     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15030
 15031     IF CP-ERROR-RATE-IS-ZERO OR
 15032        CP-ERROR-RATE-NOT-FOUND
 15033        MOVE ER-2740             TO WS-ERROR
 15034        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15035
 15036     IF CP-ERROR-RATE-FILE-NOTOPEN
 15037        MOVE ER-2617             TO WS-ERROR
 15038        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15039
 15040     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15041
 15042******************************************************************
 15043
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 276
* EL050.cbl
 15045 3730-GET-AH-REMAIN-TERM.
 15046     IF NO-AH-BENEFIT-MATCH  OR
 15047        WS-AH-BENEFIT-CD = ZEROS
 15048         GO TO 3770-CHECK-REFUNDS.
 15049
 15050     IF PB-CI-AH-LUMP-SUM-DISAB
 15051         IF  PB-C-AH-CANCEL-AMT = ZERO
 15052            IF NOT PB-COMP-AH-CANCEL
 15053             GO TO 3770-CHECK-REFUNDS.
 15054
 15055     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15056     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15057     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15058     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15059     MOVE PB-SV-STATE            TO CP-STATE.
 15060     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15061     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15062     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15063     MOVE '2'                    TO CP-PROCESS-TYPE.
 15064     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15065     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15066     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15067     IF (PB-COMPANY-ID = 'CID')
 15068        AND (CP-STATE-STD-ABBRV = 'WI')
 15069        MOVE '7'                 TO CP-REM-TERM-METHOD
 15070        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15071     ELSE
 15072        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15073        MOVE WS-REM-TRM-CALC-OPTION
 15074                                 TO CP-REM-TRM-CALC-OPTION
 15075     END-IF
 15076     IF (PB-COMPANY-ID = 'CID')
 15077        AND (CP-STATE-STD-ABBRV = 'MO')
 15078        AND (PB-CERT-EFF-DT >= X'9B41')
 15079        AND (PB-CERT-EFF-DT <= X'A2FB')
 15080        MOVE '7'                 TO CP-REM-TERM-METHOD
 15081        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15082     END-IF
 15083     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15084                                    CP-LOAN-TERM.
 15085     IF NOT CP-TERM-IS-DAYS
 15086         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15087
 15088     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15089
 15090     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15091
 15092     IF AH-COVERAGE-CANCELLED
 15093        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15094        NEXT SENTENCE
 15095      ELSE
 15096         GO TO 3770-CHECK-REFUNDS.
 15097
 15098 3740-GET-AH-REFUND.
 15099
 15100     IF PB-C-LF-CANCEL-VOIDED OR
 15101        PB-C-AH-CANCEL-VOIDED
 15102        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 277
* EL050.cbl
 15103
 15104     IF PB-COMPANY-ID = 'BOA'
 15105         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15106         GO TO 3770-CHECK-REFUNDS.
 15107
 15108     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15109*    MOVE ' '                    TO DC-OPTION-CODE
 15110     SET BIN-TO-GREG             TO TRUE
 15111     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15112     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15113                                    PB-C-AH-REM-TERM.
 15114     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15115     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15116
 15117     IF PB-COMPANY-ID EQUAL 'FLC'
 15118        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15119           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15120           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15121                    - CM-AH-ITD-AH-PMT)
 15122           IF PB-C-AH-REF-CALC LESS THAN +0
 15123              MOVE +0            TO PB-C-AH-REF-CALC
 15124              GO TO 3770-CHECK-REFUNDS
 15125           ELSE
 15126              GO TO 3770-CHECK-REFUNDS.
 15127
 15128     IF PB-COMPANY-ID = 'DCC'
 15129        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15130            AND (CP-EARNING-METHOD NOT = 'G')
 15131           MOVE 'S'              TO CP-EARNING-METHOD
 15132        END-IF
 15133     END-IF
 15134     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15135                            OR '4' OR '5' OR '6' OR '8'
 15136                            OR '9' OR 'G' OR 'S'
 15137        MOVE PB-C-AH-REFUND-OVERRIDE
 15138                                 TO CP-EARNING-METHOD.
 15139
 15140     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15141     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15142     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15143                                    CP-RATING-BENEFIT-AMT.
 15144     IF CP-STATE-STD-ABBRV = 'OR'
 15145         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15146                                         PB-CI-AH-TERM.
 15147     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15148     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15149     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15150     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15151     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15152     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15153
 15154     IF CP-STATE-STD-ABBRV = 'OH'
 15155        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15156                                AND 'CID' AND 'DCC')
 15157           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15158              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15159              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15160              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 278
* EL050.cbl
 15161           END-IF
 15162        END-IF
 15163        IF PB-COMPANY-ID = 'CID'
 15164           IF NO-LIFE-COVERAGE
 15165              IF CP-CRITICAL-PERIOD
 15166                 MOVE '2'       TO CP-EARNING-METHOD
 15167              ELSE
 15168                 MOVE '6'       TO CP-EARNING-METHOD
 15169              END-IF
 15170           ELSE
 15171              IF WS-LF-COVERAGE-TYPE = 'L'
 15172                 MOVE '2'       TO CP-EARNING-METHOD
 15173              ELSE
 15174                 IF (PB-CI-LF-TERM > +60) OR
 15175                    (WS-LF-EARNINGS-CALC = '5')
 15176                    IF CP-CRITICAL-PERIOD
 15177                       MOVE '2'  TO CP-EARNING-METHOD
 15178                    ELSE
 15179                       MOVE '6'  TO CP-EARNING-METHOD
 15180                    END-IF
 15181                 ELSE
 15182                    MOVE '1'     TO CP-EARNING-METHOD
 15183                 END-IF
 15184              END-IF
 15185           END-IF
 15186        END-IF
 15187     END-IF
 15188
 15189*    IF CP-STATE-STD-ABBRV = 'VA'
 15190*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15191*          IF CP-ORIGINAL-TERM GREATER 61
 15192*             MOVE '6' TO CP-EARNING-METHOD
 15193*          ELSE
 15194*             MOVE '1' TO CP-EARNING-METHOD.
 15195
 15196     IF WS-DEFAULT-APR NOT NUMERIC
 15197         MOVE ZEROS TO WS-DEFAULT-APR.
 15198     IF CP-EARN-AS-NET-PAY
 15199         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15200            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15201                MOVE WS-DEFAULT-APR
 15202                                 TO  CP-LOAN-APR
 15203                MOVE ER-3780     TO  WS-ERROR
 15204                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15205            ELSE
 15206                MOVE ER-3781     TO  WS-ERROR
 15207                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15208
 15209     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15210
 15211     IF CP-REFUND-TYPE-USED NOT = SPACE
 15212         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 15213
 15214     IF CP-ERROR-RATE-IS-ZERO OR
 15215        CP-ERROR-RATE-NOT-FOUND
 15216        MOVE ER-2740             TO WS-ERROR
 15217        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15218
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 279
* EL050.cbl
 15219     IF CP-ERROR-RATE-FILE-NOTOPEN
 15220        MOVE ER-2617             TO WS-ERROR
 15221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15222     IF PB-COMPANY-ID = 'DCC'
 15223        AND PB-CI-ENTRY-STATUS = 'M'
 15224        MOVE +0                  TO PB-C-AH-REF-CALC
 15225     ELSE
 15226        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 15227     END-IF
 15228     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 280
* EL050.cbl
 15230
 15231 3770-CHECK-REFUNDS.
 15232
 15233     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 15234        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 15235           MOVE ER-2766          TO WS-ERROR
 15236           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15237           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 15238           IF PB-C-LF-REF-CALC LESS THAN ZERO
 15239              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 15240
 15241     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 15242        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 15243           MOVE ER-2766          TO WS-ERROR
 15244           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15245           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 15246           IF PB-C-AH-REF-CALC LESS THAN ZERO
 15247              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 15248
 15249     IF PB-COMP-LF-CANCEL
 15250        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 15251        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 15252           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 15253              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 15254
 15255     IF PB-COMP-AH-CANCEL
 15256        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 15257        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 15258           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 15259              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 15260
 15261     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 15262             GIVING WS-UNSIGN-WRK1
 15263     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 15264             GIVING WS-UNSIGN-WRK2.
 15265
 15266     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15267         MOVE ZERO TO WS-UNSIGN-WRK1.
 15268
 15269     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15270         MOVE ZERO TO WS-UNSIGN-WRK2.
 15271
 15272     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 15273
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 281
* EL050.cbl
 15275
 15276 3772-CONTINUE.
 15277
 15278**********************************
 15279*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 15280*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 15281*** DOUBLES THE TOLERANCE AMOUNT.
 15282***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 15283**********************************
 15284     IF PB-COMPANY-ID = 'MON'
 15285     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 15286         IF WS-REF-REJECT-SW = SPACE
 15287             MOVE ER-2754        TO WS-ERROR
 15288             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15289           ELSE
 15290             MOVE ER-2736        TO WS-ERROR
 15291             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15292**********************************
 15293
 15294 3773-CONTINUE.
 15295
 15296     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 15297        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 15298           MOVE ER-2723          TO WS-ERROR
 15299           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15300
 15301     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 15302        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 15303           MOVE ER-2724          TO WS-ERROR
 15304           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15305
 15306     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 15307         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 15308             (1 + WS-LF-REFUND-OVS-PCT)
 15309     ELSE
 15310         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 15311
 15312     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 15313         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 15314             (1 - WS-TOL-LF-REFUND-PCT)
 15315     ELSE
 15316         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15317
 15318     IF (PB-COMPANY-ID = 'DCC')
 15319        AND (PB-CI-ENTRY-STATUS = 'M')
 15320        AND (PB-C-LF-CANCEL-AMT > +0)
 15321        MOVE ER-3843             TO WS-ERROR
 15322        PERFORM 9900-ERROR-FORMAT
 15323                                 THRU 9900-EXIT
 15324     END-IF
 15325     EVALUATE TRUE
 15326        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 15327           CONTINUE
 15328        WHEN PB-C-LF-CANCEL-AMT = +0
 15329                 AND PB-C-LF-REF-CALC > +0
 15330           CONTINUE
 15331        WHEN WS-LF-REFUND-OVS-AMT = 0
 15332                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 282
* EL050.cbl
 15333           CONTINUE
 15334        WHEN OTHER
 15335           IF WS-TOL-LF-REFUND  = +0
 15336              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 15337           END-IF
 15338           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 15339                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 15340                          (PB-C-LF-CANCEL-AMT))
 15341              CONTINUE
 15342           ELSE
 15343              IF WS-LF-REFUND-OVS-AMT = +0
 15344                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 15345              END-IF
 15346              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 15347                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 15348                                       PB-C-LF-CANCEL-AMT)
 15349                 CONTINUE
 15350              ELSE
 15351                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 15352                   MOVE ER-2754   TO  WS-ERROR
 15353                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15354                 ELSE
 15355                    MOVE ER-2736   TO  WS-ERROR
 15356                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15357                 END-IF
 15358              END-IF
 15359           END-IF
 15360     END-EVALUATE.
 15361
 15362     EVALUATE TRUE
 15363        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 15364           CONTINUE
 15365        WHEN PB-C-LF-CANCEL-AMT = +0
 15366                 AND PB-C-LF-REF-CALC > +0
 15367           CONTINUE
 15368        WHEN OTHER
 15369           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 15370               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 15371              CONTINUE
 15372           ELSE
 15373              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 15374               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 15375                CONTINUE
 15376              ELSE
 15377                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 15378                     MOVE ER-2754   TO  WS-ERROR
 15379                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15380                 ELSE
 15381                     MOVE ER-2736   TO  WS-ERROR
 15382                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15383                 END-IF
 15384              END-IF
 15385           END-IF
 15386     END-EVALUATE.
 15387
 15388     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 15389         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 15390             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 283
* EL050.cbl
 15391     ELSE
 15392         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 15393
 15394     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 15395         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 15396             (1 - WS-TOL-AH-REFUND-PCT)
 15397     ELSE
 15398         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15399
 15400     IF (PB-COMPANY-ID = 'DCC')
 15401        AND (PB-CI-ENTRY-STATUS = 'M')
 15402        AND (PB-C-AH-CANCEL-AMT > +0)
 15403        MOVE ER-3843             TO WS-ERROR
 15404        PERFORM 9900-ERROR-FORMAT
 15405                                 THRU 9900-EXIT
 15406     END-IF
 15407     EVALUATE TRUE
 15408        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 15409           CONTINUE
 15410*       WHEN PB-C-AH-REF-CALC = +0 AND
 15411*                  PB-C-AH-CANCEL-AMT > +0
 15412        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 15413                   PB-C-AH-REF-CALC > +0
 15414           CONTINUE
 15415        WHEN WS-AH-REFUND-OVS-AMT = +0
 15416                AND WS-TOL-AH-REFUND = +0
 15417           CONTINUE
 15418        WHEN OTHER
 15419           IF WS-TOL-AH-REFUND = +0
 15420              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 15421           END-IF
 15422           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 15423               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 15424                                         PB-C-AH-CANCEL-AMT)
 15425              CONTINUE
 15426           ELSE
 15427              IF WS-AH-REFUND-OVS-AMT = +0
 15428                 MOVE +9999999.99 TO
 15429                         WS-AH-REFUND-OVS-AMT
 15430              END-IF
 15431              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 15432                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 15433                                         PB-C-AH-CANCEL-AMT)
 15434                 CONTINUE
 15435              ELSE
 15436                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 15437                    MOVE ER-2754   TO  WS-ERROR
 15438                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15439                 ELSE
 15440                    MOVE ER-2736   TO  WS-ERROR
 15441                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15442                 END-IF
 15443              END-IF
 15444           END-IF
 15445     END-EVALUATE.
 15446
 15447     EVALUATE TRUE
 15448        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 284
* EL050.cbl
 15449           CONTINUE
 15450*       WHEN PB-C-AH-REF-CALC > +0 AND
 15451*                  PB-C-AH-CANCEL-AMT = +0
 15452        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 15453                   PB-C-AH-REF-CALC = +0
 15454           CONTINUE
 15455        WHEN OTHER
 15456           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 15457               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 15458              CONTINUE
 15459           ELSE
 15460              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 15461                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 15462                 CONTINUE
 15463              ELSE
 15464                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 15465                     MOVE ER-2754   TO  WS-ERROR
 15466                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15467                 ELSE
 15468                     MOVE ER-2736   TO  WS-ERROR
 15469                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15470                 END-IF
 15471              END-IF
 15472           END-IF
 15473     END-EVALUATE.
 15474
 15475     IF (PB-C-LF-CANCEL-AMT = ZERO)
 15476        AND (PB-C-AH-CANCEL-AMT = ZERO)
 15477        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 15478           AND  PB-C-LF-REF-CALC < +1.00
 15479           AND  PB-C-AH-REF-CALC < +1.00
 15480           CONTINUE
 15481        ELSE
 15482           IF (PB-COMPANY-ID = 'DCC')
 15483              AND (PB-CI-ENTRY-STATUS = 'M')
 15484              CONTINUE
 15485           ELSE
 15486              MOVE ER-2741       TO WS-ERROR
 15487              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15488           END-IF
 15489        END-IF
 15490     END-IF
 15491
 15492     IF (PB-C-LF-CANCEL-AMT = ZERO
 15493        AND WS-LF-BENEFIT-CD NOT = ZERO
 15494        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 15495        AND PB-C-LF-REF-CALC NOT = ZERO)
 15496        OR
 15497        (PB-C-LF-CANCEL-AMT = ZERO
 15498        AND WS-LF-BENEFIT-CD NOT = ZERO
 15499        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 15500             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 15501                AND PB-C-LF-REF-CALC LESS THAN +1.00
 15502                NEXT SENTENCE
 15503             ELSE
 15504                MOVE ER-2739        TO WS-ERROR
 15505                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15506
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 285
* EL050.cbl
 15507     IF (PB-C-AH-CANCEL-AMT = ZERO
 15508        AND WS-AH-BENEFIT-CD NOT = ZERO
 15509        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 15510        AND PB-C-AH-REF-CALC NOT = ZERO)
 15511        OR
 15512        (PB-C-AH-CANCEL-AMT = ZERO
 15513        AND WS-AH-BENEFIT-CD NOT = ZERO
 15514        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 15515             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 15516                AND PB-C-AH-REF-CALC LESS THAN +1.00
 15517                NEXT SENTENCE
 15518             ELSE
 15519                MOVE ER-2738        TO WS-ERROR
 15520                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15521
 15522 3775-OVER-REF-CHK.
 15523
 15524     IF PB-CI-ENTRY-STATUS = '5'
 15525        GO TO 3780-UPDATE-CANCEL-CERT.
 15526
 15527     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 15528                              PB-CI-LF-ALT-PREMIUM-AMT.
 15529
 15530     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15531        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 15532                                 PB-C-LF-REF-CALC
 15533      ELSE
 15534        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 15535                                 PB-C-LF-CANCEL-AMT.
 15536
 15537     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 15538        MOVE ER-2755             TO WS-ERROR
 15539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15540
 15541     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 15542
 15543     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 15544        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 15545                                 PB-C-AH-REF-CALC
 15546      ELSE
 15547        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 15548                                 PB-C-AH-CANCEL-AMT.
 15549
 15550     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 15551        MOVE ER-2778             TO WS-ERROR
 15552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15553
 15554     IF PB-CI-OB-FLAG NOT = 'Z'
 15555        NEXT SENTENCE
 15556       ELSE
 15557         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 15558            MOVE ER-2757           TO WS-ERROR
 15559            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15560
 15561 3780-UPDATE-CANCEL-CERT.
 15562
 15563     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 15564        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 286
* EL050.cbl
 15565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15566
 15567     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 15568         MOVE ER-2729              TO WS-ERROR
 15569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15570
 15571     IF PB-CI-LF-BENEFIT-CD = ZERO
 15572         GO TO 3780-UPDATE-CONT-1.
 15573
 15574     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 15575         GO TO 3780-UPDATE-CONT-1.
 15576
 15577     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 15578       AND
 15579        (PB-C-LF-CANCEL-AMT NEGATIVE)
 15580       AND
 15581        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 15582       AND
 15583        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15584            NEXT SENTENCE
 15585       ELSE
 15586        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 15587          AND
 15588***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 15589***       AND
 15590           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 15591            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 15592               MOVE ER-2730      TO WS-ERROR
 15593               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15594               GO TO 3999-END-EDIT
 15595            ELSE
 15596               GO TO 3999-END-EDIT
 15597        ELSE
 15598            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 15599               MOVE ER-2765           TO WS-ERROR
 15600               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15601               GO TO 3785-CHECK-NH.
 15602*              GO TO 3999-END-EDIT.
 15603
 15604 3780-UPDATE-CONT-1.
 15605
 15606     IF PB-CI-AH-BENEFIT-CD = ZERO
 15607         GO TO 3780-UPDATE-CONT-2.
 15608
 15609     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 15610         GO TO 3780-UPDATE-CONT-2.
 15611
 15612     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 15613       AND
 15614        (PB-C-AH-CANCEL-AMT NEGATIVE)
 15615       AND
 15616        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 15617       AND
 15618        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 15619            NEXT SENTENCE
 15620       ELSE
 15621        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 15622          AND
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 287
* EL050.cbl
 15623***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 15624***       AND
 15625           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 15626            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 15627               MOVE ER-2773      TO WS-ERROR
 15628               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15629               GO TO 3999-END-EDIT
 15630            ELSE
 15631               GO TO 3999-END-EDIT
 15632          ELSE
 15633            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 15634               MOVE ER-2765      TO WS-ERROR
 15635               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15636               GO TO 3785-CHECK-NH.
 15637*              GO TO 3999-END-EDIT.
 15638
 15639 3780-UPDATE-CONT-2.
 15640
 15641     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 15642        AND WS-LF-BENEFIT-CD = ZERO
 15643           MOVE ER-2743           TO WS-ERROR
 15644           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15645
 15646     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 15647        AND WS-AH-BENEFIT-CD = ZERO
 15648           MOVE ER-2744           TO WS-ERROR
 15649           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15650
 15651     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 15652        (PB-C-AH-CANCEL-AMT NEGATIVE))
 15653        AND
 15654        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 15655         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 15656           MOVE ER-2746           TO WS-ERROR
 15657           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15658
 15659     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15660       AND
 15661        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 15662             MOVE ER-2737        TO WS-ERROR
 15663             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15664
 15665     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15666       AND
 15667        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 15668             MOVE ER-2737        TO WS-ERROR
 15669             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15670
 15671     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 15672         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 15673             OR 'CID' OR 'DCC'
 15674             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 15675         ELSE
 15676             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 15677                 MOVE ER-2768    TO WS-ERROR
 15678                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15679             ELSE
 15680                 MOVE ER-2756    TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 288
* EL050.cbl
 15681                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15682
 15683     IF CERT-PEND-ISSUE-RETURNED
 15684        MOVE ER-2772             TO WS-ERROR
 15685        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15686 3785-CHECK-NH.
 15687     IF PB-STATE NOT = 'NH'
 15688        GO TO 3999-END-EDIT
 15689     END-IF
 15690
 15691     MOVE ER-2796                TO WS-ERROR
 15692     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 15693     IF (PB-C-REF-INTERFACE-SW = 'Y')
 15694        OR (CM-NH-INTERFACE-SW = 'Y')
 15695        MOVE ER-2793             TO WS-ERROR
 15696        PERFORM 9900-ERROR-FORMAT
 15697                                 THRU 9900-EXIT
 15698     END-IF
 15699     MOVE +0                     TO WS-PAYMENT-AMT
 15700     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 15701        GO TO 3999-END-EDIT
 15702     END-IF
 15703     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 15704        GO TO 3999-END-EDIT
 15705     END-IF
 15706     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15707     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 15708     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 15709        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 15710     END-IF
 15711     MOVE '1'                    TO DC-OPTION-CODE
 15712     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 15713     IF NO-CONVERSION-ERROR
 15714        IF DC-ELAPSED-DAYS < +16
 15715           GO TO 3999-END-EDIT
 15716        END-IF
 15717     END-IF
 15718     MOVE +0                     TO DC-ELAPSED-DAYS
 15719     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 15720     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 15721     MOVE '1'                    TO DC-OPTION-CODE
 15722     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 15723     IF NO-CONVERSION-ERROR
 15724        IF DC-ELAPSED-DAYS > +30
 15725           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 15726        ELSE
 15727           GO TO 3999-END-EDIT
 15728        END-IF
 15729     ELSE
 15730        GO TO 3999-END-EDIT
 15731     END-IF
 15732     COMPUTE WS-PAYMENT-AMT ROUNDED =
 15733        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 15734           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 15735     IF WS-PAYMENT-AMT < 600.00
 15736        GO TO 3999-END-EDIT
 15737     END-IF
 15738     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 289
* EL050.cbl
 15739
 15740     IF (ERMAIL-FOUND = ' ')
 15741         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 15742         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 15743        GO TO 3999-END-EDIT
 15744     END-IF
 15745     MOVE ER-2795                TO WS-ERROR
 15746     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 15747
 15748     GO TO 3999-END-EDIT.
 15749******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 290
* EL050.cbl
 15751 3990-FILES-NOT-OPEN.
 15752
 15753     MOVE ER-2617                TO WS-ERROR.
 15754     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15755     GO TO 9990-RETURN.
 15756
 15757 3999-END-EDIT.
 15758
 15759     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 15760
 15761     IF PB-CANCELLATION AND CERT-WAS-FOUND
 15762         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 15763         IF CERTIFICATE-MASTER = ELCERT-SAVE
 15764             PERFORM 9250-UNLOCK-RETURN
 15765             GO TO 9990-RETURN
 15766          ELSE
 15767             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 15768             GO TO 9990-RETURN.
 15769
 15770     IF PB-CANCELLATION
 15771          GO TO 9990-RETURN.
 15772
 15773     IF CERT-WAS-NOT-FOUND
 15774        MOVE SPACES              TO CERTIFICATE-MASTER.
 15775
 15776     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 15777
 15778     IF CERT-WAS-FOUND
 15779         IF CERTIFICATE-MASTER = ELCERT-SAVE
 15780             PERFORM 9250-UNLOCK-RETURN
 15781          ELSE
 15782            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 15783      ELSE
 15784         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 15785
 15786     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 15787        IF PB-COMPANY-ID = 'DCC' AND
 15788           (PB-CARRIER = '2' OR '4' OR '6')
 15789              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 15790        END-IF
 15791     END-IF.
 15792
 15793     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 15794     IF ((PB-COMPANY-ID = 'DCC')
 15795        AND (WS-NO-SECURE-PAY))
 15796                  OR
 15797        (WS-LF-SPECIAL-CALC-CD = 'O'
 15798        OR WS-AH-SPECIAL-CALC-CD = 'O')
 15799        SET SKIP-ADDR-EDIT       TO TRUE
 15800     END-IF
 15801     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 15802        AND (NOT SKIP-ADDR-EDIT)
 15803        MOVE ER-2963             TO WS-ERROR
 15804        PERFORM 9900-ERROR-FORMAT
 15805                                 THRU 9900-EXIT
 15806        GO TO 9990-RETURN
 15807     END-IF
 15808     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 291
* EL050.cbl
 15809     IF ERPNDM-FOUND NOT = 'X'
 15810        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 15811           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 15812           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 15813           AND (NOT SKIP-ADDR-EDIT)
 15814           MOVE ER-2694          TO WS-ERROR
 15815           PERFORM 9900-ERROR-FORMAT
 15816                                 THRU 9900-EXIT
 15817        END-IF
 15818        MOVE ' '                 TO STATE-RECORD-ERROR
 15819        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 15820        MOVE PM-STATE            TO CNTL-ACCESS
 15821        MOVE '3'                 TO CNTL-REC-TYPE
 15822        MOVE +0                  TO CNTL-SEQ-NO
 15823        MOVE '0'                 TO RC-SW-2
 15824        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 15825        IF (NO-STATE-RECORD)
 15826           OR (CF-RECORD-TYPE NOT = '3')
 15827           OR (PM-STATE NOT = CF-STATE-CODE)
 15828           IF (PM-STATE = SPACES)
 15829              AND (SKIP-ADDR-EDIT)
 15830              CONTINUE
 15831           ELSE
 15832              MOVE ER-2963       TO WS-ERROR
 15833              PERFORM 9900-ERROR-FORMAT
 15834                                 THRU 9900-EXIT
 15835           END-IF
 15836        END-IF
 15837        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 15838           MOVE ER-2883          TO WS-ERROR
 15839           PERFORM 9900-ERROR-FORMAT
 15840                                 THRU 9900-EXIT
 15841        END-IF
 15842        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 15843           MOVE ' '                 TO STATE-RECORD-ERROR
 15844           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 15845           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 15846           MOVE '3'                 TO CNTL-REC-TYPE
 15847           MOVE +0                  TO CNTL-SEQ-NO
 15848           MOVE '0'                 TO RC-SW-2
 15849           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 15850           IF NO-STATE-RECORD
 15851              OR (CF-RECORD-TYPE NOT = '3')
 15852              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 15853              MOVE ER-2964          TO WS-ERROR
 15854              PERFORM 9900-ERROR-FORMAT
 15855                                    THRU 9900-EXIT
 15856           END-IF
 15857        END-IF
 15858     ELSE
 15859        IF NOT SKIP-ADDR-EDIT
 15860           MOVE ER-2393          TO WS-ERROR
 15861           PERFORM 9900-ERROR-FORMAT
 15862                                 THRU 9900-EXIT
 15863        END-IF
 15864     END-IF
 15865
 15866     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 292
* EL050.cbl
 15867
 15868     IF (ERMAIL-FOUND = ' ' AND
 15869        ERPNDM-FOUND = ' ')
 15870        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 15871           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 15872           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 15873          OR
 15874           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 15875          OR
 15876           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 15877           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 15878           GO TO 3999-UNLOCK-ERMAIL.
 15879
 15880     IF ERPNDM-FOUND = 'X'
 15881        GO TO 3999-UNLOCK-ERMAIL.
 15882
 15883     IF PM-INSURED-LAST-NAME      = SPACES
 15884        AND PM-INSURED-FIRST-NAME = SPACES
 15885        AND PM-ADDRESS-LINE-1     = SPACES
 15886        AND PM-ADDRESS-LINE-2     = SPACES
 15887        AND PM-CITY-STATE         = SPACES
 15888        AND PM-CRED-BENE-NAME     = SPACES
 15889        AND PM-CRED-BENE-ADDR     = SPACES
 15890        AND PM-CRED-BENE-CTYST    = SPACES
 15891        GO TO 3999-UNLOCK-ERMAIL
 15892     END-IF
 15893
 15894     MOVE SPACES                 TO MAILING-DATA.
 15895
 15896     MOVE 'MA'                   TO MA-RECORD-ID.
 15897     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 15898     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 15899     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 15900     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 15901     MOVE PB-SV-STATE            TO MA-STATE.
 15902     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 15903     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 15904
 15905     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 15906     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 15907
 15908     IF ERMAIL-FOUND = ' '
 15909        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 15910     ELSE
 15911        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 15912        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 15913        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 15914
 15915     GO TO 9990-RETURN.
 15916
 15917 3999-UNLOCK-ERMAIL.
 15918     IF ERMAIL-FOUND = ' '
 15919        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 15920
 15921     GO TO 9990-RETURN.
 15922******************************************************************
 15923
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 293
* EL050.cbl
 15925 4000-UPDATE-CANCELLED-CERT.
 15926     IF CERT-WAS-NOT-FOUND
 15927        GO TO 4299-EXIT.
 15928
 15929*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 15930     IF PB-C-NH-INT-ON-REFS > ZEROS
 15931        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 15932     END-IF
 15933     IF PB-C-REF-INTERFACE-SW = 'Y'
 15934        MOVE PB-C-REF-INTERFACE-SW
 15935                                 TO CM-NH-INTERFACE-SW
 15936     END-IF
 15937     IF PB-C-POST-CARD-IND = 'Y'
 15938        MOVE +8                  TO SUB
 15939        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 15940        IF ERMAIL-FOUND = ' '
 15941           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 15942              (SUB > +7)
 15943              OR (MA-MAIL-STATUS (SUB) = '1')
 15944           END-PERFORM
 15945        END-IF
 15946        IF (SUB > +7)
 15947           OR (ERMAIL-FOUND = 'X')
 15948           MOVE ER-3789          TO WS-ERROR
 15949           PERFORM 9900-ERROR-FORMAT
 15950                                 THRU 9900-EXIT
 15951        END-IF
 15952     ELSE
 15953        MOVE 'N'                 TO PB-C-POST-CARD-IND
 15954     END-IF
 15955     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 15956
 15957     IF PB-CI-OB-FLAG = 'Z'
 15958        GO TO 4150-SUMMARY-CERT-CANCEL.
 15959
 15960     IF PB-C-LF-CANCEL-VOIDED
 15961         PERFORM 4200-REVERSE-LF-CANCEL.
 15962     IF PB-C-AH-CANCEL-VOIDED
 15963         PERFORM 4200-REVERSE-AH-CANCEL.
 15964
 15965 4100-APPLY-LF-CANCEL.
 15966
 15967     MOVE +0                     TO WS-SUB.
 15968
 15969 4100-CHECK-LF-ERRORS.
 15970
 15971     ADD +1                       TO WS-SUB.
 15972
 15973     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 15974        IF LF-COVERAGE-CANCELLED
 15975           GO TO 4100-LF-CANCEL-CONT
 15976        ELSE
 15977           GO TO 4100-UPDATE-LF-COVERAGE.
 15978
 15979     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 15980                                   ER-2729 OR
 15981                                   ER-2730 OR
 15982                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 294
* EL050.cbl
 15983                                   ER-2732 OR
 15984                                   ER-2737 OR
 15985                                   ER-2740 OR
 15986                                   ER-2743 OR
 15987                                   ER-2749 OR
 15988                                   ER-2750 OR
 15989                                   ER-2755 OR
 15990                                   ER-2757 OR
 15991                                   ER-2760 OR
 15992                                   ER-2772 OR
 15993                                   ER-2774 OR
 15994                                   ER-2776 OR
 15995                                   ER-2794
 15996        GO TO 4100-UPDATE-LF-COVERAGE.
 15997
 15998     GO TO 4100-CHECK-LF-ERRORS.
 15999
 16000 4100-UPDATE-LF-COVERAGE.
 16001
 16002     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16003     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16004     MOVE PB-CI-LF-POLICY-STATUS      TO CM-LF-CURRENT-STATUS
 16005     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16006                                      TO CM-CREDIT-INTERFACE-SW-2.
 16007     IF CM-LF-CANCEL-DT = LOW-VALUE
 16008         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16009
 16010     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16011         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16012                                         CM-LF-STATUS-AT-CANCEL.
 16013
 16014     GO TO 4100-APPLY-AH-CANCEL.
 16015
 16016 4100-LF-CANCEL-CONT.
 16017     IF PB-C-LF-CANCEL-VOIDED
 16018         GO TO 4100-APPLY-AH-CANCEL.
 16019
 16020     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16021         GO TO 4100-APPLY-AH-CANCEL.
 16022
 16023     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16024        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16025           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16026        ELSE
 16027           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16028
 16029     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16030     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16031
 16032     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16033         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 16034
 16035     IF CM-LF-STATUS-AT-CANCEL = SPACE
 16036         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 16037         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 16038
 16039     IF PB-RECORD-RETURNED
 16040        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 295
* EL050.cbl
 16041      ELSE
 16042        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 16043
 16044 4100-APPLY-AH-CANCEL.
 16045
 16046     MOVE +0                      TO WS-SUB.
 16047
 16048 4100-CHECK-AH-ERRORS.
 16049
 16050     ADD +1                       TO WS-SUB.
 16051
 16052     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16053        IF AH-COVERAGE-CANCELLED
 16054           GO TO 4100-AH-CANCEL-CONT
 16055        ELSE
 16056           GO TO 4100-UPDATE-AH-COVERAGE.
 16057
 16058     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16059                                   ER-2729 OR
 16060                                   ER-2732 OR
 16061                                   ER-2737 OR
 16062                                   ER-2740 OR
 16063                                   ER-2744 OR
 16064                                   ER-2749 OR
 16065                                   ER-2750 OR
 16066                                   ER-2755 OR
 16067                                   ER-2757 OR
 16068                                   ER-2760 OR
 16069                                   ER-2771 OR
 16070                                   ER-2772 OR
 16071                                   ER-2773 OR
 16072                                   ER-2775 OR
 16073                                   ER-2777 OR
 16074                                   ER-2794
 16075        GO TO 4100-UPDATE-AH-COVERAGE.
 16076
 16077     GO TO 4100-CHECK-AH-ERRORS.
 16078
 16079 4100-UPDATE-AH-COVERAGE.
 16080
 16081     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 16082     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 16083     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 16084     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16085                                      TO CM-CREDIT-INTERFACE-SW-2.
 16086     IF CM-AH-CANCEL-DT = LOW-VALUE
 16087         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 16088
 16089     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 16090         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 16091                                         CM-AH-STATUS-AT-CANCEL.
 16092
 16093     IF LF-COVERAGE-CANCELLED
 16094         IF PB-RECORD-RETURNED
 16095              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 16096          ELSE
 16097              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 16098
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 296
* EL050.cbl
 16099     GO TO 4299-EXIT.
 16100
 16101 4100-AH-CANCEL-CONT.
 16102     IF PB-C-AH-CANCEL-VOIDED
 16103         GO TO 4299-EXIT.
 16104
 16105     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16106         GO TO 4299-EXIT.
 16107
 16108     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 16109        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16110           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 16111        ELSE
 16112           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 16113
 16114     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 16115     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 16116
 16117     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 16118         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 16119
 16120     IF CM-AH-STATUS-AT-CANCEL = SPACE
 16121         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 16122         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 16123
 16124     IF PB-RECORD-RETURNED
 16125        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 16126      ELSE
 16127        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 16128
 16129     GO TO 4299-EXIT.
 16130
 16131 4150-SUMMARY-CERT-CANCEL.
 16132     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 16133
 16134     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16135        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16136                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 16137     ELSE
 16138        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16139                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 16140
 16141     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16142        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16143                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 16144     ELSE
 16145        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16146                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 16147
 16148     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16149        NEXT SENTENCE
 16150     ELSE
 16151        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 16152
 16153     GO TO 4299-EXIT.
 16154
 16155 4200-REVERSE-LF-CANCEL.
 16156     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 297
* EL050.cbl
 16157
 16158     IF CM-LF-CANCEL-APPLIED
 16159        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 16160        MOVE SPACES                TO CM-LF-EXIT-BATCH
 16161        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 16162
 16163     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 16164
 16165     IF PB-RECORD-RETURNED
 16166        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16167       ELSE
 16168        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16169
 16170 4200-REVERSE-LF-EXIT.
 16171       EXIT.
 16172
 16173 4200-REVERSE-AH-CANCEL.
 16174     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 16175
 16176     IF CM-AH-CANCEL-APPLIED
 16177        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 16178        MOVE SPACES                TO CM-AH-EXIT-BATCH
 16179        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 16180
 16181     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 16182
 16183     IF PB-RECORD-RETURNED
 16184        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16185       ELSE
 16186        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16187
 16188 4200-REVERSE-AH-EXIT.
 16189       EXIT.
 16190
 16191 4299-EXIT.
 16192       EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 298
* EL050.cbl
 16194
 16195 4500-UPDATE-NEW-CERT.
 16196     IF CERT-WAS-FOUND
 16197         NEXT SENTENCE
 16198       ELSE
 16199         GO TO 4520-BUILD-NEW-KEY.
 16200
 16201     IF  CLASIC-CREATED-CERT
 16202         GO TO 4999-EXIT.
 16203
 16204     IF  CERT-WAS-CREATED-FOR-CLAIM
 16205         GO TO 4520-BUILD-NEW-KEY.
 16206
 16207     IF CERT-ADDED-BATCH
 16208        IF CM-RECORD-ID = 'CM'
 16209            GO TO 4999-EXIT.
 16210
 16211 4520-BUILD-NEW-KEY.
 16212* BUILD CONTROL PRIMARY
 16213
 16214     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 16215                                       CM-COMPANY-CD-A1
 16216                                       CM-COMPANY-CD-A2
 16217                                       CM-COMPANY-CD-A4
 16218                                       CM-COMPANY-CD-A5.
 16219
 16220     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 16221     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 16222     MOVE PB-SV-STATE               TO CM-STATE.
 16223     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 16224     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 16225     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 16226     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 16227
 16228     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 16229
 16230     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 16231     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 16232     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 16233     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 16234
 16235     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 16236        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 16237
 16238     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 16239         MOVE PB-SV-STATE            TO CM-SSN-STATE
 16240         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 16241         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 16242         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 16243     ELSE
 16244         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 16245
 16246     IF PB-COMPANY-ID   EQUAL  'CRI'
 16247         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 16248         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 16249         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 16250         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 16251         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 299
* EL050.cbl
 16252
 16253     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 16254        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 16255         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 16256
 16257     IF PB-COMPANY-ID  = 'LBL'
 16258        IF PB-I-JOINT-COVERAGE
 16259            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 16260                                           PB-I-MEMBER-NO
 16261            GO TO 4550-CONT-CERT-PROCESS.
 16262
 16263     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 16264        NEXT SENTENCE
 16265     ELSE
 16266        GO TO 4540-BUILD-MEMBER-NO.
 16267
 16268******************************************************************
 16269*                                                                *
 16270*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 16271*    FOR 'MON'.                                                  *
 16272*                                                                *
 16273******************************************************************
 16274
 16275     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 16276     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 16277     MOVE +1                     TO WS-SUB1
 16278                                    WS-SUB2.
 16279
 16280 4530-EDIT-MEMB-NAME.
 16281
 16282     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 16283        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 16284        ADD +1                       TO WS-SUB2.
 16285
 16286     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 16287        ADD +1                       TO WS-SUB1
 16288        GO TO 4530-EDIT-MEMB-NAME.
 16289
 16290     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 16291     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 16292     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 16293*    MOVE SPACE                      TO DC-OPTION-CODE.
 16294     SET  BIN-TO-GREG                TO TRUE.
 16295     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16296     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 16297
 16298     GO TO 4550-CONT-CERT-PROCESS.
 16299
 16300******************************************************************
 16301*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 16302******************************************************************
 16303
 16304 4540-BUILD-MEMBER-NO.
 16305
 16306     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 16307         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 16308         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 16309         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 300
* EL050.cbl
 16310         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 16311     ELSE
 16312         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 16313
 16314     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 16315        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 16316         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 16317
 16318 4550-CONT-CERT-PROCESS.
 16319
 16320*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 16321*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 16322*    ELSE
 16323*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 16324
 16325     IF CERT-WAS-CREATED-FOR-CLAIM
 16326        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 16327        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 16328
 16329     IF CERT-AND-CLAIM-ONLINE
 16330        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 16331        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 16332
 16333     MOVE 'CM'                     TO CM-RECORD-ID.
 16334     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 16335
 16336     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 16337        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 16338        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 16339     ELSE
 16340        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 16341        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 16342
 16343     MOVE ZERO                     TO CM-LOAN-BALANCE.
 16344     MOVE '1'                      TO CM-PREMIUM-TYPE.
 16345     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 16346     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 16347     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 16348     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 16349     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 16350                                      CM-LF-ITD-CANCEL-AMT
 16351                                      CM-LF-ITD-DEATH-AMT
 16352                                      CM-AH-ITD-AH-PMT
 16353                                      CM-AH-ITD-LUMP-PMT
 16354                                      CM-AH-ITD-CANCEL-AMT
 16355                                      CM-LF-NSP-PREMIUM-AMT
 16356                                      CM-AH-NSP-PREMIUM-AMT.
 16357*                                     CM-CLAIM-DEDUCT-WITHHELD
 16358*                                     CM-CANCEL-DEDUCT-WITHHELD.
 16359     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 16360     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 16361     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 16362     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 16363     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 16364     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 16365     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 16366     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 16367     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 301
* EL050.cbl
 16368     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 16369     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 16370     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 16371
 16372     IF PB-I-LIVES NOT NUMERIC
 16373         MOVE ZERO                 TO PB-I-LIVES.
 16374
 16375     IF PB-I-NUM-BILLED NOT NUMERIC
 16376         MOVE ZERO                 TO PB-I-NUM-BILLED.
 16377
 16378     MOVE PB-I-LIVES               TO CM-LIVES.
 16379     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 16380
 16381     IF PB-COMPANY-ID EQUAL  'DMD'
 16382         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 16383         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 16384
 16385     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 16386     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 16387     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 16388     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 16389     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 16390     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 16391
 16392     IF PB-I-LF-POLICY-FEE NUMERIC
 16393        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 16394     ELSE
 16395        MOVE +0                    TO CM-LF-POLICY-FEE.
 16396
 16397     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16398        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 16399        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 16400     ELSE
 16401        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 16402
 16403     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 16404     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 16405     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 16406     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 16407     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 16408     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 16409     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 16410     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 16411     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 16412
 16413     IF PB-I-AH-POLICY-FEE NUMERIC
 16414        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 16415     ELSE
 16416        MOVE +0                    TO CM-AH-POLICY-FEE.
 16417
 16418     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16419        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 16420     ELSE
 16421        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 16422
 16423     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 16424     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 16425
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 302
* EL050.cbl
 16426     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 16427                                      CM-LF-DEATH-EXIT-DT
 16428                                      CM-AH-SETTLEMENT-EXIT-DT.
 16429
 16430*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 16431*                       'TIH' OR 'OFL' OR 'FLA' OR
 16432*                       'TII' OR 'TMS' OR 'CRI' OR
 16433*                       'NCL'
 16434     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 16435
 16436     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 16437         IF WS-LF-SPECIAL-CALC-CD = 'O'
 16438            MOVE '2'                TO CM-PREMIUM-TYPE.
 16439
 16440     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 16441         IF WS-AH-SPECIAL-CALC-CD = 'O'
 16442            MOVE '2'                TO CM-PREMIUM-TYPE.
 16443
 16444     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16445         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 16446     ELSE
 16447         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 16448         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 16449
 16450     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 16451     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 16452     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 16453     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 16454     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 16455     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 16456     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 16457     MOVE SPACE                     TO CM-PAYMENT-MODE.
 16458
 16459     IF PB-NO-MONTHS-SKIPPED
 16460         MOVE SPACE                 TO CM-SKIP-CODE
 16461     ELSE
 16462         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 16463
 16464     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 16465     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 16466                                       CM-LF-STATUS-AT-CANCEL.
 16467
 16468     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 16469     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 16470                                       CM-AH-STATUS-AT-CANCEL.
 16471
 16472     MOVE '1'                       TO CM-ENTRY-STATUS.
 16473
 16474     IF PB-REISSUED-CERT
 16475        MOVE '5'                    TO CM-ENTRY-STATUS.
 16476
 16477     IF PB-MONTHLY-CERT
 16478        MOVE 'M'                    TO CM-ENTRY-STATUS.
 16479
 16480     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 16481     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 16482     IF PB-POLICY-IS-DECLINED
 16483        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 303
* EL050.cbl
 16484
 16485     IF PB-POLICY-IS-VOIDED
 16486        MOVE 'V'                    TO CM-ENTRY-STATUS.
 16487
 16488     IF PB-NEEDS-UNDERWRITING
 16489        MOVE 'U'                    TO CM-ENTRY-STATUS.
 16490
 16491     IF PB-REIN-ONLY-CERT
 16492        MOVE '9'                    TO CM-ENTRY-STATUS.
 16493
 16494     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 16495         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 16496     ELSE
 16497         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 16498
 16499     IF PB-RECORD-RETURNED
 16500        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 16501      ELSE
 16502        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 16503
 16504     IF PB-I-MAIL-ADDRS-PRESENT
 16505        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 16506
 16507     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 16508                                       CM-ENTRY-DT.
 16509
 16510 4999-EXIT.
 16511     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 304
* EL050.cbl
 16513
 16514 5000-PROCESS-REPS.
 16515     MOVE ' '                    TO AGTC-MASTER-SW
 16516     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 16517     MOVE CO-TYPE                TO AGTC-TYPE
 16518     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 16519     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 16520     IF (AGTC-MASTER-SW NOT = 'N')
 16521        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 16522        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 16523        PERFORM 8583-READ-ERAGTC-NEXT
 16524                                 THRU 8583-EXIT
 16525     END-IF
 16526     IF AGTC-MASTER-SW = 'N'
 16527        CONTINUE
 16528     ELSE
 16529        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 16530           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 16531              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 16532              MOVE 'Y'           TO AGTC-MASTER-SW
 16533           END-IF
 16534        END-IF
 16535     END-IF
 16536     .
 16537 5000-EXIT.
 16538     EXIT.
 16539 6370-EDIT-INPUT-LF-CODE.
 16540     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 16541        MOVE +1                  TO SUB
 16542        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 16543        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 16544        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 16545        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 16546        GO TO 6370-SEARCH-LOOP.
 16547
 16548     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 16549
 16550     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 16551     MOVE SPACES                 TO CNTL-ACCESS.
 16552*    MOVE 'L'                    TO CNTL-REC-TYPE.
 16553     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 16554     MOVE +0                     TO CNTL-SEQ-NO.
 16555     MOVE '4' TO RC-SW-2.
 16556     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 16557
 16558     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 16559        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 16560        GO TO 6370-NO-LF-FOUND.
 16561
 16562     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 16563     MOVE +1                     TO SUB.
 16564
 16565 6370-SEARCH-LOOP.
 16566     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 16567         GO TO 6370-NO-LF-FOUND.
 16568
 16569     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 16570         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 305
* EL050.cbl
 16571         GO TO 6370-HER-NET-PAY-CHECK.
 16572
 16573     ADD 1   TO SUB.
 16574*    IF SUB GREATER 120
 16575     IF SUB GREATER 200
 16576         GO TO 6370-NO-LF-FOUND.
 16577
 16578     GO TO 6370-SEARCH-LOOP.
 16579
 16580 6370-NO-LF-FOUND.
 16581
 16582     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 16583
 16584 6370-HER-NET-PAY-CHECK.
 16585
 16586     IF PB-COMPANY-ID = 'CID'
 16587        IF PB-SV-STATE = 'CA' OR 'MN'
 16588           IF PB-I-LF-BENEFIT-CD = '02'
 16589              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 16590           ELSE
 16591              IF PB-I-LF-BENEFIT-CD = '04'
 16592                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 16593              END-IF
 16594           END-IF
 16595        END-IF
 16596     END-IF
 16597
 16598     IF PB-COMPANY-ID NOT = 'HER'
 16599         GO TO 6370-EXIT.
 16600
 16601     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 16602         GO TO 6370-EXIT.
 16603
 16604     IF PB-I-LF-TERM NOT NUMERIC
 16605         MOVE ZEROS              TO PB-I-LF-TERM.
 16606
 16607     IF PB-I-LOAN-TERM NOT NUMERIC
 16608         MOVE ZEROS              TO PB-I-LOAN-TERM.
 16609
 16610     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 16611         GO TO 6370-EXIT.
 16612
 16613     IF PB-I-LF-BENEFIT-CD = '33'
 16614         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 16615
 16616     IF PB-I-LF-BENEFIT-CD = '34'
 16617         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 16618
 16619 6370-EXIT.
 16620     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 306
* EL050.cbl
 16622
 16623 6380-EDIT-INPUT-AH-CODE.
 16624     IF WK-AH-EDIT-ADDR NOT = ZEROS
 16625        MOVE +1                  TO SUB
 16626        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 16627        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 16628        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 16629        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 16630        GO TO 6380-SEARCH-LOOP.
 16631
 16632     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 16633
 16634     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 16635     MOVE SPACES                 TO CNTL-ACCESS.
 16636     MOVE 'A'                    TO CNTL-REC-TYPE.
 16637*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 16638     MOVE +0                     TO CNTL-SEQ-NO.
 16639     MOVE '5' TO RC-SW-2.
 16640     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 16641
 16642     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 16643        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 16644        GO TO 6380-NO-AH-FOUND.
 16645
 16646     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 16647     MOVE +1 TO SUB.
 16648
 16649 6380-SEARCH-LOOP.
 16650     IF CF-AH-CODE-OUT (SUB) = ZEROS
 16651         GO TO 6380-NO-AH-FOUND.
 16652
 16653     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 16654         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 16655         GO TO 6380-CSO-AH-ONLY-CHECKS.
 16656
 16657     ADD 1   TO SUB.
 16658     IF SUB GREATER THAN 96
 16659*    IF SUB GREATER THAN 300
 16660         GO TO 6380-NO-AH-FOUND.
 16661
 16662     GO TO 6380-SEARCH-LOOP.
 16663
 16664 6380-NO-AH-FOUND.
 16665
 16666     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 16667
 16668     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 16669         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 16670     ELSE
 16671         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 16672
 16673 6380-CSO-AH-ONLY-CHECKS.
 16674
 16675     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 16676        NEXT SENTENCE
 16677      ELSE
 16678        GO TO 6380-EXIT.
 16679
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 307
* EL050.cbl
 16680     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 16681         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 16682
 16683
 16684     GO TO 6380-EXIT
 16685     .
 16686 6380-CSO-LIFE-WITH-AH-CHECKS.
 16687
 16688
 16689     .
 16690 6380-EXIT.
 16691     EXIT.
 16692
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 308
* EL050.cbl
 16694
 16695 6400-COMPUTE-EXTENSION-DAYS.
 16696
 16697******************************************************************
 16698*                                                                *
 16699*                   COMPUTE EXTENSION DAYS                       *
 16700*                                                                *
 16701*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 16702*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 16703*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 16704*    THE EXTENSION DAYS.                                         *
 16705*                                                                *
 16706******************************************************************
 16707
 16708     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 16709     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 16710
 16711******************************************************************
 16712*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 16713*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 16714******************************************************************
 16715
 16716     IF DC-ELAPSED-MONTHS GREATER THAN +0
 16717        COMPUTE WS-ODD-DAYS-OVER =
 16718               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 16719     ELSE
 16720        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 16721
 16722     IF WS-ODD-DAYS-OVER = ZEROS
 16723           GO TO 6499-EXIT
 16724     ELSE
 16725        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 16726           IF WS-WDF-MONTH = 02
 16727              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 16728              ADD 2       TO  WS-ODD-DAYS-OVER
 16729              GO TO 6499-EXIT
 16730           ELSE
 16731              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 16732                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 16733                 GO TO 6499-EXIT
 16734               ELSE
 16735                 GO TO 6499-EXIT
 16736        ELSE
 16737           GO TO 6499-EXIT.
 16738
 16739 6412-CHECK-TO-DAY.
 16740
 16741        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 16742           IF WS-WDT-DAY = 28
 16743              ADD 2              TO WS-ODD-DAYS-OVER
 16744           ELSE
 16745              IF WS-WDT-DAY = 29
 16746                 ADD 1           TO WS-ODD-DAYS-OVER
 16747              ELSE
 16748                 NEXT SENTENCE
 16749        ELSE
 16750           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 16751              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 309
* EL050.cbl
 16752
 16753     GO TO 6499-EXIT.
 16754
 16755
 16756 6415-CHECK-LEAP-YEAR.
 16757
 16758     IF DC-DAYS-IN-MONTH = 29
 16759        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 16760
 16761 6415-EXIT.
 16762     EXIT.
 16763
 16764 6499-EXIT.
 16765      EXIT.
 16766
 16767 6500-END.
 16768     EXIT.
 16769
 16770
 16771******************************************************************
 16772************* PROCEDURE DIVISION FOR EL050 ***********************
 16773********************** ELC50PD END *******************************
 16774
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 310
* EL050.cbl
 16776
 16777**START***********************************************************
 16778*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 16779*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 16780******************************************************************
 16781*
 16782 6600-GET-STATE-MUNICIPAL-TAX.
 16783
 16784     IF PB-COMPANY-ID NOT = 'DMD'
 16785         GO TO 6640-EXIT.
 16786
 16787     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 16788     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 16789     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 16790*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 16791*
 16792***  Y2K PROJ 7744
 16793     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 16794     SET BIN-TO-GREG          TO TRUE.
 16795     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16796
 16797     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 16798
 16799     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 16800     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 16801
 16802
 16803* EXEC CICS HANDLE CONDITION
 16804*        INVREQ    (6610-START-BROWSE)
 16805*        NOTOPEN   (6630-ERRESS-PROBLEM)
 16806*        NOTFND    (6630-END-OF-FILE)
 16807*    END-EXEC.
 16808*    MOVE '"$8JI                 ! # #00016790' TO DFHEIV0
 16809     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 16810     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16811     MOVE X'2320233030303136373930' TO DFHEIV0(25:11)
 16812     CALL 'kxdfhei1' USING DFHEIV0
 16813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16814
 16815
 16816 6610-START-BROWSE.
 16817
 16818
 16819* EXEC CICS HANDLE CONDITION
 16820*        NOTFND    (6630-END-OF-FILE)
 16821*        DISABLED  (6630-ERRESS-PROBLEM)
 16822*        NOTOPEN   (6630-ERRESS-PROBLEM)
 16823*        ENDFILE   (6630-END-OF-FILE)
 16824*    END-EXEC.
 16825*    MOVE '"$IcJ''                ! $ #00016798' TO DFHEIV0
 16826     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 16827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16828     MOVE X'2420233030303136373938' TO DFHEIV0(25:11)
 16829     CALL 'kxdfhei1' USING DFHEIV0
 16830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16831
 16832
 16833
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 311
* EL050.cbl
 16834* EXEC CICS STARTBR
 16835*        DATASET (FILE-ID-ERRESS)
 16836*        RIDFLD  (WS-ERRESS-KEY)
 16837*        GTEQ
 16838*    END-EXEC.
 16839     MOVE 0
 16840       TO DFHEIV11
 16841*    MOVE '&,         G          &   #00016805' TO DFHEIV0
 16842     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16843     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16844     MOVE X'2020233030303136383035' TO DFHEIV0(25:11)
 16845     CALL 'kxdfhei1' USING DFHEIV0,
 16846           FILE-ID-ERRESS,
 16847           WS-ERRESS-KEY,
 16848           DFHEIV99,
 16849           DFHEIV11,
 16850           DFHEIV99
 16851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16852
 16853
 16854 6620-READ-NEXT-ERRESS-MASTER.
 16855
 16856
 16857* EXEC CICS HANDLE CONDITION
 16858*        NOTFND    (6630-END-OF-FILE)
 16859*        ENDFILE   (6630-END-OF-FILE)
 16860*        DISABLED  (6630-ERRESS-PROBLEM)
 16861*        NOTOPEN   (6630-ERRESS-PROBLEM)
 16862*    END-EXEC.
 16863*    MOVE '"$I''cJ                ! % #00016813' TO DFHEIV0
 16864     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 16865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16866     MOVE X'2520233030303136383133' TO DFHEIV0(25:11)
 16867     CALL 'kxdfhei1' USING DFHEIV0
 16868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16869
 16870
 16871
 16872* EXEC CICS READNEXT
 16873*        DATASET (FILE-ID-ERRESS)
 16874*        INTO    (RESIDENT-STATE-TAX-MASTER)
 16875*        RIDFLD  (WS-ERRESS-KEY)
 16876*    END-EXEC.
 16877     MOVE LENGTH OF
 16878      RESIDENT-STATE-TAX-MASTER
 16879       TO DFHEIV12
 16880     MOVE 0
 16881       TO DFHEIV11
 16882*    MOVE '&.IL                  )   #00016820' TO DFHEIV0
 16883     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 16884     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16885     MOVE X'2020233030303136383230' TO DFHEIV0(25:11)
 16886     CALL 'kxdfhei1' USING DFHEIV0,
 16887           FILE-ID-ERRESS,
 16888           RESIDENT-STATE-TAX-MASTER,
 16889           DFHEIV12,
 16890           WS-ERRESS-KEY,
 16891           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 312
* EL050.cbl
 16892           DFHEIV11,
 16893           DFHEIV99,
 16894           DFHEIV99
 16895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16896
 16897
 16898     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 16899
 16900* EXEC CICS ENDBR
 16901*            DATASET (FILE-ID-ERRESS)
 16902*       END-EXEC
 16903     MOVE 0
 16904       TO DFHEIV11
 16905*    MOVE '&2                    $   #00016827' TO DFHEIV0
 16906     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16907     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16908     MOVE X'2020233030303136383237' TO DFHEIV0(25:11)
 16909     CALL 'kxdfhei1' USING DFHEIV0,
 16910           FILE-ID-ERRESS,
 16911           DFHEIV11,
 16912           DFHEIV99
 16913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16914        GO TO 6630-END-OF-FILE.
 16915
 16916     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 16917        NEXT SENTENCE
 16918      ELSE
 16919        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 16920
 16921*IS IT LIFE(1) OR IS IT P&C(2) ?????
 16922*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 16923*
 16924     MOVE +2                     TO WS-SUB1.
 16925
 16926     IF PB-ISSUE
 16927     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 16928        MOVE +1                  TO WS-SUB1.
 16929
 16930     IF PB-CANCELLATION
 16931     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 16932        MOVE +1                  TO WS-SUB1.
 16933*
 16934*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 16935*
 16936***  Y2K PROJ 7744
 16937     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 16938***  Y2K PROJ 7744
 16939
 16940*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 16941* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 16942* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 16943
 16944     ADD 1                    TO WS-YEAR-YY.
 16945
 16946     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 16947         MOVE RES-REN-STATE-TAX (WS-SUB1)
 16948                              TO WS-RES-STATE-TAX
 16949         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 313
* EL050.cbl
 16950                              TO WS-RES-MUNI-TAX
 16951     ELSE
 16952         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 16953                              TO WS-RES-STATE-TAX
 16954         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 16955                              TO WS-RES-MUNI-TAX.
 16956
 16957*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 16958
 16959     IF PB-CANCELLATION
 16960         GO TO 6640-CANCEL-TAX.
 16961
 16962     IF PB-I-LF-PREMIUM-AMT > ZEROS
 16963         COMPUTE PB-I-STATE-TAX ROUNDED =
 16964                                   PB-I-LF-PREMIUM-AMT
 16965                                 * WS-RES-STATE-TAX
 16966         COMPUTE PB-I-MUNI-TAX ROUNDED =
 16967                                   PB-I-LF-PREMIUM-AMT
 16968                                 * WS-RES-MUNI-TAX
 16969     ELSE
 16970     IF PB-I-AH-PREMIUM-AMT > ZEROS
 16971         COMPUTE PB-I-STATE-TAX ROUNDED =
 16972                                   PB-I-AH-PREMIUM-AMT
 16973                                 * WS-RES-STATE-TAX
 16974         COMPUTE PB-I-MUNI-TAX ROUNDED =
 16975                                   PB-I-AH-PREMIUM-AMT
 16976                                 * WS-RES-MUNI-TAX.
 16977
 16978
 16979* EXEC CICS ENDBR
 16980*         DATASET (FILE-ID-ERRESS)
 16981*    END-EXEC.
 16982     MOVE 0
 16983       TO DFHEIV11
 16984*    MOVE '&2                    $   #00016894' TO DFHEIV0
 16985     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16986     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16987     MOVE X'2020233030303136383934' TO DFHEIV0(25:11)
 16988     CALL 'kxdfhei1' USING DFHEIV0,
 16989           FILE-ID-ERRESS,
 16990           DFHEIV11,
 16991           DFHEIV99
 16992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16993
 16994
 16995     GO TO 6640-EXIT.
 16996
 16997 6640-CANCEL-TAX.
 16998     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 16999
 17000     IF PB-C-LF-CANCEL-AMT > ZEROS
 17001         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17002                                   PB-C-LF-CANCEL-AMT
 17003                                 * WS-RES-STATE-TAX
 17004         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17005                                   PB-C-LF-CANCEL-AMT
 17006                                *  WS-RES-MUNI-TAX
 17007     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 314
* EL050.cbl
 17008     IF PB-C-AH-CANCEL-AMT > ZEROS
 17009         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17010                                   PB-C-AH-CANCEL-AMT
 17011                                 * WS-RES-STATE-TAX
 17012         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17013                                   PB-C-AH-CANCEL-AMT
 17014                                *  WS-RES-MUNI-TAX.
 17015
 17016
 17017* EXEC CICS ENDBR
 17018*         DATASET (FILE-ID-ERRESS)
 17019*    END-EXEC.
 17020     MOVE 0
 17021       TO DFHEIV11
 17022*    MOVE '&2                    $   #00016919' TO DFHEIV0
 17023     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17024     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17025     MOVE X'2020233030303136393139' TO DFHEIV0(25:11)
 17026     CALL 'kxdfhei1' USING DFHEIV0,
 17027           FILE-ID-ERRESS,
 17028           DFHEIV11,
 17029           DFHEIV99
 17030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17031
 17032
 17033     GO TO 6640-EXIT.
 17034
 17035 6630-END-OF-FILE.
 17036     MOVE ER-8002              TO WS-ERROR.
 17037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17038
 17039     GO TO 6640-EXIT.
 17040
 17041 6630-ERRESS-PROBLEM.
 17042     MOVE ER-8044              TO WS-ERROR.
 17043     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17044
 17045 6640-EXIT.
 17046     EXIT.
 17047
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 315
* EL050.cbl
 17049 6650-GET-RES-STATE-COMM.
 17050
 17051     IF PB-COMPANY-ID NOT = 'DMD'
 17052         GO TO 6700-COMM-EXIT.
 17053
 17054     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 17055     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 17056     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 17057     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 17058     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 17059     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 17060     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 17061
 17062*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 17063*
 17064***  Y2K PROJ 7744
 17065     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17066     SET BIN-TO-GREG          TO TRUE.
 17067     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17068
 17069     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17070***  Y2K PROJ 7744
 17071
 17072     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 17073
 17074
 17075* EXEC CICS HANDLE CONDITION
 17076*        INVREQ    (6660-START-BROWSE)
 17077*        DISABLED  (6690-ERRESC-PROBLEM)
 17078*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17079*        NOTFND    (6690-END-OF-FILE)
 17080*    END-EXEC.
 17081*    MOVE '"$8cJI                ! & #00016964' TO DFHEIV0
 17082     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 17083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17084     MOVE X'2620233030303136393634' TO DFHEIV0(25:11)
 17085     CALL 'kxdfhei1' USING DFHEIV0
 17086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17087
 17088
 17089
 17090* EXEC CICS RESETBR
 17091*        DATASET (FILE-ID-ERRESC)
 17092*        RIDFLD  (WS-ERRESC-KEY)
 17093*    END-EXEC.
 17094     MOVE 0
 17095       TO DFHEIV11
 17096*    MOVE '&4         G          &   #00016971' TO DFHEIV0
 17097     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17098     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17099     MOVE X'2020233030303136393731' TO DFHEIV0(25:11)
 17100     CALL 'kxdfhei1' USING DFHEIV0,
 17101           FILE-ID-ERRESC,
 17102           WS-ERRESC-KEY,
 17103           DFHEIV99,
 17104           DFHEIV11,
 17105           DFHEIV99
 17106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 316
* EL050.cbl
 17107
 17108
 17109 6660-START-BROWSE.
 17110
 17111
 17112* EXEC CICS HANDLE CONDITION
 17113*        NOTFND    (6690-END-OF-FILE)
 17114*        DISABLED  (6690-ERRESC-PROBLEM)
 17115*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17116*        ENDFILE   (6690-END-OF-FILE)
 17117*    END-EXEC.
 17118*    MOVE '"$IcJ''                ! '' #00016978' TO DFHEIV0
 17119     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17121     MOVE X'2720233030303136393738' TO DFHEIV0(25:11)
 17122     CALL 'kxdfhei1' USING DFHEIV0
 17123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17124
 17125
 17126
 17127* EXEC CICS STARTBR
 17128*        DATASET (FILE-ID-ERRESC)
 17129*        RIDFLD  (WS-ERRESC-KEY)
 17130*        GTEQ
 17131*    END-EXEC.
 17132     MOVE 0
 17133       TO DFHEIV11
 17134*    MOVE '&,         G          &   #00016985' TO DFHEIV0
 17135     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17136     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17137     MOVE X'2020233030303136393835' TO DFHEIV0(25:11)
 17138     CALL 'kxdfhei1' USING DFHEIV0,
 17139           FILE-ID-ERRESC,
 17140           WS-ERRESC-KEY,
 17141           DFHEIV99,
 17142           DFHEIV11,
 17143           DFHEIV99
 17144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17145
 17146
 17147     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 17148
 17149 6670-READ-NEXT-ERRESC-MASTER.
 17150
 17151
 17152* EXEC CICS HANDLE CONDITION
 17153*        NOTFND    (6690-END-OF-FILE)
 17154*        DISABLED  (6690-ERRESC-PROBLEM)
 17155*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17156*        ENDFILE   (6690-END-OF-FILE)
 17157*    END-EXEC.
 17158*    MOVE '"$IcJ''                ! ( #00016995' TO DFHEIV0
 17159     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17160     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17161     MOVE X'2820233030303136393935' TO DFHEIV0(25:11)
 17162     CALL 'kxdfhei1' USING DFHEIV0
 17163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17164
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 317
* EL050.cbl
 17165
 17166
 17167* EXEC CICS READNEXT
 17168*        DATASET (FILE-ID-ERRESC)
 17169*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 17170*        RIDFLD  (ERRESC-RECORD-KEY)
 17171*    END-EXEC.
 17172     MOVE LENGTH OF
 17173      ACCOUNT-RESIDENT-ST-COMMISSION
 17174       TO DFHEIV12
 17175     MOVE 0
 17176       TO DFHEIV11
 17177*    MOVE '&.IL                  )   #00017002' TO DFHEIV0
 17178     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17179     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17180     MOVE X'2020233030303137303032' TO DFHEIV0(25:11)
 17181     CALL 'kxdfhei1' USING DFHEIV0,
 17182           FILE-ID-ERRESC,
 17183           ACCOUNT-RESIDENT-ST-COMMISSION,
 17184           DFHEIV12,
 17185           ERRESC-RECORD-KEY,
 17186           DFHEIV99,
 17187           DFHEIV11,
 17188           DFHEIV99,
 17189           DFHEIV99
 17190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17191
 17192
 17193     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 17194        NEXT SENTENCE
 17195     ELSE
 17196
 17197* EXEC CICS ENDBR
 17198*            DATASET (FILE-ID-ERRESC)
 17199*       END-EXEC
 17200     MOVE 0
 17201       TO DFHEIV11
 17202*    MOVE '&2                    $   #00017011' TO DFHEIV0
 17203     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17204     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17205     MOVE X'2020233030303137303131' TO DFHEIV0(25:11)
 17206     CALL 'kxdfhei1' USING DFHEIV0,
 17207           FILE-ID-ERRESC,
 17208           DFHEIV11,
 17209           DFHEIV99
 17210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17211        GO TO 6690-END-OF-FILE.
 17212
 17213     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 17214
 17215* EXEC CICS ENDBR
 17216*            DATASET (FILE-ID-ERRESC)
 17217*       END-EXEC
 17218     MOVE 0
 17219       TO DFHEIV11
 17220*    MOVE '&2                    $   #00017017' TO DFHEIV0
 17221     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17222     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 318
* EL050.cbl
 17223     MOVE X'2020233030303137303137' TO DFHEIV0(25:11)
 17224     CALL 'kxdfhei1' USING DFHEIV0,
 17225           FILE-ID-ERRESC,
 17226           DFHEIV11,
 17227           DFHEIV99
 17228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17229        GO TO 6690-END-OF-FILE.
 17230
 17231     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 17232        NEXT SENTENCE
 17233      ELSE
 17234        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 17235
 17236* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 17237*
 17238     MOVE ZEROS               TO WS-SUB WS-SUB1.
 17239
 17240     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 17241
 17242     IF WS-SUB1 > ZERO
 17243         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 17244             PERFORM 6680-SET-COMMISSION
 17245         ELSE
 17246             PERFORM 6680-SET-TABLE-CODE.
 17247
 17248
 17249* EXEC CICS ENDBR
 17250*         DATASET (FILE-ID-ERRESC)
 17251*    END-EXEC.
 17252     MOVE 0
 17253       TO DFHEIV11
 17254*    MOVE '&2                    $   #00017039' TO DFHEIV0
 17255     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17256     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17257     MOVE X'2020233030303137303339' TO DFHEIV0(25:11)
 17258     CALL 'kxdfhei1' USING DFHEIV0,
 17259           FILE-ID-ERRESC,
 17260           DFHEIV11,
 17261           DFHEIV99
 17262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17263
 17264
 17265     GO TO 6700-COMM-EXIT.
 17266
 17267 6680-SET-TABLE-CODE.
 17268     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 17269        MOVE ZEROS             TO WS-SUB1
 17270     ELSE
 17271* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 17272* TO COMPUTE AH COMMISSION.
 17273        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 17274        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 17275        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 17276        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 17277        PERFORM 6680-READ-CTBL-TABLE
 17278        IF WS-CTBL-READ-SW NOT = 'Y'
 17279           MOVE ZEROS          TO WS-SUB1.
 17280
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 319
* EL050.cbl
 17281 6680-READ-CTBL-TABLE.
 17282*
 17283* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 17284* TO COMPUTE LIFE COMMISSION
 17285
 17286     IF CTBL-SW = '0540'
 17287        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 17288        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 17289        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 17290
 17291     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 17292
 17293     IF CTBL-TABLE-FOUND
 17294        IF CTBL-SW = '0530'
 17295             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 17296                                    * PB-I-AH-TERM
 17297             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 17298             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 17299        ELSE
 17300             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 17301             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 17302             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 17303     ELSE
 17304        IF FIRST-TIME-THROUGH
 17305            GO TO 6680-READ-CTBL-TABLE
 17306        ELSE
 17307            MOVE ZEROS         TO WS-SUB1.
 17308
 17309 6680-SET-COMMISSION.
 17310     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 17311           MOVE ZEROS          TO WS-SUB1
 17312       ELSE
 17313           MOVE RESC-COMMISSION-PER (WS-SUB)
 17314                               TO WS-COMMISSION
 17315           IF CTBL-SW = '0530'
 17316               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 17317           ELSE
 17318               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 17319
 17320 6680-SEARCH-CATEGORY.
 17321     ADD +1                   TO WS-SUB.
 17322     IF WS-SUB > +12
 17323         GO TO 6680-EXIT.
 17324
 17325     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 17326          MOVE WS-SUB         TO WS-SUB1
 17327          GO TO 6680-EXIT.
 17328
 17329     GO TO 6680-SEARCH-CATEGORY.
 17330
 17331 6680-EXIT.
 17332     EXIT.
 17333
 17334 6690-END-OF-FILE.
 17335     GO TO 6700-COMM-EXIT.
 17336
 17337 6690-ERRESC-PROBLEM.
 17338      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 320
* EL050.cbl
 17339      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17340
 17341      GO TO 6700-COMM-EXIT.
 17342
 17343 6700-COMM-EXIT.
 17344     EXIT.
 17345
 17346 7000-GET-RATE.
 17347
 17348* EXEC CICS LINK
 17349*        PROGRAM    ('ELRATE')
 17350*        COMMAREA   (CALCULATION-PASS-AREA)
 17351*        LENGTH     (CP-COMM-LENGTH)
 17352*    END-EXEC.
 17353     MOVE 'ELRATE' TO DFHEIV1
 17354*    MOVE '."C                   ''   #00017125' TO DFHEIV0
 17355     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17356     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17357     MOVE X'2020233030303137313235' TO DFHEIV0(25:11)
 17358     CALL 'kxdfhei1' USING DFHEIV0,
 17359           DFHEIV1,
 17360           CALCULATION-PASS-AREA,
 17361           CP-COMM-LENGTH,
 17362           DFHEIV99,
 17363           DFHEIV99,
 17364           DFHEIV99
 17365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17366
 17367
 17368 7000-EXIT.
 17369     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 321
* EL050.cbl
 17371 7100-FIND-BENEFIT-IN-STATE.
 17372     MOVE 'N'                    TO BEN-SEARCH-SW.
 17373
 17374     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 17375         VARYING SUB3 FROM 1 BY 1 UNTIL
 17376            ((SUB3 GREATER 50) OR
 17377              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 17378               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 17379
 17380     IF SUB3 NOT = 51
 17381         MOVE 'Y'                TO BEN-SEARCH-SW.
 17382
 17383     GO TO 7199-EXIT.
 17384
 17385 7100-BENEFIT-DUMMY.
 17386
 17387 7100-DUMMY-EXIT.
 17388     EXIT.
 17389
 17390 7199-EXIT.
 17391     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 322
* EL050.cbl
 17393 7200-FIND-BENEFIT.
 17394     MOVE 'N'                    TO BEN-SEARCH-SW.
 17395
 17396     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 17397         VARYING SUB3 FROM 1 BY 1 UNTIL
 17398            ((SUB3 GREATER 8) OR
 17399            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 17400
 17401     IF SUB3 NOT = 9
 17402         MOVE 'Y'                TO BEN-SEARCH-SW.
 17403
 17404     GO TO 7200-EXIT.
 17405
 17406 7200-BENEFIT-DUMMY.
 17407
 17408 7200-DUMMY-EXIT.
 17409     EXIT.
 17410
 17411 7200-EXIT.
 17412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 323
* EL050.cbl
 17414 7300-CHECK-FOR-OPEN-CLMS.
 17415
 17416*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 17417*    MOVE SPACES                 TO CNTL-ACCESS.
 17418*    MOVE '1'                    TO CNTL-REC-TYPE.
 17419*    MOVE +0                     TO CNTL-SEQ-NO.
 17420
 17421*    MOVE '3'                    TO RC-SW-1.
 17422*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 17423
 17424*    IF NOT CF-COMPANY-MASTER
 17425*         PERFORM 0099-COMPANY-NOT-FOUND
 17426*         GO TO 7300-EXIT.
 17427
 17428     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 17429                                    W-CL-COMP-CD.
 17430     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 17431                                    W-CL-CERT-NO.
 17432
 17433
 17434* EXEC CICS HANDLE CONDITION
 17435*        NOTFND  (7300-CONTINUE)
 17436*        ENDFILE (7300-CONTINUE)
 17437*    END-EXEC.
 17438*    MOVE '"$I''                  ! ) #00017196' TO DFHEIV0
 17439     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17441     MOVE X'2920233030303137313936' TO DFHEIV0(25:11)
 17442     CALL 'kxdfhei1' USING DFHEIV0
 17443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17444
 17445
 17446
 17447* EXEC CICS IGNORE CONDITION
 17448*        DUPKEY
 17449*    END-EXEC.
 17450*    MOVE '"*$                   !   #00017201' TO DFHEIV0
 17451     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 17452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17453     MOVE X'2020233030303137323031' TO DFHEIV0(25:11)
 17454     CALL 'kxdfhei1' USING DFHEIV0
 17455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17456
 17457
 17458
 17459* EXEC CICS STARTBR
 17460*        DATASET   (CLMS-ID)
 17461*        RIDFLD    (ELMSTR-KEY)
 17462*        GENERIC   EQUAL
 17463*        KEYLENGTH (ELMSTR-LENGTH)
 17464*    END-EXEC.
 17465     MOVE 0
 17466       TO DFHEIV11
 17467*    MOVE '&,   KG    E          &   #00017205' TO DFHEIV0
 17468     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 17469     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17470     MOVE X'2020233030303137323035' TO DFHEIV0(25:11)
 17471     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 324
* EL050.cbl
 17472           CLMS-ID,
 17473           ELMSTR-KEY,
 17474           ELMSTR-LENGTH,
 17475           DFHEIV11,
 17476           DFHEIV99
 17477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17478
 17479
 17480     MOVE 'Y'                    TO W-BROWSE-SW.
 17481
 17482 7300-NEXT-CLAIM.
 17483
 17484
 17485* EXEC CICS READNEXT
 17486*        DATASET   (CLMS-ID)
 17487*        RIDFLD    (ELMSTR-KEY)
 17488*        SET       (ADDRESS OF CLAIM-MASTER)
 17489*    END-EXEC.
 17490     MOVE 0
 17491       TO DFHEIV11
 17492*    MOVE '&.S                   )   #00017216' TO DFHEIV0
 17493     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17494     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17495     MOVE X'2020233030303137323136' TO DFHEIV0(25:11)
 17496     CALL 'kxdfhei1' USING DFHEIV0,
 17497           CLMS-ID,
 17498           DFHEIV20,
 17499           DFHEIV99,
 17500           ELMSTR-KEY,
 17501           DFHEIV99,
 17502           DFHEIV11,
 17503           DFHEIV99,
 17504           DFHEIV99
 17505     SET ADDRESS OF CLAIM-MASTER TO
 17506         DFHEIV20
 17507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17508
 17509
 17510     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 17511        MSTR-CERT-NO NOT = W-CL-CERT-NO
 17512         GO TO 7300-CONTINUE.
 17513
 17514     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 17515        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 17516        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 17517        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 17518        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 17519         GO TO 7300-NEXT-CLAIM.
 17520
 17521*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 17522     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 17523        OR (CL-CLAIM-TYPE = 'I')
 17524        OR (CL-CLAIM-TYPE = 'G')
 17525        IF CLAIM-IS-OPEN
 17526           EVALUATE TRUE
 17527             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 17528                 MOVE ER-2884      TO WS-ERROR
 17529             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 325
* EL050.cbl
 17530                 MOVE ER-2885      TO WS-ERROR
 17531             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 17532                 MOVE ER-2886      TO WS-ERROR
 17533             WHEN OTHER
 17534                 MOVE ER-2768      TO WS-ERROR
 17535           END-EVALUATE
 17536           IF PB-C-AH-CANCEL-VOIDED OR
 17537              (WS-ST-REFUND-CLAIM-FLAG = '3' AND
 17538                NOT AH-COVERAGE-CANCELLED)
 17539               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 17540               MOVE ER-2768      TO WS-ERROR
 17541           END-IF
 17542           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17543           IF WS-ST-REFUND-CLAIM-FLAG = '3' AND
 17544              PB-FORCE-CODE NOT EQUAL '8'
 17545               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 17546           END-IF
 17547           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 17548           GO TO 7300-CONTINUE
 17549        ELSE
 17550           IF PB-C-AH-CANCEL-DT < CL-PAID-THRU-DT
 17551              MOVE ER-2756        TO WS-ERROR
 17552              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17553              GO TO 7300-CONTINUE
 17554           END-IF
 17555        END-IF
 17556     ELSE
 17557*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 17558        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 17559           IF CLAIM-IS-OPEN
 17560*              MOVE ER-2768      TO WS-ERROR
 17561*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17562              GO TO 7300-CONTINUE
 17563           ELSE
 17564              IF PB-C-LF-CANCEL-DT < CL-PAID-THRU-DT
 17565                 MOVE ER-2756        TO WS-ERROR
 17566                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17567                 GO TO 7300-CONTINUE
 17568              END-IF
 17569           END-IF
 17570        END-IF
 17571     END-IF
 17572
 17573     GO TO 7300-NEXT-CLAIM.
 17574
 17575 7300-CONTINUE.
 17576
 17577     IF W-BROWSE-SW = 'Y'
 17578
 17579* EXEC CICS ENDBR
 17580*            DATASET   (CLMS-ID)
 17581*        END-EXEC.
 17582     MOVE 0
 17583       TO DFHEIV11
 17584*    MOVE '&2                    $   #00017290' TO DFHEIV0
 17585     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17586     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17587     MOVE X'2020233030303137323930' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 326
* EL050.cbl
 17588     CALL 'kxdfhei1' USING DFHEIV0,
 17589           CLMS-ID,
 17590           DFHEIV11,
 17591           DFHEIV99
 17592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17593
 17594
 17595 7300-EXIT.
 17596     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 327
* EL050.cbl
 17598
 17599 7400-GET-REMAIN-TERM.
 17600
 17601* EXEC CICS LINK
 17602*        PROGRAM    ('ELRTRM')
 17603*        COMMAREA   (CALCULATION-PASS-AREA)
 17604*        LENGTH     (CP-COMM-LENGTH)
 17605*    END-EXEC.
 17606     MOVE 'ELRTRM' TO DFHEIV1
 17607*    MOVE '."C                   ''   #00017299' TO DFHEIV0
 17608     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17609     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17610     MOVE X'2020233030303137323939' TO DFHEIV0(25:11)
 17611     CALL 'kxdfhei1' USING DFHEIV0,
 17612           DFHEIV1,
 17613           CALCULATION-PASS-AREA,
 17614           CP-COMM-LENGTH,
 17615           DFHEIV99,
 17616           DFHEIV99,
 17617           DFHEIV99
 17618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17619
 17620
 17621 7400-EXIT.
 17622     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 328
* EL050.cbl
 17624
 17625 7500-GET-REMAIN-AMOUNT.
 17626
 17627* EXEC CICS LINK
 17628*        PROGRAM    ('ELRAMT')
 17629*        COMMAREA   (CALCULATION-PASS-AREA)
 17630*        LENGTH     (CP-COMM-LENGTH)
 17631*    END-EXEC.
 17632     MOVE 'ELRAMT' TO DFHEIV1
 17633*    MOVE '."C                   ''   #00017310' TO DFHEIV0
 17634     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17635     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17636     MOVE X'2020233030303137333130' TO DFHEIV0(25:11)
 17637     CALL 'kxdfhei1' USING DFHEIV0,
 17638           DFHEIV1,
 17639           CALCULATION-PASS-AREA,
 17640           CP-COMM-LENGTH,
 17641           DFHEIV99,
 17642           DFHEIV99,
 17643           DFHEIV99
 17644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17645
 17646
 17647 7500-EXIT.
 17648     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 329
* EL050.cbl
 17650
 17651 7600-GET-REFUND.
 17652
 17653* EXEC CICS LINK
 17654*        PROGRAM    ('ELRFND')
 17655*        COMMAREA   (CALCULATION-PASS-AREA)
 17656*        LENGTH     (CP-COMM-LENGTH)
 17657*    END-EXEC.
 17658     MOVE 'ELRFND' TO DFHEIV1
 17659*    MOVE '."C                   ''   #00017321' TO DFHEIV0
 17660     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17661     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17662     MOVE X'2020233030303137333231' TO DFHEIV0(25:11)
 17663     CALL 'kxdfhei1' USING DFHEIV0,
 17664           DFHEIV1,
 17665           CALCULATION-PASS-AREA,
 17666           CP-COMM-LENGTH,
 17667           DFHEIV99,
 17668           DFHEIV99,
 17669           DFHEIV99
 17670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17671
 17672
 17673 7600-EXIT.
 17674     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 330
* EL050.cbl
 17676 7700-CALL-DL1.
 17677
 17678* EXEC CICS LINK
 17679*        PROGRAM    ('DLO001')
 17680*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 17681*        LENGTH     (DLO001-COMM-LENGTH)
 17682*    END-EXEC.
 17683     MOVE 'DLO001' TO DFHEIV1
 17684*    MOVE '."C                   ''   #00017331' TO DFHEIV0
 17685     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17686     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17687     MOVE X'2020233030303137333331' TO DFHEIV0(25:11)
 17688     CALL 'kxdfhei1' USING DFHEIV0,
 17689           DFHEIV1,
 17690           WS-DLO-MASTER-POLICY-FORM,
 17691           DLO001-COMM-LENGTH,
 17692           DFHEIV99,
 17693           DFHEIV99,
 17694           DFHEIV99
 17695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17696
 17697
 17698 7700-EXIT.
 17699     EXIT.
 17700
 17701 7710-CALL-DL2.
 17702
 17703* EXEC CICS LINK
 17704*        PROGRAM    ('DLO002')
 17705*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 17706*        LENGTH     (DLO002-COMM-LENGTH)
 17707*    END-EXEC.
 17708     MOVE 'DLO002' TO DFHEIV1
 17709*    MOVE '."C                   ''   #00017341' TO DFHEIV0
 17710     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17711     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17712     MOVE X'2020233030303137333431' TO DFHEIV0(25:11)
 17713     CALL 'kxdfhei1' USING DFHEIV0,
 17714           DFHEIV1,
 17715           WS-DLO-INTERNAL-POLICY-FORM,
 17716           DLO002-COMM-LENGTH,
 17717           DFHEIV99,
 17718           DFHEIV99,
 17719           DFHEIV99
 17720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17721
 17722
 17723 7710-EXIT.
 17724     EXIT.
 17725
 17726 7720-CALL-DL3.
 17727
 17728* EXEC CICS LINK
 17729*        PROGRAM    ('DLO003')
 17730*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 17731*        LENGTH     (DLO003-COMM-LENGTH)
 17732*    END-EXEC.
 17733     MOVE 'DLO003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 331
* EL050.cbl
 17734*    MOVE '."C                   ''   #00017351' TO DFHEIV0
 17735     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17736     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17737     MOVE X'2020233030303137333531' TO DFHEIV0(25:11)
 17738     CALL 'kxdfhei1' USING DFHEIV0,
 17739           DFHEIV1,
 17740           WS-DLO-VALID-BANK-ID,
 17741           DLO003-COMM-LENGTH,
 17742           DFHEIV99,
 17743           DFHEIV99,
 17744           DFHEIV99
 17745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17746
 17747
 17748 7720-EXIT.
 17749     EXIT.
 17750
 17751 7730-CALL-DL7.
 17752
 17753* EXEC CICS LINK
 17754*        PROGRAM    ('DLO007')
 17755*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 17756*        LENGTH     (DLO007-COMM-LENGTH)
 17757*    END-EXEC.
 17758     MOVE 'DLO007' TO DFHEIV1
 17759*    MOVE '."C                   ''   #00017361' TO DFHEIV0
 17760     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17761     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17762     MOVE X'2020233030303137333631' TO DFHEIV0(25:11)
 17763     CALL 'kxdfhei1' USING DFHEIV0,
 17764           DFHEIV1,
 17765           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 17766           DLO007-COMM-LENGTH,
 17767           DFHEIV99,
 17768           DFHEIV99,
 17769           DFHEIV99
 17770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17771
 17772
 17773 7730-EXIT.
 17774     EXIT.
 17775
 17776 7740-CALL-DL11.
 17777
 17778* EXEC CICS LINK
 17779*        PROGRAM    ('DLO011')
 17780*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 17781*        LENGTH     (DLO011-COMM-LENGTH)
 17782*    END-EXEC.
 17783     MOVE 'DLO011' TO DFHEIV1
 17784*    MOVE '."C                   ''   #00017371' TO DFHEIV0
 17785     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17786     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17787     MOVE X'2020233030303137333731' TO DFHEIV0(25:11)
 17788     CALL 'kxdfhei1' USING DFHEIV0,
 17789           DFHEIV1,
 17790           WS-DLO-PREM-RATES-BEN-TYPE,
 17791           DLO011-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 332
* EL050.cbl
 17792           DFHEIV99,
 17793           DFHEIV99,
 17794           DFHEIV99
 17795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17796
 17797
 17798 7740-EXIT.
 17799     EXIT.
 17800
 17801 7750-CALL-DL17.
 17802
 17803* EXEC CICS LINK
 17804*        PROGRAM    ('DLO017')
 17805*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 17806*        LENGTH     (DLO017-COMM-LENGTH)
 17807*    END-EXEC.
 17808     MOVE 'DLO017' TO DFHEIV1
 17809*    MOVE '."C                   ''   #00017381' TO DFHEIV0
 17810     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17811     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17812     MOVE X'2020233030303137333831' TO DFHEIV0(25:11)
 17813     CALL 'kxdfhei1' USING DFHEIV0,
 17814           DFHEIV1,
 17815           WS-DLO-VALID-RATE-CODE,
 17816           DLO017-COMM-LENGTH,
 17817           DFHEIV99,
 17818           DFHEIV99,
 17819           DFHEIV99
 17820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17821
 17822
 17823 7750-EXIT.
 17824     EXIT.
 17825
 17826 7755-CALL-DL19.
 17827
 17828* EXEC CICS LINK
 17829*        PROGRAM    ('DLO019')
 17830*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 17831*        LENGTH     (DLO019-COMM-LENGTH)
 17832*    END-EXEC.
 17833     MOVE 'DLO019' TO DFHEIV1
 17834*    MOVE '."C                   ''   #00017391' TO DFHEIV0
 17835     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17836     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17837     MOVE X'2020233030303137333931' TO DFHEIV0(25:11)
 17838     CALL 'kxdfhei1' USING DFHEIV0,
 17839           DFHEIV1,
 17840           WS-DLO-ORIG-COV-CAT,
 17841           DLO019-COMM-LENGTH,
 17842           DFHEIV99,
 17843           DFHEIV99,
 17844           DFHEIV99
 17845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17846
 17847
 17848 7755-EXIT.
 17849     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 333
* EL050.cbl
 17850
 17851 7760-CALL-DL21.
 17852
 17853* EXEC CICS LINK
 17854*        PROGRAM    ('DLO021')
 17855*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 17856*        LENGTH     (DLO021-COMM-LENGTH)
 17857*    END-EXEC.
 17858     MOVE 'DLO021' TO DFHEIV1
 17859*    MOVE '."C                   ''   #00017401' TO DFHEIV0
 17860     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17861     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17862     MOVE X'2020233030303137343031' TO DFHEIV0(25:11)
 17863     CALL 'kxdfhei1' USING DFHEIV0,
 17864           DFHEIV1,
 17865           WS-DLO-VALID-LOAN-OFFICER,
 17866           DLO021-COMM-LENGTH,
 17867           DFHEIV99,
 17868           DFHEIV99,
 17869           DFHEIV99
 17870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17871
 17872
 17873 7760-EXIT.
 17874     EXIT.
 17875
 17876 7770-CALL-DL22.
 17877
 17878* EXEC CICS LINK
 17879*        PROGRAM    ('DLO022')
 17880*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 17881*        LENGTH     (DLO022-COMM-LENGTH)
 17882*    END-EXEC.
 17883     MOVE 'DLO022' TO DFHEIV1
 17884*    MOVE '."C                   ''   #00017411' TO DFHEIV0
 17885     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17887     MOVE X'2020233030303137343131' TO DFHEIV0(25:11)
 17888     CALL 'kxdfhei1' USING DFHEIV0,
 17889           DFHEIV1,
 17890           WS-DLO-VALID-STATE-CODE,
 17891           DLO022-COMM-LENGTH,
 17892           DFHEIV99,
 17893           DFHEIV99,
 17894           DFHEIV99
 17895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17896
 17897
 17898 7770-EXIT.
 17899     EXIT.
 17900
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 334
* EL050.cbl
 17902
 17903 7800-REWRITE-CERT.
 17904******************************************************************
 17905*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 17906*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 17907******************************************************************
 17908
 17909     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 17910        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 17911        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 17912        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 17913
 17914* EXEC CICS REWRITE
 17915*                  DATASET (CERT-ID)
 17916*                  FROM    (CERTIFICATE-MASTER)
 17917*              END-EXEC
 17918     MOVE LENGTH OF
 17919      CERTIFICATE-MASTER
 17920       TO DFHEIV11
 17921*    MOVE '&& L                  %   #00017432' TO DFHEIV0
 17922     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17923     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17924     MOVE X'2020233030303137343332' TO DFHEIV0(25:11)
 17925     CALL 'kxdfhei1' USING DFHEIV0,
 17926           CERT-ID,
 17927           CERTIFICATE-MASTER,
 17928           DFHEIV11,
 17929           DFHEIV99
 17930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17931        GO TO 7800-EXIT.
 17932
 17933       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 17934       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 17935
 17936 7800-EXIT.
 17937      EXIT.
 17938
 17939 7900-DELETE-CERT.
 17940
 17941* EXEC CICS DELETE
 17942*        DATASET (CERT-ID)
 17943*    END-EXEC.
 17944*    MOVE '&(                    &   #00017445' TO DFHEIV0
 17945     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17946     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17947     MOVE X'2020233030303137343435' TO DFHEIV0(25:11)
 17948     CALL 'kxdfhei1' USING DFHEIV0,
 17949           CERT-ID,
 17950           DFHEIV99,
 17951           DFHEIV99,
 17952           DFHEIV99,
 17953           DFHEIV99
 17954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17955
 17956
 17957 7900-EXIT.
 17958     EXIT.
 17959
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 335
* EL050.cbl
 17960 8000-WRITE-CERT.
 17961
 17962* EXEC CICS HANDLE CONDITION
 17963*        DUPKEY    (8000-FREE-MAIN)
 17964*    END-EXEC.
 17965*    MOVE '"$$                   ! * #00017453' TO DFHEIV0
 17966     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 17967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17968     MOVE X'2A20233030303137343533' TO DFHEIV0(25:11)
 17969     CALL 'kxdfhei1' USING DFHEIV0
 17970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17971
 17972
 17973
 17974* EXEC CICS WRITE
 17975*        DATASET     (CERT-ID)
 17976*        FROM        (CERTIFICATE-MASTER)
 17977*        RIDFLD      (ELCERT-KEY)
 17978*    END-EXEC.
 17979     MOVE LENGTH OF
 17980      CERTIFICATE-MASTER
 17981       TO DFHEIV11
 17982*    MOVE '&$ L                  ''   #00017457' TO DFHEIV0
 17983     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17985     MOVE X'2020233030303137343537' TO DFHEIV0(25:11)
 17986     CALL 'kxdfhei1' USING DFHEIV0,
 17987           CERT-ID,
 17988           CERTIFICATE-MASTER,
 17989           DFHEIV11,
 17990           ELCERT-KEY,
 17991           DFHEIV99,
 17992           DFHEIV99
 17993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17994
 17995
 17996 8000-FREE-MAIN.
 17997
 17998 8000-EXIT.
 17999      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 336
* EL050.cbl
 18001
 18002 8100-READ-ERPNDM.
 18003
 18004* EXEC CICS HANDLE CONDITION
 18005*         NOTFND     (8100-NOTFND)
 18006*         ENDFILE    (8100-NOTFND)
 18007*    END-EXEC.
 18008*    MOVE '"$I''                  ! + #00017470' TO DFHEIV0
 18009     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18011     MOVE X'2B20233030303137343730' TO DFHEIV0(25:11)
 18012     CALL 'kxdfhei1' USING DFHEIV0
 18013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18014
 18015
 18016     MOVE SPACES                 TO ERPNDM-FOUND.
 18017     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 18018
 18019
 18020* EXEC CICS READ
 18021*         DATASET   (FILE-ERPNDM)
 18022*         RIDFLD    (PM-CONTROL-PRIMARY)
 18023*         INTO      (PENDING-MAILING-DATA)
 18024*    END-EXEC.
 18025     MOVE LENGTH OF
 18026      PENDING-MAILING-DATA
 18027       TO DFHEIV11
 18028*    MOVE '&"IL       E          (   #00017478' TO DFHEIV0
 18029     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18031     MOVE X'2020233030303137343738' TO DFHEIV0(25:11)
 18032     CALL 'kxdfhei1' USING DFHEIV0,
 18033           FILE-ERPNDM,
 18034           PENDING-MAILING-DATA,
 18035           DFHEIV11,
 18036           PM-CONTROL-PRIMARY,
 18037           DFHEIV99,
 18038           DFHEIV99,
 18039           DFHEIV99
 18040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18041
 18042
 18043     GO TO 8100-EXIT.
 18044
 18045 8100-NOTFND.
 18046
 18047     MOVE 'X'                    TO ERPNDM-FOUND.
 18048     MOVE ER-2694                TO WS-ERROR.
 18049     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18050     MOVE ER-2883                TO WS-ERROR
 18051     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18052     .
 18053 8100-EXIT.
 18054     EXIT.
 18055
 18056 8110-READ-ERMAIL.
 18057
 18058* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 337
* EL050.cbl
 18059*         NOTFND     (8110-NOTFND)
 18060*         ENDFILE    (8110-NOTFND)
 18061*    END-EXEC.
 18062*    MOVE '"$I''                  ! , #00017498' TO DFHEIV0
 18063     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18064     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18065     MOVE X'2C20233030303137343938' TO DFHEIV0(25:11)
 18066     CALL 'kxdfhei1' USING DFHEIV0
 18067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18068
 18069
 18070     MOVE SPACES                 TO ERMAIL-FOUND.
 18071     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18072     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18073     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18074     MOVE PB-SV-STATE            TO MA-STATE.
 18075
 18076
 18077* EXEC CICS READ
 18078*         UPDATE
 18079*         DATASET   (FILE-ERMAIL)
 18080*         RIDFLD    (MA-CONTROL-PRIMARY)
 18081*         INTO      (MAILING-DATA)
 18082*    END-EXEC.
 18083     MOVE LENGTH OF
 18084      MAILING-DATA
 18085       TO DFHEIV11
 18086*    MOVE '&"IL       EU         (   #00017509' TO DFHEIV0
 18087     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18088     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18089     MOVE X'2020233030303137353039' TO DFHEIV0(25:11)
 18090     CALL 'kxdfhei1' USING DFHEIV0,
 18091           FILE-ERMAIL,
 18092           MAILING-DATA,
 18093           DFHEIV11,
 18094           MA-CONTROL-PRIMARY,
 18095           DFHEIV99,
 18096           DFHEIV99,
 18097           DFHEIV99
 18098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18099
 18100
 18101     GO TO 8110-EXIT.
 18102
 18103 8110-NOTFND.
 18104     MOVE 'X'                    TO ERMAIL-FOUND.
 18105
 18106 8110-EXIT.
 18107     EXIT.
 18108
 18109 8120-REWRITE-ERMAIL.
 18110
 18111* EXEC CICS REWRITE
 18112*         DATASET    (FILE-ERMAIL)
 18113*         FROM       (MAILING-DATA)
 18114*    END-EXEC.
 18115     MOVE LENGTH OF
 18116      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 338
* EL050.cbl
 18117       TO DFHEIV11
 18118*    MOVE '&& L                  %   #00017525' TO DFHEIV0
 18119     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18120     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18121     MOVE X'2020233030303137353235' TO DFHEIV0(25:11)
 18122     CALL 'kxdfhei1' USING DFHEIV0,
 18123           FILE-ERMAIL,
 18124           MAILING-DATA,
 18125           DFHEIV11,
 18126           DFHEIV99
 18127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18128
 18129
 18130 8120-EXIT.
 18131     EXIT.
 18132
 18133 8130-WRITE-ERMAIL.
 18134
 18135* EXEC CICS HANDLE CONDITION
 18136*         DUPKEY   (8130-EXIT)
 18137*    END-EXEC.
 18138*    MOVE '"$$                   ! - #00017534' TO DFHEIV0
 18139     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 18140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18141     MOVE X'2D20233030303137353334' TO DFHEIV0(25:11)
 18142     CALL 'kxdfhei1' USING DFHEIV0
 18143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18144
 18145
 18146
 18147* EXEC CICS WRITE
 18148*         DATASET     (FILE-ERMAIL)
 18149*         RIDFLD      (MA-CONTROL-PRIMARY)
 18150*         FROM        (MAILING-DATA)
 18151*    END-EXEC.
 18152     MOVE LENGTH OF
 18153      MAILING-DATA
 18154       TO DFHEIV11
 18155*    MOVE '&$ L                  ''   #00017538' TO DFHEIV0
 18156     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18157     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18158     MOVE X'2020233030303137353338' TO DFHEIV0(25:11)
 18159     CALL 'kxdfhei1' USING DFHEIV0,
 18160           FILE-ERMAIL,
 18161           MAILING-DATA,
 18162           DFHEIV11,
 18163           MA-CONTROL-PRIMARY,
 18164           DFHEIV99,
 18165           DFHEIV99
 18166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18167
 18168
 18169 8130-EXIT.
 18170     EXIT.
 18171
 18172 8140-UNLOCK-ERMAIL.
 18173
 18174* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 339
* EL050.cbl
 18175*         DATASET   (FILE-ERMAIL)
 18176*    END-EXEC.
 18177*    MOVE '&*                    #   #00017548' TO DFHEIV0
 18178     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 18179     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18180     MOVE X'2020233030303137353438' TO DFHEIV0(25:11)
 18181     CALL 'kxdfhei1' USING DFHEIV0,
 18182           FILE-ERMAIL,
 18183           DFHEIV99
 18184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18185
 18186
 18187 8140-EXIT.
 18188     EXIT.
 18189
 18190 8180-UPDATE-VIN-NUMBER.
 18191
 18192* EXEC CICS HANDLE CONDITION
 18193*        NOTFND   (8180-NOTFND)
 18194*    END-EXEC.
 18195*    MOVE '"$I                   ! . #00017556' TO DFHEIV0
 18196     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18198     MOVE X'2E20233030303137353536' TO DFHEIV0(25:11)
 18199     CALL 'kxdfhei1' USING DFHEIV0
 18200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18201
 18202
 18203     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 18204     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 18205
 18206
 18207* EXEC CICS READ
 18208*        UPDATE
 18209*        DATASET  (CRTT-ID)
 18210*        RIDFLD   (WS-ELCRTT-KEY)
 18211*        INTO     (CERTIFICATE-TRAILERS)
 18212*    END-EXEC.
 18213     MOVE LENGTH OF
 18214      CERTIFICATE-TRAILERS
 18215       TO DFHEIV11
 18216*    MOVE '&"IL       EU         (   #00017563' TO DFHEIV0
 18217     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18218     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18219     MOVE X'2020233030303137353633' TO DFHEIV0(25:11)
 18220     CALL 'kxdfhei1' USING DFHEIV0,
 18221           CRTT-ID,
 18222           CERTIFICATE-TRAILERS,
 18223           DFHEIV11,
 18224           WS-ELCRTT-KEY,
 18225           DFHEIV99,
 18226           DFHEIV99,
 18227           DFHEIV99
 18228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18229
 18230
 18231     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 18232         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 340
* EL050.cbl
 18233
 18234* EXEC CICS REWRITE
 18235*           DATASET  (CRTT-ID)
 18236*           FROM     (CERTIFICATE-TRAILERS)
 18237*        END-EXEC
 18238     MOVE LENGTH OF
 18239      CERTIFICATE-TRAILERS
 18240       TO DFHEIV11
 18241*    MOVE '&& L                  %   #00017572' TO DFHEIV0
 18242     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18243     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18244     MOVE X'2020233030303137353732' TO DFHEIV0(25:11)
 18245     CALL 'kxdfhei1' USING DFHEIV0,
 18246           CRTT-ID,
 18247           CERTIFICATE-TRAILERS,
 18248           DFHEIV11,
 18249           DFHEIV99
 18250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18251     END-IF.
 18252
 18253     GO TO 8180-EXIT.
 18254
 18255 8180-NOTFND.
 18256
 18257     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 18258     MOVE 'CS'         TO CS-RECORD-ID.
 18259     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 18260     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 18261     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 18262     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 18263
 18264* EXEC CICS WRITE
 18265*       DATASET  (CRTT-ID)
 18266*       RIDFLD   (WS-ELCRTT-KEY)
 18267*       FROM     (CERTIFICATE-TRAILERS)
 18268*    END-EXEC.
 18269     MOVE LENGTH OF
 18270      CERTIFICATE-TRAILERS
 18271       TO DFHEIV11
 18272*    MOVE '&$ L                  ''   #00017588' TO DFHEIV0
 18273     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18275     MOVE X'2020233030303137353838' TO DFHEIV0(25:11)
 18276     CALL 'kxdfhei1' USING DFHEIV0,
 18277           CRTT-ID,
 18278           CERTIFICATE-TRAILERS,
 18279           DFHEIV11,
 18280           WS-ELCRTT-KEY,
 18281           DFHEIV99,
 18282           DFHEIV99
 18283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18284
 18285
 18286 8180-EXIT.
 18287     EXIT.
 18288
 18289 8190-UPDATE-REFUND-CLAIM-FLAG.
 18290
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 341
* EL050.cbl
 18291* EXEC CICS HANDLE CONDITION
 18292*        NOTFND   (8190-NOTFND)
 18293*    END-EXEC.
 18294*    MOVE '"$I                   ! / #00017598' TO DFHEIV0
 18295     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18297     MOVE X'2F20233030303137353938' TO DFHEIV0(25:11)
 18298     CALL 'kxdfhei1' USING DFHEIV0
 18299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18300
 18301
 18302     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 18303     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 18304
 18305
 18306* EXEC CICS READ
 18307*        UPDATE
 18308*        DATASET  (CRTT-ID)
 18309*        RIDFLD   (WS-ELCRTT-KEY)
 18310*        INTO     (CERTIFICATE-TRAILERS)
 18311*    END-EXEC.
 18312     MOVE LENGTH OF
 18313      CERTIFICATE-TRAILERS
 18314       TO DFHEIV11
 18315*    MOVE '&"IL       EU         (   #00017605' TO DFHEIV0
 18316     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18317     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18318     MOVE X'2020233030303137363035' TO DFHEIV0(25:11)
 18319     CALL 'kxdfhei1' USING DFHEIV0,
 18320           CRTT-ID,
 18321           CERTIFICATE-TRAILERS,
 18322           DFHEIV11,
 18323           WS-ELCRTT-KEY,
 18324           DFHEIV99,
 18325           DFHEIV99,
 18326           DFHEIV99
 18327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18328
 18329
 18330     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 18331
 18332* EXEC CICS REWRITE
 18333*       DATASET  (CRTT-ID)
 18334*       FROM     (CERTIFICATE-TRAILERS)
 18335*    END-EXEC.
 18336     MOVE LENGTH OF
 18337      CERTIFICATE-TRAILERS
 18338       TO DFHEIV11
 18339*    MOVE '&& L                  %   #00017613' TO DFHEIV0
 18340     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18341     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18342     MOVE X'2020233030303137363133' TO DFHEIV0(25:11)
 18343     CALL 'kxdfhei1' USING DFHEIV0,
 18344           CRTT-ID,
 18345           CERTIFICATE-TRAILERS,
 18346           DFHEIV11,
 18347           DFHEIV99
 18348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 342
* EL050.cbl
 18349
 18350
 18351     GO TO 8190-EXIT.
 18352
 18353 8190-NOTFND.
 18354
 18355     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 18356     MOVE 'CS'         TO CS-RECORD-ID.
 18357     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 18358     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 18359     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 18360     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 18361
 18362* EXEC CICS WRITE
 18363*       DATASET  (CRTT-ID)
 18364*       RIDFLD   (WS-ELCRTT-KEY)
 18365*       FROM     (CERTIFICATE-TRAILERS)
 18366*    END-EXEC.
 18367     MOVE LENGTH OF
 18368      CERTIFICATE-TRAILERS
 18369       TO DFHEIV11
 18370*    MOVE '&$ L                  ''   #00017628' TO DFHEIV0
 18371     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18372     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18373     MOVE X'2020233030303137363238' TO DFHEIV0(25:11)
 18374     CALL 'kxdfhei1' USING DFHEIV0,
 18375           CRTT-ID,
 18376           CERTIFICATE-TRAILERS,
 18377           DFHEIV11,
 18378           WS-ELCRTT-KEY,
 18379           DFHEIV99,
 18380           DFHEIV99
 18381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18382
 18383
 18384 8190-EXIT.
 18385     EXIT.
 18386
 18387 8200-READ-REIN-TABLE.
 18388
 18389* EXEC CICS HANDLE CONDITION
 18390*         NOTFND   (8200-NOTFND)
 18391*    END-EXEC.
 18392*    MOVE '"$I                   ! 0 #00017638' TO DFHEIV0
 18393     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18394     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18395     MOVE X'3020233030303137363338' TO DFHEIV0(25:11)
 18396     CALL 'kxdfhei1' USING DFHEIV0
 18397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18398
 18399
 18400
 18401* EXEC CICS READ
 18402*        DATASET     (REIN-ID)
 18403*        SET         (ADDRESS OF REINSURANCE-RECORD)
 18404*        RIDFLD      (ERREIN-KEY)
 18405*    END-EXEC.
 18406*    MOVE '&"S        E          (   #00017642' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 343
* EL050.cbl
 18407     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18408     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18409     MOVE X'2020233030303137363432' TO DFHEIV0(25:11)
 18410     CALL 'kxdfhei1' USING DFHEIV0,
 18411           REIN-ID,
 18412           DFHEIV20,
 18413           DFHEIV99,
 18414           ERREIN-KEY,
 18415           DFHEIV99,
 18416           DFHEIV99,
 18417           DFHEIV99
 18418     SET ADDRESS OF REINSURANCE-RECORD TO
 18419         DFHEIV20
 18420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18421
 18422
 18423     GO TO 8200-EXIT.
 18424
 18425 8200-NOTFND.
 18426     MOVE 'N'             TO WS-REIN-READ-SW.
 18427
 18428 8200-EXIT.
 18429      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 344
* EL050.cbl
 18431
 18432 8300-READ-CTBL-TABLE.
 18433
 18434* EXEC CICS HANDLE CONDITION
 18435*        NOTFND    (8300-NOTFND)
 18436*        DISABLED  (8300-ERRESS-PROBLEM)
 18437*        NOTOPEN   (8300-ERRESS-PROBLEM)
 18438*        ENDFILE   (8300-NOTFND)
 18439*    END-EXEC.
 18440*    MOVE '"$IcJ''                ! 1 #00017658' TO DFHEIV0
 18441     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18443     MOVE X'3120233030303137363538' TO DFHEIV0(25:11)
 18444     CALL 'kxdfhei1' USING DFHEIV0
 18445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18446
 18447
 18448
 18449* EXEC CICS READ
 18450*        DATASET     (CTBL-ID)
 18451*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 18452*        RIDFLD      (ERCTBL-KEY)
 18453*    END-EXEC.
 18454*    MOVE '&"S        E          (   #00017665' TO DFHEIV0
 18455     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18457     MOVE X'2020233030303137363635' TO DFHEIV0(25:11)
 18458     CALL 'kxdfhei1' USING DFHEIV0,
 18459           CTBL-ID,
 18460           DFHEIV20,
 18461           DFHEIV99,
 18462           ERCTBL-KEY,
 18463           DFHEIV99,
 18464           DFHEIV99,
 18465           DFHEIV99
 18466     SET ADDRESS OF COMM-TABLE-RECORD TO
 18467         DFHEIV20
 18468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18469
 18470
 18471     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 18472
 18473     GO TO 8300-EXIT.
 18474
 18475 8300-NOTFND.
 18476
 18477     IF CTBL-SW = '0530'
 18478         MOVE 'AA'                     TO WS-AH-COMP-CD
 18479         MOVE '0550'                   TO CTBL-SW
 18480         MOVE '1'                      TO WS-CTBL-READ-SW
 18481         GO TO 8300-EXIT.
 18482
 18483     IF CTBL-SW = '0540'
 18484         MOVE 'AA'                     TO WS-LF-COMP-CD
 18485         MOVE '0550'                   TO CTBL-SW
 18486         MOVE '1'                      TO WS-CTBL-READ-SW
 18487         GO TO 8300-EXIT.
 18488
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 345
* EL050.cbl
 18489     IF CTBL-SW = '0550'
 18490         MOVE '2'                      TO WS-CTBL-READ-SW
 18491         GO TO 8300-EXIT.
 18492
 18493     GO TO 8300-EXIT.
 18494
 18495 8300-ERRESS-PROBLEM.
 18496
 18497      MOVE ER-8050              TO WS-ERROR.
 18498      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18499
 18500     GO TO 8300-EXIT.
 18501
 18502 8300-EXIT.
 18503      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 346
* EL050.cbl
 18505
 18506
 18507 8400-GETMAIN-ERFORM.
 18508
 18509
 18510* EXEC CICS   GETMAIN
 18511*        LENGTH  (500)
 18512*        SET     (ADDRESS OF FORM-MASTER)
 18513*    END-EXEC.
 18514     MOVE 500
 18515       TO DFHEIV11
 18516*    MOVE '," L                  $   #00017709' TO DFHEIV0
 18517     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 18518     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18519     MOVE X'2020233030303137373039' TO DFHEIV0(25:11)
 18520     CALL 'kxdfhei1' USING DFHEIV0,
 18521           DFHEIV20,
 18522           DFHEIV11,
 18523           DFHEIV99
 18524     SET ADDRESS OF FORM-MASTER TO
 18525         DFHEIV20
 18526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18527
 18528
 18529     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 18530
 18531 8400-EXIT.
 18532      EXIT.
 18533
 18534 8450-READ-FORM-MASTER.
 18535
 18536
 18537* EXEC CICS  HANDLE CONDITION
 18538*        NOTFND   (8450-FORM-NOT-FOUND)
 18539*        ENDFILE  (8450-FORM-NOT-FOUND)
 18540*    END-EXEC.
 18541*    MOVE '"$I''                  ! 2 #00017721' TO DFHEIV0
 18542     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18544     MOVE X'3220233030303137373231' TO DFHEIV0(25:11)
 18545     CALL 'kxdfhei1' USING DFHEIV0
 18546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18547
 18548
 18549
 18550* EXEC CICS   READ
 18551*        DATASET   (FORM-ID)
 18552*        RIDFLD    (ERFORM-KEY)
 18553*        INTO      (FORM-MASTER)
 18554*        GTEQ
 18555*    END-EXEC.
 18556     MOVE LENGTH OF
 18557      FORM-MASTER
 18558       TO DFHEIV11
 18559*    MOVE '&"IL       G          (   #00017726' TO DFHEIV0
 18560     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 18561     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18562     MOVE X'2020233030303137373236' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 347
* EL050.cbl
 18563     CALL 'kxdfhei1' USING DFHEIV0,
 18564           FORM-ID,
 18565           FORM-MASTER,
 18566           DFHEIV11,
 18567           ERFORM-KEY,
 18568           DFHEIV99,
 18569           DFHEIV99,
 18570           DFHEIV99
 18571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18572
 18573
 18574     MOVE  'Y'           TO  FORM-MASTER-SW.
 18575
 18576     GO TO  8450-EXIT.
 18577
 18578 8450-FORM-NOT-FOUND.
 18579
 18580     MOVE  'N'           TO  FORM-MASTER-SW.
 18581
 18582 8450-EXIT.
 18583      EXIT.
 18584
 18585 8500-DATE-CONVERT.
 18586
 18587* EXEC CICS LINK
 18588*        PROGRAM    ('ELDATCV')
 18589*        COMMAREA   (DATE-CONVERSION-DATA)
 18590*        LENGTH     (DC-COMM-LENGTH)
 18591*    END-EXEC.
 18592     MOVE 'ELDATCV' TO DFHEIV1
 18593*    MOVE '."C                   ''   #00017745' TO DFHEIV0
 18594     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18595     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18596     MOVE X'2020233030303137373435' TO DFHEIV0(25:11)
 18597     CALL 'kxdfhei1' USING DFHEIV0,
 18598           DFHEIV1,
 18599           DATE-CONVERSION-DATA,
 18600           DC-COMM-LENGTH,
 18601           DFHEIV99,
 18602           DFHEIV99,
 18603           DFHEIV99
 18604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18605
 18606
 18607 8500-EXIT.
 18608     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 348
* EL050.cbl
 18610
 18611 8555-RELOAD-CONTROL-FILE.
 18612     CONTINUE.
 18613
 18614 8555-EXIT.
 18615     EXIT.
 18616
 18617 8557-GETMAIN-ERPLAN.
 18618
 18619
 18620* EXEC CICS GETMAIN
 18621*        LENGTH    (840)
 18622*        SET       (ADDRESS OF PLAN-RECORDS)
 18623*    END-EXEC.
 18624     MOVE 840
 18625       TO DFHEIV11
 18626*    MOVE '," L                  $   #00017763' TO DFHEIV0
 18627     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 18628     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18629     MOVE X'2020233030303137373633' TO DFHEIV0(25:11)
 18630     CALL 'kxdfhei1' USING DFHEIV0,
 18631           DFHEIV20,
 18632           DFHEIV11,
 18633           DFHEIV99
 18634     SET ADDRESS OF PLAN-RECORDS TO
 18635         DFHEIV20
 18636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18637
 18638
 18639     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 18640
 18641 8557-EXIT.
 18642     EXIT.
 18643
 18644 8560-GETMAIN.
 18645
 18646* EXEC CICS GETMAIN
 18647*        LENGTH    (2000)
 18648*        SET       (ADDRESS OF ACCOUNT-MASTER)
 18649*    END-EXEC.
 18650     MOVE 2000
 18651       TO DFHEIV11
 18652*    MOVE '," L                  $   #00017774' TO DFHEIV0
 18653     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 18654     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18655     MOVE X'2020233030303137373734' TO DFHEIV0(25:11)
 18656     CALL 'kxdfhei1' USING DFHEIV0,
 18657           DFHEIV20,
 18658           DFHEIV11,
 18659           DFHEIV99
 18660     SET ADDRESS OF ACCOUNT-MASTER TO
 18661         DFHEIV20
 18662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18663
 18664
 18665     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 18666
 18667 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 349
* EL050.cbl
 18668     EXIT.
 18669
 18670 8570-START-ACCOUNT-MASTER.
 18671
 18672* EXEC CICS HANDLE CONDITION
 18673*        NOTFND    (0199-ACCT-NOT-FOUND)
 18674*        ENDFILE   (0199-ACCT-NOT-FOUND)
 18675*    END-EXEC.
 18676*    MOVE '"$I''                  ! 3 #00017785' TO DFHEIV0
 18677     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18679     MOVE X'3320233030303137373835' TO DFHEIV0(25:11)
 18680     CALL 'kxdfhei1' USING DFHEIV0
 18681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18682
 18683
 18684
 18685* EXEC CICS STARTBR
 18686*        DATASET    (ACCT-ID)
 18687*        RIDFLD     (ERACCT-KEY)
 18688*        GTEQ
 18689*    END-EXEC.
 18690     MOVE 0
 18691       TO DFHEIV11
 18692*    MOVE '&,         G          &   #00017790' TO DFHEIV0
 18693     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18694     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18695     MOVE X'2020233030303137373930' TO DFHEIV0(25:11)
 18696     CALL 'kxdfhei1' USING DFHEIV0,
 18697           ACCT-ID,
 18698           ERACCT-KEY,
 18699           DFHEIV99,
 18700           DFHEIV11,
 18701           DFHEIV99
 18702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18703
 18704
 18705 8570-EXIT.
 18706     EXIT.
 18707
 18708 8580-READ-ACCOUNT-MASTER.
 18709
 18710* EXEC CICS HANDLE CONDITION
 18711*        NOTFND    (0199-ACCT-NOT-FOUND)
 18712*        ENDFILE   (0199-ACCT-NOT-FOUND)
 18713*    END-EXEC.
 18714*    MOVE '"$I''                  ! 4 #00017800' TO DFHEIV0
 18715     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18717     MOVE X'3420233030303137383030' TO DFHEIV0(25:11)
 18718     CALL 'kxdfhei1' USING DFHEIV0
 18719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18720
 18721
 18722
 18723* EXEC CICS READNEXT
 18724*        DATASET     (ACCT-ID)
 18725*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 350
* EL050.cbl
 18726*        RIDFLD      (ERACCT-KEY)
 18727*    END-EXEC.
 18728     MOVE LENGTH OF
 18729      ACCOUNT-MASTER
 18730       TO DFHEIV12
 18731     MOVE 0
 18732       TO DFHEIV11
 18733*    MOVE '&.IL                  )   #00017805' TO DFHEIV0
 18734     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18735     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18736     MOVE X'2020233030303137383035' TO DFHEIV0(25:11)
 18737     CALL 'kxdfhei1' USING DFHEIV0,
 18738           ACCT-ID,
 18739           ACCOUNT-MASTER,
 18740           DFHEIV12,
 18741           ERACCT-KEY,
 18742           DFHEIV99,
 18743           DFHEIV11,
 18744           DFHEIV99,
 18745           DFHEIV99
 18746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18747
 18748
 18749 8580-EXIT.
 18750     EXIT.
 18751
 18752 8582-READ-COMPENSATION-MASTER.
 18753
 18754* EXEC CICS HANDLE CONDITION
 18755*        NOTFND    (8582-COMP-NOT-FOUND)
 18756*        ENDFILE   (8582-COMP-NOT-FOUND)
 18757*    END-EXEC.
 18758*    MOVE '"$I''                  ! 5 #00017815' TO DFHEIV0
 18759     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18760     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18761     MOVE X'3520233030303137383135' TO DFHEIV0(25:11)
 18762     CALL 'kxdfhei1' USING DFHEIV0
 18763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18764
 18765
 18766
 18767* EXEC CICS READ
 18768*        DATASET     (COMP-ID)
 18769*        INTO        (COMPENSATION-MASTER)
 18770*        RIDFLD      (ERCOMP-KEY)
 18771*    END-EXEC.
 18772     MOVE LENGTH OF
 18773      COMPENSATION-MASTER
 18774       TO DFHEIV11
 18775*    MOVE '&"IL       E          (   #00017820' TO DFHEIV0
 18776     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18777     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18778     MOVE X'2020233030303137383230' TO DFHEIV0(25:11)
 18779     CALL 'kxdfhei1' USING DFHEIV0,
 18780           COMP-ID,
 18781           COMPENSATION-MASTER,
 18782           DFHEIV11,
 18783           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 351
* EL050.cbl
 18784           DFHEIV99,
 18785           DFHEIV99,
 18786           DFHEIV99
 18787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18788
 18789
 18790     MOVE 'Y'                    TO COMP-MASTER-SW
 18791
 18792     GO TO 8582-EXIT
 18793     .
 18794 8582-COMP-NOT-FOUND.
 18795
 18796     MOVE 'N'                    TO COMP-MASTER-SW.
 18797
 18798 8582-EXIT.
 18799     EXIT.
 18800
 18801 8583-READ-ERAGTC.
 18802
 18803* EXEC CICS HANDLE CONDITION
 18804*        NOTFND    (8583-AGTC-NOT-FOUND)
 18805*        ENDFILE   (8583-AGTC-NOT-FOUND)
 18806*    END-EXEC.
 18807*    MOVE '"$I''                  ! 6 #00017838' TO DFHEIV0
 18808     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18809     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18810     MOVE X'3620233030303137383338' TO DFHEIV0(25:11)
 18811     CALL 'kxdfhei1' USING DFHEIV0
 18812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18813
 18814
 18815
 18816* EXEC CICS STARTBR
 18817*        DATASET    (AGTC-ID)
 18818*        RIDFLD     (ERAGTC-KEY)
 18819*        GTEQ
 18820*    END-EXEC.
 18821     MOVE 0
 18822       TO DFHEIV11
 18823*    MOVE '&,         G          &   #00017843' TO DFHEIV0
 18824     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18825     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18826     MOVE X'2020233030303137383433' TO DFHEIV0(25:11)
 18827     CALL 'kxdfhei1' USING DFHEIV0,
 18828           AGTC-ID,
 18829           ERAGTC-KEY,
 18830           DFHEIV99,
 18831           DFHEIV11,
 18832           DFHEIV99
 18833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18834
 18835
 18836 8583-READ-ERAGTC-NEXT.
 18837
 18838* EXEC CICS READNEXT
 18839*        DATASET     (AGTC-ID)
 18840*        INTO        (AGENT-COMMISSIONS)
 18841*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 352
* EL050.cbl
 18842*    END-EXEC.
 18843     MOVE LENGTH OF
 18844      AGENT-COMMISSIONS
 18845       TO DFHEIV12
 18846     MOVE 0
 18847       TO DFHEIV11
 18848*    MOVE '&.IL                  )   #00017850' TO DFHEIV0
 18849     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18850     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18851     MOVE X'2020233030303137383530' TO DFHEIV0(25:11)
 18852     CALL 'kxdfhei1' USING DFHEIV0,
 18853           AGTC-ID,
 18854           AGENT-COMMISSIONS,
 18855           DFHEIV12,
 18856           ERAGTC-KEY,
 18857           DFHEIV99,
 18858           DFHEIV11,
 18859           DFHEIV99,
 18860           DFHEIV99
 18861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18862
 18863
 18864*    MOVE 'Y'                    TO AGTC-MASTER-SW
 18865
 18866     GO TO 8583-EXIT
 18867     .
 18868 8583-AGTC-NOT-FOUND.
 18869
 18870     MOVE 'N'                    TO AGTC-MASTER-SW.
 18871
 18872 8583-EXIT.
 18873     EXIT.
 18874
 18875 8584-READ-BANK-CROSS-REF.
 18876
 18877* EXEC CICS HANDLE CONDITION
 18878*        NOTFND    (8584-BXRF-NOT-FOUND)
 18879*        ENDFILE   (8584-BXRF-NOT-FOUND)
 18880*    END-EXEC.
 18881*    MOVE '"$I''                  ! 7 #00017868' TO DFHEIV0
 18882     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18883     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18884     MOVE X'3720233030303137383638' TO DFHEIV0(25:11)
 18885     CALL 'kxdfhei1' USING DFHEIV0
 18886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18887
 18888
 18889
 18890* EXEC CICS READ
 18891*        DATASET     (BXRF-ID)
 18892*        INTO        (BANK-CROSS-REFERENCE)
 18893*        RIDFLD      (ERBXRF-KEY)
 18894*        LENGTH      (BXRF-REC-LENGTH)
 18895*    END-EXEC.
 18896*    MOVE '&"IL       E          (   #00017873' TO DFHEIV0
 18897     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18899     MOVE X'2020233030303137383733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 353
* EL050.cbl
 18900     CALL 'kxdfhei1' USING DFHEIV0,
 18901           BXRF-ID,
 18902           BANK-CROSS-REFERENCE,
 18903           BXRF-REC-LENGTH,
 18904           ERBXRF-KEY,
 18905           DFHEIV99,
 18906           DFHEIV99,
 18907           DFHEIV99
 18908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18909
 18910
 18911     MOVE 'Y'                    TO BXRF-MASTER-SW
 18912
 18913     GO TO 8584-EXIT
 18914     .
 18915 8584-BXRF-NOT-FOUND.
 18916
 18917     MOVE 'N'                    TO BXRF-MASTER-SW.
 18918
 18919 8584-EXIT.
 18920     EXIT.
 18921
 18922 8585-READ-PLAN-MASTER.
 18923
 18924
 18925* EXEC CICS HANDLE CONDITION
 18926*        NOTFND    (8585-PLAN-NOT-FOUND)
 18927*        ENDFILE   (8585-PLAN-NOT-FOUND)
 18928*    END-EXEC.
 18929*    MOVE '"$I''                  ! 8 #00017893' TO DFHEIV0
 18930     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18932     MOVE X'3820233030303137383933' TO DFHEIV0(25:11)
 18933     CALL 'kxdfhei1' USING DFHEIV0
 18934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18935
 18936
 18937
 18938* EXEC CICS READ
 18939*        DATASET     (PLAN-ID)
 18940*        INTO        (PLAN-MASTER)
 18941*        RIDFLD      (ERPLAN-KEY)
 18942*    END-EXEC.
 18943     MOVE LENGTH OF
 18944      PLAN-MASTER
 18945       TO DFHEIV11
 18946*    MOVE '&"IL       E          (   #00017898' TO DFHEIV0
 18947     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18948     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18949     MOVE X'2020233030303137383938' TO DFHEIV0(25:11)
 18950     CALL 'kxdfhei1' USING DFHEIV0,
 18951           PLAN-ID,
 18952           PLAN-MASTER,
 18953           DFHEIV11,
 18954           ERPLAN-KEY,
 18955           DFHEIV99,
 18956           DFHEIV99,
 18957           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 354
* EL050.cbl
 18958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18959
 18960
 18961     MOVE 'Y'                    TO PLAN-MASTER-SW.
 18962
 18963     GO TO 8585-EXIT.
 18964
 18965 8585-PLAN-NOT-FOUND.
 18966
 18967     MOVE 'N'                    TO PLAN-MASTER-SW.
 18968
 18969 8585-EXIT.
 18970     EXIT.
 18971
 18972 8586-READ-LOAN-OFFICER.
 18973
 18974* EXEC CICS READ
 18975*        DATASET     (LOFC-ID)
 18976*        INTO        (LOAN-OFFICER-MASTER)
 18977*        RIDFLD      (ERLOFC-KEY)
 18978*        RESP        (WS-RESPONSE)
 18979*    END-EXEC
 18980     MOVE LENGTH OF
 18981      LOAN-OFFICER-MASTER
 18982       TO DFHEIV11
 18983*    MOVE '&"IL       E          (  N#00017916' TO DFHEIV0
 18984     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18986     MOVE X'204E233030303137393136' TO DFHEIV0(25:11)
 18987     CALL 'kxdfhei1' USING DFHEIV0,
 18988           LOFC-ID,
 18989           LOAN-OFFICER-MASTER,
 18990           DFHEIV11,
 18991           ERLOFC-KEY,
 18992           DFHEIV99,
 18993           DFHEIV99,
 18994           DFHEIV99
 18995     MOVE EIBRESP  TO WS-RESPONSE
 18996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18997
 18998     IF WS-RESP-NORMAL
 18999        MOVE 'Y'                 TO LOFC-MASTER-SW
 19000     ELSE
 19001        MOVE 'N'                 TO LOFC-MASTER-SW
 19002     END-IF
 19003     .
 19004 8586-EXIT.
 19005     EXIT.
 19006
 19007 8590-READ-CERT-MASTER.
 19008     IF PB-COMPANY-ID = 'UCL'
 19009         GO TO 8690-READ-CERT-MASTER-UCL.
 19010
 19011
 19012* EXEC CICS HANDLE CONDITION
 19013*         NOTFND    (0299-CERT-NOT-FOUND)
 19014*    END-EXEC.
 19015*    MOVE '"$I                   ! 9 #00017936' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 355
* EL050.cbl
 19016     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19018     MOVE X'3920233030303137393336' TO DFHEIV0(25:11)
 19019     CALL 'kxdfhei1' USING DFHEIV0
 19020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19021
 19022
 19023
 19024* EXEC CICS READ
 19025*        DATASET     (CERT-ID)
 19026*        INTO        (CERTIFICATE-MASTER)
 19027*        RIDFLD      (ELCERT-KEY)
 19028*        UPDATE
 19029*    END-EXEC.
 19030     MOVE LENGTH OF
 19031      CERTIFICATE-MASTER
 19032       TO DFHEIV11
 19033*    MOVE '&"IL       EU         (   #00017940' TO DFHEIV0
 19034     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19035     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19036     MOVE X'2020233030303137393430' TO DFHEIV0(25:11)
 19037     CALL 'kxdfhei1' USING DFHEIV0,
 19038           CERT-ID,
 19039           CERTIFICATE-MASTER,
 19040           DFHEIV11,
 19041           ELCERT-KEY,
 19042           DFHEIV99,
 19043           DFHEIV99,
 19044           DFHEIV99
 19045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19046
 19047
 19048 8590-EXIT.
 19049     EXIT.
 19050
 19051 8690-READ-CERT-MASTER-UCL.
 19052
 19053* EXEC CICS HANDLE CONDITION
 19054*         NOTFND    (8700-READ-CERT-MASTER)
 19055*    END-EXEC.
 19056*    MOVE '"$I                   ! : #00017951' TO DFHEIV0
 19057     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19059     MOVE X'3A20233030303137393531' TO DFHEIV0(25:11)
 19060     CALL 'kxdfhei1' USING DFHEIV0
 19061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19062
 19063
 19064 8690-READ-CERT-CONT.
 19065
 19066* EXEC CICS READ
 19067*        DATASET     (CERT-ID)
 19068*        INTO        (CERTIFICATE-MASTER)
 19069*        RIDFLD      (ELCERT-KEY)
 19070*        UPDATE
 19071*    END-EXEC.
 19072     MOVE LENGTH OF
 19073      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 356
* EL050.cbl
 19074       TO DFHEIV11
 19075*    MOVE '&"IL       EU         (   #00017956' TO DFHEIV0
 19076     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19077     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19078     MOVE X'2020233030303137393536' TO DFHEIV0(25:11)
 19079     CALL 'kxdfhei1' USING DFHEIV0,
 19080           CERT-ID,
 19081           CERTIFICATE-MASTER,
 19082           DFHEIV11,
 19083           ELCERT-KEY,
 19084           DFHEIV99,
 19085           DFHEIV99,
 19086           DFHEIV99
 19087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19088
 19089
 19090     GO TO 8590-EXIT.
 19091
 19092 8700-READ-CERT-MASTER.
 19093     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 19094     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 19095
 19096* EXEC CICS HANDLE CONDITION
 19097*         DUPKEY    (8720-COMP-ACCOUNTS)
 19098*         ENDFILE   (8730-END-BROWSE)
 19099*         NOTFND    (8740-NOT-FOUND)
 19100*    END-EXEC.
 19101*    MOVE '"$$''I                 ! ; #00017968' TO DFHEIV0
 19102     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 19103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19104     MOVE X'3B20233030303137393638' TO DFHEIV0(25:11)
 19105     CALL 'kxdfhei1' USING DFHEIV0
 19106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19107
 19108
 19109
 19110* EXEC CICS STARTBR
 19111*        DATASET     ('ELCERT5')
 19112*        RIDFLD      (ELCERT2-KEY)
 19113*        EQUAL
 19114*    END-EXEC.
 19115     MOVE 'ELCERT5' TO DFHEIV1
 19116     MOVE 0
 19117       TO DFHEIV11
 19118*    MOVE '&,         E          &   #00017974' TO DFHEIV0
 19119     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 19120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19121     MOVE X'2020233030303137393734' TO DFHEIV0(25:11)
 19122     CALL 'kxdfhei1' USING DFHEIV0,
 19123           DFHEIV1,
 19124           ELCERT2-KEY,
 19125           DFHEIV99,
 19126           DFHEIV11,
 19127           DFHEIV99
 19128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19129
 19130
 19131 8710-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 357
* EL050.cbl
 19132
 19133* EXEC CICS READNEXT
 19134*        DATASET     ('ELCERT5')
 19135*        INTO        (CERTIFICATE-MASTER)
 19136*        RIDFLD      (ELCERT2-KEY)
 19137*    END-EXEC.
 19138     MOVE LENGTH OF
 19139      CERTIFICATE-MASTER
 19140       TO DFHEIV12
 19141     MOVE 'ELCERT5' TO DFHEIV1
 19142     MOVE 0
 19143       TO DFHEIV11
 19144*    MOVE '&.IL                  )   #00017981' TO DFHEIV0
 19145     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19146     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19147     MOVE X'2020233030303137393831' TO DFHEIV0(25:11)
 19148     CALL 'kxdfhei1' USING DFHEIV0,
 19149           DFHEIV1,
 19150           CERTIFICATE-MASTER,
 19151           DFHEIV12,
 19152           ELCERT2-KEY,
 19153           DFHEIV99,
 19154           DFHEIV11,
 19155           DFHEIV99,
 19156           DFHEIV99
 19157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19158
 19159
 19160 8720-COMP-ACCOUNTS.
 19161
 19162* EXEC CICS ENTER
 19163*         TRACEID (001)
 19164*         FROM (PB-C-LAST-NAME)
 19165*    END-EXEC.
 19166     MOVE 001
 19167       TO DFHEIV11
 19168*    MOVE ':$F                   %   #00017988' TO DFHEIV0
 19169     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 19170     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19171     MOVE X'2020233030303137393838' TO DFHEIV0(25:11)
 19172     CALL 'kxdfhei1' USING DFHEIV0,
 19173           DFHEIV11,
 19174           PB-C-LAST-NAME,
 19175           DFHEIV99,
 19176           DFHEIV99
 19177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19178
 19179
 19180
 19181* EXEC CICS ENTER
 19182*         TRACEID (002)
 19183*         FROM (CM-INSURED-LAST-NAME)
 19184*    END-EXEC.
 19185     MOVE 002
 19186       TO DFHEIV11
 19187*    MOVE ':$F                   %   #00017993' TO DFHEIV0
 19188     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 19189     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 358
* EL050.cbl
 19190     MOVE X'2020233030303137393933' TO DFHEIV0(25:11)
 19191     CALL 'kxdfhei1' USING DFHEIV0,
 19192           DFHEIV11,
 19193           CM-INSURED-LAST-NAME,
 19194           DFHEIV99,
 19195           DFHEIV99
 19196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19197
 19198
 19199     IF PB-CERT-NO NOT = CM-CERT-NO
 19200         GO TO 8730-END-BROWSE.
 19201
 19202     IF PB-ACCOUNT = CM-ACCOUNT
 19203         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 19204             MOVE ER-2799        TO WS-ERROR
 19205             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19206             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 19207             GO TO 8730-END-BROWSE.
 19208
 19209     GO TO 8710-READ-NEXT.
 19210
 19211 8730-END-BROWSE.
 19212
 19213* EXEC CICS ENDBR
 19214*         DATASET    ('ELCERT5')
 19215*    END-EXEC.
 19216     MOVE 'ELCERT5' TO DFHEIV1
 19217     MOVE 0
 19218       TO DFHEIV11
 19219*    MOVE '&2                    $   #00018011' TO DFHEIV0
 19220     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19221     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19222     MOVE X'2020233030303138303131' TO DFHEIV0(25:11)
 19223     CALL 'kxdfhei1' USING DFHEIV0,
 19224           DFHEIV1,
 19225           DFHEIV11,
 19226           DFHEIV99
 19227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19228
 19229
 19230 8740-NOT-FOUND.
 19231     GO TO 0299-CERT-NOT-FOUND.
 19232
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 359
* EL050.cbl
 19234
 19235 8800-GET-COMP-RATE.
 19236     MOVE +1 TO IB.
 19237     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 19238         ADD +9 TO IB
 19239         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 19240             ADD +9 TO IB
 19241             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 19242                MOVE ZEROS       TO WS-WK-RATE
 19243                GO TO 8800-EXIT.
 19244
 19245     IF PB-I-AGE GREATER CT-AGE (1)
 19246         ADD +3 TO IB
 19247         IF PB-I-AGE GREATER CT-AGE (2)
 19248             ADD +3 TO IB
 19249             IF PB-I-AGE GREATER CT-AGE (3)
 19250                MOVE ZEROS       TO WS-WK-RATE
 19251                GO TO 8800-EXIT.
 19252
 19253     IF WS-WORK-TERM GREATER CT-TRM (1)
 19254         ADD +1 TO IB
 19255         IF WS-WORK-TERM GREATER CT-TRM (2)
 19256             ADD +1 TO IB
 19257             IF WS-WORK-TERM GREATER CT-TRM (3)
 19258                MOVE ZEROS       TO WS-WK-RATE
 19259                GO TO 8800-EXIT.
 19260
 19261     IF CT-RT (IB) NOT NUMERIC
 19262         MOVE CT-RT-R (IB) TO CTBL-TABLE
 19263         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 19264         GO TO 8800-GET-COMP-RATE.
 19265
 19266     MOVE CT-RT (IB) TO WS-WK-RATE.
 19267
 19268 8800-EXIT.
 19269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 360
* EL050.cbl
 19271 8900-ADDRESS-FILE.
 19272     IF ERACCT-FILE-ADDRESSED
 19273         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 19274         GO TO 8900-ADDRESS-EXIT.
 19275
 19276     IF ELCNTL-FILE-ADDRESSED
 19277         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 19278         GO TO 8900-ADDRESS-EXIT.
 19279
 19280     IF ERPLAN-FILE-ADDRESSED
 19281         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 19282         GO TO 8900-ADDRESS-EXIT.
 19283
 19284     IF ERFORM-FILE-ADDRESSED
 19285         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 19286         GO TO 8900-ADDRESS-EXIT.
 19287
 19288 8900-ADDRESS-EXIT.
 19289     EXIT.
 19290
 19291 9000-READ-CONTROL.
 19292
 19293* EXEC CICS HANDLE CONDITION
 19294*        NOTFND    (9000-NOTFND)
 19295*    END-EXEC.
 19296*    MOVE '"$I                   ! < #00018077' TO DFHEIV0
 19297     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19298     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19299     MOVE X'3C20233030303138303737' TO DFHEIV0(25:11)
 19300     CALL 'kxdfhei1' USING DFHEIV0
 19301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19302
 19303
 19304
 19305* EXEC CICS READ
 19306*        DATASET     (CNTL-ID)
 19307*        SET         (ADDRESS OF CONTROL-FILE)
 19308*        RIDFLD      (ELCNTL-KEY)
 19309*        GTEQ
 19310*    END-EXEC.
 19311*    MOVE '&"S        G          (   #00018081' TO DFHEIV0
 19312     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19313     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19314     MOVE X'2020233030303138303831' TO DFHEIV0(25:11)
 19315     CALL 'kxdfhei1' USING DFHEIV0,
 19316           CNTL-ID,
 19317           DFHEIV20,
 19318           DFHEIV99,
 19319           ELCNTL-KEY,
 19320           DFHEIV99,
 19321           DFHEIV99,
 19322           DFHEIV99
 19323     SET ADDRESS OF CONTROL-FILE TO
 19324         DFHEIV20
 19325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19326
 19327
 19328     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 361
* EL050.cbl
 19329
 19330 9000-NOTFND.
 19331     IF RC-SW-1 = '1'
 19332        MOVE ER-2616              TO WS-ERROR
 19333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19334        GO TO 9000-EXIT.
 19335
 19336     IF RC-SW-1 = '2'
 19337        MOVE ER-2602              TO WS-ERROR
 19338        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19339
 19340 9000-EXIT.
 19341      EXIT.
 19342
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 362
* EL050.cbl
 19344 9100-READ-CONTROL.
 19345
 19346* EXEC CICS HANDLE CONDITION
 19347*        NOTFND  (9100-NOTFND)
 19348*        ENDFILE (9100-NOTFND)
 19349*    END-EXEC.
 19350*    MOVE '"$I''                  ! = #00018105' TO DFHEIV0
 19351     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19353     MOVE X'3D20233030303138313035' TO DFHEIV0(25:11)
 19354     CALL 'kxdfhei1' USING DFHEIV0
 19355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19356
 19357
 19358
 19359* EXEC CICS READ
 19360*        DATASET     (CNTL-ID)
 19361*        INTO        (CONTROL-FILE)
 19362*        RIDFLD      (ELCNTL-KEY)
 19363*        GTEQ
 19364*    END-EXEC.
 19365     MOVE LENGTH OF
 19366      CONTROL-FILE
 19367       TO DFHEIV11
 19368*    MOVE '&"IL       G          (   #00018110' TO DFHEIV0
 19369     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19371     MOVE X'2020233030303138313130' TO DFHEIV0(25:11)
 19372     CALL 'kxdfhei1' USING DFHEIV0,
 19373           CNTL-ID,
 19374           CONTROL-FILE,
 19375           DFHEIV11,
 19376           ELCNTL-KEY,
 19377           DFHEIV99,
 19378           DFHEIV99,
 19379           DFHEIV99
 19380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19381
 19382
 19383     GO TO 9100-EXIT.
 19384
 19385 9100-NOTFND.
 19386     IF RC-SW-2 = '0'
 19387        MOVE '1'                  TO STATE-RECORD-ERROR
 19388        GO TO 9100-EXIT
 19389     END-IF
 19390     IF RC-SW-2 = '1'
 19391        MOVE '1'                  TO LF-BENEFIT-ERROR
 19392        MOVE ER-2604              TO WS-ERROR
 19393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19394        GO TO 9100-EXIT.
 19395
 19396     IF RC-SW-2 = '2'
 19397        MOVE '1'                  TO AH-BENEFIT-ERROR
 19398        MOVE ER-2605              TO WS-ERROR
 19399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19400        GO TO 9100-EXIT.
 19401
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 363
* EL050.cbl
 19402     IF RC-SW-2 = '3'
 19403         MOVE ER-2603           TO WS-ERROR
 19404         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19405         GO TO 9100-EXIT.
 19406
 19407     IF RC-SW-2 = '4'
 19408         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 19409         GO TO 9100-EXIT.
 19410
 19411     IF RC-SW-2 = '5'
 19412         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 19413         IF WS-AH-INPUT-CD-1 = SPACE
 19414             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 19415         ELSE
 19416             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 19417
 19418 9100-EXIT.
 19419      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 364
* EL050.cbl
 19421 9200-CONTROL-GETMAIN.
 19422
 19423* EXEC CICS GETMAIN
 19424*         LENGTH   (750)
 19425*         SET      (ADDRESS OF CONTROL-FILE)
 19426*    END-EXEC.
 19427     MOVE 750
 19428       TO DFHEIV11
 19429*    MOVE '," L                  $   #00018156' TO DFHEIV0
 19430     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19431     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19432     MOVE X'2020233030303138313536' TO DFHEIV0(25:11)
 19433     CALL 'kxdfhei1' USING DFHEIV0,
 19434           DFHEIV20,
 19435           DFHEIV11,
 19436           DFHEIV99
 19437     SET ADDRESS OF CONTROL-FILE TO
 19438         DFHEIV20
 19439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19440
 19441
 19442     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 19443
 19444 9200-EXIT.
 19445     EXIT.
 19446
 19447 9250-UNLOCK-RETURN.
 19448
 19449* EXEC CICS UNLOCK
 19450*        DATASET   (CERT-ID)
 19451*    END-EXEC.
 19452*    MOVE '&*                    #   #00018167' TO DFHEIV0
 19453     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19454     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19455     MOVE X'2020233030303138313637' TO DFHEIV0(25:11)
 19456     CALL 'kxdfhei1' USING DFHEIV0,
 19457           CERT-ID,
 19458           DFHEIV99
 19459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19460
 19461
 19462 9300-ABEND.
 19463     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 19464
 19465
 19466* EXEC CICS LINK
 19467*        PROGRAM   ('EL004')
 19468*        COMMAREA  (WS-ERROR-LINE)
 19469*        LENGTH    (72)
 19470*    END-EXEC.
 19471     MOVE 'EL004' TO DFHEIV1
 19472     MOVE 72
 19473       TO DFHEIV11
 19474*    MOVE '."C                   ''   #00018174' TO DFHEIV0
 19475     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19476     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19477     MOVE X'2020233030303138313734' TO DFHEIV0(25:11)
 19478     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 365
* EL050.cbl
 19479           DFHEIV1,
 19480           WS-ERROR-LINE,
 19481           DFHEIV11,
 19482           DFHEIV99,
 19483           DFHEIV99,
 19484           DFHEIV99
 19485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19486
 19487
 19488     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 19489
 19490
 19491* EXEC CICS ABEND
 19492*        ABCODE ('EL50')
 19493*    END-EXEC.
 19494     MOVE 'EL50' TO DFHEIV5
 19495*    MOVE '.,A                   "   #00018182' TO DFHEIV0
 19496     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 19497     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 19498     MOVE X'2020233030303138313832' TO DFHEIV0(25:11)
 19499     CALL 'kxdfhei1' USING DFHEIV0,
 19500           DFHEIV5
 19501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19502
 19503
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 366
* EL050.cbl
 19505
 19506******************************************************************
 19507*                                                                *
 19508*            E R R O R   F O R M A T   R O U T I N E             *
 19509*                                                                *
 19510******************************************************************
 19511
 19512 9900-ERROR-FORMAT.
 19513
 19514     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 19515                    PB-COMMON-ERROR (2) OR
 19516                    PB-COMMON-ERROR (3) OR
 19517                    PB-COMMON-ERROR (4) OR
 19518                    PB-COMMON-ERROR (5) OR
 19519                    PB-COMMON-ERROR (6) OR
 19520                    PB-COMMON-ERROR (7) OR
 19521                    PB-COMMON-ERROR (8) OR
 19522                    PB-COMMON-ERROR (9) OR
 19523                    PB-COMMON-ERROR (10)
 19524        GO TO 9900-EXIT.
 19525
 19526     IF PB-NO-OF-ERRORS = +10
 19527        GO TO 9900-EXIT.
 19528
 19529     ADD +1  TO PB-NO-OF-ERRORS.
 19530     MOVE WS-ERROR               TO PB-COMMON-ERROR
 19531                                       (PB-NO-OF-ERRORS).
 19532 9900-EXIT.
 19533     EXIT.
 19534
 19535 9990-RETURN.
 19536     IF BROWSE-STARTED
 19537
 19538* EXEC CICS ENDBR
 19539*            DATASET  (ACCT-ID)
 19540*       END-EXEC.
 19541     MOVE 0
 19542       TO DFHEIV11
 19543*    MOVE '&2                    $   #00018219' TO DFHEIV0
 19544     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19545     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19546     MOVE X'2020233030303138323139' TO DFHEIV0(25:11)
 19547     CALL 'kxdfhei1' USING DFHEIV0,
 19548           ACCT-ID,
 19549           DFHEIV11,
 19550           DFHEIV99
 19551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19552
 19553
 19554 9990-EXIT.
 19555     EXIT.
 19556
 19557 9999-RETURN.
 19558     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 19559
 19560
 19561* EXEC CICS RETURN
 19562*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 367
* EL050.cbl
 19563*    MOVE '.(                    &   #00018229' TO DFHEIV0
 19564     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19565     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19566     MOVE X'2020233030303138323239' TO DFHEIV0(25:11)
 19567     CALL 'kxdfhei1' USING DFHEIV0,
 19568           DFHEIV99,
 19569           DFHEIV99,
 19570           DFHEIV99,
 19571           DFHEIV99,
 19572           DFHEIV99
 19573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19574
 19575
 19576
 19577* GOBACK.
 19578     MOVE '9%                    "   ' TO DFHEIV0
 19579     MOVE 'EL050' TO DFHEIV1
 19580     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19581     GOBACK.
 19582
 19583 9999-DFHBACK SECTION.
 19584     MOVE '9%                    "   ' TO DFHEIV0
 19585     MOVE 'EL050' TO DFHEIV1
 19586     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19587     GOBACK.
 19588 9999-DFHEXIT.
 19589     IF DFHEIGDJ EQUAL 0001
 19590         NEXT SENTENCE
 19591     ELSE IF DFHEIGDJ EQUAL 2
 19592         GO TO 9300-ABEND,
 19593               3990-FILES-NOT-OPEN
 19594         DEPENDING ON DFHEIGDI
 19595     ELSE IF DFHEIGDJ EQUAL 3
 19596         GO TO 6610-START-BROWSE,
 19597               6630-ERRESS-PROBLEM,
 19598               6630-END-OF-FILE
 19599         DEPENDING ON DFHEIGDI
 19600     ELSE IF DFHEIGDJ EQUAL 4
 19601         GO TO 6630-END-OF-FILE,
 19602               6630-ERRESS-PROBLEM,
 19603               6630-ERRESS-PROBLEM,
 19604               6630-END-OF-FILE
 19605         DEPENDING ON DFHEIGDI
 19606     ELSE IF DFHEIGDJ EQUAL 5
 19607         GO TO 6630-END-OF-FILE,
 19608               6630-END-OF-FILE,
 19609               6630-ERRESS-PROBLEM,
 19610               6630-ERRESS-PROBLEM
 19611         DEPENDING ON DFHEIGDI
 19612     ELSE IF DFHEIGDJ EQUAL 6
 19613         GO TO 6660-START-BROWSE,
 19614               6690-ERRESC-PROBLEM,
 19615               6690-ERRESC-PROBLEM,
 19616               6690-END-OF-FILE
 19617         DEPENDING ON DFHEIGDI
 19618     ELSE IF DFHEIGDJ EQUAL 7
 19619         GO TO 6690-END-OF-FILE,
 19620               6690-ERRESC-PROBLEM,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 368
* EL050.cbl
 19621               6690-ERRESC-PROBLEM,
 19622               6690-END-OF-FILE
 19623         DEPENDING ON DFHEIGDI
 19624     ELSE IF DFHEIGDJ EQUAL 8
 19625         GO TO 6690-END-OF-FILE,
 19626               6690-ERRESC-PROBLEM,
 19627               6690-ERRESC-PROBLEM,
 19628               6690-END-OF-FILE
 19629         DEPENDING ON DFHEIGDI
 19630     ELSE IF DFHEIGDJ EQUAL 9
 19631         GO TO 7300-CONTINUE,
 19632               7300-CONTINUE
 19633         DEPENDING ON DFHEIGDI
 19634     ELSE IF DFHEIGDJ EQUAL 10
 19635         GO TO 8000-FREE-MAIN
 19636         DEPENDING ON DFHEIGDI
 19637     ELSE IF DFHEIGDJ EQUAL 11
 19638         GO TO 8100-NOTFND,
 19639               8100-NOTFND
 19640         DEPENDING ON DFHEIGDI
 19641     ELSE IF DFHEIGDJ EQUAL 12
 19642         GO TO 8110-NOTFND,
 19643               8110-NOTFND
 19644         DEPENDING ON DFHEIGDI
 19645     ELSE IF DFHEIGDJ EQUAL 13
 19646         GO TO 8130-EXIT
 19647         DEPENDING ON DFHEIGDI
 19648     ELSE IF DFHEIGDJ EQUAL 14
 19649         GO TO 8180-NOTFND
 19650         DEPENDING ON DFHEIGDI
 19651     ELSE IF DFHEIGDJ EQUAL 15
 19652         GO TO 8190-NOTFND
 19653         DEPENDING ON DFHEIGDI
 19654     ELSE IF DFHEIGDJ EQUAL 16
 19655         GO TO 8200-NOTFND
 19656         DEPENDING ON DFHEIGDI
 19657     ELSE IF DFHEIGDJ EQUAL 17
 19658         GO TO 8300-NOTFND,
 19659               8300-ERRESS-PROBLEM,
 19660               8300-ERRESS-PROBLEM,
 19661               8300-NOTFND
 19662         DEPENDING ON DFHEIGDI
 19663     ELSE IF DFHEIGDJ EQUAL 18
 19664         GO TO 8450-FORM-NOT-FOUND,
 19665               8450-FORM-NOT-FOUND
 19666         DEPENDING ON DFHEIGDI
 19667     ELSE IF DFHEIGDJ EQUAL 19
 19668         GO TO 0199-ACCT-NOT-FOUND,
 19669               0199-ACCT-NOT-FOUND
 19670         DEPENDING ON DFHEIGDI
 19671     ELSE IF DFHEIGDJ EQUAL 20
 19672         GO TO 0199-ACCT-NOT-FOUND,
 19673               0199-ACCT-NOT-FOUND
 19674         DEPENDING ON DFHEIGDI
 19675     ELSE IF DFHEIGDJ EQUAL 21
 19676         GO TO 8582-COMP-NOT-FOUND,
 19677               8582-COMP-NOT-FOUND
 19678         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 16-Mar-11 15:01 Page 369
* EL050.cbl
 19679     ELSE IF DFHEIGDJ EQUAL 22
 19680         GO TO 8583-AGTC-NOT-FOUND,
 19681               8583-AGTC-NOT-FOUND
 19682         DEPENDING ON DFHEIGDI
 19683     ELSE IF DFHEIGDJ EQUAL 23
 19684         GO TO 8584-BXRF-NOT-FOUND,
 19685               8584-BXRF-NOT-FOUND
 19686         DEPENDING ON DFHEIGDI
 19687     ELSE IF DFHEIGDJ EQUAL 24
 19688         GO TO 8585-PLAN-NOT-FOUND,
 19689               8585-PLAN-NOT-FOUND
 19690         DEPENDING ON DFHEIGDI
 19691     ELSE IF DFHEIGDJ EQUAL 25
 19692         GO TO 0299-CERT-NOT-FOUND
 19693         DEPENDING ON DFHEIGDI
 19694     ELSE IF DFHEIGDJ EQUAL 26
 19695         GO TO 8700-READ-CERT-MASTER
 19696         DEPENDING ON DFHEIGDI
 19697     ELSE IF DFHEIGDJ EQUAL 27
 19698         GO TO 8720-COMP-ACCOUNTS,
 19699               8730-END-BROWSE,
 19700               8740-NOT-FOUND
 19701         DEPENDING ON DFHEIGDI
 19702     ELSE IF DFHEIGDJ EQUAL 28
 19703         GO TO 9000-NOTFND
 19704         DEPENDING ON DFHEIGDI
 19705     ELSE IF DFHEIGDJ EQUAL 29
 19706         GO TO 9100-NOTFND,
 19707               9100-NOTFND
 19708         DEPENDING ON DFHEIGDI.
 19709     MOVE '9%                    "   ' TO DFHEIV0
 19710     MOVE 'EL050' TO DFHEIV1
 19711     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19712     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       37820     Code:       78024
