* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    45* 121417  IR2017121200001  PEMA  Correct assignment of ben period
    46* 011118  CR2016052500002  TANA  Add Message for pre-existing
    47* 052918  CR2018031500002  TANA  Add Message for filing time limit
    48* 061418  IR2018053000003  TANA  Fix Causal state / filing limit
    49* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    50******************************************************************
    51
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page   3
* EL130.cbl
    53 ENVIRONMENT DIVISION.
    54 DATA DIVISION.
    55 WORKING-STORAGE SECTION.
    56 01  DFH-START PIC X(04).
    57 77  FILLER  PIC X(32)  VALUE '********************************'.
    58 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    59 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    60 77  A1                          PIC S999 COMP-3 VALUE +0.
    61 77  E1                          PIC S999 COMP-3 VALUE +0.
    62 77  s1                          pic s999 comp-3 value +0.
    63 77  s2                          pic s999 comp-3 value +0.
    64 77  P1                          PIC S999 COMP-3 VALUE +0.
    65 77  P2                          PIC S999 COMP-3 VALUE +0.
    66 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    67 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    68 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    69 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    70 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    71 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    72 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    73 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    74     88  ERPDEF-FOUND                 VALUE 'Y'.
    75 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    76 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    77 77  ws-dcc-product-code         pic xxx value spaces.
    78 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    79 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    80 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    81 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    82 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    83 77  ws-zero-bens-avail          pic x value ' '.
    84 77  WS-PRE-EXISTING-PER         PIC 99    VALUE ZEROS.
    85*    COPY ELCSCTM.
    86******************************************************************
    87*                                                                *
    88*                                                                *
    89*                            ELCSCTM                             *
    90*                            VMOD=2.001                          *
    91*                                                                *
    92*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    93*                                                                *
    94******************************************************************
    95 01  SECURITY-MESSAGE.
    96     12  FILLER                          PIC X(30)
    97            VALUE '** LOGIC SECURITY VIOLATION -'.
    98     12  SM-READ                         PIC X(6).
    99     12  FILLER                          PIC X(5)
   100            VALUE ' PGM='.
   101     12  SM-PGM                          PIC X(6).
   102     12  FILLER                          PIC X(5)
   103            VALUE ' OPR='.
   104     12  SM-PROCESSOR-ID                 PIC X(4).
   105     12  FILLER                          PIC X(6)
   106            VALUE ' TERM='.
   107     12  SM-TERMID                       PIC X(4).
   108     12  FILLER                          PIC XX   VALUE SPACE.
   109     12  SM-JUL-DATE                     PIC 9(5).
   110     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page   4
* EL130.cbl
   111     12  SM-TIME                         PIC 99.99.
   112
   113
   114*    COPY ELCSCRTY.
   115******************************************************************
   116*                                                                *
   117*                                                                *
   118*                            ELCSCRTY                            *
   119*                            VMOD=2.001                          *
   120*                                                                *
   121*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   122*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   123*        SAVED IN PI-SECURITY-ADDRESS.                           *
   124*                                                                *
   125******************************************************************
   126 01  SECURITY-CONTROL.
   127     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   128     12  FILLER                       PIC XX    VALUE 'SC'.
   129     12  SC-CREDIT-CODES.
   130         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   131             20  SC-CREDIT-DISPLAY    PIC X.
   132             20  SC-CREDIT-UPDATE     PIC X.
   133     12  SC-CLAIMS-CODES.
   134         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   135             20  SC-CLAIMS-DISPLAY    PIC X.
   136             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page   5
* EL130.cbl
   138 01  WS-DATE-AREA.
   139     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   140     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   141     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   142
   143 01  ws-dcc-error-line.
   144     05  filler occurs 15.
   145         10  ws-error-no        pic x(4).
   146 01  WS-CRI-SSN-WORK-AREA.
   147     05  WS-CRI-SOC-SEC-NO.
   148         10  WS-SS-REPT-CD       PIC X(5).
   149         10  WS-SS-LAST-NAME     PIC X(5).
   150         10  WS-SS-INITIAL       PIC X.
   151
   152     05  WS-CRI-REPORT-CODE.
   153         10  FILLER              PIC X(5).
   154         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   155
   156     05  WS-CRI-LAST-NAME.
   157         10  WS-CRI-NAME-MOVE    PIC X(5).
   158         10  FILLER              PIC X(10).
   159
   160 01  STANDARD-AREAS.
   161     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   162     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   163     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   164     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   165     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   166     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   167     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   168     12  PGM-NAME            PIC X(8).
   169     12  TIME-IN             PIC S9(7).
   170     12  TIME-OUT-R  REDEFINES TIME-IN.
   171         16  FILLER          PIC X.
   172         16  TIME-OUT        PIC 99V99.
   173         16  FILLER          PIC X(2).
   174     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   175     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   176     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   177     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   178     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   179     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   180     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   181     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   182     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   183     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   184     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   185     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   186     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   187     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   188     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   189     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   190     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   191     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   192     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   193     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   194     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   195     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page   6
* EL130.cbl
   196     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   197     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   198     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   199     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   200     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   201     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   202     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   203     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   204     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   205     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   206     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   207     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   208     12  FILE-ID             PIC X(8).
   209     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   210     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   211     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   212     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   213     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   214     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   215     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   216     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   217     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   218
   219 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   220     12  M                   PIC S9(7)V99           VALUE ZEROS.
   221     12  L                   PIC S9(7)V99           VALUE ZEROS.
   222     12  N                   PIC S9(3)              VALUE ZEROS.
   223     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   224     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   225     12  I                   PIC S99V9(5)           VALUE ZEROS.
   226     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   227     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   228     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   229     12  R                   PIC S9(3)              VALUE ZEROS.
   230     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   231     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   232     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   233     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   234     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   235     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   236     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   237     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   238     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   239
   240 01  TERM-CALC-WORK-AREA.
   241     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   242     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   243     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   244     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   245     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   246     12  V-EXPONENTS.
   247        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   248     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   249
   250 01  MISC-WORK-AREAS.
   251     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   252     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   253     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page   7
* EL130.cbl
   254     12  QID.
   255         16  QID-TERM        PIC X(4).
   256         16  FILLER          PIC X(4)    VALUE '130A'.
   257     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   258     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   259     12  WS-GROUP-NO.
   260         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   261         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   262
   263     12  WS-RESPONSE         PIC S9(8)   COMP.
   264         88  WS-RESP-NORMAL              VALUE +00.
   265         88  WS-RESP-ERROR               VALUE +01.
   266         88  WS-RESP-NOTFND              VALUE +13.
   267         88  WS-RESP-DUPKEY              VALUE +15.
   268         88  WS-RESP-NOTOPEN             VALUE +19.
   269         88  WS-RESP-ENDFILE             VALUE +20.
   270
   271***************************************************************
   272*                                                             *
   273*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   274*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   275*    CHANGES WITH IN MAP EL130A.                              *
   276*                                                             *
   277***************************************************************
   278
   279     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   280     12  WS-SAVE-CLAIM-MASTER.
   281         16  FILLER                    PIC XX.
   282         16  WS-SAVE-CLAIM-KEY.
   283             20  WS-SAVE-COMPANY-CD    PIC X.
   284             20  WS-SAVE-CARRIER       PIC X.
   285             20  WS-SAVE-CLAIM-NO      PIC X(7).
   286             20  WS-SAVE-CERT-NO       PIC X(11).
   287         16  FILLER                    PIC X(328).
   288     12  SAVE-CURRENT-DATE         PIC XX.
   289     12  SAVE-CONTROL              PIC X(39).
   290     12  SAVE-ERACCT-KEY           PIC X(26).
   291     12  SAVE-COUNTER              PIC S9(8)   COMP.
   292     12  SAVE-METHOD               PIC X.
   293     12  SAVE-COMPANY-ID           PIC XXX.
   294     12  SAVE-COMPANY-CD           PIC X.
   295     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   296     12  SAVE-CREDIT-USER          PIC X.
   297     12  SAVE-CLAIM-USER           PIC X.
   298     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   299     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   300     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   301     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   302     12  SAVE-AH-OVERRIDE-L1       PIC X.
   303     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   304     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   305     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   306     12  FILLER                    PIC X.
   307*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   308     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   309     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   310     12  SAVE-EL127-TO-EL130-CNTRL.
   311         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page   8
* EL130.cbl
   312         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   313         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   314             20  SAVE-EL127-CARRIER  PIC X.
   315             20  SAVE-EL127-GROUPING PIC X(6).
   316             20  SAVE-EL127-STATE    PIC X(2).
   317             20  SAVE-EL127-ACCOUNT  PIC X(10).
   318             20  SAVE-EL127-CERT-NO  PIC X(11).
   319             20  SAVE-EL127-EFF-DT   PIC XX.
   320     12  SAVE-EL659-TO-EL130-CNTRL.
   321         16  SAVE-EL659-CARRIER    PIC X.
   322         16  SAVE-EL659-GROUPING   PIC X(6).
   323         16  SAVE-EL659-STATE      PIC XX.
   324         16  SAVE-EL659-ACCOUNT    PIC X(10).
   325     12  DIVIDE-QUOT               PIC 999.
   326     12  DIVIDE-REM                PIC 999.
   327     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   328     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   329     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   330     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   331     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   332     12  WS-RESERVE-CONTROLS       PIC X(9).
   333     12  WS-EXPENSE-CONTROLS       PIC X(7).
   334     12  WS-REIN-TABLE.
   335         16  WS-REIN-1             PIC X            VALUE SPACE.
   336         16  WS-REIN-2             PIC X            VALUE SPACE.
   337         16  WS-REIN-3             PIC X            VALUE SPACE.
   338     12  WS-BENE-CALC-METHOD       PIC X.
   339     12  ws-lf-joint-indicator     pic x.
   340     12  ws-ah-joint-indicator     pic x.
   341     12  WS-EARNINGS-CALC          PIC X.
   342     12  WS-LF-EARNINGS-CALC       PIC X.
   343         88 TEX-REG                VALUE '4'.
   344         88 NET-PAY                VALUE '5'.
   345     12  WS-AH-EARNINGS-CALC       PIC X.
   346     12  WS-SPECIAL-CALC-CD        PIC X(01).
   347     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   348     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   349     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   350     12  WS-ICD-CODE-1             PIC X(8).
   351     12  WS-ICD-CODE-2             PIC X(8).
   352     12  WS-CLAIM-NUMBER.
   353         16  WS-CN-PREFIX.
   354             20  WS-CN-PRF-A PIC X.
   355             20  WS-CN-PRF-B PIC X.
   356         16  WS-CN-NUMBER    PIC 9(5).
   357     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   358     12  WS-CLAIM-SEQU.
   359         16  FILLER          PIC X    VALUE '('.
   360         16  WS-CURRENT-SEQU PIC Z9.
   361         16  FILLER          PIC X(4) VALUE ' OF '.
   362         16  WS-OF-SEQU      PIC Z9.
   363         16  FILLER          PIC X    VALUE ')'.
   364     12  DATE-WORK.
   365       14  FILLER                PIC XX.
   366       14  DATE-MM               PIC XX.
   367       14  DATE-DD               PIC XX.
   368       14  DATE-YY               PIC XX.
   369     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page   9
* EL130.cbl
   370         16  CURR-MM.
   371           18  CURR-M1           PIC 9.
   372           18  CURR-M2           PIC 9.
   373         16  FILLER              PIC X(5).
   374         16  CURR-YEAR           PIC 9.
   375     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   376     12  SUB                     PIC 99.
   377     12  MY-DATE.
   378         16  MY-MM               PIC XX.
   379         16  FILLER              PIC X VALUE '/'.
   380         16  MY-YY               PIC XX.
   381
   382     12  WS-EDIT-BEN-CODE        PIC XX.
   383         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   384                                          '90' THRU '99'.
   385
   386     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   387     12  WS-BEN-HOLD             PIC XX.
   388     12  WS-BEN-ALPHA-HOLD.
   389         15  WS-BEN-ALPHA-2      PIC XX.
   390         15  WS-BEN-ALPHA-1      PIC X.
   391     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   392     12  WS-REC-TYPE             PIC X.
   393     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   394     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   395     12  ARCH-NUMBER             PIC S9(8)   COMP.
   396     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   397         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   398         88  REIN-REC-FOUND                  VALUE 'Y'.
   399
   400     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   401     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   402
   403
   404 01  CSO-WORK-FIELDS.
   405     12  WS-BLANK            PIC X       VALUE ' '.
   406
   407     12  WS-MA-CONTROL-PRIMARY.
   408         16  WS-MA-COMPANY-CD        PIC  X.
   409         16  WS-MA-CARRIER           PIC  X.
   410         16  WS-MA-GROUPING          PIC  X(6).
   411         16  WS-MA-STATE             PIC  XX.
   412         16  WS-MA-ACCOUNT           PIC  X(10).
   413         16  WS-MA-CERT-EFF-DT       PIC  XX.
   414         16  WS-MA-CERT-NO.
   415             20  WS-MA-CERT-PRIME    PIC  X(10).
   416             20  WS-MA-CERT-SFX      PIC  X.
   417
   418     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   419     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   420     12  WS-SOC-SEC-NUMBER.
   421         16  WS-SOC-SEC-NO       PIC 9(9).
   422         16  WS-SOC-SEC-BLANK    PIC X(2).
   423     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   424         16  WS-SSN-1-3          PIC 9(3).
   425         16  WS-SSN-DASH1        PIC X(1).
   426         16  WS-SSN-4-5          PIC 9(2).
   427         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  10
* EL130.cbl
   428         16  WS-SSN-6-9          PIC 9(4).
   429
   430     12  WS-DIAG-VIN-MSG.
   431         16  FILLER          PIC X(11)
   432             VALUE 'VIN NUMBER '.
   433         16  WS-DIAG-VIN     PIC X(17).
   434
   435     12  WS-VERIFY-NOTE      PIC X(34)
   436         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   437
   438     12  WS-CAUSAL-NOTE      PIC X(40)
   439         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   440
   441     12  WS-VFY-SSN-NOTE     PIC X(25)
   442         VALUE 'SSN VERIFICATION REQUIRED'.
   443
   444     12  WS-FILING-NOTE     PIC X(30)
   445         VALUE 'FILING TIME LIMIT EXCEEDED'.
   446
   447 01  MAP-DATE-AREAS.
   448     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   449     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   450     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   451     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   452     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   453     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   454     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   455     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   456     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   457     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   458     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   459     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   460     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   461     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   462     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   463     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   464     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   465     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   466     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   467         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   468     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   469     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   470     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   471     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   472
   473 01  ACCESS-KEYS.
   474     12  ELACTQ-KEY.
   475         16  ELACTQ-COMPANY-CD       PIC X.
   476         16  ELACTQ-CARRIER          PIC X.
   477         16  ELACTQ-CLAIM-NO         PIC X(7).
   478         16  ELACTQ-CERT-NO          PIC X(11).
   479     12  ELMSTR-KEY.
   480         16  MSTR-COMP-CD            PIC X.
   481         16  MSTR-CARRIER            PIC X.
   482         16  MSTR-CLAIM-NO           PIC X(7).
   483         16  MSTR-CERT-NO.
   484             20  MSTR-CERT-NO-PRIME  PIC X(10).
   485             20  MSTR-CERT-NO-SUFX   PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  11
* EL130.cbl
   486     12  SAVE-ELMSTR-KEY.
   487         16  SAVE-COMP-CD            PIC X.
   488         16  SAVE-CARRIER            PIC X.
   489         16  SAVE-CLAIM-NO           PIC X(7).
   490         16  SAVE-CERT-NO.
   491             20  SAVE-CERT-NO-PRIME  PIC X(10).
   492             20  SAVE-CERT-NO-SUFX   PIC X.
   493     12  ELMSTR5-KEY.
   494         16  MSTR5-COMP-CD           PIC X.
   495         16  MSTR5-CERT-NO.
   496             20  MSTR5-CERT-NO-PRIME PIC X(10).
   497             20  MSTR5-CERT-NO-SUFX  PIC X.
   498     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   499         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   500         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   501         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   502     12  ELCNTL-KEY.
   503         16  CNTL-COMP-ID    PIC X(3).
   504         16  CNTL-REC-TYPE   PIC X.
   505         16  CNTL-ACCESS.
   506             20  FILLER      PIC XX.
   507             20  CNTL-BENEFIT.
   508                 24  FILLER  PIC X.
   509                 24  CNTL-CARRIER PIC X.
   510         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   511     12  ELCERT-KEY.
   512         16  CERT-COMP-CD    PIC X.
   513         16  CERT-CARRIER    PIC X.
   514         16  CERT-GROUPING   PIC X(6).
   515         16  CERT-STATE      PIC X(2).
   516         16  CERT-ACCOUNT.
   517             20  CERT-ACCOUNT-PREFIX PIC X(4).
   518             20  CERT-ACCOUNT-PRIME  PIC X(6).
   519         16  CERT-EFF-DT     PIC XX.
   520         16  CERT-CERT-NO.
   521             20  CERT-CERT-NO-PRIME  PIC X(10).
   522             20  CERT-CERT-NO-SUFX   PIC X.
   523     12  ELCERT-KEY-5.
   524         16  CERT-COMP-CD-5      PIC X.
   525         16  CERT-CERT-5.
   526             20  CERT-CERT-5-PRIME   PIC X(10).
   527             20  CERT-CERT-5-SUFX    PIC X.
   528     12  ERACCT-KEY.
   529         16  ACCT-COMP-CD    PIC X.
   530         16  ACCT-CARRIER    PIC X.
   531         16  ACCT-GROUPING   PIC X(6).
   532         16  ACCT-STATE      PIC X(2).
   533         16  ACCT-ACCOUNT    PIC X(10).
   534         16  ACCT-EXP-DT     PIC XX.
   535     12  ELTRLR-KEY.
   536         16  TRLR-COMP-CD    PIC X.
   537         16  TRLR-CARRIER    PIC X.
   538         16  TRLR-CLAIM-NO   PIC X(7).
   539         16  TRLR-CERT-NO.
   540             20  TRLR-CERT-NO-PRIME  PIC X(10).
   541             20  TRLR-CERT-NO-SUFX   PIC X.
   542         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   543         16  TRLR-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  12
* EL130.cbl
   544     12  ELBENE-KEY.
   545         16  BENE-COMP-CD    PIC X.
   546         16  BENE-RCD-TYPE   PIC X.
   547         16  BENE-CODE       PIC X(10).
   548     12  ERREIN-KEY.
   549         16  REIN-COMP-CD        PIC X(01).
   550         16  REIN-TYPE           PIC X(01).
   551         16  REIN-TABLE-CO.
   552             20  REIN-CODE-1     PIC X(01).
   553             20  REIN-CODE-2     PIC X(01).
   554             20  REIN-CODE-3     PIC X(01).
   555         16  FILLER              PIC X(03).
   556     12  ELCRTT-KEY.
   557         16  CTRLR-COMP-CD       PIC X.
   558         16  CTRLR-CARRIER       PIC X.
   559         16  CTRLR-GROUPING      PIC X(6).
   560         16  CTRLR-STATE         PIC X(2).
   561         16  CTRLR-ACCOUNT       PIC X(10).
   562         16  CTRLR-EFF-DT        PIC XX.
   563         16  CTRLR-CERT-NO       PIC X(11).
   564         16  CTRLR-REC-TYPE      PIC X.
   565 01  ws-acct-found-sw            pic x value ' '.
   566     88  acct-found                value 'Y'.
   567 01  ERPDEF-KEY-SAVE             PIC X(18).
   568 01  ERPDEF-KEY.
   569     12  ERPDEF-COMPANY-CD       PIC X.
   570     12  ERPDEF-STATE            PIC XX.
   571     12  ERPDEF-PROD-CD          PIC XXX.
   572     12  F                       PIC X(7).
   573     12  ERPDEF-BEN-TYPE         PIC X.
   574     12  ERPDEF-BEN-CODE         PIC XX.
   575     12  ERPDEF-EXP-DT           PIC XX.
   576 01  ERROR-MESSAGES.
   577     12  ER-0000                 PIC X(4)  VALUE '0000'.
   578     12  ER-0004                 PIC X(4)  VALUE '0004'.
   579     12  ER-0019                 PIC X(4)  VALUE '0019'.
   580     12  ER-0023                 PIC X(4)  VALUE '0023'.
   581     12  ER-0029                 PIC X(4)  VALUE '0029'.
   582     12  ER-0033                 PIC X(4)  VALUE '0033'.
   583     12  ER-0068                 PIC X(4)  VALUE '0068'.
   584     12  ER-0070                 PIC X(4)  VALUE '0070'.
   585     12  ER-0194                 PIC X(4)  VALUE '0194'.
   586     12  ER-0202                 PIC X(4)  VALUE '0202'.
   587     12  ER-0203                 PIC X(4)  VALUE '0203'.
   588     12  ER-0204                 PIC X(4)  VALUE '0204'.
   589     12  ER-0205                 PIC X(4)  VALUE '0205'.
   590     12  ER-0206                 PIC X(4)  VALUE '0206'.
   591     12  ER-0207                 PIC X(4)  VALUE '0207'.
   592     12  ER-0213                 PIC X(4)  VALUE '0213'.
   593     12  ER-0214                 PIC X(4)  VALUE '0214'.
   594     12  ER-0217                 PIC X(4)  VALUE '0217'.
   595     12  ER-0219                 PIC X(4)  VALUE '0219'.
   596     12  ER-0220                 PIC X(4)  VALUE '0220'.
   597     12  ER-0221                 PIC X(4)  VALUE '0221'.
   598     12  ER-0222                 PIC X(4)  VALUE '0222'.
   599     12  ER-0223                 PIC X(4)  VALUE '0223'.
   600     12  ER-0224                 PIC X(4)  VALUE '0224'.
   601     12  ER-0225                 PIC X(4)  VALUE '0225'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  13
* EL130.cbl
   602     12  ER-0226                 PIC X(4)  VALUE '0226'.
   603     12  ER-0227                 PIC X(4)  VALUE '0227'.
   604     12  ER-0229                 PIC X(4)  VALUE '0229'.
   605     12  ER-0230                 PIC X(4)  VALUE '0230'.
   606     12  ER-0231                 PIC X(4)  VALUE '0231'.
   607     12  ER-0232                 PIC X(4)  VALUE '0232'.
   608     12  ER-0233                 PIC X(4)  VALUE '0233'.
   609     12  ER-0234                 PIC X(4)  VALUE '0234'.
   610     12  ER-0235                 PIC X(4)  VALUE '0235'.
   611     12  ER-0236                 PIC X(4)  VALUE '0236'.
   612     12  ER-0237                 PIC X(4)  VALUE '0237'.
   613     12  ER-0238                 PIC X(4)  VALUE '0238'.
   614     12  ER-0239                 PIC X(4)  VALUE '0239'.
   615     12  ER-0240                 PIC X(4)  VALUE '0240'.
   616     12  ER-0241                 PIC X(4)  VALUE '0241'.
   617     12  ER-0243                 PIC X(4)  VALUE '0243'.
   618     12  ER-0244                 PIC X(4)  VALUE '0244'.
   619     12  ER-0245                 PIC X(4)  VALUE '0245'.
   620     12  ER-0246                 PIC X(4)  VALUE '0246'.
   621     12  ER-0247                 PIC X(4)  VALUE '0247'.
   622     12  ER-0248                 PIC X(4)  VALUE '0248'.
   623     12  ER-0250                 PIC X(4)  VALUE '0250'.
   624     12  ER-0251                 PIC X(4)  VALUE '0251'.
   625     12  ER-0252                 PIC X(4)  VALUE '0252'.
   626     12  ER-0253                 PIC X(4)  VALUE '0253'.
   627     12  ER-0254                 PIC X(4)  VALUE '0254'.
   628     12  ER-0257                 PIC X(4)  VALUE '0257'.
   629     12  ER-0258                 PIC X(4)  VALUE '0258'.
   630     12  ER-0260                 PIC X(4)  VALUE '0260'.
   631     12  ER-0261                 PIC X(4)  VALUE '0261'.
   632     12  ER-0263                 PIC X(4)  VALUE '0263'.
   633     12  ER-0264                 PIC X(4)  VALUE '0264'.
   634     12  ER-0265                 PIC X(4)  VALUE '0265'.
   635     12  ER-0266                 PIC X(4)  VALUE '0266'.
   636     12  ER-0267                 PIC X(4)  VALUE '0267'.
   637     12  ER-0334                 PIC X(4)  VALUE '0334'.
   638     12  ER-0337                 PIC X(4)  VALUE '0337'.
   639     12  ER-0412                 PIC X(4)  VALUE '0412'.
   640     12  ER-0413                 PIC X(4)  VALUE '0413'.
   641     12  ER-0428                 PIC X(4)  VALUE '0428'.
   642     12  ER-0429                 PIC X(4)  VALUE '0429'.
   643     12  ER-0430                 PIC X(4)  VALUE '0430'.
   644     12  ER-0433                 PIC X(4)  VALUE '0433'.
   645     12  ER-0434                 PIC X(4)  VALUE '0434'.
   646     12  ER-0458                 PIC X(4)  VALUE '0458'.
   647     12  ER-0489                 PIC X(4)  VALUE '0489'.
   648     12  ER-0509                 PIC X(4)  VALUE '0509'.
   649     12  ER-0510                 PIC X(4)  VALUE '0510'.
   650     12  ER-0511                 PIC X(4)  VALUE '0511'.
   651     12  ER-0512                 PIC X(4)  VALUE '0512'.
   652     12  ER-0516                 PIC X(4)  VALUE '0516'.
   653     12  ER-0517                 PIC X(4)  VALUE '0517'.
   654     12  ER-0518                 PIC X(4)  VALUE '0518'.
   655     12  ER-0519                 PIC X(4)  VALUE '0519'.
   656     12  ER-0520                 PIC X(4)  VALUE '0520'.
   657     12  ER-0521                 PIC X(4)  VALUE '0521'.
   658     12  ER-0522                 PIC X(4)  VALUE '0522'.
   659     12  ER-0523                 PIC X(4)  VALUE '0523'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  14
* EL130.cbl
   660     12  ER-0544                 PIC X(4)  VALUE '0544'.
   661     12  ER-0546                 PIC X(4)  VALUE '0546'.
   662     12  ER-0558                 PIC X(4)  VALUE '0558'.
   663     12  ER-0560                 PIC X(4)  VALUE '0560'.
   664     12  ER-0562                 PIC X(4)  VALUE '0562'.
   665     12  ER-0565                 PIC X(4)  VALUE '0565'.
   666     12  ER-0569                 PIC X(4)  VALUE '0569'.
   667     12  ER-0693                 PIC X(4)  VALUE '0693'.
   668     12  ER-0715                 PIC X(4)  VALUE '0715'.
   669     12  ER-0840                 PIC X(4)  VALUE '0840'.
   670     12  ER-0841                 PIC X(4)  VALUE '0841'.
   671     12  ER-0842                 PIC X(4)  VALUE '0842'.
   672     12  ER-0843                 PIC X(4)  VALUE '0843'.
   673     12  ER-0878                 PIC X(4)  VALUE '0878'.
   674     12  ER-0887                 PIC X(4)  VALUE '0887'.
   675     12  ER-0992                 PIC X(4)  VALUE '0992'.
   676     12  ER-1651                 PIC X(4)  VALUE '1651'.
   677     12  ER-1652                 PIC X(4)  VALUE '1652'.
   678     12  ER-1653                 PIC X(4)  VALUE '1653'.
   679     12  ER-1654                 PIC X(4)  VALUE '1654'.
   680     12  ER-1655                 PIC X(4)  VALUE '1655'.
   681     12  er-1659                 pic x(4)  value '1659'.
   682     12  er-1660                 pic x(4)  value '1660'.
   683     12  er-1661                 pic x(4)  value '1661'.
   684     12  er-1671                 pic x(4)  value '1671'.
   685     12  er-1672                 pic x(4)  value '1672'.
   686     12  er-1673                 pic x(4)  value '1673'.
   687     12  er-1675                 pic x(4)  value '1675'.
   688     12  er-1676                 pic x(4)  value '1676'.
   689     12  ER-1677                 PIC X(4)  VALUE '1677'.
   690     12  ER-1679                 PIC X(4)  VALUE '1679'.
   691     12  ER-2280                 PIC X(4)  VALUE '2280'.
   692     12  ER-2370                 PIC X(4)  VALUE '2370'.
   693     12  ER-2371                 PIC X(4)  VALUE '2371'.
   694     12  ER-2378                 PIC X(4)  VALUE '2378'.
   695     12  ER-2380                 PIC X(4)  VALUE '2380'.
   696     12  ER-2566                 PIC X(4)  VALUE '2566'.
   697     12  ER-2848                 PIC X(4)  VALUE '2848'.
   698     12  ER-3548                 PIC X(4)  VALUE '3548'.
   699     12  ER-7008                 PIC X(4)  VALUE '7008'.
   700     12  ER-7319                 PIC X(4)  VALUE '7319'.
   701     12  ER-7321                 PIC X(4)  VALUE '7321'.
   702     12  ER-7352                 PIC X(4)  VALUE '7352'.
   703     12  ER-7353                 PIC X(4)  VALUE '7353'.
   704     12  ER-7572                 PIC X(4)  VALUE '7572'.
   705     12  ER-7575                 PIC X(4)  VALUE '7575'.
   706     12  ER-7577                 PIC X(4)  VALUE '7577'.
   707     12  ER-7582                 PIC X(4)  VALUE '7582'.
   708     12  ER-7634                 PIC X(4)  VALUE '7634'.
   709     12  ER-7635                 PIC X(4)  VALUE '7635'.
   710     12  ER-7636                 PIC X(4)  VALUE '7636'.
   711     12  ER-7637                 PIC X(4)  VALUE '7637'.
   712     12  ER-7638                 PIC X(4)  VALUE '7638'.
   713     12  ER-7639                 PIC X(4)  VALUE '7639'.
   714     12  ER-7640                 PIC X(4)  VALUE '7640'.
   715     12  ER-7641                 PIC X(4)  VALUE '7641'.
   716     12  ER-7642                 PIC X(4)  VALUE '7642'.
   717     12  ER-7643                 PIC X(4)  VALUE '7643'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  15
* EL130.cbl
   718     12  ER-7646                 PIC X(4)  VALUE '7646'.
   719     12  ER-7647                 PIC X(4)  VALUE '7647'.
   720     12  ER-7648                 PIC X(4)  VALUE '7648'.
   721     12  ER-7649                 PIC X(4)  VALUE '7649'.
   722     12  ER-7651                 PIC X(4)  VALUE '7651'.
   723     12  ER-7670                 PIC X(4)  VALUE '7670'.
   724     12  ER-7671                 PIC X(4)  VALUE '7671'.
   725     12  ER-7686                 PIC X(4)  VALUE '7686'.
   726     12  ER-7688                 PIC X(4)  VALUE '7688'.
   727     12  ER-7689                 PIC X(4)  VALUE '7689'.
   728     12  ER-7691                 PIC X(4)  VALUE '7691'.
   729*    COPY ERCPDEF.
   730******************************************************************
   731*                                                                *
   732*                                                                *
   733*                            ERCPDEF.                            *
   734*                                                                *
   735*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   736*                                                                *
   737*    FILE TYPE = VSAM,KSDS                                       *
   738*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   739*                                                                *
   740*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   741*                                                                *
   742*    LOG = YES                                                   *
   743*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   744******************************************************************
   745*                   C H A N G E   L O G
   746*
   747* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   748*-----------------------------------------------------------------
   749*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   750* EFFECTIVE    NUMBER
   751*-----------------------------------------------------------------
   752* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   753* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   754* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   755* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   756******************************************************************
   757 01  PRODUCT-MASTER.
   758    12  PD-RECORD-ID                 PIC X(02).
   759        88  VALID-PD-ID                  VALUE 'PD'.
   760    12  PD-CONTROL-PRIMARY.
   761        16  PD-COMPANY-CD            PIC X.
   762        16  PD-STATE                 PIC XX.
   763        16  PD-PRODUCT-CD            PIC XXX.
   764        16  PD-FILLER                PIC X(7).
   765        16  PD-BEN-TYPE              PIC X.
   766        16  PD-BEN-CODE              PIC XX.
   767        16  PD-PROD-EXP-DT           PIC XX.
   768    12  FILLER                       PIC X(50).
   769    12  PD-PRODUCT-DATA OCCURS 8.
   770        16  PD-PROD-CODE             PIC X.
   771            88  PD-PROD-LIFE           VALUE 'L'.
   772            88  PD-PROD-PROP           VALUE 'P'.
   773            88  PD-PROD-AH             VALUE 'A'.
   774            88  PD-PROD-IU             VALUE 'I'.
   775            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  16
* EL130.cbl
   776            88  PD-PROD-FAML           VALUE 'F'.
   777            88  PD-PROD-OTH            VALUE 'O'.
   778        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   779        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   780        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   781        16  PD-MAX-TERM              PIC S999        COMP-3.
   782        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   783        16  FILLER                   PIC X.
   784        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   785        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   786        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   787        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   788        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   789        16  PD-REC-CRIT-PERIOD       PIC 99.
   790        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   791            20  PD-RECURRING-YN      PIC X.
   792            20  FILLER               PIC X.
   793        16  PD-RTW-MOS               PIC 99.
   794        16  PD-MAX-EXTENSION         PIC 99.
   795        16  pd-ben-pct               pic sv999 comp-3.
   796*       16  FILLER                   PIC XX.
   797    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   798    12  PD-TERM-LIMITS OCCURS 15.
   799        16  PD-LOW-TERM              PIC S999        COMP-3.
   800        16  PD-HI-TERM               PIC S999        COMP-3.
   801*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   802    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   803        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   804        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   805    12  PD-EARN-FACTORS.
   806        16  FILLER OCCURS 15.
   807            20  FILLER OCCURS 15.
   808                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   809    12  PD-PRODUCT-DESC              PIC X(80).
   810    12  PD-TRUNCATED                 PIC X.
   811    12  FILLER                       PIC X(59).
   812    12  PD-MAINT-INFORMATION.
   813        16  PD-LAST-MAINT-DT         PIC X(02).
   814        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   815        16  PD-LAST-MAINT-BY         PIC X(04).
   816*    COPY ELCLNKLT.
   817******************************************************************
   818*                                                                *
   819*                                                                *
   820*                           ELCLNKLT                             *
   821*                            VMOD=2.003                          *
   822*                                                                *
   823*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   824*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   825*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   826*                                                                *
   827*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   828*   COMPLETING THE REQUIRED FIELDS.                              *
   829*                                                                *
   830*   THE CALLING PROGRAM SHOULD CHECK:                            *
   831*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   832*                              9999 INDICATES AN UNKNOWN ABEND   *
   833*                                   WAS DETECTED.                *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  17
* EL130.cbl
   834*                              ALL OTHER VALUES ARE NORMAL ERROR *
   835*                              CODES FOUND IN THE ERROR FILE.    *
   836******************************************************************
   837 01  W-1523-LINKDATA.
   838     12  W-1523-COMMON-PI-DATA.
   839         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   840         16  FILLER              PIC  X(67).
   841         16  W-1523-COMPANY-CD   PIC  X(01).
   842         16  FILLER              PIC  X(10).
   843         16  W-1523-CONTROL-IN-PROGRESS.
   844             20  W-1523-CARRIER  PIC  X(01).
   845             20  W-1523-GROUPING PIC  X(06).
   846             20  W-1523-STATE    PIC  X(02).
   847             20  W-1523-ACCOUNT  PIC  X(10).
   848             20  W-1523-CLAIM-CERT-GRP.
   849                 24  W-1523-CLAIM-NO
   850                                 PIC  X(07).
   851                 24  W-1523-CERT-NO.
   852                     28  W-1523-CERT-PRIME
   853                                 PIC  X(10).
   854                     28  W-1523-CERT-SFX
   855                                 PIC  X(01).
   856                 24  W-1523-CERT-EFF-DT
   857                                 PIC  X(02).
   858         16  FILLER              PIC X(265).
   859
   860     12  W-1523-WORK-AREA.
   861         16  W-1523-FORM-NUMBER  PIC  X(04).
   862         16  W-1523-NUMBER-COPIES
   863                                 PIC  9(01).
   864         16  W-1523-ADDR-TYPE    PIC  X(02).
   865         16  W-1523-FOLLOW-UP-DATE
   866                                 PIC  X(02).
   867         16  W-1523-RESEND-DATE  PIC  X(02).
   868         16  W-1523-ERROR-CODE   PIC  9(04).
   869             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   870             88  W-1523-FATAL-ERROR
   871                                    VALUES  0006 0013 0042
   872                                            0154 0168 0169
   873                                            0176 9999 0172
   874                                            0179 0186 0281
   875                                            0332 2055 3697
   876                                            3698 3699 3770
   877                                            3771 3772 7675
   878                                            9106 9808 9883
   879                                            9887.
   880             88  W-1523-STOP-ERRORS
   881                                    VALUES  0013 0042 0154
   882                                            0168 0169 0172
   883                                            0281 0332 2055
   884                                            3698 3699 7675
   885                                            9106 9808 9883
   886                                            9999.
   887         16  W-1523-REASON       PIC  X(70).
   888         16  W-1523-ARCHIVE-NUMBER
   889                                 PIC  9(08).
   890     12  W-1523-POINTER-AREA.
   891         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  18
* EL130.cbl
   892         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   893         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   894         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   895         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  19
* EL130.cbl
   897*    COPY ELCINTF.
   898******************************************************************
   899*                                                                *
   900*                                                                *
   901*                            ELCINTF.                            *
   902*                            VMOD=2.017                          *
   903*                                                                *
   904*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   905*                                                                *
   906*       LENGTH = 1024                                            *
   907*                                                                *
   908******************************************************************
   909*                   C H A N G E   L O G
   910*
   911* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   912*-----------------------------------------------------------------
   913*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   914* EFFECTIVE    NUMBER
   915*-----------------------------------------------------------------
   916* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   917******************************************************************
   918 01  PROGRAM-INTERFACE-BLOCK.
   919     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   920     12  PI-CALLING-PROGRAM              PIC X(8).
   921     12  PI-SAVED-PROGRAM-1              PIC X(8).
   922     12  PI-SAVED-PROGRAM-2              PIC X(8).
   923     12  PI-SAVED-PROGRAM-3              PIC X(8).
   924     12  PI-SAVED-PROGRAM-4              PIC X(8).
   925     12  PI-SAVED-PROGRAM-5              PIC X(8).
   926     12  PI-SAVED-PROGRAM-6              PIC X(8).
   927     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   928     12  PI-COMPANY-ID                   PIC XXX.
   929     12  PI-COMPANY-CD                   PIC X.
   930
   931     12  PI-COMPANY-PASSWORD             PIC X(8).
   932
   933     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   934
   935     12  PI-CONTROL-IN-PROGRESS.
   936         16  PI-CARRIER                  PIC X.
   937         16  PI-GROUPING                 PIC X(6).
   938         16  PI-STATE                    PIC XX.
   939         16  PI-ACCOUNT                  PIC X(10).
   940         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   941                                         PIC X(10).
   942         16  PI-CLAIM-CERT-GRP.
   943             20  PI-CLAIM-NO             PIC X(7).
   944             20  PI-CERT-NO.
   945                 25  PI-CERT-PRIME       PIC X(10).
   946                 25  PI-CERT-SFX         PIC X.
   947             20  PI-CERT-EFF-DT          PIC XX.
   948         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   949             20  PI-PLAN-CODE            PIC X(2).
   950             20  PI-REVISION-NUMBER      PIC X(3).
   951             20  PI-PLAN-EFF-DT          PIC X(2).
   952             20  PI-PLAN-EXP-DT          PIC X(2).
   953             20  FILLER                  PIC X(11).
   954         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  20
* EL130.cbl
   955             20  PI-OE-REFERENCE-1.
   956                 25  PI-OE-REF-1-PRIME   PIC X(18).
   957                 25  PI-OE-REF-1-SUFF    PIC XX.
   958
   959     12  PI-SESSION-IN-PROGRESS          PIC X.
   960         88  CLAIM-SESSION                   VALUE '1'.
   961         88  CREDIT-SESSION                  VALUE '2'.
   962         88  WARRANTY-SESSION                VALUE '3'.
   963         88  MORTGAGE-SESSION                VALUE '4'.
   964         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   965
   966
   967*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   968
   969     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   970     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   971
   972     12  PI-CREDIT-USER                  PIC X.
   973         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   974         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   975
   976     12  PI-CLAIM-USER                   PIC X.
   977         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   978         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   979
   980     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   981         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   982         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   983         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   984         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   985         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   986
   987     12  PI-PROCESSOR-ID                 PIC X(4).
   988
   989     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   990
   991     12  PI-MEMBER-CAPTION               PIC X(10).
   992
   993     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   994         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   995
   996     12  PI-LIFE-OVERRIDE-L1             PIC X.
   997     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   998     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   999     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1000
  1001     12  PI-AH-OVERRIDE-L1               PIC X.
  1002     12  PI-AH-OVERRIDE-L2               PIC XX.
  1003     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1004     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1005
  1006     12  PI-NEW-SYSTEM                   PIC X(2).
  1007
  1008     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1009     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1010         88  PI-USES-PAID-TO                 VALUE '1'.
  1011     12  PI-CRDTCRD-SYSTEM.
  1012         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  21
* EL130.cbl
  1013             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1014             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1015         16  PI-CC-MONTH-END-DT          PIC XX.
  1016     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1017
  1018     12  PI-OE-REFERENCE-2.
  1019         16  PI-OE-REF-2-PRIME           PIC X(10).
  1020         16  PI-OE-REF-2-SUFF            PIC X.
  1021
  1022     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1023
  1024     12  PI-LANGUAGE-TYPE                PIC X.
  1025             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1026             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1027             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1028
  1029     12  PI-POLICY-LINKAGE-IND           PIC X.
  1030         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1031         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1032                                                   LOW-VALUES.
  1033
  1034     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1035     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1036         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1037         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1038
  1039     12  PI-PROCESSOR-CSR-IND            PIC X.
  1040         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1041         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1042
  1043     12  FILLER                          PIC X(3).
  1044
  1045     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1046
  1047     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1048         PI-SYSTEM-LEVEL.
  1049
  1050         16  PI-ENTRY-CODES.
  1051             20  PI-ENTRY-CD-1           PIC X.
  1052             20  PI-ENTRY-CD-2           PIC X.
  1053
  1054         16  PI-RETURN-CODES.
  1055             20  PI-RETURN-CD-1          PIC X.
  1056             20  PI-RETURN-CD-2          PIC X.
  1057
  1058         16  PI-UPDATE-STATUS-SAVE.
  1059             20  PI-UPDATE-BY            PIC X(4).
  1060             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1061
  1062         16  PI-LOWER-CASE-LETTERS       PIC X.
  1063             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1064
  1065*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1066*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1067*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1068
  1069         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1070             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  22
* EL130.cbl
  1071             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1072             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1073             88  ACCNT-CNTL                  VALUE '3'.
  1074             88  CARR-ACCNT-CNTL             VALUE '4'.
  1075
  1076         16  PI-PROCESSOR-CAP-LIST.
  1077             20  PI-SYSTEM-CONTROLS.
  1078                24 PI-SYSTEM-DISPLAY     PIC X.
  1079                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1080                24 PI-SYSTEM-MODIFY      PIC X.
  1081                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1082             20  FILLER                  PIC XX.
  1083             20  PI-DISPLAY-CAP          PIC X.
  1084                 88  DISPLAY-CAP             VALUE 'Y'.
  1085             20  PI-MODIFY-CAP           PIC X.
  1086                 88  MODIFY-CAP              VALUE 'Y'.
  1087             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1088                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1089             20  PI-FORCE-CAP            PIC X.
  1090                 88  FORCE-CAP               VALUE 'Y'.
  1091
  1092         16  PI-PROGRAM-CONTROLS.
  1093             20  PI-PGM-PRINT-OPT        PIC X.
  1094             20  PI-PGM-FORMAT-OPT       PIC X.
  1095             20  PI-PGM-PROCESS-OPT      PIC X.
  1096             20  PI-PGM-TOTALS-OPT       PIC X.
  1097
  1098         16  PI-HELP-INTERFACE.
  1099             20  PI-LAST-ERROR-NO        PIC X(4).
  1100             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1101
  1102         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1103             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1104
  1105         16  PI-CR-CONTROL-IN-PROGRESS.
  1106             20  PI-CR-CARRIER           PIC X.
  1107             20  PI-CR-GROUPING          PIC X(6).
  1108             20  PI-CR-STATE             PIC XX.
  1109             20  PI-CR-ACCOUNT           PIC X(10).
  1110             20  PI-CR-FIN-RESP          PIC X(10).
  1111             20  PI-CR-TYPE              PIC X.
  1112
  1113         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1114
  1115         16  PI-CR-MONTH-END-DT          PIC XX.
  1116
  1117         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1118             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1119             88  PI-ZERO-CARRIER             VALUE '1'.
  1120             88  PI-ZERO-GROUPING            VALUE '2'.
  1121             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1122
  1123         16  PI-CARRIER-SECURITY         PIC X.
  1124             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1125
  1126         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1127             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1128             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  23
* EL130.cbl
  1129
  1130         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1131             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1132                                         INDEXED BY PI-ACCESS-NDX
  1133                                         PIC X.
  1134
  1135         16  PI-GA-BILLING-CONTROL       PIC X.
  1136             88  PI-GA-BILLING               VALUE '1'.
  1137
  1138         16  PI-MAIL-PROCESSING          PIC X.
  1139             88  PI-MAIL-YES                 VALUE 'Y'.
  1140
  1141         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1142
  1143         16  PI-AR-SYSTEM.
  1144             20  PI-AR-PROCESSING-CNTL   PIC X.
  1145                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1146             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1147             20  PI-AR-MONTH-END-DT      PIC XX.
  1148
  1149         16  PI-MP-SYSTEM.
  1150             20  PI-MORTGAGE-USER            PIC X.
  1151                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1152                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1153             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1154                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1155                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1156                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1157                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1158                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1159             20  PI-MP-MONTH-END-DT          PIC XX.
  1160             20  PI-MP-REFERENCE-NO.
  1161                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1162                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1163
  1164         16  PI-LABEL-CONTROL            PIC X(01).
  1165             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1166             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1167
  1168         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1169             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1170
  1171         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1172             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1173             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1174
  1175         16  FILLER                      PIC X(14).
  1176
  1177     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1178******************************************************************
  1179     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1180         16  PI-MSTR-DT               PIC XX.
  1181         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1182         16  PI-TRLR-DT               PIC XX.
  1183         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1184         16  PI-LAST-CLAIM            PIC X(7).
  1185         16  PI-LAST-CARR             PIC X.
  1186         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  24
* EL130.cbl
  1187             20  PI-LAST-CERT-PRIME   PIC X(10).
  1188             20  PI-LAST-CERT-SUFX    PIC X.
  1189         16  PI-LAST-CLAIM-TYPE       PIC X.
  1190         16  PI-CURSOR                PIC S9(4)   COMP.
  1191         16  PI-SAVE-CERT.
  1192             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1193             20  PI-SAVE-CERT-SUFX    PIC X.
  1194         16  PI-SAVE-EFFDT            PIC X(2).
  1195         16  PI-SAVE-ACCOUNT          PIC X(10).
  1196         16  PI-INCURR-SW             PIC X.
  1197         16  PI-PRT-OPT               PIC X.
  1198         16  PI-ALT-PRT               PIC X(4).
  1199         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1200             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1201         16  FILLER                   PIC X(272).
  1202         16  PI-EL127-TO-EL130-CNTRL.
  1203             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1204             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1205             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1206                 24  PI-EL127-CARRIER        PIC X.
  1207                 24  PI-EL127-GROUPING       PIC X(6).
  1208                 24  PI-EL127-STATE          PIC X(2).
  1209                 24  PI-EL127-ACCOUNT        PIC X(10).
  1210                 24  PI-EL127-CERT-NO.
  1211                     28  PI-EL127-CERT-PRIME PIC X(10).
  1212                     28  PI-EL127-CERT-SUFX  PIC X.
  1213                 24  PI-EL127-EFF-DT         PIC XX.
  1214*        16  FILLER                          PIC X(50).
  1215         16  FILLER                          PIC X(31).
  1216         16  PI-EL659-TO-EL130-CNTRL.
  1217             20  PI-EL659-CARRIER            PIC X.
  1218             20  PI-EL659-GROUPING           PIC X(6).
  1219             20  PI-EL659-STATE              PIC XX.
  1220             20  PI-EL659-ACCOUNT            PIC X(10).
  1221
  1222         16  FILLER                          PIC X(19).
  1223
  1224         16  PI-SAVE-INCUR-DT                PIC X(02).
  1225         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1226*         16  FILLER                          PIC X(65).
  1227         16  PI-ST-VFY-2ND-BENE              PIC X.
  1228         16  PI-ST-CAUSAL-STATE              PIC X.
  1229         16  pi-dcc-max-benefits             pic s999 comp-3.
  1230         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1231         16  pi-emi-sub                      pic 99.
  1232         16  FILLER                          PIC X(53).
  1233
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  25
* EL130.cbl
  1235*    COPY EL130S.
  1236 01  EL130AI.
  1237     05  FILLER            PIC  X(0012).
  1238*    -------------------------------
  1239     05  RUNDTEL PIC S9(0004) COMP.
  1240     05  RUNDTEF PIC  X(0001).
  1241     05  FILLER REDEFINES RUNDTEF.
  1242         10  RUNDTEA PIC  X(0001).
  1243     05  RUNDTEI PIC  X(0008).
  1244*    -------------------------------
  1245     05  RUNTIMEL PIC S9(0004) COMP.
  1246     05  RUNTIMEF PIC  X(0001).
  1247     05  FILLER REDEFINES RUNTIMEF.
  1248         10  RUNTIMEA PIC  X(0001).
  1249     05  RUNTIMEI PIC  X(0005).
  1250*    -------------------------------
  1251     05  COMPL PIC S9(0004) COMP.
  1252     05  COMPF PIC  X(0001).
  1253     05  FILLER REDEFINES COMPF.
  1254         10  COMPA PIC  X(0001).
  1255     05  COMPI PIC  X(0003).
  1256*    -------------------------------
  1257     05  SEQUL PIC S9(0004) COMP.
  1258     05  SEQUF PIC  X(0001).
  1259     05  FILLER REDEFINES SEQUF.
  1260         10  SEQUA PIC  X(0001).
  1261     05  SEQUI PIC  X(0010).
  1262*    -------------------------------
  1263     05  MAINTL PIC S9(0004) COMP.
  1264     05  MAINTF PIC  X(0001).
  1265     05  FILLER REDEFINES MAINTF.
  1266         10  MAINTA PIC  X(0001).
  1267     05  MAINTI PIC  X(0001).
  1268*    -------------------------------
  1269     05  CLMNOL PIC S9(0004) COMP.
  1270     05  CLMNOF PIC  X(0001).
  1271     05  FILLER REDEFINES CLMNOF.
  1272         10  CLMNOA PIC  X(0001).
  1273     05  CLMNOI PIC  X(0007).
  1274*    -------------------------------
  1275     05  CLMCARRL PIC S9(0004) COMP.
  1276     05  CLMCARRF PIC  X(0001).
  1277     05  FILLER REDEFINES CLMCARRF.
  1278         10  CLMCARRA PIC  X(0001).
  1279     05  CLMCARRI PIC  X(0001).
  1280*    -------------------------------
  1281     05  CLMTYPEL PIC S9(0004) COMP.
  1282     05  CLMTYPEF PIC  X(0001).
  1283     05  FILLER REDEFINES CLMTYPEF.
  1284         10  CLMTYPEA PIC  X(0001).
  1285     05  CLMTYPEI PIC  X(0001).
  1286*    -------------------------------
  1287     05  CERTNOL PIC S9(0004) COMP.
  1288     05  CERTNOF PIC  X(0001).
  1289     05  FILLER REDEFINES CERTNOF.
  1290         10  CERTNOA PIC  X(0001).
  1291     05  CERTNOI PIC  X(0010).
  1292*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  26
* EL130.cbl
  1293     05  SUFXL PIC S9(0004) COMP.
  1294     05  SUFXF PIC  X(0001).
  1295     05  FILLER REDEFINES SUFXF.
  1296         10  SUFXA PIC  X(0001).
  1297     05  SUFXI PIC  X(0001).
  1298*    -------------------------------
  1299     05  PCERTNOL PIC S9(0004) COMP.
  1300     05  PCERTNOF PIC  X(0001).
  1301     05  FILLER REDEFINES PCERTNOF.
  1302         10  PCERTNOA PIC  X(0001).
  1303     05  PCERTNOI PIC  X(0010).
  1304*    -------------------------------
  1305     05  PSUFXL PIC S9(0004) COMP.
  1306     05  PSUFXF PIC  X(0001).
  1307     05  FILLER REDEFINES PSUFXF.
  1308         10  PSUFXA PIC  X(0001).
  1309     05  PSUFXI PIC  X(0001).
  1310*    -------------------------------
  1311     05  INCURL PIC S9(0004) COMP.
  1312     05  INCURF PIC  X(0001).
  1313     05  FILLER REDEFINES INCURF.
  1314         10  INCURA PIC  X(0001).
  1315     05  INCURI PIC  X(0008).
  1316*    -------------------------------
  1317     05  REPORTL PIC S9(0004) COMP.
  1318     05  REPORTF PIC  X(0001).
  1319     05  FILLER REDEFINES REPORTF.
  1320         10  REPORTA PIC  X(0001).
  1321     05  REPORTI PIC  X(0008).
  1322*    -------------------------------
  1323     05  ICD1L PIC S9(0004) COMP.
  1324     05  ICD1F PIC  X(0001).
  1325     05  FILLER REDEFINES ICD1F.
  1326         10  ICD1A PIC  X(0001).
  1327     05  ICD1I PIC  X(0008).
  1328*    -------------------------------
  1329     05  ICD2L PIC S9(0004) COMP.
  1330     05  ICD2F PIC  X(0001).
  1331     05  FILLER REDEFINES ICD2F.
  1332         10  ICD2A PIC  X(0001).
  1333     05  ICD2I PIC  X(0008).
  1334*    -------------------------------
  1335     05  DIAGL PIC S9(0004) COMP.
  1336     05  DIAGF PIC  X(0001).
  1337     05  FILLER REDEFINES DIAGF.
  1338         10  DIAGA PIC  X(0001).
  1339     05  DIAGI PIC  X(0060).
  1340*    -------------------------------
  1341     05  BENECDL PIC S9(0004) COMP.
  1342     05  BENECDF PIC  X(0001).
  1343     05  FILLER REDEFINES BENECDF.
  1344         10  BENECDA PIC  X(0001).
  1345     05  BENECDI PIC  X(0010).
  1346*    -------------------------------
  1347     05  BIRTHDTL PIC S9(0004) COMP.
  1348     05  BIRTHDTF PIC  X(0001).
  1349     05  FILLER REDEFINES BIRTHDTF.
  1350         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  27
* EL130.cbl
  1351     05  BIRTHDTI PIC  X(0008).
  1352*    -------------------------------
  1353     05  SSNL PIC S9(0004) COMP.
  1354     05  SSNF PIC  X(0001).
  1355     05  FILLER REDEFINES SSNF.
  1356         10  SSNA PIC  X(0001).
  1357     05  SSNI PIC  X(0011).
  1358*    -------------------------------
  1359     05  SEXL PIC S9(0004) COMP.
  1360     05  SEXF PIC  X(0001).
  1361     05  FILLER REDEFINES SEXF.
  1362         10  SEXA PIC  X(0001).
  1363     05  SEXI PIC  X(0001).
  1364*    -------------------------------
  1365     05  INSTYPEL PIC S9(0004) COMP.
  1366     05  INSTYPEF PIC  X(0001).
  1367     05  FILLER REDEFINES INSTYPEF.
  1368         10  INSTYPEA PIC  X(0001).
  1369     05  INSTYPEI PIC  X(0001).
  1370*    -------------------------------
  1371     05  LSTNMEL PIC S9(0004) COMP.
  1372     05  LSTNMEF PIC  X(0001).
  1373     05  FILLER REDEFINES LSTNMEF.
  1374         10  LSTNMEA PIC  X(0001).
  1375     05  LSTNMEI PIC  X(0015).
  1376*    -------------------------------
  1377     05  FSTNMEL PIC S9(0004) COMP.
  1378     05  FSTNMEF PIC  X(0001).
  1379     05  FILLER REDEFINES FSTNMEF.
  1380         10  FSTNMEA PIC  X(0001).
  1381     05  FSTNMEI PIC  X(0012).
  1382*    -------------------------------
  1383     05  INITL PIC S9(0004) COMP.
  1384     05  INITF PIC  X(0001).
  1385     05  FILLER REDEFINES INITF.
  1386         10  INITA PIC  X(0001).
  1387     05  INITI PIC  X(0001).
  1388*    -------------------------------
  1389     05  LOANNOL PIC S9(0004) COMP.
  1390     05  LOANNOF PIC  X(0001).
  1391     05  FILLER REDEFINES LOANNOF.
  1392         10  LOANNOA PIC  X(0001).
  1393     05  LOANNOI PIC  X(0008).
  1394*    -------------------------------
  1395     05  CRTLNMEL PIC S9(0004) COMP.
  1396     05  CRTLNMEF PIC  X(0001).
  1397     05  FILLER REDEFINES CRTLNMEF.
  1398         10  CRTLNMEA PIC  X(0001).
  1399     05  CRTLNMEI PIC  X(0015).
  1400*    -------------------------------
  1401     05  CRTFNMEL PIC S9(0004) COMP.
  1402     05  CRTFNMEF PIC  X(0001).
  1403     05  FILLER REDEFINES CRTFNMEF.
  1404         10  CRTFNMEA PIC  X(0001).
  1405     05  CRTFNMEI PIC  X(0012).
  1406*    -------------------------------
  1407     05  CRTINITL PIC S9(0004) COMP.
  1408     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  28
* EL130.cbl
  1409     05  FILLER REDEFINES CRTINITF.
  1410         10  CRTINITA PIC  X(0001).
  1411     05  CRTINITI PIC  X(0001).
  1412*    -------------------------------
  1413     05  LOANBALL PIC S9(0004) COMP.
  1414     05  LOANBALF PIC  X(0001).
  1415     05  FILLER REDEFINES LOANBALF.
  1416         10  LOANBALA PIC  X(0001).
  1417     05  LOANBALI PIC  9(7)V99.
  1418*    -------------------------------
  1419     05  MANRSVL PIC S9(0004) COMP.
  1420     05  MANRSVF PIC  X(0001).
  1421     05  FILLER REDEFINES MANRSVF.
  1422         10  MANRSVA PIC  X(0001).
  1423     05  MANRSVI PIC  9(7)V99.
  1424*    -------------------------------
  1425     05  SUPVL PIC S9(0004) COMP.
  1426     05  SUPVF PIC  X(0001).
  1427     05  FILLER REDEFINES SUPVF.
  1428         10  SUPVA PIC  X(0001).
  1429     05  SUPVI PIC  X(0001).
  1430*    -------------------------------
  1431     05  PRICDL PIC S9(0004) COMP.
  1432     05  PRICDF PIC  X(0001).
  1433     05  FILLER REDEFINES PRICDF.
  1434         10  PRICDA PIC  X(0001).
  1435     05  PRICDI PIC  X(0001).
  1436*    -------------------------------
  1437     05  PRODL PIC S9(0004) COMP.
  1438     05  PRODF PIC  X(0001).
  1439     05  FILLER REDEFINES PRODF.
  1440         10  PRODA PIC  X(0001).
  1441     05  PRODI PIC  X(0008).
  1442*    -------------------------------
  1443     05  PRODCDL PIC S9(0004) COMP.
  1444     05  PRODCDF PIC  X(0001).
  1445     05  FILLER REDEFINES PRODCDF.
  1446         10  PRODCDA PIC  X(0001).
  1447     05  PRODCDI PIC  X(0001).
  1448*    -------------------------------
  1449     05  FILETOL PIC S9(0004) COMP.
  1450     05  FILETOF PIC  X(0001).
  1451     05  FILLER REDEFINES FILETOF.
  1452         10  FILETOA PIC  X(0001).
  1453     05  FILETOI PIC  X(0004).
  1454*    -------------------------------
  1455     05  PROCCDL PIC S9(0004) COMP.
  1456     05  PROCCDF PIC  X(0001).
  1457     05  FILLER REDEFINES PROCCDF.
  1458         10  PROCCDA PIC  X(0001).
  1459     05  PROCCDI PIC  X(0004).
  1460*    -------------------------------
  1461     05  RELCLML PIC S9(0004) COMP.
  1462     05  RELCLMF PIC  X(0001).
  1463     05  FILLER REDEFINES RELCLMF.
  1464         10  RELCLMA PIC  X(0001).
  1465     05  RELCLMI PIC  X(0007).
  1466*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  29
* EL130.cbl
  1467     05  PRTOPTL PIC S9(0004) COMP.
  1468     05  PRTOPTF PIC  X(0001).
  1469     05  FILLER REDEFINES PRTOPTF.
  1470         10  PRTOPTA PIC  X(0001).
  1471     05  PRTOPTI PIC  X(0001).
  1472*    -------------------------------
  1473     05  ALTPRTL PIC S9(0004) COMP.
  1474     05  ALTPRTF PIC  X(0001).
  1475     05  FILLER REDEFINES ALTPRTF.
  1476         10  ALTPRTA PIC  X(0001).
  1477     05  ALTPRTI PIC  X(0004).
  1478*    -------------------------------
  1479     05  CERTMTL PIC S9(0004) COMP.
  1480     05  CERTMTF PIC  X(0001).
  1481     05  FILLER REDEFINES CERTMTF.
  1482         10  CERTMTA PIC  X(0001).
  1483     05  CERTMTI PIC  X(0001).
  1484*    -------------------------------
  1485     05  CRTCARRL PIC S9(0004) COMP.
  1486     05  CRTCARRF PIC  X(0001).
  1487     05  FILLER REDEFINES CRTCARRF.
  1488         10  CRTCARRA PIC  X(0001).
  1489     05  CRTCARRI PIC  X(0001).
  1490*    -------------------------------
  1491     05  GROUPL PIC S9(0004) COMP.
  1492     05  GROUPF PIC  X(0001).
  1493     05  FILLER REDEFINES GROUPF.
  1494         10  GROUPA PIC  X(0001).
  1495     05  GROUPI PIC  X(0006).
  1496*    -------------------------------
  1497     05  STATEL PIC S9(0004) COMP.
  1498     05  STATEF PIC  X(0001).
  1499     05  FILLER REDEFINES STATEF.
  1500         10  STATEA PIC  X(0001).
  1501     05  STATEI PIC  X(0002).
  1502*    -------------------------------
  1503     05  ACCOUNTL PIC S9(0004) COMP.
  1504     05  ACCOUNTF PIC  X(0001).
  1505     05  FILLER REDEFINES ACCOUNTF.
  1506         10  ACCOUNTA PIC  X(0001).
  1507     05  ACCOUNTI PIC  X(0010).
  1508*    -------------------------------
  1509     05  EFFDTL PIC S9(0004) COMP.
  1510     05  EFFDTF PIC  X(0001).
  1511     05  FILLER REDEFINES EFFDTF.
  1512         10  EFFDTA PIC  X(0001).
  1513     05  EFFDTI PIC  X(0008).
  1514*    -------------------------------
  1515     05  CRTSSNL PIC S9(0004) COMP.
  1516     05  CRTSSNF PIC  X(0001).
  1517     05  FILLER REDEFINES CRTSSNF.
  1518         10  CRTSSNA PIC  X(0001).
  1519     05  CRTSSNI PIC  X(0011).
  1520*    -------------------------------
  1521     05  MEMCAPL PIC S9(0004) COMP.
  1522     05  MEMCAPF PIC  X(0001).
  1523     05  FILLER REDEFINES MEMCAPF.
  1524         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  30
* EL130.cbl
  1525     05  MEMCAPI PIC  X(0010).
  1526*    -------------------------------
  1527     05  MEMBERL PIC S9(0004) COMP.
  1528     05  MEMBERF PIC  X(0001).
  1529     05  FILLER REDEFINES MEMBERF.
  1530         10  MEMBERA PIC  X(0001).
  1531     05  MEMBERI PIC  X(0012).
  1532*    -------------------------------
  1533     05  REINCDL PIC S9(0004) COMP.
  1534     05  REINCDF PIC  X(0001).
  1535     05  FILLER REDEFINES REINCDF.
  1536         10  REINCDA PIC  X(0001).
  1537     05  REINCDI PIC  X(0001).
  1538*    -------------------------------
  1539     05  ISSAGEL PIC S9(0004) COMP.
  1540     05  ISSAGEF PIC  X(0001).
  1541     05  FILLER REDEFINES ISSAGEF.
  1542         10  ISSAGEA PIC  X(0001).
  1543     05  ISSAGEI PIC  X(0002).
  1544*    -------------------------------
  1545     05  APRL PIC S9(0004) COMP.
  1546     05  APRF PIC  X(0001).
  1547     05  FILLER REDEFINES APRF.
  1548         10  APRA PIC  X(0001).
  1549     05  APRI PIC  9(4)V9(4).
  1550*    -------------------------------
  1551     05  PMTFREQL PIC S9(0004) COMP.
  1552     05  PMTFREQF PIC  X(0001).
  1553     05  FILLER REDEFINES PMTFREQF.
  1554         10  PMTFREQA PIC  X(0001).
  1555     05  PMTFREQI PIC  99.
  1556*    -------------------------------
  1557     05  INDGRPL PIC S9(0004) COMP.
  1558     05  INDGRPF PIC  X(0001).
  1559     05  FILLER REDEFINES INDGRPF.
  1560         10  INDGRPA PIC  X(0001).
  1561     05  INDGRPI PIC  X(0001).
  1562*    -------------------------------
  1563     05  PREMTYPL PIC S9(0004) COMP.
  1564     05  PREMTYPF PIC  X(0001).
  1565     05  FILLER REDEFINES PREMTYPF.
  1566         10  PREMTYPA PIC  X(0001).
  1567     05  PREMTYPI PIC  X(0001).
  1568*    -------------------------------
  1569     05  ADDONDTL PIC S9(0004) COMP.
  1570     05  ADDONDTF PIC  X(0001).
  1571     05  FILLER REDEFINES ADDONDTF.
  1572         10  ADDONDTA PIC  X(0001).
  1573     05  ADDONDTI PIC  X(0008).
  1574*    -------------------------------
  1575     05  JNTLNMEL PIC S9(0004) COMP.
  1576     05  JNTLNMEF PIC  X(0001).
  1577     05  FILLER REDEFINES JNTLNMEF.
  1578         10  JNTLNMEA PIC  X(0001).
  1579     05  JNTLNMEI PIC  X(0015).
  1580*    -------------------------------
  1581     05  JNTFNMEL PIC S9(0004) COMP.
  1582     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  31
* EL130.cbl
  1583     05  FILLER REDEFINES JNTFNMEF.
  1584         10  JNTFNMEA PIC  X(0001).
  1585     05  JNTFNMEI PIC  X(0002).
  1586*    -------------------------------
  1587     05  JNTINITL PIC S9(0004) COMP.
  1588     05  JNTINITF PIC  X(0001).
  1589     05  FILLER REDEFINES JNTINITF.
  1590         10  JNTINITA PIC  X(0001).
  1591     05  JNTINITI PIC  X(0001).
  1592*    -------------------------------
  1593     05  JNTAGEL PIC S9(0004) COMP.
  1594     05  JNTAGEF PIC  X(0001).
  1595     05  FILLER REDEFINES JNTAGEF.
  1596         10  JNTAGEA PIC  X(0001).
  1597     05  JNTAGEI PIC  X(0002).
  1598*    -------------------------------
  1599     05  LCVDSCRL PIC S9(0004) COMP.
  1600     05  LCVDSCRF PIC  X(0001).
  1601     05  FILLER REDEFINES LCVDSCRF.
  1602         10  LCVDSCRA PIC  X(0001).
  1603     05  LCVDSCRI PIC  X(0006).
  1604*    -------------------------------
  1605     05  LCVKINDL PIC S9(0004) COMP.
  1606     05  LCVKINDF PIC  X(0001).
  1607     05  FILLER REDEFINES LCVKINDF.
  1608         10  LCVKINDA PIC  X(0001).
  1609     05  LCVKINDI PIC  X(0003).
  1610*    -------------------------------
  1611     05  LCVCDL PIC S9(0004) COMP.
  1612     05  LCVCDF PIC  X(0001).
  1613     05  FILLER REDEFINES LCVCDF.
  1614         10  LCVCDA PIC  X(0001).
  1615     05  LCVCDI PIC  X(0002).
  1616*    -------------------------------
  1617     05  LCVOTRML PIC S9(0004) COMP.
  1618     05  LCVOTRMF PIC  X(0001).
  1619     05  FILLER REDEFINES LCVOTRMF.
  1620         10  LCVOTRMA PIC  X(0001).
  1621     05  LCVOTRMI PIC  999.
  1622*    -------------------------------
  1623     05  LCVRTRML PIC S9(0004) COMP.
  1624     05  LCVRTRMF PIC  X(0001).
  1625     05  FILLER REDEFINES LCVRTRMF.
  1626         10  LCVRTRMA PIC  X(0001).
  1627     05  LCVRTRMI PIC  X(0003).
  1628*    -------------------------------
  1629     05  LCVRATEL PIC S9(0004) COMP.
  1630     05  LCVRATEF PIC  X(0001).
  1631     05  FILLER REDEFINES LCVRATEF.
  1632         10  LCVRATEA PIC  X(0001).
  1633     05  LCVRATEI PIC  9999V99.
  1634*    -------------------------------
  1635     05  LCVBENEL PIC S9(0004) COMP.
  1636     05  LCVBENEF PIC  X(0001).
  1637     05  FILLER REDEFINES LCVBENEF.
  1638         10  LCVBENEA PIC  X(0001).
  1639     05  LCVBENEI PIC  9(9)V99.
  1640*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  32
* EL130.cbl
  1641     05  LCVFORML PIC S9(0004) COMP.
  1642     05  LCVFORMF PIC  X(0001).
  1643     05  FILLER REDEFINES LCVFORMF.
  1644         10  LCVFORMA PIC  X(0001).
  1645     05  LCVFORMI PIC  X(0012).
  1646*    -------------------------------
  1647     05  LCVCNDTL PIC S9(0004) COMP.
  1648     05  LCVCNDTF PIC  X(0001).
  1649     05  FILLER REDEFINES LCVCNDTF.
  1650         10  LCVCNDTA PIC  X(0001).
  1651     05  LCVCNDTI PIC  X(0008).
  1652*    -------------------------------
  1653     05  LCVEXITL PIC S9(0004) COMP.
  1654     05  LCVEXITF PIC  X(0001).
  1655     05  FILLER REDEFINES LCVEXITF.
  1656         10  LCVEXITA PIC  X(0001).
  1657     05  LCVEXITI PIC  X(0008).
  1658*    -------------------------------
  1659     05  LCVSTATL PIC S9(0004) COMP.
  1660     05  LCVSTATF PIC  X(0001).
  1661     05  FILLER REDEFINES LCVSTATF.
  1662         10  LCVSTATA PIC  X(0001).
  1663     05  LCVSTATI PIC  X(0006).
  1664*    -------------------------------
  1665     05  ACVDSCRL PIC S9(0004) COMP.
  1666     05  ACVDSCRF PIC  X(0001).
  1667     05  FILLER REDEFINES ACVDSCRF.
  1668         10  ACVDSCRA PIC  X(0001).
  1669     05  ACVDSCRI PIC  X(0006).
  1670*    -------------------------------
  1671     05  ACVKINDL PIC S9(0004) COMP.
  1672     05  ACVKINDF PIC  X(0001).
  1673     05  FILLER REDEFINES ACVKINDF.
  1674         10  ACVKINDA PIC  X(0001).
  1675     05  ACVKINDI PIC  X(0003).
  1676*    -------------------------------
  1677     05  ACVCDL PIC S9(0004) COMP.
  1678     05  ACVCDF PIC  X(0001).
  1679     05  FILLER REDEFINES ACVCDF.
  1680         10  ACVCDA PIC  X(0001).
  1681     05  ACVCDI PIC  X(0002).
  1682*    -------------------------------
  1683     05  ACVOTRML PIC S9(0004) COMP.
  1684     05  ACVOTRMF PIC  X(0001).
  1685     05  FILLER REDEFINES ACVOTRMF.
  1686         10  ACVOTRMA PIC  X(0001).
  1687     05  ACVOTRMI PIC  999.
  1688*    -------------------------------
  1689     05  ACVRTRML PIC S9(0004) COMP.
  1690     05  ACVRTRMF PIC  X(0001).
  1691     05  FILLER REDEFINES ACVRTRMF.
  1692         10  ACVRTRMA PIC  X(0001).
  1693     05  ACVRTRMI PIC  X(0003).
  1694*    -------------------------------
  1695     05  ACVRATEL PIC S9(0004) COMP.
  1696     05  ACVRATEF PIC  X(0001).
  1697     05  FILLER REDEFINES ACVRATEF.
  1698         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  33
* EL130.cbl
  1699     05  ACVRATEI PIC  9999V99.
  1700*    -------------------------------
  1701     05  ACVBENEL PIC S9(0004) COMP.
  1702     05  ACVBENEF PIC  X(0001).
  1703     05  FILLER REDEFINES ACVBENEF.
  1704         10  ACVBENEA PIC  X(0001).
  1705     05  ACVBENEI PIC  9(9)V99.
  1706*    -------------------------------
  1707     05  ACVFORML PIC S9(0004) COMP.
  1708     05  ACVFORMF PIC  X(0001).
  1709     05  FILLER REDEFINES ACVFORMF.
  1710         10  ACVFORMA PIC  X(0001).
  1711     05  ACVFORMI PIC  X(0012).
  1712*    -------------------------------
  1713     05  ACVCNDTL PIC S9(0004) COMP.
  1714     05  ACVCNDTF PIC  X(0001).
  1715     05  FILLER REDEFINES ACVCNDTF.
  1716         10  ACVCNDTA PIC  X(0001).
  1717     05  ACVCNDTI PIC  X(0008).
  1718*    -------------------------------
  1719     05  ACVEXITL PIC S9(0004) COMP.
  1720     05  ACVEXITF PIC  X(0001).
  1721     05  FILLER REDEFINES ACVEXITF.
  1722         10  ACVEXITA PIC  X(0001).
  1723     05  ACVEXITI PIC  X(0008).
  1724*    -------------------------------
  1725     05  ACVSTATL PIC S9(0004) COMP.
  1726     05  ACVSTATF PIC  X(0001).
  1727     05  FILLER REDEFINES ACVSTATF.
  1728         10  ACVSTATA PIC  X(0001).
  1729     05  ACVSTATI PIC  X(0006).
  1730*    -------------------------------
  1731     05  ERRMSG1L PIC S9(0004) COMP.
  1732     05  ERRMSG1F PIC  X(0001).
  1733     05  FILLER REDEFINES ERRMSG1F.
  1734         10  ERRMSG1A PIC  X(0001).
  1735     05  ERRMSG1I PIC  X(0072).
  1736*    -------------------------------
  1737     05  ERRMSG2L PIC S9(0004) COMP.
  1738     05  ERRMSG2F PIC  X(0001).
  1739     05  FILLER REDEFINES ERRMSG2F.
  1740         10  ERRMSG2A PIC  X(0001).
  1741     05  ERRMSG2I PIC  X(0072).
  1742*    -------------------------------
  1743     05  BCERT1L PIC S9(0004) COMP.
  1744     05  BCERT1F PIC  X(0001).
  1745     05  FILLER REDEFINES BCERT1F.
  1746         10  BCERT1A PIC  X(0001).
  1747     05  BCERT1I PIC  X(0010).
  1748*    -------------------------------
  1749     05  BSUFX1L PIC S9(0004) COMP.
  1750     05  BSUFX1F PIC  X(0001).
  1751     05  FILLER REDEFINES BSUFX1F.
  1752         10  BSUFX1A PIC  X(0001).
  1753     05  BSUFX1I PIC  X(0001).
  1754*    -------------------------------
  1755     05  BCERT2L PIC S9(0004) COMP.
  1756     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  34
* EL130.cbl
  1757     05  FILLER REDEFINES BCERT2F.
  1758         10  BCERT2A PIC  X(0001).
  1759     05  BCERT2I PIC  X(0010).
  1760*    -------------------------------
  1761     05  BSUFX2L PIC S9(0004) COMP.
  1762     05  BSUFX2F PIC  X(0001).
  1763     05  FILLER REDEFINES BSUFX2F.
  1764         10  BSUFX2A PIC  X(0001).
  1765     05  BSUFX2I PIC  X(0001).
  1766*    -------------------------------
  1767     05  BCERT3L PIC S9(0004) COMP.
  1768     05  BCERT3F PIC  X(0001).
  1769     05  FILLER REDEFINES BCERT3F.
  1770         10  BCERT3A PIC  X(0001).
  1771     05  BCERT3I PIC  X(0010).
  1772*    -------------------------------
  1773     05  BSUFX3L PIC S9(0004) COMP.
  1774     05  BSUFX3F PIC  X(0001).
  1775     05  FILLER REDEFINES BSUFX3F.
  1776         10  BSUFX3A PIC  X(0001).
  1777     05  BSUFX3I PIC  X(0001).
  1778*    -------------------------------
  1779     05  BCERT4L PIC S9(0004) COMP.
  1780     05  BCERT4F PIC  X(0001).
  1781     05  FILLER REDEFINES BCERT4F.
  1782         10  BCERT4A PIC  X(0001).
  1783     05  BCERT4I PIC  X(0010).
  1784*    -------------------------------
  1785     05  BSUFX4L PIC S9(0004) COMP.
  1786     05  BSUFX4F PIC  X(0001).
  1787     05  FILLER REDEFINES BSUFX4F.
  1788         10  BSUFX4A PIC  X(0001).
  1789     05  BSUFX4I PIC  X(0001).
  1790*    -------------------------------
  1791     05  BCERT5L PIC S9(0004) COMP.
  1792     05  BCERT5F PIC  X(0001).
  1793     05  FILLER REDEFINES BCERT5F.
  1794         10  BCERT5A PIC  X(0001).
  1795     05  BCERT5I PIC  X(0010).
  1796*    -------------------------------
  1797     05  BSUFX5L PIC S9(0004) COMP.
  1798     05  BSUFX5F PIC  X(0001).
  1799     05  FILLER REDEFINES BSUFX5F.
  1800         10  BSUFX5A PIC  X(0001).
  1801     05  BSUFX5I PIC  X(0001).
  1802*    -------------------------------
  1803     05  ENTERPFL PIC S9(0004) COMP.
  1804     05  ENTERPFF PIC  X(0001).
  1805     05  FILLER REDEFINES ENTERPFF.
  1806         10  ENTERPFA PIC  X(0001).
  1807     05  ENTERPFI PIC  99.
  1808*    -------------------------------
  1809     05  PF5L PIC S9(0004) COMP.
  1810     05  PF5F PIC  X(0001).
  1811     05  FILLER REDEFINES PF5F.
  1812         10  PF5A PIC  X(0001).
  1813     05  PF5I PIC  X(0013).
  1814 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  35
* EL130.cbl
  1815     05  FILLER            PIC  X(0012).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  RUNDTEO PIC  X(0008).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  RUNTIMEO PIC  99.99.
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  COMPO PIC  X(0003).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  SEQUO PIC  X(0010).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  MAINTO PIC  X(0001).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  CLMNOO PIC  X(0007).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  CLMCARRO PIC  X(0001).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  CLMTYPEO PIC  X(0001).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  CERTNOO PIC  X(0010).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  SUFXO PIC  X(0001).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  PCERTNOO PIC  X(0010).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  PSUFXO PIC  X(0001).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  INCURO PIC  X(0008).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  REPORTO PIC  X(0008).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  ICD1O PIC  X(0008).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  ICD2O PIC  X(0008).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  DIAGO PIC  X(0060).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  BENECDO PIC  X(0010).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  36
* EL130.cbl
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  SSNO PIC  X(0011).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  SEXO PIC  X(0001).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  INSTYPEO PIC  X(0001).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  LSTNMEO PIC  X(0015).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  FSTNMEO PIC  X(0012).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  INITO PIC  X(0001).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  LOANNOO PIC  X(0008).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  CRTLNMEO PIC  X(0015).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  CRTFNMEO PIC  X(0012).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  CRTINITO PIC  X(0001).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  LOANBALO PIC  ZZZZZ9.99.
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  MANRSVO PIC  Z(5)9.99.
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  SUPVO PIC  X(0001).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  PRICDO PIC  X(0001).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  PRODO PIC  X(0008).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  PRODCDO PIC  X(0001).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  FILETOO PIC  X(0004).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  PROCCDO PIC  X(0004).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  RELCLMO PIC  X(0007).
  1930*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  37
* EL130.cbl
  1931     05  FILLER            PIC  X(0003).
  1932     05  PRTOPTO PIC  X(0001).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  ALTPRTO PIC  X(0004).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  CERTMTO PIC  X(0001).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  CRTCARRO PIC  X(0001).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  GROUPO PIC  X(0006).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  STATEO PIC  X(0002).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  ACCOUNTO PIC  X(0010).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  EFFDTO PIC  X(0008).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  CRTSSNO PIC  X(0011).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  MEMCAPO PIC  X(0010).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  MEMBERO PIC  X(0012).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  REINCDO PIC  X(0001).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  ISSAGEO PIC  X(0002).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  APRO PIC  9(3).9(4).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  PMTFREQO PIC  99.
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  INDGRPO PIC  X(0001).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  PREMTYPO PIC  X(0001).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  ADDONDTO PIC  X(0008).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  JNTLNMEO PIC  X(0015).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  38
* EL130.cbl
  1989     05  JNTFNMEO PIC  X(0002).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  JNTINITO PIC  X(0001).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  JNTAGEO PIC  X(0002).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  LCVDSCRO PIC  X(0006).
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  LCVKINDO PIC  X(0003).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  LCVCDO PIC  X(0002).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  LCVOTRMO PIC  999.
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  LCVRTRMO PIC  ZZZ.
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  LCVRATEO PIC  ZZZ.ZZ.
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  LCVFORMO PIC  X(0012).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  LCVCNDTO PIC  X(0008).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  LCVEXITO PIC  X(0008).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  LCVSTATO PIC  X(0006).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  ACVDSCRO PIC  X(0006).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  ACVKINDO PIC  X(0003).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  ACVCDO PIC  X(0002).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  ACVOTRMO PIC  999.
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  ACVRTRMO PIC  ZZZ.
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  39
* EL130.cbl
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  ACVFORMO PIC  X(0012).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  ACVCNDTO PIC  X(0008).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  ACVEXITO PIC  X(0008).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  ACVSTATO PIC  X(0006).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  ERRMSG1O PIC  X(0072).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  ERRMSG2O PIC  X(0072).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  BCERT1O PIC  X(0010).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  BSUFX1O PIC  X(0001).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  BCERT2O PIC  X(0010).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  BSUFX2O PIC  X(0001).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  BCERT3O PIC  X(0010).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  BSUFX3O PIC  X(0001).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  BCERT4O PIC  X(0010).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  BSUFX4O PIC  X(0001).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  BCERT5O PIC  X(0010).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  BSUFX5O PIC  X(0001).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  ENTERPFO PIC  X(0002).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  PF5O PIC  X(0013).
  2104*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  40
* EL130.cbl
  2106*    COPY ELCDATE.
  2107******************************************************************
  2108*                                                                *
  2109*                                                                *
  2110*                            ELCDATE.                            *
  2111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2112*                            VMOD=2.003
  2113*                                                                *
  2114*                                                                *
  2115*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2116*                 LENGTH = 200                                   *
  2117******************************************************************
  2118
  2119 01  DATE-CONVERSION-DATA.
  2120     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2121     12  DC-OPTION-CODE                PIC X.
  2122         88  BIN-TO-GREG                VALUE ' '.
  2123         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2124         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2125         88  YMD-GREG-TO-BIN            VALUE '3'.
  2126         88  MDY-GREG-TO-BIN            VALUE '4'.
  2127         88  JULIAN-TO-BIN              VALUE '5'.
  2128         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2129         88  FIND-CENTURY               VALUE '7'.
  2130         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2131         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2132         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2133         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2134         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2135         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2136         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2137         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2138         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2139         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2140         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2141         88  BIN-3-TO-GREG              VALUE 'I'.
  2142         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2143         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2144         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2145         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2146         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2147         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2148         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2149         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2150         88  THREE-CHARACTER-BIN
  2151                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2152         88  GREGORIAN-TO-BIN
  2153                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2154         88  BIN-TO-GREGORIAN
  2155                  VALUES ' ' '1' 'I' '8' 'G'.
  2156         88  JULIAN-TO-BINARY
  2157                  VALUES '5' 'C' 'E' 'F'.
  2158     12  DC-ERROR-CODE                 PIC X.
  2159         88  NO-CONVERSION-ERROR        VALUE ' '.
  2160         88  DATE-CONVERSION-ERROR
  2161                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2162         88  DATE-IS-ZERO               VALUE '1'.
  2163         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  41
* EL130.cbl
  2164         88  DATE-IS-INVALID            VALUE '3'.
  2165         88  DATE1-GREATER-DATE2        VALUE '4'.
  2166         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2167         88  DATE-INVALID-OPTION        VALUE '9'.
  2168         88  INVALID-CENTURY            VALUE 'A'.
  2169         88  ONLY-CENTURY               VALUE 'B'.
  2170         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2171         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2172     12  DC-END-OF-MONTH               PIC X.
  2173         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2174     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2175         88  USE-NORMAL-PROCESS         VALUE ' '.
  2176         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2177         88  ADJUST-UP-100-YRS          VALUE '2'.
  2178     12  FILLER                        PIC X.
  2179     12  DC-CONVERSION-DATES.
  2180         16  DC-BIN-DATE-1             PIC XX.
  2181         16  DC-BIN-DATE-2             PIC XX.
  2182         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2183         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2184                       DC-GREG-DATE-1-EDIT.
  2185             20  DC-EDIT1-MONTH        PIC 99.
  2186             20  SLASH1-1              PIC X.
  2187             20  DC-EDIT1-DAY          PIC 99.
  2188             20  SLASH1-2              PIC X.
  2189             20  DC-EDIT1-YEAR         PIC 99.
  2190         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2191         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2192                     DC-GREG-DATE-2-EDIT.
  2193             20  DC-EDIT2-MONTH        PIC 99.
  2194             20  SLASH2-1              PIC X.
  2195             20  DC-EDIT2-DAY          PIC 99.
  2196             20  SLASH2-2              PIC X.
  2197             20  DC-EDIT2-YEAR         PIC 99.
  2198         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2199         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2200                     DC-GREG-DATE-1-YMD.
  2201             20  DC-YMD-YEAR           PIC 99.
  2202             20  DC-YMD-MONTH          PIC 99.
  2203             20  DC-YMD-DAY            PIC 99.
  2204         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2205         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2206                      DC-GREG-DATE-1-MDY.
  2207             20  DC-MDY-MONTH          PIC 99.
  2208             20  DC-MDY-DAY            PIC 99.
  2209             20  DC-MDY-YEAR           PIC 99.
  2210         16  DC-GREG-DATE-1-ALPHA.
  2211             20  DC-ALPHA-MONTH        PIC X(10).
  2212             20  DC-ALPHA-DAY          PIC 99.
  2213             20  FILLER                PIC XX.
  2214             20  DC-ALPHA-CENTURY.
  2215                 24 DC-ALPHA-CEN-N     PIC 99.
  2216             20  DC-ALPHA-YEAR         PIC 99.
  2217         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2218         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2219         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2220         16  DC-JULIAN-DATE            PIC 9(05).
  2221         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  42
* EL130.cbl
  2222                                       PIC 9(05).
  2223         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2224             20  DC-JULIAN-YEAR        PIC 99.
  2225             20  DC-JULIAN-DAYS        PIC 999.
  2226         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2227         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2228         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2229     12  DATE-CONVERSION-VARIBLES.
  2230         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2231         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2232             20  FILLER                PIC 9(3).
  2233             20  HOLD-CEN-1-CCYY.
  2234                 24  HOLD-CEN-1-CC     PIC 99.
  2235                 24  HOLD-CEN-1-YY     PIC 99.
  2236             20  HOLD-CEN-1-MO         PIC 99.
  2237             20  HOLD-CEN-1-DA         PIC 99.
  2238         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2239             20  HOLD-CEN-1-R-MO       PIC 99.
  2240             20  HOLD-CEN-1-R-DA       PIC 99.
  2241             20  HOLD-CEN-1-R-CCYY.
  2242                 24  HOLD-CEN-1-R-CC   PIC 99.
  2243                 24  HOLD-CEN-1-R-YY   PIC 99.
  2244             20  FILLER                PIC 9(3).
  2245         16  HOLD-CENTURY-1-X.
  2246             20  FILLER                PIC X(3)  VALUE SPACES.
  2247             20  HOLD-CEN-1-X-CCYY.
  2248                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2249                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2250             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2251             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2252         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2253             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2254             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2255             20  HOLD-CEN-1-R-X-CCYY.
  2256                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2257                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2258             20  FILLER                PIC XXX.
  2259         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2260         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2261         16  DC-JULIAN-DATE-1          PIC 9(07).
  2262         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2263             20  DC-JULIAN-1-CCYY.
  2264                 24  DC-JULIAN-1-CC    PIC 99.
  2265                 24  DC-JULIAN-1-YR    PIC 99.
  2266             20  DC-JULIAN-DA-1        PIC 999.
  2267         16  DC-JULIAN-DATE-2          PIC 9(07).
  2268         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2269             20  DC-JULIAN-2-CCYY.
  2270                 24  DC-JULIAN-2-CC    PIC 99.
  2271                 24  DC-JULIAN-2-YR    PIC 99.
  2272             20  DC-JULIAN-DA-2        PIC 999.
  2273         16  DC-GREG-DATE-A-EDIT.
  2274             20  DC-EDITA-MONTH        PIC 99.
  2275             20  SLASHA-1              PIC X VALUE '/'.
  2276             20  DC-EDITA-DAY          PIC 99.
  2277             20  SLASHA-2              PIC X VALUE '/'.
  2278             20  DC-EDITA-CCYY.
  2279                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  43
* EL130.cbl
  2280                 24  DC-EDITA-YEAR     PIC 99.
  2281         16  DC-GREG-DATE-B-EDIT.
  2282             20  DC-EDITB-MONTH        PIC 99.
  2283             20  SLASHB-1              PIC X VALUE '/'.
  2284             20  DC-EDITB-DAY          PIC 99.
  2285             20  SLASHB-2              PIC X VALUE '/'.
  2286             20  DC-EDITB-CCYY.
  2287                 24  DC-EDITB-CENT     PIC 99.
  2288                 24  DC-EDITB-YEAR     PIC 99.
  2289         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2290         16  DC-GREG-DATE-CYMD-R REDEFINES
  2291                              DC-GREG-DATE-CYMD.
  2292             20  DC-CYMD-CEN           PIC 99.
  2293             20  DC-CYMD-YEAR          PIC 99.
  2294             20  DC-CYMD-MONTH         PIC 99.
  2295             20  DC-CYMD-DAY           PIC 99.
  2296         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2297         16  DC-GREG-DATE-MDCY-R REDEFINES
  2298                              DC-GREG-DATE-MDCY.
  2299             20  DC-MDCY-MONTH         PIC 99.
  2300             20  DC-MDCY-DAY           PIC 99.
  2301             20  DC-MDCY-CEN           PIC 99.
  2302             20  DC-MDCY-YEAR          PIC 99.
  2303    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2304        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2305    12  DC-EL310-DATE                  PIC X(21).
  2306    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  44
* EL130.cbl
  2308*    COPY ELCCALC.
  2309******************************************************************
  2310*                                                                *
  2311*                           ELCCALC.                            *
  2312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2313*                            VMOD=2.025                          *
  2314*                                                                *
  2315*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2316*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2317*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2318*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2319*                                                                *
  2320*  PASSED TO ELRTRM                                              *
  2321*  -----------------                                             *
  2322*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2323*  ORIGINAL TERM                                                 *
  2324*  BEGINNING DATE                                                *
  2325*  ENDING DATE                                                   *
  2326*  COMPANY I.D.                                                  *
  2327*  ACCOUNT MASTER USER FIELD                                     *
  2328*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2329*  FREE LOOK DAYS                                                *
  2330*                                                                *
  2331*  RETURNED FROM ELRTRM                                          *
  2332*  ---------------------                                         *
  2333*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2334*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2335*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2336*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2337*----------------------------------------------------------------*
  2338*  PASSED TO ELRAMT                                              *
  2339*  ----------------                                              *
  2340*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2341*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2342*  ORIGINAL AMOUNT                                               *
  2343*  ALTERNATE BENEFIT (BALLON)                                    *
  2344*  A.P.R. - NET PAY ONLY                                         *
  2345*  METHOD
  2346*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2347*  COMPANY I.D.                                                  *
  2348*  BENEFIT TYPE                                                  *
  2349*                                                                *
  2350*  RETURNED FROM ELRAMT                                          *
  2351*  --------------------                                          *
  2352*  REMAINING AMOUNT 1 - CURRENT                                  *
  2353*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2354*  REMAINING AMOUNT FACTOR
  2355*----------------------------------------------------------------*
  2356*  PASSED TO ELRESV                                              *
  2357*  -----------------                                             *
  2358*  CERTIFICATE EFFECTIVE DATE                                    *
  2359*  VALUATION DATE                                                *
  2360*  PAID THRU DATE                                                *
  2361*  BENEFIT                                                       *
  2362*  INCURRED DATE                                                 *
  2363*  REPORTED DATE                                                 *
  2364*  ISSUE AGE                                                     *
  2365*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  45
* EL130.cbl
  2366*  CDT PERCENT                                                   *
  2367*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2368* *CLAIM TYPE (LIFE, A/H)                                        *
  2369* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2370* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2371*                                                                *
  2372*  RETURNED FROM ELRESV                                          *
  2373*  --------------------                                          *
  2374*  CDT TABLE USED                                                *
  2375*  CDT FACTOR USED                                               *
  2376*  PAY TO CURRENT RESERVE                                        *
  2377*  I.B.N.R. - A/H ONLY                                           *
  2378*  FUTURE (ACCRUED) AH ONLY                                      *
  2379*----------------------------------------------------------------*
  2380*  PASSED TO ELRATE                                              *
  2381*  ----------------                                              *
  2382*  CERT ISSUE DATE                                               *
  2383*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2384*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2385*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2386*  STATE CODE (CLIENT DEFINED)                                   *
  2387*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2388*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2389*  DEVIATION CODE                                                *
  2390*  ISSUE AGE                                                     *
  2391*  ORIGINAL BENEFIT AMOUNT                                       *
  2392*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2393*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2394*  BENEFIT KIND (LIFE OR A/H)                                    *
  2395*  A.P.R.                                                        *
  2396*  METHOD
  2397*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2398*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2399*  COMPANY I.D. (3 CHARACTER)                                    *
  2400*  BENEFIT CODE                                                  *
  2401*  BENEFIT OVERRIDE CODE                                         *
  2402*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2403*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2404*  JOINT INDICATOR (CSL ONLY)                                    *
  2405*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2406*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2407*                                                                *
  2408*  RETURNED FROM ELRATE                                          *
  2409*  --------------------                                          *
  2410*  CALCULATED PREMIUM                                            *
  2411*  PREMIUM RATE                                                  *
  2412*  MORTALITY CODE                                                *
  2413*  MAX ATTAINED AGE                                              *
  2414*  MAX AGE                                                       *
  2415*  MAX TERM                                                      *
  2416*  MAX MONTHLY BENEFIT                                           *
  2417*  MAX TOTAL BENIFIT                                             *
  2418*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2419*----------------------------------------------------------------*
  2420*  PASSED TO ELRFND                                              *
  2421*  ----------------                                              *
  2422*  CERT ISSUE DATE                                               *
  2423*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  46
* EL130.cbl
  2424*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2425*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2426*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2427*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2428*  STATE CODE (CLIENT DEFINED)                                   *
  2429*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2430*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2431*  DEVIATION CODE                                                *
  2432*  ISSUE AGE                                                     *
  2433*  ORIGINAL BENEFIT AMOUNT                                       *
  2434*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2435*  PROCESS TYPE (CANCEL)                                         *
  2436*  BENEFIT KIND (LIFE OR A/H)                                    *
  2437*  A.P.R.                                                        *
  2438*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2439*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2440*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2441*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2442*  COMPANY I.D. (3 CHARACTER)                                    *
  2443*  BENEFIT CODE                                                  *
  2444*  BENEFIT OVERRIDE CODE                                         *
  2445*                                                                *
  2446*  RETURNED FROM ELRFND                                          *
  2447*  --------------------                                          *
  2448*  CALCULATED REFUND                                             *
  2449*----------------------------------------------------------------*
  2450*  PASSED TO ELEARN                                              *
  2451*  ----------------                                              *
  2452*  CERT ISSUE DATE                                               *
  2453*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2454*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2455*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2456*  STATE CODE (CLIENT DEFINED)                                   *
  2457*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2458*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2459*  DEVIATION CODE                                                *
  2460*  ISSUE AGE                                                     *
  2461*  ORIGINAL BENEFIT AMOUNT                                       *
  2462*  BENEFIT KIND (LIFE OR A/H)                                    *
  2463*  A.P.R.                                                        *
  2464*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2465*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2466*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2467*  COMPANY I.D. (3 CHARACTER)                                    *
  2468*  BENEFIT CODE                                                  *
  2469*  BENEFIT OVERRIDE CODE                                         *
  2470*                                                                *
  2471*  RETURNED FROM ELEARN                                          *
  2472*  --------------------                                          *
  2473*  INDICATED  EARNINGS                                           *
  2474*----------------------------------------------------------------*
  2475*                 LENGTH = 450                                   *
  2476*                                                                *
  2477******************************************************************
  2478******************************************************************
  2479*                   C H A N G E   L O G
  2480*
  2481* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  47
* EL130.cbl
  2482*-----------------------------------------------------------------
  2483*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2484* EFFECTIVE    NUMBER
  2485*-----------------------------------------------------------------
  2486* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2487* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2488* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2489* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2490* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2491* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2492* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2493* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2494* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2495* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2496* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2497******************************************************************
  2498
  2499 01  CALCULATION-PASS-AREA.
  2500     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2501                                     COMP.
  2502
  2503     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2504       88  NO-CP-ERROR                             VALUE ZERO.
  2505       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2506                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2507       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2508       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2509       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2510       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2511       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2512       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2513       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2514       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2515       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2516       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2517       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2518       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2519       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2520       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2521       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2522       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2523       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2524
  2525     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2526       88  NO-CP-ERROR-2                           VALUE ZERO.
  2527***********************  INPUT AREAS ****************************
  2528
  2529     12  CP-CALCULATION-AREA.
  2530         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2531         16  CP-CERT-EFF-DT        PIC XX.
  2532         16  CP-VALUATION-DT       PIC XX.
  2533         16  CP-PAID-THRU-DT       PIC XX.
  2534         16  CP-BENEFIT-TYPE       PIC X.
  2535           88  CP-AH                               VALUE 'A' 'D'
  2536                                                   'I' 'U'.
  2537           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2538           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2539         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  48
* EL130.cbl
  2540         16  CP-REPORTED-DT        PIC XX.
  2541         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2542         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2543         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2544                                     COMP-3.
  2545         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2546                                     COMP-3.
  2547         16  CP-CDT-METHOD         PIC X.
  2548           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2549           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2550           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2551         16  CP-CLAIM-TYPE         PIC X.
  2552           88  CP-AH-CLAIM                         VALUE 'A'.
  2553           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2554         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2555                                     COMP-3.
  2556         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2557                                     COMP-3.
  2558         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2559                                     COMP-3.
  2560         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2561                                     COMP-3.
  2562         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2563                                     COMP-3.
  2564         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2565                                     COMP-3.
  2566         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2567                                     COMP-3.
  2568         16  CP-REM-TERM-METHOD    PIC X.
  2569           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2570           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2571           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2572           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2573           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2574           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2575           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2576         16  CP-EARNING-METHOD     PIC X.
  2577           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2578           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2579           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2580           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2581           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2582           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2583           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2584           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2585           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2586           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2587           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2588           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2589           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2590           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2591         16  CP-PROCESS-TYPE       PIC X.
  2592           88  CP-CLAIM                            VALUE '1'.
  2593           88  CP-CANCEL                           VALUE '2'.
  2594           88  CP-ISSUE                            VALUE '3'.
  2595         16  CP-SPECIAL-CALC-CD    PIC X.
  2596           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2597           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  49
* EL130.cbl
  2598           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2599           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2600           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2601           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2602           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2603           88  CP-FARM-PLAN                    VALUE 'F'.
  2604           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2605           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2606           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2607           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2608           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2609           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2610           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2611           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2612           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2613           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2614                                                     'W' 'X'.
  2615           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2616           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2617           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2618           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2619           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2620           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2621           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2622           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2623           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2624           88  CP-CSL-METH-1                   VALUE '5'.
  2625           88  CP-CSL-METH-2                   VALUE '6'.
  2626           88  CP-CSL-METH-3                   VALUE '7'.
  2627           88  CP-CSL-METH-4                   VALUE '8'.
  2628
  2629         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2630                                     COMP-3.
  2631         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2632         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2633         16  CP-STATE              PIC XX          VALUE SPACE.
  2634         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2635         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2636           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2637               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2638         16  CP-R78-OPTION         PIC X.
  2639           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2640           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2641
  2642         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2643         16  CP-IBNR-RESERVE-SW    PIC X.
  2644         16  CP-CLAIM-STATUS       PIC X.
  2645         16  CP-RATE-FILE          PIC X.
  2646         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2647                                     COMP-3.
  2648
  2649         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2650         16  CP-AH-OVERRIDE-CODE   PIC X.
  2651
  2652         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2653                                     COMP-3.
  2654         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2655                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  50
* EL130.cbl
  2656         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2657                                     COMP-3.
  2658         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2659                                     COMP-3.
  2660         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2661                                     COMP-3.
  2662         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2663                                  PIC S9(7)V99 COMP-3.
  2664
  2665         16  CP-PAID-FROM-DATE     PIC X(02).
  2666         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2667         16  CP-EXT-DAYS-CALC      PIC X.
  2668           88  CP-EXT-NO-CHG                   VALUE ' '.
  2669           88  CP-EXT-CHG-LF                   VALUE '1'.
  2670           88  CP-EXT-CHG-AH                   VALUE '2'.
  2671           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2672         16  CP-DOMICILE-STATE     PIC XX.
  2673         16  CP-CARRIER            PIC X.
  2674         16  CP-REIN-FLAG          PIC X.
  2675         16  CP-REM-TRM-CALC-OPTION PIC X.
  2676           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2677                      '2' '3' '4' '5'.
  2678           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2679           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2680           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2681           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2682           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2683           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2684           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2685           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2686         16  CP-SIG-SWITCH         PIC X.
  2687         16  CP-RATING-METHOD      PIC X.
  2688           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2689           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2690           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2691           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2692           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2693           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2694           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2695           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2696           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2697         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2698                                     COMP-3.
  2699         16  CP-BEN-CATEGORY       PIC X.
  2700         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2701         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2702                                   PIC S99V9(5) COMP-3.
  2703         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2704         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2705                                   PIC S99V9(5) COMP-3.
  2706         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2707         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2708         16  CP-EXPIRE-DT          PIC XX.
  2709         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2710         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2711         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2712         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2713         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  51
* EL130.cbl
  2714             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2715             88  CP-CALC-CLP              VALUE 'C'.
  2716         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2717         16  CP-CANCEL-REASON      PIC X.
  2718         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2719         16  CP-PMT-MODE           PIC X.
  2720         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2721         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2722         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2723         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2724         16  FILLER                PIC X.
  2725
  2726***************    OUTPUT FROM ELRESV   ************************
  2727
  2728         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2729
  2730         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2731                                     COMP-3.
  2732         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2733                                     COMP-3.
  2734         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2735                                     COMP-3.
  2736         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2737                                     COMP-3.
  2738         16  FILLER                PIC X(09).
  2739***************    OUTPUT FROM ELRTRM   *************************
  2740
  2741         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2742                                     COMP-3.
  2743         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2744                                     COMP-3.
  2745         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2746                                     COMP-3.
  2747         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2748                                     COMP-3.
  2749         16  FILLER                PIC X(12).
  2750
  2751***************    OUTPUT FROM ELRAMT   *************************
  2752
  2753         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2754                                     COMP-3.
  2755         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2756                                     COMP-3.
  2757         16  FILLER                PIC X(12).
  2758
  2759***************    OUTPUT FROM ELRATE   *************************
  2760
  2761         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2762                                     COMP-3.
  2763         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2764                                     COMP-3.
  2765         16  CP-MORTALITY-CODE     PIC X(4).
  2766         16  CP-RATE-EDIT-FLAG     PIC X.
  2767             88  CP-RATES-NEED-APR                  VALUE '1'.
  2768         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2769                                     COMP-3.
  2770         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2771         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  52
* EL130.cbl
  2772         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2773                                   PIC S9(7)V99 COMP-3.
  2774         16  FILLER                PIC X(07).
  2775
  2776***************    OUTPUT FROM ELRFND   *************************
  2777
  2778         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2779                                     COMP-3.
  2780         16  CP-REFUND-TYPE-USED   PIC X.
  2781           88  CP-R-AS-R78                         VALUE '1'.
  2782           88  CP-R-AS-PRORATA                     VALUE '2'.
  2783           88  CP-R-AS-CALIF                       VALUE '3'.
  2784           88  CP-R-AS-TEXAS                       VALUE '4'.
  2785           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2786           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2787           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2788           88  CP-R-AS-MEAN                        VALUE '8'.
  2789           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2790           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2791           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2792           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2793           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2794           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2795         16  FILLER                PIC X(12).
  2796
  2797***************    OUTPUT FROM ELEARN   *************************
  2798
  2799         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2800                                     COMP-3.
  2801         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2802                                     COMP-3.
  2803         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2804                                     COMP-3.
  2805         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2806                                     COMP-3.
  2807         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2808                                     COMP-3.
  2809         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2810                                     COMP-3.
  2811         16  CP-EARNING-TYPE-USED  PIC X.
  2812           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2813           88  CP-E-AS-R78                         VALUE '1'.
  2814           88  CP-E-AS-PRORATA                     VALUE '2'.
  2815           88  CP-E-AS-TEXAS                       VALUE '4'.
  2816           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2817           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2818           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2819           88  CP-E-AS-MEAN                        VALUE '8'.
  2820           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2821         16  FILLER                PIC X(12).
  2822
  2823***************    OUTPUT FROM ELPMNT   *************************
  2824
  2825         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2826                                     COMP-3.
  2827         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2828                                     COMP-3.
  2829         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  53
* EL130.cbl
  2830
  2831***************   MISC WORK AREAS    *****************************
  2832         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2833                                     COMP-3.
  2834         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2835                                     COMP-3.
  2836         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2837                                     COMP-3.
  2838         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2839                                     COMP-3.
  2840         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2841                                     COMP-3.
  2842         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2843                                     COMP-3.
  2844         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2845             88  OPEN-RATE-FILE                   VALUE 'O'.
  2846             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2847             88  IO-ERROR                         VALUE 'E'.
  2848
  2849         16  CP-FIRST-PAY-DATE     PIC XX.
  2850
  2851         16  CP-JOINT-INDICATOR    PIC X.
  2852
  2853         16  CP-RESERVE-REMAINING-TERM
  2854                                   PIC S9(4)V9    VALUE ZERO
  2855                                     COMP-3.
  2856
  2857         16  CP-INSURED-BIRTH-DT   PIC XX.
  2858
  2859         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2860                                     COMP-3.
  2861
  2862         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2863                                     COMP-3.
  2864
  2865         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2866                                     COMP-3.
  2867
  2868         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2869                                     COMP-3.
  2870
  2871         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2872                                     COMP-3.
  2873
  2874         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2875                                     COMP-3.
  2876
  2877         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2878                                     COMP-3.
  2879
  2880         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2881             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2882
  2883         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2884                                     COMP-3.
  2885         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2886                                     COMP-3.
  2887         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  54
* EL130.cbl
  2888         16  cp-extra-periods      pic 9 value zeros.
  2889         16  cp-net-only-state     pic x value spaces.
  2890         16  FILLER                PIC X(13).
  2891******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  55
* EL130.cbl
  2893*    COPY ELCLOGOF.
  2894******************************************************************
  2895*                                                                *
  2896*                                                                *
  2897*                            ELCLOGOF.                           *
  2898*                            VMOD=2.001                          *
  2899*                                                                *
  2900*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2901*                                                                *
  2902******************************************************************
  2903 01  CLASIC-LOGOFF.
  2904     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2905     12  LOGOFF-TEXT.
  2906         16  FILLER          PIC X(5)    VALUE SPACES.
  2907         16  LOGOFF-MSG.
  2908             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2909             20  FILLER      PIC X       VALUE SPACES.
  2910             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2911         16  FILLER          PIC X(80)
  2912           VALUE '* YOU ARE NOW LOGGED OFF'.
  2913         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2914         16  FILLER          PIC X       VALUE QUOTE.
  2915         16  LOGOFF-SYS-MSG  PIC X(17)
  2916           VALUE 'S CLAS-IC SYSTEM '.
  2917     12  TEXT-MESSAGES.
  2918         16  UNACCESS-MSG    PIC X(29)
  2919             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2920         16  PGMIDERR-MSG    PIC X(17)
  2921             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  56
* EL130.cbl
  2923*    COPY ELCATTR.
  2924******************************************************************
  2925*                                                                *
  2926*                            ELCATTR.                            *
  2927*                            VMOD=2.001                          *
  2928*                                                                *
  2929*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2930*                                                                *
  2931*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2932*                                                                *
  2933*                   POS 1   P=PROTECTED                          *
  2934*                           U=UNPROTECTED                        *
  2935*                           S=ASKIP                              *
  2936*                   POS 2   A=ALPHA/NUMERIC                      *
  2937*                           N=NUMERIC                            *
  2938*                   POS 3   N=NORMAL                             *
  2939*                           B=BRIGHT                             *
  2940*                           D=DARK                               *
  2941*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2942*                           OF=MODIFIED DATA TAG OFF             *
  2943*                                                                *
  2944*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2945******************************************************************
  2946 01  ATTRIBUTE-LIST.
  2947     12  AL-PABOF            PIC X       VALUE 'Y'.
  2948     12  AL-PABON            PIC X       VALUE 'Z'.
  2949     12  AL-PADOF            PIC X       VALUE '%'.
  2950     12  AL-PADON            PIC X       VALUE '_'.
  2951     12  AL-PANOF            PIC X       VALUE '-'.
  2952     12  AL-PANON            PIC X       VALUE '/'.
  2953     12  AL-SABOF            PIC X       VALUE '8'.
  2954     12  AL-SABON            PIC X       VALUE '9'.
  2955     12  AL-SADOF            PIC X       VALUE '@'.
  2956     12  AL-SADON            PIC X       VALUE QUOTE.
  2957     12  AL-SANOF            PIC X       VALUE '0'.
  2958     12  AL-SANON            PIC X       VALUE '1'.
  2959     12  AL-UABOF            PIC X       VALUE 'H'.
  2960     12  AL-UABON            PIC X       VALUE 'I'.
  2961     12  AL-UADOF            PIC X       VALUE '<'.
  2962     12  AL-UADON            PIC X       VALUE '('.
  2963     12  AL-UANOF            PIC X       VALUE ' '.
  2964     12  AL-UANON            PIC X       VALUE 'A'.
  2965     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2966     12  AL-UNBON            PIC X       VALUE 'R'.
  2967     12  AL-UNDOF            PIC X       VALUE '*'.
  2968     12  AL-UNDON            PIC X       VALUE ')'.
  2969     12  AL-UNNOF            PIC X       VALUE '&'.
  2970     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  57
* EL130.cbl
  2972*    COPY ELCEMIB.
  2973******************************************************************
  2974*                                                                *
  2975*                                                                *
  2976*                            ELCEMIB.                            *
  2977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2978*                            VMOD=2.005                          *
  2979*                                                                *
  2980*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2981*                                                                *
  2982******************************************************************
  2983 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2984     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2985     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2986     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2987     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2988     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2989     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2990     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2991     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2992     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2993         88  EMI-NO-ERRORS                    VALUE '1'.
  2994         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2995         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2996     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2997         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2998     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2999         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3000         88  EMI-AREA1-FULL                   VALUE '2'.
  3001     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3002         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3003         88  EMI-AREA2-FULL                   VALUE '2'.
  3004     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3005         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3006         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3007         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3008         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3009         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3010     12  EMI-ERROR-LINES.
  3011         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3012         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3013         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3014         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3015             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3016                 24  EMI-ERR-NUM         PIC X(4).
  3017                 24  EMI-FILLER          PIC X.
  3018                 24  EMI-SEV             PIC X.
  3019                 24  FILLER              PIC X.
  3020             20  FILLER                  PIC X(02).
  3021     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3022         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3023             20  EMI-ERROR-NUMBER    PIC X(4).
  3024             20  EMI-FILL            PIC X.
  3025             20  EMI-SEVERITY        PIC X.
  3026             20  FILLER              PIC X.
  3027             20  EMI-ERROR-TEXT.
  3028                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3029                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  58
* EL130.cbl
  3030     12  EMI-SEVERITY-SAVE           PIC X.
  3031         88  EMI-NOTE                    VALUE 'N'.
  3032         88  EMI-WARNING                 VALUE 'W'.
  3033         88  EMI-FORCABLE                VALUE 'F'.
  3034         88  EMI-FATAL                   VALUE 'X'.
  3035     12  EMI-MESSAGE-FLAG            PIC X.
  3036         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3037         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3038     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3039     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3040         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3041         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3042         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3043     12  emi-claim-no                pic x(7).
  3044     12  emi-claim-type              pic x(6).
  3045     12  FILLER                      PIC X(124)  VALUE SPACES.
  3046     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3047     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3048     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3049     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  59
* EL130.cbl
  3051*    COPY ELCJPFX.
  3052******************************************************************
  3053*                                                                *
  3054*                                                                *
  3055*                            ELCJPFX.                            *
  3056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3057*                            VMOD=2.002                          *
  3058*                                                                *
  3059*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3060*                                                                *
  3061*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3062*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3063*        ELCNTL - CONTROL FILE                                   *
  3064*        ELMSTR - CLAIM MASTERS                                  *
  3065*        ELTRLR - ACTIVITY TRAILERS                              *
  3066*        ELCHKQ - CHECK QUE                                      *
  3067******************************************************************
  3068 01  JOURNAL-RECORD.
  3069     12  jp-date                     pic s9(5) comp-3.
  3070     12  jp-time                     pic s9(7) comp-3.
  3071     12  JP-USER-ID                  PIC X(4).
  3072     12  JP-FILE-ID                  PIC X(8).
  3073     12  JP-PROGRAM-ID               PIC X(8).
  3074     12  JP-RECORD-TYPE              PIC X.
  3075         88 JP-ADD              VALUE 'A'.
  3076         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3077         88 JP-AFTER-CHANGE     VALUE 'C'.
  3078         88 JP-DELETE           VALUE 'D'.
  3079         88 JP-GENERIC-DELETE   VALUE 'G'.
  3080         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3081         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3082     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3083     12  JP-RECORD-AREA
  3084
  3085
  3086         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  60
* EL130.cbl
  3088*    COPY ELCAID.
  3089******************************************************************
  3090*                                                                *
  3091*                            ELCAID.                             *
  3092*                            VMOD=2.001                          *
  3093*                                                                *
  3094*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3095*                                                                *
  3096*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3097*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3098******************************************************************
  3099
  3100 01  DFHAID.
  3101   02  DFHNULL   PIC  X  VALUE  ' '.
  3102   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3103   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3104   02  DFHPEN    PIC  X  VALUE  '='.
  3105   02  DFHOPID   PIC  X  VALUE  'W'.
  3106   02  DFHPA1    PIC  X  VALUE  '%'.
  3107   02  DFHPA2    PIC  X  VALUE  '>'.
  3108   02  DFHPA3    PIC  X  VALUE  ','.
  3109   02  DFHPF1    PIC  X  VALUE  '1'.
  3110   02  DFHPF2    PIC  X  VALUE  '2'.
  3111   02  DFHPF3    PIC  X  VALUE  '3'.
  3112   02  DFHPF4    PIC  X  VALUE  '4'.
  3113   02  DFHPF5    PIC  X  VALUE  '5'.
  3114   02  DFHPF6    PIC  X  VALUE  '6'.
  3115   02  DFHPF7    PIC  X  VALUE  '7'.
  3116   02  DFHPF8    PIC  X  VALUE  '8'.
  3117   02  DFHPF9    PIC  X  VALUE  '9'.
  3118   02  DFHPF10   PIC  X  VALUE  ':'.
  3119   02  DFHPF11   PIC  X  VALUE  '#'.
  3120   02  DFHPF12   PIC  X  VALUE  '@'.
  3121   02  DFHPF13   PIC  X  VALUE  'A'.
  3122   02  DFHPF14   PIC  X  VALUE  'B'.
  3123   02  DFHPF15   PIC  X  VALUE  'C'.
  3124   02  DFHPF16   PIC  X  VALUE  'D'.
  3125   02  DFHPF17   PIC  X  VALUE  'E'.
  3126   02  DFHPF18   PIC  X  VALUE  'F'.
  3127   02  DFHPF19   PIC  X  VALUE  'G'.
  3128   02  DFHPF20   PIC  X  VALUE  'H'.
  3129   02  DFHPF21   PIC  X  VALUE  'I'.
  3130*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3131   02  DFHPF22   PIC  X  VALUE  '['.
  3132   02  DFHPF23   PIC  X  VALUE  '.'.
  3133   02  DFHPF24   PIC  X  VALUE  '<'.
  3134   02  DFHMSRE   PIC  X  VALUE  'X'.
  3135   02  DFHSTRF   PIC  X  VALUE  'h'.
  3136   02  DFHTRIG   PIC  X  VALUE  '"'.
  3137
  3138 01  FILLER    REDEFINES DFHAID.
  3139     12  FILLER              PIC X(8).
  3140     12  PF-VALUES           PIC X       OCCURS 12.
  3141
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  61
* EL130.cbl
  3143****************************************************************
  3144*
  3145* Copyright (c) 2007-2013 Dell Inc.
  3146* All rights reserved.
  3147*
  3148****************************************************************
  3149 01  DFHEIV.
  3150   02  DFHEIV0               PIC X(35).
  3151   02  DFHEIV1               PIC X(08).
  3152   02  DFHEIV2               PIC X(08).
  3153   02  DFHEIV3               PIC X(08).
  3154   02  DFHEIV4               PIC X(06).
  3155   02  DFHEIV5               PIC X(04).
  3156   02  DFHEIV6               PIC X(04).
  3157   02  DFHEIV7               PIC X(02).
  3158   02  DFHEIV8               PIC X(02).
  3159   02  DFHEIV9               PIC X(01).
  3160   02  DFHEIV10              PIC S9(7) COMP-3.
  3161   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3162   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3163   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3164   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3165   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3166   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3167   02  DFHEIV17              PIC X(04).
  3168   02  DFHEIV18              PIC X(04).
  3169   02  DFHEIV19              PIC X(04).
  3170   02  DFHEIV20              USAGE IS POINTER.
  3171   02  DFHEIV21              USAGE IS POINTER.
  3172   02  DFHEIV22              USAGE IS POINTER.
  3173   02  DFHEIV23              USAGE IS POINTER.
  3174   02  DFHEIV24              USAGE IS POINTER.
  3175   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3176   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3177   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3178   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3179   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3180   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3181   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3182   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3183   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3184   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3185   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3186   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3187   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3188   02  FILLER                PIC X(02).
  3189   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3190   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3191   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3192   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3193   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3194   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3195   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3196 LINKAGE  SECTION.
  3197*****************************************************************
  3198*                                                               *
  3199* Copyright (c) 2007-2013 Dell Inc.                             *
  3200* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  62
* EL130.cbl
  3201*                                                               *
  3202*****************************************************************
  3203 01  dfheiblk.
  3204     02  eibtime          pic s9(7) comp-3.
  3205     02  eibdate          pic s9(7) comp-3.
  3206     02  eibtrnid         pic x(4).
  3207     02  eibtaskn         pic s9(7) comp-3.
  3208     02  eibtrmid         pic x(4).
  3209     02  dfheigdi         pic s9(4) comp.
  3210     02  eibcposn         pic s9(4) comp.
  3211     02  eibcalen         pic s9(4) comp.
  3212     02  eibaid           pic x(1).
  3213     02  eibfiller1       pic x(1).
  3214     02  eibfn            pic x(2).
  3215     02  eibfiller2       pic x(2).
  3216     02  eibrcode         pic x(6).
  3217     02  eibfiller3       pic x(2).
  3218     02  eibds            pic x(8).
  3219     02  eibreqid         pic x(8).
  3220     02  eibrsrce         pic x(8).
  3221     02  eibsync          pic x(1).
  3222     02  eibfree          pic x(1).
  3223     02  eibrecv          pic x(1).
  3224     02  eibsend          pic x(1).
  3225     02  eibatt           pic x(1).
  3226     02  eibeoc           pic x(1).
  3227     02  eibfmh           pic x(1).
  3228     02  eibcompl         pic x(1).
  3229     02  eibsig           pic x(1).
  3230     02  eibconf          pic x(1).
  3231     02  eiberr           pic x(1).
  3232     02  eibrldbk         pic x(1).
  3233     02  eiberrcd         pic x(4).
  3234     02  eibsynrb         pic x(1).
  3235     02  eibnodat         pic x(1).
  3236     02  eibfiller5       pic x(2).
  3237     02  eibresp          pic s9(8) comp.
  3238     02  eibresp2         pic s9(8) comp.
  3239     02  dfheigdj         pic s9(4) comp.
  3240     02  dfheigdk         pic s9(4) comp.
  3241
  3242 01  DFHCOMMAREA             PIC X(1024).
  3243
  3244*01 PARMLIST .
  3245*    02  FILLER              PIC S9(8)   COMP.
  3246*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3247*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3248*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3249*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3250*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3251*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3252*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3253*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3254*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  63
* EL130.cbl
  3256*    COPY ELCMSTR.
  3257******************************************************************
  3258*                                                                *
  3259*                            ELCMSTR.                            *
  3260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3261*                            VMOD=2.012                          *
  3262*                                                                *
  3263*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3264*                                                                *
  3265*   FILE TYPE = VSAM,KSDS                                        *
  3266*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3267*                                                                *
  3268*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3269*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3270*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3271*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3272*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3273*                                                 RKP=75,LEN=21  *
  3274*                                                                *
  3275*   **** NOTE ****                                               *
  3276*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3277*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3278*                                                                *
  3279*   LOG = YES                                                    *
  3280*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3281******************************************************************
  3282*                   C H A N G E   L O G
  3283*
  3284* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3285*-----------------------------------------------------------------
  3286*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3287* EFFECTIVE    NUMBER
  3288*-----------------------------------------------------------------
  3289* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3290* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3291* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3292* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3293* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3294* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3295* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3296******************************************************************
  3297 01  CLAIM-MASTER.
  3298     12  CL-RECORD-ID                PIC XX.
  3299         88  VALID-CL-ID         VALUE 'CL'.
  3300
  3301     12  CL-CONTROL-PRIMARY.
  3302         16  CL-COMPANY-CD           PIC X.
  3303         16  CL-CARRIER              PIC X.
  3304         16  CL-CLAIM-NO             PIC X(7).
  3305         16  CL-CERT-NO.
  3306             20  CL-CERT-PRIME       PIC X(10).
  3307             20  CL-CERT-SFX         PIC X.
  3308
  3309     12  CL-CONTROL-BY-NAME.
  3310         16  CL-COMPANY-CD-A1        PIC X.
  3311         16  CL-INSURED-LAST-NAME    PIC X(15).
  3312         16  CL-INSURED-NAME.
  3313             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  64
* EL130.cbl
  3314             20  CL-INSURED-MID-INIT PIC X.
  3315
  3316     12  CL-CONTROL-BY-SSN.
  3317         16  CL-COMPANY-CD-A2        PIC X.
  3318         16  CL-SOC-SEC-NO.
  3319             20  CL-SSN-STATE        PIC XX.
  3320             20  CL-SSN-ACCOUNT      PIC X(6).
  3321             20  CL-SSN-LN3          PIC X(3).
  3322
  3323     12  CL-CONTROL-BY-CERT-NO.
  3324         16  CL-COMPANY-CD-A4        PIC X.
  3325         16  CL-CERT-NO-A4.
  3326             20  CL-CERT-A4-PRIME    PIC X(10).
  3327             20  CL-CERT-A4-SFX      PIC X.
  3328
  3329     12  CL-CONTROL-BY-CCN.
  3330         16  CL-COMPANY-CD-A5        PIC X.
  3331         16  CL-CCN-A5.
  3332             20  CL-CCN.
  3333                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3334                 24  CL-CCN-PRIME-A5 PIC X(12).
  3335             20  CL-CCN-FILLER-A5    PIC X(4).
  3336
  3337     12  CL-INSURED-PROFILE-DATA.
  3338         16  CL-INSURED-BIRTH-DT     PIC XX.
  3339         16  CL-INSURED-SEX-CD       PIC X.
  3340             88  INSURED-IS-MALE        VALUE 'M'.
  3341             88  INSURED-IS-FEMALE      VALUE 'F'.
  3342             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3343         16  CL-INSURED-OCC-CD       PIC X(6).
  3344         16  FILLER                  PIC X(5).
  3345
  3346     12  CL-PROCESSING-INFO.
  3347         16  CL-PROCESSOR-ID         PIC X(4).
  3348         16  CL-CLAIM-STATUS         PIC X.
  3349             88  CLAIM-IS-OPEN          VALUE 'O'.
  3350             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3351         16  CL-CLAIM-TYPE           PIC X.
  3352*            88  AH-CLAIM               VALUE 'A'.
  3353*            88  LIFE-CLAIM             VALUE 'L'.
  3354*            88  PROPERTY-CLAIM         VALUE 'P'.
  3355*            88  IUI-CLAIM              VALUE 'I'.
  3356*            88  GAP-CLAIM              VALUE 'G'.
  3357*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3358*            88  OTHER-CLAIM            VALUE 'O'.
  3359         16  CL-CLAIM-PREM-TYPE      PIC X.
  3360             88  SINGLE-PREMIUM         VALUE '1'.
  3361             88  O-B-COVERAGE           VALUE '2'.
  3362             88  OPEN-END-COVERAGE      VALUE '3'.
  3363         16  CL-INCURRED-DT          PIC XX.
  3364         16  CL-REPORTED-DT          PIC XX.
  3365         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3366         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3367         16  CL-LAST-PMT-DT          PIC XX.
  3368         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3369         16  CL-PAID-THRU-DT         PIC XX.
  3370         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3371         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  65
* EL130.cbl
  3372         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3373         16  CL-PMT-CALC-METHOD      PIC X.
  3374             88  CL-360-DAY-YR          VALUE '1'.
  3375             88  CL-365-DAY-YR          VALUE '2'.
  3376             88  CL-FULL-MONTHS         VALUE '3'.
  3377         16  CL-CAUSE-CD             PIC X(6).
  3378
  3379         16  CL-PRIME-CERT-NO.
  3380             20  CL-PRIME-CERT-PRIME PIC X(10).
  3381             20  CL-PRIME-CERT-SFX   PIC X.
  3382
  3383         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3384             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3385             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3386
  3387         16  CL-MICROFILM-NO         PIC X(10).
  3388         16  FILLER REDEFINES CL-MICROFILM-NO.
  3389             20  CL-BENEFIT-PERIOD   PIC 99.
  3390             20  FILLER              PIC X(8).
  3391         16  CL-PROG-FORM-TYPE       PIC X.
  3392         16  CL-LAST-ADD-ON-DT       PIC XX.
  3393
  3394         16  CL-LAST-REOPEN-DT       PIC XX.
  3395         16  CL-LAST-CLOSE-DT        PIC XX.
  3396         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3397             88  FINAL-PAID             VALUE '1'.
  3398             88  CLAIM-DENIED           VALUE '2'.
  3399             88  AUTO-CLOSE             VALUE '3'.
  3400             88  MANUAL-CLOSE           VALUE '4'.
  3401             88  BENEFITS-CHANGED       VALUE 'C'.
  3402             88  SETUP-ERRORS           VALUE 'E'.
  3403         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3404         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3405         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3406             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3407         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3408         16  FILLER                  PIC X.
  3409
  3410     12  CL-CERTIFICATE-DATA.
  3411         16  CL-CERT-ORIGIN          PIC X.
  3412             88  CERT-WAS-ONLINE        VALUE '1'.
  3413             88  CERT-WAS-CREATED       VALUE '2'.
  3414             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3415         16  CL-CERT-KEY-DATA.
  3416             20  CL-CERT-CARRIER     PIC X.
  3417             20  CL-CERT-GROUPING    PIC X(6).
  3418             20  CL-CERT-STATE       PIC XX.
  3419             20  CL-CERT-ACCOUNT.
  3420                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3421                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3422             20  CL-CERT-EFF-DT      PIC XX.
  3423
  3424     12  CL-STATUS-CONTROLS.
  3425         16  CL-PRIORITY-CD          PIC X.
  3426             88  CONFIDENTIAL-DATA      VALUE '8'.
  3427             88  HIGHEST-PRIORITY       VALUE '9'.
  3428         16  CL-SUPV-ATTN-CD         PIC X.
  3429             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  66
* EL130.cbl
  3430             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3431         16  CL-PURGED-DT            PIC XX.
  3432         16  CL-RESTORED-DT          PIC XX.
  3433         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3434         16  CL-NEXT-RESEND-DT       PIC XX.
  3435         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3436         16  CL-CRITICAL-PERIOD      PIC 99.
  3437*        16  FILLER                  PIC XX.
  3438         16  CL-LAST-MAINT-DT        PIC XX.
  3439         16  CL-LAST-MAINT-USER      PIC X(4).
  3440         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3441         16  CL-LAST-MAINT-TYPE      PIC X.
  3442             88  CLAIM-SET-UP           VALUE ' '.
  3443             88  PAYMENT-MADE           VALUE '1'.
  3444             88  LETTER-SENT            VALUE '2'.
  3445             88  MASTER-WAS-ALTERED     VALUE '3'.
  3446             88  MASTER-WAS-RESTORED    VALUE '4'.
  3447             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3448             88  FILE-CONVERTED         VALUE '6'.
  3449             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3450             88  ERROR-CORRECTION       VALUE 'E'.
  3451         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3452         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3453         16  CL-BENEFICIARY          PIC X(10).
  3454         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3455         16  CL-DENIAL-TYPE          PIC X.
  3456             88  CL-TYPE-DENIAL          VALUE '1'.
  3457             88  CL-TYPE-RESCISSION      VALUE '2'.
  3458             88  CL-TYPE-REFORMATION     VALUE '3'.
  3459             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3460             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3461         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3462         16  filler                  pic x(3).
  3463*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3464*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3465*        16  CL-RTW-DT               PIC XX.
  3466
  3467     12  CL-TRAILER-CONTROLS.
  3468         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3469             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3470             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3471             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3472         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3473         16  FILLER                  PIC XX.
  3474         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3475         16  CL-ADDRESS-TRAILER-CNT.
  3476             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3477                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3478             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3479                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3480             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3481                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3482             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3483                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3484             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3485                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3486             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3487                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  67
* EL130.cbl
  3488             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3489                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3490
  3491     12  CL-CV-REFERENCE-NO.
  3492         16  CL-CV-REFNO-PRIME       PIC X(18).
  3493         16  CL-CV-REFNO-SFX         PIC XX.
  3494
  3495     12  CL-FILE-LOCATION            PIC X(4).
  3496
  3497     12  CL-PROCESS-ERRORS.
  3498         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3499             88  NO-FATAL-ERRORS        VALUE ZERO.
  3500         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3501             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3502
  3503     12  CL-PRODUCT-CD               PIC X.
  3504
  3505     12  CL-CURRENT-KEY-DATA.
  3506         16  CL-CURRENT-CARRIER      PIC X.
  3507         16  CL-CURRENT-GROUPING     PIC X(6).
  3508         16  CL-CURRENT-STATE        PIC XX.
  3509         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3510
  3511     12  CL-ASSOCIATES               PIC X.
  3512         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3513         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3514         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3515         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3516
  3517     12  CL-ACTIVITY-CODE            PIC 99.
  3518     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3519     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3520
  3521     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3522     12  CL-LAG-REPORT-CODE          PIC 9.
  3523     12  CL-LOAN-TYPE                PIC XX.
  3524     12  CL-LEGAL-STATE              PIC XX.
  3525
  3526     12  CL-YESNOSW                  PIC X.
  3527     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3528         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3529         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3530         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3531     12  cl-insured-type             pic x.
  3532         88  cl-claim-on-primary         value 'P'.
  3533         88  cl-claim-on-co-borrower     value 'C'.
  3534     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  68
* EL130.cbl
  3536*    COPY ELCCNTL.
  3537******************************************************************
  3538*                                                                *
  3539*                                                                *
  3540*                            ELCCNTL.                            *
  3541*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3542*                            VMOD=2.059                          *
  3543*                                                                *
  3544*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3545*                                                                *
  3546*   FILE TYPE = VSAM,KSDS                                        *
  3547*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3548*                                                                *
  3549*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3550*       ALTERNATE INDEX = NONE                                   *
  3551*                                                                *
  3552*   LOG = YES                                                    *
  3553*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3554******************************************************************
  3555*                   C H A N G E   L O G
  3556*
  3557* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3558*-----------------------------------------------------------------
  3559*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3560* EFFECTIVE    NUMBER
  3561*-----------------------------------------------------------------
  3562* 082503                   PEMA  ADD BENEFIT GROUP
  3563* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3564* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3565* 092705    2005050300006  PEMA  ADD SPP LEASES
  3566* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3567* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3568* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3569* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3570* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3571* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3572* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3573* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3574* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3575* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3576* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  3577******************************************************************
  3578*
  3579 01  CONTROL-FILE.
  3580     12  CF-RECORD-ID                       PIC XX.
  3581         88  VALID-CF-ID                        VALUE 'CF'.
  3582
  3583     12  CF-CONTROL-PRIMARY.
  3584         16  CF-COMPANY-ID                  PIC XXX.
  3585         16  CF-RECORD-TYPE                 PIC X.
  3586             88  CF-COMPANY-MASTER              VALUE '1'.
  3587             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3588             88  CF-STATE-MASTER                VALUE '3'.
  3589             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3590             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3591             88  CF-CARRIER-MASTER              VALUE '6'.
  3592             88  CF-MORTALITY-MASTER            VALUE '7'.
  3593             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  69
* EL130.cbl
  3594             88  CF-TERMINAL-MASTER             VALUE '9'.
  3595             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3596             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3597             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3598             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3599             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3600             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3601             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3602             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3603             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3604         16  CF-ACCESS-CD-GENL              PIC X(4).
  3605         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3606             20  CF-PROCESSOR               PIC X(4).
  3607         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3608             20  CF-STATE-CODE              PIC XX.
  3609             20  FILLER                     PIC XX.
  3610         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3611             20  FILLER                     PIC XX.
  3612             20  CF-HI-BEN-IN-REC           PIC XX.
  3613         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3614             20  FILLER                     PIC XXX.
  3615             20  CF-CARRIER-CNTL            PIC X.
  3616         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3617             20  FILLER                     PIC XX.
  3618             20  CF-HI-TYPE-IN-REC          PIC 99.
  3619         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3620             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3621                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3622             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3623             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3624         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3625             20  FILLER                     PIC X.
  3626             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3627         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3628             20  FILLER                     PIC XX.
  3629             20  CF-MORTGAGE-PLAN           PIC XX.
  3630         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3631
  3632     12  CF-LAST-MAINT-DT                   PIC XX.
  3633     12  CF-LAST-MAINT-BY                   PIC X(4).
  3634     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3635
  3636     12  CF-RECORD-BODY                     PIC X(728).
  3637
  3638
  3639****************************************************************
  3640*             COMPANY MASTER RECORD                            *
  3641****************************************************************
  3642
  3643     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3644         16  CF-COMPANY-ADDRESS.
  3645             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3646             20  CF-CL-IN-CARE-OF           PIC X(30).
  3647             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3648             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3649             20  CF-CL-CITY-STATE           PIC X(30).
  3650             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3651             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  70
* EL130.cbl
  3652         16  CF-COMPANY-CD                  PIC X.
  3653         16  CF-COMPANY-PASSWORD            PIC X(8).
  3654         16  CF-SECURITY-OPTION             PIC X.
  3655             88  ALL-SECURITY                   VALUE '1'.
  3656             88  COMPANY-VERIFY                 VALUE '2'.
  3657             88  PROCESSOR-VERIFY               VALUE '3'.
  3658             88  NO-SECURITY                    VALUE '4'.
  3659             88  ALL-BUT-TERM                   VALUE '5'.
  3660         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3661             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3662         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3663             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3664         16  CF-INFORCE-LOCATION            PIC X.
  3665             88  CERTS-ARE-ONLINE               VALUE '1'.
  3666             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3667             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3668         16  CF-LOWER-CASE-LETTERS          PIC X.
  3669         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3670             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3671             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3672             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3673             88  CF-ACCNT-CNTL                  VALUE '3'.
  3674             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3675
  3676         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3677         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3678
  3679         16  CF-LGX-CREDIT-USER             PIC X.
  3680             88  CO-IS-NOT-USER                 VALUE 'N'.
  3681             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3682
  3683         16 CF-CREDIT-CALC-CODES.
  3684             20  CF-CR-REM-TERM-CALC PIC X.
  3685               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3686               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3687               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3688               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3689               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3690               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3691               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3692             20  CF-CR-R78-METHOD           PIC X.
  3693               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3694               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3695
  3696         16  CF-CLAIM-CONTROL-COUNTS.
  3697             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3698                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3699
  3700             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3701                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3702
  3703             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3704                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3705
  3706             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3707                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3708
  3709         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  71
* EL130.cbl
  3710
  3711         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3712             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3713             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3714             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3715             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3716                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3717                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3718             20  CF-CO-PREM-REJECT-SW       PIC X.
  3719                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3720                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3721             20  CF-CO-REF-REJECT-SW        PIC X.
  3722                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3723                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3724
  3725         16  CF-CO-REPORTING-DT             PIC XX.
  3726         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3727         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3728           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3729           88  CF-CO-MONTH-END                  VALUE '1'.
  3730
  3731         16  CF-LGX-CLAIM-USER              PIC X.
  3732             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3733             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3734
  3735         16  CF-CREDIT-EDIT-CONTROLS.
  3736             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3737             20  CF-MIN-AGE                 PIC 99.
  3738             20  CF-DEFAULT-AGE             PIC 99.
  3739             20  CF-MIN-TERM                PIC S999      COMP-3.
  3740             20  CF-MAX-TERM                PIC S999      COMP-3.
  3741             20  CF-DEFAULT-SEX             PIC X.
  3742             20  CF-JOINT-AGE-INPUT         PIC X.
  3743                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3744             20  CF-BIRTH-DATE-INPUT        PIC X.
  3745                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3746             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3747                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3748                 88  CF-ZERO-CARRIER            VALUE '1'.
  3749                 88  CF-ZERO-GROUPING           VALUE '2'.
  3750                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3751             20  CF-EDIT-SW                 PIC X.
  3752                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3753             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3754             20  CF-CR-PR-METHOD            PIC X.
  3755               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3756               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3757             20  FILLER                     PIC X.
  3758
  3759         16  CF-CREDIT-MISC-CONTROLS.
  3760             20  CF-REIN-TABLE-SW           PIC X.
  3761                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3762             20  CF-COMP-TABLE-SW           PIC X.
  3763                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3764             20  CF-EXPERIENCE-RETENTION-AGE
  3765                                            PIC S9        COMP-3.
  3766             20  CF-CONVERSION-DT           PIC XX.
  3767             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  72
* EL130.cbl
  3768             20  CF-RUN-FREQUENCY-SW        PIC X.
  3769                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3770                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3771
  3772             20  CF-CR-CHECK-NO-CONTROL.
  3773                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3774                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3775                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3776                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3777                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3778                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3779
  3780                 24  CF-CR-CHECK-COUNT       REDEFINES
  3781                     CF-CR-CHECK-COUNTER      PIC X(4).
  3782
  3783                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3784                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3785
  3786                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3787                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3788                 24  CF-MAIL-PROCESSING       PIC X.
  3789                     88  MAIL-PROCESSING          VALUE 'Y'.
  3790
  3791         16  CF-MISC-SYSTEM-CONTROL.
  3792             20  CF-SYSTEM-C                 PIC X.
  3793                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3794             20  CF-SYSTEM-D                 PIC X.
  3795                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3796             20  CF-SOC-SEC-NO-SW            PIC X.
  3797                 88  SOC-SEC-NO-USED             VALUE '1'.
  3798             20  CF-MEMBER-NO-SW             PIC X.
  3799                 88  MEMBER-NO-USED              VALUE '1'.
  3800             20  CF-TAX-ID-NUMBER            PIC X(11).
  3801             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3802             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3803                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3804                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3805                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3806                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3807             20  CF-SYSTEM-E                 PIC X.
  3808                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3809
  3810         16  CF-LGX-LIFE-USER               PIC X.
  3811             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3812             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3813
  3814         16  CF-CR-MONTH-END-DT             PIC XX.
  3815
  3816         16  CF-FILE-MAINT-DATES.
  3817             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3818                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3819             20  CF-LAST-BATCH       REDEFINES
  3820                 CF-LAST-BATCH-NO               PIC X(4).
  3821             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3822             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3823             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3824             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3825             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  73
* EL130.cbl
  3826             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3827             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3828             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3829             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3830             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3831
  3832         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3833         16  FILLER                         PIC X.
  3834
  3835         16  CF-ALT-MORT-CODE               PIC X(4).
  3836         16  CF-MEMBER-CAPTION              PIC X(10).
  3837
  3838         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3839             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3840             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3841             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3842             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3843             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3844
  3845         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3846
  3847         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3848         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3849         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3850         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3851
  3852         16  CF-AH-OVERRIDE-L1              PIC X.
  3853         16  CF-AH-OVERRIDE-L2              PIC XX.
  3854         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3855         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3856
  3857         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3858         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3859
  3860         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3861         16  CF-AR-LAST-EL860-DT            PIC XX.
  3862         16  CF-MP-MONTH-END-DT             PIC XX.
  3863
  3864         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3865         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3866             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3867
  3868         16  CF-AR-MONTH-END-DT             PIC XX.
  3869
  3870         16  CF-CRDTCRD-USER                PIC X.
  3871             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3872             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3873
  3874         16  CF-CC-MONTH-END-DT             PIC XX.
  3875
  3876         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3877
  3878         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3879             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3880             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3881             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3882         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3883         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  74
* EL130.cbl
  3884         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3885         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3886             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3887             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3888         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3889         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3890         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3891             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3892         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3893
  3894         16  CF-CL-ZIP-CODE.
  3895             20  CF-CL-ZIP-PRIME.
  3896                 24  CF-CL-ZIP-1ST          PIC X.
  3897                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3898                 24  FILLER                 PIC X(4).
  3899             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3900         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3901             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3902             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3903             20  FILLER                     PIC XXX.
  3904
  3905         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3906         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3907         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3908         16  CF-CO-OPTION-START-DATE        PIC XX.
  3909         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3910           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3911                                                      '3' '4'.
  3912           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3913           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3914           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3915           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3916           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3917           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3918
  3919         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3920
  3921         16  CF-PAYMENT-APPROVAL-LEVELS.
  3922             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3923             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3924             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3925             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3926             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3927             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3928
  3929         16  CF-END-USER-REPORTING-USER     PIC X.
  3930             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3931             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3932
  3933         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3934             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3935             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3936
  3937         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3938
  3939         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3940         16  FILLER                         PIC X.
  3941
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  75
* EL130.cbl
  3942         16  CF-CREDIT-ARCHIVE-CNTL.
  3943             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3944             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3945             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3946
  3947         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3948
  3949         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3950             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3951             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3952
  3953         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3954             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3955             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3956
  3957         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3958
  3959         16  CF-CO-ACH-ID-CODE              PIC  X.
  3960             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3961             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3962             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3963         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3964         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3965         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3966         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3967         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3968         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3969         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3970         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3971         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3972                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3973         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3974                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3975
  3976         16  CF-CO-OVER-SHORT.
  3977             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3978             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3979
  3980*         16  FILLER                         PIC X(102).
  3981         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3982             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3983             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3984
  3985         16  CF-AH-APPROVAL-DAYS.
  3986             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3987             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3988             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3989             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3990
  3991         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3992
  3993         16  CF-APPROV-LEV-5.
  3994             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3995             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3996             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3997
  3998         16  FILLER                         PIC X(68).
  3999****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  76
* EL130.cbl
  4000*             PROCESSOR/USER RECORD                            *
  4001****************************************************************
  4002
  4003     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4004         16  CF-PROCESSOR-NAME              PIC X(30).
  4005         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4006         16  CF-PROCESSOR-TITLE             PIC X(26).
  4007         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4008                 88  MESSAGE-YES                VALUE 'Y'.
  4009                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4010
  4011*****************************************************
  4012****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4013****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4014****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4015****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4016*****************************************************
  4017
  4018         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4019             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4020             20  CF-APPLICATION-FORCE       PIC X.
  4021             20  CF-INDIVIDUAL-APP.
  4022                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4023                     28  CF-BROWSE-APP      PIC X.
  4024                     28  CF-UPDATE-APP      PIC X.
  4025
  4026         16  CF-CURRENT-TERM-ON             PIC X(4).
  4027         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4028             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4029             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4030             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4031             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4032             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4033             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4034             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4035         16  CF-PROCESSOR-CARRIER           PIC X.
  4036             88  NO-CARRIER-SECURITY            VALUE ' '.
  4037         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4038             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4039         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4040             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4041         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4042             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4043
  4044         16  CF-PROC-SYS-ACCESS-SW.
  4045             20  CF-PROC-CREDIT-CLAIMS-SW.
  4046                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4047                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4048                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4049                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4050             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4051                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4052                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4053             20  CF-PROC-LIFE-GNRLDGR-SW.
  4054                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4055                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4056                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4057                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  77
* EL130.cbl
  4058             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4059                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4060                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4061         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4062             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4063             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4064         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4065
  4066         16  CF-APPROVAL-LEVEL                  PIC X.
  4067             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4068             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4069             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4070             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4071             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4072
  4073         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4074
  4075         16  CF-LANGUAGE-TYPE                   PIC X.
  4076             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4077             88  CF-LANG-IS-FR                      VALUE 'F'.
  4078
  4079         16  CF-CSR-IND                         PIC X.
  4080         16  FILLER                             PIC X(239).
  4081
  4082****************************************************************
  4083*             PROCESSOR/REMINDERS RECORD                       *
  4084****************************************************************
  4085
  4086     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4087         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4088             20  CF-START-REMIND-DT         PIC XX.
  4089             20  CF-END-REMIND-DT           PIC XX.
  4090             20  CF-REMINDER-TEXT           PIC X(50).
  4091         16  FILLER                         PIC X(296).
  4092
  4093
  4094****************************************************************
  4095*             STATE MASTER RECORD                              *
  4096****************************************************************
  4097
  4098     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4099         16  CF-STATE-ABBREVIATION          PIC XX.
  4100         16  CF-STATE-NAME                  PIC X(25).
  4101         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4102         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4103             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4104             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4105             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4106             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4107                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4108                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4109             20  CF-ST-PREM-REJECT-SW       PIC X.
  4110                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4111                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4112             20  CF-ST-REF-REJECT-SW        PIC X.
  4113                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4114                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4115         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  78
* EL130.cbl
  4116         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4117         16  CF-ST-REFUND-RULES.
  4118             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4119             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4120             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4121         16  CF-ST-FST-PMT-EXTENSION.
  4122             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4123             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4124                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4125                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4126                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4127                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4128         16  CF-ST-STATE-CALL.
  4129             20  CF-ST-CALL-UNEARNED        PIC X.
  4130             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4131             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4132         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4133             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4134             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4135         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4136         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4137         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4138         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4139         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4140         16  FILLER                         PIC X.
  4141         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4142             20  CF-ST-BENEFIT-CD           PIC XX.
  4143             20  CF-ST-BENEFIT-KIND         PIC X.
  4144                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4145                 88  CF-ST-AH-KIND              VALUE 'A'.
  4146             20  CF-ST-REM-TERM-CALC        PIC X.
  4147                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4148                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4149                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4150                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4151                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4152                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4153                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4154                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4155
  4156             20  CF-ST-REFUND-CALC          PIC X.
  4157                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4158                 88  ST-REFD-BY-R78             VALUE '1'.
  4159                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4160                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4161                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4162                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4163                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4164                 88  ST-REFD-UTAH               VALUE '7'.
  4165                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4166                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4167                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4168
  4169             20  CF-ST-EARNING-CALC         PIC X.
  4170                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4171                 88  ST-EARN-BY-R78             VALUE '1'.
  4172                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4173                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  79
* EL130.cbl
  4174                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4175                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4176                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4177                 88  ST-EARN-MEAN               VALUE '8'.
  4178                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4179
  4180             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4181                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4182                 88  ST-OVRD-BY-R78             VALUE '1'.
  4183                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4184                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4185                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4186                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4187                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4188                 88  ST-OVRD-MEAN               VALUE '8'.
  4189                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4190             20  cf-st-extra-periods        pic 9.
  4191*            20  FILLER                     PIC X.
  4192
  4193         16  CF-ST-COMMISSION-CAPS.
  4194             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4195             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4196             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4197             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4198         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4199                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4200                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4201                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4202
  4203         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4204
  4205         16  CF-ST-STATUTORY-INTEREST.
  4206             20  CF-ST-STAT-DATE-FROM       PIC X.
  4207                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4208                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4209             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4210             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4211             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4212             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4213             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4214
  4215         16  CF-ST-OVER-SHORT.
  4216             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4217             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4218
  4219         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4220
  4221         16  CF-ST-RT-CALC                  PIC X.
  4222
  4223         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4224         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4225         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4226         16  CF-ST-RF-LR-CALC               PIC X.
  4227         16  CF-ST-RF-LL-CALC               PIC X.
  4228         16  CF-ST-RF-LN-CALC               PIC X.
  4229         16  CF-ST-RF-AH-CALC               PIC X.
  4230         16  CF-ST-RF-CP-CALC               PIC X.
  4231*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  80
* EL130.cbl
  4232*CIDMOD         16  FILLER                         PIC X(192).
  4233         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4234             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4235         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4236         16  CF-ST-VFY-2ND-BENE             PIC X.
  4237         16  CF-ST-CAUSAL-STATE             PIC X.
  4238         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4239         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4240         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4241             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4242         16  CF-ST-NET-ONLY-STATE           PIC X.
  4243             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4244         16  cf-commission-cap-required     pic x.
  4245         16  CF-ST-GA-COMMISSION-CAPS.
  4246             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4247             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4248             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4249             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4250         16  CF-ST-TOT-COMMISSION-CAPS.
  4251             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4252             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4253             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4254             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4255         16  FILLER                         PIC X(156).
  4256
  4257****************************************************************
  4258*             BENEFIT MASTER RECORD                            *
  4259****************************************************************
  4260
  4261     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4262         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4263             20  CF-BENEFIT-CODE            PIC XX.
  4264             20  CF-BENEFIT-NUMERIC  REDEFINES
  4265                 CF-BENEFIT-CODE            PIC XX.
  4266             20  CF-BENEFIT-ALPHA           PIC XXX.
  4267             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4268             20  CF-BENEFIT-COMMENT         PIC X(10).
  4269
  4270             20  CF-LF-COVERAGE-TYPE        PIC X.
  4271                 88  CF-REDUCING                VALUE 'R'.
  4272                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4273
  4274             20  CF-SPECIAL-CALC-CD         PIC X.
  4275                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4276                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4277                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4278                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4279                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4280                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4281                 88  CF-FARM-PLAN               VALUE 'F'.
  4282                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4283                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4284                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4285                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4286                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4287                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4288                 88  CF-PRUDENTIAL              VALUE 'P'.
  4289                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  81
* EL130.cbl
  4290                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4291                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4292                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4293                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4294                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4295
  4296             20  CF-JOINT-INDICATOR         PIC X.
  4297                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4298
  4299*            20  FILLER                     PIC X(12).
  4300             20  cf-maximum-benefits        pic s999 comp-3.
  4301             20  FILLER                     PIC X(09).
  4302             20  CF-BENEFIT-CATEGORY        PIC X.
  4303             20  CF-LOAN-TYPE               PIC X(8).
  4304
  4305             20  CF-CO-REM-TERM-CALC        PIC X.
  4306                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4307                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4308                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4309                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4310                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4311
  4312             20  CF-CO-EARNINGS-CALC        PIC X.
  4313                 88  CO-EARN-BY-R78             VALUE '1'.
  4314                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4315                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4316                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4317                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4318                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4319                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4320                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4321
  4322             20  CF-CO-REFUND-CALC          PIC X.
  4323                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4324                 88  CO-REFD-BY-R78             VALUE '1'.
  4325                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4326                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4327                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4328                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4329                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4330                 88  CO-REFD-MEAN               VALUE '8'.
  4331                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4332                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4333                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4334
  4335             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4336                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4337                 88  CO-OVRD-BY-R78             VALUE '1'.
  4338                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4339                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4340                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4341                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4342                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4343                 88  CO-OVRD-MEAN               VALUE '8'.
  4344                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4345
  4346             20  CF-CO-BEN-I-G-CD           PIC X.
  4347                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  82
* EL130.cbl
  4348                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4349                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4350
  4351         16  FILLER                         PIC X(304).
  4352
  4353
  4354****************************************************************
  4355*             CARRIER MASTER RECORD                            *
  4356****************************************************************
  4357
  4358     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4359         16  CF-ADDRESS-DATA.
  4360             20  CF-MAIL-TO-NAME            PIC X(30).
  4361             20  CF-IN-CARE-OF              PIC X(30).
  4362             20  CF-ADDRESS-LINE-1          PIC X(30).
  4363             20  CF-ADDRESS-LINE-2          PIC X(30).
  4364             20  CF-CITY-STATE              PIC X(30).
  4365             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4366             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4367
  4368         16  CF-CLAIM-NO-CONTROL.
  4369             20  CF-CLAIM-NO-METHOD         PIC X.
  4370                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4371                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4372                 88  CLAIM-NO-SEQ               VALUE '3'.
  4373                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4374             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4375                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4376                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4377                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4378
  4379         16  CF-CHECK-NO-CONTROL.
  4380             20  CF-CHECK-NO-METHOD         PIC X.
  4381                 88  CHECK-NO-MANUAL            VALUE '1'.
  4382                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4383                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4384                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4385             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4386                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4387
  4388         16  CF-DOMICILE-STATE              PIC XX.
  4389
  4390         16  CF-EXPENSE-CONTROLS.
  4391             20  CF-EXPENSE-METHOD          PIC X.
  4392                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4393                 88  DOLLARS-PER-PMT            VALUE '2'.
  4394                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4395                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4396             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4397             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4398
  4399         16  CF-CORRESPONDENCE-CONTROL.
  4400             20  CF-LETTER-RESEND-OPT       PIC X.
  4401                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4402                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4403             20  FILLER                     PIC X(4).
  4404
  4405         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  83
* EL130.cbl
  4406             20  CF-MANUAL-SW               PIC X.
  4407                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4408             20  CF-FUTURE-SW               PIC X.
  4409                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4410             20  CF-PTC-SW                  PIC X.
  4411                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4412             20  CF-IBNR-SW                 PIC X.
  4413                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4414             20  CF-PTC-LF-SW               PIC X.
  4415                 88  CF-LF-PTC-USED             VALUE '1'.
  4416             20  CF-CDT-ACCESS-METHOD       PIC X.
  4417                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4418                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4419                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4420             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4421
  4422         16  CF-CLAIM-CALC-METHOD           PIC X.
  4423             88  360-PLUS-MONTHS                VALUE '1'.
  4424             88  365-PLUS-MONTHS                VALUE '2'.
  4425             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4426             88  360-DAILY                      VALUE '4'.
  4427             88  365-DAILY                      VALUE '5'.
  4428
  4429         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4430         16  FILLER                         PIC X(11).
  4431
  4432         16  CF-LIMIT-AMOUNTS.
  4433             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4434             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4435             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4436             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4437             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4438             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4439             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4440             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4441             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4442             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4443
  4444         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4445         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4446         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4447
  4448         16  CF-ZIP-CODE.
  4449             20  CF-ZIP-PRIME.
  4450                 24  CF-ZIP-1ST             PIC X.
  4451                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4452                 24  FILLER                 PIC X(4).
  4453             20  CF-ZIP-PLUS4               PIC X(4).
  4454         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4455             20  CF-CAN-POSTAL-1            PIC XXX.
  4456             20  CF-CAN-POSTAL-2            PIC XXX.
  4457             20  FILLER                     PIC XXX.
  4458
  4459         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4460         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4461         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4462
  4463         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  84
* EL130.cbl
  4464             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4465             88  CF-NO-RATING                   VALUE 'N'.
  4466
  4467         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4468
  4469         16  CF-CARRIER-OVER-SHORT.
  4470             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4471             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4472
  4473         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4474         16  CF-SECPAY-SWITCH               PIC X.
  4475             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4476             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4477         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4478         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4479         16  FILLER                         PIC X(444).
  4480*        16  FILLER                         PIC X(452).
  4481
  4482
  4483****************************************************************
  4484*             MORTALITY MASTER RECORD                          *
  4485****************************************************************
  4486
  4487     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4488         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4489                                INDEXED BY CF-MORT-NDX.
  4490             20  CF-MORT-TABLE              PIC X(5).
  4491             20  CF-MORT-TABLE-TYPE         PIC X.
  4492                 88  CF-MORT-JOINT              VALUE 'J'.
  4493                 88  CF-MORT-SINGLE             VALUE 'S'.
  4494                 88  CF-MORT-COMBINED           VALUE 'C'.
  4495                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4496                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4497             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4498             20  CF-MORT-AGE-METHOD         PIC XX.
  4499                 88  CF-AGE-LAST                VALUE 'AL'.
  4500                 88  CF-AGE-NEAR                VALUE 'AN'.
  4501             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4502             20  CF-MORT-ADJUSTMENT-DIRECTION
  4503                                            PIC X.
  4504                 88  CF-MINUS                   VALUE '-'.
  4505                 88  CF-PLUS                    VALUE '+'.
  4506             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4507             20  CF-MORT-JOINT-CODE         PIC X.
  4508                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4509             20  CF-MORT-PC-Q               PIC X.
  4510                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4511             20  CF-MORT-TABLE-CODE         PIC X(4).
  4512             20  CF-MORT-COMMENTS           PIC X(15).
  4513             20  FILLER                     PIC X(14).
  4514
  4515         16  FILLER                         PIC X(251).
  4516
  4517
  4518****************************************************************
  4519*             BUSSINESS TYPE MASTER RECORD                     *
  4520****************************************************************
  4521
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  85
* EL130.cbl
  4522     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4523* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4524* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4525* AND RECORD 05 IS TYPES 81-99
  4526         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4527             20  CF-BUSINESS-TITLE          PIC  X(19).
  4528             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4529                                            PIC S9V9(4) COMP-3.
  4530             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4531             20  FILLER                     PIC  X.
  4532         16  FILLER                         PIC  X(248).
  4533
  4534
  4535****************************************************************
  4536*             TERMINAL MASTER RECORD                           *
  4537****************************************************************
  4538
  4539     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4540
  4541         16  CF-COMPANY-TERMINALS.
  4542             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4543                                  PIC X(4).
  4544         16  FILLER               PIC X(248).
  4545
  4546
  4547****************************************************************
  4548*             LIFE EDIT MASTER RECORD                          *
  4549****************************************************************
  4550
  4551     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4552         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4553             20  CF-LIFE-CODE-IN            PIC XX.
  4554             20  CF-LIFE-CODE-OUT           PIC XX.
  4555         16  FILLER                         PIC X(248).
  4556
  4557
  4558****************************************************************
  4559*             AH EDIT MASTER RECORD                            *
  4560****************************************************************
  4561
  4562     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4563         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4564             20  CF-AH-CODE-IN              PIC XXX.
  4565             20  CF-AH-CODE-OUT             PIC XX.
  4566         16  FILLER                         PIC X(248).
  4567
  4568
  4569****************************************************************
  4570*             CREDIBILITY TABLES                               *
  4571****************************************************************
  4572
  4573     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4574         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4575                             INDEXED BY CF-CRDB-NDX.
  4576             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4577             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4578             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4579         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  86
* EL130.cbl
  4580
  4581
  4582****************************************************************
  4583*             REPORT CUSTOMIZATION RECORD                      *
  4584****************************************************************
  4585
  4586     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4587         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4588             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4589             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4590             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4591**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4592****       A T-TRANSFER.                                   ****
  4593             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4594
  4595         16  FILLER                         PIC XX.
  4596
  4597         16  CF-CARRIER-CNTL-OPT.
  4598             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4599                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4600                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4601             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4602                                            PIC X.
  4603         16  CF-GROUP-CNTL-OPT.
  4604             20  CF-GROUP-OPT-SEQ           PIC 9.
  4605                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4606                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4607             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4608                                            PIC X(6).
  4609         16  CF-STATE-CNTL-OPT.
  4610             20  CF-STATE-OPT-SEQ           PIC 9.
  4611                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4612                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4613             20  CF-STATE-SELECT OCCURS 3 TIMES
  4614                                            PIC XX.
  4615         16  CF-ACCOUNT-CNTL-OPT.
  4616             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4617                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4618                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4619             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4620                                            PIC X(10).
  4621         16  CF-BUS-TYP-CNTL-OPT.
  4622             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4623                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4624                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4625             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4626                                            PIC XX.
  4627         16  CF-LF-TYP-CNTL-OPT.
  4628             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4629                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4630                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4631             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4632                                            PIC XX.
  4633         16  CF-AH-TYP-CNTL-OPT.
  4634             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4635                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4636                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4637             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  87
* EL130.cbl
  4638                                            PIC XX.
  4639         16  CF-REPTCD1-CNTL-OPT.
  4640             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4641                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4642                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4643             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4644                                            PIC X(10).
  4645         16  CF-REPTCD2-CNTL-OPT.
  4646             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4647                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4648                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4649             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4650                                            PIC X(10).
  4651         16  CF-USER1-CNTL-OPT.
  4652             20  CF-USER1-OPT-SEQ           PIC 9.
  4653                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4654                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4655             20  CF-USER1-SELECT OCCURS 3 TIMES
  4656                                            PIC X(10).
  4657         16  CF-USER2-CNTL-OPT.
  4658             20  CF-USER2-OPT-SEQ           PIC 9.
  4659                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4660                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4661             20  CF-USER2-SELECT OCCURS 3 TIMES
  4662                                            PIC X(10).
  4663         16  CF-USER3-CNTL-OPT.
  4664             20  CF-USER3-OPT-SEQ           PIC 9.
  4665                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4666                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4667             20  CF-USER3-SELECT OCCURS 3 TIMES
  4668                                            PIC X(10).
  4669         16  CF-USER4-CNTL-OPT.
  4670             20  CF-USER4-OPT-SEQ           PIC 9.
  4671                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4672                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4673             20  CF-USER4-SELECT OCCURS 3 TIMES
  4674                                            PIC X(10).
  4675         16  CF-USER5-CNTL-OPT.
  4676             20  CF-USER5-OPT-SEQ           PIC 9.
  4677                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4678                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4679             20  CF-USER5-SELECT OCCURS 3 TIMES
  4680                                            PIC X(10).
  4681         16  CF-REINS-CNTL-OPT.
  4682             20  CF-REINS-OPT-SEQ           PIC 9.
  4683                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4684                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4685             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4686                 24  CF-REINS-PRIME         PIC XXX.
  4687                 24  CF-REINS-SUB           PIC XXX.
  4688
  4689         16  CF-AGENT-CNTL-OPT.
  4690             20  CF-AGENT-OPT-SEQ           PIC 9.
  4691                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4692                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4693             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4694                                            PIC X(10).
  4695
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  88
* EL130.cbl
  4696         16  FILLER                         PIC X(43).
  4697
  4698         16  CF-LOSS-RATIO-SELECT.
  4699             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4700             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4701         16  CF-ENTRY-DATE-SELECT.
  4702             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4703             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4704         16  CF-EFFECTIVE-DATE-SELECT.
  4705             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4706             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4707
  4708         16  CF-EXCEPTION-LIST-IND          PIC X.
  4709             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4710
  4711         16  FILLER                         PIC X(318).
  4712
  4713****************************************************************
  4714*                  EXCEPTION REPORTING RECORD                  *
  4715****************************************************************
  4716
  4717     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4718         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4719             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4720
  4721         16  CF-COMBINED-LIFE-AH-OPT.
  4722             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4723             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4724             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4725             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4726
  4727         16  CF-LIFE-OPT.
  4728             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4729             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4730             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4731             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4732             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4733             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4734             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4735             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4736             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4737             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4738
  4739         16  CF-AH-OPT.
  4740             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4741             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4742             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4743             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4744             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4745             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4746             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4747             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4748             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4749             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4750
  4751         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4752             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4753             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  89
* EL130.cbl
  4754             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4755
  4756         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4757
  4758         16  FILLER                         PIC X(673).
  4759
  4760
  4761****************************************************************
  4762*             MORTGAGE SYSTEM PLAN RECORD                      *
  4763****************************************************************
  4764
  4765     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4766         16  CF-PLAN-TYPE                   PIC X.
  4767             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4768             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4769             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4770         16  CF-PLAN-ABBREV                 PIC XXX.
  4771         16  CF-PLAN-DESCRIPT               PIC X(10).
  4772         16  CF-PLAN-NOTES                  PIC X(20).
  4773         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4774         16  CF-PLAN-UNDERWRITING.
  4775             20  CF-PLAN-TERM-DATA.
  4776                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4777                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4778             20  CF-PLAN-AGE-DATA.
  4779                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4780                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4781                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4782             20  CF-PLAN-BENEFIT-DATA.
  4783                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4784                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4785                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4786                                            PIC S9(7)V99  COMP-3.
  4787         16  CF-PLAN-POLICY-FORMS.
  4788             20  CF-POLICY-FORM             PIC X(12).
  4789             20  CF-MASTER-APPLICATION      PIC X(12).
  4790             20  CF-MASTER-POLICY           PIC X(12).
  4791         16  CF-PLAN-RATING.
  4792             20  CF-RATE-CODE               PIC X(5).
  4793             20  CF-SEX-RATING              PIC X.
  4794                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4795                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4796             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4797             20  CF-SUB-STD-TYPE            PIC X.
  4798                 88  CF-PCT-OF-PREM            VALUE '1'.
  4799                 88  CF-PCT-OF-BENE            VALUE '2'.
  4800         16  CF-PLAN-PREM-TOLERANCES.
  4801             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4802             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4803         16  CF-PLAN-PYMT-TOLERANCES.
  4804             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4805             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4806         16  CF-PLAN-MISC-DATA.
  4807             20  FILLER                     PIC X.
  4808             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4809             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4810         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4811         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  90
* EL130.cbl
  4812             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4813                                                     '1'.
  4814             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4815                                                     '2'.
  4816         16  CF-MIB-SEARCH-SW               PIC X.
  4817             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4818             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4819             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4820             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4821         16  CF-ALPHA-SEARCH-SW             PIC X.
  4822             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4823             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4824             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4825             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4826             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4827             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4828             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4829             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4830             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4831             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4832                                                     'A' 'B' 'C'
  4833                                                     'X' 'Y' 'Z'.
  4834         16  CF-EFF-DT-RULE-SW              PIC X.
  4835             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4836             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4837             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4838             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4839             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4840         16  FILLER                         PIC X(4).
  4841         16  CF-HEALTH-QUESTIONS            PIC X.
  4842             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4843         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4844         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4845         16  CF-PLAN-SNGL-JNT               PIC X.
  4846             88  CF-COMBINED-PLAN              VALUE 'C'.
  4847             88  CF-JNT-PLAN                   VALUE 'J'.
  4848             88  CF-SNGL-PLAN                  VALUE 'S'.
  4849         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4850         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4851         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4852         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4853         16  CF-RERATE-CNTL                 PIC  X.
  4854             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4855             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4856             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4857             88  CF-AUTO-RECALC                 VALUE '4'.
  4858         16  CF-BENEFIT-TYPE                PIC  X.
  4859             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4860             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4861         16  CF-POLICY-FEE                  PIC S999V99
  4862                                                    COMP-3.
  4863         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4864         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4865         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4866         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4867         16  FILLER                         PIC  X(32).
  4868         16  CF-TERMINATION-FORM            PIC  X(04).
  4869         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  91
* EL130.cbl
  4870         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4871                                                       COMP-3.
  4872         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4873         16  CF-ISSUE-LETTER                PIC  X(4).
  4874         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4875         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4876             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4877             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4878         16  CF-MP-REFUND-CALC              PIC X.
  4879             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4880             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4881             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4882             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4883             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4884             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4885             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4886             88  CF-MP-REFD-MEAN                VALUE '8'.
  4887         16  CF-ALT-RATE-CODE               PIC  X(5).
  4888
  4889
  4890         16  FILLER                         PIC X(498).
  4891****************************************************************
  4892*             MORTGAGE COMPANY MASTER RECORD                   *
  4893****************************************************************
  4894
  4895     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4896         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4897         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4898             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4899             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4900             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4901             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4902             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4903
  4904         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4905         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4906         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4907         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4908         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4909
  4910         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4911             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4912         16  CF-MP-RECON-USE-IND            PIC X(1).
  4913             88  CF-MP-USE-RECON             VALUE 'Y'.
  4914         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4915             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4916         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4917             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4918             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4919         16  FILLER                         PIC X(1).
  4920         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4921             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4922         16  CF-MORTG-MIB-VERSION           PIC X.
  4923             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4924             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4925             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4926         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4927             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  92
* EL130.cbl
  4928                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4929             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4930                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4931             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4932                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4933             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4934                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4935             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4936                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4937             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4938                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4939         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4940         16  FILLER                         PIC X(7).
  4941         16  CF-MORTG-DESTINATION-SYMBOL.
  4942             20  CF-MORTG-MIB-COMM          PIC X(5).
  4943             20  CF-MORTG-MIB-TERM          PIC X(5).
  4944         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4945             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4946         16  FILLER                         PIC X(03).
  4947         16  CF-MP-CHECK-NO-CONTROL.
  4948             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4949                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4950                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4951                                                ' ' LOW-VALUES.
  4952                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4953                                               VALUE '3'.
  4954         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4955         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4956         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4957             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4958                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4959             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4960                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4961             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4962                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4963             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4964                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4965             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4966                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4967             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4968                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4969         16  CF-MORTG-BILLING-AREA.
  4970             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4971                                            PIC X.
  4972         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4973         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4974         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4975         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4976             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4977             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4978         16  FILLER                         PIC X.
  4979         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4980             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4981             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4982         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4983         16  FILLER                         PIC X(8).
  4984         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4985         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  93
* EL130.cbl
  4986         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4987         16  CF-ACH-COMPANY-ID.
  4988             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4989                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4990                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4991                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4992             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4993         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4994             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4995         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4996             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4997             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4998         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4999         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5000         16  FILLER                         PIC X(536).
  5001
  5002****************************************************************
  5003*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5004****************************************************************
  5005
  5006     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5007         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5008             20  CF-FEMALE-HEIGHT.
  5009                 24  CF-FEMALE-FT           PIC 99.
  5010                 24  CF-FEMALE-IN           PIC 99.
  5011             20  CF-FEMALE-MIN-WT           PIC 999.
  5012             20  CF-FEMALE-MAX-WT           PIC 999.
  5013         16  FILLER                         PIC X(428).
  5014
  5015     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5016         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5017             20  CF-MALE-HEIGHT.
  5018                 24  CF-MALE-FT             PIC 99.
  5019                 24  CF-MALE-IN             PIC 99.
  5020             20  CF-MALE-MIN-WT             PIC 999.
  5021             20  CF-MALE-MAX-WT             PIC 999.
  5022         16  FILLER                         PIC X(428).
  5023******************************************************************
  5024*             AUTOMATIC ACTIVITY RECORD                          *
  5025******************************************************************
  5026     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5027         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5028             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5029             20  CF-SYS-LETTER-ID           PIC X(04).
  5030             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5031             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5032             20  CF-SYS-RESET-SW            PIC X(01).
  5033             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5034             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5035
  5036         16  FILLER                         PIC X(50).
  5037
  5038         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5039             20  CF-USER-ACTIVE-SW          PIC X(01).
  5040             20  CF-USER-LETTER-ID          PIC X(04).
  5041             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5042             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5043             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  94
* EL130.cbl
  5044             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5045             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5046             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5047
  5048         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  95
* EL130.cbl
  5050*    COPY ELCCERT.
  5051******************************************************************
  5052*                                                                *
  5053*                            ELCCERT.                            *
  5054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5055*                            VMOD=2.013                          *
  5056*                                                                *
  5057*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5058*                                                                *
  5059*   FILE TYPE = VSAM,KSDS                                        *
  5060*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5061*                                                                *
  5062*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5063*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5064*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5065*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5066*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5067*                                                                *
  5068*   LOG = YES                                                    *
  5069*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5070******************************************************************
  5071*                   C H A N G E   L O G
  5072*
  5073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5074*-----------------------------------------------------------------
  5075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5076* EFFECTIVE    NUMBER
  5077*-----------------------------------------------------------------
  5078* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5079* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5080* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5081* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5082* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5083* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5084* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5085* 032612  CR2011110200001  PEMA  AHL CHANGES
  5086* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5087* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5088* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5089******************************************************************
  5090
  5091 01  CERTIFICATE-MASTER.
  5092     12  CM-RECORD-ID                      PIC XX.
  5093         88  VALID-CM-ID                      VALUE 'CM'.
  5094
  5095     12  CM-CONTROL-PRIMARY.
  5096         16  CM-COMPANY-CD                 PIC X.
  5097         16  CM-CARRIER                    PIC X.
  5098         16  CM-GROUPING.
  5099             20  CM-GROUPING-PREFIX        PIC X(3).
  5100             20  CM-GROUPING-PRIME         PIC X(3).
  5101         16  CM-STATE                      PIC XX.
  5102         16  CM-ACCOUNT.
  5103             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5104             20  CM-ACCOUNT-PRIME          PIC X(6).
  5105         16  CM-CERT-EFF-DT                PIC XX.
  5106         16  CM-CERT-NO.
  5107             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  96
* EL130.cbl
  5108             20  CM-CERT-SFX               PIC X.
  5109
  5110     12  CM-CONTROL-BY-NAME.
  5111         16  CM-COMPANY-CD-A1              PIC X.
  5112         16  CM-INSURED-LAST-NAME          PIC X(15).
  5113         16  CM-INSURED-INITIALS.
  5114             20  CM-INSURED-INITIAL1       PIC X.
  5115             20  CM-INSURED-INITIAL2       PIC X.
  5116
  5117     12  CM-CONTROL-BY-SSN.
  5118         16  CM-COMPANY-CD-A2              PIC X.
  5119         16  CM-SOC-SEC-NO.
  5120             20  CM-SSN-STATE              PIC XX.
  5121             20  CM-SSN-ACCOUNT            PIC X(6).
  5122             20  CM-SSN-LN3.
  5123                 25  CM-INSURED-INITIALS-A2.
  5124                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5125                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5126                 25 CM-PART-LAST-NAME-A2         PIC X.
  5127
  5128     12  CM-CONTROL-BY-CERT-NO.
  5129         16  CM-COMPANY-CD-A4              PIC X.
  5130         16  CM-CERT-NO-A4                 PIC X(11).
  5131
  5132     12  CM-CONTROL-BY-MEMB.
  5133         16  CM-COMPANY-CD-A5              PIC X.
  5134         16  CM-MEMBER-NO.
  5135             20  CM-MEMB-STATE             PIC XX.
  5136             20  CM-MEMB-ACCOUNT           PIC X(6).
  5137             20  CM-MEMB-LN4.
  5138                 25  CM-INSURED-INITIALS-A5.
  5139                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5140                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5141                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5142
  5143     12  CM-INSURED-PROFILE-DATA.
  5144         16  CM-INSURED-FIRST-NAME.
  5145             20  CM-INSURED-1ST-INIT       PIC X.
  5146             20  FILLER                    PIC X(9).
  5147         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5148         16  CM-INSURED-SEX                PIC X.
  5149             88  CM-SEX-MALE                  VALUE 'M'.
  5150             88  CM-SEX-FEMAL                 VALUE 'F'.
  5151         16  CM-INSURED-JOINT-AGE          PIC 99.
  5152         16  CM-JOINT-INSURED-NAME.
  5153             20  CM-JT-LAST-NAME           PIC X(15).
  5154             20  CM-JT-FIRST-NAME.
  5155                 24  CM-JT-1ST-INIT        PIC X.
  5156                 24  FILLER                PIC X(9).
  5157             20  CM-JT-INITIAL             PIC X.
  5158
  5159     12  CM-LIFE-DATA.
  5160         16  CM-LF-BENEFIT-CD              PIC XX.
  5161         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5162         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5163         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5164         16  CM-LF-DEV-CODE                PIC XXX.
  5165         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  97
* EL130.cbl
  5166         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5167         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5168         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5169         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5170         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5171         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5172         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5173         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5174         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5175         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5176         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5177         16  cm-temp-epiq                  pic xx.
  5178             88  EPIQ-CLASS                  value 'EQ'.
  5179*        16  FILLER                        PIC XX.
  5180
  5181     12  CM-AH-DATA.
  5182         16  CM-AH-BENEFIT-CD              PIC XX.
  5183         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5184         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5185         16  CM-AH-DEV-CODE                PIC XXX.
  5186         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5187         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5188         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5189         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5190         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5191         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5192         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5193         16  CM-AH-PAID-THRU-DT            PIC XX.
  5194             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5195         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5196         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5197         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5198         16  FILLER                        PIC X.
  5199
  5200     12  CM-LOAN-INFORMATION.
  5201         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5202         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5203                                           PIC S9(5)V99  COMP-3.
  5204         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5205         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5206         16  CM-PAY-FREQUENCY              PIC S99.
  5207         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5208         16  CM-RATE-CLASS                 PIC XX.
  5209         16  CM-BENEFICIARY                PIC X(25).
  5210         16  CM-POLICY-FORM-NO             PIC X(12).
  5211         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5212         16  CM-LAST-ADD-ON-DT             PIC XX.
  5213         16  CM-DEDUCTIBLE-AMOUNTS.
  5214             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5215             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5216         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5217             20  CM-RESIDENT-STATE         PIC XX.
  5218             20  CM-RATE-CODE              PIC X(4).
  5219             20  FILLER                    PIC XX.
  5220         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5221             20  CM-LOAN-OFFICER           PIC X(5).
  5222             20  FILLER                    PIC XXX.
  5223         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  98
* EL130.cbl
  5224         16  CM-UNDERWRITING-CODE          PIC X.
  5225             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5226         16  CM-POST-CARD-IND              PIC X.
  5227         16  CM-REF-INTERFACE-SW           PIC X.
  5228         16  CM-PREMIUM-TYPE               PIC X.
  5229             88  CM-SING-PRM                  VALUE '1'.
  5230             88  CM-O-B-COVERAGE              VALUE '2'.
  5231             88  CM-OPEN-END                  VALUE '3'.
  5232         16  CM-IND-GRP-TYPE               PIC X.
  5233             88  CM-INDIVIDUAL                VALUE 'I'.
  5234             88  CM-GROUP                     VALUE 'G'.
  5235         16  CM-SKIP-CODE                  PIC X.
  5236             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5237             88  SKIP-JULY                    VALUE '1'.
  5238             88  SKIP-AUGUST                  VALUE '2'.
  5239             88  SKIP-SEPTEMBER               VALUE '3'.
  5240             88  SKIP-JULY-AUG                VALUE '4'.
  5241             88  SKIP-AUG-SEPT                VALUE '5'.
  5242             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5243             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5244             88  SKIP-JUNE                    VALUE '8'.
  5245             88  SKIP-JUNE-JULY               VALUE '9'.
  5246             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5247             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5248         16  CM-PAYMENT-MODE               PIC X.
  5249             88  PAY-MONTHLY                  VALUE SPACE.
  5250             88  PAY-WEEKLY                   VALUE '1'.
  5251             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5252             88  PAY-BI-WEEKLY                VALUE '3'.
  5253             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5254         16  CM-LOAN-NUMBER                PIC X(8).
  5255         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5256         16  CM-OLD-LOF                    PIC XXX.
  5257*        16  CM-LOAN-OFFICER               PIC XXX.
  5258         16  CM-REIN-TABLE                 PIC XXX.
  5259         16  CM-SPECIAL-REIN-CODE          PIC X.
  5260         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5261         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5262         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5263
  5264     12  CM-STATUS-DATA.
  5265         16  CM-ENTRY-STATUS               PIC X.
  5266         16  CM-ENTRY-DT                   PIC XX.
  5267
  5268         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5269         16  CM-LF-CANCEL-DT               PIC XX.
  5270         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5271
  5272         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5273         16  CM-LF-DEATH-DT                PIC XX.
  5274         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5275
  5276         16  CM-LF-CURRENT-STATUS          PIC X.
  5277             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5278                                                'M' '4' '5' '9'.
  5279             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5280             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5281             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page  99
* EL130.cbl
  5282             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5283             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5284             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5285             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5286             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5287             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5288             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5289             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5290             88  CM-LF-DECLINED               VALUE 'D'.
  5291             88  CM-LF-VOIDED                 VALUE 'V'.
  5292
  5293         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5294         16  CM-AH-CANCEL-DT               PIC XX.
  5295         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5296
  5297         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5298         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5299         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5300
  5301         16  CM-AH-CURRENT-STATUS          PIC X.
  5302             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5303                                                'M' '4' '5' '9'.
  5304             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5305             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5306             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5307             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5308             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5309             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5310             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5311             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5312             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5313             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5314             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5315             88  CM-AH-DECLINED               VALUE 'D'.
  5316             88  CM-AH-VOIDED                 VALUE 'V'.
  5317
  5318         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5319             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5320             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5321             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5322         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5323
  5324         16  CM-ENTRY-BATCH                PIC X(6).
  5325         16  CM-LF-EXIT-BATCH              PIC X(6).
  5326         16  CM-AH-EXIT-BATCH              PIC X(6).
  5327         16  CM-LAST-MONTH-END             PIC XX.
  5328
  5329     12  CM-NOTE-SW                        PIC X.
  5330         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5331         88  CERT-NOTES-PRESENT               VALUE '1'.
  5332         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5333         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5334         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5335         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5336         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5337         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5338     12  CM-COMP-EXCP-SW                   PIC X.
  5339         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 100
* EL130.cbl
  5340         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5341     12  CM-INSURED-ADDRESS-SW             PIC X.
  5342         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5343         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5344
  5345*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5346     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5347     12  FILLER                            PIC X.
  5348
  5349*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5350     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5351     12  FILLER                            PIC X.
  5352*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5353     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5354
  5355     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5356         88  CERT-ADDED-BATCH                 VALUE ' '.
  5357         88  CERT-ADDED-ONLINE                VALUE '1'.
  5358         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5359         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5360         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5361     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5362         88  CERT-AS-LOADED                   VALUE ' '.
  5363         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5364         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5365         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5366         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5367         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5368         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5369         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5370
  5371     12  CM-ACCOUNT-COMM-PCTS.
  5372         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5373         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5374
  5375     12  CM-USER-FIELD                     PIC X.
  5376     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5377     12  CM-CLP-STATE                      PIC XX.
  5378     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5379     12  CM-USER-RESERVED                  PIC XXX.
  5380     12  FILLER REDEFINES CM-USER-RESERVED.
  5381         16  CM-AH-CLASS-CD                PIC XX.
  5382         16  F                             PIC X.
  5383******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 101
* EL130.cbl
  5385*    COPY ERCACCT.
  5386******************************************************************
  5387*                                                                *
  5388*                                                                *
  5389*                            ERCACCT                             *
  5390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5391*                            VMOD=2.031                          *
  5392*                                                                *
  5393*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5394*                                                                *
  5395*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5396*   VSAM ACCOUNT MASTER FILES.                                   *
  5397*                                                                *
  5398*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5399*                                                                *
  5400*   FILE TYPE = VSAM,KSDS                                        *
  5401*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5402*                                                                *
  5403*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5404*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5405*                                                                *
  5406*   LOG = NO                                                     *
  5407*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5408*                                                                *
  5409*                                                                *
  5410******************************************************************
  5411*                   C H A N G E   L O G
  5412*
  5413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5414*-----------------------------------------------------------------
  5415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5416* EFFECTIVE    NUMBER
  5417*-----------------------------------------------------------------
  5418* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5419* 092705    2005050300006  PEMA  ADD SPP LEASES
  5420* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5421* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5422* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5423* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5424* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5425* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  5426******************************************************************
  5427
  5428 01  ACCOUNT-MASTER.
  5429     12  AM-RECORD-ID                      PIC XX.
  5430         88  VALID-AM-ID                      VALUE 'AM'.
  5431
  5432     12  AM-CONTROL-PRIMARY.
  5433         16  AM-COMPANY-CD                 PIC X.
  5434         16  AM-MSTR-CNTRL.
  5435             20  AM-CONTROL-A.
  5436                 24  AM-CARRIER            PIC X.
  5437                 24  AM-GROUPING.
  5438                     28 AM-GROUPING-PREFIX PIC XXX.
  5439                     28 AM-GROUPING-PRIME  PIC XXX.
  5440                 24  AM-STATE              PIC XX.
  5441                 24  AM-ACCOUNT.
  5442                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 102
* EL130.cbl
  5443                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5444             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5445                                           PIC X(19).
  5446             20  AM-CNTRL-B.
  5447                 24  AM-EXPIRATION-DT      PIC XX.
  5448                 24  FILLER                PIC X(4).
  5449             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5450                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5451
  5452     12  AM-CONTROL-BY-VAR-GRP.
  5453         16  AM-COMPANY-CD-A1              PIC X.
  5454         16  AM-VG-CARRIER                 PIC X.
  5455         16  AM-VG-GROUPING                PIC X(6).
  5456         16  AM-VG-STATE                   PIC XX.
  5457         16  AM-VG-ACCOUNT                 PIC X(10).
  5458         16  AM-VG-DATE.
  5459             20  AM-VG-EXPIRATION-DT       PIC XX.
  5460             20  FILLER                    PIC X(4).
  5461         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5462                                           PIC 9(11)      COMP-3.
  5463     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5464         16  FILLER                        PIC X(10).
  5465         16  AM-VG-KEY3.
  5466             20  AM-VG3-ACCOUNT            PIC X(10).
  5467             20  AM-VG3-EXP-DT             PIC XX.
  5468         16  FILLER                        PIC X(4).
  5469     12  AM-MAINT-INFORMATION.
  5470         16  AM-LAST-MAINT-DT              PIC XX.
  5471         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5472         16  AM-LAST-MAINT-USER            PIC X(4).
  5473         16  FILLER                        PIC XX.
  5474
  5475     12  AM-EFFECTIVE-DT                   PIC XX.
  5476     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5477
  5478     12  AM-PREV-DATES  COMP-3.
  5479         16  AM-PREV-EXP-DT                PIC 9(11).
  5480         16  AM-PREV-EFF-DT                PIC 9(11).
  5481
  5482     12  AM-REPORT-CODE-1                  PIC X(10).
  5483     12  AM-REPORT-CODE-2                  PIC X(10).
  5484
  5485     12  AM-CITY-CODE                      PIC X(4).
  5486     12  AM-COUNTY-PARISH                  PIC X(6).
  5487
  5488     12  AM-NAME                           PIC X(30).
  5489     12  AM-PERSON                         PIC X(30).
  5490     12  AM-ADDRS                          PIC X(30).
  5491     12  AM-CITY.
  5492         16  AM-ADDR-CITY                  PIC X(28).
  5493         16  AM-ADDR-STATE                 PIC XX.
  5494     12  AM-ZIP.
  5495         16  AM-ZIP-PRIME.
  5496             20  AM-ZIP-PRI-1ST            PIC X.
  5497                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5498             20  FILLER                    PIC X(4).
  5499         16  AM-ZIP-PLUS4                  PIC X(4).
  5500     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 103
* EL130.cbl
  5501         16  AM-CAN-POSTAL-1               PIC XXX.
  5502         16  AM-CAN-POSTAL-2               PIC XXX.
  5503         16  FILLER                        PIC XXX.
  5504     12  AM-TEL-NO.
  5505         16  AM-AREA-CODE                  PIC 999.
  5506         16  AM-TEL-PRE                    PIC 999.
  5507         16  AM-TEL-NBR                    PIC 9(4).
  5508     12  AM-TEL-LOC                        PIC X.
  5509         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5510         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5511
  5512     12  AM-COMM-STRUCTURE.
  5513         16  AM-DEFN-1.
  5514             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5515                 24  AM-AGT.
  5516                     28  AM-AGT-PREFIX     PIC X(4).
  5517                     28  AM-AGT-PRIME      PIC X(6).
  5518                 24  AM-COM-TYP            PIC X.
  5519                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5520                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5521                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5522                 24  AM-RECALC-LV-INDIC    PIC X.
  5523                 24  AM-RETRO-LV-INDIC     PIC X.
  5524                 24  AM-GL-CODES           PIC X.
  5525                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5526                 24  FILLER                PIC X(01).
  5527         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5528             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5529                 24  FILLER                PIC X(11).
  5530                 24  AM-L-COMA             PIC XXX.
  5531                 24  AM-J-COMA             PIC XXX.
  5532                 24  AM-A-COMA             PIC XXX.
  5533                 24  FILLER                PIC X(6).
  5534
  5535     12  AM-COMM-CHANGE-STATUS             PIC X.
  5536         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5537
  5538     12  AM-CSR-CODE                       PIC X(4).
  5539
  5540     12  AM-BILLING-STATUS                 PIC X.
  5541         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5542         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5543     12  AM-AUTO-REFUND-SW                 PIC X.
  5544         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5545         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5546     12  AM-GPCD                           PIC 99.
  5547     12  AM-IG                             PIC X.
  5548         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5549         88  AM-HAS-GROUP                     VALUE '2'.
  5550     12  AM-STATUS                         PIC X.
  5551         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5552         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5553         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5554         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5555         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5556         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5557         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5558         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 104
* EL130.cbl
  5559         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5560         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5561     12  AM-REMIT-TO                       PIC 99.
  5562     12  AM-ID-NO                          PIC X(11).
  5563
  5564     12  AM-CAL-TABLE                      PIC XX.
  5565     12  AM-LF-DEVIATION                   PIC XXX.
  5566     12  AM-AH-DEVIATION                   PIC XXX.
  5567     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5568     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5569     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5570     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5571     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5572     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5573
  5574     12  AM-USER-FIELDS.
  5575         16  AM-FLD-1                      PIC XX.
  5576         16  AM-FLD-2                      PIC XX.
  5577         16  AM-FLD-3                      PIC XX.
  5578         16  AM-FLD-4                      PIC XX.
  5579         16  AM-FLD-5                      PIC XX.
  5580
  5581     12  AM-1ST-PROD-DATE.
  5582         16  AM-1ST-PROD-YR                PIC XX.
  5583         16  AM-1ST-PROD-MO                PIC XX.
  5584         16  AM-1ST-PROD-DA                PIC XX.
  5585     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5586     12  AM-CERTS-PURGED-DATE.
  5587         16  AM-PUR-YR                     PIC XX.
  5588         16  AM-PUR-MO                     PIC XX.
  5589         16  AM-PUR-DA                     PIC XX.
  5590     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5591     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5592     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5593     12  AM-INACTIVE-DATE.
  5594         16  AM-INA-MO                     PIC 99.
  5595         16  AM-INA-DA                     PIC 99.
  5596         16  AM-INA-YR                     PIC 99.
  5597     12  AM-AR-HI-CERT-DATE                PIC XX.
  5598
  5599     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5600     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5601
  5602     12  AM-OB-PAYMENT-MODE                PIC X.
  5603         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5604         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5605         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5606         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5607
  5608     12  AM-AH-ONLY-INDICATOR              PIC X.
  5609         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5610         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5611
  5612     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5613
  5614     12  AM-OVER-SHORT.
  5615         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5616         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 105
* EL130.cbl
  5617
  5618     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5619     12  AM-DCC-CLP-STATE                  PIC XX.
  5620
  5621     12  AM-RECALC-COMM                    PIC X.
  5622     12  AM-RECALC-REIN                    PIC X.
  5623
  5624     12  AM-REI-TABLE                      PIC XXX.
  5625     12  AM-REI-ET-LF                      PIC X.
  5626     12  AM-REI-ET-AH                      PIC X.
  5627     12  AM-REI-PE-LF                      PIC X.
  5628     12  AM-REI-PE-AH                      PIC X.
  5629     12  AM-REI-PRT-ST                     PIC X.
  5630     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5631     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5632     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5633     12  AM-REI-GROUP-A                    PIC X(6).
  5634     12  AM-REI-MORT                       PIC X(4).
  5635     12  AM-REI-PRT-OW                     PIC X.
  5636     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5637     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5638     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5639     12  AM-REI-GROUP-B                    PIC X(6).
  5640
  5641     12  AM-TRUST-TYPE                     PIC X(2).
  5642
  5643     12  AM-EMPLOYER-STMT-USED             PIC X.
  5644     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5645
  5646     12  AM-STD-AH-TYPE                    PIC XX.
  5647     12  AM-EARN-METHODS.
  5648         16  AM-EARN-METHOD-R              PIC X.
  5649             88 AM-REF-RL-R78                 VALUE 'R'.
  5650             88 AM-REF-RL-PR                  VALUE 'P'.
  5651             88 AM-REF-RL-MEAN                VALUE 'M'.
  5652             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5653         16  AM-EARN-METHOD-L              PIC X.
  5654             88 AM-REF-LL-R78                 VALUE 'R'.
  5655             88 AM-REF-LL-PR                  VALUE 'P'.
  5656             88 AM-REF-LL-MEAN                VALUE 'M'.
  5657             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5658         16  AM-EARN-METHOD-A              PIC X.
  5659             88 AM-REF-AH-R78                 VALUE 'R'.
  5660             88 AM-REF-AH-PR                  VALUE 'P'.
  5661             88 AM-REF-AH-MEAN                VALUE 'M'.
  5662             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5663             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5664             88 AM-REF-AH-NET                 VALUE 'N'.
  5665
  5666     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5667     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5668     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5669
  5670     12  AM-RET-Y-N                        PIC X.
  5671     12  AM-RET-P-E                        PIC X.
  5672     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5673     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5674     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 106
* EL130.cbl
  5675     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5676         16  AM-POOL-PRIME                 PIC XXX.
  5677         16  AM-POOL-SUB                   PIC XXX.
  5678     12  AM-RETRO-EARNINGS.
  5679         16  AM-RET-EARN-R                 PIC X.
  5680         16  AM-RET-EARN-L                 PIC X.
  5681         16  AM-RET-EARN-A                 PIC X.
  5682     12  AM-RET-ST-TAX-USE                 PIC X.
  5683         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5684         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5685     12  AM-RETRO-BEG-EARNINGS.
  5686         16  AM-RET-BEG-EARN-R             PIC X.
  5687         16  AM-RET-BEG-EARN-L             PIC X.
  5688         16  AM-RET-BEG-EARN-A             PIC X.
  5689     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5690     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5691
  5692     12  AM-USER-SELECT-OPTIONS.
  5693         16  AM-USER-SELECT-1              PIC X(10).
  5694         16  AM-USER-SELECT-2              PIC X(10).
  5695         16  AM-USER-SELECT-3              PIC X(10).
  5696         16  AM-USER-SELECT-4              PIC X(10).
  5697         16  AM-USER-SELECT-5              PIC X(10).
  5698
  5699     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5700
  5701     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5702
  5703     12  AM-RPT045A-SWITCH                 PIC X.
  5704         88  RPT045A-OFF                   VALUE 'N'.
  5705
  5706     12  AM-INSURANCE-LIMITS.
  5707         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5708         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5709
  5710     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5711         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5712
  5713     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5714         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5715         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5716
  5717     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5718
  5719     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5720     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5721     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5722     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5723     12  AM-DCC-UEF-STATE                  PIC XX.
  5724     12  FILLER                            PIC XXX.
  5725     12  AM-REPORT-CODE-3                  PIC X(10).
  5726*    12  FILLER                            PIC X(22).
  5727
  5728     12  AM-RESERVE-DATE.
  5729         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5730         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5731         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5732
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 107
* EL130.cbl
  5733     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5734     12  AM-NOTIFICATION-TYPES.
  5735         16  AM-NOTIF-OF-LETTERS           PIC X.
  5736         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5737         16  AM-NOTIF-OF-REPORTS           PIC X.
  5738         16  AM-NOTIF-OF-STATUS            PIC X.
  5739
  5740     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5741         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5742         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5743         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5744         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5745
  5746     12  AM-BENEFIT-CONTROLS.
  5747         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5748             20  AM-BENEFIT-CODE           PIC XX.
  5749             20  AM-BENEFIT-TYPE           PIC X.
  5750             20  AM-BENEFIT-REVISION       PIC XXX.
  5751             20  AM-BENEFIT-REM-TERM       PIC X.
  5752             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5753             20  FILLER                    PIC XX.
  5754         16  FILLER                        PIC X(80).
  5755
  5756     12  AM-TRANSFER-DATA.
  5757         16  AM-TRANSFERRED-FROM.
  5758             20  AM-TRNFROM-CARRIER        PIC X.
  5759             20  AM-TRNFROM-GROUPING.
  5760                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5761                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5762             20  AM-TRNFROM-STATE          PIC XX.
  5763             20  AM-TRNFROM-ACCOUNT.
  5764                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5765                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5766             20  AM-TRNFROM-DTE            PIC XX.
  5767         16  AM-TRANSFERRED-TO.
  5768             20  AM-TRNTO-CARRIER          PIC X.
  5769             20  AM-TRNTO-GROUPING.
  5770                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5771                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5772             20  AM-TRNTO-STATE            PIC XX.
  5773             20  AM-TRNTO-ACCOUNT.
  5774                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5775                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5776             20  AM-TRNTO-DTE              PIC XX.
  5777         16  FILLER                        PIC X(10).
  5778
  5779     12  AM-SAVED-REMIT-TO                 PIC 99.
  5780
  5781     12  AM-COMM-STRUCTURE-SAVED.
  5782         16  AM-DEFN-1-SAVED.
  5783             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5784                 24  AM-AGT-SV             PIC X(10).
  5785                 24  AM-COM-TYP-SV         PIC X.
  5786                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5787                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5788                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5789                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5790                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 108
* EL130.cbl
  5791                 24  AM-GL-CODES-SV        PIC X.
  5792                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5793                 24  FILLER                PIC X.
  5794         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5795             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5796                 24  FILLER                PIC X(11).
  5797                 24  AM-L-COMA-SV          PIC XXX.
  5798                 24  AM-J-COMA-SV          PIC XXX.
  5799                 24  AM-A-COMA-SV          PIC XXX.
  5800                 24  FILLER                PIC X(6).
  5801
  5802     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5803         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5804            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5805            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5806            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5807
  5808     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5809     12  FILLER                            PIC X(120).
  5810
  5811     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5812         16  AM-CONTROL-NAME               PIC X(30).
  5813         16  AM-EXECUTIVE-ONE.
  5814             20  AM-EXEC1-NAME             PIC X(15).
  5815             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5816                                                          COMP-3.
  5817             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5818                                                          COMP-3.
  5819         16  AM-EXECUTIVE-TWO.
  5820             20  AM-EXEC2-NAME             PIC X(15).
  5821             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5822                                                          COMP-3.
  5823             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5824                                                          COMP-3.
  5825
  5826     12  AM-RETRO-ADDITIONAL-DATA.
  5827         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5828         16  AM-RETRO-PREM-P-E             PIC X.
  5829         16  AM-RETRO-CLMS-P-I             PIC X.
  5830         16  AM-RETRO-RET-BRACKET-LF.
  5831             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5832                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5833                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5834             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5835                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5836                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5837             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5838                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5839                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5840         16  AM-RETRO-RET-BRACKET-AH.
  5841             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5842                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5843                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5844                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5845             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5846                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5847                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5848             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 109
* EL130.cbl
  5849                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5850                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5851
  5852     12  AM-COMMENTS.
  5853         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5854
  5855     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5856         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5857         16  AM-FLI-BILLING-CODE           PIC X.
  5858         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5859         16  AM-FLI-UNITED-IDENT           PIC X.
  5860         16  AM-FLI-INTEREST-LOST-DATA.
  5861             20  AM-FLI-BANK-NO            PIC X(5).
  5862             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5863             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5864             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5865         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5866             20  AM-FLI-AGT                PIC X(9).
  5867             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5868             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5869         16  FILLER                        PIC X(102).
  5870
  5871     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5872         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5873             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5874             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5875             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5876             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5877             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5878         16  FILLER                          PIC X(10).
  5879******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 110
* EL130.cbl
  5881*    COPY ELCTRLR.
  5882******************************************************************
  5883*                                                                *
  5884*                            ELCTRLR.                            *
  5885*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5886*                            VMOD=2.014                          *
  5887*                                                                *
  5888*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5889*                                                                *
  5890*   FILE TYPE = VSAM,KSDS                                        *
  5891*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5892*                                                                *
  5893*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5894*       ALTERNATE INDEX = NONE                                   *
  5895*                                                                *
  5896*   LOG = YES                                                    *
  5897*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5898******************************************************************
  5899*                   C H A N G E   L O G
  5900*
  5901* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5902*-----------------------------------------------------------------
  5903*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5904* EFFECTIVE    NUMBER
  5905*-----------------------------------------------------------------
  5906* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5907* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5908* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5909* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5910* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5911* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5912* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5913* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5914* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5915* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5916* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5917* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5918* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5919* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5920* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5921* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5922* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5923* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5924* 040814    2014030500002  AJRA  ADD ICD CODES
  5925* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5926* 013017  CR2016053100001  PEMA  ACH PROCESSING
  5927* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  5928* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5929* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  5930******************************************************************
  5931 01  ACTIVITY-TRAILERS.
  5932     12  AT-RECORD-ID                    PIC XX.
  5933         88  VALID-AT-ID                       VALUE 'AT'.
  5934
  5935     12  AT-CONTROL-PRIMARY.
  5936         16  AT-COMPANY-CD               PIC X.
  5937         16  AT-CARRIER                  PIC X.
  5938         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 111
* EL130.cbl
  5939         16  AT-CERT-NO.
  5940             20  AT-CERT-PRIME           PIC X(10).
  5941             20  AT-CERT-SFX             PIC X.
  5942         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5943             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5944             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5945             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5946             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5947             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5948             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5949             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5950             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5951             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5952             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5953             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5954             88  AT-BENEFICIARY-TRL           VALUE +91.
  5955             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5956             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5957             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5958             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5959
  5960     12  AT-TRAILER-TYPE                 PIC X.
  5961         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5962         88  PAYMENT-TR                       VALUE '2'.
  5963         88  AUTO-PAY-TR                      VALUE '3'.
  5964         88  CORRESPONDENCE-TR                VALUE '4'.
  5965         88  ADDRESS-TR                       VALUE '5'.
  5966         88  GENERAL-INFO-TR                  VALUE '6'.
  5967         88  AUTO-PROMPT-TR                   VALUE '7'.
  5968         88  DENIAL-TR                        VALUE '8'.
  5969         88  INCURRED-CHG-TR                  VALUE '9'.
  5970         88  FORM-CONTROL-TR                  VALUE 'A'.
  5971
  5972     12  AT-RECORDED-DT                  PIC XX.
  5973     12  AT-RECORDED-BY                  PIC X(4).
  5974     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5975
  5976     12  AT-TRAILER-BODY                 PIC X(165).
  5977
  5978     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5979         16  AT-RESERVE-CONTROLS.
  5980             20  AT-MANUAL-SW            PIC X.
  5981                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5982             20  AT-FUTURE-SW            PIC X.
  5983                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5984             20  AT-PTC-SW               PIC X.
  5985                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5986             20  AT-IBNR-SW              PIC X.
  5987                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5988             20  AT-PTC-LF-SW            PIC X.
  5989                 88  AT-LF-PTC-USED          VALUE '1'.
  5990             20  AT-CDT-ACCESS-METHOD    PIC X.
  5991                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5992                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5993                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5994             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5995         16  AT-LAST-COMPUTED-DT         PIC XX.
  5996         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 112
* EL130.cbl
  5997         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5998         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5999         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6000         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6001         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6002         16  AT-EXPENSE-CONTROLS.
  6003             20  AT-EXPENSE-METHOD       PIC X.
  6004                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6005                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6006                 88  PERCENT-OF-PMT           VALUE '3'.
  6007                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6008             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6009             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6010         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6011         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6012
  6013         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6014         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6015
  6016*        16  FILLER                      PIC X(53).
  6017         16  FILLER                      PIC X(47).
  6018
  6019         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6020         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6021
  6022         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6023             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6024             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6025*                    C = CLOSED
  6026*                    O = OPEN
  6027             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6028*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6029
  6030     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6031         16  AT-PAYMENT-TYPE             PIC X.
  6032             88  PARTIAL-PAYMENT                VALUE '1'.
  6033             88  FINAL-PAYMENT                  VALUE '2'.
  6034             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6035             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6036             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6037             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6038             88  VOIDED-PAYMENT                 VALUE '9'.
  6039             88  TRANSFER                       VALUE 'T'.
  6040             88  LIFE-INTEREST                  VALUE 'I'.
  6041
  6042         16  AT-CLAIM-TYPE               PIC X.
  6043             88  PAID-FOR-AH                    VALUE 'A'.
  6044             88  PAID-FOR-LIFE                  VALUE 'L'.
  6045             88  PAID-FOR-IUI                   VALUE 'I'.
  6046             88  PAID-FOR-GAP                   VALUE 'G'.
  6047             88  PAID-FOR-FAM                   VALUE 'F'.
  6048             88  PAID-FOR-OTH                   VALUE 'O'.
  6049         16  AT-CLAIM-PREM-TYPE          PIC X.
  6050             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6051             88  AT-O-B-COVERAGE                VALUE '2'.
  6052             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6053         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6054         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 113
* EL130.cbl
  6055         16  AT-PAID-FROM-DT             PIC XX.
  6056         16  AT-PAID-THRU-DT             PIC XX.
  6057         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6058         16  AT-ACH-PAYMENT              PIC X.
  6059*        16  FILLER                      PIC X.
  6060         16  AT-PAYEES-NAME              PIC X(30).
  6061         16  AT-PAYMENT-ORIGIN           PIC X.
  6062             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6063             88  ONLINE-AUTO-PMT                VALUE '2'.
  6064             88  OFFLINE-PMT                    VALUE '3'.
  6065         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6066         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6067         16  AT-VOID-DATA.
  6068             20  AT-VOID-DT              PIC XX.
  6069*00144       20  AT-VOID-REASON          PIC X(30).
  6070             20  AT-VOID-REASON          PIC X(26).
  6071         16  AT-PMT-APPROVED-BY          PIC X(04).
  6072         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6073         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6074         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6075                                         PIC S99V9(5)  COMP-3.
  6076         16  AT-CREDIT-INTERFACE.
  6077             20  AT-PMT-SELECT-DT        PIC XX.
  6078                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6079             20  AT-PMT-ACCEPT-DT        PIC XX.
  6080                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6081             20  AT-VOID-SELECT-DT       PIC XX.
  6082                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6083             20  AT-VOID-ACCEPT-DT       PIC XX.
  6084                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6085
  6086         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6087                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6088                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6089         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6090
  6091         16  AT-FORCE-CONTROL            PIC X.
  6092             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6093         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6094         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6095         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6096         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6097         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6098         16  AT-BENEFIT-TYPE             PIC X.
  6099
  6100         16  AT-EXPENSE-TYPE             PIC X.
  6101         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6102
  6103         16  AT-PAYEE-TYPE-CD.
  6104             20  AT-PAYEE-TYPE           PIC X.
  6105                 88  INSURED-PAID           VALUE 'I'.
  6106                 88  BENEFICIARY-PAID       VALUE 'B'.
  6107                 88  ACCOUNT-PAID           VALUE 'A'.
  6108                 88  OTHER-1-PAID           VALUE 'O'.
  6109                 88  OTHER-2-PAID           VALUE 'Q'.
  6110                 88  DOCTOR-PAID            VALUE 'P'.
  6111                 88  EMPLOYER-PAID          VALUE 'E'.
  6112             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 114
* EL130.cbl
  6113
  6114         16  AT-CASH-PAYMENT             PIC X.
  6115         16  AT-GROUPED-PAYMENT          PIC X.
  6116         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6117         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6118         16  AT-APPROVED-LEVEL           PIC X.
  6119         16  AT-VOID-TYPE                PIC X.
  6120             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6121             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6122         16  AT-AIG-UNEMP-IND            PIC X.
  6123             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6124         16  AT-ASSOCIATES               PIC X.
  6125             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6126             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6127
  6128         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6129         16  AT-CV-PMT-CODE              PIC X.
  6130             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6131             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6132             88  FULL-ADD-PAYMENT           VALUE '3'.
  6133             88  HALF-ADD-PAYMENT           VALUE '4'.
  6134             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6135             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6136             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6137             88  ADDL-PAYMENT               VALUE '8'.
  6138
  6139         16  AT-EOB-CODE1                PIC XXX.
  6140         16  AT-EOB-CODE2                PIC XXX.
  6141         16  AT-EOB-CODE3                PIC XXX.
  6142         16  FILLER REDEFINES AT-EOB-CODE3.
  6143             20  AT-PRINT-CLM-FORM       PIC X.
  6144             20  AT-PRINT-SURVEY         PIC X.
  6145             20  AT-SPECIAL-RELEASE      PIC X.
  6146         16  AT-EOB-CODE4                PIC XXX.
  6147         16  FILLER REDEFINES AT-EOB-CODE4.
  6148             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6149             20  FILLER                  PIC X.
  6150         16  AT-EOB-CODE5                PIC XXX.
  6151         16  FILLER REDEFINES AT-EOB-CODE5.
  6152             20  AT-PMT-PROOF-DT         PIC XX.
  6153             20  FILLER                  PIC X.
  6154
  6155         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6156             88  AT-PRINT-EOB            VALUE 'Y'.
  6157
  6158         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6159         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6160
  6161     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6162         16  AT-SCHEDULE-START-DT        PIC XX.
  6163         16  AT-SCHEDULE-END-DT          PIC XX.
  6164         16  AT-TERMINATED-DT            PIC XX.
  6165         16  AT-LAST-PMT-TYPE            PIC X.
  6166             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6167             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6168         16  AT-FIRST-PMT-DATA.
  6169             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6170             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 115
* EL130.cbl
  6171             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6172         16  AT-REGULAR-PMT-DATA.
  6173             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6174             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6175             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6176         16  AT-AUTO-PAYEE-CD.
  6177             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6178                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6179                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6180                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6181                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6182                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6183             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6184         16  AT-AUTO-PAY-DAY             PIC 99.
  6185         16  AT-AUTO-CASH                PIC X.
  6186             88  AT-CASH                      VALUE 'Y'.
  6187             88  AT-NON-CASH                  VALUE 'N'.
  6188*        16  FILLER                      PIC X(129).
  6189         16  AT-AUTO-END-LETTER          PIC X(4).
  6190         16  FILLER                      PIC X(125).
  6191
  6192         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6193         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6194
  6195     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6196         16  AT-LETTER-SENT-DT           PIC XX.
  6197         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6198         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6199         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6200         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6201         16  AT-LETTER-ORIGIN            PIC X.
  6202             88  ONLINE-CREATION              VALUE '1' '3'.
  6203             88  OFFLINE-CREATION             VALUE '2' '4'.
  6204             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6205             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6206         16  AT-STD-LETTER-FORM          PIC X(4).
  6207         16  AT-REASON-TEXT              PIC X(70).
  6208         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6209         16  AT-ADDRESEE-TYPE            PIC X.
  6210              88  INSURED-ADDRESEE            VALUE 'I'.
  6211              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6212              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6213              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6214              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6215              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6216              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6217         16  AT-ADDRESSEE-NAME           PIC X(30).
  6218         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6219         16  AT-RESEND-PRINT-DATE        PIC XX.
  6220         16  AT-CORR-SOL-UNSOL           PIC X.
  6221         16  AT-LETTER-PURGED-DT         PIC XX.
  6222*
  6223*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6224*
  6225         16  AT-CSO-REDEFINITION.
  6226             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6227             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6228             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 116
* EL130.cbl
  6229             20  AT-STOP-LETTER-DT       PIC X(2).
  6230             20  AT-AUTH-RCVD            PIC X(1).
  6231             20  FILLER                  PIC X(18).
  6232*             20  FILLER                  PIC X(27).
  6233             20  AT-CSO-LETTER-STATUS    PIC X.
  6234                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6235                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6236                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6237             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6238             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6239*
  6240*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6241*
  6242*        16  FILLER                      PIC X(26).
  6243*
  6244*        16  AT-DMD-BSR-CODE             PIC X.
  6245*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6246*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6247*
  6248*        16  AT-DMD-LETTER-STATUS        PIC X.
  6249*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6250*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6251*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6252*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6253*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6254
  6255         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6256         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6257
  6258     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6259         16  AT-ADDRESS-TYPE             PIC X.
  6260             88  INSURED-ADDRESS               VALUE 'I'.
  6261             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6262             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6263             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6264             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6265             88  OTHER-ADDRESS-1               VALUE 'O'.
  6266             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6267         16  AT-MAIL-TO-NAME             PIC X(30).
  6268         16  AT-ADDRESS-LINE-1           PIC X(30).
  6269         16  AT-ADDRESS-LINE-2           PIC X(30).
  6270         16  AT-CITY-STATE.
  6271             20  AT-CITY                 PIC X(28).
  6272             20  AT-STATE                PIC XX.
  6273         16  AT-ZIP.
  6274             20  AT-ZIP-CODE.
  6275                 24  AT-ZIP-1ST          PIC X.
  6276                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6277                 24  FILLER              PIC X(4).
  6278             20  AT-ZIP-PLUS4            PIC X(4).
  6279         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6280             20  AT-CAN-POSTAL-1         PIC XXX.
  6281             20  AT-CAN-POSTAL-2         PIC XXX.
  6282             20  FILLER                  PIC XXX.
  6283         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6284*         16  FILLER                      PIC X(23).
  6285         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6286         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 117
* EL130.cbl
  6287         16  FILLER                      PIC X(13).
  6288         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6289         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6290
  6291     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6292         16  AT-INFO-LINE-1              PIC X(60).
  6293         16  FILLER REDEFINES AT-INFO-LINE-1.
  6294             20  AT-NOTE-ERROR-NO OCCURS 15
  6295                                         PIC X(4).
  6296         16  AT-INFO-LINE-2              PIC X(60).
  6297         16  FILLER REDEFINES AT-INFO-LINE-2.
  6298             20  AT-ICD-CODE-1           PIC X(8).
  6299             20  AT-ICD-CODE-2           PIC X(8).
  6300             20  FILLER                  PIC X(44).
  6301         16  AT-INFO-TRAILER-TYPE        PIC X.
  6302             88  AT-ERRORS-NOTE          VALUE 'E'.
  6303             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6304             88  AT-CALL-NOTE            VALUE 'C'.
  6305             88  AT-MAINT-NOTE           VALUE 'M'.
  6306             88  AT-CERT-CHANGE          VALUE 'X'.
  6307             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6308             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6309             88  AT-CERT-CANCELLED       VALUE 'T'.
  6310         16  AT-CALL-TYPE                PIC X.
  6311             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6312             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  6313             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6314         16  AT-NOTE-CONTINUATION        PIC X.
  6315             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6316         16  AT-EOB-CODES-EXIST          PIC X.
  6317             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6318         16  FILLER                      PIC X(35).
  6319         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6320         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6321
  6322     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6323         16  AT-PROMPT-LINE-1            PIC X(60).
  6324         16  AT-PROMPT-LINE-2            PIC X(60).
  6325         16  AT-PROMPT-START-DT          PIC XX.
  6326         16  AT-PROMPT-END-DT            PIC XX.
  6327         16  FILLER                      PIC X(35).
  6328         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6329         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6330
  6331     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6332         16  AT-DENIAL-INFO-1            PIC X(60).
  6333         16  AT-DENIAL-INFO-2            PIC X(60).
  6334         16  AT-DENIAL-DT                PIC XX.
  6335         16  AT-RETRACTION-DT            PIC XX.
  6336         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6337*         16  FILLER                      PIC X(31).
  6338         16  AT-DENIAL-PROOF-DT          PIC XX.
  6339         16  FILLER                      PIC X(29).
  6340         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6341         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6342
  6343     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6344         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 118
* EL130.cbl
  6345         16  AT-OLD-REPORTED-DT          PIC XX.
  6346         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6347         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6348         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6349         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6350         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6351         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6352         16  FILLER                      PIC X(26).
  6353         16  AT-OLD-DIAG-CODE            PIC X(6).
  6354         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6355         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6356         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6357         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6358         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6359         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6360         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6361         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6362         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6363         16  FILLER                      PIC X(9).
  6364         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6365
  6366     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6367         16  AT-FORM-SEND-ON-DT          PIC XX.
  6368         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6369         16  AT-FORM-RE-SEND-DT          PIC XX.
  6370         16  AT-FORM-ANSWERED-DT         PIC XX.
  6371         16  AT-FORM-PRINTED-DT          PIC XX.
  6372         16  AT-FORM-REPRINT-DT          PIC XX.
  6373         16  AT-FORM-TYPE                PIC X.
  6374             88  INITIAL-FORM                  VALUE '1'.
  6375             88  PROGRESS-FORM                 VALUE '2'.
  6376         16  AT-INSTRUCT-LN-1            PIC X(28).
  6377         16  AT-INSTRUCT-LN-2            PIC X(28).
  6378         16  AT-INSTRUCT-LN-3            PIC X(28).
  6379         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6380         16  AT-FORM-ADDRESS             PIC X.
  6381             88  FORM-TO-INSURED              VALUE 'I'.
  6382             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6383             88  FORM-TO-OTHER-1              VALUE 'O'.
  6384             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6385         16  AT-RELATED-1.
  6386             20 AT-REL-CARR-1            PIC X.
  6387             20 AT-REL-CLAIM-1           PIC X(7).
  6388             20 AT-REL-CERT-1            PIC X(11).
  6389         16  AT-RELATED-2.
  6390             20 AT-REL-CARR-2            PIC X.
  6391             20 AT-REL-CLAIM-2           PIC X(7).
  6392             20 AT-REL-CERT-2            PIC X(11).
  6393         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6394         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6395         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6396         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6397         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6398         16  AT-STOP-FORM-DT             PIC X(2).
  6399
  6400         16  FILLER                      PIC X(09).
  6401         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6402         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 119
* EL130.cbl
  6403******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 120
* EL130.cbl
  6405*    COPY ELCBENE.
  6406******************************************************************
  6407*                                                                *
  6408*                            ELCBENE.                            *
  6409*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6410*                            VMOD=2.006                          *
  6411*                                                                *
  6412*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6413*                                                                *
  6414*   FILE TYPE = VSAM,KSDS                                        *
  6415*   RECORD SIZE = 500   RECFORM = FIX                            *
  6416*                                                                *
  6417*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6418*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6419*                                                                *
  6420*   LOG = YES                                                    *
  6421*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6422*                                                                *
  6423*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6424******************************************************************
  6425*                   C H A N G E   L O G
  6426*
  6427* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6428*-----------------------------------------------------------------
  6429*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6430* EFFECTIVE    NUMBER
  6431*-----------------------------------------------------------------
  6432* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6433* 082317  CR2017082100003  PEMA  Add sub type
  6434* 032019  CR2019011400002  PEMA  Add email address for ach report
  6435******************************************************************
  6436
  6437 01  BENEFICIARY-MASTER.
  6438     12  BE-RECORD-ID                PIC XX.
  6439         88  VALID-BE-ID                VALUE 'BE'.
  6440
  6441     12  BE-CONTROL-PRIMARY.
  6442         16  BE-COMPANY-CD           PIC X.
  6443         16  BE-RECORD-TYPE          PIC X.
  6444             88  BENEFICIARY-RECORD  VALUE 'B'.
  6445             88  ADJUSTOR-RECORD     VALUE 'A'.
  6446         16  BE-BENEFICIARY          PIC X(10).
  6447     12  BE-CONTROL-BY-NAME.
  6448         16  BE-COMPANY-CD-A1        PIC X.
  6449         16  BE-RECORD-TYPE-A1       PIC X.
  6450         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6451         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6452
  6453     12  BE-LAST-MAINT-DT            PIC XX.
  6454     12  BE-LAST-MAINT-BY            PIC X(4).
  6455     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6456
  6457     12  BE-ADDRESS-DATA.
  6458         16  BE-MAIL-TO-NAME         PIC X(30).
  6459         16  BE-ADDRESS-LINE-1       PIC X(30).
  6460         16  BE-ADDRESS-LINE-2       PIC X(30).
  6461         16  BE-ADDRESS-LINE-3       PIC X(30).
  6462         16  BE-CITY-STATE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 121
* EL130.cbl
  6463             20  BE-CITY             PIC X(28).
  6464             20  BE-STATE            PIC XX.
  6465         16  BE-ZIP-CODE.
  6466             20  BE-ZIP-PRIME.
  6467                 24  BE-ZIP-1ST      PIC X.
  6468                     88  BE-CANADIAN-POST-CODE
  6469                                         VALUE 'A' THRU 'Z'.
  6470                 24  FILLER          PIC X(4).
  6471             20  BE-ZIP-PLUS4        PIC X(4).
  6472         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6473             20  BE-CAN-POSTAL-1     PIC XXX.
  6474             20  BE-CAN-POSTAL-2     PIC XXX.
  6475             20  FILLER              PIC XXX.
  6476         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6477         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6478
  6479******************************************************************
  6480*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6481*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6482******************************************************************
  6483     12  BE-CARRIER                  PIC X.
  6484
  6485     12  BE-ADDRESS-DATA2.
  6486         16  BE-MAIL-TO-NAME2        PIC X(30).
  6487         16  BE-ADDRESS-LINE-12      PIC X(30).
  6488         16  BE-ADDRESS-LINE-22      PIC X(30).
  6489         16  BE-ADDRESS-LINE-32      PIC X(30).
  6490         16  BE-CITY-STATE2.
  6491             20  BE-CITY2            PIC X(28).
  6492             20  BE-STATE2           PIC XX.
  6493         16  BE-ZIP-CODE2.
  6494             20  BE-ZIP-PRIME2.
  6495                 24  BE-ZIP-1ST2     PIC X.
  6496                     88  BE-CANADIAN-POST-CODE2
  6497                                         VALUE 'A' THRU 'Z'.
  6498                 24  FILLER          PIC X(4).
  6499             20  BE-ZIP-PLUS42       PIC X(4).
  6500         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6501             20  BE-CAN-POSTAL-12    PIC XXX.
  6502             20  BE-CAN-POSTAL-22    PIC XXX.
  6503             20  FILLER              PIC XXX.
  6504         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6505         16  BE-ACH-DATA.
  6506             20  BE-ACH-YES-OR-NO    PIC X.
  6507                 88  BE-ON-ACH       VALUE 'Y'.
  6508                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  6509             20  BE-ACH-ABA-ROUTING-NUMBER
  6510                                     PIC X(15).
  6511             20  BE-ACH-BANK-ACCOUNT-NUMBER
  6512                                     PIC X(20).
  6513             20  BE-ACH-SUB-TYPE     PIC XX.
  6514             20  BE-ACH-EMAIL-YN     PIC X.
  6515                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.
  6516             20  be-ach-email-addr   PIC X(40).
  6517         16  BE-BILLING-STMT-DATA.
  6518*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6519             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6520             20  BE-OUTPUT-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 122
* EL130.cbl
  6521                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6522                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6523
  6524     12  filler                      PIC X(16).
  6525******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 123
* EL130.cbl
  6527*    COPY ELCDAR.
  6528******************************************************************
  6529*                                                                *
  6530*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6531*   FILE TYPE = VSAM,KSDS                                        *
  6532*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6533*   BASE CLUSTER = DLYACTV                                       *
  6534*   LOG = YES                                                    *
  6535*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6536*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6537*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6538*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6539*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6540*               BY PROGRAM "LGINFCE".                            *
  6541*                                                                *
  6542******************************************************************
  6543 01  DAILY-ACTIVITY-RECORD.
  6544     05  DA-KEY.
  6545         10  DA-COMP-CD          PIC X.
  6546         10  DA-CARRIER          PIC X.
  6547         10  DA-CLAIM-NO         PIC X(7).
  6548         10  DA-CERT-NO.
  6549             15  DA-CERT-PRIME   PIC X(10).
  6550             15  DA-CERT-SFX     PIC X.
  6551     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6552     05  DA-RECORD-TYPE          PIC X.
  6553     05  FILLER                  PIC X(2).
  6554******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 124
* EL130.cbl
  6556*    COPY ELCACTQ.
  6557******************************************************************
  6558*                                                                *
  6559*                            ELCACTQ.                            *
  6560*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6561*                            VMOD=2.004                          *
  6562*                                                                *
  6563*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6564*                                                                *
  6565*   FILE TYPE = VSAM,KSDS                                        *
  6566*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6567*                                                                *
  6568*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6569*       ALTERNATE INDEX = NONE                                   *
  6570*                                                                *
  6571*   LOG = YES                                                    *
  6572*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6573*                                                                *
  6574*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6575******************************************************************
  6576
  6577 01  ACTIVITY-QUE.
  6578     12  AQ-RECORD-ID                PIC XX.
  6579         88  VALID-AQ-ID                VALUE 'AQ'.
  6580
  6581     12  AQ-CONTROL-PRIMARY.
  6582         16  AQ-COMPANY-CD           PIC X.
  6583         16  AQ-CARRIER              PIC X.
  6584         16  AQ-CLAIM-NO             PIC X(7).
  6585         16  AQ-CERT-NO.
  6586             20  AQ-CERT-PRIME       PIC X(10).
  6587             20  AQ-CERT-SFX         PIC X.
  6588
  6589     12  AQ-PENDING-ACTIVITY-FLAGS.
  6590         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6591         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6592             88  PENDING-PAYMENTS       VALUE '1'.
  6593         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6594             88  PENDING-FULL-PRINT     VALUE '1'.
  6595             88  PENDING-PART-PRINT     VALUE '2'.
  6596         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6597             88  PENDING-LETTERS        VALUE '1'.
  6598         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6599             88  PENDING-RESTORE        VALUE 'C'.
  6600             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6601
  6602     12  FILLER                      PIC X(20).
  6603
  6604     12  AQ-RESEND-DATE              PIC XX.
  6605     12  AQ-FOLLOWUP-DATE            PIC XX.
  6606     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6607     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6608     12  AQ-AUTO-LETTER              PIC X(4).
  6609     12  FILLER                      PIC XX.
  6610     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6611*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 125
* EL130.cbl
  6613*    COPY ELCARCH.
  6614******************************************************************
  6615*                                                                *
  6616*                            ELCARCH.                            *
  6617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6618*                            VMOD=2.007                          *
  6619*                                                                *
  6620*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6621*                                                                *
  6622*   FILE TYPE = VSAM,KSDS                                        *
  6623*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6624*                                                                *
  6625*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6626*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6627*                                                                *
  6628*   LOG = NO                                                     *
  6629*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6630*                                                                *
  6631*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6632******************************************************************
  6633 01  LETTER-ARCHIVE.
  6634     12  LA-RECORD-ID                PIC XX.
  6635         88  VALID-LA-ID                VALUE 'LA'.
  6636
  6637     12  LA-CONTROL-PRIMARY.
  6638         16  LA-COMPANY-CD           PIC X.
  6639         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6640         16  LA-RECORD-TYPE          PIC X.
  6641             88  LA-HEADER-DATA         VALUE '1'.
  6642             88  LA-ADDRESS-DATA        VALUE '2'.
  6643             88  LA-TEXT-DATA           VALUE '3'.
  6644             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6645         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6646
  6647     12  LA-CONTROL-BY-TYPE.
  6648         16  LA-COMPANY-CD-A1        PIC X.
  6649         16  LA-RECORD-TYPE-A1       PIC X.
  6650         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6651         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6652
  6653     12  LA-TEXT-RECORD.
  6654         16  LA-SKIP-CONTROL         PIC XX.
  6655             88  NO-LINES-SKIPPED       VALUE SPACES.
  6656             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6657         16  LA-TEXT-LINE            PIC X(70).
  6658
  6659     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6660         16  FILLER                  PIC XX.
  6661         16  LA-ADDRESS-LINE         PIC X(30).
  6662         16  FILLER                  PIC X(40).
  6663
  6664     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6665         16  FILLER                  PIC XX.
  6666         16  LA-CARRIER              PIC X.
  6667         16  LA-CLAIM-NO             PIC X(7).
  6668         16  LA-CERT-NO.
  6669             20  LA-CERT-PRIME       PIC X(10).
  6670             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 126
* EL130.cbl
  6671         16  LA-NO-OF-COPIES         PIC S9.
  6672         16  LA-RESEND-DATE          PIC XX.
  6673         16  LA-PROCESSOR-CD         PIC X(4).
  6674         16  LA-CREATION-DT          PIC XX.
  6675         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6676         16  LA-RESEND-PRINT-DATE    PIC XX.
  6677         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6678         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6679*
  6680* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6681*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6682*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6683*   I        20  LA-DMD-RES-ST           PIC XX.
  6684*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6685*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6686*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6687*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6688*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6689*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6690*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6691*   I        20  LA-DMD-UND-CODE         PIC XX.
  6692*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6693*   V    16  FILLER                  PIC X(15).
  6694* -----
  6695*
  6696* REINSERTED  CSO  MODS
  6697*
  6698         16  FILLER.
  6699             20  FILLER                  PIC X(29).
  6700             20  LA-CSO-LETTER-STATUS    PIC X.
  6701                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6702                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6703                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6704             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6705             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6706*
  6707
  6708     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6709         16  FILLER                  PIC XX.
  6710         16  LA4-CARRIER             PIC X.
  6711         16  LA4-CLAIM-NO            PIC X(7).
  6712         16  LA4-CERT-NO.
  6713             20  LA4-CERT-PRIME      PIC X(10).
  6714             20  LA4-CERT-SFX        PIC X.
  6715         16  LA4-NO-OF-COPIES        PIC S9.
  6716         16  LA4-RESEND-DATE         PIC XX.
  6717         16  LA4-PROCESSOR-CD        PIC X(4).
  6718         16  LA4-CREATION-DT         PIC XX.
  6719         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6720         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6721         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6722         16  LA4-FORM-TYPE           PIC X.
  6723             88  LA4-INITIAL-FORM    VALUE '1'.
  6724             88  LA4-PROGRESS-FORM   VALUE '2'.
  6725         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6726         16  LA4-STATE               PIC X(02).
  6727         16  FILLER                  PIC X(31).
  6728******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 127
* EL130.cbl
  6730*    COPY ERCREIN.
  6731******************************************************************
  6732*                                                                *
  6733*                            ERCREIN                             *
  6734*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6735*                            VMOD=2.010                          *
  6736*                                                                *
  6737*   ONLINE CREDIT SYSTEM                                         *
  6738*                                                                *
  6739*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6740*                                                                *
  6741*   FILE TYPE = VSAM,KSDS                                        *
  6742*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6743*                                                                *
  6744*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6745*       ALTERNATE PATH = NONE                                    *
  6746*                                                                *
  6747*   LOG = NO                                                     *
  6748*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6749*                                                                *
  6750******************************************************************
  6751*                   C H A N G E   L O G
  6752*
  6753* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6754*-----------------------------------------------------------------
  6755*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6756* EFFECTIVE    NUMBER
  6757*-----------------------------------------------------------------
  6758* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6759* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6760******************************************************************
  6761 01  REINSURANCE-RECORD.
  6762     12  RE-RECORD-ID                      PIC XX.
  6763         88  VALID-RE-ID                      VALUE 'RE'.
  6764
  6765     12  RE-CONTROL-PRIMARY.
  6766         16  RE-COMPANY-CD                 PIC X.
  6767         16  RE-KEY.
  6768             20  RE-CODE                   PIC X.
  6769                 88  RE-TABLE-RECORD          VALUE 'A'.
  6770                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6771             20  RE-TABLE                  PIC XXX.
  6772             20  FILLER                    PIC XXX.
  6773         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6774             20  FILLER                    PIC X.
  6775             20  RE-COMPANY.
  6776                 24  RE-COMP-PRIME         PIC XXX.
  6777                 24  RE-COMP-SUB           PIC XXX.
  6778
  6779     12  RE-MAINT-INFORMATION.
  6780         16  RE-LAST-MAINT-DT              PIC XX.
  6781         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6782         16  RE-LAST-MAINT-USER            PIC X(4).
  6783         16  FILLER                        PIC X(10).
  6784
  6785     12  RE-TABLE-DATA.
  6786         16  RE-100-COMP                   PIC 99.
  6787
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 128
* EL130.cbl
  6788         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6789             20  RE-REI-COMP-NO.
  6790                 24  RE-REI-COMP           PIC XXX.
  6791                 24  RE-REI-COMP-SUB       PIC XXX.
  6792             20  RE-LF-QC                  PIC X.
  6793             20  RE-AH-QC                  PIC X.
  6794             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6795             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6796             20  RE-LFAGE-LO               PIC 99.
  6797             20  RE-LFAGE-HI               PIC 99.
  6798             20  RE-AHAGE-LO               PIC 99.
  6799             20  RE-AHAGE-HI               PIC 99.
  6800             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6801             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6802             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6803             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6804             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6805             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6806             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6807             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6808             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6809             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6810             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6811             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6812             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6813             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6814             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6815             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6816             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6817             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6818             20  RE-LF-BEN-CODE            PIC X.
  6819             20  RE-AH-BEN-CODE            PIC X.
  6820             20  RE-INTERACTIVE            PIC X.
  6821             20  RE-REMAINING              PIC X.
  6822             20  RE-LF-RUNOFF-SW           PIC X.
  6823             20  RE-AH-RUNOFF-SW           PIC X.
  6824             20  FILLER                    PIC X(19).
  6825
  6826         16  RE-COMP-INFO-END              PIC X(6).
  6827         16  RE-NSP-ST-CD-LF               PIC XX.
  6828         16  RE-NSP-ST-CD-AH               PIC XX.
  6829         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6830             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6831
  6832         16  FILLER                        PIC X(27).
  6833
  6834     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6835         16  RE-NAME                       PIC X(30).
  6836         16  RE-LF-PE                      PIC X.
  6837         16  RE-AH-PE                      PIC X.
  6838         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6839         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6840         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6841         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6842         16  RE-PRT-ST                     PIC X.
  6843         16  RE-PRT-OW                     PIC X.
  6844         16  RE-MORT-CODE                  PIC X(4).
  6845         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 129
* EL130.cbl
  6846         16  RE-ZERO-LF-FEE                PIC X.
  6847         16  RE-ZERO-AH-FEE                PIC X.
  6848         16  RE-CEDE-NAME                  PIC X(30).
  6849         16  RE-LF-COMM                    PIC X.
  6850         16  RE-AH-COMM                    PIC X.
  6851         16  RE-LF-TAX                     PIC X.
  6852         16  RE-AH-TAX                     PIC X.
  6853         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6854         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6855         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6856
  6857         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6858             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6859
  6860         16  RE-LF-CEDING-FEE-BRACKETS.
  6861             20  RE-LF-FEE-METHOD          PIC X.
  6862                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6863                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6864                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6865                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6866             20  RE-LF-FEE-BASIS           PIC X.
  6867                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6868                 88  RE-LF-NET-CEDED               VALUE '2'.
  6869                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6870                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6871                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6872                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6873                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6874                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6875             20  FILLER                    PIC XXX.
  6876             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6877                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6878                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6879
  6880         16  RE-AH-CEDING-FEE-BRACKETS.
  6881             20  RE-AH-FEE-METHOD          PIC X.
  6882                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6883                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6884                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6885                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6886             20  RE-AH-FEE-BASIS           PIC X.
  6887                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6888                 88  RE-AH-NET-CEDED               VALUE '2'.
  6889                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6890                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6891                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6892                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6893                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6894                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6895             20  FILLER                    PIC XXX.
  6896             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6897                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6898                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6899
  6900         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6901
  6902         16  RE-OLD-CEDING-STMT            PIC X.
  6903
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 130
* EL130.cbl
  6904         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6905         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6906         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6907         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6908         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6909         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6910         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6911         16  RE-MORT-SW                    PIC X.
  6912         16  RE-CEDING-TYPE-FLAG           PIC X.
  6913             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6914             88  RE-CEDED                          VALUE 'C'.
  6915             88  RE-ASSUMED                        VALUE 'A'.
  6916             88  RE-PHANTOM                        VALUE 'P'.
  6917
  6918         16  RE-CEDING-STMT-OPT-A          PIC X.
  6919             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6920         16  RE-CEDING-STMT-OPT-B          PIC X.
  6921             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6922         16  RE-CEDING-STMT-OPT-C          PIC X.
  6923             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6924         16  RE-CEDING-STMT-OPT-D          PIC X.
  6925             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6926         16  RE-CEDING-STMT-OPT-E          PIC X.
  6927             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6928
  6929         16  RE-PRT-CRSV                   PIC X.
  6930
  6931         16  RE-GL-CENTER                  PIC X(4).
  6932
  6933         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6934
  6935         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6936
  6937         16  RE-EARN-STOP-CODE             PIC X.
  6938             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6939             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6940
  6941         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6942             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6943
  6944         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6945         16  FILLER                        PIC X(2281).
  6946
  6947         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6948
  6949******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 131
* EL130.cbl
  6951*    COPY ERCMAIL.
  6952******************************************************************
  6953*                                                                *
  6954*                                                                *
  6955*                            ERCMAIL                             *
  6956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6957*                            VMOD=2.003                          *
  6958*                                                                *
  6959*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6960*                                                                *
  6961*   FILE TYPE = VSAM,KSDS                                        *
  6962*   RECORD SIZE = 374   RECFORM = FIX                            *
  6963*                                                                *
  6964*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6965*   ALTERNATE PATH    = NOT USED                                 *
  6966*                                                                *
  6967*   LOG = YES                                                    *
  6968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6969******************************************************************
  6970*                   C H A N G E   L O G
  6971*
  6972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6973*-----------------------------------------------------------------
  6974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6975* EFFECTIVE    NUMBER
  6976*-----------------------------------------------------------------
  6977* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6978* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6979* 111108                   PEMA  ADD CRED BENE ADDR2
  6980******************************************************************
  6981
  6982 01  MAILING-DATA.
  6983     12  MA-RECORD-ID                      PIC XX.
  6984         88  VALID-MA-ID                       VALUE 'MA'.
  6985
  6986     12  MA-CONTROL-PRIMARY.
  6987         16  MA-COMPANY-CD                 PIC X.
  6988         16  MA-CARRIER                    PIC X.
  6989         16  MA-GROUPING.
  6990             20  MA-GROUPING-PREFIX        PIC XXX.
  6991             20  MA-GROUPING-PRIME         PIC XXX.
  6992         16  MA-STATE                      PIC XX.
  6993         16  MA-ACCOUNT.
  6994             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6995             20  MA-ACCOUNT-PRIME          PIC X(6).
  6996         16  MA-CERT-EFF-DT                PIC XX.
  6997         16  MA-CERT-NO.
  6998             20  MA-CERT-PRIME             PIC X(10).
  6999             20  MA-CERT-SFX               PIC X.
  7000
  7001     12  FILLER                            PIC XX.
  7002
  7003     12  MA-ACCESS-CONTROL.
  7004         16  MA-SOURCE-SYSTEM              PIC XX.
  7005             88  MA-FROM-CREDIT                VALUE 'CR'.
  7006             88  MA-FROM-VSI                   VALUE 'VS'.
  7007             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7008             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 132
* EL130.cbl
  7009         16  MA-RECORD-ADD-DT              PIC XX.
  7010         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7011         16  MA-LAST-MAINT-DT              PIC XX.
  7012         16  MA-LAST-MAINT-BY              PIC XXXX.
  7013         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7014
  7015     12  MA-PROFILE-INFO.
  7016         16  MA-QUALIFY-CODE-1             PIC XX.
  7017         16  MA-QUALIFY-CODE-2             PIC XX.
  7018         16  MA-QUALIFY-CODE-3             PIC XX.
  7019         16  MA-QUALIFY-CODE-4             PIC XX.
  7020         16  MA-QUALIFY-CODE-5             PIC XX.
  7021
  7022         16  MA-INSURED-LAST-NAME          PIC X(15).
  7023         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7024         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7025         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7026         16  MA-INSURED-BIRTH-DT           PIC XX.
  7027         16  MA-INSURED-SEX                PIC X.
  7028             88  MA-SEX-MALE                   VALUE 'M'.
  7029             88  MA-SEX-FEMALE                 VALUE 'F'.
  7030         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7031
  7032         16  MA-ADDRESS-CORRECTED          PIC X.
  7033         16  MA-JOINT-BIRTH-DT             PIC XX.
  7034*        16  FILLER                        PIC X(12).
  7035
  7036         16  MA-ADDRESS-LINE-1             PIC X(30).
  7037         16  MA-ADDRESS-LINE-2             PIC X(30).
  7038         16  MA-CITY-STATE.
  7039             20  MA-CITY                   PIC X(28).
  7040             20  MA-ADDR-STATE             PIC XX.
  7041         16  MA-ZIP.
  7042             20  MA-ZIP-CODE.
  7043                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7044                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7045                 24  FILLER                PIC X(4).
  7046             20  MA-ZIP-PLUS4              PIC X(4).
  7047         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7048             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7049             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7050             20  FILLER                    PIC X(3).
  7051
  7052         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7053
  7054         16  FILLER                        PIC XXX.
  7055*        16  FILLER                        PIC X(10).
  7056
  7057     12  MA-CRED-BENE-INFO.
  7058         16  MA-CRED-BENE-NAME                 PIC X(25).
  7059         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7060         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7061         16  MA-CRED-BENE-CTYST.
  7062             20  MA-CRED-BENE-CITY             PIC X(28).
  7063             20  MA-CRED-BENE-STATE            PIC XX.
  7064         16  MA-CRED-BENE-ZIP.
  7065             20  MA-CB-ZIP-CODE.
  7066                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 133
* EL130.cbl
  7067                     88  MA-CB-CANADIAN-POST-CODE
  7068                                           VALUE 'A' THRU 'Z'.
  7069                 24  FILLER                    PIC X(4).
  7070             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7071         16  MA-CB-CANADIAN-POSTAL-CODE
  7072                            REDEFINES MA-CRED-BENE-ZIP.
  7073             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7074             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7075             20  FILLER                        PIC X(3).
  7076     12  MA-POST-CARD-MAIL-DATA.
  7077         16  MA-MAIL-DATA OCCURS 7.
  7078             20  MA-MAIL-TYPE              PIC X.
  7079                 88  MA-12MO-MAILING           VALUE '1'.
  7080                 88  MA-EXP-MAILING            VALUE '2'.
  7081             20  MA-MAIL-STATUS            PIC X.
  7082                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7083                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7084                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7085             20  MA-MAIL-DATE              PIC XX.
  7086     12  FILLER                            PIC XX.
  7087     12  FILLER                            PIC XX.
  7088*    12  FILLER                            PIC X(30).
  7089******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 134
* EL130.cbl
  7091*    COPY ELCCRTT.
  7092******************************************************************
  7093*                                                                *
  7094*                            ELCCRTT.                            *
  7095*                                                                *
  7096*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7097*                                                                *
  7098*   FILE TYPE = VSAM,KSDS                                        *
  7099*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7100*                                                                *
  7101*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7102*                                                                *
  7103*   LOG = YES                                                    *
  7104*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7105******************************************************************
  7106*                   C H A N G E   L O G
  7107*
  7108* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7109*-----------------------------------------------------------------
  7110*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7111* EFFECTIVE    NUMBER
  7112*-----------------------------------------------------------------
  7113* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7114* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7115* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7116* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7117* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7118* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7119* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7120* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7121* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7122* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7123* 091318  CR2018073000001  PEMA  ADD Refund methods
  7124* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7125******************************************************************
  7126
  7127 01  CERTIFICATE-TRAILERS.
  7128     12  CS-RECORD-ID                      PIC XX.
  7129         88  VALID-CS-ID                      VALUE 'CS'.
  7130
  7131     12  CS-CONTROL-PRIMARY.
  7132         16  CS-COMPANY-CD                 PIC X.
  7133         16  CS-CARRIER                    PIC X.
  7134         16  CS-GROUPING                   PIC X(6).
  7135         16  CS-STATE                      PIC XX.
  7136         16  CS-ACCOUNT                    PIC X(10).
  7137         16  CS-CERT-EFF-DT                PIC XX.
  7138         16  CS-CERT-NO.
  7139             20  CS-CERT-PRIME             PIC X(10).
  7140             20  CS-CERT-SFX               PIC X.
  7141         16  CS-TRAILER-TYPE               PIC X.
  7142             88  COMM-TRLR           VALUE 'A'.
  7143             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7144             88  CERT-DATA-TRLR      VALUE 'C'.
  7145
  7146     12  CS-DATA-AREA                      PIC X(516).
  7147
  7148     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 135
* EL130.cbl
  7149         16  CS-BANK-COMMISSION-AREA.
  7150             20  CS-BANK-COMMS       OCCURS 10.
  7151                 24  CS-AGT                PIC X(10).
  7152                 24  CS-COM-TYP            PIC X.
  7153                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7154                 24  CS-RECALC-LV-INDIC    PIC X.
  7155                 24  FILLER                PIC X(10).
  7156         16  FILLER                        PIC X(256).
  7157
  7158     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7159****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7160         16  CS-MB-CLAIM-DATA OCCURS 24.
  7161             20  CS-CLAIM-NO               PIC X(7).
  7162             20  CS-CLAIM-TYPE             PIC X.
  7163                 88  CS-AH-CLM               VALUE 'A'.
  7164                 88  CS-IU-CLM               VALUE 'I'.
  7165                 88  CS-GP-CLM               VALUE 'G'.
  7166                 88  CS-LF-CLM               VALUE 'L'.
  7167                 88  CS-PR-CLM               VALUE 'P'.
  7168                 88  CS-FL-CLM               VALUE 'F'.
  7169                 88  CS-OT-CLM               VALUE 'O'.
  7170             20  CS-INSURED-TYPE           PIC X.
  7171                 88  CS-PRIM-INSURED          VALUE 'P'.
  7172                 88  CS-CO-BORROWER           VALUE 'C'.
  7173             20  CS-BENEFIT-PERIOD         PIC 99.
  7174             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7175             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7176             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7177         16  FILLER                        PIC X(12).
  7178     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7179         16  CS-VIN-NUMBER                 PIC X(17).
  7180         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7181         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7182         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7183         16  cs-agent-name.
  7184             20  cs-agent-fname            pic x(20).
  7185             20  cs-agent-mi               pic x.
  7186             20  cs-agent-lname            pic x(25).
  7187         16  cs-license-no                 pic x(15).
  7188         16  cs-npn-number                 pic x(10).
  7189         16  cs-agent-edit-status          pic x.
  7190             88  cs-ae-refer-to-manager      value 'M'.
  7191             88  cs-ae-cover-sheet           value 'C'.
  7192             88  cs-ae-sig-form              value 'S'.
  7193             88  cs-ae-verified              value 'V'.
  7194             88  cs-unidentified-signature   value 'U'.
  7195             88  cs-cert-returned            value 'R'.
  7196             88  cs-accept-no-commission     value 'N'.
  7197         16  cs-year                       pic 9999.
  7198         16  cs-make                       pic x(20).
  7199         16  cs-model                      pic x(20).
  7200         16  cs-future                     pic x(20).
  7201         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7202         16  cs-claim-verification-status  pic x.
  7203             88  cs-clm-ver-eligible         value 'A'.
  7204             88  cs-clm-ver-partial-elig     value 'B'.
  7205             88  cs-clm-ver-not-eligible     value 'C'.
  7206             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 136
* EL130.cbl
  7207             88  cs-clm-ver-not-part-elig-rw value 'E'.
  7208             88  cs-clm-ver-ND-CERT          value 'F'.
  7209             88  cs-clm-ver-spec-other       value 'G'.
  7210             88  cs-clam-ver-pratial-corrected
  7211                                             value 'H'.
  7212             88  cs-clm-ver-no-matches       value 'I'.
  7213             88  cs-clm-ver-not-elig-corrected
  7214                                             value 'J'.
  7215             88  cs-clm-ver-needs-review     value 'R'.
  7216             88  cs-clm-ver-sent-to-claims   value 'W'.
  7217         16  CS-LF-REFUND-METHOD           PIC X.
  7218         16  CS-AH-REFUND-METHOD           PIC X.
  7219         16  FILLER                        PIC X(353). *> was 420
  7220*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 137
* EL130.cbl
  7222
  7223 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7224                          CONTROL-FILE CERTIFICATE-MASTER
  7225                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7226                          BENEFICIARY-MASTER
  7227                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7228                          LETTER-ARCHIVE REINSURANCE-RECORD
  7229                          MAILING-DATA CERTIFICATE-TRAILERS.
  7230 0000-DFHEXIT SECTION.
  7231     MOVE '9#                    $   ' TO DFHEIV0.
  7232     MOVE 'EL130' TO DFHEIV1.
  7233     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7234     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7235     MOVE '5'                    TO DC-OPTION-CODE.
  7236     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7237     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7238     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7239
  7240     IF EIBCALEN = ZERO
  7241         GO TO 8800-UNAUTHORIZED-ACCESS
  7242     END-IF.
  7243
  7244     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7245     MOVE EIBTRMID               TO QID-TERM.
  7246     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7247     move spaces                 to emi-error-lines
  7248     MOVE '2'                    TO EMI-SWITCH2.
  7249     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7250     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7251
  7252
  7253* EXEC CICS HANDLE CONDITION
  7254*        QIDERR     (0100-TEST-ENTRY)
  7255*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7256*        PGMIDERR   (9600-PGMID-ERROR)
  7257*        TERMIDERR  (8820-TERM-ERROR)
  7258*        TRANSIDERR (8830-TRAN-ERROR)
  7259*        ERROR      (9990-ABEND)
  7260*    END-EXEC.
  7261*    MOVE '"$N?L[\.              ! " #00007248' TO DFHEIV0
  7262     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7264     MOVE X'2220233030303037323438' TO DFHEIV0(25:11)
  7265     CALL 'kxdfhei1' USING DFHEIV0
  7266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7267
  7268
  7269     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7270        PI-CALLING-PROGRAM   = XCTL-6592
  7271         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7272     ELSE
  7273         MOVE SPACES             TO RETURNED-FROM
  7274     END-IF.
  7275
  7276     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7277         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7278             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7279             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 138
* EL130.cbl
  7280             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7281             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7282             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7283             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7284             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7285             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7286         ELSE
  7287             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7288             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7289             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7290             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7291             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7292             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7293             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7294             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7295         END-IF
  7296     END-IF.
  7297
  7298     IF EIBTRNID = TRANS-ID
  7299         IF EIBAID = DFHCLEAR
  7300             GO TO 9400-CLEAR
  7301         ELSE
  7302             GO TO 0200-RECEIVE
  7303         END-IF
  7304     END-IF.
  7305
  7306     IF RETURNED-FROM NOT = SPACES
  7307         GO TO 0600-RECOVER-TEMP-STORAGE
  7308     END-IF.
  7309
  7310     MOVE LOW-VALUES TO EL130AO.
  7311     move zeros to pi-dcc-max-amt
  7312                   pi-dcc-max-benefits
  7313
  7314
  7315
  7316* EXEC CICS DELETEQ TS
  7317*         QUEUE   (QID)
  7318*    END-EXEC.
  7319*    MOVE '*&                    #   #00007303' TO DFHEIV0
  7320     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7321     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7322     MOVE X'2020233030303037333033' TO DFHEIV0(25:11)
  7323     CALL 'kxdfhei1' USING DFHEIV0,
  7324           QID,
  7325           DFHEIV99
  7326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7327
  7328
  7329 0100-TEST-ENTRY.
  7330     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7331         GO TO 0650-FROM-EL127
  7332     ELSE
  7333         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7334                                    PI-CERT-PROCESSED
  7335                                    PI-LETTER-ERROR-CODE
  7336     END-IF.
  7337
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 139
* EL130.cbl
  7338     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7339         GO TO 0640-FROM-EL132
  7340     END-IF.
  7341
  7342     GO TO 8100-SEND-INITIAL-MAP.
  7343
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 140
* EL130.cbl
  7345 0200-RECEIVE.
  7346     MOVE LOW-VALUES             TO EL130AI.
  7347
  7348     IF PI-PROCESSOR-ID = 'LGXX'
  7349*        NEXT SENTENCE
  7350         CONTINUE
  7351     ELSE
  7352
  7353* EXEC CICS READQ TS
  7354*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7355*            INTO    (SECURITY-CONTROL)
  7356*            LENGTH  (SC-COMM-LENGTH)
  7357*            ITEM    (SC-ITEM)
  7358*        END-EXEC
  7359*    MOVE '*$II   L              ''   #00007330' TO DFHEIV0
  7360     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7361     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7362     MOVE X'2020233030303037333330' TO DFHEIV0(25:11)
  7363     CALL 'kxdfhei1' USING DFHEIV0,
  7364           PI-SECURITY-TEMP-STORE-ID,
  7365           SECURITY-CONTROL,
  7366           SC-COMM-LENGTH,
  7367           SC-ITEM,
  7368           DFHEIV99,
  7369           DFHEIV99
  7370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7371         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7372         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7373         IF NOT DISPLAY-CAP
  7374             MOVE 'READ'              TO  SM-READ
  7375             PERFORM 9995-SECURITY-VIOLATION
  7376             MOVE ER-0070             TO  EMI-ERROR
  7377             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7378             GO TO 8100-SEND-INITIAL-MAP
  7379         END-IF
  7380     END-IF.
  7381
  7382     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7383         MOVE ER-7008 TO EMI-ERROR
  7384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7385         MOVE -1 TO MAINTL
  7386         GO TO 8200-SEND-DATAONLY
  7387     END-IF.
  7388
  7389
  7390
  7391* EXEC CICS RECEIVE
  7392*         MAP     (MAP-NAME)
  7393*         MAPSET  (MAPSET-NAME)
  7394*         INTO    (EL130AI)
  7395*    END-EXEC.
  7396     MOVE LENGTH OF
  7397      EL130AI
  7398       TO DFHEIV11
  7399*    MOVE '8"T I  L              ''   #00007355' TO DFHEIV0
  7400     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7401     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7402     MOVE X'2020233030303037333535' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 141
* EL130.cbl
  7403     CALL 'kxdfhei1' USING DFHEIV0,
  7404           MAP-NAME,
  7405           EL130AI,
  7406           DFHEIV11,
  7407           MAPSET-NAME,
  7408           DFHEIV99,
  7409           DFHEIV99
  7410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7411
  7412
  7413     IF NOT PI-NO-CARRIER-SECURITY
  7414        MOVE +1                  TO CLMCARRL
  7415        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7416     END-IF.
  7417
  7418     IF ENTERPFL = ZERO
  7419         GO TO 0300-CHECK-PFKEYS
  7420     END-IF.
  7421
  7422     IF EIBAID NOT = DFHENTER
  7423         MOVE ER-0004            TO EMI-ERROR
  7424         GO TO 0320-INPUT-ERROR
  7425     END-IF.
  7426
  7427     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7428         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7429     ELSE
  7430         MOVE ER-0029            TO EMI-ERROR
  7431         GO TO 0320-INPUT-ERROR
  7432     END-IF.
  7433
  7434 0300-CHECK-PFKEYS.
  7435     IF EIBAID = DFHPF23
  7436         GO TO 8810-PF23
  7437     END-IF.
  7438
  7439     IF EIBAID = DFHPF24
  7440         GO TO 9200-RETURN-MAIN-MENU
  7441     END-IF.
  7442
  7443     IF EIBAID = DFHPF12
  7444         GO TO 9500-PF12
  7445     END-IF.
  7446
  7447     IF EIBAID = DFHPF3
  7448         MOVE SPACES              TO MAINTI
  7449         MOVE ZEROS               TO MAINTL
  7450         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7451         MOVE XCTL-127            TO PGM-NAME
  7452         GO TO 9300-XCTL
  7453     END-IF.
  7454
  7455     IF EIBAID = DFHPF4
  7456         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7457         MOVE XCTL-132            TO PGM-NAME
  7458         GO TO 9300-XCTL
  7459     END-IF.
  7460
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 142
* EL130.cbl
  7461     IF EIBAID = DFHPF13
  7462         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7463             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7464             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7465             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7466             MOVE PI-STATE            TO  PI-CR-STATE
  7467             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7468             MOVE XCTL-650            TO  PGM-NAME
  7469             GO TO 9300-XCTL
  7470         ELSE
  7471             MOVE -1                  TO  ENTERPFL
  7472             MOVE ER-2566             TO  EMI-ERROR
  7473             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7474             GO TO 8100-SEND-INITIAL-MAP
  7475         END-IF
  7476     END-IF.
  7477
  7478     IF EIBAID = DFHPF5
  7479         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7480             ADD +1 TO PI-CERT-PROCESSED
  7481             GO TO 0650-FROM-EL127
  7482         ELSE
  7483             MOVE ER-7686         TO EMI-ERROR
  7484             GO TO 0320-INPUT-ERROR
  7485         END-IF
  7486     END-IF.
  7487
  7488     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7489         GO TO 0800-TEST-PREVIOUS-CONTROL
  7490     END-IF.
  7491
  7492     IF PI-HAS-CLAS-IC-CRDTCRD
  7493         IF EIBAID = DFHPF10
  7494             MOVE XCTL-725          TO PGM-NAME
  7495             GO TO 9300-XCTL
  7496         END-IF
  7497     END-IF.
  7498
  7499     IF EIBAID = DFHPF14
  7500         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7501         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7502         MOVE XCTL-659            TO PGM-NAME
  7503         GO TO 9300-XCTL
  7504     END-IF.
  7505
  7506     IF EIBAID = DFHPF15
  7507         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7508         MOVE XCTL-114            TO PGM-NAME
  7509         GO TO 9300-XCTL
  7510     END-IF.
  7511
  7512*    IF EIBAID = DFHPF11
  7513*       GO TO 0600-RECOVER-TEMP-STORAGE
  7514*    END-IF
  7515     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7516         GO TO 0330-EDIT-DATA
  7517     END-IF.
  7518
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 143
* EL130.cbl
  7519     MOVE ER-0029                TO EMI-ERROR.
  7520
  7521 0320-INPUT-ERROR.
  7522     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7523
  7524     MOVE AL-UNBON               TO ENTERPFA.
  7525
  7526     IF ENTERPFL = ZERO
  7527         MOVE -1                 TO MAINTL
  7528     ELSE
  7529         MOVE -1                 TO ENTERPFL
  7530     END-IF.
  7531
  7532     GO TO 8200-SEND-DATAONLY.
  7533
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 144
* EL130.cbl
  7535 0330-EDIT-DATA.
  7536
  7537     IF MAINTI = 'S'
  7538         IF PRTOPTL GREATER THAN 0
  7539             IF PRTOPTI NOT = 'N' AND 'L'
  7540                 MOVE AL-UABON   TO  PRTOPTA
  7541                 MOVE -1         TO  PRTOPTL
  7542                 MOVE ER-0334    TO  EMI-ERROR
  7543                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7544                 GO TO 8200-SEND-DATAONLY
  7545             ELSE
  7546                 IF PRTOPTI = 'L'
  7547                     GO TO 0400-CREATE-ELACTQ
  7548                 ELSE
  7549                     GO TO 0480-PRINT-NOW
  7550                 END-IF
  7551             END-IF
  7552         ELSE
  7553             GO TO 1000-SHOW-CLAIM
  7554         END-IF
  7555     END-IF.
  7556
  7557     IF NOT MODIFY-CAP
  7558         MOVE 'UPDATE'       TO  SM-READ
  7559         PERFORM 9995-SECURITY-VIOLATION
  7560         MOVE ER-0070        TO  EMI-ERROR
  7561         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7562         GO TO 8100-SEND-INITIAL-MAP
  7563     END-IF.
  7564
  7565     IF MAINTI = 'D'
  7566         GO TO 2000-DELETE-CLAIM
  7567     END-IF.
  7568
  7569     IF MAINTI = 'A'
  7570         GO TO 3000-ADD-CLAIM
  7571     END-IF.
  7572
  7573     IF MAINTI = 'I'
  7574         GO TO 5000-INCURRED-CHANGE
  7575     END-IF.
  7576
  7577     MOVE ER-0023                TO EMI-ERROR.
  7578     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7579     MOVE -1                     TO MAINTL.
  7580     MOVE AL-UABON               TO MAINTA.
  7581
  7582     GO TO 8200-SEND-DATAONLY.
  7583
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 145
* EL130.cbl
  7585 0400-CREATE-ELACTQ.
  7586     IF CLMNOI   = PI-LAST-CLAIM      AND
  7587        CLMCARRI = PI-LAST-CARR       AND
  7588        CERTNOI  = PI-LAST-CERT-PRIME AND
  7589        SUFXI    = PI-LAST-CERT-SUFX
  7590         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7591         MOVE PI-LAST-CARR       TO PI-CARRIER
  7592         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7593     ELSE
  7594         MOVE ER-0207            TO EMI-ERROR
  7595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7596         MOVE -1                 TO MAINTL
  7597         GO TO 8200-SEND-DATAONLY
  7598     END-IF.
  7599
  7600     IF (NOT PI-NO-CARRIER-SECURITY OR
  7601         NOT PI-NO-ACCOUNT-SECURITY)
  7602         MOVE AL-UABON      TO  PRTOPTA
  7603         MOVE -1            TO  PRTOPTL
  7604         MOVE ER-2378       TO  EMI-ERROR
  7605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7606         GO TO 8200-SEND-DATAONLY
  7607     END-IF.
  7608
  7609     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7610     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7611     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7612     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7613
  7614
  7615
  7616* EXEC CICS HANDLE CONDITION
  7617*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7618*    END-EXEC.
  7619*    MOVE '"$I                   ! # #00007563' TO DFHEIV0
  7620     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7622     MOVE X'2320233030303037353633' TO DFHEIV0(25:11)
  7623     CALL 'kxdfhei1' USING DFHEIV0
  7624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7625
  7626
  7627
  7628
  7629* EXEC CICS READ
  7630*         UPDATE
  7631*         DATASET    (ELACTQ-DSID)
  7632*         SET        (ADDRESS OF ACTIVITY-QUE)
  7633*         RIDFLD     (ELACTQ-KEY)
  7634*    END-EXEC.
  7635*    MOVE '&"S        EU         (   #00007568' TO DFHEIV0
  7636     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7637     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7638     MOVE X'2020233030303037353638' TO DFHEIV0(25:11)
  7639     CALL 'kxdfhei1' USING DFHEIV0,
  7640           ELACTQ-DSID,
  7641           DFHEIV20,
  7642           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 146
* EL130.cbl
  7643           ELACTQ-KEY,
  7644           DFHEIV99,
  7645           DFHEIV99,
  7646           DFHEIV99
  7647     SET ADDRESS OF ACTIVITY-QUE TO
  7648         DFHEIV20
  7649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7650
  7651
  7652     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7653     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7654
  7655
  7656
  7657* EXEC CICS REWRITE
  7658*         DATASET     (ELACTQ-DSID)
  7659*         FROM        (ACTIVITY-QUE)
  7660*    END-EXEC.
  7661     MOVE LENGTH OF
  7662      ACTIVITY-QUE
  7663       TO DFHEIV11
  7664*    MOVE '&& L                  %   #00007579' TO DFHEIV0
  7665     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7666     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7667     MOVE X'2020233030303037353739' TO DFHEIV0(25:11)
  7668     CALL 'kxdfhei1' USING DFHEIV0,
  7669           ELACTQ-DSID,
  7670           ACTIVITY-QUE,
  7671           DFHEIV11,
  7672           DFHEIV99
  7673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7674
  7675
  7676     GO TO 0470-STATUS-FINISH.
  7677
  7678 0450-ADD-ELACTQ-RECORD.
  7679
  7680
  7681* EXEC CICS GETMAIN
  7682*        SET     (ADDRESS OF ACTIVITY-QUE)
  7683*        LENGTH  (ELACTQ-LENGTH)
  7684*        INITIMG (GETMAIN-SPACE)
  7685*    END-EXEC.
  7686*    MOVE ',"IL                  $   #00007588' TO DFHEIV0
  7687     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7688     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7689     MOVE X'2020233030303037353838' TO DFHEIV0(25:11)
  7690     CALL 'kxdfhei1' USING DFHEIV0,
  7691           DFHEIV20,
  7692           ELACTQ-LENGTH,
  7693           GETMAIN-SPACE
  7694     SET ADDRESS OF ACTIVITY-QUE TO
  7695         DFHEIV20
  7696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7697
  7698
  7699     MOVE 'AQ'              TO AQ-RECORD-ID.
  7700     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 147
* EL130.cbl
  7701     MOVE +0                TO AQ-PAYMENT-COUNTER
  7702                               AQ-PMT-UNAPPROVED-COUNT.
  7703     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7704                               AQ-FOLLOWUP-DATE.
  7705     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7706     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7707
  7708
  7709
  7710* EXEC CICS WRITE
  7711*         DATASET     (ELACTQ-DSID)
  7712*         FROM        (ACTIVITY-QUE)
  7713*         RIDFLD      (ELACTQ-KEY)
  7714*    END-EXEC.
  7715     MOVE LENGTH OF
  7716      ACTIVITY-QUE
  7717       TO DFHEIV11
  7718*    MOVE '&$ L                  ''   #00007604' TO DFHEIV0
  7719     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7720     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7721     MOVE X'2020233030303037363034' TO DFHEIV0(25:11)
  7722     CALL 'kxdfhei1' USING DFHEIV0,
  7723           ELACTQ-DSID,
  7724           ACTIVITY-QUE,
  7725           DFHEIV11,
  7726           ELACTQ-KEY,
  7727           DFHEIV99,
  7728           DFHEIV99
  7729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7730
  7731
  7732 0470-STATUS-FINISH.
  7733     MOVE AL-UANOF               TO  PRTOPTA
  7734                                     ALTPRTA.
  7735
  7736     MOVE SPACES                 TO  PRTOPTO
  7737                                     ALTPRTO.
  7738
  7739     MOVE ER-0000                TO EMI-ERROR.
  7740     MOVE -1                     TO MAINTL.
  7741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7742     GO TO 8100-SEND-INITIAL-MAP.
  7743
  7744 0480-PRINT-NOW.
  7745
  7746
  7747* EXEC CICS HANDLE CONDITION
  7748*        TERMIDERR   (8820-TERM-ERROR)
  7749*        TRANSIDERR  (8830-TRAN-ERROR)
  7750*    END-EXEC.
  7751*    MOVE '"$[\                  ! $ #00007624' TO DFHEIV0
  7752     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7754     MOVE X'2420233030303037363234' TO DFHEIV0(25:11)
  7755     CALL 'kxdfhei1' USING DFHEIV0
  7756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7757
  7758
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 148
* EL130.cbl
  7759     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7760     MOVE '1'                    TO  CNTL-REC-TYPE.
  7761     MOVE SPACES                 TO  CNTL-ACCESS.
  7762     MOVE +0                     TO  CNTL-SEQ-NO.
  7763     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7764
  7765     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7766
  7767     IF CF-FORMS-PRINTER-ID = SPACES
  7768         IF ALTPRTL NOT GREATER THAN 0
  7769             MOVE ER-0337        TO  EMI-ERROR
  7770             MOVE -1             TO  ALTPRTL
  7771             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7772             GO TO 8200-SEND-DATAONLY
  7773         END-IF
  7774     END-IF.
  7775
  7776     IF ALTPRTL GREATER THAN 0
  7777         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7778     END-IF.
  7779
  7780     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7781     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7782     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7783
  7784
  7785
  7786* EXEC CICS START
  7787*        TRANSID   (START-TRANS-ID)
  7788*        TERMID    (CF-FORMS-PRINTER-ID)
  7789*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7790*        LENGTH    (PI-COMM-LENGTH)
  7791*    END-EXEC.
  7792*    MOVE '0( LFT                1   #00007655' TO DFHEIV0
  7793     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7794     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7795     MOVE X'2020233030303037363535' TO DFHEIV0(25:11)
  7796     CALL 'kxdfhei1' USING DFHEIV0,
  7797           DFHEIV99,
  7798           START-TRANS-ID,
  7799           DFHEIV99,
  7800           PROGRAM-INTERFACE-BLOCK,
  7801           PI-COMM-LENGTH,
  7802           CF-FORMS-PRINTER-ID,
  7803           DFHEIV99,
  7804           DFHEIV99,
  7805           DFHEIV99,
  7806           DFHEIV99,
  7807           DFHEIV99,
  7808           DFHEIV99,
  7809           DFHEIV99,
  7810           DFHEIV99,
  7811           DFHEIV99,
  7812           DFHEIV99
  7813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7814
  7815
  7816     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 149
* EL130.cbl
  7817                                     ALTPRTA.
  7818
  7819     MOVE SPACES                 TO  PRTOPTO
  7820                                     ALTPRTO.
  7821
  7822     MOVE ER-0000                TO  EMI-ERROR.
  7823     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7824     MOVE -1                     TO  MAINTL.
  7825     GO TO 8100-SEND-INITIAL-MAP.
  7826
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 150
* EL130.cbl
  7828 0500-CREATE-TEMP-STORAGE.
  7829     MOVE EIBCPOSN               TO PI-CURSOR.
  7830
  7831    move emi-line1               to errmsg1o
  7832    move emi-line2               to errmsg2o
  7833    move emi-sub                 to pi-emi-sub
  7834
  7835
  7836* EXEC CICS WRITEQ TS
  7837*        QUEUE   (QID)
  7838*        FROM    (EL130AI)
  7839*        LENGTH  (QID-MAP-LENGTH)
  7840*    END-EXEC.
  7841*    MOVE '*"     L              ''   #00007681' TO DFHEIV0
  7842     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7843     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7844     MOVE X'2020233030303037363831' TO DFHEIV0(25:11)
  7845     CALL 'kxdfhei1' USING DFHEIV0,
  7846           QID,
  7847           EL130AI,
  7848           QID-MAP-LENGTH,
  7849           DFHEIV99,
  7850           DFHEIV99,
  7851           DFHEIV99
  7852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7853
  7854
  7855
  7856
  7857* EXEC CICS WRITEQ TS
  7858*        QUEUE    (QID)
  7859*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7860*        LENGTH   (PI-COMM-LENGTH)
  7861*    END-EXEC.
  7862*    MOVE '*"     L              ''   #00007688' TO DFHEIV0
  7863     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7864     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7865     MOVE X'2020233030303037363838' TO DFHEIV0(25:11)
  7866     CALL 'kxdfhei1' USING DFHEIV0,
  7867           QID,
  7868           PROGRAM-INTERFACE-BLOCK,
  7869           PI-COMM-LENGTH,
  7870           DFHEIV99,
  7871           DFHEIV99,
  7872           DFHEIV99
  7873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7874
  7875
  7876 0599-EXIT.
  7877      EXIT.
  7878
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 151
* EL130.cbl
  7880 0600-RECOVER-TEMP-STORAGE.
  7881     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7882     MOVE PI-EL127-TO-EL130-CNTRL
  7883                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7884     MOVE PI-EL659-TO-EL130-CNTRL
  7885                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7886     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7887     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7888     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7889     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7890     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7891     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7892     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7893     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7894     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7895     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7896     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7897     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7898     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7899     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7900     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7901     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7902                                 TO SAVE-BENEFICIARY
  7903
  7904
  7905
  7906* EXEC CICS HANDLE CONDITION
  7907*        NOTFND  (0660-NOT-FOUND)
  7908*        QIDERR  (0670-QIDERR)
  7909*    END-EXEC.
  7910*    MOVE '"$IN                  ! % #00007723' TO DFHEIV0
  7911     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7913     MOVE X'2520233030303037373233' TO DFHEIV0(25:11)
  7914     CALL 'kxdfhei1' USING DFHEIV0
  7915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7916
  7917
  7918
  7919
  7920* EXEC CICS READQ TS
  7921*        QUEUE    (QID)
  7922*        INTO     (EL130AI)
  7923*        LENGTH   (QID-MAP-LENGTH)
  7924*    END-EXEC.
  7925*    MOVE '*$I    L              ''   #00007729' TO DFHEIV0
  7926     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7927     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7928     MOVE X'2020233030303037373239' TO DFHEIV0(25:11)
  7929     CALL 'kxdfhei1' USING DFHEIV0,
  7930           QID,
  7931           EL130AI,
  7932           QID-MAP-LENGTH,
  7933           DFHEIV99,
  7934           DFHEIV99,
  7935           DFHEIV99
  7936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7937
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 152
* EL130.cbl
  7938
  7939     IF RETURNED-FROM = XCTL-131
  7940        IF CLAIM-DELETED-BY-EL131
  7941            MOVE LOW-VALUES      TO CERTNOI
  7942                                    SUFXI
  7943            MOVE ZEROS           TO CERTNOL
  7944                                    SUFXL
  7945         END-IF
  7946     END-IF.
  7947
  7948     IF RETURNED-FROM = XCTL-131
  7949         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7950         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7951                                    PI-CERT-PROCESSED
  7952     ELSE
  7953
  7954
  7955* EXEC CICS READQ TS
  7956*             QUEUE   (QID)
  7957*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7958*             LENGTH  (PI-COMM-LENGTH)
  7959*        END-EXEC
  7960*    MOVE '*$I    L              ''   #00007750' TO DFHEIV0
  7961     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7962     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7963     MOVE X'2020233030303037373530' TO DFHEIV0(25:11)
  7964     CALL 'kxdfhei1' USING DFHEIV0,
  7965           QID,
  7966           PROGRAM-INTERFACE-BLOCK,
  7967           PI-COMM-LENGTH,
  7968           DFHEIV99,
  7969           DFHEIV99,
  7970           DFHEIV99
  7971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7972     END-IF.
  7973
  7974
  7975* EXEC CICS DELETEQ TS
  7976*        QUEUE   (QID)
  7977*    END-EXEC.
  7978*    MOVE '*&                    #   #00007757' TO DFHEIV0
  7979     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7980     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7981     MOVE X'2020233030303037373537' TO DFHEIV0(25:11)
  7982     CALL 'kxdfhei1' USING DFHEIV0,
  7983           QID,
  7984           DFHEIV99
  7985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7986
  7987
  7988     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7989
  7990     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7991         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7992         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7993         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7994         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7995         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 153
* EL130.cbl
  7996         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7997         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7998         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7999         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  8000         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  8001         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  8002         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  8003         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  8004         MOVE SAVE-CERT-ACCESS-CONTROL
  8005                                    TO PI-CERT-ACCESS-CONTROL
  8006         MOVE SAVE-CARRIER-CONTROL-LEVEL
  8007                                    TO PI-CARRIER-CONTROL-LEVEL
  8008     END-IF.
  8009
  8010*    IF EIBAID = DFHPF11
  8011*       move errmsg1i            to emi-line1
  8012*       move errmsg2i            to emi-line2
  8013*       move pi-emi-sub          to emi-sub
  8014*       go to 8200-SEND-DATAONLY
  8015*    end-if
  8016     IF RETURNED-FROM = XCTL-127
  8017         MOVE SAVE-EL127-TO-EL130-CNTRL
  8018                                 TO PI-EL127-TO-EL130-CNTRL
  8019     END-IF.
  8020
  8021     IF RETURNED-FROM = XCTL-6592
  8022        MOVE SAVE-EL659-TO-EL130-CNTRL
  8023                                 TO PI-EL659-TO-EL130-CNTRL
  8024     END-IF.
  8025
  8026     IF RETURNED-FROM = XCTL-114
  8027        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  8028           MOVE SAVE-BENEFICIARY TO BENECDI
  8029           MOVE +10              TO BENECDL
  8030           MOVE -1               TO BIRTHDTL
  8031        END-IF
  8032     END-IF.
  8033     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  8034
  8035     IF MAINTL NOT = ZERO
  8036         MOVE AL-UANON           TO MAINTA
  8037     END-IF.
  8038
  8039     IF ENTERPFL NOT = ZERO
  8040         MOVE AL-UNNON           TO ENTERPFA
  8041     END-IF.
  8042
  8043     IF RETURNED-FROM = XCTL-127
  8044         GO TO 0650-FROM-EL127
  8045     END-IF.
  8046
  8047     IF RETURNED-FROM = XCTL-132
  8048         GO TO 0640-FROM-EL132
  8049     END-IF.
  8050
  8051     IF RETURNED-FROM = XCTL-650
  8052         MOVE AL-SABON           TO PF5A
  8053         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 154
* EL130.cbl
  8054     END-IF.
  8055
  8056     IF RETURNED-FROM = XCTL-6592
  8057         GO TO 0630-FROM-EL6592
  8058     END-IF.
  8059
  8060     IF MAINTI = 'S' OR 'I'
  8061        GO TO 1000-SHOW-CLAIM
  8062     END-IF.
  8063
  8064     GO TO 8100-SEND-INITIAL-MAP.
  8065
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 155
* EL130.cbl
  8067 0630-FROM-EL6592.
  8068     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  8069     MOVE PI-EL659-GROUPING      TO GROUPO.
  8070     MOVE PI-EL659-STATE         TO STATEO.
  8071     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  8072
  8073     MOVE AL-UANON               TO CRTCARRA
  8074                                    GROUPA
  8075                                    STATEA
  8076                                    ACCOUNTA.
  8077     GO TO 8100-SEND-INITIAL-MAP.
  8078
  8079 0640-FROM-EL132.
  8080     IF PI-CLAIM-NO = SPACES
  8081         GO TO 0645-NO-CLAIM-SELECTED
  8082     END-IF.
  8083
  8084     MOVE LOW-VALUES             TO EL130AI.
  8085     MOVE 'MSTR'                 TO FILE-SWITCH.
  8086     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8087     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8088     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  8089                                    CLMNOO.
  8090     MOVE AL-UANON               TO CLMNOA.
  8091     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8092
  8093
  8094
  8095* EXEC CICS HANDLE CONDITION
  8096*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8097*    END-EXEC.
  8098*    MOVE '"$I                   ! & #00007867' TO DFHEIV0
  8099     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8101     MOVE X'2620233030303037383637' TO DFHEIV0(25:11)
  8102     CALL 'kxdfhei1' USING DFHEIV0
  8103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8104
  8105
  8106     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8107     MOVE 'X'                    TO CLAIM-SWITCH.
  8108     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8109     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8110     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8111     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8112     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8113     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8114
  8115     MOVE ER-0213                TO EMI-ERROR.
  8116     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8117     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  8118     GO TO 8100-SEND-INITIAL-MAP.
  8119
  8120 0645-NO-CLAIM-SELECTED.
  8121
  8122     IF MAINTI = 'S' OR 'I'
  8123        GO TO 1000-SHOW-CLAIM
  8124     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 156
* EL130.cbl
  8125
  8126     GO TO 8100-SEND-INITIAL-MAP.
  8127
  8128 0650-FROM-EL127.
  8129
  8130     IF PI-CERT-SELECT-CNT GREATER THAN +6
  8131         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  8132                                    PI-CERT-PROCESSED
  8133     END-IF.
  8134
  8135     IF PI-RETURN-TO-PROGRAM = XCTL-727
  8136         MOVE +1                 TO PI-CERT-SELECT-CNT
  8137                                    PI-CERT-PROCESSED
  8138         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8139         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8140         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8141         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8142         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8143         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8144     END-IF.
  8145
  8146     IF PI-CERT-SELECT-CNT = ZERO
  8147         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8148             MOVE CERTNOI        TO PI-CERT-NO
  8149             MOVE SUFXI          TO PI-CERT-SFX
  8150             GO TO 3000-READ-CERT
  8151         ELSE
  8152             GO TO 8100-SEND-INITIAL-MAP
  8153         END-IF
  8154     END-IF.
  8155
  8156     MOVE AL-SABON               TO PF5A.
  8157
  8158     IF PI-CERT-PROCESSED = 1
  8159         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8160     END-IF.
  8161
  8162     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8163     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8164
  8165     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8166     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8167                                 TO CERT-CARRIER
  8168                                    PI-CARRIER.
  8169     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8170                                 TO CERT-GROUPING
  8171                                    PI-GROUPING.
  8172     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8173                                 TO CERT-STATE
  8174                                    PI-STATE.
  8175     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8176                                 TO CERT-ACCOUNT
  8177                                    PI-ACCOUNT.
  8178     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8179                                 TO CERT-EFF-DT
  8180                                    PI-CERT-EFF-DT.
  8181     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8182                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 157
* EL130.cbl
  8183                                    PI-CERT-NO.
  8184
  8185     MOVE 'CERT'                 TO FILE-SWITCH.
  8186     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8187
  8188     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8189     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8190     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8191
  8192     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8193         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8194         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8195         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8196         IF INCURRED-DATE-MATCH
  8197             MOVE ER-7352        TO EMI-ERROR
  8198             MOVE -1             TO CERTNOL
  8199             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8200         ELSE
  8201             IF NO-CLAIMS-FOR-CERT
  8202                 MOVE ER-7353    TO EMI-ERROR
  8203                 MOVE -1         TO CERTNOL
  8204                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8205             ELSE
  8206                 MOVE ER-0558    TO EMI-ERROR
  8207                 MOVE -1         TO CERTNOL
  8208                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8209             END-IF
  8210         END-IF
  8211     END-IF.
  8212
  8213     MOVE SPACES                 TO PI-PRT-OPT
  8214                                    PI-ALT-PRT.
  8215
  8216     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8217
  8218     if (ws-lf-joint-indicator not = 'J')
  8219        and (ws-ah-joint-indicator not = 'J')
  8220        move 'P'                 to INSTYPEO
  8221        MOVE AL-UANON            TO INSTYPEA
  8222     end-if
  8223     IF LSTNMEL NOT GREATER ZERO
  8224        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8225         MOVE CRTLNMEI           TO  LSTNMEO
  8226         MOVE CRTFNMEI           TO  FSTNMEO
  8227         MOVE CRTINITI           TO  INITO
  8228         MOVE AL-UANON           TO  LSTNMEA
  8229                                     FSTNMEA
  8230                                     INITA
  8231     END-IF.
  8232
  8233     IF SSNL GREATER ZERO
  8234         GO TO 0655-SKIP-SOCIAL-SECURITY
  8235     END-IF.
  8236
  8237     IF CRTSSNI = SPACES OR LOW-VALUES
  8238         GO TO 0655-SKIP-SOCIAL-SECURITY
  8239     END-IF.
  8240
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 158
* EL130.cbl
  8241     IF CM-SSN-STATE   = CM-STATE AND
  8242        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8243            GO TO 0655-SKIP-SOCIAL-SECURITY
  8244     END-IF.
  8245
  8246     MOVE CRTSSNI                TO SSNO
  8247     MOVE AL-UANON               TO SSNA.
  8248
  8249 0655-SKIP-SOCIAL-SECURITY.
  8250
  8251     IF CLMCARRL NOT = ZERO  AND
  8252        CLMCARRI NOT = CRTCARRI
  8253        MOVE ER-0562             TO EMI-ERROR
  8254        MOVE AL-UABON            TO CLMCARRA
  8255        MOVE -1                  TO CLMCARRL
  8256        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8257     END-IF.
  8258
  8259     IF CLMCARRL = ZERO
  8260        MOVE AL-UANON            TO CLMCARRA
  8261        MOVE CRTCARRI            TO CLMCARRI
  8262     END-IF.
  8263
  8264     MOVE 'A'                    TO MAINTO.
  8265     MOVE AL-UANON               TO MAINTA.
  8266
  8267     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8268        GO TO 8100-SEND-INITIAL-MAP
  8269     ELSE
  8270        GO TO 8150-SEND-MAP-CURSOR
  8271     END-IF.
  8272
  8273 0660-NOT-FOUND.
  8274     MOVE ER-0214                TO EMI-ERROR.
  8275     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8276     GO TO 8100-SEND-INITIAL-MAP.
  8277
  8278 0670-QIDERR.
  8279     MOVE ER-0033                TO EMI-ERROR.
  8280     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8281     GO TO 8100-SEND-INITIAL-MAP.
  8282
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 159
* EL130.cbl
  8284 0680-PLUG-SELECTED-CERTS.
  8285
  8286     MOVE AL-SANON               TO BCERT1A
  8287                                    BSUFX1A
  8288                                    BCERT2A
  8289                                    BSUFX2A
  8290                                    BCERT3A
  8291                                    BSUFX3A
  8292                                    BCERT4A
  8293                                    BSUFX4A
  8294                                    BCERT5A
  8295                                    BSUFX5A.
  8296
  8297     IF PCERTNOO = SPACES OR LOW-VALUES
  8298         MOVE PI-EL127-CERT-PRIME (1)
  8299                                 TO PCERTNOO
  8300         MOVE PI-EL127-CERT-SUFX  (1)
  8301                                 TO PSUFXO
  8302     END-IF.
  8303
  8304     MOVE PI-EL127-CERT-PRIME (1)
  8305                                 TO BCERT1O.
  8306     MOVE PI-EL127-CERT-SUFX  (1)
  8307                                 TO BSUFX1O.
  8308
  8309     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8310         MOVE PI-EL127-CERT-PRIME (2)
  8311                                 TO BCERT2O
  8312         MOVE PI-EL127-CERT-SUFX  (2)
  8313                                 TO BSUFX2O
  8314     ELSE
  8315         MOVE LOW-VALUES         TO BCERT2O
  8316                                    BSUFX2O
  8317     END-IF.
  8318
  8319     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8320         MOVE PI-EL127-CERT-PRIME (3)
  8321                                 TO BCERT3O
  8322         MOVE PI-EL127-CERT-SUFX  (3)
  8323                                 TO BSUFX3O
  8324     ELSE
  8325         MOVE LOW-VALUES         TO BCERT3O
  8326                                    BSUFX3O
  8327     END-IF.
  8328
  8329     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8330         MOVE PI-EL127-CERT-PRIME (4)
  8331                                 TO BCERT4O
  8332         MOVE PI-EL127-CERT-SUFX  (4)
  8333                                 TO BSUFX4O
  8334     ELSE
  8335         MOVE LOW-VALUES         TO BCERT4O
  8336                                    BSUFX4O
  8337     END-IF.
  8338
  8339     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8340         MOVE PI-EL127-CERT-PRIME (5)
  8341                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 160
* EL130.cbl
  8342         MOVE PI-EL127-CERT-SUFX  (5)
  8343                                 TO BSUFX5O
  8344     ELSE
  8345         MOVE LOW-VALUES         TO BCERT5O
  8346                                    BSUFX5O
  8347     END-IF.
  8348
  8349 0680-EXIT.
  8350     EXIT.
  8351
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 161
* EL130.cbl
  8353 0690-HIGHLIGHT-CERTS.
  8354
  8355     MOVE AL-UANON               TO PCERTNOA
  8356                                    PSUFXA.
  8357
  8358     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8359        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8360            MOVE AL-SABON        TO BCERT1A
  8361                                    BSUFX1A
  8362     ELSE
  8363         MOVE AL-SANON           TO BCERT1A
  8364                                    BSUFX1A
  8365     END-IF.
  8366
  8367     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8368        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8369            MOVE AL-SABON        TO BCERT2A
  8370                                    BSUFX2A
  8371     ELSE
  8372         MOVE AL-SANON           TO BCERT2A
  8373                                    BSUFX2A
  8374     END-IF.
  8375
  8376     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8377        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8378            MOVE AL-SABON        TO BCERT3A
  8379                                    BSUFX3A
  8380     ELSE
  8381         MOVE AL-SANON           TO BCERT3A
  8382                                    BSUFX3A
  8383     END-IF.
  8384
  8385     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8386        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8387            MOVE AL-SABON        TO BCERT4A
  8388                                    BSUFX4A
  8389     ELSE
  8390         MOVE AL-SANON           TO BCERT4A
  8391                                    BSUFX4A
  8392     END-IF.
  8393
  8394     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8395        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8396            MOVE AL-SABON        TO BCERT5A
  8397                                    BSUFX5A
  8398     ELSE
  8399         MOVE AL-SANON           TO BCERT5A
  8400                                    BSUFX5A
  8401     END-IF.
  8402
  8403 0690-EXIT.
  8404     EXIT.
  8405
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 162
* EL130.cbl
  8407 0800-TEST-PREVIOUS-CONTROL.
  8408     IF CLMNOI   = PI-LAST-CLAIM       AND
  8409        CLMCARRI = PI-LAST-CARR        AND
  8410        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8411        SUFXI    = PI-LAST-CERT-SUFX
  8412*        NEXT SENTENCE
  8413         CONTINUE
  8414     ELSE
  8415         MOVE ER-0207            TO EMI-ERROR
  8416         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8417         MOVE -1                 TO MAINTL
  8418         GO TO 8200-SEND-DATAONLY
  8419     END-IF.
  8420
  8421     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8422
  8423     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8424     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8425     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8426
  8427     IF EIBAID = DFHPF7
  8428         MOVE XCTL-157           TO PGM-NAME
  8429     END-IF.
  8430
  8431     IF EIBAID = DFHPF8
  8432         MOVE XCTL-141           TO PGM-NAME
  8433     END-IF.
  8434
  8435     IF EIBAID = DFHPF9
  8436        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8437                                    PI-SAVED-PROGRAM-2
  8438                                    PI-SAVED-PROGRAM-3
  8439                                    PI-SAVED-PROGRAM-4
  8440                                    PI-SAVED-PROGRAM-5
  8441                                    PI-SAVED-PROGRAM-6
  8442        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8443        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8444        MOVE XCTL-150            TO PGM-NAME
  8445     END-IF.
  8446
  8447     GO TO 9300-XCTL.
  8448
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 163
* EL130.cbl
  8450 1000-SHOW-CLAIM.
  8451
  8452     IF CLMNOL = ZERO
  8453         MOVE -1                 TO CLMNOL
  8454         MOVE AL-UABON           TO CLMNOA
  8455         MOVE ER-0202            TO EMI-ERROR
  8456         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8457     ELSE
  8458         MOVE AL-UANON           TO CLMNOA
  8459     END-IF.
  8460
  8461     IF PI-NO-CARRIER-SECURITY
  8462        IF CLMCARRL = ZERO
  8463             MOVE -1             TO CLMCARRL
  8464             MOVE AL-UABON       TO CLMCARRA
  8465             MOVE ER-0194        TO EMI-ERROR
  8466             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8467         ELSE
  8468             MOVE AL-UANON       TO CLMCARRA
  8469         END-IF
  8470     END-IF.
  8471
  8472     IF SUFXL = ZERO
  8473         MOVE SPACES             TO SUFXI
  8474         MOVE AL-UANON           TO SUFXA
  8475     ELSE
  8476         MOVE AL-UANON           TO SUFXA
  8477     END-IF.
  8478
  8479     IF NOT EMI-NO-ERRORS
  8480         GO TO 1050-SEND-CHECK
  8481     END-IF.
  8482
  8483
  8484
  8485* EXEC CICS HANDLE CONDITION
  8486*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8487*    END-EXEC.
  8488*    MOVE '"$I                   ! '' #00008249' TO DFHEIV0
  8489     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8491     MOVE X'2720233030303038323439' TO DFHEIV0(25:11)
  8492     CALL 'kxdfhei1' USING DFHEIV0
  8493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8494
  8495
  8496     MOVE 'MSTR'                 TO FILE-SWITCH
  8497     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8498
  8499     MOVE CLMCARRI               TO MSTR-CARRIER.
  8500     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8501
  8502     IF CERTNOL = ZERO     OR
  8503        CERTNOI = SPACES   OR
  8504        CERTNOI = LOW-VALUES
  8505         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8506         MOVE AL-SANON        TO CERTNOA
  8507                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 164
* EL130.cbl
  8508     ELSE
  8509         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8510     END-IF.
  8511
  8512     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8513     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8514
  8515
  8516
  8517* EXEC CICS HANDLE CONDITION
  8518*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8519*    END-EXEC.
  8520*    MOVE '"$I                   ! ( #00008273' TO DFHEIV0
  8521     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8523     MOVE X'2820233030303038323733' TO DFHEIV0(25:11)
  8524     CALL 'kxdfhei1' USING DFHEIV0
  8525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8526
  8527
  8528     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8529
  8530     IF NOT PI-NO-ACCOUNT-SECURITY
  8531         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8532           MOVE ER-2371          TO EMI-ERROR
  8533           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8534           MOVE -1               TO MAINTL
  8535           GO TO 8200-SEND-DATAONLY
  8536         END-IF
  8537     END-IF.
  8538
  8539
  8540
  8541* EXEC CICS HANDLE CONDITION
  8542*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8543*    END-EXEC.
  8544*    MOVE '"$I                   ! ) #00008289' TO DFHEIV0
  8545     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8547     MOVE X'2920233030303038323839' TO DFHEIV0(25:11)
  8548     CALL 'kxdfhei1' USING DFHEIV0
  8549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8550
  8551
  8552     MOVE 'Y'                    TO CLAIM-SWITCH.
  8553     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8554     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8555     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8556     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8557     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8558
  8559 1000-SHOW-END-OF-PERFORM.
  8560
  8561     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8562     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8563     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8564     MOVE CL-CERT-STATE          TO CERT-STATE.
  8565     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 165
* EL130.cbl
  8566     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8567     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8568
  8569     MOVE 'CERT'                 TO FILE-SWITCH.
  8570
  8571     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8572
  8573     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8574     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8575     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8576     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8577     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8578     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8579     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8580     MOVE CLMCARRI               TO PI-LAST-CARR.
  8581
  8582     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8583
  8584     IF MAINTI = 'I'
  8585         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8586                 BIRTHDTA  LSTNMEA   RELCLMA
  8587                 LOANNOA   LOANBALA  BENECDA
  8588         MOVE AL-SANON TO  SSNA
  8589         MOVE SPACES   TO  INCURI    REPORTI
  8590         MOVE 'Y'      TO PI-INCURR-SW
  8591         MOVE ER-0522  TO EMI-ERROR
  8592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8593     ELSE
  8594         MOVE ' '      TO PI-INCURR-SW
  8595     END-IF.
  8596
  8597     MOVE -1                     TO MAINTL.
  8598     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8599     MOVE CERT-GROUPING          TO PI-GROUPING.
  8600     MOVE CERT-STATE             TO PI-STATE.
  8601     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8602     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8603     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8604     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8605
  8606     IF RETURNED-FROM NOT = SPACES
  8607         GO TO 8100-SEND-INITIAL-MAP
  8608     ELSE
  8609         GO TO 8200-SEND-DATAONLY
  8610     END-IF.
  8611
  8612 1025-SHOW-RECORD-NOT-FOUND.
  8613
  8614     IF FILE-SWITCH = 'MSTR'
  8615         MOVE ER-0204            TO EMI-ERROR
  8616     ELSE
  8617         IF FILE-SWITCH = 'TRLR'
  8618             MOVE ER-0205        TO EMI-ERROR
  8619         ELSE
  8620             MOVE ER-0206        TO EMI-ERROR
  8621         END-IF
  8622     END-IF.
  8623
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 166
* EL130.cbl
  8624     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8625
  8626 1050-SEND-CHECK.
  8627
  8628     IF RETURNED-FROM NOT = SPACES
  8629         GO TO 8100-SEND-INITIAL-MAP
  8630     ELSE
  8631         MOVE -1                 TO MAINTL
  8632         GO TO 8200-SEND-DATAONLY
  8633     END-IF.
  8634
  8635 2000-DELETE-CLAIM.
  8636     IF NOT MODIFY-CAP
  8637         MOVE ER-0070            TO EMI-ERROR
  8638         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8639         MOVE -1                 TO MAINTL
  8640         GO TO 8200-SEND-DATAONLY
  8641     END-IF.
  8642
  8643     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8644        CLMCARRI NOT = PI-LAST-CARR        OR
  8645        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8646        SUFXI    NOT = PI-LAST-CERT-SUFX
  8647         MOVE ER-0207            TO EMI-ERROR
  8648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8649         MOVE -1                 TO MAINTL
  8650         GO TO 8200-SEND-DATAONLY
  8651     END-IF.
  8652
  8653
  8654
  8655* EXEC CICS HANDLE CONDITION
  8656*        NOTFND   (2050-DELETE-NOT-FOUND)
  8657*    END-EXEC.
  8658*    MOVE '"$I                   ! * #00008395' TO DFHEIV0
  8659     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8660     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8661     MOVE X'2A20233030303038333935' TO DFHEIV0(25:11)
  8662     CALL 'kxdfhei1' USING DFHEIV0
  8663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8664
  8665
  8666     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8667
  8668     MOVE CLMCARRI               TO MSTR-CARRIER.
  8669     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8670     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8671     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8672
  8673     MOVE 'MSTR'                 TO FILE-SWITCH.
  8674     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8675
  8676     MOVE 'Y'                    TO CLAIM-SWITCH.
  8677
  8678     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8679        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8680         MOVE ER-0068        TO EMI-ERROR
  8681         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 167
* EL130.cbl
  8682         MOVE -1             TO MAINTL
  8683         GO TO 8200-SEND-DATAONLY
  8684     END-IF.
  8685
  8686     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8687         MOVE ER-0569            TO EMI-ERROR
  8688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8689         MOVE -1                 TO MAINTL
  8690         GO TO 8200-SEND-DATAONLY
  8691     END-IF.
  8692
  8693     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8694         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8695     END-IF.
  8696
  8697     IF CL-PURGED-DT NOT = LOW-VALUES
  8698         MOVE ER-7691            TO EMI-ERROR
  8699         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8700         MOVE -1                 TO MAINTL
  8701         GO TO 8200-SEND-DATAONLY
  8702     END-IF.
  8703
  8704     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8705     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8706     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8707     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8708     MOVE +0                     TO TRLR-SEQ-NO.
  8709     MOVE '1'                    TO TRLR-TYPE.
  8710
  8711     MOVE 'TRLR'                 TO FILE-SWITCH.
  8712
  8713
  8714
  8715* EXEC CICS READ
  8716*        UPDATE
  8717*        DATASET  (ELTRLR-DSID)
  8718*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8719*        RIDFLD   (ELTRLR-KEY)
  8720*    END-EXEC.
  8721*    MOVE '&"S        EU         (   #00008447' TO DFHEIV0
  8722     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8723     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8724     MOVE X'2020233030303038343437' TO DFHEIV0(25:11)
  8725     CALL 'kxdfhei1' USING DFHEIV0,
  8726           ELTRLR-DSID,
  8727           DFHEIV20,
  8728           DFHEIV99,
  8729           ELTRLR-KEY,
  8730           DFHEIV99,
  8731           DFHEIV99,
  8732           DFHEIV99
  8733     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8734         DFHEIV20
  8735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8736
  8737
  8738     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8739        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 168
* EL130.cbl
  8740         MOVE ER-0068        TO EMI-ERROR
  8741         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8742         MOVE -1             TO MAINTL
  8743         GO TO 8200-SEND-DATAONLY
  8744     END-IF.
  8745
  8746
  8747
  8748* EXEC CICS DELETE
  8749*        DATASET   (ELTRLR-DSID)
  8750*    END-EXEC.
  8751*    MOVE '&(                    &   #00008463' TO DFHEIV0
  8752     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8753     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8754     MOVE X'2020233030303038343633' TO DFHEIV0(25:11)
  8755     CALL 'kxdfhei1' USING DFHEIV0,
  8756           ELTRLR-DSID,
  8757           DFHEIV99,
  8758           DFHEIV99,
  8759           DFHEIV99,
  8760           DFHEIV99
  8761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8762
  8763
  8764     MOVE +90                    TO TRLR-SEQ-NO.
  8765     MOVE '6'                    TO TRLR-TYPE.
  8766
  8767
  8768
  8769* EXEC CICS READ
  8770*        UPDATE
  8771*        DATASET  (ELTRLR-DSID)
  8772*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8773*        RIDFLD   (ELTRLR-KEY)
  8774*    END-EXEC.
  8775*    MOVE '&"S        EU         (   #00008471' TO DFHEIV0
  8776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8777     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8778     MOVE X'2020233030303038343731' TO DFHEIV0(25:11)
  8779     CALL 'kxdfhei1' USING DFHEIV0,
  8780           ELTRLR-DSID,
  8781           DFHEIV20,
  8782           DFHEIV99,
  8783           ELTRLR-KEY,
  8784           DFHEIV99,
  8785           DFHEIV99,
  8786           DFHEIV99
  8787     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8788         DFHEIV20
  8789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8790
  8791
  8792
  8793
  8794* EXEC CICS DELETE
  8795*        DATASET   (ELTRLR-DSID)
  8796*    END-EXEC.
  8797*    MOVE '&(                    &   #00008479' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 169
* EL130.cbl
  8798     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8799     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8800     MOVE X'2020233030303038343739' TO DFHEIV0(25:11)
  8801     CALL 'kxdfhei1' USING DFHEIV0,
  8802           ELTRLR-DSID,
  8803           DFHEIV99,
  8804           DFHEIV99,
  8805           DFHEIV99,
  8806           DFHEIV99
  8807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8808
  8809
  8810     MOVE +91                    TO TRLR-SEQ-NO.
  8811     MOVE '6'                    TO TRLR-TYPE.
  8812
  8813
  8814
  8815* EXEC CICS READ
  8816*        UPDATE
  8817*        DATASET  (ELTRLR-DSID)
  8818*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8819*        RIDFLD   (ELTRLR-KEY)
  8820*        RESP     (WS-RESPONSE)
  8821*    END-EXEC
  8822*    MOVE '&"S        EU         (  N#00008487' TO DFHEIV0
  8823     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8824     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8825     MOVE X'204E233030303038343837' TO DFHEIV0(25:11)
  8826     CALL 'kxdfhei1' USING DFHEIV0,
  8827           ELTRLR-DSID,
  8828           DFHEIV20,
  8829           DFHEIV99,
  8830           ELTRLR-KEY,
  8831           DFHEIV99,
  8832           DFHEIV99,
  8833           DFHEIV99
  8834     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8835         DFHEIV20
  8836     MOVE EIBRESP  TO WS-RESPONSE
  8837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8838
  8839     IF WS-RESP-NORMAL
  8840
  8841* EXEC CICS DELETE
  8842*          DATASET   (ELTRLR-DSID)
  8843*       END-EXEC
  8844*    MOVE '&(                    &   #00008496' TO DFHEIV0
  8845     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8846     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8847     MOVE X'2020233030303038343936' TO DFHEIV0(25:11)
  8848     CALL 'kxdfhei1' USING DFHEIV0,
  8849           ELTRLR-DSID,
  8850           DFHEIV99,
  8851           DFHEIV99,
  8852           DFHEIV99,
  8853           DFHEIV99
  8854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8855     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 170
* EL130.cbl
  8856
  8857     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8858     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8859     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8860     MOVE CL-CERT-STATE          TO CERT-STATE.
  8861     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8862     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8863     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8864
  8865     MOVE 'CERT'                 TO FILE-SWITCH.
  8866
  8867     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8868
  8869     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8870
  8871     IF WS-NUM-HOLD NOT = +0
  8872         GO TO 2005-REWRITE-CERT
  8873     END-IF.
  8874
  8875     IF NOT CERT-WAS-CREATED
  8876         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8877         GO TO 2005-REWRITE-CERT
  8878     END-IF.
  8879
  8880
  8881
  8882* EXEC CICS DELETE
  8883*        DATASET   (ELCERT-DSID)
  8884*    END-EXEC.
  8885*    MOVE '&(                    &   #00008525' TO DFHEIV0
  8886     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8887     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8888     MOVE X'2020233030303038353235' TO DFHEIV0(25:11)
  8889     CALL 'kxdfhei1' USING DFHEIV0,
  8890           ELCERT-DSID,
  8891           DFHEIV99,
  8892           DFHEIV99,
  8893           DFHEIV99,
  8894           DFHEIV99
  8895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8896
  8897
  8898     GO TO 2010-DELETE-CL.
  8899
  8900 2005-REWRITE-CERT.
  8901
  8902     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8903
  8904
  8905
  8906* EXEC CICS HANDLE CONDITION
  8907*         DUPKEY   (2010-DELETE-CL)
  8908*    END-EXEC.
  8909*    MOVE '"$$                   ! + #00008536' TO DFHEIV0
  8910     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8912     MOVE X'2B20233030303038353336' TO DFHEIV0(25:11)
  8913     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 171
* EL130.cbl
  8914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8915
  8916
  8917
  8918
  8919* EXEC CICS REWRITE
  8920*        DATASET  (ELCERT-DSID)
  8921*        FROM     (CERTIFICATE-MASTER)
  8922*    END-EXEC.
  8923     MOVE LENGTH OF
  8924      CERTIFICATE-MASTER
  8925       TO DFHEIV11
  8926*    MOVE '&& L                  %   #00008541' TO DFHEIV0
  8927     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8928     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8929     MOVE X'2020233030303038353431' TO DFHEIV0(25:11)
  8930     CALL 'kxdfhei1' USING DFHEIV0,
  8931           ELCERT-DSID,
  8932           CERTIFICATE-MASTER,
  8933           DFHEIV11,
  8934           DFHEIV99
  8935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8936
  8937
  8938 2010-DELETE-CL.
  8939
  8940
  8941
  8942* EXEC CICS DELETE
  8943*        DATASET  (ELMSTR-DSID)
  8944*    END-EXEC.
  8945*    MOVE '&(                    &   #00008549' TO DFHEIV0
  8946     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8947     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8948     MOVE X'2020233030303038353439' TO DFHEIV0(25:11)
  8949     CALL 'kxdfhei1' USING DFHEIV0,
  8950           ELMSTR-DSID,
  8951           DFHEIV99,
  8952           DFHEIV99,
  8953           DFHEIV99,
  8954           DFHEIV99
  8955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8956
  8957
  8958     MOVE -1                     TO ONE-OR-MIN1.
  8959     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8960
  8961     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8962         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8963                                    WS-SAVE-CLAIM-KEY
  8964         MOVE +1                 TO ONE-OR-MIN1
  8965         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8966     END-IF.
  8967
  8968     MOVE ER-0000                TO EMI-ERROR.
  8969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8970     MOVE LOW-VALUES             TO EL130AO.
  8971     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 172
* EL130.cbl
  8972     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8973     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8974                                    PI-CERT-PROCESSED
  8975                                    PI-LETTER-ERROR-CODE.
  8976     GO TO 8100-SEND-INITIAL-MAP.
  8977
  8978 2050-DELETE-NOT-FOUND.
  8979     IF FILE-SWITCH = 'MSTR'
  8980         MOVE -1                 TO CLMNOL
  8981         MOVE ER-0204            TO EMI-ERROR
  8982     ELSE
  8983         IF FILE-SWITCH = 'TRLR'
  8984             MOVE -1             TO MAINTL
  8985             MOVE ER-0205        TO EMI-ERROR
  8986         ELSE
  8987             MOVE -1             TO CERTNOL
  8988             MOVE ER-0206        TO EMI-ERROR
  8989         END-IF
  8990     END-IF.
  8991
  8992     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8993     GO TO 8200-SEND-DATAONLY.
  8994
  8995 3000-ADD-CLAIM.
  8996     IF NOT MODIFY-CAP
  8997         MOVE ER-0070            TO EMI-ERROR
  8998         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8999         MOVE -1                 TO MAINTL
  9000         GO TO 8200-SEND-DATAONLY
  9001     END-IF.
  9002
  9003     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  9004
  9005     IF CERTMTI = 'S'
  9006         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  9007            SUFXI    = PI-SAVE-CERT-SUFX   AND
  9008            WS-EFFDT = PI-SAVE-EFFDT       AND
  9009            ACCOUNTI = PI-SAVE-ACCOUNT
  9010             IF EMI-ERROR = 0
  9011                 GO TO 3010-TEST-FOR-ERRORS
  9012             ELSE
  9013                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  9014                 MOVE PI-CARRIER       TO  CERT-CARRIER
  9015                 MOVE PI-GROUPING      TO  CERT-GROUPING
  9016                 MOVE PI-STATE         TO  CERT-STATE
  9017                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  9018                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  9019                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  9020
  9021
  9022* EXEC CICS HANDLE CONDITION
  9023*                    NOTFND   (3010-TEST-FOR-ERRORS)
  9024*                END-EXEC
  9025*    MOVE '"$I                   ! , #00008616' TO DFHEIV0
  9026     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9028     MOVE X'2C20233030303038363136' TO DFHEIV0(25:11)
  9029     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 173
* EL130.cbl
  9030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9031                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  9032                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  9033                 GO TO 3010-TEST-FOR-ERRORS
  9034             END-IF
  9035         END-IF
  9036     END-IF.
  9037
  9038     IF CERTMTI = 'A'
  9039         IF NOT PI-NO-CARRIER-SECURITY OR
  9040             NOT PI-NO-ACCOUNT-SECURITY
  9041             MOVE ER-2370          TO EMI-ERROR
  9042             MOVE -1               TO MAINTL
  9043             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9044             GO TO 8200-SEND-DATAONLY
  9045         ELSE
  9046             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  9047             GO TO 3010-TEST-FOR-ERRORS
  9048         END-IF
  9049     END-IF.
  9050
  9051     IF CERTNOL = ZEROS
  9052        GO TO 3010-TEST-FOR-ERRORS
  9053     END-IF.
  9054
  9055 3000-READ-CERT.
  9056
  9057     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  9058                                    MSTR5-COMP-CD.
  9059     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  9060                                    MSTR5-CERT-NO-PRIME.
  9061     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  9062                                    MSTR5-CERT-NO-SUFX.
  9063
  9064
  9065
  9066* EXEC CICS HANDLE CONDITION
  9067*         DUPKEY   (3008-DUP-ERROR)
  9068*         NOTFND   (3009-NOT-FOUND)
  9069*    END-EXEC
  9070*    MOVE '"$$I                  ! - #00008653' TO DFHEIV0
  9071     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  9072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9073     MOVE X'2D20233030303038363533' TO DFHEIV0(25:11)
  9074     CALL 'kxdfhei1' USING DFHEIV0
  9075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9076
  9077     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  9078
  9079     IF NOT PI-NO-ACCOUNT-SECURITY
  9080         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  9081             MOVE ER-2371          TO EMI-ERROR
  9082             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9083             MOVE -1               TO MAINTL
  9084             GO TO 8200-SEND-DATAONLY
  9085         END-IF
  9086     END-IF.
  9087
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 174
* EL130.cbl
  9088     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  9089     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  9090     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  9091     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  9092     MOVE CM-CARRIER             TO PI-CARRIER.
  9093     MOVE CM-GROUPING            TO PI-GROUPING.
  9094     MOVE CM-STATE               TO PI-STATE.
  9095     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  9096     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9097     MOVE CM-CERT-NO             TO PI-CERT-NO.
  9098     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  9099
  9100     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  9101         IF LSTNMEO = SPACES OR LOW-VALUES
  9102             MOVE CRTLNMEI       TO  LSTNMEO
  9103             MOVE AL-UANON       TO  LSTNMEA
  9104         END-IF
  9105     END-IF.
  9106
  9107     MOVE 'S'                    TO CERTMTO.
  9108*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  9109     MOVE AL-SANON               TO CERTNOA.
  9110     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  9111                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  9112     IF EMI-NO-ERRORS
  9113         MOVE -1                  TO MAINTL
  9114     END-IF.
  9115
  9116     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9117         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9118         IF INCURRED-DATE-MATCH
  9119             MOVE ER-7352         TO EMI-ERROR
  9120             MOVE -1              TO CERTNOL
  9121             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9122         ELSE
  9123             IF NO-CLAIMS-FOR-CERT
  9124                 MOVE ER-7353     TO EMI-ERROR
  9125                 MOVE -1          TO CERTNOL
  9126                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9127             ELSE
  9128                 MOVE ER-0558     TO EMI-ERROR
  9129                 MOVE -1          TO CERTNOL
  9130                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9131                 GO TO 3010-TEST-FOR-ERRORS
  9132             END-IF
  9133         END-IF
  9134     END-IF.
  9135
  9136 3007-SEND-SCREEN.
  9137     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9138         GO TO 8150-SEND-MAP-CURSOR
  9139     ELSE
  9140         GO TO 8200-SEND-DATAONLY
  9141     END-IF.
  9142
  9143 3008-DUP-ERROR.
  9144     MOVE ER-0560                TO EMI-ERROR.
  9145     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 175
* EL130.cbl
  9146     MOVE -1                     TO CERTNOL.
  9147     GO TO 3007-SEND-SCREEN.
  9148
  9149 3009-NOT-FOUND.
  9150     MOVE ER-0214                TO EMI-ERROR.
  9151     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9152     MOVE -1                     TO CERTNOL.
  9153     GO TO 3007-SEND-SCREEN.
  9154
  9155 3010-TEST-FOR-ERRORS.
  9156
  9157     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9158     perform 6500-get-acct    thru 6500-exit
  9159     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9160*     perform 6500-get-acct    thru 6500-exit
  9161
  9162     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9163     move +0                     to e1
  9164     move spaces                 to ws-dcc-error-line
  9165     move ' '                    to ws-zero-bens-avail
  9166
  9167     if ws-dcc-product-code not = spaces
  9168        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9169        IF ERPDEF-FOUND
  9170           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9171           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9172           MOVE '1'              TO DC-OPTION-CODE
  9173           MOVE +0               TO DC-ELAPSED-MONTHS
  9174                                    DC-ELAPSED-DAYS
  9175           PERFORM 9700-LINK-DATE-CONVERT
  9176                                 THRU 9700-EXIT
  9177           IF NO-CONVERSION-ERROR
  9178              MOVE DC-ELAPSED-MONTHS
  9179                                 TO WS-MONTHS-BETWEEN
  9180              IF DC-ELAPSED-DAYS > 1
  9181                 ADD 1 TO WS-MONTHS-BETWEEN
  9182              END-IF
  9183           ELSE
  9184              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9185           END-IF
  9186
  9187           evaluate true
  9188              when (ws-excl-period not = zeros)
  9189                 and (ws-months-between <= ws-excl-period)
  9190                 MOVE -1         TO MAINTL
  9191                 add +1          to e1
  9192                 move 'Y'        to ws-zero-bens-avail
  9193                 MOVE ER-1651    TO EMI-ERROR
  9194                                    ws-error-no (e1)
  9195                 PERFORM 9900-ERROR-FORMAT
  9196                                 THRU 9900-EXIT
  9197              when (ws-cov-ends not = zeros)
  9198                 and (ws-months-between > ws-cov-ends)
  9199                 MOVE -1         TO MAINTL
  9200                 add +1          to e1
  9201                 move 'Y'        to ws-zero-bens-avail
  9202                 MOVE ER-1653    TO EMI-ERROR
  9203                                    ws-error-no (e1)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 176
* EL130.cbl
  9204                 evaluate true
  9205                    when clmtypei = 'L'
  9206                       move '  LF  ' to emi-claim-type
  9207                    when clmtypei = 'I'
  9208                       move '  IU  ' to emi-claim-type
  9209                    when clmtypei = 'F'
  9210                       move '  FL  ' to emi-claim-type
  9211                    when other
  9212                       move '  AH  ' to emi-claim-type
  9213                 end-evaluate
  9214                 PERFORM 9900-ERROR-FORMAT
  9215                                 THRU 9900-EXIT
  9216              when (ws-acc-period not = zeros)
  9217                 and (ws-months-between <= ws-acc-period)
  9218                 MOVE -1         TO MAINTL
  9219                 add +1          to e1
  9220                 MOVE ER-1652    TO EMI-ERROR
  9221                                    ws-error-no (e1)
  9222                 PERFORM 9900-ERROR-FORMAT
  9223                                 THRU 9900-EXIT
  9224                 add +1          to e1
  9225                 move er-1655    to emi-error
  9226                                    ws-error-no (e1)
  9227                 PERFORM 9900-ERROR-FORMAT
  9228                                 THRU 9900-EXIT
  9229              when clmtypei = 'I'
  9230                 add +1          to e1
  9231                 move er-1661    to emi-error
  9232                                    ws-error-no (e1)
  9233                 PERFORM 9900-ERROR-FORMAT
  9234                                 THRU 9900-EXIT
  9235           end-evaluate
  9236           IF (WS-PRE-EXISTING-PER NOT = ZEROS)
  9237              AND (WS-MONTHS-BETWEEN <= WS-PRE-EXISTING-PER)
  9238              MOVE -1         TO MAINTL
  9239              ADD +1          TO E1
  9240              MOVE ER-1677    TO EMI-ERROR
  9241                                 WS-ERROR-NO (E1)
  9242              PERFORM 9900-ERROR-FORMAT
  9243                              THRU 9900-EXIT
  9244           END-IF
  9245        END-IF
  9246*       perform 3996-read-cert-claim-trailer
  9247*                                thru 3996-exit
  9248     END-IF
  9249     perform 3996-read-cert-claim-trailer
  9250                                 thru 3996-exit
  9251     IF CERTMTI NOT = 'A'
  9252         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9253             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9254             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9255             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9256             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9257             IF INCURRED-DATE-MATCH
  9258                 MOVE ER-7352         TO EMI-ERROR
  9259                 MOVE -1              TO CERTNOL
  9260                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9261             ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 177
* EL130.cbl
  9262                 IF NO-CLAIMS-FOR-CERT
  9263                     MOVE ER-7353     TO EMI-ERROR
  9264                     MOVE -1          TO CERTNOL
  9265                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9266                 ELSE
  9267                     MOVE ER-0558     TO EMI-ERROR
  9268                     MOVE -1          TO CERTNOL
  9269                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9270                 END-IF
  9271             END-IF
  9272         END-IF
  9273     END-IF.
  9274
  9275     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9276         MOVE ER-0433             TO EMI-ERROR
  9277         MOVE -1                  TO MAINTL
  9278         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9279         GO TO 8200-SEND-DATAONLY
  9280     END-IF.
  9281
  9282     IF (EMI-NO-ERRORS)
  9283        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9284         GO TO 3015-TRY-TO-BUILD
  9285     END-IF.
  9286
  9287     IF EIBAID = DFHPF6
  9288         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9289             MOVE ER-0434         TO EMI-ERROR
  9290             MOVE -1              TO MAINTL
  9291             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9292             GO TO 8200-SEND-DATAONLY
  9293         ELSE
  9294             MOVE +1              TO INCURL
  9295             GO TO 3015-TRY-TO-BUILD
  9296         END-IF
  9297     END-IF.
  9298
  9299     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9300         GO TO 8150-SEND-MAP-CURSOR
  9301     ELSE
  9302         GO TO 8200-SEND-DATAONLY
  9303     END-IF.
  9304
  9305 3015-TRY-TO-BUILD.
  9306     IF CLMNOL EQUAL ZERO
  9307         GO TO 3030-BUILD-CONT
  9308     END-IF.
  9309
  9310
  9311
  9312* EXEC CICS HANDLE CONDITION
  9313*        NOTFND   (3030-BUILD-CONT)
  9314*    END-EXEC.
  9315*    MOVE '"$I                   ! . #00008892' TO DFHEIV0
  9316     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9318     MOVE X'2E20233030303038383932' TO DFHEIV0(25:11)
  9319     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 178
* EL130.cbl
  9320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9321
  9322
  9323     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9324
  9325     MOVE CLMCARRI               TO MSTR-CARRIER.
  9326     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9327     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9328     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9329
  9330     MOVE 'MSTR'                 TO FILE-SWITCH.
  9331
  9332     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9333
  9334     MOVE ER-0221                TO EMI-ERROR.
  9335
  9336     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9337     MOVE -1                     TO MAINTL.
  9338     GO TO 8200-SEND-DATAONLY.
  9339
  9340 3030-BUILD-CONT.
  9341     IF (CERTMTI NOT = 'A')
  9342        and (pi-company-id not = 'DCC' and 'VPP')
  9343         GO TO 3060-BUILD-CONT
  9344     END-IF.
  9345
  9346
  9347
  9348* EXEC CICS HANDLE CONDITION
  9349*        NOTFND   (3033-ACCT-NOT-FOUND)
  9350*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9351*    END-EXEC.
  9352*    MOVE '"$I''                  ! / #00008920' TO DFHEIV0
  9353     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9355     MOVE X'2F20233030303038393230' TO DFHEIV0(25:11)
  9356     CALL 'kxdfhei1' USING DFHEIV0
  9357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9358
  9359
  9360     MOVE SPACES                 TO ERACCT-KEY.
  9361
  9362     IF CARR-GROUP-ST-ACCNT-CNTL
  9363         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9364         MOVE CRTCARRI           TO ACCT-CARRIER
  9365         MOVE GROUPI             TO ACCT-GROUPING
  9366         MOVE STATEI             TO ACCT-STATE
  9367         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9368         GO TO 3031-MOVE-ACCT-KEY
  9369     END-IF.
  9370
  9371     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9372     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9373
  9374     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9375         MOVE STATEI             TO ACCT-STATE
  9376     END-IF.
  9377
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 179
* EL130.cbl
  9378     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9379         MOVE CRTCARRI           TO ACCT-CARRIER
  9380     END-IF.
  9381
  9382 3031-MOVE-ACCT-KEY.
  9383     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9384
  9385
  9386
  9387* EXEC CICS STARTBR
  9388*        DATASET     (ERACCT2-DSID)
  9389*        RIDFLD      (SAVE-ERACCT-KEY)
  9390*        GENERIC
  9391*        KEYLENGTH   (20)
  9392*    END-EXEC.
  9393     MOVE 20
  9394       TO DFHEIV11
  9395     MOVE 0
  9396       TO DFHEIV12
  9397*    MOVE '&,   KG    G          &   #00008951' TO DFHEIV0
  9398     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9399     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9400     MOVE X'2020233030303038393531' TO DFHEIV0(25:11)
  9401     CALL 'kxdfhei1' USING DFHEIV0,
  9402           ERACCT2-DSID,
  9403           SAVE-ERACCT-KEY,
  9404           DFHEIV11,
  9405           DFHEIV12,
  9406           DFHEIV99
  9407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9408
  9409
  9410
  9411
  9412* EXEC CICS HANDLE CONDITION
  9413*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9414*    END-EXEC.
  9415*    MOVE '"$''                   ! 0 #00008959' TO DFHEIV0
  9416     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9418     MOVE X'3020233030303038393539' TO DFHEIV0(25:11)
  9419     CALL 'kxdfhei1' USING DFHEIV0
  9420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9421
  9422
  9423 3031-READ-ACCT-LOOP.
  9424
  9425
  9426* EXEC CICS READNEXT
  9427*        DATASET   (ERACCT2-DSID)
  9428*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9429*        RIDFLD    (SAVE-ERACCT-KEY)
  9430*    END-EXEC.
  9431     MOVE 0
  9432       TO DFHEIV11
  9433*    MOVE '&.S                   )   #00008965' TO DFHEIV0
  9434     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9435     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 180
* EL130.cbl
  9436     MOVE X'2020233030303038393635' TO DFHEIV0(25:11)
  9437     CALL 'kxdfhei1' USING DFHEIV0,
  9438           ERACCT2-DSID,
  9439           DFHEIV20,
  9440           DFHEIV99,
  9441           SAVE-ERACCT-KEY,
  9442           DFHEIV99,
  9443           DFHEIV11,
  9444           DFHEIV99,
  9445           DFHEIV99
  9446     SET ADDRESS OF ACCOUNT-MASTER TO
  9447         DFHEIV20
  9448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9449
  9450
  9451     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9452        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9453        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9454        ACCT-STATE    NOT = AM-VG-STATE       OR
  9455        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9456         GO TO 3033-ACCT-NOT-FOUND
  9457     END-IF.
  9458
  9459     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9460        WS-EFFDT LESS AM-EXPIRATION-DT
  9461         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9462         MOVE AM-CARRIER       TO CERT-CARRIER
  9463         MOVE AM-GROUPING      TO CERT-GROUPING
  9464         MOVE AM-STATE         TO CERT-STATE
  9465         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9466         MOVE WS-EFFDT         TO CERT-EFF-DT
  9467         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9468         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9469         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9470         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9471     END-IF.
  9472
  9473     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9474         GO TO 3031-READ-ACCT-LOOP
  9475     END-IF.
  9476
  9477 3032-NOT-IN-DT-RANGE.
  9478     MOVE ER-0226                TO EMI-ERROR.
  9479     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9480     MOVE -1                     TO EFFDTL.
  9481     GO TO 8200-SEND-DATAONLY.
  9482
  9483 3033-ACCT-NOT-FOUND.
  9484     MOVE ER-0226 TO EMI-ERROR.
  9485     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9486     MOVE -1                     TO ACCOUNTL.
  9487     GO TO 8200-SEND-DATAONLY.
  9488
  9489 3034-CHECK-EMPLOYER-STATEMENT.
  9490
  9491     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9492*        NEXT SENTENCE
  9493         CONTINUE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 181
* EL130.cbl
  9494     ELSE
  9495         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9496     END-IF.
  9497
  9498     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9499     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9500     MOVE '1'                    TO  DC-OPTION-CODE.
  9501     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9502                                     DC-ELAPSED-DAYS.
  9503     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9504
  9505     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9506         DC-ELAPSED-DAYS LESS THAN +31)
  9507                      OR
  9508        (AM-EMPLOYER-STMT-USED = '2' AND
  9509         DC-ELAPSED-DAYS LESS THAN +61)
  9510                      OR
  9511        (AM-EMPLOYER-STMT-USED = '3' AND
  9512         DC-ELAPSED-DAYS LESS THAN +91)
  9513            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9514     END-IF.
  9515
  9516 3034-CHECK-ACCOUNT-LIMITS.
  9517
  9518     IF CERTMTI NOT = 'A'
  9519         GO TO 3060-BUILD-CONT
  9520     END-IF.
  9521
  9522     IF AM-STATUS NOT = '0'
  9523         MOVE ER-0225                TO EMI-ERROR
  9524         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9525         MOVE -1                     TO ACCOUNTL
  9526     END-IF.
  9527
  9528     IF EIBAID = DFHPF6
  9529         IF EMI-FATAL-CTR NOT = ZERO
  9530             MOVE ER-0434         TO EMI-ERROR
  9531             MOVE -1              TO MAINTL
  9532             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9533             GO TO 8200-SEND-DATAONLY
  9534         END-IF
  9535     END-IF.
  9536
  9537*    IF PI-COMPANY-ID NOT = 'CRI'
  9538*        GO TO 3035-END-BROWSE
  9539*    END-IF.
  9540
  9541 3035-END-BROWSE.
  9542
  9543
  9544* EXEC CICS ENDBR
  9545*        DATASET    (ERACCT2-DSID)
  9546*    END-EXEC.
  9547     MOVE 0
  9548       TO DFHEIV11
  9549*    MOVE '&2                    $   #00009063' TO DFHEIV0
  9550     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9551     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 182
* EL130.cbl
  9552     MOVE X'2020233030303039303633' TO DFHEIV0(25:11)
  9553     CALL 'kxdfhei1' USING DFHEIV0,
  9554           ERACCT2-DSID,
  9555           DFHEIV11,
  9556           DFHEIV99
  9557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9558
  9559
  9560 3040-CHECK-CERT-ALREADY-ON.
  9561
  9562
  9563* EXEC CICS HANDLE CONDITION
  9564*        NOTFND   (3070-BUILD-CONT)
  9565*    END-EXEC.
  9566*    MOVE '"$I                   ! 1 #00009069' TO DFHEIV0
  9567     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9569     MOVE X'3120233030303039303639' TO DFHEIV0(25:11)
  9570     CALL 'kxdfhei1' USING DFHEIV0
  9571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9572
  9573
  9574     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9575
  9576     MOVE ER-0229                TO EMI-ERROR.
  9577     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9578     MOVE -1                     TO MAINTL.
  9579     GO TO 8200-SEND-DATAONLY.
  9580
  9581 3060-BUILD-CONT.
  9582     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9583     MOVE CRTCARRI               TO CERT-CARRIER.
  9584     MOVE GROUPI                 TO CERT-GROUPING.
  9585     MOVE STATEI                 TO CERT-STATE.
  9586     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9587     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9588     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9589     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9590
  9591
  9592
  9593* EXEC CICS HANDLE CONDITION
  9594*        NOTFND  (3065-CERT-NOT-FOUND)
  9595*    END-EXEC.
  9596*    MOVE '"$I                   ! 2 #00009091' TO DFHEIV0
  9597     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9599     MOVE X'3220233030303039303931' TO DFHEIV0(25:11)
  9600     CALL 'kxdfhei1' USING DFHEIV0
  9601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9602
  9603
  9604     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9605
  9606     GO TO 3070-BUILD-CONT.
  9607
  9608 3065-CERT-NOT-FOUND.
  9609     MOVE ER-0244                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 183
* EL130.cbl
  9610     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9611     MOVE -1                     TO CERTNOL.
  9612     GO TO 8200-SEND-DATAONLY.
  9613
  9614 3070-BUILD-CONT.
  9615     IF CLMNOL NOT = ZERO
  9616         GO TO 3200-BUILD-ZERO-TRAILER
  9617     END-IF.
  9618
  9619     MOVE SPACES                 TO ELCNTL-KEY.
  9620
  9621     IF CONTROL-IS-ACTUAL-CARRIER
  9622         MOVE PI-CARRIER         TO CNTL-CARRIER
  9623     ELSE
  9624         MOVE PI-CARRIER-CONTROL-LEVEL
  9625                                 TO CNTL-CARRIER
  9626     END-IF.
  9627
  9628     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9629     MOVE '6'                    TO CNTL-REC-TYPE.
  9630     MOVE +0                     TO CNTL-SEQ-NO.
  9631
  9632
  9633
  9634* EXEC CICS HANDLE CONDITION
  9635*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9636*    END-EXEC.
  9637*    MOVE '"$I                   ! 3 #00009124' TO DFHEIV0
  9638     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9640     MOVE X'3320233030303039313234' TO DFHEIV0(25:11)
  9641     CALL 'kxdfhei1' USING DFHEIV0
  9642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9643
  9644
  9645
  9646
  9647* EXEC CICS READ
  9648*        UPDATE
  9649*        DATASET   (ELCNTL-DSID)
  9650*        SET       (ADDRESS OF CONTROL-FILE)
  9651*        RIDFLD    (ELCNTL-KEY)
  9652*    END-EXEC.
  9653*    MOVE '&"S        EU         (   #00009129' TO DFHEIV0
  9654     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9655     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9656     MOVE X'2020233030303039313239' TO DFHEIV0(25:11)
  9657     CALL 'kxdfhei1' USING DFHEIV0,
  9658           ELCNTL-DSID,
  9659           DFHEIV20,
  9660           DFHEIV99,
  9661           ELCNTL-KEY,
  9662           DFHEIV99,
  9663           DFHEIV99,
  9664           DFHEIV99
  9665     SET ADDRESS OF CONTROL-FILE TO
  9666         DFHEIV20
  9667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 184
* EL130.cbl
  9668
  9669
  9670     IF CLAIM-NO-MANUAL
  9671         GO TO 3120-CLAIM-MUST-BE-INPUT
  9672     END-IF.
  9673
  9674     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9675     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9676
  9677     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' OR 'VPP'
  9678         CONTINUE
  9679     ELSE
  9680         GO TO 3080-ASSIGN-LOOP
  9681     END-IF.
  9682
  9683
  9684
  9685* EXEC CICS UNLOCK
  9686*        DATASET   (ELCNTL-DSID)
  9687*    END-EXEC.
  9688*    MOVE '&*                    #   #00009150' TO DFHEIV0
  9689     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9690     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9691     MOVE X'2020233030303039313530' TO DFHEIV0(25:11)
  9692     CALL 'kxdfhei1' USING DFHEIV0,
  9693           ELCNTL-DSID,
  9694           DFHEIV99
  9695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9696
  9697
  9698     MOVE '1'                    TO CNTL-REC-TYPE.
  9699     MOVE SPACES                 TO CNTL-ACCESS.
  9700
  9701     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9702
  9703
  9704
  9705* EXEC CICS HANDLE CONDITION
  9706*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9707*    END-EXEC.
  9708*    MOVE '"$I                   ! 4 #00009160' TO DFHEIV0
  9709     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9711     MOVE X'3420233030303039313630' TO DFHEIV0(25:11)
  9712     CALL 'kxdfhei1' USING DFHEIV0
  9713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9714
  9715
  9716     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9717
  9718     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9719
  9720 3080-ASSIGN-LOOP.
  9721     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9722        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9723         MOVE +0                 TO SAVE-COUNTER
  9724     END-IF.
  9725
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 185
* EL130.cbl
  9726     ADD +1 TO SAVE-COUNTER.
  9727
  9728     IF SAVE-METHOD  = '3'
  9729         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9730         GO TO 3090-SET-COMP
  9731     END-IF.
  9732
  9733     IF SAVE-METHOD  = '4'
  9734         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9735         MOVE CLMCARRI           TO WS-CN-PRF-A
  9736         GO TO 3090-SET-COMP
  9737     END-IF.
  9738
  9739     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9740     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9741     MOVE SAVE-DATE              TO CURR-DATE.
  9742
  9743     IF CURR-MM LESS '10'
  9744         MOVE CURR-M2             TO WS-CN-PRF-B
  9745     END-IF.
  9746
  9747     IF CURR-MM = '10'
  9748        MOVE 'A'                 TO WS-CN-PRF-B
  9749     END-IF.
  9750     IF CURR-MM = '11'
  9751        MOVE 'B'                 TO WS-CN-PRF-B
  9752     END-IF.
  9753     IF CURR-MM = '12'
  9754        MOVE 'C'                 TO WS-CN-PRF-B
  9755     END-IF.
  9756
  9757     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9758
  9759 3090-SET-COMP.
  9760
  9761     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9762     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9763                                    CLMNOO.
  9764     MOVE AL-UANON               TO CLMNOA.
  9765     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9766     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9767     MOVE CLMCARRI               TO MSTR-CARRIER.
  9768
  9769
  9770
  9771* EXEC CICS HANDLE CONDITION
  9772*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9773*    END-EXEC.
  9774*    MOVE '"$I                   ! 5 #00009218' TO DFHEIV0
  9775     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9777     MOVE X'3520233030303039323138' TO DFHEIV0(25:11)
  9778     CALL 'kxdfhei1' USING DFHEIV0
  9779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9780
  9781
  9782     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9783
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 186
* EL130.cbl
  9784     GO TO 3080-ASSIGN-LOOP.
  9785
  9786 3100-CARRIER-NOT-FOUND.
  9787     MOVE ER-0252                TO EMI-ERROR.
  9788     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9789     MOVE -1                     TO CLMCARRL.
  9790     GO TO 8200-SEND-DATAONLY.
  9791
  9792 3110-COMPANY-NOT-FOUND.
  9793     MOVE ER-0254                TO EMI-ERROR.
  9794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9795     MOVE -1                     TO MAINTL.
  9796     GO TO 8200-SEND-DATAONLY.
  9797
  9798 3120-CLAIM-MUST-BE-INPUT.
  9799     MOVE ER-0264                TO EMI-ERROR.
  9800     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9801     MOVE -1                     TO CLMNOL.
  9802     GO TO 8200-SEND-DATAONLY.
  9803
  9804 3200-BUILD-ZERO-TRAILER.
  9805
  9806
  9807* EXEC CICS HANDLE CONDITION
  9808*        NOTFND
  9809*    END-EXEC.
  9810*    MOVE '"$                   ! 6 #00009246' TO DFHEIV0
  9811     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9813     MOVE X'3620233030303039323436' TO DFHEIV0(25:11)
  9814     CALL 'kxdfhei1' USING DFHEIV0
  9815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9816
  9817
  9818
  9819
  9820* EXEC CICS GETMAIN
  9821*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9822*        LENGTH  (ELTRLR-LENGTH)
  9823*    END-EXEC.
  9824*    MOVE '," L                  $   #00009251' TO DFHEIV0
  9825     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9827     MOVE X'2020233030303039323531' TO DFHEIV0(25:11)
  9828     CALL 'kxdfhei1' USING DFHEIV0,
  9829           DFHEIV20,
  9830           ELTRLR-LENGTH,
  9831           DFHEIV99
  9832     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9833         DFHEIV20
  9834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9835
  9836
  9837     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9838     MOVE 'AT'                   TO AT-RECORD-ID.
  9839
  9840     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9841     MOVE CLMCARRI               TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 187
* EL130.cbl
  9842     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9843     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9844     MOVE +0                     TO AT-SEQUENCE-NO.
  9845     MOVE '1'                    TO AT-TRAILER-TYPE.
  9846
  9847     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9848     MOVE '5'                    TO DC-OPTION-CODE.
  9849     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9850     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9851                                    AT-RESERVES-LAST-MAINT-DT.
  9852
  9853     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9854                                    AT-RESERVES-LAST-UPDATED-BY.
  9855
  9856     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9857
  9858     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9859
  9860     MOVE +0                     TO AT-FUTURE-RESERVE
  9861                                    AT-IBNR-RESERVE
  9862                                    AT-PAY-CURRENT-RESERVE
  9863                                    AT-INITIAL-MANUAL-RESERVE
  9864                                    AT-CURRENT-MANUAL-RESERVE
  9865                                    AT-ITD-LIFE-REFUNDS
  9866                                    AT-ITD-AH-REFUNDS
  9867                                    AT-ITD-ADDITIONAL-RESERVE.
  9868
  9869     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9870
  9871     IF MANRSVL NOT = ZERO
  9872         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9873                                    AT-CURRENT-MANUAL-RESERVE
  9874     END-IF.
  9875
  9876     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9877
  9878     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9879                                    AT-ITD-CHARGEABLE-EXPENSE.
  9880
  9881     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9882     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9883     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9884
  9885
  9886
  9887* EXEC CICS WRITE
  9888*        DATASET   (ELTRLR-DSID)
  9889*        FROM      (ACTIVITY-TRAILERS)
  9890*        RIDFLD    (AT-CONTROL-PRIMARY)
  9891*    END-EXEC.
  9892     MOVE LENGTH OF
  9893      ACTIVITY-TRAILERS
  9894       TO DFHEIV11
  9895*    MOVE '&$ L                  ''   #00009305' TO DFHEIV0
  9896     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9898     MOVE X'2020233030303039333035' TO DFHEIV0(25:11)
  9899     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 188
* EL130.cbl
  9900           ELTRLR-DSID,
  9901           ACTIVITY-TRAILERS,
  9902           DFHEIV11,
  9903           AT-CONTROL-PRIMARY,
  9904           DFHEIV99,
  9905           DFHEIV99
  9906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9907
  9908
  9909     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9910
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 189
* EL130.cbl
  9912
  9913 3250-BUILD-I1-ADDRESS-TRAILER.
  9914
  9915     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9916     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9917     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9918     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9919     MOVE GROUPI                 TO WS-MA-GROUPING.
  9920     MOVE STATEI                 TO WS-MA-STATE.
  9921     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9922     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9923     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9924     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9925
  9926
  9927* EXEC CICS HANDLE CONDITION
  9928*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9929*    END-EXEC.
  9930*    MOVE '"$I                   ! 7 #00009328' TO DFHEIV0
  9931     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9933     MOVE X'3720233030303039333238' TO DFHEIV0(25:11)
  9934     CALL 'kxdfhei1' USING DFHEIV0
  9935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9936
  9937
  9938
  9939* EXEC CICS READ
  9940*        EQUAL
  9941*        DATASET   (ERMAIL-DSID)
  9942*        SET       (ADDRESS OF MAILING-DATA)
  9943*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9944*    END-EXEC.
  9945*    MOVE '&"S        E          (   #00009332' TO DFHEIV0
  9946     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9948     MOVE X'2020233030303039333332' TO DFHEIV0(25:11)
  9949     CALL 'kxdfhei1' USING DFHEIV0,
  9950           ERMAIL-DSID,
  9951           DFHEIV20,
  9952           DFHEIV99,
  9953           WS-MA-CONTROL-PRIMARY,
  9954           DFHEIV99,
  9955           DFHEIV99,
  9956           DFHEIV99
  9957     SET ADDRESS OF MAILING-DATA TO
  9958         DFHEIV20
  9959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9960
  9961
  9962     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9963         GO TO 3290-NO-INSURED-ADDRESS
  9964     END-IF.
  9965
  9966     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9967     MOVE 'AT'                   TO AT-RECORD-ID.
  9968
  9969     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 190
* EL130.cbl
  9970     MOVE CLMCARRI               TO AT-CARRIER.
  9971     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9972     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9973     MOVE +1                     TO AT-SEQUENCE-NO.
  9974     MOVE '5'                    TO AT-TRAILER-TYPE.
  9975
  9976     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9977     IF MA-INSURED-MIDDLE-INIT > SPACES
  9978        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9979               ' ' DELIMITED BY SIZE
  9980               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9981               ' ' DELIMITED BY SIZE
  9982               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9983        INTO AT-MAIL-TO-NAME
  9984     ELSE
  9985        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9986               ' ' DELIMITED BY SIZE
  9987               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9988        INTO AT-MAIL-TO-NAME
  9989     END-IF.
  9990     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9991     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9992*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9993     MOVE MA-CITY                TO AT-CITY
  9994     MOVE MA-ADDR-STATE          TO AT-STATE
  9995     MOVE MA-ZIP                 TO AT-ZIP
  9996     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9997
  9998     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9999                                    AT-ADDRESS-LAST-MAINT-DT.
 10000
 10001     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10002                                    AT-ADDRESS-LAST-UPDATED-BY.
 10003
 10004     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10005
 10006
 10007* EXEC CICS WRITE
 10008*        DATASET   (ELTRLR-DSID)
 10009*        FROM      (ACTIVITY-TRAILERS)
 10010*        RIDFLD    (AT-CONTROL-PRIMARY)
 10011*    END-EXEC.
 10012     MOVE LENGTH OF
 10013      ACTIVITY-TRAILERS
 10014       TO DFHEIV11
 10015*    MOVE '&$ L                  ''   #00009383' TO DFHEIV0
 10016     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10017     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10018     MOVE X'2020233030303039333833' TO DFHEIV0(25:11)
 10019     CALL 'kxdfhei1' USING DFHEIV0,
 10020           ELTRLR-DSID,
 10021           ACTIVITY-TRAILERS,
 10022           DFHEIV11,
 10023           AT-CONTROL-PRIMARY,
 10024           DFHEIV99,
 10025           DFHEIV99
 10026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10027
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 191
* EL130.cbl
 10028
 10029     ADD +1                      TO WS-INSURED-ADDR-CNT.
 10030     GO TO 3300-BUILD-NINETY-TRAILER.
 10031
 10032 3290-NO-INSURED-ADDRESS.
 10033      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
 10034
 10035 3300-BUILD-NINETY-TRAILER.
 10036
 10037     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10038     MOVE 'AT'                   TO AT-RECORD-ID.
 10039
 10040     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10041     MOVE CLMCARRI               TO AT-CARRIER.
 10042
 10043     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10044     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10045     MOVE +90                    TO AT-SEQUENCE-NO.
 10046     MOVE '6'                    TO AT-TRAILER-TYPE.
 10047
 10048     IF DIAGL NOT = ZERO
 10049         MOVE DIAGI              TO AT-INFO-LINE-1
 10050     END-IF.
 10051
 10052     IF ICD1L NOT = ZERO
 10053         MOVE ICD1I              TO AT-ICD-CODE-1
 10054     END-IF.
 10055
 10056     IF ICD2L NOT = ZERO
 10057         MOVE ICD2I              TO AT-ICD-CODE-2
 10058     END-IF.
 10059
 10060     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10061                                    AT-GEN-INFO-LAST-MAINT-DT.
 10062
 10063     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10064                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10065     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10066
 10067
 10068
 10069* EXEC CICS WRITE
 10070*        DATASET   (ELTRLR-DSID)
 10071*        FROM      (ACTIVITY-TRAILERS)
 10072*        RIDFLD    (AT-CONTROL-PRIMARY)
 10073*    END-EXEC.
 10074     MOVE LENGTH OF
 10075      ACTIVITY-TRAILERS
 10076       TO DFHEIV11
 10077*    MOVE '&$ L                  ''   #00009428' TO DFHEIV0
 10078     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10079     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10080     MOVE X'2020233030303039343238' TO DFHEIV0(25:11)
 10081     CALL 'kxdfhei1' USING DFHEIV0,
 10082           ELTRLR-DSID,
 10083           ACTIVITY-TRAILERS,
 10084           DFHEIV11,
 10085           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 192
* EL130.cbl
 10086           DFHEIV99,
 10087           DFHEIV99
 10088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10089
 10090
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 193
* EL130.cbl
 10092 3400-CHECK-CERT-MAINT.
 10093
 10094     IF CERTMTI = 'A'
 10095         GO TO 3600-BUILD-NEW-CERT
 10096     END-IF.
 10097
 10098     IF NO-CLAIM-ATTACHED
 10099         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
 10100     END-IF.
 10101
 10102     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
 10103
 10104     IF CM-LF-CURRENT-STATUS = '2' OR
 10105        CM-AH-CURRENT-STATUS = '2'
 10106         GO TO 3400-REWRITE-CERT
 10107     END-IF.
 10108
 10109     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10110
 10111 3400-REWRITE-CERT.
 10112
 10113
 10114
 10115* EXEC CICS HANDLE CONDITION
 10116*        DUPKEY (3410-DUP-KEY)
 10117*    END-EXEC.
 10118*    MOVE '"$$                   ! 8 #00009457' TO DFHEIV0
 10119     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10121     MOVE X'3820233030303039343537' TO DFHEIV0(25:11)
 10122     CALL 'kxdfhei1' USING DFHEIV0
 10123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10124
 10125
 10126
 10127
 10128* EXEC CICS REWRITE
 10129*        DATASET   (ELCERT-DSID)
 10130*        FROM      (CERTIFICATE-MASTER)
 10131*    END-EXEC.
 10132     MOVE LENGTH OF
 10133      CERTIFICATE-MASTER
 10134       TO DFHEIV11
 10135*    MOVE '&& L                  %   #00009462' TO DFHEIV0
 10136     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10137     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10138     MOVE X'2020233030303039343632' TO DFHEIV0(25:11)
 10139     CALL 'kxdfhei1' USING DFHEIV0,
 10140           ELCERT-DSID,
 10141           CERTIFICATE-MASTER,
 10142           DFHEIV11,
 10143           DFHEIV99
 10144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10145
 10146
 10147 3410-DUP-KEY.
 10148     GO TO 3800-BUILD-NEW-CLAIM.
 10149
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 194
* EL130.cbl
 10150 3600-BUILD-NEW-CERT.
 10151
 10152
 10153* EXEC CICS GETMAIN
 10154*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10155*        LENGTH   (ELCERT-LENGTH)
 10156*    END-EXEC.
 10157*    MOVE '," L                  $   #00009472' TO DFHEIV0
 10158     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10159     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10160     MOVE X'2020233030303039343732' TO DFHEIV0(25:11)
 10161     CALL 'kxdfhei1' USING DFHEIV0,
 10162           DFHEIV20,
 10163           ELCERT-LENGTH,
 10164           DFHEIV99
 10165     SET ADDRESS OF CERTIFICATE-MASTER TO
 10166         DFHEIV20
 10167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10168
 10169
 10170     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10171
 10172     MOVE 'CM'                   TO CM-RECORD-ID.
 10173
 10174     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10175                                    CM-COMPANY-CD-A1
 10176                                    CM-COMPANY-CD-A2
 10177                                    CM-COMPANY-CD-A4
 10178                                    CM-COMPANY-CD-A5.
 10179
 10180     MOVE CERT-CARRIER           TO CM-CARRIER.
 10181     MOVE CERT-GROUPING          TO CM-GROUPING.
 10182     MOVE CERT-STATE             TO CM-STATE.
 10183     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10184     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10185     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10186
 10187     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10188                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10189                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10190                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10191                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10192                       CM-LIVES              CM-LOAN-TERM
 10193                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10194                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10195                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10196                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10197                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10198                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10199                       CM-LF-ALT-PREMIUM-RATE
 10200                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10201                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10202                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10203                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10204                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10205
 10206     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10207                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 195
* EL130.cbl
 10208                                    CM-AH-SETTLEMENT-DT
 10209                                    CM-AH-CANCEL-EXIT-DT
 10210                                    CM-AH-SETTLEMENT-EXIT-DT
 10211                                    CM-LF-LOAN-EXPIRE-DT
 10212                                    CM-LF-CANCEL-DT
 10213                                    CM-LF-DEATH-DT
 10214                                    CM-LF-CANCEL-EXIT-DT
 10215                                    CM-LF-DEATH-EXIT-DT
 10216                                    CM-LAST-ADD-ON-DT
 10217                                    CM-ENTRY-DT.
 10218
 10219     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10220     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10221     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10222
 10223     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10224                                    CM-PART-LAST-NAME-A2
 10225                                    CM-PART-LAST-NAME-A5.
 10226
 10227     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10228                                    CM-INSURED-INITIAL1-A2
 10229                                    CM-INSURED-INITIAL1-A5
 10230                                    CM-INSURED-FIRST-NAME.
 10231
 10232     IF CRTINITL GREATER ZERO
 10233         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10234                                    CM-INSURED-INITIAL2-A2
 10235                                    CM-INSURED-INITIAL2-A5
 10236     ELSE
 10237         MOVE SPACES             TO CM-INSURED-INITIAL2
 10238                                    CM-INSURED-INITIAL2-A2
 10239                                    CM-INSURED-INITIAL2-A5
 10240     END-IF.
 10241
 10242     IF CM-INSURED-INITIALS = SPACES
 10243         MOVE '**'               TO CM-INSURED-INITIALS
 10244     END-IF.
 10245
 10246     IF MEMBERL GREATER ZERO
 10247         MOVE MEMBERI              TO CM-MEMBER-NO
 10248     ELSE
 10249         MOVE CERT-STATE           TO CM-MEMB-STATE
 10250         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10251         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10252         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10253     END-IF.
 10254
 10255     IF JNTLNMEL GREATER ZERO
 10256         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10257     END-IF.
 10258
 10259     IF JNTFNMEL GREATER ZERO
 10260         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10261     END-IF.
 10262
 10263     IF JNTINITL GREATER ZERO
 10264         MOVE JNTINITI           TO CM-JT-INITIAL
 10265     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 196
* EL130.cbl
 10266
 10267     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10268
 10269
 10270
 10271* EXEC CICS HANDLE CONDITION
 10272*        DUPKEY   (3690-CERT-WRITTEN)
 10273*    END-EXEC.
 10274*    MOVE '"$$                   ! 9 #00009577' TO DFHEIV0
 10275     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10277     MOVE X'3920233030303039353737' TO DFHEIV0(25:11)
 10278     CALL 'kxdfhei1' USING DFHEIV0
 10279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10280
 10281
 10282
 10283
 10284* EXEC CICS WRITE
 10285*        DATASET   (ELCERT-DSID)
 10286*        FROM      (CERTIFICATE-MASTER)
 10287*        RIDFLD    (CM-CONTROL-PRIMARY)
 10288*    END-EXEC.
 10289     MOVE LENGTH OF
 10290      CERTIFICATE-MASTER
 10291       TO DFHEIV11
 10292*    MOVE '&$ L                  ''   #00009582' TO DFHEIV0
 10293     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10294     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10295     MOVE X'2020233030303039353832' TO DFHEIV0(25:11)
 10296     CALL 'kxdfhei1' USING DFHEIV0,
 10297           ELCERT-DSID,
 10298           CERTIFICATE-MASTER,
 10299           DFHEIV11,
 10300           CM-CONTROL-PRIMARY,
 10301           DFHEIV99,
 10302           DFHEIV99
 10303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10304
 10305
 10306 3690-CERT-WRITTEN.
 10307
 10308     GO TO 3800-BUILD-NEW-CLAIM.
 10309
 10310 3690-EXIT.
 10311      EXIT.
 10312
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 197
* EL130.cbl
 10314 3700-BUILD-CERT.
 10315
 10316     IF CERTMTI NOT = 'A'
 10317         GO TO 3700-FINISH-CERT-BUILD
 10318     END-IF.
 10319
 10320     IF CERTMTI = 'A'
 10321         IF LCVCDL = ZEROS
 10322             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10323                                    CM-LF-ORIG-TERM
 10324                                    CM-LF-BENEFIT-AMT
 10325                                    CM-LF-PREMIUM-RATE
 10326             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10327         END-IF
 10328     END-IF.
 10329
 10330     IF LCVCDL GREATER ZERO
 10331         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10332     END-IF.
 10333
 10334     IF LCVOTRML GREATER ZERO
 10335         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10336     END-IF.
 10337
 10338     IF LCVBENEL GREATER ZERO
 10339         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10340     END-IF.
 10341
 10342     IF LCVRATEL GREATER ZERO
 10343         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10344     END-IF.
 10345
 10346     IF WS-EXPIRE NOT = LOW-VALUES
 10347         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10348     END-IF.
 10349
 10350     IF LCVFORML GREATER ZERO
 10351         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10352     END-IF.
 10353
 10354     IF LCVCNDTL = ZERO
 10355        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10356     END-IF.
 10357
 10358     IF WS-LCVCNDT NOT = LOW-VALUES
 10359        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10360        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10361        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10362     END-IF.
 10363
 10364     IF CM-LF-CURRENT-STATUS = '7'
 10365        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10366        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10367        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10368                                    CM-LF-DEATH-DT
 10369        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10370     END-IF.
 10371
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 198
* EL130.cbl
 10372     IF CM-LF-CURRENT-STATUS = '8'
 10373        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10374        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10375     END-IF.
 10376
 10377 3700-BUILD-AH-COVERAGE-SIDE.
 10378
 10379     IF CERTMTI = 'A'
 10380         IF ACVCDL = ZEROS
 10381             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10382                                    CM-AH-ORIG-TERM
 10383                                    CM-AH-BENEFIT-AMT
 10384                                    CM-AH-PREMIUM-RATE
 10385             GO TO 3700-COVERAGE-BUILT
 10386         END-IF
 10387     END-IF.
 10388
 10389     IF ACVCDL GREATER ZERO
 10390         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10391     END-IF.
 10392
 10393     IF ACVOTRML GREATER ZERO
 10394         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10395     END-IF.
 10396
 10397     IF ACVBENEL GREATER ZERO
 10398         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10399     END-IF.
 10400
 10401     IF ACVRATEL GREATER ZERO
 10402         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10403     END-IF.
 10404
 10405     IF WS-EXPIRE NOT = LOW-VALUES
 10406         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10407     END-IF.
 10408
 10409     IF ACVFORML GREATER ZERO
 10410         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10411     END-IF.
 10412
 10413     IF ACVCNDTL = ZERO
 10414        GO TO 3700-COVERAGE-BUILT
 10415     END-IF.
 10416
 10417     IF WS-ACVCNDT NOT = LOW-VALUES
 10418        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10419        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10420        GO TO 3700-COVERAGE-BUILT
 10421     END-IF.
 10422
 10423     IF CM-AH-CURRENT-STATUS = '6'
 10424        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10425        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10426        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10427        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10428        GO TO 3700-COVERAGE-BUILT
 10429     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 199
* EL130.cbl
 10430
 10431     IF CM-AH-CURRENT-STATUS = '8'
 10432        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10433        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10434     END-IF.
 10435
 10436 3700-COVERAGE-BUILT.
 10437     IF ISSAGEL GREATER ZERO
 10438         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10439     END-IF.
 10440
 10441     IF JNTAGEL GREATER ZERO
 10442         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10443     END-IF.
 10444
 10445     IF SEXL GREATER ZERO
 10446         MOVE SEXI               TO CM-INSURED-SEX
 10447     END-IF.
 10448
 10449     IF APRL GREATER ZERO
 10450         MOVE WS-APR             TO CM-LOAN-APR
 10451     END-IF.
 10452
 10453     IF PMTFREQL GREATER ZERO
 10454         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10455     END-IF.
 10456
 10457     IF INDGRPL GREATER ZERO
 10458         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10459     END-IF.
 10460
 10461     IF CERTMTI = 'A'
 10462         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10463     END-IF.
 10464
 10465     IF REINCDL GREATER ZERO
 10466         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10467                                    WS-REIN-1
 10468                                    WS-REIN-2
 10469                                    WS-REIN-3
 10470         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10471     END-IF.
 10472
 10473     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10474         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10475     END-IF.
 10476
 10477     IF CRTSSNL GREATER ZERO
 10478         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10479     ELSE
 10480         IF SSNL GREATER ZERO
 10481             MOVE SSNI           TO CM-SOC-SEC-NO
 10482         END-IF
 10483     END-IF.
 10484
 10485     IF CRTSSNL = ZERO AND
 10486        SSNL    = ZERO
 10487         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 200
* EL130.cbl
 10488         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10489         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10490         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10491     END-IF.
 10492
 10493     IF CM-LF-CURRENT-STATUS = SPACES
 10494         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10495     END-IF.
 10496
 10497     IF CM-AH-CURRENT-STATUS = SPACES
 10498         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10499     END-IF.
 10500
 10501     IF CERTMTI = 'A'
 10502         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10503     END-IF.
 10504
 10505 3700-FINISH-CERT-BUILD.
 10506
 10507     IF LOANNOL GREATER ZERO
 10508         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10509     END-IF.
 10510
 10511     IF LOANBALL GREATER ZERO
 10512         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10513     END-IF.
 10514
 10515     IF PREMTYPL GREATER ZERO
 10516         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10517     END-IF.
 10518
 10519 3700-EXIT.
 10520      EXIT.
 10521
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 201
* EL130.cbl
 10523 3800-BUILD-NEW-CLAIM.
 10524
 10525*************************************************************
 10526*****           START OF ACTIVITY FILE PROCESSING          **
 10527*************************************************************
 10528     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10529         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10530                 6700-EXIT
 10531     END-IF.
 10532*************************************************************
 10533*****            END OF ACTIVITY FILE PROCESSING           **
 10534*************************************************************
 10535
 10536
 10537
 10538
 10539* EXEC CICS GETMAIN
 10540*        SET     (ADDRESS OF CLAIM-MASTER)
 10541*        LENGTH  (ELMSTR-LENGTH)
 10542*    END-EXEC.
 10543*    MOVE '," L                  $   #00009820' TO DFHEIV0
 10544     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10545     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10546     MOVE X'2020233030303039383230' TO DFHEIV0(25:11)
 10547     CALL 'kxdfhei1' USING DFHEIV0,
 10548           DFHEIV20,
 10549           ELMSTR-LENGTH,
 10550           DFHEIV99
 10551     SET ADDRESS OF CLAIM-MASTER TO
 10552         DFHEIV20
 10553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10554
 10555
 10556     MOVE SPACES TO CLAIM-MASTER.
 10557
 10558     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10559         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10560         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10561         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10562         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10563         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10564         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10565         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10566
 10567     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10568             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10569             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10570             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10571             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10572             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10573             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10574             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10575             CL-FORCEABLE-ERROR-CNT.
 10576
 10577     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10578
 10579     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10580                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 202
* EL130.cbl
 10581                                    CL-LAG-REPORT-CODE
 10582                                    CL-CRITICAL-PERIOD
 10583*                                   CL-CRIT-PER-RTW-MOS
 10584     move 01                     to cl-benefit-period
 10585
 10586     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10587     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10588
 10589     IF BENECDL NOT = ZEROS
 10590        MOVE BENECDI             TO CL-BENEFICIARY
 10591     END-IF.
 10592
 10593     MOVE 'CL'                   TO CL-RECORD-ID.
 10594     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10595
 10596     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10597                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10598                             CL-COMPANY-CD-A5.
 10599
 10600     MOVE CLMCARRI               TO CL-CARRIER.
 10601
 10602     IF CLMNOL = ZERO
 10603         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10604     ELSE
 10605         MOVE CLMNOI             TO CL-CLAIM-NO
 10606     END-IF.
 10607
 10608     MOVE CERTNOI                TO CL-CERT-PRIME
 10609                                    CL-CERT-A4-PRIME.
 10610
 10611     MOVE SUFXI                  TO CL-CERT-SFX
 10612                                    CL-CERT-A4-SFX.
 10613
 10614     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10615
 10616     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10617
 10618     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10619
 10620     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10621
 10622     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10623     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10624
 10625     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10626
 10627     IF CERTMTI = 'A'
 10628         MOVE '2'                TO CL-CERT-ORIGIN
 10629     ELSE
 10630         MOVE '1'                TO CL-CERT-ORIGIN
 10631     END-IF.
 10632
 10633     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10634     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10635     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10636     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10637     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10638
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 203
* EL130.cbl
 10639 3820-REWRITE-CONTROL-FILE.
 10640
 10641     IF CLMNOL GREATER ZERO
 10642         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10643     END-IF.
 10644
 10645     IF CF-RECORD-TYPE = '6'
 10646         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10647     ELSE
 10648         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10649     END-IF.
 10650
 10651
 10652
 10653* EXEC CICS REWRITE
 10654*        DATASET   (ELCNTL-DSID)
 10655*        FROM      (CONTROL-FILE)
 10656*    END-EXEC.
 10657     MOVE LENGTH OF
 10658      CONTROL-FILE
 10659       TO DFHEIV11
 10660*    MOVE '&& L                  %   #00009921' TO DFHEIV0
 10661     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10662     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10663     MOVE X'2020233030303039393231' TO DFHEIV0(25:11)
 10664     CALL 'kxdfhei1' USING DFHEIV0,
 10665           ELCNTL-DSID,
 10666           CONTROL-FILE,
 10667           DFHEIV11,
 10668           DFHEIV99
 10669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10670
 10671
 10672 3830-SEQUENCE-CLAIM-RECORDS.
 10673
 10674     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10675     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10676     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10677
 10678     IF WS-ASSOC-CERT-TOTAL = ZERO
 10679         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10680                                    CL-ASSOC-CERT-TOTAL
 10681         GO TO 3840-WRITE-CLAIM-MASTER
 10682     END-IF.
 10683
 10684     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10685         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10686     ELSE
 10687         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10688     END-IF.
 10689
 10690     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10691     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10692     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10693
 10694 3840-WRITE-CLAIM-MASTER.
 10695
 10696     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 204
* EL130.cbl
 10697     IF WS-REC-FOUND-SW = 'Y'
 10698         MOVE 01                 TO  CL-ACTIVITY-CODE
 10699         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10700         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10701     END-IF.
 10702
 10703
 10704
 10705* EXEC CICS HANDLE CONDITION
 10706*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10707*    END-EXEC.
 10708*    MOVE '"$$                   ! : #00009958' TO DFHEIV0
 10709     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10711     MOVE X'3A20233030303039393538' TO DFHEIV0(25:11)
 10712     CALL 'kxdfhei1' USING DFHEIV0
 10713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10714
 10715
 10716** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10717     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10718
 10719
 10720*       CL-CERT-NO
 10721*    IF CL-COMPANY-CD = X'04'
 10722*    ELSE
 10723*       IF CL-COMPANY-CD = X'05'
 10724*       ELSE
 10725*       END-IF
 10726*    END-IF
 10727
 10728* EXEC CICS WRITE
 10729*        DATASET   (ELMSTR-DSID)
 10730*        FROM      (CLAIM-MASTER)
 10731*        RIDFLD    (CL-CONTROL-PRIMARY)
 10732*    END-EXEC.
 10733     MOVE LENGTH OF
 10734      CLAIM-MASTER
 10735       TO DFHEIV11
 10736*    MOVE '&$ L                  ''   #00009978' TO DFHEIV0
 10737     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10738     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10739     MOVE X'2020233030303039393738' TO DFHEIV0(25:11)
 10740     CALL 'kxdfhei1' USING DFHEIV0,
 10741           ELMSTR-DSID,
 10742           CLAIM-MASTER,
 10743           DFHEIV11,
 10744           CL-CONTROL-PRIMARY,
 10745           DFHEIV99,
 10746           DFHEIV99
 10747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10748
 10749
 10750 3850-CLAIM-MSTR-WRITTEN.
 10751
 10752     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10753         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10754     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 205
* EL130.cbl
 10755
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 206
* EL130.cbl
 10757 3990-ADD-DONE.
 10758*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10759*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10760*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10761*                                  EMI-ERROR-LINES.
 10762
 10763     IF CLMNOL = ZERO
 10764         move spaces             to emi-claim-no
 10765         MOVE ER-0265            TO EMI-ERROR
 10766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10767         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10768                                    PI-LAST-CLAIM
 10769     ELSE
 10770         MOVE CLMNOI             TO PI-LAST-CLAIM
 10771                                    MSTR-CLAIM-NO
 10772         MOVE ER-0000            TO EMI-ERROR
 10773         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10774     END-IF.
 10775
 10776     IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O')
 10777       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10778         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10779         MOVE ER-7575            TO EMI-ERROR
 10780         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10781     END-IF.
 10782
 10783     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 10784       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10785         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10786         MOVE ER-7582            TO EMI-ERROR
 10787         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10788     END-IF.
 10789
 10790     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 10791        PERFORM 3991-CHECK-2-YEAR-CONTESTABLE THRU 3991-EXIT
 10792     END-IF.
 10793     IF WS-NO-INSURED-ADDRESS = 'Y'
 10794         MOVE ER-3548            TO EMI-ERROR
 10795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10796     END-IF.
 10797
 10798     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10799       (PI-ST-CAUSAL-STATE = 'L' AND
 10800             (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'))   OR
 10801       (PI-ST-CAUSAL-STATE = 'A' AND
 10802              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10803         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10804         MOVE ER-7577            TO EMI-ERROR
 10805         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10806     END-IF.
 10807     if pi-company-id = 'DCC' OR 'VPP'
 10808        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10809                                 THRU 3994C-EXIT
 10810     end-if
 10811     IF CLMTYPEI = PI-AH-OVERRIDE-L1
 10812       AND PI-COMPANY-ID = 'CID'
 10813        SET ELAPSED-BETWEEN-BIN TO TRUE
 10814        MOVE ZERO               TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 207
* EL130.cbl
 10815                                   DC-ELAPSED-DAYS
 10816
 10817        MOVE CL-INCURRED-DT  TO DC-BIN-DATE-1
 10818        MOVE WS-TODAY-DT TO DC-BIN-DATE-2
 10819        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10820        IF DC-ODD-DAYS-OVER > ZERO
 10821           ADD 1 TO DC-ELAPSED-MONTHS
 10822        END-IF
 10823
 10824        IF PI-STATE = 'HI'
 10825          AND DC-ELAPSED-MONTHS <= 18
 10826           CONTINUE
 10827        ELSE
 10828           IF DC-ELAPSED-MONTHS > 15
 10829              MOVE ER-7572            TO EMI-ERROR
 10830              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10831              PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10832           END-IF
 10833        END-IF
 10834
 10835     END-IF.
 10836     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10837     MOVE CLMCARRI                   TO  PI-CARRIER.
 10838     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10839     MOVE SUFXI                      TO  PI-CERT-SFX.
 10840
 10841     IF WS-LETTER-SW = 'Y'
 10842         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10843         IF W-1523-ERROR-CODE NOT = ZEROS
 10844             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10845             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10846         END-IF
 10847     END-IF.
 10848
 10849     perform 3998-update-cert-claim-trailer
 10850                                 thru 3998-exit
 10851     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10852     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10853     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10854     MOVE CLMCARRI               TO PI-LAST-CARR.
 10855
 10856     IF PRTOPTL GREATER THAN 0
 10857         MOVE PRTOPTI            TO PI-PRT-OPT
 10858     END-IF.
 10859     IF ALTPRTL GREATER THAN 0
 10860         MOVE ALTPRTI            TO PI-ALT-PRT
 10861     END-IF.
 10862
 10863     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10864         MOVE LOW-VALUES         TO EL130AI
 10865         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10866         MOVE AL-SANON           TO CERTNOA
 10867         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10868         MOVE AL-SANON           TO SUFXA
 10869         MOVE PI-LAST-CARR       TO CLMCARRO
 10870         MOVE AL-UANON           TO CLMCARRA
 10871         MOVE PI-LAST-CLAIM      TO CLMNOO
 10872         MOVE AL-UANON           TO CLMNOA
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 208
* EL130.cbl
 10873         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10874         MOVE AL-UANON           TO CLMTYPEA
 10875     ELSE
 10876         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10877         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10878     END-IF.
 10879
 10880     IF PI-PRT-OPT = 'N' OR 'L'
 10881         MOVE PI-PRT-OPT         TO PRTOPTO
 10882         MOVE 1                  TO PRTOPTL
 10883     END-IF.
 10884
 10885     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10886         MOVE PI-ALT-PRT         TO ALTPRTO
 10887         MOVE 4                  TO ALTPRTL
 10888     END-IF.
 10889
 10890     IF PRTOPTL GREATER THAN 0
 10891         IF PRTOPTI = 'L'
 10892             GO TO 0400-CREATE-ELACTQ
 10893         ELSE
 10894             GO TO 0480-PRINT-NOW
 10895         END-IF
 10896     END-IF.
 10897     move 'S'                    to mainti
 10898     PERFORM 0500-CREATE-TEMP-STORAGE
 10899                                 THRU 0599-EXIT
 10900     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10901         GO TO 8100-SEND-INITIAL-MAP
 10902     ELSE
 10903         MOVE LOW-VALUES         TO MAINTO
 10904         MOVE -1                 TO MAINTL
 10905         GO TO 8200-SEND-DATAONLY
 10906     END-IF.
 10907
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 209
* EL130.cbl
 10909 3991-CHECK-2-YEAR-CONTESTABLE.
 10910     SET ELAPSED-BETWEEN-BIN TO TRUE
 10911     MOVE ZERO               TO DC-ELAPSED-MONTHS
 10912                                DC-ELAPSED-DAYS
 10913
 10914     MOVE PI-SAVE-EFFDT  TO DC-BIN-DATE-1.
 10915     MOVE CL-INCURRED-DT TO DC-BIN-DATE-2.
 10916     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10917     IF DC-ODD-DAYS-OVER > ZERO
 10918        ADD 1 TO DC-ELAPSED-MONTHS
 10919     END-IF
 10920
 10921     IF DC-ELAPSED-MONTHS <= 24
 10922        MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
 10923        MOVE ZERO           TO DC-ELAPSED-MONTHS
 10924                               DC-ELAPSED-DAYS
 10925        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10926        IF DC-ODD-DAYS-OVER > ZERO
 10927           ADD 1 TO DC-ELAPSED-MONTHS
 10928        END-IF
 10929        IF DC-ELAPSED-MONTHS > 24
 10930           MOVE ER-1679            TO EMI-ERROR
 10931           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10932           PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10933        END-IF
 10934     END-IF.
 10935
 10936 3991-EXIT.
 10937     EXIT.
 10938 3992-BUILD-TRAILER.
 10939
 10940     MOVE SPACES             TO AT-GENERAL-INFO-TR
 10941     INITIALIZE AT-GENERAL-INFO-TR
 10942     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 10943     MOVE 'AT'               TO AT-RECORD-ID
 10944     IF EMI-ERROR = ER-7572
 10945        MOVE +97             TO AT-SEQUENCE-NO
 10946     ELSE
 10947        MOVE +96             TO AT-SEQUENCE-NO
 10948     END-IF
 10949     MOVE '6'                TO AT-TRAILER-TYPE
 10950     MOVE WS-TODAY-DT        TO AT-RECORDED-DT
 10951                                AT-GEN-INFO-LAST-MAINT-DT
 10952     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 10953                                AT-GEN-INFO-LAST-UPDATED-BY
 10954     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 10955
 10956     IF EMI-ERROR = ER-7572
 10957        MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 10958     ELSE
 10959        MOVE EMI-LINE2 TO AT-INFO-LINE-1
 10960     END-IF
 10961     MOVE SPACES             TO AT-INFO-LINE-2.
 10962
 10963 3992-WRITE.
 10964
 10965
 10966* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 210
* EL130.cbl
 10967*        DUPREC    (3992-DUPREC)
 10968*    END-EXEC.
 10969*    MOVE '"$%                   ! ; #00010199' TO DFHEIV0
 10970     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10972     MOVE X'3B20233030303130313939' TO DFHEIV0(25:11)
 10973     CALL 'kxdfhei1' USING DFHEIV0
 10974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10975
 10976
 10977
 10978* EXEC CICS WRITE
 10979*         DATASET     ('ELTRLR')
 10980*         FROM        (ACTIVITY-TRAILERS)
 10981*         RIDFLD      (AT-CONTROL-PRIMARY)
 10982*     END-EXEC.
 10983     MOVE LENGTH OF
 10984      ACTIVITY-TRAILERS
 10985       TO DFHEIV11
 10986     MOVE 'ELTRLR' TO DFHEIV1
 10987*    MOVE '&$ L                  ''   #00010203' TO DFHEIV0
 10988     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10989     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10990     MOVE X'2020233030303130323033' TO DFHEIV0(25:11)
 10991     CALL 'kxdfhei1' USING DFHEIV0,
 10992           DFHEIV1,
 10993           ACTIVITY-TRAILERS,
 10994           DFHEIV11,
 10995           AT-CONTROL-PRIMARY,
 10996           DFHEIV99,
 10997           DFHEIV99
 10998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10999
 11000
 11001     GO TO 3992-EXIT.
 11002
 11003 3992-DUPREC.
 11004     SUBTRACT +1 FROM AT-SEQUENCE-NO.
 11005     GO TO 3992-WRITE.
 11006
 11007 3992-EXIT.
 11008     EXIT.
 11009 3993-MODIFY-SCREEN-ATTRB.
 11010
 11011     IF CERTMTL GREATER ZERO
 11012         MOVE AL-UANON           TO CERTMTA
 11013     END-IF.
 11014
 11015     IF EFFDTL GREATER ZERO
 11016         MOVE AL-UANON           TO EFFDTA
 11017     END-IF.
 11018
 11019     IF ACCOUNTL GREATER ZERO
 11020         MOVE AL-UANON           TO ACCOUNTA
 11021     END-IF.
 11022
 11023     IF STATEL GREATER ZERO
 11024         MOVE AL-UANON           TO STATEA
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 211
* EL130.cbl
 11025     END-IF.
 11026
 11027     IF CRTCARRL GREATER ZERO
 11028         MOVE AL-UANON           TO CRTCARRA
 11029     END-IF.
 11030
 11031     IF GROUPL GREATER ZERO
 11032         MOVE AL-UANON           TO GROUPA
 11033     END-IF.
 11034
 11035     IF CRTLNMEL GREATER ZERO
 11036         MOVE AL-UANON           TO CRTLNMEA
 11037     END-IF.
 11038
 11039     IF CRTFNMEL GREATER ZERO
 11040         MOVE AL-UANON           TO CRTFNMEA
 11041     END-IF.
 11042
 11043     IF CRTINITL GREATER ZERO
 11044         MOVE AL-UANON           TO CRTINITA
 11045     END-IF.
 11046
 11047     IF ISSAGEL GREATER ZERO
 11048         MOVE AL-UNNON           TO ISSAGEA
 11049     END-IF.
 11050
 11051     IF JNTLNMEL GREATER ZERO
 11052         MOVE AL-UANON           TO JNTLNMEA
 11053     END-IF.
 11054
 11055     IF JNTFNMEL GREATER ZERO
 11056         MOVE AL-UANON           TO JNTFNMEA
 11057     END-IF.
 11058
 11059     IF JNTINITL GREATER ZERO
 11060         MOVE AL-UANON           TO JNTINITA
 11061     END-IF.
 11062
 11063     IF JNTAGEL GREATER ZERO
 11064         MOVE AL-UNNON           TO JNTAGEA
 11065     END-IF.
 11066
 11067     IF CRTSSNL GREATER ZERO
 11068         MOVE AL-UANON           TO CRTSSNA
 11069     END-IF.
 11070
 11071     IF ACVDSCRL GREATER ZERO
 11072         MOVE AL-SANON           TO ACVDSCRA
 11073     END-IF.
 11074
 11075     IF ACVKINDL GREATER ZERO
 11076         MOVE AL-SANON           TO ACVKINDA
 11077     END-IF.
 11078
 11079     IF ACVCDL GREATER ZERO
 11080         MOVE AL-UANON           TO ACVCDA
 11081     END-IF.
 11082
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 212
* EL130.cbl
 11083     IF ACVOTRML GREATER ZERO
 11084         MOVE AL-UNNON           TO ACVOTRMA
 11085     END-IF.
 11086
 11087     IF ACVRTRML GREATER ZERO
 11088         MOVE AL-UNNON           TO ACVRTRMA
 11089     END-IF.
 11090
 11091     IF ACVRATEL GREATER ZERO
 11092         MOVE AL-UNNON           TO ACVRATEA
 11093     END-IF.
 11094
 11095     IF ACVBENEL GREATER ZERO
 11096         MOVE AL-UNNON           TO ACVBENEA
 11097     END-IF.
 11098
 11099     IF ACVFORML GREATER ZERO
 11100         MOVE AL-UANON           TO ACVFORMA
 11101     END-IF.
 11102
 11103     IF ACVCNDTL GREATER ZERO
 11104         MOVE AL-UANON           TO ACVCNDTA
 11105     END-IF.
 11106
 11107     IF ACVEXITL GREATER ZERO
 11108         MOVE AL-UANON           TO ACVEXITA
 11109     END-IF.
 11110
 11111     IF ACVSTATL GREATER ZERO
 11112         MOVE AL-UANON           TO ACVSTATA
 11113     END-IF.
 11114
 11115     IF LCVDSCRL GREATER ZERO
 11116         MOVE AL-SANON           TO LCVDSCRA
 11117     END-IF.
 11118
 11119     IF LCVKINDL GREATER ZERO
 11120         MOVE AL-SANON           TO LCVKINDA
 11121     END-IF.
 11122
 11123     IF LCVCDL GREATER ZERO
 11124         MOVE AL-UANON           TO LCVCDA
 11125     END-IF.
 11126
 11127     IF LCVOTRML GREATER ZERO
 11128         MOVE AL-UNNON           TO LCVOTRMA
 11129     END-IF.
 11130
 11131     IF LCVRTRML GREATER ZERO
 11132         MOVE AL-UNNON           TO LCVRTRMA
 11133     END-IF.
 11134
 11135     IF LCVRATEL GREATER ZERO
 11136         MOVE AL-UNNON           TO LCVRATEA
 11137     END-IF.
 11138
 11139     IF LCVBENEL GREATER ZERO
 11140         MOVE AL-UNNON           TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 213
* EL130.cbl
 11141     END-IF.
 11142
 11143     IF LCVFORML GREATER ZERO
 11144         MOVE AL-UANON           TO LCVFORMA
 11145     END-IF.
 11146
 11147     IF LCVCNDTL GREATER ZERO
 11148         MOVE AL-UANON           TO LCVCNDTA
 11149     END-IF.
 11150
 11151     IF LCVEXITL GREATER ZERO
 11152         MOVE AL-UANON           TO LCVEXITA
 11153     END-IF.
 11154
 11155     IF LCVSTATL GREATER ZERO
 11156         MOVE AL-UANON           TO LCVSTATA
 11157     END-IF.
 11158
 11159     IF MEMCAPL GREATER ZERO
 11160         MOVE AL-UANON           TO MEMCAPA
 11161     END-IF.
 11162
 11163     IF APRL GREATER ZERO
 11164         MOVE AL-UNNON           TO APRA
 11165     END-IF.
 11166
 11167     IF PMTFREQL GREATER ZERO
 11168         MOVE AL-UNNON           TO PMTFREQA
 11169     END-IF.
 11170
 11171     IF INDGRPL GREATER ZERO
 11172         MOVE AL-UANON           TO INDGRPA
 11173     END-IF.
 11174
 11175     IF PREMTYPL GREATER ZERO
 11176         MOVE AL-UANON           TO PREMTYPA
 11177     END-IF.
 11178
 11179     IF REINCDL GREATER ZERO
 11180         MOVE AL-UANON           TO REINCDA
 11181     END-IF.
 11182
 11183     IF ADDONDTL GREATER ZERO
 11184         MOVE AL-UANON           TO ADDONDTA
 11185     END-IF.
 11186
 11187     IF MEMBERL GREATER ZERO
 11188         MOVE AL-UANON           TO MEMBERA
 11189     END-IF.
 11190
 11191     IF BCERT1L GREATER ZERO
 11192         MOVE AL-SANON           TO BCERT1A
 11193                                    BSUFX1A
 11194     END-IF.
 11195
 11196     IF BCERT2L GREATER ZERO
 11197         MOVE AL-SANON           TO BCERT2A
 11198                                    BSUFX2A
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 214
* EL130.cbl
 11199     END-IF.
 11200
 11201     IF BCERT3L GREATER ZERO
 11202         MOVE AL-SANON           TO BCERT3A
 11203                                    BSUFX3A
 11204     END-IF.
 11205
 11206     IF BCERT4L GREATER ZERO
 11207         MOVE AL-SANON           TO BCERT4A
 11208                                    BSUFX4A
 11209     END-IF.
 11210
 11211     IF BCERT5L GREATER ZERO
 11212         MOVE AL-SANON           TO BCERT5A
 11213                                    BSUFX5A
 11214     END-IF.
 11215
 11216 3993-MODIFY-CLAIM-ATTRB.
 11217
 11218     IF PCERTNOL GREATER ZERO
 11219         MOVE AL-UANON           TO PCERTNOA
 11220     END-IF.
 11221
 11222     IF PSUFXL GREATER ZERO
 11223         MOVE AL-UANON           TO PSUFXA
 11224     END-IF.
 11225
 11226     IF LSTNMEL GREATER ZERO
 11227         MOVE AL-UANON           TO LSTNMEA
 11228     END-IF.
 11229
 11230     IF FSTNMEL GREATER ZERO
 11231         MOVE AL-UANON           TO FSTNMEA
 11232     END-IF.
 11233
 11234     IF INITL GREATER ZERO
 11235         MOVE AL-UANON           TO INITA
 11236     END-IF.
 11237
 11238     IF SEXL GREATER ZERO
 11239         MOVE AL-UANON           TO SEXA
 11240     END-IF.
 11241
 11242     IF BIRTHDTL GREATER ZERO
 11243         MOVE AL-UANON           TO BIRTHDTA
 11244     END-IF.
 11245
 11246     IF SSNL GREATER ZERO
 11247         MOVE AL-UANON           TO SSNA
 11248     END-IF.
 11249
 11250     IF INCURL GREATER ZERO
 11251         MOVE AL-UANON           TO INCURA
 11252     END-IF.
 11253
 11254     IF REPORTL GREATER ZERO
 11255         MOVE AL-UANON           TO REPORTA
 11256     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 215
* EL130.cbl
 11257
 11258*    IF ESTENDL GREATER ZERO
 11259*        MOVE AL-UANON           TO ESTENDA
 11260*    END-IF.
 11261
 11262     IF DIAGL GREATER ZERO
 11263         MOVE AL-UANON           TO DIAGA
 11264     END-IF.
 11265*
 11266     IF ICD1L GREATER ZERO
 11267         MOVE AL-UANON           TO ICD1A
 11268     END-IF.
 11269
 11270     IF ICD2L GREATER ZERO
 11271         MOVE AL-UANON           TO ICD2A
 11272     END-IF.
 11273
 11274*    IF CAUSEL GREATER ZERO
 11275*        MOVE AL-UANON           TO CAUSEA
 11276*    END-IF.
 11277
 11278     IF MANRSVL GREATER ZERO
 11279         MOVE AL-UNNON           TO MANRSVA
 11280     END-IF.
 11281
 11282     IF RELCLML GREATER ZERO
 11283         MOVE AL-UANON           TO RELCLMA
 11284     END-IF.
 11285
 11286     IF LOANNOL GREATER ZERO
 11287         MOVE AL-UANON           TO LOANNOA
 11288     END-IF.
 11289
 11290     IF LOANBALL GREATER ZERO
 11291         MOVE AL-UNNON           TO LOANBALA
 11292     END-IF.
 11293
 11294     IF PROCCDL GREATER ZERO
 11295         MOVE AL-UANON           TO PROCCDA
 11296     END-IF.
 11297
 11298     IF BENECDL GREATER THAN ZERO
 11299         MOVE AL-UANON           TO  BENECDA
 11300     END-IF.
 11301
 11302     IF PRICDL GREATER ZERO
 11303         MOVE AL-UANON           TO PRICDA
 11304     END-IF.
 11305
 11306     IF SUPVL GREATER ZERO
 11307         MOVE AL-UANON           TO SUPVA
 11308     END-IF.
 11309
 11310     IF FILETOL GREATER ZERO
 11311         MOVE AL-UANON           TO FILETOA
 11312     END-IF.
 11313
 11314
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 216
* EL130.cbl
 11315 3993-MODIFY-CLAIM-KEY-ATTRB.
 11316
 11317     IF CLMNOL GREATER ZERO
 11318         MOVE AL-UANON           TO CLMNOA
 11319     END-IF.
 11320
 11321     IF CLMCARRL GREATER ZERO
 11322         MOVE AL-UANON           TO CLMCARRA
 11323     END-IF.
 11324
 11325     IF CLMTYPEL GREATER ZERO
 11326         MOVE AL-UANON           TO CLMTYPEA
 11327     END-IF.
 11328
 11329     IF CERTNOL GREATER ZERO
 11330         MOVE AL-SANON           TO CERTNOA
 11331     END-IF.
 11332
 11333     IF SUFXL GREATER ZERO
 11334         MOVE AL-SANON           TO SUFXA
 11335     END-IF.
 11336
 11337 3993-EXIT.
 11338     EXIT.
 11339
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 217
* EL130.cbl
 11341 3994-BUILD-NINETY-THREE-TRAILER.
 11342
 11343     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11344     MOVE 'AT'                   TO AT-RECORD-ID.
 11345
 11346     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11347     MOVE CLMCARRI               TO AT-CARRIER.
 11348
 11349     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11350     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11351     MOVE +93                    TO AT-SEQUENCE-NO.
 11352     MOVE '6'                    TO AT-TRAILER-TYPE.
 11353     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11354
 11355     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'
 11356         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11357     ELSE
 11358         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11359     END-IF
 11360
 11361     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11362                                    AT-GEN-INFO-LAST-MAINT-DT.
 11363
 11364     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11365                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11366     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11367
 11368
 11369
 11370* EXEC CICS WRITE
 11371*        DATASET   (ELTRLR-DSID)
 11372*        FROM      (ACTIVITY-TRAILERS)
 11373*        RIDFLD    (AT-CONTROL-PRIMARY)
 11374*    END-EXEC.
 11375     MOVE LENGTH OF
 11376      ACTIVITY-TRAILERS
 11377       TO DFHEIV11
 11378*    MOVE '&$ L                  ''   #00010577' TO DFHEIV0
 11379     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11380     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11381     MOVE X'2020233030303130353737' TO DFHEIV0(25:11)
 11382     CALL 'kxdfhei1' USING DFHEIV0,
 11383           ELTRLR-DSID,
 11384           ACTIVITY-TRAILERS,
 11385           DFHEIV11,
 11386           AT-CONTROL-PRIMARY,
 11387           DFHEIV99,
 11388           DFHEIV99
 11389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11390
 11391
 11392 3994-EXIT.
 11393     EXIT.
 11394
 11395 3994B-BUILD-NINETY-FOUR-TRAILER.
 11396
 11397     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11398     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 218
* EL130.cbl
 11399
 11400     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11401     MOVE CLMCARRI               TO AT-CARRIER.
 11402
 11403     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11404     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11405     MOVE +94                    TO AT-SEQUENCE-NO.
 11406     MOVE '6'                    TO AT-TRAILER-TYPE.
 11407     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11408
 11409     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11410
 11411     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11412                                    AT-GEN-INFO-LAST-MAINT-DT.
 11413
 11414     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11415                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11416     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11417
 11418
 11419
 11420* EXEC CICS WRITE
 11421*        DATASET   (ELTRLR-DSID)
 11422*        FROM      (ACTIVITY-TRAILERS)
 11423*        RIDFLD    (AT-CONTROL-PRIMARY)
 11424*    END-EXEC.
 11425     MOVE LENGTH OF
 11426      ACTIVITY-TRAILERS
 11427       TO DFHEIV11
 11428*    MOVE '&$ L                  ''   #00010610' TO DFHEIV0
 11429     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11430     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11431     MOVE X'2020233030303130363130' TO DFHEIV0(25:11)
 11432     CALL 'kxdfhei1' USING DFHEIV0,
 11433           ELTRLR-DSID,
 11434           ACTIVITY-TRAILERS,
 11435           DFHEIV11,
 11436           AT-CONTROL-PRIMARY,
 11437           DFHEIV99,
 11438           DFHEIV99
 11439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11440
 11441
 11442 3994B-EXIT.
 11443     EXIT.
 11444 3994C-BUILD-NINETY-FIVE-TRAILER.
 11445
 11446     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11447     MOVE 'AT'                   TO AT-RECORD-ID
 11448
 11449     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11450     MOVE CLMCARRI               TO AT-CARRIER
 11451
 11452     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11453     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11454     MOVE +95                    TO AT-SEQUENCE-NO
 11455     MOVE '6'                    TO AT-TRAILER-TYPE
 11456     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 219
* EL130.cbl
 11457
 11458     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11459                                    AT-GEN-INFO-LAST-MAINT-DT
 11460
 11461     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11462                                    AT-GEN-INFO-LAST-UPDATED-BY
 11463     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11464
 11465     perform varying e1 from +1 by +1 until
 11466        ws-error-no (e1) = spaces
 11467        move ws-error-no (e1)    to at-note-error-no (e1)
 11468     end-perform
 11469
 11470     if at-info-line-1 not = spaces
 11471
 11472* EXEC CICS WRITE
 11473*          DATASET  (ELTRLR-DSID)
 11474*          FROM     (ACTIVITY-TRAILERS)
 11475*          RIDFLD   (AT-CONTROL-PRIMARY)
 11476*       END-EXEC
 11477     MOVE LENGTH OF
 11478      ACTIVITY-TRAILERS
 11479       TO DFHEIV11
 11480*    MOVE '&$ L                  ''   #00010645' TO DFHEIV0
 11481     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11482     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11483     MOVE X'2020233030303130363435' TO DFHEIV0(25:11)
 11484     CALL 'kxdfhei1' USING DFHEIV0,
 11485           ELTRLR-DSID,
 11486           ACTIVITY-TRAILERS,
 11487           DFHEIV11,
 11488           AT-CONTROL-PRIMARY,
 11489           DFHEIV99,
 11490           DFHEIV99
 11491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11492     end-if
 11493
 11494     .
 11495 3994C-EXIT.
 11496     EXIT.
 11497 3995-BUILD-CLAIM-RECORD.
 11498     IF PROCCDL GREATER ZERO
 11499         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11500     ELSE
 11501         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11502     END-IF.
 11503
 11504     IF FSTNMEL GREATER ZERO
 11505         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11506     END-IF.
 11507
 11508     IF INITL GREATER ZERO
 11509         MOVE INITI              TO CL-INSURED-MID-INIT
 11510     END-IF.
 11511
 11512     IF BIRTHDTL GREATER ZERO
 11513         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11514     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 220
* EL130.cbl
 11515
 11516     IF SEXL GREATER ZERO
 11517         MOVE SEXI               TO CL-INSURED-SEX-CD
 11518     END-IF.
 11519
 11520     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11521
 11522*    IF CLMTYPEL GREATER ZERO
 11523     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11524*    END-IF.
 11525
 11526     IF PREMTYPL GREATER ZERO
 11527         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11528     END-IF.
 11529
 11530     IF INCURL GREATER ZERO
 11531         MOVE WS-INCUR           TO CL-INCURRED-DT
 11532     END-IF.
 11533
 11534     IF (PI-COMPANY-ID = 'DCC' OR 'VPP')
 11535        AND (ERPDEF-FOUND)
 11536        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11537*       MOVE WS-CRIT-PER-RECURRENT
 11538*                                TO CL-CRIT-PER-RECURRENT
 11539*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11540        if ws-crit-per-recurrent > 01
 11541           move zeros            to cl-benefit-period
 11542        end-if
 11543     ELSE
 11544        IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
 11545           MOVE CM-LF-CRITICAL-PERIOD
 11546                                 TO CL-CRITICAL-PERIOD
 11547        ELSE
 11548           MOVE CM-AH-CRITICAL-PERIOD
 11549                                 TO CL-CRITICAL-PERIOD
 11550        END-IF
 11551     END-IF
 11552
 11553     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11554        COMPUTE DC-ELAPSED-MONTHS =
 11555           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11556        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11557        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11558        MOVE '6'                 TO DC-OPTION-CODE
 11559        PERFORM 9700-LINK-DATE-CONVERT
 11560                                 THRU 9700-EXIT
 11561        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11562     END-IF
 11563
 11564     if instypel > zero
 11565        move instypei            to cl-insured-type
 11566     end-if
 11567     IF REPORTL GREATER ZERO
 11568         MOVE WS-REPORT          TO CL-REPORTED-DT
 11569     END-IF.
 11570
 11571     IF EIBAID = DFHPF6
 11572         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 221
* EL130.cbl
 11573             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11574                 IF EMI-FORCABLE-CTR = +1
 11575                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11576                 END-IF
 11577         END-IF
 11578     END-IF.
 11579
 11580*    IF ESTENDL GREATER ZERO
 11581*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11582*    END-IF.
 11583
 11584     IF ADDONDTL GREATER ZERO
 11585         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11586     END-IF.
 11587
 11588*    IF CAUSEL GREATER ZERO
 11589*        MOVE CAUSEI             TO CL-CAUSE-CD
 11590*    END-IF.
 11591
 11592     IF SSNL GREATER ZERO
 11593         MOVE SSNI               TO CL-SOC-SEC-NO
 11594     ELSE
 11595         MOVE CERT-STATE         TO CL-SSN-STATE
 11596         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11597         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11598     END-IF.
 11599
 11600     IF PRICDL GREATER ZERO
 11601         MOVE PRICDI             TO CL-PRIORITY-CD
 11602     END-IF.
 11603
 11604     IF SUPVL GREATER ZERO
 11605         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11606     END-IF.
 11607
 11608     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11609     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11610     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11611
 11612     IF RELCLML GREATER ZERO
 11613         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11614     END-IF.
 11615
 11616     IF FILETOL GREATER ZERO
 11617         MOVE FILETOI            TO CL-FILE-LOCATION
 11618     END-IF.
 11619
 11620 3995-EXIT.
 11621      EXIT.
 11622 3996-read-cert-claim-trailer.
 11623
 11624     move cm-ah-benefit-amt      to ws-monthly-benefit
 11625     if (pi-dcc-max-amt < ws-monthly-benefit)
 11626        and (pi-dcc-max-amt not = zeros)
 11627        move pi-dcc-max-amt      to ws-monthly-benefit
 11628     end-if
 11629
 11630     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 222
* EL130.cbl
 11631     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11632     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11633     MOVE CM-STATE               TO CTRLR-STATE
 11634     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11635     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11636     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11637     MOVE 'B'                    TO CTRLR-REC-TYPE
 11638
 11639* EXEC CICS READ
 11640*       DATASET  (ELCRTT-DSID)
 11641*       set     (address of CERTIFICATE-TRAILERS)
 11642*       RIDFLD   (ELCRTT-KEY)
 11643*       RESP     (WS-RESPONSE)
 11644*    END-EXEC
 11645*    MOVE '&"S        E          (  N#00010796' TO DFHEIV0
 11646     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11648     MOVE X'204E233030303130373936' TO DFHEIV0(25:11)
 11649     CALL 'kxdfhei1' USING DFHEIV0,
 11650           ELCRTT-DSID,
 11651           DFHEIV20,
 11652           DFHEIV99,
 11653           ELCRTT-KEY,
 11654           DFHEIV99,
 11655           DFHEIV99,
 11656           DFHEIV99
 11657     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11658         DFHEIV20
 11659     MOVE EIBRESP  TO WS-RESPONSE
 11660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11661***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11662***                                                            ***
 11663***  This may need some work here. I think I should accumulate ***
 11664***  all the claims with the same claim type?????????          ***
 11665***                                                            ***
 11666***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11667     IF WS-RESP-NORMAL
 11668        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11669        perform varying s1 from +1 by +1 until
 11670           (s1 > +24)
 11671           or (cs-claim-no (s1) = spaces)
 11672           if cs-claim-type (s1) = clmtypei
 11673              move er-1659       to ws-error-no (e1)
 11674              compute ws-tot-days-paid =
 11675                 ws-tot-days-paid + cs-days-paid (s1)
 11676              compute ws-tot-amt-paid =
 11677                 ws-tot-amt-paid + cs-total-paid (s1)
 11678           end-if
 11679        end-perform
 11680*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11681*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11682*           and (pi-dcc-max-benefits not = zeros)
 11683*           add +1                to e1
 11684*           MOVE ER-1660          TO EMI-ERROR
 11685*                                    ws-error-no (e1)
 11686*           PERFORM 9900-ERROR-FORMAT
 11687*                                 THRU 9900-EXIT
 11688*        end-if
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 223
* EL130.cbl
 11689     end-if
 11690**       if instypei = 'P'
 11691**          move +1 to s1
 11692**       else
 11693**          MOVE +2 to s1
 11694**       end-if
 11695*
 11696*        move +1 to s1
 11697*        evaluate clmtypei
 11698*           when 'A'
 11699*              move +1 to s2
 11700*           when 'I'
 11701*              move +2 to s2
 11702*           when 'G'
 11703*              move +3 to s2
 11704*           when 'L'
 11705*              move +4 to s2
 11706*           when 'P'
 11707*              move +5 to s2
 11708*        end-evaluate
 11709*        if cs-claim-type (s1 s2) = clmtypei
 11710*           if cs-no-of-claims (s1 s2) > zeros
 11711*              move er-1659       to ws-error-no (e1)
 11712*           end-if
 11713*           compute WS-BENEFITS-PREV-PAID =
 11714*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11715*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11716*              and (pi-dcc-max-benefits not = zeros)
 11717*              add +1             to e1
 11718*              MOVE ER-1660       TO EMI-ERROR
 11719*                                    ws-error-no (e1)
 11720*              PERFORM 9900-ERROR-FORMAT
 11721*                                 THRU 9900-EXIT
 11722*           end-if
 11723*        end-if
 11724*     end-if
 11725
 11726     .
 11727 3996-exit.
 11728     exit.
 11729
 11730 3997-GET-ERPDEF.
 11731
 11732     if cm-clp-state = spaces or low-values or zeros
 11733        move cm-state            to cm-clp-state
 11734     end-if
 11735     MOVE SPACES                 TO WS-ERPDEF-SW
 11736     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11737                                    WS-CRIT-PER-RTW-MOS
 11738                                    WS-CRIT-PER-RECURRENT
 11739
 11740     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11741     MOVE CM-clp-state        TO ERPDEF-STATE
 11742     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11743***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11744***                                                            ***
 11745***  If they set up a claim where there is no coverage on the  ***
 11746***  addendum with the intention of denying.  We need to do    ***
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 224
* EL130.cbl
 11747***  some funky stuff here.                                    ***
 11748***                                                            ***
 11749***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11750
 11751     evaluate true
 11752        when (clmtypei = 'L' or 'P')
 11753           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 11754              and 'CU')
 11755           move 'L'              to erpdef-ben-type
 11756           move cm-lf-benefit-cd to erpdef-ben-code
 11757        when (clmtypei not = 'L' and 'P')
 11758           and (cm-ah-benefit-cd not = '00' and '  ')
 11759           move 'A'              to erpdef-ben-type
 11760           move cm-ah-benefit-cd to erpdef-ben-code
 11761        when (clmtypei not = 'L' and 'P')
 11762           and (cm-ah-benefit-cd = '00' or '  ')
 11763           move 'L'              to erpdef-ben-type
 11764           move cm-lf-benefit-cd to erpdef-ben-code
 11765        when (clmtypei = 'L' or 'P')
 11766           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 11767           move 'A'              to erpdef-ben-type
 11768           move cm-ah-benefit-cd to erpdef-ben-code
 11769        when other
 11770           move 'A'              to erpdef-ben-type
 11771           move cm-ah-benefit-cd to erpdef-ben-code
 11772     end-evaluate
 11773*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11774*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11775     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11776     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11777
 11778
 11779* EXEC CICS STARTBR
 11780*        DATASET  ('ERPDEF')
 11781*        RIDFLD   (ERPDEF-KEY)
 11782*        GTEQ
 11783*        RESP     (WS-RESPONSE)
 11784*    END-EXEC
 11785     MOVE 'ERPDEF' TO DFHEIV1
 11786     MOVE 0
 11787       TO DFHEIV11
 11788*    MOVE '&,         G          &  N#00010919' TO DFHEIV0
 11789     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11790     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11791     MOVE X'204E233030303130393139' TO DFHEIV0(25:11)
 11792     CALL 'kxdfhei1' USING DFHEIV0,
 11793           DFHEIV1,
 11794           ERPDEF-KEY,
 11795           DFHEIV99,
 11796           DFHEIV11,
 11797           DFHEIV99
 11798     MOVE EIBRESP  TO WS-RESPONSE
 11799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11800
 11801     IF WS-RESP-NORMAL
 11802
 11803* EXEC CICS READNEXT
 11804*          DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 225
* EL130.cbl
 11805*          INTO     (PRODUCT-MASTER)
 11806*          RIDFLD   (ERPDEF-KEY)
 11807*          RESP     (WS-RESPONSE)
 11808*       END-EXEC
 11809     MOVE LENGTH OF
 11810      PRODUCT-MASTER
 11811       TO DFHEIV12
 11812     MOVE 'ERPDEF' TO DFHEIV1
 11813     MOVE 0
 11814       TO DFHEIV11
 11815*    MOVE '&.IL                  )  N#00010927' TO DFHEIV0
 11816     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11817     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11818     MOVE X'204E233030303130393237' TO DFHEIV0(25:11)
 11819     CALL 'kxdfhei1' USING DFHEIV0,
 11820           DFHEIV1,
 11821           PRODUCT-MASTER,
 11822           DFHEIV12,
 11823           ERPDEF-KEY,
 11824           DFHEIV99,
 11825           DFHEIV11,
 11826           DFHEIV99,
 11827           DFHEIV99
 11828     MOVE EIBRESP  TO WS-RESPONSE
 11829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11830
 11831        IF WS-RESP-NORMAL
 11832           IF (ERPDEF-KEY-SAVE (1:16) =
 11833              PD-CONTROL-PRIMARY (1:16))
 11834              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11835
 11836              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11837                 (A1 > +8)
 11838                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11839              END-PERFORM
 11840              IF A1 < +9
 11841                 SET ERPDEF-FOUND TO TRUE
 11842                 move pd-max-amt (a1)
 11843                              to pi-dcc-max-amt
 11844                 MOVE PD-CRIT-PERIOD (A1)
 11845                              TO WS-MAX-BENEFITS
 11846                                 pi-dcc-max-benefits
 11847                 if pd-rec-crit-period (a1) not numeric
 11848                    move 01      to pd-rec-crit-period (a1)
 11849                 end-if
 11850                 MOVE PD-REC-CRIT-PERIOD (A1)
 11851                              TO WS-CRIT-PER-RECURRENT
 11852                 IF PD-RTW-MOS (A1) NUMERIC
 11853                    MOVE PD-RTW-MOS (A1)
 11854                              TO WS-CRIT-PER-RTW-MOS
 11855                 ELSE
 11856                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11857                 END-IF
 11858                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11859                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11860                                 TO WS-EXCL-PERIOD
 11861                 END-IF
 11862                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 226
* EL130.cbl
 11863                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11864                                 TO WS-COV-ENDS
 11865                 END-IF
 11866                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11867                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11868                                 TO WS-ACC-PERIOD
 11869                 END-IF
 11870                 IF PD-PRE-EXIST-EXCL-TYPE (A1) NUMERIC
 11871                    MOVE PD-PRE-EXIST-EXCL-TYPE (A1)
 11872                                 TO WS-PRE-EXISTING-PER
 11873                 END-IF
 11874              else
 11875                 MOVE -1         TO MAINTL
 11876                 move er-1673    to emi-error
 11877                 PERFORM 9900-ERROR-FORMAT
 11878                                 THRU 9900-EXIT
 11879              END-IF
 11880           else
 11881              MOVE -1            TO MAINTL
 11882              move er-1671       to emi-error
 11883              PERFORM 9900-ERROR-FORMAT
 11884                                 THRU 9900-EXIT
 11885           END-IF
 11886        END-IF
 11887     END-IF
 11888
 11889     .
 11890 3997-EXIT.
 11891     EXIT.
 11892
 11893 3998-update-cert-claim-trailer.
 11894
 11895
 11896* EXEC CICS GETMAIN
 11897*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11898*       LENGTH   (ELCRTT-LENGTH)
 11899*       INITIMG  (GETMAIN-SPACE)
 11900*    END-EXEC
 11901*    MOVE ',"IL                  $   #00010998' TO DFHEIV0
 11902     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11904     MOVE X'2020233030303130393938' TO DFHEIV0(25:11)
 11905     CALL 'kxdfhei1' USING DFHEIV0,
 11906           DFHEIV20,
 11907           ELCRTT-LENGTH,
 11908           GETMAIN-SPACE
 11909     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11910         DFHEIV20
 11911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11912
 11913     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11914     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11915     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11916     MOVE CM-STATE         TO CTRLR-STATE
 11917     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11918     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11919     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11920     MOVE 'B'              TO CTRLR-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 227
* EL130.cbl
 11921
 11922* EXEC CICS READ
 11923*       UPDATE
 11924*       DATASET  (ELCRTT-DSID)
 11925*       into     (CERTIFICATE-TRAILERS)
 11926*       RIDFLD   (ELCRTT-KEY)
 11927*       RESP     (WS-RESPONSE)
 11928*    END-EXEC
 11929     MOVE LENGTH OF
 11930      CERTIFICATE-TRAILERS
 11931       TO DFHEIV11
 11932*    MOVE '&"IL       EU         (  N#00011012' TO DFHEIV0
 11933     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11934     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11935     MOVE X'204E233030303131303132' TO DFHEIV0(25:11)
 11936     CALL 'kxdfhei1' USING DFHEIV0,
 11937           ELCRTT-DSID,
 11938           CERTIFICATE-TRAILERS,
 11939           DFHEIV11,
 11940           ELCRTT-KEY,
 11941           DFHEIV99,
 11942           DFHEIV99,
 11943           DFHEIV99
 11944     MOVE EIBRESP  TO WS-RESPONSE
 11945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11946     IF WS-RESP-NORMAL
 11947        perform varying s1 from +1 by +1 until
 11948           (s1 > +24)
 11949           or (cs-claim-no (s1) = spaces)
 11950        end-perform
 11951        if s1 < +25
 11952           perform 3999-upd-crt-trlr thru 3999-exit
 11953
 11954* EXEC CICS REWRITE
 11955*             DATASET  (ELCRTT-DSID)
 11956*             from     (CERTIFICATE-TRAILERS)
 11957*             RESP     (WS-RESPONSE)
 11958*          END-EXEC
 11959     MOVE LENGTH OF
 11960      CERTIFICATE-TRAILERS
 11961       TO DFHEIV11
 11962*    MOVE '&& L                  %  N#00011026' TO DFHEIV0
 11963     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11964     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11965     MOVE X'204E233030303131303236' TO DFHEIV0(25:11)
 11966     CALL 'kxdfhei1' USING DFHEIV0,
 11967           ELCRTT-DSID,
 11968           CERTIFICATE-TRAILERS,
 11969           DFHEIV11,
 11970           DFHEIV99
 11971     MOVE EIBRESP  TO WS-RESPONSE
 11972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11973        end-if
 11974     else
 11975        if ws-resp-notfnd
 11976           move 'CS'             to certificate-trailers
 11977           move cm-control-primary to cs-control-primary
 11978           move 'B'              to cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 228
* EL130.cbl
 11979           perform varying s1 from +1 by +1 until s1 > +24
 11980              move zeros         to cs-days-paid (s1)
 11981                                    cs-total-paid (s1)
 11982                                    cs-benefit-period (s1)
 11983                                    cs-remaining-bens (s1)
 11984           end-perform
 11985           move +1               to s1
 11986           perform 3999-upd-crt-trlr
 11987                                 thru 3999-exit
 11988
 11989* EXEC CICS WRITE
 11990*             DATASET  (ELCRTT-DSID)
 11991*             from     (CERTIFICATE-TRAILERS)
 11992*             RIDFLD   (cs-control-primary)
 11993*             RESP     (WS-RESPONSE)
 11994*          END-EXEC
 11995     MOVE LENGTH OF
 11996      CERTIFICATE-TRAILERS
 11997       TO DFHEIV11
 11998*    MOVE '&$ L                  ''  N#00011046' TO DFHEIV0
 11999     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12000     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12001     MOVE X'204E233030303131303436' TO DFHEIV0(25:11)
 12002     CALL 'kxdfhei1' USING DFHEIV0,
 12003           ELCRTT-DSID,
 12004           CERTIFICATE-TRAILERS,
 12005           DFHEIV11,
 12006           cs-control-primary,
 12007           DFHEIV99,
 12008           DFHEIV99
 12009     MOVE EIBRESP  TO WS-RESPONSE
 12010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12011        end-if
 12012     END-IF
 12013
 12014     .
 12015 3998-exit.
 12016     exit.
 12017
 12018 3999-upd-crt-trlr.
 12019     move clmnoi                 to cs-claim-no       (s1)
 12020     move clmtypei               to cs-claim-type     (s1)
 12021     move instypei               to cs-insured-type   (s1)
 12022     if ws-crit-per-recurrent > 01
 12023        move zeros               to cs-benefit-period(s1)
 12024     else
 12025        move 01                  to cs-benefit-period(s1)
 12026     end-if
 12027*    move cl-benefit-period      to cs-benefit-period (s1)
 12028*    move cl-critical-period     to cs-remaining-bens (s1)
 12029     move zeros                  to cs-remaining-bens (s1)
 12030     .
 12031 3999-exit.
 12032     exit.
 12033 4000-CALCULATE-CERT-TERM.
 12034
 12035     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 12036
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 229
* EL130.cbl
 12037     MOVE N                      TO WS-TERM.
 12038
 12039     IF WS-TERM GREATER 120
 12040         MOVE 120                TO WS-TERM
 12041     END-IF.
 12042
 12043 4000-CALC-TERM-EXIT.
 12044      EXIT.
 12045
 12046 4100-CALC-GROSS-TERM.
 12047     MOVE HOLD-LOAN-BAL           TO L.
 12048     MOVE WS-ACVBENE              TO M.
 12049     COMPUTE N = L / M.
 12050     IF N LESS 1
 12051         MOVE 1  TO N
 12052     END-IF.
 12053
 12054     IF LCVCDL GREATER ZERO
 12055         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 12056     ELSE
 12057         MOVE ZEROS               TO WS-LF-RATE
 12058     END-IF.
 12059
 12060     IF ACVCDL GREATER ZERO
 12061         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 12062     ELSE
 12063         MOVE ZEROS               TO WS-AH-RATE
 12064     END-IF.
 12065
 12066     COMPUTE I = WS-APR / +1200.
 12067
 12068 4105-LOOP.
 12069     IF N GREATER 240
 12070         GO TO 4200-EXIT
 12071     END-IF.
 12072
 12073     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 12074
 12075     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 12076         ADD 1 TO N
 12077         GO TO 4105-LOOP
 12078     END-IF.
 12079
 12080 4200-EXIT.
 12081      EXIT.
 12082
 12083 4210-CALC-LEFT-RIGHTONE.
 12084      MOVE L         TO LEFT-TOT-1.
 12085      SUBTRACT 1 FROM N.
 12086      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12087      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 12088      ADD 1 TO N.
 12089
 12090 4211-CALC-TERM1.
 12091      MOVE N         TO TERM1.
 12092      MULTIPLY M BY TERM1.
 12093
 12094 4212-LOOP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 230
* EL130.cbl
 12095      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 12096      ADD 1 TO A-N.
 12097      MULTIPLY A-N BY TERM1.
 12098      SUBTRACT 1 FROM A-N.
 12099      ADD TERM1 TO LEFT-TOT-1.
 12100
 12101 4213-CALC-TERM2.
 12102      MOVE M         TO TERM2.
 12103      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 12104      MULTIPLY IA-N BY TERM2.
 12105      SUBTRACT TERM2 FROM LEFT-TOT-1.
 12106
 12107 4215-CALC-RIGHTONE.
 12108      MOVE M         TO RIGHT-TOT-1.
 12109      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12110      MULTIPLY A-N BY RIGHT-TOT-1.
 12111
 12112 4220-EXIT.
 12113      EXIT.
 12114
 12115 4300-CALC-A-N.
 12116     IF N LESS 1
 12117         MOVE 0     TO A-N
 12118         GO TO 4300-EXIT
 12119     END-IF.
 12120
 12121     IF I = 0
 12122         MOVE .00001 TO I
 12123     END-IF.
 12124
 12125     ADD 1 TO I.
 12126     DIVIDE I INTO 1 GIVING V.
 12127     SUBTRACT 1 FROM I.
 12128     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12129     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 12130     DIVIDE I INTO TERM3 GIVING A-N.
 12131
 12132 4300-EXIT.
 12133      EXIT.
 12134
 12135 4350-CALC-IA-N.
 12136     IF N LESS 1
 12137         MOVE 0      TO IA-N
 12138         GO TO 4400-EXIT
 12139     END-IF.
 12140
 12141     ADD 1 TO N.
 12142     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12143     SUBTRACT 1 FROM N.
 12144     MULTIPLY N BY V-EX-N GIVING TERM3.
 12145     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 12146     SUBTRACT V FROM 1 GIVING TERM4.
 12147     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 12148
 12149 4400-EXIT.
 12150      EXIT.
 12151
 12152 4450-CALC-V-EX-N.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 231
* EL130.cbl
 12153     IF N LESS 1
 12154         MOVE 1    TO V-EX-N
 12155         GO TO 4490-EXIT
 12156     END-IF.
 12157
 12158     MOVE N        TO NV-STORE.
 12159
 12160     IF V-EX-ONETIME = 1  OR
 12161        V NOT = V-EXPONENT (1)
 12162          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 12163     END-IF.
 12164
 12165 4460-LOOP.
 12166     IF N GREATER 248
 12167         MOVE 248 TO N
 12168     END-IF.
 12169
 12170     IF N = 1
 12171         MOVE V               TO V-EX-N
 12172     ELSE
 12173         MOVE V-EXPONENT (N)  TO V-EX-N
 12174     END-IF.
 12175
 12176     GO TO 4490-EXIT.
 12177
 12178 4470-BUILD-V-EX-TABLE.
 12179     MOVE 2      TO N.
 12180     MOVE V      TO V-EXPONENT (1)
 12181                    V-EX-N.
 12182
 12183 4471-LOOP.
 12184     MULTIPLY V BY V-EX-N.
 12185     MOVE V-EX-N   TO V-EXPONENT (N).
 12186
 12187     ADD 1 TO N.
 12188     IF N LESS 248
 12189         GO TO 4471-LOOP
 12190     END-IF.
 12191
 12192     MOVE NV-STORE     TO N.
 12193     MOVE ZERO         TO V-EX-ONETIME.
 12194
 12195 4480-EXIT.
 12196      EXIT.
 12197
 12198 4490-EXIT.
 12199      EXIT.
 12200
 12201 4500-CALC-NET-TERM.
 12202     MOVE HOLD-LOAN-BAL           TO L.
 12203     MOVE WS-ACVBENE              TO M.
 12204     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 12205
 12206     IF WS-REMAIN GREATER ZERO
 12207         ADD 1 TO N
 12208     END-IF.
 12209
 12210     IF N = 0
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 232
* EL130.cbl
 12211         MOVE 1 TO N
 12212     END-IF.
 12213
 12214 4700-EXIT.
 12215      EXIT.
 12216
 12217 4999-CALC-TERM-EXIT.
 12218     EXIT.
 12219
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 233
* EL130.cbl
 12221 5000-INCURRED-CHANGE.
 12222     IF NOT MODIFY-CAP
 12223         MOVE ER-0070            TO EMI-ERROR
 12224         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12225         MOVE -1                 TO MAINTL
 12226         GO TO 8200-SEND-DATAONLY
 12227     END-IF.
 12228
 12229     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 12230        CLMCARRI     NOT = PI-LAST-CARR        OR
 12231        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 12232        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 12233        PI-INCURR-SW NOT = 'Y'
 12234          GO TO 1000-SHOW-CLAIM
 12235     END-IF.
 12236
 12237     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 12238     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 12239     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 12240
 12241     IF EMI-NO-ERRORS
 12242         GO TO 5000-TRY-TO-BUILD
 12243     END-IF.
 12244
 12245     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 12246        MOVE ER-0433             TO EMI-ERROR
 12247        MOVE -1                  TO MAINTL
 12248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12249        GO TO 8200-SEND-DATAONLY
 12250     END-IF.
 12251
 12252     IF EIBAID = DFHPF6
 12253         IF EMI-FATAL-CTR NOT EQUAL ZERO
 12254            MOVE ER-0434         TO EMI-ERROR
 12255            MOVE -1              TO MAINTL
 12256            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12257            GO TO 8200-SEND-DATAONLY
 12258         ELSE
 12259            MOVE +1              TO INCURL
 12260            GO TO 5000-TRY-TO-BUILD
 12261         END-IF
 12262     END-IF.
 12263
 12264     GO TO 8200-SEND-DATAONLY.
 12265
 12266 5000-TRY-TO-BUILD.
 12267
 12268     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12269
 12270     MOVE CLMCARRI               TO MSTR-CARRIER.
 12271
 12272     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 12273     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 12274     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 12275
 12276     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 12277
 12278     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 234
* EL130.cbl
 12279         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 12280     END-IF.
 12281
 12282     IF CL-PURGED-DT NOT = LOW-VALUES
 12283
 12284
 12285* EXEC CICS UNLOCK
 12286*            DATASET   (ELMSTR-DSID)
 12287*        END-EXEC
 12288*    MOVE '&*                    #   #00011325' TO DFHEIV0
 12289     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12290     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12291     MOVE X'2020233030303131333235' TO DFHEIV0(25:11)
 12292     CALL 'kxdfhei1' USING DFHEIV0,
 12293           ELMSTR-DSID,
 12294           DFHEIV99
 12295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12296         MOVE ER-7691            TO EMI-ERROR
 12297         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12298         MOVE -1                 TO MAINTL
 12299         GO TO 8200-SEND-DATAONLY
 12300     END-IF.
 12301
 12302     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12303
 12304
 12305* EXEC CICS UNLOCK
 12306*            DATASET   (ELMSTR-DSID)
 12307*       END-EXEC
 12308*    MOVE '&*                    #   #00011336' TO DFHEIV0
 12309     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12310     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12311     MOVE X'2020233030303131333336' TO DFHEIV0(25:11)
 12312     CALL 'kxdfhei1' USING DFHEIV0,
 12313           ELMSTR-DSID,
 12314           DFHEIV99
 12315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12316         MOVE ER-0523             TO EMI-ERROR
 12317         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12318         MOVE -1                  TO MAINTL
 12319         GO TO 8200-SEND-DATAONLY
 12320     END-IF.
 12321
 12322     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12323
 12324     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12325     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12326     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12327     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12328     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12329
 12330     IF MANRSVL GREATER ZERO
 12331        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12332                                    AT-CURRENT-MANUAL-RESERVE
 12333     END-IF.
 12334     MOVE 1                      TO SUB.
 12335
 12336 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 235
* EL130.cbl
 12337     IF SUB = 1
 12338        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12339        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12340        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12341     ELSE
 12342        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12343        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12344                                    AT-OPEN-CLOSE-REASON (SUB)
 12345     END-IF.
 12346
 12347     IF SUB NOT = 6
 12348        ADD 1                    TO SUB
 12349        GO TO 5010-LOOP
 12350     END-IF.
 12351
 12352 5020-UPDATE.
 12353
 12354     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12355
 12356     IF DIAGL = ZERO
 12357       AND ICD1L = ZERO
 12358       AND ICD2L = ZERO
 12359         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12360         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12361         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12362         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12363         GO TO 5025-BYPASS-UPDATE
 12364     END-IF.
 12365
 12366     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12367
 12368     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12369     IF DIAGL NOT = ZERO
 12370         MOVE DIAGI              TO AT-INFO-LINE-1
 12371     END-IF.
 12372
 12373     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12374     IF ICD1L NOT = ZERO
 12375         MOVE ICD1I              TO AT-ICD-CODE-1
 12376     END-IF.
 12377
 12378     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12379     IF ICD2L NOT = ZERO
 12380         MOVE ICD2I              TO AT-ICD-CODE-2
 12381     END-IF.
 12382
 12383     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12384
 12385 5025-BYPASS-UPDATE.
 12386
 12387
 12388
 12389* EXEC CICS GETMAIN
 12390*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12391*        LENGTH   (ELTRLR-LENGTH)
 12392*    END-EXEC.
 12393*    MOVE '," L                  $   #00011411' TO DFHEIV0
 12394     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 236
* EL130.cbl
 12395     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12396     MOVE X'2020233030303131343131' TO DFHEIV0(25:11)
 12397     CALL 'kxdfhei1' USING DFHEIV0,
 12398           DFHEIV20,
 12399           ELTRLR-LENGTH,
 12400           DFHEIV99
 12401     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12402         DFHEIV20
 12403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12404
 12405
 12406     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12407     MOVE 'AT'                   TO AT-RECORD-ID.
 12408
 12409     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12410     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12411     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12412     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12413     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12414     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12415     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12416     MOVE '9'                    TO AT-TRAILER-TYPE.
 12417     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12418     MOVE '5'                    TO DC-OPTION-CODE.
 12419     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12420     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12421
 12422     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12423     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12424
 12425     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12426     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12427     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12428     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12429     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12430     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12431     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12432     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12433     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12434     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12435     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12436     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12437
 12438     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12439     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12440     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12441     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12442     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12443
 12444
 12445
 12446* EXEC CICS WRITE
 12447*        DATASET   (ELTRLR-DSID)
 12448*        FROM      (ACTIVITY-TRAILERS)
 12449*        RIDFLD    (AT-CONTROL-PRIMARY)
 12450*    END-EXEC.
 12451     MOVE LENGTH OF
 12452      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 237
* EL130.cbl
 12453       TO DFHEIV11
 12454*    MOVE '&$ L                  ''   #00011455' TO DFHEIV0
 12455     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12456     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12457     MOVE X'2020233030303131343535' TO DFHEIV0(25:11)
 12458     CALL 'kxdfhei1' USING DFHEIV0,
 12459           ELTRLR-DSID,
 12460           ACTIVITY-TRAILERS,
 12461           DFHEIV11,
 12462           AT-CONTROL-PRIMARY,
 12463           DFHEIV99,
 12464           DFHEIV99
 12465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12466
 12467
 12468     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12469     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12470     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12471     MOVE CL-CERT-STATE          TO CERT-STATE.
 12472     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12473     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12474     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12475
 12476
 12477
 12478* EXEC CICS HANDLE CONDITION
 12479*        NOTFND   (5050-CERT-NOT-FOUND)
 12480*    END-EXEC.
 12481*    MOVE '"$I                   ! < #00011470' TO DFHEIV0
 12482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12484     MOVE X'3C20233030303131343730' TO DFHEIV0(25:11)
 12485     CALL 'kxdfhei1' USING DFHEIV0
 12486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12487
 12488
 12489     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12490
 12491     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12492
 12493
 12494
 12495* EXEC CICS HANDLE CONDITION
 12496*         DUPKEY   (5030-CERT-WRITTEN)
 12497*    END-EXEC.
 12498*    MOVE '"$$                   ! = #00011479' TO DFHEIV0
 12499     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12501     MOVE X'3D20233030303131343739' TO DFHEIV0(25:11)
 12502     CALL 'kxdfhei1' USING DFHEIV0
 12503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12504
 12505
 12506
 12507
 12508* EXEC CICS REWRITE
 12509*        DATASET  (ELCERT-DSID)
 12510*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 238
* EL130.cbl
 12511*    END-EXEC.
 12512     MOVE LENGTH OF
 12513      CERTIFICATE-MASTER
 12514       TO DFHEIV11
 12515*    MOVE '&& L                  %   #00011484' TO DFHEIV0
 12516     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12517     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12518     MOVE X'2020233030303131343834' TO DFHEIV0(25:11)
 12519     CALL 'kxdfhei1' USING DFHEIV0,
 12520           ELCERT-DSID,
 12521           CERTIFICATE-MASTER,
 12522           DFHEIV11,
 12523           DFHEIV99
 12524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12525
 12526
 12527 5030-CERT-WRITTEN.
 12528
 12529     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12530                                    CL-INCURRED-DT
 12531                                    CL-REPORTED-DT
 12532                                    CL-EST-END-OF-DISAB-DT
 12533                                    CL-PAID-THRU-DT.
 12534
 12535     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12536                                    CL-NO-OF-PMTS-MADE
 12537                                    CL-NO-OF-DAYS-PAID.
 12538
 12539     IF CLAIM-IS-CLOSED
 12540        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12541        MOVE 'O'                 TO CL-CLAIM-STATUS
 12542     END-IF.
 12543
 12544     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12545     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12546     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12547
 12548
 12549
 12550* EXEC CICS HANDLE CONDITION
 12551*         DUPKEY   (5035-CLAIM-WRITTEN)
 12552*    END-EXEC.
 12553*    MOVE '"$$                   ! > #00011511' TO DFHEIV0
 12554     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12556     MOVE X'3E20233030303131353131' TO DFHEIV0(25:11)
 12557     CALL 'kxdfhei1' USING DFHEIV0
 12558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12559
 12560
 12561
 12562
 12563* EXEC CICS REWRITE
 12564*        DATASET   (ELMSTR-DSID)
 12565*        FROM      (CLAIM-MASTER)
 12566*    END-EXEC.
 12567     MOVE LENGTH OF
 12568      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 239
* EL130.cbl
 12569       TO DFHEIV11
 12570*    MOVE '&& L                  %   #00011516' TO DFHEIV0
 12571     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12572     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12573     MOVE X'2020233030303131353136' TO DFHEIV0(25:11)
 12574     CALL 'kxdfhei1' USING DFHEIV0,
 12575           ELMSTR-DSID,
 12576           CLAIM-MASTER,
 12577           DFHEIV11,
 12578           DFHEIV99
 12579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12580
 12581
 12582 5035-CLAIM-WRITTEN.
 12583
 12584     MOVE ER-0000                TO EMI-ERROR.
 12585     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12586
 12587     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12588     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12589     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12590     MOVE CLMCARRI               TO PI-LAST-CARR.
 12591
 12592     IF PRTOPTL GREATER ZERO
 12593         MOVE PRTOPTI            TO PI-PRT-OPT
 12594     END-IF.
 12595
 12596     IF ALTPRTL GREATER ZERO
 12597         MOVE ALTPRTI            TO PI-ALT-PRT
 12598     END-IF.
 12599
 12600     MOVE LOW-VALUES             TO EL130AI.
 12601
 12602     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12603     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12604     MOVE PI-LAST-CARR           TO CLMCARRO.
 12605     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12606
 12607     IF PI-PRT-OPT = 'N' OR 'L'
 12608         MOVE PI-PRT-OPT         TO PRTOPTO
 12609         MOVE 1                  TO PRTOPTL
 12610     END-IF.
 12611
 12612     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12613         MOVE PI-ALT-PRT         TO ALTPRTO
 12614         MOVE 4                  TO ALTPRTL
 12615     END-IF.
 12616
 12617     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12618     MOVE AL-SANON               TO CERTNOA SUFXA.
 12619
 12620     MOVE SPACES                 TO PI-INCURR-SW.
 12621
 12622     IF PRTOPTL GREATER ZERO
 12623         IF PRTOPTI = 'L'
 12624             GO TO 0400-CREATE-ELACTQ
 12625         ELSE
 12626             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 240
* EL130.cbl
 12627         END-IF
 12628     END-IF.
 12629
 12630     GO TO 8100-SEND-INITIAL-MAP.
 12631
 12632 5050-CERT-NOT-FOUND.
 12633
 12634     MOVE ER-0244                TO EMI-ERROR.
 12635     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12636     MOVE -1                     TO CERTNOL.
 12637     GO TO 8200-SEND-DATAONLY.
 12638
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 241
* EL130.cbl
 12640 5500-BUILD-FORM-TRAILER.
 12641*************************************************************
 12642*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12643*************************************************************
 12644
 12645     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12646
 12647     IF  WS-BEN-ALPHA-2 = '30'
 12648         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12649         MOVE '6'                TO DC-OPTION-CODE
 12650         IF CL-CARRIER = 'C'
 12651             MOVE +14            TO DC-ELAPSED-DAYS
 12652             MOVE +0             TO DC-ELAPSED-MONTHS
 12653             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12654             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12655         ELSE
 12656             MOVE +21            TO DC-ELAPSED-DAYS
 12657             MOVE +0             TO DC-ELAPSED-MONTHS
 12658             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12659             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12660         END-IF
 12661     END-IF.
 12662
 12663
 12664
 12665* EXEC CICS GETMAIN
 12666*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12667*         LENGTH   (ELTRLR-LENGTH)
 12668*         INITIMG  (GETMAIN-SPACE)
 12669*    END-EXEC.
 12670*    MOVE ',"IL                  $   #00011603' TO DFHEIV0
 12671     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12672     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12673     MOVE X'2020233030303131363033' TO DFHEIV0(25:11)
 12674     CALL 'kxdfhei1' USING DFHEIV0,
 12675           DFHEIV20,
 12676           ELTRLR-LENGTH,
 12677           GETMAIN-SPACE
 12678     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12679         DFHEIV20
 12680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12681
 12682
 12683     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12684     MOVE 'AT'                   TO AT-RECORD-ID.
 12685
 12686     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12687     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12688     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12689     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12690                                    AT-FORM-LAST-MAINT-DT.
 12691     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12692                                    AT-FORM-LAST-UPDATED-BY.
 12693     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12694     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12695     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12696                                    AT-FORM-RE-SEND-DT
 12697                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 242
* EL130.cbl
 12698                                    AT-EMP-FORM-ANSWERED-DT
 12699                                    AT-PHY-FORM-ANSWERED-DT
 12700                                    AT-EMP-FORM-SEND-ON-DT
 12701                                    AT-FORM-PRINTED-DT
 12702                                    AT-FORM-REPRINT-DT.
 12703     MOVE '1'                    TO AT-FORM-TYPE.
 12704
 12705     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12706                                    AT-INSTRUCT-LN-2
 12707                                    AT-INSTRUCT-LN-3.
 12708
 12709     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12710     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12711
 12712     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12713
 12714     IF AM-EMPLOYER-STMT-USED = 'Y'
 12715        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12716     END-IF.
 12717
 12718
 12719
 12720* EXEC CICS WRITE
 12721*         DATASET  (ELTRLR-DSID)
 12722*         FROM     (ACTIVITY-TRAILERS)
 12723*         RIDFLD   (AT-CONTROL-PRIMARY)
 12724*    END-EXEC.
 12725     MOVE LENGTH OF
 12726      ACTIVITY-TRAILERS
 12727       TO DFHEIV11
 12728*    MOVE '&$ L                  ''   #00011645' TO DFHEIV0
 12729     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12730     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12731     MOVE X'2020233030303131363435' TO DFHEIV0(25:11)
 12732     CALL 'kxdfhei1' USING DFHEIV0,
 12733           ELTRLR-DSID,
 12734           ACTIVITY-TRAILERS,
 12735           DFHEIV11,
 12736           AT-CONTROL-PRIMARY,
 12737           DFHEIV99,
 12738           DFHEIV99
 12739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12740
 12741
 12742 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 243
* EL130.cbl
 12744*************************************************************
 12745*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12746*************************************************************
 12747
 12748 5700-BUILD-ARCHIVE-HEADER.
 12749
 12750     MOVE '1'                    TO CNTL-REC-TYPE.
 12751     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12752     MOVE SPACES                 TO CNTL-ACCESS.
 12753
 12754
 12755
 12756* EXEC CICS READ
 12757*         DATASET  (ELCNTL-DSID)
 12758*         SET      (ADDRESS OF CONTROL-FILE)
 12759*         RIDFLD   (ELCNTL-KEY)
 12760*         UPDATE
 12761*    END-EXEC.
 12762*    MOVE '&"S        EU         (   #00011664' TO DFHEIV0
 12763     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12764     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12765     MOVE X'2020233030303131363634' TO DFHEIV0(25:11)
 12766     CALL 'kxdfhei1' USING DFHEIV0,
 12767           ELCNTL-DSID,
 12768           DFHEIV20,
 12769           DFHEIV99,
 12770           ELCNTL-KEY,
 12771           DFHEIV99,
 12772           DFHEIV99,
 12773           DFHEIV99
 12774     SET ADDRESS OF CONTROL-FILE TO
 12775         DFHEIV20
 12776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12777
 12778
 12779     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12780
 12781     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12782
 12783
 12784
 12785* EXEC CICS REWRITE
 12786*         FROM     (CONTROL-FILE)
 12787*         DATASET  (ELCNTL-DSID)
 12788*    END-EXEC.
 12789     MOVE LENGTH OF
 12790      CONTROL-FILE
 12791       TO DFHEIV11
 12792*    MOVE '&& L                  %   #00011676' TO DFHEIV0
 12793     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12794     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12795     MOVE X'2020233030303131363736' TO DFHEIV0(25:11)
 12796     CALL 'kxdfhei1' USING DFHEIV0,
 12797           ELCNTL-DSID,
 12798           CONTROL-FILE,
 12799           DFHEIV11,
 12800           DFHEIV99
 12801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 244
* EL130.cbl
 12802
 12803
 12804
 12805
 12806* EXEC CICS HANDLE CONDITION
 12807*         NOTOPEN  (9990-ABEND)
 12808*         DUPKEY   (5799-EXIT)
 12809*    END-EXEC.
 12810*    MOVE '"$J$                  ! ? #00011682' TO DFHEIV0
 12811     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12813     MOVE X'3F20233030303131363832' TO DFHEIV0(25:11)
 12814     CALL 'kxdfhei1' USING DFHEIV0
 12815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12816
 12817
 12818
 12819
 12820* EXEC CICS GETMAIN
 12821*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12822*         LENGTH  (ELARCH-LENGTH)
 12823*    END-EXEC.
 12824*    MOVE '," L                  $   #00011688' TO DFHEIV0
 12825     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12827     MOVE X'2020233030303131363838' TO DFHEIV0(25:11)
 12828     CALL 'kxdfhei1' USING DFHEIV0,
 12829           DFHEIV20,
 12830           ELARCH-LENGTH,
 12831           DFHEIV99
 12832     SET ADDRESS OF LETTER-ARCHIVE TO
 12833         DFHEIV20
 12834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12835
 12836
 12837     MOVE SPACES                 TO LETTER-ARCHIVE.
 12838     MOVE 'LA'                   TO LA-RECORD-ID.
 12839     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12840                                    LA-ARCHIVE-NO-A1.
 12841     MOVE '4'                    TO LA-RECORD-TYPE
 12842                                    LA-RECORD-TYPE-A1.
 12843     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12844                                    LA-LINE-SEQ-NO-A1.
 12845     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12846                                    LA-COMPANY-CD-A1.
 12847     MOVE CL-CARRIER             TO LA4-CARRIER.
 12848     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12849     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12850     MOVE CL-CERT-STATE          TO LA4-STATE.
 12851     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12852     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12853     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12854     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12855                                    LA4-RESEND-PRINT-DATE
 12856                                    LA4-FORM-REM-PRINT-DT
 12857                                    LA4-RESEND-DATE.
 12858     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12859     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 245
* EL130.cbl
 12860
 12861
 12862
 12863* EXEC CICS WRITE
 12864*         DATASET  (ELARCH-DSID)
 12865*         FROM     (LETTER-ARCHIVE)
 12866*         RIDFLD   (LA-CONTROL-PRIMARY)
 12867*    END-EXEC.
 12868     MOVE LENGTH OF
 12869      LETTER-ARCHIVE
 12870       TO DFHEIV11
 12871*    MOVE '&$ L                  ''   #00011718' TO DFHEIV0
 12872     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12873     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12874     MOVE X'2020233030303131373138' TO DFHEIV0(25:11)
 12875     CALL 'kxdfhei1' USING DFHEIV0,
 12876           ELARCH-DSID,
 12877           LETTER-ARCHIVE,
 12878           DFHEIV11,
 12879           LA-CONTROL-PRIMARY,
 12880           DFHEIV99,
 12881           DFHEIV99
 12882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12883
 12884
 12885 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 246
* EL130.cbl
 12887 6000-EDIT-CLAIM-DATA.
 12888
 12889     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12890     MOVE '2'                    TO DC-OPTION-CODE.
 12891     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12892     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12893
 12894     IF MAINTL NOT = ZERO
 12895         MOVE AL-UANON           TO MAINTA
 12896     END-IF
 12897
 12898     IF CLMNOL GREATER ZERO
 12899         IF CLMNOI = SPACES OR LOW-VALUES
 12900             MOVE -1             TO CLMNOL
 12901             MOVE AL-UABON       TO CLMNOA
 12902             MOVE ER-7688        TO EMI-ERROR
 12903             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12904         ELSE
 12905             MOVE AL-UANON       TO CLMNOA
 12906         END-IF
 12907     END-IF.
 12908
 12909     IF CERTNOL = ZERO
 12910         MOVE -1                 TO CERTNOL
 12911         MOVE AL-SABON           TO CERTNOA
 12912         MOVE ER-0203            TO EMI-ERROR
 12913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12914     ELSE
 12915         MOVE AL-SANON           TO CERTNOA
 12916     END-IF.
 12917
 12918     IF SUFXL = ZERO
 12919         MOVE SPACES             TO SUFXI
 12920         MOVE AL-SANON           TO SUFXA
 12921     ELSE
 12922         MOVE AL-SANON           TO SUFXA
 12923     END-IF.
 12924
 12925     IF CLMCARRL = ZERO
 12926         MOVE -1                 TO CLMCARRL
 12927         MOVE ER-0194            TO EMI-ERROR
 12928         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12929     ELSE
 12930         MOVE CLMCARRI           TO PI-CARRIER
 12931         IF PI-NO-CARRIER-SECURITY
 12932             MOVE AL-UANON       TO CLMCARRA
 12933         END-IF
 12934     END-IF.
 12935
 12936     IF CLMTYPEL > ZERO
 12937        IF ((PI-COMPANY-ID = 'DCC' OR 'VPP')
 12938           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 12939              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12940                        OR
 12941           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12942           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 12943              AND PI-AH-OVERRIDE-L1))
 12944              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 247
* EL130.cbl
 12945              MOVE AL-UABON       TO CLMTYPEA
 12946              MOVE ER-7634        TO EMI-ERROR
 12947              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12948        ELSE
 12949           MOVE AL-UANON       TO CLMTYPEA
 12950        END-IF
 12951     ELSE
 12952        IF MAINTI = 'A'
 12953           MOVE -1             TO CLMTYPEL
 12954           MOVE AL-UABON       TO CLMTYPEA
 12955           MOVE ER-0546        TO EMI-ERROR
 12956           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12957        END-IF
 12958     END-IF
 12959     if instypel > ZERO
 12960        if instypei = 'P' OR 'C'
 12961           move al-uanon         to instypea
 12962        else
 12963           MOVE -1               TO INSTYPEL
 12964           MOVE AL-UABON         TO INSTYPEA
 12965           MOVE ER-1654          TO EMI-ERROR
 12966           PERFORM 9900-ERROR-FORMAT
 12967                                 THRU 9900-EXIT
 12968        END-IF
 12969     ELSE
 12970        IF MAINTI = 'A'
 12971           MOVE -1               TO INSTYPEL
 12972           MOVE AL-UABON         TO INSTYPEA
 12973           MOVE ER-1654          TO EMI-ERROR
 12974           PERFORM 9900-ERROR-FORMAT
 12975                                 THRU 9900-EXIT
 12976        END-IF
 12977     END-IF
 12978     if (instypel <> zeros)
 12979        and (emi-error not = er-1654)
 12980        and (instypei = 'C')
 12981        and (crtfnmei = fstnmei)
 12982        move er-1675             to emi-error
 12983        MOVE -1                  TO INSTYPEL
 12984        MOVE AL-UABON            TO INSTYPEA
 12985        PERFORM 9900-ERROR-FORMAT
 12986                                 THRU 9900-EXIT
 12987    end-if
 12988     if (instypel <> zeros)
 12989        and (emi-error not = er-1654)
 12990        and (instypei = 'P')
 12991        and (crtfnmei <> fstnmei)
 12992        move er-1676             to emi-error
 12993        MOVE -1                  TO INSTYPEL
 12994        MOVE AL-UABON            TO INSTYPEA
 12995        PERFORM 9900-ERROR-FORMAT
 12996                                 THRU 9900-EXIT
 12997    end-if
 12998     IF PCERTNOL = ZERO
 12999        MOVE CERTNOI             TO PCERTNOI
 13000        MOVE CERTNOL             TO PCERTNOL
 13001        MOVE AL-UANON            TO PCERTNOA
 13002     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 248
* EL130.cbl
 13003        MOVE AL-UANON            TO PCERTNOA
 13004     END-IF.
 13005
 13006     IF PSUFXL = ZERO
 13007        MOVE SUFXI               TO PSUFXI
 13008        MOVE SUFXL               TO PSUFXL
 13009        MOVE AL-UANON            TO PSUFXA
 13010     ELSE
 13011        MOVE AL-UANON            TO PSUFXA
 13012     END-IF.
 13013
 13014     IF MAINTI = 'I'
 13015         GO TO 6020-EDIT
 13016     END-IF.
 13017
 13018     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 13019         MOVE -1                 TO LSTNMEL
 13020         MOVE ER-0236            TO EMI-ERROR
 13021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13022     ELSE
 13023         MOVE AL-UANON           TO LSTNMEA
 13024     END-IF.
 13025     if fstnmel not = zeros
 13026        move al-uanon            to fstnmea
 13027     end-if
 13028     IF SEXL > ZEROS
 13029        IF SEXI = 'M' OR 'F'
 13030           move al-uanon         to sexa
 13031           CONTINUE
 13032        ELSE
 13033           MOVE -1               TO SEXL
 13034           MOVE AL-UABON         TO SEXA
 13035           MOVE ER-0219          TO EMI-ERROR
 13036           PERFORM 9900-ERROR-FORMAT
 13037                                 THRU 9900-EXIT
 13038        END-IF
 13039     ELSE
 13040        IF MAINTI = 'A'
 13041           MOVE -1               TO SEXL
 13042           MOVE AL-UABON         TO SEXA
 13043           MOVE ER-0219          TO EMI-ERROR
 13044           PERFORM 9900-ERROR-FORMAT
 13045                                 THRU 9900-EXIT
 13046        END-IF
 13047     END-IF
 13048     IF SSNL GREATER THAN ZERO
 13049         MOVE SSNI TO WS-SOC-SEC-NUMBER
 13050         IF WS-SOC-SEC-NO NUMERIC AND
 13051           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 13052             NEXT SENTENCE
 13053         ELSE
 13054            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 13055               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 13056               WS-SSN-DASH2 = '-'
 13057                 NEXT SENTENCE
 13058            ELSE
 13059                 MOVE ER-0887        TO  EMI-ERROR
 13060                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 249
* EL130.cbl
 13061                 MOVE AL-UABON       TO  SSNA
 13062                 MOVE -1             TO  SSNL
 13063            END-IF
 13064        END-IF
 13065     END-IF.
 13066
 13067     IF BIRTHDTL = ZERO
 13068         GO TO 6020-EDIT
 13069     END-IF.
 13070
 13071     IF BIRTHDTL GREATER ZERO
 13072         MOVE BIRTHDTI           TO DATE-WORK
 13073         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13074         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13075         MOVE '4'                TO DC-OPTION-CODE
 13076         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13077         IF DATE-CONVERSION-ERROR
 13078             MOVE AL-UABON       TO BIRTHDTA
 13079             MOVE -1             TO BIRTHDTL
 13080             MOVE ER-0220        TO EMI-ERROR
 13081             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13082             GO TO 6020-EDIT
 13083         END-IF
 13084     END-IF.
 13085
 13086******************************************************************
 13087**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 13088**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 13089**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 13090******************************************************************
 13091
 13092     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 13093         MOVE BIRTHDTI           TO  DATE-WORK
 13094         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13095         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 13096         MOVE '4'                TO  DC-OPTION-CODE
 13097         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 13098         MOVE +0                 TO  DC-ELAPSED-MONTHS
 13099                                     DC-ELAPSED-DAYS
 13100         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13101         IF DATE-CONVERSION-ERROR
 13102             MOVE AL-UABON       TO  BIRTHDTA
 13103             MOVE -1             TO  BIRTHDTL
 13104             MOVE ER-0220        TO  EMI-ERROR
 13105             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13106             GO TO 6020-EDIT
 13107         END-IF
 13108     END-IF.
 13109
 13110     MOVE AL-UANON               TO  BIRTHDTA.
 13111     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 13112     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 13113     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 13114
 13115 6020-EDIT.
 13116     IF INCURL GREATER ZERO
 13117         MOVE INCURI             TO DATE-WORK
 13118         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 250
* EL130.cbl
 13119         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13120         MOVE '4'                TO DC-OPTION-CODE
 13121         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13122         IF DATE-CONVERSION-ERROR
 13123             MOVE AL-UABON       TO INCURA
 13124             MOVE -1             TO INCURL
 13125             MOVE ER-0222        TO EMI-ERROR
 13126             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13127         ELSE
 13128             MOVE AL-UANON       TO INCURA
 13129             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 13130             MOVE DC-BIN-DATE-1  TO WS-INCUR
 13131                                    PI-SAVE-INCUR-DT
 13132             IF WS-INCUR GREATER THAN WS-TODAY-DT
 13133                 MOVE ER-0511     TO EMI-ERROR
 13134                 MOVE -1          TO INCURL
 13135                 MOVE AL-UABON    TO INCURA
 13136                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13137             ELSE
 13138*                NEXT SENTENCE
 13139                 CONTINUE
 13140             END-IF
 13141         END-IF
 13142     ELSE
 13143         MOVE ER-0516         TO EMI-ERROR
 13144         MOVE AL-UABON        TO INCURA
 13145         MOVE -1              TO INCURL
 13146         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13147     END-IF.
 13148
 13149     IF REPORTL GREATER ZERO
 13150         MOVE REPORTI            TO DATE-WORK
 13151         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13152         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13153         MOVE '4'                TO DC-OPTION-CODE
 13154         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13155         IF DATE-CONVERSION-ERROR
 13156             MOVE AL-UABON       TO REPORTA
 13157             MOVE -1             TO REPORTL
 13158             MOVE ER-0223        TO EMI-ERROR
 13159             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13160         ELSE
 13161             MOVE AL-UANON       TO REPORTA
 13162             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 13163             MOVE DC-BIN-DATE-1  TO WS-REPORT
 13164             IF WS-REPORT GREATER THAN WS-TODAY-DT
 13165                 MOVE ER-0512     TO EMI-ERROR
 13166                 MOVE -1          TO REPORTL
 13167                 MOVE AL-UABON    TO REPORTA
 13168                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13169             ELSE
 13170*                NEXT SENTENCE
 13171                 CONTINUE
 13172             END-IF
 13173         END-IF
 13174     ELSE
 13175         MOVE ER-0517         TO EMI-ERROR
 13176         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 251
* EL130.cbl
 13177         MOVE AL-UABON        TO REPORTA
 13178         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13179     END-IF.
 13180
 13181     IF WS-REPORT NOT = LOW-VALUES
 13182         IF WS-INCUR GREATER THAN WS-REPORT
 13183             MOVE AL-UABON       TO REPORTA
 13184             MOVE -1             TO REPORTL
 13185             MOVE ER-0509        TO EMI-ERROR
 13186             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13187         END-IF
 13188     END-IF.
 13189
 13190     IF ICD1L GREATER THAN ZERO
 13191         IF (ICD1I GREATER THAN SPACES) AND
 13192            (ICD1I(4:1) NOT = '.')
 13193             IF ICD1I(4:1) = ' '
 13194                 MOVE '.' TO ICD1I(4:1)
 13195             ELSE
 13196                 IF ICD1I(8:1) = ' '
 13197                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 13198                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 13199                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 13200                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 13201                     MOVE '.'        TO ICD1I(4:1)
 13202                 END-IF
 13203             END-IF
 13204         END-IF
 13205         IF (ICD1I GREATER THAN SPACES) AND
 13206            (ICD1I(1:1) NOT > ' ' OR
 13207             ICD1I(2:1) NOT > ' ' OR
 13208             ICD1I(3:1) NOT > ' ' OR
 13209             ICD1I(4:1) NOT = '.')
 13210              MOVE ER-0992        TO  EMI-ERROR
 13211              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13212              MOVE AL-UABON       TO ICD1A
 13213              MOVE -1             TO ICD1L
 13214         END-IF
 13215     END-IF.
 13216
 13217     IF ICD2L GREATER THAN ZERO
 13218         IF (ICD2I GREATER THAN SPACES) AND
 13219            (ICD2I(4:1) NOT = '.')
 13220             IF ICD2I(4:1) = ' '
 13221                 MOVE '.' TO ICD2I(4:1)
 13222             ELSE
 13223                 IF ICD2I(8:1) = ' '
 13224                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 13225                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 13226                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 13227                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 13228                     MOVE '.'        TO ICD2I(4:1)
 13229                 END-IF
 13230             END-IF
 13231         END-IF
 13232         IF (ICD2I GREATER THAN SPACES) AND
 13233            (ICD2I(1:1) NOT > ' ' OR
 13234             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 252
* EL130.cbl
 13235             ICD2I(3:1) NOT > ' ' OR
 13236             ICD2I(4:1) NOT = '.')
 13237              MOVE ER-0992        TO  EMI-ERROR
 13238              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13239              MOVE AL-UABON       TO ICD2A
 13240              MOVE -1             TO ICD2L
 13241         END-IF
 13242     END-IF
 13243
 13244*    IF ESTENDL GREATER ZERO
 13245*        MOVE ESTENDI            TO DATE-WORK
 13246*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13247*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13248*        MOVE '4'                TO DC-OPTION-CODE
 13249*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13250*        IF DATE-CONVERSION-ERROR
 13251*            MOVE AL-UABON       TO ESTENDA
 13252*            MOVE -1             TO ESTENDL
 13253*            MOVE ER-0224        TO EMI-ERROR
 13254*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13255*        ELSE
 13256*            MOVE AL-UANON       TO ESTENDA
 13257*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 13258*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 13259*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13260*               MOVE AL-UABON    TO ESTENDA
 13261*               MOVE -1          TO ESTENDL
 13262*               MOVE ER-0544     TO EMI-ERROR
 13263*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13264*            END-IF
 13265*        END-IF
 13266*    END-IF.
 13267*
 13268*    IF WS-ESTEND NOT = LOW-VALUES
 13269*        IF WS-INCUR GREATER THAN WS-ESTEND
 13270*            MOVE AL-UABON       TO ESTENDA
 13271*            MOVE -1             TO ESTENDL
 13272*            MOVE ER-0510        TO EMI-ERROR
 13273*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13274*        END-IF
 13275*    END-IF.
 13276
 13277     IF PRTOPTL GREATER ZERO
 13278         IF PRTOPTI NOT = 'N' AND 'L'
 13279             MOVE AL-UABON       TO PRTOPTA
 13280             MOVE -1             TO PRTOPTL
 13281             MOVE ER-0334        TO EMI-ERROR
 13282             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13283         END-IF
 13284     END-IF.
 13285
 13286     IF MANRSVL GREATER ZERO
 13287
 13288* EXEC CICS BIF DEEDIT
 13289*            FIELD   (MANRSVI)
 13290*            LENGTH  (9)
 13291*        END-EXEC
 13292     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 253
* EL130.cbl
 13293       TO DFHEIV11
 13294*    MOVE '@"L                   #   #00012126' TO DFHEIV0
 13295     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13296     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13297     MOVE X'2020233030303132313236' TO DFHEIV0(25:11)
 13298     CALL 'kxdfhei1' USING DFHEIV0,
 13299           MANRSVI,
 13300           DFHEIV11
 13301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13302         IF MANRSVI NOT NUMERIC
 13303             MOVE AL-UNBON       TO MANRSVA
 13304             MOVE -1             TO MANRSVL
 13305             MOVE ER-0489        TO EMI-ERROR
 13306             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13307         ELSE
 13308             MOVE AL-UNNON       TO MANRSVA
 13309             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13310         END-IF
 13311     END-IF.
 13312
 13313     MOVE SPACES                 TO ELCNTL-KEY.
 13314
 13315     IF CONTROL-IS-ACTUAL-CARRIER
 13316         MOVE PI-CARRIER         TO CNTL-CARRIER
 13317     ELSE
 13318         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13319     END-IF.
 13320
 13321     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13322     MOVE '6'                    TO CNTL-REC-TYPE.
 13323     MOVE +0                     TO CNTL-SEQ-NO.
 13324
 13325
 13326
 13327* EXEC CICS HANDLE CONDITION
 13328*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13329*    END-EXEC.
 13330*    MOVE '"$I                   ! @ #00012154' TO DFHEIV0
 13331     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13332     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13333     MOVE X'4020233030303132313534' TO DFHEIV0(25:11)
 13334     CALL 'kxdfhei1' USING DFHEIV0
 13335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13336
 13337
 13338     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13339
 13340     IF NOT CF-MANUAL-RESERVES-USED AND
 13341           WS-MANRSV GREATER ZERO
 13342         MOVE ER-0518             TO EMI-ERROR
 13343         MOVE -1                  TO MANRSVL
 13344         MOVE AL-UNBON            TO MANRSVA
 13345         MOVE ZEROS               TO WS-MANRSV
 13346         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13347     END-IF.
 13348
 13349     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13350     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 254
* EL130.cbl
 13351
 13352     IF SUPVL GREATER ZERO
 13353         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13354             MOVE -1             TO SUPVL
 13355             MOVE AL-UABON       TO SUPVA
 13356             MOVE ER-0230        TO EMI-ERROR
 13357             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13358         ELSE
 13359             MOVE AL-UANON       TO SUPVA
 13360         END-IF
 13361     END-IF.
 13362
 13363     IF PROCCDL = ZERO
 13364        GO TO 6050-CONTINUE-EDITS
 13365     END-IF.
 13366
 13367     MOVE SPACES                 TO ELCNTL-KEY.
 13368     MOVE PROCCDI                TO CNTL-ACCESS.
 13369
 13370     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13371     MOVE '2'                    TO CNTL-REC-TYPE.
 13372     MOVE +0                     TO CNTL-SEQ-NO.
 13373
 13374
 13375
 13376* EXEC CICS HANDLE CONDITION
 13377*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13378*    END-EXEC.
 13379*    MOVE '"$I                   ! A #00012195' TO DFHEIV0
 13380     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13381     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13382     MOVE X'4120233030303132313935' TO DFHEIV0(25:11)
 13383     CALL 'kxdfhei1' USING DFHEIV0
 13384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13385
 13386
 13387     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13388
 13389     GO TO 6050-CONTINUE-EDITS.
 13390
 13391 6040-NO-PROCESSOR-RECORD.
 13392     MOVE ER-0019                TO EMI-ERROR.
 13393     MOVE -1                     TO PROCCDL.
 13394     MOVE AL-UABON               TO PROCCDA.
 13395     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13396
 13397 6050-CONTINUE-EDITS.
 13398     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13399           GO TO 6070-CONTINUE-EDITS
 13400     END-IF.
 13401
 13402     MOVE BENECDI                TO BENE-CODE.
 13403     MOVE 'B'                    TO BENE-RCD-TYPE.
 13404     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13405
 13406
 13407
 13408* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 255
* EL130.cbl
 13409*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13410*    END-EXEC.
 13411*    MOVE '"$I                   ! B #00012219' TO DFHEIV0
 13412     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13414     MOVE X'4220233030303132323139' TO DFHEIV0(25:11)
 13415     CALL 'kxdfhei1' USING DFHEIV0
 13416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13417
 13418
 13419
 13420* EXEC CICS READ
 13421*         DATASET   (ELBENE-DSID)
 13422*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13423*         RIDFLD    (ELBENE-KEY)
 13424*    END-EXEC.
 13425*    MOVE '&"S        E          (   #00012223' TO DFHEIV0
 13426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13428     MOVE X'2020233030303132323233' TO DFHEIV0(25:11)
 13429     CALL 'kxdfhei1' USING DFHEIV0,
 13430           ELBENE-DSID,
 13431           DFHEIV20,
 13432           DFHEIV99,
 13433           ELBENE-KEY,
 13434           DFHEIV99,
 13435           DFHEIV99,
 13436           DFHEIV99
 13437     SET ADDRESS OF BENEFICIARY-MASTER TO
 13438         DFHEIV20
 13439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13440
 13441
 13442     GO TO 6070-CONTINUE-EDITS.
 13443
 13444 6060-NO-BENEFICIARY-RECORD.
 13445     MOVE ER-0565                TO EMI-ERROR.
 13446     MOVE -1                     TO BENECDL.
 13447     MOVE AL-UABON               TO BENECDA.
 13448     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13449
 13450
 13451 6070-CONTINUE-EDITS.
 13452     IF CERTMTL GREATER ZERO
 13453         IF CERTMTI NOT = 'A' AND 'S'
 13454             MOVE -1             TO CERTMTL
 13455             MOVE AL-UABON       TO CERTMTA
 13456             MOVE ER-0267        TO EMI-ERROR
 13457             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13458         ELSE
 13459             MOVE AL-UANON       TO CERTMTA
 13460         END-IF
 13461     ELSE
 13462         GO TO 6000-EXIT
 13463     END-IF.
 13464
 13465     IF EFFDTL GREATER ZERO
 13466         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 256
* EL130.cbl
 13467         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13468         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13469         MOVE '4'                TO DC-OPTION-CODE
 13470         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13471         IF DATE-CONVERSION-ERROR
 13472             MOVE AL-UABON       TO EFFDTA
 13473             MOVE -1             TO EFFDTL
 13474             MOVE ER-0231        TO EMI-ERROR
 13475             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13476         ELSE
 13477             MOVE AL-UANON       TO EFFDTA
 13478             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13479             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13480         END-IF
 13481     ELSE
 13482         MOVE ER-0231            TO EMI-ERROR
 13483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13484         MOVE -1                 TO EFFDTL
 13485         MOVE AL-UABON           TO EFFDTA
 13486     END-IF.
 13487
 13488     IF ACCOUNTL = ZERO
 13489         MOVE ER-0232            TO EMI-ERROR
 13490         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13491         MOVE AL-UABON           TO ACCOUNTA
 13492         MOVE -1                 TO ACCOUNTL
 13493     ELSE
 13494         MOVE AL-UANON           TO ACCOUNTA
 13495     END-IF.
 13496
 13497     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13498        (STATEL = ZERO)
 13499         MOVE ER-0233        TO EMI-ERROR
 13500         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13501         MOVE AL-UABON       TO STATEA
 13502         MOVE -1             TO STATEL
 13503     ELSE
 13504         MOVE AL-UANON       TO STATEA
 13505     END-IF.
 13506
 13507     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13508        (CRTCARRL = ZERO)
 13509         MOVE ER-0234        TO EMI-ERROR
 13510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13511         MOVE AL-UABON       TO CRTCARRA
 13512         MOVE -1             TO CRTCARRL
 13513     ELSE
 13514         MOVE AL-UANON       TO CRTCARRA
 13515     END-IF.
 13516
 13517     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13518        GROUPL = ZERO
 13519         MOVE ER-0235            TO EMI-ERROR
 13520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13521         MOVE AL-UABON           TO GROUPA
 13522         MOVE -1                 TO GROUPL
 13523     ELSE
 13524         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 257
* EL130.cbl
 13525     END-IF.
 13526
 13527     IF CRTLNMEL = ZERO
 13528         IF LSTNMEI = SPACES OR LOW-VALUES
 13529             MOVE ER-0236            TO  EMI-ERROR
 13530             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13531             MOVE AL-UABON           TO  CRTLNMEA
 13532             MOVE -1                 TO  CRTLNMEL
 13533         ELSE
 13534             MOVE LSTNMEI            TO  CRTLNMEI
 13535             MOVE AL-UANON           TO  CRTLNMEA
 13536         END-IF
 13537     ELSE
 13538         MOVE AL-UANON               TO  CRTLNMEA
 13539     END-IF.
 13540
 13541     IF CRTFNMEL = ZERO
 13542         IF FSTNMEI = SPACES OR LOW-VALUES
 13543*            NEXT SENTENCE
 13544             CONTINUE
 13545         ELSE
 13546             MOVE FSTNMEI            TO  CRTFNMEI
 13547             MOVE AL-UANON           TO  CRTFNMEA
 13548         END-IF
 13549     END-IF.
 13550
 13551     IF CRTINITL = ZERO
 13552         IF INITI = SPACES OR LOW-VALUES
 13553*            NEXT SENTENCE
 13554             CONTINUE
 13555         ELSE
 13556             MOVE INITI              TO  CRTINITI
 13557             MOVE AL-UANON           TO  CRTINITA
 13558         END-IF
 13559     END-IF.
 13560
 13561 6000-EXIT.
 13562     EXIT.
 13563
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 258
* EL130.cbl
 13565 6200-EDIT-CERT-DATA.
 13566     IF ISSAGEL GREATER ZERO
 13567         IF ISSAGEI NOT NUMERIC
 13568             MOVE ER-0237        TO EMI-ERROR
 13569             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13570             MOVE -1             TO ISSAGEL
 13571             MOVE AL-UNBON       TO ISSAGEA
 13572         ELSE
 13573             MOVE AL-UNNON       TO ISSAGEA
 13574         END-IF
 13575     END-IF.
 13576
 13577     IF JNTAGEL GREATER ZERO
 13578         IF JNTAGEI NOT NUMERIC
 13579             MOVE ER-0238        TO EMI-ERROR
 13580             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13581             MOVE -1             TO JNTAGEL
 13582             MOVE AL-UNBON       TO JNTAGEA
 13583         ELSE
 13584             MOVE AL-UNNON       TO JNTAGEA
 13585         END-IF
 13586     END-IF.
 13587
 13588     IF LCVCDL GREATER ZERO
 13589         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13590         IF INVALID-BENEFIT-CODE
 13591             MOVE ER-7635        TO EMI-ERROR
 13592             MOVE -1             TO LCVCDL
 13593             MOVE AL-UABON       TO LCVCDA
 13594             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13595         ELSE
 13596             MOVE LCVCDI         TO WS-BEN-HOLD
 13597             MOVE '4'            TO WS-REC-TYPE
 13598             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13599             IF WS-BEN-ALPHA-HOLD = SPACES
 13600                MOVE ER-7635     TO EMI-ERROR
 13601                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13602                MOVE -1          TO LCVCDL
 13603                MOVE AL-UABON    TO LCVCDA
 13604             ELSE
 13605                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13606                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13607                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13608                MOVE AL-UANON           TO LCVCDA
 13609             END-IF
 13610         END-IF
 13611     END-IF.
 13612
 13613     IF ACVCDL GREATER ZERO
 13614         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13615         IF INVALID-BENEFIT-CODE
 13616             MOVE ER-7635        TO EMI-ERROR
 13617             MOVE -1             TO ACVCDL
 13618             MOVE AL-UABON       TO ACVCDA
 13619             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13620         ELSE
 13621             MOVE ACVCDI         TO WS-BEN-HOLD
 13622             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 259
* EL130.cbl
 13623             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13624             IF WS-BEN-ALPHA-HOLD = SPACES
 13625                MOVE ER-7635     TO EMI-ERROR
 13626                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13627                MOVE -1          TO ACVCDL
 13628                MOVE AL-UABON    TO ACVCDA
 13629             ELSE
 13630                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13631                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13632                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13633                MOVE AL-UANON           TO ACVCDA
 13634             END-IF
 13635         END-IF
 13636     END-IF.
 13637
 13638     IF LCVOTRML GREATER ZERO
 13639         IF LCVOTRMI NOT NUMERIC
 13640             MOVE ER-7636        TO EMI-ERROR
 13641             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13642             MOVE -1             TO LCVOTRML
 13643             MOVE AL-UNBON       TO LCVOTRMA
 13644         ELSE
 13645             MOVE AL-UNNON       TO LCVOTRMA
 13646         END-IF
 13647     END-IF.
 13648
 13649     IF ACVOTRML GREATER ZERO
 13650         IF ACVOTRMI NOT NUMERIC
 13651             MOVE ER-7636        TO EMI-ERROR
 13652             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13653             MOVE -1             TO ACVOTRML
 13654             MOVE AL-UNBON       TO ACVOTRMA
 13655         ELSE
 13656             MOVE AL-UNNON       TO ACVOTRMA
 13657         END-IF
 13658     END-IF.
 13659
 13660     IF LCVRATEL GREATER ZERO
 13661
 13662* EXEC CICS BIF DEEDIT
 13663*            FIELD    (LCVRATEI)
 13664*            LENGTH   (06)
 13665*        END-EXEC
 13666     MOVE 06
 13667       TO DFHEIV11
 13668*    MOVE '@"L                   #   #00012448' TO DFHEIV0
 13669     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13670     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13671     MOVE X'2020233030303132343438' TO DFHEIV0(25:11)
 13672     CALL 'kxdfhei1' USING DFHEIV0,
 13673           LCVRATEI,
 13674           DFHEIV11
 13675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13676         IF LCVRATEI NOT NUMERIC
 13677             MOVE AL-UNBON       TO LCVRATEA
 13678             MOVE -1             TO LCVRATEL
 13679             MOVE ER-2280        TO EMI-ERROR
 13680             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 260
* EL130.cbl
 13681         ELSE
 13682             MOVE AL-UNNON       TO LCVRATEA
 13683             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13684         END-IF
 13685     END-IF.
 13686
 13687     IF ACVRATEL GREATER ZERO
 13688
 13689* EXEC CICS BIF DEEDIT
 13690*            FIELD    (ACVRATEI)
 13691*            LENGTH   (06)
 13692*        END-EXEC
 13693     MOVE 06
 13694       TO DFHEIV11
 13695*    MOVE '@"L                   #   #00012464' TO DFHEIV0
 13696     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13697     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13698     MOVE X'2020233030303132343634' TO DFHEIV0(25:11)
 13699     CALL 'kxdfhei1' USING DFHEIV0,
 13700           ACVRATEI,
 13701           DFHEIV11
 13702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13703         IF ACVRATEI NOT NUMERIC
 13704             MOVE AL-UNBON       TO ACVRATEA
 13705             MOVE -1             TO ACVRATEL
 13706             MOVE ER-2280        TO EMI-ERROR
 13707             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13708         ELSE
 13709             MOVE AL-UNNON       TO ACVRATEA
 13710             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13711         END-IF
 13712     END-IF.
 13713
 13714     IF LCVBENEL GREATER ZERO
 13715
 13716* EXEC CICS BIF DEEDIT
 13717*            FIELD    (LCVBENEI)
 13718*            LENGTH   (11)
 13719*        END-EXEC
 13720     MOVE 11
 13721       TO DFHEIV11
 13722*    MOVE '@"L                   #   #00012480' TO DFHEIV0
 13723     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13724     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13725     MOVE X'2020233030303132343830' TO DFHEIV0(25:11)
 13726     CALL 'kxdfhei1' USING DFHEIV0,
 13727           LCVBENEI,
 13728           DFHEIV11
 13729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13730         IF LCVBENEI NOT NUMERIC
 13731             MOVE AL-UNBON       TO LCVBENEA
 13732             MOVE -1             TO LCVBENEL
 13733             MOVE ER-7637        TO EMI-ERROR
 13734             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13735         ELSE
 13736             MOVE AL-UNNON       TO LCVBENEA
 13737             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13738         END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 261
* EL130.cbl
 13739     END-IF.
 13740
 13741     IF ACVBENEL GREATER ZERO
 13742
 13743* EXEC CICS BIF DEEDIT
 13744*            FIELD    (ACVBENEI)
 13745*            LENGTH   (11)
 13746*        END-EXEC
 13747     MOVE 11
 13748       TO DFHEIV11
 13749*    MOVE '@"L                   #   #00012496' TO DFHEIV0
 13750     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13751     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13752     MOVE X'2020233030303132343936' TO DFHEIV0(25:11)
 13753     CALL 'kxdfhei1' USING DFHEIV0,
 13754           ACVBENEI,
 13755           DFHEIV11
 13756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13757         IF ACVBENEI NOT NUMERIC
 13758             MOVE AL-UNBON       TO ACVBENEA
 13759             MOVE -1             TO ACVBENEL
 13760             MOVE ER-7637        TO EMI-ERROR
 13761             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13762         ELSE
 13763             MOVE AL-UNNON       TO ACVBENEA
 13764             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13765         END-IF
 13766     END-IF.
 13767
 13768     IF LCVCNDTL GREATER ZERO
 13769         IF LCVCNDTI NOT = SPACES
 13770             MOVE LCVCNDTI        TO DATE-WORK
 13771             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13772             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13773             MOVE '4'             TO DC-OPTION-CODE
 13774             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13775             IF DATE-CONVERSION-ERROR
 13776                 MOVE AL-UABON    TO LCVCNDTA
 13777                 MOVE -1          TO LCVCNDTL
 13778                 MOVE ER-7638     TO EMI-ERROR
 13779                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13780             ELSE
 13781                 MOVE AL-UANON    TO LCVCNDTA
 13782                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13783                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13784             END-IF
 13785         END-IF
 13786     END-IF.
 13787
 13788     IF ACVCNDTL GREATER ZERO
 13789         IF ACVCNDTI NOT = SPACES
 13790             MOVE ACVCNDTI        TO DATE-WORK
 13791             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13792             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13793             MOVE '4'             TO DC-OPTION-CODE
 13794             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13795             IF DATE-CONVERSION-ERROR
 13796                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 262
* EL130.cbl
 13797                 MOVE -1          TO ACVCNDTL
 13798                 MOVE ER-7638     TO EMI-ERROR
 13799                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13800             ELSE
 13801                 MOVE AL-UANON    TO ACVCNDTA
 13802                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13803                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13804             END-IF
 13805         END-IF
 13806     END-IF.
 13807
 13808     IF ADDONDTL GREATER ZERO
 13809         MOVE ADDONDTI        TO DATE-WORK
 13810         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13811         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13812         MOVE '4'             TO DC-OPTION-CODE
 13813         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13814         IF DATE-CONVERSION-ERROR
 13815             MOVE AL-UABON    TO ADDONDTA
 13816             MOVE -1          TO ADDONDTL
 13817             MOVE ER-7651     TO EMI-ERROR
 13818             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13819         ELSE
 13820             MOVE AL-UANON    TO ADDONDTA
 13821             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13822             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13823         END-IF
 13824     END-IF.
 13825
 13826     IF APRL GREATER ZERO
 13827
 13828* EXEC CICS BIF DEEDIT
 13829*            FIELD    (APRI)
 13830*            LENGTH   (8)
 13831*        END-EXEC
 13832     MOVE 8
 13833       TO DFHEIV11
 13834*    MOVE '@"L                   #   #00012570' TO DFHEIV0
 13835     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13836     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13837     MOVE X'2020233030303132353730' TO DFHEIV0(25:11)
 13838     CALL 'kxdfhei1' USING DFHEIV0,
 13839           APRI,
 13840           DFHEIV11
 13841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13842         IF APRI NOT NUMERIC
 13843             MOVE AL-UNBON       TO APRA
 13844             MOVE -1             TO APRL
 13845             MOVE ER-0248        TO EMI-ERROR
 13846             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13847         ELSE
 13848             MOVE AL-UNNON       TO APRA
 13849             MOVE APRI           TO WS-APR APRO
 13850         END-IF
 13851     END-IF.
 13852
 13853     IF PMTFREQL GREATER ZERO
 13854
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 263
* EL130.cbl
 13855* EXEC CICS BIF DEEDIT
 13856*            FIELD   (PMTFREQI)
 13857*            LENGTH  (2)
 13858*        END-EXEC
 13859     MOVE 2
 13860       TO DFHEIV11
 13861*    MOVE '@"L                   #   #00012586' TO DFHEIV0
 13862     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13863     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13864     MOVE X'2020233030303132353836' TO DFHEIV0(25:11)
 13865     CALL 'kxdfhei1' USING DFHEIV0,
 13866           PMTFREQI,
 13867           DFHEIV11
 13868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13869         IF PMTFREQI NOT NUMERIC
 13870             MOVE -1             TO PMTFREQL
 13871             MOVE AL-UNBON       TO PMTFREQA
 13872             MOVE ER-0258        TO EMI-ERROR
 13873             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13874         ELSE
 13875             MOVE AL-UNNON       TO PMTFREQA
 13876             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13877         END-IF
 13878     END-IF.
 13879
 13880     IF INDGRPL GREATER ZERO
 13881         IF INDGRPI = 'I' OR 'G'
 13882             MOVE AL-UANON       TO INDGRPA
 13883         ELSE
 13884             MOVE -1 TO INDGRPL
 13885             MOVE AL-UABON       TO INDGRPA
 13886             MOVE ER-0260        TO EMI-ERROR
 13887             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13888         END-IF
 13889     END-IF.
 13890
 13891     IF LOANBALL GREATER ZERO
 13892         MOVE LOANBALI           TO DEEDIT-FIELD
 13893
 13894* EXEC CICS BIF DEEDIT
 13895*            FIELD   (DEEDIT-FIELD)
 13896*            LENGTH  (12)
 13897*        END-EXEC
 13898     MOVE 12
 13899       TO DFHEIV11
 13900*    MOVE '@"L                   #   #00012614' TO DFHEIV0
 13901     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13902     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13903     MOVE X'2020233030303132363134' TO DFHEIV0(25:11)
 13904     CALL 'kxdfhei1' USING DFHEIV0,
 13905           DEEDIT-FIELD,
 13906           DFHEIV11
 13907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13908         IF DEEDIT-FIELD NOT NUMERIC
 13909             MOVE AL-UNBON       TO LOANBALA
 13910             MOVE -1             TO LOANBALL
 13911             MOVE ER-0247        TO EMI-ERROR
 13912             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 264
* EL130.cbl
 13913         ELSE
 13914             MOVE AL-UNNON       TO LOANBALA
 13915             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13916         END-IF
 13917     END-IF.
 13918
 13919     IF PREMTYPL GREATER ZERO
 13920         IF (PREMTYPI = '1' OR '2' OR '3')
 13921             MOVE AL-UANON       TO PREMTYPA
 13922         ELSE
 13923             MOVE -1             TO PREMTYPL
 13924             MOVE AL-UABON       TO PREMTYPA
 13925             MOVE ER-0227        TO EMI-ERROR
 13926             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13927         END-IF
 13928     END-IF.
 13929
 13930     IF REINCDL GREATER ZERO
 13931         MOVE LOW-VALUES         TO  ERREIN-KEY
 13932         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13933         MOVE REINCDI            TO  REIN-CODE-1
 13934                                     REIN-CODE-2
 13935                                     REIN-CODE-3
 13936         MOVE 'A'                TO  REIN-TYPE
 13937         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13938         IF REIN-REC-NOT-FOUND
 13939             MOVE ER-0266        TO  EMI-ERROR
 13940             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13941             MOVE -1             TO  REINCDL
 13942             MOVE AL-UABON       TO  REINCDA
 13943         ELSE
 13944             MOVE AL-UANON       TO  REINCDA
 13945         END-IF
 13946     END-IF.
 13947
 13948     IF CERTMTI NOT = 'A'
 13949        GO TO 6200-EXIT
 13950     END-IF.
 13951
 13952     IF PREMTYPI = '1'
 13953         IF LCVCDL GREATER ZERO
 13954             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13955                 MOVE ER-0841        TO  EMI-ERROR
 13956                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13957                 MOVE -1             TO  PREMTYPL
 13958                 MOVE AL-UABON       TO  PREMTYPA
 13959             END-IF
 13960         END-IF
 13961     END-IF.
 13962
 13963     IF PREMTYPI = '1'
 13964         IF ACVCDL GREATER ZERO
 13965             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13966                 MOVE ER-0841        TO  EMI-ERROR
 13967                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13968                 MOVE -1             TO  PREMTYPL
 13969                 MOVE AL-UABON       TO  PREMTYPA
 13970             END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 265
* EL130.cbl
 13971         END-IF
 13972     END-IF.
 13973
 13974     IF PREMTYPI = '2'
 13975         IF LCVCDL GREATER ZERO
 13976             IF (PI-COMPANY-ID = 'HAN') AND
 13977                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13978                        OR
 13979                 WS-LF-SPECIAL-CALC-CD = 'O'
 13980*                NEXT SENTENCE
 13981                 CONTINUE
 13982             ELSE
 13983                 MOVE ER-0840        TO  EMI-ERROR
 13984                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13985                 MOVE -1             TO  PREMTYPL
 13986                 MOVE AL-UABON       TO  PREMTYPA
 13987             END-IF
 13988         END-IF
 13989     END-IF.
 13990
 13991     IF PREMTYPI = '2'
 13992         IF ACVCDL GREATER ZERO
 13993             IF (PI-COMPANY-ID = 'HAN')  AND
 13994                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13995                        OR
 13996                 WS-AH-SPECIAL-CALC-CD = 'O'
 13997*                NEXT SENTENCE
 13998                 CONTINUE
 13999             ELSE
 14000                 MOVE ER-0840        TO  EMI-ERROR
 14001                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14002                 MOVE -1             TO  PREMTYPL
 14003                 MOVE AL-UABON       TO  PREMTYPA
 14004             END-IF
 14005         END-IF
 14006     END-IF.
 14007
 14008     IF LCVCDL = ZEROS
 14009        GO TO 6200-EXIT
 14010     END-IF.
 14011
 14012     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 14013         IF PMTFREQI NOT = ZEROS
 14014             MOVE ER-0428        TO EMI-ERROR
 14015             MOVE -1             TO PMTFREQL
 14016             MOVE AL-UNBON       TO PMTFREQA
 14017             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14018             GO TO 6200-CHECK-APR
 14019         END-IF
 14020     END-IF.
 14021
 14022     IF PMTFREQL = ZEROS AND TEX-REG
 14023         MOVE ER-0429            TO EMI-ERROR
 14024         MOVE -1                 TO PMTFREQL
 14025         MOVE AL-UNBON           TO PMTFREQA
 14026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14027         GO TO 6200-CHECK-APR
 14028     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 266
* EL130.cbl
 14029
 14030     IF LCVOTRMI NOT NUMERIC
 14031         GO TO 6200-CHECK-APR
 14032     END-IF.
 14033
 14034     IF WS-PMTFREQ NOT = ZERO
 14035         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 14036         GIVING DIVIDE-QUOT
 14037         REMAINDER DIVIDE-REM
 14038         IF DIVIDE-REM GREATER ZERO
 14039             MOVE ER-0430            TO EMI-ERROR
 14040             MOVE -1                 TO PMTFREQL
 14041             MOVE AL-UNBON           TO PMTFREQA
 14042             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14043         END-IF
 14044     END-IF.
 14045
 14046 6200-CHECK-APR.
 14047     IF NET-PAY AND APRL = ZEROS
 14048        MOVE ER-0257             TO EMI-ERROR
 14049        MOVE -1                  TO APRL
 14050        MOVE AL-UABON            TO APRA
 14051        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14052     END-IF.
 14053
 14054 6200-EXIT.
 14055     EXIT.
 14056
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 267
* EL130.cbl
 14058 6300-REQUIRED-CERT-EDIT.
 14059
 14060     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14061        GO TO 6300-REQUIRED-AH-EDIT
 14062     END-IF
 14063
 14064     IF LCVCDL = ZERO
 14065        MOVE ER-7639             TO EMI-ERROR
 14066        MOVE -1                  TO LCVCDL
 14067        MOVE AL-UABON            TO LCVCDA
 14068        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14069     END-IF.
 14070
 14071     IF LCVOTRML = ZERO
 14072        MOVE ER-7670             TO EMI-ERROR
 14073        MOVE -1                  TO LCVOTRML
 14074        MOVE AL-UNBON            TO LCVOTRMA
 14075        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14076     END-IF.
 14077
 14078     IF LCVBENEL = ZERO
 14079        MOVE ER-7671             TO EMI-ERROR
 14080        MOVE -1                  TO LCVBENEL
 14081        MOVE AL-UNBON            TO LCVBENEA
 14082        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14083     END-IF.
 14084
 14085     GO TO 6399-EXIT.
 14086
 14087 6300-REQUIRED-AH-EDIT.
 14088
 14089     IF ACVCDL = ZERO
 14090        MOVE ER-7639             TO EMI-ERROR
 14091        MOVE -1                  TO ACVCDL
 14092        MOVE AL-UABON            TO ACVCDA
 14093        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14094     END-IF.
 14095
 14096     IF ACVOTRML = ZERO
 14097         MOVE ER-7670             TO EMI-ERROR
 14098         MOVE -1                  TO ACVOTRML
 14099         MOVE AL-UNBON            TO ACVOTRMA
 14100         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14101     END-IF.
 14102
 14103     IF ACVBENEL = ZERO
 14104        MOVE ER-7671             TO EMI-ERROR
 14105        MOVE -1                  TO ACVBENEL
 14106        MOVE AL-UNBON            TO ACVBENEA
 14107        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14108     END-IF.
 14109
 14110 6399-EXIT.
 14111      EXIT.
 14112
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 268
* EL130.cbl
 14114 6400-TEST-CLAIM-REASONABILITY.
 14115
 14116     IF WS-INCUR = LOW-VALUES
 14117        GO TO 6499-EXIT
 14118     END-IF.
 14119
 14120     IF WS-EFFDT NOT = LOW-VALUES
 14121         IF WS-INCUR LESS WS-EFFDT
 14122             MOVE ER-0458          TO EMI-ERROR
 14123             MOVE -1               TO INCURL
 14124             MOVE AL-UABON         TO INCURA
 14125             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14126         END-IF
 14127     END-IF.
 14128
 14129     IF CERTMTI = 'A'
 14130        GO TO 6460-TEST-NEW-CERT
 14131     END-IF.
 14132
 14133     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 14134     MOVE CRTCARRI               TO CERT-CARRIER.
 14135     MOVE GROUPI                 TO CERT-GROUPING.
 14136     MOVE STATEI                 TO CERT-STATE.
 14137     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 14138     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 14139     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 14140
 14141
 14142
 14143* EXEC CICS HANDLE CONDITION
 14144*         DUPKEY   (6499-EXIT)
 14145*         NOTFND   (6499-EXIT)
 14146*    END-EXEC.
 14147*    MOVE '"$$I                  ! C #00012852' TO DFHEIV0
 14148     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 14149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14150     MOVE X'4320233030303132383532' TO DFHEIV0(25:11)
 14151     CALL 'kxdfhei1' USING DFHEIV0
 14152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14153
 14154
 14155     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 14156
 14157     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 14158        'I' OR 'G' OR 'F')
 14159        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14160     ELSE
 14161        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14162     END-IF.
 14163
 14164     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14165     MOVE '6'                    TO DC-OPTION-CODE.
 14166     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14167
 14168     IF (WS-INCUR GREATER THAN DC-BIN-DATE-2)
 14169        and (dc-elapsed-months > zeros)
 14170        MOVE ER-0519             TO EMI-ERROR
 14171        MOVE -1                  TO INCURL
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 269
* EL130.cbl
 14172        MOVE AL-UABON            TO INCURA
 14173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14174     END-IF.
 14175
 14176     IF CLMCARRI NOT = CRTCARRI
 14177        MOVE ER-0562             TO EMI-ERROR
 14178        MOVE AL-UABON            TO CLMCARRA
 14179        MOVE -1                  TO CLMCARRL
 14180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14181     END-IF.
 14182
 14183     if (pi-company-id = 'DCC' OR 'VPP')
 14184        and (ws-dcc-product-code <> spaces)
 14185        continue
 14186     else
 14187      IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F') AND
 14188        CM-AH-BENEFIT-CD = '00')
 14189                  OR
 14190        ((CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O') AND
 14191        CM-LF-BENEFIT-CD = '00')
 14192         MOVE ER-0521         TO EMI-ERROR
 14193         MOVE AL-UABON        TO CLMTYPEA
 14194         MOVE -1              TO CLMTYPEL
 14195         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14196      END-IF
 14197     end-if
 14198*    IF CLMTYPEI = 'I' AND
 14199*       CM-AH-CRITICAL-PERIOD = +0
 14200*        MOVE ER-0521         TO EMI-ERROR
 14201*        MOVE AL-UABON        TO CLMTYPEA
 14202*        MOVE -1              TO CLMTYPEL
 14203*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14204*    END-IF
 14205
 14206*    IF PI-COMPANY-ID = 'CRI'
 14207*        IF MAINTI = 'A'
 14208*            IF CERT-PEND-ISSUE-ERROR  OR
 14209*               CERT-PEND-ISSUE-RETURNED
 14210*                MOVE -1                 TO CERTNOL
 14211*                MOVE AL-UABON           TO CERTNOA
 14212*                MOVE ER-7640            TO EMI-ERROR
 14213*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14214*            END-IF
 14215*        END-IF
 14216*    END-IF.
 14217
 14218     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 14219         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14220         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 14221             GO TO 6450-DATE-ERROR
 14222         END-IF
 14223     END-IF.
 14224
 14225     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 14226         (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'))
 14227         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 14228             GO TO 6450-DATE-ERROR
 14229         END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 270
* EL130.cbl
 14230     END-IF.
 14231
 14232     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14233         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 14234             GO TO 6450-DATE-ERROR
 14235         END-IF
 14236     END-IF.
 14237
 14238     GO TO 6499-EXIT.
 14239
 14240 6450-DATE-ERROR.
 14241     MOVE ER-0520                TO EMI-ERROR.
 14242     MOVE -1                     TO INCURL.
 14243     MOVE AL-UABON               TO INCURA.
 14244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14245
 14246*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 14247*       (EMI-SEVERITY-SAVE = 'X')
 14248*        ADD 1                TO EMI-FORCABLE-CTR
 14249*        SUBTRACT 1 FROM EMI-FATAL-CTR
 14250*    END-IF.
 14251
 14252     GO TO 6499-EXIT.
 14253
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 271
* EL130.cbl
 14255 6460-TEST-NEW-CERT.
 14256
 14257     IF NOT EMI-NO-ERRORS
 14258        GO TO 6499-EXIT
 14259     END-IF.
 14260
 14261     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 14262
 14263     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14264          OR 'F') AND
 14265         ACVOTRML GREATER ZERO)
 14266        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 14267     END-IF.
 14268
 14269     IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O') AND
 14270         LCVOTRML GREATER ZERO
 14271        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 14272     END-IF.
 14273
 14274     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 14275
 14276*    IF PI-COMPANY-ID = 'HAN'
 14277*        IF ADDONDTL GREATER ZERO
 14278*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 14279*            IF CLMTYPEI = 'A'
 14280*                IF ACVOTRMI NOT = ZEROS
 14281*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 14282*                ELSE
 14283*                    NEXT SENTENCE
 14284*                    CONTINUE
 14285*                END-IF
 14286*            ELSE
 14287*                IF LCVOTRMI NOT = ZEROS
 14288*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 14289*                END-IF
 14290*            END-IF
 14291*        END-IF
 14292*    END-IF.
 14293
 14294     MOVE '6'                    TO DC-OPTION-CODE.
 14295     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14296
 14297     IF NO-CONVERSION-ERROR
 14298         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 14299     END-IF.
 14300
 14301     IF WS-INCUR GREATER THAN WS-EXPIRE
 14302        MOVE ER-0519             TO EMI-ERROR
 14303        MOVE -1                  TO INCURL
 14304        MOVE AL-UABON            TO INCURA
 14305        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14306     END-IF.
 14307
 14308     IF CLMCARRI NOT = CRTCARRI
 14309        MOVE ER-0562             TO EMI-ERROR
 14310        MOVE AL-UABON            TO CLMCARRA
 14311        MOVE -1                  TO CLMCARRL
 14312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 272
* EL130.cbl
 14313     END-IF.
 14314
 14315     if (pi-company-id = 'DCC' OR 'VPP')
 14316        and (ws-dcc-product-code <> spaces)
 14317        continue
 14318     else
 14319        IF (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 14320           and (ACVCDL = ZEROS)
 14321           MOVE ER-0521          TO EMI-ERROR
 14322           MOVE AL-UABON         TO CLMTYPEA
 14323           MOVE -1               TO CLMTYPEL
 14324           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14325        END-IF
 14326     end-if
 14327
 14328     if (pi-company-id = 'DCC' OR 'VPP')
 14329        and (ws-dcc-product-code <> spaces)
 14330        continue
 14331     else
 14332        IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O')
 14333           and (LCVCDL = ZEROS)
 14334           MOVE ER-0521          TO EMI-ERROR
 14335           MOVE AL-UABON         TO CLMTYPEA
 14336           MOVE -1               TO CLMTYPEL
 14337           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14338        END-IF
 14339     end-if
 14340
 14341     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'
 14342         IF LCVCNDTL GREATER ZERO
 14343             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14344                 GO TO 6450-DATE-ERROR
 14345             END-IF
 14346         END-IF
 14347     END-IF.
 14348
 14349     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14350         IF ACVCNDTL GREATER ZERO
 14351             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14352                 GO TO 6450-DATE-ERROR
 14353             END-IF
 14354         END-IF
 14355     END-IF.
 14356
 14357 6499-EXIT.
 14358     EXIT.
 14359 6500-get-acct.
 14360
 14361     MOVE SPACES                 TO ERACCT-KEY
 14362                                    ws-dcc-product-code
 14363                                    ws-acct-found-sw
 14364
 14365     IF CARR-GROUP-ST-ACCNT-CNTL
 14366        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14367        MOVE CRTCARRI            TO ACCT-CARRIER
 14368        MOVE GROUPI              TO ACCT-GROUPING
 14369        MOVE STATEI              TO ACCT-STATE
 14370        MOVE ACCOUNTI            TO ACCT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 273
* EL130.cbl
 14371        GO TO 6500-startbr
 14372     END-IF
 14373
 14374     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14375     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14376
 14377     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14378        MOVE STATEI             TO ACCT-STATE
 14379     END-IF
 14380
 14381     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14382        MOVE CRTCARRI           TO ACCT-CARRIER
 14383     END-IF
 14384
 14385     .
 14386 6500-startbr.
 14387
 14388     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14389
 14390
 14391* EXEC CICS STARTBR
 14392*       DATASET     (ERACCT2-DSID)
 14393*       RIDFLD      (SAVE-ERACCT-KEY)
 14394*       GENERIC
 14395*       KEYLENGTH   (20)
 14396*       resp        (ws-response)
 14397*    END-EXEC
 14398     MOVE 20
 14399       TO DFHEIV11
 14400     MOVE 0
 14401       TO DFHEIV12
 14402*    MOVE '&,   KG    G          &  N#00013092' TO DFHEIV0
 14403     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14404     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14405     MOVE X'204E233030303133303932' TO DFHEIV0(25:11)
 14406     CALL 'kxdfhei1' USING DFHEIV0,
 14407           ERACCT2-DSID,
 14408           SAVE-ERACCT-KEY,
 14409           DFHEIV11,
 14410           DFHEIV12,
 14411           DFHEIV99
 14412     MOVE EIBRESP  TO ws-response
 14413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14414
 14415     if not ws-resp-normal
 14416        go to 6500-exit
 14417     end-if
 14418
 14419     .
 14420 6500-readnext.
 14421
 14422
 14423* EXEC CICS READNEXT
 14424*       DATASET   (ERACCT2-DSID)
 14425*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14426*       RIDFLD    (SAVE-ERACCT-KEY)
 14427*    END-EXEC
 14428     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 274
* EL130.cbl
 14429       TO DFHEIV11
 14430*    MOVE '&.S                   )   #00013107' TO DFHEIV0
 14431     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14432     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14433     MOVE X'2020233030303133313037' TO DFHEIV0(25:11)
 14434     CALL 'kxdfhei1' USING DFHEIV0,
 14435           ERACCT2-DSID,
 14436           DFHEIV20,
 14437           DFHEIV99,
 14438           SAVE-ERACCT-KEY,
 14439           DFHEIV99,
 14440           DFHEIV11,
 14441           DFHEIV99,
 14442           DFHEIV99
 14443     SET ADDRESS OF ACCOUNT-MASTER TO
 14444         DFHEIV20
 14445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14446
 14447     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14448        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14449        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14450        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14451        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14452        go to 6500-endbr
 14453     END-IF
 14454
 14455     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14456        and (WS-EFFDT < AM-EXPIRATION-DT)
 14457        set acct-found to true
 14458        MOVE AM-dcc-product-code to ws-dcc-product-code
 14459        GO TO 6500-endbr
 14460     END-IF
 14461
 14462     IF WS-EFFDT >= AM-EXPIRATION-DT
 14463         GO TO 6500-readnext
 14464     END-IF
 14465
 14466     .
 14467 6500-endbr.
 14468
 14469
 14470* EXEC CICS ENDBR
 14471*        DATASET    (ERACCT2-DSID)
 14472*    END-EXEC
 14473     MOVE 0
 14474       TO DFHEIV11
 14475*    MOVE '&2                    $   #00013135' TO DFHEIV0
 14476     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14477     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14478     MOVE X'2020233030303133313335' TO DFHEIV0(25:11)
 14479     CALL 'kxdfhei1' USING DFHEIV0,
 14480           ERACCT2-DSID,
 14481           DFHEIV11,
 14482           DFHEIV99
 14483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14484
 14485     .
 14486 6500-exit.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 275
* EL130.cbl
 14487     exit.
 14488 6600-CHECK-AUTO-ACTIVITY.
 14489
 14490
 14491* EXEC CICS HANDLE CONDITION
 14492*        NOTFND   (6600-NOT-FOUND)
 14493*    END-EXEC.
 14494*    MOVE '"$I                   ! D #00013144' TO DFHEIV0
 14495     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14497     MOVE X'4420233030303133313434' TO DFHEIV0(25:11)
 14498     CALL 'kxdfhei1' USING DFHEIV0
 14499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14500
 14501
 14502     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14503     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14504     MOVE SPACES                     TO  CNTL-ACCESS.
 14505     MOVE +0                         TO  CNTL-SEQ-NO.
 14506
 14507     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14508
 14509     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14510         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14511                                         WS-LETTER-SW
 14512         GO TO 6600-EXIT
 14513     END-IF.
 14514
 14515     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14516         MOVE 'N'                     TO  WS-LETTER-SW
 14517     ELSE
 14518         MOVE 'Y'                     TO  WS-LETTER-SW
 14519     END-IF.
 14520
 14521     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14522     GO TO 6600-EXIT.
 14523
 14524 6600-START-AUTO-LETTER-WRITER.
 14525
 14526     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14527     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14528
 14529     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14530
 14531     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14532         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14533         MOVE '6'                     TO  DC-OPTION-CODE
 14534         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14535         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14536         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14537         IF NO-CONVERSION-ERROR
 14538             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14539         ELSE
 14540             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14541         END-IF
 14542     END-IF.
 14543
 14544     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 276
* EL130.cbl
 14545         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14546         MOVE '6'                     TO  DC-OPTION-CODE
 14547         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14548         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14549         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14550         IF NO-CONVERSION-ERROR
 14551             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14552         ELSE
 14553             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14554         END-IF
 14555     END-IF.
 14556
 14557
 14558
 14559* EXEC CICS LINK
 14560*        PROGRAM    (LINK-1523)
 14561*        COMMAREA   (W-1523-LINKDATA)
 14562*        LENGTH     (W-1523-COMM-LENGTH)
 14563*    END-EXEC.
 14564*    MOVE '."C                   (   #00013204' TO DFHEIV0
 14565     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14566     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14567     MOVE X'2020233030303133323034' TO DFHEIV0(25:11)
 14568     CALL 'kxdfhei1' USING DFHEIV0,
 14569           LINK-1523,
 14570           W-1523-LINKDATA,
 14571           W-1523-COMM-LENGTH,
 14572           DFHEIV99,
 14573           DFHEIV99,
 14574           DFHEIV99,
 14575           DFHEIV99
 14576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14577
 14578
 14579     GO TO 6600-EXIT.
 14580
 14581 6600-NOT-FOUND.
 14582     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14583
 14584 6600-EXIT.
 14585     EXIT.
 14586
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 277
* EL130.cbl
 14587/
 14588*************************************************************
 14589*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14590*************************************************************
 14591
 14592 6700-OUTPUT-ACTIVITY-RECORD.
 14593
 14594
 14595
 14596* EXEC CICS GETMAIN
 14597*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14598*        LENGTH (DLYACTV-LENGTH)
 14599*        INITIMG (WS-BLANK)
 14600*    END-EXEC.
 14601*    MOVE ',"IL                  $   #00013226' TO DFHEIV0
 14602     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14603     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14604     MOVE X'2020233030303133323236' TO DFHEIV0(25:11)
 14605     CALL 'kxdfhei1' USING DFHEIV0,
 14606           DFHEIV20,
 14607           DLYACTV-LENGTH,
 14608           WS-BLANK
 14609     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14610         DFHEIV20
 14611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14612
 14613
 14614     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14615     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14616     MOVE CLMCARRI               TO DA-CARRIER.
 14617     IF CLMNOL EQUAL ZERO
 14618         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14619     ELSE
 14620         MOVE CLMNOI             TO DA-CLAIM-NO
 14621     END-IF.
 14622     MOVE CERTNOI                TO DA-CERT-PRIME.
 14623     MOVE SUFXI                  TO DA-CERT-SFX.
 14624     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14625     MOVE 'A'                    TO DA-RECORD-TYPE.
 14626
 14627
 14628* EXEC CICS HANDLE CONDITION
 14629*        NOTOPEN (6700-NOTOPEN-ERROR)
 14630*        DUPREC (6700-EXIT)
 14631*    END-EXEC.
 14632*    MOVE '"$J%                  ! E #00013245' TO DFHEIV0
 14633     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14635     MOVE X'4520233030303133323435' TO DFHEIV0(25:11)
 14636     CALL 'kxdfhei1' USING DFHEIV0
 14637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14638
 14639
 14640
 14641* EXEC CICS WRITE
 14642*        DATASET (DLYACTV-DSID)
 14643*        RIDFLD (DA-KEY)
 14644*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 278
* EL130.cbl
 14645*        LENGTH (DLYACTV-LENGTH)
 14646*    END-EXEC.
 14647*    MOVE '&$ L                  ''   #00013250' TO DFHEIV0
 14648     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14649     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14650     MOVE X'2020233030303133323530' TO DFHEIV0(25:11)
 14651     CALL 'kxdfhei1' USING DFHEIV0,
 14652           DLYACTV-DSID,
 14653           DAILY-ACTIVITY-RECORD,
 14654           DLYACTV-LENGTH,
 14655           DA-KEY,
 14656           DFHEIV99,
 14657           DFHEIV99
 14658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14659
 14660     GO TO 6700-EXIT.
 14661
 14662 6700-NOTOPEN-ERROR.
 14663     MOVE '2955'                 TO EMI-ERROR.
 14664     MOVE -1                     TO MAINTL.
 14665     MOVE AL-UANON               TO MAINTA.
 14666     PERFORM 9900-ERROR-FORMAT THRU
 14667             9900-EXIT.
 14668     GO TO 8200-SEND-DATAONLY.
 14669
 14670 6700-EXIT.
 14671     EXIT.
 14672
 14673*************************************************************
 14674*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14675*************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 279
* EL130.cbl
 14676/
 14677 6990-DEEDIT-DATE.
 14678
 14679
 14680* EXEC CICS BIF DEEDIT
 14681*        FIELD   (DATE-WORK)
 14682*        LENGTH  (8)
 14683*    END-EXEC.
 14684     MOVE 8
 14685       TO DFHEIV11
 14686*    MOVE '@"L                   #   #00013275' TO DFHEIV0
 14687     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14688     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14689     MOVE X'2020233030303133323735' TO DFHEIV0(25:11)
 14690     CALL 'kxdfhei1' USING DFHEIV0,
 14691           DATE-WORK,
 14692           DFHEIV11
 14693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14694
 14695 6990-EXIT.
 14696     EXIT.
 14697
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 280
* EL130.cbl
 14699 7000-BUILD-OUTPUT-MAP.
 14700
 14701     IF CLAIM-SWITCH = 'N'
 14702         GO TO 7050-BUILD-MAP-CERT-DATA
 14703     END-IF.
 14704
 14705     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14706         MOVE SPACES                 TO SEQUO
 14707         MOVE AL-SABOF               TO SEQUA
 14708     ELSE
 14709         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14710         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14711         MOVE WS-CLAIM-SEQU          TO SEQUO
 14712         MOVE AL-SABON               TO SEQUA
 14713     END-IF.
 14714
 14715     MOVE CL-CARRIER             TO CLMCARRO.
 14716     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14717     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14718     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14719     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14720     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14721     MOVE CL-INSURED-MID-INIT    TO INITO.
 14722     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14723     move cl-insured-type        to instypeo
 14724*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14725
 14726     MOVE AL-UANON               TO CLMCARRA
 14727                                    CLMTYPEA
 14728                                    PCERTNOA
 14729                                    PSUFXA
 14730                                    LSTNMEA
 14731                                    FSTNMEA
 14732                                    INITA
 14733                                    SEXA
 14734
 14735     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14736
 14737     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14738         MOVE ' '                 TO DC-OPTION-CODE
 14739         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14740         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14741         IF NOT DATE-CONVERSION-ERROR
 14742             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14743             MOVE AL-UANON            TO BIRTHDTA
 14744         END-IF
 14745     END-IF.
 14746
 14747     MOVE CL-SOC-SEC-NO          TO SSNO.
 14748     MOVE AL-UANON               TO SSNA.
 14749
 14750     IF CL-INCURRED-DT NOT = LOW-VALUES
 14751         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14752         MOVE ' '                TO DC-OPTION-CODE
 14753         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14754         IF NOT DATE-CONVERSION-ERROR
 14755             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14756             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 281
* EL130.cbl
 14757         END-IF
 14758     END-IF.
 14759
 14760     IF CL-REPORTED-DT NOT = LOW-VALUES
 14761         MOVE ' '                TO DC-OPTION-CODE
 14762         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14763         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14764         IF NOT DATE-CONVERSION-ERROR
 14765             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14766             MOVE AL-UANON            TO REPORTA
 14767         END-IF
 14768     END-IF.
 14769
 14770*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14771*        MOVE ' '                 TO DC-OPTION-CODE
 14772*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14773*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14774*        IF NOT DATE-CONVERSION-ERROR
 14775*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14776*            MOVE AL-UANON            TO ESTENDA
 14777*        END-IF
 14778*    END-IF.
 14779
 14780     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14781     MOVE WS-ICD-CODE-1          TO ICD1O.
 14782     MOVE WS-ICD-CODE-2          TO ICD2O.
 14783*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14784     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14785     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14786     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14787     MOVE CL-PRIORITY-CD         TO PRICDO.
 14788     MOVE AL-UANON               TO DIAGA
 14789                                    ICD1A
 14790                                    ICD2A
 14791*                                   CAUSEA
 14792                                    RELCLMA
 14793                                    PROCCDA
 14794                                    PRICDA.
 14795     MOVE AL-UNNON               TO MANRSVA.
 14796
 14797*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14798*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14799*        MOVE AL-UANON               TO PRODCDA
 14800*    END-IF.
 14801
 14802     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14803     MOVE CL-FILE-LOCATION       TO FILETOO.
 14804     MOVE CL-BENEFICIARY         TO BENECDO.
 14805     MOVE AL-UANON               TO SUPVA
 14806                                    FILETOA
 14807                                    BENECDA.
 14808
 14809     IF CLAIM-SWITCH = 'X'
 14810         GO TO 7099-EXIT
 14811     END-IF.
 14812
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 282
* EL130.cbl
 14814 7050-BUILD-MAP-CERT-DATA.
 14815     MOVE CM-CERT-PRIME          TO CERTNOO.
 14816     MOVE CM-CERT-SFX            TO SUFXO.
 14817     MOVE AL-SANON               TO CERTNOA
 14818                                    SUFXA.
 14819
 14820     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14821         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14822         MOVE ' '                TO DC-OPTION-CODE
 14823         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14824         IF NOT DATE-CONVERSION-ERROR
 14825             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14826         END-IF
 14827     END-IF.
 14828
 14829     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14830     MOVE CM-STATE               TO STATEO.
 14831     MOVE CM-CARRIER             TO CRTCARRO.
 14832     MOVE CM-GROUPING            TO GROUPO.
 14833     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14834     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14835     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14836     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14837     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14838     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14839     MOVE CM-JT-INITIAL          TO JNTINITO.
 14840     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14841     MOVE AL-UANON               TO ACCOUNTA
 14842                                    STATEA
 14843                                    CRTCARRA
 14844                                    GROUPA
 14845                                    CRTLNMEA
 14846                                    CRTFNMEA
 14847                                    CRTINITA
 14848                                    JNTLNMEA
 14849                                    JNTFNMEA
 14850                                    JNTINITA.
 14851     MOVE AL-UNNON               TO ISSAGEA
 14852                                    JNTAGEA.
 14853
 14854     IF CM-SSN-STATE   = CM-STATE AND
 14855        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14856*        NEXT SENTENCE
 14857         CONTINUE
 14858     ELSE
 14859         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14860     END-IF.
 14861
 14862     MOVE AL-UANON               TO CRTSSNA.
 14863
 14864     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14865     MOVE '2'                    TO DC-OPTION-CODE.
 14866     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14867     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14868
 14869*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14870     MOVE SPACES                 TO ELCNTL-KEY.
 14871     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 283
* EL130.cbl
 14872     MOVE '3'                    TO CNTL-REC-TYPE.
 14873     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14874     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14875
 14876
 14877
 14878* EXEC CICS READ
 14879*        DATASET  (ELCNTL-DSID)
 14880*        SET      (ADDRESS OF CONTROL-FILE)
 14881*        RIDFLD   (ELCNTL-KEY)
 14882*        RESP     (WS-RESPONSE)
 14883*    END-EXEC.
 14884*    MOVE '&"S        E          (  N#00013461' TO DFHEIV0
 14885     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14886     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14887     MOVE X'204E233030303133343631' TO DFHEIV0(25:11)
 14888     CALL 'kxdfhei1' USING DFHEIV0,
 14889           ELCNTL-DSID,
 14890           DFHEIV20,
 14891           DFHEIV99,
 14892           ELCNTL-KEY,
 14893           DFHEIV99,
 14894           DFHEIV99,
 14895           DFHEIV99
 14896     SET ADDRESS OF CONTROL-FILE TO
 14897         DFHEIV20
 14898     MOVE EIBRESP  TO WS-RESPONSE
 14899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14900
 14901
 14902     IF WS-RESP-NOTFND
 14903          MOVE ER-2848           TO EMI-ERROR
 14904          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14905          GO TO 8100-SEND-INITIAL-MAP
 14906     END-IF.
 14907
 14908     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14909     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14910     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 284
* EL130.cbl
 14912     IF CM-LF-BENEFIT-CD = '00'
 14913         MOVE ZEROS              TO LCVOTRMO
 14914                                    LCVRTRMO
 14915                                    LCVRATEO
 14916                                    LCVBENEO
 14917         MOVE SPACES             TO LCVDSCRO
 14918                                    LCVCDO
 14919                                    LCVKINDO
 14920                                    LCVFORMO
 14921                                    LCVCNDTO
 14922                                    LCVEXITO
 14923                                    LCVSTATO
 14924         IF CLMTYPEL GREATER THAN ZERO AND
 14925            CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'
 14926                MOVE ER-0521     TO EMI-ERROR
 14927                MOVE AL-UABON    TO CLMTYPEA
 14928                MOVE -1          TO CLMTYPEL
 14929                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14930                GO TO 7060-FILL-AH-COVERAGE
 14931         ELSE
 14932             GO TO 7060-FILL-AH-COVERAGE
 14933         END-IF
 14934     END-IF.
 14935
 14936     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14937     MOVE AL-UANON               TO LCVDSCRA.
 14938     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14939     MOVE '4'                    TO WS-REC-TYPE.
 14940     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14941     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14942     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14943     MOVE AL-UANON               TO LCVCDA.
 14944     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14945                                    CP-ORIGINAL-TERM.
 14946     MOVE AL-UNNON               TO LCVOTRMA.
 14947     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14948     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14949     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14950     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14951     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14952     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14953
 14954     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14955     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14956
 14957     IF CM-LF-PREMIUM-RATE NUMERIC
 14958         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14959     ELSE
 14960         MOVE ZEROS              TO LCVRATEO
 14961     END-IF.
 14962
 14963     MOVE AL-UNNON               TO LCVRATEA.
 14964
 14965     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14966         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14967     END-IF.
 14968
 14969     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 285
* EL130.cbl
 14970
 14971     MOVE AL-UNNON               TO LCVBENEA.
 14972
 14973     IF CM-POLICY-FORM-NO NOT = SPACES
 14974         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14975     ELSE
 14976         MOVE WS-FORM-HOLD       TO LCVFORMO
 14977     END-IF.
 14978
 14979     MOVE SPACES                 TO WS-FORM-HOLD.
 14980     MOVE 'L'                    TO WS-REC-TYPE.
 14981     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14982
 14983     IF WS-FORM-HOLD NOT = SPACES
 14984         MOVE WS-FORM-HOLD       TO LCVFORMO
 14985         MOVE AL-UANON           TO LCVFORMA
 14986     END-IF.
 14987
 14988     IF CM-LF-CURRENT-STATUS = '8'
 14989         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14990             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14991             MOVE ' '             TO DC-OPTION-CODE
 14992             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14993             IF NOT DATE-CONVERSION-ERROR
 14994                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14995                 MOVE AL-UANON            TO LCVCNDTA
 14996             END-IF
 14997         END-IF
 14998     END-IF.
 14999
 15000     IF CM-LF-CURRENT-STATUS = '7'
 15001         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15002             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 15003             MOVE ' '            TO DC-OPTION-CODE
 15004             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15005             IF NOT DATE-CONVERSION-ERROR
 15006                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 15007                 MOVE AL-UANON   TO LCVCNDTA
 15008             END-IF
 15009         END-IF
 15010     END-IF.
 15011
 15012     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15013         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 15014             MOVE ' '            TO DC-OPTION-CODE
 15015             MOVE CM-LF-DEATH-EXIT-DT
 15016                                 TO DC-BIN-DATE-1
 15017             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15018             IF NOT DATE-CONVERSION-ERROR
 15019                 MOVE DC-GREG-DATE-1-EDIT
 15020                                 TO LCVEXITO
 15021             END-IF
 15022         END-IF
 15023     END-IF.
 15024
 15025     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15026         IF CP-REMAINING-TERM-3 = ZEROS
 15027             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 286
* EL130.cbl
 15028         ELSE
 15029             MOVE 'ACTIVE'       TO LCVSTATO
 15030         END-IF
 15031     END-IF.
 15032
 15033     IF CM-LF-CURRENT-STATUS = '2'
 15034        MOVE 'PEND  '            TO LCVSTATO
 15035     END-IF.
 15036     IF CM-LF-CURRENT-STATUS = '3'
 15037        MOVE 'RESTORE'           TO LCVSTATO
 15038     END-IF.
 15039     IF CM-LF-CURRENT-STATUS = '5'
 15040        MOVE 'REISSUE'           TO LCVSTATO
 15041     END-IF.
 15042     IF CM-LF-CURRENT-STATUS = '6'
 15043        MOVE 'LMP DIS'           TO LCVSTATO
 15044     END-IF.
 15045     IF CM-LF-CURRENT-STATUS = '7'
 15046        MOVE 'DEATH  '           TO LCVSTATO
 15047     END-IF.
 15048     IF CM-LF-CURRENT-STATUS = '8'
 15049        MOVE 'CANCEL '           TO LCVSTATO
 15050     END-IF.
 15051     IF CM-LF-CURRENT-STATUS = '9'
 15052        MOVE 'RE-ONLY'           TO LCVSTATO
 15053     END-IF.
 15054     IF CM-LF-CURRENT-STATUS = 'V'
 15055        MOVE 'VOID   '           TO LCVSTATO
 15056     END-IF.
 15057     IF CM-LF-CURRENT-STATUS = 'D'
 15058        MOVE 'DECLINE'           TO LCVSTATO
 15059     END-IF.
 15060
 15061     IF PI-COMPANY-ID = 'CID'
 15062         IF CM-LF-BENEFIT-CD >= '2O' AND
 15063            CM-LF-BENEFIT-CD <= '2V'
 15064             MOVE ER-0878       TO EMI-ERROR
 15065             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15066         END-IF
 15067     END-IF.
 15068
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 287
* EL130.cbl
 15070 7060-FILL-AH-COVERAGE.
 15071
 15072     IF CM-AH-BENEFIT-CD = '00'
 15073         MOVE ZEROS              TO ACVOTRMO
 15074                                    ACVRTRMO
 15075                                    ACVRATEO
 15076                                    ACVBENEO
 15077         MOVE SPACES             TO ACVDSCRO
 15078                                    ACVCDO
 15079                                    ACVKINDO
 15080                                    ACVFORMO
 15081                                    ACVCNDTO
 15082                                    ACVEXITO
 15083                                    ACVSTATO
 15084         IF (CLMTYPEL GREATER THAN ZERO AND
 15085             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 15086             MOVE ER-0521     TO EMI-ERROR
 15087             MOVE AL-UABON    TO CLMTYPEA
 15088             MOVE -1          TO CLMTYPEL
 15089             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15090             GO TO 7070-BUILD-MAP-FINISH
 15091         ELSE
 15092             GO TO 7070-BUILD-MAP-FINISH
 15093         END-IF
 15094     END-IF.
 15095
 15096     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15097     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 15098     MOVE AL-UANON               TO ACVDSCRA
 15099                                    ACVCDA.
 15100     MOVE '5'                    TO WS-REC-TYPE.
 15101     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 15102     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 15103
 15104     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 15105                                    CP-ORIGINAL-TERM.
 15106     MOVE AL-UNNON               TO ACVOTRMA.
 15107
 15108     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15109     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15110     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 15111     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15112     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15113     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15114
 15115     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 15116     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15117
 15118     IF CM-AH-PREMIUM-RATE NUMERIC
 15119         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15120     ELSE
 15121         MOVE ZEROS              TO ACVRATEO
 15122     END-IF.
 15123
 15124     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 15125     MOVE AL-UNNON               TO ACVRATEA
 15126                                    ACVBENEA.
 15127
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 288
* EL130.cbl
 15128     IF CM-POLICY-FORM-NO NOT = SPACES
 15129         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 15130     ELSE
 15131         MOVE WS-FORM-HOLD       TO ACVFORMO
 15132         MOVE SPACES TO WS-FORM-HOLD
 15133         MOVE 'A'                TO WS-REC-TYPE
 15134         PERFORM 7400-READ-STATE THRU 7499-EXIT
 15135         IF WS-FORM-HOLD NOT = SPACES
 15136             MOVE WS-FORM-HOLD   TO ACVFORMO
 15137         END-IF
 15138     END-IF.
 15139
 15140     MOVE AL-UANON               TO ACVFORMA.
 15141
 15142     IF CM-AH-CURRENT-STATUS = '8'
 15143         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 15144             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15145             MOVE ' '             TO DC-OPTION-CODE
 15146             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15147             IF NOT DATE-CONVERSION-ERROR
 15148                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15149                MOVE AL-UANON    TO ACVCNDTA
 15150             END-IF
 15151         END-IF
 15152     END-IF.
 15153
 15154     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15155         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15156             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 15157             MOVE ' '             TO DC-OPTION-CODE
 15158             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15159             IF NOT DATE-CONVERSION-ERROR
 15160                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15161                MOVE AL-UANON            TO ACVCNDTA
 15162             END-IF
 15163         END-IF
 15164     END-IF.
 15165
 15166     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15167         MOVE ' '                TO DC-OPTION-CODE
 15168         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15169         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15170         IF NOT DATE-CONVERSION-ERROR
 15171             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 15172         END-IF
 15173     END-IF.
 15174
 15175     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15176         IF CP-REMAINING-TERM-3 = ZEROS
 15177             MOVE 'EXPIRED'      TO ACVSTATO
 15178         ELSE
 15179             MOVE 'ACTIVE'       TO ACVSTATO
 15180         END-IF
 15181     END-IF.
 15182
 15183     IF CM-AH-CURRENT-STATUS = '2'
 15184         MOVE 'PEND  '           TO ACVSTATO
 15185     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 289
* EL130.cbl
 15186     IF CM-AH-CURRENT-STATUS = '3'
 15187         MOVE 'RESTORE'          TO ACVSTATO
 15188     END-IF.
 15189     IF CM-AH-CURRENT-STATUS = '5'
 15190         MOVE 'REISSUE'          TO ACVSTATO
 15191     END-IF.
 15192     IF CM-AH-CURRENT-STATUS = '6'
 15193         MOVE 'LMP DIS'          TO ACVSTATO
 15194     END-IF.
 15195     IF CM-AH-CURRENT-STATUS = '7'
 15196         MOVE 'DEATH  '          TO ACVSTATO
 15197     END-IF.
 15198     IF CM-AH-CURRENT-STATUS = '8'
 15199         MOVE 'CANCEL '          TO ACVSTATO
 15200     END-IF.
 15201     IF CM-AH-CURRENT-STATUS = '9'
 15202         MOVE 'RE-ONLY'          TO ACVSTATO
 15203     END-IF.
 15204     IF CM-AH-CURRENT-STATUS = 'V'
 15205         MOVE 'VOID   '          TO ACVSTATO
 15206     END-IF.
 15207     IF CM-AH-CURRENT-STATUS = 'D'
 15208         MOVE 'DECLINE'          TO ACVSTATO
 15209     END-IF.
 15210
 15211     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
 15212        IF CM-ACCOUNT (9:2) = 'BI'
 15213           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 15214           MOVE CM-CARRIER       TO CTRLR-CARRIER
 15215           MOVE CM-GROUPING      TO CTRLR-GROUPING
 15216           MOVE CM-STATE         TO CTRLR-STATE
 15217           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 15218           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 15219           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 15220           MOVE 'C'              TO CTRLR-REC-TYPE
 15221
 15222* EXEC CICS READ
 15223*            DATASET  (ELCRTT-DSID)
 15224*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 15225*            RIDFLD   (ELCRTT-KEY)
 15226*            RESP     (WS-RESPONSE)
 15227*          END-EXEC
 15228*    MOVE '&"S        E          (  N#00013787' TO DFHEIV0
 15229     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15231     MOVE X'204E233030303133373837' TO DFHEIV0(25:11)
 15232     CALL 'kxdfhei1' USING DFHEIV0,
 15233           ELCRTT-DSID,
 15234           DFHEIV20,
 15235           DFHEIV99,
 15236           ELCRTT-KEY,
 15237           DFHEIV99,
 15238           DFHEIV99,
 15239           DFHEIV99
 15240     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 15241         DFHEIV20
 15242     MOVE EIBRESP  TO WS-RESPONSE
 15243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 290
* EL130.cbl
 15244           IF WS-RESP-NORMAL
 15245               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 15246               MOVE WS-DIAG-VIN-MSG TO DIAGO
 15247               MOVE AL-UANON        TO DIAGA
 15248           END-IF
 15249        END-IF
 15250     END-IF.
 15251
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 291
* EL130.cbl
 15253 7070-BUILD-MAP-FINISH.
 15254     MOVE CM-LOAN-APR            TO APRO.
 15255     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15256     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15257     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 15258     MOVE AL-UNNON               TO APRA
 15259                                    PMTFREQA.
 15260     MOVE AL-UANON               TO INDGRPA
 15261                                    PREMTYPA.
 15262
 15263     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 15264         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 15265         MOVE AL-UANON               TO REINCDA
 15266     END-IF.
 15267
 15268     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 15269*        NEXT SENTENCE
 15270         CONTINUE
 15271     ELSE
 15272         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15273         MOVE ' '                TO DC-OPTION-CODE
 15274         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15275         IF NOT DATE-CONVERSION-ERROR
 15276             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 15277             MOVE AL-UANON            TO ADDONDTA
 15278         END-IF
 15279     END-IF.
 15280
 15281     IF CLAIM-SWITCH = 'N'
 15282         IF SEXL = ZEROS
 15283             MOVE CM-INSURED-SEX TO SEXO
 15284*            MOVE AL-UANON       TO SEXA
 15285         END-IF
 15286     END-IF.
 15287
 15288     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 15289         MOVE CM-MEMBER-NO       TO MEMBERO
 15290         MOVE AL-UANON           TO MEMBERA
 15291     END-IF.
 15292
 15293     IF MAINTI = 'A'
 15294         IF (LOANNOL = ZEROS OR
 15295             EIBAID = DFHPF5)
 15296             MOVE CM-LOAN-NUMBER TO LOANNOO
 15297             MOVE AL-UANON       TO LOANNOA
 15298         ELSE
 15299*            NEXT SENTENCE
 15300             CONTINUE
 15301         END-IF
 15302     ELSE
 15303         MOVE CM-LOAN-NUMBER     TO LOANNOO
 15304         MOVE AL-UANON           TO LOANNOA
 15305     END-IF.
 15306
 15307     IF MAINTI = 'A'
 15308         IF (LOANBALL = ZEROS OR
 15309             EIBAID = DFHPF5)
 15310             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 292
* EL130.cbl
 15311             MOVE AL-UNNON       TO LOANBALA
 15312         ELSE
 15313*            NEXT SENTENCE
 15314             CONTINUE
 15315         END-IF
 15316     ELSE
 15317         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15318         MOVE AL-UNNON           TO LOANBALA
 15319     END-IF.
 15320
 15321     IF CM-PREMIUM-TYPE NOT = '3'
 15322         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15323             PERFORM 7200-PROTECT-CERT-FIELDS
 15324         ELSE
 15325             PERFORM 7300-RESET-KEY-ATTRBS
 15326         END-IF
 15327     ELSE
 15328         PERFORM 7300-RESET-KEY-ATTRBS
 15329     END-IF.
 15330
 15331*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15332*        NEXT SENTENCE
 15333*        CONTINUE
 15334*    ELSE
 15335         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15336*    END-IF.
 15337
 15338 7099-EXIT.
 15339     EXIT.
 15340
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 293
* EL130.cbl
 15342 7100-READ-BENEFIT.
 15343
 15344
 15345* EXEC CICS HANDLE CONDITION
 15346*         NOTFND   (7120-NOT-FOUND)
 15347*    END-EXEC.
 15348*    MOVE '"$I                   ! F #00013893' TO DFHEIV0
 15349     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15351     MOVE X'4620233030303133383933' TO DFHEIV0(25:11)
 15352     CALL 'kxdfhei1' USING DFHEIV0
 15353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15354
 15355
 15356     MOVE SPACES                 TO ELCNTL-KEY.
 15357     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15358     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15359     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15360     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15361
 15362 7105-READ-FILE.
 15363     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15364
 15365     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15366        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15367          GO TO 7120-NOT-FOUND
 15368     END-IF.
 15369
 15370     MOVE 1                      TO SUB.
 15371 7110-LOOP.
 15372     IF SUB = 9
 15373         GO TO 7120-NOT-FOUND
 15374     END-IF.
 15375
 15376     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15377         ADD 1                   TO SUB
 15378         GO TO 7110-LOOP
 15379     END-IF.
 15380
 15381     if ws-rec-type = '4'
 15382        move cf-joint-indicator (sub)
 15383                                 to ws-lf-joint-indicator
 15384     else
 15385        move cf-joint-indicator (sub)
 15386                                 to ws-ah-joint-indicator
 15387     end-if
 15388     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15389     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15390     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15391
 15392     GO TO 7199-EXIT.
 15393
 15394 7120-NOT-FOUND.
 15395     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15396                                    WS-FORM-HOLD.
 15397
 15398 7199-EXIT.
 15399      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 294
* EL130.cbl
 15400
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 295
* EL130.cbl
 15402 7200-PROTECT-CERT-FIELDS.
 15403     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15404                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15405                                LCVFORMA ACVFORMA JNTLNMEA
 15406                                JNTFNMEA JNTINITA.
 15407
 15408     IF CM-LF-CURRENT-STATUS = '2' OR
 15409        CM-AH-CURRENT-STATUS = '2'
 15410         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15411     END-IF.
 15412
 15413     MOVE AL-SANOF TO
 15414            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15415            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15416            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15417            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15418            LCVRATEA   ACVRATEA.
 15419
 15420     MOVE 'S'                    TO CERTMTI.
 15421
 15422 7300-RESET-KEY-ATTRBS.
 15423     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15424                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15425                                LCVFORMA ACVFORMA JNTLNMEA
 15426                                JNTFNMEA JNTINITA.
 15427
 15428     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15429         MOVE AL-SANOF           TO REINCDA
 15430     END-IF.
 15431
 15432     MOVE 'S'                    TO CERTMTI.
 15433
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 296
* EL130.cbl
 15435 7400-READ-STATE.
 15436
 15437
 15438* EXEC CICS HANDLE CONDITION
 15439*         NOTFND   (7499-EXIT)
 15440*    END-EXEC.
 15441*    MOVE '"$I                   ! G #00013978' TO DFHEIV0
 15442     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15443     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15444     MOVE X'4720233030303133393738' TO DFHEIV0(25:11)
 15445     CALL 'kxdfhei1' USING DFHEIV0
 15446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15447
 15448
 15449     MOVE SPACES                 TO ELCNTL-KEY.
 15450     MOVE CM-STATE               TO CNTL-ACCESS.
 15451     MOVE '3'                    TO CNTL-REC-TYPE.
 15452     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15453     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15454
 15455     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15456
 15457     MOVE 1                      TO SUB.
 15458
 15459 7410-LOOP.
 15460     IF SUB = 21
 15461        GO TO 7499-EXIT
 15462     END-IF.
 15463
 15464*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15465*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15466*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15467*        GO TO 7499-EXIT.
 15468
 15469     ADD 1                       TO SUB.
 15470     GO TO 7410-LOOP.
 15471
 15472 7499-EXIT.
 15473      EXIT.
 15474
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 297
* EL130.cbl
 15476 7500-BROWSE-FOR-DUPLICATE.
 15477
 15478     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15479
 15480
 15481
 15482* EXEC CICS HANDLE CONDITION
 15483*        NOTFND   (7500-EXIT)
 15484*        DUPKEY   (7500-DUPLICATE-KEY)
 15485*        ENDFILE  (7500-EXIT)
 15486*    END-EXEC.
 15487*    MOVE '"$I$''                 ! H #00014014' TO DFHEIV0
 15488     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15490     MOVE X'4820233030303134303134' TO DFHEIV0(25:11)
 15491     CALL 'kxdfhei1' USING DFHEIV0
 15492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15493
 15494
 15495
 15496
 15497* EXEC CICS STARTBR
 15498*        DATASET    (ELMSTR5-DSID)
 15499*        RIDFLD     (ELMSTR5-KEY)
 15500*    END-EXEC.
 15501     MOVE 0
 15502       TO DFHEIV11
 15503*    MOVE '&,         G          &   #00014021' TO DFHEIV0
 15504     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15505     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15506     MOVE X'2020233030303134303231' TO DFHEIV0(25:11)
 15507     CALL 'kxdfhei1' USING DFHEIV0,
 15508           ELMSTR5-DSID,
 15509           ELMSTR5-KEY,
 15510           DFHEIV99,
 15511           DFHEIV11,
 15512           DFHEIV99
 15513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15514
 15515
 15516
 15517
 15518* EXEC CICS HANDLE CONDITION
 15519*        ENDFILE  (7500-END-BROWSE)
 15520*    END-EXEC.
 15521*    MOVE '"$''                   ! I #00014027' TO DFHEIV0
 15522     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15523     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15524     MOVE X'4920233030303134303237' TO DFHEIV0(25:11)
 15525     CALL 'kxdfhei1' USING DFHEIV0
 15526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15527
 15528
 15529 7500-READ-CLAIM-LOOP.
 15530
 15531
 15532
 15533* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 298
* EL130.cbl
 15534*        DATASET   (ELMSTR5-DSID)
 15535*        SET       (ADDRESS OF CLAIM-MASTER)
 15536*        RIDFLD    (ELMSTR5-KEY)
 15537*    END-EXEC.
 15538     MOVE 0
 15539       TO DFHEIV11
 15540*    MOVE '&.S                   )   #00014034' TO DFHEIV0
 15541     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15542     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15543     MOVE X'2020233030303134303334' TO DFHEIV0(25:11)
 15544     CALL 'kxdfhei1' USING DFHEIV0,
 15545           ELMSTR5-DSID,
 15546           DFHEIV20,
 15547           DFHEIV99,
 15548           ELMSTR5-KEY,
 15549           DFHEIV99,
 15550           DFHEIV11,
 15551           DFHEIV99,
 15552           DFHEIV99
 15553     SET ADDRESS OF CLAIM-MASTER TO
 15554         DFHEIV20
 15555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15556
 15557
 15558 7500-DUPLICATE-KEY.
 15559
 15560     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15561        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15562        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15563        CL-CERT-STATE     NOT = CM-STATE       OR
 15564        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15565        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15566        CL-CERT-NO        NOT = CM-CERT-NO
 15567           GO TO 7500-CHECK-MATCH-COUNT
 15568     END-IF.
 15569
 15570     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15571
 15572     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15573        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15574        GO TO 7500-END-BROWSE
 15575     ELSE
 15576        GO TO 7500-READ-CLAIM-LOOP
 15577     END-IF.
 15578
 15579 7500-CHECK-MATCH-COUNT.
 15580
 15581     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15582        CL-CERT-NO    = CM-CERT-NO
 15583          GO TO 7500-READ-CLAIM-LOOP
 15584     END-IF.
 15585
 15586 7500-END-BROWSE.
 15587
 15588
 15589
 15590* EXEC CICS ENDBR
 15591*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 299
* EL130.cbl
 15592*    END-EXEC.
 15593     MOVE 0
 15594       TO DFHEIV11
 15595*    MOVE '&2                    $   #00014071' TO DFHEIV0
 15596     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15597     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15598     MOVE X'2020233030303134303731' TO DFHEIV0(25:11)
 15599     CALL 'kxdfhei1' USING DFHEIV0,
 15600           ELMSTR5-DSID,
 15601           DFHEIV11,
 15602           DFHEIV99
 15603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15604
 15605
 15606 7500-EXIT.
 15607     EXIT.
 15608
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 300
* EL130.cbl
 15610 7550-FALL-THRU-PARA.
 15611
 15612
 15613
 15614* EXEC CICS DUMP
 15615*         DUMPCODE ('E130')
 15616*         TASK
 15617*    END-EXEC.
 15618     MOVE 'E130' TO DFHEIV5
 15619*    MOVE '<"   T                $   #00014082' TO DFHEIV0
 15620     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15621     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15622     MOVE X'2020233030303134303832' TO DFHEIV0(25:11)
 15623     CALL 'kxdfhei1' USING DFHEIV0,
 15624           DFHEIV5,
 15625           DFHEIV99,
 15626           DFHEIV99
 15627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15628
 15629
 15630
 15631
 15632* EXEC CICS RETURN
 15633*    END-EXEC.
 15634*    MOVE '.(                    ''   #00014088' TO DFHEIV0
 15635     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15636     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15637     MOVE X'2020233030303134303838' TO DFHEIV0(25:11)
 15638     CALL 'kxdfhei1' USING DFHEIV0,
 15639           DFHEIV99,
 15640           DFHEIV99,
 15641           DFHEIV99,
 15642           DFHEIV99,
 15643           DFHEIV99,
 15644           DFHEIV99
 15645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15646
 15647
 15648 7600-BROWSE-CLAIM.
 15649
 15650
 15651
 15652* EXEC CICS READ
 15653*        DATASET(ELMSTR-DSID)
 15654*        SET    (ADDRESS OF CLAIM-MASTER)
 15655*        RIDFLD (ELMSTR-KEY)
 15656*        GENERIC
 15657*        EQUAL
 15658*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15659*    END-EXEC.
 15660*    MOVE '&"S  KG    E          (   #00014094' TO DFHEIV0
 15661     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15663     MOVE X'2020233030303134303934' TO DFHEIV0(25:11)
 15664     CALL 'kxdfhei1' USING DFHEIV0,
 15665           ELMSTR-DSID,
 15666           DFHEIV20,
 15667           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 301
* EL130.cbl
 15668           ELMSTR-KEY,
 15669           ELMSTR-GENERIC-LENGTH,
 15670           DFHEIV99,
 15671           DFHEIV99
 15672     SET ADDRESS OF CLAIM-MASTER TO
 15673         DFHEIV20
 15674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15675
 15676
 15677     MOVE CL-CERT-PRIME          TO CERTNOI.
 15678     MOVE CL-CERT-SFX            TO SUFXI.
 15679
 15680 7610-BROWSE-CLAIM-LOOP.
 15681
 15682     MOVE LOW-VALUES             TO BCERT1O
 15683                                    BSUFX1O
 15684                                    BCERT2O
 15685                                    BSUFX2O
 15686                                    BCERT3O
 15687                                    BSUFX3O
 15688                                    BCERT4O
 15689                                    BSUFX4O
 15690                                    BCERT5O
 15691                                    BSUFX5O.
 15692
 15693     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15694
 15695
 15696
 15697* EXEC CICS HANDLE CONDITION
 15698*        ENDFILE  (7630-END-BROWSE)
 15699*    END-EXEC.
 15700*    MOVE '"$''                   ! J #00014122' TO DFHEIV0
 15701     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15703     MOVE X'4A20233030303134313232' TO DFHEIV0(25:11)
 15704     CALL 'kxdfhei1' USING DFHEIV0
 15705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15706
 15707
 15708
 15709
 15710* EXEC CICS STARTBR
 15711*        DATASET    (ELMSTR-DSID)
 15712*        RIDFLD     (ELMSTR-KEY)
 15713*    END-EXEC.
 15714     MOVE 0
 15715       TO DFHEIV11
 15716*    MOVE '&,         G          &   #00014127' TO DFHEIV0
 15717     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15718     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15719     MOVE X'2020233030303134313237' TO DFHEIV0(25:11)
 15720     CALL 'kxdfhei1' USING DFHEIV0,
 15721           ELMSTR-DSID,
 15722           ELMSTR-KEY,
 15723           DFHEIV99,
 15724           DFHEIV11,
 15725           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 302
* EL130.cbl
 15726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15727
 15728
 15729     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15730
 15731 7620-READ-CLAIM-LOOP.
 15732
 15733
 15734
 15735* EXEC CICS READNEXT
 15736*        DATASET   (ELMSTR-DSID)
 15737*        SET       (ADDRESS OF CLAIM-MASTER)
 15738*        RIDFLD    (ELMSTR-KEY)
 15739*    END-EXEC.
 15740     MOVE 0
 15741       TO DFHEIV11
 15742*    MOVE '&.S                   )   #00014137' TO DFHEIV0
 15743     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15744     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15745     MOVE X'2020233030303134313337' TO DFHEIV0(25:11)
 15746     CALL 'kxdfhei1' USING DFHEIV0,
 15747           ELMSTR-DSID,
 15748           DFHEIV20,
 15749           DFHEIV99,
 15750           ELMSTR-KEY,
 15751           DFHEIV99,
 15752           DFHEIV11,
 15753           DFHEIV99,
 15754           DFHEIV99
 15755     SET ADDRESS OF CLAIM-MASTER TO
 15756         DFHEIV20
 15757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15758
 15759
 15760     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15761        CL-CARRIER     NOT = CLMCARRI       OR
 15762        CL-CLAIM-NO    NOT = CLMNOI
 15763          GO TO 7630-END-BROWSE
 15764     END-IF.
 15765
 15766     IF WS-ASSOCIATED-CERTS = 1
 15767         MOVE CL-CERT-PRIME      TO BCERT1O
 15768         MOVE CL-CERT-SFX        TO BSUFX1O
 15769     END-IF.
 15770
 15771     IF WS-ASSOCIATED-CERTS = 2
 15772         MOVE CL-CERT-PRIME      TO BCERT2O
 15773         MOVE CL-CERT-SFX        TO BSUFX2O
 15774     END-IF.
 15775
 15776     IF WS-ASSOCIATED-CERTS = 3
 15777         MOVE CL-CERT-PRIME      TO BCERT3O
 15778         MOVE CL-CERT-SFX        TO BSUFX3O
 15779     END-IF.
 15780
 15781     IF WS-ASSOCIATED-CERTS = 4
 15782         MOVE CL-CERT-PRIME      TO BCERT4O
 15783         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 303
* EL130.cbl
 15784     END-IF.
 15785
 15786     IF WS-ASSOCIATED-CERTS = 5
 15787         MOVE CL-CERT-PRIME      TO BCERT5O
 15788         MOVE CL-CERT-SFX        TO BSUFX5O
 15789     ELSE
 15790         ADD +1                  TO WS-ASSOCIATED-CERTS
 15791         GO TO 7620-READ-CLAIM-LOOP
 15792     END-IF.
 15793
 15794 7630-END-BROWSE.
 15795
 15796
 15797
 15798* EXEC CICS ENDBR
 15799*        DATASET   (ELMSTR-DSID)
 15800*    END-EXEC.
 15801     MOVE 0
 15802       TO DFHEIV11
 15803*    MOVE '&2                    $   #00014180' TO DFHEIV0
 15804     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15805     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15806     MOVE X'2020233030303134313830' TO DFHEIV0(25:11)
 15807     CALL 'kxdfhei1' USING DFHEIV0,
 15808           ELMSTR-DSID,
 15809           DFHEIV11,
 15810           DFHEIV99
 15811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15812
 15813
 15814 7640-HIGHLIGHT-CERT-DISPLAYED.
 15815
 15816     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15817     MOVE AL-SANON               TO BCERT1A
 15818                                    BSUFX1A
 15819                                    BCERT2A
 15820                                    BSUFX2A
 15821                                    BCERT3A
 15822                                    BSUFX3A
 15823                                    BCERT4A
 15824                                    BSUFX4A
 15825                                    BCERT5A
 15826                                    BSUFX5A.
 15827
 15828     IF BCERT1O = CERTNOI AND
 15829        BSUFX1O = SUFXI
 15830            MOVE AL-SABON        TO BCERT1A
 15831                                    BSUFX1A
 15832     END-IF.
 15833
 15834     IF BCERT2O = CERTNOI AND
 15835        BSUFX2O = SUFXI
 15836            MOVE AL-SABON        TO BCERT2A
 15837                                    BSUFX2A
 15838     END-IF.
 15839
 15840     IF BCERT3O = CERTNOI AND
 15841        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 304
* EL130.cbl
 15842            MOVE AL-SABON        TO BCERT3A
 15843                                    BSUFX3A
 15844     END-IF.
 15845
 15846     IF BCERT4O = CERTNOI AND
 15847        BSUFX4O = SUFXI
 15848            MOVE AL-SABON        TO BCERT4A
 15849                                    BSUFX4A
 15850     END-IF.
 15851
 15852     IF BCERT5O = CERTNOI AND
 15853        BSUFX5O = SUFXI
 15854            MOVE AL-SABON        TO BCERT5A
 15855                                    BSUFX5A
 15856     END-IF.
 15857
 15858 7699-EXIT.
 15859     EXIT.
 15860
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 305
* EL130.cbl
 15862 7700-CHECK-SEQUENCE.
 15863
 15864
 15865
 15866* EXEC CICS HANDLE CONDITION
 15867*        ENDFILE  (7799-EXIT)
 15868*        NOTFND   (7799-EXIT)
 15869*    END-EXEC.
 15870*    MOVE '"$''I                  ! K #00014235' TO DFHEIV0
 15871     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15872     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15873     MOVE X'4B20233030303134323335' TO DFHEIV0(25:11)
 15874     CALL 'kxdfhei1' USING DFHEIV0
 15875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15876
 15877
 15878
 15879
 15880* EXEC CICS READ
 15881*        DATASET(ELMSTR-DSID)
 15882*        SET    (ADDRESS OF CLAIM-MASTER)
 15883*        RIDFLD (ELMSTR-KEY)
 15884*        GENERIC
 15885*        EQUAL
 15886*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15887*    END-EXEC.
 15888*    MOVE '&"S  KG    E          (   #00014241' TO DFHEIV0
 15889     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15891     MOVE X'2020233030303134323431' TO DFHEIV0(25:11)
 15892     CALL 'kxdfhei1' USING DFHEIV0,
 15893           ELMSTR-DSID,
 15894           DFHEIV20,
 15895           DFHEIV99,
 15896           ELMSTR-KEY,
 15897           ELMSTR-GENERIC-LENGTH,
 15898           DFHEIV99,
 15899           DFHEIV99
 15900     SET ADDRESS OF CLAIM-MASTER TO
 15901         DFHEIV20
 15902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15903
 15904
 15905     COMPUTE WS-ASSOC-CERT-TOTAL =
 15906             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15907
 15908     GO TO 7799-EXIT.
 15909
 15910 7710-RESEQUENCE-CLAIMS.
 15911
 15912
 15913
 15914* EXEC CICS HANDLE CONDITION
 15915*        ENDFILE  (7790-END-BROWSE)
 15916*    END-EXEC.
 15917*    MOVE '"$''                   ! L #00014258' TO DFHEIV0
 15918     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 306
* EL130.cbl
 15920     MOVE X'4C20233030303134323538' TO DFHEIV0(25:11)
 15921     CALL 'kxdfhei1' USING DFHEIV0
 15922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15923
 15924
 15925
 15926
 15927* EXEC CICS STARTBR
 15928*        DATASET    (ELMSTR-DSID)
 15929*        RIDFLD     (ELMSTR-KEY)
 15930*    END-EXEC.
 15931     MOVE 0
 15932       TO DFHEIV11
 15933*    MOVE '&,         G          &   #00014263' TO DFHEIV0
 15934     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15935     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15936     MOVE X'2020233030303134323633' TO DFHEIV0(25:11)
 15937     CALL 'kxdfhei1' USING DFHEIV0,
 15938           ELMSTR-DSID,
 15939           ELMSTR-KEY,
 15940           DFHEIV99,
 15941           DFHEIV11,
 15942           DFHEIV99
 15943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15944
 15945
 15946     ADD +1 TO WS-ASSOC-CERT-SEQU
 15947               WS-READNEXT-SWITCH.
 15948
 15949 7720-READ-CLAIM-LOOP.
 15950
 15951
 15952
 15953* EXEC CICS READNEXT
 15954*        DATASET   (ELMSTR-DSID)
 15955*        SET       (ADDRESS OF CLAIM-MASTER)
 15956*        RIDFLD    (ELMSTR-KEY)
 15957*    END-EXEC.
 15958     MOVE 0
 15959       TO DFHEIV11
 15960*    MOVE '&.S                   )   #00014274' TO DFHEIV0
 15961     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15962     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15963     MOVE X'2020233030303134323734' TO DFHEIV0(25:11)
 15964     CALL 'kxdfhei1' USING DFHEIV0,
 15965           ELMSTR-DSID,
 15966           DFHEIV20,
 15967           DFHEIV99,
 15968           ELMSTR-KEY,
 15969           DFHEIV99,
 15970           DFHEIV11,
 15971           DFHEIV99,
 15972           DFHEIV99
 15973     SET ADDRESS OF CLAIM-MASTER TO
 15974         DFHEIV20
 15975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15976
 15977
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 307
* EL130.cbl
 15978     IF WS-READNEXT-SWITCH = 1
 15979         ADD 1 TO WS-READNEXT-SWITCH
 15980         GO TO 7720-READ-CLAIM-LOOP
 15981     END-IF.
 15982
 15983 7730-END-BROWSE.
 15984
 15985
 15986
 15987* EXEC CICS ENDBR
 15988*        DATASET   (ELMSTR-DSID)
 15989*    END-EXEC.
 15990     MOVE 0
 15991       TO DFHEIV11
 15992*    MOVE '&2                    $   #00014288' TO DFHEIV0
 15993     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15994     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15995     MOVE X'2020233030303134323838' TO DFHEIV0(25:11)
 15996     CALL 'kxdfhei1' USING DFHEIV0,
 15997           ELMSTR-DSID,
 15998           DFHEIV11,
 15999           DFHEIV99
 16000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16001
 16002
 16003 7740-READ-CLAIM-UPDATE.
 16004
 16005     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 16006        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 16007        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 16008          GO TO 7799-EXIT
 16009     ELSE
 16010          MOVE ZERO              TO WS-READNEXT-SWITCH
 16011     END-IF.
 16012
 16013
 16014
 16015* EXEC CICS READ
 16016*        DATASET(ELMSTR-DSID)
 16017*        SET    (ADDRESS OF CLAIM-MASTER)
 16018*        RIDFLD (ELMSTR-KEY)
 16019*        UPDATE
 16020*    END-EXEC.
 16021*    MOVE '&"S        EU         (   #00014303' TO DFHEIV0
 16022     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16023     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16024     MOVE X'2020233030303134333033' TO DFHEIV0(25:11)
 16025     CALL 'kxdfhei1' USING DFHEIV0,
 16026           ELMSTR-DSID,
 16027           DFHEIV20,
 16028           DFHEIV99,
 16029           ELMSTR-KEY,
 16030           DFHEIV99,
 16031           DFHEIV99,
 16032           DFHEIV99
 16033     SET ADDRESS OF CLAIM-MASTER TO
 16034         DFHEIV20
 16035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 308
* EL130.cbl
 16036
 16037
 16038     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16039     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16040
 16041
 16042
 16043* EXEC CICS REWRITE
 16044*         DATASET     (ELMSTR-DSID)
 16045*         FROM        (CLAIM-MASTER)
 16046*    END-EXEC.
 16047     MOVE LENGTH OF
 16048      CLAIM-MASTER
 16049       TO DFHEIV11
 16050*    MOVE '&& L                  %   #00014314' TO DFHEIV0
 16051     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16052     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16053     MOVE X'2020233030303134333134' TO DFHEIV0(25:11)
 16054     CALL 'kxdfhei1' USING DFHEIV0,
 16055           ELMSTR-DSID,
 16056           CLAIM-MASTER,
 16057           DFHEIV11,
 16058           DFHEIV99
 16059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16060
 16061
 16062     GO TO 7710-RESEQUENCE-CLAIMS.
 16063
 16064 7790-END-BROWSE.
 16065
 16066
 16067
 16068* EXEC CICS ENDBR
 16069*        DATASET   (ELMSTR-DSID)
 16070*    END-EXEC.
 16071     MOVE 0
 16072       TO DFHEIV11
 16073*    MOVE '&2                    $   #00014324' TO DFHEIV0
 16074     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16075     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16076     MOVE X'2020233030303134333234' TO DFHEIV0(25:11)
 16077     CALL 'kxdfhei1' USING DFHEIV0,
 16078           ELMSTR-DSID,
 16079           DFHEIV11,
 16080           DFHEIV99
 16081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16082
 16083
 16084 7799-EXIT.
 16085     EXIT.
 16086
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 309
* EL130.cbl
 16088************************************************
 16089*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 16090************************************************
 16091
 16092 7900-READ-ACTV-UPDATE.
 16093     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16094     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16095     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16096     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16097     MOVE +0                     TO TRLR-SEQ-NO.
 16098     MOVE '1'                    TO TRLR-TYPE.
 16099     GO TO 7900-READ-TRAILER-UPDATE.
 16100
 16101 7900-READ-NINETY-UPDATE.
 16102     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16103     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16104     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16105     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16106     MOVE +90                    TO TRLR-SEQ-NO.
 16107     MOVE '6'                    TO TRLR-TYPE.
 16108
 16109 7900-READ-TRAILER-UPDATE.
 16110
 16111
 16112* EXEC CICS READ  UPDATE
 16113*        DATASET    (ELTRLR-DSID)
 16114*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 16115*        RIDFLD     (ELTRLR-KEY)
 16116*    END-EXEC.
 16117*    MOVE '&"S        EU         (   #00014355' TO DFHEIV0
 16118     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16119     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16120     MOVE X'2020233030303134333535' TO DFHEIV0(25:11)
 16121     CALL 'kxdfhei1' USING DFHEIV0,
 16122           ELTRLR-DSID,
 16123           DFHEIV20,
 16124           DFHEIV99,
 16125           ELTRLR-KEY,
 16126           DFHEIV99,
 16127           DFHEIV99,
 16128           DFHEIV99
 16129     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16130         DFHEIV20
 16131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16132
 16133
 16134 7900-EXIT.
 16135      EXIT.
 16136
 16137 7910-READ-ACTV.
 16138     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16139     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16140     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16141     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16142     MOVE +0                     TO TRLR-SEQ-NO.
 16143     MOVE '1'                    TO TRLR-TYPE.
 16144     GO TO 7910-READ-TRAILER.
 16145
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 310
* EL130.cbl
 16146 7910-READ-NINETY.
 16147     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16148     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16149     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16150     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16151     MOVE +90                    TO TRLR-SEQ-NO.
 16152     MOVE '6'                    TO TRLR-TYPE.
 16153
 16154 7910-READ-TRAILER.
 16155     MOVE 'TRLR'                 TO FILE-SWITCH.
 16156
 16157
 16158
 16159* EXEC CICS READ
 16160*        DATASET   (ELTRLR-DSID)
 16161*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16162*        RIDFLD    (ELTRLR-KEY)
 16163*    END-EXEC.
 16164*    MOVE '&"S        E          (   #00014385' TO DFHEIV0
 16165     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16166     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16167     MOVE X'2020233030303134333835' TO DFHEIV0(25:11)
 16168     CALL 'kxdfhei1' USING DFHEIV0,
 16169           ELTRLR-DSID,
 16170           DFHEIV20,
 16171           DFHEIV99,
 16172           ELTRLR-KEY,
 16173           DFHEIV99,
 16174           DFHEIV99,
 16175           DFHEIV99
 16176     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16177         DFHEIV20
 16178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16179
 16180
 16181 7910-EXIT.
 16182      EXIT.
 16183
 16184 7915-REWRITE-TRAILER.
 16185
 16186
 16187* EXEC CICS REWRITE
 16188*        DATASET   (ELTRLR-DSID)
 16189*        FROM      (ACTIVITY-TRAILERS)
 16190*    END-EXEC.
 16191     MOVE LENGTH OF
 16192      ACTIVITY-TRAILERS
 16193       TO DFHEIV11
 16194*    MOVE '&& L                  %   #00014396' TO DFHEIV0
 16195     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16196     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16197     MOVE X'2020233030303134333936' TO DFHEIV0(25:11)
 16198     CALL 'kxdfhei1' USING DFHEIV0,
 16199           ELTRLR-DSID,
 16200           ACTIVITY-TRAILERS,
 16201           DFHEIV11,
 16202           DFHEIV99
 16203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 311
* EL130.cbl
 16204
 16205
 16206 7915-EXIT.
 16207      EXIT.
 16208
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 312
* EL130.cbl
 16210********************************************
 16211*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 16212********************************************
 16213
 16214 7920-READ-CLAIM-UPDATE.
 16215
 16216
 16217
 16218* EXEC CICS READ
 16219*        UPDATE
 16220*        DATASET   (ELMSTR-DSID)
 16221*        SET       (ADDRESS OF CLAIM-MASTER)
 16222*        RIDFLD    (ELMSTR-KEY)
 16223*    END-EXEC.
 16224*    MOVE '&"S        EU         (   #00014412' TO DFHEIV0
 16225     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16226     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16227     MOVE X'2020233030303134343132' TO DFHEIV0(25:11)
 16228     CALL 'kxdfhei1' USING DFHEIV0,
 16229           ELMSTR-DSID,
 16230           DFHEIV20,
 16231           DFHEIV99,
 16232           ELMSTR-KEY,
 16233           DFHEIV99,
 16234           DFHEIV99,
 16235           DFHEIV99
 16236     SET ADDRESS OF CLAIM-MASTER TO
 16237         DFHEIV20
 16238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16239
 16240
 16241 7920-EXIT.
 16242      EXIT.
 16243
 16244 7950-READ-CLAIM.
 16245
 16246
 16247* EXEC CICS READ
 16248*        DATASET   (ELMSTR-DSID)
 16249*        SET       (ADDRESS OF CLAIM-MASTER)
 16250*        RIDFLD    (ELMSTR-KEY)
 16251*    END-EXEC.
 16252*    MOVE '&"S        E          (   #00014424' TO DFHEIV0
 16253     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16254     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16255     MOVE X'2020233030303134343234' TO DFHEIV0(25:11)
 16256     CALL 'kxdfhei1' USING DFHEIV0,
 16257           ELMSTR-DSID,
 16258           DFHEIV20,
 16259           DFHEIV99,
 16260           ELMSTR-KEY,
 16261           DFHEIV99,
 16262           DFHEIV99,
 16263           DFHEIV99
 16264     SET ADDRESS OF CLAIM-MASTER TO
 16265         DFHEIV20
 16266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16267
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 313
* EL130.cbl
 16268
 16269 7950-EXIT.
 16270      EXIT.
 16271
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 314
* EL130.cbl
 16273***************************************
 16274*  I/O REQUESTS AGAINST CONTROL FILE  *
 16275***************************************
 16276
 16277 7960-READ-CNTL-UPDATE.
 16278
 16279
 16280* EXEC CICS READ
 16281*        UPDATE
 16282*        DATASET  (ELCNTL-DSID)
 16283*        SET      (ADDRESS OF CONTROL-FILE)
 16284*        RIDFLD   (ELCNTL-KEY)
 16285*    END-EXEC.
 16286*    MOVE '&"S        EU         (   #00014440' TO DFHEIV0
 16287     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16288     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16289     MOVE X'2020233030303134343430' TO DFHEIV0(25:11)
 16290     CALL 'kxdfhei1' USING DFHEIV0,
 16291           ELCNTL-DSID,
 16292           DFHEIV20,
 16293           DFHEIV99,
 16294           ELCNTL-KEY,
 16295           DFHEIV99,
 16296           DFHEIV99,
 16297           DFHEIV99
 16298     SET ADDRESS OF CONTROL-FILE TO
 16299         DFHEIV20
 16300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16301
 16302
 16303 7960-EXIT.
 16304      EXIT.
 16305
 16306 7970-READ-CNTL.
 16307
 16308
 16309* EXEC CICS READ
 16310*        DATASET  (ELCNTL-DSID)
 16311*        SET      (ADDRESS OF CONTROL-FILE)
 16312*        RIDFLD   (ELCNTL-KEY)
 16313*    END-EXEC.
 16314*    MOVE '&"S        E          (   #00014452' TO DFHEIV0
 16315     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16317     MOVE X'2020233030303134343532' TO DFHEIV0(25:11)
 16318     CALL 'kxdfhei1' USING DFHEIV0,
 16319           ELCNTL-DSID,
 16320           DFHEIV20,
 16321           DFHEIV99,
 16322           ELCNTL-KEY,
 16323           DFHEIV99,
 16324           DFHEIV99,
 16325           DFHEIV99
 16326     SET ADDRESS OF CONTROL-FILE TO
 16327         DFHEIV20
 16328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16329
 16330
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 315
* EL130.cbl
 16331 7970-EXIT.
 16332      EXIT.
 16333
 16334 7975-READ-CNTL-GTEQ.
 16335
 16336
 16337* EXEC CICS READ
 16338*         DATASET   (ELCNTL-DSID)
 16339*         SET       (ADDRESS OF CONTROL-FILE)
 16340*         RIDFLD    (ELCNTL-KEY)
 16341*         GTEQ
 16342*     END-EXEC.
 16343*    MOVE '&"S        G          (   #00014463' TO DFHEIV0
 16344     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16346     MOVE X'2020233030303134343633' TO DFHEIV0(25:11)
 16347     CALL 'kxdfhei1' USING DFHEIV0,
 16348           ELCNTL-DSID,
 16349           DFHEIV20,
 16350           DFHEIV99,
 16351           ELCNTL-KEY,
 16352           DFHEIV99,
 16353           DFHEIV99,
 16354           DFHEIV99
 16355     SET ADDRESS OF CONTROL-FILE TO
 16356         DFHEIV20
 16357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16358
 16359
 16360 7975-EXIT.
 16361      EXIT.
 16362
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 316
* EL130.cbl
 16364**************************************************
 16365*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16366**************************************************
 16367
 16368 7980-READ-CERT5.
 16369
 16370
 16371* EXEC CICS READ
 16372*         DATASET  (ELCERT5-DSID)
 16373*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16374*         RIDFLD   (ELCERT-KEY-5)
 16375*     END-EXEC.
 16376*    MOVE '&"S        E          (   #00014480' TO DFHEIV0
 16377     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16379     MOVE X'2020233030303134343830' TO DFHEIV0(25:11)
 16380     CALL 'kxdfhei1' USING DFHEIV0,
 16381           ELCERT5-DSID,
 16382           DFHEIV20,
 16383           DFHEIV99,
 16384           ELCERT-KEY-5,
 16385           DFHEIV99,
 16386           DFHEIV99,
 16387           DFHEIV99
 16388     SET ADDRESS OF CERTIFICATE-MASTER TO
 16389         DFHEIV20
 16390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16391
 16392
 16393 7980-EXIT.
 16394      EXIT.
 16395
 16396 7930-READ-CERT-UPDATE.
 16397
 16398
 16399* EXEC CICS READ
 16400*        DATASET  (ELCERT-DSID)
 16401*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16402*        RIDFLD   (ELCERT-KEY)
 16403*        UPDATE
 16404*    END-EXEC.
 16405*    MOVE '&"S        EU         (   #00014491' TO DFHEIV0
 16406     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16407     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16408     MOVE X'2020233030303134343931' TO DFHEIV0(25:11)
 16409     CALL 'kxdfhei1' USING DFHEIV0,
 16410           ELCERT-DSID,
 16411           DFHEIV20,
 16412           DFHEIV99,
 16413           ELCERT-KEY,
 16414           DFHEIV99,
 16415           DFHEIV99,
 16416           DFHEIV99
 16417     SET ADDRESS OF CERTIFICATE-MASTER TO
 16418         DFHEIV20
 16419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16420
 16421
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 317
* EL130.cbl
 16422 7930-EXIT.
 16423      EXIT.
 16424
 16425 7940-READ-CERT.
 16426
 16427
 16428* EXEC CICS READ
 16429*        DATASET  (ELCERT-DSID)
 16430*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16431*        RIDFLD   (ELCERT-KEY)
 16432*    END-EXEC.
 16433*    MOVE '&"S        E          (   #00014503' TO DFHEIV0
 16434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16436     MOVE X'2020233030303134353033' TO DFHEIV0(25:11)
 16437     CALL 'kxdfhei1' USING DFHEIV0,
 16438           ELCERT-DSID,
 16439           DFHEIV20,
 16440           DFHEIV99,
 16441           ELCERT-KEY,
 16442           DFHEIV99,
 16443           DFHEIV99,
 16444           DFHEIV99
 16445     SET ADDRESS OF CERTIFICATE-MASTER TO
 16446         DFHEIV20
 16447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16448
 16449
 16450 7940-EXIT.
 16451      EXIT.
 16452
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 318
* EL130.cbl
 16454**************************************************
 16455*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16456**************************************************
 16457
 16458 7991-READ-BENE.
 16459
 16460
 16461* EXEC CICS READ
 16462*         DATASET   (ELBENE-DSID)
 16463*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16464*         RIDFLD    (ELBENE-KEY)
 16465*     END-EXEC.
 16466*    MOVE '&"S        E          (   #00014519' TO DFHEIV0
 16467     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16468     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16469     MOVE X'2020233030303134353139' TO DFHEIV0(25:11)
 16470     CALL 'kxdfhei1' USING DFHEIV0,
 16471           ELBENE-DSID,
 16472           DFHEIV20,
 16473           DFHEIV99,
 16474           ELBENE-KEY,
 16475           DFHEIV99,
 16476           DFHEIV99,
 16477           DFHEIV99
 16478     SET ADDRESS OF BENEFICIARY-MASTER TO
 16479         DFHEIV20
 16480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16481
 16482
 16483 7991-EXIT.
 16484      EXIT.
 16485
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 319
* EL130.cbl
 16487**************************************************
 16488*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16489**************************************************
 16490
 16491 7992-READ-REIN.
 16492
 16493
 16494
 16495* EXEC CICS HANDLE CONDITION
 16496*        NOTFND   (7992-NOT-FOUND)
 16497*    END-EXEC.
 16498*    MOVE '"$I                   ! M #00014536' TO DFHEIV0
 16499     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16501     MOVE X'4D20233030303134353336' TO DFHEIV0(25:11)
 16502     CALL 'kxdfhei1' USING DFHEIV0
 16503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16504
 16505
 16506
 16507
 16508* EXEC CICS READ
 16509*        DATASET   (ERREIN-DSID)
 16510*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16511*        RIDFLD    (ERREIN-KEY)
 16512*    END-EXEC.
 16513*    MOVE '&"S        E          (   #00014541' TO DFHEIV0
 16514     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16516     MOVE X'2020233030303134353431' TO DFHEIV0(25:11)
 16517     CALL 'kxdfhei1' USING DFHEIV0,
 16518           ERREIN-DSID,
 16519           DFHEIV20,
 16520           DFHEIV99,
 16521           ERREIN-KEY,
 16522           DFHEIV99,
 16523           DFHEIV99,
 16524           DFHEIV99
 16525     SET ADDRESS OF REINSURANCE-RECORD TO
 16526         DFHEIV20
 16527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16528
 16529
 16530     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16531
 16532     GO TO 7992-EXIT.
 16533
 16534 7992-NOT-FOUND.
 16535     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16536
 16537 7992-EXIT.
 16538     EXIT.
 16539
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 320
* EL130.cbl
 16541 8000-LOAD-ERROR-MESSAGES.
 16542     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16543
 16544     IF EMI-NO-ERRORS
 16545         GO TO 8000-EXIT
 16546     END-IF.
 16547
 16548     perform varying e1 from +1 by +1 until e1 > +3
 16549        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16550                                or '1655' or '1660'
 16551           move 'W'              to emi-severity (e1)
 16552        end-if
 16553     end-perform
 16554     IF EMI-NUMBER-OF-LINES = 1
 16555         MOVE EMI-LINE1          TO ERRMSG1O
 16556         GO TO 8000-EXIT
 16557     END-IF.
 16558
 16559     IF EMI-NUMBER-OF-LINES = 2
 16560          MOVE EMI-LINE1         TO ERRMSG1O
 16561          MOVE EMI-LINE2         TO ERRMSG2O
 16562          GO TO 8000-EXIT
 16563     END-IF.
 16564
 16565     MOVE EMI-LINE1              TO ERRMSG1O.
 16566
 16567 8000-EXIT.
 16568     EXIT.
 16569
 16570 8100-SEND-INITIAL-MAP.
 16571     MOVE SAVE-DATE              TO RUNDTEO.
 16572     MOVE EIBTIME                TO TIME-IN.
 16573     MOVE TIME-OUT               TO RUNTIMEO.
 16574     IF EIBAID = DFHPF11
 16575        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16577     end-if
 16578     IF RETURNED-FROM = XCTL-114
 16579        CONTINUE
 16580     ELSE
 16581        MOVE -1                  TO MAINTL
 16582     END-IF.
 16583
 16584*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16585         MOVE SPACES             TO PRODO.
 16586         MOVE AL-SANOF           TO PRODCDA.
 16587*    END-IF.
 16588
 16589     MOVE PI-COMPANY-ID          TO COMPO.
 16590     MOVE AL-PABOF               TO COMPA.
 16591     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16592     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16593     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16594
 16595     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16596
 16597     IF NOT PI-NO-CARRIER-SECURITY
 16598        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 321
* EL130.cbl
 16599        MOVE AL-SABOF            TO CLMCARRA
 16600     END-IF.
 16601
 16602     IF PI-PROCESSOR-ID = 'PEMA'
 16603        MOVE AL-UANON            TO CERTNOA
 16604                                    SUFXA
 16605     END-IF.
 16606*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16607*        NEXT SENTENCE
 16608*        CONTINUE
 16609*    ELSE
 16610         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16611*    END-IF.
 16612
 16613
 16614
 16615* EXEC CICS SEND
 16616*        MAP     (MAP-NAME)
 16617*        MAPSET  (MAPSET-NAME)
 16618*        FROM    (EL130AO)
 16619*        ERASE
 16620*        CURSOR
 16621*    END-EXEC.
 16622     MOVE LENGTH OF
 16623      EL130AO
 16624       TO DFHEIV12
 16625     MOVE -1
 16626       TO DFHEIV11
 16627*    MOVE '8$     CT  E    H L F ,   #00014631' TO DFHEIV0
 16628     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16629     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16630     MOVE X'2020233030303134363331' TO DFHEIV0(25:11)
 16631     CALL 'kxdfhei1' USING DFHEIV0,
 16632           MAP-NAME,
 16633           EL130AO,
 16634           DFHEIV12,
 16635           MAPSET-NAME,
 16636           DFHEIV99,
 16637           DFHEIV99,
 16638           DFHEIV99,
 16639           DFHEIV11,
 16640           DFHEIV99,
 16641           DFHEIV99,
 16642           DFHEIV99
 16643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16644
 16645
 16646     GO TO 9100-RETURN-TRAN.
 16647
 16648 8150-SEND-MAP-CURSOR.
 16649     MOVE SAVE-DATE              TO RUNDTEO.
 16650     MOVE EIBTIME                TO TIME-IN.
 16651     MOVE TIME-OUT               TO RUNTIMEO.
 16652     IF EIBAID = DFHPF11
 16653        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16654        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16655     end-if
 16656     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 322
* EL130.cbl
 16657     MOVE AL-PABOF               TO COMPA
 16658     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16659     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16660     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16661
 16662*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16663         MOVE SPACES             TO PRODO.
 16664         MOVE AL-SANOF           TO PRODCDA.
 16665*    END-IF.
 16666
 16667     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16668
 16669     IF NOT PI-NO-CARRIER-SECURITY
 16670         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16671         MOVE AL-SABOF            TO CLMCARRA
 16672     END-IF.
 16673
 16674     IF PI-PROCESSOR-ID = 'PEMA'
 16675        MOVE AL-UANON            TO CERTNOA
 16676                                    SUFXA
 16677     END-IF.
 16678*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16679*        NEXT SENTENCE
 16680*        CONTINUE
 16681*    ELSE
 16682         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16683*    END-IF.
 16684
 16685
 16686
 16687* EXEC CICS SEND
 16688*        MAP      (MAP-NAME)
 16689*        MAPSET   (MAPSET-NAME)
 16690*        FROM     (EL130AO)
 16691*        CURSOR   (PI-CURSOR)
 16692*        ERASE
 16693*    END-EXEC.
 16694     MOVE LENGTH OF
 16695      EL130AO
 16696       TO DFHEIV11
 16697*    MOVE '8$     CT  E    H L F ,   #00014679' TO DFHEIV0
 16698     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16699     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16700     MOVE X'2020233030303134363739' TO DFHEIV0(25:11)
 16701     CALL 'kxdfhei1' USING DFHEIV0,
 16702           MAP-NAME,
 16703           EL130AO,
 16704           DFHEIV11,
 16705           MAPSET-NAME,
 16706           DFHEIV99,
 16707           DFHEIV99,
 16708           DFHEIV99,
 16709           PI-CURSOR,
 16710           DFHEIV99,
 16711           DFHEIV99,
 16712           DFHEIV99
 16713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16714
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 323
* EL130.cbl
 16715
 16716     GO TO 9100-RETURN-TRAN.
 16717
 16718 8200-SEND-DATAONLY.
 16719     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16720
 16721     IF EIBAID = DFHPF11
 16722        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16723        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16724        go to 8100-send-initial-map
 16725     end-if
 16726*    IF EIBAID = DFHPF11
 16727*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16728*       move pi-last-claim       to emi-claim-no
 16729*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16730*       go to 8100-send-initial-map
 16731*    END-IF.
 16732     .
 16733 8200-BYPASS-ERROR.
 16734     MOVE SAVE-DATE              TO RUNDTEO.
 16735     MOVE EIBTIME                TO TIME-IN.
 16736     MOVE TIME-OUT               TO RUNTIMEO.
 16737     MOVE PI-COMPANY-ID          TO COMPO.
 16738     MOVE AL-PABOF               TO COMPA
 16739     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16740
 16741*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16742         MOVE SPACES             TO PRODO.
 16743         MOVE AL-SANOF           TO PRODCDA.
 16744*    END-IF.
 16745
 16746     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16747     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16748
 16749     IF PI-PROCESSOR-ID = 'PEMA'
 16750        MOVE AL-UANON            TO CERTNOA
 16751                                    SUFXA
 16752     END-IF.
 16753     IF NOT PI-NO-CARRIER-SECURITY
 16754        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16755        MOVE AL-SABOF            TO CLMCARRA
 16756     END-IF.
 16757
 16758*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16759*        NEXT SENTENCE
 16760*        CONTINUE
 16761*    ELSE
 16762         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16763*    END-IF.
 16764
 16765*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16766         MOVE AL-SANOF           TO PRODCDA.
 16767*    END-IF.
 16768
 16769
 16770
 16771* EXEC CICS SEND
 16772*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 324
* EL130.cbl
 16773*        MAPSET   (MAPSET-NAME)
 16774*        FROM     (EL130AO)
 16775*        DATAONLY
 16776*        CURSOR
 16777*    END-EXEC.
 16778     MOVE LENGTH OF
 16779      EL130AO
 16780       TO DFHEIV12
 16781     MOVE -1
 16782       TO DFHEIV11
 16783*    MOVE '8$D    CT       H L F ,   #00014741' TO DFHEIV0
 16784     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16785     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16786     MOVE X'2020233030303134373431' TO DFHEIV0(25:11)
 16787     CALL 'kxdfhei1' USING DFHEIV0,
 16788           MAP-NAME,
 16789           EL130AO,
 16790           DFHEIV12,
 16791           MAPSET-NAME,
 16792           DFHEIV99,
 16793           DFHEIV99,
 16794           DFHEIV99,
 16795           DFHEIV11,
 16796           DFHEIV99,
 16797           DFHEIV99,
 16798           DFHEIV99
 16799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16800
 16801
 16802     GO TO 9100-RETURN-TRAN.
 16803
 16804 8300-SEND-TEXT.
 16805
 16806
 16807* EXEC CICS SEND TEXT
 16808*        FROM     (LOGOFF-TEXT)
 16809*        LENGTH   (LOGOFF-LENGTH)
 16810*        ERASE
 16811*        FREEKB
 16812*    END-EXEC.
 16813*    MOVE '8&      T  E F  H   F -   #00014753' TO DFHEIV0
 16814     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16815     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16816     MOVE X'2020233030303134373533' TO DFHEIV0(25:11)
 16817     CALL 'kxdfhei1' USING DFHEIV0,
 16818           LOGOFF-TEXT,
 16819           LOGOFF-LENGTH,
 16820           DFHEIV99,
 16821           DFHEIV99,
 16822           DFHEIV99,
 16823           DFHEIV99,
 16824           DFHEIV99,
 16825           DFHEIV99,
 16826           DFHEIV99,
 16827           DFHEIV99,
 16828           DFHEIV99,
 16829           DFHEIV99
 16830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 325
* EL130.cbl
 16831
 16832
 16833
 16834
 16835* EXEC CICS RETURN
 16836*    END-EXEC.
 16837*    MOVE '.(                    ''   #00014761' TO DFHEIV0
 16838     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16839     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16840     MOVE X'2020233030303134373631' TO DFHEIV0(25:11)
 16841     CALL 'kxdfhei1' USING DFHEIV0,
 16842           DFHEIV99,
 16843           DFHEIV99,
 16844           DFHEIV99,
 16845           DFHEIV99,
 16846           DFHEIV99,
 16847           DFHEIV99
 16848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16849
 16850
 16851 8800-UNAUTHORIZED-ACCESS.
 16852     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16853     GO TO 8300-SEND-TEXT.
 16854
 16855 8810-PF23.
 16856     MOVE EIBAID TO PI-ENTRY-CD-1.
 16857     MOVE XCTL-005               TO PGM-NAME.
 16858     GO TO 9300-XCTL.
 16859
 16860 8820-TERM-ERROR.
 16861     MOVE ER-0412                TO EMI-ERROR.
 16862     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16863     MOVE -1                     TO MAINTL.
 16864     GO TO 8200-SEND-DATAONLY.
 16865
 16866 8830-TRAN-ERROR.
 16867     MOVE ER-0413                TO EMI-ERROR.
 16868     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16869     MOVE -1                     TO MAINTL.
 16870     GO TO 8200-SEND-DATAONLY.
 16871
 16872 9000-RETURN-CICS.
 16873
 16874
 16875* EXEC CICS RETURN
 16876*    END-EXEC.
 16877*    MOVE '.(                    ''   #00014787' TO DFHEIV0
 16878     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16879     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16880     MOVE X'2020233030303134373837' TO DFHEIV0(25:11)
 16881     CALL 'kxdfhei1' USING DFHEIV0,
 16882           DFHEIV99,
 16883           DFHEIV99,
 16884           DFHEIV99,
 16885           DFHEIV99,
 16886           DFHEIV99,
 16887           DFHEIV99
 16888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 326
* EL130.cbl
 16889
 16890
 16891 9100-RETURN-TRAN.
 16892     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16893     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16894
 16895
 16896
 16897* EXEC CICS RETURN
 16898*        TRANSID   (TRANS-ID)
 16899*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16900*        LENGTH    (PI-COMM-LENGTH)
 16901*    END-EXEC.
 16902*    MOVE '.(CT                  ''   #00014795' TO DFHEIV0
 16903     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16904     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16905     MOVE X'2020233030303134373935' TO DFHEIV0(25:11)
 16906     CALL 'kxdfhei1' USING DFHEIV0,
 16907           TRANS-ID,
 16908           PROGRAM-INTERFACE-BLOCK,
 16909           PI-COMM-LENGTH,
 16910           DFHEIV99,
 16911           DFHEIV99,
 16912           DFHEIV99
 16913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16914
 16915
 16916 9200-RETURN-MAIN-MENU.
 16917     MOVE XCTL-126               TO PGM-NAME.
 16918     GO TO 9300-XCTL.
 16919
 16920 9300-XCTL.
 16921
 16922
 16923* EXEC CICS XCTL
 16924*        PROGRAM   (PGM-NAME)
 16925*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16926*        LENGTH    (PI-COMM-LENGTH)
 16927*    END-EXEC.
 16928*    MOVE '.$C                   %   #00014807' TO DFHEIV0
 16929     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16930     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16931     MOVE X'2020233030303134383037' TO DFHEIV0(25:11)
 16932     CALL 'kxdfhei1' USING DFHEIV0,
 16933           PGM-NAME,
 16934           PROGRAM-INTERFACE-BLOCK,
 16935           PI-COMM-LENGTH,
 16936           DFHEIV99
 16937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16938
 16939
 16940 9400-CLEAR.
 16941     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16942     GO TO 9300-XCTL.
 16943
 16944 9500-PF12.
 16945     MOVE XCTL-010               TO PGM-NAME.
 16946     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 327
* EL130.cbl
 16947
 16948 9600-PGMID-ERROR.
 16949
 16950
 16951* EXEC CICS HANDLE CONDITION
 16952*        PGMIDERR  (8300-SEND-TEXT)
 16953*    END-EXEC.
 16954*    MOVE '"$L                   ! N #00014823' TO DFHEIV0
 16955     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16957     MOVE X'4E20233030303134383233' TO DFHEIV0(25:11)
 16958     CALL 'kxdfhei1' USING DFHEIV0
 16959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16960
 16961
 16962     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16963     MOVE ' '                    TO PI-ENTRY-CD-1.
 16964     MOVE XCTL-005               TO PGM-NAME.
 16965     MOVE PGM-NAME               TO LOGOFF-PGM.
 16966     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16967     GO TO 9300-XCTL.
 16968
 16969 9700-LINK-DATE-CONVERT.
 16970     MOVE LINK-ELDATCV           TO PGM-NAME.
 16971
 16972
 16973* EXEC CICS LINK
 16974*        PROGRAM    (PGM-NAME)
 16975*        COMMAREA   (DATE-CONVERSION-DATA)
 16976*        LENGTH     (DC-COMM-LENGTH)
 16977*    END-EXEC.
 16978*    MOVE '."C                   (   #00014837' TO DFHEIV0
 16979     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16980     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16981     MOVE X'2020233030303134383337' TO DFHEIV0(25:11)
 16982     CALL 'kxdfhei1' USING DFHEIV0,
 16983           PGM-NAME,
 16984           DATE-CONVERSION-DATA,
 16985           DC-COMM-LENGTH,
 16986           DFHEIV99,
 16987           DFHEIV99,
 16988           DFHEIV99,
 16989           DFHEIV99
 16990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16991
 16992
 16993 9700-EXIT.
 16994     EXIT.
 16995
 16996 9800-LINK-REM-TERM.
 16997     MOVE LINK-ELRTRM            TO PGM-NAME.
 16998
 16999
 17000* EXEC CICS LINK
 17001*        PROGRAM    (PGM-NAME)
 17002*        COMMAREA   (CALCULATION-PASS-AREA)
 17003*        LENGTH     (CP-COMM-LENGTH)
 17004*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 328
* EL130.cbl
 17005*    MOVE '."C                   (   #00014849' TO DFHEIV0
 17006     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17008     MOVE X'2020233030303134383439' TO DFHEIV0(25:11)
 17009     CALL 'kxdfhei1' USING DFHEIV0,
 17010           PGM-NAME,
 17011           CALCULATION-PASS-AREA,
 17012           CP-COMM-LENGTH,
 17013           DFHEIV99,
 17014           DFHEIV99,
 17015           DFHEIV99,
 17016           DFHEIV99
 17017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17018
 17019
 17020 9800-EXIT.
 17021     EXIT.
 17022
 17023 9900-ERROR-FORMAT.
 17024*    if emi-error = 1651 or 1652 or 1653 or 1655
 17025*       display ' 9900 error ' emi-error
 17026*       display emi-message-area (1)
 17027*       display emi-message-area (2)
 17028*       display emi-message-area (3)
 17029*    end-if
 17030     IF NOT EMI-ERRORS-COMPLETE
 17031         MOVE LINK-001           TO PGM-NAME
 17032
 17033* EXEC CICS LINK
 17034*            PROGRAM   (PGM-NAME)
 17035*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 17036*            LENGTH    (EMI-COMM-LENGTH)
 17037*        END-EXEC
 17038*    MOVE '."C                   (   #00014867' TO DFHEIV0
 17039     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17040     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17041     MOVE X'2020233030303134383637' TO DFHEIV0(25:11)
 17042     CALL 'kxdfhei1' USING DFHEIV0,
 17043           PGM-NAME,
 17044           ERROR-MESSAGE-INTERFACE-BLOCK,
 17045           EMI-COMM-LENGTH,
 17046           DFHEIV99,
 17047           DFHEIV99,
 17048           DFHEIV99,
 17049           DFHEIV99
 17050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17051         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 17052            subtract 1 from emi-fatal-ctr
 17053         end-if
 17054     END-IF.
 17055
 17056     .
 17057 9900-EXIT.
 17058     EXIT.
 17059
 17060 9990-ABEND.
 17061     MOVE -1                     TO MAINTL.
 17062     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 329
* EL130.cbl
 17063     MOVE DFHEIBLK               TO EMI-LINE1.
 17064
 17065
 17066* EXEC CICS LINK
 17067*        PROGRAM   (PGM-NAME)
 17068*        COMMAREA  (EMI-LINE1)
 17069*        LENGTH    (72)
 17070*    END-EXEC.
 17071     MOVE 72
 17072       TO DFHEIV11
 17073*    MOVE '."C                   (   #00014886' TO DFHEIV0
 17074     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17076     MOVE X'2020233030303134383836' TO DFHEIV0(25:11)
 17077     CALL 'kxdfhei1' USING DFHEIV0,
 17078           PGM-NAME,
 17079           EMI-LINE1,
 17080           DFHEIV11,
 17081           DFHEIV99,
 17082           DFHEIV99,
 17083           DFHEIV99,
 17084           DFHEIV99
 17085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17086
 17087
 17088     MOVE EMI-LINE1              TO ERRMSG2O.
 17089
 17090     GO TO 8200-BYPASS-ERROR.
 17091
 17092
 17093
 17094* GOBACK.
 17095     MOVE '9%                    "   ' TO DFHEIV0
 17096     MOVE 'EL130' TO DFHEIV1
 17097     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17098     GOBACK.
 17099
 17100 9995-SECURITY-VIOLATION.
 17101*             COPY ELCSCTP.
 17102******************************************************************
 17103*                                                                *
 17104*                            ELCSCTP                             *
 17105*                            VMOD=2.001                          *
 17106*                                                                *
 17107*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17108******************************************************************
 17109
 17110
 17111     MOVE EIBDATE          TO SM-JUL-DATE.
 17112     MOVE EIBTRMID         TO SM-TERMID.
 17113     MOVE THIS-PGM         TO SM-PGM.
 17114     MOVE EIBTIME          TO TIME-IN.
 17115     MOVE TIME-OUT         TO SM-TIME.
 17116     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17117
 17118
 17119* EXEC CICS LINK
 17120*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 330
* EL130.cbl
 17121*         COMMAREA (SECURITY-MESSAGE)
 17122*         LENGTH   (80)
 17123*    END-EXEC.
 17124     MOVE 'EL003' TO DFHEIV1
 17125     MOVE 80
 17126       TO DFHEIV11
 17127*    MOVE '."C                   (   #00014917' TO DFHEIV0
 17128     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17129     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17130     MOVE X'2020233030303134393137' TO DFHEIV0(25:11)
 17131     CALL 'kxdfhei1' USING DFHEIV0,
 17132           DFHEIV1,
 17133           SECURITY-MESSAGE,
 17134           DFHEIV11,
 17135           DFHEIV99,
 17136           DFHEIV99,
 17137           DFHEIV99,
 17138           DFHEIV99
 17139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17140
 17141
 17142******************************************************************
 17143
 17144
 17145 9995-EXIT.
 17146     EXIT.
 17147
 17148
 17149 9999-DFHBACK SECTION.
 17150     MOVE '9%                    "   ' TO DFHEIV0
 17151     MOVE 'EL130' TO DFHEIV1
 17152     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17153     GOBACK.
 17154 9999-DFHEXIT.
 17155     IF DFHEIGDJ EQUAL 0001
 17156         NEXT SENTENCE
 17157     ELSE IF DFHEIGDJ EQUAL 2
 17158         GO TO 0100-TEST-ENTRY,
 17159               8100-SEND-INITIAL-MAP,
 17160               9600-PGMID-ERROR,
 17161               8820-TERM-ERROR,
 17162               8830-TRAN-ERROR,
 17163               9990-ABEND
 17164         DEPENDING ON DFHEIGDI
 17165     ELSE IF DFHEIGDJ EQUAL 3
 17166         GO TO 0450-ADD-ELACTQ-RECORD
 17167         DEPENDING ON DFHEIGDI
 17168     ELSE IF DFHEIGDJ EQUAL 4
 17169         GO TO 8820-TERM-ERROR,
 17170               8830-TRAN-ERROR
 17171         DEPENDING ON DFHEIGDI
 17172     ELSE IF DFHEIGDJ EQUAL 5
 17173         GO TO 0660-NOT-FOUND,
 17174               0670-QIDERR
 17175         DEPENDING ON DFHEIGDI
 17176     ELSE IF DFHEIGDJ EQUAL 6
 17177         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17178         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 331
* EL130.cbl
 17179     ELSE IF DFHEIGDJ EQUAL 7
 17180         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17181         DEPENDING ON DFHEIGDI
 17182     ELSE IF DFHEIGDJ EQUAL 8
 17183         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17184         DEPENDING ON DFHEIGDI
 17185     ELSE IF DFHEIGDJ EQUAL 9
 17186         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17187         DEPENDING ON DFHEIGDI
 17188     ELSE IF DFHEIGDJ EQUAL 10
 17189         GO TO 2050-DELETE-NOT-FOUND
 17190         DEPENDING ON DFHEIGDI
 17191     ELSE IF DFHEIGDJ EQUAL 11
 17192         GO TO 2010-DELETE-CL
 17193         DEPENDING ON DFHEIGDI
 17194     ELSE IF DFHEIGDJ EQUAL 12
 17195         GO TO 3010-TEST-FOR-ERRORS
 17196         DEPENDING ON DFHEIGDI
 17197     ELSE IF DFHEIGDJ EQUAL 13
 17198         GO TO 3008-DUP-ERROR,
 17199               3009-NOT-FOUND
 17200         DEPENDING ON DFHEIGDI
 17201     ELSE IF DFHEIGDJ EQUAL 14
 17202         GO TO 3030-BUILD-CONT
 17203         DEPENDING ON DFHEIGDI
 17204     ELSE IF DFHEIGDJ EQUAL 15
 17205         GO TO 3033-ACCT-NOT-FOUND,
 17206               3033-ACCT-NOT-FOUND
 17207         DEPENDING ON DFHEIGDI
 17208     ELSE IF DFHEIGDJ EQUAL 16
 17209         GO TO 3032-NOT-IN-DT-RANGE
 17210         DEPENDING ON DFHEIGDI
 17211     ELSE IF DFHEIGDJ EQUAL 17
 17212         GO TO 3070-BUILD-CONT
 17213         DEPENDING ON DFHEIGDI
 17214     ELSE IF DFHEIGDJ EQUAL 18
 17215         GO TO 3065-CERT-NOT-FOUND
 17216         DEPENDING ON DFHEIGDI
 17217     ELSE IF DFHEIGDJ EQUAL 19
 17218         GO TO 3100-CARRIER-NOT-FOUND
 17219         DEPENDING ON DFHEIGDI
 17220     ELSE IF DFHEIGDJ EQUAL 20
 17221         GO TO 3110-COMPANY-NOT-FOUND
 17222         DEPENDING ON DFHEIGDI
 17223     ELSE IF DFHEIGDJ EQUAL 21
 17224         GO TO 3200-BUILD-ZERO-TRAILER
 17225         DEPENDING ON DFHEIGDI
 17226     ELSE IF DFHEIGDJ EQUAL 22
 17227         GO TO 9999-DFHBACK
 17228         DEPENDING ON DFHEIGDI
 17229     ELSE IF DFHEIGDJ EQUAL 23
 17230         GO TO 3290-NO-INSURED-ADDRESS
 17231         DEPENDING ON DFHEIGDI
 17232     ELSE IF DFHEIGDJ EQUAL 24
 17233         GO TO 3410-DUP-KEY
 17234         DEPENDING ON DFHEIGDI
 17235     ELSE IF DFHEIGDJ EQUAL 25
 17236         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 332
* EL130.cbl
 17237         DEPENDING ON DFHEIGDI
 17238     ELSE IF DFHEIGDJ EQUAL 26
 17239         GO TO 3850-CLAIM-MSTR-WRITTEN
 17240         DEPENDING ON DFHEIGDI
 17241     ELSE IF DFHEIGDJ EQUAL 27
 17242         GO TO 3992-DUPREC
 17243         DEPENDING ON DFHEIGDI
 17244     ELSE IF DFHEIGDJ EQUAL 28
 17245         GO TO 5050-CERT-NOT-FOUND
 17246         DEPENDING ON DFHEIGDI
 17247     ELSE IF DFHEIGDJ EQUAL 29
 17248         GO TO 5030-CERT-WRITTEN
 17249         DEPENDING ON DFHEIGDI
 17250     ELSE IF DFHEIGDJ EQUAL 30
 17251         GO TO 5035-CLAIM-WRITTEN
 17252         DEPENDING ON DFHEIGDI
 17253     ELSE IF DFHEIGDJ EQUAL 31
 17254         GO TO 9990-ABEND,
 17255               5799-EXIT
 17256         DEPENDING ON DFHEIGDI
 17257     ELSE IF DFHEIGDJ EQUAL 32
 17258         GO TO 3100-CARRIER-NOT-FOUND
 17259         DEPENDING ON DFHEIGDI
 17260     ELSE IF DFHEIGDJ EQUAL 33
 17261         GO TO 6040-NO-PROCESSOR-RECORD
 17262         DEPENDING ON DFHEIGDI
 17263     ELSE IF DFHEIGDJ EQUAL 34
 17264         GO TO 6060-NO-BENEFICIARY-RECORD
 17265         DEPENDING ON DFHEIGDI
 17266     ELSE IF DFHEIGDJ EQUAL 35
 17267         GO TO 6499-EXIT,
 17268               6499-EXIT
 17269         DEPENDING ON DFHEIGDI
 17270     ELSE IF DFHEIGDJ EQUAL 36
 17271         GO TO 6600-NOT-FOUND
 17272         DEPENDING ON DFHEIGDI
 17273     ELSE IF DFHEIGDJ EQUAL 37
 17274         GO TO 6700-NOTOPEN-ERROR,
 17275               6700-EXIT
 17276         DEPENDING ON DFHEIGDI
 17277     ELSE IF DFHEIGDJ EQUAL 38
 17278         GO TO 7120-NOT-FOUND
 17279         DEPENDING ON DFHEIGDI
 17280     ELSE IF DFHEIGDJ EQUAL 39
 17281         GO TO 7499-EXIT
 17282         DEPENDING ON DFHEIGDI
 17283     ELSE IF DFHEIGDJ EQUAL 40
 17284         GO TO 7500-EXIT,
 17285               7500-DUPLICATE-KEY,
 17286               7500-EXIT
 17287         DEPENDING ON DFHEIGDI
 17288     ELSE IF DFHEIGDJ EQUAL 41
 17289         GO TO 7500-END-BROWSE
 17290         DEPENDING ON DFHEIGDI
 17291     ELSE IF DFHEIGDJ EQUAL 42
 17292         GO TO 7630-END-BROWSE
 17293         DEPENDING ON DFHEIGDI
 17294     ELSE IF DFHEIGDJ EQUAL 43
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:39 Page 333
* EL130.cbl
 17295         GO TO 7799-EXIT,
 17296               7799-EXIT
 17297         DEPENDING ON DFHEIGDI
 17298     ELSE IF DFHEIGDJ EQUAL 44
 17299         GO TO 7790-END-BROWSE
 17300         DEPENDING ON DFHEIGDI
 17301     ELSE IF DFHEIGDJ EQUAL 45
 17302         GO TO 7992-NOT-FOUND
 17303         DEPENDING ON DFHEIGDI
 17304     ELSE IF DFHEIGDJ EQUAL 46
 17305         GO TO 8300-SEND-TEXT
 17306         DEPENDING ON DFHEIGDI.
 17307     MOVE '9%                    "   ' TO DFHEIV0
 17308     MOVE 'EL130' TO DFHEIV1
 17309     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17310     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12864     Code:       55141
