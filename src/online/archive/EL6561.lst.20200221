* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   1
* EL6561.cbl
* Options: int("EL6561.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6561.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6561.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6561.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6561.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 13:22:43.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.021
     9
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   2
* EL6561.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EXE2 - RATE MASTER MAINTENANCE
    26*                                 LIFE AND A&H LIMITS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   3
* EL6561.cbl
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 081413    2013080700002  PEMA ADD JOURNALING OF ERRATE FILE
    37* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40 DATA DIVISION.
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*    EL6561 WORKING STORAGE    *'.
    45 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    46
    47 01  WS-DATE-AREA.
    48     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    49     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    50
    51***  Y2K PROJ 7744
    52 01  WS-RATE-HOLD-AREA.
    53     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    54     05  WS-HOLD-RATE-EXP-DT REDEFINES
    55         WS-HOLD-RATE-EXP-AL PIC 9(11).
    56***  Y2K PROJ 7744
    57
    58 01  STANDARD-AREAS.
    59     05  GETMAIN-SPACE       PIC X       VALUE SPACE.
    60     05  WS-MAPNAME          PIC X(8)    VALUE 'EL6561A'.
    61     05  WS-MAPSET-NAME      PIC X(8)    VALUE 'EL6561S'.
    62     05  TRANS-ID            PIC X(4)    VALUE 'EXE2'.
    63     05  THIS-PGM            PIC X(8)    VALUE 'EL6561'.
    64     05  PGM-NAME            PIC X(8).
    65     05  SUB1                PIC S999    VALUE +0.
    66     05  SUB2                PIC S99     VALUE +0.
    67     05  SC-ITEM             PIC S9(4)   VALUE +1     COMP.
    68     05  WS-COMP-CD-R.
    69         10  FILLER          PIC X.
    70         10  WS-COMP-CD-X    PIC X.
    71     05  WS-COMP-CD   REDEFINES WS-COMP-CD-R  PIC S9(4)     COMP.
    72     05  TIME-IN             PIC S9(7).
    73     05  TIME-OUT-R  REDEFINES TIME-IN.
    74         10  FILLER          PIC X.
    75         10  TIME-OUT        PIC 99V99.
    76         10  FILLER          PIC XX.
    77     05  XCTL-005            PIC X(8)    VALUE 'EL005'.
    78     05  XCTL-010            PIC X(8)    VALUE 'EL010'.
    79     05  XCTL-626            PIC X(8)    VALUE 'EL126'.
    80     05  XCTL-6562           PIC X(8)    VALUE 'EL6562'.
    81     05  LINK-001            PIC X(8)    VALUE 'EL001'.
    82     05  LINK-004            PIC X(8)    VALUE 'EL004'.
    83
    84     05  ER-0000             PIC X(4)    VALUE  '0000'.
    85     05  ER-0004             PIC X(4)    VALUE  '0004'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   4
* EL6561.cbl
    86     05  ER-0008             PIC X(4)    VALUE  '0008'.
    87     05  ER-0029             PIC X(4)    VALUE  '0029'.
    88     05  ER-0068             PIC X(4)    VALUE  '0068'.
    89     05  ER-0070             PIC X(4)    VALUE  '0070'.
    90     05  ER-0142             PIC X(4)    VALUE  '0142'.
    91     05  ER-2055             PIC X(4)    VALUE  '2055'.
    92     05  ER-2056             PIC X(4)    VALUE  '2056'.
    93     05  ER-2184             PIC X(4)    VALUE  '2184'.
    94     05  ER-2185             PIC X(4)    VALUE  '2185'.
    95     05  ER-2186             PIC X(4)    VALUE  '2186'.
    96     05  ER-2187             PIC X(4)    VALUE  '2187'.
    97     05  ER-2237             PIC X(4)    VALUE  '2237'.
    98     05  ER-2273             PIC X(4)    VALUE  '2273'.
    99     05  ER-2274             PIC X(4)    VALUE  '2274'.
   100     05  ER-2275             PIC X(4)    VALUE  '2275'.
   101     05  ER-2276             PIC X(4)    VALUE  '2276'.
   102     05  ER-2277             PIC X(4)    VALUE  '2277'.
   103     05  ER-2278             PIC X(4)    VALUE  '2278'.
   104     05  ER-2279             PIC X(4)    VALUE  '2279'.
   105     05  ER-2280             PIC X(4)    VALUE  '2280'.
   106     05  ER-2285             PIC X(4)    VALUE  '2285'.
   107***  Y2K PROJ 7744
   108     05  ER-2296             PIC X(4)    VALUE  '2296'.
   109***  Y2K PROJ 7744
   110     05  ER-2546             PIC X(4)    VALUE  '2546'.
   111     05  ER-2873             PIC X(4)    VALUE  '2873'.
   112     05  ER-2874             PIC X(4)    VALUE  '2874'.
   113     05  ER-2875             PIC X(4)    VALUE  '2875'.
   114     05  ER-9407             PIC X(4)    VALUE  '9407'.
   115
   116     05  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   117     05  RATE-FILE-ID        PIC X(8)    VALUE 'ERRATE'.
   118     05  OE-RATE-FILE-ID     PIC X(8)    VALUE 'OERATE'.
   119     05  CNTL-FILE-ID        PIC X(8)    VALUE 'ELCNTL'.
   120     05  FILE-ID             PIC X(8)    VALUE  SPACES.
   121     05  BIN-CURRENT-SAVE    PIC XX      VALUE  SPACES.
   122
   123 01  filler.
   124     12  WS-RESPONSE             PIC S9(8)   COMP.
   125         88  WS-RESP-NORMAL              VALUE +00.
   126         88  WS-RESP-ERROR               VALUE +01.
   127         88  WS-RESP-NOTFND              VALUE +13.
   128         88  WS-RESP-DUPKEY              VALUE +15.
   129         88  WS-RESP-NOTOPEN             VALUE +19.
   130         88  WS-RESP-ENDFILE             VALUE +20.
   131 01  MISC-WORK-AREAS.
   132     05  WS-PHONE-IN         PIC 9(10).
   133     05  WS-PHONE-IN-R  REDEFINES WS-PHONE-IN.
   134         10  WSPI-AREA       PIC XXX.
   135         10  WSPI-PFX        PIC XXX.
   136         10  WSPI-SFX        PIC X(4).
   137     05  WS-PHONE-OUT.
   138         10  WSPO-AREA       PIC XXX.
   139         10  FILLER          PIC X       VALUE '-'.
   140         10  WSPO-PFX        PIC XXX.
   141         10  FILLER          PIC X       VALUE '-'.
   142         10  WSPO-SFX        PIC X(4).
   143
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   5
* EL6561.cbl
   144     05  DEEDIT-FIELD            PIC X(15).
   145     05  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).
   146     05  DEEDIT-FIELD-V2  REDEFINES DEEDIT-FIELD PIC S9(13)V99.
   147     05  DEEDIT-FIELD-V5  REDEFINES DEEDIT-FIELD PIC S9(10)V9(5).
   148
   149     05  ERRATE-LENGTH       PIC S9(4)    VALUE +1765 COMP.
   150     05  MORTCD-LENGTH       PIC S9(4)    VALUE +4    COMP.
   151     05  SV-CLMTOL           PIC 999V99   VALUE ZEROS.
   152     05  DATE-TEST-AREA      PIC 9(6).
   153     05  DATE-TEST-AREA-R  REDEFINES DATE-TEST-AREA.
   154         10  DATE-TEST-MM    PIC 99.
   155         10  DATE-TEST-DD    PIC 99.
   156         10  DATE-TEST-YY    PIC 99.
   157     05  DIVIDE-RESULT       PIC 99.
   158     05  DIVIDE-REMAINDER    PIC 9.
   159
   160     05  WS-PREV-AGE         PIC 99       VALUE ZERO.
   161     05  WS-PREV-TRM         PIC 999      VALUE ZERO.
   162     05  WS-PREV-AMT         PIC S9(7)V99 VALUE ZERO.
   163     05  WS-DAILY-RATE       PIC S99V9(5) VALUE ZERO.
   164     05  WS-DISCOUNT-RATE    PIC S99V9(5) VALUE ZERO.
   165     05  WS-CANCEL-FEE       PIC S9(03)V99 VALUE +0.
   166     05  WS-COMPOSITE-RATE   PIC S99V9(5) VALUE ZERO.
   167     05  WS-DISCOUNT-OB-RATE PIC S99V9(5) VALUE ZERO.
   168     05  WS-DISCOUNT-OPTION  PIC X        VALUE SPACES.
   169
   170     05  WS-SAVE-KEY         PIC X(28)    VALUE SPACES.
   171     05  WS-SAVE-STRUCTURE   PIC X(7)     VALUE SPACES.
   172
   173     05  WS-FIRST-TIME-SW    PIC X        VALUE 'Y'.
   174         88  FIRST-TIME                   VALUE 'Y'.
   175
   176     05  ELCNTL-KEY.
   177         10  CNTL-COMP-ID    PIC XXX     VALUE SPACES.
   178         10  CNTL-REC-TYPE   PIC X       VALUE SPACES.
   179         10  CNTL-ACCESS     PIC X(4)    VALUE SPACES.
   180         10  CNTL-SEQ-NO     PIC S9(4)   VALUE +0  COMP.
   181
   182     05  MISC-SAVE-AREAS.
   183         10  WS-MAX-AGE               PIC 99.
   184         10  WS-MORT-CODE             PIC X(4).
   185         10  WS-EXCEPTIONS            OCCURS 8 TIMES.
   186             15  WS-LIMIT-AGE         PIC 99.
   187             15  WS-LIMIT-TERM        PIC S999.
   188             15  WS-LIMIT-MO-BEN      PIC S9(5).
   189             15  WS-LIMIT-TO-BEN      PIC S9(7).
   190
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   6
* EL6561.cbl
   192*                          COPY ELCSCTM.
   193******************************************************************
   194*                                                                *
   195*                                                                *
   196*                            ELCSCTM                             *
   197*                            VMOD=2.001                          *
   198*                                                                *
   199*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   200*                                                                *
   201******************************************************************
   202 01  SECURITY-MESSAGE.
   203     12  FILLER                          PIC X(30)
   204            VALUE '** LOGIC SECURITY VIOLATION -'.
   205     12  SM-READ                         PIC X(6).
   206     12  FILLER                          PIC X(5)
   207            VALUE ' PGM='.
   208     12  SM-PGM                          PIC X(6).
   209     12  FILLER                          PIC X(5)
   210            VALUE ' OPR='.
   211     12  SM-PROCESSOR-ID                 PIC X(4).
   212     12  FILLER                          PIC X(6)
   213            VALUE ' TERM='.
   214     12  SM-TERMID                       PIC X(4).
   215     12  FILLER                          PIC XX   VALUE SPACE.
   216     12  SM-JUL-DATE                     PIC 9(5).
   217     12  FILLER                          PIC X    VALUE SPACE.
   218     12  SM-TIME                         PIC 99.99.
   219
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   7
* EL6561.cbl
   221*                          COPY ELCSCRTY.
   222******************************************************************
   223*                                                                *
   224*                                                                *
   225*                            ELCSCRTY                            *
   226*                            VMOD=2.001                          *
   227*                                                                *
   228*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   229*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   230*        SAVED IN PI-SECURITY-ADDRESS.                           *
   231*                                                                *
   232******************************************************************
   233 01  SECURITY-CONTROL.
   234     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   235     12  FILLER                       PIC XX    VALUE 'SC'.
   236     12  SC-CREDIT-CODES.
   237         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   238             20  SC-CREDIT-DISPLAY    PIC X.
   239             20  SC-CREDIT-UPDATE     PIC X.
   240     12  SC-CLAIMS-CODES.
   241         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   242             20  SC-CLAIMS-DISPLAY    PIC X.
   243             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   8
* EL6561.cbl
   245*                                  COPY ELCDATE.
   246******************************************************************
   247*                                                                *
   248*                                                                *
   249*                            ELCDATE.                            *
   250*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   251*                            VMOD=2.003
   252*                                                                *
   253*                                                                *
   254*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   255*                 LENGTH = 200                                   *
   256******************************************************************
   257
   258 01  DATE-CONVERSION-DATA.
   259     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   260     12  DC-OPTION-CODE                PIC X.
   261         88  BIN-TO-GREG                VALUE ' '.
   262         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   263         88  EDIT-GREG-TO-BIN           VALUE '2'.
   264         88  YMD-GREG-TO-BIN            VALUE '3'.
   265         88  MDY-GREG-TO-BIN            VALUE '4'.
   266         88  JULIAN-TO-BIN              VALUE '5'.
   267         88  BIN-PLUS-ELAPSED           VALUE '6'.
   268         88  FIND-CENTURY               VALUE '7'.
   269         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   270         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   271         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   272         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   273         88  JULIAN-TO-BIN-3            VALUE 'C'.
   274         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   275         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   276         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   277         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   278         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   279         88  CHECK-LEAP-YEAR            VALUE 'H'.
   280         88  BIN-3-TO-GREG              VALUE 'I'.
   281         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   282         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   283         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   284         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   285         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   286         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   287         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   288         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   289         88  THREE-CHARACTER-BIN
   290                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   291         88  GREGORIAN-TO-BIN
   292                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   293         88  BIN-TO-GREGORIAN
   294                  VALUES ' ' '1' 'I' '8' 'G'.
   295         88  JULIAN-TO-BINARY
   296                  VALUES '5' 'C' 'E' 'F'.
   297     12  DC-ERROR-CODE                 PIC X.
   298         88  NO-CONVERSION-ERROR        VALUE ' '.
   299         88  DATE-CONVERSION-ERROR
   300                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   301         88  DATE-IS-ZERO               VALUE '1'.
   302         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page   9
* EL6561.cbl
   303         88  DATE-IS-INVALID            VALUE '3'.
   304         88  DATE1-GREATER-DATE2        VALUE '4'.
   305         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   306         88  DATE-INVALID-OPTION        VALUE '9'.
   307         88  INVALID-CENTURY            VALUE 'A'.
   308         88  ONLY-CENTURY               VALUE 'B'.
   309         88  ONLY-LEAP-YEAR             VALUE 'C'.
   310         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   311     12  DC-END-OF-MONTH               PIC X.
   312         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   313     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   314         88  USE-NORMAL-PROCESS         VALUE ' '.
   315         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   316         88  ADJUST-UP-100-YRS          VALUE '2'.
   317     12  FILLER                        PIC X.
   318     12  DC-CONVERSION-DATES.
   319         16  DC-BIN-DATE-1             PIC XX.
   320         16  DC-BIN-DATE-2             PIC XX.
   321         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   322         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   323                       DC-GREG-DATE-1-EDIT.
   324             20  DC-EDIT1-MONTH        PIC 99.
   325             20  SLASH1-1              PIC X.
   326             20  DC-EDIT1-DAY          PIC 99.
   327             20  SLASH1-2              PIC X.
   328             20  DC-EDIT1-YEAR         PIC 99.
   329         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   330         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   331                     DC-GREG-DATE-2-EDIT.
   332             20  DC-EDIT2-MONTH        PIC 99.
   333             20  SLASH2-1              PIC X.
   334             20  DC-EDIT2-DAY          PIC 99.
   335             20  SLASH2-2              PIC X.
   336             20  DC-EDIT2-YEAR         PIC 99.
   337         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   338         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   339                     DC-GREG-DATE-1-YMD.
   340             20  DC-YMD-YEAR           PIC 99.
   341             20  DC-YMD-MONTH          PIC 99.
   342             20  DC-YMD-DAY            PIC 99.
   343         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   344         16  DC-GREG-DATE-1-MDY-R REDEFINES
   345                      DC-GREG-DATE-1-MDY.
   346             20  DC-MDY-MONTH          PIC 99.
   347             20  DC-MDY-DAY            PIC 99.
   348             20  DC-MDY-YEAR           PIC 99.
   349         16  DC-GREG-DATE-1-ALPHA.
   350             20  DC-ALPHA-MONTH        PIC X(10).
   351             20  DC-ALPHA-DAY          PIC 99.
   352             20  FILLER                PIC XX.
   353             20  DC-ALPHA-CENTURY.
   354                 24 DC-ALPHA-CEN-N     PIC 99.
   355             20  DC-ALPHA-YEAR         PIC 99.
   356         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   357         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   358         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   359         16  DC-JULIAN-DATE            PIC 9(05).
   360         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  10
* EL6561.cbl
   361                                       PIC 9(05).
   362         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   363             20  DC-JULIAN-YEAR        PIC 99.
   364             20  DC-JULIAN-DAYS        PIC 999.
   365         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   366         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   367         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   368     12  DATE-CONVERSION-VARIBLES.
   369         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   370         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   371             20  FILLER                PIC 9(3).
   372             20  HOLD-CEN-1-CCYY.
   373                 24  HOLD-CEN-1-CC     PIC 99.
   374                 24  HOLD-CEN-1-YY     PIC 99.
   375             20  HOLD-CEN-1-MO         PIC 99.
   376             20  HOLD-CEN-1-DA         PIC 99.
   377         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   378             20  HOLD-CEN-1-R-MO       PIC 99.
   379             20  HOLD-CEN-1-R-DA       PIC 99.
   380             20  HOLD-CEN-1-R-CCYY.
   381                 24  HOLD-CEN-1-R-CC   PIC 99.
   382                 24  HOLD-CEN-1-R-YY   PIC 99.
   383             20  FILLER                PIC 9(3).
   384         16  HOLD-CENTURY-1-X.
   385             20  FILLER                PIC X(3)  VALUE SPACES.
   386             20  HOLD-CEN-1-X-CCYY.
   387                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   388                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   389             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   390             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   391         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   392             20  HOLD-CEN-1-R-X-MO     PIC XX.
   393             20  HOLD-CEN-1-R-X-DA     PIC XX.
   394             20  HOLD-CEN-1-R-X-CCYY.
   395                 24  HOLD-CEN-1-R-X-CC PIC XX.
   396                 24  HOLD-CEN-1-R-X-YY PIC XX.
   397             20  FILLER                PIC XXX.
   398         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   399         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   400         16  DC-JULIAN-DATE-1          PIC 9(07).
   401         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   402             20  DC-JULIAN-1-CCYY.
   403                 24  DC-JULIAN-1-CC    PIC 99.
   404                 24  DC-JULIAN-1-YR    PIC 99.
   405             20  DC-JULIAN-DA-1        PIC 999.
   406         16  DC-JULIAN-DATE-2          PIC 9(07).
   407         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   408             20  DC-JULIAN-2-CCYY.
   409                 24  DC-JULIAN-2-CC    PIC 99.
   410                 24  DC-JULIAN-2-YR    PIC 99.
   411             20  DC-JULIAN-DA-2        PIC 999.
   412         16  DC-GREG-DATE-A-EDIT.
   413             20  DC-EDITA-MONTH        PIC 99.
   414             20  SLASHA-1              PIC X VALUE '/'.
   415             20  DC-EDITA-DAY          PIC 99.
   416             20  SLASHA-2              PIC X VALUE '/'.
   417             20  DC-EDITA-CCYY.
   418                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  11
* EL6561.cbl
   419                 24  DC-EDITA-YEAR     PIC 99.
   420         16  DC-GREG-DATE-B-EDIT.
   421             20  DC-EDITB-MONTH        PIC 99.
   422             20  SLASHB-1              PIC X VALUE '/'.
   423             20  DC-EDITB-DAY          PIC 99.
   424             20  SLASHB-2              PIC X VALUE '/'.
   425             20  DC-EDITB-CCYY.
   426                 24  DC-EDITB-CENT     PIC 99.
   427                 24  DC-EDITB-YEAR     PIC 99.
   428         16  DC-GREG-DATE-CYMD         PIC 9(08).
   429         16  DC-GREG-DATE-CYMD-R REDEFINES
   430                              DC-GREG-DATE-CYMD.
   431             20  DC-CYMD-CEN           PIC 99.
   432             20  DC-CYMD-YEAR          PIC 99.
   433             20  DC-CYMD-MONTH         PIC 99.
   434             20  DC-CYMD-DAY           PIC 99.
   435         16  DC-GREG-DATE-MDCY         PIC 9(08).
   436         16  DC-GREG-DATE-MDCY-R REDEFINES
   437                              DC-GREG-DATE-MDCY.
   438             20  DC-MDCY-MONTH         PIC 99.
   439             20  DC-MDCY-DAY           PIC 99.
   440             20  DC-MDCY-CEN           PIC 99.
   441             20  DC-MDCY-YEAR          PIC 99.
   442    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   443        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   444    12  DC-EL310-DATE                  PIC X(21).
   445    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  12
* EL6561.cbl
   447*                                  COPY ELCLOGOF.
   448******************************************************************
   449*                                                                *
   450*                                                                *
   451*                            ELCLOGOF.                           *
   452*                            VMOD=2.001                          *
   453*                                                                *
   454*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   455*                                                                *
   456******************************************************************
   457 01  CLASIC-LOGOFF.
   458     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   459     12  LOGOFF-TEXT.
   460         16  FILLER          PIC X(5)    VALUE SPACES.
   461         16  LOGOFF-MSG.
   462             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   463             20  FILLER      PIC X       VALUE SPACES.
   464             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   465         16  FILLER          PIC X(80)
   466           VALUE '* YOU ARE NOW LOGGED OFF'.
   467         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   468         16  FILLER          PIC X       VALUE QUOTE.
   469         16  LOGOFF-SYS-MSG  PIC X(17)
   470           VALUE 'S CLAS-IC SYSTEM '.
   471     12  TEXT-MESSAGES.
   472         16  UNACCESS-MSG    PIC X(29)
   473             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   474         16  PGMIDERR-MSG    PIC X(17)
   475             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  13
* EL6561.cbl
   477*                                  COPY ELCATTR.
   478******************************************************************
   479*                                                                *
   480*                            ELCATTR.                            *
   481*                            VMOD=2.001                          *
   482*                                                                *
   483*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   484*                                                                *
   485*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   486*                                                                *
   487*                   POS 1   P=PROTECTED                          *
   488*                           U=UNPROTECTED                        *
   489*                           S=ASKIP                              *
   490*                   POS 2   A=ALPHA/NUMERIC                      *
   491*                           N=NUMERIC                            *
   492*                   POS 3   N=NORMAL                             *
   493*                           B=BRIGHT                             *
   494*                           D=DARK                               *
   495*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   496*                           OF=MODIFIED DATA TAG OFF             *
   497*                                                                *
   498*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   499******************************************************************
   500 01  ATTRIBUTE-LIST.
   501     12  AL-PABOF            PIC X       VALUE 'Y'.
   502     12  AL-PABON            PIC X       VALUE 'Z'.
   503     12  AL-PADOF            PIC X       VALUE '%'.
   504     12  AL-PADON            PIC X       VALUE '_'.
   505     12  AL-PANOF            PIC X       VALUE '-'.
   506     12  AL-PANON            PIC X       VALUE '/'.
   507     12  AL-SABOF            PIC X       VALUE '8'.
   508     12  AL-SABON            PIC X       VALUE '9'.
   509     12  AL-SADOF            PIC X       VALUE '@'.
   510     12  AL-SADON            PIC X       VALUE QUOTE.
   511     12  AL-SANOF            PIC X       VALUE '0'.
   512     12  AL-SANON            PIC X       VALUE '1'.
   513     12  AL-UABOF            PIC X       VALUE 'H'.
   514     12  AL-UABON            PIC X       VALUE 'I'.
   515     12  AL-UADOF            PIC X       VALUE '<'.
   516     12  AL-UADON            PIC X       VALUE '('.
   517     12  AL-UANOF            PIC X       VALUE ' '.
   518     12  AL-UANON            PIC X       VALUE 'A'.
   519     12  AL-UNBOF            PIC X       VALUE 'Q'.
   520     12  AL-UNBON            PIC X       VALUE 'R'.
   521     12  AL-UNDOF            PIC X       VALUE '*'.
   522     12  AL-UNDON            PIC X       VALUE ')'.
   523     12  AL-UNNOF            PIC X       VALUE '&'.
   524     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  14
* EL6561.cbl
   526*                                  COPY ELCEMIB.
   527******************************************************************
   528*                                                                *
   529*                                                                *
   530*                            ELCEMIB.                            *
   531*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   532*                            VMOD=2.005                          *
   533*                                                                *
   534*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   535*                                                                *
   536******************************************************************
   537 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   538     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   539     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   540     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   541     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   542     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   543     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   544     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   545     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   546     12  EMI-SWITCH1             PIC X        VALUE '1'.
   547         88  EMI-NO-ERRORS                    VALUE '1'.
   548         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   549         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   550     12  EMI-SWITCH2             PIC X        VALUE '1'.
   551         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   552     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   553         88  EMI-AREA1-EMPTY                  VALUE '1'.
   554         88  EMI-AREA1-FULL                   VALUE '2'.
   555     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   556         88  EMI-AREA2-EMPTY                  VALUE '1'.
   557         88  EMI-AREA2-FULL                   VALUE '2'.
   558     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   559         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   560         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   561         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   562         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   563         88  EMI-BYPASS-FATALS                VALUE 'X'.
   564     12  EMI-ERROR-LINES.
   565         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   566         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   567         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   568         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   569             20  EMI-ERR-CODES OCCURS 10 TIMES.
   570                 24  EMI-ERR-NUM         PIC X(4).
   571                 24  EMI-FILLER          PIC X.
   572                 24  EMI-SEV             PIC X.
   573                 24  FILLER              PIC X.
   574             20  FILLER                  PIC X(02).
   575     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   576         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   577             20  EMI-ERROR-NUMBER    PIC X(4).
   578             20  EMI-FILL            PIC X.
   579             20  EMI-SEVERITY        PIC X.
   580             20  FILLER              PIC X.
   581             20  EMI-ERROR-TEXT.
   582                 24  EMI-TEXT-VARIABLE   PIC X(10).
   583                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  15
* EL6561.cbl
   584     12  EMI-SEVERITY-SAVE           PIC X.
   585         88  EMI-NOTE                    VALUE 'N'.
   586         88  EMI-WARNING                 VALUE 'W'.
   587         88  EMI-FORCABLE                VALUE 'F'.
   588         88  EMI-FATAL                   VALUE 'X'.
   589     12  EMI-MESSAGE-FLAG            PIC X.
   590         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   591         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   592     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   593     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   594         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   595         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   596         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   597     12  emi-claim-no                pic x(7).
   598     12  emi-claim-type              pic x(6).
   599     12  FILLER                      PIC X(124)  VALUE SPACES.
   600     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   601     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   602     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   603     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  16
* EL6561.cbl
   605*                                  COPY ELCINTF.
   606******************************************************************
   607*                                                                *
   608*                                                                *
   609*                            ELCINTF.                            *
   610*                            VMOD=2.017                          *
   611*                                                                *
   612*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   613*                                                                *
   614*       LENGTH = 1024                                            *
   615*                                                                *
   616******************************************************************
   617*                   C H A N G E   L O G
   618*
   619* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   620*-----------------------------------------------------------------
   621*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   622* EFFECTIVE    NUMBER
   623*-----------------------------------------------------------------
   624* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   625******************************************************************
   626 01  PROGRAM-INTERFACE-BLOCK.
   627     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   628     12  PI-CALLING-PROGRAM              PIC X(8).
   629     12  PI-SAVED-PROGRAM-1              PIC X(8).
   630     12  PI-SAVED-PROGRAM-2              PIC X(8).
   631     12  PI-SAVED-PROGRAM-3              PIC X(8).
   632     12  PI-SAVED-PROGRAM-4              PIC X(8).
   633     12  PI-SAVED-PROGRAM-5              PIC X(8).
   634     12  PI-SAVED-PROGRAM-6              PIC X(8).
   635     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   636     12  PI-COMPANY-ID                   PIC XXX.
   637     12  PI-COMPANY-CD                   PIC X.
   638
   639     12  PI-COMPANY-PASSWORD             PIC X(8).
   640
   641     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   642
   643     12  PI-CONTROL-IN-PROGRESS.
   644         16  PI-CARRIER                  PIC X.
   645         16  PI-GROUPING                 PIC X(6).
   646         16  PI-STATE                    PIC XX.
   647         16  PI-ACCOUNT                  PIC X(10).
   648         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   649                                         PIC X(10).
   650         16  PI-CLAIM-CERT-GRP.
   651             20  PI-CLAIM-NO             PIC X(7).
   652             20  PI-CERT-NO.
   653                 25  PI-CERT-PRIME       PIC X(10).
   654                 25  PI-CERT-SFX         PIC X.
   655             20  PI-CERT-EFF-DT          PIC XX.
   656         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   657             20  PI-PLAN-CODE            PIC X(2).
   658             20  PI-REVISION-NUMBER      PIC X(3).
   659             20  PI-PLAN-EFF-DT          PIC X(2).
   660             20  PI-PLAN-EXP-DT          PIC X(2).
   661             20  FILLER                  PIC X(11).
   662         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  17
* EL6561.cbl
   663             20  PI-OE-REFERENCE-1.
   664                 25  PI-OE-REF-1-PRIME   PIC X(18).
   665                 25  PI-OE-REF-1-SUFF    PIC XX.
   666
   667     12  PI-SESSION-IN-PROGRESS          PIC X.
   668         88  CLAIM-SESSION                   VALUE '1'.
   669         88  CREDIT-SESSION                  VALUE '2'.
   670         88  WARRANTY-SESSION                VALUE '3'.
   671         88  MORTGAGE-SESSION                VALUE '4'.
   672         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   673
   674
   675*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   676
   677     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   678     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   679
   680     12  PI-CREDIT-USER                  PIC X.
   681         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   682         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   683
   684     12  PI-CLAIM-USER                   PIC X.
   685         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   686         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   687
   688     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   689         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   690         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   691         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   692         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   693         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   694
   695     12  PI-PROCESSOR-ID                 PIC X(4).
   696
   697     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   698
   699     12  PI-MEMBER-CAPTION               PIC X(10).
   700
   701     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   702         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   703
   704     12  PI-LIFE-OVERRIDE-L1             PIC X.
   705     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   706     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   707     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   708
   709     12  PI-AH-OVERRIDE-L1               PIC X.
   710     12  PI-AH-OVERRIDE-L2               PIC XX.
   711     12  PI-AH-OVERRIDE-L6               PIC X(6).
   712     12  PI-AH-OVERRIDE-L12              PIC X(12).
   713
   714     12  PI-NEW-SYSTEM                   PIC X(2).
   715
   716     12  PI-PRIMARY-CERT-NO              PIC X(11).
   717     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   718         88  PI-USES-PAID-TO                 VALUE '1'.
   719     12  PI-CRDTCRD-SYSTEM.
   720         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  18
* EL6561.cbl
   721             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   722             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   723         16  PI-CC-MONTH-END-DT          PIC XX.
   724     12  PI-PROCESSOR-PRINTER            PIC X(4).
   725
   726     12  PI-OE-REFERENCE-2.
   727         16  PI-OE-REF-2-PRIME           PIC X(10).
   728         16  PI-OE-REF-2-SUFF            PIC X.
   729
   730     12  PI-REM-TRM-CALC-OPTION          PIC X.
   731
   732     12  PI-LANGUAGE-TYPE                PIC X.
   733             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   734             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   735             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   736
   737     12  PI-POLICY-LINKAGE-IND           PIC X.
   738         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   739         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   740                                                   LOW-VALUES.
   741
   742     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   743     12  PI-CLAIM-PW-SESSION             PIC X(1).
   744         88  PI-CLAIM-CREDIT                 VALUE '1'.
   745         88  PI-CLAIM-CONVEN                 VALUE '2'.
   746
   747     12  PI-PROCESSOR-CSR-IND            PIC X.
   748         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   749         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   750
   751     12  FILLER                          PIC X(3).
   752
   753     12  PI-SYSTEM-LEVEL                 PIC X(145).
   754
   755     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   756         PI-SYSTEM-LEVEL.
   757
   758         16  PI-ENTRY-CODES.
   759             20  PI-ENTRY-CD-1           PIC X.
   760             20  PI-ENTRY-CD-2           PIC X.
   761
   762         16  PI-RETURN-CODES.
   763             20  PI-RETURN-CD-1          PIC X.
   764             20  PI-RETURN-CD-2          PIC X.
   765
   766         16  PI-UPDATE-STATUS-SAVE.
   767             20  PI-UPDATE-BY            PIC X(4).
   768             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   769
   770         16  PI-LOWER-CASE-LETTERS       PIC X.
   771             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   772
   773*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   774*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   775*            88  CARRIER-CLM-CNTL            VALUE '2'.
   776
   777         16  PI-CERT-ACCESS-CONTROL      PIC X.
   778             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  19
* EL6561.cbl
   779             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   780             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   781             88  ACCNT-CNTL                  VALUE '3'.
   782             88  CARR-ACCNT-CNTL             VALUE '4'.
   783
   784         16  PI-PROCESSOR-CAP-LIST.
   785             20  PI-SYSTEM-CONTROLS.
   786                24 PI-SYSTEM-DISPLAY     PIC X.
   787                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   788                24 PI-SYSTEM-MODIFY      PIC X.
   789                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   790             20  FILLER                  PIC XX.
   791             20  PI-DISPLAY-CAP          PIC X.
   792                 88  DISPLAY-CAP             VALUE 'Y'.
   793             20  PI-MODIFY-CAP           PIC X.
   794                 88  MODIFY-CAP              VALUE 'Y'.
   795             20  PI-MSG-AT-LOGON-CAP     PIC X.
   796                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   797             20  PI-FORCE-CAP            PIC X.
   798                 88  FORCE-CAP               VALUE 'Y'.
   799
   800         16  PI-PROGRAM-CONTROLS.
   801             20  PI-PGM-PRINT-OPT        PIC X.
   802             20  PI-PGM-FORMAT-OPT       PIC X.
   803             20  PI-PGM-PROCESS-OPT      PIC X.
   804             20  PI-PGM-TOTALS-OPT       PIC X.
   805
   806         16  PI-HELP-INTERFACE.
   807             20  PI-LAST-ERROR-NO        PIC X(4).
   808             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   809
   810         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   811             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   812
   813         16  PI-CR-CONTROL-IN-PROGRESS.
   814             20  PI-CR-CARRIER           PIC X.
   815             20  PI-CR-GROUPING          PIC X(6).
   816             20  PI-CR-STATE             PIC XX.
   817             20  PI-CR-ACCOUNT           PIC X(10).
   818             20  PI-CR-FIN-RESP          PIC X(10).
   819             20  PI-CR-TYPE              PIC X.
   820
   821         16  PI-CR-BATCH-NUMBER          PIC X(6).
   822
   823         16  PI-CR-MONTH-END-DT          PIC XX.
   824
   825         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   826             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   827             88  PI-ZERO-CARRIER             VALUE '1'.
   828             88  PI-ZERO-GROUPING            VALUE '2'.
   829             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   830
   831         16  PI-CARRIER-SECURITY         PIC X.
   832             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   833
   834         16  PI-ACCOUNT-SECURITY         PIC X(10).
   835             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   836             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  20
* EL6561.cbl
   837
   838         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   839             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   840                                         INDEXED BY PI-ACCESS-NDX
   841                                         PIC X.
   842
   843         16  PI-GA-BILLING-CONTROL       PIC X.
   844             88  PI-GA-BILLING               VALUE '1'.
   845
   846         16  PI-MAIL-PROCESSING          PIC X.
   847             88  PI-MAIL-YES                 VALUE 'Y'.
   848
   849         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   850
   851         16  PI-AR-SYSTEM.
   852             20  PI-AR-PROCESSING-CNTL   PIC X.
   853                 88  PI-AR-PROCESSING        VALUE 'Y'.
   854             20  PI-AR-SUMMARY-CODE      PIC X(6).
   855             20  PI-AR-MONTH-END-DT      PIC XX.
   856
   857         16  PI-MP-SYSTEM.
   858             20  PI-MORTGAGE-USER            PIC X.
   859                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   860                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   861             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   862                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   863                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   864                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   865                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   866                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   867             20  PI-MP-MONTH-END-DT          PIC XX.
   868             20  PI-MP-REFERENCE-NO.
   869                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   870                 24  PI-MP-REFERENCE-SFX     PIC XX.
   871
   872         16  PI-LABEL-CONTROL            PIC X(01).
   873             88  PI-CREATE-LABELS                    VALUE 'Y'.
   874             88  PI-BYPASS-LABELS                    VALUE 'N'.
   875
   876         16  PI-BILL-GROUPING-CODE       PIC X(01).
   877             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   878
   879         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   880             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   881             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   882
   883         16  FILLER                      PIC X(14).
   884
   885     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   886******************************************************************
   887     12  PI-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
   888         16  PI-FILE-ID                    PIC XX.
   889         16  PI-MAINT                      PIC X.
   890             88  VALID-MAINT-TYPE                VALUE 'S' 'A' 'C'
   891                                                   'D' 'P' 'E'.
   892             88  ADD-FUNCTION                    VALUE 'A'.
   893             88  SHOW-FUNCTION                   VALUE 'S'.
   894             88  DELETE-FUNCTION                 VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  21
* EL6561.cbl
   895             88  CHANGE-FUNCTION                 VALUE 'C'.
   896             88  COPY-FUNCTION                   VALUE 'P'.
   897             88  DEVIATE-FUNCTION                VALUE 'E'.
   898
   899         16  PI-ERRATE-KEY.
   900             20  PI-RATE-COMPANY-CD         PIC X.
   901             20  PI-RATE-STATE-CODE.
   902                 24  PI-RATE-CODE           PIC XX.
   903                 24  PI-RATE-CLASS          PIC XX.
   904                 24  PI-RATE-DEV            PIC XXX.
   905             20  PI-RATE-L-AH-CODE.
   906                 24  PI-RATE-L-AH           PIC X.
   907                 24  PI-RATE-LAH-NUM        PIC XX.
   908             20  PI-RATE-LIMITS.
   909                 24  PI-RATE-HIGH-AGE       PIC 99.
   910                 24  PI-RATE-HIGH-AMT       PIC 9(6).
   911                 24  PI-RATE-FUTURE         PIC XX.
   912                 24  PI-RATE-SEX            PIC X.
   913             20  PI-RATE-EXPIRY-DATE        PIC 9(11) COMP-3.
   914
   915         16  PI-SAVE-ERRATE-KEY             PIC X(28).
   916
   917         16  PI-BROWSE-SW                  PIC X.
   918             88  BROWSE-STARTED                  VALUE 'Y'.
   919         16  PI-ERRATE-EOF-SW              PIC X.
   920             88  ERRATE-EOF                      VALUE 'Y'.
   921         16  PI-SHOW-SW                    PIC X.
   922             88  SHOWN-ONCE                      VALUE 'Y'.
   923         16  PI-RETURN-SW                  PIC X.
   924         16  PI-DISCOUNT-OPTION            PIC X.
   925         16  PI-DISCOUNT-RATE              PIC S99V9(5) COMP-3.
   926         16  PI-OB-RATE                    PIC S99V9(5) COMP-3.
   927         16  FILLER                        PIC X(568).
   928
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  22
* EL6561.cbl
   930*                            COPY ELCJPFX.
   931******************************************************************
   932*                                                                *
   933*                                                                *
   934*                            ELCJPFX.                            *
   935*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   936*                            VMOD=2.002                          *
   937*                                                                *
   938*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   939*                                                                *
   940*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   941*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   942*        ELCNTL - CONTROL FILE                                   *
   943*        ELMSTR - CLAIM MASTERS                                  *
   944*        ELTRLR - ACTIVITY TRAILERS                              *
   945*        ELCHKQ - CHECK QUE                                      *
   946******************************************************************
   947 01  JOURNAL-RECORD.
   948     12  jp-date                     pic s9(5) comp-3.
   949     12  jp-time                     pic s9(7) comp-3.
   950     12  JP-USER-ID                  PIC X(4).
   951     12  JP-FILE-ID                  PIC X(8).
   952     12  JP-PROGRAM-ID               PIC X(8).
   953     12  JP-RECORD-TYPE              PIC X.
   954         88 JP-ADD              VALUE 'A'.
   955         88 JP-BEFORE-CHANGE    VALUE 'B'.
   956         88 JP-AFTER-CHANGE     VALUE 'C'.
   957         88 JP-DELETE           VALUE 'D'.
   958         88 JP-GENERIC-DELETE   VALUE 'G'.
   959         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   960         88 JP-KEY-CHG-ADD      VALUE 'N'.
   961     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   962     12  JP-RECORD-AREA
   963
   964
   965                             PIC X(2000).
   966
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  23
* EL6561.cbl
   968*                            COPY ELCAID.
   969******************************************************************
   970*                                                                *
   971*                            ELCAID.                             *
   972*                            VMOD=2.001                          *
   973*                                                                *
   974*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   975*                                                                *
   976*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   977*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   978******************************************************************
   979
   980 01  DFHAID.
   981   02  DFHNULL   PIC  X  VALUE  ' '.
   982   02  DFHENTER  PIC  X  VALUE  QUOTE.
   983   02  DFHCLEAR  PIC  X  VALUE  '_'.
   984   02  DFHPEN    PIC  X  VALUE  '='.
   985   02  DFHOPID   PIC  X  VALUE  'W'.
   986   02  DFHPA1    PIC  X  VALUE  '%'.
   987   02  DFHPA2    PIC  X  VALUE  '>'.
   988   02  DFHPA3    PIC  X  VALUE  ','.
   989   02  DFHPF1    PIC  X  VALUE  '1'.
   990   02  DFHPF2    PIC  X  VALUE  '2'.
   991   02  DFHPF3    PIC  X  VALUE  '3'.
   992   02  DFHPF4    PIC  X  VALUE  '4'.
   993   02  DFHPF5    PIC  X  VALUE  '5'.
   994   02  DFHPF6    PIC  X  VALUE  '6'.
   995   02  DFHPF7    PIC  X  VALUE  '7'.
   996   02  DFHPF8    PIC  X  VALUE  '8'.
   997   02  DFHPF9    PIC  X  VALUE  '9'.
   998   02  DFHPF10   PIC  X  VALUE  ':'.
   999   02  DFHPF11   PIC  X  VALUE  '#'.
  1000   02  DFHPF12   PIC  X  VALUE  '@'.
  1001   02  DFHPF13   PIC  X  VALUE  'A'.
  1002   02  DFHPF14   PIC  X  VALUE  'B'.
  1003   02  DFHPF15   PIC  X  VALUE  'C'.
  1004   02  DFHPF16   PIC  X  VALUE  'D'.
  1005   02  DFHPF17   PIC  X  VALUE  'E'.
  1006   02  DFHPF18   PIC  X  VALUE  'F'.
  1007   02  DFHPF19   PIC  X  VALUE  'G'.
  1008   02  DFHPF20   PIC  X  VALUE  'H'.
  1009   02  DFHPF21   PIC  X  VALUE  'I'.
  1010*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1011   02  DFHPF22   PIC  X  VALUE  '['.
  1012   02  DFHPF23   PIC  X  VALUE  '.'.
  1013   02  DFHPF24   PIC  X  VALUE  '<'.
  1014   02  DFHMSRE   PIC  X  VALUE  'X'.
  1015   02  DFHSTRF   PIC  X  VALUE  'h'.
  1016   02  DFHTRIG   PIC  X  VALUE  '"'.
  1017
  1018 01  FILLER    REDEFINES DFHAID.
  1019     05  FILLER              PIC X(8).
  1020     05  PF-VALUES           PIC X       OCCURS 2.
  1021
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  24
* EL6561.cbl
  1023*                            COPY EL6561S.
  1024 01  EL6561AI.
  1025     05  FILLER            PIC  X(0012).
  1026*    -------------------------------
  1027     05  RUNDATEL PIC S9(0004) COMP.
  1028     05  RUNDATEF PIC  X(0001).
  1029     05  FILLER REDEFINES RUNDATEF.
  1030         10  RUNDATEA PIC  X(0001).
  1031     05  RUNDATEI PIC  X(0008).
  1032*    -------------------------------
  1033     05  RUNTIMEL PIC S9(0004) COMP.
  1034     05  RUNTIMEF PIC  X(0001).
  1035     05  FILLER REDEFINES RUNTIMEF.
  1036         10  RUNTIMEA PIC  X(0001).
  1037     05  RUNTIMEI PIC  X(0005).
  1038*    -------------------------------
  1039     05  LIMITSL PIC S9(0004) COMP.
  1040     05  LIMITSF PIC  X(0001).
  1041     05  FILLER REDEFINES LIMITSF.
  1042         10  LIMITSA PIC  X(0001).
  1043     05  LIMITSI PIC  X(0006).
  1044*    -------------------------------
  1045     05  STATEL PIC S9(0004) COMP.
  1046     05  STATEF PIC  X(0001).
  1047     05  FILLER REDEFINES STATEF.
  1048         10  STATEA PIC  X(0001).
  1049     05  STATEI PIC  X(0002).
  1050*    -------------------------------
  1051     05  CLASSL PIC S9(0004) COMP.
  1052     05  CLASSF PIC  X(0001).
  1053     05  FILLER REDEFINES CLASSF.
  1054         10  CLASSA PIC  X(0001).
  1055     05  CLASSI PIC  X(0002).
  1056*    -------------------------------
  1057     05  DEVL PIC S9(0004) COMP.
  1058     05  DEVF PIC  X(0001).
  1059     05  FILLER REDEFINES DEVF.
  1060         10  DEVA PIC  X(0001).
  1061     05  DEVI PIC  X(0003).
  1062*    -------------------------------
  1063     05  PLANCODL PIC S9(0004) COMP.
  1064     05  PLANCODF PIC  X(0001).
  1065     05  FILLER REDEFINES PLANCODF.
  1066         10  PLANCODA PIC  X(0001).
  1067     05  PLANCODI PIC  X(0002).
  1068*    -------------------------------
  1069     05  COVERL PIC S9(0004) COMP.
  1070     05  COVERF PIC  X(0001).
  1071     05  FILLER REDEFINES COVERF.
  1072         10  COVERA PIC  X(0001).
  1073     05  COVERI PIC  X(0001).
  1074*    -------------------------------
  1075     05  RTAGEL PIC S9(0004) COMP.
  1076     05  RTAGEF PIC  X(0001).
  1077     05  FILLER REDEFINES RTAGEF.
  1078         10  RTAGEA PIC  X(0001).
  1079     05  RTAGEI PIC  99.
  1080*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  25
* EL6561.cbl
  1081     05  EXPIREL PIC S9(0004) COMP.
  1082     05  EXPIREF PIC  X(0001).
  1083     05  FILLER REDEFINES EXPIREF.
  1084         10  EXPIREA PIC  X(0001).
  1085     05  EXPIREI PIC  X(0006).
  1086*    -------------------------------
  1087     05  AMOUNTL PIC S9(0004) COMP.
  1088     05  AMOUNTF PIC  X(0001).
  1089     05  FILLER REDEFINES AMOUNTF.
  1090         10  AMOUNTA PIC  X(0001).
  1091     05  AMOUNTI PIC  9999999.
  1092*    -------------------------------
  1093     05  MORTDL PIC S9(0004) COMP.
  1094     05  MORTDF PIC  X(0001).
  1095     05  FILLER REDEFINES MORTDF.
  1096         10  MORTDA PIC  X(0001).
  1097     05  MORTDI PIC  X(0017).
  1098*    -------------------------------
  1099     05  MORTL PIC S9(0004) COMP.
  1100     05  MORTF PIC  X(0001).
  1101     05  FILLER REDEFINES MORTF.
  1102         10  MORTA PIC  X(0001).
  1103     05  MORTI PIC  X(0004).
  1104*    -------------------------------
  1105     05  DISOPTL PIC S9(0004) COMP.
  1106     05  DISOPTF PIC  X(0001).
  1107     05  FILLER REDEFINES DISOPTF.
  1108         10  DISOPTA PIC  X(0001).
  1109     05  DISOPTI PIC  X(0001).
  1110*    -------------------------------
  1111     05  COMPRTL PIC S9(0004) COMP.
  1112     05  COMPRTF PIC  X(0001).
  1113     05  FILLER REDEFINES COMPRTF.
  1114         10  COMPRTA PIC  X(0001).
  1115     05  COMPRTI PIC  X(0008).
  1116*    -------------------------------
  1117     05  DAYRTDL PIC S9(0004) COMP.
  1118     05  DAYRTDF PIC  X(0001).
  1119     05  FILLER REDEFINES DAYRTDF.
  1120         10  DAYRTDA PIC  X(0001).
  1121     05  DAYRTDI PIC  X(0012).
  1122*    -------------------------------
  1123     05  DAYRTL PIC S9(0004) COMP.
  1124     05  DAYRTF PIC  X(0001).
  1125     05  FILLER REDEFINES DAYRTF.
  1126         10  DAYRTA PIC  X(0001).
  1127     05  DAYRTI PIC  X(0008).
  1128*    -------------------------------
  1129     05  DISRATL PIC S9(0004) COMP.
  1130     05  DISRATF PIC  X(0001).
  1131     05  FILLER REDEFINES DISRATF.
  1132         10  DISRATA PIC  X(0001).
  1133     05  DISRATI PIC  X(0008).
  1134*    -------------------------------
  1135     05  CANFEEL PIC S9(0004) COMP.
  1136     05  CANFEEF PIC  X(0001).
  1137     05  FILLER REDEFINES CANFEEF.
  1138         10  CANFEEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  26
* EL6561.cbl
  1139     05  CANFEEI PIC  X(0006).
  1140*    -------------------------------
  1141     05  MAXAGEL PIC S9(0004) COMP.
  1142     05  MAXAGEF PIC  X(0001).
  1143     05  FILLER REDEFINES MAXAGEF.
  1144         10  MAXAGEA PIC  X(0001).
  1145     05  MAXAGEI PIC  X(0002).
  1146*    -------------------------------
  1147     05  OBRATEL PIC S9(0004) COMP.
  1148     05  OBRATEF PIC  X(0001).
  1149     05  FILLER REDEFINES OBRATEF.
  1150         10  OBRATEA PIC  X(0001).
  1151     05  OBRATEI PIC  X(0008).
  1152*    -------------------------------
  1153     05  MAXDL PIC S9(0004) COMP.
  1154     05  MAXDF PIC  X(0001).
  1155     05  FILLER REDEFINES MAXDF.
  1156         10  MAXDA PIC  X(0001).
  1157     05  MAXDI PIC  X(0015).
  1158*    -------------------------------
  1159     05  TOAGE1L PIC S9(0004) COMP.
  1160     05  TOAGE1F PIC  X(0001).
  1161     05  FILLER REDEFINES TOAGE1F.
  1162         10  TOAGE1A PIC  X(0001).
  1163     05  TOAGE1I PIC  X(0002).
  1164*    -------------------------------
  1165     05  TOTERM1L PIC S9(0004) COMP.
  1166     05  TOTERM1F PIC  X(0001).
  1167     05  FILLER REDEFINES TOTERM1F.
  1168         10  TOTERM1A PIC  X(0001).
  1169     05  TOTERM1I PIC  X(0003).
  1170*    -------------------------------
  1171     05  MONBEN1L PIC S9(0004) COMP.
  1172     05  MONBEN1F PIC  X(0001).
  1173     05  FILLER REDEFINES MONBEN1F.
  1174         10  MONBEN1A PIC  X(0001).
  1175     05  MONBEN1I PIC  X(0006).
  1176*    -------------------------------
  1177     05  TOTBEN1L PIC S9(0004) COMP.
  1178     05  TOTBEN1F PIC  X(0001).
  1179     05  FILLER REDEFINES TOTBEN1F.
  1180         10  TOTBEN1A PIC  X(0001).
  1181     05  TOTBEN1I PIC  X(0009).
  1182*    -------------------------------
  1183     05  TOAGE2L PIC S9(0004) COMP.
  1184     05  TOAGE2F PIC  X(0001).
  1185     05  FILLER REDEFINES TOAGE2F.
  1186         10  TOAGE2A PIC  X(0001).
  1187     05  TOAGE2I PIC  X(0002).
  1188*    -------------------------------
  1189     05  TOTERM2L PIC S9(0004) COMP.
  1190     05  TOTERM2F PIC  X(0001).
  1191     05  FILLER REDEFINES TOTERM2F.
  1192         10  TOTERM2A PIC  X(0001).
  1193     05  TOTERM2I PIC  X(0003).
  1194*    -------------------------------
  1195     05  MONBEN2L PIC S9(0004) COMP.
  1196     05  MONBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  27
* EL6561.cbl
  1197     05  FILLER REDEFINES MONBEN2F.
  1198         10  MONBEN2A PIC  X(0001).
  1199     05  MONBEN2I PIC  X(0006).
  1200*    -------------------------------
  1201     05  TOTBEN2L PIC S9(0004) COMP.
  1202     05  TOTBEN2F PIC  X(0001).
  1203     05  FILLER REDEFINES TOTBEN2F.
  1204         10  TOTBEN2A PIC  X(0001).
  1205     05  TOTBEN2I PIC  X(0009).
  1206*    -------------------------------
  1207     05  TOAGE3L PIC S9(0004) COMP.
  1208     05  TOAGE3F PIC  X(0001).
  1209     05  FILLER REDEFINES TOAGE3F.
  1210         10  TOAGE3A PIC  X(0001).
  1211     05  TOAGE3I PIC  X(0002).
  1212*    -------------------------------
  1213     05  TOTERM3L PIC S9(0004) COMP.
  1214     05  TOTERM3F PIC  X(0001).
  1215     05  FILLER REDEFINES TOTERM3F.
  1216         10  TOTERM3A PIC  X(0001).
  1217     05  TOTERM3I PIC  X(0003).
  1218*    -------------------------------
  1219     05  MONBEN3L PIC S9(0004) COMP.
  1220     05  MONBEN3F PIC  X(0001).
  1221     05  FILLER REDEFINES MONBEN3F.
  1222         10  MONBEN3A PIC  X(0001).
  1223     05  MONBEN3I PIC  X(0006).
  1224*    -------------------------------
  1225     05  TOTBEN3L PIC S9(0004) COMP.
  1226     05  TOTBEN3F PIC  X(0001).
  1227     05  FILLER REDEFINES TOTBEN3F.
  1228         10  TOTBEN3A PIC  X(0001).
  1229     05  TOTBEN3I PIC  X(0009).
  1230*    -------------------------------
  1231     05  TOAGE4L PIC S9(0004) COMP.
  1232     05  TOAGE4F PIC  X(0001).
  1233     05  FILLER REDEFINES TOAGE4F.
  1234         10  TOAGE4A PIC  X(0001).
  1235     05  TOAGE4I PIC  X(0002).
  1236*    -------------------------------
  1237     05  TOTERM4L PIC S9(0004) COMP.
  1238     05  TOTERM4F PIC  X(0001).
  1239     05  FILLER REDEFINES TOTERM4F.
  1240         10  TOTERM4A PIC  X(0001).
  1241     05  TOTERM4I PIC  X(0003).
  1242*    -------------------------------
  1243     05  MONBEN4L PIC S9(0004) COMP.
  1244     05  MONBEN4F PIC  X(0001).
  1245     05  FILLER REDEFINES MONBEN4F.
  1246         10  MONBEN4A PIC  X(0001).
  1247     05  MONBEN4I PIC  X(0006).
  1248*    -------------------------------
  1249     05  TOTBEN4L PIC S9(0004) COMP.
  1250     05  TOTBEN4F PIC  X(0001).
  1251     05  FILLER REDEFINES TOTBEN4F.
  1252         10  TOTBEN4A PIC  X(0001).
  1253     05  TOTBEN4I PIC  X(0009).
  1254*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  28
* EL6561.cbl
  1255     05  TOAGE5L PIC S9(0004) COMP.
  1256     05  TOAGE5F PIC  X(0001).
  1257     05  FILLER REDEFINES TOAGE5F.
  1258         10  TOAGE5A PIC  X(0001).
  1259     05  TOAGE5I PIC  X(0002).
  1260*    -------------------------------
  1261     05  TOTERM5L PIC S9(0004) COMP.
  1262     05  TOTERM5F PIC  X(0001).
  1263     05  FILLER REDEFINES TOTERM5F.
  1264         10  TOTERM5A PIC  X(0001).
  1265     05  TOTERM5I PIC  X(0003).
  1266*    -------------------------------
  1267     05  MONBEN5L PIC S9(0004) COMP.
  1268     05  MONBEN5F PIC  X(0001).
  1269     05  FILLER REDEFINES MONBEN5F.
  1270         10  MONBEN5A PIC  X(0001).
  1271     05  MONBEN5I PIC  X(0006).
  1272*    -------------------------------
  1273     05  TOTBEN5L PIC S9(0004) COMP.
  1274     05  TOTBEN5F PIC  X(0001).
  1275     05  FILLER REDEFINES TOTBEN5F.
  1276         10  TOTBEN5A PIC  X(0001).
  1277     05  TOTBEN5I PIC  X(0009).
  1278*    -------------------------------
  1279     05  TOAGE6L PIC S9(0004) COMP.
  1280     05  TOAGE6F PIC  X(0001).
  1281     05  FILLER REDEFINES TOAGE6F.
  1282         10  TOAGE6A PIC  X(0001).
  1283     05  TOAGE6I PIC  X(0002).
  1284*    -------------------------------
  1285     05  TOTERM6L PIC S9(0004) COMP.
  1286     05  TOTERM6F PIC  X(0001).
  1287     05  FILLER REDEFINES TOTERM6F.
  1288         10  TOTERM6A PIC  X(0001).
  1289     05  TOTERM6I PIC  X(0003).
  1290*    -------------------------------
  1291     05  MONBEN6L PIC S9(0004) COMP.
  1292     05  MONBEN6F PIC  X(0001).
  1293     05  FILLER REDEFINES MONBEN6F.
  1294         10  MONBEN6A PIC  X(0001).
  1295     05  MONBEN6I PIC  X(0006).
  1296*    -------------------------------
  1297     05  TOTBEN6L PIC S9(0004) COMP.
  1298     05  TOTBEN6F PIC  X(0001).
  1299     05  FILLER REDEFINES TOTBEN6F.
  1300         10  TOTBEN6A PIC  X(0001).
  1301     05  TOTBEN6I PIC  X(0009).
  1302*    -------------------------------
  1303     05  TOAGE7L PIC S9(0004) COMP.
  1304     05  TOAGE7F PIC  X(0001).
  1305     05  FILLER REDEFINES TOAGE7F.
  1306         10  TOAGE7A PIC  X(0001).
  1307     05  TOAGE7I PIC  X(0002).
  1308*    -------------------------------
  1309     05  TOTERM7L PIC S9(0004) COMP.
  1310     05  TOTERM7F PIC  X(0001).
  1311     05  FILLER REDEFINES TOTERM7F.
  1312         10  TOTERM7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  29
* EL6561.cbl
  1313     05  TOTERM7I PIC  X(0003).
  1314*    -------------------------------
  1315     05  MONBEN7L PIC S9(0004) COMP.
  1316     05  MONBEN7F PIC  X(0001).
  1317     05  FILLER REDEFINES MONBEN7F.
  1318         10  MONBEN7A PIC  X(0001).
  1319     05  MONBEN7I PIC  X(0006).
  1320*    -------------------------------
  1321     05  TOTBEN7L PIC S9(0004) COMP.
  1322     05  TOTBEN7F PIC  X(0001).
  1323     05  FILLER REDEFINES TOTBEN7F.
  1324         10  TOTBEN7A PIC  X(0001).
  1325     05  TOTBEN7I PIC  X(0009).
  1326*    -------------------------------
  1327     05  TOAGE8L PIC S9(0004) COMP.
  1328     05  TOAGE8F PIC  X(0001).
  1329     05  FILLER REDEFINES TOAGE8F.
  1330         10  TOAGE8A PIC  X(0001).
  1331     05  TOAGE8I PIC  X(0002).
  1332*    -------------------------------
  1333     05  TOTERM8L PIC S9(0004) COMP.
  1334     05  TOTERM8F PIC  X(0001).
  1335     05  FILLER REDEFINES TOTERM8F.
  1336         10  TOTERM8A PIC  X(0001).
  1337     05  TOTERM8I PIC  X(0003).
  1338*    -------------------------------
  1339     05  MONBEN8L PIC S9(0004) COMP.
  1340     05  MONBEN8F PIC  X(0001).
  1341     05  FILLER REDEFINES MONBEN8F.
  1342         10  MONBEN8A PIC  X(0001).
  1343     05  MONBEN8I PIC  X(0006).
  1344*    -------------------------------
  1345     05  TOTBEN8L PIC S9(0004) COMP.
  1346     05  TOTBEN8F PIC  X(0001).
  1347     05  FILLER REDEFINES TOTBEN8F.
  1348         10  TOTBEN8A PIC  X(0001).
  1349     05  TOTBEN8I PIC  X(0009).
  1350*    -------------------------------
  1351     05  ERRMSG1L PIC S9(0004) COMP.
  1352     05  ERRMSG1F PIC  X(0001).
  1353     05  FILLER REDEFINES ERRMSG1F.
  1354         10  ERRMSG1A PIC  X(0001).
  1355     05  ERRMSG1I PIC  X(0072).
  1356*    -------------------------------
  1357     05  PFENTERL PIC S9(0004) COMP.
  1358     05  PFENTERF PIC  X(0001).
  1359     05  FILLER REDEFINES PFENTERF.
  1360         10  PFENTERA PIC  X(0001).
  1361     05  PFENTERI PIC  9(2).
  1362 01  EL6561AO REDEFINES EL6561AI.
  1363     05  FILLER            PIC  X(0012).
  1364*    -------------------------------
  1365     05  FILLER            PIC  X(0003).
  1366     05  RUNDATEO PIC  X(0008).
  1367*    -------------------------------
  1368     05  FILLER            PIC  X(0003).
  1369     05  RUNTIMEO PIC  99.99.
  1370*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  30
* EL6561.cbl
  1371     05  FILLER            PIC  X(0003).
  1372     05  LIMITSO PIC  X(0006).
  1373*    -------------------------------
  1374     05  FILLER            PIC  X(0003).
  1375     05  STATEO PIC  X(0002).
  1376*    -------------------------------
  1377     05  FILLER            PIC  X(0003).
  1378     05  CLASSO PIC  X(0002).
  1379*    -------------------------------
  1380     05  FILLER            PIC  X(0003).
  1381     05  DEVO PIC  X(0003).
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(0003).
  1384     05  PLANCODO PIC  X(0002).
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(0003).
  1387     05  COVERO PIC  X(0001).
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(0003).
  1390     05  RTAGEO PIC  99.
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(0003).
  1393     05  EXPIREO PIC  X(0006).
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  AMOUNTO PIC  ZZZ,999.
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
  1399     05  MORTDO PIC  X(0017).
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  MORTO PIC  X(0004).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  DISOPTO PIC  X(0001).
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  COMPRTO PIC  ZZ.99999.
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  DAYRTDO PIC  X(0012).
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  DAYRTO PIC  ZZ.99999.
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  DISRATO PIC  ZZ.99999.
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  CANFEEO PIC  ZZZ.99.
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  MAXAGEO PIC  X(0002).
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
  1426     05  OBRATEO PIC  ZZ.99999.
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  31
* EL6561.cbl
  1429     05  MAXDO PIC  X(0015).
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  TOAGE1O PIC  X(0002).
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  TOTERM1O PIC  X(0003).
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  MONBEN1O PIC  X(0006).
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  TOTBEN1O PIC  X(0009).
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  TOAGE2O PIC  X(0002).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  TOTERM2O PIC  X(0003).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  MONBEN2O PIC  X(0006).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  TOTBEN2O PIC  X(0009).
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  TOAGE3O PIC  X(0002).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  TOTERM3O PIC  X(0003).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  MONBEN3O PIC  X(0006).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  TOTBEN3O PIC  X(0009).
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  TOAGE4O PIC  X(0002).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  TOTERM4O PIC  X(0003).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  MONBEN4O PIC  X(0006).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  TOTBEN4O PIC  X(0009).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  TOAGE5O PIC  X(0002).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  TOTERM5O PIC  X(0003).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  MONBEN5O PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  32
* EL6561.cbl
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  TOTBEN5O PIC  X(0009).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  TOAGE6O PIC  X(0002).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  TOTERM6O PIC  X(0003).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  MONBEN6O PIC  X(0006).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  TOTBEN6O PIC  X(0009).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  TOAGE7O PIC  X(0002).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  TOTERM7O PIC  X(0003).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  MONBEN7O PIC  X(0006).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  TOTBEN7O PIC  X(0009).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  TOAGE8O PIC  X(0002).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  TOTERM8O PIC  X(0003).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  MONBEN8O PIC  X(0006).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  TOTBEN8O PIC  X(0009).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  ERRMSG1O PIC  X(0072).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  PFENTERO PIC  99.
  1532*    -------------------------------
  1533
  1534 01  FILLER-R    REDEFINES EL6561AI.
  1535     05  FILLER             PIC X(195).
  1536     05  filler             pic x(16).
  1537     05  SCREEN-TABLE       OCCURS 8 TIMES
  1538                            INDEXED BY ST-INDX.
  1539         10  RATE-TO-AGE-L  PIC S9(4)         COMP.
  1540         10  RATE-TO-AGE-A  PIC X.
  1541         10  RATE-TO-AGE    PIC 99.
  1542
  1543         10  RATE-TO-TRM-L  PIC S9(4)         COMP.
  1544         10  RATE-TO-TRM-A  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  33
* EL6561.cbl
  1545         10  RATE-TO-TRM    PIC 999.
  1546
  1547         10  RATE-MO-BEN-L  PIC S9(4)         COMP.
  1548         10  RATE-MO-BEN-A  PIC X.
  1549         10  RATE-MO-BEN    PIC 9(6).
  1550         10  RATE-MO-BEN1   REDEFINES
  1551             RATE-MO-BEN    PIC ZZ,ZZZ.
  1552
  1553         10  RATE-TO-BEN-L  PIC S9(4)         COMP.
  1554         10  RATE-TO-BEN-A  PIC X.
  1555         10  RATE-TO-BEN    PIC 9(9).
  1556         10  RATE-TO-BEN1   REDEFINES
  1557             RATE-TO-BEN    PIC Z,ZZZ,ZZZ.
  1558     05  FILLER             PIC X(75).
  1559
  1560     05  FILLER             PIC X(5).
  1561
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  34
* EL6561.cbl
  1563
  1564****************************************************************
  1565*
  1566* Copyright (c) 2007 by Clerity Solutions, Inc.
  1567* All rights reserved.
  1568*
  1569****************************************************************
  1570 01  DFHEIV.
  1571   02  DFHEIV0               PIC X(35).
  1572   02  DFHEIV1               PIC X(08).
  1573   02  DFHEIV2               PIC X(08).
  1574   02  DFHEIV3               PIC X(08).
  1575   02  DFHEIV4               PIC X(06).
  1576   02  DFHEIV5               PIC X(04).
  1577   02  DFHEIV6               PIC X(04).
  1578   02  DFHEIV7               PIC X(02).
  1579   02  DFHEIV8               PIC X(02).
  1580   02  DFHEIV9               PIC X(01).
  1581   02  DFHEIV10              PIC S9(7) COMP-3.
  1582   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1583   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1584   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1585   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1586   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1587   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1588   02  DFHEIV17              PIC X(04).
  1589   02  DFHEIV18              PIC X(04).
  1590   02  DFHEIV19              PIC X(04).
  1591   02  DFHEIV20              USAGE IS POINTER.
  1592   02  DFHEIV21              USAGE IS POINTER.
  1593   02  DFHEIV22              USAGE IS POINTER.
  1594   02  DFHEIV23              USAGE IS POINTER.
  1595   02  DFHEIV24              USAGE IS POINTER.
  1596   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1597   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1598   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1599   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1600   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1601   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1602   02  FILLER                PIC X(02).
  1603   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1604   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1605   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1606   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1607   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1608 LINKAGE  SECTION.
  1609*****************************************************************
  1610*                                                               *
  1611* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1612* All rights reserved.                                          *
  1613*                                                               *
  1614*****************************************************************
  1615 01  dfheiblk.
  1616     02  eibtime          pic s9(7) comp-3.
  1617     02  eibdate          pic s9(7) comp-3.
  1618     02  eibtrnid         pic x(4).
  1619     02  eibtaskn         pic s9(7) comp-3.
  1620     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  35
* EL6561.cbl
  1621     02  dfheigdi         pic s9(4) comp.
  1622     02  eibcposn         pic s9(4) comp.
  1623     02  eibcalen         pic s9(4) comp.
  1624     02  eibaid           pic x(1).
  1625     02  eibfiller1       pic x(1).
  1626     02  eibfn            pic x(2).
  1627     02  eibfiller2       pic x(2).
  1628     02  eibrcode         pic x(6).
  1629     02  eibfiller3       pic x(2).
  1630     02  eibds            pic x(8).
  1631     02  eibreqid         pic x(8).
  1632     02  eibrsrce         pic x(8).
  1633     02  eibsync          pic x(1).
  1634     02  eibfree          pic x(1).
  1635     02  eibrecv          pic x(1).
  1636     02  eibsend          pic x(1).
  1637     02  eibatt           pic x(1).
  1638     02  eibeoc           pic x(1).
  1639     02  eibfmh           pic x(1).
  1640     02  eibcompl         pic x(1).
  1641     02  eibsig           pic x(1).
  1642     02  eibconf          pic x(1).
  1643     02  eiberr           pic x(1).
  1644     02  eibrldbk         pic x(1).
  1645     02  eiberrcd         pic x(4).
  1646     02  eibsynrb         pic x(1).
  1647     02  eibnodat         pic x(1).
  1648     02  eibfiller5       pic x(2).
  1649     02  eibresp          pic 9(09) comp.
  1650     02  eibresp2         pic 9(09) comp.
  1651     02  dfheigdj         pic s9(4) comp.
  1652     02  dfheigdk         pic s9(4) comp.
  1653
  1654 01  DFHCOMMAREA             PIC X(1024).
  1655
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  36
* EL6561.cbl
  1657*                            COPY ERCRATE.
  1658******************************************************************
  1659*                                                                *
  1660*                                                                *
  1661*                            ERCRATE                             *
  1662*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1663*                            VMOD=2.008                          *
  1664*                                                                *
  1665*   ONLINE CREDIT SYSTEM                                         *
  1666*                                                                *
  1667*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1668*                                                                *
  1669*   FILE TYPE = VSAM,KSDS                                        *
  1670*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1671*                                                                *
  1672*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1673*       ALTERNATE PATH = NONE                                    *
  1674*                                                                *
  1675*   LOG = NO                                                     *
  1676*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1677*                                                                *
  1678******************************************************************
  1679******************************************************************
  1680*                   C H A N G E   L O G
  1681*
  1682* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1683*-----------------------------------------------------------------
  1684*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1685* EFFECTIVE    NUMBER
  1686*-----------------------------------------------------------------
  1687* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1688******************************************************************
  1689
  1690 01  RATE-RECORD.
  1691     12  RT-RECORD-ID                      PIC XX.
  1692         88  VALID-RT-ID                      VALUE 'RT'.
  1693
  1694     12  RT-CONTROL-PRIMARY.
  1695         16  RT-COMPANY-CD                 PIC X.
  1696         16  RT-STATE-CODE.
  1697             20  RT-ST-CODE                PIC XX.
  1698             20  RT-ST-CLASS               PIC XX.
  1699             20  RT-ST-DEV                 PIC XXX.
  1700         16  RT-L-AH-CODE.
  1701             20  RT-L-AH                   PIC X.
  1702             20  RT-LAH-NUM                PIC XX.
  1703         16  RT-LIMITS.
  1704             20  RT-HIGH-AGE               PIC 99.
  1705             20  RT-HIGH-AMT               PIC 9(6).
  1706             20  RT-FUTURE                 PIC XX.
  1707             20  RT-SEX                    PIC X.
  1708         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1709
  1710     12  RT-MAINT-INFORMATION.
  1711         16  RT-LAST-MAINT-DT              PIC XX.
  1712         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1713         16  RT-LAST-MAINT-USER            PIC X(4).
  1714         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  37
* EL6561.cbl
  1715
  1716     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1717     12  RT-RATE-COMMENT                   PIC X(50).
  1718
  1719     12  CSL-RESERVED                      PIC X(10).
  1720     12  FILLER                            PIC X(12).
  1721
  1722     12  RT-MAX-AGE                        PIC 99.
  1723
  1724     12  RT-LIFE-LIMS-FLDS.
  1725         16  RT-LIFE-MORT-CODE             PIC X(4).
  1726         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1727             20  RT-L-EX-AGE               PIC 99.
  1728             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1729             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1730         16  FILLER                        PIC X(20).
  1731
  1732     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1733         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1734             20  RT-AH-AGE                 PIC 99.
  1735             20  RT-AH-TERM                PIC S999       COMP-3.
  1736             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1737             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1738
  1739     12  RT-LIFE-RATES.
  1740         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1741
  1742     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1743         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1744
  1745     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1746
  1747     12  RT-DISCOUNT-OPTION                PIC X.
  1748         88  RT-DO-NOT-USE                     VALUE ' '.
  1749         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1750         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1751
  1752     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1753     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1754
  1755     12  RT-COMPOSITE-OPTION               PIC X.
  1756         88  RT-NO-COMPOSITE                   VALUE ' '.
  1757         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1758
  1759     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1760
  1761     12  RT-CANCEL-FEE                     PIC S9(3)V99   COMP-3.
  1762     12  FILLER                            PIC X(13).
  1763
  1764     12  RT-TYPE-RATE                      PIC X.
  1765         88  RT-IS-STND                        VALUE ' ' 'S'.
  1766         88  RT-IS-OB                          VALUE 'O'.
  1767
  1768     12  RT-SRT-ALPHA                      PIC X.
  1769
  1770     12  RT-CONTROL-2.
  1771         16  RTC-1                         PIC X(7).
  1772         16  RTC-3                         PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  38
* EL6561.cbl
  1773         16  RTC-4                         PIC 9(11) COMP-3.
  1774         16  RTC-2                         PIC X(3).
  1775******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  39
* EL6561.cbl
  1777*                            COPY ELCCNTL.
  1778******************************************************************
  1779*                                                                *
  1780*                                                                *
  1781*                            ELCCNTL.                            *
  1782*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1783*                            VMOD=2.059                          *
  1784*                                                                *
  1785*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1786*                                                                *
  1787*   FILE TYPE = VSAM,KSDS                                        *
  1788*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1789*                                                                *
  1790*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1791*       ALTERNATE INDEX = NONE                                   *
  1792*                                                                *
  1793*   LOG = YES                                                    *
  1794*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1795******************************************************************
  1796*                   C H A N G E   L O G
  1797*
  1798* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1799*-----------------------------------------------------------------
  1800*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1801* EFFECTIVE    NUMBER
  1802*-----------------------------------------------------------------
  1803* 082503                   PEMA  ADD BENEFIT GROUP
  1804* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1805* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1806* 092705    2005050300006  PEMA  ADD SPP LEASES
  1807* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1808* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1809* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1810* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1811* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1812* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1813* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1814* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1815* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1816* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1817******************************************************************
  1818*
  1819 01  CONTROL-FILE.
  1820     12  CF-RECORD-ID                       PIC XX.
  1821         88  VALID-CF-ID                        VALUE 'CF'.
  1822
  1823     12  CF-CONTROL-PRIMARY.
  1824         16  CF-COMPANY-ID                  PIC XXX.
  1825         16  CF-RECORD-TYPE                 PIC X.
  1826             88  CF-COMPANY-MASTER              VALUE '1'.
  1827             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1828             88  CF-STATE-MASTER                VALUE '3'.
  1829             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1830             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1831             88  CF-CARRIER-MASTER              VALUE '6'.
  1832             88  CF-MORTALITY-MASTER            VALUE '7'.
  1833             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1834             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  40
* EL6561.cbl
  1835             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1836             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1837             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1838             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1839             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1840             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1841             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1842             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1843             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1844         16  CF-ACCESS-CD-GENL              PIC X(4).
  1845         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1846             20  CF-PROCESSOR               PIC X(4).
  1847         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1848             20  CF-STATE-CODE              PIC XX.
  1849             20  FILLER                     PIC XX.
  1850         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1851             20  FILLER                     PIC XX.
  1852             20  CF-HI-BEN-IN-REC           PIC XX.
  1853         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1854             20  FILLER                     PIC XXX.
  1855             20  CF-CARRIER-CNTL            PIC X.
  1856         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1857             20  FILLER                     PIC XX.
  1858             20  CF-HI-TYPE-IN-REC          PIC 99.
  1859         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1860             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1861                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1862             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1863             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1864         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1865             20  FILLER                     PIC X.
  1866             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1867         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1868             20  FILLER                     PIC XX.
  1869             20  CF-MORTGAGE-PLAN           PIC XX.
  1870         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1871
  1872     12  CF-LAST-MAINT-DT                   PIC XX.
  1873     12  CF-LAST-MAINT-BY                   PIC X(4).
  1874     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1875
  1876     12  CF-RECORD-BODY                     PIC X(728).
  1877
  1878
  1879****************************************************************
  1880*             COMPANY MASTER RECORD                            *
  1881****************************************************************
  1882
  1883     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1884         16  CF-COMPANY-ADDRESS.
  1885             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1886             20  CF-CL-IN-CARE-OF           PIC X(30).
  1887             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1888             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1889             20  CF-CL-CITY-STATE           PIC X(30).
  1890             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1891             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1892         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  41
* EL6561.cbl
  1893         16  CF-COMPANY-PASSWORD            PIC X(8).
  1894         16  CF-SECURITY-OPTION             PIC X.
  1895             88  ALL-SECURITY                   VALUE '1'.
  1896             88  COMPANY-VERIFY                 VALUE '2'.
  1897             88  PROCESSOR-VERIFY               VALUE '3'.
  1898             88  NO-SECURITY                    VALUE '4'.
  1899             88  ALL-BUT-TERM                   VALUE '5'.
  1900         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1901             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1902         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1903             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1904         16  CF-INFORCE-LOCATION            PIC X.
  1905             88  CERTS-ARE-ONLINE               VALUE '1'.
  1906             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1907             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1908         16  CF-LOWER-CASE-LETTERS          PIC X.
  1909         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1910             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1911             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1912             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1913             88  CF-ACCNT-CNTL                  VALUE '3'.
  1914             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1915
  1916         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1917         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1918
  1919         16  CF-LGX-CREDIT-USER             PIC X.
  1920             88  CO-IS-NOT-USER                 VALUE 'N'.
  1921             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1922
  1923         16 CF-CREDIT-CALC-CODES.
  1924             20  CF-CR-REM-TERM-CALC PIC X.
  1925               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1926               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1927               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1928               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1929               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1930               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1931               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1932             20  CF-CR-R78-METHOD           PIC X.
  1933               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1934               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1935
  1936         16  CF-CLAIM-CONTROL-COUNTS.
  1937             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1938                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1939
  1940             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1941                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1942
  1943             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1944                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1945
  1946             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1947                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1948
  1949         16  CF-CURRENT-MONTH-END           PIC XX.
  1950
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  42
* EL6561.cbl
  1951         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1952             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1953             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1954             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1955             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1956                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1957                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1958             20  CF-CO-PREM-REJECT-SW       PIC X.
  1959                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1960                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1961             20  CF-CO-REF-REJECT-SW        PIC X.
  1962                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1963                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1964
  1965         16  CF-CO-REPORTING-DT             PIC XX.
  1966         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1967         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1968           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1969           88  CF-CO-MONTH-END                  VALUE '1'.
  1970
  1971         16  CF-LGX-CLAIM-USER              PIC X.
  1972             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1973             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1974
  1975         16  CF-CREDIT-EDIT-CONTROLS.
  1976             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1977             20  CF-MIN-AGE                 PIC 99.
  1978             20  CF-DEFAULT-AGE             PIC 99.
  1979             20  CF-MIN-TERM                PIC S999      COMP-3.
  1980             20  CF-MAX-TERM                PIC S999      COMP-3.
  1981             20  CF-DEFAULT-SEX             PIC X.
  1982             20  CF-JOINT-AGE-INPUT         PIC X.
  1983                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1984             20  CF-BIRTH-DATE-INPUT        PIC X.
  1985                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1986             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1987                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1988                 88  CF-ZERO-CARRIER            VALUE '1'.
  1989                 88  CF-ZERO-GROUPING           VALUE '2'.
  1990                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1991             20  CF-EDIT-SW                 PIC X.
  1992                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1993             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1994             20  CF-CR-PR-METHOD            PIC X.
  1995               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1996               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1997             20  FILLER                     PIC X.
  1998
  1999         16  CF-CREDIT-MISC-CONTROLS.
  2000             20  CF-REIN-TABLE-SW           PIC X.
  2001                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2002             20  CF-COMP-TABLE-SW           PIC X.
  2003                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2004             20  CF-EXPERIENCE-RETENTION-AGE
  2005                                            PIC S9        COMP-3.
  2006             20  CF-CONVERSION-DT           PIC XX.
  2007             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2008             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  43
* EL6561.cbl
  2009                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2010                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2011
  2012             20  CF-CR-CHECK-NO-CONTROL.
  2013                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2014                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2015                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2016                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2017                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2018                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2019
  2020                 24  CF-CR-CHECK-COUNT       REDEFINES
  2021                     CF-CR-CHECK-COUNTER      PIC X(4).
  2022
  2023                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2024                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2025
  2026                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2027                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2028                 24  CF-MAIL-PROCESSING       PIC X.
  2029                     88  MAIL-PROCESSING          VALUE 'Y'.
  2030
  2031         16  CF-MISC-SYSTEM-CONTROL.
  2032             20  CF-SYSTEM-C                 PIC X.
  2033                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2034             20  CF-SYSTEM-D                 PIC X.
  2035                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2036             20  CF-SOC-SEC-NO-SW            PIC X.
  2037                 88  SOC-SEC-NO-USED             VALUE '1'.
  2038             20  CF-MEMBER-NO-SW             PIC X.
  2039                 88  MEMBER-NO-USED              VALUE '1'.
  2040             20  CF-TAX-ID-NUMBER            PIC X(11).
  2041             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2042             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2043                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2044                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2045                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2046                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2047             20  CF-SYSTEM-E                 PIC X.
  2048                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2049
  2050         16  CF-LGX-LIFE-USER               PIC X.
  2051             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2052             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2053
  2054         16  CF-CR-MONTH-END-DT             PIC XX.
  2055
  2056         16  CF-FILE-MAINT-DATES.
  2057             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2058                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2059             20  CF-LAST-BATCH       REDEFINES
  2060                 CF-LAST-BATCH-NO               PIC X(4).
  2061             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2062             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2063             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2064             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2065             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2066             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  44
* EL6561.cbl
  2067             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2068             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2069             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2070             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2071
  2072         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2073         16  FILLER                         PIC X.
  2074
  2075         16  CF-ALT-MORT-CODE               PIC X(4).
  2076         16  CF-MEMBER-CAPTION              PIC X(10).
  2077
  2078         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2079             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2080             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2081             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2082             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2083             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2084
  2085         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2086
  2087         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2088         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2089         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2090         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2091
  2092         16  CF-AH-OVERRIDE-L1              PIC X.
  2093         16  CF-AH-OVERRIDE-L2              PIC XX.
  2094         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2095         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2096
  2097         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2098         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2099
  2100         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2101         16  CF-AR-LAST-EL860-DT            PIC XX.
  2102         16  CF-MP-MONTH-END-DT             PIC XX.
  2103
  2104         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2105         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2106             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2107
  2108         16  CF-AR-MONTH-END-DT             PIC XX.
  2109
  2110         16  CF-CRDTCRD-USER                PIC X.
  2111             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2112             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2113
  2114         16  CF-CC-MONTH-END-DT             PIC XX.
  2115
  2116         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2117
  2118         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2119             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2120             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2121             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2122         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2123         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2124         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  45
* EL6561.cbl
  2125         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2126             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2127             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2128         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2129         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2130         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2131             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2132         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2133
  2134         16  CF-CL-ZIP-CODE.
  2135             20  CF-CL-ZIP-PRIME.
  2136                 24  CF-CL-ZIP-1ST          PIC X.
  2137                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2138                 24  FILLER                 PIC X(4).
  2139             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2140         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2141             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2142             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2143             20  FILLER                     PIC XXX.
  2144
  2145         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2146         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2147         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2148         16  CF-CO-OPTION-START-DATE        PIC XX.
  2149         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2150           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2151                                                      '3' '4'.
  2152           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2153           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2154           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2155           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2156           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2157           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2158
  2159         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2160
  2161         16  CF-PAYMENT-APPROVAL-LEVELS.
  2162             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2163             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2164             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2165             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2166             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2167             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2168
  2169         16  CF-END-USER-REPORTING-USER     PIC X.
  2170             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2171             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2172
  2173         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2174             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2175             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2176
  2177         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2178
  2179         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2180         16  FILLER                         PIC X.
  2181
  2182         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  46
* EL6561.cbl
  2183             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2184             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2185             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2186
  2187         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2188
  2189         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2190             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2191             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2192
  2193         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2194             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2195             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2196
  2197         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2198
  2199         16  CF-CO-ACH-ID-CODE              PIC  X.
  2200             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2201             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2202             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2203         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2204         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2205         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2206         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2207         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2208         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2209         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2210         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2211         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2212                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2213         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2214                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2215
  2216         16  CF-CO-OVER-SHORT.
  2217             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2218             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2219
  2220*         16  FILLER                         PIC X(102).
  2221         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2222             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2223             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2224
  2225         16  CF-AH-APPROVAL-DAYS.
  2226             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2227             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2228             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2229             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2230
  2231         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2232
  2233         16  CF-APPROV-LEV-5.
  2234             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2235             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2236             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2237
  2238         16  FILLER                         PIC X(68).
  2239****************************************************************
  2240*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  47
* EL6561.cbl
  2241****************************************************************
  2242
  2243     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2244         16  CF-PROCESSOR-NAME              PIC X(30).
  2245         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2246         16  CF-PROCESSOR-TITLE             PIC X(26).
  2247         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2248                 88  MESSAGE-YES                VALUE 'Y'.
  2249                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2250
  2251*****************************************************
  2252****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2253****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2254****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2255****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2256*****************************************************
  2257
  2258         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2259             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2260             20  CF-APPLICATION-FORCE       PIC X.
  2261             20  CF-INDIVIDUAL-APP.
  2262                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2263                     28  CF-BROWSE-APP      PIC X.
  2264                     28  CF-UPDATE-APP      PIC X.
  2265
  2266         16  CF-CURRENT-TERM-ON             PIC X(4).
  2267         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2268             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2269             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2270             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2271             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2272             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2273             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2274             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2275         16  CF-PROCESSOR-CARRIER           PIC X.
  2276             88  NO-CARRIER-SECURITY            VALUE ' '.
  2277         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2278             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2279         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2280             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2281         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2282             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2283
  2284         16  CF-PROC-SYS-ACCESS-SW.
  2285             20  CF-PROC-CREDIT-CLAIMS-SW.
  2286                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2287                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2288                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2289                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2290             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2291                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2292                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2293             20  CF-PROC-LIFE-GNRLDGR-SW.
  2294                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2295                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2296                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2297                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2298             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  48
* EL6561.cbl
  2299                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2300                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2301         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2302             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2303             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2304         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2305
  2306         16  CF-APPROVAL-LEVEL                  PIC X.
  2307             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2308             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2309             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2310             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2311             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2312
  2313         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2314
  2315         16  CF-LANGUAGE-TYPE                   PIC X.
  2316             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2317             88  CF-LANG-IS-FR                      VALUE 'F'.
  2318
  2319         16  CF-CSR-IND                         PIC X.
  2320         16  FILLER                             PIC X(239).
  2321
  2322****************************************************************
  2323*             PROCESSOR/REMINDERS RECORD                       *
  2324****************************************************************
  2325
  2326     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2327         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2328             20  CF-START-REMIND-DT         PIC XX.
  2329             20  CF-END-REMIND-DT           PIC XX.
  2330             20  CF-REMINDER-TEXT           PIC X(50).
  2331         16  FILLER                         PIC X(296).
  2332
  2333
  2334****************************************************************
  2335*             STATE MASTER RECORD                              *
  2336****************************************************************
  2337
  2338     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2339         16  CF-STATE-ABBREVIATION          PIC XX.
  2340         16  CF-STATE-NAME                  PIC X(25).
  2341         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2342         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2343             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2344             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2345             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2346             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2347                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2348                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2349             20  CF-ST-PREM-REJECT-SW       PIC X.
  2350                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2351                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2352             20  CF-ST-REF-REJECT-SW        PIC X.
  2353                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2354                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2355         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2356         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  49
* EL6561.cbl
  2357         16  CF-ST-REFUND-RULES.
  2358             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2359             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2360             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2361         16  CF-ST-FST-PMT-EXTENSION.
  2362             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2363             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2364                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2365                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2366                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2367                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2368         16  CF-ST-STATE-CALL.
  2369             20  CF-ST-CALL-UNEARNED        PIC X.
  2370             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2371             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2372         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2373             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2374             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2375         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2376         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2377         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2378         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2379         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2380         16  FILLER                         PIC X.
  2381         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2382             20  CF-ST-BENEFIT-CD           PIC XX.
  2383             20  CF-ST-BENEFIT-KIND         PIC X.
  2384                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2385                 88  CF-ST-AH-KIND              VALUE 'A'.
  2386             20  CF-ST-REM-TERM-CALC        PIC X.
  2387                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2388                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2389                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2390                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2391                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2392                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2393                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2394                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2395
  2396             20  CF-ST-REFUND-CALC          PIC X.
  2397                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2398                 88  ST-REFD-BY-R78             VALUE '1'.
  2399                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2400                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2401                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2402                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2403                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2404                 88  ST-REFD-UTAH               VALUE '7'.
  2405                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2406                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2407                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2408
  2409             20  CF-ST-EARNING-CALC         PIC X.
  2410                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2411                 88  ST-EARN-BY-R78             VALUE '1'.
  2412                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2413                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2414                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  50
* EL6561.cbl
  2415                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2416                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2417                 88  ST-EARN-MEAN               VALUE '8'.
  2418                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2419
  2420             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2421                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2422                 88  ST-OVRD-BY-R78             VALUE '1'.
  2423                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2424                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2425                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2426                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2427                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2428                 88  ST-OVRD-MEAN               VALUE '8'.
  2429                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2430             20  cf-st-extra-periods        pic 9.
  2431*            20  FILLER                     PIC X.
  2432
  2433         16  CF-ST-COMMISSION-CAPS.
  2434             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2435             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2436             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2437             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2438         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2439                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2440
  2441         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2442
  2443         16  CF-ST-STATUTORY-INTEREST.
  2444             20  CF-ST-STAT-DATE-FROM       PIC X.
  2445                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2446                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2447             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2448             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2449             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2450             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2451             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2452
  2453         16  CF-ST-OVER-SHORT.
  2454             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2455             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2456
  2457         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2458
  2459         16  CF-ST-RT-CALC                  PIC X.
  2460
  2461         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2462         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2463         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2464         16  CF-ST-RF-LR-CALC               PIC X.
  2465         16  CF-ST-RF-LL-CALC               PIC X.
  2466         16  CF-ST-RF-LN-CALC               PIC X.
  2467         16  CF-ST-RF-AH-CALC               PIC X.
  2468         16  CF-ST-RF-CP-CALC               PIC X.
  2469*        16  FILLER                         PIC X(206).
  2470*CIDMOD         16  FILLER                         PIC X(192).
  2471         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2472             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  51
* EL6561.cbl
  2473         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2474         16  CF-ST-VFY-2ND-BENE             PIC X.
  2475         16  CF-ST-CAUSAL-STATE             PIC X.
  2476         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2477         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2478         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2479             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2480         16  CF-ST-NET-ONLY-STATE           PIC X.
  2481             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2482         16  FILLER                         PIC X(181).
  2483
  2484****************************************************************
  2485*             BENEFIT MASTER RECORD                            *
  2486****************************************************************
  2487
  2488     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2489         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2490             20  CF-BENEFIT-CODE            PIC XX.
  2491             20  CF-BENEFIT-NUMERIC  REDEFINES
  2492                 CF-BENEFIT-CODE            PIC XX.
  2493             20  CF-BENEFIT-ALPHA           PIC XXX.
  2494             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2495             20  CF-BENEFIT-COMMENT         PIC X(10).
  2496
  2497             20  CF-LF-COVERAGE-TYPE        PIC X.
  2498                 88  CF-REDUCING                VALUE 'R'.
  2499                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2500
  2501             20  CF-SPECIAL-CALC-CD         PIC X.
  2502                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2503                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2504                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2505                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2506                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2507                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2508                 88  CF-FARM-PLAN               VALUE 'F'.
  2509                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2510                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2511                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2512                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2513                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2514                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2515                 88  CF-PRUDENTIAL              VALUE 'P'.
  2516                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2517                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2518                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2519                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2520                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2521                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2522
  2523             20  CF-JOINT-INDICATOR         PIC X.
  2524                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2525
  2526*            20  FILLER                     PIC X(12).
  2527             20  cf-maximum-benefits        pic s999 comp-3.
  2528             20  FILLER                     PIC X(09).
  2529             20  CF-BENEFIT-CATEGORY        PIC X.
  2530             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  52
* EL6561.cbl
  2531
  2532             20  CF-CO-REM-TERM-CALC        PIC X.
  2533                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2534                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2535                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2536                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2537                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2538
  2539             20  CF-CO-EARNINGS-CALC        PIC X.
  2540                 88  CO-EARN-BY-R78             VALUE '1'.
  2541                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2542                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2543                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2544                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2545                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2546                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2547                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2548
  2549             20  CF-CO-REFUND-CALC          PIC X.
  2550                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2551                 88  CO-REFD-BY-R78             VALUE '1'.
  2552                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2553                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2554                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2555                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2556                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2557                 88  CO-REFD-MEAN               VALUE '8'.
  2558                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2559                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2560                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2561
  2562             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2563                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2564                 88  CO-OVRD-BY-R78             VALUE '1'.
  2565                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2566                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2567                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2568                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2569                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2570                 88  CO-OVRD-MEAN               VALUE '8'.
  2571                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2572
  2573             20  CF-CO-BEN-I-G-CD           PIC X.
  2574                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2575                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2576                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2577
  2578         16  FILLER                         PIC X(304).
  2579
  2580
  2581****************************************************************
  2582*             CARRIER MASTER RECORD                            *
  2583****************************************************************
  2584
  2585     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2586         16  CF-ADDRESS-DATA.
  2587             20  CF-MAIL-TO-NAME            PIC X(30).
  2588             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  53
* EL6561.cbl
  2589             20  CF-ADDRESS-LINE-1          PIC X(30).
  2590             20  CF-ADDRESS-LINE-2          PIC X(30).
  2591             20  CF-CITY-STATE              PIC X(30).
  2592             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2593             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2594
  2595         16  CF-CLAIM-NO-CONTROL.
  2596             20  CF-CLAIM-NO-METHOD         PIC X.
  2597                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2598                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2599                 88  CLAIM-NO-SEQ               VALUE '3'.
  2600                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2601             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2602                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2603                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2604                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2605
  2606         16  CF-CHECK-NO-CONTROL.
  2607             20  CF-CHECK-NO-METHOD         PIC X.
  2608                 88  CHECK-NO-MANUAL            VALUE '1'.
  2609                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2610                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2611                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2612             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2613                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2614
  2615         16  CF-DOMICILE-STATE              PIC XX.
  2616
  2617         16  CF-EXPENSE-CONTROLS.
  2618             20  CF-EXPENSE-METHOD          PIC X.
  2619                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2620                 88  DOLLARS-PER-PMT            VALUE '2'.
  2621                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2622                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2623             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2624             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2625
  2626         16  CF-CORRESPONDENCE-CONTROL.
  2627             20  CF-LETTER-RESEND-OPT       PIC X.
  2628                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2629                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2630             20  FILLER                     PIC X(4).
  2631
  2632         16  CF-RESERVE-CONTROLS.
  2633             20  CF-MANUAL-SW               PIC X.
  2634                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2635             20  CF-FUTURE-SW               PIC X.
  2636                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2637             20  CF-PTC-SW                  PIC X.
  2638                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2639             20  CF-IBNR-SW                 PIC X.
  2640                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2641             20  CF-PTC-LF-SW               PIC X.
  2642                 88  CF-LF-PTC-USED             VALUE '1'.
  2643             20  CF-CDT-ACCESS-METHOD       PIC X.
  2644                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2645                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2646                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  54
* EL6561.cbl
  2647             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2648
  2649         16  CF-CLAIM-CALC-METHOD           PIC X.
  2650             88  360-PLUS-MONTHS                VALUE '1'.
  2651             88  365-PLUS-MONTHS                VALUE '2'.
  2652             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2653             88  360-DAILY                      VALUE '4'.
  2654             88  365-DAILY                      VALUE '5'.
  2655
  2656         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2657         16  FILLER                         PIC X(11).
  2658
  2659         16  CF-LIMIT-AMOUNTS.
  2660             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2661             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2662             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2663             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2664             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2665             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2666             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2667             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2668             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2669             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2670
  2671         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2672         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2673         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2674
  2675         16  CF-ZIP-CODE.
  2676             20  CF-ZIP-PRIME.
  2677                 24  CF-ZIP-1ST             PIC X.
  2678                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2679                 24  FILLER                 PIC X(4).
  2680             20  CF-ZIP-PLUS4               PIC X(4).
  2681         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2682             20  CF-CAN-POSTAL-1            PIC XXX.
  2683             20  CF-CAN-POSTAL-2            PIC XXX.
  2684             20  FILLER                     PIC XXX.
  2685
  2686         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2687         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2688         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2689
  2690         16  CF-RATING-SWITCH               PIC X.
  2691             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2692             88  CF-NO-RATING                   VALUE 'N'.
  2693
  2694         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2695
  2696         16  CF-CARRIER-OVER-SHORT.
  2697             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2698             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2699
  2700         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2701         16  CF-SECPAY-SWITCH               PIC X.
  2702             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2703             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2704         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  55
* EL6561.cbl
  2705         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2706         16  FILLER                         PIC X(444).
  2707*        16  FILLER                         PIC X(452).
  2708
  2709
  2710****************************************************************
  2711*             MORTALITY MASTER RECORD                          *
  2712****************************************************************
  2713
  2714     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2715         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2716                                INDEXED BY CF-MORT-NDX.
  2717             20  CF-MORT-TABLE              PIC X(5).
  2718             20  CF-MORT-TABLE-TYPE         PIC X.
  2719                 88  CF-MORT-JOINT              VALUE 'J'.
  2720                 88  CF-MORT-SINGLE             VALUE 'S'.
  2721                 88  CF-MORT-COMBINED           VALUE 'C'.
  2722                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2723                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2724             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2725             20  CF-MORT-AGE-METHOD         PIC XX.
  2726                 88  CF-AGE-LAST                VALUE 'AL'.
  2727                 88  CF-AGE-NEAR                VALUE 'AN'.
  2728             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2729             20  CF-MORT-ADJUSTMENT-DIRECTION
  2730                                            PIC X.
  2731                 88  CF-MINUS                   VALUE '-'.
  2732                 88  CF-PLUS                    VALUE '+'.
  2733             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2734             20  CF-MORT-JOINT-CODE         PIC X.
  2735                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2736             20  CF-MORT-PC-Q               PIC X.
  2737                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2738             20  CF-MORT-TABLE-CODE         PIC X(4).
  2739             20  CF-MORT-COMMENTS           PIC X(15).
  2740             20  FILLER                     PIC X(14).
  2741
  2742         16  FILLER                         PIC X(251).
  2743
  2744
  2745****************************************************************
  2746*             BUSSINESS TYPE MASTER RECORD                     *
  2747****************************************************************
  2748
  2749     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2750* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2751* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2752* AND RECORD 05 IS TYPES 81-99
  2753         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2754             20  CF-BUSINESS-TITLE          PIC  X(19).
  2755             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2756                                            PIC S9V9(4) COMP-3.
  2757             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2758             20  FILLER                     PIC  X.
  2759         16  FILLER                         PIC  X(248).
  2760
  2761
  2762****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  56
* EL6561.cbl
  2763*             TERMINAL MASTER RECORD                           *
  2764****************************************************************
  2765
  2766     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2767
  2768         16  CF-COMPANY-TERMINALS.
  2769             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2770                                  PIC X(4).
  2771         16  FILLER               PIC X(248).
  2772
  2773
  2774****************************************************************
  2775*             LIFE EDIT MASTER RECORD                          *
  2776****************************************************************
  2777
  2778     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2779         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2780             20  CF-LIFE-CODE-IN            PIC XX.
  2781             20  CF-LIFE-CODE-OUT           PIC XX.
  2782         16  FILLER                         PIC X(248).
  2783
  2784
  2785****************************************************************
  2786*             AH EDIT MASTER RECORD                            *
  2787****************************************************************
  2788
  2789     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2790         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2791             20  CF-AH-CODE-IN              PIC XXX.
  2792             20  CF-AH-CODE-OUT             PIC XX.
  2793         16  FILLER                         PIC X(248).
  2794
  2795
  2796****************************************************************
  2797*             CREDIBILITY TABLES                               *
  2798****************************************************************
  2799
  2800     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2801         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2802                             INDEXED BY CF-CRDB-NDX.
  2803             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2804             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2805             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2806         16  FILLER                         PIC  X(332).
  2807
  2808
  2809****************************************************************
  2810*             REPORT CUSTOMIZATION RECORD                      *
  2811****************************************************************
  2812
  2813     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2814         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2815             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2816             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2817             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2818**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2819****       A T-TRANSFER.                                   ****
  2820             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  57
* EL6561.cbl
  2821
  2822         16  FILLER                         PIC XX.
  2823
  2824         16  CF-CARRIER-CNTL-OPT.
  2825             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2826                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2827                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2828             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2829                                            PIC X.
  2830         16  CF-GROUP-CNTL-OPT.
  2831             20  CF-GROUP-OPT-SEQ           PIC 9.
  2832                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2833                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2834             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2835                                            PIC X(6).
  2836         16  CF-STATE-CNTL-OPT.
  2837             20  CF-STATE-OPT-SEQ           PIC 9.
  2838                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2839                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2840             20  CF-STATE-SELECT OCCURS 3 TIMES
  2841                                            PIC XX.
  2842         16  CF-ACCOUNT-CNTL-OPT.
  2843             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2844                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2845                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2846             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2847                                            PIC X(10).
  2848         16  CF-BUS-TYP-CNTL-OPT.
  2849             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2850                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2851                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2852             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2853                                            PIC XX.
  2854         16  CF-LF-TYP-CNTL-OPT.
  2855             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2856                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2857                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2858             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2859                                            PIC XX.
  2860         16  CF-AH-TYP-CNTL-OPT.
  2861             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2862                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2863                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2864             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2865                                            PIC XX.
  2866         16  CF-REPTCD1-CNTL-OPT.
  2867             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2868                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2869                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2870             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2871                                            PIC X(10).
  2872         16  CF-REPTCD2-CNTL-OPT.
  2873             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2874                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2875                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2876             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2877                                            PIC X(10).
  2878         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  58
* EL6561.cbl
  2879             20  CF-USER1-OPT-SEQ           PIC 9.
  2880                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2881                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2882             20  CF-USER1-SELECT OCCURS 3 TIMES
  2883                                            PIC X(10).
  2884         16  CF-USER2-CNTL-OPT.
  2885             20  CF-USER2-OPT-SEQ           PIC 9.
  2886                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2887                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2888             20  CF-USER2-SELECT OCCURS 3 TIMES
  2889                                            PIC X(10).
  2890         16  CF-USER3-CNTL-OPT.
  2891             20  CF-USER3-OPT-SEQ           PIC 9.
  2892                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2893                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2894             20  CF-USER3-SELECT OCCURS 3 TIMES
  2895                                            PIC X(10).
  2896         16  CF-USER4-CNTL-OPT.
  2897             20  CF-USER4-OPT-SEQ           PIC 9.
  2898                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2899                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2900             20  CF-USER4-SELECT OCCURS 3 TIMES
  2901                                            PIC X(10).
  2902         16  CF-USER5-CNTL-OPT.
  2903             20  CF-USER5-OPT-SEQ           PIC 9.
  2904                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2905                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2906             20  CF-USER5-SELECT OCCURS 3 TIMES
  2907                                            PIC X(10).
  2908         16  CF-REINS-CNTL-OPT.
  2909             20  CF-REINS-OPT-SEQ           PIC 9.
  2910                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2911                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2912             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2913                 24  CF-REINS-PRIME         PIC XXX.
  2914                 24  CF-REINS-SUB           PIC XXX.
  2915
  2916         16  CF-AGENT-CNTL-OPT.
  2917             20  CF-AGENT-OPT-SEQ           PIC 9.
  2918                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2919                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2920             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2921                                            PIC X(10).
  2922
  2923         16  FILLER                         PIC X(43).
  2924
  2925         16  CF-LOSS-RATIO-SELECT.
  2926             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2927             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2928         16  CF-ENTRY-DATE-SELECT.
  2929             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2930             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2931         16  CF-EFFECTIVE-DATE-SELECT.
  2932             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2933             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2934
  2935         16  CF-EXCEPTION-LIST-IND          PIC X.
  2936             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  59
* EL6561.cbl
  2937
  2938         16  FILLER                         PIC X(318).
  2939
  2940****************************************************************
  2941*                  EXCEPTION REPORTING RECORD                  *
  2942****************************************************************
  2943
  2944     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2945         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2946             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2947
  2948         16  CF-COMBINED-LIFE-AH-OPT.
  2949             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2950             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2951             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2952             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2953
  2954         16  CF-LIFE-OPT.
  2955             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2956             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2957             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2958             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2959             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2960             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2961             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2962             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2963             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2964             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2965
  2966         16  CF-AH-OPT.
  2967             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2968             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2969             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2970             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2971             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2972             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2973             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2974             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2975             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2976             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2977
  2978         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2979             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2980             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2981             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2982
  2983         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2984
  2985         16  FILLER                         PIC X(673).
  2986
  2987
  2988****************************************************************
  2989*             MORTGAGE SYSTEM PLAN RECORD                      *
  2990****************************************************************
  2991
  2992     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2993         16  CF-PLAN-TYPE                   PIC X.
  2994             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  60
* EL6561.cbl
  2995             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2996             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2997         16  CF-PLAN-ABBREV                 PIC XXX.
  2998         16  CF-PLAN-DESCRIPT               PIC X(10).
  2999         16  CF-PLAN-NOTES                  PIC X(20).
  3000         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3001         16  CF-PLAN-UNDERWRITING.
  3002             20  CF-PLAN-TERM-DATA.
  3003                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3004                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3005             20  CF-PLAN-AGE-DATA.
  3006                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3007                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3008                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3009             20  CF-PLAN-BENEFIT-DATA.
  3010                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3011                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3012                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3013                                            PIC S9(7)V99  COMP-3.
  3014         16  CF-PLAN-POLICY-FORMS.
  3015             20  CF-POLICY-FORM             PIC X(12).
  3016             20  CF-MASTER-APPLICATION      PIC X(12).
  3017             20  CF-MASTER-POLICY           PIC X(12).
  3018         16  CF-PLAN-RATING.
  3019             20  CF-RATE-CODE               PIC X(5).
  3020             20  CF-SEX-RATING              PIC X.
  3021                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3022                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3023             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3024             20  CF-SUB-STD-TYPE            PIC X.
  3025                 88  CF-PCT-OF-PREM            VALUE '1'.
  3026                 88  CF-PCT-OF-BENE            VALUE '2'.
  3027         16  CF-PLAN-PREM-TOLERANCES.
  3028             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3029             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3030         16  CF-PLAN-PYMT-TOLERANCES.
  3031             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3032             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3033         16  CF-PLAN-MISC-DATA.
  3034             20  FILLER                     PIC X.
  3035             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3036             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3037         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3038         16  CF-PLAN-IND-GRP                PIC X.
  3039             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3040                                                     '1'.
  3041             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3042                                                     '2'.
  3043         16  CF-MIB-SEARCH-SW               PIC X.
  3044             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3045             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3046             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3047             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3048         16  CF-ALPHA-SEARCH-SW             PIC X.
  3049             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3050             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3051             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3052             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  61
* EL6561.cbl
  3053             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3054             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3055             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3056             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3057             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3058             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3059                                                     'A' 'B' 'C'
  3060                                                     'X' 'Y' 'Z'.
  3061         16  CF-EFF-DT-RULE-SW              PIC X.
  3062             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3063             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3064             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3065             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3066             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3067         16  FILLER                         PIC X(4).
  3068         16  CF-HEALTH-QUESTIONS            PIC X.
  3069             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3070         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3071         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3072         16  CF-PLAN-SNGL-JNT               PIC X.
  3073             88  CF-COMBINED-PLAN              VALUE 'C'.
  3074             88  CF-JNT-PLAN                   VALUE 'J'.
  3075             88  CF-SNGL-PLAN                  VALUE 'S'.
  3076         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3077         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3078         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3079         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3080         16  CF-RERATE-CNTL                 PIC  X.
  3081             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3082             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3083             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3084             88  CF-AUTO-RECALC                 VALUE '4'.
  3085         16  CF-BENEFIT-TYPE                PIC  X.
  3086             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3087             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3088         16  CF-POLICY-FEE                  PIC S999V99
  3089                                                    COMP-3.
  3090         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3091         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3092         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3093         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3094         16  FILLER                         PIC  X(32).
  3095         16  CF-TERMINATION-FORM            PIC  X(04).
  3096         16  FILLER                         PIC  X(08).
  3097         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3098                                                       COMP-3.
  3099         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3100         16  CF-ISSUE-LETTER                PIC  X(4).
  3101         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3102         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3103             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3104             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3105         16  CF-MP-REFUND-CALC              PIC X.
  3106             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3107             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3108             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3109             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3110             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  62
* EL6561.cbl
  3111             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3112             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3113             88  CF-MP-REFD-MEAN                VALUE '8'.
  3114         16  CF-ALT-RATE-CODE               PIC  X(5).
  3115
  3116
  3117         16  FILLER                         PIC X(498).
  3118****************************************************************
  3119*             MORTGAGE COMPANY MASTER RECORD                   *
  3120****************************************************************
  3121
  3122     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3123         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3124         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3125             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3126             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3127             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3128             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3129             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3130
  3131         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3132         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3133         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3134         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3135         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3136
  3137         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3138             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3139         16  CF-MP-RECON-USE-IND            PIC X(1).
  3140             88  CF-MP-USE-RECON             VALUE 'Y'.
  3141         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3142             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3143         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3144             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3145             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3146         16  FILLER                         PIC X(1).
  3147         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3148             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3149         16  CF-MORTG-MIB-VERSION           PIC X.
  3150             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3151             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3152             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3153         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3154             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3155                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3156             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3157                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3158             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3159                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3160             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3161                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3162             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3163                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3164             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3165                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3166         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3167         16  FILLER                         PIC X(7).
  3168         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  63
* EL6561.cbl
  3169             20  CF-MORTG-MIB-COMM          PIC X(5).
  3170             20  CF-MORTG-MIB-TERM          PIC X(5).
  3171         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3172             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3173         16  FILLER                         PIC X(03).
  3174         16  CF-MP-CHECK-NO-CONTROL.
  3175             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3176                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3177                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3178                                                ' ' LOW-VALUES.
  3179                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3180                                               VALUE '3'.
  3181         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3182         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3183         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3184             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3185                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3186             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3187                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3188             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3189                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3190             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3191                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3192             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3193                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3194             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3195                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3196         16  CF-MORTG-BILLING-AREA.
  3197             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3198                                            PIC X.
  3199         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3200         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3201         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3202         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3203             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3204             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3205         16  FILLER                         PIC X.
  3206         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3207             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3208             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3209         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3210         16  FILLER                         PIC X(8).
  3211         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3212         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3213         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3214         16  CF-ACH-COMPANY-ID.
  3215             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3216                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3217                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3218                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3219             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3220         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3221             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3222         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3223             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3224             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3225         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3226         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  64
* EL6561.cbl
  3227         16  FILLER                         PIC X(536).
  3228
  3229****************************************************************
  3230*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3231****************************************************************
  3232
  3233     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3234         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3235             20  CF-FEMALE-HEIGHT.
  3236                 24  CF-FEMALE-FT           PIC 99.
  3237                 24  CF-FEMALE-IN           PIC 99.
  3238             20  CF-FEMALE-MIN-WT           PIC 999.
  3239             20  CF-FEMALE-MAX-WT           PIC 999.
  3240         16  FILLER                         PIC X(428).
  3241
  3242     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3243         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3244             20  CF-MALE-HEIGHT.
  3245                 24  CF-MALE-FT             PIC 99.
  3246                 24  CF-MALE-IN             PIC 99.
  3247             20  CF-MALE-MIN-WT             PIC 999.
  3248             20  CF-MALE-MAX-WT             PIC 999.
  3249         16  FILLER                         PIC X(428).
  3250******************************************************************
  3251*             AUTOMATIC ACTIVITY RECORD                          *
  3252******************************************************************
  3253     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3254         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3255             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3256             20  CF-SYS-LETTER-ID           PIC X(04).
  3257             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3258             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3259             20  CF-SYS-RESET-SW            PIC X(01).
  3260             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3261             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3262
  3263         16  FILLER                         PIC X(50).
  3264
  3265         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3266             20  CF-USER-ACTIVE-SW          PIC X(01).
  3267             20  CF-USER-LETTER-ID          PIC X(04).
  3268             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3269             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3270             20  CF-USER-RESET-SW           PIC X(01).
  3271             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3272             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3273             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3274
  3275         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  65
* EL6561.cbl
  3277 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD
  3278                          CONTROL-FILE.
  3279 0000-DFHEXIT SECTION.
  3280     MOVE '9#                    $   ' TO DFHEIV0.
  3281     MOVE 'EL6561' TO DFHEIV1.
  3282     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3283
  3284     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3285     MOVE '5'                   TO DC-OPTION-CODE.
  3286     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3287     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3288     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  3289     INITIALIZE PI-DISCOUNT-RATE
  3290                PI-OB-RATE.
  3291
  3292     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  3293
  3294 0100-START.
  3295     IF EIBCALEN = 0
  3296         GO TO 8800-UNAUTHORIZED-ACCESS.
  3297
  3298     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3299         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3300             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3301             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3302             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3303             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3304             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3305             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3306             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3307             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3308         ELSE
  3309             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3310             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3311             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3312             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3313             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3314             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3315             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3316             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  3317
  3318
  3319* EXEC CICS HANDLE CONDITION
  3320*        NOTOPEN  (9990-ABEND)
  3321*        NOTFND   (8880-NOT-FOUND)
  3322*        PGMIDERR (9600-PGMID-ERROR)
  3323*        ERROR    (9990-ABEND)
  3324*    END-EXEC.
  3325*    MOVE '"$JIL.                ! " #00003314' TO DFHEIV0
  3326     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  3327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3328     MOVE X'2220233030303033333134' TO DFHEIV0(25:11)
  3329     CALL 'kxdfhei1' USING DFHEIV0
  3330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3331
  3332
  3333     IF PI-FILE-ID = 'OE'
  3334        MOVE OE-RATE-FILE-ID TO RATE-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  66
* EL6561.cbl
  3335
  3336     IF EIBTRNID NOT = TRANS-ID
  3337         MOVE LOW-VALUES TO EL6561AI
  3338         GO TO 3000-BUILD-SCREEN-B.
  3339
  3340     IF EIBAID = DFHCLEAR
  3341         MOVE 'Y' TO PI-RETURN-SW
  3342         GO TO 9400-CLEAR.
  3343
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  67
* EL6561.cbl
  3345
  3346 0200-RECEIVE.
  3347     MOVE LOW-VALUES TO EL6561AI.
  3348
  3349     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3350         MOVE ER-0008 TO EMI-ERROR
  3351         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3352         MOVE -1   TO MAXAGEL
  3353         GO TO 8200-SEND-DATAONLY.
  3354
  3355
  3356* EXEC CICS RECEIVE
  3357*        MAP    (WS-MAPNAME)
  3358*        MAPSET (WS-MAPSET-NAME)
  3359*        INTO   (EL6561AI)
  3360*    END-EXEC.
  3361     MOVE LENGTH OF
  3362      EL6561AI
  3363       TO DFHEIV11
  3364*    MOVE '8"T I  L              ''   #00003343' TO DFHEIV0
  3365     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3366     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3367     MOVE X'2020233030303033333433' TO DFHEIV0(25:11)
  3368     CALL 'kxdfhei1' USING DFHEIV0,
  3369           WS-MAPNAME,
  3370           EL6561AI,
  3371           DFHEIV11,
  3372           WS-MAPSET-NAME,
  3373           DFHEIV99,
  3374           DFHEIV99
  3375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3376
  3377
  3378     IF PFENTERL = 0
  3379         GO TO 0300-CHECK-PFKEYS.
  3380
  3381     IF EIBAID NOT = DFHENTER
  3382         MOVE ER-0004 TO EMI-ERROR
  3383         GO TO 0310-INPUT-ERROR.
  3384
  3385     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  3386         MOVE PF-VALUES (PFENTERI) TO EIBAID
  3387     ELSE
  3388         MOVE ER-0029 TO EMI-ERROR
  3389         GO TO 0310-INPUT-ERROR.
  3390
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  68
* EL6561.cbl
  3392
  3393 0300-CHECK-PFKEYS.
  3394     IF EIBAID = DFHPF23
  3395         GO TO 8810-PF23.
  3396
  3397     IF EIBAID = DFHPF24
  3398         GO TO 9200-RETURN-MAIN-MENU.
  3399
  3400     IF EIBAID = DFHPF12
  3401         GO TO 9500-PF12.
  3402
  3403     IF EIBAID = DFHPF1
  3404         GO TO 7100-NEXT-PLAN.
  3405
  3406     IF EIBAID = DFHPF2
  3407         GO TO 7200-PRIOR-PLAN.
  3408
  3409     IF EIBAID = DFHPF5
  3410         MOVE XCTL-6562 TO PGM-NAME
  3411         GO TO 9300-XCTL.
  3412
  3413     IF EIBAID = DFHENTER
  3414         GO TO 1000-CHANGE.
  3415
  3416     MOVE ER-0029 TO EMI-ERROR.
  3417
  3418 0310-INPUT-ERROR.
  3419     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3420
  3421     MOVE AL-UNBON TO PFENTERA
  3422     MOVE -1       TO PFENTERL
  3423
  3424     GO TO 8200-SEND-DATAONLY.
  3425
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  69
* EL6561.cbl
  3427
  3428 1000-CHANGE.
  3429     IF NOT MODIFY-CAP
  3430         MOVE 'UPDATE'       TO SM-READ
  3431         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3432         MOVE ER-0070        TO  EMI-ERROR
  3433         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3434         GO TO 8100-SEND-INITIAL-MAP.
  3435
  3436     IF PI-ERRATE-KEY = PI-SAVE-ERRATE-KEY
  3437         NEXT SENTENCE
  3438     ELSE
  3439         MOVE ER-2056  TO EMI-ERROR
  3440         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3441         MOVE -1    TO MAXAGEL
  3442         GO TO 8200-SEND-DATAONLY.
  3443
  3444     PERFORM 5000-EDIT-SCREEN-B THRU 5099-EXIT.
  3445
  3446     IF EMI-NO-ERRORS
  3447         NEXT SENTENCE
  3448     ELSE
  3449         GO TO 8200-SEND-DATAONLY.
  3450
  3451     PERFORM 7750-READ-ERRATE-UPDATE THRU 7750-EXIT.
  3452
  3453     MOVE RATE-RECORD TO JP-RECORD-AREA.
  3454
  3455     PERFORM 4000-UPDATE-SCREEN-B THRU 4099-EXIT.
  3456
  3457     IF RT-LAST-MAINT-USER   = PI-UPDATE-BY OR
  3458        RT-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  3459         NEXT SENTENCE
  3460     ELSE
  3461
  3462* EXEC CICS UNLOCK
  3463*             DATASET  (RATE-FILE-ID)
  3464*        END-EXEC
  3465*    MOVE '&*                    #   #00003432' TO DFHEIV0
  3466     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3467     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3468     MOVE X'2020233030303033343332' TO DFHEIV0(25:11)
  3469     CALL 'kxdfhei1' USING DFHEIV0,
  3470           RATE-FILE-ID,
  3471           DFHEIV99
  3472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3473         MOVE ER-0068 TO EMI-ERROR
  3474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3475         GO TO 3000-BUILD-SCREEN-B.
  3476
  3477     MOVE PI-PROCESSOR-ID     TO RT-LAST-MAINT-USER.
  3478     MOVE EIBTIME             TO RT-LAST-MAINT-HHMMSS.
  3479
  3480     MOVE SAVE-BIN-DATE       TO RT-LAST-MAINT-DT
  3481                                 BIN-CURRENT-SAVE.
  3482     MOVE 'B'                 TO JP-RECORD-TYPE
  3483     MOVE RATE-FILE-ID        TO FILE-ID.
  3484     PERFORM 8400-LOG-JOURNAL-RECORD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  70
* EL6561.cbl
  3485                                 thru 8400-exit
  3486     MOVE RATE-RECORD         TO JP-RECORD-AREA.
  3487
  3488
  3489* EXEC CICS REWRITE
  3490*        DATASET  (RATE-FILE-ID)
  3491*        FROM     (RATE-RECORD)
  3492*    END-EXEC.
  3493     MOVE LENGTH OF
  3494      RATE-RECORD
  3495       TO DFHEIV11
  3496*    MOVE '&& L                  %   #00003450' TO DFHEIV0
  3497     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3498     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3499     MOVE X'2020233030303033343530' TO DFHEIV0(25:11)
  3500     CALL 'kxdfhei1' USING DFHEIV0,
  3501           RATE-FILE-ID,
  3502           RATE-RECORD,
  3503           DFHEIV11,
  3504           DFHEIV99
  3505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3506
  3507
  3508     MOVE 'C'                 TO JP-RECORD-TYPE
  3509     MOVE RATE-FILE-ID        TO FILE-ID.
  3510     PERFORM 8400-LOG-JOURNAL-RECORD
  3511                                 thru 8400-exit
  3512     PERFORM 8000-UPDATE-MAINT-DATE THRU 8000-EXIT.
  3513     MOVE ER-0000 TO EMI-ERROR.
  3514     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3515
  3516 1099-EXIT.
  3517     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  71
* EL6561.cbl
  3519
  3520 3000-BUILD-SCREEN-B.
  3521     MOVE LOW-VALUES                TO  EL6561AO.
  3522     MOVE ZEROS                     TO  MISC-SAVE-AREAS.
  3523     MOVE PI-COMPANY-CD             TO  PI-RATE-COMPANY-CD.
  3524
  3525     PERFORM 7650-READ-ERRATE THRU 7650-EXIT.
  3526
  3527     MOVE PI-ERRATE-KEY             TO PI-SAVE-ERRATE-KEY.
  3528
  3529 3025-SET-UP-SCREEN-B.
  3530     MOVE RT-ST-CODE             TO STATEO
  3531     MOVE RT-ST-CLASS            TO CLASSO
  3532     MOVE RT-ST-DEV              TO DEVO
  3533     MOVE RT-LAH-NUM                TO PLANCODO.
  3534     MOVE RT-MAX-AGE                TO MAXAGEO.
  3535     MOVE RT-HIGH-AGE               TO RTAGEO.
  3536     MOVE RT-HIGH-AMT               TO AMOUNTO.
  3537
  3538***  Y2K PROJ 7744
  3539     MOVE RT-EXPIRY-DATE            TO WS-HOLD-RATE-EXP-DT
  3540     MOVE WS-HOLD-RATE-EXP-AL(6:6)  TO EXPIREO
  3541***  Y2K PROJ 7744
  3542
  3543     IF PI-COMPANY-ID = 'CSL' OR  'LGX'
  3544         NEXT SENTENCE
  3545     ELSE
  3546         MOVE AL-SADOF    TO  DAYRTDA
  3547         MOVE AL-SANOF    TO  DAYRTA
  3548         GO TO 3025-SKIP-DAILY-RATE.
  3549
  3550     IF RT-DAILY-RATE NUMERIC
  3551        IF RT-DAILY-RATE NOT = +0
  3552           MOVE RT-DAILY-RATE       TO DAYRTO.
  3553
  3554 3025-SKIP-DAILY-RATE.
  3555     IF RT-DISCOUNT-RATE NUMERIC
  3556         MOVE RT-DISCOUNT-RATE   TO PI-DISCOUNT-RATE
  3557         IF RT-DISCOUNT-RATE NOT = +0
  3558             MOVE RT-DISCOUNT-RATE
  3559                                 TO DISRATO
  3560         END-IF
  3561     ELSE
  3562         MOVE ZEROS              TO PI-DISCOUNT-RATE
  3563     END-IF.
  3564
  3565     IF RT-CANCEL-FEE NUMERIC
  3566        IF RT-CANCEL-FEE NOT EQUAL +0
  3567           MOVE RT-CANCEL-FEE       TO CANFEEO.
  3568
  3569     IF RT-COMPOSITE-RATE NUMERIC
  3570        IF RT-COMPOSITE-RATE NOT = +0
  3571           MOVE RT-COMPOSITE-RATE   TO COMPRTO.
  3572
  3573     IF RT-DISCOUNT-OB-RATE NUMERIC
  3574         MOVE RT-DISCOUNT-OB-RATE
  3575                                 TO PI-OB-RATE
  3576         IF RT-DISCOUNT-OB-RATE NOT = +0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  72
* EL6561.cbl
  3577             MOVE RT-DISCOUNT-OB-RATE
  3578                                 TO OBRATEO
  3579         END-IF
  3580     ELSE
  3581         MOVE ZEROS              TO PI-OB-RATE
  3582     END-IF.
  3583
  3584     IF RT-DISCOUNT-OPTION = '1' OR '2' OR '3' OR '4' OR
  3585                             '5' OR '6'
  3586        MOVE RT-DISCOUNT-OPTION     TO DISOPTO
  3587                                       PI-DISCOUNT-OPTION
  3588     ELSE
  3589        MOVE SPACES                 TO DISOPTO.
  3590
  3591     IF PI-RATE-L-AH = PI-LIFE-OVERRIDE-L1
  3592         MOVE -1                    TO MORTL
  3593         MOVE PI-LIFE-OVERRIDE-L6   TO LIMITSO
  3594         MOVE PI-LIFE-OVERRIDE-L1   TO COVERO
  3595         MOVE RT-LIFE-MORT-CODE     TO MORTO
  3596         MOVE AL-SADOF              TO MAXDA
  3597         MOVE AL-UANON              TO MORTA
  3598         MOVE AL-SANOF              TO MORTDA.
  3599
  3600     IF PI-RATE-L-AH = PI-AH-OVERRIDE-L1
  3601         MOVE -1                    TO MAXAGEL
  3602         MOVE PI-AH-OVERRIDE-L6     TO LIMITSO
  3603         MOVE PI-AH-OVERRIDE-L1     TO COVERO
  3604         MOVE AL-SANOF              TO MAXDA
  3605         MOVE AL-SADOF              TO MORTA
  3606                                       MORTDA.
  3607
  3608     MOVE +1     TO SUB1.
  3609     SET ST-INDX TO +1.
  3610
  3611 3050-SET-UP-LIMITS.
  3612
  3613     IF PI-RATE-L-AH = PI-AH-OVERRIDE-L1
  3614        IF RT-AH-AGE (SUB1) = ZEROS
  3615           NEXT SENTENCE
  3616         ELSE
  3617             MOVE RT-AH-AGE   (SUB1)  TO  RATE-TO-AGE   (ST-INDX)
  3618             MOVE RT-AH-TERM  (SUB1)  TO  RATE-TO-TRM   (ST-INDX)
  3619             MOVE RT-AH-BEN-M (SUB1)  TO  RATE-MO-BEN1  (ST-INDX)
  3620             MOVE RT-AH-BEN-F (SUB1)  TO  RATE-TO-BEN1  (ST-INDX)
  3621             MOVE AL-UNNON            TO  RATE-TO-AGE-A (ST-INDX)
  3622                                          RATE-TO-TRM-A (ST-INDX)
  3623                                          RATE-TO-BEN-A (ST-INDX)
  3624                                          RATE-MO-BEN-A (ST-INDX).
  3625
  3626     IF PI-RATE-L-AH = PI-LIFE-OVERRIDE-L1
  3627         IF RT-L-EX-AGE (SUB1) = ZEROS
  3628             MOVE AL-SADOF            TO  RATE-MO-BEN-A (ST-INDX)
  3629         ELSE
  3630             MOVE RT-L-EX-AGE  (SUB1) TO  RATE-TO-AGE   (ST-INDX)
  3631             MOVE RT-L-EX-TERM (SUB1) TO  RATE-TO-TRM   (ST-INDX)
  3632             MOVE RT-L-EX-FACE (SUB1) TO  RATE-TO-BEN1  (ST-INDX)
  3633             MOVE AL-SADOF            TO  RATE-MO-BEN-A (ST-INDX)
  3634             MOVE AL-UNNON            TO  RATE-TO-AGE-A (ST-INDX)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  73
* EL6561.cbl
  3635                                          RATE-TO-TRM-A (ST-INDX)
  3636                                          RATE-TO-BEN-A (ST-INDX).
  3637
  3638     ADD +1 TO SUB1.
  3639     SET ST-INDX UP BY +1.
  3640
  3641     IF SUB1 GREATER +8
  3642         MOVE +1     TO SUB1
  3643         SET ST-INDX TO +1
  3644     ELSE
  3645         GO TO 3050-SET-UP-LIMITS.
  3646
  3647     MOVE AL-UNNON                      TO MAXAGEA.
  3648     GO TO 8100-SEND-INITIAL-MAP.
  3649
  3650 3099-EXIT.
  3651     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  74
* EL6561.cbl
  3653
  3654 4000-UPDATE-SCREEN-B.
  3655
  3656     IF RT-CANCEL-FEE NOT NUMERIC
  3657        MOVE +0                 TO RT-CANCEL-FEE.
  3658
  3659     IF MAXAGEL GREATER ZERO
  3660         MOVE WS-MAX-AGE        TO RT-MAX-AGE.
  3661
  3662     IF MORTL GREATER ZERO
  3663         MOVE WS-MORT-CODE      TO RT-LIFE-MORT-CODE.
  3664
  3665     IF DAYRTL GREATER ZERO
  3666        MOVE WS-DAILY-RATE      TO RT-DAILY-RATE.
  3667
  3668     IF DISRATL GREATER +0
  3669        MOVE WS-DISCOUNT-RATE   TO RT-DISCOUNT-RATE.
  3670
  3671     IF CANFEEL GREATER +0
  3672        MOVE WS-CANCEL-FEE      TO RT-CANCEL-FEE.
  3673
  3674     IF COMPRTL GREATER +0
  3675        MOVE WS-COMPOSITE-RATE  TO RT-COMPOSITE-RATE.
  3676
  3677     IF RT-COMPOSITE-RATE NOT NUMERIC
  3678         MOVE ZERO              TO RT-COMPOSITE-RATE.
  3679     IF RT-COMPOSITE-RATE GREATER +0
  3680        MOVE '1'                TO RT-COMPOSITE-OPTION
  3681       ELSE
  3682        MOVE ' '                TO RT-COMPOSITE-OPTION.
  3683
  3684     IF OBRATEL GREATER +0
  3685        MOVE WS-DISCOUNT-OB-RATE
  3686                                TO RT-DISCOUNT-OB-RATE.
  3687
  3688     IF DISOPTL GREATER +0
  3689        MOVE WS-DISCOUNT-OPTION TO RT-DISCOUNT-OPTION.
  3690
  3691
  3692     MOVE +1     TO SUB1
  3693                    SUB2.
  3694
  3695 4025-UPDATE-LIMITS.
  3696
  3697     IF SUB1 GREATER +8
  3698         GO TO 4050-ZERO-RECORD.
  3699
  3700     IF WS-LIMIT-AGE (SUB1) = ZERO
  3701        IF PI-COMPANY-ID NOT EQUAL 'CRI'
  3702         ADD +1 TO SUB1
  3703         GO TO 4025-UPDATE-LIMITS.
  3704
  3705     IF PI-RATE-L-AH = PI-AH-OVERRIDE-L1
  3706         MOVE WS-LIMIT-AGE    (SUB1) TO RT-AH-AGE   (SUB2)
  3707         MOVE WS-LIMIT-TERM   (SUB1) TO RT-AH-TERM  (SUB2)
  3708         MOVE WS-LIMIT-MO-BEN (SUB1) TO RT-AH-BEN-M (SUB2)
  3709         MOVE WS-LIMIT-TO-BEN (SUB1) TO RT-AH-BEN-F (SUB2).
  3710
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  75
* EL6561.cbl
  3711     IF PI-RATE-L-AH = PI-LIFE-OVERRIDE-L1
  3712         MOVE WS-LIMIT-AGE    (SUB1) TO RT-L-EX-AGE  (SUB2)
  3713         MOVE WS-LIMIT-TERM   (SUB1) TO RT-L-EX-TERM (SUB2)
  3714         MOVE WS-LIMIT-TO-BEN (SUB1) TO RT-L-EX-FACE (SUB2).
  3715
  3716     ADD +1 TO SUB1
  3717               SUB2.
  3718
  3719     GO TO 4025-UPDATE-LIMITS.
  3720
  3721 4050-ZERO-RECORD.
  3722     IF SUB2 GREATER +8
  3723         MOVE +1 TO SUB1
  3724                    SUB2
  3725         GO TO 4099-EXIT.
  3726
  3727     IF PI-RATE-L-AH = PI-AH-OVERRIDE-L1
  3728         MOVE ZEROS     TO RT-AH-AGE   (SUB2)
  3729                           RT-AH-TERM  (SUB2)
  3730                           RT-AH-BEN-M (SUB2)
  3731                           RT-AH-BEN-F (SUB2)
  3732     ELSE
  3733         IF PI-RATE-L-AH = PI-LIFE-OVERRIDE-L1
  3734             MOVE ZEROS TO RT-L-EX-AGE  (SUB2)
  3735                           RT-L-EX-TERM (SUB2)
  3736                           RT-L-EX-FACE (SUB2).
  3737
  3738     ADD +1 TO SUB2.
  3739     GO TO 4050-ZERO-RECORD.
  3740
  3741 4099-EXIT.
  3742     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  76
* EL6561.cbl
  3744
  3745 5000-EDIT-SCREEN-B.
  3746     IF PLANCODL GREATER ZERO
  3747         IF PLANCODI NUMERIC
  3748             MOVE PLANCODI TO PI-RATE-LAH-NUM
  3749         ELSE
  3750             MOVE -1       TO PLANCODL
  3751             MOVE AL-UNBON TO PLANCODA
  3752             MOVE ER-2184  TO EMI-ERROR
  3753             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3754
  3755     IF COVERL GREATER ZERO
  3756         IF COVERI = PI-LIFE-OVERRIDE-L1 OR
  3757                     PI-AH-OVERRIDE-L1
  3758             MOVE COVERI   TO PI-RATE-L-AH
  3759         ELSE
  3760             MOVE -1       TO COVERL
  3761             MOVE AL-UNBON TO COVERA
  3762             MOVE ER-2185  TO EMI-ERROR
  3763             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3764
  3765***  Y2K PROJ 7744
  3766     IF EXPIREL GREATER ZERO
  3767         IF EXPIREI NUMERIC
  3768             MOVE ZEROS    TO WS-HOLD-RATE-EXP-DT
  3769             MOVE EXPIREI  TO WS-HOLD-RATE-EXP-AL(6:6)
  3770                              DC-GREG-DATE-1-YMD
  3771             MOVE '3'      TO DC-OPTION-CODE
  3772             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  3773             IF NO-CONVERSION-ERROR
  3774                 MOVE DC-ALPHA-CENTURY TO
  3775                      WS-HOLD-RATE-EXP-AL(4:2)
  3776                 MOVE WS-HOLD-RATE-EXP-DT TO
  3777                                          PI-RATE-EXPIRY-DATE
  3778             ELSE
  3779                 IF WS-HOLD-RATE-EXP-DT(6:6) = 999999
  3780                     MOVE WS-HOLD-RATE-EXP-DT TO
  3781                                          PI-RATE-EXPIRY-DATE
  3782                 ELSE
  3783                     MOVE -1       TO EXPIREL
  3784                     MOVE AL-UNBON TO EXPIREA
  3785                     MOVE ER-2296  TO EMI-ERROR
  3786                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3787                 END-IF
  3788             END-IF
  3789         ELSE
  3790             MOVE -1       TO EXPIREL
  3791             MOVE AL-UNBON TO EXPIREA
  3792             MOVE ER-2296  TO EMI-ERROR
  3793             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3794         END-IF
  3795     END-IF.
  3796***  Y2K PROJ 7744
  3797
  3798     IF RTAGEL GREATER ZERO
  3799         IF RTAGEI NUMERIC
  3800             MOVE RTAGEI TO PI-RATE-HIGH-AGE
  3801         ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  77
* EL6561.cbl
  3802             MOVE -1       TO RTAGEL
  3803             MOVE AL-UNBON TO RTAGEA
  3804             MOVE ER-2187  TO EMI-ERROR
  3805             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3806
  3807     IF PI-ERRATE-KEY NOT = PI-SAVE-ERRATE-KEY
  3808         GO TO 7100-NEXT-PLAN.
  3809
  3810     MOVE ZEROS  TO MISC-SAVE-AREAS.
  3811     MOVE SPACES TO WS-MORT-CODE.
  3812
  3813     IF MORTL GREATER ZERO
  3814         PERFORM 7400-EDIT-MORTALITY THRU 7499-EXIT.
  3815
  3816     IF MAXAGEL GREATER ZERO
  3817         IF MAXAGEI NUMERIC
  3818             MOVE AL-UNNON TO MAXAGEA
  3819             MOVE MAXAGEI  TO WS-MAX-AGE
  3820         ELSE
  3821             MOVE -1 TO MAXAGEL
  3822             MOVE AL-UNBON TO MAXAGEA
  3823             MOVE ER-2273  TO EMI-ERROR
  3824             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3825
  3826     IF PI-COMPANY-ID  = 'CSL'  OR  'LGX'
  3827         IF DAYRTL GREATER ZERO
  3828             MOVE DAYRTI      TO  DEEDIT-FIELD
  3829             PERFORM 7500-DEEDIT
  3830             IF DEEDIT-FIELD-V5 NUMERIC
  3831                 MOVE DEEDIT-FIELD-V5 TO WS-DAILY-RATE
  3832                                           DAYRTO
  3833                 MOVE AL-UNNON TO DAYRTA
  3834             ELSE
  3835                 MOVE -1 TO DAYRTL
  3836                 MOVE AL-UNBON TO DAYRTA
  3837                 MOVE ER-2280 TO EMI-ERROR
  3838                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3839
  3840     IF DISRATL GREATER ZERO
  3841        MOVE DISRATI         TO  DEEDIT-FIELD
  3842        PERFORM 7500-DEEDIT
  3843        IF DEEDIT-FIELD-V5 NUMERIC
  3844           MOVE DEEDIT-FIELD-V5  TO  WS-DISCOUNT-RATE
  3845                                     DISRATO
  3846                                     PI-DISCOUNT-RATE
  3847           MOVE AL-UNNON TO DISRATA
  3848        ELSE
  3849           MOVE -1 TO DISRATL
  3850           MOVE AL-UNBON TO DISRATA
  3851           MOVE ER-2280  TO EMI-ERROR
  3852           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3853
  3854     IF CANFEEL GREATER +0
  3855        MOVE CANFEEI         TO  DEEDIT-FIELD
  3856        PERFORM 7500-DEEDIT
  3857        IF DEEDIT-FIELD-V2 NUMERIC
  3858           MOVE DEEDIT-FIELD-V2  TO  WS-CANCEL-FEE
  3859                                     CANFEEO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  78
* EL6561.cbl
  3860           MOVE AL-UNNON TO CANFEEA
  3861        ELSE
  3862           MOVE -1 TO CANFEEL
  3863           MOVE AL-UNBON TO CANFEEA
  3864           MOVE ER-9407  TO EMI-ERROR
  3865           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3866
  3867     IF COMPRTL GREATER ZERO
  3868        MOVE COMPRTI         TO  DEEDIT-FIELD
  3869        PERFORM 7500-DEEDIT
  3870        IF DEEDIT-FIELD-V5 NUMERIC
  3871           MOVE DEEDIT-FIELD-V5  TO  WS-COMPOSITE-RATE
  3872                                     COMPRTO
  3873           MOVE AL-UNNON TO COMPRTA
  3874        ELSE
  3875           MOVE -1 TO COMPRTL
  3876           MOVE AL-UNBON TO COMPRTA
  3877           MOVE ER-2280  TO EMI-ERROR
  3878           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3879
  3880     IF OBRATEL GREATER ZERO
  3881        MOVE OBRATEI         TO  DEEDIT-FIELD
  3882        PERFORM 7500-DEEDIT
  3883        IF DEEDIT-FIELD-V5 NUMERIC
  3884           MOVE DEEDIT-FIELD-V5  TO  WS-DISCOUNT-OB-RATE
  3885                                     OBRATEO
  3886                                     PI-OB-RATE
  3887           MOVE AL-UNNON TO OBRATEA
  3888        ELSE
  3889           MOVE -1 TO OBRATEL
  3890           MOVE AL-UNBON TO OBRATEA
  3891           MOVE ER-2280  TO EMI-ERROR
  3892           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3893
  3894     IF DISOPTL GREATER ZERO
  3895         NEXT SENTENCE
  3896     ELSE
  3897         GO TO 5010-OPTION-EDITS-DONE.
  3898
  3899     IF DISOPTI = ' ' OR '1' OR '2' OR '3' OR '4' OR
  3900                  '5' OR '6'
  3901         MOVE DISOPTI            TO WS-DISCOUNT-OPTION
  3902                                    PI-DISCOUNT-OPTION
  3903         MOVE AL-UANON           TO DISOPTA
  3904     ELSE
  3905         MOVE -1                 TO DISOPTL
  3906         MOVE AL-UABON           TO DISOPTA
  3907         MOVE ER-2546            TO EMI-ERROR
  3908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3909         GO TO 5010-OPTION-EDITS-DONE.
  3910
  3911     IF PI-DISCOUNT-OPTION = '6'
  3912         IF PI-OB-RATE NOT = ZEROS
  3913             MOVE -1             TO OBRATEL
  3914             MOVE AL-UABON       TO OBRATEA
  3915             MOVE ER-2873        TO EMI-ERROR
  3916             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3917
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  79
* EL6561.cbl
  3918 5010-OPTION-EDITS-DONE.
  3919
  3920     MOVE +1 TO SUB1.
  3921     SET ST-INDX TO +1.
  3922
  3923 5025-EDIT-LIMITS.
  3924     IF ST-INDX GREATER +8
  3925         MOVE +1 TO SUB1
  3926         SET ST-INDX TO +1
  3927         GO TO 5099-EXIT.
  3928
  3929     IF RATE-TO-AGE-L (ST-INDX) GREATER ZERO
  3930         IF RATE-TO-AGE (ST-INDX) NUMERIC
  3931             IF RATE-TO-AGE (ST-INDX) LESS WS-PREV-AGE
  3932                 IF RATE-TO-AGE (ST-INDX) = ZERO
  3933                     MOVE AL-UNNON TO RATE-TO-AGE-A (ST-INDX)
  3934                     MOVE ZEROS    TO WS-LIMIT-AGE (SUB1)
  3935                 ELSE
  3936                     MOVE -1       TO RATE-TO-AGE-L (ST-INDX)
  3937                     MOVE AL-UNBON TO RATE-TO-AGE-A (ST-INDX)
  3938                     MOVE ER-2274  TO EMI-ERROR
  3939                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3940             ELSE
  3941                 MOVE AL-UNNON TO RATE-TO-AGE-A (ST-INDX)
  3942                 MOVE RATE-TO-AGE (ST-INDX) TO WS-LIMIT-AGE (SUB1)
  3943                                               WS-PREV-AGE
  3944         ELSE
  3945             MOVE -1       TO RATE-TO-AGE-L (ST-INDX)
  3946             MOVE AL-UNBON TO RATE-TO-AGE-A (ST-INDX)
  3947             MOVE ER-2275  TO EMI-ERROR
  3948             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3949
  3950     IF RATE-TO-TRM-L (ST-INDX) GREATER ZERO
  3951         IF RATE-TO-TRM (ST-INDX) NUMERIC
  3952             MOVE AL-UNNON TO RATE-TO-TRM-A (ST-INDX)
  3953             MOVE RATE-TO-TRM (ST-INDX) TO WS-LIMIT-TERM (SUB1)
  3954         ELSE
  3955             MOVE -1       TO RATE-TO-TRM-L (ST-INDX)
  3956             MOVE AL-UNBON TO RATE-TO-TRM-A (ST-INDX)
  3957             MOVE ER-2276  TO EMI-ERROR
  3958             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3959     ELSE
  3960         IF RATE-TO-AGE-L (ST-INDX) GREATER ZERO
  3961             MOVE -1       TO RATE-TO-TRM-L (ST-INDX)
  3962             MOVE AL-UNBON TO RATE-TO-TRM-A (ST-INDX)
  3963             MOVE ER-2276  TO EMI-ERROR
  3964             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3965
  3966     IF RATE-MO-BEN-L (ST-INDX) GREATER ZERO
  3967         MOVE RATE-MO-BEN (ST-INDX) TO DEEDIT-FIELD
  3968         PERFORM 7500-DEEDIT THRU 7500-EXIT
  3969         IF DEEDIT-FIELD-V0 NUMERIC
  3970             MOVE AL-UNNON TO RATE-MO-BEN-A (ST-INDX)
  3971             MOVE DEEDIT-FIELD-V0 TO WS-LIMIT-MO-BEN (SUB1)
  3972                                     RATE-MO-BEN1 (ST-INDX)
  3973         ELSE
  3974             MOVE -1       TO RATE-MO-BEN-L (ST-INDX)
  3975             MOVE AL-UNBON TO RATE-MO-BEN-A (ST-INDX)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  80
* EL6561.cbl
  3976             MOVE ER-2277  TO EMI-ERROR
  3977             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3978     ELSE
  3979         IF RATE-TO-AGE-L (ST-INDX) GREATER ZERO
  3980             IF PI-RATE-L-AH = PI-AH-OVERRIDE-L1
  3981                 MOVE -1       TO RATE-MO-BEN-L (ST-INDX)
  3982                 MOVE AL-UNBON TO RATE-MO-BEN-A (ST-INDX)
  3983                 MOVE ER-2277  TO EMI-ERROR
  3984                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3985
  3986     IF RATE-TO-BEN-L (ST-INDX) GREATER ZERO
  3987         MOVE RATE-TO-BEN (ST-INDX) TO DEEDIT-FIELD
  3988         PERFORM 7500-DEEDIT THRU 7500-EXIT
  3989         IF DEEDIT-FIELD-V0 NUMERIC
  3990             MOVE AL-UNNON TO RATE-TO-BEN-A (ST-INDX)
  3991             MOVE DEEDIT-FIELD-V0 TO WS-LIMIT-TO-BEN (SUB1)
  3992                                     RATE-TO-BEN1 (ST-INDX)
  3993         ELSE
  3994             MOVE -1       TO RATE-TO-BEN-L (ST-INDX)
  3995             MOVE AL-UNBON TO RATE-TO-BEN-A (ST-INDX)
  3996             MOVE ER-2278  TO EMI-ERROR
  3997             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3998     ELSE
  3999         IF RATE-TO-AGE-L (ST-INDX) GREATER ZERO
  4000             MOVE -1       TO RATE-TO-BEN-L (ST-INDX)
  4001             MOVE AL-UNBON TO RATE-TO-BEN-A (ST-INDX)
  4002             MOVE ER-2278  TO EMI-ERROR
  4003             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4004
  4005     ADD +1 TO SUB1.
  4006     SET ST-INDX UP BY +1.
  4007
  4008     IF ST-INDX GREATER +8
  4009         MOVE +1 TO SUB1
  4010         SET ST-INDX TO +1
  4011     ELSE
  4012         GO TO 5025-EDIT-LIMITS.
  4013
  4014 5099-EXIT.
  4015     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  81
* EL6561.cbl
  4017 7100-NEXT-PLAN.
  4018     MOVE SPACES             TO PI-ERRATE-EOF-SW.
  4019     MOVE PI-ERRATE-KEY      TO PI-SAVE-ERRATE-KEY.
  4020     MOVE PI-RATE-STATE-CODE TO WS-SAVE-STRUCTURE.
  4021
  4022     MOVE PI-COMPANY-CD      TO PI-RATE-COMPANY-CD.
  4023
  4024     PERFORM 7800-START-BROWSE THRU 7800-EXIT.
  4025
  4026
  4027* EXEC CICS HANDLE CONDITION
  4028*        ENDFILE  (7150-ENDFILE)
  4029*        NOTFND   (7175-NOTFOUND)
  4030*    END-EXEC.
  4031*    MOVE '"$''I                  ! # #00003973' TO DFHEIV0
  4032     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4034     MOVE X'2320233030303033393733' TO DFHEIV0(25:11)
  4035     CALL 'kxdfhei1' USING DFHEIV0
  4036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4037
  4038
  4039 7125-READ-NEXT.
  4040     PERFORM 7850-READNEXT THRU 7850-EXIT.
  4041
  4042     IF ERRATE-EOF
  4043         GO TO 7150-ENDFILE.
  4044
  4045     IF PI-ERRATE-KEY = PI-SAVE-ERRATE-KEY
  4046         GO TO 7125-READ-NEXT.
  4047
  4048     IF PI-RATE-STATE-CODE = WS-SAVE-STRUCTURE
  4049         NEXT SENTENCE
  4050     ELSE
  4051         GO TO 7150-ENDFILE.
  4052
  4053     MOVE RT-LAST-MAINT-USER     TO PI-UPDATE-BY.
  4054     MOVE RT-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  4055     MOVE PI-ERRATE-KEY          TO PI-SAVE-ERRATE-KEY.
  4056     MOVE LOW-VALUES             TO EL6561AO.
  4057
  4058     GO TO 3025-SET-UP-SCREEN-B.
  4059
  4060 7150-ENDFILE.
  4061     IF BROWSE-STARTED
  4062         PERFORM 7950-END-BROWSE THRU 7950-EXIT.
  4063
  4064     MOVE PI-SAVE-ERRATE-KEY     TO PI-ERRATE-KEY.
  4065     MOVE LOW-VALUES             TO PI-RATE-L-AH-CODE.
  4066***  Y2K PROJ 7744
  4067     MOVE ZEROS                  TO PI-RATE-EXPIRY-DATE.
  4068***  Y2K PROJ 7744
  4069     MOVE ER-2285                TO EMI-ERROR.
  4070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4071     GO TO 7100-NEXT-PLAN.
  4072
  4073 7175-NOTFOUND.
  4074     IF BROWSE-STARTED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  82
* EL6561.cbl
  4075         PERFORM 7950-END-BROWSE THRU 7950-EXIT.
  4076
  4077     GO TO 8880-NOT-FOUND.
  4078
  4079 7199-EXIT.
  4080     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  83
* EL6561.cbl
  4082
  4083 7200-PRIOR-PLAN.
  4084     MOVE SPACES             TO  PI-ERRATE-EOF-SW.
  4085
  4086     MOVE PI-COMPANY-CD      TO  PI-RATE-COMPANY-CD.
  4087
  4088     PERFORM 7800-START-BROWSE THRU 7800-EXIT.
  4089
  4090
  4091* EXEC CICS HANDLE CONDITION
  4092*        ENDFILE  (7150-ENDFILE)
  4093*        NOTFND   (7275-NOTFOUND)
  4094*    END-EXEC.
  4095*    MOVE '"$''I                  ! $ #00004029' TO DFHEIV0
  4096     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4098     MOVE X'2420233030303034303239' TO DFHEIV0(25:11)
  4099     CALL 'kxdfhei1' USING DFHEIV0
  4100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4101
  4102
  4103     PERFORM 7850-READNEXT THRU 7850-EXIT.
  4104
  4105     IF ERRATE-EOF
  4106         GO TO 7150-ENDFILE.
  4107
  4108     MOVE PI-ERRATE-KEY      TO PI-SAVE-ERRATE-KEY.
  4109     MOVE PI-RATE-STATE-CODE TO WS-SAVE-STRUCTURE.
  4110
  4111 7225-READ-PREV.
  4112     PERFORM 7900-READPREV THRU 7900-EXIT.
  4113
  4114     IF ERRATE-EOF
  4115         GO TO 7150-ENDFILE.
  4116
  4117     IF PI-ERRATE-KEY = PI-SAVE-ERRATE-KEY
  4118         GO TO 7225-READ-PREV.
  4119
  4120     IF PI-RATE-STATE-CODE = WS-SAVE-STRUCTURE
  4121         NEXT SENTENCE
  4122     ELSE
  4123         GO TO 7150-ENDFILE.
  4124
  4125     MOVE RT-LAST-MAINT-USER     TO PI-UPDATE-BY.
  4126     MOVE RT-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  4127     MOVE PI-ERRATE-KEY          TO PI-SAVE-ERRATE-KEY.
  4128     MOVE LOW-VALUES             TO EL6561AO.
  4129
  4130     GO TO 3025-SET-UP-SCREEN-B.
  4131
  4132 7275-NOTFOUND.
  4133     IF BROWSE-STARTED
  4134         PERFORM 7950-END-BROWSE THRU 7950-EXIT.
  4135
  4136     GO TO 8880-NOT-FOUND.
  4137
  4138 7299-EXIT.
  4139     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  84
* EL6561.cbl
  4141
  4142 7400-EDIT-MORTALITY.
  4143     IF  MORTI = SPACES
  4144         GO TO 7499-EXIT.
  4145
  4146     IF  MORTI = 'ZERO'
  4147         MOVE 'ZERO'             TO  WS-MORT-CODE
  4148         GO TO 7499-EXIT.
  4149
  4150     MOVE SPACES                 TO  ELCNTL-KEY.
  4151     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  4152     MOVE '7'                    TO  CNTL-REC-TYPE.
  4153     MOVE +0                     TO  CNTL-SEQ-NO.
  4154
  4155
  4156* EXEC CICS HANDLE CONDITION
  4157*        NOTFND  (7490-NOT-FOUND)
  4158*        ENDFILE (7491-END-OF-FILE)
  4159*    END-EXEC.
  4160*    MOVE '"$I''                  ! % #00004086' TO DFHEIV0
  4161     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4163     MOVE X'2520233030303034303836' TO DFHEIV0(25:11)
  4164     CALL 'kxdfhei1' USING DFHEIV0
  4165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4166
  4167
  4168 7409-READ-NEXT.
  4169
  4170
  4171* EXEC CICS READ
  4172*         DATASET  (CNTL-FILE-ID)
  4173*         SET      (ADDRESS OF CONTROL-FILE)
  4174*         RIDFLD   (ELCNTL-KEY)
  4175*    END-EXEC.
  4176*    MOVE '&"S        E          (   #00004093' TO DFHEIV0
  4177     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4178     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4179     MOVE X'2020233030303034303933' TO DFHEIV0(25:11)
  4180     CALL 'kxdfhei1' USING DFHEIV0,
  4181           CNTL-FILE-ID,
  4182           DFHEIV20,
  4183           DFHEIV99,
  4184           ELCNTL-KEY,
  4185           DFHEIV99,
  4186           DFHEIV99,
  4187           DFHEIV99
  4188     SET ADDRESS OF CONTROL-FILE TO
  4189         DFHEIV20
  4190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4191
  4192
  4193     IF  PI-COMPANY-ID  NOT = CF-COMPANY-ID OR
  4194         CF-RECORD-TYPE NOT = '7'
  4195         GO TO 7490-NOT-FOUND
  4196
  4197     ELSE
  4198         MOVE +1                 TO SUB2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  85
* EL6561.cbl
  4199         GO TO 7410-SEARCH-MORTAL-TABLE.
  4200
  4201 7410-SEARCH-MORTAL-TABLE.
  4202
  4203     IF  CF-MORT-TABLE-CODE (SUB2) = MORTI
  4204         MOVE MORTI TO WS-MORT-CODE
  4205         GO TO 7499-EXIT.
  4206
  4207     IF  CF-MORT-TABLE-CODE (SUB2) = LOW-VALUES
  4208             OR
  4209         CF-MORT-TABLE-CODE (SUB2) GREATER THAN MORTI
  4210         GO TO 7490-NOT-FOUND.
  4211
  4212     ADD +1                      TO SUB2.
  4213
  4214     IF  SUB2 GREATER +9
  4215         ADD +1                  TO  CNTL-SEQ-NO
  4216         GO TO 7409-READ-NEXT
  4217
  4218     ELSE
  4219         GO TO 7410-SEARCH-MORTAL-TABLE.
  4220
  4221 7490-NOT-FOUND.
  4222
  4223     MOVE -1                     TO MORTL.
  4224     MOVE AL-UABON               TO MORTA.
  4225     MOVE ER-2279                TO EMI-ERROR
  4226     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4227     GO TO 7499-EXIT.
  4228
  4229 7491-END-OF-FILE.
  4230
  4231     MOVE -1                     TO MORTL.
  4232     MOVE AL-UABON               TO MORTA.
  4233     MOVE ER-2237                TO EMI-ERROR
  4234     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4235     GO TO 7499-EXIT.
  4236
  4237 7499-EXIT.
  4238     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  86
* EL6561.cbl
  4240
  4241 7500-DEEDIT.
  4242
  4243* EXEC CICS BIF
  4244*         DEEDIT
  4245*         FIELD  (DEEDIT-FIELD)
  4246*         LENGTH (15)
  4247*    END-EXEC.
  4248     MOVE 15
  4249       TO DFHEIV11
  4250*    MOVE '@"L                   #   #00004148' TO DFHEIV0
  4251     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4252     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4253     MOVE X'2020233030303034313438' TO DFHEIV0(25:11)
  4254     CALL 'kxdfhei1' USING DFHEIV0,
  4255           DEEDIT-FIELD,
  4256           DFHEIV11
  4257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4258
  4259
  4260 7500-EXIT.
  4261     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  87
* EL6561.cbl
  4263
  4264 7600-READ-ERRATE-GTEQ.
  4265     MOVE PI-COMPANY-CD  TO  PI-RATE-COMPANY-CD.
  4266
  4267
  4268* EXEC CICS READ
  4269*         DATASET  (RATE-FILE-ID)
  4270*         SET      (ADDRESS OF RATE-RECORD)
  4271*         RIDFLD   (PI-ERRATE-KEY)
  4272*         GTEQ
  4273*    END-EXEC.
  4274*    MOVE '&"S        G          (   #00004161' TO DFHEIV0
  4275     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  4276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4277     MOVE X'2020233030303034313631' TO DFHEIV0(25:11)
  4278     CALL 'kxdfhei1' USING DFHEIV0,
  4279           RATE-FILE-ID,
  4280           DFHEIV20,
  4281           DFHEIV99,
  4282           PI-ERRATE-KEY,
  4283           DFHEIV99,
  4284           DFHEIV99,
  4285           DFHEIV99
  4286     SET ADDRESS OF RATE-RECORD TO
  4287         DFHEIV20
  4288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4289
  4290
  4291     MOVE RT-LAST-MAINT-USER     TO PI-UPDATE-BY.
  4292     MOVE RT-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  4293
  4294     MOVE RT-CONTROL-PRIMARY     TO PI-ERRATE-KEY.
  4295
  4296 7600-EXIT.
  4297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  88
* EL6561.cbl
  4299
  4300 7650-READ-ERRATE.
  4301     MOVE PI-COMPANY-CD  TO  PI-RATE-COMPANY-CD.
  4302
  4303
  4304* EXEC CICS READ
  4305*         DATASET  (RATE-FILE-ID)
  4306*         SET      (ADDRESS OF RATE-RECORD)
  4307*         RIDFLD   (PI-ERRATE-KEY)
  4308*    END-EXEC.
  4309*    MOVE '&"S        E          (   #00004180' TO DFHEIV0
  4310     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4311     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4312     MOVE X'2020233030303034313830' TO DFHEIV0(25:11)
  4313     CALL 'kxdfhei1' USING DFHEIV0,
  4314           RATE-FILE-ID,
  4315           DFHEIV20,
  4316           DFHEIV99,
  4317           PI-ERRATE-KEY,
  4318           DFHEIV99,
  4319           DFHEIV99,
  4320           DFHEIV99
  4321     SET ADDRESS OF RATE-RECORD TO
  4322         DFHEIV20
  4323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4324
  4325
  4326     MOVE RT-LAST-MAINT-USER     TO PI-UPDATE-BY.
  4327     MOVE RT-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  4328
  4329 7650-EXIT.
  4330     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  89
* EL6561.cbl
  4332
  4333 7700-ERRATE-GETMAIN.
  4334
  4335* EXEC CICS GETMAIN
  4336*         SET     (ADDRESS OF RATE-RECORD)
  4337*         LENGTH  (ERRATE-LENGTH)
  4338*         INITIMG (GETMAIN-SPACE)
  4339*         END-EXEC.
  4340*    MOVE ',"IL                  $   #00004194' TO DFHEIV0
  4341     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4342     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4343     MOVE X'2020233030303034313934' TO DFHEIV0(25:11)
  4344     CALL 'kxdfhei1' USING DFHEIV0,
  4345           DFHEIV20,
  4346           ERRATE-LENGTH,
  4347           GETMAIN-SPACE
  4348     SET ADDRESS OF RATE-RECORD TO
  4349         DFHEIV20
  4350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4351
  4352
  4353 7700-EXIT.
  4354     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  90
* EL6561.cbl
  4356
  4357 7750-READ-ERRATE-UPDATE.
  4358     MOVE PI-COMPANY-CD  TO  PI-RATE-COMPANY-CD.
  4359
  4360
  4361* EXEC CICS READ
  4362*         DATASET  (RATE-FILE-ID)
  4363*         SET      (ADDRESS OF RATE-RECORD)
  4364*         RIDFLD   (PI-ERRATE-KEY)
  4365*         UPDATE
  4366*    END-EXEC.
  4367*    MOVE '&"S        EU         (   #00004207' TO DFHEIV0
  4368     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4369     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4370     MOVE X'2020233030303034323037' TO DFHEIV0(25:11)
  4371     CALL 'kxdfhei1' USING DFHEIV0,
  4372           RATE-FILE-ID,
  4373           DFHEIV20,
  4374           DFHEIV99,
  4375           PI-ERRATE-KEY,
  4376           DFHEIV99,
  4377           DFHEIV99,
  4378           DFHEIV99
  4379     SET ADDRESS OF RATE-RECORD TO
  4380         DFHEIV20
  4381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4382
  4383
  4384 7750-EXIT.
  4385     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  91
* EL6561.cbl
  4387
  4388 7800-START-BROWSE.
  4389
  4390* EXEC CICS STARTBR
  4391*         DATASET  (RATE-FILE-ID)
  4392*         RIDFLD   (PI-ERRATE-KEY)
  4393*    END-EXEC.
  4394     MOVE 0
  4395       TO DFHEIV11
  4396*    MOVE '&,         G          &   #00004219' TO DFHEIV0
  4397     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4398     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4399     MOVE X'2020233030303034323139' TO DFHEIV0(25:11)
  4400     CALL 'kxdfhei1' USING DFHEIV0,
  4401           RATE-FILE-ID,
  4402           PI-ERRATE-KEY,
  4403           DFHEIV99,
  4404           DFHEIV11,
  4405           DFHEIV99
  4406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4407
  4408
  4409     MOVE 'Y' TO PI-BROWSE-SW.
  4410
  4411 7800-EXIT.
  4412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  92
* EL6561.cbl
  4414
  4415 7850-READNEXT.
  4416
  4417* EXEC CICS READNEXT
  4418*         DATASET  (RATE-FILE-ID)
  4419*         SET      (ADDRESS OF RATE-RECORD)
  4420*         RIDFLD   (PI-ERRATE-KEY)
  4421*    END-EXEC.
  4422     MOVE 0
  4423       TO DFHEIV11
  4424*    MOVE '&.S                   )   #00004231' TO DFHEIV0
  4425     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4426     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4427     MOVE X'2020233030303034323331' TO DFHEIV0(25:11)
  4428     CALL 'kxdfhei1' USING DFHEIV0,
  4429           RATE-FILE-ID,
  4430           DFHEIV20,
  4431           DFHEIV99,
  4432           PI-ERRATE-KEY,
  4433           DFHEIV99,
  4434           DFHEIV11,
  4435           DFHEIV99,
  4436           DFHEIV99
  4437     SET ADDRESS OF RATE-RECORD TO
  4438         DFHEIV20
  4439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4440
  4441
  4442     IF PI-COMPANY-CD NOT = RT-COMPANY-CD
  4443         MOVE LOW-VALUES TO EL6561AO
  4444         MOVE 'Y'        TO PI-ERRATE-EOF-SW.
  4445
  4446 7850-EXIT.
  4447     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  93
* EL6561.cbl
  4449
  4450 7900-READPREV.
  4451
  4452* EXEC CICS READPREV
  4453*         DATASET  (RATE-FILE-ID)
  4454*         SET      (ADDRESS OF RATE-RECORD)
  4455*         RIDFLD   (PI-ERRATE-KEY)
  4456*    END-EXEC.
  4457     MOVE 0
  4458       TO DFHEIV11
  4459*    MOVE '&0S                   )   #00004246' TO DFHEIV0
  4460     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4461     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4462     MOVE X'2020233030303034323436' TO DFHEIV0(25:11)
  4463     CALL 'kxdfhei1' USING DFHEIV0,
  4464           RATE-FILE-ID,
  4465           DFHEIV20,
  4466           DFHEIV99,
  4467           PI-ERRATE-KEY,
  4468           DFHEIV99,
  4469           DFHEIV11,
  4470           DFHEIV99,
  4471           DFHEIV99
  4472     SET ADDRESS OF RATE-RECORD TO
  4473         DFHEIV20
  4474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4475
  4476
  4477     IF PI-COMPANY-CD NOT = RT-COMPANY-CD
  4478         MOVE LOW-VALUES TO EL6561AO
  4479         MOVE 'Y'        TO PI-ERRATE-EOF-SW.
  4480
  4481 7900-EXIT.
  4482     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  94
* EL6561.cbl
  4484
  4485 7950-END-BROWSE.
  4486
  4487* EXEC CICS ENDBR
  4488*         DATASET  (RATE-FILE-ID)
  4489*         END-EXEC.
  4490     MOVE 0
  4491       TO DFHEIV11
  4492*    MOVE '&2                    $   #00004261' TO DFHEIV0
  4493     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4494     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4495     MOVE X'2020233030303034323631' TO DFHEIV0(25:11)
  4496     CALL 'kxdfhei1' USING DFHEIV0,
  4497           RATE-FILE-ID,
  4498           DFHEIV11,
  4499           DFHEIV99
  4500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4501
  4502
  4503     MOVE SPACE TO PI-BROWSE-SW.
  4504
  4505 7950-EXIT.
  4506     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  95
* EL6561.cbl
  4508 8000-UPDATE-MAINT-DATE.
  4509     MOVE SPACES                 TO ELCNTL-KEY.
  4510
  4511     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  4512     MOVE '1'                    TO CNTL-REC-TYPE.
  4513     MOVE +0                     TO CNTL-SEQ-NO.
  4514
  4515
  4516* EXEC CICS HANDLE CONDITION
  4517*        NOTFND   (8000-EXIT)
  4518*    END-EXEC.
  4519*    MOVE '"$I                   ! & #00004277' TO DFHEIV0
  4520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4522     MOVE X'2620233030303034323737' TO DFHEIV0(25:11)
  4523     CALL 'kxdfhei1' USING DFHEIV0
  4524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4525
  4526
  4527
  4528* EXEC CICS READ
  4529*        UPDATE
  4530*        DATASET   (CNTL-FILE-ID)
  4531*        SET       (ADDRESS OF CONTROL-FILE)
  4532*        RIDFLD    (ELCNTL-KEY)
  4533*    END-EXEC.
  4534*    MOVE '&"S        EU         (   #00004281' TO DFHEIV0
  4535     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4536     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4537     MOVE X'2020233030303034323831' TO DFHEIV0(25:11)
  4538     CALL 'kxdfhei1' USING DFHEIV0,
  4539           CNTL-FILE-ID,
  4540           DFHEIV20,
  4541           DFHEIV99,
  4542           ELCNTL-KEY,
  4543           DFHEIV99,
  4544           DFHEIV99,
  4545           DFHEIV99
  4546     SET ADDRESS OF CONTROL-FILE TO
  4547         DFHEIV20
  4548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4549
  4550
  4551     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4552     MOVE 'B'                    TO JP-RECORD-TYPE.
  4553     MOVE CNTL-FILE-ID           TO FILE-ID.
  4554*    PERFORM 8400-LOG-JOURNAL-RECORD
  4555*                                thru 8400-exit
  4556
  4557     MOVE BIN-CURRENT-SAVE       TO CF-RATES-FILE-MAINT-DT.
  4558
  4559     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4560     MOVE 'C'                    TO JP-RECORD-TYPE.
  4561     MOVE CNTL-FILE-ID           TO FILE-ID.
  4562
  4563
  4564* EXEC CICS REWRITE
  4565*        DATASET   (CNTL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  96
* EL6561.cbl
  4566*        FROM      (CONTROL-FILE)
  4567*    END-EXEC.
  4568     MOVE LENGTH OF
  4569      CONTROL-FILE
  4570       TO DFHEIV11
  4571*    MOVE '&& L                  %   #00004300' TO DFHEIV0
  4572     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4573     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4574     MOVE X'2020233030303034333030' TO DFHEIV0(25:11)
  4575     CALL 'kxdfhei1' USING DFHEIV0,
  4576           CNTL-FILE-ID,
  4577           CONTROL-FILE,
  4578           DFHEIV11,
  4579           DFHEIV99
  4580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4581
  4582
  4583*    PERFORM 8400-LOG-JOURNAL-RECORD
  4584*                                thru 8400-exit
  4585     .
  4586 8000-EXIT.
  4587      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  97
* EL6561.cbl
  4589
  4590 8100-SEND-INITIAL-MAP.
  4591     MOVE EIBTIME              TO TIME-IN.
  4592     MOVE SAVE-DATE            TO RUNDATEO.
  4593     MOVE TIME-OUT             TO RUNTIMEO.
  4594     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  4595     MOVE -1 TO MAXAGEL.
  4596
  4597* EXEC CICS SEND
  4598*        MAP   (WS-MAPNAME)
  4599*        MAPSET(WS-MAPSET-NAME)
  4600*        FROM  (EL6561AO)
  4601*        ERASE
  4602*        CURSOR
  4603*    END-EXEC.
  4604     MOVE LENGTH OF
  4605      EL6561AO
  4606       TO DFHEIV12
  4607     MOVE -1
  4608       TO DFHEIV11
  4609*    MOVE '8$     CT  E    H L F ,   #00004318' TO DFHEIV0
  4610     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4611     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4612     MOVE X'2020233030303034333138' TO DFHEIV0(25:11)
  4613     CALL 'kxdfhei1' USING DFHEIV0,
  4614           WS-MAPNAME,
  4615           EL6561AO,
  4616           DFHEIV12,
  4617           WS-MAPSET-NAME,
  4618           DFHEIV99,
  4619           DFHEIV99,
  4620           DFHEIV99,
  4621           DFHEIV11,
  4622           DFHEIV99,
  4623           DFHEIV99,
  4624           DFHEIV99
  4625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4626
  4627
  4628     GO TO 9100-RETURN-TRAN.
  4629
  4630 8200-SEND-DATAONLY.
  4631     MOVE EIBTIME              TO TIME-IN.
  4632     MOVE SAVE-DATE            TO RUNDATEO.
  4633     MOVE TIME-OUT             TO RUNTIMEO.
  4634     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  4635
  4636* EXEC CICS SEND
  4637*        MAP   (WS-MAPNAME)
  4638*        MAPSET(WS-MAPSET-NAME)
  4639*        FROM  (EL6561AO)
  4640*        DATAONLY
  4641*        CURSOR
  4642*    END-EXEC.
  4643     MOVE LENGTH OF
  4644      EL6561AO
  4645       TO DFHEIV12
  4646     MOVE -1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  98
* EL6561.cbl
  4647       TO DFHEIV11
  4648*    MOVE '8$D    CT       H L F ,   #00004333' TO DFHEIV0
  4649     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4650     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4651     MOVE X'2020233030303034333333' TO DFHEIV0(25:11)
  4652     CALL 'kxdfhei1' USING DFHEIV0,
  4653           WS-MAPNAME,
  4654           EL6561AO,
  4655           DFHEIV12,
  4656           WS-MAPSET-NAME,
  4657           DFHEIV99,
  4658           DFHEIV99,
  4659           DFHEIV99,
  4660           DFHEIV11,
  4661           DFHEIV99,
  4662           DFHEIV99,
  4663           DFHEIV99
  4664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4665
  4666
  4667     GO TO 9100-RETURN-TRAN.
  4668
  4669 8300-SEND-TEXT.
  4670
  4671* EXEC CICS SEND TEXT
  4672*        FROM  (LOGOFF-TEXT)
  4673*        LENGTH(LOGOFF-LENGTH)
  4674*        ERASE
  4675*        FREEKB
  4676*    END-EXEC.
  4677*    MOVE '8&      T  E F  H   F -   #00004344' TO DFHEIV0
  4678     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4679     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4680     MOVE X'2020233030303034333434' TO DFHEIV0(25:11)
  4681     CALL 'kxdfhei1' USING DFHEIV0,
  4682           LOGOFF-TEXT,
  4683           LOGOFF-LENGTH,
  4684           DFHEIV99,
  4685           DFHEIV99,
  4686           DFHEIV99,
  4687           DFHEIV99,
  4688           DFHEIV99,
  4689           DFHEIV99,
  4690           DFHEIV99,
  4691           DFHEIV99,
  4692           DFHEIV99,
  4693           DFHEIV99
  4694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4695
  4696
  4697
  4698* EXEC CICS RETURN
  4699*        END-EXEC.
  4700*    MOVE '.(                    ''   #00004351' TO DFHEIV0
  4701     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4702     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4703     MOVE X'2020233030303034333531' TO DFHEIV0(25:11)
  4704     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page  99
* EL6561.cbl
  4705           DFHEIV99,
  4706           DFHEIV99,
  4707           DFHEIV99,
  4708           DFHEIV99,
  4709           DFHEIV99,
  4710           DFHEIV99
  4711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4712
  4713 8400-LOG-JOURNAL-RECORD.
  4714
  4715     if pi-journal-file-id = 0
  4716        go to 8400-exit
  4717     end-if
  4718
  4719     move eibdate                to jp-date
  4720     move eibtime                to jp-time
  4721     move RATE-FILE-ID           TO JP-FILE-ID
  4722     MOVE PI-PROCESSOR-ID        TO JP-USER-ID
  4723     MOVE 02                     TO PI-JOURNAL-FILE-ID
  4724     MOVE THIS-PGM               TO JP-PROGRAM-ID
  4725
  4726
  4727* EXEC CICS JOURNAL
  4728*       JFILEID   (PI-JOURNAL-FILE-ID)
  4729*       JTYPEID   ('EL')
  4730*       FROM      (JOURNAL-RECORD)
  4731*       LENGTH    (2000)
  4732*       resp      (ws-response)
  4733*    END-EXEC
  4734     MOVE 'EL' TO DFHEIV7
  4735     MOVE 2000
  4736       TO DFHEIV11
  4737*    MOVE '4"LF                  (  N#00004366' TO DFHEIV0
  4738     MOVE X'34224C462020202020202020' TO DFHEIV0(1:12)
  4739     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4740     MOVE X'204E233030303034333636' TO DFHEIV0(25:11)
  4741     CALL 'kxdfhei1' USING DFHEIV0,
  4742           PI-JOURNAL-FILE-ID,
  4743           DFHEIV7,
  4744           JOURNAL-RECORD,
  4745           DFHEIV11,
  4746           DFHEIV99,
  4747           DFHEIV99,
  4748           DFHEIV99
  4749     MOVE EIBRESP  TO ws-response
  4750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4751
  4752     if ws-resp-normal
  4753        continue
  4754     else
  4755        display ' error-el6561-journal ' ws-response
  4756     end-if
  4757
  4758     .
  4759 8400-exit.
  4760     exit.
  4761 8800-UNAUTHORIZED-ACCESS.
  4762     MOVE UNACCESS-MSG TO LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 100
* EL6561.cbl
  4763     GO TO 8300-SEND-TEXT.
  4764
  4765 8810-PF23.
  4766     MOVE EIBAID   TO PI-ENTRY-CD-1.
  4767     MOVE XCTL-005 TO PGM-NAME.
  4768     GO TO 9300-XCTL.
  4769
  4770 8880-NOT-FOUND.
  4771     MOVE ER-0142 TO EMI-ERROR.
  4772     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4773     MOVE -1   TO MAXAGEL.
  4774
  4775     IF EIBTRNID NOT = TRANS-ID
  4776         GO TO 8100-SEND-INITIAL-MAP.
  4777
  4778     GO TO 8200-SEND-DATAONLY.
  4779
  4780 9100-RETURN-TRAN.
  4781     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  4782     MOVE '656B'               TO PI-CURRENT-SCREEN-NO.
  4783
  4784* EXEC CICS RETURN
  4785*        TRANSID (TRANS-ID)
  4786*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4787*        LENGTH  (PI-COMM-LENGTH)
  4788*   END-EXEC.
  4789*    MOVE '.(CT                  ''   #00004405' TO DFHEIV0
  4790     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4791     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4792     MOVE X'2020233030303034343035' TO DFHEIV0(25:11)
  4793     CALL 'kxdfhei1' USING DFHEIV0,
  4794           TRANS-ID,
  4795           PROGRAM-INTERFACE-BLOCK,
  4796           PI-COMM-LENGTH,
  4797           DFHEIV99,
  4798           DFHEIV99,
  4799           DFHEIV99
  4800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4801
  4802
  4803 9200-RETURN-MAIN-MENU.
  4804     MOVE XCTL-626 TO PGM-NAME.
  4805     GO TO 9300-XCTL.
  4806
  4807 9300-XCTL.
  4808
  4809* EXEC CICS XCTL
  4810*        PROGRAM (PGM-NAME)
  4811*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4812*        LENGTH  (PI-COMM-LENGTH)
  4813*    END-EXEC.
  4814*    MOVE '.$C                   %   #00004416' TO DFHEIV0
  4815     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4816     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4817     MOVE X'2020233030303034343136' TO DFHEIV0(25:11)
  4818     CALL 'kxdfhei1' USING DFHEIV0,
  4819           PGM-NAME,
  4820           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 101
* EL6561.cbl
  4821           PI-COMM-LENGTH,
  4822           DFHEIV99
  4823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4824
  4825
  4826 9400-CLEAR.
  4827     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  4828     GO TO 9300-XCTL.
  4829
  4830 9500-PF12.
  4831     MOVE XCTL-010 TO PGM-NAME.
  4832     GO TO 9300-XCTL.
  4833
  4834 9600-PGMID-ERROR.
  4835
  4836* EXEC CICS HANDLE CONDITION
  4837*        PGMIDERR(8300-SEND-TEXT)
  4838*    END-EXEC.
  4839*    MOVE '"$L                   ! '' #00004431' TO DFHEIV0
  4840     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4842     MOVE X'2720233030303034343331' TO DFHEIV0(25:11)
  4843     CALL 'kxdfhei1' USING DFHEIV0
  4844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4845
  4846
  4847     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  4848     MOVE ' '          TO PI-ENTRY-CD-1.
  4849     MOVE XCTL-005     TO PGM-NAME.
  4850     MOVE PGM-NAME     TO LOGOFF-PGM.
  4851     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  4852     GO TO 9300-XCTL.
  4853
  4854 9700-LINK-DATE-CONVERT.
  4855     MOVE LINK-ELDATCV TO PGM-NAME.
  4856
  4857
  4858* EXEC CICS LINK
  4859*        PROGRAM (PGM-NAME)
  4860*        COMMAREA(DATE-CONVERSION-DATA)
  4861*        LENGTH  (DC-COMM-LENGTH)
  4862*    END-EXEC.
  4863*    MOVE '."C                   (   #00004445' TO DFHEIV0
  4864     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4865     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4866     MOVE X'2020233030303034343435' TO DFHEIV0(25:11)
  4867     CALL 'kxdfhei1' USING DFHEIV0,
  4868           PGM-NAME,
  4869           DATE-CONVERSION-DATA,
  4870           DC-COMM-LENGTH,
  4871           DFHEIV99,
  4872           DFHEIV99,
  4873           DFHEIV99,
  4874           DFHEIV99
  4875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4876
  4877
  4878 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 102
* EL6561.cbl
  4879     EXIT.
  4880
  4881 9900-ERROR-FORMAT.
  4882     IF NOT EMI-ERRORS-COMPLETE
  4883         MOVE LINK-001 TO PGM-NAME
  4884
  4885* EXEC CICS LINK
  4886*            PROGRAM (PGM-NAME)
  4887*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4888*            LENGTH  (EMI-COMM-LENGTH)
  4889*        END-EXEC.
  4890*    MOVE '."C                   (   #00004457' TO DFHEIV0
  4891     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4893     MOVE X'2020233030303034343537' TO DFHEIV0(25:11)
  4894     CALL 'kxdfhei1' USING DFHEIV0,
  4895           PGM-NAME,
  4896           ERROR-MESSAGE-INTERFACE-BLOCK,
  4897           EMI-COMM-LENGTH,
  4898           DFHEIV99,
  4899           DFHEIV99,
  4900           DFHEIV99,
  4901           DFHEIV99
  4902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4903
  4904
  4905 9900-EXIT.
  4906     EXIT.
  4907
  4908 9990-ABEND.
  4909     MOVE LINK-004     TO PGM-NAME.
  4910     MOVE DFHEIBLK     TO EMI-LINE1
  4911
  4912* EXEC CICS LINK
  4913*        PROGRAM   (PGM-NAME)
  4914*        COMMAREA  (EMI-LINE1)
  4915*        LENGTH    (72)
  4916*    END-EXEC.
  4917     MOVE 72
  4918       TO DFHEIV11
  4919*    MOVE '."C                   (   #00004469' TO DFHEIV0
  4920     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4921     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4922     MOVE X'2020233030303034343639' TO DFHEIV0(25:11)
  4923     CALL 'kxdfhei1' USING DFHEIV0,
  4924           PGM-NAME,
  4925           EMI-LINE1,
  4926           DFHEIV11,
  4927           DFHEIV99,
  4928           DFHEIV99,
  4929           DFHEIV99,
  4930           DFHEIV99
  4931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4932
  4933
  4934     GO TO 8200-SEND-DATAONLY.
  4935
  4936
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 103
* EL6561.cbl
  4937* GOBACK.
  4938     MOVE '9%                    "   ' TO DFHEIV0
  4939     MOVE 'EL6561' TO DFHEIV1
  4940     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4941     GOBACK.
  4942
  4943 9995-SECURITY-VIOLATION.
  4944*                            COPY ELCSCTP.
  4945******************************************************************
  4946*                                                                *
  4947*                            ELCSCTP                             *
  4948*                            VMOD=2.001                          *
  4949*                                                                *
  4950*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4951******************************************************************
  4952
  4953
  4954     MOVE EIBDATE          TO SM-JUL-DATE.
  4955     MOVE EIBTRMID         TO SM-TERMID.
  4956     MOVE THIS-PGM         TO SM-PGM.
  4957     MOVE EIBTIME          TO TIME-IN.
  4958     MOVE TIME-OUT         TO SM-TIME.
  4959     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4960
  4961
  4962* EXEC CICS LINK
  4963*         PROGRAM  ('EL003')
  4964*         COMMAREA (SECURITY-MESSAGE)
  4965*         LENGTH   (80)
  4966*    END-EXEC.
  4967     MOVE 'EL003' TO DFHEIV1
  4968     MOVE 80
  4969       TO DFHEIV11
  4970*    MOVE '."C                   (   #00004497' TO DFHEIV0
  4971     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4973     MOVE X'2020233030303034343937' TO DFHEIV0(25:11)
  4974     CALL 'kxdfhei1' USING DFHEIV0,
  4975           DFHEIV1,
  4976           SECURITY-MESSAGE,
  4977           DFHEIV11,
  4978           DFHEIV99,
  4979           DFHEIV99,
  4980           DFHEIV99,
  4981           DFHEIV99
  4982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4983
  4984
  4985******************************************************************
  4986
  4987
  4988 9995-EXIT.
  4989      EXIT.
  4990
  4991 9999-DFHBACK SECTION.
  4992     MOVE '9%                    "   ' TO DFHEIV0
  4993     MOVE 'EL6561' TO DFHEIV1
  4994     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:21 Page 104
* EL6561.cbl
  4995     GOBACK.
  4996 9999-DFHEXIT.
  4997     IF DFHEIGDJ EQUAL 0001
  4998         NEXT SENTENCE
  4999     ELSE IF DFHEIGDJ EQUAL 2
  5000         GO TO 9990-ABEND,
  5001               8880-NOT-FOUND,
  5002               9600-PGMID-ERROR,
  5003               9990-ABEND
  5004         DEPENDING ON DFHEIGDI
  5005     ELSE IF DFHEIGDJ EQUAL 3
  5006         GO TO 7150-ENDFILE,
  5007               7175-NOTFOUND
  5008         DEPENDING ON DFHEIGDI
  5009     ELSE IF DFHEIGDJ EQUAL 4
  5010         GO TO 7150-ENDFILE,
  5011               7275-NOTFOUND
  5012         DEPENDING ON DFHEIGDI
  5013     ELSE IF DFHEIGDJ EQUAL 5
  5014         GO TO 7490-NOT-FOUND,
  5015               7491-END-OF-FILE
  5016         DEPENDING ON DFHEIGDI
  5017     ELSE IF DFHEIGDJ EQUAL 6
  5018         GO TO 8000-EXIT
  5019         DEPENDING ON DFHEIGDI
  5020     ELSE IF DFHEIGDJ EQUAL 7
  5021         GO TO 8300-SEND-TEXT
  5022         DEPENDING ON DFHEIGDI.
  5023     MOVE '9%                    "   ' TO DFHEIV0
  5024     MOVE 'EL6561' TO DFHEIV1
  5025     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5026     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6428     Code:       10462
