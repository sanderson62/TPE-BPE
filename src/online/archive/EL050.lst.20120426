* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page   1
* EL050.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL050.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page   2
* EL050.cbl
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page   3
* EL050.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46
    47 77  FILLER   PIC X(32) VALUE '********************************'.
    48 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    49 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    50
    51 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    52 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    53                                   USAGE POINTER.
    54 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    55 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    56 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    57                                   USAGE IS POINTER.
    58 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    59 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    60                                   USAGE IS POINTER.
    61 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    63                                   USAGE IS POINTER.
    64
    65 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69*    COPY ELC50WS.
    70*****************************************************************
    71*                                                               *
    72*                            ELC50WS.                           *
    73*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    74*                            VMOD=2.061.                        *
    75*                                                               *
    76*   THIS IS THE WORKING STORAGE FOR EL050                       *
    77*                                   EL517                       *
    78*****************************************************************
    79******************************************************************
    80*                   C H A N G E   L O G
    81*
    82* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    83*-----------------------------------------------------------------
    84*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    85* EFFECTIVE    NUMBER
    86*-----------------------------------------------------------------
    87* 123102                   PEMA  ADD DCC PROCESSING
    88* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    89* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    90* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    91* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    92* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    93* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    94* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    95* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
    96* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
    97* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    98* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
    99* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   100* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   101* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page   4
* EL050.cbl
   102* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   103* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   104* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   105* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   106* 030309  CR2009021700001  PEMA  ADD ER-2883
   107* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   109* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   110* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   111* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   112* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   113* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   114* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   115* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   117* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   118* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   119*-----------------------------------------------------------------
   120
   121 01  WORK-AREAS.
   122
   123*****************************************************************
   124*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   125*****************************************************************
   126
   127     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   128     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   129     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   130     12  WS-NAME-EDIT-WORK-AREA.
   131         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   132         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   133             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   134         16  WS-WORK-NAME.
   135             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   136             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   137             20  FILLER           PIC X(10)     VALUE SPACES.
   138         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   139             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   140
   141*****************************************************************
   142*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   143*****************************************************************
   144
   145     12  WS-ERRESC-KEY.
   146         16 WS-ERRESC-SEARCH-KEY.
   147             20  WS-ERRESC-COMPANY-CD PIC  X.
   148             20  WS-ERRESC-CARRIER    PIC  X.
   149             20  WS-ERRESC-GROUP      PIC X(6).
   150             20  WS-ERRESC-STATE      PIC XX.
   151             20  WS-ERRESC-ACCOUNT    PIC X(10).
   152         16 WS-ERRESC-RESIDUAL-KEY.
   153             20  WS-ERRESC-AGENT      PIC X(10).
   154             20  WS-ERRESC-RES-STATE  PIC XX.
   155             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   156*                                          YYYYMMDD
   157     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   158     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   159
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page   5
* EL050.cbl
   160*RESIDENT STATE TAX MASTER(ERRESS)
   161*
   162     12  WS-ERRESS-KEY.
   163         16  WS-ERRESS-COMPANY-CD      PIC  X.
   164         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   165         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   166         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   167*                                          YYYYMMDD
   168
   169     12  WS-CONTRACT-DATE              PIC 9(8).
   170*                                          YYYYMMDD
   171     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   172     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   173         16 WS-YEAR-YY                 PIC   9999.
   174         16 FILLER                     PIC 9(4).
   175*                                          YYYYMMDD
   176     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   177     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   178     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   179     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   180
   181     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   182         88  DPRB-1ST-TIME                      VALUE ' '.
   183
   184*****************************************************************
   185*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   186*****************************************************************
   187
   188     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   189     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   190     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   191     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   192     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   193     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   194     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   195     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   196     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   197     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   198         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   199         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   200     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   201         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   202         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   203     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   204
   205     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   206     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   207
   208     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   209     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   210     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   211     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   212     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   213     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   214     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   215     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page   6
* EL050.cbl
   218     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   220     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   221     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   222     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   223     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   239     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   244     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   245     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   246     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   247     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   248     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   249     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   250     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   251     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   252     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   254     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   255     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   256     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   257     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   258     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   259     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   260     12  WS-2671-SW               PIC X         VALUE SPACE.
   261     12  WS-2672-SW               PIC X         VALUE SPACE.
   262     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   263         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   264     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   265         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   266     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   267
   268     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   269         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   270         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   271         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   272         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   273
   274     12  WS-CREDIT-EDIT-CONTROLS.
   275         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page   7
* EL050.cbl
   276         16  WS-MIN-AGE           PIC 99                VALUE  0.
   277         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   278         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   279         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   280         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   281
   282     12  WS-SAVE-ALLOWABLE-BENEFIT.
   283         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   284         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   285         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   286         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   287         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   288         16  FILLER                      PIC XX.
   289
   290     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   291     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   292     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   293     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   294     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   295     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   296     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   297     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   298     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   299     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   300
   301     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   302     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   303     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   304     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   305     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   306     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   307     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   308     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   309         88  WS-REDUCING              VALUE 'R'.
   310         88  WS-LEVEL                 VALUE 'L' 'P'.
   311     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   312
   313     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   314     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   315     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   316     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   317     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   318     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   319     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   320     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   321     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   322
   323     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   324     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   325     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   326     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   327     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   328     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   329     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   330     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   331     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   332     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   333     12  WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page   8
* EL050.cbl
   334         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   335         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   336     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   337     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   338     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   339     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   340     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   341     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   342     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   343     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   344     12  WS-INITIALS.
   345         16  WS-INIT-1            PIC X         VALUE SPACES.
   346         16  WS-INIT-2            PIC X         VALUE SPACES.
   347
   348     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   349     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   350     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   351     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   352     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   353*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   354     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   355     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   356     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   357     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   358     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   359     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   360     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   361     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   362     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   363     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   364     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   365     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   366     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   367     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   368     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   369     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   370     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   371     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   372     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   373     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   374     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   375     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   376******** FLA
   377     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   378     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   379     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   380     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   381     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   382********
   383     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   384     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   385     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   386     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   387     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   388     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   389     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   390     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   391     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page   9
* EL050.cbl
   392     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   393
   394     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   395         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   396                                         '0' THRU '9'.
   397
   398     12  NUMBER-OF-MONTHS.
   399         16  SK-MO OCCURS 12 TIMES PIC X.
   400
   401     12  WS-WORK-DATE.
   402         16  WS-YEAR            PIC 99    VALUE 00.
   403         16  WS-MONTH           PIC 99    VALUE 00.
   404         16  WS-DAY             PIC 99    VALUE 00.
   405
   406     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   407     12  WS-WORK-CRIT-DEV       REDEFINES
   408         WS-WORK-LF-CRIT-PER    PIC X(03).
   409
   410     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   411     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   412
   413     12  WS-WORK-DATE-FROM.
   414         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   415         16  FILLER             PIC X  VALUE SPACE.
   416         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   417         16  FILLER             PIC X         VALUE SPACE.
   418         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   419
   420     12  WS-WORK-DATE-THRU.
   421         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   422         16  FILLER             PIC X         VALUE SPACE.
   423         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   424         16  FILLER             PIC X         VALUE SPACE.
   425         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   426
   427     12  WS-LF-INPUT-CD.
   428         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   429         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   430
   431     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   432     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   433         16  WS-AH-INPUT-CD-1   PIC X.
   434         16  WS-AH-INPUT-CD-2-3 PIC XX.
   435
   436     12  WS-SWITCHES.
   437         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   438         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   439             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   440         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   441             88  BANK-ACCT-FOUND          VALUE 'Y'.
   442         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   443             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   444         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   445             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   446         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   447             88  COMP-MASTER-FOUND        VALUE 'Y'.
   448         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   449             88  LOFC-MASTER-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  10
* EL050.cbl
   450         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   451             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   452         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   453             88  STAT-MASTER-FOUND        VALUE 'Y'.
   454         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   455             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   456         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   457             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   458         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   459             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   460         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   461             88  FORM-MASTER-FOUND        VALUE 'Y'.
   462         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   463             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   464         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   465             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   466         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   467             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   468         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   469             88  NO-BENEFIT-FOUND         VALUE 'N'.
   470         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   471             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   472         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   473             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   474         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   475             88  AH-BENEFIT-FOUND         VALUE ' '.
   476             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   477         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   478             88  LF-BENEFIT-FOUND         VALUE ' '.
   479             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   480         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   481             88  NO-STATE-RECORD          VALUE '1'.
   482         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   483             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   484         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   485             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   486         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   487             88  CERT-WAS-FOUND           VALUE ' '.
   488             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   489         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   490             88  BROWSE-STARTED           VALUE 'Y'.
   491         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   492             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   493         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   494             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   495         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   496             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   497         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   498             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   499         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   500             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   501         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   502             88  APP-CERT-USED            VALUE 'Y' 'A'.
   503         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   504             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   505             88  FIRST-TIME-THROUGH       VALUE '1'.
   506             88  CTBL-NOT-FOUND           VALUE '2'.
   507
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  11
* EL050.cbl
   508         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   509             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   510
   511         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   512             88  DLO-ERROR-FOUND          VALUE 'Y'.
   513
   514********FLA
   515     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   516     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   517********
   518     12  RC-SW-1                  PIC X           VALUE '0'.
   519     12  RC-SW-2                  PIC X           VALUE '0'.
   520     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   521     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   522     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   523     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   524     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   525     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   526     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   527     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   528     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   529     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   530     12  LIT-SPACES               PIC X           VALUE SPACES.
   531     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   532     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   533     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   534     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   535     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   536     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   537     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   538         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   539         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   540     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   541         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   542
   543 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   544     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   545     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   546 01  WS-CRI-SSN-WORK-AREA.
   547     05  WS-CRI-SOC-SEC-NO.
   548         10  WS-SS-REPT-CD       PIC X(5).
   549         10  WS-SS-LAST-NAME     PIC X(5).
   550         10  WS-SS-INITIAL       PIC X.
   551
   552     05  WS-CRI-REPORT-CODE.
   553         10  FILLER              PIC X(5).
   554         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   555
   556     05  WS-CRI-LAST-NAME.
   557         10  WS-CRI-NAME-MOVE    PIC X(5).
   558         10  FILLER              PIC X(10).
   559
   560 01  WS-NUM-TABLE                PIC X(26)  VALUE
   561     '12345678012345070923456789'.
   562 01  FILLER REDEFINES WS-NUM-TABLE.
   563     05  WS-NUM OCCURS 26        PIC 9.
   564 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   565 01  V1                          PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  12
* EL050.cbl
   566 01  V2                          PIC S999 COMP-3.
   567 01  V3                          PIC S999 COMP-3.
   568 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   569 01  FILLER REDEFINES WS-WORK-VIN.
   570     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   571 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   572 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   573 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   574 01  WS-HEX-WORK.
   575     05  FILLER                  PIC X  VALUE LOW-VALUES.
   576     05  WS-HEX-BYTE             PIC X.
   577 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   578 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   579 01  WS-WORK-HIN-ROW-B.
   580     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   581
   582 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   583 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   584     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   585 01  WS-ROW-D-TABLE.
   586     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   587
   588 01  WS-HIN-TABLE-B.
   589     05  F                       PIC XX VALUE 'A2'.
   590     05  F                       PIC XX VALUE 'B3'.
   591     05  F                       PIC XX VALUE 'C4'.
   592     05  F                       PIC XX VALUE 'D5'.
   593     05  F                       PIC XX VALUE 'E6'.
   594     05  F                       PIC XX VALUE 'F7'.
   595     05  F                       PIC XX VALUE 'G8'.
   596     05  F                       PIC XX VALUE 'H9'.
   597     05  F                       PIC XX VALUE 'I1'.
   598     05  F                       PIC XX VALUE 'J2'.
   599     05  F                       PIC XX VALUE 'K3'.
   600     05  F                       PIC XX VALUE 'L4'.
   601     05  F                       PIC XX VALUE 'M5'.
   602     05  F                       PIC XX VALUE 'N6'.
   603     05  F                       PIC XX VALUE 'O0'.
   604     05  F                       PIC XX VALUE 'P7'.
   605     05  F                       PIC XX VALUE 'Q0'.
   606     05  F                       PIC XX VALUE 'R8'.
   607     05  F                       PIC XX VALUE 'S9'.
   608     05  F                       PIC XX VALUE 'T2'.
   609     05  F                       PIC XX VALUE 'U3'.
   610     05  F                       PIC XX VALUE 'V4'.
   611     05  F                       PIC XX VALUE 'W5'.
   612     05  F                       PIC XX VALUE 'X6'.
   613     05  F                       PIC XX VALUE 'Y7'.
   614     05  F                       PIC XX VALUE 'Z8'.
   615 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   616     05  WS-VAL-IN               PIC X.
   617     05  WS-VAL-OUT              PIC 9.
   618 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   619 01  WS-COMPARE-BINARY-DATES.
   620     05  WS-971231                PIC XX VALUE X'92FF'.
   621     05  WS-931231                PIC XX VALUE X'8CFF'.
   622     05  WS-791231                PIC XX VALUE X'77FF'.
   623     05  WS-771001                PIC XX VALUE X'74A1'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  13
* EL050.cbl
   624     05  WS-820301                PIC XX VALUE X'7B41'.
   625     05  WS-831031                PIC XX VALUE X'7DBF'.
   626     05  WS-831231                PIC XX VALUE X'7DFF'.
   627     05  WS-810831                PIC XX VALUE X'7A7F'.
   628     05  WS-830901                PIC XX VALUE X'7D81'.
   629
   630 01  FILE-ACCESS-IDS.
   631     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   632     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   633     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   634     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   635     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   636     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   637     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   638     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   639     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   640     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   641     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   642     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   643     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   644     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   645     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   646     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   647     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   648 01  DD-IU-SW                    PIC X   VALUE ' '.
   649     88  DD-IU-PRESENT                 VALUE 'Y'.
   650
   651 01  ACCESS-KEYS.
   652     12  ELMSTR-KEY.
   653         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   654         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   655     12  W-CLAIM-KEY.
   656         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   657         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   658
   659     12  ELCNTL-KEY.
   660         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   661         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   662         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   663         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   664
   665     12  ELCERT-KEY.
   666         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   667         16  CERT-CARRIER         PIC X       VALUE SPACE.
   668         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   669         16  CERT-STATE           PIC XX      VALUE SPACES.
   670         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   671         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   672         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   673
   674     12  ELCERT2-KEY.
   675         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   676         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   677
   678     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   679
   680     12  ELCERT-SAVE.
   681         16  FILLER                      PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  14
* EL050.cbl
   682
   683         16  WCS-CONTROL-PRIMARY.
   684             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   685             20  WCS-CARRIER             PIC X     VALUE SPACE.
   686             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   687             20  WCS-STATE               PIC XX    VALUE SPACES.
   688             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   689             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   690             20  WCS-CERT-NO.
   691                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   692                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   693
   694         16  CS-CONTROL-BY-NAME.
   695             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   696             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   697             20  CS-INSURED-INITIALS.
   698                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   699                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   700
   701         16  CS-CONTROL-BY-SSN.
   702             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   703             20  CS-SOC-SEC-NO.
   704                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   705                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   706                 24  CS-SSN-LN3.
   707                     28 CS-INSURED-INITIALS-A2   PIC XX
   708                                     VALUE SPACES.
   709                     28 CS-PART-LAST-NAME-A2     PIC X
   710                                     VALUE SPACE.
   711
   712         16  CS-CONTROL-BY-CERT-NO.
   713             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   714             20  CS-CERT-NO-A4           PIC X(11)
   715                                     VALUE SPACES.
   716
   717         16  CS-CONTROL-BY-MEMB.
   718             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   719             20  CS-MEMBER-NO.
   720                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   721                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   722                 24  CS-MEMB-LN4.
   723                     28 CS-INSURED-INITIALS-A5   PIC XX
   724                                      VALUE SPACES.
   725                     28 CS-PART-LAST-NAME-A5     PIC XX
   726                                      VALUE SPACES.
   727
   728         16  FILLER              PIC X(360) VALUE SPACES.
   729
   730     12  ERACCT-KEY.
   731         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   732         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   733         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   734         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   735         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   736         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   737
   738     12  ERCOMP-KEY.
   739         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  15
* EL050.cbl
   740         16  COMP-CARRIER         PIC X     VALUE SPACES.
   741         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   742         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   743         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   744         16  COMP-TYPE            PIC X     VALUE SPACES.
   745
   746     12  ERLOFC-KEY.
   747         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   748         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   749         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   750         16  LOFC-STATE           PIC XX    VALUE SPACES.
   751         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   752         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   753
   754     12  WS-ELCRTT-KEY.
   755         16  WS-ELCRTT-PRIMARY       PIC X(33).
   756         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   757
   758     12  ERBXRF-KEY.
   759         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   760         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   761         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   762         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   763
   764     12  ERAGTC-KEY.
   765         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   766         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   767         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   768         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   769         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   770         16  AGTC-TYPE            PIC X     VALUE SPACES.
   771
   772     12  ERPLAN-KEY.
   773         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   774         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   775         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   776         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   777         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   778         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   779         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   780         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   781
   782     12  ERFORM-KEY.
   783         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   784         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   785         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   786         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   787
   788     12  ERREIN-KEY.
   789         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   790         16  REIN-TYPE            PIC X     VALUE SPACES.
   791         16  REIN-TABLE-CO.
   792             20  REIN-CODE-1      PIC X     VALUE SPACE.
   793             20  REIN-CODE-2      PIC X     VALUE SPACE.
   794             20  REIN-CODE-3      PIC X     VALUE SPACE.
   795         16  FILLER               PIC X(3)  VALUE SPACES.
   796
   797     12  ERCTBL-KEY.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  16
* EL050.cbl
   798         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   799         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   800         16  CTBL-CNTRL-2.
   801             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   802             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   803
   804     12  WS-ACCESS.
   805         16  FILLER               PIC XX    VALUE SPACES.
   806         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   807
   808     12  WS-CARR-ACCESS.
   809         16  FILLER               PIC X(3)  VALUE SPACES.
   810         16  WS-CARR              PIC X     VALUE SPACE.
   811*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   812*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   813     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   814         88  WS-DMD-LF-RATING   VALUE 'Y'.
   815         88  WS-DMD-AH-RATING   VALUE 'Y'.
   816         88  WS-DMD-NO-RATING   VALUE 'N'.
   817
   818     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   819         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   820                                         'NJ' 'NL'
   821                                         'PJ' 'PL'
   822                                         'SJ' 'SL'.
   823     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   824         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   825                                         'NI' 'NJ' 'NL' 'NU'
   826                                         'PJ' 'PL' 'PI' 'PU'
   827                                         'SI' 'SJ' 'SL' 'SU'
   828                                         'MX' 'MY' 'MZ'.
   829 01  ERPDEF-KEY-SAVE             PIC X(18).
   830 01  ERPDEF-KEY.
   831     12  ERPDEF-COMPANY-CD       PIC X.
   832     12  ERPDEF-STATE            PIC XX.
   833     12  ERPDEF-PROD-CD          PIC XXX.
   834     12  F                       PIC X(7).
   835     12  ERPDEF-BEN-TYPE         PIC X.
   836     12  ERPDEF-BEN-CODE         PIC XX.
   837     12  ERPDEF-EXP-DT           PIC XX.
   838
   839 01  ELSTAT-KEY-SAVE             PIC X(20).
   840 01  ELSTAT-KEY.
   841     12  ELSTAT-COMPANY-ID       PIC XXX.
   842     12  ELSTAT-CARRIER          PIC X.
   843     12  ELSTAT-GROUP            PIC X(6).
   844     12  ELSTAT-STATE            PIC XX.
   845     12  ELSTAT-EXP-DT           PIC 9(8).
   846 01  WS-ERROR-VALUES.
   847     12  ER-1570                     PIC S9(4)   VALUE +1570.
   848     12  ER-1571                     PIC S9(4)   VALUE +1571.
   849     12  ER-1575                     PIC S9(4)   VALUE +1575.
   850     12  ER-1891                     PIC S9(4)   VALUE +1891.
   851     12  ER-1892                     PIC S9(4)   VALUE +1892.
   852     12  ER-1893                     PIC S9(4)   VALUE +1893.
   853     12  ER-1894                     PIC S9(4)   VALUE +1894.
   854     12  ER-1895                     PIC S9(4)   VALUE +1895.
   855     12  ER-1896                     PIC S9(4)   VALUE +1896.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  17
* EL050.cbl
   856     12  ER-1897                     PIC S9(4)   VALUE +1897.
   857     12  ER-1898                     PIC S9(4)   VALUE +1898.
   858     12  ER-1899                     PIC S9(4)   VALUE +1899.
   859     12  ER-1900                     PIC S9(4)   VALUE +1900.
   860     12  ER-1901                     PIC S9(4)   VALUE +1901.
   861     12  ER-1902                     PIC S9(4)   VALUE +1902.
   862     12  ER-1903                     PIC S9(4)   VALUE +1903.
   863     12  ER-1904                     PIC S9(4)   VALUE +1904.
   864     12  ER-1905                     PIC S9(4)   VALUE +1905.
   865     12  ER-1906                     PIC S9(4)   VALUE +1906.
   866     12  ER-1907                     PIC S9(4)   VALUE +1907.
   867     12  ER-1909                     PIC S9(4)   VALUE +1909.
   868     12  ER-1910                     PIC S9(4)   VALUE +1910.
   869     12  ER-1911                     PIC S9(4)   VALUE +1911.
   870     12  ER-1912                     PIC S9(4)   VALUE +1912.
   871     12  ER-1913                     PIC S9(4)   VALUE +1913.
   872     12  ER-1914                     PIC S9(4)   VALUE +1914.
   873     12  ER-1915                     PIC S9(4)   VALUE +1915.
   874     12  ER-1916                     PIC S9(4)   VALUE +1916.
   875     12  ER-1917                     PIC S9(4)   VALUE +1917.
   876     12  ER-1918                     PIC S9(4)   VALUE +1918.
   877     12  ER-1919                     PIC S9(4)   VALUE +1919.
   878     12  ER-1920                     PIC S9(4)   VALUE +1920.
   879     12  ER-1921                     PIC S9(4)   VALUE +1921.
   880     12  ER-1922                     PIC S9(4)   VALUE +1922.
   881     12  ER-1923                     PIC S9(4)   VALUE +1923.
   882     12  ER-1924                     PIC S9(4)   VALUE +1924.
   883     12  ER-1925                     PIC S9(4)   VALUE +1925.
   884     12  ER-1926                     PIC S9(4)   VALUE +1926.
   885     12  ER-1927                     PIC S9(4)   VALUE +1927.
   886     12  ER-2393                     PIC S9(4)   VALUE +2393.
   887     12  ER-2600                     PIC S9(4)   VALUE +2600.
   888     12  ER-2601                     PIC S9(4)   VALUE +2601.
   889     12  ER-2602                     PIC S9(4)   VALUE +2602.
   890     12  ER-2603                     PIC S9(4)   VALUE +2603.
   891     12  ER-2604                     PIC S9(4)   VALUE +2604.
   892     12  ER-2605                     PIC S9(4)   VALUE +2605.
   893     12  ER-2606                     PIC S9(4)   VALUE +2606.
   894     12  ER-2607                     PIC S9(4)   VALUE +2607.
   895     12  ER-2608                     PIC S9(4)   VALUE +2608.
   896     12  ER-2609                     PIC S9(4)   VALUE +2609.
   897     12  ER-2610                     PIC S9(4)   VALUE +2610.
   898     12  ER-2611                     PIC S9(4)   VALUE +2611.
   899     12  ER-2612                     PIC S9(4)   VALUE +2612.
   900     12  ER-2613                     PIC S9(4)   VALUE +2613.
   901     12  ER-2614                     PIC S9(4)   VALUE +2614.
   902     12  ER-2615                     PIC S9(4)   VALUE +2615.
   903     12  ER-2616                     PIC S9(4)   VALUE +2616.
   904     12  ER-2617                     PIC S9(4)   VALUE +2617.
   905     12  ER-2618                     PIC S9(4)   VALUE +2618.
   906     12  ER-2619                     PIC S9(4)   VALUE +2619.
   907     12  ER-2620                     PIC S9(4)   VALUE +2620.
   908     12  ER-2621                     PIC S9(4)   VALUE +2621.
   909     12  ER-2622                     PIC S9(4)   VALUE +2622.
   910     12  ER-2623                     PIC S9(4)   VALUE +2623.
   911     12  ER-2624                     PIC S9(4)   VALUE +2624.
   912     12  ER-2625                     PIC S9(4)   VALUE +2625.
   913     12  ER-2626                     PIC S9(4)   VALUE +2626.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  18
* EL050.cbl
   914     12  ER-2627                     PIC S9(4)   VALUE +2627.
   915     12  ER-2628                     PIC S9(4)   VALUE +2628.
   916     12  ER-2629                     PIC S9(4)   VALUE +2629.
   917     12  ER-2630                     PIC S9(4)   VALUE +2630.
   918     12  ER-2631                     PIC S9(4)   VALUE +2631.
   919     12  ER-2632                     PIC S9(4)   VALUE +2632.
   920     12  ER-2633                     PIC S9(4)   VALUE +2633.
   921     12  ER-2634                     PIC S9(4)   VALUE +2634.
   922     12  ER-2635                     PIC S9(4)   VALUE +2635.
   923     12  ER-2636                     PIC S9(4)   VALUE +2636.
   924     12  ER-2637                     PIC S9(4)   VALUE +2637.
   925     12  ER-2638                     PIC S9(4)   VALUE +2638.
   926     12  ER-2639                     PIC S9(4)   VALUE +2639.
   927     12  ER-2640                     PIC S9(4)   VALUE +2640.
   928     12  ER-2641                     PIC S9(4)   VALUE +2641.
   929     12  ER-2642                     PIC S9(4)   VALUE +2642.
   930     12  ER-2643                     PIC S9(4)   VALUE +2643.
   931     12  ER-2644                     PIC S9(4)   VALUE +2644.
   932     12  ER-2645                     PIC S9(4)   VALUE +2645.
   933     12  ER-2646                     PIC S9(4)   VALUE +2646.
   934     12  ER-2647                     PIC S9(4)   VALUE +2647.
   935     12  ER-2648                     PIC S9(4)   VALUE +2648.
   936     12  ER-2649                     PIC S9(4)   VALUE +2649.
   937     12  ER-2650                     PIC S9(4)   VALUE +2650.
   938     12  ER-2651                     PIC S9(4)   VALUE +2651.
   939     12  ER-2652                     PIC S9(4)   VALUE +2652.
   940     12  ER-2653                     PIC S9(4)   VALUE +2653.
   941     12  ER-2654                     PIC S9(4)   VALUE +2654.
   942     12  ER-2655                     PIC S9(4)   VALUE +2655.
   943     12  ER-2656                     PIC S9(4)   VALUE +2656.
   944     12  ER-2657                     PIC S9(4)   VALUE +2657.
   945     12  ER-2658                     PIC S9(4)   VALUE +2658.
   946     12  ER-2659                     PIC S9(4)   VALUE +2659.
   947     12  ER-2660                     PIC S9(4)   VALUE +2660.
   948     12  ER-2661                     PIC S9(4)   VALUE +2661.
   949     12  ER-2662                     PIC S9(4)   VALUE +2662.
   950     12  ER-2663                     PIC S9(4)   VALUE +2663.
   951     12  ER-2664                     PIC S9(4)   VALUE +2664.
   952     12  ER-2665                     PIC S9(4)   VALUE +2665.
   953     12  ER-2666                     PIC S9(4)   VALUE +2666.
   954     12  ER-2667                     PIC S9(4)   VALUE +2667.
   955     12  ER-2668                     PIC S9(4)   VALUE +2668.
   956     12  ER-2669                     PIC S9(4)   VALUE +2669.
   957     12  ER-2670                     PIC S9(4)   VALUE +2670.
   958     12  ER-2671                     PIC S9(4)   VALUE +2671.
   959     12  ER-2672                     PIC S9(4)   VALUE +2672.
   960     12  ER-2673                     PIC S9(4)   VALUE +2673.
   961     12  ER-2674                     PIC S9(4)   VALUE +2674.
   962     12  ER-2675                     PIC S9(4)   VALUE +2675.
   963     12  ER-2676                     PIC S9(4)   VALUE +2676.
   964     12  ER-2677                     PIC S9(4)   VALUE +2677.
   965     12  ER-2678                     PIC S9(4)   VALUE +2678.
   966     12  ER-2679                     PIC S9(4)   VALUE +2679.
   967     12  ER-2680                     PIC S9(4)   VALUE +2680.
   968     12  ER-2681                     PIC S9(4)   VALUE +2681.
   969     12  ER-2682                     PIC S9(4)   VALUE +2682.
   970     12  ER-2683                     PIC S9(4)   VALUE +2683.
   971     12  ER-2684                     PIC S9(4)   VALUE +2684.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  19
* EL050.cbl
   972     12  ER-2685                     PIC S9(4)   VALUE +2685.
   973     12  ER-2686                     PIC S9(4)   VALUE +2686.
   974     12  ER-2687                     PIC S9(4)   VALUE +2687.
   975     12  ER-2688                     PIC S9(4)   VALUE +2688.
   976     12  ER-2689                     PIC S9(4)   VALUE +2689.
   977     12  ER-2690                     PIC S9(4)   VALUE +2690.
   978     12  ER-2691                     PIC S9(4)   VALUE +2691.
   979     12  ER-2692                     PIC S9(4)   VALUE +2692.
   980     12  ER-2693                     PIC S9(4)   VALUE +2693.
   981     12  ER-2694                     PIC S9(4)   VALUE +2694.
   982     12  ER-2695                     PIC S9(4)   VALUE +2695.
   983     12  ER-2696                     PIC S9(4)   VALUE +2696.
   984     12  ER-2697                     PIC S9(4)   VALUE +2697.
   985     12  ER-2698                     PIC S9(4)   VALUE +2698.
   986     12  ER-2699                     PIC S9(4)   VALUE +2699.
   987     12  ER-2700                     PIC S9(4)   VALUE +2700.
   988     12  ER-2701                     PIC S9(4)   VALUE +2701.
   989     12  ER-2702                     PIC S9(4)   VALUE +2702.
   990     12  ER-2703                     PIC S9(4)   VALUE +2703.
   991     12  ER-2704                     PIC S9(4)   VALUE +2704.
   992     12  ER-2707                     PIC S9(4)   VALUE +2707.
   993     12  ER-2720                     PIC S9(4)   VALUE +2720.
   994     12  ER-2709                     PIC S9(4)   VALUE +2709.
   995     12  ER-2717                     PIC S9(4)   VALUE +2717.
   996     12  ER-2718                     PIC S9(4)   VALUE +2718.
   997     12  ER-2719                     PIC S9(4)   VALUE +2719.
   998     12  ER-2721                     PIC S9(4)   VALUE +2721.
   999     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1000     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1001     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1002     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1003     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1004     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1005     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1006     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1007     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1008     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1009     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1010     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1011     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1012     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1013     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1014     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1015     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1016     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1017     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1018     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1019     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1020     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1021     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1022     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1023     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1024     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1025     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1026     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1027     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1028     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1029     12  ER-2752                     PIC S9(4)   VALUE +2752.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  20
* EL050.cbl
  1030     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1031     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1032     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1033     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1034     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1035     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1036     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1037     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1038     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1039     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1040     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1041     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1042     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1043     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1044     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1045     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1046     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1047     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1048     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1049     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1050     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1051     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1052     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1053     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1054     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1055     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1056     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1057     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1058     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1059     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1060     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1061     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1062     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1063     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1064     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1065     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1066     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1067     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1068     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1069     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1070     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1071     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1072     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1073     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1074     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1075     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1076     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1077     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1078     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1079     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1080     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1081     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1082     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1083     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1084     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1085     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1086     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1087     12  ER-2964                     PIC S9(4)   VALUE +2964.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  21
* EL050.cbl
  1088     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1089     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1090     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1091     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1092     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1093     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1094     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1095     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1096     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1097     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1098     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1099     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1100     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1101     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1102     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1103     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1104     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1105     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1106     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1107     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1108     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1109     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1110     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1111     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1112     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1113     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1114     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1115     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1116     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1117     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1118     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1119     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1120     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1121     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1122     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1123     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1124     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1125     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1126     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1127     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1128     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1129     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1130     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1131     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1132     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1133     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1134     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1135     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1136     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1137     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1138     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1139     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1140     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1141     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1142     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1143     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1144     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1145     12  ER-8085                     PIC S9(4)   VALUE +8085.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  22
* EL050.cbl
  1146     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1147     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1148     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1149     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1150     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1151     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1152     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1153     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1154     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1155     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1156     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1157     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1158     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1159     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1160     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1161     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1162     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1163     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1164     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1165     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1166     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1167     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1168     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1169     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1170     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1171     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1172     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1173     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1174     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1175     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1176     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1177     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1178     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1179     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1180     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1181     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1182     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1183     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1184     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1185     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1186     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1187******************************************************************
  1188***************   END OF ELC50WS     ****************************
  1189******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  23
* EL050.cbl
  1192 01  WORKING-STORAGE-WORK-AREAS.
  1193     12  WS-RESPONSE             PIC S9(8)  COMP.
  1194         88  WS-RESP-NORMAL           VALUE +00.
  1195         88  WS-RESP-ERROR            VALUE +01.
  1196         88  WS-RESP-NOTFND           VALUE +13.
  1197         88  WS-RESP-DUPREC           VALUE +14.
  1198         88  WS-RESP-ENDFILE          VALUE +20.
  1199     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1200     12  WORK-AREAS.
  1201         16  WK-CONV-GREG.
  1202             24  WCG-CENT             PIC XX.
  1203             24  WCG-REST             PIC X(4).
  1204         16  WORK-GREGORIAN-DATE.
  1205             24  WK-GREG-CENT         PIC XX.
  1206             24  WK-GREG-DATE-YYMMDD.
  1207                 28  WK-GREG-YYMM     PIC X(4).
  1208                 28  WK-GREG-DD       PIC XX.
  1209
  1210         16  WORK-SELECT-DATE.
  1211             24  WK-SELECT-CENT            PIC XX.
  1212             24  WK-SELECT-DATE-YYMMDD.
  1213                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1214                 28  FILLER                PIC XX.
  1215
  1216         16  WK-FORM-NO.
  1217             24  WK-FORM-BANK-ID       PIC X(5).
  1218             24  WK-FORM-UNDRWRTR      PIC X(1).
  1219             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1220
  1221         16  WK-MEMBER-NO.
  1222             24  WK-MEMBER-1-6        PIC X(6).
  1223             24  WK-MEMBER-7-12       PIC X(6).
  1224
  1225         16  WK-FULL-CERT-NO.
  1226             24  WK-CERT-POS-1-2      PIC X(2).
  1227             24  WK-CERT-POS-3        PIC X(1).
  1228             24  WK-CERT-POS-4        PIC X(1).
  1229             24  WK-CERT-POS-5-6      PIC X(2).
  1230             24  WK-CERT-POS-7        PIC X(1).
  1231             24  WK-CERT-POS-8-11     PIC X(4).
  1232
  1233         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1234             88  VALID-RATE-CODE        VALUE 'Y'.
  1235             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1236
  1237         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1238         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1239         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1240         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1241         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1242         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1243         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1244         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1245         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1246         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1247
  1248* DLO001
  1249 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  24
* EL050.cbl
  1250     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1251     12  DMPF-RETURN-CODE          PIC XX.
  1252         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1253         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1254         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1255         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1256         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1257         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1258
  1259* DLO002
  1260 01  WS-DLO-INTERNAL-POLICY-FORM.
  1261     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1262     12  DIPF-RETURN-CODE          PIC XX.
  1263         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1264         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1265         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1266         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1267         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1268         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1269
  1270* DLO003
  1271 01  WS-DLO-VALID-BANK-ID.
  1272     12  DVBI-BANK-ID              PIC X(5).
  1273     12  DVBI-BANK-ID-TYPE         PIC X.
  1274         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1275         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1276         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1277         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1278         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1279     12  DVBI-RETURN-CODE          PIC XX.
  1280         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1281         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1282         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1283         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1284         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1285         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1286         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1287         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1288         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1289
  1290* DLO007
  1291 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1292     12  DCUA-RES-STATE            PIC XX.
  1293     12  DCUA-BEN-TYPE             PIC XX.
  1294     12  DCUA-SYS-IDENT            PIC X.
  1295         88  DCUA-CLAIM                        VALUE 'C'.
  1296         88  DCUA-PREMIUM                      VALUE 'P'.
  1297     12  DCUA-COVERAGE-RULE        PIC X.
  1298     12  DCUA-CLIENT-ID            PIC X(10).
  1299     12  DCUA-EFF-DATE             PIC X(8).
  1300     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1301     12  DCUA-RETURN-CODE          PIC XX.
  1302         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1303     12  DCUA-CERT-NUMBER          PIC X(11).
  1304     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1305     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1306
  1307* DLO011
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  25
* EL050.cbl
  1308 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1309     12  DPRB-RATE-CODE            PIC X(4).
  1310     12  DPRB-COVERAGE-CATEG       PIC X.
  1311     12  DPRB-RETURN-CODE          PIC XX.
  1312         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1313         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1314         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1315         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1316         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1317         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1318         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1319         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1320         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1321     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1322     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1323     12  DPRB-BEN-TYPE             PIC XX.
  1324
  1325* DLO017
  1326 01  WS-DLO-VALID-RATE-CODE.
  1327     12  DVRC-RATE-CODE            PIC X(4).
  1328     12  DVRC-RETURN-CODE          PIC XX.
  1329         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1330         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1331         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1332         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1333         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1334         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1335
  1336* DLO019
  1337 01  WS-DLO-ORIG-COV-CAT.
  1338     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1339     12  DOCC-RETURN-CODE          PIC XX.
  1340     12  DOCC-ORIG-COV-CAT         PIC X.
  1341     12  DOCC-UNDERWITER           PIC XX.
  1342     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1343     12  DOCC-FILLER               PIC X(6).
  1344
  1345* DLO021
  1346 01  WS-DLO-VALID-LOAN-OFFICER.
  1347     12  DVLO-LOAN-OFFICER.
  1348         16  DVLO-BILL-TYPE        PIC X.
  1349         16  DVLO-BILL-SOURCE      PIC X.
  1350         16  DVLO-BATCH-TYPE       PIC X.
  1351     12  DVLO-RETURN-CODE          PIC XX.
  1352         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1353         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1354         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1355         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1356         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1357         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1358
  1359* DLO022
  1360 01  WS-DLO-VALID-STATE-CODE.
  1361     12  DVSC-STATE-CODE           PIC XX.
  1362     12  DVSC-RETURN-CODE          PIC XX.
  1363         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1364
  1365* DLO023
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  26
* EL050.cbl
  1366 01  WS-DLO-VALID-CODE-VALUES.
  1367     12  DVCV-SYSTEM-ID            PIC XX.
  1368         88  DVCV-CLAIMS                       VALUE 'CL'.
  1369         88  DVCV-CREDIT                       VALUE 'CR'.
  1370     12  DVCV-RECORD-TYPE          PIC XX.
  1371         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1372         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1373         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1374         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1375         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1376         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1377         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1378         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1379     12  DVCV-RECORD-KEY           PIC X(6).
  1380     12  DVCV-RETURN-CODE          PIC XX.
  1381         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1382         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1383         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1384         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1385         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1386         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1387         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1388     12  DVCV-CODE-DESC            PIC X(60).
  1389     12  DVCV-GEN-DESC-1           PIC X(20).
  1390     12  DVCV-GEN-DESC-2           PIC X(20).
  1391     12  DVCV-GEN-DESC-3           PIC X(20).
  1392
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  27
* EL050.cbl
  1394*    COPY ERCBXRF.
  1395******************************************************************
  1396*                                                                *
  1397*                                                                *
  1398*                            ERCBXRF                             *
  1399*                                                                *
  1400*   ONLINE CREDIT SYSTEM                                         *
  1401*                                                                *
  1402*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1403*                                                                *
  1404*   FILE TYPE = VSAM,KSDS                                        *
  1405*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1406*                                                                *
  1407*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1408*       ALTERNATE PATH = NONE                                    *
  1409*                                                                *
  1410*   LOG = NO                                                     *
  1411*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1412*                                                                *
  1413******************************************************************
  1414
  1415 01  BANK-CROSS-REFERENCE.
  1416     12  BK-RECORD-ID                PIC XX.
  1417         88  VALID-BK-ID             VALUE 'BK'.
  1418
  1419     12  BK-CONTROL-PRIMARY.
  1420         16  BK-COMPANY-CD           PIC X.
  1421         16  BK-CARRIER              PIC X.
  1422         16  BK-GROUPING             PIC X(6).
  1423         16  BK-BANK-NO              PIC X(10).
  1424
  1425     12  BK-MAINT-INFORMATION.
  1426         16  BK-LAST-MAINT-DT        PIC XX.
  1427         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1428         16  BK-LAST-MAINT-USER      PIC X(4).
  1429         16  FILLER                  PIC X(9).
  1430
  1431     12  FILLER                      PIC X(37).
  1432
  1433     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1434
  1435     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1436                            DEPENDING ON BK-BANK-POINTER-CNT.
  1437         16  BK-AM-ACCOUNT           PIC X(10).
  1438         16  BK-AM-EXP-DT            PIC XX.
  1439         16  BK-AM-EFF-DT            PIC XX.
  1440         16  BK-AM-STATE             PIC XX.
  1441         16  FILLER                  PIC X(20).
  1442
  1443******************************************************************
  1444
  1445*    COPY ERCCOMP.
  1446******************************************************************
  1447*                                                                *
  1448*                                                                *
  1449*                            ERCCOMP                             *
  1450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1451*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  28
* EL050.cbl
  1452*                                                                *
  1453*   ONLINE CREDIT SYSTEM                                         *
  1454*                                                                *
  1455*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1456*                                                                *
  1457*   FILE TYPE = VSAM,KSDS                                        *
  1458*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1459*                                                                *
  1460*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1461*       ALTERNATE PATH = NONE                                    *
  1462*                                                                *
  1463*   LOG = NO                                                     *
  1464*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1465*                                                                *
  1466******************************************************************
  1467*                   C H A N G E   L O G
  1468*
  1469* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1470*-----------------------------------------------------------------
  1471*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1472* EFFECTIVE    NUMBER
  1473*-----------------------------------------------------------------
  1474* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1475* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1476* 092205    2005050300006  PEMA  ADD LEASE FEE
  1477* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1478* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1479* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1480* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1481* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1482******************************************************************
  1483
  1484 01  COMPENSATION-MASTER.
  1485     12  CO-RECORD-ID                          PIC XX.
  1486         88  VALID-CO-ID                          VALUE 'CO'.
  1487
  1488     12  CO-CONTROL-PRIMARY.
  1489         16  CO-COMPANY-CD                     PIC X.
  1490         16  CO-CONTROL.
  1491             20  CO-CTL-1.
  1492                 24  CO-CARR-GROUP.
  1493                     28  CO-CARRIER            PIC X.
  1494                     28  CO-GROUPING.
  1495                         32  CO-GROUP-PREFIX   PIC XXX.
  1496                         32  CO-GROUP-PRIME    PIC XXX.
  1497                 24  CO-RESP-NO.
  1498                     28  CO-RESP-PREFIX        PIC X(4).
  1499                     28  CO-RESP-PRIME         PIC X(6).
  1500             20  CO-CTL-2.
  1501                 24  CO-ACCOUNT.
  1502                     28  CO-ACCT-PREFIX        PIC X(4).
  1503                     28  CO-ACCT-PRIME         PIC X(6).
  1504         16  CO-TYPE                           PIC X.
  1505             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1506             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1507             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1508
  1509     12  CO-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  29
* EL050.cbl
  1510         16  CO-LAST-MAINT-DT                  PIC XX.
  1511         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1512         16  CO-LAST-MAINT-USER                PIC X(4).
  1513     12  FILLER                                PIC XX.
  1514     12  CO-STMT-TYPE                          PIC XXX.
  1515     12  CO-COMP-TYPE                          PIC X.
  1516         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1517     12  CO-STMT-OWNER                         PIC X(4).
  1518     12  CO-BALANCE-CONTROL                    PIC X.
  1519         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1520         88  CO-NO-BALANCE                        VALUE 'N'.
  1521
  1522     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1523         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1524         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1525         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1526
  1527     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1528         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1529         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1530
  1531     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1532     12  CO-GA-DIRECT-DEP                      PIC X.
  1533     12  CO-FUTURE-SPACE                       PIC X.
  1534         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1535
  1536     12  CO-ACCT-NAME                          PIC X(30).
  1537     12  CO-MAIL-NAME                          PIC X(30).
  1538     12  CO-ADDR-1                             PIC X(30).
  1539     12  CO-ADDR-2                             PIC X(30).
  1540     12  CO-ADDR-3.
  1541         16  CO-ADDR-CITY                      PIC X(27).
  1542         16  CO-ADDR-STATE                     PIC XX.
  1543     12  CO-CSO-1099                           PIC X.
  1544     12  CO-ZIP.
  1545         16  CO-ZIP-PRIME.
  1546             20  CO-ZIP-PRI-1ST                PIC X.
  1547                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1548             20  FILLER                        PIC X(4).
  1549         16  CO-ZIP-PLUS4                      PIC X(4).
  1550     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1551         16  CO-CAN-POSTAL-1                   PIC XXX.
  1552         16  CO-CAN-POSTAL-2                   PIC XXX.
  1553         16  FILLER                            PIC XXX.
  1554     12  CO-SOC-SEC                            PIC X(13).
  1555     12  CO-TELEPHONE.
  1556         16  CO-AREA-CODE                      PIC XXX.
  1557         16  CO-PREFIX                         PIC XXX.
  1558         16  CO-PHONE                          PIC X(4).
  1559
  1560     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1561
  1562     12  CO-AR-BAL-LEVEL                       PIC X.
  1563         88  CO-AR-REF-LVL                        VALUE '1'.
  1564         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1565         88  CO-AR-BILL-LVL                       VALUE '2'.
  1566         88  CO-AR-AGT-LVL                        VALUE '3'.
  1567         88  CO-AR-FR-LVL                         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  30
* EL050.cbl
  1568
  1569     12  CO-AR-NORMAL-PRINT                    PIC X.
  1570         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1571         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1572
  1573     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1574
  1575     12  CO-AR-REPORTING                       PIC X.
  1576         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1577         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1578
  1579     12  CO-AR-PULL-CHECK                      PIC X.
  1580         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1581         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1582
  1583     12  CO-AR-BALANCE-PRINT                   PIC X.
  1584         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1585
  1586     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1587         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1588         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1589         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1590
  1591     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1592
  1593     12  CO-USER-CODE                          PIC X.
  1594     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1595
  1596******************************************************************
  1597*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1598*    THE LAST MONTH END RUN.
  1599******************************************************************
  1600
  1601     12  CO-LAST-ACTIVITY-DATE.
  1602         16  CO-ACT-YEAR                       PIC 99.
  1603         16  CO-ACT-MONTH                      PIC 99.
  1604         16  CO-ACT-DAY                        PIC 99.
  1605
  1606     12  CO-LAST-STMT-DT.
  1607         16  CO-LAST-STMT-YEAR                 PIC 99.
  1608         16  CO-LAST-STMT-MONTH                PIC 99.
  1609         16  CO-LAST-STMT-DAY                  PIC 99.
  1610
  1611     12  CO-MO-END-TOTALS.
  1612         16  CO-MONTHLY-TOTALS.
  1613             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1614             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1615             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1616             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1617             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1618
  1619         16  CO-AGING-TOTALS.
  1620             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1621             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1622             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1623             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1624
  1625         16  CO-YTD-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  31
* EL050.cbl
  1626             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1627             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1628
  1629         16  CO-OVER-UNDER-TOTALS.
  1630             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1631             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1632
  1633     12  CO-MISCELLANEOUS-TOTALS.
  1634         16  CO-FICA-TOTALS.
  1635             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1636             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1637
  1638         16  CO-CLAIM-TOTALS.
  1639             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1640             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1641
  1642******************************************************************
  1643*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1644*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1645******************************************************************
  1646
  1647     12  CO-CURRENT-TOTALS.
  1648         16  CO-CURRENT-LAST-STMT-DT.
  1649             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1650             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1651             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1652
  1653         16  CO-CURRENT-MONTHLY-TOTALS.
  1654             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1655             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1656             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1657             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1658             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1659
  1660         16  CO-CURRENT-AGING-TOTALS.
  1661             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1662             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1663             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1664             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1665
  1666         16  CO-CURRENT-YTD-TOTALS.
  1667             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1668             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1669
  1670     12  CO-PAID-COMM-TOTALS.
  1671         16  CO-YTD-PAID-COMMS.
  1672             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1673             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1674
  1675     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1676         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1677         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1678
  1679     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1680         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1681         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1682         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1683         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  32
* EL050.cbl
  1684         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1685         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1686         88  CO-FINAL-LETTER                  VALUE 'F'.
  1687         88  CO-RECONCILING                   VALUE 'R'.
  1688         88  CO-PHONE-CALL                    VALUE 'P'.
  1689         88  CO-LEGAL                         VALUE 'L'.
  1690         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1691         88  CO-WRITE-OFF                     VALUE 'W'.
  1692         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1693
  1694     12  CO-CSR-CODE                       PIC X(4).
  1695
  1696     12  CO-GA-STATUS-INFO.
  1697         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1698         16  CO-GA-TERMINATION-DT          PIC XX.
  1699         16  CO-GA-STATUS-CODE             PIC X.
  1700             88  CO-GA-ACTIVE                 VALUE 'A'.
  1701             88  CO-GA-INACTIVE               VALUE 'I'.
  1702             88  CO-GA-PENDING                VALUE 'P'.
  1703         16  CO-GA-COMMENTS.
  1704             20  CO-GA-COMMENT-1           PIC X(40).
  1705             20  CO-GA-COMMENT-2           PIC X(40).
  1706             20  CO-GA-COMMENT-3           PIC X(40).
  1707             20  CO-GA-COMMENT-4           PIC X(40).
  1708
  1709     12  CO-RPTCD2                         PIC X(10).
  1710
  1711     12  CO-TYPE-AGENT                     PIC X(01).
  1712         88  CO-CORPORATION                   VALUE 'C'.
  1713         88  CO-PARTNERSHIP                   VALUE 'P'.
  1714         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1715         88  CO-TRUST                         VALUE 'T'.
  1716         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1717
  1718     12  CO-FAXNO.
  1719         16  CO-FAX-AREA-CODE                  PIC XXX.
  1720         16  CO-FAX-PREFIX                     PIC XXX.
  1721         16  CO-FAX-PHONE                      PIC X(4).
  1722
  1723     12  CO-BANK-INFORMATION.
  1724         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1725         16  CO-BANK-TRANSIT-NON REDEFINES
  1726             CO-BANK-TRANSIT-NO                PIC 9(8).
  1727
  1728         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1729     12  CO-MISC-DEDUCT-INFO REDEFINES
  1730                  CO-BANK-INFORMATION.
  1731         16  CO-MD-GL-ACCT                     PIC X(10).
  1732         16  CO-MD-DIV                         PIC XX.
  1733         16  CO-MD-CENTER                      PIC X(4).
  1734         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1735         16  CO-CREATE-AP-CHECK                PIC X.
  1736         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1737         16  FILLER                            PIC XXX.
  1738     12  CO-ACH-STATUS                         PIC X.
  1739         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1740         88  CO-ACH-PENDING                        VALUE 'P'.
  1741
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  33
* EL050.cbl
  1742     12  CO-BILL-SW                            PIC X.
  1743     12  CO-CONTROL-NAME                       PIC X(30).
  1744     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1745     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1746     12  CO-CLP-STATE                          PIC XX.
  1747     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1748     12  CO-SPP-REFUND-EDIT                    PIC X.
  1749
  1750******************************************************************
  1751
  1752*    COPY ERCAGTC.
  1753******************************************************************
  1754*                                                                *
  1755*                                                                *
  1756*                            ERCAGTC                             *
  1757*                            VMOD=2.001                          *
  1758*                                                                *
  1759*   ONLINE CREDIT SYSTEM                                         *
  1760*                                                                *
  1761*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1762*                                                                *
  1763*   FILE TYPE = VSAM,KSDS                                        *
  1764*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1765*                                                                *
  1766*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1767*       ALTERNATE PATH = NONE                                    *
  1768*                                                                *
  1769*   LOG = NO                                                     *
  1770*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1771*                                                                *
  1772******************************************************************
  1773*                   C H A N G E   L O G
  1774*
  1775* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1776*-----------------------------------------------------------------
  1777*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1778* EFFECTIVE    NUMBER
  1779*-----------------------------------------------------------------
  1780* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1781* 111004                         NEW FILE AND COPYBOOK
  1782* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1783******************************************************************
  1784 01  AGENT-COMMISSIONS.
  1785     12  AG-RECORD-ID                          PIC XX.
  1786         88  VALID-CO-ID                          VALUE 'AG'.
  1787     12  AG-CONTROL-PRIMARY.
  1788         16  AG-COMPANY-CD                     PIC X.
  1789         16  AG-CONTROL.
  1790             20  AG-CTL-1.
  1791                 24  AG-CARR-GROUP.
  1792                     28  AG-CARRIER            PIC X.
  1793                     28  AG-GROUPING           PIC X(6).
  1794                 24  AG-BANK                   PIC X(10).
  1795             20  AG-CTL-2.
  1796                 24  AG-EXP-DT                 PIC XX.
  1797         16  AG-TYPE                           PIC X.
  1798             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1799             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  34
* EL050.cbl
  1800     12  AG-MAINT-INFORMATION.
  1801         16  AG-LAST-MAINT-DT                  PIC XX.
  1802         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1803         16  AG-LAST-MAINT-USER                PIC X(4).
  1804         16  FILLER                            PIC X(10).
  1805     12  AG-EFF-DT                             PIC XX.
  1806     12  AG-COMM-STRUCTURE.
  1807         16  AG-AGT-COMMS OCCURS 10.
  1808             20  AG-AGT                PIC X(10).
  1809             20  AG-COM-TYP            PIC X.
  1810             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1811             20  AG-RECALC-LV-INDIC    PIC X.
  1812             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1813             20  AG-LRCALC-LV-INDIC    PIC X.
  1814             20  FILLER                PIC X(05).
  1815     12  FILLER                  PIC X(145).
  1816******************************************************************
  1817*    COPY ERCRESS.
  1818******************************************************************
  1819*                                                                *
  1820*                            ERCRESS                             *
  1821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1822*                            VMOD=2.002                          *
  1823*                                                                *
  1824*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1825*                                                                *
  1826*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1827*   VSAM RESIDENT STATE TAX MASTER                              *
  1828*                                                                *
  1829*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1830*                                                                *
  1831*   FILE TYPE = VSAM,KSDS                                        *
  1832*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1833*                                                                *
  1834*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1835*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1836*                                                                *
  1837*   LOG = NO                                                     *
  1838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1839*                                                                *
  1840*                                                                *
  1841******************************************************************
  1842
  1843 01  RESIDENT-STATE-TAX-MASTER.
  1844
  1845     10  ERRESS-PRIMARY-KEY.
  1846         15  RES-COMPANY-CD        PIC X.
  1847         15  RES-RESIDENT-STATE    PIC XX.
  1848         15  RES-COVERAGE-CATEGORY PIC X.
  1849         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1850*                                      YYYYMMDD
  1851*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1852
  1853     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
  1854
  1855         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1856         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1857         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  35
* EL050.cbl
  1858         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1859
  1860     10 RES-RECALC-SW              PIC   X.
  1861         88 RECALC                VALUE 'Y'.
  1862         88 NO-RECALC             VALUE 'N'.
  1863     10  RES-MAINT-BY              PIC X(4).
  1864     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1865     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1866*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  36
* EL050.cbl
  1868*    COPY ERCRESC.
  1869******************************************************************
  1870*                                                                *
  1871*                            ERCRESC                             *
  1872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1873*                            VMOD=2.003                          *
  1874*                                                                *
  1875*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1876*                                                                *
  1877*   FILE TYPE = VSAM,KSDS                                        *
  1878*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1879*                                                                *
  1880*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1881*       ALTERNATE PATH1 = NONE                                   *
  1882*                                                                *
  1883*   LOG = NO                                                     *
  1884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1885*                                                                *
  1886******************************************************************
  1887
  1888 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1889
  1890     10  ERRESC-RECORD-KEY.
  1891         15  RESC-COMPANY-CD           PIC   X.
  1892         15  RESC-CARRIER              PIC   X.
  1893         15  RESC-GROUP                PIC   X(6).
  1894         15  RESC-STATE                PIC   XX.
  1895         15  RESC-ACCOUNT              PIC   X(10).
  1896         15  RESC-AGENT                PIC   X(10).
  1897         15  RESC-RESIDENT-STATE       PIC   XX.
  1898         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1899*                                           YYYYMMDD
  1900     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1901
  1902     10  RESC-COMM-RECORD-DATA.
  1903         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1904             20 RESC-COVERAGE-CAT      PIC    X.
  1905             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1906             20 RESC-COMMISSION-TAB REDEFINES
  1907                RESC-COMMISSION-PER    PIC  XXX.
  1908
  1909     10  RESC-MAINT-BY                 PIC X(4).
  1910     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1911     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1912*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  37
* EL050.cbl
  1914*    COPY ERCPLAN.
  1915******************************************************************
  1916*                                                                *
  1917*                                                                *
  1918*                            ERCPLAN                             *
  1919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1920*                            VMOD=2.003                          *
  1921*                                                                *
  1922*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1923*                                                                *
  1924*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1925*   PLAN MASTER                                                  *
  1926*                                                                *
  1927*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1928*                                                                *
  1929*   FILE TYPE = VSAM,KSDS                                        *
  1930*   RECORD SIZE = 420   RECFORM = FIX                            *
  1931*                                                                *
  1932*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1933*       ALTERNATE PATH1 = N/A                                    *
  1934*                                                                *
  1935*   LOG = NO                                                     *
  1936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1937*                                                                *
  1938*                                                                *
  1939******************************************************************
  1940
  1941 01  PLAN-MASTER.
  1942     12  PL-RECORD-ID                      PIC XX.
  1943         88  VALID-PL-ID                      VALUE 'PL'.
  1944
  1945     12  PL-CONTROL-PRIMARY.
  1946         16  PL-COMPANY-CD                 PIC X.
  1947         16  PL-MSTR-CNTRL.
  1948             20  PL-CONTROL-A.
  1949                 24  PL-CARRIER            PIC X.
  1950                 24  PL-GROUPING           PIC X(6).
  1951                 24  PL-STATE              PIC XX.
  1952                 24  PL-ACCOUNT            PIC X(10).
  1953             20  PL-BENEFIT-TYPE           PIC X.
  1954             20  PL-BENEFIT-CODE           PIC XX.
  1955             20  PL-REVISION-NO            PIC X(3).
  1956
  1957     12  PL-CONTROL-BY-VAR-GRP.
  1958         16  PL-COMPANY-CD-A1              PIC X.
  1959         16  PL-VG-CARRIER                 PIC X.
  1960         16  PL-VG-GROUPING                PIC X(6).
  1961         16  PL-VG-STATE                   PIC XX.
  1962         16  PL-VG-ACCOUNT                 PIC X(10).
  1963         16  PL-BENEFIT-TYPE-A1            PIC X.
  1964         16  PL-BENEFIT-CODE-A1            PIC XX.
  1965         16  PL-REVISION-NO-A1             PIC 999.
  1966
  1967     12  PL-MAINT-INFORMATION.
  1968         16  PL-LAST-MAINT-DT              PIC XX.
  1969         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1970         16  PL-LAST-MAINT-USER            PIC X(4).
  1971         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  38
* EL050.cbl
  1972
  1973     12  PL-LIABILITY-LIMITS.
  1974         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1975         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1976             20  PL-LM-AGE                 PIC S99        COMP-3.
  1977             20  PL-LM-DUR                 PIC S999       COMP-3.
  1978             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  1979             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  1980
  1981     12  FILLER                            PIC X(30).
  1982
  1983     12  PL-GL-ACCOUNT-NOS.
  1984         16  PL-PREMIUM-GL                 PIC X(8).
  1985         16  PL-COMM-GL                    PIC X(8).
  1986         16  PL-CLAIM-GL                   PIC X(8).
  1987     12  FILLER                            PIC X(24).
  1988     12  PL-TOLERANCES.
  1989         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  1990         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  1991         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  1992         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  1993         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  1994         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  1995     12  PL-OVER-SHORT.
  1996         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  1997         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  1998     12  FILLER                            PIC X(24).
  1999     12  PLAN-MISC.
  2000         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2001         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2002         16  PL-IG                         PIC X.
  2003         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2004         16  PL-POLICY-FORM                PIC X(12).
  2005         16  PL-EDIT-FOR-FORM              PIC X(01).
  2006         16  PL-DEV-CODE                   PIC XXX.
  2007         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2008         16  PL-CALC-METHOD                PIC X.
  2009         16  PL-BENEFIT-GROUP              PIC X(05).
  2010         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2011
  2012         16  FILLER                        PIC X(99).
  2013******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  39
* EL050.cbl
  2015*    COPY ELCCERT.
  2016******************************************************************
  2017*                                                                *
  2018*                            ELCCERT.                            *
  2019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2020*                            VMOD=2.013                          *
  2021*                                                                *
  2022*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2023*                                                                *
  2024*   FILE TYPE = VSAM,KSDS                                        *
  2025*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2026*                                                                *
  2027*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2028*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2029*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2030*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2031*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2032*                                                                *
  2033*   LOG = YES                                                    *
  2034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2035******************************************************************
  2036*                   C H A N G E   L O G
  2037*
  2038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2039*-----------------------------------------------------------------
  2040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2041* EFFECTIVE    NUMBER
  2042*-----------------------------------------------------------------
  2043* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2044* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2045* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2046* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2047* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2048* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2049* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2050* 032612  CR2011110200001  PEMA  AHL CHANGES
  2051******************************************************************
  2052
  2053 01  CERTIFICATE-MASTER.
  2054     12  CM-RECORD-ID                      PIC XX.
  2055         88  VALID-CM-ID                      VALUE 'CM'.
  2056
  2057     12  CM-CONTROL-PRIMARY.
  2058         16  CM-COMPANY-CD                 PIC X.
  2059         16  CM-CARRIER                    PIC X.
  2060         16  CM-GROUPING.
  2061             20  CM-GROUPING-PREFIX        PIC X(3).
  2062             20  CM-GROUPING-PRIME         PIC X(3).
  2063         16  CM-STATE                      PIC XX.
  2064         16  CM-ACCOUNT.
  2065             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2066             20  CM-ACCOUNT-PRIME          PIC X(6).
  2067         16  CM-CERT-EFF-DT                PIC XX.
  2068         16  CM-CERT-NO.
  2069             20  CM-CERT-PRIME             PIC X(10).
  2070             20  CM-CERT-SFX               PIC X.
  2071
  2072     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  40
* EL050.cbl
  2073         16  CM-COMPANY-CD-A1              PIC X.
  2074         16  CM-INSURED-LAST-NAME          PIC X(15).
  2075         16  CM-INSURED-INITIALS.
  2076             20  CM-INSURED-INITIAL1       PIC X.
  2077             20  CM-INSURED-INITIAL2       PIC X.
  2078
  2079     12  CM-CONTROL-BY-SSN.
  2080         16  CM-COMPANY-CD-A2              PIC X.
  2081         16  CM-SOC-SEC-NO.
  2082             20  CM-SSN-STATE              PIC XX.
  2083             20  CM-SSN-ACCOUNT            PIC X(6).
  2084             20  CM-SSN-LN3.
  2085                 25  CM-INSURED-INITIALS-A2.
  2086                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2087                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2088                 25 CM-PART-LAST-NAME-A2         PIC X.
  2089
  2090     12  CM-CONTROL-BY-CERT-NO.
  2091         16  CM-COMPANY-CD-A4              PIC X.
  2092         16  CM-CERT-NO-A4                 PIC X(11).
  2093
  2094     12  CM-CONTROL-BY-MEMB.
  2095         16  CM-COMPANY-CD-A5              PIC X.
  2096         16  CM-MEMBER-NO.
  2097             20  CM-MEMB-STATE             PIC XX.
  2098             20  CM-MEMB-ACCOUNT           PIC X(6).
  2099             20  CM-MEMB-LN4.
  2100                 25  CM-INSURED-INITIALS-A5.
  2101                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2102                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2103                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2104
  2105     12  CM-INSURED-PROFILE-DATA.
  2106         16  CM-INSURED-FIRST-NAME.
  2107             20  CM-INSURED-1ST-INIT       PIC X.
  2108             20  FILLER                    PIC X(9).
  2109         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2110         16  CM-INSURED-SEX                PIC X.
  2111             88  CM-SEX-MALE                  VALUE 'M'.
  2112             88  CM-SEX-FEMAL                 VALUE 'F'.
  2113         16  CM-INSURED-JOINT-AGE          PIC 99.
  2114         16  CM-JOINT-INSURED-NAME.
  2115             20  CM-JT-LAST-NAME           PIC X(15).
  2116             20  CM-JT-FIRST-NAME.
  2117                 24  CM-JT-1ST-INIT        PIC X.
  2118                 24  FILLER                PIC X(9).
  2119             20  CM-JT-INITIAL             PIC X.
  2120
  2121     12  CM-LIFE-DATA.
  2122         16  CM-LF-BENEFIT-CD              PIC XX.
  2123         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2124         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2125         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2126         16  CM-LF-DEV-CODE                PIC XXX.
  2127         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2128         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2129         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2130         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  41
* EL050.cbl
  2131         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2132         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2133         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2134         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2135         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2136         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2137         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2138         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2139         16  FILLER                        PIC XX.
  2140
  2141     12  CM-AH-DATA.
  2142         16  CM-AH-BENEFIT-CD              PIC XX.
  2143         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2144         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2145         16  CM-AH-DEV-CODE                PIC XXX.
  2146         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2147         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2148         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2149         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2150         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2151         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2152         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2153         16  CM-AH-PAID-THRU-DT            PIC XX.
  2154             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2155         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2156         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2157         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2158         16  FILLER                        PIC X.
  2159
  2160     12  CM-LOAN-INFORMATION.
  2161         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2162         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2163                                           PIC S9(5)V99  COMP-3.
  2164         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2165         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2166         16  CM-PAY-FREQUENCY              PIC S99.
  2167         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2168         16  CM-RATE-CLASS                 PIC XX.
  2169         16  CM-BENEFICIARY                PIC X(25).
  2170         16  CM-POLICY-FORM-NO             PIC X(12).
  2171         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2172         16  CM-LAST-ADD-ON-DT             PIC XX.
  2173         16  CM-DEDUCTIBLE-AMOUNTS.
  2174             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2175             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2176         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2177             20  CM-RESIDENT-STATE         PIC XX.
  2178             20  CM-RATE-CODE              PIC X(4).
  2179             20  FILLER                    PIC XX.
  2180         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2181             20  CM-LOAN-OFFICER           PIC X(5).
  2182             20  FILLER                    PIC XXX.
  2183         16  CM-CSR-CODE                   PIC XXX.
  2184         16  CM-UNDERWRITING-CODE          PIC X.
  2185             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2186         16  CM-POST-CARD-IND              PIC X.
  2187         16  CM-NH-INTERFACE-SW            PIC X.
  2188         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  42
* EL050.cbl
  2189             88  CM-SING-PRM                  VALUE '1'.
  2190             88  CM-O-B-COVERAGE              VALUE '2'.
  2191             88  CM-OPEN-END                  VALUE '3'.
  2192         16  CM-IND-GRP-TYPE               PIC X.
  2193             88  CM-INDIVIDUAL                VALUE 'I'.
  2194             88  CM-GROUP                     VALUE 'G'.
  2195         16  CM-SKIP-CODE                  PIC X.
  2196             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2197             88  SKIP-JULY                    VALUE '1'.
  2198             88  SKIP-AUGUST                  VALUE '2'.
  2199             88  SKIP-SEPTEMBER               VALUE '3'.
  2200             88  SKIP-JULY-AUG                VALUE '4'.
  2201             88  SKIP-AUG-SEPT                VALUE '5'.
  2202             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2203             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2204             88  SKIP-JUNE                    VALUE '8'.
  2205             88  SKIP-JUNE-JULY               VALUE '9'.
  2206             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2207             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2208         16  CM-PAYMENT-MODE               PIC X.
  2209             88  PAY-MONTHLY                  VALUE SPACE.
  2210             88  PAY-WEEKLY                   VALUE '1'.
  2211             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2212             88  PAY-BI-WEEKLY                VALUE '3'.
  2213             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2214         16  CM-LOAN-NUMBER                PIC X(8).
  2215         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2216         16  CM-OLD-LOF                    PIC XXX.
  2217*        16  CM-LOAN-OFFICER               PIC XXX.
  2218         16  CM-REIN-TABLE                 PIC XXX.
  2219         16  CM-SPECIAL-REIN-CODE          PIC X.
  2220         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2221         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2222         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2223
  2224     12  CM-STATUS-DATA.
  2225         16  CM-ENTRY-STATUS               PIC X.
  2226         16  CM-ENTRY-DT                   PIC XX.
  2227
  2228         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2229         16  CM-LF-CANCEL-DT               PIC XX.
  2230         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2231
  2232         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2233         16  CM-LF-DEATH-DT                PIC XX.
  2234         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2235
  2236         16  CM-LF-CURRENT-STATUS          PIC X.
  2237             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2238                                                'M' '4' '5' '9'.
  2239             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2240             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2241             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2242             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2243             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2244             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2245             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2246             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  43
* EL050.cbl
  2247             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2248             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2249             88  CM-LF-DECLINED               VALUE 'D'.
  2250             88  CM-LF-VOIDED                 VALUE 'V'.
  2251
  2252         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2253         16  CM-AH-CANCEL-DT               PIC XX.
  2254         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2255
  2256         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2257         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2258         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2259
  2260         16  CM-AH-CURRENT-STATUS          PIC X.
  2261             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2262                                                'M' '4' '5' '9'.
  2263             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2264             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2265             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2266             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2267             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2268             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2269             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2270             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2271             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2272             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2273             88  CM-AH-DECLINED               VALUE 'D'.
  2274             88  CM-AH-VOIDED                 VALUE 'V'.
  2275
  2276         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2277             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2278             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2279             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2280         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2281
  2282         16  CM-ENTRY-BATCH                PIC X(6).
  2283         16  CM-LF-EXIT-BATCH              PIC X(6).
  2284         16  CM-AH-EXIT-BATCH              PIC X(6).
  2285         16  CM-LAST-MONTH-END             PIC XX.
  2286
  2287     12  CM-NOTE-SW                        PIC X.
  2288         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2289         88  CERT-NOTES-PRESENT               VALUE '1'.
  2290         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2291         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2292         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2293         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2294         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2295         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2296     12  CM-COMP-EXCP-SW                   PIC X.
  2297         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2298         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2299     12  CM-INSURED-ADDRESS-SW             PIC X.
  2300         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2301         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2302
  2303*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2304     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  44
* EL050.cbl
  2305     12  FILLER                            PIC X.
  2306
  2307*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2308     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2309     12  FILLER                            PIC X.
  2310*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2311     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2312
  2313     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2314         88  CERT-ADDED-BATCH                 VALUE ' '.
  2315         88  CERT-ADDED-ONLINE                VALUE '1'.
  2316         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2317         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2318         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2319     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2320         88  CERT-AS-LOADED                   VALUE ' '.
  2321         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2322         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2323         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2324         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2325         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2326         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2327         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2328
  2329     12  CM-ACCOUNT-COMM-PCTS.
  2330         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2331         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2332
  2333     12  CM-USER-FIELD                     PIC X.
  2334     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2335     12  CM-CLP-STATE                      PIC XX.
  2336     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2337     12  CM-USER-RESERVED                  PIC XXX.
  2338     12  FILLER REDEFINES CM-USER-RESERVED.
  2339         16  CM-AH-CLASS-CD                PIC XX.
  2340         16  F                             PIC X.
  2341******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  45
* EL050.cbl
  2343*    COPY ERCMAIL.
  2344******************************************************************
  2345*                                                                *
  2346*                                                                *
  2347*                            ERCMAIL                             *
  2348*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2349*                            VMOD=2.003                          *
  2350*                                                                *
  2351*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2352*                                                                *
  2353*   FILE TYPE = VSAM,KSDS                                        *
  2354*   RECORD SIZE = 374   RECFORM = FIX                            *
  2355*                                                                *
  2356*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2357*   ALTERNATE PATH    = NOT USED                                 *
  2358*                                                                *
  2359*   LOG = YES                                                    *
  2360*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2361******************************************************************
  2362*                   C H A N G E   L O G
  2363*
  2364* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2365*-----------------------------------------------------------------
  2366*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2367* EFFECTIVE    NUMBER
  2368*-----------------------------------------------------------------
  2369* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2370* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2371* 111108                   PEMA  ADD CRED BENE ADDR2
  2372******************************************************************
  2373
  2374 01  MAILING-DATA.
  2375     12  MA-RECORD-ID                      PIC XX.
  2376         88  VALID-MA-ID                       VALUE 'MA'.
  2377
  2378     12  MA-CONTROL-PRIMARY.
  2379         16  MA-COMPANY-CD                 PIC X.
  2380         16  MA-CARRIER                    PIC X.
  2381         16  MA-GROUPING.
  2382             20  MA-GROUPING-PREFIX        PIC XXX.
  2383             20  MA-GROUPING-PRIME         PIC XXX.
  2384         16  MA-STATE                      PIC XX.
  2385         16  MA-ACCOUNT.
  2386             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2387             20  MA-ACCOUNT-PRIME          PIC X(6).
  2388         16  MA-CERT-EFF-DT                PIC XX.
  2389         16  MA-CERT-NO.
  2390             20  MA-CERT-PRIME             PIC X(10).
  2391             20  MA-CERT-SFX               PIC X.
  2392
  2393     12  FILLER                            PIC XX.
  2394
  2395     12  MA-ACCESS-CONTROL.
  2396         16  MA-SOURCE-SYSTEM              PIC XX.
  2397             88  MA-FROM-CREDIT                VALUE 'CR'.
  2398             88  MA-FROM-VSI                   VALUE 'VS'.
  2399             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2400             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  46
* EL050.cbl
  2401         16  MA-RECORD-ADD-DT              PIC XX.
  2402         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2403         16  MA-LAST-MAINT-DT              PIC XX.
  2404         16  MA-LAST-MAINT-BY              PIC XXXX.
  2405         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2406
  2407     12  MA-PROFILE-INFO.
  2408         16  MA-QUALIFY-CODE-1             PIC XX.
  2409         16  MA-QUALIFY-CODE-2             PIC XX.
  2410         16  MA-QUALIFY-CODE-3             PIC XX.
  2411         16  MA-QUALIFY-CODE-4             PIC XX.
  2412         16  MA-QUALIFY-CODE-5             PIC XX.
  2413
  2414         16  MA-INSURED-LAST-NAME          PIC X(15).
  2415         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2416         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2417         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2418         16  MA-INSURED-BIRTH-DT           PIC XX.
  2419         16  MA-INSURED-SEX                PIC X.
  2420             88  MA-SEX-MALE                   VALUE 'M'.
  2421             88  MA-SEX-FEMALE                 VALUE 'F'.
  2422         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2423
  2424         16  MA-ADDRESS-CORRECTED          PIC X.
  2425         16  MA-JOINT-BIRTH-DT             PIC XX.
  2426*        16  FILLER                        PIC X(12).
  2427
  2428         16  MA-ADDRESS-LINE-1             PIC X(30).
  2429         16  MA-ADDRESS-LINE-2             PIC X(30).
  2430         16  MA-CITY-STATE.
  2431             20  MA-CITY                   PIC X(28).
  2432             20  MA-ADDR-STATE             PIC XX.
  2433         16  MA-ZIP.
  2434             20  MA-ZIP-CODE.
  2435                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2436                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2437                 24  FILLER                PIC X(4).
  2438             20  MA-ZIP-PLUS4              PIC X(4).
  2439         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2440             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2441             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2442             20  FILLER                    PIC X(3).
  2443
  2444         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2445
  2446         16  FILLER                        PIC XXX.
  2447*        16  FILLER                        PIC X(10).
  2448
  2449     12  MA-CRED-BENE-INFO.
  2450         16  MA-CRED-BENE-NAME                 PIC X(25).
  2451         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2452         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2453         16  MA-CRED-BENE-CTYST.
  2454             20  MA-CRED-BENE-CITY             PIC X(28).
  2455             20  MA-CRED-BENE-STATE            PIC XX.
  2456         16  MA-CRED-BENE-ZIP.
  2457             20  MA-CB-ZIP-CODE.
  2458                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  47
* EL050.cbl
  2459                     88  MA-CB-CANADIAN-POST-CODE
  2460                                           VALUE 'A' THRU 'Z'.
  2461                 24  FILLER                    PIC X(4).
  2462             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2463         16  MA-CB-CANADIAN-POSTAL-CODE
  2464                            REDEFINES MA-CRED-BENE-ZIP.
  2465             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2466             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2467             20  FILLER                        PIC X(3).
  2468     12  MA-POST-CARD-MAIL-DATA.
  2469         16  MA-MAIL-DATA OCCURS 7.
  2470             20  MA-MAIL-TYPE              PIC X.
  2471                 88  MA-12MO-MAILING           VALUE '1'.
  2472                 88  MA-EXP-MAILING            VALUE '2'.
  2473             20  MA-MAIL-STATUS            PIC X.
  2474                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2475                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2476                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2477             20  MA-MAIL-DATE              PIC XX.
  2478     12  FILLER                            PIC XX.
  2479     12  FILLER                            PIC XX.
  2480*    12  FILLER                            PIC X(30).
  2481******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  48
* EL050.cbl
  2483*    COPY ERCPNDM.
  2484******************************************************************
  2485*                                                                *
  2486*                                                                *
  2487*                            ERCPNDM                             *
  2488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2489*                            VMOD=2.003                          *
  2490*                                                                *
  2491*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2492*                                                                *
  2493*   FILE TYPE = VSAM,KSDS                                        *
  2494*   RECORD SIZE = 374   RECFORM = FIX                            *
  2495*                                                                *
  2496*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2497*   ALTERNATE PATH    = NOT USED                                 *
  2498*                                                                *
  2499*   LOG = YES                                                    *
  2500*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2501******************************************************************
  2502*                   C H A N G E   L O G
  2503*
  2504* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2505*-----------------------------------------------------------------
  2506*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2507* EFFECTIVE    NUMBER
  2508*-----------------------------------------------------------------
  2509* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2510* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2511* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2512******************************************************************
  2513
  2514 01  PENDING-MAILING-DATA.
  2515     12  PM-RECORD-ID                      PIC XX.
  2516         88  VALID-MA-ID                       VALUE 'PM'.
  2517
  2518     12  PM-CONTROL-PRIMARY.
  2519         16  PM-COMPANY-CD                 PIC X.
  2520         16  PM-ENTRY-BATCH                PIC X(6).
  2521         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2522         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2523
  2524     12  FILLER                            PIC X(14).
  2525
  2526     12  PM-ACCESS-CONTROL.
  2527         16  PM-SOURCE-SYSTEM              PIC XX.
  2528             88  PM-FROM-CREDIT                VALUE 'CR'.
  2529             88  PM-FROM-VSI                   VALUE 'VS'.
  2530             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2531             88  PM-FROM-OTHER                 VALUE 'OT'.
  2532         16  PM-RECORD-ADD-DT              PIC XX.
  2533         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2534         16  PM-LAST-MAINT-DT              PIC XX.
  2535         16  PM-LAST-MAINT-BY              PIC XXXX.
  2536         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2537
  2538     12  PM-PROFILE-INFO.
  2539         16  PM-QUALIFY-CODE-1             PIC XX.
  2540         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  49
* EL050.cbl
  2541         16  PM-QUALIFY-CODE-3             PIC XX.
  2542         16  PM-QUALIFY-CODE-4             PIC XX.
  2543         16  PM-QUALIFY-CODE-5             PIC XX.
  2544
  2545         16  PM-INSURED-LAST-NAME          PIC X(15).
  2546         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2547         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2548         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2549         16  PM-INSURED-BIRTH-DT           PIC XX.
  2550         16  PM-INSURED-SEX                PIC X.
  2551             88  PM-SEX-MALE                   VALUE 'M'.
  2552             88  PM-SEX-FEMALE                 VALUE 'F'.
  2553         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2554
  2555         16  PM-ADDRESS-CORRECTED          PIC X.
  2556         16  PM-JOINT-BIRTH-DT             PIC XX.
  2557*        16  FILLER                        PIC X(12).
  2558
  2559         16  PM-ADDRESS-LINE-1             PIC X(30).
  2560         16  PM-ADDRESS-LINE-2             PIC X(30).
  2561         16  PM-CITY-STATE.
  2562             20  PM-CITY                   PIC X(28).
  2563             20  PM-STATE                  PIC XX.
  2564         16  PM-ZIP.
  2565             20  PM-ZIP-CODE.
  2566                 24  PM-ZIP-1              PIC X.
  2567                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2568                 24  FILLER                PIC X(4).
  2569             20  PM-ZIP-PLUS4              PIC X(4).
  2570         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2571             20  PM-CAN-POST1              PIC XXX.
  2572             20  PM-CAN-POST2              PIC XXX.
  2573             20  FILLER                    PIC XXX.
  2574
  2575         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2576
  2577         16  FILLER                        PIC X(03).
  2578
  2579     12  PM-CRED-BENE-INFO.
  2580         16  PM-CRED-BENE-NAME             PIC X(25).
  2581         16  PM-CRED-BENE-ADDR             PIC X(30).
  2582         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2583         16  PM-CRED-BENE-CTYST.
  2584             20  PM-CRED-BENE-CITY         PIC X(28).
  2585             20  PM-CRED-BENE-STATE        PIC XX.
  2586         16  PM-CRED-BENE-ZIP.
  2587             20  PM-CB-ZIP-CODE.
  2588                 24  PM-CB-ZIP-1           PIC X.
  2589                     88  PM-CB-CANADIAN-POST-CODE
  2590                                  VALUE 'A' THRU 'Z'.
  2591                 24  FILLER                PIC X(4).
  2592             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2593         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2594             20  PM-CB-CAN-POST1           PIC XXX.
  2595             20  PM-CB-CAN-POST2           PIC XXX.
  2596             20  FILLER                    PIC XXX.
  2597     12  PM-POST-CARD-MAIL-DATA.
  2598         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  50
* EL050.cbl
  2599             20  PM-MAIL-TYPE              PIC X.
  2600                 88  PM-12MO-MAILING           VALUE '1'.
  2601                 88  PM-EXP-MAILING            VALUE '2'.
  2602             20  PM-MAIL-STATUS            PIC X.
  2603                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2604                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2605                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2606             20  PM-MAIL-DATE              PIC XX.
  2607     12  FILLER                            PIC XX.
  2608     12  FILLER                            PIC X(12).
  2609*    12  FILLER                            PIC X(30).
  2610
  2611******************************************************************
  2612*                                COPY ERCLOFC.
  2613******************************************************************
  2614*                                                                *
  2615*                                                                *
  2616*                            ERCLOFC                             *
  2617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2618*                            VMOD=2.003                          *
  2619*                                                                *
  2620*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2621*                                                                *
  2622*   FILE TYPE = VSAM,KSDS                                        *
  2623*   RECORD SIZE = 670   RECFORM = FIX                            *
  2624*                                                                *
  2625*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2626*                                                                *
  2627*   LOG = YES                                                    *
  2628*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2629*                                                                *
  2630******************************************************************
  2631
  2632 01  LOAN-OFFICER-MASTER.
  2633     12  LO-RECORD-ID                PIC XX.
  2634         88  VALID-LO-ID                VALUE 'LO'.
  2635
  2636     12  LO-CONTROL-PRIMARY.
  2637         16  LO-COMPANY-CD           PIC X.
  2638         16  LO-CARRIER              PIC X.
  2639         16  LO-GROUPING.
  2640             20  LO-GROUPING-PREFIX  PIC XXX.
  2641             20  LO-GROUPING-PRIME   PIC XXX.
  2642         16  LO-STATE                PIC XX.
  2643         16  LO-ACCOUNT.
  2644             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2645             20  LO-ACCOUNT-PRIME    PIC X(6).
  2646         16  LO-OFFICER-CODE         PIC X(5).
  2647
  2648     12  LO-OFFICER-NAME             PIC X(30).
  2649
  2650     12  LO-LAST-MAINT-DT            PIC XX.
  2651     12  LO-LAST-USER                PIC X(4).
  2652     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2653
  2654     12  LO-COMP-CONTROL             PIC X.
  2655             88  LO-SHOW-COMP           VALUE 'Y'.
  2656             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  51
* EL050.cbl
  2657     12  LO-DETAIL-CONTROL           PIC X.
  2658             88  LO-PRINT-DETAIL        VALUE 'D'.
  2659             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2660
  2661     12  LO-SV-CARRIER               PIC X.
  2662     12  LO-SV-GROUPING              PIC X(6).
  2663     12  LO-SV-STATE                 PIC XX.
  2664
  2665     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2666     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2667
  2668     12  LO-OFFICER-INFO.
  2669         16  FILLER OCCURS 12 TIMES.
  2670             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2671             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2672             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2673             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2674             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2675             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2676             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2677             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2678     12  FILLER                      PIC X(198).
  2679******************************************************************
  2680*                                COPY ERCPDEF.
  2681******************************************************************
  2682*                                                                *
  2683*                                                                *
  2684*                            ERCPDEF.                            *
  2685*                                                                *
  2686*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2687*                                                                *
  2688*    FILE TYPE = VSAM,KSDS                                       *
  2689*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2690*                                                                *
  2691*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2692*                                                                *
  2693*    LOG = YES                                                   *
  2694*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2695******************************************************************
  2696 01  PRODUCT-MASTER.
  2697    12  PD-RECORD-ID                 PIC X(02).
  2698        88  VALID-PD-ID                  VALUE 'PD'.
  2699    12  PD-CONTROL-PRIMARY.
  2700        16  PD-COMPANY-CD            PIC X.
  2701        16  PD-STATE                 PIC XX.
  2702        16  PD-PRODUCT-CD            PIC XXX.
  2703        16  PD-FILLER                PIC X(7).
  2704        16  PD-BEN-TYPE              PIC X.
  2705        16  PD-BEN-CODE              PIC XX.
  2706        16  PD-PROD-EXP-DT           PIC XX.
  2707    12  FILLER                       PIC X(50).
  2708    12  PD-PRODUCT-DATA OCCURS 8.
  2709        16  PD-PROD-CODE             PIC X.
  2710            88  PD-PROD-LIFE           VALUE 'L'.
  2711            88  PD-PROD-PROP           VALUE 'P'.
  2712            88  PD-PROD-AH             VALUE 'A'.
  2713            88  PD-PROD-IU             VALUE 'I'.
  2714            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  52
* EL050.cbl
  2715        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2716        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2717        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2718        16  PD-MAX-TERM              PIC S999        COMP-3.
  2719        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2720        16  FILLER                   PIC X.
  2721        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2722        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2723        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2724        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2725        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2726        16  PD-REC-CRIT-PERIOD       PIC X.
  2727        16  PD-RTW-MOS               PIC 99.
  2728        16  FILLER                   PIC X(5).
  2729    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2730    12  PD-TERM-LIMITS OCCURS 15.
  2731        16  PD-LOW-TERM              PIC S999        COMP-3.
  2732        16  PD-HI-TERM               PIC S999        COMP-3.
  2733*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2734    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2735        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2736        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2737    12  PD-EARN-FACTORS.
  2738        16  FILLER OCCURS 15.
  2739            20  FILLER OCCURS 15.
  2740                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2741    12  PD-PRODUCT-DESC              PIC X(80).
  2742    12  PD-TRUNCATED                 PIC X.
  2743    12  FILLER                       PIC X(59).
  2744    12  PD-MAINT-INFORMATION.
  2745        16  PD-LAST-MAINT-DT         PIC X(02).
  2746        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2747        16  PD-LAST-MAINT-BY         PIC X(04).
  2748*                                COPY ELCSTATE.
  2749******************************************************************
  2750*                                                                *
  2751*                                                                *
  2752*                            ELCSTATE.                           *
  2753*                                                                *
  2754*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2755*                                                                *
  2756*   FILE TYPE = VSAM,KSDS                                        *
  2757*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2758*                                                                *
  2759*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2760*       ALTERNATE INDEX = NONE                                   *
  2761*                                                                *
  2762*   LOG = YES                                                    *
  2763*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2764******************************************************************
  2765*                   C H A N G E   L O G
  2766*
  2767* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2768*-----------------------------------------------------------------
  2769*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2770* EFFECTIVE    NUMBER
  2771*-----------------------------------------------------------------
  2772* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  53
* EL050.cbl
  2773******************************************************************
  2774*
  2775 01  STATE-FILE.
  2776     12  SF-RECORD-ID                       PIC XX.
  2777         88  VALID-CF-ID                        VALUE 'SF'.
  2778     12  SF-CONTROL-PRIMARY.
  2779         16  SF-COMPANY-ID                  PIC XXX.
  2780         16  SF-CARRIER-CODE                PIC X.
  2781         16  SF-GROUPING                    PIC X(6).
  2782         16  SF-STATE-CODE                  PIC XX.
  2783         16  SF-EXPIRE-DATE                 PIC 9(8).
  2784****************************************************************
  2785*             STATE CONTROLS
  2786****************************************************************
  2787     12  SF-LAST-MAINT-DT                   PIC XX.
  2788     12  SF-LAST-MAINT-BY                   PIC X(4).
  2789     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2790     12  SF-STATE-RT-CONTROLS.
  2791         16  SF-ST-RT-CALC                  PIC X.
  2792     12  SF-ST-TAX-CONTROLS.
  2793         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2794         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2795         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2796     12  SF-ST-REFUND-OPTIONS.
  2797         16  SF-ST-RF-LR-CALC               PIC X.
  2798         16  SF-ST-RF-LL-CALC               PIC X.
  2799         16  SF-ST-RF-LN-CALC               PIC X.
  2800         16  SF-ST-RF-AH-CALC               PIC X.
  2801         16  SF-ST-RF-CP-CALC               PIC X.
  2802     12  SF-ST-UNEARN-PREM-OPTIONS.
  2803         16  SF-ST-LUEP-R78                 PIC X.
  2804         16  SF-ST-LUEP-PRO                 PIC X.
  2805         16  SF-ST-LUEP-ST                  PIC X.
  2806         16  SF-ST-LUEP-DOM                 PIC X.
  2807         16  SF-ST-AUEP-R78                 PIC X.
  2808         16  SF-ST-AUEP-PRO                 PIC X.
  2809         16  SF-ST-AUEP-ST                  PIC X.
  2810         16  SF-ST-AUEP-DOM                 PIC X.
  2811         16  SF-ST-CUEP-R78                 PIC X.
  2812         16  SF-ST-CUEP-PRO                 PIC X.
  2813         16  SF-ST-CUEP-ST                  PIC X.
  2814         16  SF-ST-CUEP-DOM                 PIC X.
  2815     12  SF-ST-EARN-PREM-OPTIONS.
  2816         16  SF-ST-LEP-R78                  PIC X.
  2817         16  SF-ST-LEP-PRO                  PIC X.
  2818         16  SF-ST-LEP-ST                   PIC X.
  2819         16  SF-ST-LEP-DOM                  PIC X.
  2820         16  SF-ST-AEP-R78                  PIC X.
  2821         16  SF-ST-AEP-PRO                  PIC X.
  2822         16  SF-ST-AEP-ST                   PIC X.
  2823         16  SF-ST-AEP-DOM                  PIC X.
  2824         16  SF-ST-CEP-R78                  PIC X.
  2825         16  SF-ST-CEP-PRO                  PIC X.
  2826         16  SF-ST-CEP-ST                   PIC X.
  2827         16  SF-ST-CEP-DOM                  PIC X.
  2828     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  54
* EL050.cbl
  2830*    COPY ELCCRTT.
  2831******************************************************************
  2832*                                                                *
  2833*                            ELCCRTT.                            *
  2834*                                                                *
  2835*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2836*                                                                *
  2837*   FILE TYPE = VSAM,KSDS                                        *
  2838*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2839*                                                                *
  2840*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2841*                                                                *
  2842*   LOG = YES                                                    *
  2843*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2844******************************************************************
  2845*                   C H A N G E   L O G
  2846*
  2847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2848*-----------------------------------------------------------------
  2849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2850* EFFECTIVE    NUMBER
  2851*-----------------------------------------------------------------
  2852* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2853* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2854* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2855******************************************************************
  2856
  2857 01  CERTIFICATE-TRAILERS.
  2858     12  CS-RECORD-ID                      PIC XX.
  2859         88  VALID-CS-ID                      VALUE 'CS'.
  2860
  2861     12  CS-CONTROL-PRIMARY.
  2862         16  CS-COMPANY-CD                 PIC X.
  2863         16  CS-CARRIER                    PIC X.
  2864         16  CS-GROUPING                   PIC X(6).
  2865         16  CS-STATE                      PIC XX.
  2866         16  CS-ACCOUNT                    PIC X(10).
  2867         16  CS-CERT-EFF-DT                PIC XX.
  2868         16  CS-CERT-NO.
  2869             20  CS-CERT-PRIME             PIC X(10).
  2870             20  CS-CERT-SFX               PIC X.
  2871         16  CS-TRAILER-TYPE               PIC X.
  2872             88  COMM-TRLR           VALUE 'A'.
  2873             88  FUTURE-TRLR         VALUE 'B'.
  2874             88  CERT-DATA-TRLR      VALUE 'C'.
  2875
  2876     12  CS-DATA-AREA                      PIC X(516).
  2877
  2878     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2879         16  CS-BANK-COMMISSION-AREA.
  2880             20  CS-BANK-COMMS       OCCURS 10.
  2881                 24  CS-AGT                PIC X(10).
  2882                 24  CS-COM-TYP            PIC X.
  2883                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2884                 24  CS-RECALC-LV-INDIC    PIC X.
  2885                 24  FILLER                PIC X(10).
  2886         16  FILLER                        PIC X(256).
  2887
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  55
* EL050.cbl
  2888     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2889         16  CS-VIN-NUMBER                 PIC X(17).
  2890         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2891         16  FILLER                        PIC X(498).
  2892******************************************************************
  2893
  2894*    COPY ELCDATE.
  2895******************************************************************
  2896*                                                                *
  2897*                                                                *
  2898*                            ELCDATE.                            *
  2899*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2900*                            VMOD=2.003
  2901*                                                                *
  2902*                                                                *
  2903*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2904*                 LENGTH = 200                                   *
  2905******************************************************************
  2906
  2907 01  DATE-CONVERSION-DATA.
  2908     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2909     12  DC-OPTION-CODE                PIC X.
  2910         88  BIN-TO-GREG                VALUE ' '.
  2911         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2912         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2913         88  YMD-GREG-TO-BIN            VALUE '3'.
  2914         88  MDY-GREG-TO-BIN            VALUE '4'.
  2915         88  JULIAN-TO-BIN              VALUE '5'.
  2916         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2917         88  FIND-CENTURY               VALUE '7'.
  2918         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2919         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2920         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2921         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2922         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2923         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2924         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2925         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2926         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2927         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2928         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2929         88  BIN-3-TO-GREG              VALUE 'I'.
  2930         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2931         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2932         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2933         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2934         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2935         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2936         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2937         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2938         88  THREE-CHARACTER-BIN
  2939                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2940         88  GREGORIAN-TO-BIN
  2941                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2942         88  BIN-TO-GREGORIAN
  2943                  VALUES ' ' '1' 'I' '8' 'G'.
  2944         88  JULIAN-TO-BINARY
  2945                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  56
* EL050.cbl
  2946     12  DC-ERROR-CODE                 PIC X.
  2947         88  NO-CONVERSION-ERROR        VALUE ' '.
  2948         88  DATE-CONVERSION-ERROR
  2949                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2950         88  DATE-IS-ZERO               VALUE '1'.
  2951         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2952         88  DATE-IS-INVALID            VALUE '3'.
  2953         88  DATE1-GREATER-DATE2        VALUE '4'.
  2954         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2955         88  DATE-INVALID-OPTION        VALUE '9'.
  2956         88  INVALID-CENTURY            VALUE 'A'.
  2957         88  ONLY-CENTURY               VALUE 'B'.
  2958         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2959         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2960     12  DC-END-OF-MONTH               PIC X.
  2961         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2962     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2963         88  USE-NORMAL-PROCESS         VALUE ' '.
  2964         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2965         88  ADJUST-UP-100-YRS          VALUE '2'.
  2966     12  FILLER                        PIC X.
  2967     12  DC-CONVERSION-DATES.
  2968         16  DC-BIN-DATE-1             PIC XX.
  2969         16  DC-BIN-DATE-2             PIC XX.
  2970         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2971         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2972                       DC-GREG-DATE-1-EDIT.
  2973             20  DC-EDIT1-MONTH        PIC 99.
  2974             20  SLASH1-1              PIC X.
  2975             20  DC-EDIT1-DAY          PIC 99.
  2976             20  SLASH1-2              PIC X.
  2977             20  DC-EDIT1-YEAR         PIC 99.
  2978         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2979         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2980                     DC-GREG-DATE-2-EDIT.
  2981             20  DC-EDIT2-MONTH        PIC 99.
  2982             20  SLASH2-1              PIC X.
  2983             20  DC-EDIT2-DAY          PIC 99.
  2984             20  SLASH2-2              PIC X.
  2985             20  DC-EDIT2-YEAR         PIC 99.
  2986         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2987         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2988                     DC-GREG-DATE-1-YMD.
  2989             20  DC-YMD-YEAR           PIC 99.
  2990             20  DC-YMD-MONTH          PIC 99.
  2991             20  DC-YMD-DAY            PIC 99.
  2992         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2993         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2994                      DC-GREG-DATE-1-MDY.
  2995             20  DC-MDY-MONTH          PIC 99.
  2996             20  DC-MDY-DAY            PIC 99.
  2997             20  DC-MDY-YEAR           PIC 99.
  2998         16  DC-GREG-DATE-1-ALPHA.
  2999             20  DC-ALPHA-MONTH        PIC X(10).
  3000             20  DC-ALPHA-DAY          PIC 99.
  3001             20  FILLER                PIC XX.
  3002             20  DC-ALPHA-CENTURY.
  3003                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  57
* EL050.cbl
  3004             20  DC-ALPHA-YEAR         PIC 99.
  3005         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3006         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3007         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3008         16  DC-JULIAN-DATE            PIC 9(05).
  3009         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3010                                       PIC 9(05).
  3011         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3012             20  DC-JULIAN-YEAR        PIC 99.
  3013             20  DC-JULIAN-DAYS        PIC 999.
  3014         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3015         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3016         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3017     12  DATE-CONVERSION-VARIBLES.
  3018         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3019         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3020             20  FILLER                PIC 9(3).
  3021             20  HOLD-CEN-1-CCYY.
  3022                 24  HOLD-CEN-1-CC     PIC 99.
  3023                 24  HOLD-CEN-1-YY     PIC 99.
  3024             20  HOLD-CEN-1-MO         PIC 99.
  3025             20  HOLD-CEN-1-DA         PIC 99.
  3026         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3027             20  HOLD-CEN-1-R-MO       PIC 99.
  3028             20  HOLD-CEN-1-R-DA       PIC 99.
  3029             20  HOLD-CEN-1-R-CCYY.
  3030                 24  HOLD-CEN-1-R-CC   PIC 99.
  3031                 24  HOLD-CEN-1-R-YY   PIC 99.
  3032             20  FILLER                PIC 9(3).
  3033         16  HOLD-CENTURY-1-X.
  3034             20  FILLER                PIC X(3)  VALUE SPACES.
  3035             20  HOLD-CEN-1-X-CCYY.
  3036                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3037                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3038             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3039             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3040         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3041             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3042             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3043             20  HOLD-CEN-1-R-X-CCYY.
  3044                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3045                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3046             20  FILLER                PIC XXX.
  3047         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3048         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3049         16  DC-JULIAN-DATE-1          PIC 9(07).
  3050         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3051             20  DC-JULIAN-1-CCYY.
  3052                 24  DC-JULIAN-1-CC    PIC 99.
  3053                 24  DC-JULIAN-1-YR    PIC 99.
  3054             20  DC-JULIAN-DA-1        PIC 999.
  3055         16  DC-JULIAN-DATE-2          PIC 9(07).
  3056         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3057             20  DC-JULIAN-2-CCYY.
  3058                 24  DC-JULIAN-2-CC    PIC 99.
  3059                 24  DC-JULIAN-2-YR    PIC 99.
  3060             20  DC-JULIAN-DA-2        PIC 999.
  3061         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  58
* EL050.cbl
  3062             20  DC-EDITA-MONTH        PIC 99.
  3063             20  SLASHA-1              PIC X VALUE '/'.
  3064             20  DC-EDITA-DAY          PIC 99.
  3065             20  SLASHA-2              PIC X VALUE '/'.
  3066             20  DC-EDITA-CCYY.
  3067                 24  DC-EDITA-CENT     PIC 99.
  3068                 24  DC-EDITA-YEAR     PIC 99.
  3069         16  DC-GREG-DATE-B-EDIT.
  3070             20  DC-EDITB-MONTH        PIC 99.
  3071             20  SLASHB-1              PIC X VALUE '/'.
  3072             20  DC-EDITB-DAY          PIC 99.
  3073             20  SLASHB-2              PIC X VALUE '/'.
  3074             20  DC-EDITB-CCYY.
  3075                 24  DC-EDITB-CENT     PIC 99.
  3076                 24  DC-EDITB-YEAR     PIC 99.
  3077         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3078         16  DC-GREG-DATE-CYMD-R REDEFINES
  3079                              DC-GREG-DATE-CYMD.
  3080             20  DC-CYMD-CEN           PIC 99.
  3081             20  DC-CYMD-YEAR          PIC 99.
  3082             20  DC-CYMD-MONTH         PIC 99.
  3083             20  DC-CYMD-DAY           PIC 99.
  3084         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3085         16  DC-GREG-DATE-MDCY-R REDEFINES
  3086                              DC-GREG-DATE-MDCY.
  3087             20  DC-MDCY-MONTH         PIC 99.
  3088             20  DC-MDCY-DAY           PIC 99.
  3089             20  DC-MDCY-CEN           PIC 99.
  3090             20  DC-MDCY-YEAR          PIC 99.
  3091    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3092        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3093    12  DC-EL310-DATE                  PIC X(21).
  3094    12  FILLER                         PIC X(28).
  3095
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  59
* EL050.cbl
  3097*    COPY ELCCALC.
  3098******************************************************************
  3099*                                                                *
  3100*                           ELCCALC.                            *
  3101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3102*                            VMOD=2.025                          *
  3103*                                                                *
  3104*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3105*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3106*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3107*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3108*                                                                *
  3109*  PASSED TO ELRTRM                                              *
  3110*  -----------------                                             *
  3111*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3112*  ORIGINAL TERM                                                 *
  3113*  BEGINNING DATE                                                *
  3114*  ENDING DATE                                                   *
  3115*  COMPANY I.D.                                                  *
  3116*  ACCOUNT MASTER USER FIELD                                     *
  3117*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3118*  FREE LOOK DAYS                                                *
  3119*                                                                *
  3120*  RETURNED FROM ELRTRM                                          *
  3121*  ---------------------                                         *
  3122*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3123*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3124*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3125*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3126*----------------------------------------------------------------*
  3127*  PASSED TO ELRAMT                                              *
  3128*  ----------------                                              *
  3129*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3130*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3131*  ORIGINAL AMOUNT                                               *
  3132*  ALTERNATE BENEFIT (BALLON)                                    *
  3133*  A.P.R. - NET PAY ONLY                                         *
  3134*  METHOD
  3135*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3136*  COMPANY I.D.                                                  *
  3137*  BENEFIT TYPE                                                  *
  3138*                                                                *
  3139*  RETURNED FROM ELRAMT                                          *
  3140*  --------------------                                          *
  3141*  REMAINING AMOUNT 1 - CURRENT                                  *
  3142*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3143*  REMAINING AMOUNT FACTOR
  3144*----------------------------------------------------------------*
  3145*  PASSED TO ELRESV                                              *
  3146*  -----------------                                             *
  3147*  CERTIFICATE EFFECTIVE DATE                                    *
  3148*  VALUATION DATE                                                *
  3149*  PAID THRU DATE                                                *
  3150*  BENEFIT                                                       *
  3151*  INCURRED DATE                                                 *
  3152*  REPORTED DATE                                                 *
  3153*  ISSUE AGE                                                     *
  3154*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  60
* EL050.cbl
  3155*  CDT PERCENT                                                   *
  3156*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3157* *CLAIM TYPE (LIFE, A/H)                                        *
  3158* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3159* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3160*                                                                *
  3161*  RETURNED FROM ELRESV                                          *
  3162*  --------------------                                          *
  3163*  CDT TABLE USED                                                *
  3164*  CDT FACTOR USED                                               *
  3165*  PAY TO CURRENT RESERVE                                        *
  3166*  I.B.N.R. - A/H ONLY                                           *
  3167*  FUTURE (ACCRUED) AH ONLY                                      *
  3168*----------------------------------------------------------------*
  3169*  PASSED TO ELRATE                                              *
  3170*  ----------------                                              *
  3171*  CERT ISSUE DATE                                               *
  3172*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3173*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3174*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3175*  STATE CODE (CLIENT DEFINED)                                   *
  3176*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3177*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3178*  DEVIATION CODE                                                *
  3179*  ISSUE AGE                                                     *
  3180*  ORIGINAL BENEFIT AMOUNT                                       *
  3181*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3182*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3183*  BENEFIT KIND (LIFE OR A/H)                                    *
  3184*  A.P.R.                                                        *
  3185*  METHOD
  3186*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3187*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3188*  COMPANY I.D. (3 CHARACTER)                                    *
  3189*  BENEFIT CODE                                                  *
  3190*  BENEFIT OVERRIDE CODE                                         *
  3191*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3192*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3193*  JOINT INDICATOR (CSL ONLY)                                    *
  3194*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3195*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3196*                                                                *
  3197*  RETURNED FROM ELRATE                                          *
  3198*  --------------------                                          *
  3199*  CALCULATED PREMIUM                                            *
  3200*  PREMIUM RATE                                                  *
  3201*  MORTALITY CODE                                                *
  3202*  MAX ATTAINED AGE                                              *
  3203*  MAX AGE                                                       *
  3204*  MAX TERM                                                      *
  3205*  MAX MONTHLY BENEFIT                                           *
  3206*  MAX TOTAL BENIFIT                                             *
  3207*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3208*----------------------------------------------------------------*
  3209*  PASSED TO ELRFND                                              *
  3210*  ----------------                                              *
  3211*  CERT ISSUE DATE                                               *
  3212*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  61
* EL050.cbl
  3213*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3214*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3215*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3216*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3217*  STATE CODE (CLIENT DEFINED)                                   *
  3218*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3219*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3220*  DEVIATION CODE                                                *
  3221*  ISSUE AGE                                                     *
  3222*  ORIGINAL BENEFIT AMOUNT                                       *
  3223*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3224*  PROCESS TYPE (CANCEL)                                         *
  3225*  BENEFIT KIND (LIFE OR A/H)                                    *
  3226*  A.P.R.                                                        *
  3227*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3228*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3229*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3230*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3231*  COMPANY I.D. (3 CHARACTER)                                    *
  3232*  BENEFIT CODE                                                  *
  3233*  BENEFIT OVERRIDE CODE                                         *
  3234*                                                                *
  3235*  RETURNED FROM ELRFND                                          *
  3236*  --------------------                                          *
  3237*  CALCULATED REFUND                                             *
  3238*----------------------------------------------------------------*
  3239*  PASSED TO ELEARN                                              *
  3240*  ----------------                                              *
  3241*  CERT ISSUE DATE                                               *
  3242*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3243*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3244*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3245*  STATE CODE (CLIENT DEFINED)                                   *
  3246*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3247*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3248*  DEVIATION CODE                                                *
  3249*  ISSUE AGE                                                     *
  3250*  ORIGINAL BENEFIT AMOUNT                                       *
  3251*  BENEFIT KIND (LIFE OR A/H)                                    *
  3252*  A.P.R.                                                        *
  3253*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3254*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3255*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3256*  COMPANY I.D. (3 CHARACTER)                                    *
  3257*  BENEFIT CODE                                                  *
  3258*  BENEFIT OVERRIDE CODE                                         *
  3259*                                                                *
  3260*  RETURNED FROM ELEARN                                          *
  3261*  --------------------                                          *
  3262*  INDICATED  EARNINGS                                           *
  3263*----------------------------------------------------------------*
  3264*                 LENGTH = 450                                   *
  3265*                                                                *
  3266******************************************************************
  3267******************************************************************
  3268*                   C H A N G E   L O G
  3269*
  3270* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  62
* EL050.cbl
  3271*-----------------------------------------------------------------
  3272*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3273* EFFECTIVE    NUMBER
  3274*-----------------------------------------------------------------
  3275* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3276* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3277* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3278* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3279* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3280* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3281* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3282* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3283* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3284******************************************************************
  3285
  3286 01  CALCULATION-PASS-AREA.
  3287     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3288                                     COMP.
  3289
  3290     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3291       88  NO-CP-ERROR                             VALUE ZERO.
  3292       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3293                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3294       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3295       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3296       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3297       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3298       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3299       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3300       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3301       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3302       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3303       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3304       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3305       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3306       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3307       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3308       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3309       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3310       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3311
  3312     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3313       88  NO-CP-ERROR-2                           VALUE ZERO.
  3314***********************  INPUT AREAS ****************************
  3315
  3316     12  CP-CALCULATION-AREA.
  3317         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3318         16  CP-CERT-EFF-DT        PIC XX.
  3319         16  CP-VALUATION-DT       PIC XX.
  3320         16  CP-PAID-THRU-DT       PIC XX.
  3321         16  CP-BENEFIT-TYPE       PIC X.
  3322           88  CP-AH                               VALUE 'A' 'D'
  3323                                                   'I' 'U'.
  3324           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3325           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3326         16  CP-INCURRED-DT        PIC XX.
  3327         16  CP-REPORTED-DT        PIC XX.
  3328         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  63
* EL050.cbl
  3329         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3330         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3331                                     COMP-3.
  3332         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3333                                     COMP-3.
  3334         16  CP-CDT-METHOD         PIC X.
  3335           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3336           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3337           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3338         16  CP-CLAIM-TYPE         PIC X.
  3339           88  CP-AH-CLAIM                         VALUE 'A'.
  3340           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3341         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3342                                     COMP-3.
  3343         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3344                                     COMP-3.
  3345         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3346                                     COMP-3.
  3347         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3348                                     COMP-3.
  3349         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3350                                     COMP-3.
  3351         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3352                                     COMP-3.
  3353         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3354                                     COMP-3.
  3355         16  CP-REM-TERM-METHOD    PIC X.
  3356           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3357           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3358           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3359           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3360           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3361           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3362           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3363         16  CP-EARNING-METHOD     PIC X.
  3364           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3365           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3366           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3367           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3368           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3369           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3370           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3371           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3372           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3373           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3374           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3375           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3376           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3377           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3378         16  CP-PROCESS-TYPE       PIC X.
  3379           88  CP-CLAIM                            VALUE '1'.
  3380           88  CP-CANCEL                           VALUE '2'.
  3381           88  CP-ISSUE                            VALUE '3'.
  3382         16  CP-SPECIAL-CALC-CD    PIC X.
  3383           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3384           88  CP-1-MTH-INTEREST               VALUE ' '.
  3385           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3386           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  64
* EL050.cbl
  3387           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3388           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3389           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3390           88  CP-FARM-PLAN                    VALUE 'F'.
  3391           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3392           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3393           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3394           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3395           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3396           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3397           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3398           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3399           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3400           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3401                                                     'W' 'X'.
  3402           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3403           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3404           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3405           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3406           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3407           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3408           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3409           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3410           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3411           88  CP-CSL-METH-1                   VALUE '5'.
  3412           88  CP-CSL-METH-2                   VALUE '6'.
  3413           88  CP-CSL-METH-3                   VALUE '7'.
  3414           88  CP-CSL-METH-4                   VALUE '8'.
  3415
  3416         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3417                                     COMP-3.
  3418         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3419         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3420         16  CP-STATE              PIC XX          VALUE SPACE.
  3421         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3422         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3423           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3424               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3425         16  CP-R78-OPTION         PIC X.
  3426           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3427           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3428
  3429         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3430         16  CP-IBNR-RESERVE-SW    PIC X.
  3431         16  CP-CLAIM-STATUS       PIC X.
  3432         16  CP-RATE-FILE          PIC X.
  3433         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3434                                     COMP-3.
  3435
  3436         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3437         16  CP-AH-OVERRIDE-CODE   PIC X.
  3438
  3439         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3440                                     COMP-3.
  3441         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3442                                   PIC S9(5)V99 COMP-3.
  3443         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3444                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  65
* EL050.cbl
  3445         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3446                                     COMP-3.
  3447         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3448                                     COMP-3.
  3449         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3450                                  PIC S9(7)V99 COMP-3.
  3451
  3452         16  CP-PAID-FROM-DATE     PIC X(02).
  3453         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3454         16  CP-EXT-DAYS-CALC      PIC X.
  3455           88  CP-EXT-NO-CHG                   VALUE ' '.
  3456           88  CP-EXT-CHG-LF                   VALUE '1'.
  3457           88  CP-EXT-CHG-AH                   VALUE '2'.
  3458           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3459         16  CP-DOMICILE-STATE     PIC XX.
  3460         16  CP-CARRIER            PIC X.
  3461         16  CP-REIN-FLAG          PIC X.
  3462         16  CP-REM-TRM-CALC-OPTION PIC X.
  3463           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3464                      '2' '3' '4' '5'.
  3465           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3466           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3467           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3468           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3469           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3470           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3471           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3472           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3473         16  CP-SIG-SWITCH         PIC X.
  3474         16  CP-RATING-METHOD      PIC X.
  3475           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3476           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3477           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3478           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3479           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3480           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3481           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3482           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3483           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3484         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3485                                     COMP-3.
  3486         16  CP-BEN-CATEGORY       PIC X.
  3487         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3488         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3489                                   PIC S99V9(5) COMP-3.
  3490         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3491         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3492                                   PIC S99V9(5) COMP-3.
  3493         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3494         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3495         16  CP-EXPIRE-DT          PIC XX.
  3496         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3497         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3498         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3499         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3500         16  CP-DDF-SPEC-CALC      PIC X.
  3501             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3502             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  66
* EL050.cbl
  3503         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3504         16  CP-CANCEL-REASON      PIC X.
  3505         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3506         16  CP-PMT-MODE           PIC X.
  3507         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3508         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3509         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3510         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3511         16  FILLER                PIC X.
  3512
  3513***************    OUTPUT FROM ELRESV   ************************
  3514
  3515         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3516
  3517         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3518                                     COMP-3.
  3519         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3520                                     COMP-3.
  3521         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3522                                     COMP-3.
  3523         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3524                                     COMP-3.
  3525         16  FILLER                PIC X(09).
  3526***************    OUTPUT FROM ELRTRM   *************************
  3527
  3528         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3529                                     COMP-3.
  3530         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3531                                     COMP-3.
  3532         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3533                                     COMP-3.
  3534         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3535                                     COMP-3.
  3536         16  FILLER                PIC X(12).
  3537
  3538***************    OUTPUT FROM ELRAMT   *************************
  3539
  3540         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3541                                     COMP-3.
  3542         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3543                                     COMP-3.
  3544         16  FILLER                PIC X(12).
  3545
  3546***************    OUTPUT FROM ELRATE   *************************
  3547
  3548         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3549                                     COMP-3.
  3550         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3551                                     COMP-3.
  3552         16  CP-MORTALITY-CODE     PIC X(4).
  3553         16  CP-RATE-EDIT-FLAG     PIC X.
  3554             88  CP-RATES-NEED-APR                  VALUE '1'.
  3555         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3556                                     COMP-3.
  3557         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3558         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3559         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3560                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  67
* EL050.cbl
  3561         16  FILLER                PIC X(07).
  3562
  3563***************    OUTPUT FROM ELRFND   *************************
  3564
  3565         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3566                                     COMP-3.
  3567         16  CP-REFUND-TYPE-USED   PIC X.
  3568           88  CP-R-AS-R78                         VALUE '1'.
  3569           88  CP-R-AS-PRORATA                     VALUE '2'.
  3570           88  CP-R-AS-CALIF                       VALUE '3'.
  3571           88  CP-R-AS-TEXAS                       VALUE '4'.
  3572           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3573           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3574           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3575           88  CP-R-AS-MEAN                        VALUE '8'.
  3576           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3577           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3578           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3579           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3580           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3581           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3582         16  FILLER                PIC X(12).
  3583
  3584***************    OUTPUT FROM ELEARN   *************************
  3585
  3586         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3587                                     COMP-3.
  3588         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3589                                     COMP-3.
  3590         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3591                                     COMP-3.
  3592         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3593                                     COMP-3.
  3594         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3595                                     COMP-3.
  3596         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3597                                     COMP-3.
  3598         16  CP-EARNING-TYPE-USED  PIC X.
  3599           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3600           88  CP-E-AS-R78                         VALUE '1'.
  3601           88  CP-E-AS-PRORATA                     VALUE '2'.
  3602           88  CP-E-AS-TEXAS                       VALUE '4'.
  3603           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3604           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3605           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3606           88  CP-E-AS-MEAN                        VALUE '8'.
  3607           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3608         16  FILLER                PIC X(12).
  3609
  3610***************    OUTPUT FROM ELPMNT   *************************
  3611
  3612         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3613                                     COMP-3.
  3614         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3615                                     COMP-3.
  3616         16  FILLER                PIC X(12).
  3617
  3618***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  68
* EL050.cbl
  3619         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3620                                     COMP-3.
  3621         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3622                                     COMP-3.
  3623         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3624                                     COMP-3.
  3625         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3626                                     COMP-3.
  3627         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3628                                     COMP-3.
  3629         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3630                                     COMP-3.
  3631         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3632             88  OPEN-RATE-FILE                   VALUE 'O'.
  3633             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3634             88  IO-ERROR                         VALUE 'E'.
  3635
  3636         16  CP-FIRST-PAY-DATE     PIC XX.
  3637
  3638         16  CP-JOINT-INDICATOR    PIC X.
  3639
  3640         16  CP-RESERVE-REMAINING-TERM
  3641                                   PIC S9(4)V9    VALUE ZERO
  3642                                     COMP-3.
  3643
  3644         16  CP-INSURED-BIRTH-DT   PIC XX.
  3645
  3646         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3647                                     COMP-3.
  3648
  3649         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3650                                     COMP-3.
  3651
  3652         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3653                                     COMP-3.
  3654
  3655         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3656                                     COMP-3.
  3657
  3658         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3659                                     COMP-3.
  3660
  3661         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3662                                     COMP-3.
  3663
  3664         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3665                                     COMP-3.
  3666
  3667         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3668             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3669
  3670         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3671                                     COMP-3.
  3672         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3673                                     COMP-3.
  3674         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3675         16  FILLER                PIC X(15).
  3676******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  69
* EL050.cbl
  3678******************************************************************
  3679*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3680*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3681*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3682*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3683*** MODIFICATION.                                              ***
  3684*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3685*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3686******************************************************************
  3687*    COPY ERCPNDB.
  3688******************************************************************
  3689*                                                                *
  3690*                                                                *
  3691*                            ERCPNDB.                            *
  3692*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3693*                            VMOD=2.025                          *
  3694*                                                                *
  3695*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3696*                                                                *
  3697******************************************************************
  3698*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3699*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3700******************************************************************
  3701*                                                                *
  3702*                                                                *
  3703*   FILE TYPE = VSAM,KSDS                                        *
  3704*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3705*                                                                *
  3706*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3707*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3708*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3709*                                                 RKP=13,LEN=36  *
  3710*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3711*                                      AND CHG-SEQ.)             *
  3712*                                                RKP=49,LEN=11   *
  3713*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3714*                                      AND CHG-SEQ.)             *
  3715*                                                RKP=60,LEN=15   *
  3716*                                                                *
  3717*   LOG = NO                                                     *
  3718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3719******************************************************************
  3720******************************************************************
  3721*                   C H A N G E   L O G
  3722*
  3723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3724*-----------------------------------------------------------------
  3725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3726* EFFECTIVE    NUMBER
  3727*-----------------------------------------------------------------
  3728* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3729* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3730* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3731* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3732* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3733* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3734* 032306                   PEMA  ADD BOW LOAN NUMBER
  3735* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  70
* EL050.cbl
  3736* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3737* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3738* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3739* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3740* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3741* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3742* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3743******************************************************************
  3744
  3745 01  PENDING-BUSINESS.
  3746     12  PB-RECORD-ID                     PIC XX.
  3747         88  VALID-PB-ID                        VALUE 'PB'.
  3748
  3749     12  PB-CONTROL-PRIMARY.
  3750         16  PB-COMPANY-CD                PIC X.
  3751         16  PB-ENTRY-BATCH               PIC X(6).
  3752         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3753         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3754
  3755     12  PB-CONTROL-BY-ACCOUNT.
  3756         16  PB-COMPANY-CD-A1             PIC X.
  3757         16  PB-CARRIER                   PIC X.
  3758         16  PB-GROUPING.
  3759             20  PB-GROUPING-PREFIX       PIC XXX.
  3760             20  PB-GROUPING-PRIME        PIC XXX.
  3761         16  PB-STATE                     PIC XX.
  3762         16  PB-ACCOUNT.
  3763             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3764             20  PB-ACCOUNT-PRIME         PIC X(6).
  3765         16  PB-CERT-EFF-DT               PIC XX.
  3766         16  PB-CERT-NO.
  3767             20  PB-CERT-PRIME            PIC X(10).
  3768             20  PB-CERT-SFX              PIC X.
  3769         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3770
  3771         16  PB-RECORD-TYPE               PIC X.
  3772             88  PB-MAILING-DATA                VALUE '0'.
  3773             88  PB-ISSUE                       VALUE '1'.
  3774             88  PB-CANCELLATION                VALUE '2'.
  3775             88  PB-BATCH-TRAILER               VALUE '9'.
  3776
  3777     12  PB-CONTROL-BY-ORIG-BATCH.
  3778         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3779         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3780         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3781         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3782
  3783     12  PB-CONTROL-BY-CSR.
  3784         16  PB-CSR-COMPANY-CD            PIC X.
  3785         16  PB-CSR-ID                    PIC X(4).
  3786         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3787         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3788         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3789******************************************************************
  3790*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3791******************************************************************
  3792
  3793     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  71
* EL050.cbl
  3794     12  PB-LAST-MAINT-BY                 PIC X(4).
  3795     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3796
  3797     12  PB-RECORD-BODY                   PIC X(375).
  3798
  3799     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3800         16  PB-CERT-ORIGIN               PIC X.
  3801             88  CLASIC-CREATED-CERT         VALUE '1'.
  3802         16  PB-I-NAME.
  3803             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3804             20  PB-I-INSURED-FIRST-NAME.
  3805                 24  PB-I-INSURED-1ST-INIT PIC X.
  3806                 24  FILLER                PIC X(9).
  3807             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3808         16  PB-I-AGE                     PIC S99   COMP-3.
  3809         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3810         16  PB-I-BIRTHDAY                PIC XX.
  3811         16  PB-I-INSURED-SEX             PIC X.
  3812             88  PB-SEX-MALE     VALUE 'M'.
  3813             88  PB-SEX-FEMALE   VALUE 'F'.
  3814
  3815         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3816         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3817         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3818         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3819         16  PB-I-SKIP-CODE               PIC X.
  3820             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3821             88  PB-SKIP-JULY              VALUE '1'.
  3822             88  PB-SKIP-AUGUST            VALUE '2'.
  3823             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3824             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3825             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3826             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3827             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3828             88  PB-SKIP-JUNE              VALUE '8'.
  3829             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3830             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3831             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3832         16  PB-I-TERM-TYPE               PIC X.
  3833             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3834             88  PB-PAID-WEEKLY            VALUE 'W'.
  3835             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3836             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3837             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3838         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3839         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3840         16  PB-I-DATA-ENTRY-SW           PIC X.
  3841             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3842             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3843             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3844             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3845         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3846         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3847*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3848         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3849         16  FILLER                       PIC X.
  3850
  3851         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  72
* EL050.cbl
  3852             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3853             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3854                                                   '90' THRU '99'.
  3855         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3856                                          PIC XX.
  3857         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3858         16  PB-I-AMOUNT-FINANCED REDEFINES
  3859                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3860         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3861         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3862                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3863         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3864         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3865         16  PB-I-CLP-AMOUNT REDEFINES
  3866                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3867         16  PB-I-LF-CALC-FLAG            PIC X.
  3868             88 PB-COMP-LF-PREM               VALUE '?'.
  3869         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3870         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3871         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3872         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3873         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3874         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3875         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3876         16  PB-I-LF-ABBR                 PIC XXX.
  3877         16  PB-I-LF-INPUT-CD             PIC XX.
  3878
  3879         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3880             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3881             88  PB-INVALID-AH               VALUE '  ' '00'
  3882                                                   '90' THRU '99'.
  3883         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3884         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3885         16  PB-I-AH-CALC-FLAG            PIC X.
  3886             88 PB-COMP-AH-PREM                  VALUE '?'.
  3887         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3888         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3889         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3890         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3891         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3892         16  PB-I-AH-ABBR                 PIC XXX.
  3893         16  PB-I-AH-INPUT-CD             PIC XXX.
  3894
  3895         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3896         16  PB-I-REIN-TABLE              PIC XXX.
  3897         16  PB-I-BUSINESS-TYPE           PIC 99.
  3898         16  PB-I-INDV-GRP-CD             PIC X.
  3899         16  PB-I-MORT-CODE.
  3900             20  PB-I-TABLE               PIC X.
  3901             20  PB-I-INTEREST            PIC XX.
  3902             20  PB-I-MORT-TYP            PIC X.
  3903         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3904         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3905         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3906         16  PB-I-INDV-GRP-OVRD           PIC X.
  3907         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3908         16  PB-I-SIG-SW                  PIC X.
  3909             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  73
* EL050.cbl
  3910         16  PB-I-RATE-CLASS              PIC XX.
  3911         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3912         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3913         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3914         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3915         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3916         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3917         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3918         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3919         16  PB-I-OB-FLAG                 PIC X.
  3920             88  PB-I-OB                      VALUE 'B'.
  3921             88  PB-I-SUMMARY                 VALUE 'Z'.
  3922         16  PB-I-ENTRY-STATUS            PIC X.
  3923             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3924                                              'M' '5' '9' '2'.
  3925             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3926             88  PB-I-POLICY-PENDING          VALUE '2'.
  3927             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3928             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3929             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3930             88  PB-I-REIN-ONLY               VALUE '9'.
  3931             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3932             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3933             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3934             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3935         16  PB-I-INT-CODE                PIC X.
  3936             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3937             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3938         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3939         16  PB-I-SOC-SEC-NO              PIC X(11).
  3940         16  PB-I-MEMBER-NO               PIC X(12).
  3941         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3942*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3943         16  PB-I-OLD-LOF                 PIC XXX.
  3944         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3945         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3946         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3947         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3948         16  PB-I-LIFE-INDICATOR          PIC X.
  3949             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3950         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3951         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3952                                          PIC S9(5)V99    COMP-3.
  3953         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3954             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3955             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3956         16  PB-I-1ST-PMT-DT              PIC XX.
  3957         16  PB-I-JOINT-INSURED.
  3958             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3959             20 PB-I-JOINT-FIRST-NAME.
  3960                24  PB-I-JOINT-FIRST-INIT PIC X.
  3961                24  FILLER                PIC X(9).
  3962             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3963*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3964         16  PB-I-BENEFICIARY-NAME.
  3965             20  PB-I-BANK-NUMBER         PIC X(10).
  3966             20  FILLER                   PIC X(15).
  3967         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  74
* EL050.cbl
  3968         16  PB-I-REFERENCE               PIC X(12).
  3969         16  FILLER REDEFINES PB-I-REFERENCE.
  3970             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3971             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3972             20  PB-I-CLP-STATE           PIC XX.
  3973         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3974             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3975             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3976             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3977         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3978         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3979         16  PB-I-RESIDENT-STATE          PIC XX.
  3980         16  PB-I-RATE-CODE               PIC X(4).
  3981         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3982         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3983         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3984         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3985         16  PB-I-BANK-NOCHRGB            PIC 99.
  3986         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3987         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3988
  3989     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3990         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3991             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3992         16  PB-C-CANCEL-ORIGIN           PIC X.
  3993             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3994         16  PB-C-LF-CANCEL-DT            PIC XX.
  3995         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3996         16  PB-C-LF-CALC-REQ             PIC X.
  3997             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3998         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3999         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4000         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4001             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4002         16  PB-C-AH-CANCEL-DT            PIC XX.
  4003         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4004         16  PB-C-AH-CALC-REQ             PIC X.
  4005             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4006         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4007         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4008         16  PB-C-LAST-NAME               PIC X(15).
  4009         16  PB-C-REFUND-SW               PIC X.
  4010             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4011             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4012         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4013         16  PB-C-PAYEE-CODE              PIC X(6).
  4014         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4015         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4016         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4017         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4018         16  PB-C-REFERENCE               PIC X(12).
  4019         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4020         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4021         16  PB-C-POST-CARD-IND           PIC X.
  4022         16  PB-C-CANCEL-REASON           PIC X.
  4023         16  PB-C-REF-INTERFACE-SW        PIC X.
  4024         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4025         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  75
* EL050.cbl
  4026         16  FILLER                       PIC X(01).
  4027*        16  FILLER                       PIC X(18).
  4028         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4029*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4030         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4031         16  PB-CANCELED-CERT-DATA.
  4032             20  PB-CI-INSURED-NAME.
  4033                 24  PB-CI-LAST-NAME      PIC X(15).
  4034                 24  PB-CI-INITIALS       PIC XX.
  4035             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4036             20  PB-CI-INSURED-SEX        PIC X.
  4037             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4038             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4039             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4040             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4041             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4042             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4043             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4044             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4045             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4046             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4047             20  PB-CI-RATE-CLASS         PIC XX.
  4048             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4049             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4050             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4051             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4052             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4053             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4054             20  PB-CI-LF-ABBR            PIC X(3).
  4055             20  PB-CI-AH-ABBR            PIC X(3).
  4056             20  PB-CI-OB-FLAG            PIC X.
  4057                 88  PB-CI-OB                VALUE 'B'.
  4058             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4059                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4060                                           'M' '4' '5' '9' '2'.
  4061                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4062                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4063                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4064                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4065                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4066                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4067                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4068                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4069                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4070                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4071                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4072                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4073             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4074                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4075                                           'M' '4' '5' '9' '2'.
  4076                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4077                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4078                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4079                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4080                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4081                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4082                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4083                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  76
* EL050.cbl
  4084                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4085                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4086                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4087                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4088             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4089             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4090             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4091             20  PB-CI-MEMBER-NO          PIC X(12).
  4092             20  PB-CI-INT-CODE           PIC X.
  4093                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4094                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4095             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4096             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4097             20  PB-CI-COMP-EXCP-SW       PIC X.
  4098                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4099                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4100             20  PB-CI-ENTRY-STATUS       PIC X.
  4101             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4102             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4103             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4104             20  PB-CI-DEATH-DT           PIC XX.
  4105             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4106             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4107             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4108             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4109             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4110             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4111             20  PB-CI-ENTRY-DT              PIC XX.
  4112             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4113             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4114             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4115             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4116             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4117             20  PB-CI-OLD-LOF               PIC XXX.
  4118*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4119             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4120             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4121             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4122             20  PB-CI-INDV-GRP-CD           PIC X.
  4123             20  PB-CI-BENEFICIARY-NAME.
  4124                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4125                 24  FILLER                  PIC X(15).
  4126             20  PB-CI-NOTE-SW               PIC X.
  4127             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4128             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4129             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4130             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4131             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4132             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4133             20  PB-CI-FIRST-NAME            PIC X(10).
  4134             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4135
  4136         16  FILLER                       PIC X(13).
  4137*032306  16  FILLER                       PIC X(27).
  4138*        16  FILLER                       PIC X(46).
  4139
  4140     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4141         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  77
* EL050.cbl
  4142         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4143         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4144         16  PB-M-INSURED-MID-INIT        PIC X.
  4145         16  PB-M-INSURED-AGE             PIC 99.
  4146         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4147         16  PB-M-INSURED-SEX             PIC X.
  4148         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4149         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4150         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4151         16  PB-M-INSURED-CITY-STATE.
  4152             20  PB-M-INSURED-CITY        PIC X(28).
  4153             20  PB-M-INSURED-STATE       PIC XX.
  4154         16  PB-M-INSURED-ZIP-CODE.
  4155             20  PB-M-INSURED-ZIP-PRIME.
  4156                 24  PB-M-INSURED-ZIP-1   PIC X.
  4157                     88  PB-M-CANADIAN-POST-CODE
  4158                                             VALUE 'A' THRU 'Z'.
  4159                 24  FILLER               PIC X(4).
  4160             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4161         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4162                                        PB-M-INSURED-ZIP-CODE.
  4163             20  PM-M-INS-CAN-POST1       PIC XXX.
  4164             20  PM-M-INS-CAN-POST2       PIC XXX.
  4165             20  FILLER                   PIC XXX.
  4166         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4167         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4168         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4169         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4170         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4171         16  PB-M-CRED-BENE-CITYST.
  4172             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4173             20  PB-M-CRED-BENE-STATE     PIC XX.
  4174         16  FILLER                       PIC X(92).
  4175
  4176     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4177         16  FILLER                       PIC X(10).
  4178         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4179         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4180         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4181         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4182         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4183         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4184         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4185         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4186         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4187         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4188         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4189         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4190         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4191         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4192         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4193         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4194         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4195         16  PB-ACCOUNT-NAME              PIC X(30).
  4196         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4197         16  PB-REFERENCE                 PIC X(12).
  4198         16  PB-B-RECEIVED-DT             PIC XX.
  4199         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  78
* EL050.cbl
  4200
  4201     12  PB-RECORD-STATUS.
  4202         16  PB-CREDIT-SELECT-DT          PIC XX.
  4203         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4204         16  PB-BILLED-DT                 PIC XX.
  4205         16  PB-BILLING-STATUS            PIC X.
  4206             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4207             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4208             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4209         16  PB-RECORD-BILL               PIC X.
  4210             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4211             88  PB-RECORD-RETURNED           VALUE 'R'.
  4212             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4213             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4214             88  PB-OVERRIDE-AH               VALUE 'A'.
  4215             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4216         16  PB-BATCH-ENTRY               PIC X.
  4217             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4218             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4219             88  PB-REISSUED-CERT             VALUE 'E'.
  4220             88  PB-MONTHLY-CERT              VALUE 'M'.
  4221             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4222             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4223             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4224         16  PB-FORCE-CODE                PIC X.
  4225             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4226             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4227             88  PB-CANCEL-FORCE              VALUE '8'.
  4228             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4229             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4230             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4231             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4232             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4233             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4234             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4235         16  PB-FATAL-FLAG                PIC X.
  4236             88  PB-FATAL-ERRORS              VALUE 'X'.
  4237         16  PB-FORCE-ER-CD               PIC X.
  4238             88  PB-FORCE-ERRORS              VALUE 'F'.
  4239             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4240         16  PB-WARN-ER-CD                PIC X.
  4241             88  PB-WARNING-ERRORS            VALUE 'W'.
  4242         16  FILLER                       PIC X.
  4243         16  PB-OUT-BAL-CD                PIC X.
  4244             88  PB-OUT-OF-BAL                VALUE 'O'.
  4245         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4246         16  PB-AH-OVERRIDE-L1            PIC X.
  4247         16  PB-INPUT-DT                  PIC XX.
  4248         16  PB-INPUT-BY                  PIC X(4).
  4249         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4250         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4251         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4252         16  PB-LF-EARNING-METHOD         PIC X.
  4253         16  PB-AH-EARNING-METHOD         PIC X.
  4254         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4255         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4256         16  PB-REIN-CD                   PIC XXX.
  4257         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  79
* EL050.cbl
  4258         16  PB-AH-REFUND-TYPE            PIC X.
  4259         16  PB-ACCT-EFF-DT               PIC XX.
  4260         16  PB-ACCT-EXP-DT               PIC XX.
  4261         16  PB-COMPANY-ID                PIC X(3).
  4262         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4263         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4264         16  PB-SV-CARRIER                PIC X.
  4265         16  PB-SV-GROUPING               PIC X(6).
  4266         16  PB-SV-STATE                  PIC XX.
  4267         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4268         16  PB-GA-BILLING-INFO.
  4269             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4270                                          PIC XX.
  4271         16  PB-SV-REMIT-TO  REDEFINES
  4272             PB-GA-BILLING-INFO           PIC X(10).
  4273         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4274         16  PB-I-LOAN-OFFICER            PIC X(5).
  4275         16  PB-I-VIN                     PIC X(17).
  4276
  4277         16  FILLER                       PIC X(04).
  4278         16  IMNET-BYPASS-SW              PIC X.
  4279
  4280******************************************************************
  4281*                COMMON EDIT ERRORS                              *
  4282******************************************************************
  4283
  4284     12  PB-COMMON-ERRORS.
  4285         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4286                                           PIC S9(4)     COMP.
  4287
  4288******************************************************************
  4289
  4290* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4291*    COPY ELC50W1.
  4292******************************************************************
  4293*                                                                *
  4294*                                                                *
  4295*                             ELC50W1                            *
  4296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4297*                            VMOD=2.004                          *
  4298*                                                                *
  4299*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4300*                                                                *
  4301*                                                                *
  4302******************************************************************
  4303
  4304     12  WK-WORK-AREA.
  4305         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4306         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4307         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4308         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4309         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4310         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4311         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4312         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4313         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4314         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4315         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  80
* EL050.cbl
  4316         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4317         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4318         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4319         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4320         16  WK-CREDIT-EDIT-CONTROLS.
  4321             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4322             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4323             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4324             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4325             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4326             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4327         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4328         16  WK-SAVE-REIN-DATA.
  4329             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4330             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4331             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4332         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4333             88  ENTRY-FROM-EL6311       VALUE '6'.
  4334         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4335         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4336     12  WK-RECORD-ADDRESSES.
  4337         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4338         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4339         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4340         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4341         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4342         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4343         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4344         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4345     12  WK-OVER-SHORT-AREA.
  4346         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4347         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4348         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4349             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4350         16  FILLER                   PIC X(5) VALUE SPACES.
  4351
  4352*    COPY ELCEDITC.
  4353******************************************************************
  4354*                                                                *
  4355*                                                                *
  4356*                            ELCEDITC                            *
  4357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4358*                            VMOD=2.012                          *
  4359*                                                                *
  4360*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4361*                     EL6313, EL050 AND EL517.                   *
  4362*                                                                *
  4363******************************************************************
  4364******************************************************************
  4365*                   C H A N G E   L O G
  4366*
  4367* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4368*-----------------------------------------------------------------
  4369*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4370* EFFECTIVE    NUMBER
  4371*-----------------------------------------------------------------
  4372* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4373******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  81
* EL050.cbl
  4374
  4375     12  EDIT-CRITERIA-DATA.
  4376         16  EC-CO-MONTH-END-DT       PIC XX.
  4377         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4378         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4379         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4380         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4381         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4382         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4383         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4384         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4385         16  EC-CO-REM-TERM-CALC      PIC X.
  4386               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4387               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4388               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4389               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4390
  4391         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4392               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4393               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4394               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4395               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4396               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4397               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4398               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4399               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4400               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4401               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4402
  4403         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4404               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4405               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4406               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4407               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4408               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4409               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4410               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4411               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4412
  4413         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4414                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4415                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4416
  4417         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4418                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4419                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4420                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4421                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4422                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4423                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4424                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4425                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4426
  4427         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4428               88  EC-BR-REDUCING                   VALUE 'R'.
  4429               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4430
  4431         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  82
* EL050.cbl
  4432         16  EC-BR-LF-DESC             PIC X(10).
  4433         16  EC-BR-AH-DESC             PIC X(10).
  4434         16  EC-BR-LF-COMMENT          PIC X(10).
  4435         16  EC-BR-AH-COMMENT          PIC X(10).
  4436
  4437         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4438               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4439               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4440               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4441               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4442
  4443         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4444               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4445               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4446               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4447               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4448
  4449         16  EC-BR-LF-REFUND-CALC      PIC X.
  4450                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4451                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4452                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4453                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4454                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4455                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4456                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4457
  4458         16  EC-BR-AH-REFUND-CALC      PIC X.
  4459                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4460                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4461                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4462                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4463                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4464                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4465                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4466                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4467
  4468         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4469                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4470                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4471                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4472
  4473         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4474                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4475                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4476                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4477
  4478         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4479         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4480         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4481         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4482
  4483         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4484         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4485                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4486                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4487                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4488                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4489
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  83
* EL050.cbl
  4490         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4491               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4492               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4493               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4494               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4495               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4496
  4497         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4498               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4499               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4500               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4501               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4502               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4503
  4504         16  EC-ST-LF-REFUND-CALC      PIC X.
  4505                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4506                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4507                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4508                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4509                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4510                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4511                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4512                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4513
  4514         16  EC-ST-AH-REFUND-CALC      PIC X.
  4515                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4516                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4517                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4518                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4519                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4520                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4521                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4522                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4523
  4524         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4525         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4526         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4527         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4528         16  EC-AM-EXPIRATION-DT       PIC XX.
  4529         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4530         16  EC-AM-CLASS-CD            PIC XX.
  4531         16  EC-AM-LF-DEVIATION        PIC XXX.
  4532         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4533         16  EC-AM-AH-DEVIATION        PIC XXX.
  4534         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4535         16  EC-AM-PHONE-NO            PIC X(10).
  4536
  4537         16  EC-AM-LF-REFUND-CALC      PIC X.
  4538                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4539                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4540                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4541                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4542                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4543                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4544                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4545
  4546         16  EC-AM-AH-REFUND-CALC      PIC X.
  4547                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  84
* EL050.cbl
  4548                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4549                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4550                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4551                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4552                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4553                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4554
  4555         16  EC-AM-BEN-I-G-CD          PIC X.
  4556                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4557                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4558                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4559
  4560         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4561         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4562         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4563         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4564         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4565         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4566         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4567         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4568         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4569
  4570         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4571         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4572         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4573         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4574         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4575         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4576         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4577         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4578         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4579         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4580         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4581         16  EC-RT-LF-NSP-ST           PIC XX.
  4582         16  EC-RT-AH-NSP-ST           PIC XX.
  4583         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4584         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4585
  4586         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4587             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4588                                             'M' '5' '9' '2'.
  4589             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4590             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4591             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4592             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4593             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4594             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4595             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4596             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4597             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4598             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4599
  4600         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4601             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4602                                             'M' '5' '9' '2'.
  4603             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4604             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4605             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  85
* EL050.cbl
  4606             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4607             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4608             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4609             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4610             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4611             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4612             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4613
  4614         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4615         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4616         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4617         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4618         16  EC-CM-DEATH-DT            PIC XX.
  4619
  4620*DMD CUSTOM CODING FIELDS BELOW
  4621*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4622         16  EC-BR-DMD-RATING-SW       PIC X.
  4623                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4624                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4625                 88  NO-DMD-RATING               VALUE 'N'.
  4626
  4627         16  EC-NEW-CERT               PIC X(11).
  4628         16  EC-NEW-STATE              PIC XX.
  4629         16  FILLER                    PIC X.
  4630*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4631         16  OVER-SHORT-EDIT-FIELDS.
  4632             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4633             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4634             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4635             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4636             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4637             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4638             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4639             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4640             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4641         16  FILLER                    PIC X(71).
  4642******************************************************************
  4643
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  86
* EL050.cbl
  4645*    COPY ELCDIFRD.
  4646******************************************************************
  4647*                                                                *
  4648*                                                                *
  4649*                            ELCDIFRD.                           *
  4650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4651*                            VMOD=2.004                          *
  4652*                                                                *
  4653*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4654*                                                                *
  4655******************************************************************
  4656*
  4657  01  WS-DIFFERENCE-CALCULATION.
  4658        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4659        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4660        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4661        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4662        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4663        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4664        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4665        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4666        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4667        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4668        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4669
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  87
* EL050.cbl
  4671****************************************************************
  4672*
  4673* Copyright (c) 2007 by Clerity Solutions, Inc.
  4674* All rights reserved.
  4675*
  4676****************************************************************
  4677 01  DFHEIV.
  4678   02  DFHEIV0               PIC X(35).
  4679   02  DFHEIV1               PIC X(08).
  4680   02  DFHEIV2               PIC X(08).
  4681   02  DFHEIV3               PIC X(08).
  4682   02  DFHEIV4               PIC X(06).
  4683   02  DFHEIV5               PIC X(04).
  4684   02  DFHEIV6               PIC X(04).
  4685   02  DFHEIV7               PIC X(02).
  4686   02  DFHEIV8               PIC X(02).
  4687   02  DFHEIV9               PIC X(01).
  4688   02  DFHEIV10              PIC S9(7) COMP-3.
  4689   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4690   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4691   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4692   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4693   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4694   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4695   02  DFHEIV17              PIC X(04).
  4696   02  DFHEIV18              PIC X(04).
  4697   02  DFHEIV19              PIC X(04).
  4698   02  DFHEIV20              USAGE IS POINTER.
  4699   02  DFHEIV21              USAGE IS POINTER.
  4700   02  DFHEIV22              USAGE IS POINTER.
  4701   02  DFHEIV23              USAGE IS POINTER.
  4702   02  DFHEIV24              USAGE IS POINTER.
  4703   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4704   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4705   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4706   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4707   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4708   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4709   02  FILLER                PIC X(02).
  4710   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4711   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4712   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4713   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4714   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4715 LINKAGE  SECTION.
  4716*****************************************************************
  4717*                                                               *
  4718* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4719* All rights reserved.                                          *
  4720*                                                               *
  4721*****************************************************************
  4722 01  dfheiblk.
  4723     02  eibtime          pic s9(7) comp-3.
  4724     02  eibdate          pic s9(7) comp-3.
  4725     02  eibtrnid         pic x(4).
  4726     02  eibtaskn         pic s9(7) comp-3.
  4727     02  eibtrmid         pic x(4).
  4728     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  88
* EL050.cbl
  4729     02  eibcposn         pic s9(4) comp.
  4730     02  eibcalen         pic s9(4) comp.
  4731     02  eibaid           pic x(1).
  4732     02  eibfiller1       pic x(1).
  4733     02  eibfn            pic x(2).
  4734     02  eibfiller2       pic x(2).
  4735     02  eibrcode         pic x(6).
  4736     02  eibfiller3       pic x(2).
  4737     02  eibds            pic x(8).
  4738     02  eibreqid         pic x(8).
  4739     02  eibrsrce         pic x(8).
  4740     02  eibsync          pic x(1).
  4741     02  eibfree          pic x(1).
  4742     02  eibrecv          pic x(1).
  4743     02  eibsend          pic x(1).
  4744     02  eibatt           pic x(1).
  4745     02  eibeoc           pic x(1).
  4746     02  eibfmh           pic x(1).
  4747     02  eibcompl         pic x(1).
  4748     02  eibsig           pic x(1).
  4749     02  eibconf          pic x(1).
  4750     02  eiberr           pic x(1).
  4751     02  eibrldbk         pic x(1).
  4752     02  eiberrcd         pic x(4).
  4753     02  eibsynrb         pic x(1).
  4754     02  eibnodat         pic x(1).
  4755     02  eibfiller5       pic x(2).
  4756     02  eibresp          pic 9(09) comp.
  4757     02  eibresp2         pic 9(09) comp.
  4758     02  dfheigdj         pic s9(4) comp.
  4759     02  dfheigdk         pic s9(4) comp.
  4760
  4761 01  DFHCOMMAREA                   PIC X(1036).
  4762
  4763*01 PARMLIST .
  4764*    02  FILLER                    PIC S9(8)   COMP.
  4765*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4766*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4767*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4768*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4769*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4770*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4771*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4772
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  89
* EL050.cbl
  4774*    COPY ELCCNTL.
  4775******************************************************************
  4776*                                                                *
  4777*                                                                *
  4778*                            ELCCNTL.                            *
  4779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4780*                            VMOD=2.059                          *
  4781*                                                                *
  4782*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4783*                                                                *
  4784*   FILE TYPE = VSAM,KSDS                                        *
  4785*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4786*                                                                *
  4787*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4788*       ALTERNATE INDEX = NONE                                   *
  4789*                                                                *
  4790*   LOG = YES                                                    *
  4791*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4792******************************************************************
  4793*                   C H A N G E   L O G
  4794*
  4795* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4796*-----------------------------------------------------------------
  4797*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4798* EFFECTIVE    NUMBER
  4799*-----------------------------------------------------------------
  4800* 082503                   PEMA  ADD BENEFIT GROUP
  4801* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4802* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4803* 092705    2005050300006  PEMA  ADD SPP LEASES
  4804* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4805* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4806* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4807* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4808* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4809******************************************************************
  4810*
  4811 01  CONTROL-FILE.
  4812     12  CF-RECORD-ID                       PIC XX.
  4813         88  VALID-CF-ID                        VALUE 'CF'.
  4814
  4815     12  CF-CONTROL-PRIMARY.
  4816         16  CF-COMPANY-ID                  PIC XXX.
  4817         16  CF-RECORD-TYPE                 PIC X.
  4818             88  CF-COMPANY-MASTER              VALUE '1'.
  4819             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4820             88  CF-STATE-MASTER                VALUE '3'.
  4821             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4822             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4823             88  CF-CARRIER-MASTER              VALUE '6'.
  4824             88  CF-MORTALITY-MASTER            VALUE '7'.
  4825             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4826             88  CF-TERMINAL-MASTER             VALUE '9'.
  4827             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4828             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4829             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4830             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4831             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  90
* EL050.cbl
  4832             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4833             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4834             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4835             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4836         16  CF-ACCESS-CD-GENL              PIC X(4).
  4837         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4838             20  CF-PROCESSOR               PIC X(4).
  4839         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4840             20  CF-STATE-CODE              PIC XX.
  4841             20  FILLER                     PIC XX.
  4842         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4843             20  FILLER                     PIC XX.
  4844             20  CF-HI-BEN-IN-REC           PIC XX.
  4845         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4846             20  FILLER                     PIC XXX.
  4847             20  CF-CARRIER-CNTL            PIC X.
  4848         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4849             20  FILLER                     PIC XX.
  4850             20  CF-HI-TYPE-IN-REC          PIC 99.
  4851         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4852             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4853                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4854             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4855             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4856         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4857             20  FILLER                     PIC X.
  4858             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4859         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4860             20  FILLER                     PIC XX.
  4861             20  CF-MORTGAGE-PLAN           PIC XX.
  4862         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4863
  4864     12  CF-LAST-MAINT-DT                   PIC XX.
  4865     12  CF-LAST-MAINT-BY                   PIC X(4).
  4866     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4867
  4868     12  CF-RECORD-BODY                     PIC X(728).
  4869
  4870
  4871****************************************************************
  4872*             COMPANY MASTER RECORD                            *
  4873****************************************************************
  4874
  4875     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4876         16  CF-COMPANY-ADDRESS.
  4877             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4878             20  CF-CL-IN-CARE-OF           PIC X(30).
  4879             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4880             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4881             20  CF-CL-CITY-STATE           PIC X(30).
  4882             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4883             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4884         16  CF-COMPANY-CD                  PIC X.
  4885         16  CF-COMPANY-PASSWORD            PIC X(8).
  4886         16  CF-SECURITY-OPTION             PIC X.
  4887             88  ALL-SECURITY                   VALUE '1'.
  4888             88  COMPANY-VERIFY                 VALUE '2'.
  4889             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  91
* EL050.cbl
  4890             88  NO-SECURITY                    VALUE '4'.
  4891             88  ALL-BUT-TERM                   VALUE '5'.
  4892         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4893             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4894         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4895             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4896         16  CF-INFORCE-LOCATION            PIC X.
  4897             88  CERTS-ARE-ONLINE               VALUE '1'.
  4898             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4899             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4900         16  CF-LOWER-CASE-LETTERS          PIC X.
  4901         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4902             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4903             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4904             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4905             88  CF-ACCNT-CNTL                  VALUE '3'.
  4906             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4907
  4908         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4909         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4910
  4911         16  CF-LGX-CREDIT-USER             PIC X.
  4912             88  CO-IS-NOT-USER                 VALUE 'N'.
  4913             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4914
  4915         16 CF-CREDIT-CALC-CODES.
  4916             20  CF-CR-REM-TERM-CALC PIC X.
  4917               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4918               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4919               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4920               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4921               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4922               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4923               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4924             20  CF-CR-R78-METHOD           PIC X.
  4925               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4926               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4927
  4928         16  CF-CLAIM-CONTROL-COUNTS.
  4929             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4930                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4931
  4932             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4933                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4934
  4935             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4936                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4937
  4938             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4939                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4940
  4941         16  CF-CURRENT-MONTH-END           PIC XX.
  4942
  4943         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4944             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4945             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4946             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4947             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  92
* EL050.cbl
  4948                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4949                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4950             20  CF-CO-PREM-REJECT-SW       PIC X.
  4951                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4952                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4953             20  CF-CO-REF-REJECT-SW        PIC X.
  4954                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4955                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4956
  4957         16  CF-CO-REPORTING-DT             PIC XX.
  4958         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4959         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4960           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4961           88  CF-CO-MONTH-END                  VALUE '1'.
  4962
  4963         16  CF-LGX-CLAIM-USER              PIC X.
  4964             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4965             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4966
  4967         16  CF-CREDIT-EDIT-CONTROLS.
  4968             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4969             20  CF-MIN-AGE                 PIC 99.
  4970             20  CF-DEFAULT-AGE             PIC 99.
  4971             20  CF-MIN-TERM                PIC S999      COMP-3.
  4972             20  CF-MAX-TERM                PIC S999      COMP-3.
  4973             20  CF-DEFAULT-SEX             PIC X.
  4974             20  CF-JOINT-AGE-INPUT         PIC X.
  4975                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4976             20  CF-BIRTH-DATE-INPUT        PIC X.
  4977                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4978             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4979                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4980                 88  CF-ZERO-CARRIER            VALUE '1'.
  4981                 88  CF-ZERO-GROUPING           VALUE '2'.
  4982                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4983             20  CF-EDIT-SW                 PIC X.
  4984                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4985             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4986             20  CF-CR-PR-METHOD            PIC X.
  4987               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4988               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4989             20  FILLER                     PIC X.
  4990
  4991         16  CF-CREDIT-MISC-CONTROLS.
  4992             20  CF-REIN-TABLE-SW           PIC X.
  4993                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4994             20  CF-COMP-TABLE-SW           PIC X.
  4995                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4996             20  CF-EXPERIENCE-RETENTION-AGE
  4997                                            PIC S9        COMP-3.
  4998             20  CF-CONVERSION-DT           PIC XX.
  4999             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5000             20  CF-RUN-FREQUENCY-SW        PIC X.
  5001                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5002                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5003
  5004             20  CF-CR-CHECK-NO-CONTROL.
  5005                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  93
* EL050.cbl
  5006                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5007                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5008                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5009                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5010                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5011
  5012                 24  CF-CR-CHECK-COUNT       REDEFINES
  5013                     CF-CR-CHECK-COUNTER      PIC X(4).
  5014
  5015                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5016                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5017
  5018                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5019                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5020                 24  CF-MAIL-PROCESSING       PIC X.
  5021                     88  MAIL-PROCESSING          VALUE 'Y'.
  5022
  5023         16  CF-MISC-SYSTEM-CONTROL.
  5024             20  CF-SYSTEM-C                 PIC X.
  5025                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5026             20  CF-SYSTEM-D                 PIC X.
  5027                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5028             20  CF-SOC-SEC-NO-SW            PIC X.
  5029                 88  SOC-SEC-NO-USED             VALUE '1'.
  5030             20  CF-MEMBER-NO-SW             PIC X.
  5031                 88  MEMBER-NO-USED              VALUE '1'.
  5032             20  CF-TAX-ID-NUMBER            PIC X(11).
  5033             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5034             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5035                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5036                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5037                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5038                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5039             20  CF-SYSTEM-E                 PIC X.
  5040                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5041
  5042         16  CF-LGX-LIFE-USER               PIC X.
  5043             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5044             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5045
  5046         16  CF-CR-MONTH-END-DT             PIC XX.
  5047
  5048         16  CF-FILE-MAINT-DATES.
  5049             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5050                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5051             20  CF-LAST-BATCH       REDEFINES
  5052                 CF-LAST-BATCH-NO               PIC X(4).
  5053             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5054             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5055             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5056             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5057             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5058             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5059             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5060             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5061             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5062             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5063
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  94
* EL050.cbl
  5064         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5065         16  FILLER                         PIC X.
  5066
  5067         16  CF-ALT-MORT-CODE               PIC X(4).
  5068         16  CF-MEMBER-CAPTION              PIC X(10).
  5069
  5070         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5071             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5072             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5073             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5074             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5075             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5076
  5077         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5078
  5079         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5080         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5081         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5082         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5083
  5084         16  CF-AH-OVERRIDE-L1              PIC X.
  5085         16  CF-AH-OVERRIDE-L2              PIC XX.
  5086         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5087         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5088
  5089         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5090         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5091
  5092         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5093         16  CF-AR-LAST-EL860-DT            PIC XX.
  5094         16  CF-MP-MONTH-END-DT             PIC XX.
  5095
  5096         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5097         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5098             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5099
  5100         16  CF-AR-MONTH-END-DT             PIC XX.
  5101
  5102         16  CF-CRDTCRD-USER                PIC X.
  5103             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5104             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5105
  5106         16  CF-CC-MONTH-END-DT             PIC XX.
  5107
  5108         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5109
  5110         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5111             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5112             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5113             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5114         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5115         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5116         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5117         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5118             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5119             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5120         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5121         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  95
* EL050.cbl
  5122         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5123             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5124         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5125
  5126         16  CF-CL-ZIP-CODE.
  5127             20  CF-CL-ZIP-PRIME.
  5128                 24  CF-CL-ZIP-1ST          PIC X.
  5129                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5130                 24  FILLER                 PIC X(4).
  5131             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5132         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5133             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5134             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5135             20  FILLER                     PIC XXX.
  5136
  5137         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5138         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5139         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5140         16  CF-CO-OPTION-START-DATE        PIC XX.
  5141         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5142           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5143                                                      '3' '4'.
  5144           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5145           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5146           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5147           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5148           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5149           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5150
  5151         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5152
  5153         16  CF-PAYMENT-APPROVAL-LEVELS.
  5154             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5155             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5156             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5157             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5158             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5159             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5160
  5161         16  CF-END-USER-REPORTING-USER     PIC X.
  5162             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5163             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5164
  5165         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5166             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5167             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5168
  5169         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5170
  5171         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5172         16  FILLER                         PIC X.
  5173
  5174         16  CF-CREDIT-ARCHIVE-CNTL.
  5175             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5176             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5177             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5178
  5179         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  96
* EL050.cbl
  5180
  5181         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5182             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5183             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5184
  5185         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5186             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5187             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5188
  5189         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5190
  5191         16  CF-CO-ACH-ID-CODE              PIC  X.
  5192             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5193             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5194             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5195         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5196         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5197         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5198         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5199         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5200         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5201         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5202         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5203         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5204                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5205         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5206                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5207
  5208         16  CF-CO-OVER-SHORT.
  5209             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5210             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5211
  5212*         16  FILLER                         PIC X(102).
  5213         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5214             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5215             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5216
  5217         16  CF-AH-APPROVAL-DAYS.
  5218             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5219             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5220             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5221             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5222
  5223         16  FILLER                         PIC X(82).
  5224****************************************************************
  5225*             PROCESSOR/USER RECORD                            *
  5226****************************************************************
  5227
  5228     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5229         16  CF-PROCESSOR-NAME              PIC X(30).
  5230         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5231         16  CF-PROCESSOR-TITLE             PIC X(26).
  5232         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5233                 88  MESSAGE-YES                VALUE 'Y'.
  5234                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5235
  5236*****************************************************
  5237****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  97
* EL050.cbl
  5238****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5239****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5240****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5241*****************************************************
  5242
  5243         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5244             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5245             20  CF-APPLICATION-FORCE       PIC X.
  5246             20  CF-INDIVIDUAL-APP.
  5247                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5248                     28  CF-BROWSE-APP      PIC X.
  5249                     28  CF-UPDATE-APP      PIC X.
  5250
  5251         16  CF-CURRENT-TERM-ON             PIC X(4).
  5252         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5253             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5254             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5255             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5256             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5257             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5258             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5259             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5260         16  CF-PROCESSOR-CARRIER           PIC X.
  5261             88  NO-CARRIER-SECURITY            VALUE ' '.
  5262         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5263             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5264         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5265             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5266         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5267             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5268
  5269         16  CF-PROC-SYS-ACCESS-SW.
  5270             20  CF-PROC-CREDIT-CLAIMS-SW.
  5271                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5272                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5273                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5274                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5275             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5276                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5277                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5278             20  CF-PROC-LIFE-GNRLDGR-SW.
  5279                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5280                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5281                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5282                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5283             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5284                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5285                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5286         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5287             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5288             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5289         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5290
  5291         16  CF-APPROVAL-LEVEL                  PIC X.
  5292             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5293             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5294             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5295             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  98
* EL050.cbl
  5296
  5297         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5298
  5299         16  CF-LANGUAGE-TYPE                   PIC X.
  5300             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5301             88  CF-LANG-IS-FR                      VALUE 'F'.
  5302         16  FILLER                             PIC  X(240).
  5303
  5304****************************************************************
  5305*             PROCESSOR/REMINDERS RECORD                       *
  5306****************************************************************
  5307
  5308     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5309         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5310             20  CF-START-REMIND-DT         PIC XX.
  5311             20  CF-END-REMIND-DT           PIC XX.
  5312             20  CF-REMINDER-TEXT           PIC X(50).
  5313         16  FILLER                         PIC X(296).
  5314
  5315
  5316****************************************************************
  5317*             STATE MASTER RECORD                              *
  5318****************************************************************
  5319
  5320     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5321         16  CF-STATE-ABBREVIATION          PIC XX.
  5322         16  CF-STATE-NAME                  PIC X(25).
  5323         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5324         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5325             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5326             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5327             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5328             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5329                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5330                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5331             20  CF-ST-PREM-REJECT-SW       PIC X.
  5332                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5333                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5334             20  CF-ST-REF-REJECT-SW        PIC X.
  5335                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5336                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5337         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5338         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5339         16  CF-ST-REFUND-RULES.
  5340             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5341             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5342             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5343         16  CF-ST-FST-PMT-EXTENSION.
  5344             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5345             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5346                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5347                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5348                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5349                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5350         16  CF-ST-STATE-CALL.
  5351             20  CF-ST-CALL-UNEARNED        PIC X.
  5352             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5353             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page  99
* EL050.cbl
  5354         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5355             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5356             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5357         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5358         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5359         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5360         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5361         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5362         16  FILLER                         PIC X.
  5363         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5364             20  CF-ST-BENEFIT-CD           PIC XX.
  5365             20  CF-ST-BENEFIT-KIND         PIC X.
  5366                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5367                 88  CF-ST-AH-KIND              VALUE 'A'.
  5368             20  CF-ST-REM-TERM-CALC        PIC X.
  5369                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5370                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5371                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5372                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5373                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5374                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5375                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5376                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5377
  5378             20  CF-ST-REFUND-CALC          PIC X.
  5379                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5380                 88  ST-REFD-BY-R78             VALUE '1'.
  5381                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5382                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5383                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5384                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5385                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5386                 88  ST-REFD-UTAH               VALUE '7'.
  5387                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5388                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5389                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5390
  5391             20  CF-ST-EARNING-CALC         PIC X.
  5392                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5393                 88  ST-EARN-BY-R78             VALUE '1'.
  5394                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5395                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5396                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5397                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5398                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5399                 88  ST-EARN-MEAN               VALUE '8'.
  5400                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5401
  5402             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5403                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5404                 88  ST-OVRD-BY-R78             VALUE '1'.
  5405                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5406                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5407                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5408                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5409                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5410                 88  ST-OVRD-MEAN               VALUE '8'.
  5411                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 100
* EL050.cbl
  5412             20  FILLER                     PIC X.
  5413
  5414         16  CF-ST-COMMISSION-CAPS.
  5415             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5416             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5417             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5418             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5419         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5420                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5421
  5422         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5423
  5424         16  CF-ST-STATUTORY-INTEREST.
  5425             20  CF-ST-STAT-DATE-FROM       PIC X.
  5426                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5427                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5428             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5429             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5430             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5431             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5432             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5433
  5434         16  CF-ST-OVER-SHORT.
  5435             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5436             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5437
  5438         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5439
  5440         16  CF-ST-RT-CALC                  PIC X.
  5441
  5442         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5443         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5444         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5445         16  CF-ST-RF-LR-CALC               PIC X.
  5446         16  CF-ST-RF-LL-CALC               PIC X.
  5447         16  CF-ST-RF-LN-CALC               PIC X.
  5448         16  CF-ST-RF-AH-CALC               PIC X.
  5449         16  CF-ST-RF-CP-CALC               PIC X.
  5450*        16  FILLER                         PIC X(206).
  5451*CIDMOD         16  FILLER                         PIC X(192).
  5452         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5453             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5454         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5455         16  CF-ST-VFY-2ND-BENE             PIC X.
  5456         16  FILLER                         PIC X(186).
  5457
  5458****************************************************************
  5459*             BENEFIT MASTER RECORD                            *
  5460****************************************************************
  5461
  5462     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5463         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5464             20  CF-BENEFIT-CODE            PIC XX.
  5465             20  CF-BENEFIT-NUMERIC  REDEFINES
  5466                 CF-BENEFIT-CODE            PIC XX.
  5467             20  CF-BENEFIT-ALPHA           PIC XXX.
  5468             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5469             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 101
* EL050.cbl
  5470
  5471             20  CF-LF-COVERAGE-TYPE        PIC X.
  5472                 88  CF-REDUCING                VALUE 'R'.
  5473                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5474
  5475             20  CF-SPECIAL-CALC-CD         PIC X.
  5476                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5477                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5478                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5479                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5480                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5481                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5482                 88  CF-FARM-PLAN               VALUE 'F'.
  5483                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5484                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5485                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5486                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5487                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5488                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5489                 88  CF-PRUDENTIAL              VALUE 'P'.
  5490                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5491                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5492                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5493                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5494                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5495                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5496
  5497             20  CF-JOINT-INDICATOR         PIC X.
  5498                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5499
  5500*            20  FILLER                     PIC X(12).
  5501             20  FILLER                     PIC X(11).
  5502             20  CF-BENEFIT-CATEGORY        PIC X.
  5503             20  CF-LOAN-TYPE               PIC X(8).
  5504
  5505             20  CF-CO-REM-TERM-CALC        PIC X.
  5506                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5507                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5508                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5509                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5510                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5511
  5512             20  CF-CO-EARNINGS-CALC        PIC X.
  5513                 88  CO-EARN-BY-R78             VALUE '1'.
  5514                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5515                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5516                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5517                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5518                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5519                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5520                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5521
  5522             20  CF-CO-REFUND-CALC          PIC X.
  5523                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5524                 88  CO-REFD-BY-R78             VALUE '1'.
  5525                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5526                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5527                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 102
* EL050.cbl
  5528                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5529                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5530                 88  CO-REFD-MEAN               VALUE '8'.
  5531                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5532                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5533                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5534
  5535             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5536                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5537                 88  CO-OVRD-BY-R78             VALUE '1'.
  5538                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5539                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5540                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5541                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5542                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5543                 88  CO-OVRD-MEAN               VALUE '8'.
  5544                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5545
  5546             20  CF-CO-BEN-I-G-CD           PIC X.
  5547                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5548                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5549                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5550
  5551         16  FILLER                         PIC X(304).
  5552
  5553
  5554****************************************************************
  5555*             CARRIER MASTER RECORD                            *
  5556****************************************************************
  5557
  5558     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5559         16  CF-ADDRESS-DATA.
  5560             20  CF-MAIL-TO-NAME            PIC X(30).
  5561             20  CF-IN-CARE-OF              PIC X(30).
  5562             20  CF-ADDRESS-LINE-1          PIC X(30).
  5563             20  CF-ADDRESS-LINE-2          PIC X(30).
  5564             20  CF-CITY-STATE              PIC X(30).
  5565             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5566             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5567
  5568         16  CF-CLAIM-NO-CONTROL.
  5569             20  CF-CLAIM-NO-METHOD         PIC X.
  5570                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5571                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5572                 88  CLAIM-NO-SEQ               VALUE '3'.
  5573                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5574             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5575                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5576                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5577                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5578
  5579         16  CF-CHECK-NO-CONTROL.
  5580             20  CF-CHECK-NO-METHOD         PIC X.
  5581                 88  CHECK-NO-MANUAL            VALUE '1'.
  5582                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5583                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5584                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5585             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 103
* EL050.cbl
  5586                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5587
  5588         16  CF-DOMICILE-STATE              PIC XX.
  5589
  5590         16  CF-EXPENSE-CONTROLS.
  5591             20  CF-EXPENSE-METHOD          PIC X.
  5592                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5593                 88  DOLLARS-PER-PMT            VALUE '2'.
  5594                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5595                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5596             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5597             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5598
  5599         16  CF-CORRESPONDENCE-CONTROL.
  5600             20  CF-LETTER-RESEND-OPT       PIC X.
  5601                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5602                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5603             20  FILLER                     PIC X(4).
  5604
  5605         16  CF-RESERVE-CONTROLS.
  5606             20  CF-MANUAL-SW               PIC X.
  5607                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5608             20  CF-FUTURE-SW               PIC X.
  5609                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5610             20  CF-PTC-SW                  PIC X.
  5611                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5612             20  CF-IBNR-SW                 PIC X.
  5613                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5614             20  CF-PTC-LF-SW               PIC X.
  5615                 88  CF-LF-PTC-USED             VALUE '1'.
  5616             20  CF-CDT-ACCESS-METHOD       PIC X.
  5617                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5618                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5619                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5620             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5621
  5622         16  CF-CLAIM-CALC-METHOD           PIC X.
  5623             88  360-PLUS-MONTHS                VALUE '1'.
  5624             88  365-PLUS-MONTHS                VALUE '2'.
  5625             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5626             88  360-DAILY                      VALUE '4'.
  5627             88  365-DAILY                      VALUE '5'.
  5628
  5629         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5630         16  FILLER                         PIC X(11).
  5631
  5632         16  CF-LIMIT-AMOUNTS.
  5633             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5634             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5635             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5636             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5637             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5638             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5639             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5640             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5641             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5642             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5643
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 104
* EL050.cbl
  5644         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5645         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5646         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5647
  5648         16  CF-ZIP-CODE.
  5649             20  CF-ZIP-PRIME.
  5650                 24  CF-ZIP-1ST             PIC X.
  5651                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5652                 24  FILLER                 PIC X(4).
  5653             20  CF-ZIP-PLUS4               PIC X(4).
  5654         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5655             20  CF-CAN-POSTAL-1            PIC XXX.
  5656             20  CF-CAN-POSTAL-2            PIC XXX.
  5657             20  FILLER                     PIC XXX.
  5658
  5659         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5660         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5661         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5662
  5663         16  CF-RATING-SWITCH               PIC X.
  5664             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5665             88  CF-NO-RATING                   VALUE 'N'.
  5666
  5667         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5668
  5669         16  CF-CARRIER-OVER-SHORT.
  5670             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5671             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5672
  5673         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5674         16  CF-SECPAY-SWITCH               PIC X.
  5675             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5676             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5677         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5678         16  FILLER                         PIC X(448).
  5679*        16  FILLER                         PIC X(452).
  5680
  5681
  5682****************************************************************
  5683*             MORTALITY MASTER RECORD                          *
  5684****************************************************************
  5685
  5686     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5687         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5688                                INDEXED BY CF-MORT-NDX.
  5689             20  CF-MORT-TABLE              PIC X(5).
  5690             20  CF-MORT-TABLE-TYPE         PIC X.
  5691                 88  CF-MORT-JOINT              VALUE 'J'.
  5692                 88  CF-MORT-SINGLE             VALUE 'S'.
  5693                 88  CF-MORT-COMBINED           VALUE 'C'.
  5694                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5695                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5696             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5697             20  CF-MORT-AGE-METHOD         PIC XX.
  5698                 88  CF-AGE-LAST                VALUE 'AL'.
  5699                 88  CF-AGE-NEAR                VALUE 'AN'.
  5700             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5701             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 105
* EL050.cbl
  5702                                            PIC X.
  5703                 88  CF-MINUS                   VALUE '-'.
  5704                 88  CF-PLUS                    VALUE '+'.
  5705             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5706             20  CF-MORT-JOINT-CODE         PIC X.
  5707                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5708             20  CF-MORT-PC-Q               PIC X.
  5709                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5710             20  CF-MORT-TABLE-CODE         PIC X(4).
  5711             20  CF-MORT-COMMENTS           PIC X(15).
  5712             20  FILLER                     PIC X(14).
  5713
  5714         16  FILLER                         PIC X(251).
  5715
  5716
  5717****************************************************************
  5718*             BUSSINESS TYPE MASTER RECORD                     *
  5719****************************************************************
  5720
  5721     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5722* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5723* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5724* AND RECORD 05 IS TYPES 81-99
  5725         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5726             20  CF-BUSINESS-TITLE          PIC  X(19).
  5727             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5728                                            PIC S9V9(4) COMP-3.
  5729             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5730             20  FILLER                     PIC  X.
  5731         16  FILLER                         PIC  X(248).
  5732
  5733
  5734****************************************************************
  5735*             TERMINAL MASTER RECORD                           *
  5736****************************************************************
  5737
  5738     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5739
  5740         16  CF-COMPANY-TERMINALS.
  5741             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5742                                  PIC X(4).
  5743         16  FILLER               PIC X(248).
  5744
  5745
  5746****************************************************************
  5747*             LIFE EDIT MASTER RECORD                          *
  5748****************************************************************
  5749
  5750     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5751         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5752             20  CF-LIFE-CODE-IN            PIC XX.
  5753             20  CF-LIFE-CODE-OUT           PIC XX.
  5754         16  FILLER                         PIC X(248).
  5755
  5756
  5757****************************************************************
  5758*             AH EDIT MASTER RECORD                            *
  5759****************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 106
* EL050.cbl
  5760
  5761     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5762         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5763             20  CF-AH-CODE-IN              PIC XXX.
  5764             20  CF-AH-CODE-OUT             PIC XX.
  5765         16  FILLER                         PIC X(248).
  5766
  5767
  5768****************************************************************
  5769*             CREDIBILITY TABLES                               *
  5770****************************************************************
  5771
  5772     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5773         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5774                             INDEXED BY CF-CRDB-NDX.
  5775             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5776             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5777             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5778         16  FILLER                         PIC  X(332).
  5779
  5780
  5781****************************************************************
  5782*             REPORT CUSTOMIZATION RECORD                      *
  5783****************************************************************
  5784
  5785     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5786         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5787             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5788             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5789             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5790**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5791****       A T-TRANSFER.                                   ****
  5792             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5793
  5794         16  FILLER                         PIC XX.
  5795
  5796         16  CF-CARRIER-CNTL-OPT.
  5797             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5798                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5799                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5800             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5801                                            PIC X.
  5802         16  CF-GROUP-CNTL-OPT.
  5803             20  CF-GROUP-OPT-SEQ           PIC 9.
  5804                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5805                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5806             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5807                                            PIC X(6).
  5808         16  CF-STATE-CNTL-OPT.
  5809             20  CF-STATE-OPT-SEQ           PIC 9.
  5810                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5811                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5812             20  CF-STATE-SELECT OCCURS 3 TIMES
  5813                                            PIC XX.
  5814         16  CF-ACCOUNT-CNTL-OPT.
  5815             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5816                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5817                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 107
* EL050.cbl
  5818             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5819                                            PIC X(10).
  5820         16  CF-BUS-TYP-CNTL-OPT.
  5821             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5822                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5823                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5824             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5825                                            PIC XX.
  5826         16  CF-LF-TYP-CNTL-OPT.
  5827             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5828                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5829                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5830             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5831                                            PIC XX.
  5832         16  CF-AH-TYP-CNTL-OPT.
  5833             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5834                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5835                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5836             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5837                                            PIC XX.
  5838         16  CF-REPTCD1-CNTL-OPT.
  5839             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5840                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5841                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5842             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5843                                            PIC X(10).
  5844         16  CF-REPTCD2-CNTL-OPT.
  5845             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5846                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5847                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5848             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5849                                            PIC X(10).
  5850         16  CF-USER1-CNTL-OPT.
  5851             20  CF-USER1-OPT-SEQ           PIC 9.
  5852                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5853                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5854             20  CF-USER1-SELECT OCCURS 3 TIMES
  5855                                            PIC X(10).
  5856         16  CF-USER2-CNTL-OPT.
  5857             20  CF-USER2-OPT-SEQ           PIC 9.
  5858                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5859                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5860             20  CF-USER2-SELECT OCCURS 3 TIMES
  5861                                            PIC X(10).
  5862         16  CF-USER3-CNTL-OPT.
  5863             20  CF-USER3-OPT-SEQ           PIC 9.
  5864                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5865                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5866             20  CF-USER3-SELECT OCCURS 3 TIMES
  5867                                            PIC X(10).
  5868         16  CF-USER4-CNTL-OPT.
  5869             20  CF-USER4-OPT-SEQ           PIC 9.
  5870                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5871                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5872             20  CF-USER4-SELECT OCCURS 3 TIMES
  5873                                            PIC X(10).
  5874         16  CF-USER5-CNTL-OPT.
  5875             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 108
* EL050.cbl
  5876                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5877                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5878             20  CF-USER5-SELECT OCCURS 3 TIMES
  5879                                            PIC X(10).
  5880         16  CF-REINS-CNTL-OPT.
  5881             20  CF-REINS-OPT-SEQ           PIC 9.
  5882                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5883                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5884             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5885                 24  CF-REINS-PRIME         PIC XXX.
  5886                 24  CF-REINS-SUB           PIC XXX.
  5887
  5888         16  CF-AGENT-CNTL-OPT.
  5889             20  CF-AGENT-OPT-SEQ           PIC 9.
  5890                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5891                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5892             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5893                                            PIC X(10).
  5894
  5895         16  FILLER                         PIC X(43).
  5896
  5897         16  CF-LOSS-RATIO-SELECT.
  5898             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5899             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5900         16  CF-ENTRY-DATE-SELECT.
  5901             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5902             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5903         16  CF-EFFECTIVE-DATE-SELECT.
  5904             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5905             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5906
  5907         16  CF-EXCEPTION-LIST-IND          PIC X.
  5908             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5909
  5910         16  FILLER                         PIC X(318).
  5911
  5912****************************************************************
  5913*                  EXCEPTION REPORTING RECORD                  *
  5914****************************************************************
  5915
  5916     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5917         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5918             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5919
  5920         16  CF-COMBINED-LIFE-AH-OPT.
  5921             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5922             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5923             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5924             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5925
  5926         16  CF-LIFE-OPT.
  5927             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5928             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5929             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5930             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5931             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5932             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5933             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 109
* EL050.cbl
  5934             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5935             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5936             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5937
  5938         16  CF-AH-OPT.
  5939             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5940             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5941             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5942             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5943             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5944             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5945             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5946             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5947             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5948             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5949
  5950         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5951             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5952             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5953             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5954
  5955         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5956
  5957         16  FILLER                         PIC X(673).
  5958
  5959
  5960****************************************************************
  5961*             MORTGAGE SYSTEM PLAN RECORD                      *
  5962****************************************************************
  5963
  5964     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5965         16  CF-PLAN-TYPE                   PIC X.
  5966             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5967             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5968             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5969         16  CF-PLAN-ABBREV                 PIC XXX.
  5970         16  CF-PLAN-DESCRIPT               PIC X(10).
  5971         16  CF-PLAN-NOTES                  PIC X(20).
  5972         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5973         16  CF-PLAN-UNDERWRITING.
  5974             20  CF-PLAN-TERM-DATA.
  5975                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5976                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5977             20  CF-PLAN-AGE-DATA.
  5978                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5979                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5980                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5981             20  CF-PLAN-BENEFIT-DATA.
  5982                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5983                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5984                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5985                                            PIC S9(7)V99  COMP-3.
  5986         16  CF-PLAN-POLICY-FORMS.
  5987             20  CF-POLICY-FORM             PIC X(12).
  5988             20  CF-MASTER-APPLICATION      PIC X(12).
  5989             20  CF-MASTER-POLICY           PIC X(12).
  5990         16  CF-PLAN-RATING.
  5991             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 110
* EL050.cbl
  5992             20  CF-SEX-RATING              PIC X.
  5993                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5994                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5995             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5996             20  CF-SUB-STD-TYPE            PIC X.
  5997                 88  CF-PCT-OF-PREM            VALUE '1'.
  5998                 88  CF-PCT-OF-BENE            VALUE '2'.
  5999         16  CF-PLAN-PREM-TOLERANCES.
  6000             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6001             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6002         16  CF-PLAN-PYMT-TOLERANCES.
  6003             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6004             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6005         16  CF-PLAN-MISC-DATA.
  6006             20  FILLER                     PIC X.
  6007             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6008             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6009         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6010         16  CF-PLAN-IND-GRP                PIC X.
  6011             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6012                                                     '1'.
  6013             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6014                                                     '2'.
  6015         16  CF-MIB-SEARCH-SW               PIC X.
  6016             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6017             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6018             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6019             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6020         16  CF-ALPHA-SEARCH-SW             PIC X.
  6021             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6022             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6023             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6024             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6025             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6026             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6027             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6028             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6029             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6030             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6031                                                     'A' 'B' 'C'
  6032                                                     'X' 'Y' 'Z'.
  6033         16  CF-EFF-DT-RULE-SW              PIC X.
  6034             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6035             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6036             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6037             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6038             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6039         16  FILLER                         PIC X(4).
  6040         16  CF-HEALTH-QUESTIONS            PIC X.
  6041             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6042         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6043         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6044         16  CF-PLAN-SNGL-JNT               PIC X.
  6045             88  CF-COMBINED-PLAN              VALUE 'C'.
  6046             88  CF-JNT-PLAN                   VALUE 'J'.
  6047             88  CF-SNGL-PLAN                  VALUE 'S'.
  6048         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6049         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 111
* EL050.cbl
  6050         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6051         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6052         16  CF-RERATE-CNTL                 PIC  X.
  6053             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6054             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6055             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6056             88  CF-AUTO-RECALC                 VALUE '4'.
  6057         16  CF-BENEFIT-TYPE                PIC  X.
  6058             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6059             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6060         16  CF-POLICY-FEE                  PIC S999V99
  6061                                                    COMP-3.
  6062         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6063         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6064         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6065         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6066         16  FILLER                         PIC  X(32).
  6067         16  CF-TERMINATION-FORM            PIC  X(04).
  6068         16  FILLER                         PIC  X(08).
  6069         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6070                                                       COMP-3.
  6071         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6072         16  CF-ISSUE-LETTER                PIC  X(4).
  6073         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6074         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6075             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6076             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6077         16  CF-MP-REFUND-CALC              PIC X.
  6078             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6079             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6080             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6081             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6082             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6083             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6084             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6085             88  CF-MP-REFD-MEAN                VALUE '8'.
  6086         16  CF-ALT-RATE-CODE               PIC  X(5).
  6087
  6088
  6089         16  FILLER                         PIC X(498).
  6090****************************************************************
  6091*             MORTGAGE COMPANY MASTER RECORD                   *
  6092****************************************************************
  6093
  6094     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6095         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6096         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6097             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6098             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6099             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6100             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6101             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6102
  6103         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6104         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6105         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6106         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6107         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 112
* EL050.cbl
  6108
  6109         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6110             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6111         16  CF-MP-RECON-USE-IND            PIC X(1).
  6112             88  CF-MP-USE-RECON             VALUE 'Y'.
  6113         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6114             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6115         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6116             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6117             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6118         16  FILLER                         PIC X(1).
  6119         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6120             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6121         16  CF-MORTG-MIB-VERSION           PIC X.
  6122             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6123             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6124             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6125         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6126             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6127                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6128             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6129                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6130             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6131                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6132             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6133                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6134             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6135                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6136             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6137                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6138         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6139         16  FILLER                         PIC X(7).
  6140         16  CF-MORTG-DESTINATION-SYMBOL.
  6141             20  CF-MORTG-MIB-COMM          PIC X(5).
  6142             20  CF-MORTG-MIB-TERM          PIC X(5).
  6143         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6144             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6145         16  FILLER                         PIC X(03).
  6146         16  CF-MP-CHECK-NO-CONTROL.
  6147             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6148                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6149                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6150                                                ' ' LOW-VALUES.
  6151                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6152                                               VALUE '3'.
  6153         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6154         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6155         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6156             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6157                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6158             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6159                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6160             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6161                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6162             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6163                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6164             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6165                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 113
* EL050.cbl
  6166             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6167                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6168         16  CF-MORTG-BILLING-AREA.
  6169             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6170                                            PIC X.
  6171         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6172         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6173         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6174         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6175             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6176             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6177         16  FILLER                         PIC X.
  6178         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6179             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6180             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6181         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6182         16  FILLER                         PIC X(8).
  6183         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6184         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6185         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6186         16  CF-ACH-COMPANY-ID.
  6187             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6188                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6189                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6190                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6191             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6192         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6193             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6194         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6195             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6196             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6197         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6198         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6199         16  FILLER                         PIC X(536).
  6200
  6201****************************************************************
  6202*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6203****************************************************************
  6204
  6205     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6206         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6207             20  CF-FEMALE-HEIGHT.
  6208                 24  CF-FEMALE-FT           PIC 99.
  6209                 24  CF-FEMALE-IN           PIC 99.
  6210             20  CF-FEMALE-MIN-WT           PIC 999.
  6211             20  CF-FEMALE-MAX-WT           PIC 999.
  6212         16  FILLER                         PIC X(428).
  6213
  6214     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6215         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6216             20  CF-MALE-HEIGHT.
  6217                 24  CF-MALE-FT             PIC 99.
  6218                 24  CF-MALE-IN             PIC 99.
  6219             20  CF-MALE-MIN-WT             PIC 999.
  6220             20  CF-MALE-MAX-WT             PIC 999.
  6221         16  FILLER                         PIC X(428).
  6222******************************************************************
  6223*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 114
* EL050.cbl
  6224******************************************************************
  6225     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6226         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6227             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6228             20  CF-SYS-LETTER-ID           PIC X(04).
  6229             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6230             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6231             20  CF-SYS-RESET-SW            PIC X(01).
  6232             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6233             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6234
  6235         16  FILLER                         PIC X(50).
  6236
  6237         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6238             20  CF-USER-ACTIVE-SW          PIC X(01).
  6239             20  CF-USER-LETTER-ID          PIC X(04).
  6240             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6241             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6242             20  CF-USER-RESET-SW           PIC X(01).
  6243             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6244             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6245             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6246
  6247         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 115
* EL050.cbl
  6249*    COPY ERCACCT.
  6250******************************************************************
  6251*                                                                *
  6252*                                                                *
  6253*                            ERCACCT                             *
  6254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6255*                            VMOD=2.031                          *
  6256*                                                                *
  6257*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6258*                                                                *
  6259*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6260*   VSAM ACCOUNT MASTER FILES.                                   *
  6261*                                                                *
  6262*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6263*                                                                *
  6264*   FILE TYPE = VSAM,KSDS                                        *
  6265*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6266*                                                                *
  6267*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6268*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6269*                                                                *
  6270*   LOG = NO                                                     *
  6271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6272*                                                                *
  6273*                                                                *
  6274******************************************************************
  6275*                   C H A N G E   L O G
  6276*
  6277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6278*-----------------------------------------------------------------
  6279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6280* EFFECTIVE    NUMBER
  6281*-----------------------------------------------------------------
  6282* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6283* 092705    2005050300006  PEMA  ADD SPP LEASES
  6284* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6285* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6286* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6287* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6288* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6289******************************************************************
  6290
  6291 01  ACCOUNT-MASTER.
  6292     12  AM-RECORD-ID                      PIC XX.
  6293         88  VALID-AM-ID                      VALUE 'AM'.
  6294
  6295     12  AM-CONTROL-PRIMARY.
  6296         16  AM-COMPANY-CD                 PIC X.
  6297         16  AM-MSTR-CNTRL.
  6298             20  AM-CONTROL-A.
  6299                 24  AM-CARRIER            PIC X.
  6300                 24  AM-GROUPING.
  6301                     28 AM-GROUPING-PREFIX PIC XXX.
  6302                     28 AM-GROUPING-PRIME  PIC XXX.
  6303                 24  AM-STATE              PIC XX.
  6304                 24  AM-ACCOUNT.
  6305                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6306                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 116
* EL050.cbl
  6307             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6308                                           PIC X(19).
  6309             20  AM-CNTRL-B.
  6310                 24  AM-EXPIRATION-DT      PIC XX.
  6311                 24  FILLER                PIC X(4).
  6312             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6313                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6314
  6315     12  AM-CONTROL-BY-VAR-GRP.
  6316         16  AM-COMPANY-CD-A1              PIC X.
  6317         16  AM-VG-CARRIER                 PIC X.
  6318         16  AM-VG-GROUPING                PIC X(6).
  6319         16  AM-VG-STATE                   PIC XX.
  6320         16  AM-VG-ACCOUNT                 PIC X(10).
  6321         16  AM-VG-DATE.
  6322             20  AM-VG-EXPIRATION-DT       PIC XX.
  6323             20  FILLER                    PIC X(4).
  6324         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6325                                           PIC 9(11)      COMP-3.
  6326     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6327         16  FILLER                        PIC X(10).
  6328         16  AM-VG-KEY3.
  6329             20  AM-VG3-ACCOUNT            PIC X(10).
  6330             20  AM-VG3-EXP-DT             PIC XX.
  6331         16  FILLER                        PIC X(4).
  6332     12  AM-MAINT-INFORMATION.
  6333         16  AM-LAST-MAINT-DT              PIC XX.
  6334         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6335         16  AM-LAST-MAINT-USER            PIC X(4).
  6336         16  FILLER                        PIC XX.
  6337
  6338     12  AM-EFFECTIVE-DT                   PIC XX.
  6339     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6340
  6341     12  AM-PREV-DATES  COMP-3.
  6342         16  AM-PREV-EXP-DT                PIC 9(11).
  6343         16  AM-PREV-EFF-DT                PIC 9(11).
  6344
  6345     12  AM-REPORT-CODE-1                  PIC X(10).
  6346     12  AM-REPORT-CODE-2                  PIC X(10).
  6347
  6348     12  AM-CITY-CODE                      PIC X(4).
  6349     12  AM-COUNTY-PARISH                  PIC X(6).
  6350
  6351     12  AM-NAME                           PIC X(30).
  6352     12  AM-PERSON                         PIC X(30).
  6353     12  AM-ADDRS                          PIC X(30).
  6354     12  AM-CITY.
  6355         16  AM-ADDR-CITY                  PIC X(28).
  6356         16  AM-ADDR-STATE                 PIC XX.
  6357     12  AM-ZIP.
  6358         16  AM-ZIP-PRIME.
  6359             20  AM-ZIP-PRI-1ST            PIC X.
  6360                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6361             20  FILLER                    PIC X(4).
  6362         16  AM-ZIP-PLUS4                  PIC X(4).
  6363     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6364         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 117
* EL050.cbl
  6365         16  AM-CAN-POSTAL-2               PIC XXX.
  6366         16  FILLER                        PIC XXX.
  6367     12  AM-TEL-NO.
  6368         16  AM-AREA-CODE                  PIC 999.
  6369         16  AM-TEL-PRE                    PIC 999.
  6370         16  AM-TEL-NBR                    PIC 9(4).
  6371     12  AM-TEL-LOC                        PIC X.
  6372         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6373         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6374
  6375     12  AM-COMM-STRUCTURE.
  6376         16  AM-DEFN-1.
  6377             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6378                 24  AM-AGT.
  6379                     28  AM-AGT-PREFIX     PIC X(4).
  6380                     28  AM-AGT-PRIME      PIC X(6).
  6381                 24  AM-COM-TYP            PIC X.
  6382                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6383                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6384                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6385                 24  AM-RECALC-LV-INDIC    PIC X.
  6386                 24  AM-RETRO-LV-INDIC     PIC X.
  6387                 24  AM-GL-CODES           PIC X.
  6388                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6389                 24  FILLER                PIC X(01).
  6390         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6391             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6392                 24  FILLER                PIC X(11).
  6393                 24  AM-L-COMA             PIC XXX.
  6394                 24  AM-J-COMA             PIC XXX.
  6395                 24  AM-A-COMA             PIC XXX.
  6396                 24  FILLER                PIC X(6).
  6397
  6398     12  AM-COMM-CHANGE-STATUS             PIC X.
  6399         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6400
  6401     12  AM-CSR-CODE                       PIC X(4).
  6402
  6403     12  AM-BILLING-STATUS                 PIC X.
  6404         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6405         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6406     12  AM-AUTO-REFUND-SW                 PIC X.
  6407         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6408         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6409     12  AM-GPCD                           PIC 99.
  6410     12  AM-IG                             PIC X.
  6411         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6412         88  AM-HAS-GROUP                     VALUE '2'.
  6413     12  AM-STATUS                         PIC X.
  6414         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6415         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6416         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6417         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6418         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6419         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6420     12  AM-REMIT-TO                       PIC 99.
  6421     12  AM-ID-NO                          PIC X(11).
  6422
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 118
* EL050.cbl
  6423     12  AM-CAL-TABLE                      PIC XX.
  6424     12  AM-LF-DEVIATION                   PIC XXX.
  6425     12  AM-AH-DEVIATION                   PIC XXX.
  6426     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6427     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6428     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6429     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6430     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6431     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6432
  6433     12  AM-USER-FIELDS.
  6434         16  AM-FLD-1                      PIC XX.
  6435         16  AM-FLD-2                      PIC XX.
  6436         16  AM-FLD-3                      PIC XX.
  6437         16  AM-FLD-4                      PIC XX.
  6438         16  AM-FLD-5                      PIC XX.
  6439
  6440     12  AM-1ST-PROD-DATE.
  6441         16  AM-1ST-PROD-YR                PIC XX.
  6442         16  AM-1ST-PROD-MO                PIC XX.
  6443         16  AM-1ST-PROD-DA                PIC XX.
  6444     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6445     12  AM-CERTS-PURGED-DATE.
  6446         16  AM-PUR-YR                     PIC XX.
  6447         16  AM-PUR-MO                     PIC XX.
  6448         16  AM-PUR-DA                     PIC XX.
  6449     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6450     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6451     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6452     12  AM-INACTIVE-DATE.
  6453         16  AM-INA-MO                     PIC 99.
  6454         16  AM-INA-DA                     PIC 99.
  6455         16  AM-INA-YR                     PIC 99.
  6456     12  AM-AR-HI-CERT-DATE                PIC XX.
  6457
  6458     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6459     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6460
  6461     12  AM-OB-PAYMENT-MODE                PIC X.
  6462         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6463         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6464         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6465         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6466
  6467     12  AM-AH-ONLY-INDICATOR              PIC X.
  6468         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6469         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6470
  6471     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6472
  6473     12  AM-OVER-SHORT.
  6474         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6475         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6476
  6477     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6478     12  AM-DCC-CLP-STATE                  PIC XX.
  6479
  6480     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 119
* EL050.cbl
  6481     12  AM-RECALC-REIN                    PIC X.
  6482
  6483     12  AM-REI-TABLE                      PIC XXX.
  6484     12  AM-REI-ET-LF                      PIC X.
  6485     12  AM-REI-ET-AH                      PIC X.
  6486     12  AM-REI-PE-LF                      PIC X.
  6487     12  AM-REI-PE-AH                      PIC X.
  6488     12  AM-REI-PRT-ST                     PIC X.
  6489     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6490     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6491     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6492     12  AM-REI-GROUP-A                    PIC X(6).
  6493     12  AM-REI-MORT                       PIC X(4).
  6494     12  AM-REI-PRT-OW                     PIC X.
  6495     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6496     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6497     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6498     12  AM-REI-GROUP-B                    PIC X(6).
  6499
  6500     12  AM-TRUST-TYPE                     PIC X(2).
  6501
  6502     12  AM-EMPLOYER-STMT-USED             PIC X.
  6503     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6504
  6505     12  AM-STD-AH-TYPE                    PIC XX.
  6506     12  AM-EARN-METHODS.
  6507         16  AM-EARN-METHOD-R              PIC X.
  6508             88 AM-REF-RL-R78                 VALUE 'R'.
  6509             88 AM-REF-RL-PR                  VALUE 'P'.
  6510             88 AM-REF-RL-MEAN                VALUE 'M'.
  6511             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6512         16  AM-EARN-METHOD-L              PIC X.
  6513             88 AM-REF-LL-R78                 VALUE 'R'.
  6514             88 AM-REF-LL-PR                  VALUE 'P'.
  6515             88 AM-REF-LL-MEAN                VALUE 'M'.
  6516             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6517         16  AM-EARN-METHOD-A              PIC X.
  6518             88 AM-REF-AH-R78                 VALUE 'R'.
  6519             88 AM-REF-AH-PR                  VALUE 'P'.
  6520             88 AM-REF-AH-MEAN                VALUE 'M'.
  6521             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6522             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6523             88 AM-REF-AH-NET                 VALUE 'N'.
  6524
  6525     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6526     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6527     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6528
  6529     12  AM-RET-Y-N                        PIC X.
  6530     12  AM-RET-P-E                        PIC X.
  6531     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6532     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6533     12  AM-RET-GRP                        PIC X(6).
  6534     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6535         16  AM-POOL-PRIME                 PIC XXX.
  6536         16  AM-POOL-SUB                   PIC XXX.
  6537     12  AM-RETRO-EARNINGS.
  6538         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 120
* EL050.cbl
  6539         16  AM-RET-EARN-L                 PIC X.
  6540         16  AM-RET-EARN-A                 PIC X.
  6541     12  AM-RET-ST-TAX-USE                 PIC X.
  6542         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6543         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6544     12  AM-RETRO-BEG-EARNINGS.
  6545         16  AM-RET-BEG-EARN-R             PIC X.
  6546         16  AM-RET-BEG-EARN-L             PIC X.
  6547         16  AM-RET-BEG-EARN-A             PIC X.
  6548     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6549     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6550
  6551     12  AM-USER-SELECT-OPTIONS.
  6552         16  AM-USER-SELECT-1              PIC X(10).
  6553         16  AM-USER-SELECT-2              PIC X(10).
  6554         16  AM-USER-SELECT-3              PIC X(10).
  6555         16  AM-USER-SELECT-4              PIC X(10).
  6556         16  AM-USER-SELECT-5              PIC X(10).
  6557
  6558     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6559
  6560     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6561
  6562     12  AM-RPT045A-SWITCH                 PIC X.
  6563         88  RPT045A-OFF                   VALUE 'N'.
  6564
  6565     12  AM-INSURANCE-LIMITS.
  6566         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6567         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6568
  6569     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6570         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6571
  6572     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6573         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6574         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6575
  6576     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6577
  6578     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6579     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6580     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6581     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6582     12  AM-DCC-UEF-STATE                  PIC XX.
  6583     12  FILLER                            PIC XXX.
  6584     12  AM-REPORT-CODE-3                  PIC X(10).
  6585*    12  FILLER                            PIC X(22).
  6586
  6587     12  AM-RESERVE-DATE.
  6588         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6589         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6590         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6591
  6592     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6593     12  AM-NOTIFICATION-TYPES.
  6594         16  AM-NOTIF-OF-LETTERS           PIC X.
  6595         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6596         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 121
* EL050.cbl
  6597         16  AM-NOTIF-OF-STATUS            PIC X.
  6598
  6599     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6600         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6601         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6602         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6603         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6604
  6605     12  AM-BENEFIT-CONTROLS.
  6606         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6607             20  AM-BENEFIT-CODE           PIC XX.
  6608             20  AM-BENEFIT-TYPE           PIC X.
  6609             20  AM-BENEFIT-REVISION       PIC XXX.
  6610             20  AM-BENEFIT-REM-TERM       PIC X.
  6611             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6612             20  FILLER                    PIC XX.
  6613         16  FILLER                        PIC X(80).
  6614
  6615     12  AM-TRANSFER-DATA.
  6616         16  AM-TRANSFERRED-FROM.
  6617             20  AM-TRNFROM-CARRIER        PIC X.
  6618             20  AM-TRNFROM-GROUPING.
  6619                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6620                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6621             20  AM-TRNFROM-STATE          PIC XX.
  6622             20  AM-TRNFROM-ACCOUNT.
  6623                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6624                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6625             20  AM-TRNFROM-DTE            PIC XX.
  6626         16  AM-TRANSFERRED-TO.
  6627             20  AM-TRNTO-CARRIER          PIC X.
  6628             20  AM-TRNTO-GROUPING.
  6629                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6630                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6631             20  AM-TRNTO-STATE            PIC XX.
  6632             20  AM-TRNTO-ACCOUNT.
  6633                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6634                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6635             20  AM-TRNTO-DTE              PIC XX.
  6636         16  FILLER                        PIC X(10).
  6637
  6638     12  AM-SAVED-REMIT-TO                 PIC 99.
  6639
  6640     12  AM-COMM-STRUCTURE-SAVED.
  6641         16  AM-DEFN-1-SAVED.
  6642             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6643                 24  AM-AGT-SV             PIC X(10).
  6644                 24  AM-COM-TYP-SV         PIC X.
  6645                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6646                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6647                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6648                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6649                 24  FILLER                PIC X.
  6650                 24  AM-GL-CODES-SV        PIC X.
  6651                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6652                 24  FILLER                PIC X.
  6653         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6654             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 122
* EL050.cbl
  6655                 24  FILLER                PIC X(11).
  6656                 24  AM-L-COMA-SV          PIC XXX.
  6657                 24  AM-J-COMA-SV          PIC XXX.
  6658                 24  AM-A-COMA-SV          PIC XXX.
  6659                 24  FILLER                PIC X(6).
  6660
  6661     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6662         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6663            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6664            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6665            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6666
  6667     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6668     12  FILLER                            PIC X(120).
  6669
  6670     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6671         16  AM-CONTROL-NAME               PIC X(30).
  6672         16  AM-EXECUTIVE-ONE.
  6673             20  AM-EXEC1-NAME             PIC X(15).
  6674             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6675                                                          COMP-3.
  6676             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6677                                                          COMP-3.
  6678         16  AM-EXECUTIVE-TWO.
  6679             20  AM-EXEC2-NAME             PIC X(15).
  6680             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6681                                                          COMP-3.
  6682             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6683                                                          COMP-3.
  6684
  6685     12  AM-RETRO-ADDITIONAL-DATA.
  6686         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6687         16  AM-RETRO-PREM-P-E             PIC X.
  6688         16  AM-RETRO-CLMS-P-I             PIC X.
  6689         16  AM-RETRO-RET-BRACKET-LF.
  6690             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6691                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6692                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6693             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6694                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6695                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6696             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6697                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6698                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6699         16  AM-RETRO-RET-BRACKET-AH.
  6700             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6701                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6702                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6703                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6704             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6705                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6706                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6707             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6708                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6709                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6710
  6711     12  AM-COMMENTS.
  6712         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 123
* EL050.cbl
  6713
  6714     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6715         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6716         16  AM-FLI-BILLING-CODE           PIC X.
  6717         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6718         16  AM-FLI-UNITED-IDENT           PIC X.
  6719         16  AM-FLI-INTEREST-LOST-DATA.
  6720             20  AM-FLI-BANK-NO            PIC X(5).
  6721             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6722             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6723             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6724         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6725             20  AM-FLI-AGT                PIC X(9).
  6726             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6727             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6728         16  FILLER                        PIC X(102).
  6729
  6730     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6731         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6732             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6733             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6734             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6735             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6736             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6737         16  FILLER                          PIC X(10).
  6738******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 124
* EL050.cbl
  6740*    COPY ERCREIN.
  6741******************************************************************
  6742*                                                                *
  6743*                            ERCREIN                             *
  6744*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6745*                            VMOD=2.010                          *
  6746*                                                                *
  6747*   ONLINE CREDIT SYSTEM                                         *
  6748*                                                                *
  6749*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6750*                                                                *
  6751*   FILE TYPE = VSAM,KSDS                                        *
  6752*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6753*                                                                *
  6754*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6755*       ALTERNATE PATH = NONE                                    *
  6756*                                                                *
  6757*   LOG = NO                                                     *
  6758*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6759*                                                                *
  6760******************************************************************
  6761*                   C H A N G E   L O G
  6762*
  6763* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6764*-----------------------------------------------------------------
  6765*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6766* EFFECTIVE    NUMBER
  6767*-----------------------------------------------------------------
  6768* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6769* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6770******************************************************************
  6771 01  REINSURANCE-RECORD.
  6772     12  RE-RECORD-ID                      PIC XX.
  6773         88  VALID-RE-ID                      VALUE 'RE'.
  6774
  6775     12  RE-CONTROL-PRIMARY.
  6776         16  RE-COMPANY-CD                 PIC X.
  6777         16  RE-KEY.
  6778             20  RE-CODE                   PIC X.
  6779                 88  RE-TABLE-RECORD          VALUE 'A'.
  6780                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6781             20  RE-TABLE                  PIC XXX.
  6782             20  FILLER                    PIC XXX.
  6783         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6784             20  FILLER                    PIC X.
  6785             20  RE-COMPANY.
  6786                 24  RE-COMP-PRIME         PIC XXX.
  6787                 24  RE-COMP-SUB           PIC XXX.
  6788
  6789     12  RE-MAINT-INFORMATION.
  6790         16  RE-LAST-MAINT-DT              PIC XX.
  6791         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6792         16  RE-LAST-MAINT-USER            PIC X(4).
  6793         16  FILLER                        PIC X(10).
  6794
  6795     12  RE-TABLE-DATA.
  6796         16  RE-100-COMP                   PIC 99.
  6797
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 125
* EL050.cbl
  6798         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6799             20  RE-REI-COMP-NO.
  6800                 24  RE-REI-COMP           PIC XXX.
  6801                 24  RE-REI-COMP-SUB       PIC XXX.
  6802             20  RE-LF-QC                  PIC X.
  6803             20  RE-AH-QC                  PIC X.
  6804             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6805             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6806             20  RE-LFAGE-LO               PIC 99.
  6807             20  RE-LFAGE-HI               PIC 99.
  6808             20  RE-AHAGE-LO               PIC 99.
  6809             20  RE-AHAGE-HI               PIC 99.
  6810             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6811             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6812             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6813             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6814             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6815             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6816             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6817             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6818             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6819             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6820             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6821             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6822             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6823             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6824             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6825             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6826             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6827             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6828             20  RE-LF-BEN-CODE            PIC X.
  6829             20  RE-AH-BEN-CODE            PIC X.
  6830             20  RE-INTERACTIVE            PIC X.
  6831             20  RE-REMAINING              PIC X.
  6832             20  RE-LF-RUNOFF-SW           PIC X.
  6833             20  RE-AH-RUNOFF-SW           PIC X.
  6834             20  FILLER                    PIC X(19).
  6835
  6836         16  RE-COMP-INFO-END              PIC X(6).
  6837         16  RE-NSP-ST-CD-LF               PIC XX.
  6838         16  RE-NSP-ST-CD-AH               PIC XX.
  6839         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6840             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6841
  6842         16  FILLER                        PIC X(27).
  6843
  6844     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6845         16  RE-NAME                       PIC X(30).
  6846         16  RE-LF-PE                      PIC X.
  6847         16  RE-AH-PE                      PIC X.
  6848         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6849         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6850         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6851         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6852         16  RE-PRT-ST                     PIC X.
  6853         16  RE-PRT-OW                     PIC X.
  6854         16  RE-MORT-CODE                  PIC X(4).
  6855         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 126
* EL050.cbl
  6856         16  RE-ZERO-LF-FEE                PIC X.
  6857         16  RE-ZERO-AH-FEE                PIC X.
  6858         16  RE-CEDE-NAME                  PIC X(30).
  6859         16  RE-LF-COMM                    PIC X.
  6860         16  RE-AH-COMM                    PIC X.
  6861         16  RE-LF-TAX                     PIC X.
  6862         16  RE-AH-TAX                     PIC X.
  6863         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6864         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6865         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6866
  6867         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6868             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6869
  6870         16  RE-LF-CEDING-FEE-BRACKETS.
  6871             20  RE-LF-FEE-METHOD          PIC X.
  6872                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6873                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6874                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6875                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6876             20  RE-LF-FEE-BASIS           PIC X.
  6877                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6878                 88  RE-LF-NET-CEDED               VALUE '2'.
  6879                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6880                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6881                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6882                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6883                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6884                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6885             20  FILLER                    PIC XXX.
  6886             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6887                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6888                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6889
  6890         16  RE-AH-CEDING-FEE-BRACKETS.
  6891             20  RE-AH-FEE-METHOD          PIC X.
  6892                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6893                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6894                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6895                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6896             20  RE-AH-FEE-BASIS           PIC X.
  6897                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6898                 88  RE-AH-NET-CEDED               VALUE '2'.
  6899                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6900                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6901                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6902                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6903                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6904                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6905             20  FILLER                    PIC XXX.
  6906             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6907                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6908                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6909
  6910         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6911
  6912         16  RE-OLD-CEDING-STMT            PIC X.
  6913
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 127
* EL050.cbl
  6914         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6915         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6916         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6917         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6918         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6919         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6920         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6921         16  RE-MORT-SW                    PIC X.
  6922         16  RE-CEDING-TYPE-FLAG           PIC X.
  6923             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6924             88  RE-CEDED                          VALUE 'C'.
  6925             88  RE-ASSUMED                        VALUE 'A'.
  6926             88  RE-PHANTOM                        VALUE 'P'.
  6927
  6928         16  RE-CEDING-STMT-OPT-A          PIC X.
  6929             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6930         16  RE-CEDING-STMT-OPT-B          PIC X.
  6931             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6932         16  RE-CEDING-STMT-OPT-C          PIC X.
  6933             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6934         16  RE-CEDING-STMT-OPT-D          PIC X.
  6935             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6936         16  RE-CEDING-STMT-OPT-E          PIC X.
  6937             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6938
  6939         16  RE-PRT-CRSV                   PIC X.
  6940
  6941         16  RE-GL-CENTER                  PIC X(4).
  6942
  6943         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6944
  6945         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6946
  6947         16  RE-EARN-STOP-CODE             PIC X.
  6948             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6949             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6950
  6951         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6952             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6953
  6954         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6955         16  FILLER                        PIC X(2281).
  6956
  6957         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6958
  6959******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 128
* EL050.cbl
  6961*    COPY ERCCTBL.
  6962******************************************************************
  6963*                                                                *
  6964*                                                                *
  6965*                            ERCCTBL                             *
  6966*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6967*                            VMOD=2.003
  6968*                                                                *
  6969*   ONLINE CREDIT SYSTEM                                         *
  6970*                                                                *
  6971*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  6972*                                                                *
  6973*   FILE TYPE = VSAM,KSDS                                        *
  6974*   RECORD SIZE = 200   RECFORM = FIXED                          *
  6975*                                                                *
  6976*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  6977*       ALTERNATE PATH = NONE                                    *
  6978*                                                                *
  6979*   LOG = NO                                                     *
  6980*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6981*                                                                *
  6982*                                                                *
  6983******************************************************************
  6984
  6985 01  COMM-TABLE-RECORD.
  6986     12  CT-RECORD-ID                      PIC XX.
  6987         88  VALID-CT-ID                      VALUE 'CT'.
  6988
  6989     12  CT-CONTROL-PRIMARY.
  6990         16  CT-COMPANY-CD                 PIC X.
  6991         16  CT-TABLE                      PIC XXX.
  6992         16  CT-CNTRL-2.
  6993             20  CT-BEN-TYPE               PIC X.
  6994             20  CT-BEN-CODE               PIC XX.
  6995
  6996     12  CT-MAINT-INFORMATION.
  6997         16  CT-LAST-MAINT-DT              PIC XX.
  6998         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6999         16  CT-LAST-MAINT-USER            PIC X(4).
  7000         16  FILLER                        PIC X(31).
  7001
  7002     12  CT-LIMITS.
  7003         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7004
  7005         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7006
  7007         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7008
  7009     12  CT-RATES.
  7010         16  CT-RTX          OCCURS 27 TIMES.
  7011             20  CT-RT                     PIC SV9(5)     COMP-3.
  7012             20  CT-RT-R   REDEFINES
  7013                 CT-RT                     PIC XXX.
  7014
  7015     12  FILLER                            PIC  X(42).
  7016
  7017******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 129
* EL050.cbl
  7019*    COPY ERCFORM.
  7020******************************************************************
  7021*                                                                *
  7022*                                                                *
  7023*                            ERCFORM.                            *
  7024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7025*                            VMOD=2.003                          *
  7026*                                                                *
  7027*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7028*                                                                *
  7029*    FILE TYPE = VSAM,KSDS                                       *
  7030*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7031*                                                                *
  7032*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7033*                                                                *
  7034*    LOG = YES                                                   *
  7035*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7036******************************************************************
  7037 01  FORM-MASTER.
  7038    12  FO-RECORD-ID                 PIC X(02).
  7039        88  VALID-FO-ID                  VALUE 'FO'.
  7040
  7041    12  FO-CONTROL-PRIMARY.
  7042        16  FO-COMPANY-CD            PIC X(01).
  7043        16  FO-STATE                 PIC X(02).
  7044        16  FO-FORM-ID               PIC X(12).
  7045        16  FO-FORM-EXP-DT           PIC X(02).
  7046
  7047    12  FO-POLICY-FORM-DATA.
  7048        16  FO-IND-GRP-CD            PIC X(01).
  7049        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7050        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7051        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7052        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7053        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7054        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7055        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7056        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7057        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7058        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7059        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7060        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7061        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7062        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7063        16  FO-APP-CERT-USE-CD       PIC X(01).
  7064
  7065    12  FILLER                       PIC X(29).
  7066
  7067    12  FO-FORM-PLAN-TABLE.
  7068        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7069            20  FO-PLAN-TYPE         PIC X(01).
  7070            20  FO-PLAN-ID           PIC X(02).
  7071            20  FO-PLAN-TERM         PIC 9(03).
  7072            20  FO-PLAN-REFUND-METHOD
  7073                                     PIC X.
  7074
  7075    12  FILLER                       PIC X(30).
  7076
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 130
* EL050.cbl
  7077    12  FO-COMMENTS-AREA.
  7078        16  FO-COMMENT-LINE-1        PIC X(78).
  7079
  7080    12  FILLER                       PIC X(20).
  7081
  7082    12  FO-MAINT-INFORMATION.
  7083        16  FO-LAST-MAINT-DT         PIC X(02).
  7084        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7085        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 131
* EL050.cbl
  7087*    COPY ELCMSTR.
  7088******************************************************************
  7089*                                                                *
  7090*                            ELCMSTR.                            *
  7091*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7092*                            VMOD=2.012                          *
  7093*                                                                *
  7094*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7095*                                                                *
  7096*   FILE TYPE = VSAM,KSDS                                        *
  7097*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7098*                                                                *
  7099*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7100*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7101*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7102*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7103*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7104*                                                 RKP=75,LEN=21  *
  7105*                                                                *
  7106*   **** NOTE ****                                               *
  7107*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7108*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7109*                                                                *
  7110*   LOG = YES                                                    *
  7111*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7112******************************************************************
  7113*                   C H A N G E   L O G
  7114*
  7115* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7116*-----------------------------------------------------------------
  7117*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7118* EFFECTIVE    NUMBER
  7119*-----------------------------------------------------------------
  7120* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7121* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7122******************************************************************
  7123 01  CLAIM-MASTER.
  7124     12  CL-RECORD-ID                PIC XX.
  7125         88  VALID-CL-ID         VALUE 'CL'.
  7126
  7127     12  CL-CONTROL-PRIMARY.
  7128         16  CL-COMPANY-CD           PIC X.
  7129         16  CL-CARRIER              PIC X.
  7130         16  CL-CLAIM-NO             PIC X(7).
  7131         16  CL-CERT-NO.
  7132             20  CL-CERT-PRIME       PIC X(10).
  7133             20  CL-CERT-SFX         PIC X.
  7134
  7135     12  CL-CONTROL-BY-NAME.
  7136         16  CL-COMPANY-CD-A1        PIC X.
  7137         16  CL-INSURED-LAST-NAME    PIC X(15).
  7138         16  CL-INSURED-NAME.
  7139             20  CL-INSURED-1ST-NAME PIC X(12).
  7140             20  CL-INSURED-MID-INIT PIC X.
  7141
  7142     12  CL-CONTROL-BY-SSN.
  7143         16  CL-COMPANY-CD-A2        PIC X.
  7144         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 132
* EL050.cbl
  7145             20  CL-SSN-STATE        PIC XX.
  7146             20  CL-SSN-ACCOUNT      PIC X(6).
  7147             20  CL-SSN-LN3          PIC X(3).
  7148
  7149     12  CL-CONTROL-BY-CERT-NO.
  7150         16  CL-COMPANY-CD-A4        PIC X.
  7151         16  CL-CERT-NO-A4.
  7152             20  CL-CERT-A4-PRIME    PIC X(10).
  7153             20  CL-CERT-A4-SFX      PIC X.
  7154
  7155     12  CL-CONTROL-BY-CCN.
  7156         16  CL-COMPANY-CD-A5        PIC X.
  7157         16  CL-CCN-A5.
  7158             20  CL-CCN.
  7159                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7160                 24  CL-CCN-PRIME-A5 PIC X(12).
  7161             20  CL-CCN-FILLER-A5    PIC X(4).
  7162
  7163     12  CL-INSURED-PROFILE-DATA.
  7164         16  CL-INSURED-BIRTH-DT     PIC XX.
  7165         16  CL-INSURED-SEX-CD       PIC X.
  7166             88  INSURED-IS-MALE        VALUE 'M'.
  7167             88  INSURED-IS-FEMALE      VALUE 'F'.
  7168             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7169         16  CL-INSURED-OCC-CD       PIC X(6).
  7170         16  FILLER                  PIC X(5).
  7171
  7172     12  CL-PROCESSING-INFO.
  7173         16  CL-PROCESSOR-ID         PIC X(4).
  7174         16  CL-CLAIM-STATUS         PIC X.
  7175             88  CLAIM-IS-OPEN          VALUE 'O'.
  7176             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7177         16  CL-CLAIM-TYPE           PIC X.
  7178*            88  AH-CLAIM               VALUE 'A'.
  7179*            88  LIFE-CLAIM             VALUE 'L'.
  7180*            88  PROPERTY-CLAIM         VALUE 'P'.
  7181*            88  IUI-CLAIM              VALUE 'I'.
  7182*            88  GAP-CLAIM              VALUE 'G'.
  7183         16  CL-CLAIM-PREM-TYPE      PIC X.
  7184             88  SINGLE-PREMIUM         VALUE '1'.
  7185             88  O-B-COVERAGE           VALUE '2'.
  7186             88  OPEN-END-COVERAGE      VALUE '3'.
  7187         16  CL-INCURRED-DT          PIC XX.
  7188         16  CL-REPORTED-DT          PIC XX.
  7189         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7190         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7191         16  CL-LAST-PMT-DT          PIC XX.
  7192         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7193         16  CL-PAID-THRU-DT         PIC XX.
  7194         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7195         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7196         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7197         16  CL-PMT-CALC-METHOD      PIC X.
  7198             88  CL-360-DAY-YR          VALUE '1'.
  7199             88  CL-365-DAY-YR          VALUE '2'.
  7200             88  CL-FULL-MONTHS         VALUE '3'.
  7201         16  CL-CAUSE-CD             PIC X(6).
  7202
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 133
* EL050.cbl
  7203         16  CL-PRIME-CERT-NO.
  7204             20  CL-PRIME-CERT-PRIME PIC X(10).
  7205             20  CL-PRIME-CERT-SFX   PIC X.
  7206
  7207         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7208             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7209             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7210
  7211         16  CL-MICROFILM-NO         PIC X(10).
  7212         16  CL-PROG-FORM-TYPE       PIC X.
  7213         16  CL-LAST-ADD-ON-DT       PIC XX.
  7214
  7215         16  CL-LAST-REOPEN-DT       PIC XX.
  7216         16  CL-LAST-CLOSE-DT        PIC XX.
  7217         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7218             88  FINAL-PAID             VALUE '1'.
  7219             88  CLAIM-DENIED           VALUE '2'.
  7220             88  AUTO-CLOSE             VALUE '3'.
  7221             88  MANUAL-CLOSE           VALUE '4'.
  7222             88  BENEFITS-CHANGED       VALUE 'C'.
  7223             88  SETUP-ERRORS           VALUE 'E'.
  7224         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7225         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7226         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7227             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7228         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7229         16  FILLER                  PIC X.
  7230
  7231     12  CL-CERTIFICATE-DATA.
  7232         16  CL-CERT-ORIGIN          PIC X.
  7233             88  CERT-WAS-ONLINE        VALUE '1'.
  7234             88  CERT-WAS-CREATED       VALUE '2'.
  7235             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7236         16  CL-CERT-KEY-DATA.
  7237             20  CL-CERT-CARRIER     PIC X.
  7238             20  CL-CERT-GROUPING    PIC X(6).
  7239             20  CL-CERT-STATE       PIC XX.
  7240             20  CL-CERT-ACCOUNT.
  7241                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7242                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7243             20  CL-CERT-EFF-DT      PIC XX.
  7244
  7245     12  CL-STATUS-CONTROLS.
  7246         16  CL-PRIORITY-CD          PIC X.
  7247             88  CONFIDENTIAL-DATA      VALUE '8'.
  7248             88  HIGHEST-PRIORITY       VALUE '9'.
  7249         16  CL-SUPV-ATTN-CD         PIC X.
  7250             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7251             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7252         16  CL-PURGED-DT            PIC XX.
  7253         16  CL-RESTORED-DT          PIC XX.
  7254         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7255         16  CL-NEXT-RESEND-DT       PIC XX.
  7256         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7257         16  FILLER                  PIC XX.
  7258         16  CL-LAST-MAINT-DT        PIC XX.
  7259         16  CL-LAST-MAINT-USER      PIC X(4).
  7260         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 134
* EL050.cbl
  7261         16  CL-LAST-MAINT-TYPE      PIC X.
  7262             88  CLAIM-SET-UP           VALUE ' '.
  7263             88  PAYMENT-MADE           VALUE '1'.
  7264             88  LETTER-SENT            VALUE '2'.
  7265             88  MASTER-WAS-ALTERED     VALUE '3'.
  7266             88  MASTER-WAS-RESTORED    VALUE '4'.
  7267             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7268             88  FILE-CONVERTED         VALUE '6'.
  7269             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7270             88  ERROR-CORRECTION       VALUE 'E'.
  7271         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7272         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7273         16  CL-BENEFICIARY          PIC X(10).
  7274         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7275         16  CL-DENIAL-TYPE          PIC X.
  7276             88  CL-TYPE-DENIAL          VALUE '1'.
  7277             88  CL-TYPE-RESCISSION      VALUE '2'.
  7278             88  CL-TYPE-REFORMATION     VALUE '3'.
  7279             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7280             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7281         16  FILLER                  PIC X(5).
  7282
  7283     12  CL-TRAILER-CONTROLS.
  7284         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7285             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7286             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7287             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7288         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7289         16  FILLER                  PIC XX.
  7290         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7291         16  CL-ADDRESS-TRAILER-CNT.
  7292             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7293                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7294             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7295                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7296             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7297                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7298             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7299                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7300             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7301                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7302             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7303                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7304             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7305                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7306
  7307     12  CL-CV-REFERENCE-NO.
  7308         16  CL-CV-REFNO-PRIME       PIC X(18).
  7309         16  CL-CV-REFNO-SFX         PIC XX.
  7310
  7311     12  CL-FILE-LOCATION            PIC X(4).
  7312
  7313     12  CL-PROCESS-ERRORS.
  7314         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7315             88  NO-FATAL-ERRORS        VALUE ZERO.
  7316         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7317             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7318
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 135
* EL050.cbl
  7319     12  CL-PRODUCT-CD               PIC X.
  7320
  7321     12  CL-CURRENT-KEY-DATA.
  7322         16  CL-CURRENT-CARRIER      PIC X.
  7323         16  CL-CURRENT-GROUPING     PIC X(6).
  7324         16  CL-CURRENT-STATE        PIC XX.
  7325         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7326
  7327     12  CL-ASSOCIATES               PIC X.
  7328         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7329         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7330         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7331         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7332
  7333     12  CL-ACTIVITY-CODE            PIC 99.
  7334     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7335     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7336
  7337     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7338     12  CL-LAG-REPORT-CODE          PIC 9.
  7339     12  CL-LOAN-TYPE                PIC XX.
  7340     12  CL-LEGAL-STATE              PIC XX.
  7341
  7342*    12  FILLER                      PIC X(5).
  7343     12  CL-YESNOSW                  PIC X.
  7344     12  FILLER                      PIC X(4).
  7345
  7346 01  PLAN-RECORDS.
  7347     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7348     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7349
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 136
* EL050.cbl
  7351 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7352                          ACCOUNT-MASTER REINSURANCE-RECORD
  7353                          COMM-TABLE-RECORD FORM-MASTER
  7354                          CLAIM-MASTER PLAN-RECORDS.
  7355 0000-DFHEXIT SECTION.
  7356     MOVE '9#                    $   ' TO DFHEIV0.
  7357     MOVE 'EL050' TO DFHEIV1.
  7358     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7359
  7360     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7361
  7362
  7363* EXEC CICS  HANDLE CONDITION
  7364*           ERROR    (9300-ABEND)
  7365*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7366*    END-EXEC.
  7367*    MOVE '"$.J                  ! " #00007358' TO DFHEIV0
  7368     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7370     MOVE X'2220233030303037333538' TO DFHEIV0(25:11)
  7371     CALL 'kxdfhei1' USING DFHEIV0
  7372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7373
  7374
  7375 0000-COPY-PROCEDURE-DIV.
  7376*                          COPY ELC50PD.
  7377******************************************************************
  7378*                                                                *
  7379*                            ELC50PD                             *
  7380*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7381*                            VMOD=2.188                          *
  7382*                                                                *
  7383******************************************************************
  7384*                   C H A N G E   L O G
  7385*
  7386* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7387*-----------------------------------------------------------------
  7388*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7389* EFFECTIVE    NUMBER
  7390*-----------------------------------------------------------------
  7391* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7392* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7393* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7394*                             2709 AND 2718
  7395* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7396* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7397* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7398* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7399* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7400*                                IS OPEN OR CNC DT < PD THRU
  7401* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7402* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7403* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7404* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7405* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7406* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7407* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7408* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 137
* EL050.cbl
  7409* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7410* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7411* 020906                   PEMA  EXPAND LOAN OFFICER
  7412* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7413* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7414* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7415* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7416* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7417* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7418* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7419* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7420* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7421* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7422* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7423* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7424* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7425* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7426* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7427* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7428* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7429* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7430* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7431* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7432* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7433* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7434* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7435* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7436* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7437*                                UPDATE VIN ON CERT TRAILER
  7438* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7439* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7440* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7441* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7442* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7443* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7444* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7445* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7446* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7447* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7448* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7449* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7450* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7451* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7452* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7453* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7454* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7455* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7456* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7457* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7458* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7459* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7460* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7461* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7462* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7463* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7464* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7465* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7466* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 138
* EL050.cbl
  7467* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7468* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7469* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7470* 032912  CR2011110200001  PEMA  AHL CHANGES
  7471* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7472* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7473* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7474******************************************************************
  7475************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7476******************************************************************
  7477
  7478     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7479
  7480     MOVE SPACES                 TO PB-FATAL-FLAG
  7481                                    PB-FORCE-ER-CD
  7482                                    PB-WARN-ER-CD
  7483                                    PB-OUT-BAL-CD.
  7484
  7485     MOVE SPACE                  TO WS-IG-OVRD-AH
  7486                                    WS-IG-OVRD-LF
  7487                                    WS-IG-OVRD-AM
  7488                                    WS-IG-OVRD
  7489                                    WS-IG-OVRD-AH-PL
  7490                                    WS-IG-OVRD-LF-PL
  7491                                    WS-IG-OVRD-AH-BEN
  7492                                    WS-IG-OVRD-LF-BEN.
  7493
  7494******************************************************************
  7495*************       INITIALIZE COMMON ERRORS       ***************
  7496******************************************************************
  7497
  7498     MOVE +0                     TO PB-NO-OF-ERRORS.
  7499     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7500
  7501******************************************************************
  7502
  7503     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7504     SET JULIAN-TO-BIN           TO TRUE.
  7505*    MOVE 5                      TO DC-OPTION-CODE.
  7506     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7507     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7508
  7509     MOVE ZERO                   TO  SUB4.
  7510
  7511 0040-INITIALIZE-GA-BILL-DT.
  7512
  7513     ADD +1                      TO  SUB4.
  7514
  7515     IF  SUB4 GREATER THAN +5
  7516         GO TO 0050-CHECK-CNTL-FOUND.
  7517
  7518     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7519         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7520
  7521     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7522
  7523 0050-CHECK-CNTL-FOUND.
  7524
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 139
* EL050.cbl
  7525     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7526        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7527                                         WS-AH-REM-TERM-CALC
  7528                                         EC-CO-REM-TERM-CALC
  7529        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7530        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7531        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7532                                         WS-TOL-AH-CLAIM
  7533        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7534                                         WS-TOL-AH-PREM
  7535                                         EC-CO-TOL-PREM
  7536        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7537                                         WS-TOL-AH-REFUND
  7538                                         EC-CO-TOL-REFUND
  7539        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7540                                         WS-AH-REFUND-OVS-AMT
  7541                                         EC-CO-OVR-SHT-AMT
  7542        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7543                                         WS-TOL-AH-PREM-PCT
  7544                                         EC-CO-TOL-PREM-PCT
  7545        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7546                                         WS-TOL-AH-REFUND-PCT
  7547                                         EC-CO-TOL-REFUND-PCT
  7548        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7549                                         WS-AH-REFUND-OVS-PCT
  7550                                         EC-CO-OVR-SHT-PCT
  7551        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7552        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7553        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7554        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7555        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7556        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7557        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7558        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7559        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7560        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7561        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7562        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7563                                         EC-CO-MONTH-END-DT
  7564        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7565          GO TO 0100-READ-ACCT.
  7566
  7567     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7568     MOVE SPACES                 TO CNTL-ACCESS.
  7569     MOVE '1'                    TO CNTL-REC-TYPE.
  7570     MOVE +0                     TO CNTL-SEQ-NO.
  7571
  7572     MOVE '1' TO RC-SW-1.
  7573     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7574     IF NOT CF-COMPANY-MASTER
  7575         MOVE ZEROS             TO WK-CO-TOL-PREM
  7576                                   WK-CO-TOL-CLAIM
  7577                                   WK-CO-TOL-REFUND
  7578                                   WK-REFUND-OVS-AMT
  7579                                   WK-REFUND-OVS-PCT
  7580                                   WK-CO-TOL-PREM-PCT
  7581                                   WK-CO-TOL-REFUND-PCT
  7582                                   WK-DEFAULT-APR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 140
* EL050.cbl
  7583                                   WK-CO-MAX-CAP
  7584        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7585                                   WK-CR-R78-METHOD
  7586                                   WK-CO-REF-REJECT-SW
  7587                                   WK-CO-PREM-REJECT-SW
  7588                                   WK-REM-TRM-CALC-OPTION
  7589                                   WK-BIRTH-DATE-INPUT
  7590                                   WK-JOINT-AGE-INPUT
  7591        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7592        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7593        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7594        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7595          GO TO 0099-COMPANY-NOT-FOUND.
  7596
  7597     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7598        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7599     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7600        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7601     IF CF-CO-TOL-CAP NOT NUMERIC
  7602        MOVE +0                    TO CF-CO-TOL-CAP.
  7603     IF CF-DEFAULT-APR NOT NUMERIC
  7604        MOVE +0                    TO CF-DEFAULT-APR.
  7605
  7606     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7607     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7608     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7609     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7610     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7611     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7612     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7613     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7614     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7615     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7616     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7617     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7618
  7619     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7620          CF-CO-OVR-SHT-AMT > +0
  7621        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7622
  7623     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7624          CF-CO-OVR-SHT-PCT > +0
  7625        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7626
  7627     IF CF-VALID-REM-TRM-OPTION
  7628         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7629     ELSE
  7630         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7631
  7632     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7633     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7634     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7635     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7636
  7637     GO TO 0050-CHECK-CNTL-FOUND.
  7638
  7639 0099-COMPANY-NOT-FOUND.
  7640
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 141
* EL050.cbl
  7641     MOVE ER-2616                TO WS-ERROR.
  7642     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7643
  7644 0100-READ-ACCT.
  7645
  7646     MOVE SPACES                 TO DATE-RANGE-SW.
  7647
  7648     IF WK-ACCT-ADDR = ZEROS
  7649        GO TO 0102-ACCT-GETMAIN.
  7650
  7651     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7652     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7653     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7654
  7655     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7656        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7657        GO TO 0105-READ-ACCT
  7658     END-IF
  7659
  7660     IF PB-CARRIER NOT = SPACES
  7661        IF PB-CARRIER NOT = AM-VG-CARRIER
  7662           GO TO 0105-READ-ACCT.
  7663
  7664     IF PB-STATE NOT = SPACES
  7665        IF PB-STATE NOT = AM-VG-STATE
  7666           GO TO 0105-READ-ACCT.
  7667
  7668     IF PB-GROUPING NOT = SPACES
  7669        IF PB-GROUPING NOT = AM-VG-GROUPING
  7670           GO TO 0105-READ-ACCT.
  7671
  7672     MOVE 'X'                 TO DATE-RANGE-SW.
  7673
  7674     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7675        MOVE 'X'                 TO DATE-RANGE-SW
  7676        GO TO 0105-READ-ACCT.
  7677
  7678     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7679        GO TO 0105-READ-ACCT.
  7680
  7681     GO TO 0180-ACCOUNT-FOUND.
  7682
  7683 0102-ACCT-GETMAIN.
  7684     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7685     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7686
  7687 0105-READ-ACCT.
  7688     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7689     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7690     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7691     MOVE PB-STATE               TO ACCT-STATE.
  7692     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7693     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7694
  7695     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7696
  7697     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7698
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 142
* EL050.cbl
  7699 0110-FIND-ACCT-TOLERANCES-LOOP.
  7700     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7701
  7702     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7703        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7704        GO TO 0199-ACCT-NOT-FOUND
  7705     END-IF
  7706     IF PB-CARRIER NOT = SPACES
  7707        IF PB-CARRIER NOT = AM-VG-CARRIER
  7708           GO TO 0199-ACCT-NOT-FOUND.
  7709
  7710     IF PB-STATE NOT = SPACES
  7711        IF PB-STATE NOT = AM-VG-STATE
  7712           GO TO 0199-ACCT-NOT-FOUND.
  7713
  7714     IF PB-GROUPING NOT = SPACES
  7715        IF PB-GROUPING NOT = AM-VG-GROUPING
  7716           GO TO 0199-ACCT-NOT-FOUND.
  7717
  7718     MOVE 'X'                    TO DATE-RANGE-SW.
  7719
  7720     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7721        MOVE 'X'                 TO DATE-RANGE-SW
  7722        GO TO 0199-ACCT-NOT-FOUND.
  7723
  7724     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7725        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7726
  7727 0180-ACCOUNT-FOUND.
  7728     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7729     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7730     MOVE AM-STATE               TO PB-SV-STATE.
  7731     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7732
  7733     IF AM-CANCEL-FEE  NOT NUMERIC
  7734        MOVE ZEROS TO AM-CANCEL-FEE.
  7735
  7736     IF AM-MAX-MON-BEN NOT NUMERIC
  7737        MOVE ZEROS TO AM-MAX-MON-BEN.
  7738
  7739     IF AM-MAX-TOT-BEN NOT NUMERIC
  7740        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7741
  7742     IF AM-CLP-TOL-PCT NOT NUMERIC
  7743        MOVE +0                  TO AM-CLP-TOL-PCT
  7744     END-IF
  7745     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7746        MOVE +0                  TO AM-SPP-LEASE-COMM
  7747     END-IF
  7748     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7749        MOVE ER-2611             TO   WS-ERROR
  7750        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7751
  7752     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7753        MOVE ER-2621             TO   WS-ERROR
  7754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7755
  7756     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 143
* EL050.cbl
  7757        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7758        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7759        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7760         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7761
  7762     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7763     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7764     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7765     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7766     IF AM-CLP-TOL-PCT NOT = ZEROS
  7767        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7768     END-IF
  7769     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7770        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7771     END-IF
  7772*    IF PB-COMPANY-ID = 'DCC'
  7773*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7774*                                   WS-ADMIN-FEES
  7775*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7776*          (SUB5 > +10)
  7777*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7778*             AND (AM-A-COM (SUB5) NUMERIC)
  7779*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7780*                + (AM-A-COM (SUB5) * 1000)
  7781*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7782*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7783*                + (AM-A-COM (SUB5) * 1000)
  7784*             END-IF
  7785*             IF AM-COM-TYP (SUB5) = 'N'
  7786*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7787*                + (AM-A-COM (SUB5) * 1000)
  7788*             END-IF
  7789*          END-IF
  7790*       END-PERFORM
  7791*    END-IF
  7792     IF (PB-COMPANY-ID = 'DCC')
  7793        AND (PB-ISSUE)
  7794        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7795        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7796           (SUB5 > +10)
  7797           MOVE +0 TO WS-WK-RATE
  7798           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7799              IF (AM-A-COM (SUB5) NUMERIC)
  7800                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7801                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7802              ELSE
  7803                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7804                 IF PB-ISSUE
  7805                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7806                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7807                 ELSE
  7808                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7809                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7810                 END-IF
  7811                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7812                 MOVE ZEROS             TO WS-SUB1
  7813                                           WS-COMMISSION
  7814                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 144
* EL050.cbl
  7815                 MOVE '0530'               TO CTBL-SW
  7816                 MOVE ' '                  TO WS-CTBL-READ-SW
  7817                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7818                 IF FIRST-TIME-THROUGH
  7819                    MOVE 'AA'              TO CTBL-BEN-CODE
  7820                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7821                 END-IF
  7822                 IF CTBL-TABLE-FOUND
  7823                    IF PB-ISSUE
  7824                       COMPUTE WS-COMM-CK-AMT =
  7825                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7826                    ELSE
  7827                       COMPUTE WS-COMM-CK-AMT =
  7828                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7829                    END-IF
  7830                    PERFORM 8800-GET-COMP-RATE
  7831                              THRU 8800-EXIT
  7832                 END-IF
  7833              END-IF
  7834              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7835                + (WS-WK-RATE * 1000)
  7836           END-IF
  7837        END-PERFORM
  7838     END-IF
  7839     IF PB-COMPANY-ID EQUAL 'CRI'
  7840         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7841
  7842     IF PB-COMPANY-ID EQUAL 'NCL'
  7843         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7844     END-IF
  7845
  7846     GO TO 0200-READ-CERT.
  7847
  7848 0199-ACCT-NOT-FOUND.
  7849
  7850     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7851
  7852     IF DATE-RANGE-SW NOT = SPACES
  7853        MOVE ER-2601             TO WS-ERROR
  7854        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7855     ELSE
  7856        MOVE ER-2619             TO WS-ERROR
  7857        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7858
  7859     GO TO 9990-RETURN.
  7860
  7861 0200-READ-CERT.
  7862
  7863     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7864     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7865     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7866     MOVE PB-SV-STATE            TO CERT-STATE.
  7867     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7868     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7869     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7870
  7871     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7872
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 145
* EL050.cbl
  7873     IF CERT-WAS-NOT-FOUND
  7874        GO TO 0299-CERT-NOT-FOUND.
  7875
  7876     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7877        MOVE ER-2759             TO WS-ERROR
  7878        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7879        GO TO 0298-UNLOCK-RETURN.
  7880
  7881     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7882         MOVE ER-2758            TO WS-ERROR
  7883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7884         GO TO 0298-UNLOCK-RETURN.
  7885
  7886     IF PB-ISSUE
  7887        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7888           IF CERT-WAS-CREATED-FOR-CLAIM
  7889              NEXT SENTENCE
  7890            ELSE
  7891              MOVE ER-2626       TO WS-ERROR
  7892              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7893              GO TO 0298-UNLOCK-RETURN.
  7894
  7895     IF NOT PB-CANCELLATION
  7896        GO TO 0300-CONTINUE-EDIT.
  7897
  7898     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  7899     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  7900     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  7901     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  7902     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  7903     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  7904
  7905     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  7906     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  7907     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  7908     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  7909     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  7910     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  7911     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  7912     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  7913     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  7914
  7915     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  7916     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  7917     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  7918     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  7919     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  7920     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  7921     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  7922
  7923     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  7924     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  7925
  7926     MOVE CM-CREDIT-INTERFACE-SW-1
  7927                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  7928     MOVE CM-CREDIT-INTERFACE-SW-2
  7929                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  7930
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 146
* EL050.cbl
  7931     IF CM-O-B-COVERAGE
  7932         MOVE 'B'                 TO PB-CI-OB-FLAG.
  7933
  7934     IF CM-LIVES NOT NUMERIC
  7935         MOVE ZERO                TO CM-LIVES.
  7936
  7937     IF CM-BILLED NOT NUMERIC
  7938         MOVE ZERO                TO CM-BILLED.
  7939
  7940     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  7941         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  7942         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  7943         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  7944         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  7945         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  7946         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  7947         MOVE CM-LIVES             TO PB-CI-LIVES
  7948*The next line causes a problem with my change  I dont think it is
  7949*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  7950
  7951     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  7952     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  7953     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  7954     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  7955     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  7956     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  7957
  7958     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  7959     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  7960     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  7961     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  7962
  7963     IF CM-LIFE-COMM-PCT NUMERIC
  7964         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  7965     ELSE
  7966         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  7967
  7968     IF CM-AH-COMM-PCT NUMERIC
  7969         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  7970     ELSE
  7971         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  7972
  7973     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  7974
  7975     IF CM-LOAN-APR       NOT NUMERIC
  7976           MOVE ZERO               TO CM-LOAN-APR.
  7977
  7978     IF CM-PAY-FREQUENCY  NOT NUMERIC
  7979           MOVE ZERO               TO CM-PAY-FREQUENCY.
  7980
  7981     IF CM-LOAN-TERM      NOT NUMERIC
  7982           MOVE ZERO               TO CM-LOAN-TERM.
  7983
  7984     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  7985           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  7986
  7987     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  7988           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 147
* EL050.cbl
  7989
  7990     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  7991     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  7992     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  7993     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  7994     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  7995     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  7996     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  7997     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  7998     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  7999     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8000     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8001     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8002
  8003     IF CM-STATE = CM-SSN-STATE
  8004         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8005
  8006     IF CM-STATE NOT = CM-MEMB-STATE
  8007         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8008
  8009     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8010
  8011     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8012        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8013        IF CM-ADDL-CLP NOT NUMERIC
  8014           MOVE +0               TO CM-ADDL-CLP
  8015        END-IF
  8016        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8017        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8018           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8019        END-IF
  8020     END-IF
  8021     IF PB-COMPANY-ID = 'DCC'
  8022        MOVE +0                  TO WS-ADMIN-FEES
  8023                                    WS-CSO-ADMIN-FEE
  8024                                    WS-COMM-AND-MFEE
  8025                                    WS-1ST-YR-ALLOW
  8026        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8027           (SUB5 > +10)
  8028           MOVE +0 TO WS-WK-RATE
  8029           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8030              IF (AM-A-COM (SUB5) NUMERIC)
  8031                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8032                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8033              ELSE
  8034                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8035                 IF PB-ISSUE
  8036                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8037                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8038                 ELSE
  8039                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8040                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8041                 END-IF
  8042                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8043                 MOVE ZEROS             TO WS-SUB1
  8044                                           WS-COMMISSION
  8045                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8046                 MOVE '0530'               TO CTBL-SW
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 148
* EL050.cbl
  8047                 MOVE ' '                  TO WS-CTBL-READ-SW
  8048                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8049                 IF FIRST-TIME-THROUGH
  8050                    MOVE 'AA'              TO CTBL-BEN-CODE
  8051                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8052                 END-IF
  8053                 IF CTBL-TABLE-FOUND
  8054                    IF PB-ISSUE
  8055                       COMPUTE WS-COMM-CK-AMT =
  8056                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8057                    ELSE
  8058                       COMPUTE WS-COMM-CK-AMT =
  8059                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8060                    END-IF
  8061                    PERFORM 8800-GET-COMP-RATE
  8062                              THRU 8800-EXIT
  8063                 END-IF
  8064              END-IF
  8065              IF AM-COM-TYP (SUB5) = 'I'
  8066                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8067                   + (WS-WK-RATE * 1000)
  8068              END-IF
  8069              IF AM-COM-TYP (SUB5) = 'N'
  8070                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8071                   + (WS-WK-RATE * 1000)
  8072              END-IF
  8073              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8074                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8075                   + (WS-WK-RATE * 1000)
  8076              END-IF
  8077              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8078                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8079                   + (WS-WK-RATE * 1000)
  8080              END-IF
  8081           END-IF
  8082        END-PERFORM
  8083     END-IF
  8084     GO TO 0300-CONTINUE-EDIT.
  8085
  8086 0298-UNLOCK-RETURN.
  8087      PERFORM 9250-UNLOCK-RETURN
  8088      GO TO 9990-RETURN.
  8089
  8090 0299-CERT-NOT-FOUND.
  8091
  8092     MOVE '1'                     TO CERT-STATUS-SW.
  8093
  8094     IF PB-COMPANY-ID = 'UCL'
  8095         IF WS-ERROR = ER-2799
  8096             GO TO 3000-CONTINUE-EDIT.
  8097
  8098     IF NOT PB-CANCELLATION
  8099         GO TO 0300-CONTINUE-EDIT.
  8100
  8101     MOVE ER-2726                  TO  WS-ERROR.
  8102     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8103     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8104     MOVE ZEROS                  TO PB-CI-INSURED-AGE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 149
* EL050.cbl
  8105                                    PB-CI-LF-TERM
  8106                                    PB-C-LF-REM-TERM
  8107                                    PB-CI-AH-TERM
  8108                                    PB-C-AH-REM-TERM
  8109                                    PB-CI-LF-BENEFIT-CD
  8110                                    PB-CI-LF-BENEFIT-AMT
  8111                                    PB-CI-LF-ALT-BENEFIT-AMT
  8112                                    PB-CI-LF-PREMIUM-AMT
  8113                                    PB-CI-LF-ALT-PREMIUM-AMT
  8114                                    PB-CI-AH-BENEFIT-CD
  8115                                    PB-CI-AH-BENEFIT-AMT
  8116                                    PB-CI-AH-PREMIUM-AMT
  8117                                    PB-CI-PAY-FREQUENCY
  8118                                    PB-CI-LOAN-APR
  8119                                    PB-CI-LOAN-TERM
  8120                                    PB-CI-LIFE-COMMISSION
  8121                                    PB-CI-AH-COMMISSION
  8122                                    PB-CI-CURR-SEQ
  8123                                    PB-CI-AH-CANCEL-AMT
  8124                                    PB-CI-LF-CANCEL-AMT
  8125                                    PB-CI-RATE-DEV-PCT-LF
  8126                                    PB-CI-RATE-DEV-PCT-AH
  8127                                    PB-CI-EXTENTION-DAYS
  8128                                    PB-CI-TERM-IN-DAYS
  8129                                    PB-CI-LIVES
  8130                                    PB-CI-LF-CRIT-PER
  8131                                    PB-CI-AH-CRIT-PER
  8132                                    PB-CI-ADDL-CLP
  8133                                    PB-CI-DDF-IU-RATE-UP.
  8134
  8135     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8136                                    PB-CI-AH-SETTLEMENT-DT
  8137                                    PB-CI-DEATH-DT
  8138                                    PB-CI-LF-PRIOR-CANCEL-DT
  8139                                    PB-CI-AH-PRIOR-CANCEL-DT
  8140                                    PB-CI-ENTRY-DT
  8141                                    PB-CI-LF-EXPIRE-DT
  8142                                    PB-CI-AH-EXPIRE-DT
  8143                                    PB-CI-LOAN-1ST-PMT-DT.
  8144
  8145     IF ACCOUNT-MAST-FOUND
  8146        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8147        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8148
  8149     GO TO 3000-CONTINUE-EDIT.
  8150
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 150
* EL050.cbl
  8152
  8153 0300-CONTINUE-EDIT.
  8154
  8155     IF PB-ISSUE
  8156        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8157            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8158
  8159     IF PB-ISSUE
  8160        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8161            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8162
  8163     IF PB-ISSUE
  8164       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8165          (AM-NO-AH-ONLY)
  8166           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8167               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8168                   MOVE ER-2679 TO WS-ERROR
  8169                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8170
  8171     IF PB-ISSUE
  8172        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8173        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8174        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8175     ELSE
  8176        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8177        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8178        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8179
  8180     MOVE 'N'                    TO PLAN-MASTER-SW
  8181                                    PLAN-MASTER-LIFE-SW
  8182                                    FORM-MASTER-SW
  8183                                    WS-APP-CERT-SW.
  8184
  8185     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8186                                    WS-PL-TOL-LF-REFUND
  8187                                    WS-PL-REF-OVS-AMT
  8188                                    WS-PL-TOL-LF-PREM-PCT
  8189                                    WS-PL-TOL-LF-REFUND-PCT
  8190                                    WS-PL-REF-OVS-PCT
  8191                                    WS-PL-TOL-LF-CLAIM.
  8192
  8193     IF PB-COMPANY-ID = 'NCL'
  8194       IF PB-ISSUE
  8195         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8196             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8197             IF FORM-MASTER-FOUND
  8198                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8199
  8200     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8201        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8202
  8203********************** MON CODE **********************
  8204     IF PB-COMPANY-ID = 'MON'
  8205     IF PB-ISSUE
  8206     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8207        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8208             PB-I-LOAN-APR = ZERO)
  8209               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 151
* EL050.cbl
  8210******************************************************
  8211
  8212     IF PB-COMPANY-ID = 'NCL'
  8213       IF PB-ISSUE
  8214           IF FORM-MASTER-FOUND
  8215             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8216                AM-DISMBR-COVERAGE
  8217                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8218                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8219                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8220                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8221                                           PB-I-LIFE-BENEFIT-CD.
  8222
  8223     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8224
  8225     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8226         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8227         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8228         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8229         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8230         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8231           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8232             GO TO 0301-LIFE-BENEFIT-SEARCH
  8233         ELSE
  8234             NEXT SENTENCE
  8235     ELSE
  8236         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8237
  8238     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8239     MOVE '4'                    TO CNTL-REC-TYPE.
  8240     MOVE +0                     TO CNTL-SEQ-NO.
  8241     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8242
  8243     MOVE '1' TO RC-SW-2.
  8244     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8245
  8246     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8247        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8248         GO TO 0305-BENEFIT-NOT-FOUND.
  8249
  8250     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8251
  8252 0301-LIFE-BENEFIT-SEARCH.
  8253
  8254     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8255
  8256     IF NO-BENEFIT-FOUND
  8257        GO TO 0305-BENEFIT-NOT-FOUND.
  8258
  8259     IF WS-BEN-CD = '99'
  8260        GO TO 0305-BENEFIT-NOT-FOUND.
  8261
  8262     IF PB-COMPANY-ID = 'NCL'
  8263         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8264             GO TO 0304-LIFE-BENEFIT-FOUND.
  8265
  8266     MOVE +1                     TO SUB5.
  8267     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 152
* EL050.cbl
  8268
  8269* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8270* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8271     IF PB-COMPANY-ID = 'DMD'
  8272         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8273
  8274 0302-EDIT-ACCT-LF-BENEFITS.
  8275
  8276     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8277        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8278           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8279                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8280           GO TO 03XX-GET-LIFE-ERPLAN.
  8281
  8282     IF SUB5 LESS THAN +20
  8283        ADD +1                   TO SUB5
  8284        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8285
  8286     MOVE +1                     TO SUB5.
  8287
  8288     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8289        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8290
  8291 0303-EDIT-DMD-EXTRA-BENEFITS.
  8292
  8293     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8294        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8295           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8296                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8297           GO TO 03XX-GET-LIFE-ERPLAN.
  8298
  8299     IF SUB5 LESS THAN +30
  8300        ADD +1                   TO SUB5
  8301        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8302
  8303     MOVE +1                     TO SUB5.
  8304
  8305 03XX-EDIT-FOR-NINETY-LF.
  8306
  8307***************************************************************
  8308*                                                             *
  8309*    NINETY BENEFIT PLAN TYPES:                               *
  8310*                                                             *
  8311*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8312*      92 = ALL GROUP REDUCING BENEFITS                       *
  8313*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8314*      94 = ALL GROUP LEVEL BENEFITS                          *
  8315*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8316*           BENEFIT CONTROLS.                                 *
  8317*      99 = ALL BENEFITS                                      *
  8318*                                                             *
  8319***************************************************************
  8320
  8321     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8322                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8323
  8324     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8325       AND
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 153
* EL050.cbl
  8326        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8327        GO TO 03XX-GET-LIFE-ERPLAN.
  8328
  8329     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8330       AND
  8331        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8332        IF CF-REDUCING (SUB3)
  8333           IF (PB-I-INDV-GRP-OVRD = 'I')
  8334              OR
  8335           ((AM-IG = '1') AND
  8336           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8337              OR
  8338           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8339           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8340           (AM-IG NOT = '2'))
  8341              GO TO 03XX-GET-LIFE-ERPLAN.
  8342
  8343     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8344       AND
  8345        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8346        IF CF-REDUCING (SUB3)
  8347           IF (PB-I-INDV-GRP-OVRD = 'G')
  8348              OR
  8349           ((AM-IG = '2') AND
  8350           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8351              OR
  8352           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8353           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8354           (AM-IG NOT = '1'))
  8355              GO TO 03XX-GET-LIFE-ERPLAN.
  8356
  8357     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8358       AND
  8359        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8360        IF CF-LEVEL    (SUB3)
  8361           IF (PB-I-INDV-GRP-OVRD = 'I')
  8362              OR
  8363           ((AM-IG = '1') AND
  8364           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8365              OR
  8366           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8367           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8368            (AM-IG NOT = '2'))
  8369              GO TO 03XX-GET-LIFE-ERPLAN.
  8370
  8371     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8372       AND
  8373        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8374        IF CF-LEVEL    (SUB3)
  8375           IF (PB-I-INDV-GRP-OVRD = 'G')
  8376              OR
  8377           ((AM-IG = '2') AND
  8378           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8379              OR
  8380           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8381           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8382           (AM-IG NOT = '1'))
  8383              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 154
* EL050.cbl
  8384
  8385     IF SUB5 LESS THAN +20
  8386        ADD +1                   TO SUB5
  8387        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8388
  8389     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8390
  8391     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8392        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8393
  8394     MOVE +1                     TO SUB5.
  8395
  8396 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8397
  8398     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8399                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8400
  8401     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8402       AND
  8403        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8404        GO TO 03XX-GET-LIFE-ERPLAN.
  8405
  8406     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8407       AND
  8408        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8409        IF CF-REDUCING (SUB3)
  8410           IF (PB-I-INDV-GRP-OVRD = 'I')
  8411              OR
  8412           ((AM-IG = '1') AND
  8413           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8414              OR
  8415           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8416           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8417           (AM-IG NOT = '2'))
  8418              GO TO 03XX-GET-LIFE-ERPLAN.
  8419
  8420     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8421       AND
  8422        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8423        IF CF-REDUCING (SUB3)
  8424           IF (PB-I-INDV-GRP-OVRD = 'G')
  8425              OR
  8426           ((AM-IG = '2') AND
  8427           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8428              OR
  8429           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8430           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8431           (AM-IG NOT = '1'))
  8432              GO TO 03XX-GET-LIFE-ERPLAN.
  8433
  8434     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8435       AND
  8436        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8437        IF CF-LEVEL    (SUB3)
  8438           IF (PB-I-INDV-GRP-OVRD = 'I')
  8439              OR
  8440           ((AM-IG = '1') AND
  8441           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 155
* EL050.cbl
  8442              OR
  8443           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8444           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8445            (AM-IG NOT = '2'))
  8446              GO TO 03XX-GET-LIFE-ERPLAN.
  8447
  8448     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8449       AND
  8450        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8451        IF CF-LEVEL    (SUB3)
  8452           IF (PB-I-INDV-GRP-OVRD = 'G')
  8453              OR
  8454           ((AM-IG = '2') AND
  8455           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8456              OR
  8457           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8458           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8459           (AM-IG NOT = '1'))
  8460              GO TO 03XX-GET-LIFE-ERPLAN.
  8461
  8462     IF SUB5 LESS THAN +30
  8463        ADD +1                   TO SUB5
  8464        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8465
  8466     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8467
  8468 03XX-EDIT-FOR-NINETY-LF-CONT.
  8469
  8470     MOVE +99                    TO SUB5.
  8471
  8472     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8473        IF PB-ISSUE
  8474           MOVE ER-1924          TO  WS-ERROR
  8475           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8476
  8477     GO TO 0304-LIFE-BENEFIT-FOUND.
  8478
  8479 03XX-GET-LIFE-ERPLAN.
  8480
  8481     IF WK-PLAN-ADDR EQUAL +0
  8482        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8483
  8484     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8485     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8486     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8487     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8488     MOVE 'Y'                    TO PLAN-MASTER-SW
  8489                                    PLAN-MASTER-LIFE-SW.
  8490     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8491
  8492 03XX-ERPLAN-LIFE-GETMAIN.
  8493
  8494     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8495     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8496
  8497 03XX-ERPLAN-LIFE-READ.
  8498
  8499     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 156
* EL050.cbl
  8500     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8501     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8502     MOVE PB-SV-STATE            TO PLAN-STATE.
  8503     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8504     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8505     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8506     MOVE WS-SAVE-BENEFIT-REVISION
  8507                                 TO PLAN-REVISION-NO.
  8508
  8509     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8510     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8511
  8512     IF PB-COMPANY-ID = 'NCL'
  8513       IF NOT LF-PLAN-MASTER-FOUND
  8514         IF NOT PB-POLICY-IS-DECLINED  AND
  8515            NOT PB-POLICY-IS-VOIDED
  8516             MOVE  ER-1921         TO  WS-ERROR
  8517             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8518             GO TO 0304-LIFE-BENEFIT-FOUND.
  8519
  8520     IF NOT LF-PLAN-MASTER-FOUND
  8521        GO TO 0304-LIFE-BENEFIT-FOUND.
  8522
  8523 XXXX-CHECK-LF-PLAN-KEY.
  8524
  8525     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8526        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8527        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8528        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8529        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8530        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8531        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8532        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8533        MOVE 'N'                 TO PLAN-MASTER-SW
  8534          GO TO 03XX-ERPLAN-LIFE-READ.
  8535
  8536     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8537
  8538     IF  PB-CANCELLATION
  8539         GO TO  0303-LF-ACCT-BEN-FOUND.
  8540
  8541     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8542        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8543           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8544           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8545              MOVE ER-2644             TO WS-ERROR
  8546              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8547           ELSE
  8548              NEXT SENTENCE
  8549        ELSE
  8550           IF PB-COMPANY-ID NOT = 'NCL'
  8551              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8552                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8553
  8554 0303-LF-ACCT-BEN-FOUND.
  8555
  8556     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8557
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 157
* EL050.cbl
  8558     IF PL-DEV-CODE NOT = SPACES
  8559        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8560
  8561     IF PL-DEV-PCT NUMERIC AND
  8562        PL-DEV-PCT NOT = ZEROS
  8563        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8564
  8565     IF PL-TOL-PREM-AMT GREATER THAN +0
  8566        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8567
  8568     IF PL-TOL-REF-AMT GREATER THAN +0
  8569        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8570
  8571     IF PL-TOL-PREM-PCT GREATER THAN +0
  8572        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8573
  8574     IF PL-TOL-REF-PCT GREATER THAN +0
  8575        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8576
  8577     IF PL-TOL-CLM-AMT GREATER THAN +0
  8578        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8579
  8580     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8581                          PL-OVER-SHORT-AMT > +0
  8582        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8583
  8584     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8585                          PL-OVER-SHORT-PCT > +0
  8586        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8587
  8588     IF PL-SALES-TAX NUMERIC AND
  8589                          PL-SALES-TAX > +0
  8590         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8591
  8592     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8593        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8594                                    WS-IG-OVRD-AM.
  8595
  8596 0304-LIFE-BENEFIT-FOUND.
  8597
  8598     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8599
  8600     IF PB-ISSUE
  8601        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8602     ELSE
  8603        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8604
  8605     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8606     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8607     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8608     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8609     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8610                                         WS-LF-REFUND-CALC.
  8611
  8612     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8613        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8614
  8615     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 158
* EL050.cbl
  8616        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8617     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8618
  8619     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8620     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8621     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8622     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8623     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8624     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8625
  8626     IF PB-COMPANY-ID = 'NCL'  AND
  8627        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8628         NEXT SENTENCE
  8629     ELSE
  8630         IF SUB5 NOT GREATER THAN +20
  8631            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8632               MOVE WS-SAVE-BENEFIT-REM-TERM
  8633                                      TO WS-AM-LF-BENE-REM-TERM
  8634                                         EC-BR-LF-REM-TERM-CALC.
  8635
  8636     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8637     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8638
  8639     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8640
  8641 0305-BENEFIT-NOT-FOUND.
  8642
  8643     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8644     MOVE ER-2604                TO WS-ERROR.
  8645     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8646
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 159
* EL050.cbl
  8648
  8649 0310-FIND-AH-BENEFIT-RECORD.
  8650
  8651     MOVE 'N'                    TO PLAN-MASTER-SW
  8652                                    PLAN-MASTER-AH-SW.
  8653
  8654     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8655                                    WS-PL-TOL-AH-REFUND
  8656                                    WS-AH-PL-REF-OVS-AMT
  8657                                    WS-PL-TOL-AH-PREM-PCT
  8658                                    WS-PL-TOL-AH-REFUND-PCT
  8659                                    WS-AH-PL-REF-OVS-PCT
  8660                                    WS-PL-TOL-AH-CLAIM.
  8661     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8662
  8663
  8664     if pb-issue
  8665        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8666           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8667        end-if
  8668        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8669           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8670           GO TO 0399-BENEFIT-NOT-FOUND
  8671        end-if
  8672     end-if
  8673
  8674     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8675        GO TO 0400-FIND-CARRIER.
  8676
  8677     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8678
  8679     IF WK-AH-BEN-ADDR NOT = ZEROS
  8680         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8681         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8682         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8683         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8684           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8685             GO TO 0311-AH-BENEFIT-SEARCH
  8686         ELSE
  8687             NEXT SENTENCE
  8688     ELSE
  8689         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8690
  8691     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8692     MOVE '5'                    TO CNTL-REC-TYPE.
  8693     MOVE +0                     TO CNTL-SEQ-NO.
  8694     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8695
  8696     MOVE '2' TO RC-SW-2.
  8697     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8698
  8699     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8700        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8701          GO TO 0399-BENEFIT-NOT-FOUND.
  8702
  8703     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8704
  8705 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 160
* EL050.cbl
  8706
  8707     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8708
  8709     IF NO-BENEFIT-FOUND
  8710         GO TO 0399-BENEFIT-NOT-FOUND.
  8711
  8712     IF WS-BEN-CD = '99'
  8713        GO TO 0399-BENEFIT-NOT-FOUND.
  8714
  8715     IF PB-COMPANY-ID  =  'NCL'
  8716         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8717             GO TO 0314-A-H-BENEFIT-FOUND.
  8718
  8719     MOVE +1                     TO SUB5.
  8720     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8721
  8722* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8723* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8724     IF PB-COMPANY-ID = 'DMD'
  8725         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8726
  8727 0312-EDIT-ACCT-AH-BENEFITS.
  8728
  8729     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8730        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8731           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8732                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8733           GO TO 03XX-GET-AH-ERPLAN.
  8734
  8735     IF SUB5 LESS THAN +20
  8736        ADD +1                   TO SUB5
  8737        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8738
  8739     MOVE +1                     TO SUB5.
  8740
  8741     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8742        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8743
  8744 0313-EDIT-DMD-EXTRA-BENEFITS.
  8745
  8746     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8747        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8748           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8749                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8750           GO TO 03XX-GET-AH-ERPLAN.
  8751
  8752     IF SUB5 LESS THAN +30
  8753        ADD +1                   TO SUB5
  8754        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8755
  8756     MOVE +1                     TO SUB5.
  8757
  8758 03XX-EDIT-FOR-NINETY-AH.
  8759
  8760***************************************************************
  8761*                                                             *
  8762*    NINETY BENEFIT PLAN TYPES:                               *
  8763*                                                             *
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 161
* EL050.cbl
  8764*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8765*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8766*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8767*           BENEFIT CONTROLS.                                 *
  8768*      99 = ALL BENEFITS.                                     *
  8769*                                                             *
  8770***************************************************************
  8771
  8772     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8773                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8774
  8775     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8776       AND
  8777        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8778        GO TO 03XX-GET-AH-ERPLAN.
  8779
  8780     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8781       AND
  8782        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8783           IF (PB-I-INDV-GRP-OVRD = 'I')
  8784              OR
  8785           ((AM-IG = '1') AND
  8786           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8787              OR
  8788           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8789           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8790           (AM-IG NOT = '2'))
  8791              GO TO 03XX-GET-AH-ERPLAN.
  8792
  8793     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8794       AND
  8795        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8796           IF (PB-I-INDV-GRP-OVRD = 'G')
  8797              OR
  8798           ((AM-IG = '2') AND
  8799           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8800              OR
  8801           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8802           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8803           (AM-IG NOT = '1'))
  8804              GO TO 03XX-GET-AH-ERPLAN.
  8805
  8806     IF SUB5 LESS THAN +20
  8807        ADD +1                   TO SUB5
  8808        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8809
  8810     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8811        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8812
  8813     MOVE +1                    TO SUB5.
  8814
  8815 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8816
  8817     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8818                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8819
  8820     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8821       AND
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 162
* EL050.cbl
  8822        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8823        GO TO 03XX-GET-AH-ERPLAN.
  8824
  8825     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8826       AND
  8827        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8828           IF (PB-I-INDV-GRP-OVRD = 'I')
  8829              OR
  8830           ((AM-IG = '1') AND
  8831           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8832              OR
  8833           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8834           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8835           (AM-IG NOT = '2'))
  8836              GO TO 03XX-GET-AH-ERPLAN.
  8837
  8838     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8839       AND
  8840        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8841           IF (PB-I-INDV-GRP-OVRD = 'G')
  8842              OR
  8843           ((AM-IG = '2') AND
  8844           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8845              OR
  8846           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8847           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8848           (AM-IG NOT = '1'))
  8849              GO TO 03XX-GET-AH-ERPLAN.
  8850
  8851     IF SUB5 LESS THAN +30
  8852        ADD +1                   TO SUB5
  8853        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8854
  8855 03XX-EDIT-FOR-NINETY-AH-CONT.
  8856
  8857     MOVE +99                    TO SUB5.
  8858
  8859     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8860
  8861     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8862        IF PB-ISSUE
  8863           MOVE ER-1925          TO  WS-ERROR
  8864           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8865
  8866     GO TO 0314-A-H-BENEFIT-FOUND.
  8867
  8868 03XX-GET-AH-ERPLAN.
  8869
  8870     IF WK-PLAN-ADDR EQUAL +0
  8871         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8872
  8873     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8874     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8875     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8876     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8877     MOVE 'Y'                    TO PLAN-MASTER-SW
  8878                                    PLAN-MASTER-AH-SW.
  8879*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 163
* EL050.cbl
  8880     GO TO 03XX-ERPLAN-AH-READ.
  8881
  8882 03XX-ERPLAN-AH-GETMAIN.
  8883
  8884     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8885     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8886
  8887 03XX-ERPLAN-AH-READ.
  8888
  8889     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8890     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8891     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8892     MOVE PB-SV-STATE            TO PLAN-STATE.
  8893     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8894     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  8895     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8896     MOVE WS-SAVE-BENEFIT-REVISION
  8897                                 TO PLAN-REVISION-NO.
  8898
  8899     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8900     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  8901
  8902     IF PB-COMPANY-ID = 'NCL'
  8903       IF NOT AH-PLAN-MASTER-FOUND
  8904         IF NOT PB-POLICY-IS-DECLINED  AND
  8905            NOT PB-POLICY-IS-VOIDED
  8906             MOVE  ER-1922         TO  WS-ERROR
  8907             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8908             GO TO 0314-A-H-BENEFIT-FOUND.
  8909
  8910     IF NOT AH-PLAN-MASTER-FOUND
  8911        GO TO 0314-A-H-BENEFIT-FOUND.
  8912
  8913 XXXX-CHECK-AH-PLAN-KEY.
  8914
  8915     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8916        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8917        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8918        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8919        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8920        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8921        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8922        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8923        MOVE 'N'                 TO PLAN-MASTER-SW
  8924          GO TO 03XX-ERPLAN-AH-READ.
  8925
  8926     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  8927
  8928     IF  PB-CANCELLATION
  8929         GO TO  0313-AH-ACCT-BEN-FOUND.
  8930
  8931     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8932       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8933          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8934          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8935             MOVE ER-2644             TO WS-ERROR
  8936             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8937          ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 164
* EL050.cbl
  8938             NEXT SENTENCE
  8939       ELSE
  8940          IF PB-COMPANY-ID NOT = 'NCL'
  8941             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8942                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8943
  8944 0313-AH-ACCT-BEN-FOUND.
  8945
  8946     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  8947
  8948     IF PL-DEV-CODE NOT = SPACES
  8949        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  8950
  8951     IF PL-DEV-PCT NUMERIC AND
  8952        PL-DEV-PCT NOT = ZEROS
  8953        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  8954
  8955     IF PL-TOL-PREM-AMT NOT EQUAL +0
  8956        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  8957
  8958     IF PL-TOL-REF-AMT NOT EQUAL +0
  8959        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  8960
  8961     IF PL-TOL-PREM-PCT GREATER THAN +0
  8962        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  8963
  8964     IF PL-TOL-REF-PCT GREATER THAN +0
  8965        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  8966
  8967     IF PL-TOL-CLM-AMT NOT EQUAL +0
  8968        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  8969
  8970     IF PL-OVER-SHORT-AMT NUMERIC AND
  8971                          PL-OVER-SHORT-AMT > +0
  8972        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  8973
  8974     IF PL-OVER-SHORT-PCT NUMERIC AND
  8975                          PL-OVER-SHORT-PCT > +0
  8976        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  8977
  8978     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8979        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  8980        IF WS-IG-OVRD-AM EQUAL SPACES
  8981            MOVE PL-IG           TO WS-IG-OVRD-AM.
  8982
  8983 0314-A-H-BENEFIT-FOUND.
  8984
  8985     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  8986
  8987     IF PB-ISSUE
  8988        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  8989       ELSE
  8990        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  8991
  8992     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  8993     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  8994     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  8995     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 165
* EL050.cbl
  8996                                         WS-AH-REFUND-CALC.
  8997
  8998     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8999        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9000
  9001     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9002        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9003     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9004
  9005     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9006     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9007     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9008     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9009     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9010     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9011
  9012     IF PB-COMPANY-ID = 'NCL'  AND
  9013        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9014         NEXT SENTENCE
  9015     ELSE
  9016         IF SUB5 NOT GREATER THAN +20
  9017            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9018                MOVE WS-SAVE-BENEFIT-REM-TERM
  9019                                      TO WS-AM-AH-BENE-REM-TERM
  9020                                         EC-BR-AH-REM-TERM-CALC.
  9021
  9022     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9023     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9024
  9025     GO TO 0400-FIND-CARRIER.
  9026
  9027 0399-BENEFIT-NOT-FOUND.
  9028
  9029     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9030     MOVE ER-2605                TO WS-ERROR.
  9031     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9032
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 166
* EL050.cbl
  9034
  9035 0400-FIND-CARRIER.
  9036
  9037     MOVE PB-SV-CARRIER          TO WS-CARR.
  9038
  9039     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9040     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9041     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9042     MOVE '6'                    TO CNTL-REC-TYPE.
  9043
  9044*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9045     MOVE SPACE                  TO WS-DMD-RATING-SW
  9046                                    EC-BR-DMD-RATING-SW.
  9047
  9048     MOVE '2'                    TO RC-SW-1.
  9049     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9050
  9051     IF NOT CF-CARRIER-MASTER
  9052        GO TO 0400-CARRIER-NOT-FOUND.
  9053
  9054 0400-BUILD-CARR-TOL.
  9055
  9056     IF CF-CR-TOL-PREM NUMERIC AND
  9057        CF-CR-TOL-PREM GREATER THAN +0
  9058        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9059                                    WS-TOL-AH-PREM.
  9060
  9061     IF CF-CR-TOL-REFUND NUMERIC AND
  9062        CF-CR-TOL-REFUND GREATER THAN +0
  9063        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9064                                    WS-TOL-AH-REFUND.
  9065
  9066     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9067        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9068        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9069                                    WS-AH-REFUND-OVS-AMT.
  9070
  9071     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9072        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9073        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9074                                    WS-AH-REFUND-OVS-PCT.
  9075
  9076     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9077        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9078        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9079                                    WS-TOL-AH-PREM-PCT.
  9080
  9081     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9082        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9083        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9084                                     WS-TOL-AH-REFUND-PCT.
  9085
  9086     IF CF-COMPANY-ID EQUAL 'DMD'
  9087         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9088                                    EC-BR-DMD-RATING-SW.
  9089
  9090     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9091     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 167
* EL050.cbl
  9092        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9093     END-IF
  9094     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9095        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9096     END-IF
  9097     IF WS-TOL-CLP-PCT = ZEROS
  9098        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9099     END-IF
  9100
  9101     IF WS-SPP-LEASE-COMM = ZEROS
  9102        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9103     END-IF
  9104     GO TO 0400-FIND-ERPDEF.
  9105
  9106 0400-CARRIER-NOT-FOUND.
  9107
  9108     MOVE ER-2602                TO WS-ERROR.
  9109     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9110
  9111 0400-FIND-ERPDEF.
  9112     IF PB-COMPANY-ID = 'DCC'
  9113        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9114        CONTINUE
  9115     ELSE
  9116        GO TO 0400-FIND-ERCOMP
  9117     END-IF
  9118     MOVE ' '                    TO PDEF-MASTER-SW
  9119     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9120     MOVE PB-STATE               TO ERPDEF-STATE
  9121     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9122     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9123     IF PB-ISSUE
  9124        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9125     ELSE
  9126        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9127     END-IF
  9128     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9129     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9130     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9131     IF PDEF-MASTER-FOUND
  9132        MOVE 'N'                 TO PDEF-MASTER-SW
  9133        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9134        IF PDEF-MASTER-FOUND
  9135           IF (ERPDEF-KEY-SAVE (1:16) =
  9136                        PD-CONTROL-PRIMARY (1:16))
  9137              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9138              CONTINUE
  9139           ELSE
  9140              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9141              IF (ERPDEF-KEY-SAVE (1:16) =
  9142                        PD-CONTROL-PRIMARY (1:16))
  9143                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9144                 CONTINUE
  9145              ELSE
  9146                 MOVE 'N'        TO PDEF-MASTER-SW
  9147              END-IF
  9148           END-IF
  9149        END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 168
* EL050.cbl
  9150        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9151     END-IF
  9152     IF PDEF-MASTER-FOUND
  9153        IF PD-TRUNCATED = 'Y'
  9154           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9155        END-IF
  9156     END-IF
  9157     .
  9158 0400-FIND-ERCOMP.
  9159     IF PB-COMPANY-ID = 'DCC'
  9160        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9161           (WS-SUB1 > +10)
  9162           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9163                 OR 'A' OR 'N'
  9164              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9165              MOVE PB-CARRIER    TO COMP-CARRIER
  9166              MOVE PB-GROUPING   TO COMP-GROUPING
  9167              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9168              MOVE AM-AGT (WS-SUB1)
  9169                                 TO COMP-FIN-RESP
  9170              MOVE 'G'           TO COMP-TYPE
  9171              PERFORM 8582-READ-COMPENSATION-MASTER
  9172                                 THRU 8582-EXIT
  9173              IF COMP-MASTER-FOUND
  9174                 IF CO-GA-INACTIVE
  9175                    MOVE ER-2763 TO WS-ERROR
  9176                    PERFORM 9900-ERROR-FORMAT
  9177                                 THRU 9900-EXIT
  9178                    MOVE +11     TO WS-SUB1
  9179                 END-IF
  9180                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9181                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9182                    MOVE ER-2788 TO WS-ERROR
  9183                    PERFORM 9900-ERROR-FORMAT
  9184                                 THRU 9900-EXIT
  9185                    MOVE +11     TO WS-SUB1
  9186                 END-IF
  9187              END-IF
  9188           END-IF
  9189        END-PERFORM
  9190     END-IF
  9191     IF (PB-COMPANY-ID = 'DCC')
  9192               AND
  9193        ((WS-LF-BEN-CATEGORY = 'D')
  9194        OR (WS-AH-BEN-CATEGORY = 'D')
  9195        OR (AM-DCC-PRODUCT-CODE = 'DDF'))
  9196        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9197           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9198                                    WS-CLP-STATE
  9199        ELSE
  9200           MOVE SPACES           TO PB-I-CLP-STATE
  9201                                    WS-CLP-STATE
  9202        END-IF
  9203     END-IF
  9204
  9205     IF (PB-COMPANY-ID = 'DCC')
  9206        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9207        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 169
* EL050.cbl
  9208        CONTINUE
  9209     ELSE
  9210        GO TO 0400-FIND-STATE-RECORD
  9211     END-IF
  9212     MOVE SPACES                 TO WS-CLP-STATE
  9213     MOVE +0                     TO WS-BANK-FEE
  9214                                    WS-BANK-LFEE
  9215                                    WS-BANK-NOCHRGB
  9216
  9217     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9218     IF (PB-ISSUE)
  9219        AND (PB-I-BANK-NUMBER NOT =
  9220            SPACES AND ZEROS AND LOW-VALUES)
  9221        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9222     ELSE
  9223        IF (PB-CANCELLATION)
  9224           AND (PB-CI-BANK-NUMBER NOT =
  9225                SPACES AND ZEROS AND LOW-VALUES)
  9226           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9227        END-IF
  9228     END-IF
  9229     IF COMP-FIN-RESP NOT = LOW-VALUES
  9230        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9231        MOVE PB-CARRIER          TO COMP-CARRIER
  9232        MOVE PB-GROUPING         TO COMP-GROUPING
  9233        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9234        MOVE 'B'                 TO COMP-TYPE
  9235        PERFORM 8582-READ-COMPENSATION-MASTER
  9236                                 THRU 8582-EXIT
  9237        IF COMP-MASTER-FOUND
  9238           IF CO-MAX-BANK-FEE NOT NUMERIC
  9239              MOVE +0            TO CO-MAX-BANK-FEE
  9240           END-IF
  9241           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9242              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9243           END-IF
  9244           IF CO-GA-INACTIVE
  9245              MOVE ER-2763       TO WS-ERROR
  9246              PERFORM 9900-ERROR-FORMAT
  9247                                 THRU 9900-EXIT
  9248           END-IF
  9249           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9250              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9251              MOVE ER-2788 TO WS-ERROR
  9252              PERFORM 9900-ERROR-FORMAT
  9253                                 THRU 9900-EXIT
  9254              MOVE +11     TO WS-SUB1
  9255           END-IF
  9256           IF WS-AH-BEN-CATEGORY = 'G'
  9257              MOVE CO-MAX-BANK-FEE
  9258                                 TO WS-BANK-FEE
  9259                                    PB-I-BANK-FEE
  9260           ELSE
  9261              MOVE CO-MAX-BANK-FEE-LEASE
  9262                                 TO WS-BANK-LFEE
  9263                                    PB-I-BANK-FEE
  9264           END-IF
  9265           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 170
* EL050.cbl
  9266              AND (WS-AH-REFUND-CALC = 'G'))
  9267                        OR
  9268              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9269              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9270              CONTINUE
  9271           ELSE
  9272              MOVE ER-2789 TO WS-ERROR
  9273              PERFORM 9900-ERROR-FORMAT
  9274                                 THRU 9900-EXIT
  9275           END-IF
  9276           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9277                                    PB-I-CLP-STATE
  9278           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9279           MOVE CO-CARRIER       TO BXRF-CARRIER
  9280           MOVE CO-GROUPING      TO BXRF-GROUPING
  9281           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9282           MOVE BXRF-MAX-REC-LENGTH
  9283                                 TO BXRF-REC-LENGTH
  9284           PERFORM 8584-READ-BANK-CROSS-REF
  9285                                 THRU 8584-EXIT
  9286           IF BXRF-MASTER-FOUND
  9287              MOVE ' '           TO BANK-ACCT-SW
  9288              MOVE BK-BANK-POINTER-CNT
  9289                                 TO BK-BANK-POINTER-CNT
  9290              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9291                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9292                 OR (BANK-ACCT-FOUND)
  9293                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9294                    AND (BK-AM-EXP-DT (WS-SUB1)
  9295                                 > PB-CERT-EFF-DT)
  9296                    AND (BK-AM-EFF-DT (WS-SUB1)
  9297                                 NOT > PB-CERT-EFF-DT)
  9298                    SET BANK-ACCT-FOUND TO TRUE
  9299                 END-IF
  9300              END-PERFORM
  9301              IF NOT BANK-ACCT-FOUND
  9302                 MOVE ZEROS      TO WS-BANK-FEE
  9303                                    WS-BANK-LFEE
  9304                 MOVE ER-2869    TO WS-ERROR
  9305                 PERFORM 9900-ERROR-FORMAT
  9306                                 THRU 9900-EXIT
  9307              ELSE
  9308                 PERFORM 5000-PROCESS-REPS
  9309                                 THRU 5000-EXIT
  9310                 IF AGENT-MASTER-FOUND
  9311                    MOVE +0      TO WS-BANK-FEE
  9312                                    WS-BANK-LFEE
  9313*                   MOVE AG-SPP-FEES (1)
  9314*                                TO PB-I-BANK-FEE
  9315*                                   WS-BANK-FEE
  9316                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9317                       (WS-SUB1 > +10)
  9318                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9319                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9320                       END-IF
  9321                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9322                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9323                       END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 171
* EL050.cbl
  9324                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9325                          AG-SPP-FEES (WS-SUB1)
  9326                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9327                          AG-SPP-LFEES (WS-SUB1)
  9328                    END-PERFORM
  9329                    IF WS-AH-BEN-CATEGORY = 'G'
  9330                       MOVE WS-BANK-FEE
  9331                                 TO PB-I-BANK-FEE
  9332                    ELSE
  9333                       MOVE WS-BANK-LFEE
  9334                                 TO PB-I-BANK-FEE
  9335                    END-IF
  9336                 END-IF
  9337              END-IF
  9338           END-IF
  9339        ELSE
  9340           MOVE ER-2879          TO WS-ERROR
  9341           PERFORM 9900-ERROR-FORMAT
  9342                                 THRU 9900-EXIT
  9343        END-IF
  9344     ELSE
  9345        MOVE ER-2879             TO WS-ERROR
  9346        PERFORM 9900-ERROR-FORMAT
  9347                                 THRU 9900-EXIT
  9348     END-IF
  9349     IF WS-AH-BEN-CATEGORY = 'G'
  9350        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9351        + WS-BANK-FEE
  9352     ELSE
  9353        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9354        + WS-BANK-LFEE
  9355     END-IF
  9356     .
  9357 0400-FIND-STATE-RECORD.
  9358
  9359     IF WK-STATE-ADDR NOT = ZEROS
  9360         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9361         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9362         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9363         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9364         IF PB-SV-STATE = CF-STATE-CODE
  9365             GO TO 0405-CONTINUE-EDIT
  9366         ELSE
  9367             NEXT SENTENCE
  9368     ELSE
  9369         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9370
  9371     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9372     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9373     MOVE '3'                    TO CNTL-REC-TYPE.
  9374     MOVE +0                     TO CNTL-SEQ-NO.
  9375
  9376     MOVE '3'                    TO RC-SW-2.
  9377     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9378
  9379     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9380        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9381        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 172
* EL050.cbl
  9382        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9383                                    WS-TOL-AH-CLAIM
  9384                                    WS-MINIMUM-REFUND
  9385                                    WS-TOL-LF-PREM
  9386                                    WS-TOL-AH-PREM
  9387                                    WS-TOL-LF-REFUND
  9388                                    WS-TOL-AH-REFUND
  9389                                    EC-ST-TOL-PREM-PCT
  9390                                    WS-TOL-LF-PREM-PCT
  9391                                    WS-TOL-AH-PREM-PCT
  9392                                    EC-ST-TOL-REFUND-PCT
  9393                                    WS-TOL-LF-REFUND-PCT
  9394                                    WS-TOL-AH-REFUND-PCT
  9395                                    EC-ST-TOL-PREM
  9396                                    EC-ST-TOL-REFUND
  9397                                    EC-ST-FST-PMT-DAYS-MAX
  9398                                    WS-FREE-LOOK-PERIOD
  9399                                    WS-ST-LF-PREM-TAX
  9400                                    WS-ST-AH-PREM-TAX-I
  9401                                    WS-ST-AH-PREM-TAX-G
  9402                                    WS-BANK-FEE
  9403                                    WS-BANK-LFEE
  9404                                    WS-TOL-CLP-PCT
  9405                                    WS-SPP-LEASE-COMM
  9406        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9407                                    EC-ST-FST-PMT-DAYS-CHG
  9408                                    WS-LF-REM-TERM-CALC
  9409                                    WS-LF-REFUND-CALC
  9410                                    EC-ST-LF-REM-TERM-CALC
  9411                                    EC-ST-LF-REFUND-CALC
  9412                                    WS-AH-REM-TERM-CALC
  9413                                    WS-AH-REFUND-CALC
  9414                                    WS-LF-BEN-CATEGORY
  9415                                    WS-AH-BEN-CATEGORY
  9416                                    WS-CLP-STATE
  9417                                    WS-ST-REFUND-CLAIM-FLAG
  9418                                    EC-ST-AH-REM-TERM-CALC
  9419                                    EC-ST-AH-REFUND-CALC
  9420          GO TO 0499-STATE-NOT-FOUND.
  9421
  9422     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9423
  9424 0405-CONTINUE-EDIT.
  9425
  9426     if pb-company-id = 'AHL'
  9427        continue
  9428     else
  9429        IF PB-CERT-PRIME NOT NUMERIC
  9430           MOVE ER-2722          TO WS-ERROR
  9431           PERFORM 9900-ERROR-FORMAT
  9432                                 THRU 9900-EXIT
  9433        end-if
  9434     END-IF
  9435*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9436*       MOVE +0                  TO SUB3
  9437*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9438*       IF SUB3 > +0
  9439*          MOVE ER-2722          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 173
* EL050.cbl
  9440*          PERFORM 9900-ERROR-FORMAT
  9441*                                THRU 9900-EXIT
  9442*       END-IF
  9443*    END-IF
  9444*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9445*       IF PB-CERT-PRIME NOT NUMERIC
  9446*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9447*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9448*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9449*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9450*
  9451*          MOVE ER-2722          TO WS-ERROR
  9452*          PERFORM 9900-ERROR-FORMAT
  9453*                                THRU 9900-EXIT
  9454*       END-IF
  9455*    END-IF
  9456
  9457     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9458
  9459     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9460        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9461                                    WS-TOL-AH-CLAIM.
  9462
  9463     IF CF-ST-REFUND-MIN NOT NUMERIC
  9464        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9465
  9466     IF CF-ST-REFUND-MIN NOT = ZEROS
  9467        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9468
  9469     IF CF-ST-TOL-PREM  NOT = ZEROS
  9470        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9471                                    WS-TOL-AH-PREM
  9472        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9473
  9474     IF CF-ST-TOL-REFUND NOT = ZEROS
  9475        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9476                                    WS-TOL-AH-REFUND
  9477        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9478
  9479     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9480        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9481        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9482                                    WS-AH-REFUND-OVS-AMT
  9483                                    EC-ST-OVR-SHT-AMT.
  9484
  9485     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9486        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9487        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9488                                    WS-TOL-LF-PREM-PCT
  9489                                    WS-TOL-AH-PREM-PCT.
  9490
  9491     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9492        CF-ST-TOL-REF-PCT GREATER THAN +0
  9493        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9494                                    WS-TOL-LF-REFUND-PCT
  9495                                    WS-TOL-AH-REFUND-PCT.
  9496
  9497     IF CF-ST-OVR-SHT-PCT NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 174
* EL050.cbl
  9498        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9499        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9500                                    WS-AH-REFUND-OVS-PCT
  9501                                    EC-ST-OVR-SHT-PCT.
  9502
  9503     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9504     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9505
  9506     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9507          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9508
  9509     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9510     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9511     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9512
  9513     IF CF-ST-LF-PREM-TAX NUMERIC
  9514        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9515     END-IF
  9516     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9517        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9518     END-IF
  9519     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9520        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9521     END-IF
  9522
  9523     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9524         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9525     END-IF.
  9526
  9527     IF WS-LF-BENEFIT-CD = ZEROS
  9528        GO TO 0410-CHECK-AH.
  9529
  9530     IF CF-ST-RT-CALC NOT = SPACES
  9531        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9532                                    EC-ST-LF-REM-TERM-CALC
  9533     END-IF
  9534
  9535     IF WS-LF-COVERAGE-TYPE = 'R'
  9536        IF WS-LF-EARNINGS-CALC = '5'
  9537           IF CF-ST-RF-LN-CALC > '0'
  9538              MOVE CF-ST-RF-LN-CALC
  9539                                 TO WS-LF-REFUND-CALC
  9540                                    EC-ST-LF-REFUND-CALC
  9541           END-IF
  9542        ELSE
  9543           IF CF-ST-RF-LR-CALC > '0'
  9544              MOVE CF-ST-RF-LR-CALC
  9545                                 TO WS-LF-REFUND-CALC
  9546                                    EC-ST-LF-REFUND-CALC
  9547           END-IF
  9548        END-IF
  9549     ELSE
  9550        IF CF-ST-RF-LL-CALC > '0'
  9551           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9552                                    EC-ST-LF-REFUND-CALC
  9553        END-IF
  9554     END-IF
  9555
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 175
* EL050.cbl
  9556     IF CF-ST-RT-CALC NOT = SPACES
  9557        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9558                                    EC-ST-LF-REM-TERM-CALC
  9559     END-IF
  9560
  9561     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9562     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9563
  9564     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9565
  9566     IF NO-BENEFIT-FOUND
  9567        GO TO 0410-CHECK-AH.
  9568
  9569     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9570        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9571                                 TO EC-ST-LF-REM-TERM-CALC
  9572                                    WS-LF-REM-TERM-CALC
  9573     END-IF
  9574
  9575     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9576        MOVE CF-ST-REFUND-CALC (SUB3)
  9577                                 TO WS-LF-REFUND-CALC
  9578                                    EC-ST-LF-REFUND-CALC
  9579     END-IF
  9580*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9581
  9582     .
  9583 0410-CHECK-AH.
  9584
  9585     IF WS-AH-BENEFIT-CD = ZEROS
  9586        GO TO 0500-SET-ACCOUNT.
  9587
  9588     IF CF-ST-RT-CALC NOT = SPACES
  9589        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9590                                    EC-ST-AH-REM-TERM-CALC
  9591     END-IF
  9592
  9593     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9594        IF CF-ST-RF-CP-CALC > '0'
  9595           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9596                                    EC-ST-AH-REFUND-CALC
  9597        END-IF
  9598     ELSE
  9599        IF CF-ST-RF-AH-CALC > '0'
  9600           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9601                                    EC-ST-AH-REFUND-CALC
  9602        END-IF
  9603     END-IF
  9604     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9605     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9606
  9607     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9608
  9609     IF NO-BENEFIT-FOUND
  9610        GO TO 0500-SET-ACCOUNT.
  9611
  9612     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9613        MOVE CF-ST-REM-TERM-CALC (SUB3)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 176
* EL050.cbl
  9614                                 TO WS-AH-REM-TERM-CALC
  9615                                    EC-ST-AH-REM-TERM-CALC
  9616     END-IF
  9617
  9618     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9619        MOVE CF-ST-REFUND-CALC (SUB3)
  9620                                 TO WS-AH-REFUND-CALC
  9621                                    EC-ST-AH-REFUND-CALC
  9622     END-IF
  9623
  9624*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9625
  9626     GO TO 0500-SET-ACCOUNT.
  9627
  9628 0499-STATE-NOT-FOUND.
  9629
  9630     MOVE ER-2603                TO WS-ERROR.
  9631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9632
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 177
* EL050.cbl
  9634
  9635 0500-SET-ACCOUNT.
  9636*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9637     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9638        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9639        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9640        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9641        MOVE '3'                 TO CNTL-REC-TYPE
  9642        MOVE +0                  TO CNTL-SEQ-NO
  9643
  9644        MOVE '3'                 TO RC-SW-2
  9645        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9646
  9647        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9648           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9649           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9650           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9651                                    WS-ST-AH-PREM-TAX-I
  9652                                    WS-ST-AH-PREM-TAX-G
  9653        ELSE
  9654           IF CF-ST-LF-PREM-TAX NUMERIC
  9655              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9656           END-IF
  9657           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9658              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9659           END-IF
  9660           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9661              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9662           END-IF
  9663        END-IF
  9664        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9665     END-IF
  9666*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9667*  FOR DCC ONLY
  9668     IF PB-COMPANY-ID = 'DCC'
  9669
  9670     MOVE ' '                    TO STAT-MASTER-SW
  9671     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9672     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9673     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9674     MOVE PB-STATE               TO ELSTAT-STATE
  9675     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9676        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9677     END-IF
  9678
  9679     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9680     SET BIN-TO-GREG             TO TRUE
  9681     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9682     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9683     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9684
  9685     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9686     IF STAT-MASTER-FOUND
  9687        MOVE 'N'                 TO STAT-MASTER-SW
  9688        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9689        IF STAT-MASTER-FOUND
  9690           IF (ELSTAT-KEY-SAVE (1:12) =
  9691                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 178
* EL050.cbl
  9692              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9693                 MOVE 'F'        TO STAT-MASTER-SW
  9694              ELSE
  9695                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9696                 IF (STAT-MASTER-FOUND)
  9697                    AND (ELSTAT-KEY-SAVE (1:12) =
  9698                        SF-CONTROL-PRIMARY (1:12))
  9699                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9700                    MOVE 'F'     TO STAT-MASTER-SW
  9701                 END-IF
  9702              END-IF
  9703           END-IF
  9704        END-IF
  9705     END-IF
  9706
  9707     IF STAT-MASTER-SW = 'F'
  9708        IF SF-ST-LF-PREM-TAX NUMERIC
  9709           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9710        END-IF
  9711        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9712           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9713        END-IF
  9714        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9715           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9716        END-IF
  9717     END-IF
  9718
  9719     END-IF
  9720     IF (PB-COMPANY-ID = 'DCC')
  9721        AND (PB-ISSUE)
  9722        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9723        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9724        AND (AM-GPCD = 06)
  9725        MOVE 'Y'                 TO WS-GOOD-HIN
  9726        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9727           MOVE PB-I-VIN         TO WS-WORK-VIN
  9728           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9729              (V1 > 16)
  9730              IF WS-WORK-VIN (V1:1) NUMERIC
  9731                 MOVE WS-WORK-VIN-N (V1)
  9732                                 TO WS-ROW-B-VAL (V1)
  9733              ELSE
  9734                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9735                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9736                    OR (V2 > 26)
  9737                 END-PERFORM
  9738                 IF V2 < 27
  9739                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9740                 ELSE
  9741                    MOVE 'N'     TO WS-GOOD-HIN
  9742                 END-IF
  9743              END-IF
  9744              COMPUTE WS-ROW-D-VAL (V1) =
  9745                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9746              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9747                 WS-ROW-D-VAL (V1)
  9748           END-PERFORM
  9749           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 179
* EL050.cbl
  9750           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9751             REMAINDER WS-VIN-REMAINDER
  9752           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9753              CONTINUE
  9754           ELSE
  9755              MOVE 'N'           TO WS-GOOD-HIN
  9756           END-IF
  9757        ELSE
  9758           MOVE 'N'              TO WS-GOOD-HIN
  9759        END-IF
  9760        IF WS-GOOD-HIN NOT = 'Y'
  9761           MOVE ER-3826           TO WS-ERROR
  9762           PERFORM 9900-ERROR-FORMAT
  9763                                 THRU 9900-EXIT
  9764        END-IF
  9765     END-IF
  9766     IF (PB-COMPANY-ID = 'DCC')
  9767        AND (PB-ISSUE)
  9768        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9769        AND (AM-GPCD NOT = 06)
  9770        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9771          MOVE PB-I-VIN          TO WS-WORK-VIN
  9772          MOVE +8                TO V2
  9773          MOVE ZEROS             TO WS-VIN-TOTAL
  9774          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9775           (V1 > 17)
  9776             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9777                MOVE ER-3825     TO WS-ERROR
  9778                PERFORM 9900-ERROR-FORMAT
  9779                                 THRU 9900-EXIT
  9780             ELSE
  9781                IF V1 = 8
  9782                   MOVE 10       TO V2
  9783                END-IF
  9784                IF V1 = 9
  9785                   MOVE 0        TO V2
  9786                END-IF
  9787                IF V1 = 10
  9788                   MOVE 9        TO V2
  9789                END-IF
  9790                IF WS-WORK-VIN (V1:1) NUMERIC
  9791                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9792                    + (WS-WORK-VIN-N (V1) * V2)
  9793                ELSE
  9794                   MOVE WS-WORK-VIN (V1:1)
  9795                                 TO WS-HEX-BYTE
  9796                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9797                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9798                    + (WS-NUM (V3) * V2)
  9799                END-IF
  9800                COMPUTE V2 = V2 - 1
  9801             END-IF
  9802          END-PERFORM
  9803          MOVE ZEROS TO WS-VIN-REMAINDER
  9804          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9805             REMAINDER WS-VIN-REMAINDER
  9806          IF ((WS-WORK-VIN (9:1) = 'X')
  9807             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 180
* EL050.cbl
  9808                     OR
  9809             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9810             CONTINUE
  9811          ELSE
  9812             MOVE ER-3826        TO WS-ERROR
  9813             PERFORM 9900-ERROR-FORMAT
  9814                                 THRU 9900-EXIT
  9815          END-IF
  9816        ELSE
  9817          MOVE ER-3826           TO WS-ERROR
  9818          PERFORM 9900-ERROR-FORMAT
  9819                                 THRU 9900-EXIT
  9820        END-IF
  9821     END-IF
  9822******************************************************************
  9823******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9824******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9825******* METHODS.
  9826******************************************************************
  9827     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9828        IF PB-CANCELLATION
  9829           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9830              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9831                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9832                IF FORM-MASTER-FOUND
  9833                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9834******************************************************************
  9835
  9836     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9837     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9838
  9839     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9840     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9841     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9842     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9843
  9844
  9845     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9846     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9847     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9848
  9849     IF AM-LF-OB-RATE NOT NUMERIC
  9850         MOVE ZERO               TO AM-LF-OB-RATE.
  9851
  9852     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9853         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9854
  9855     IF AM-AH-OB-RATE NOT NUMERIC
  9856         MOVE ZERO               TO AM-AH-OB-RATE.
  9857
  9858     IF WS-LF-JOINT-INDICATOR = 'J'
  9859         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9860     ELSE
  9861         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9862
  9863     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9864
  9865     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 181
* EL050.cbl
  9866         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9867
  9868     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9869         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9870                                       WS-IG-OVRD
  9871     ELSE
  9872         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9873             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9874                                       WS-IG-OVRD
  9875         ELSE
  9876             MOVE AM-IG             TO WS-IG-OVRD-AH
  9877                                       WS-IG-OVRD.
  9878
  9879     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9880         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9881                                       WS-IG-OVRD
  9882     ELSE
  9883         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9884             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9885                                       WS-IG-OVRD
  9886         ELSE
  9887             MOVE AM-IG             TO WS-IG-OVRD-LF
  9888                                       WS-IG-OVRD.
  9889
  9890     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9891     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9892     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
  9893     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
  9894     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
  9895
  9896     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
  9897     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
  9898     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
  9899     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
  9900
  9901     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
  9902     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
  9903     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
  9904     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
  9905     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
  9906     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
  9907     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
  9908
  9909     IF WS-ACCT-AH-DEV-PCT > +0
  9910        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
  9911     ELSE
  9912        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
  9913
  9914     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
  9915        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
  9916     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
  9917        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
  9918
  9919        IF AM-EARN-METHOD-L = 'S'
  9920            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9921                                        WS-LF-REFUND-CALC.
  9922
  9923        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 182
* EL050.cbl
  9924            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9925                                        WS-LF-REFUND-CALC.
  9926
  9927     IF WS-LF-COVERAGE-TYPE = 'R'
  9928         IF AM-EARN-METHOD-R = 'R'
  9929            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9930                                    WS-LF-REFUND-CALC.
  9931     IF WS-LF-COVERAGE-TYPE = 'R'
  9932         IF AM-EARN-METHOD-R = 'P'
  9933            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9934                                    WS-LF-REFUND-CALC.
  9935     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9936         IF AM-EARN-METHOD-L = 'R'
  9937            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9938                                    WS-LF-REFUND-CALC.
  9939     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9940         IF AM-EARN-METHOD-L = 'P'
  9941            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9942                                    WS-LF-REFUND-CALC.
  9943     IF WS-LF-COVERAGE-TYPE = 'R'
  9944         IF AM-EARN-METHOD-R = 'A'
  9945            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9946                                    WS-LF-REFUND-CALC.
  9947     IF WS-LF-COVERAGE-TYPE = 'R'
  9948         IF AM-EARN-METHOD-R = 'M'
  9949            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9950                                    WS-LF-REFUND-CALC.
  9951     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9952         IF AM-EARN-METHOD-L = 'A'
  9953            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9954                                    WS-LF-REFUND-CALC.
  9955     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9956         IF AM-EARN-METHOD-L = 'M'
  9957            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9958                                    WS-LF-REFUND-CALC.
  9959
  9960     IF AM-EARN-METHOD-A = 'R'
  9961        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
  9962                                    WS-AH-REFUND-CALC.
  9963     IF AM-EARN-METHOD-A = 'P'
  9964        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
  9965                                    WS-AH-REFUND-CALC.
  9966     IF AM-EARN-METHOD-A = 'C'
  9967        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
  9968                                    WS-AH-REFUND-CALC.
  9969     IF AM-EARN-METHOD-A = 'A'
  9970        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
  9971                                    WS-AH-REFUND-CALC.
  9972     IF AM-EARN-METHOD-A = 'M'
  9973        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
  9974                                    WS-AH-REFUND-CALC.
  9975     IF AM-EARN-METHOD-A = 'N'
  9976        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
  9977                                    WS-AH-REFUND-CALC.
  9978     IF AM-EARN-METHOD-A = 'S'
  9979        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
  9980                                    WS-AH-REFUND-CALC.
  9981
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 183
* EL050.cbl
  9982     IF AM-TOL-PREM NOT = ZEROS
  9983        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
  9984                                    WS-TOL-AH-PREM.
  9985
  9986     IF AM-OVR-SHT-AMT NUMERIC AND
  9987                  AM-OVR-SHT-AMT > 0
  9988        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
  9989                                    EC-AM-LF-OVR-SHT-AMT
  9990                                    WS-AH-REFUND-OVS-AMT
  9991                                    EC-AM-AH-OVR-SHT-AMT.
  9992
  9993     IF AM-OVR-SHT-PCT NUMERIC AND
  9994                    AM-OVR-SHT-PCT > 0
  9995        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
  9996                                    EC-AM-LF-OVR-SHT-PCT
  9997                                    WS-AH-REFUND-OVS-PCT
  9998                                    EC-AM-AH-OVR-SHT-PCT.
  9999
 10000     IF AM-TOL-REF-PCT NUMERIC AND
 10001                  AM-TOL-REF-PCT > 0
 10002        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10003                                    WS-TOL-AH-REFUND-PCT.
 10004
 10005     IF AM-TOL-REF  NOT = ZEROS  AND
 10006                  AM-TOL-REF NUMERIC
 10007        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10008                                    EC-AM-LF-TOL-REFUND
 10009                                    WS-TOL-AH-REFUND
 10010                                    EC-AM-AH-TOL-REFUND.
 10011
 10012     IF AM-TOL-CLM  NOT = ZEROS
 10013        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10014                                    WS-TOL-AH-CLAIM.
 10015
 10016     IF AM-CLP-TOL-PCT NOT NUMERIC
 10017        MOVE +0                  TO AM-CLP-TOL-PCT
 10018     END-IF
 10019
 10020     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10021        MOVE +0                  TO AM-SPP-LEASE-COMM
 10022     END-IF
 10023     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10024        MOVE WS-PL-TOL-LF-PREM-PCT
 10025                                 TO WS-TOL-LF-PREM-PCT.
 10026
 10027     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10028        MOVE WS-PL-TOL-AH-PREM-PCT
 10029                                 TO WS-TOL-AH-PREM-PCT.
 10030
 10031     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10032        MOVE WS-PL-TOL-LF-REFUND-PCT
 10033                                 TO WS-TOL-LF-REFUND-PCT.
 10034
 10035     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10036        MOVE WS-PL-TOL-AH-REFUND-PCT
 10037                                 TO WS-TOL-AH-REFUND-PCT.
 10038
 10039     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 184
* EL050.cbl
 10040        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10041
 10042     IF WS-PL-REF-OVS-PCT > +0
 10043        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10044
 10045     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10046        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10047     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10048        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10049     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10050        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10051     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10052        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10053     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10054        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10055     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10056        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10057
 10058     IF WS-AH-PL-REF-OVS-AMT > +0
 10059        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10060
 10061     IF WS-AH-PL-REF-OVS-PCT > +0
 10062        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10063
 10064     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10065     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10066
 10067     IF PB-CANCELLATION
 10068        GO TO 3000-CONTINUE-EDIT.
 10069
 10070     MOVE +1 TO SUB1.
 10071     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10072     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10073
 10074     IF CF-COMPANY-ID = 'DMD'
 10075       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10076         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10077        ELSE
 10078         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10079
 10080  0525-FIND-ACCT-COMM.
 10081     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10082        NEXT SENTENCE
 10083      ELSE
 10084         ADD +1 TO SUB1
 10085         IF SUB1 LESS +11
 10086            GO TO 0525-FIND-ACCT-COMM
 10087          ELSE
 10088             GO TO 0560-EDIT-CONTINUE.
 10089
 10090     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10091     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10092                                    PB-I-LIFE-COMMISSION.
 10093***  IF PB-COMPANY-ID = 'CRI'
 10094     IF PB-PREM-ACCTNG-ONLY
 10095         GO TO 0560-EDIT-CONTINUE.
 10096
 10097     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 185
* EL050.cbl
 10098     MOVE ' '    TO WS-CTBL-READ-SW.
 10099
 10100
 10101 0530-GET-AH-COMP.
 10102     IF NO-AH-COVERAGE  OR
 10103        NO-AH-BENEFIT-MATCH
 10104           GO TO 0540-NEXT-READ-STEP.
 10105
 10106     IF AM-A-COM (SUB1) NUMERIC
 10107        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10108         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10109         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10110         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10111         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10112     ELSE
 10113          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10114          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10115          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10116          MOVE ZEROS             TO WS-SUB1
 10117                                    WS-COMMISSION
 10118          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10119          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10120          IF WS-COMMISSION > ZEROS
 10121             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10122             GO TO 0540-NEXT-READ-STEP
 10123          END-IF
 10124          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10125          IF CTBL-TABLE-FOUND
 10126             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10127                                        PB-I-AH-TERM
 10128             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10129             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10130             GO TO 0540-NEXT-READ-STEP
 10131          ELSE
 10132             IF FIRST-TIME-THROUGH
 10133                 GO TO 0530-GET-AH-COMP
 10134             ELSE
 10135                 MOVE ER-2609                TO WS-ERROR
 10136                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10137
 10138 0540-NEXT-READ-STEP.
 10139     MOVE '0540' TO CTBL-SW.
 10140     MOVE ' '    TO WS-CTBL-READ-SW.
 10141
 10142 0540-GET-LF-COMP.
 10143     IF NO-LIFE-COVERAGE  OR
 10144        NO-LF-BENEFIT-MATCH
 10145           GO TO 0560-EDIT-CONTINUE.
 10146
 10147     IF WS-LF-JOINT-INDICATOR = 'J'
 10148        IF AM-J-COM (SUB1) NUMERIC
 10149           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10150           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10151           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10152           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10153           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10154        ELSE
 10155           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 186
* EL050.cbl
 10156           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10157           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10158           MOVE ZEROS                TO WS-SUB1
 10159                                        WS-COMMISSION
 10160           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10161           IF WS-COMMISSION > ZEROS
 10162              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10163              GO TO 0560-EDIT-CONTINUE
 10164           END-IF
 10165           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10166           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10167           IF CTBL-TABLE-FOUND
 10168              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10169              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10170              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10171              GO TO 0560-EDIT-CONTINUE
 10172           ELSE
 10173              IF FIRST-TIME-THROUGH
 10174                  GO TO 0540-GET-LF-COMP
 10175              ELSE
 10176                  MOVE ER-2609                TO WS-ERROR
 10177                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10178                  GO TO 0560-EDIT-CONTINUE.
 10179
 10180     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10181        IF AM-L-COM (SUB1) NUMERIC
 10182           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10183           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10184           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10185           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10186           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10187        ELSE
 10188           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10189           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10190           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10191           MOVE ZEROS                TO WS-SUB1
 10192                                        WS-COMMISSION
 10193           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10194           IF WS-COMMISSION IS GREATER THAN ZEROS
 10195              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10196              GO TO 0560-EDIT-CONTINUE
 10197           END-IF
 10198           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10199           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10200           IF CTBL-TABLE-FOUND
 10201              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10202              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10203              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10204              GO TO 0560-EDIT-CONTINUE
 10205           ELSE
 10206              IF FIRST-TIME-THROUGH
 10207                  GO TO 0540-GET-LF-COMP
 10208              ELSE
 10209                  MOVE ER-2609                TO WS-ERROR
 10210                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10211
 10212*    GO TO 0560-EDIT-CONTINUE.
 10213
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 187
* EL050.cbl
 10214 0560-EDIT-CONTINUE.
 10215     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10216                                    WS-AH-PMF-COMM
 10217*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10218*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10219     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10220        (SUB1 > +10)
 10221        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10222           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10223           MOVE '0530'           TO CTBL-SW
 10224           MOVE ' '              TO WS-CTBL-READ-SW
 10225           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10226           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10227           MOVE '0540'           TO CTBL-SW
 10228           MOVE ' '              TO WS-CTBL-READ-SW
 10229           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10230        END-IF
 10231     END-PERFORM
 10232     GO TO 0564-EDIT-CONTINUE
 10233     .
 10234 0561-CHECK-AH.
 10235     IF (NO-AH-COVERAGE)
 10236        OR (NO-AH-BENEFIT-MATCH)
 10237        CONTINUE
 10238     ELSE
 10239        IF (AM-A-COM (SUB1) NUMERIC)
 10240           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10241           IF (AM-COM-TYP (SUB1) = 'A')
 10242              AND (WS-AH-PMF-COMM = ZEROS)
 10243              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10244           END-IF
 10245           CONTINUE
 10246        ELSE
 10247           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10248           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10249           MOVE PB-AH-OVERRIDE-L1
 10250                                 TO CTBL-BEN-TYPE
 10251           MOVE ZEROS            TO WS-SUB1
 10252                                    WS-COMMISSION
 10253           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10254           PERFORM 8300-READ-CTBL-TABLE
 10255                                 THRU 8300-EXIT
 10256           IF CTBL-TABLE-FOUND
 10257              IF (AM-COM-TYP (SUB1) = 'A')
 10258                 AND (WS-AH-PMF-COMM = ZEROS)
 10259                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10260                                        PB-I-AH-TERM
 10261                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10262                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10263              END-IF
 10264              CONTINUE
 10265           ELSE
 10266              IF FIRST-TIME-THROUGH
 10267                 GO TO 0561-CHECK-AH
 10268              ELSE
 10269                 MOVE ER-2609    TO WS-ERROR
 10270                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10271              END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 188
* EL050.cbl
 10272           END-IF
 10273        END-IF
 10274     END-IF
 10275     .
 10276 0561-EXIT.
 10277     EXIT.
 10278 0563-CHECK-LF.
 10279     IF (NO-LIFE-COVERAGE)
 10280        OR (NO-LF-BENEFIT-MATCH)
 10281        CONTINUE
 10282     ELSE
 10283        IF WS-LF-JOINT-INDICATOR = 'J'
 10284           IF AM-J-COM (SUB1) NUMERIC
 10285              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10286              IF (AM-COM-TYP (SUB1) = 'A')
 10287                 AND (WS-LF-PMF-COMM = ZEROS)
 10288                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10289              END-IF
 10290              CONTINUE
 10291           ELSE
 10292              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10293              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10294              MOVE PB-LIFE-OVERRIDE-L1
 10295                                 TO CTBL-BEN-TYPE
 10296              MOVE ZEROS         TO WS-SUB1
 10297                                    WS-COMMISSION
 10298              MOVE AM-J-COMA (SUB1)
 10299                                 TO CTBL-TABLE
 10300              PERFORM 8300-READ-CTBL-TABLE
 10301                                 THRU 8300-EXIT
 10302              IF CTBL-TABLE-FOUND
 10303                 IF (AM-COM-TYP (SUB1) = 'A')
 10304                    AND (WS-LF-PMF-COMM = ZEROS)
 10305                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10306                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10307                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10308                 END-IF
 10309                 CONTINUE
 10310              ELSE
 10311                 IF FIRST-TIME-THROUGH
 10312                    GO TO 0563-CHECK-LF
 10313                 ELSE
 10314                    MOVE ER-2609 TO WS-ERROR
 10315                    PERFORM 9900-ERROR-FORMAT
 10316                                 THRU 9900-EXIT
 10317*                   GO TO 0560-EDIT-CONTINUE
 10318                 END-IF
 10319              END-IF
 10320           END-IF
 10321        ELSE
 10322           IF AM-L-COM (SUB1) NUMERIC
 10323              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10324              IF (AM-COM-TYP (SUB1) = 'A')
 10325                 AND (WS-LF-PMF-COMM = ZEROS)
 10326                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10327              END-IF
 10328              CONTINUE
 10329           ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 189
* EL050.cbl
 10330              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10331              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10332              MOVE PB-LIFE-OVERRIDE-L1
 10333                                 TO CTBL-BEN-TYPE
 10334              MOVE ZEROS         TO WS-SUB1
 10335                                    WS-COMMISSION
 10336              MOVE AM-L-COMA (SUB1)
 10337                                 TO CTBL-TABLE
 10338              PERFORM 8300-READ-CTBL-TABLE
 10339                                 THRU 8300-EXIT
 10340              IF CTBL-TABLE-FOUND
 10341                 CONTINUE
 10342              ELSE
 10343                 IF FIRST-TIME-THROUGH
 10344                    GO TO 0563-CHECK-LF
 10345                 ELSE
 10346                    MOVE ER-2609 TO WS-ERROR
 10347                    PERFORM 9900-ERROR-FORMAT
 10348                                 THRU 9900-EXIT
 10349                 END-IF
 10350              END-IF
 10351           END-IF
 10352        END-IF
 10353     END-IF
 10354     .
 10355 0563-EXIT.
 10356     EXIT.
 10357 0564-EDIT-CONTINUE.
 10358
 10359     IF  PB-COMPANY-ID EQUAL 'DMD'
 10360         IF PB-I-NUM-BILLED EQUAL ZEROS
 10361            MOVE ER-8148       TO WS-ERROR
 10362            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10363
 10364*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10365*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10366*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10367*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10368*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10369*         IF NO-CONVERSION-ERROR
 10370*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10371*         ELSE
 10372*             IF PB-COMPANY-ID EQUAL 'HAN'
 10373*                 MOVE ZEROS     TO PB-I-AGE.
 10374     IF PB-I-BIRTHDAY > LOW-VALUES
 10375        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10376        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10377        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10378        PERFORM 8500-DATE-CONVERT
 10379                                 THRU 8500-EXIT
 10380        IF NO-CONVERSION-ERROR
 10381           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10382           IF PB-I-AGE > ZEROS
 10383              IF WS-WORK-AGE NOT = PB-I-AGE
 10384                 MOVE ER-9501    TO WS-ERROR
 10385                 PERFORM 9900-ERROR-FORMAT
 10386                                 THRU 9900-EXIT
 10387              END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 190
* EL050.cbl
 10388           ELSE
 10389              MOVE WS-WORK-AGE   TO PB-I-AGE
 10390           END-IF
 10391        END-IF
 10392     END-IF
 10393     IF PB-I-AGE = ZEROS
 10394        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10395           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10396
 10397     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10398                                   WS-AH-EDIT-AGE.
 10399
 10400     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10401        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10402        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10403        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10404        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10405        IF NO-CONVERSION-ERROR
 10406           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10407           IF PB-I-JOINT-AGE > 0
 10408              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10409                 MOVE ER-9503    TO WS-ERROR
 10410                 PERFORM 9900-ERROR-FORMAT
 10411                                 THRU 9900-EXIT
 10412              END-IF
 10413           ELSE
 10414              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10415           END-IF
 10416        ELSE
 10417           MOVE ZEROS            TO PB-I-JOINT-AGE
 10418        END-IF
 10419     END-IF
 10420     IF PB-I-JOINT-AGE NOT NUMERIC
 10421        MOVE ZERO               TO PB-I-JOINT-AGE.
 10422
 10423     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10424        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10425           (WS-AH-JOINT-INDICATOR = 'J')
 10426           IF PB-I-JOINT-AGE = ZEROS
 10427               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10428           END-IF
 10429        END-IF
 10430     END-IF
 10431
 10432     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10433     IF WS-LF-JOINT-INDICATOR = 'J'
 10434        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10435        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10436            IF  PB-I-JOINT-AGE = ZERO
 10437                MOVE ER-2686       TO WS-ERROR
 10438                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10439            ELSE
 10440                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10441                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10442                    IF PB-COMPANY-ID NOT = 'LBL'
 10443                        MOVE ER-2685    TO WS-ERROR
 10444                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10445
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 191
* EL050.cbl
 10446     IF WS-AH-JOINT-INDICATOR = 'J'
 10447        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10448            IF  PB-I-JOINT-AGE = ZERO
 10449                MOVE ER-2686       TO WS-ERROR
 10450                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10451            ELSE
 10452                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10453                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10454                                           WS-EDIT-AGE
 10455                    IF PB-COMPANY-ID NOT = 'LBL'
 10456                        MOVE ER-2685    TO WS-ERROR
 10457                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10458
 10459******************************************************************
 10460*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10461******************************************************************
 10462
 10463     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10464        (WS-AH-SPECIAL-CALC-CD = 'O')
 10465        NEXT SENTENCE
 10466     ELSE
 10467        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10468          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10469           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10470            WS-AH-JOINT-INDICATOR = 'J')  AND
 10471           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10472            MOVE ER-2627             TO WS-ERROR
 10473            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10474
 10475     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10476        (WS-AH-SPECIAL-CALC-CD = 'O')
 10477         NEXT SENTENCE
 10478     ELSE
 10479         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10480            WS-AH-JOINT-INDICATOR = 'J'
 10481             IF PB-I-JOINT-INSURED = SPACES
 10482                 IF PB-COMPANY-ID NOT = 'JAL'
 10483                     MOVE ER-2696    TO WS-ERROR
 10484                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10485
 10486     IF PB-COMPANY-ID NOT = 'BOA'
 10487        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10488           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10489           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10490               PB-I-JOINT-INSURED NOT = SPACES)
 10491                MOVE ER-2691         TO WS-ERROR
 10492                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10493
 10494     IF PB-COMPANY-ID = 'BOA'
 10495        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10496           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10497            IF PB-I-JOINT-AGE NOT = ZEROS
 10498                MOVE ER-2691         TO WS-ERROR
 10499                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10500
 10501     IF PB-COMPANY-ID = 'CRI'
 10502        IF PB-I-SIG-SW = 'J'
 10503           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 192
* EL050.cbl
 10504              WS-AH-JOINT-INDICATOR NOT = 'J'
 10505              MOVE ER-2675       TO WS-ERROR
 10506              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10507
 10508     IF PB-COMPANY-ID = 'CRI'
 10509        IF PB-I-SIG-SW = 'S'
 10510           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10511              WS-AH-JOINT-INDICATOR = 'J'
 10512              MOVE ER-2676       TO WS-ERROR
 10513              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10514
 10515     IF PB-COMPANY-ID = 'CVL'
 10516         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10517            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10518              MOVE ER-2783           TO WS-ERROR
 10519              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10520     IF (WS-LF-JOINT-INDICATOR = 'J')
 10521        AND (WS-AH-JOINT-INDICATOR = 'J')
 10522        AND (PB-I-LF-TERM > 120)
 10523        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10524        MOVE ER-2783             TO WS-ERROR
 10525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10526     END-IF
 10527     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10528
 10529     IF PB-I-INDV-GRP-OVRD = 'I'
 10530        MOVE ER-2666             TO WS-ERROR
 10531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10532        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10533
 10534     IF PB-I-INDV-GRP-OVRD = 'G'
 10535        MOVE ER-2666             TO WS-ERROR
 10536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10537        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10538
 10539     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10540        NEXT SENTENCE
 10541     ELSE
 10542        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10543
 10544     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10545        IF WS-ERROR = ER-2666
 10546           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10547           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10548
 10549     IF PB-COMPANY-ID = 'CID'
 10550        IF PB-STATE = 'UT' OR 'MO'
 10551           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10552                 OR '76' OR '77')
 10553                      OR
 10554               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10555                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10556                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10557                   OR '2K' OR '2L'))
 10558              AND PB-I-INDV-GRP-CD = 'I'
 10559              MOVE ER-2721             TO WS-ERROR
 10560              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10561           END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 193
* EL050.cbl
 10562        END-IF
 10563     END-IF
 10564
 10565     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10566     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10567        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10568     ELSE
 10569        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10570     END-IF
 10571
 10572*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10573*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10574     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10575                                    ACCOUNT-AH-CK-SW.
 10576
 10577     IF PB-REISSUED-CERT       OR
 10578        PB-REIN-ONLY-CERT      OR
 10579        PB-POLICY-IS-DECLINED  OR
 10580        PB-POLICY-IS-VOIDED
 10581*       OR PB-MONTHLY-CERT
 10582         GO TO 3000-CONTINUE-EDIT.
 10583
 10584     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10585        IF WS-EDIT-AGE           > +65
 10586           MOVE ER-2709          TO WS-ERROR
 10587           PERFORM 9900-ERROR-FORMAT
 10588                                 THRU 9900-EXIT
 10589        ELSE
 10590           IF WS-EDIT-AGE        > +55
 10591              MOVE ER-2718       TO WS-ERROR
 10592              PERFORM 9900-ERROR-FORMAT
 10593                                 THRU 9900-EXIT
 10594           END-IF
 10595        END-IF
 10596     IF PB-COMPANY-ID = 'DCC'
 10597        IF WS-EDIT-AGE           > +65
 10598           MOVE ER-2709          TO WS-ERROR
 10599           PERFORM 9900-ERROR-FORMAT
 10600                                 THRU 9900-EXIT
 10601        END-IF
 10602     END-IF
 10603     .
 10604
 10605 0565-LIFE-PLAN-LIMIT-EDITS.
 10606
 10607     IF NOT LF-PLAN-MASTER-FOUND
 10608        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10609                                    EC-AM-LF-MAX-TOT-BEN
 10610        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10611
 10612     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10613
 10614     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10615         IF PL-LM-AGE (1) = ZEROS
 10616             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10617
 10618     IF NO-LF-BENEFIT-MATCH          OR
 10619        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 194
* EL050.cbl
 10620        WS-LF-SPECIAL-CALC-CD = 'M'
 10621        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10622
 10623     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10624     MOVE +1                     TO SUB2.
 10625
 10626     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10627        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10628           MOVE +5   TO SUB2
 10629           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10630              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10631              (PL-LM-AGE (SUB2) EQUAL +0)
 10632              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10633              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10634
 10635     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10636
 10637     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10638                               + PB-I-LF-ALT-BENEFIT-AMT.
 10639
 10640 0568-CHECK-LIFE-ATT-AGE.
 10641
 10642     IF PL-ATT-AGE NUMERIC AND
 10643        PL-ATT-AGE > +0
 10644        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10645     END-IF
 10646*    IF PL-ATT-AGE NUMERIC AND
 10647*       PL-ATT-AGE > +0
 10648*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10649*       IF PB-I-BIRTHDAY > LOW-VALUES
 10650*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10651*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10652*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10653*          SET BIN-PLUS-ELAPSED  TO TRUE
 10654*          PERFORM 8500-DATE-CONVERT
 10655*                                THRU 8500-EXIT
 10656*          IF NO-CONVERSION-ERROR
 10657*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10658*             MOVE ER-2669       TO WS-ERROR
 10659*             PERFORM 9900-ERROR-FORMAT
 10660*                                THRU 9900-EXIT
 10661*          END-IF
 10662*       ELSE
 10663*          IF WS-ATT-AGE >= PL-ATT-AGE
 10664*             MOVE ER-2669       TO WS-ERROR
 10665*             PERFORM 9900-ERROR-FORMAT
 10666*                                THRU 9900-EXIT
 10667*          END-IF
 10668*       END-IF
 10669*    END-IF
 10670     .
 10671 0570-CHECK-LIFE-LIMITS.
 10672
 10673     IF PB-COMPANY-ID EQUAL 'CRI'
 10674        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10675           IF SUB2 GREATER THAN +4
 10676              MOVE ER-2637 TO WS-ERROR
 10677              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 195
* EL050.cbl
 10678              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10679
 10680     IF PB-COMPANY-ID  =  'NCL'
 10681        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10682            SUB2 GREATER THAN +8
 10683             MOVE 'U'         TO PB-BATCH-ENTRY
 10684             MOVE ER-2637     TO WS-ERROR
 10685             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10686             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10687
 10688     IF SUB2 > +8
 10689        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10690           AND (PB-I-SIG-SW = 'Y')
 10691           CONTINUE
 10692        ELSE
 10693           MOVE ER-2637          TO WS-ERROR
 10694           PERFORM 9900-ERROR-FORMAT
 10695                                 THRU 9900-EXIT
 10696        END-IF
 10697        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10698     END-IF
 10699     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10700     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10701     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10702
 10703     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10704        ADD +1  TO SUB2
 10705        GO TO 0570-CHECK-LIFE-LIMITS.
 10706
 10707     IF PB-COMPANY-ID = 'NCL'
 10708         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10709
 10710     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10711        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10712        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10713           AND (PB-I-SIG-SW = 'Y')
 10714           CONTINUE
 10715        ELSE
 10716           MOVE ER-2637          TO WS-ERROR
 10717           PERFORM 9900-ERROR-FORMAT
 10718                                 THRU 9900-EXIT
 10719        END-IF
 10720     END-IF
 10721     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10722
 10723
 10724 0570-CHECK-NCL-LIFE-LIMITS.
 10725
 10726     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10727        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10728         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10729
 10730     IF APP-CERT-USED
 10731         IF SUB2  LESS THAN  +5
 10732             MOVE +5          TO SUB2
 10733             GO TO 0570-CHECK-LIFE-LIMITS.
 10734
 10735     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 196
* EL050.cbl
 10736     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10737
 10738     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10739
 10740 0575-CHECK-NCL-SIG-SWITCH.
 10741
 10742     IF NOT APP-CERT-USED
 10743         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10744
 10745     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10746        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10747        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10748        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10749         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10750
 10751     IF SUB2 GREATER THAN +4
 10752         IF PL-LM-AGE (5) = ZEROS  AND
 10753            PL-LM-AGE (6) = ZEROS  AND
 10754            PL-LM-AGE (7) = ZEROS  AND
 10755            PL-LM-AGE (8) = ZEROS
 10756             MOVE  ER-1927        TO WS-ERROR
 10757             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10758             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10759         ELSE
 10760             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10761                 MOVE  ER-1920    TO WS-ERROR
 10762                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10763
 10764     IF PB-I-SIG-SW  = 'Y'
 10765       IF NOT PB-I-POLICY-ACCEPTED  AND
 10766          NOT PB-I-POLICY-DECLINED
 10767           MOVE 'U'               TO PB-BATCH-ENTRY
 10768           MOVE  ER-1926          TO WS-ERROR
 10769           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10770
 10771
 10772 0580-AH-PLAN-LIMIT-EDITS.
 10773
 10774     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10775        IF PB-I-AH-BENEFIT-AMT > +1250
 10776           MOVE ER-2702          TO WS-ERROR
 10777           PERFORM 9900-ERROR-FORMAT
 10778                                 THRU 9900-EXIT
 10779        END-IF
 10780     END-IF
 10781
 10782     IF (PB-COMPANY-ID = 'DCC')
 10783        AND (PB-MONTHLY-CERT)
 10784        IF PB-I-AH-BENEFIT-AMT > +1000
 10785           MOVE ER-2881          TO WS-ERROR
 10786           PERFORM 9900-ERROR-FORMAT
 10787                                 THRU 9900-EXIT
 10788        END-IF
 10789     END-IF
 10790     IF NOT AH-PLAN-MASTER-FOUND
 10791        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10792        GO TO 3000-CONTINUE-EDIT.
 10793
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 197
* EL050.cbl
 10794     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10795
 10796     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10797         IF PL-LM-AGE (1) = ZEROS
 10798             GO TO 3000-CONTINUE-EDIT.
 10799
 10800     IF NO-AH-BENEFIT-MATCH          OR
 10801        WS-AH-BENEFIT-CD = ZEROS     OR
 10802        WS-AH-SPECIAL-CALC-CD = 'M'
 10803        GO TO 3000-CONTINUE-EDIT.
 10804
 10805     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10806     MOVE +1                     TO SUB2.
 10807
 10808     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10809        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10810           MOVE +5 TO SUB2
 10811           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10812              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10813              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10814              (PL-LM-AGE (SUB2) EQUAL +0)
 10815              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10816              GO TO 3000-CONTINUE-EDIT.
 10817
 10818     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10819
 10820 0590-CHECK-AH-ATT-AGE.
 10821
 10822     IF PL-ATT-AGE NUMERIC AND
 10823        PL-ATT-AGE GREATER THAN +0
 10824        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10825     END-IF
 10826*       IF WS-ATT-AGE >= PL-ATT-AGE
 10827*          MOVE ER-3054          TO WS-ERROR
 10828*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10829     .
 10830 0597-CHECK-AH-LIMITS.
 10831
 10832     IF PB-COMPANY-ID EQUAL 'CRI'
 10833        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10834           IF SUB2 GREATER THAN +4
 10835              MOVE ER-2638       TO WS-ERROR
 10836              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10837              GO TO 3000-CONTINUE-EDIT.
 10838
 10839     IF PB-COMPANY-ID  =  'NCL'
 10840        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10841            SUB2 GREATER THAN +8
 10842             MOVE 'U'            TO PB-BATCH-ENTRY
 10843             MOVE ER-2638        TO WS-ERROR
 10844             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10845             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10846
 10847     IF SUB2 > +8
 10848        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10849           AND (PB-I-SIG-SW = 'Y')
 10850           CONTINUE
 10851        ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 198
* EL050.cbl
 10852           MOVE ER-2638          TO WS-ERROR
 10853           PERFORM 9900-ERROR-FORMAT
 10854                                 THRU 9900-EXIT
 10855        END-IF
 10856        GO TO 3000-CONTINUE-EDIT
 10857     END-IF
 10858
 10859     IF PB-COMPANY-ID = 'CRI'
 10860        IF WS-ERROR = ER-2638
 10861           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10862
 10863     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10864     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10865     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10866     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10867
 10868     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10869        ADD +1                   TO SUB2
 10870        GO TO 0597-CHECK-AH-LIMITS.
 10871
 10872     IF PB-COMPANY-ID = 'NCL'
 10873         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10874
 10875     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10876        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10877        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10878                                 > PL-LM-AMT (SUB2))
 10879        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10880           AND (PB-I-SIG-SW = 'Y')
 10881           CONTINUE
 10882        ELSE
 10883           MOVE ER-2638          TO WS-ERROR
 10884           PERFORM 9900-ERROR-FORMAT
 10885                                 THRU 9900-EXIT
 10886        END-IF
 10887     END-IF
 10888
 10889     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10890         IF  WS-ERROR    EQUAL    ER-2638
 10891             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10892                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 10893                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10894                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10895                MOVE  ER-1910    TO  WS-ERROR
 10896                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 10897
 10898     IF PB-COMPANY-ID = 'CRI'
 10899        IF WS-ERROR = ER-2638
 10900            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10901            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10902            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 10903
 10904     GO TO 3000-CONTINUE-EDIT.
 10905
 10906 0597-CHECK-NCL-AH-LIMITS.
 10907
 10908     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 10909        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 199
* EL050.cbl
 10910        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10911                            NOT GREATER THAN PL-LM-AMT (SUB2))
 10912         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10913
 10914     IF APP-CERT-USED
 10915         IF SUB2  LESS THAN  +5
 10916             MOVE +5             TO SUB2
 10917             GO TO 0597-CHECK-AH-LIMITS.
 10918
 10919     MOVE ER-2638                TO WS-ERROR.
 10920     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10921
 10922     MOVE 'U'                    TO PB-BATCH-ENTRY.
 10923
 10924 0599-CHECK-NCL-SIG-SWITCH.
 10925
 10926     IF NOT APP-CERT-USED
 10927         GO TO 3000-CONTINUE-EDIT.
 10928
 10929     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10930        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10931        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10932        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10933         GO TO 3000-CONTINUE-EDIT.
 10934
 10935     IF SUB2 GREATER THAN +4
 10936         IF PL-LM-AGE (5) = ZEROS  AND
 10937            PL-LM-AGE (6) = ZEROS  AND
 10938            PL-LM-AGE (7) = ZEROS  AND
 10939            PL-LM-AGE (8) = ZEROS
 10940             MOVE  ER-1927        TO WS-ERROR
 10941             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10942             GO TO 3000-CONTINUE-EDIT
 10943         ELSE
 10944             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10945                 MOVE  ER-1920    TO WS-ERROR
 10946                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10947
 10948     IF PB-I-SIG-SW  = 'Y'
 10949       IF NOT PB-I-POLICY-ACCEPTED  AND
 10950          NOT PB-I-POLICY-DECLINED
 10951           MOVE 'U'               TO PB-BATCH-ENTRY
 10952           MOVE  ER-1926          TO WS-ERROR
 10953           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10954
 10955******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 200
* EL050.cbl
 10957
 10958 3000-CONTINUE-EDIT.
 10959
 10960     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10961     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 10962     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10963     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10964     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10965
 10966     IF BROWSE-STARTED
 10967        PERFORM 9990-RETURN THRU 9990-EXIT
 10968        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 10969
 10970     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 10971        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10972        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10973        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10974*       MOVE 1                   TO DC-OPTION-CODE
 10975        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10976        IF DATE-CONVERSION-ERROR
 10977           MOVE ER-2622          TO WS-ERROR
 10978           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10979        ELSE
 10980           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 10981              MOVE ER-2623       TO WS-ERROR
 10982              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10983           ELSE
 10984              MOVE ER-2622       TO WS-ERROR
 10985              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10986
 10987     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 10988     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 10989     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 10990*    MOVE 1                      TO DC-OPTION-CODE.
 10991     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10992     IF DATE-CONVERSION-ERROR
 10993        GO TO 3005-EDIT-CONTINUE
 10994     ELSE
 10995        IF DC-ELAPSED-DAYS GREATER +180
 10996           MOVE ER-2613          TO WS-ERROR
 10997           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10998        ELSE
 10999           IF DC-ELAPSED-DAYS GREATER +90
 11000              MOVE ER-2612       TO WS-ERROR
 11001              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11002           ELSE
 11003             IF DC-ELAPSED-DAYS GREATER +60
 11004                MOVE ER-2614     TO WS-ERROR
 11005                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11006
 11007 3005-EDIT-CONTINUE.
 11008
 11009     IF PB-CANCELLATION
 11010         GO TO 3700-EDIT-CANCEL.
 11011
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 201
* EL050.cbl
 11013******************************************************************
 11014*                  E D I T   I S S U E                           *
 11015******************************************************************
 11016
 11017 3020-EDIT-ISSUE.
 11018
 11019      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11020      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11021      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11022      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11023      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11024
 11025     IF PB-ISSUE-FORCE
 11026        OR PB-ISSUE-DATE-FORCED
 11027        OR PB-FORCE-OFF
 11028        OR PB-OVERCHARGE-FORCE
 11029        CONTINUE
 11030     ELSE
 11031        MOVE ER-2670             TO WS-ERROR
 11032        PERFORM 9900-ERROR-FORMAT
 11033                                 THRU 9900-EXIT
 11034     END-IF
 11035     .
 11036 3022-SET-POLICY-STATUS.
 11037
 11038     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11039
 11040     IF (PB-REISSUED-CERT)
 11041             OR
 11042        ((PB-COMPANY-ID NOT = 'DCC')
 11043         AND (PB-MONTHLY-CERT))
 11044         MOVE '5'                TO PB-I-ENTRY-STATUS
 11045         MOVE 'E'                TO PB-BATCH-ENTRY
 11046     END-IF
 11047
 11048     IF PB-COMPANY-ID = 'DCC'
 11049        IF PB-MONTHLY-CERT
 11050           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11051        END-IF
 11052     END-IF
 11053     IF PB-POLICY-IS-DECLINED
 11054         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11055     IF PB-POLICY-IS-VOIDED
 11056         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11057     IF PB-NEEDS-UNDERWRITING
 11058         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11059     IF PB-REIN-ONLY-CERT
 11060         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11061     IF PB-PREM-ACCTNG-ONLY
 11062         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11063
 11064     MOVE SPACE                  TO PB-I-OB-FLAG.
 11065
 11066     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11067         MOVE ER-2665            TO WS-ERROR
 11068         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11069         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11070
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 202
* EL050.cbl
 11071     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11072        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11073           MOVE 'Z'             TO PB-I-OB-FLAG.
 11074
 11075     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11076        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11077           MOVE 'Z'             TO PB-I-OB-FLAG.
 11078
 11079     IF ACCOUNT-MAST-FOUND
 11080         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11081         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11082         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11083         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11084         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11085         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11086         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11087     END-IF
 11088
 11089     IF ACCOUNT-MAST-FOUND
 11090        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11091         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11092
 11093     IF (ACCOUNT-MAST-FOUND)
 11094        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11095        IF PB-REISSUED-CERT
 11096           CONTINUE
 11097        ELSE
 11098           MOVE ER-2608          TO WS-ERROR
 11099           PERFORM 9900-ERROR-FORMAT
 11100                                 THRU 9900-EXIT
 11101         END-IF
 11102     END-IF
 11103
 11104     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11105        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11106        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11107
 11108**********   DMD CUSTOM CODE FOLLOWS  **********
 11109 3024-EDIT-DMD-FIELDS.
 11110     IF PB-COMPANY-ID NOT = 'DMD'
 11111        GO TO 3025-EDIT-REINSURANCE.
 11112
 11113*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11114*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11115*** ERROR IF THEY ARE NOT EQUAL.
 11116
 11117     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11118     SET BIN-TO-GREG               TO TRUE.
 11119     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11120     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11121**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11122
 11123     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11124     SET BIN-TO-GREG               TO TRUE.
 11125     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11126     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11127**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11128
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 203
* EL050.cbl
 11129     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11130        MOVE ER-8116               TO WS-ERROR
 11131        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11132
 11133     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11134
 11135     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11136                                      WK-FULL-CERT-NO.
 11137     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11138
 11139     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11140
 11141     IF PB-VALID-LIFE
 11142        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11143     ELSE
 11144        IF PB-VALID-AH
 11145          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11146
 11147
 11148     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11149     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11150     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11151                                      DCUA-UNDRWRTR-CODE
 11152                                      DCUA-UNDRWRTR-GROUP-CODE
 11153                                      DCUA-RETURN-CODE.
 11154
 11155****************************************************************
 11156*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11157***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11158***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11159***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11160***   TO THIS RECORD.                                        ***
 11161****************************************************************
 11162     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11163     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11164     IF DCUA-SUCCESSFUL-PROCESS
 11165        GO TO 3024-EDIT-DL7-CONT.
 11166
 11167     IF DCUA-RETURN-CODE EQUAL '01'
 11168        MOVE ER-8110               TO WS-ERROR
 11169        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11170        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11171        GO TO 3024-EDIT-DL7-CONT.
 11172
 11173     IF DCUA-RETURN-CODE EQUAL '02'
 11174        MOVE ER-8111               TO WS-ERROR
 11175        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11176        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11177        GO TO 3024-EDIT-DL7-CONT.
 11178
 11179     IF DCUA-RETURN-CODE EQUAL '03'
 11180        MOVE ER-8074               TO WS-ERROR
 11181        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11182        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11183        GO TO 3024-EDIT-DL7-CONT.
 11184
 11185     IF DCUA-RETURN-CODE EQUAL '04'
 11186        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 204
* EL050.cbl
 11187        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11188        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11189        GO TO 3024-EDIT-DL7-CONT.
 11190
 11191     IF DCUA-RETURN-CODE EQUAL '05'
 11192        MOVE ER-8076               TO WS-ERROR
 11193        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11194        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11195        GO TO 3024-EDIT-DL7-CONT.
 11196
 11197     IF DCUA-RETURN-CODE EQUAL '06'
 11198        MOVE ER-8077               TO WS-ERROR
 11199        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11200        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11201        GO TO 3024-EDIT-DL7-CONT.
 11202
 11203     IF DCUA-RETURN-CODE EQUAL '07'
 11204        MOVE ER-8078               TO WS-ERROR
 11205        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11207        GO TO 3024-EDIT-DL7-CONT.
 11208
 11209     IF DCUA-RETURN-CODE EQUAL 'E1'
 11210        MOVE ER-8079               TO WS-ERROR
 11211        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11213        GO TO 3024-EDIT-DL7-CONT.
 11214
 11215     IF DCUA-RETURN-CODE EQUAL 'E2'
 11216        MOVE ER-8080               TO WS-ERROR
 11217        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11218        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11219        GO TO 3024-EDIT-DL7-CONT.
 11220
 11221     IF DCUA-RETURN-CODE EQUAL 'E3'
 11222        MOVE ER-8098               TO WS-ERROR
 11223        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11225        GO TO 3024-EDIT-DL7-CONT.
 11226
 11227     IF DCUA-RETURN-CODE EQUAL 'C1'
 11228        MOVE ER-8099               TO WS-ERROR
 11229        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11231        GO TO 3024-EDIT-DL7-CONT.
 11232
 11233     IF DCUA-RETURN-CODE EQUAL 'U1'
 11234        MOVE ER-8109               TO WS-ERROR
 11235        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11236        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11237        GO TO 3024-EDIT-DL7-CONT.
 11238
 11239     IF DCUA-RETURN-CODE EQUAL 'N1'
 11240        MOVE ER-8112               TO WS-ERROR
 11241        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11243        GO TO 3024-EDIT-DL7-CONT.
 11244
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 205
* EL050.cbl
 11245     IF DCUA-RETURN-CODE EQUAL 'N2'
 11246        MOVE ER-8113               TO WS-ERROR
 11247        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11249        GO TO 3024-EDIT-DL7-CONT.
 11250
 11251     IF DCUA-RETURN-CODE EQUAL 'N3'
 11252        MOVE ER-8114               TO WS-ERROR
 11253        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11254        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11255        GO TO 3024-EDIT-DL7-CONT.
 11256
 11257     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11258     MOVE ER-8097                  TO WS-ERROR.
 11259     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11260     GO TO 3024-EDIT-DL7-CONT.
 11261
 11262 3024-EDIT-DL7-CONT.
 11263
 11264     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11265     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11266     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11267        NEXT SENTENCE
 11268     ELSE
 11269        MOVE ER-9263               TO WS-ERROR
 11270        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11271
 11272******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11273******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11274     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11275        NEXT SENTENCE
 11276     ELSE
 11277        MOVE ER-8039               TO WS-ERROR
 11278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11279
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 206
* EL050.cbl
 11281****************************************************************
 11282*** VALIDATE STATE  : DLO022                                 ***
 11283****************************************************************
 11284     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11285     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11286
 11287     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11288     IF DVSC-SUCCESSFUL-EDIT
 11289        GO TO 3024-EDIT-DL22-CONT.
 11290
 11291     IF DVSC-RETURN-CODE EQUAL '01'
 11292        MOVE ER-8300               TO WS-ERROR
 11293        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11294        GO TO 3024-EDIT-DL22-CONT.
 11295
 11296     IF DVSC-RETURN-CODE EQUAL '02'
 11297        MOVE ER-8301               TO WS-ERROR
 11298        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11299        GO TO 3024-EDIT-DL22-CONT.
 11300
 11301     IF DVSC-RETURN-CODE EQUAL '03'
 11302        MOVE ER-8302               TO WS-ERROR
 11303        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11304        GO TO 3024-EDIT-DL22-CONT.
 11305
 11306     IF DVSC-RETURN-CODE EQUAL 'N1'
 11307        MOVE ER-8304               TO WS-ERROR
 11308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11309        GO TO 3024-EDIT-DL22-CONT.
 11310
 11311     MOVE ER-8303                  TO WS-ERROR
 11312     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11313
 11314 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 207
* EL050.cbl
 11316****************************************************************
 11317*** VALIDATE LOAN OFFICER : DLO021                           ***
 11318****************************************************************
 11319
 11320     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11321     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11322     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11323     IF DVLO-SUCCESSFUL-EDIT
 11324        GO TO 3024-EDIT-DL21-CONT.
 11325
 11326     IF DVLO-RETURN-CODE EQUAL '01'
 11327        MOVE ER-8081               TO WS-ERROR
 11328        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11329        GO TO 3024-EDIT-DL21-CONT.
 11330
 11331     IF DVLO-RETURN-CODE EQUAL '02'
 11332        MOVE ER-8082               TO WS-ERROR
 11333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11334        GO TO 3024-EDIT-DL21-CONT.
 11335
 11336     IF DVLO-RETURN-CODE EQUAL '03'
 11337        MOVE ER-8083               TO WS-ERROR
 11338        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11339        GO TO 3024-EDIT-DL21-CONT.
 11340
 11341     IF DVLO-RETURN-CODE EQUAL '04'
 11342        MOVE ER-8084               TO WS-ERROR
 11343        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11344        GO TO 3024-EDIT-DL21-CONT.
 11345
 11346     IF DVLO-RETURN-CODE EQUAL '05'
 11347        MOVE ER-8085               TO WS-ERROR
 11348        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11349        GO TO 3024-EDIT-DL21-CONT.
 11350
 11351     MOVE ER-7825                  TO WS-ERROR
 11352     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11353     GO TO 3024-EDIT-DL21-CONT.
 11354
 11355 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 208
* EL050.cbl
 11357
 11358****************************************************************
 11359*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11360****************************************************************
 11361
 11362     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11363     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11364     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11365     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11366     IF DIPF-SUCCESSFUL-EDIT
 11367        GO TO 3024-EDIT-DL02-CONT.
 11368
 11369     IF DIPF-RETURN-CODE EQUAL '01'
 11370        MOVE ER-8086               TO WS-ERROR
 11371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11372        GO TO 3024-EDIT-DL02-CONT.
 11373
 11374     IF DIPF-RETURN-CODE EQUAL '02'
 11375        MOVE ER-8087               TO WS-ERROR
 11376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11377        GO TO 3024-EDIT-DL02-CONT.
 11378
 11379     IF DIPF-RETURN-CODE EQUAL '03'
 11380        MOVE ER-8088               TO WS-ERROR
 11381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11382        GO TO 3024-EDIT-DL02-CONT.
 11383
 11384     MOVE ER-8095                  TO WS-ERROR
 11385     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11386     GO TO 3024-EDIT-DL02-CONT.
 11387
 11388 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 209
* EL050.cbl
 11390
 11391****************************************************************
 11392*** VALIDATE BANK ID : DLO003                                ***
 11393****************************************************************
 11394
 11395     MOVE WK-GREG-CENT           TO WCG-CENT.
 11396     MOVE WK-GREG-YYMM           TO WCG-REST.
 11397     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11398        MOVE ER-8040               TO WS-ERROR
 11399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11400
 11401     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11402     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11403     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11404     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11405     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11406     IF DVBI-SUCCESSFUL-EDIT
 11407        GO TO 3024-EDIT-DL03-CONT.
 11408
 11409     IF DVBI-RETURN-CODE EQUAL '01'
 11410        MOVE ER-8089               TO WS-ERROR
 11411        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11412        GO TO 3024-EDIT-DL03-CONT.
 11413
 11414     IF DVBI-RETURN-CODE EQUAL '02'
 11415        MOVE ER-8090               TO WS-ERROR
 11416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11417        GO TO 3024-EDIT-DL03-CONT.
 11418
 11419     IF DVBI-RETURN-CODE EQUAL '03'
 11420        MOVE ER-8091               TO WS-ERROR
 11421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11422        GO TO 3024-EDIT-DL03-CONT.
 11423
 11424     IF DVBI-RETURN-CODE EQUAL '04'
 11425        MOVE ER-8092               TO WS-ERROR
 11426        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11427        GO TO 3024-EDIT-DL03-CONT.
 11428
 11429     IF DVBI-RETURN-CODE EQUAL '05'
 11430        MOVE ER-8093               TO WS-ERROR
 11431        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11432        GO TO 3024-EDIT-DL03-CONT.
 11433
 11434     IF DVBI-RETURN-CODE EQUAL '06'
 11435        MOVE ER-8094               TO WS-ERROR
 11436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11437        GO TO 3024-EDIT-DL03-CONT.
 11438
 11439     MOVE ER-8096                  TO WS-ERROR
 11440     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11441     GO TO 3024-EDIT-DL03-CONT.
 11442
 11443 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 210
* EL050.cbl
 11445
 11446     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11447        NEXT SENTENCE
 11448     ELSE
 11449        MOVE ER-8042               TO WS-ERROR
 11450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11451
 11452     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11453     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11454     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11455
 11456     IF DMPF-RETURN-CODE = '01'
 11457        MOVE ER-8067               TO WS-ERROR
 11458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11459        GO TO 3024-EDIT-DL01-CONT.
 11460
 11461     IF DMPF-RETURN-CODE = '02'
 11462        MOVE ER-8068               TO WS-ERROR
 11463        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11464        GO TO 3024-EDIT-DL01-CONT.
 11465
 11466     IF DMPF-RETURN-CODE = '03'
 11467        MOVE ER-8069               TO WS-ERROR
 11468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11469        GO TO 3024-EDIT-DL01-CONT.
 11470
 11471     IF DMPF-RETURN-CODE = 'E1'
 11472        MOVE ER-8070               TO WS-ERROR
 11473        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11474        GO TO 3024-EDIT-DL01-CONT.
 11475
 11476     IF DMPF-RETURN-CODE = 'N1'
 11477        MOVE ER-8071               TO WS-ERROR
 11478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11479        GO TO 3024-EDIT-DL01-CONT.
 11480
 11481     IF DMPF-RETURN-CODE NOT = 'OK'
 11482        MOVE ER-8072               TO WS-ERROR
 11483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11484
 11485 3024-EDIT-DL01-CONT.
 11486******************************************************************
 11487***  VALIDATES RATE CODES : DLO017                             ***
 11488******************************************************************
 11489
 11490      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11491      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11492      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11493      IF DVRC-SUCCESSFUL-EDIT
 11494        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11495        GO TO 3024-CHECK-VALID-RATE.
 11496
 11497      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11498
 11499      IF DVRC-RETURN-CODE EQUAL '01'
 11500         MOVE ER-7817                   TO WS-ERROR
 11501         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11502         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 211
* EL050.cbl
 11503
 11504      IF DVRC-RETURN-CODE EQUAL '02'
 11505         MOVE ER-7818                   TO WS-ERROR
 11506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507         GO TO 3025-EDIT-REINSURANCE.
 11508
 11509      IF DVRC-RETURN-CODE EQUAL '03'
 11510         MOVE ER-7819                   TO WS-ERROR
 11511         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11512         GO TO 3025-EDIT-REINSURANCE.
 11513
 11514       MOVE ER-7820                     TO WS-ERROR.
 11515       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11516       GO TO 3025-EDIT-REINSURANCE.
 11517
 11518******************************************************************
 11519***  GET PREMIUM RATES : DLO011                                ***
 11520******************************************************************
 11521
 11522 3024-CHECK-VALID-RATE.
 11523
 11524     IF VALID-RATE-CODE
 11525        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11526        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11527        MOVE SPACES                TO DPRB-RETURN-CODE
 11528        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11529     ELSE
 11530         GO TO 3025-EDIT-REINSURANCE.
 11531
 11532      IF DPRB-SUCCESSFUL-PROCESS
 11533         IF PB-VALID-LIFE
 11534             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11535             GO TO 3025-EDIT-REINSURANCE
 11536         ELSE
 11537             IF PB-VALID-AH
 11538                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11539                 GO TO 3025-EDIT-REINSURANCE.
 11540
 11541      IF DPRB-RETURN-CODE EQUAL '01'
 11542         MOVE ER-7812                   TO WS-ERROR
 11543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11544         GO TO 3025-EDIT-REINSURANCE.
 11545
 11546      IF DPRB-RETURN-CODE EQUAL '02'
 11547         MOVE ER-7813                   TO WS-ERROR
 11548         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11549         GO TO 3025-EDIT-REINSURANCE.
 11550
 11551      IF DPRB-RETURN-CODE EQUAL '03'
 11552         MOVE ER-7814                   TO WS-ERROR
 11553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11554         GO TO 3025-EDIT-REINSURANCE.
 11555
 11556      IF DPRB-RETURN-CODE EQUAL '04'
 11557         IF NOT DPRB-1ST-TIME
 11558            MOVE ER-7815                   TO WS-ERROR
 11559            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11560            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 212
* EL050.cbl
 11561          ELSE
 11562         IF PB-VALID-LIFE
 11563            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11564          ELSE
 11565            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11566         END-IF
 11567         MOVE SPACES                TO DOCC-RETURN-CODE
 11568         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11569         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11570         IF DOCC-RETURN-CODE = 'OK'
 11571             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11572             GO TO 3024-CHECK-VALID-RATE
 11573           ELSE
 11574             MOVE ER-7823               TO WS-ERROR
 11575             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11576             GO TO 3025-EDIT-REINSURANCE.
 11577
 11578       MOVE ER-7816                     TO WS-ERROR.
 11579       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11580       GO TO 3025-EDIT-REINSURANCE.
 11581
 11582**********   DMD CUSTOM CODE ABOVE    **********
 11583
 11584 3025-EDIT-REINSURANCE.
 11585     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11586         GO TO 3027-EDIT-CONTINUE.
 11587
 11588     MOVE LOW-VALUES               TO ERREIN-KEY.
 11589     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11590     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11591                                      REIN-CODE-2
 11592                                      REIN-CODE-3.
 11593     MOVE 'A'                      TO REIN-TYPE.
 11594
 11595     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11596
 11597     MOVE '3026' TO REIN-SW.
 11598     MOVE ' '                   TO WS-REIN-READ-SW.
 11599
 11600     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11601     IF REIN-TABLE-NOT-FOUND
 11602         GO TO 3026-NO-SPEC-TABLE.
 11603
 11604     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11605     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11606                                   WS-NSP-ST-CD-LF.
 11607     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11608                                   WS-NSP-ST-CD-AH.
 11609
 11610     GO TO 3040-EDIT-CONTINUE.
 11611
 11612 3026-NO-SPEC-TABLE.
 11613
 11614     MOVE ER-2664                TO WS-ERROR.
 11615     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11616     GO TO 3040-EDIT-CONTINUE.
 11617
 11618 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 213
* EL050.cbl
 11619
 11620     IF PB-I-REIN-TABLE = SPACES
 11621       GO TO 3040-EDIT-CONTINUE.
 11622
 11623     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11624          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11625          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11626           GO TO 3040-EDIT-CONTINUE.
 11627
 11628     MOVE LOW-VALUES            TO ERREIN-KEY.
 11629     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11630     MOVE 'A'                   TO REIN-TYPE.
 11631     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11632
 11633     MOVE '3028'                TO REIN-SW.
 11634     MOVE ' '                   TO WS-REIN-READ-SW.
 11635
 11636     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11637     IF REIN-TABLE-NOT-FOUND
 11638         GO TO 3028-NO-REIN-TABLE.
 11639
 11640     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11641     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11642                                   WS-NSP-ST-CD-LF.
 11643     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11644                                   WS-NSP-ST-CD-AH.
 11645
 11646     GO TO 3040-EDIT-CONTINUE.
 11647
 11648 3028-NO-REIN-TABLE.
 11649
 11650     MOVE ER-2615                TO WS-ERROR.
 11651     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11652     GO TO 3040-EDIT-CONTINUE.
 11653
 11654 3040-EDIT-CONTINUE.
 11655
 11656     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11657         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11658
 11659     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11660         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11661
 11662     IF (NOT PB-REISSUED-CERT)
 11663        AND (NOT PB-MONTHLY-CERT)
 11664        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11665            MOVE '001'           TO PB-I-LF-TERM
 11666            MOVE 'M'             TO PB-I-INSURED-SEX.
 11667
 11668     IF (NOT PB-REISSUED-CERT)
 11669        AND (NOT PB-MONTHLY-CERT)
 11670        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11671            MOVE '001'           TO PB-I-AH-TERM
 11672            MOVE 'M'             TO PB-I-INSURED-SEX.
 11673
 11674 3040-EDIT-1ST-PMT-DT.
 11675     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11676     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 214
* EL050.cbl
 11677         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11678
 11679******************************************************************
 11680*                                                                *
 11681*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11682*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11683*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11684*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11685*                                                                *
 11686******************************************************************
 11687
 11688     IF PB-EFF-DT-PROCESSING
 11689        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11690                                    PB-I-LF-EXPIRE-DT
 11691                                    PB-I-AH-EXPIRE-DT
 11692        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11693        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11694        MOVE ZERO                TO DC-ELAPSED-DAYS
 11695        MOVE +1                  TO DC-ELAPSED-MONTHS
 11696        SET BIN-PLUS-ELAPSED     TO TRUE
 11697*       MOVE 6                   TO DC-OPTION-CODE
 11698        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11699        IF NO-CONVERSION-ERROR
 11700           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11701
 11702******************************************************************
 11703*                                                                *
 11704*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11705*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11706*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11707*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11708*                                                                *
 11709******************************************************************
 11710
 11711     IF PB-EXT-DAYS-PROCESSING
 11712          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11713                                         PB-I-LF-EXPIRE-DT
 11714                                         PB-I-AH-EXPIRE-DT
 11715          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11716          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11717          MOVE +1                     TO DC-ELAPSED-MONTHS
 11718          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11719          SET BIN-PLUS-ELAPSED        TO TRUE
 11720*         MOVE 6                      TO DC-OPTION-CODE
 11721          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11722          IF NO-CONVERSION-ERROR
 11723             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11724
 11725******************************************************************
 11726*                                                                *
 11727*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11728*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11729*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11730*        (EXPIRE DATE - (TERM -1))  *  -1.
 11731*                                                                *
 11732******************************************************************
 11733
 11734     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 215
* EL050.cbl
 11735        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11736           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11737              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11738              MOVE PB-I-AH-TERM      TO WS-TERM
 11739           ELSE
 11740              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11741              MOVE PB-I-LF-TERM      TO WS-TERM
 11742        ELSE
 11743           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11744              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11745              MOVE PB-I-LF-TERM      TO WS-TERM
 11746           ELSE
 11747              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11748              MOVE PB-I-AH-TERM      TO WS-TERM.
 11749
 11750     IF PB-EXPIRE-DT-PROCESSING
 11751        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11752        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11753        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11754        MOVE ZERO                TO DC-ELAPSED-DAYS
 11755                                    DC-ODD-DAYS-OVER
 11756          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11757          SET BIN-PLUS-ELAPSED    TO TRUE
 11758*         MOVE 6                  TO DC-OPTION-CODE
 11759          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11760          IF NO-CONVERSION-ERROR
 11761             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11762
 11763******************************************************************
 11764*                                                                *
 11765*            1ST PAYMENT DATE PROCESSING                         *
 11766*                                                                *
 11767******************************************************************
 11768
 11769     IF PB-1ST-PMT-DT-PROCESSING
 11770        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11771                                    PB-I-AH-EXPIRE-DT
 11772        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11773
 11774     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11775         NEXT SENTENCE
 11776     ELSE
 11777         MOVE ER-2680                 TO WS-ERROR
 11778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11779         GO TO 3060-ORIG-TERM-CHECK.
 11780
 11781     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11782     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11783     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11784*    MOVE 1                      TO DC-OPTION-CODE.
 11785     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11786                                    DC-ELAPSED-DAYS
 11787                                    DC-ODD-DAYS-OVER.
 11788
 11789     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11790
 11791     IF DATE-CONVERSION-ERROR
 11792        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 216
* EL050.cbl
 11793
 11794     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11795     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11796        AND (WS-LF-COVERAGE-TYPE = 'L')
 11797        IF (DC-ELAPSED-MONTHS > 1)
 11798                      OR
 11799           ((DC-ELAPSED-MONTHS = 1)
 11800           AND (DC-ODD-DAYS-OVER > 0))
 11801           MOVE ER-2882          TO WS-ERROR
 11802           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11803        END-IF
 11804     END-IF
 11805     IF PB-EXT-DAYS-PROCESSING
 11806        CONTINUE
 11807     ELSE
 11808        IF DC-ELAPSED-MONTHS = +0
 11809           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11810        ELSE
 11811           IF (WS-LF-EARNINGS-CALC = '4')
 11812              AND (DC-ELAPSED-MONTHS > ZERO)
 11813              AND (DC-ELAPSED-DAYS > ZERO)
 11814              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11815           ELSE
 11816              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11817                                 THRU 6499-EXIT
 11818              MOVE WS-ODD-DAYS-OVER
 11819                                 TO PB-I-EXTENTION-DAYS
 11820           END-IF
 11821        END-IF
 11822     END-IF
 11823******************************************************************
 11824*                                                                *
 11825*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11826*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11827*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11828*            AND ANY ODD DAYS.                                   *
 11829*                                                                *
 11830******************************************************************
 11831
 11832     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11833                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11834     IF WS-LF-EARNINGS-CALC NOT = '4'
 11835        IF DC-ELAPSED-DAYS > ZEROS
 11836           MOVE ER-2681          TO WS-ERROR
 11837           PERFORM 9900-ERROR-FORMAT
 11838                                 THRU 9900-EXIT
 11839        END-IF
 11840     END-IF
 11841
 11842     IF WS-LF-EARNINGS-CALC NOT = '4'
 11843        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11844           MOVE ER-2681          TO WS-ERROR
 11845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11846
 11847     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11848        (PB-I-LF-TERM NOT = ZERO) AND
 11849         NOT NO-LIFE-COVERAGE
 11850          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 217
* EL050.cbl
 11851          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11852          IF WS-LF-EARNINGS-CALC = '4'
 11853             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11854             PB-I-PAY-FREQUENCY
 11855          END-IF
 11856          MOVE ZERO              TO DC-ELAPSED-DAYS
 11857                                    DC-ODD-DAYS-OVER
 11858          MOVE 1                 TO DC-END-OF-MONTH
 11859          SET BIN-PLUS-ELAPSED        TO TRUE
 11860*         MOVE 6                 TO DC-OPTION-CODE
 11861          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11862          IF NO-CONVERSION-ERROR
 11863             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11864             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11865                (WS-LF-SPECIAL-CALC-CD = 'L')
 11866                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11867                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11868                  MOVE +1             TO DC-ELAPSED-MONTHS
 11869                  SET BIN-PLUS-ELAPSED  TO TRUE
 11870*                 MOVE 6              TO DC-OPTION-CODE
 11871                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11872                  IF NO-CONVERSION-ERROR
 11873                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11874
 11875* okay, i had to move the new att age edit down here because the
 11876* expiration date could get recalculated and i need the exp date
 11877     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11878        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11879        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11880        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11881           AND ZEROS
 11882           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11883           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11884           SET ELAPSED-BETWEEN-BIN TO TRUE
 11885           PERFORM 8500-DATE-CONVERT
 11886                                 THRU 8500-EXIT
 11887           IF NO-CONVERSION-ERROR
 11888              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11889                 MOVE ER-2669       TO WS-ERROR
 11890*                PERFORM 9900-ERROR-FORMAT
 11891*                                THRU 9900-EXIT
 11892              END-IF
 11893           END-IF
 11894        ELSE
 11895           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 11896           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11897              MOVE ER-2669       TO WS-ERROR
 11898*             PERFORM 9900-ERROR-FORMAT
 11899*                                THRU 9900-EXIT
 11900           ELSE
 11901              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11902                 MOVE ER-1570    TO WS-ERROR
 11903                 PERFORM 9900-ERROR-FORMAT
 11904                                 THRU 9900-EXIT
 11905              END-IF
 11906           END-IF
 11907        END-IF
 11908        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 218
* EL050.cbl
 11909           AND ZEROS
 11910           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11911           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11912           SET ELAPSED-BETWEEN-BIN TO TRUE
 11913           PERFORM 8500-DATE-CONVERT
 11914                                 THRU 8500-EXIT
 11915           IF NO-CONVERSION-ERROR
 11916              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11917                 MOVE ER-2669       TO WS-ERROR
 11918*                PERFORM 9900-ERROR-FORMAT
 11919*                                THRU 9900-EXIT
 11920              END-IF
 11921           END-IF
 11922        ELSE
 11923           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11924             (PB-I-LF-TERM / 12)
 11925           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11926              MOVE ER-2669       TO WS-ERROR
 11927*             PERFORM 9900-ERROR-FORMAT
 11928*                                THRU 9900-EXIT
 11929           ELSE
 11930              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11931                 MOVE ER-1571    TO WS-ERROR
 11932                 PERFORM 9900-ERROR-FORMAT
 11933                                 THRU 9900-EXIT
 11934              END-IF
 11935           END-IF
 11936        END-IF
 11937        IF WS-ERROR = ER-2669
 11938           PERFORM 9900-ERROR-FORMAT
 11939                                 THRU 9900-EXIT
 11940        END-IF
 11941     END-IF
 11942     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 11943        (PB-I-AH-TERM NOT = ZERO) AND
 11944         NOT NO-AH-COVERAGE
 11945          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 11946             AND (PB-COMPANY-ID = 'DCC')
 11947             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11948             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 11949          ELSE
 11950             IF WS-LF-EARNINGS-CALC = '4'
 11951                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 11952                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 11953                PB-I-PAY-FREQUENCY
 11954             ELSE
 11955                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 11956                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 11957             END-IF
 11958          END-IF
 11959          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11960                                         DC-ODD-DAYS-OVER
 11961          MOVE 1                      TO DC-END-OF-MONTH
 11962          SET BIN-PLUS-ELAPSED        TO TRUE
 11963*         MOVE 6                      TO DC-OPTION-CODE
 11964          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11965          IF NO-CONVERSION-ERROR
 11966             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 219
* EL050.cbl
 11967     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 11968        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 11969        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 11970        IF PB-I-BIRTHDAY > LOW-VALUES
 11971           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11972           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11973           SET ELAPSED-BETWEEN-BIN TO TRUE
 11974           PERFORM 8500-DATE-CONVERT
 11975                                 THRU 8500-EXIT
 11976           IF NO-CONVERSION-ERROR
 11977              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11978                 MOVE ER-3054       TO WS-ERROR
 11979*                PERFORM 9900-ERROR-FORMAT
 11980*                                THRU 9900-EXIT
 11981              END-IF
 11982           END-IF
 11983        ELSE
 11984           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 11985           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11986              MOVE ER-3054       TO WS-ERROR
 11987*             PERFORM 9900-ERROR-FORMAT
 11988*                                THRU 9900-EXIT
 11989           END-IF
 11990        END-IF
 11991        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11992           AND ZEROS
 11993           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11994           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11995           SET ELAPSED-BETWEEN-BIN TO TRUE
 11996           PERFORM 8500-DATE-CONVERT
 11997                                 THRU 8500-EXIT
 11998           IF NO-CONVERSION-ERROR
 11999              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12000                 MOVE ER-3054       TO WS-ERROR
 12001*                PERFORM 9900-ERROR-FORMAT
 12002*                                THRU 9900-EXIT
 12003              END-IF
 12004           END-IF
 12005        ELSE
 12006           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12007             (PB-I-AH-TERM / 12)
 12008           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12009              MOVE ER-3054       TO WS-ERROR
 12010*             PERFORM 9900-ERROR-FORMAT
 12011*                                THRU 9900-EXIT
 12012           END-IF
 12013        END-IF
 12014        IF WS-ERROR = ER-3054
 12015           PERFORM 9900-ERROR-FORMAT
 12016                                 THRU 9900-EXIT
 12017        END-IF
 12018     END-IF
 12019     MOVE SPACE                       TO DC-END-OF-MONTH.
 12020
 12021     IF PB-COMPANY-ID = 'NCB'
 12022        GO TO 3040-EDIT-EXTENSION-DAYS.
 12023
 12024     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 220
* EL050.cbl
 12025       AND
 12026        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12027        NEXT SENTENCE
 12028     ELSE
 12029        GO TO 3040-EDIT-EXTENSION-DAYS.
 12030
 12031     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12032        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12033        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12034     ELSE
 12035        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12036        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12037
 12038     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12039*    MOVE '1'      TO DC-OPTION-CODE
 12040     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12041     IF (NO-CONVERSION-ERROR)
 12042        AND (DC-ELAPSED-MONTHS > +1)
 12043        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12044        MOVE ER-2668   TO WS-ERROR
 12045        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12046
 12047 3040-EDIT-EXTENSION-DAYS.
 12048
 12049     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12050        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12051         GO TO 3050-EDIT-TERM-IN-DAYS
 12052     ELSE
 12053         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12054
 12055     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12056         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12057     ELSE
 12058        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12059           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12060           MOVE ER-2681         TO WS-ERROR
 12061           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12062
 12063     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12064        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12065        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12066         GO TO 3060-ORIG-TERM-CHECK.
 12067
 12068     GO TO 3060-ORIG-TERM-CHECK.
 12069
 12070 3050-EDIT-TERM-IN-DAYS.
 12071
 12072     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12073
 12074     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12075         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12076     ELSE
 12077         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12078            MOVE ER-2682         TO WS-ERROR
 12079            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12080
 12081     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12082                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 221
* EL050.cbl
 12083     IF WS-WORK-TERM GREATER THAN ZERO
 12084         ADD +1 TO PB-I-LF-TERM.
 12085
 12086     IF NOT NO-AH-COVERAGE
 12087         MOVE ER-2684            TO WS-ERROR
 12088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12089
 12090
 12091 3060-ORIG-TERM-CHECK.
 12092
 12093******************************************************************
 12094*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12095******************************************************************
 12096
 12097     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12098        NEXT SENTENCE
 12099     ELSE
 12100        IF NOT NO-LIFE-COVERAGE
 12101           IF PB-I-LF-TERM NUMERIC
 12102              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12103              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12104              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12105                  NEXT SENTENCE
 12106           ELSE
 12107              MOVE ER-2647       TO WS-ERROR
 12108              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12109
 12110     IF NOT NO-AH-COVERAGE
 12111         IF PB-I-AH-TERM NUMERIC
 12112            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12113            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12114            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12115             NEXT SENTENCE
 12116          ELSE
 12117              MOVE ER-2658       TO WS-ERROR
 12118              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12119
 12120     IF PB-COMPANY-ID = 'NCB'
 12121        GO TO 3070-LOAN-TERM-CHECK.
 12122
 12123     IF POLICY-HAS-AH
 12124       AND
 12125        POLICY-HAS-LIFE
 12126       AND
 12127        PB-I-LF-TERM NUMERIC
 12128       AND
 12129        PB-I-AH-TERM NUMERIC
 12130        NEXT SENTENCE
 12131     ELSE
 12132        GO TO 3070-LOAN-TERM-CHECK.
 12133
 12134     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12135     IF WS-TEX-FACT-2 LESS THAN +0
 12136        MULTIPLY +1 BY WS-TEX-FACT-2.
 12137
 12138     IF WS-TEX-FACT-2 GREATER THAN +1
 12139        MOVE ER-2668             TO WS-ERROR
 12140        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 222
* EL050.cbl
 12141
 12142 3070-LOAN-TERM-CHECK.
 12143
 12144     IF (WS-LF-BENEFIT-CD = ZERO)
 12145         OR (NO-LF-BENEFIT-MATCH)
 12146            GO TO 3125-EDIT-PMT-FREQ.
 12147*    IF PB-COMPANY-ID NOT = 'DCC'
 12148*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12149*          AND 'V' AND 'W' AND 'X'
 12150*          GO TO 3125-EDIT-PMT-FREQ
 12151*       END-IF
 12152*    ELSE
 12153*       IF WS-AH-DCC-TRUNC = 'T'
 12154*          CONTINUE
 12155*       ELSE
 12156*          GO TO 3125-EDIT-PMT-FREQ
 12157*       END-IF
 12158*    END-IF
 12159     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12160                    OR
 12161        ((PB-COMPANY-ID = 'DCC')
 12162        AND (WS-AH-DCC-TRUNC = 'T'))
 12163        CONTINUE
 12164     ELSE
 12165        GO TO 3125-EDIT-PMT-FREQ
 12166     END-IF
 12167     IF PB-I-LOAN-TERM NOT NUMERIC
 12168         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12169
 12170     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12171        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12172        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12173        PB-I-LOAN-TERM NOT GREATER THAN +360
 12174         NEXT SENTENCE
 12175     ELSE
 12176         MOVE ER-2648            TO WS-ERROR
 12177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12178
 12179     IF WS-STATE-ABBREVIATION = 'NC'
 12180        IF PB-I-LOAN-TERM > +59
 12181           CONTINUE
 12182        ELSE
 12183           MOVE ER-2792          TO WS-ERROR
 12184           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12185        END-IF
 12186     END-IF
 12187
 12188     .
 12189 3125-EDIT-PMT-FREQ.
 12190     IF (WS-LF-BENEFIT-CD = ZERO)
 12191         OR (NO-LF-BENEFIT-MATCH)
 12192            GO TO 3127-EDIT-LOAN-OFFICER.
 12193     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12194                    OR
 12195        ((PB-COMPANY-ID = 'DCC')
 12196        AND (WS-AH-DCC-TRUNC = 'T'))
 12197                    OR
 12198         (PB-COMPANY-ID = 'AHL')
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 223
* EL050.cbl
 12199        CONTINUE
 12200     ELSE
 12201        IF (PB-I-LOAN-TERM > ZEROS)
 12202           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12203           MOVE ER-1575          TO WS-ERROR
 12204           PERFORM 9900-ERROR-FORMAT
 12205                                 THRU 9900-EXIT
 12206        END-IF
 12207     END-IF
 12208     IF WS-LF-EARNINGS-CALC NOT = '4'
 12209         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12210            MOVE ER-2653         TO WS-ERROR
 12211            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12212            GO TO 3127-EDIT-LOAN-OFFICER
 12213         ELSE
 12214            GO TO 3127-EDIT-LOAN-OFFICER.
 12215
 12216     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12217         MOVE ER-2655            TO WS-ERROR
 12218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12219         GO TO 3127-EDIT-LOAN-OFFICER.
 12220
 12221     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12222         MOVE ER-2654            TO WS-ERROR
 12223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12224         GO TO 3127-EDIT-LOAN-OFFICER.
 12225
 12226     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12227         GIVING WS-TEX-FACT-2
 12228             REMAINDER WS-TEX-FACT-3.
 12229
 12230*    IF WS-TEX-FACT-3 NOT = ZERO
 12231*       MOVE ER-2654             TO WS-ERROR
 12232*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12233
 12234
 12235 3127-EDIT-LOAN-OFFICER.
 12236
 12237     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12238        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12239           MOVE ER-2690          TO WS-ERROR
 12240           PERFORM 9900-ERROR-FORMAT
 12241                                 THRU 9900-EXIT
 12242        ELSE
 12243           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12244           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12245           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12246           MOVE PB-SV-STATE      TO LOFC-STATE
 12247           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12248           MOVE PB-I-LOAN-OFFICER
 12249                                 TO LOFC-CODE
 12250           PERFORM 8586-READ-LOAN-OFFICER
 12251                                 THRU 8586-EXIT
 12252           IF (NOT LOFC-MASTER-FOUND)
 12253              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12254              MOVE ER-3006       TO WS-ERROR
 12255              PERFORM 9900-ERROR-FORMAT
 12256                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 224
* EL050.cbl
 12257           END-IF
 12258        END-IF
 12259     END-IF
 12260     .
 12261 3129-EDIT-APR.
 12262
 12263     IF (WS-LF-BENEFIT-CD = ZERO)
 12264        OR (NO-LF-BENEFIT-MATCH)
 12265        IF PB-COMPANY-ID NOT = 'DCC'
 12266           GO TO 3130-EDIT-AGE
 12267*       ELSE
 12268*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12269*             GO TO 3130-EDIT-AGE
 12270*          END-IF
 12271        END-IF
 12272     END-IF
 12273
 12274     IF (WS-STATE-ABBREVIATION = 'OH')
 12275         AND (PB-I-RATE-CLASS NOT = 'L ')
 12276         AND (PB-I-LF-TERM GREATER THAN 60)
 12277         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12278         GO TO 3129-APR-CONT.
 12279
 12280     IF (WS-STATE-ABBREVIATION = 'RI')
 12281         AND (PB-I-LF-TERM GREATER THAN 60)
 12282         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12283         GO TO 3129-APR-CONT.
 12284
 12285     IF (WS-STATE-ABBREVIATION = 'UT')
 12286         AND (PB-I-LF-TERM GREATER THAN 62)
 12287         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12288         AND (PB-CERT-EFF-DT LESS WS-830901)
 12289         GO TO 3129-APR-CONT.
 12290
 12291     IF PB-COMPANY-ID = 'LAP'
 12292        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12293           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12294              MOVE ER-2656         TO WS-ERROR
 12295              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12296              GO TO 3130-EDIT-AGE.
 12297
 12298     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12299        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12300        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12301        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12302         GO TO 3130-EDIT-AGE.
 12303
 12304 3129-APR-CONT.
 12305     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12306         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12307         GO TO 3130-EDIT-AGE.
 12308
 12309     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 12310        AND (PB-COMPANY-ID = 'DCC')
 12311        AND (PB-I-LOAN-APR = ZERO)
 12312        MOVE ER-2657             TO WS-ERROR
 12313        PERFORM 9900-ERROR-FORMAT
 12314                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 225
* EL050.cbl
 12315        GO TO 3130-EDIT-AGE
 12316     END-IF
 12317     IF PB-I-LOAN-APR = ZERO
 12318        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12319     END-IF
 12320
 12321     IF PB-I-LOAN-APR = ZERO
 12322        MOVE ER-2656             TO WS-ERROR
 12323        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12324        GO TO 3130-EDIT-AGE.
 12325
 12326*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12327     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12328        MOVE ER-2657             TO WS-ERROR
 12329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12330
 12331 3130-EDIT-AGE.
 12332
 12333******************************************************************
 12334*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12335******************************************************************
 12336
 12337     IF NOT NO-LIFE-COVERAGE
 12338        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12339           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12340               MOVE ER-2628             TO WS-ERROR
 12341               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12342
 12343     IF NOT NO-AH-COVERAGE
 12344        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12345           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12346               MOVE ER-2628         TO WS-ERROR
 12347               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12348
 12349 3133-SEX-CODE.
 12350     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12351         IF WS-DEFAULT-SEX = 'M'
 12352             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12353          ELSE
 12354             IF WS-DEFAULT-SEX = 'F'
 12355             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12356
 12357     IF PB-I-INSURED-SEX = '1'
 12358         MOVE 'M' TO PB-I-INSURED-SEX.
 12359
 12360     IF PB-I-INSURED-SEX = '2'
 12361         MOVE 'F' TO PB-I-INSURED-SEX.
 12362
 12363 3134-SIG-SW-EDIT.
 12364     IF PB-I-SIG-SW = SPACE
 12365         MOVE 'N'                TO  PB-I-SIG-SW.
 12366
 12367     IF PB-COMPANY-ID = 'NCL'
 12368         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12369             NEXT SENTENCE
 12370         ELSE
 12371             MOVE ER-1923        TO  WS-ERROR
 12372             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 226
* EL050.cbl
 12373     ELSE
 12374     IF PB-COMPANY-ID = 'CRI'
 12375         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12376             NEXT SENTENCE
 12377         ELSE
 12378             MOVE ER-2606        TO  WS-ERROR
 12379             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12380     ELSE
 12381     IF PB-COMPANY-ID = 'TMS'
 12382         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12383             NEXT SENTENCE
 12384         ELSE
 12385             MOVE ER-2689        TO  WS-ERROR
 12386             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12387     ELSE
 12388         IF PB-I-SIG-SW = 'Y' OR 'N'
 12389             NEXT SENTENCE
 12390         ELSE
 12391             MOVE ER-2651        TO  WS-ERROR
 12392             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12393
 12394     IF PB-COMPANY-ID = 'FLA'
 12395         IF (WS-EDIT-AGE GREATER 54  OR
 12396             WS-AH-EDIT-AGE GREATER 54)  AND
 12397            PB-I-SIG-SW = 'N'
 12398            MOVE ER-2651         TO  WS-ERROR
 12399            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12400
 12401 3135-NAME-EDIT.
 12402
 12403     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12404        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12405        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12406           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12407                                 TO PB-I-JOINT-FIRST-NAME
 12408        END-PERFORM
 12409     END-IF
 12410     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12411        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12412        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12413           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12414                                 TO PB-I-JOINT-LAST-NAME
 12415        END-PERFORM
 12416     END-IF
 12417     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12418        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12419        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12420           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12421                                 TO PB-I-INSURED-FIRST-NAME
 12422        END-PERFORM
 12423     END-IF
 12424     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12425        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12426        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12427           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12428                                 TO PB-I-INSURED-LAST-NAME
 12429        END-PERFORM
 12430     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 227
* EL050.cbl
 12431     IF PB-I-INSURED-LAST-NAME = SPACES
 12432       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12433       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12434           MOVE ER-2660    TO WS-ERROR
 12435           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12436
 12437 3136-EDIT-SEX.
 12438
 12439******************************************************************
 12440*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12441******************************************************************
 12442
 12443     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12444        (WS-AH-SPECIAL-CALC-CD = 'O')
 12445        NEXT SENTENCE
 12446     ELSE
 12447        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12448           NEXT SENTENCE
 12449        ELSE
 12450           MOVE ER-2629            TO WS-ERROR
 12451           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12452
 12453 3137-EDIT-EFF-DATE.
 12454
 12455     IF PB-REISSUED-CERT       OR
 12456        PB-POLICY-IS-DECLINED  OR
 12457        PB-POLICY-IS-VOIDED
 12458         GO TO 3139-EDIT-COVERAGE-CODES.
 12459
 12460     MOVE SPACE                  TO WS-2671-SW
 12461                                    WS-2672-SW.
 12462
 12463     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12464         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12465             MOVE ER-2703        TO WS-ERROR
 12466             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12467             GO TO 3139-EDIT-COVERAGE-CODES.
 12468
 12469     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12470         GO TO 3139-EDIT-COVERAGE-CODES.
 12471
 12472     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12473     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12474*    MOVE '1'                    TO DC-OPTION-CODE.
 12475     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12476     MOVE +0                     TO DC-ELAPSED-MONTHS
 12477                                    DC-ELAPSED-DAYS.
 12478     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12479
 12480     IF DATE-CONVERSION-ERROR
 12481         GO TO 3139-EDIT-COVERAGE-CODES.
 12482
 12483     IF DC-ELAPSED-DAYS GREATER +180
 12484         MOVE ER-2672            TO WS-ERROR
 12485         MOVE 'Y'                TO WS-2672-SW
 12486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12487     END-IF
 12488
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 228
* EL050.cbl
 12489     IF WS-ERROR = ER-2671  AND
 12490        PB-COMPANY-ID  = 'LBL'
 12491        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12492        MOVE SPACE               TO WS-2671-SW
 12493        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12494
 12495     IF PB-ISSUE-DATE-FORCED  AND
 12496      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12497         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12498         MOVE ER-2673            TO WS-ERROR
 12499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12500         MOVE SPACE              TO WS-2671-SW
 12501                                    WS-2672-SW.
 12502
 12503     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12504         IF PB-ISSUE-DATE-FORCED
 12505             MOVE ER-2600          TO  WS-ERROR
 12506             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12507         ELSE
 12508             MOVE ER-2692          TO  WS-ERROR
 12509             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12510
 12511
 12512 3139-EDIT-COVERAGE-CODES.
 12513
 12514     if pb-company-id not = 'AHL'
 12515        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12516           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12517           MOVE ER-2787          TO WS-ERROR
 12518           PERFORM 9900-ERROR-FORMAT
 12519                                 THRU 9900-EXIT
 12520        END-IF
 12521     end-if
 12522     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12523        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12524                                 > 250000.00
 12525           MOVE ER-2719          TO WS-ERROR
 12526           PERFORM 9900-ERROR-FORMAT
 12527                                 THRU 9900-EXIT
 12528        END-IF
 12529     END-IF
 12530
 12531     IF PB-POLICY-IS-DECLINED  OR
 12532        PB-POLICY-IS-VOIDED
 12533         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12534
 12535     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12536        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12537         MOVE ER-2630                TO WS-ERROR
 12538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12539
 12540     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12541        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12542        PB-I-LF-PREMIUM-AMT = ZERO
 12543         GO TO 3140-CHECK-AH-FOR-ZERO.
 12544
 12545     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12546        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 229
* EL050.cbl
 12547        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12548         GO TO 3140-CHECK-AH-FOR-ZERO.
 12549
 12550     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12551        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12552        MOVE ER-2631             TO WS-ERROR
 12553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12554     END-IF
 12555
 12556
 12557******************************************************************
 12558*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12559******************************************************************
 12560
 12561     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12562        NEXT SENTENCE
 12563     ELSE
 12564        IF PB-I-LF-BENEFIT-AMT = ZERO
 12565           MOVE ER-2632             TO WS-ERROR
 12566           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12567
 12568
 12569******************************************************************
 12570*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12571******************************************************************
 12572
 12573     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12574        CONTINUE
 12575     ELSE
 12576        IF PB-I-LF-PREMIUM-AMT = ZERO
 12577           IF (NOT PB-COMP-LF-PREM)
 12578              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12579              MOVE ER-2633       TO WS-ERROR
 12580              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12581           END-IF
 12582        END-IF
 12583     END-IF
 12584     .
 12585 3140-CHECK-AH-FOR-ZERO.
 12586
 12587     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12588        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12589        PB-I-AH-PREMIUM-AMT = ZERO
 12590         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12591
 12592     IF PB-COMPANY-ID = 'CSL'  AND
 12593        PB-I-AH-BENEFIT-CD = ZERO  AND
 12594        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12595        PB-I-AH-PREMIUM-AMT = ZERO
 12596         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12597
 12598     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12599        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12600        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12601         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12602
 12603     IF PB-I-AH-BENEFIT-CD = ZERO
 12604         MOVE ER-2634            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 230
* EL050.cbl
 12605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12606
 12607******************************************************************
 12608*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12609******************************************************************
 12610
 12611     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12612        NEXT SENTENCE
 12613     ELSE
 12614        IF PB-I-AH-BENEFIT-AMT = ZERO
 12615           MOVE ER-2635             TO WS-ERROR
 12616           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12617
 12618******************************************************************
 12619*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12620******************************************************************
 12621
 12622     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12623        NEXT SENTENCE
 12624     ELSE
 12625        IF PB-I-AH-PREMIUM-AMT = ZERO
 12626            IF NOT PB-COMP-AH-PREM
 12627                MOVE ER-2636    TO WS-ERROR
 12628                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12629
 12630
 12631 3140-EDIT-MAX-AMT-SIZES.
 12632* CUSTOM CODE FOR CLIENT    'DMD'
 12633     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12634                                     WS-RES-MUNI-TAX
 12635                                     PB-I-STATE-TAX
 12636                                     PB-I-MUNI-TAX.
 12637
 12638     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12639
 12640     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12641        GO TO 3150-RATE-OUTSTAND-BAL.
 12642
 12643     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12644        GO TO 3150-RATE-OUTSTAND-BAL.
 12645
 12646     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12647        GO TO 3150-RATE-OUTSTAND-BAL.
 12648
 12649     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12650                             OR 'RIC')
 12651        GO TO 3150-RATE-OUTSTAND-BAL.
 12652
 12653     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12654        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12655            GO TO 3150-RATE-OUTSTAND-BAL
 12656        ELSE
 12657           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12658               GO TO 3150-RATE-OUTSTAND-BAL.
 12659
 12660     IF NOT PB-NO-MONTHS-SKIPPED
 12661        GO TO 3150-RATE-OUTSTAND-BAL.
 12662
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 231
* EL050.cbl
 12663     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12664        GO TO 3150-RATE-OUTSTAND-BAL.
 12665
 12666     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12667        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12668           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12669             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12670           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12671           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12672              MOVE ER-2693     TO WS-ERROR
 12673              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12674              GO TO 3150-RATE-OUTSTAND-BAL
 12675           ELSE
 12676              GO TO 3150-RATE-OUTSTAND-BAL.
 12677
 12678 3150-RATE-OUTSTAND-BAL.
 12679
 12680* DMD RATING TEST
 12681     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12682         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12683         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12684         MOVE ER-2687                 TO WS-ERROR
 12685         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12686         MOVE 'B'                     TO PB-I-OB-FLAG
 12687         GO TO 3260-EDIT-CONTINUE.
 12688
 12689     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12690         IF  WS-ERROR    EQUAL    ER-2693
 12691             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12692                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12693                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12694                 MOVE  +0            TO  WS-ERROR.
 12695
 12696     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12697         IF  WS-ERROR    EQUAL    ER-2693
 12698             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12699                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12700                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12701                 MOVE  +0            TO  WS-ERROR.
 12702
 12703     IF PLAN-MASTER-AH-SW = 'Y'
 12704        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12705            IF  WS-ERROR    EQUAL    ER-2693
 12706              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12707                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12708                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12709                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12710                 MOVE  ER-1910           TO  WS-ERROR
 12711                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12712
 12713     IF PLAN-MASTER-AH-SW = 'Y'
 12714        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12715            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12716               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12717               MOVE  ER-1910           TO  WS-ERROR
 12718               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12719
 12720     IF PLAN-MASTER-AH-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 232
* EL050.cbl
 12721        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12722            IF  WS-ERROR    EQUAL    ER-2693
 12723                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12724                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12725                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12726                 MOVE  +0       TO  WS-ERROR.
 12727
 12728     IF WS-ERROR = ER-2693
 12729        IF PB-COMPANY-ID = 'JAL' AND
 12730           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12731           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12732           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12733
 12734     IF WS-ERROR = ER-2693
 12735        IF PB-COMPANY-ID = 'NCL'  AND
 12736           PB-I-AH-BENEFIT-CD = 'OA'
 12737           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12738           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12739
 12740     IF WS-ERROR = ER-2693
 12741        IF PB-COMPANY-ID = 'CNL' AND
 12742           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12743           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12744           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12745
 12746     IF WS-ERROR = ER-2693
 12747        IF PB-COMPANY-ID = 'HER'
 12748           IF WS-LEVEL
 12749              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12750              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12751
 12752     IF ((LF-BENEFIT-FOUND) AND
 12753         (NOT NO-LIFE-COVERAGE)  AND
 12754         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12755       OR   ((AH-BENEFIT-FOUND) AND
 12756             (NOT NO-AH-COVERAGE)    AND
 12757             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12758         NEXT SENTENCE
 12759     ELSE
 12760         GO TO 3215-EDIT-RATES.
 12761
 12762     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12763        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12764           MOVE ER-2674          TO WS-ERROR
 12765           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12766           GO TO 3215-EDIT-RATES.
 12767
 12768     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12769        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12770           MOVE ER-2674          TO WS-ERROR
 12771           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12772           GO TO 3215-EDIT-RATES.
 12773
 12774     MOVE 'B'                    TO PB-I-OB-FLAG.
 12775
 12776     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12777         NEXT SENTENCE
 12778     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 233
* EL050.cbl
 12779         IF NOT NO-LIFE-COVERAGE
 12780             IF WS-ACCT-LF-OB-RT = ZERO
 12781                MOVE ER-2641    TO WS-ERROR
 12782                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12783
 12784     IF PB-COMPANY-ID = 'CRI'
 12785       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12786         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12787         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12788         IF WS-ERROR = ER-2675
 12789            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12790            MOVE ER-2687              TO WS-ERROR
 12791            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12792         ELSE
 12793            MOVE ER-2687              TO WS-ERROR
 12794            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12795
 12796
 12797     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12798         NEXT SENTENCE
 12799     ELSE
 12800       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12801            NEXT SENTENCE
 12802       ELSE
 12803         IF NOT NO-AH-COVERAGE
 12804             IF WS-ACCT-AH-OB-RT = ZERO
 12805                MOVE ER-2642    TO WS-ERROR
 12806                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12807
 12808     IF PB-COMPANY-ID = 'CRI'
 12809       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12810         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12811         IF WS-ERROR = ER-2676
 12812            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12813            MOVE ER-2687              TO WS-ERROR
 12814            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12815         ELSE
 12816            MOVE ER-2687              TO WS-ERROR
 12817            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12818
 12819     IF PB-COMPANY-ID NOT = 'GIC'
 12820         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12821            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12822     ELSE
 12823         IF PB-I-LF-PREM-CALC = ZEROS
 12824             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12825                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12826
 12827     IF PB-COMPANY-ID NOT = 'GIC'
 12828         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12829            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12830     ELSE
 12831         IF PB-I-AH-PREM-CALC = ZEROS
 12832             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12833                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12834
 12835     MOVE ZEROS TO PB-I-MORT-CODE.
 12836
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 234
* EL050.cbl
 12837     GO TO 3260-EDIT-CONTINUE.
 12838
 12839
 12840 3215-EDIT-RATES.
 12841     IF ACCOUNT-MAST-FOUND
 12842         NEXT SENTENCE
 12843     ELSE
 12844         GO TO 3999-END-EDIT.
 12845
 12846 3220-CHECK-LF-RATES.
 12847
 12848     IF PB-COMPANY-ID = 'DCC'
 12849        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12850        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12851        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12852           AND (NOT WS-LF-CASH))
 12853                           OR
 12854           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12855           AND (NOT WS-AH-CASH)))
 12856                       AND
 12857           (PB-I-ENTRY-STATUS NOT = '5')
 12858           MOVE 'M'              TO PB-BATCH-ENTRY
 12859                                    PB-I-ENTRY-STATUS
 12860        END-IF
 12861     END-IF
 12862     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12863                                    PB-I-AH-PREM-CALC
 12864                                    PB-I-LF-ALT-PREM-CALC
 12865                                    PB-I-LF-ALT-RATE
 12866                                    PB-I-LF-REI-RATE
 12867                                    PB-I-LF-ALT-REI-RATE
 12868                                    PB-I-AH-REI-RATE
 12869                                    PB-I-TOT-FEES-CALC.
 12870
 12871     IF PB-COMPANY-ID EQUAL 'DMD'
 12872        NEXT SENTENCE
 12873     ELSE
 12874        MOVE ZEROS               TO PB-I-LF-RATE
 12875                                    PB-I-AH-RATE.
 12876
 12877     IF PB-I-TOT-FEES NOT NUMERIC
 12878        MOVE ZEROS               TO PB-I-TOT-FEES
 12879     END-IF
 12880     IF PB-I-LIVES NOT NUMERIC
 12881         MOVE ZERO               TO PB-I-LIVES.
 12882
 12883     IF PB-I-NUM-BILLED NOT NUMERIC
 12884         MOVE ZERO               TO PB-I-NUM-BILLED.
 12885
 12886     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12887        MOVE +0                  TO PB-I-LF-PREM-TAX
 12888     END-IF
 12889
 12890     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12891        MOVE +0                  TO PB-I-AH-PREM-TAX
 12892     END-IF
 12893
 12894     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 235
* EL050.cbl
 12895        PB-I-PAY-FREQUENCY = ZEROS
 12896            MOVE 12 TO CP-PAY-FREQUENCY
 12897     ELSE
 12898            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 12899
 12900     IF PB-I-STATE-TAX NOT NUMERIC
 12901         MOVE ZEROS               TO PB-I-STATE-TAX.
 12902
 12903     IF PB-I-MUNI-TAX NOT NUMERIC
 12904         MOVE ZEROS               TO PB-I-MUNI-TAX.
 12905
 12906     MOVE SPACES                 TO CP-BEN-CATEGORY
 12907     IF PB-COMPANY-ID  = 'CSL'  AND
 12908        PB-I-LF-TERM NOT = ZERO
 12909        COMPUTE WS-PAYMENT-AMT =
 12910             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 12911        COMPUTE WS-CSL-AMT1 =
 12912             PB-I-LF-TERM * AM-MAX-MON-BEN
 12913        COMPUTE WS-CSL-AMT2 =
 12914             WS-PAYMENT-AMT * PB-I-LF-TERM
 12915        IF CP-PAY-FREQUENCY NOT = 12
 12916           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 12917           MOVE '8' TO WS-CSL-CALC-CD
 12918        ELSE
 12919           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 12920              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 12921               AM-MAX-TOT-BEN
 12922               MOVE '6' TO WS-CSL-CALC-CD
 12923           ELSE
 12924              IF (WS-CSL-AMT1  GREATER THAN
 12925                 AM-MAX-TOT-BEN) AND
 12926                 (WS-CSL-AMT2  GREATER THAN
 12927                 AM-MAX-TOT-BEN)
 12928                 MOVE '7' TO WS-CSL-CALC-CD
 12929              ELSE
 12930                 MOVE '5' TO WS-CSL-CALC-CD.
 12931
 12932     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 12933         NEXT SENTENCE
 12934     ELSE
 12935         GO TO 3300-CHECK-AH-RATES.
 12936
 12937*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 12938
 12939     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12940        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 12941              OR
 12942           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 12943           MOVE ER-2618          TO WS-ERROR
 12944           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12945           GO TO 3300-CHECK-AH-RATES.
 12946
 12947     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12948           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 12949                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 12950
 12951     IF WS-LF-SPECIAL-CALC-CD = 'M'
 12952         MOVE ER-2687             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 236
* EL050.cbl
 12953         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12954         MOVE 'Z000'              TO PB-I-MORT-CODE
 12955         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 12956         GO TO 3300-CHECK-AH-RATES.
 12957
 12958     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 12959        IF PB-I-LIVES = ZERO
 12960           MOVE ER-2688          TO WS-ERROR
 12961           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12962
 12963     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 12964
 12965     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 12966     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 12967     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 12968     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 12969     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 12970     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 12971     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12972     MOVE '3'                    TO CP-PROCESS-TYPE.
 12973     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 12974     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 12975
 12976******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 12977     IF PB-COMPANY-ID EQUAL 'CDL'
 12978         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12979            CP-EARN-AS-NET-PAY)
 12980             IF PB-CERT-EFF-DT GREATER  WS-931231
 12981                 MOVE '1'        TO CP-EARNING-METHOD.
 12982*******
 12983
 12984     MOVE PB-SV-STATE            TO CP-STATE.
 12985     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 12986     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 12987     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 12988     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 12989     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 12990                                    CP-RATING-BENEFIT-AMT.
 12991     IF CP-STATE-STD-ABBRV = 'OR'
 12992         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 12993                                         PB-I-LF-ALT-BENEFIT-AMT.
 12994     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 12995     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 12996     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 12997     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12998     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 12999     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13000     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13001     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13002     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13003                                    CP-REMAINING-TERM
 13004                                    CP-LOAN-TERM.
 13005
 13006     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13007         NEXT SENTENCE
 13008     ELSE
 13009         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13010             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 237
* EL050.cbl
 13011                                           PB-I-LF-PREMIUM-AMT.
 13012
 13013     IF PB-COMPANY-ID EQUAL 'CSL'
 13014        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13015           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13016                                         PB-I-LF-PREMIUM-AMT.
 13017
 13018     IF PB-COMPANY-ID EQUAL 'NCB'
 13019         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13020            CP-EARN-AS-NET-PAY
 13021             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13022                 PB-I-LF-PREMIUM-AMT.
 13023
 13024     IF (CP-TRUNCATED-LIFE)
 13025        or ((pb-company-id = 'AHL')
 13026           and (pb-i-loan-term > pb-i-lf-term))
 13027        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13028
 13029     IF PB-COMPANY-ID EQUAL 'CRI'
 13030        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13031
 13032     IF CP-TERM-IS-DAYS
 13033         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13034     ELSE
 13035         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13036     IF PB-COMPANY-ID = 'DCC'
 13037        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13038        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13039        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13040        IF WS-LF-BEN-CATEGORY = 'D'
 13041           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13042           MOVE PB-I-LIFE-COMMISSION
 13043                                 TO CP-DCC-ACT-COMM
 13044           MOVE WS-LF-BEN-CATEGORY
 13045                                 TO CP-BEN-CATEGORY
 13046        END-IF
 13047        IF (CP-BENEFIT-CD (1:1) = 'P')
 13048           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13049           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13050        END-IF
 13051     END-IF
 13052     IF PB-COMPANY-ID = 'CSL'
 13053         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13054         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13055         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13056
 13057     IF PB-COMPANY-ID = 'CSL'
 13058        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13059
 13060     IF (CP-SPECIAL-CALC-CD = 'H')
 13061        OR (PB-COMPANY-ID = 'DCC')
 13062         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13063                                    TO CP-ALTERNATE-BENEFIT
 13064         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13065
 13066     IF (PB-COMPANY-ID = 'CID')
 13067        AND (WS-LF-EARNINGS-CALC = 'B')
 13068        AND (CP-STATE-STD-ABBRV = 'MN')
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 238
* EL050.cbl
 13069        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13070                                 TO CP-ALTERNATE-BENEFIT
 13071        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13072     END-IF
 13073     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13074     MOVE 'R'                   TO CP-RATE-FILE.
 13075     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13076
 13077     IF CP-ERROR-RATE-NOT-FOUND
 13078        MOVE ER-2641            TO WS-ERROR
 13079        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13080        GO TO 3300-CHECK-AH-RATES.
 13081
 13082     IF PB-COMPANY-ID EQUAL 'CRI'
 13083        IF CP-ERROR-NO-LIMITS-CRI
 13084           IF NOT ACCOUNT-LIFE-CHECKED
 13085              MOVE ER-2607      TO WS-ERROR
 13086              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13087
 13088******************************************************************
 13089*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13090*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13091******************************************************************
 13092
 13093* CALC LIFE AGE AT EXPIRATION.
 13094
 13095     COMPUTE WS-AGE-AT-EXPIRE =
 13096          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13097
 13098*    IF PB-STATE = 'CO' OR 'UT'
 13099*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13100*        MOVE 'F'            TO PB-FATAL-FLAG
 13101*        MOVE ER-2709        TO WS-ERROR
 13102*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13103*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13104
 13105*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13106*        MOVE 'X'            TO PB-FATAL-FLAG
 13107*        MOVE ER-2718        TO WS-ERROR
 13108*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13109*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13110
 13111* CALC A & H AGE AT EXPIRATION.
 13112
 13113     COMPUTE WS-AGE-AT-EXPIRE =
 13114          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13115
 13116*    IF PB-STATE = 'CO' OR 'UT'
 13117*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13118*        MOVE 'F'            TO PB-FATAL-FLAG
 13119*        MOVE ER-2709        TO WS-ERROR
 13120*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13121*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13122
 13123*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13124*        MOVE 'X'            TO PB-FATAL-FLAG
 13125*        MOVE ER-2718        TO WS-ERROR
 13126*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 239
* EL050.cbl
 13127*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13128
 13129     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13130        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13131
 13132     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13133        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13134
 13135     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13136        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13137
 13138     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13139         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13140         MOVE ER-2639        TO WS-ERROR
 13141         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13142
 13143
 13144******************************************************************
 13145*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13146******************************************************************
 13147
 13148 PREMIUM-EDITING-IS-BYPASSED.
 13149     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13150        AND (CP-R-MAX-ATT-AGE > +0)
 13151        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13152        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13153           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13154           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13155           MOVE '1'              TO DC-OPTION-CODE
 13156           PERFORM 8500-DATE-CONVERT
 13157                                 THRU 8500-EXIT
 13158           IF NO-CONVERSION-ERROR
 13159              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13160                 MOVE ER-2661       TO WS-ERROR
 13161*                PERFORM 9900-ERROR-FORMAT
 13162*                                THRU 9900-EXIT
 13163              END-IF
 13164           END-IF
 13165        ELSE
 13166           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13167           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13168              MOVE ER-2661       TO WS-ERROR
 13169*             PERFORM 9900-ERROR-FORMAT
 13170*                                THRU 9900-EXIT
 13171           ELSE
 13172              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13173                 MOVE ER-1570    TO WS-ERROR
 13174                 PERFORM 9900-ERROR-FORMAT
 13175                                 THRU 9900-EXIT
 13176              END-IF
 13177           END-IF
 13178        END-IF
 13179        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13180           MOVE PB-I-JOINT-BIRTHDAY
 13181                                 TO DC-BIN-DATE-1
 13182           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13183           MOVE '1'              TO DC-OPTION-CODE
 13184           PERFORM 8500-DATE-CONVERT
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 240
* EL050.cbl
 13185                                 THRU 8500-EXIT
 13186           IF NO-CONVERSION-ERROR
 13187              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13188                 MOVE ER-2661       TO WS-ERROR
 13189*                PERFORM 9900-ERROR-FORMAT
 13190*                                THRU 9900-EXIT
 13191              END-IF
 13192           ELSE
 13193              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13194           END-IF
 13195        ELSE
 13196           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13197             (PB-I-LF-TERM / 12)
 13198           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13199              MOVE ER-2661       TO WS-ERROR
 13200*             PERFORM 9900-ERROR-FORMAT
 13201*                                THRU 9900-EXIT
 13202           ELSE
 13203              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13204                 MOVE ER-1571    TO WS-ERROR
 13205                 PERFORM 9900-ERROR-FORMAT
 13206                                 THRU 9900-EXIT
 13207              END-IF
 13208           END-IF
 13209        END-IF
 13210        IF WS-ERROR = ER-2661
 13211           PERFORM 9900-ERROR-FORMAT
 13212                                 THRU 9900-EXIT
 13213        END-IF
 13214     END-IF
 13215*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13216*       MOVE ER-2661             TO WS-ERROR
 13217*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13218
 13219     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13220        MOVE ER-2662             TO WS-ERROR
 13221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13222
 13223     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13224        MOVE ER-2677             TO WS-ERROR
 13225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13226
 13227     IF CP-ERROR-LOAN-TERM
 13228        MOVE ER-2648             TO WS-ERROR
 13229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13230
 13231 3221-CHECK-ERROR-RATE-OPEN.
 13232
 13233     IF CP-ERROR-RATE-FILE-NOTOPEN
 13234         GO TO 3990-FILES-NOT-OPEN.
 13235
 13236     IF PB-COMPANY-ID NOT = 'DMD'
 13237        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13238     END-IF
 13239     .
 13240 3221-CONTINUE.
 13241     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13242                                    WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 241
* EL050.cbl
 13243     IF PB-COMPANY-ID = 'DCC'
 13244        IF WS-LF-BEN-CATEGORY = 'D'
 13245           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13246              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13247        END-IF
 13248     END-IF
 13249     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13250*   X'A4FF' = 12/31/2009
 13251     IF (PB-COMPANY-ID = 'CID')
 13252        AND (WS-LF-EARNINGS-CALC = 'B')
 13253        AND (CP-STATE-STD-ABBRV = 'MN')
 13254        AND (PB-CERT-EFF-DT > X'A4FF')
 13255        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13256     END-IF
 13257     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13258
 13259     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13260     IF (PB-COMPANY-ID = 'DCC')
 13261        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13262        AND (PB-I-POLICY-IS-MONTHLY)
 13263        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13264        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13265     END-IF
 13266     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13267     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13268     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13269     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13270     IF (PB-COMPANY-ID = 'DCC')
 13271        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13272        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13273        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13274        MOVE ER-2786             TO WS-ERROR
 13275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13276     END-IF
 13277
 13278     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13279
 13280******************************************************************
 13281*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13282******************************************************************
 13283     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13284        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13285
 13286     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13287        GO TO 3225-CHECK-ALT-LIFE-RATE
 13288     ELSE
 13289       IF PB-I-LF-RATE = ZERO
 13290          MOVE ER-2641          TO WS-ERROR
 13291          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13292
 13293 3225-CHECK-ALT-LIFE-RATE.
 13294
 13295     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13296        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13297        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13298         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13299
 13300     IF (WS-LF-EARNINGS-CALC NOT = 'B')
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 242
* EL050.cbl
 13301         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13302             AND PB-COMPANY-ID NOT = 'DCC')
 13303                   OR
 13304              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13305              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13306              AND PB-COMPANY-ID NOT = 'DCC')
 13307             MOVE ER-2720        TO  WS-ERROR
 13308             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13309             GO TO 3225-RATING-CONT
 13310         ELSE
 13311             GO TO 3225-RATING-CONT.
 13312     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13313        AND (AM-GPCD = 01 OR 06 OR 15)
 13314        MOVE ER-2798             TO WS-ERROR
 13315        PERFORM 9900-ERROR-FORMAT
 13316                                 THRU 9900-EXIT
 13317*       GO TO 3225-RATING-CONT
 13318     END-IF
 13319     IF (PB-COMPANY-ID = 'CID')
 13320        AND (WS-LF-EARNINGS-CALC = 'B')
 13321        AND (CP-STATE-STD-ABBRV = 'MN')
 13322        AND (PB-CERT-EFF-DT > X'A4FF')
 13323        GO TO 3225-RATING-CONT
 13324     END-IF
 13325     IF PB-COMPANY-ID = 'DCC'
 13326        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13327           AND (PB-I-POLICY-IS-MONTHLY)
 13328           GO TO 3225-RATING-CONT
 13329        END-IF
 13330     END-IF
 13331
 13332     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13333        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13334        CP-EARN-AS-REG-BALLOON
 13335        NEXT SENTENCE
 13336     ELSE
 13337        MOVE '2'                 TO CP-EARNING-METHOD.
 13338
 13339 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13340
 13341     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13342
 13343     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13344        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13345        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13346         NEXT SENTENCE
 13347     ELSE
 13348         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13349
 13350     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13351     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13352     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13353                                     CP-RATING-BENEFIT-AMT.
 13354     IF CP-STATE-STD-ABBRV = 'OR'
 13355         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13356                                         PB-I-LF-ALT-BENEFIT-AMT.
 13357     IF PB-COMPANY-ID = 'DCC'
 13358        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 243
* EL050.cbl
 13359     END-IF
 13360     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13361     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13362     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13363                                    CP-REMAINING-TERM
 13364                                    CP-LOAN-TERM.
 13365     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13366        ADD +1                   TO CP-ORIGINAL-TERM
 13367                                    CP-REMAINING-TERM
 13368                                    CP-LOAN-TERM.
 13369
 13370     MOVE 'R'                   TO CP-RATE-FILE.
 13371     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13372
 13373     IF CP-ERROR-RATE-NOT-FOUND
 13374         MOVE ER-2641            TO WS-ERROR
 13375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13376         GO TO 3300-CHECK-AH-RATES.
 13377
 13378     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13379     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13380
 13381     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13382         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13383
 13384     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13385                               + PB-I-LF-ALT-BENEFIT-AMT.
 13386
 13387     IF ACCOUNT-LIFE-CHECKED  OR
 13388        PB-POLICY-IS-VOIDED   OR
 13389        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13390        GO TO 3225-CONTINUE.
 13391
 13392     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13393        GO TO 3225-CONTINUE.
 13394
 13395     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13396                             EC-RT-LF-MAX-TOT-BEN
 13397        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13398        MOVE ER-2639       TO WS-ERROR
 13399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13400
 13401 3225-CONTINUE.
 13402     IF PB-I-LF-ALT-RATE = ZERO
 13403         MOVE ER-2659            TO WS-ERROR
 13404         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13405
 13406     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13407        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13408        MOVE ER-2698             TO WS-ERROR
 13409        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13410
 13411 3225-RATING-CONT.
 13412
 13413     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13414         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13415         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13416         MOVE ER-2687             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 244
* EL050.cbl
 13417         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13418         GO TO 3290-EDIT-LF-REIN-RATE.
 13419
 13420* DMD RATING TEST
 13421     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13422         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13423         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13424         MOVE ER-2687                 TO WS-ERROR
 13425         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13426         GO TO 3290-EDIT-LF-REIN-RATE.
 13427
 13428 3230-CLIENT-MORT-CD-SPECIALS.
 13429
 13430     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13431     SET BIN-TO-GREG          TO TRUE.
 13432*    MOVE ' '                 TO DC-OPTION-CODE.
 13433     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13434     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13435
 13436 C-POS-3230-MORT-CD.
 13437     IF PB-COMPANY-ID = 'POS' AND
 13438        PB-SV-CARRIER = '2'
 13439         NEXT SENTENCE
 13440     ELSE
 13441         GO TO C-POS-3240-MORT-CD.
 13442
 13443     IF PB-SV-GROUPING = '030'
 13444        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13445         MOVE '2350' TO PB-I-MORT-CODE
 13446      ELSE
 13447         MOVE '3300' TO PB-I-MORT-CODE.
 13448
 13449
 13450 C-POS-3240-MORT-CD.
 13451     IF PB-COMPANY-ID = 'POS' AND
 13452        PB-SV-CARRIER = '1'
 13453         NEXT SENTENCE
 13454     ELSE
 13455         GO TO 3230-CONTINUE.
 13456
 13457     IF PB-SV-STATE = '45' OR '47'
 13458        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13459         MOVE '5200' TO PB-I-MORT-CODE
 13460     ELSE
 13461         MOVE '8300' TO PB-I-MORT-CODE.
 13462
 13463 3230-CONTINUE.
 13464
 13465     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13466        GO TO 3240-CONTINUE
 13467     END-IF
 13468
 13469     IF PB-CERT-EFF-DT > WS-971231
 13470        GO TO 3240-CONTINUE
 13471     END-IF
 13472
 13473     IF LF-BENEFIT-FOUND AND
 13474        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 245
* EL050.cbl
 13475         MOVE 'F250'       TO PB-I-MORT-CODE
 13476     ELSE
 13477         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13478             MOVE '7250'   TO PB-I-MORT-CODE
 13479         ELSE
 13480             MOVE '4251'   TO PB-I-MORT-CODE
 13481         END-IF
 13482     END-IF
 13483
 13484     .
 13485 3240-CONTINUE.
 13486
 13487     IF PB-COMPANY-ID NOT = 'GNL'
 13488         GO TO 3256-CONTINUE.
 13489
 13490     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13491         MOVE 'A300' TO PB-I-MORT-CODE
 13492     ELSE
 13493         MOVE '8350' TO PB-I-MORT-CODE.
 13494
 13495 3256-CONTINUE.
 13496     IF PB-COMPANY-ID NOT = 'ABL'
 13497         GO TO 3260-EDIT-CONTINUE.
 13498
 13499     IF PB-I-LF-TERM GREATER THAN 59
 13500         MOVE 'F550' TO PB-I-MORT-CODE
 13501     ELSE
 13502         MOVE 'E550' TO PB-I-MORT-CODE.
 13503
 13504 3260-EDIT-CONTINUE.
 13505     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13506
 13507 3290-EDIT-LF-REIN-RATE.
 13508     IF LF-REIN-NSP-NOT-USED
 13509         GO TO 3290-RATING-CONT.
 13510
 13511     IF PB-COMPANY-ID = 'DCC'
 13512        GO TO 3290-RATING-CONT.
 13513     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13514     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13515     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13516     MOVE '3'                   TO CP-PROCESS-TYPE.
 13517     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13518
 13519******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13520     IF PB-COMPANY-ID EQUAL 'CDL'
 13521         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13522            CP-EARN-AS-NET-PAY)
 13523             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13524*            MOVE SPACE          TO DC-OPTION-CODE
 13525             SET BIN-TO-GREG     TO TRUE
 13526             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13527***  Y2K PROJ 7744
 13528             IF DC-GREG-DATE-CYMD GREATER 19931231
 13529                 MOVE '1'        TO CP-EARNING-METHOD.
 13530***  Y2K PROJ 7744
 13531*******
 13532
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 246
* EL050.cbl
 13533     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13534     MOVE PB-SV-STATE           TO CP-STATE.
 13535     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13536     MOVE ZERO                  TO CP-DEVIATION-CODE
 13537                                   CP-RATE-DEV-PCT.
 13538     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13539     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13540                                   CP-RATING-BENEFIT-AMT.
 13541
 13542************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13543     IF PB-COMPANY-ID EQUAL 'NCB'
 13544         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13545            CP-EARN-AS-NET-PAY
 13546             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13547                 PB-I-LF-PREMIUM-AMT.
 13548************
 13549
 13550     IF CP-STATE-STD-ABBRV = 'OR'
 13551         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13552                                         PB-I-LF-ALT-BENEFIT-AMT.
 13553     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13554     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13555     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13556     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13557     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13558     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13559     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13560     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13561                                   CP-REMAINING-TERM
 13562                                   CP-LOAN-TERM.
 13563     IF CP-TRUNCATED-LIFE
 13564        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13565
 13566     IF CP-TERM-IS-DAYS
 13567         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13568     ELSE
 13569         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13570
 13571     IF PB-COMPANY-ID = 'DCC'
 13572        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13573     END-IF
 13574     IF PB-COMPANY-ID NOT = 'TIC'
 13575          MOVE ZERO          TO CP-CLASS-CODE.
 13576
 13577     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13578
 13579     MOVE 'R'                   TO CP-RATE-FILE.
 13580     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13581
 13582     IF CP-ERROR-RATE-NOT-FOUND
 13583        IF PB-I-OB
 13584           MOVE ER-2625      TO WS-ERROR
 13585           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13586           GO TO 3299-EDIT-CONTINUE
 13587        ELSE
 13588           MOVE ER-2643      TO WS-ERROR
 13589           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13590           GO TO 3299-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 247
* EL050.cbl
 13591
 13592     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13593
 13594     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13595     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13596
 13597     IF PB-I-LF-REI-RATE = ZERO
 13598         MOVE ER-2643        TO WS-ERROR
 13599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13600
 13601 3290-CHECK-ALT-REIN-RATE.
 13602
 13603     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13604        GO TO 3290-RATING-CONT.
 13605
 13606     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13607     MOVE '2'                    TO CP-EARNING-METHOD.
 13608     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13609     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13610     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13611     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13612                                     CP-RATING-BENEFIT-AMT.
 13613     IF CP-STATE-STD-ABBRV = 'OR'
 13614         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13615                                         PB-I-LF-ALT-BENEFIT-AMT.
 13616     IF PB-COMPANY-ID = 'DCC'
 13617        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13618     END-IF
 13619     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13620     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13621     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13622                                    CP-REMAINING-TERM
 13623                                    CP-LOAN-TERM.
 13624     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13625        ADD +1                   TO CP-ORIGINAL-TERM
 13626                                    CP-REMAINING-TERM
 13627                                    CP-LOAN-TERM.
 13628
 13629     MOVE 'R'                   TO CP-RATE-FILE.
 13630     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13631
 13632     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13633
 13634     IF PB-I-LF-ALT-REI-RATE = ZERO
 13635         MOVE ER-2643            TO WS-ERROR
 13636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13637
 13638 3290-RATING-CONT.
 13639
 13640     IF PB-I-OB
 13641*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13642        GO TO 3300-CHECK-AH-RATES.
 13643
 13644 3299-EDIT-CONTINUE.
 13645
 13646     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13647         NEXT SENTENCE
 13648     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 248
* EL050.cbl
 13649         MOVE ER-2620           TO WS-ERROR
 13650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13651
 13652 3300-CHECK-AH-RATES.
 13653     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13654         NEXT SENTENCE
 13655     ELSE
 13656         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13657
 13658     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13659        ((CF-COMPANY-ID = 'DMD') AND
 13660                (NO-DMD-RATING))
 13661         MOVE ER-2687             TO WS-ERROR
 13662         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13663         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13664         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13665
 13666     IF PB-I-OB
 13667        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13668
 13669     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13670         MOVE ER-2687             TO WS-ERROR
 13671         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13672         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13673         GO TO 3999-END-EDIT.
 13674
 13675*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13676
 13677     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13678        IF PB-I-AH-CRIT-PER = ZERO
 13679           IF PB-COMPANY-ID = 'DCC'
 13680              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13681              CONTINUE
 13682           ELSE
 13683              MOVE ER-2618       TO WS-ERROR
 13684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13685              GO TO 3999-END-EDIT
 13686           END-IF
 13687        END-IF
 13688     END-IF
 13689     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13690     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13691     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13692     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13693     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13694     MOVE PB-SV-STATE            TO CP-STATE.
 13695     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13696     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13697     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13698*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13699     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13700     MOVE '3'                    TO CP-PROCESS-TYPE.
 13701     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13702     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13703                                    CP-RATING-BENEFIT-AMT.
 13704     IF PB-COMPANY-ID = 'CID'
 13705               OR
 13706        CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 249
* EL050.cbl
 13707         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13708                                         PB-I-AH-TERM.
 13709     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13710        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13711           AND (PB-I-POLICY-IS-MONTHLY)
 13712           MOVE PB-I-LF-BENEFIT-AMT
 13713                                 TO CP-NET-BENEFIT-AMT
 13714           move pb-i-ah-premium-amt to cp-original-premium
 13715        END-IF
 13716     END-IF
 13717     MOVE SPACES                 TO CP-BEN-CATEGORY
 13718     IF PB-COMPANY-ID = 'DCC'
 13719        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13720        EVALUATE TRUE
 13721           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13722              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13723              MOVE PB-I-LF-BENEFIT-AMT
 13724                                 TO CP-RATING-BENEFIT-AMT
 13725              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13726           WHEN WS-AH-BEN-CATEGORY = 'G'
 13727              MOVE PB-I-UNPAID-CASH-PRICE
 13728                                 TO CP-RATING-BENEFIT-AMT
 13729           WHEN WS-AH-BEN-CATEGORY = 'D'
 13730              MOVE WS-AH-PMF-COMM
 13731                                 TO CP-DCC-PMF-COMM
 13732              MOVE PB-I-AH-COMMISSION
 13733                                 TO CP-DCC-ACT-COMM
 13734        END-EVALUATE
 13735     END-IF
 13736     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13737     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13738     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13739     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13740     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13741     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13742     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13743                                    CP-REMAINING-TERM
 13744                                    WS-WORK-TERM.
 13745     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13746
 13747     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13748     SET BIN-TO-GREG             TO TRUE.
 13749*    MOVE ' '                    TO DC-OPTION-CODE.
 13750     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13751     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13752
 13753     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13754     IF NOT VALID-SKIP-CODE
 13755         MOVE ER-2683            TO WS-ERROR
 13756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13757         GO TO 3320-RATE-CONTINUE.
 13758
 13759     IF PB-NO-MONTHS-SKIPPED
 13760         GO TO 3320-RATE-CONTINUE.
 13761
 13762     MOVE SPACE TO NUMBER-OF-MONTHS.
 13763
 13764     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 250
* EL050.cbl
 13765         MOVE 'S'                TO SK-MO (6).
 13766     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13767         MOVE 'S'                TO SK-MO (7).
 13768     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13769         MOVE 'S'                TO SK-MO (8).
 13770     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13771         MOVE 'S'                TO SK-MO (9).
 13772     IF PB-I-SKIP-CODE = 'A'
 13773         MOVE 'S'                TO SK-MO (10).
 13774
 13775     MOVE 1                      TO SUB2.
 13776     MOVE PB-I-AH-TERM           TO SUB3.
 13777     MOVE WS-MONTH               TO SUB1.
 13778     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13779     GO TO 3320-RATE-CONTINUE.
 13780
 13781 3310-GET-SKIP-MO.
 13782     IF SUB1 = 13
 13783         MOVE 1                  TO SUB1.
 13784
 13785     IF SK-MO (SUB1) = 'S'
 13786         SUBTRACT 1 FROM WS-WORK-TERM.
 13787
 13788     ADD 1 TO SUB2
 13789              SUB1.
 13790
 13791 3320-RATE-CONTINUE.
 13792
 13793     IF WS-WORK-TERM = ZERO
 13794         MOVE 1                  TO WS-WORK-TERM.
 13795
 13796     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13797                                    CP-LOAN-TERM.
 13798
 13799     IF PB-COMPANY-ID EQUAL 'DMD'
 13800         NEXT SENTENCE
 13801     ELSE
 13802         MOVE ZERO               TO PB-I-AH-RATE
 13803                                    PB-I-AH-REI-RATE.
 13804
 13805
 13806     IF PB-COMPANY-ID EQUAL 'CRI'
 13807        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13808
 13809     IF PB-COMPANY-ID = 'CSL'
 13810         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13811         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13812         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13813         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13814
 13815     IF PB-COMPANY-ID = 'DCC'
 13816        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13817           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13818              PB-I-RATE-DEV-PCT-LF
 13819        END-IF
 13820        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13821                                 TO CP-ALTERNATE-BENEFIT
 13822        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 251
* EL050.cbl
 13823        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13824        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13825     END-IF
 13826     IF (PB-COMPANY-ID = 'CID')
 13827        AND (WS-LF-EARNINGS-CALC = 'B')
 13828        AND (CP-STATE-STD-ABBRV = 'MN')
 13829        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13830     ELSE
 13831        MOVE ' '                 TO CP-AH-BALLOON-SW
 13832     END-IF
 13833     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13834     MOVE 'R'                   TO CP-RATE-FILE.
 13835     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13836
 13837     IF CP-ERROR-RATE-NOT-FOUND
 13838        IF PB-I-OB
 13839           MOVE ER-2624          TO WS-ERROR
 13840           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13841           GO TO 3340-CALCULATE-PREMIUM-AMT
 13842        ELSE
 13843          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13844              NEXT SENTENCE
 13845          ELSE
 13846           MOVE ER-2642          TO WS-ERROR
 13847           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13848           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13849
 13850     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13851        CP-ERROR-DIV-BY-ZERO
 13852           MOVE ER-3782          TO WS-ERROR
 13853           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13854
 13855     IF PB-COMPANY-ID EQUAL 'CRI'
 13856        IF CP-ERROR-NO-LIMITS-CRI
 13857           IF NOT ACCOUNT-AH-CHECKED
 13858              MOVE ER-2607          TO WS-ERROR
 13859              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13860
 13861     IF ACCOUNT-AH-CHECKED
 13862        NEXT SENTENCE
 13863     ELSE
 13864       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13865          MOVE ER-2640           TO WS-ERROR
 13866          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13867
 13868     IF PB-COMPANY-ID = 'CRI'
 13869         IF WS-ERROR = ER-2640
 13870             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13871     IF ACCOUNT-AH-CHECKED
 13872        CONTINUE
 13873     ELSE
 13874        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13875           AND (CP-R-MAX-ATT-AGE > +0)
 13876           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13877           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13878              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13879              MOVE PB-I-AH-EXPIRE-DT
 13880                                 TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 252
* EL050.cbl
 13881              MOVE '1'           TO DC-OPTION-CODE
 13882              PERFORM 8500-DATE-CONVERT
 13883                                 THRU 8500-EXIT
 13884              IF NO-CONVERSION-ERROR
 13885                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13886                    MOVE ER-2661       TO WS-ERROR
 13887*                   PERFORM 9900-ERROR-FORMAT
 13888*                                THRU 9900-EXIT
 13889                 END-IF
 13890              END-IF
 13891           ELSE
 13892              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 13893              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13894                 MOVE ER-2661    TO WS-ERROR
 13895*                PERFORM 9900-ERROR-FORMAT
 13896*                                THRU 9900-EXIT
 13897              ELSE
 13898                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13899                    MOVE ER-1570 TO WS-ERROR
 13900                    PERFORM 9900-ERROR-FORMAT
 13901                                 THRU 9900-EXIT
 13902                 END-IF
 13903              END-IF
 13904           END-IF
 13905           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13906              MOVE PB-I-JOINT-BIRTHDAY
 13907                                    TO DC-BIN-DATE-1
 13908              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13909              MOVE '1'              TO DC-OPTION-CODE
 13910              PERFORM 8500-DATE-CONVERT
 13911                                    THRU 8500-EXIT
 13912              IF NO-CONVERSION-ERROR
 13913                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13914                    MOVE ER-2661       TO WS-ERROR
 13915*                   PERFORM 9900-ERROR-FORMAT
 13916*                                   THRU 9900-EXIT
 13917                 END-IF
 13918              END-IF
 13919           ELSE
 13920              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13921                (PB-I-AH-TERM / 12)
 13922              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13923                 MOVE ER-2661       TO WS-ERROR
 13924*                PERFORM 9900-ERROR-FORMAT
 13925*                                   THRU 9900-EXIT
 13926              ELSE
 13927                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13928                    MOVE ER-1571 TO WS-ERROR
 13929                    PERFORM 9900-ERROR-FORMAT
 13930                                 THRU 9900-EXIT
 13931                 END-IF
 13932              END-IF
 13933           END-IF
 13934           IF WS-ERROR = ER-2661
 13935              PERFORM 9900-ERROR-FORMAT
 13936                                    THRU 9900-EXIT
 13937           END-IF
 13938        END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 253
* EL050.cbl
 13939     END-IF
 13940*    IF ACCOUNT-AH-CHECKED
 13941*       NEXT SENTENCE
 13942*    ELSE
 13943*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13944*          MOVE ER-2661          TO WS-ERROR
 13945*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13946
 13947     IF ACCOUNT-AH-CHECKED
 13948        NEXT SENTENCE
 13949     ELSE
 13950        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13951           MOVE ER-2663          TO WS-ERROR
 13952           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13953
 13954     IF ACCOUNT-AH-CHECKED OR
 13955        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 13956         PB-POLICY-IS-VOIDED
 13957        NEXT SENTENCE
 13958     ELSE
 13959        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 13960           MOVE ER-2667            TO WS-ERROR
 13961           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13962
 13963     IF PB-COMPANY-ID = 'CRI'
 13964         IF WS-ERROR = ER-2667
 13965             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13966
 13967     IF ACCOUNT-AH-CHECKED
 13968        NEXT SENTENCE
 13969     ELSE
 13970        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13971           MOVE ER-2678            TO WS-ERROR
 13972           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13973
 13974     IF CP-ERROR-RATE-FILE-NOTOPEN
 13975         GO TO 3990-FILES-NOT-OPEN.
 13976
 13977 3321-CONTINUE.
 13978     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 13979     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 13980     IF (PB-COMPANY-ID = 'DCC')
 13981        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 13982        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 13983                                    PB-I-LF-ALT-PREM-CALC
 13984        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13985        IF WS-AH-BEN-CATEGORY = 'G'
 13986           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13987           + PB-I-ADDL-CLP)
 13988           * (1 + WS-TOL-CLP-PCT)
 13989*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 13990        ELSE
 13991           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13992           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 13993*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 13994        END-IF
 13995        MOVE WS-TOL-LF-HIGH-PREM-AMT
 13996                                 TO PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 254
* EL050.cbl
 13997        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 13998           MOVE ER-8152          TO WS-ERROR
 13999           PERFORM 9900-ERROR-FORMAT
 14000                                 THRU 9900-EXIT
 14001        ELSE
 14002           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14003                 PB-I-ADDL-CLP)
 14004              MOVE ER-8148       TO WS-ERROR
 14005              PERFORM 9900-ERROR-FORMAT
 14006                                 THRU 9900-EXIT
 14007           END-IF
 14008        END-IF
 14009     END-IF
 14010     IF (PB-COMPANY-ID = 'DCC')
 14011        AND (PB-I-POLICY-IS-MONTHLY)
 14012        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14013        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14014        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14015           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14016        END-IF
 14017     END-IF
 14018     IF (PB-COMPANY-ID = 'DCC')
 14019        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14020        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14021        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14022        MOVE ER-2786             TO WS-ERROR
 14023        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14024     END-IF
 14025     MOVE +0                     TO PB-I-AH-CLP
 14026     IF PB-COMPANY-ID = 'DCC'
 14027        IF WS-AH-BEN-CATEGORY = 'D'
 14028           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14029              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14030        ELSE
 14031           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14032              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14033           END-IF
 14034        END-IF
 14035     END-IF
 14036     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14037
 14038     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14039         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14040
 14041     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14042         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14043
 14044     IF PB-COMPANY-ID = 'CRI'
 14045         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14046            PB-I-PAYMENT-AMOUNT = ZERO
 14047             NEXT SENTENCE
 14048         ELSE
 14049             COMPUTE PB-I-AH-PREM-CALC =
 14050                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14051                 (CP-PREMIUM-RATE / 100)
 14052             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14053                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14054                                             PB-I-RATE-DEV-PCT-AH.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 255
* EL050.cbl
 14055
 14056     IF PB-I-AH-RATE  = ZERO
 14057       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14058           NEXT SENTENCE
 14059       ELSE
 14060         MOVE ER-2642            TO WS-ERROR
 14061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14062
 14063     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14064     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14065     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14066     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14067     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14068     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14069
 14070     IF (PB-COMPANY-ID = 'DCC')
 14071        AND (WS-AH-BEN-CATEGORY = 'G')
 14072        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14073        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14074        IF CP-DEVIATION-CODE NOT = '000'
 14075           MOVE '000'            TO CP-DEVIATION-CODE
 14076           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14077           IF NO-CP-ERROR
 14078              COMPUTE PB-I-DDF-IU-RATE-UP =
 14079              PB-I-AH-CLP - CP-CALC-PREMIUM
 14080           ELSE
 14081              MOVE ER-3057        TO WS-ERROR
 14082              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14083           END-IF
 14084        END-IF
 14085     END-IF
 14086     .
 14087 3335-EDIT-AH-REIN-NSP-RATE.
 14088     IF AH-REIN-NSP-NOT-USED
 14089         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14090
 14091     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14092     IF PB-COMPANY-ID = 'DCC'
 14093         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14094     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14095     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14096     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14097     MOVE PB-SV-STATE            TO CP-STATE.
 14098     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14099     MOVE ZERO                   TO CP-DEVIATION-CODE
 14100                                    CP-RATE-DEV-PCT.
 14101*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14102     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14103     MOVE '3'                    TO CP-PROCESS-TYPE.
 14104     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14105     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14106                                    CP-RATING-BENEFIT-AMT.
 14107     IF CP-STATE-STD-ABBRV = 'OR'
 14108         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14109                                         PB-I-AH-TERM.
 14110     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14111     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14112     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 256
* EL050.cbl
 14113     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14114     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14115     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14116                                    CP-REMAINING-TERM
 14117                                    WS-WORK-TERM.
 14118     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14119     IF PB-COMPANY-ID = 'DCC'
 14120        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14121     END-IF
 14122     IF  PB-COMPANY-ID = 'TIC'
 14123         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14124            MOVE ZERO TO CP-CLASS-CODE.
 14125
 14126     IF PB-COMPANY-ID NOT = 'TIC'
 14127          MOVE ZERO          TO CP-CLASS-CODE.
 14128
 14129     MOVE ZERO               TO CP-DEVIATION-CODE.
 14130
 14131     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14132
 14133     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14134
 14135     MOVE 'R'                   TO CP-RATE-FILE.
 14136     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14137
 14138     IF CP-ERROR-RATE-NOT-FOUND
 14139         MOVE ER-2645        TO WS-ERROR
 14140         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14141         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14142
 14143     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14144
 14145     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14146     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14147
 14148     IF PB-I-AH-REI-RATE = ZERO
 14149         MOVE ER-2645        TO WS-ERROR
 14150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14151
 14152
 14153 3340-CALCULATE-PREMIUM-AMT.
 14154
 14155     IF PB-COMPANY-ID = 'NCL'
 14156         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14157             WS-AH-SPECIAL-CALC-CD = 'O')
 14158             GO TO 3999-END-EDIT.
 14159
 14160     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14161                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14162                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14163                         OR 'AHL'
 14164         NEXT SENTENCE
 14165     ELSE
 14166         IF WS-STATE-ABBREVIATION = 'CT'
 14167             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14168                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14169                 COMPUTE PB-I-LF-PREM-CALC =
 14170                                     PB-I-LF-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 257
* EL050.cbl
 14171                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14172                                     PB-I-LF-ALT-PREM-CALC * .90
 14173                 COMPUTE PB-I-AH-PREM-CALC =
 14174                                     PB-I-AH-PREM-CALC * .90.
 14175
 14176     IF PB-COMP-LF-PREM
 14177        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14178        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14179
 14180     IF PB-COMP-AH-PREM
 14181        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14182
 14183 3340-CHECK-DCC-TOT-FEES.
 14184     IF (PB-COMPANY-ID = 'DCC')
 14185        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14186        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14187        AND (PB-I-POLICY-IS-MONTHLY)
 14188        CONTINUE
 14189     ELSE
 14190        GO TO 3340-EDIT-LF-AH-TOL
 14191     END-IF
 14192     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14193     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14194     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14195        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14196           PB-I-RATE-DEV-PCT-LF
 14197     END-IF
 14198     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14199        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14200           PB-I-RATE-DEV-PCT-AH
 14201     END-IF
 14202     MOVE 'N'                    TO CP-BEN-CATEGORY
 14203     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14204
 14205     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14206     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14207     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14208     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14209     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14210     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14211     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14212     MOVE '3'                    TO CP-PROCESS-TYPE.
 14213     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14214     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14215
 14216     MOVE PB-SV-STATE            TO CP-STATE.
 14217     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14218     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14219     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14220     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14221     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14222                                    CP-RATING-BENEFIT-AMT.
 14223     IF CP-STATE-STD-ABBRV = 'OR'
 14224         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14225                                         PB-I-LF-ALT-BENEFIT-AMT.
 14226     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14227     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14228     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 258
* EL050.cbl
 14229     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14230     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14231     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14232     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14233     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14234     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14235                                    CP-REMAINING-TERM
 14236                                    CP-LOAN-TERM.
 14237
 14238     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14239         NEXT SENTENCE
 14240     ELSE
 14241         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14242             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14243                                           PB-I-LF-PREMIUM-AMT.
 14244
 14245     IF CP-TRUNCATED-LIFE
 14246        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14247
 14248     IF CP-TERM-IS-DAYS
 14249         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14250     ELSE
 14251         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14252
 14253     IF PB-COMPANY-ID = 'DCC'
 14254        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14255     END-IF
 14256     IF CP-SPECIAL-CALC-CD = 'H'
 14257         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14258                                    TO CP-ALTERNATE-BENEFIT
 14259         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14260     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14261     MOVE 'R'                    TO CP-RATE-FILE
 14262     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14263     IF NOT CP-ERROR-RATE-NOT-FOUND
 14264        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14265        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14266           AND (CP-BENEFIT-CD (1:1) = 'S')
 14267           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14268                                    PB-I-LF-PREMIUM-AMT
 14269        END-IF
 14270     ELSE
 14271        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14272     END-IF
 14273     .
 14274 3340-EDIT-LF-AH-TOL.
 14275
 14276***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14277***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14278***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14279***
 14280     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14281         PB-I-AH-PREMIUM-AMT
 14282          GIVING WS-CALC-WORK.
 14283
 14284     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14285        AND WS-CALC-WORK NOT = ZERO
 14286         MOVE ER-2649            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 259
* EL050.cbl
 14287         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14288
 14289     SUBTRACT PB-I-LF-PREM-CALC
 14290             FROM PB-I-LF-PREMIUM-AMT
 14291                 GIVING WS-UNSIGN-WRK1.
 14292
 14293     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14294             FROM PB-I-LF-ALT-PREMIUM-AMT
 14295                 GIVING WS-UNSIGN-WRK4.
 14296
 14297     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14298                                + WS-UNSIGN-WRK4.
 14299
 14300     SUBTRACT PB-I-AH-PREM-CALC
 14301             FROM PB-I-AH-PREMIUM-AMT
 14302                 GIVING WS-UNSIGN-WRK2.
 14303
 14304******************************************************************
 14305*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14306******************************************************************
 14307
 14308     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14309         MOVE ZERO TO WS-UNSIGN-WRK1.
 14310
 14311     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14312         MOVE ZERO TO WS-UNSIGN-WRK2.
 14313
 14314     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14315             GIVING WS-UNSIGN-WRK3.
 14316
 14317 3342-CONTINUE.
 14318
 14319     IF (PB-I-LF-RATE = ZERO  AND
 14320         PB-I-AH-RATE = ZERO)
 14321         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14322            WS-AH-SPECIAL-CALC-CD = 'O'
 14323              NEXT SENTENCE
 14324         ELSE
 14325             GO TO 3345-EDIT-CONTINUE.
 14326
 14327     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14328         NEXT SENTENCE
 14329     ELSE
 14330     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14331        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14332           IF (PB-REISSUED-CERT         OR
 14333               PB-POLICY-IS-DECLINED    OR
 14334               PB-POLICY-IS-VOIDED)
 14335              NEXT SENTENCE
 14336           ELSE
 14337              IF WS-PREM-REJECT-SW = SPACE
 14338                 MOVE ER-2652    TO WS-ERROR
 14339                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14340                 GO TO 3344-CHECK-AH
 14341              ELSE
 14342                 MOVE ER-2650    TO WS-ERROR
 14343                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14344                 GO TO 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 260
* EL050.cbl
 14345
 14346***
 14347***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14348***
 14349
 14350     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14351         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14352            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14353             (1 + WS-TOL-LF-PREM-PCT)
 14354         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14355            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14356             (1 - WS-TOL-LF-PREM-PCT)
 14357     ELSE
 14358         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14359         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14360
 14361***
 14362***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14363***
 14364
 14365     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14366         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14367          WS-TOL-LF-PREM.
 14368
 14369     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14370         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14371          WS-TOL-LF-PREM.
 14372
 14373     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14374        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14375
 14376     IF (PB-REISSUED-CERT        OR
 14377         PB-POLICY-IS-DECLINED   OR
 14378         PB-POLICY-IS-VOIDED)
 14379        NEXT SENTENCE
 14380     ELSE
 14381     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14382           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14383       OR
 14384        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14385           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14386       AND
 14387        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14388           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14389         OR
 14390          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14391           LESS WS-TOL-LF-LOW-PREM-PCT))
 14392              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14393                  MOVE ER-2652   TO  WS-ERROR
 14394                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14395              ELSE
 14396                  MOVE ER-2650   TO  WS-ERROR
 14397                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14398
 14399*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14400*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14401*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14402*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 261
* EL050.cbl
 14403
 14404     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14405        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14406                      OR
 14407           ((PB-COMPANY-ID = 'DCC')
 14408           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14409           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14410           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14411        END-IF
 14412     END-IF
 14413
 14414     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14415        IF WS-COMP-MAX-CAP GREATER THAN +0
 14416           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14417              IF (PB-REISSUED-CERT         OR
 14418                  PB-POLICY-IS-DECLINED    OR
 14419                  PB-POLICY-IS-VOIDED)
 14420                 NEXT SENTENCE
 14421              ELSE
 14422                  MOVE ER-2646   TO  WS-ERROR
 14423                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14424
 14425 3344-CVL-TOLERANCE-CHECK.
 14426
 14427      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14428          GO TO 3344-CHECK-AH.
 14429
 14430      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14431          GO TO 3344-CHECK-AH.
 14432
 14433      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14434                                     WS-UNSIGN-WRK6.
 14435
 14436      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14437          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14438                                 + PB-I-LF-PREMIUM-AMT
 14439                                 - PB-I-LF-PREM-CALC.
 14440
 14441      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14442          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14443                                 + PB-I-LF-ALT-PREMIUM-AMT
 14444                                 - PB-I-LF-ALT-PREM-CALC.
 14445
 14446      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14447          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14448              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14449                 MOVE ER-2652    TO  WS-ERROR
 14450                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14451              ELSE
 14452                 MOVE ER-2650    TO  WS-ERROR
 14453                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14454
 14455      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14456          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14457              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14458                 MOVE ER-2652    TO  WS-ERROR
 14459                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14460              ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 262
* EL050.cbl
 14461                 MOVE ER-2650    TO  WS-ERROR
 14462                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14463
 14464 3344-CHECK-AH.
 14465
 14466****************************************************************
 14467***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14468***
 14469
 14470     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14471         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14472             (1 + WS-TOL-AH-PREM-PCT)
 14473         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14474             (1 - WS-TOL-AH-PREM-PCT)
 14475     ELSE
 14476         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14477         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14478
 14479***
 14480***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14481***
 14482
 14483     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14484         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14485
 14486     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14487         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14488
 14489     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14490        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14491
 14492     IF (PB-REISSUED-CERT)
 14493        OR (PB-POLICY-IS-DECLINED)
 14494        OR (PB-POLICY-IS-VOIDED)
 14495        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14496        CONTINUE
 14497     ELSE
 14498        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14499            OR
 14500           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14501           AND
 14502           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14503           OR
 14504           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14505           IF WS-PREM-REJECT-SW = SPACE
 14506              MOVE ER-3052       TO WS-ERROR
 14507              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14508           ELSE
 14509              MOVE ER-3050       TO WS-ERROR
 14510              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14511           END-IF
 14512        END-IF
 14513     END-IF
 14514
 14515     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14516         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14517             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14518             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 263
* EL050.cbl
 14519
 14520     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14521        IF WS-COMP-MAX-CAP GREATER THAN +0
 14522           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14523              IF (PB-REISSUED-CERT         OR
 14524                  PB-POLICY-IS-DECLINED    OR
 14525                  PB-POLICY-IS-VOIDED)
 14526                 NEXT SENTENCE
 14527              ELSE
 14528                  MOVE ER-2646   TO  WS-ERROR
 14529                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14530
 14531     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14532        (WS-COMP-MAX-CAP EQUAL +0)
 14533           GO TO 3345-EDIT-CONTINUE.
 14534
 14535     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14536        GREATER THAN WS-COMP-MAX-CAP
 14537           MOVE ER-2646          TO  WS-ERROR
 14538           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14539
 14540 3345-EDIT-CONTINUE.
 14541
 14542*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14543*       IF PB-ENTRY-BATCH   NUMERIC
 14544*          IF PB-ISSUE
 14545*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14546*          ELSE
 14547*              IF PB-CANCELLATION
 14548*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14549
 14550*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14551*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14552*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14553*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14554*        ELSE
 14555*            MOVE  ER-1909            TO  WS-ERROR
 14556*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14557
 14558     IF PB-I-POLICY-ACCEPTED
 14559        IF PB-POLICY-IS-DECLINED  OR
 14560           PB-REISSUED-CERT  OR
 14561           PB-REIN-ONLY-CERT  OR
 14562           PB-POLICY-IS-VOIDED
 14563            MOVE  ER-1891         TO  WS-ERROR
 14564            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14565        ELSE
 14566            MOVE SPACE            TO  PB-BATCH-ENTRY
 14567            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14568
 14569     IF PB-I-POLICY-DECLINED
 14570        IF PB-REISSUED-CERT  OR
 14571           PB-REIN-ONLY-CERT  OR
 14572           PB-POLICY-IS-VOIDED
 14573            MOVE  ER-1906         TO  WS-ERROR
 14574            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14575        ELSE
 14576            MOVE  'D'             TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 264
* EL050.cbl
 14577                                      PB-I-ENTRY-STATUS.
 14578
 14579     IF PB-I-NEEDS-UNDERWRITING
 14580        IF PB-POLICY-IS-DECLINED OR
 14581           PB-REISSUED-CERT  OR
 14582           PB-REIN-ONLY-CERT  OR
 14583           PB-POLICY-IS-VOIDED
 14584            MOVE  ER-1907         TO  WS-ERROR
 14585            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14586        ELSE
 14587            MOVE 'U'              TO  PB-BATCH-ENTRY
 14588                                      PB-I-ENTRY-STATUS.
 14589
 14590     IF PB-NEEDS-UNDERWRITING
 14591        MOVE  ER-1901             TO  WS-ERROR
 14592        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14593     IF PB-COMPANY-ID = 'DCC'
 14594        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14595        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14596        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14597           AND (NOT WS-LF-CASH))
 14598                           OR
 14599           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14600           AND (NOT WS-AH-CASH)))
 14601                       AND
 14602           (PB-I-ENTRY-STATUS NOT = '5')
 14603           MOVE 'M'              TO PB-BATCH-ENTRY
 14604                                    PB-I-ENTRY-STATUS
 14605        END-IF
 14606     END-IF
 14607     IF  PB-COMPANY-ID NOT = 'NCL'
 14608         GO TO 3999-END-EDIT.
 14609
 14610     IF PB-REISSUED-CERT  OR
 14611        PB-POLICY-IS-DECLINED  OR
 14612        PB-POLICY-IS-VOIDED  OR
 14613        PB-I-OB
 14614         GO TO 3999-END-EDIT.
 14615
 14616     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14617         MOVE  ER-2644            TO  WS-ERROR
 14618         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14619         GO TO 3999-END-EDIT.
 14620
 14621     MOVE 'N'                     TO  FORM-MASTER-SW.
 14622     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14623
 14624     IF NOT FORM-MASTER-FOUND
 14625         GO TO 3999-END-EDIT.
 14626
 14627     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14628                                      FORM-MASTER-AH-SW.
 14629
 14630     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14631         MOVE  +1                 TO SUB6
 14632         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14633
 14634     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 265
* EL050.cbl
 14635         MOVE  +1                 TO SUB6
 14636         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14637
 14638     IF LF-FORM-MASTER-FOUND  OR
 14639        AH-FORM-MASTER-FOUND
 14640         GO TO 3360-CHECK-FORM-LIMITS
 14641     ELSE
 14642         GO TO 3999-END-EDIT.
 14643
 14644******************************************************************
 14645*                  3350-GET-ERFORM                               *
 14646*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14647*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14648******************************************************************
 14649
 14650 3350-GET-ERFORM.
 14651
 14652     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14653         GO TO  3350-ERFORM-GETMAIN.
 14654
 14655     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14656     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14657     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14658     MOVE 'Y'                     TO FORM-MASTER-SW.
 14659
 14660     IF PB-CANCELLATION
 14661         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14662            PB-SV-STATE          EQUAL   FO-STATE       AND
 14663            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14664              GO TO 3350-EXIT
 14665         ELSE
 14666             NEXT SENTENCE
 14667     ELSE
 14668         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14669            PB-SV-STATE          EQUAL   FO-STATE       AND
 14670            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14671              GO TO 3350-EXIT.
 14672
 14673 3350-ERFORM-GETMAIN.
 14674
 14675     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14676     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14677
 14678 3350-ERFORM-READ.
 14679
 14680     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14681     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14682     IF PB-CANCELLATION
 14683         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14684     ELSE
 14685         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14686     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14687
 14688     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14689
 14690     IF FORM-MASTER-FOUND
 14691       IF PB-CANCELLATION
 14692          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 266
* EL050.cbl
 14693             PB-SV-STATE          EQUAL   FO-STATE       AND
 14694             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14695              GO  TO 3350-EXIT
 14696          ELSE
 14697              NEXT SENTENCE
 14698       ELSE
 14699          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14700             PB-SV-STATE          EQUAL   FO-STATE       AND
 14701             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14702              GO  TO 3350-EXIT.
 14703
 14704     MOVE  'N'                    TO  FORM-MASTER-SW.
 14705     MOVE  ER-1895                TO  WS-ERROR.
 14706     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14707
 14708 3350-EXIT.
 14709      EXIT.
 14710
 14711******************************************************************
 14712*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14713*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14714*   VALID FOR THE POLICY FORM USED.                              *
 14715******************************************************************
 14716
 14717 3355-EDIT-FORM-LF-BENEFITS.
 14718
 14719     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14720        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14721         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14722         GO TO   3355-EXIT.
 14723
 14724     IF  SUB6    LESS THAN   +40
 14725         ADD  +1      TO  SUB6
 14726         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14727
 14728     MOVE  ER-1896         TO  WS-ERROR.
 14729     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14730
 14731 3355-EXIT.
 14732      EXIT.
 14733
 14734******************************************************************
 14735*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14736*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14737*   VALID FOR THE POLICY FORM USED.                              *
 14738******************************************************************
 14739
 14740 3356-EDIT-FORM-AH-BENEFITS.
 14741
 14742     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14743        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14744         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14745         GO TO  3356-EXIT.
 14746
 14747      IF  SUB6    LESS THAN     +40
 14748          ADD  +1      TO  SUB6
 14749          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14750
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 267
* EL050.cbl
 14751     MOVE  ER-1897         TO  WS-ERROR.
 14752     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14753
 14754 3356-EXIT.
 14755      EXIT.
 14756
 14757******************************************************************
 14758*                  3357-BENEFIT-SEARCH                           *
 14759*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14760*   CANCELLATIONS ONLY.                                          *
 14761******************************************************************
 14762 3357-BENEFIT-SEARCH.
 14763     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14764         MOVE +1                          TO SUB6
 14765         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14766
 14767     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14768         MOVE +1                          TO SUB6
 14769         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14770
 14771 3357-EXIT.
 14772     EXIT.
 14773
 14774******************************************************************
 14775*                  3358-BENEFIT-LIFE-SEARCH                      *
 14776*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14777*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14778*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14779******************************************************************
 14780 3358-BENEFIT-LIFE-SEARCH.
 14781     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14782       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14783         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14784           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14785              IF FO-PLAN-REFUND-METHOD (SUB6)
 14786                     IS GREATER THAN SPACES
 14787                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14788                                          WS-LF-REFUND-CALC
 14789                 GO TO 3358-EXIT.
 14790
 14791     IF SUB6 LESS THAN +40
 14792         ADD +1                 TO SUB6
 14793         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14794
 14795 3358-EXIT.
 14796     EXIT.
 14797******************************************************************
 14798*                  3359-BENEFIT-AH-SEARCH                        *
 14799*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14800*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14801*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14802******************************************************************
 14803 3359-BENEFIT-AH-SEARCH.
 14804     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14805       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14806         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14807           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14808              IF FO-PLAN-REFUND-METHOD (SUB6)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 268
* EL050.cbl
 14809                      IS GREATER THAN SPACES
 14810                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14811                                          WS-AH-REFUND-CALC
 14812                 GO TO 3359-EXIT.
 14813
 14814     IF SUB6 LESS THAN +40
 14815         ADD +1                 TO SUB6
 14816         GO TO 3359-BENEFIT-AH-SEARCH.
 14817
 14818 3359-EXIT.
 14819     EXIT.
 14820
 14821******************************************************************
 14822*                  3360-CHECK-FORM-LIMITS                        *
 14823*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14824*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14825******************************************************************
 14826
 14827 3360-CHECK-FORM-LIMITS.
 14828
 14829     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14830         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14831
 14832     IF NOT LF-FORM-MASTER-FOUND
 14833         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14834
 14835 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14836
 14837     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14838       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14839        WS-LF-JOINT-INDICATOR = 'J'  AND
 14840        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14841         IF PB-COMPANY-ID = 'NCL'
 14842            MOVE  ER-1911          TO  WS-ERROR
 14843            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14844         ELSE
 14845            MOVE  ER-1892          TO  WS-ERROR
 14846            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14847
 14848 3360-CHECK-FORM-LF-ATT-AGE.
 14849
 14850     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14851
 14852     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14853         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14854         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14855            IF PB-COMPANY-ID = 'NCL'
 14856                MOVE  ER-1913      TO  WS-ERROR
 14857                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14858            ELSE
 14859                MOVE  ER-1894      TO  WS-ERROR
 14860                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14861
 14862 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14863
 14864     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14865         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14866         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 269
* EL050.cbl
 14867            IF PB-COMPANY-ID = 'NCL'
 14868                MOVE  ER-1914      TO  WS-ERROR
 14869                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14870            ELSE
 14871                MOVE  ER-1899      TO  WS-ERROR
 14872                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14873
 14874 3360-CHECK-FORM-LF-TERM-BAMT.
 14875
 14876     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14877         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 14878         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14879           IF  PB-COMPANY-ID = 'NCL'
 14880               MOVE  ER-1916       TO  WS-ERROR
 14881               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14882           ELSE
 14883               MOVE  ER-1902       TO  WS-ERROR
 14884               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14885
 14886     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 14887                                    PB-I-LF-ALT-BENEFIT-AMT.
 14888
 14889     IF  FO-MAX-LF-AMT   NUMERIC   AND
 14890         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 14891         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 14892             IF  PB-COMPANY-ID = 'NCL'
 14893                 MOVE  ER-1918     TO  WS-ERROR
 14894                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14895             ELSE
 14896                 MOVE  ER-1904     TO  WS-ERROR
 14897                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14898
 14899******************************************************************
 14900*                  3360-CHECK-FORM-AH-LIMITS                     *
 14901*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14902*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14903******************************************************************
 14904
 14905 3360-CHECK-FORM-AH-LIMITS.
 14906
 14907     IF NOT AH-FORM-MASTER-FOUND
 14908         GO TO 3999-END-EDIT.
 14909
 14910 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 14911
 14912     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 14913       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 14914        WS-AH-JOINT-INDICATOR = 'J'  AND
 14915        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14916         IF PB-COMPANY-ID = 'NCL'
 14917            MOVE  ER-1912          TO  WS-ERROR
 14918            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14919         ELSE
 14920            MOVE  ER-1893          TO  WS-ERROR
 14921            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14922
 14923 3360-CHECK-FORM-AH-ATT-AGE.
 14924
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 270
* EL050.cbl
 14925     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 14926
 14927     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 14928         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14929         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 14930            IF PB-COMPANY-ID = 'NCL'
 14931                MOVE  ER-1913      TO  WS-ERROR
 14932                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14933            ELSE
 14934                MOVE  ER-1894      TO  WS-ERROR
 14935                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14936
 14937 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 14938
 14939     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 14940         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 14941         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 14942            IF PB-COMPANY-ID = 'NCL'
 14943                MOVE  ER-1915      TO  WS-ERROR
 14944                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14945            ELSE
 14946                MOVE  ER-1900      TO  WS-ERROR
 14947                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14948
 14949 3360-CHECK-FORM-AH-TERM-BAMT.
 14950
 14951     IF  FO-AH-MAX-TERM    NUMERIC   AND
 14952         FO-AH-MAX-TERM    GREATER THAN  +0
 14953         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 14954             IF  PB-COMPANY-ID = 'NCL'
 14955                 MOVE  ER-1917     TO  WS-ERROR
 14956                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14957             ELSE
 14958                  MOVE  ER-1903    TO  WS-ERROR
 14959                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14960
 14961     IF  FO-MAX-AH-AMT    NUMERIC   AND
 14962         FO-MAX-AH-AMT    GREATER THAN  +0
 14963         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 14964             IF  PB-COMPANY-ID = 'NCL'
 14965                 MOVE  ER-1919     TO  WS-ERROR
 14966                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14967             ELSE
 14968                 MOVE  ER-1905     TO  WS-ERROR
 14969                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14970
 14971     GO TO 3999-END-EDIT.
 14972
 14973******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 271
* EL050.cbl
 14975******************************************************************
 14976*                  E D I T   C A N C E L                         *
 14977******************************************************************
 14978
 14979 3700-EDIT-CANCEL.
 14980     IF PB-COMPANY-ID = 'DMD'
 14981         MOVE ZEROS                   TO WS-RES-STATE-TAX
 14982                                         WS-RES-MUNI-TAX
 14983                                         PB-CI-STATE-TAX
 14984                                         PB-CI-MUNI-TAX
 14985         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 14986
 14987*    IF PB-COMPANY-ID  EQUAL  'NCL'
 14988*       IF PB-ENTRY-BATCH  NUMERIC
 14989*          IF PB-CANCELLATION
 14990*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 14991*          ELSE
 14992*             IF PB-ISSUE
 14993*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 14994
 14995     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 14996        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 14997     END-IF
 14998*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 14999*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15000
 15001     IF CM-ENTRY-STATUS = 'V'
 15002        MOVE ER-2780             TO WS-ERROR
 15003        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15004        GO TO 3999-END-EDIT.
 15005
 15006     IF CM-ENTRY-STATUS = 'D'
 15007        MOVE ER-2781             TO WS-ERROR
 15008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15009        GO TO 3999-END-EDIT.
 15010
 15011     IF CM-ENTRY-STATUS = 'U'
 15012        MOVE ER-2782             TO WS-ERROR
 15013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15014
 15015***************************************************************
 15016*                                                             *
 15017*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15018*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15019*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15020*   OF ANOTHER COVERAGE.                                      *
 15021*                                                             *
 15022***************************************************************
 15023
 15024     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15025                                    PB-C-AH-CANCEL-VOID-SW.
 15026
 15027     IF PB-C-LF-CANCEL-AMT = ZERO
 15028        NEXT SENTENCE
 15029     ELSE
 15030        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15031           AND
 15032           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 272
* EL050.cbl
 15033               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15034               MOVE ER-2745           TO WS-ERROR
 15035               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15036
 15037     IF PB-C-AH-CANCEL-AMT = ZERO
 15038        NEXT SENTENCE
 15039     ELSE
 15040        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15041           AND
 15042           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15043               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15044               MOVE ER-2745           TO WS-ERROR
 15045               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15046
 15047     IF WS-LF-EARNINGS-CALC = '4'
 15048        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15049
 15050     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15051     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15052     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15053     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15054     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15055     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15056
 15057     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15058                                      PB-C-AH-REF-CALC.
 15059     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15060
 15061******************************************************************
 15062*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15063*             TO VALIDATE COVERAGE.                              *
 15064******************************************************************
 15065
 15066     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15067        PB-C-LF-CANCEL-AMT = ZEROS
 15068          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15069      ELSE
 15070          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15071
 15072     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15073        PB-C-AH-CANCEL-AMT = ZEROS
 15074          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15075      ELSE
 15076          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15077
 15078     EVALUATE TRUE
 15079         WHEN PB-CANCEL-FORCE             OR
 15080              PB-CANCEL-DATE-FORCED       OR
 15081              PB-FORCE-OFF
 15082                  IF PB-COMPANY-ID = 'ACE'
 15083                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15084                  END-IF
 15085         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15086               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15087              (PB-COMPANY-ID = 'ACE' )
 15088                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15089         WHEN OTHER
 15090              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 273
* EL050.cbl
 15091                 MOVE ER-2794              TO WS-ERROR
 15092              ELSE
 15093                 MOVE ER-2749              TO WS-ERROR
 15094              END-IF
 15095              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15096     END-EVALUATE.
 15097
 15098
 15099*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15100*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15101*            MOVE  ER-1909            TO  WS-ERROR
 15102*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15103*        ELSE
 15104*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15105
 15106     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15107     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15108        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15109     ELSE
 15110        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15111     END-IF
 15112     .
 15113 3705-EDIT-CANCEL-DT.
 15114
 15115     IF LF-COVERAGE-CANCELLED
 15116        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15117         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15118         MOVE WS-CURRENT-MONTH-END
 15119                                 TO DC-BIN-DATE-2
 15120         SET ELAPSED-BETWEEN-BIN TO TRUE
 15121*        MOVE 1                  TO DC-OPTION-CODE
 15122         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15123         IF DATE-CONVERSION-ERROR
 15124            NEXT SENTENCE
 15125          ELSE
 15126             IF DC-ELAPSED-DAYS GREATER +180
 15127                IF PB-CANCEL-DATE-FORCED  OR
 15128                   PB-CANCEL-DATE-FORCED-NO-FEE
 15129                      MOVE ER-2751  TO WS-ERROR
 15130                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15131                 ELSE
 15132                   MOVE ER-2752  TO WS-ERROR
 15133                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15134
 15135     IF AH-COVERAGE-CANCELLED
 15136        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15137         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15138         MOVE WS-CURRENT-MONTH-END
 15139                                 TO DC-BIN-DATE-2
 15140         SET ELAPSED-BETWEEN-BIN TO TRUE
 15141*        MOVE 1                  TO DC-OPTION-CODE
 15142         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15143         IF DATE-CONVERSION-ERROR
 15144            NEXT SENTENCE
 15145          ELSE
 15146             IF DC-ELAPSED-DAYS GREATER +180
 15147                IF PB-CANCEL-DATE-FORCED OR
 15148                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 274
* EL050.cbl
 15149                      MOVE ER-2751  TO WS-ERROR
 15150                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15151                 ELSE
 15152                   MOVE ER-2752  TO WS-ERROR
 15153                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15154
 15155     IF WS-ERROR = ER-2752
 15156        AND (PB-COMPANY-ID = 'ABL'
 15157         OR  PB-COMPANY-ID = 'FGL'
 15158         OR  PB-COMPANY-ID = 'IST'
 15159         OR  PB-COMPANY-ID = 'JHL'
 15160         OR  PB-COMPANY-ID = 'LAP'
 15161         OR  PB-COMPANY-ID = 'LBL'
 15162         OR  PB-COMPANY-ID = 'NCB'
 15163         OR  PB-COMPANY-ID = 'NLI'
 15164         OR  PB-COMPANY-ID = 'OFI'
 15165         OR  PB-COMPANY-ID = 'PLI'
 15166         OR  PB-COMPANY-ID = 'TAO'
 15167         OR  PB-COMPANY-ID = 'TIC'
 15168         OR  PB-COMPANY-ID = 'HER'
 15169         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15170         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15171            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15172            MOVE ER-2762     TO WS-ERROR
 15173            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15174
 15175     IF LF-COVERAGE-CANCELLED
 15176        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15177        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15178             MOVE ER-2733         TO WS-ERROR
 15179             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15180
 15181     IF AH-COVERAGE-CANCELLED
 15182        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15183        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15184              MOVE ER-2733        TO WS-ERROR
 15185              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15186
 15187     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15188        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15189        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15190           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15191            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15192              IF PB-COMPANY-ID NOT = 'LAP'
 15193               MOVE ER-2704            TO WS-ERROR
 15194               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15195
 15196     IF CERT-WAS-NOT-FOUND
 15197         GO TO 3999-END-EDIT.
 15198
 15199     IF PB-COMPANY-ID EQUAL 'CDC'
 15200        IF LF-COVERAGE-CANCELLED
 15201           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15202            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15203            MOVE PB-C-LF-CANCEL-DT
 15204                                 TO DC-BIN-DATE-2
 15205            SET ELAPSED-BETWEEN-BIN TO TRUE
 15206*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 275
* EL050.cbl
 15207            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15208            IF DATE-CONVERSION-ERROR
 15209               NEXT SENTENCE
 15210             ELSE
 15211                IF DC-ELAPSED-DAYS GREATER +60
 15212                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15213
 15214     IF PB-COMPANY-ID EQUAL 'CDC'
 15215        IF AH-COVERAGE-CANCELLED
 15216           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15217            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15218            MOVE PB-C-AH-CANCEL-DT
 15219                                 TO DC-BIN-DATE-2
 15220            MOVE +0              TO DC-ELAPSED-DAYS
 15221                                    DC-ELAPSED-MONTHS
 15222            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15223*           MOVE 1               TO DC-OPTION-CODE
 15224            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15225            IF DATE-CONVERSION-ERROR
 15226               NEXT SENTENCE
 15227             ELSE
 15228                IF DC-ELAPSED-DAYS GREATER +60
 15229                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15230
 15231     MOVE +0                     TO DC-ELAPSED-DAYS
 15232                                    DC-ELAPSED-MONTHS.
 15233
 15234     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15235        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15236          MOVE 'Z'                TO PB-CI-OB-FLAG
 15237          MOVE ER-2767            TO WS-ERROR
 15238          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15239          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15240          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15241          GO TO 3775-OVER-REF-CHK
 15242        ELSE
 15243          MOVE ZEROS              TO PB-CI-LIVES
 15244                                     PB-C-LIVES
 15245          IF PB-CI-OB-FLAG NOT = 'B'
 15246             MOVE SPACE           TO PB-CI-OB-FLAG.
 15247
 15248     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15249         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15250     ELSE
 15251         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15252
 15253     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15254        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15255            MOVE ER-2760         TO WS-ERROR
 15256            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15257
 15258     IF LF-COVERAGE-CANCELLED
 15259        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15260         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15261            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15262               MOVE ER-2774       TO WS-ERROR
 15263               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15264
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 276
* EL050.cbl
 15265     IF AH-COVERAGE-CANCELLED
 15266        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15267         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15268            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15269               MOVE ER-2775       TO WS-ERROR
 15270               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15271
 15272     IF LF-COVERAGE-CANCELLED
 15273        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15274         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15275            MOVE ER-2776         TO WS-ERROR
 15276            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15277
 15278     IF AH-COVERAGE-CANCELLED
 15279        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15280         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15281            MOVE ER-2777         TO WS-ERROR
 15282            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15283
 15284     IF LF-COVERAGE-CANCELLED
 15285        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15286         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15287         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15288         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15289*        MOVE 6                    TO DC-OPTION-CODE
 15290         SET BIN-PLUS-ELAPSED      TO TRUE
 15291         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15292         IF DATE-CONVERSION-ERROR
 15293            NEXT SENTENCE
 15294          ELSE
 15295            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15296              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15297                             OR  'FIA'
 15298                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15299               ELSE
 15300                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15301                MOVE ER-2731       TO WS-ERROR
 15302                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15303
 15304 3705-EDIT-AH-CANCEL-DT.
 15305
 15306     IF AH-COVERAGE-CANCELLED
 15307        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15308         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15309         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15310         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15311*        MOVE 6                    TO DC-OPTION-CODE
 15312         SET BIN-PLUS-ELAPSED      TO TRUE
 15313         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15314         IF DATE-CONVERSION-ERROR
 15315            NEXT SENTENCE
 15316          ELSE
 15317            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15318              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15319                              OR 'FIA'
 15320                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15321              ELSE
 15322               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 277
* EL050.cbl
 15323               MOVE ER-2771       TO WS-ERROR
 15324               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15325
 15326 3705-EDIT-CONTINUED.
 15327
 15328*    IF LF-COVERAGE-CANCELLED
 15329*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15330*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15331*            MOVE ER-2727         TO WS-ERROR
 15332*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15333*
 15334*    IF AH-COVERAGE-CANCELLED
 15335*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15336*        IF PB-COMPANY-ID = 'ACE'
 15337*           MOVE ER-2727        TO WS-ERROR
 15338*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15339*        ELSE
 15340*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15341*              MOVE ER-2727     TO WS-ERROR
 15342*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15343
 15344     IF PB-COMPANY-ID = 'ACE'
 15345       IF AH-COVERAGE-CANCELLED
 15346         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15347           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15348              MOVE ER-2732      TO WS-ERROR
 15349              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15350
 15351     IF PB-COMPANY-ID      EQUAL   'HER'
 15352        IF WS-ERROR        EQUAL   ER-2727
 15353            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15354            MOVE  ER-2725          TO  WS-ERROR
 15355            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15356
 15357     IF PB-C-CLAIM-CREATED-CANCEL
 15358            MOVE ER-2748         TO WS-ERROR
 15359            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15360
 15361     IF PB-C-LAST-NAME NOT = SPACES
 15362         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15363            MOVE ER-2747         TO WS-ERROR
 15364            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15365
 15366 3710-EDIT-LUMP-SUM-PRIOR.
 15367
 15368     IF AH-COVERAGE-CANCELLED
 15369         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15370             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15371                MOVE ER-2735    TO WS-ERROR
 15372                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15373
 15374     IF LF-COVERAGE-CANCELLED
 15375         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15376             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15377                MOVE ER-2735    TO WS-ERROR
 15378                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15379
 15380 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 278
* EL050.cbl
 15381
 15382*    IF LF-COVERAGE-CANCELLED
 15383*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15384*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15385*           (NOT PB-CI-OB)
 15386*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15387*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15388*                   MOVE ER-2732  TO WS-ERROR
 15389*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15390*
 15391*    IF AH-COVERAGE-CANCELLED
 15392*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15393*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15394*           (NOT PB-CI-OB)
 15395*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15396*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15397*                   MOVE ER-2732  TO WS-ERROR
 15398*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15399
 15400     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15401         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15402            (NOT PB-COMP-LF-CANCEL)
 15403             NEXT SENTENCE
 15404         ELSE
 15405           IF PB-C-LF-CANCEL-VOIDED
 15406              NEXT SENTENCE
 15407           ELSE
 15408              MOVE ER-2753      TO WS-ERROR
 15409              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15410
 15411     IF CANCEL-FUTURE-DT
 15412         GO TO 3999-END-EDIT.
 15413
 15414 3715-GET-REMAIN-TERM-LF.
 15415
 15416     IF NO-LF-BENEFIT-MATCH  OR
 15417        WS-LF-BENEFIT-CD = ZEROS
 15418        GO TO 3730-GET-AH-REMAIN-TERM.
 15419
 15420     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15421     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15422     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15423     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15424     MOVE PB-SV-STATE            TO CP-STATE.
 15425     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15426     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15427     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15428     MOVE '2'                    TO CP-PROCESS-TYPE.
 15429     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15430     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15431     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15432     IF (PB-COMPANY-ID = 'CID')
 15433        AND (CP-STATE-STD-ABBRV = 'WI')
 15434        MOVE '7'                 TO CP-REM-TERM-METHOD
 15435        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15436     ELSE
 15437        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15438        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 279
* EL050.cbl
 15439                                 TO CP-REM-TRM-CALC-OPTION
 15440     END-IF
 15441**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15442     IF (PB-COMPANY-ID = 'CID')
 15443        AND (CP-STATE-STD-ABBRV = 'MO')
 15444        AND (PB-CERT-EFF-DT >= X'9B41')
 15445        AND (PB-CERT-EFF-DT <= X'A2FB')
 15446        MOVE '7'                 TO CP-REM-TERM-METHOD
 15447        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15448     END-IF
 15449     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15450                                    CP-LOAN-TERM.
 15451     IF CP-TRUNCATED-LIFE
 15452        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15453
 15454     IF CP-TERM-IS-DAYS
 15455         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15456     ELSE
 15457         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15458
 15459     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15460
 15461     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15462
 15463     IF LF-COVERAGE-CANCELLED
 15464        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15465        NEXT SENTENCE
 15466      ELSE
 15467          GO TO 3730-GET-AH-REMAIN-TERM.
 15468
 15469 3720-GET-LF-REFUND.
 15470
 15471     IF PB-C-LF-CANCEL-VOIDED OR
 15472        PB-C-AH-CANCEL-VOIDED
 15473        GO TO 3780-UPDATE-CANCEL-CERT.
 15474
 15475     IF PB-COMPANY-ID EQUAL 'BOA'
 15476         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15477         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15478         GO TO 3730-GET-AH-REMAIN-TERM.
 15479
 15480     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15481        (WS-AH-SPECIAL-CALC-CD = 'M')
 15482         MOVE ER-2767            TO WS-ERROR
 15483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15484         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15485         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15486         GO TO 3780-UPDATE-CANCEL-CERT.
 15487
 15488     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15489
 15490     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15491     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15492     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15493     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15494     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15495     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15496     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 280
* EL050.cbl
 15497        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15498        IF PDEF-MASTER-FOUND
 15499           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15500              (V1 > +8)
 15501              OR (PD-PROD-CODE (V1) = 'L')
 15502           END-PERFORM
 15503           IF V1 < +9
 15504              MOVE PD-MAX-AMT (V1)
 15505                           TO CP-R-MAX-TOT-BEN
 15506                              EC-AM-LF-MAX-TOT-BEN
 15507           END-IF
 15508        ELSE
 15509        MOVE ' '                 TO PDEF-MASTER-SW
 15510        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15511        MOVE PB-STATE            TO ERPDEF-STATE
 15512        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15513        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15514        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15515        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15516        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15517        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15518        IF PDEF-MASTER-FOUND
 15519           MOVE 'N'              TO PDEF-MASTER-SW
 15520           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15521           IF PDEF-MASTER-FOUND
 15522              IF (ERPDEF-KEY-SAVE (1:16) =
 15523                           PD-CONTROL-PRIMARY (1:16))
 15524                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15525                 CONTINUE
 15526              ELSE
 15527                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15528                 IF (ERPDEF-KEY-SAVE (1:16) =
 15529                           PD-CONTROL-PRIMARY (1:16))
 15530                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15531                    CONTINUE
 15532                 ELSE
 15533                    MOVE 'N'     TO PDEF-MASTER-SW
 15534                 END-IF
 15535              END-IF
 15536              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15537
 15538              IF PDEF-MASTER-FOUND
 15539                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15540                    (V1 > +8)
 15541                    OR (PD-PROD-CODE (V1) = 'L')
 15542                 END-PERFORM
 15543                 IF V1 < +9
 15544                    MOVE PD-MAX-AMT (V1)
 15545                                 TO CP-R-MAX-TOT-BEN
 15546                                    EC-AM-LF-MAX-TOT-BEN
 15547                 END-IF
 15548              END-IF
 15549           END-IF
 15550           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15551        END-IF
 15552        END-IF
 15553     END-IF
 15554     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 281
* EL050.cbl
 15555
 15556     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15557
 15558     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15559                                    PB-C-LF-REM-TERM.
 15560
 15561     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15562     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15563
 15564     IF PB-COMPANY-ID EQUAL 'FLC'
 15565        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15566           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15567           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15568                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15569                    - CM-LF-ITD-DEATH-AMT
 15570           IF PB-C-LF-REF-CALC LESS THAN +0
 15571              MOVE +0            TO PB-C-LF-REF-CALC
 15572              GO TO 3730-GET-AH-REMAIN-TERM
 15573           ELSE
 15574              GO TO 3730-GET-AH-REMAIN-TERM.
 15575
 15576     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15577                            OR '4' OR '5' OR '6' OR '8'
 15578                            OR '9' OR 'G'
 15579        MOVE PB-C-LF-REFUND-OVERRIDE
 15580                                 TO CP-EARNING-METHOD.
 15581
 15582     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15583     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15584     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15585                                    CP-RATING-BENEFIT-AMT.
 15586     IF CP-STATE-STD-ABBRV = 'OR'
 15587         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15588                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15589     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15590     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15591     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15592     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15593     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15594     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15595     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15596     IF WS-DEFAULT-APR NOT NUMERIC
 15597         MOVE ZEROS TO WS-DEFAULT-APR.
 15598****   N O T E   ****
 15599*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15600*      THE OH HARD CODING IN ELCRFNDP
 15601
 15602     IF PB-COMPANY-ID = 'CID'
 15603        IF CP-STATE-STD-ABBRV = 'OH'
 15604           MOVE WS-LF-EARNINGS-CALC
 15605                                 TO CP-EARNING-METHOD
 15606        END-IF
 15607     END-IF
 15608
 15609****   N O T E   ****
 15610
 15611     IF CP-EARN-AS-NET-PAY
 15612         IF CP-LOAN-APR NOT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 282
* EL050.cbl
 15613            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15614                MOVE WS-DEFAULT-APR
 15615                                 TO  CP-LOAN-APR
 15616                MOVE ER-3780     TO  WS-ERROR
 15617                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15618            ELSE
 15619                MOVE ER-3781     TO  WS-ERROR
 15620                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15621     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15622     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15623
 15624     IF CP-REFUND-TYPE-USED NOT = SPACE
 15625         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15626
 15627     IF CP-ERROR-RATE-IS-ZERO OR
 15628        CP-ERROR-RATE-NOT-FOUND
 15629        MOVE ER-2740             TO WS-ERROR
 15630        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15631
 15632     IF CP-ERROR-RATE-FILE-NOTOPEN
 15633        MOVE ER-2617             TO WS-ERROR
 15634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15635
 15636     IF PB-COMPANY-ID = 'DCC'
 15637        AND PB-CI-ENTRY-STATUS = 'M'
 15638        MOVE +0                  TO PB-C-LF-REF-CALC
 15639     ELSE
 15640        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15641     END-IF
 15642
 15643     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15644         GO TO 3730-GET-AH-REMAIN-TERM.
 15645
 15646*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15647*       ADD +1                   TO PB-C-LF-REM-TERM
 15648*                                   CP-REMAINING-TERM
 15649*                                   CP-ORIGINAL-TERM.
 15650
 15651     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15652     MOVE '2'                    TO CP-EARNING-METHOD
 15653                                    CP-RATING-METHOD.
 15654     IF PB-COMPANY-ID = 'CID'
 15655        IF (CP-STATE-STD-ABBRV = 'MN')
 15656           AND (PB-CERT-EFF-DT > X'A4FF')
 15657           AND (WS-LF-EARNINGS-CALC = 'B')
 15658           MOVE '5'              TO CP-EARNING-METHOD
 15659           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15660        END-IF
 15661     END-IF
 15662     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15663                                        CP-REMAINING-BENEFIT
 15664                                        CP-RATING-BENEFIT-AMT.
 15665     IF CP-STATE-STD-ABBRV = 'OR'
 15666         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15667                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15668     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15669     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15670
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 283
* EL050.cbl
 15671     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15672
 15673     IF CP-ERROR-RATE-IS-ZERO OR
 15674        CP-ERROR-RATE-NOT-FOUND
 15675        MOVE ER-2740             TO WS-ERROR
 15676        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15677
 15678     IF CP-ERROR-RATE-FILE-NOTOPEN
 15679        MOVE ER-2617             TO WS-ERROR
 15680        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15681
 15682     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15683
 15684******************************************************************
 15685
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 284
* EL050.cbl
 15687 3730-GET-AH-REMAIN-TERM.
 15688     IF NO-AH-BENEFIT-MATCH  OR
 15689        WS-AH-BENEFIT-CD = ZEROS
 15690         GO TO 3770-CHECK-REFUNDS.
 15691
 15692     IF PB-CI-AH-LUMP-SUM-DISAB
 15693         IF  PB-C-AH-CANCEL-AMT = ZERO
 15694            IF NOT PB-COMP-AH-CANCEL
 15695             GO TO 3770-CHECK-REFUNDS.
 15696
 15697     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15698     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15699     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15700     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15701     MOVE PB-SV-STATE            TO CP-STATE.
 15702     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15703     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15704     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15705     MOVE '2'                    TO CP-PROCESS-TYPE.
 15706     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15707     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15708     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15709     IF (PB-COMPANY-ID = 'CID')
 15710        AND (CP-STATE-STD-ABBRV = 'WI')
 15711        MOVE '7'                 TO CP-REM-TERM-METHOD
 15712        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15713     ELSE
 15714        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15715        MOVE WS-REM-TRM-CALC-OPTION
 15716                                 TO CP-REM-TRM-CALC-OPTION
 15717     END-IF
 15718     IF (PB-COMPANY-ID = 'CID')
 15719        AND (CP-STATE-STD-ABBRV = 'MO')
 15720        AND (PB-CERT-EFF-DT >= X'9B41')
 15721        AND (PB-CERT-EFF-DT <= X'A2FB')
 15722        MOVE '7'                 TO CP-REM-TERM-METHOD
 15723        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15724     END-IF
 15725     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15726                                    CP-LOAN-TERM.
 15727     IF NOT CP-TERM-IS-DAYS
 15728         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15729
 15730     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15731
 15732     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15733
 15734     IF AH-COVERAGE-CANCELLED
 15735        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15736        NEXT SENTENCE
 15737      ELSE
 15738         GO TO 3770-CHECK-REFUNDS.
 15739
 15740 3740-GET-AH-REFUND.
 15741
 15742     IF PB-C-LF-CANCEL-VOIDED OR
 15743        PB-C-AH-CANCEL-VOIDED
 15744        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 285
* EL050.cbl
 15745
 15746     IF PB-COMPANY-ID = 'BOA'
 15747         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15748         GO TO 3770-CHECK-REFUNDS.
 15749
 15750     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15751*    MOVE ' '                    TO DC-OPTION-CODE
 15752     SET BIN-TO-GREG             TO TRUE
 15753     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15754     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15755                                    PB-C-AH-REM-TERM.
 15756     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15757     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15758
 15759     IF PB-COMPANY-ID EQUAL 'FLC'
 15760        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15761           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15762           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15763                    - CM-AH-ITD-AH-PMT)
 15764           IF PB-C-AH-REF-CALC LESS THAN +0
 15765              MOVE +0            TO PB-C-AH-REF-CALC
 15766              GO TO 3770-CHECK-REFUNDS
 15767           ELSE
 15768              GO TO 3770-CHECK-REFUNDS.
 15769
 15770     IF PB-COMPANY-ID = 'DCC'
 15771        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15772            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15773           MOVE 'S'              TO CP-EARNING-METHOD
 15774        END-IF
 15775     END-IF
 15776     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15777                            OR '4' OR '5' OR '6' OR '8'
 15778                            OR '9' OR 'G' OR 'S'
 15779        MOVE PB-C-AH-REFUND-OVERRIDE
 15780                                 TO CP-EARNING-METHOD.
 15781
 15782     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15783     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15784     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15785                                    CP-RATING-BENEFIT-AMT.
 15786     IF CP-STATE-STD-ABBRV = 'OR'
 15787         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15788                                         PB-CI-AH-TERM.
 15789     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15790     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15791     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15792     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15793     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15794     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15795
 15796     IF CP-STATE-STD-ABBRV = 'OH'
 15797        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15798                                AND 'CID' AND 'DCC' AND 'AHL')
 15799           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15800              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15801              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15802              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 286
* EL050.cbl
 15803           END-IF
 15804        END-IF
 15805        IF PB-COMPANY-ID = 'CID'
 15806           IF NO-LIFE-COVERAGE
 15807              IF CP-CRITICAL-PERIOD
 15808                 MOVE '2'       TO CP-EARNING-METHOD
 15809              ELSE
 15810                 MOVE '6'       TO CP-EARNING-METHOD
 15811              END-IF
 15812           ELSE
 15813              IF WS-LF-COVERAGE-TYPE = 'L'
 15814                 MOVE '2'       TO CP-EARNING-METHOD
 15815              ELSE
 15816                 IF (PB-CI-LF-TERM > +60) OR
 15817                    (WS-LF-EARNINGS-CALC = '5')
 15818                    IF CP-CRITICAL-PERIOD
 15819                       MOVE '2'  TO CP-EARNING-METHOD
 15820                    ELSE
 15821                       MOVE '6'  TO CP-EARNING-METHOD
 15822                    END-IF
 15823                 ELSE
 15824                    MOVE '1'     TO CP-EARNING-METHOD
 15825                 END-IF
 15826              END-IF
 15827           END-IF
 15828        END-IF
 15829     END-IF
 15830
 15831*    IF CP-STATE-STD-ABBRV = 'VA'
 15832*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15833*          IF CP-ORIGINAL-TERM GREATER 61
 15834*             MOVE '6' TO CP-EARNING-METHOD
 15835*          ELSE
 15836*             MOVE '1' TO CP-EARNING-METHOD.
 15837
 15838     IF WS-DEFAULT-APR NOT NUMERIC
 15839         MOVE ZEROS TO WS-DEFAULT-APR.
 15840     IF CP-EARN-AS-NET-PAY
 15841         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15842            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15843                MOVE WS-DEFAULT-APR
 15844                                 TO  CP-LOAN-APR
 15845                MOVE ER-3780     TO  WS-ERROR
 15846                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15847            ELSE
 15848                MOVE ER-3781     TO  WS-ERROR
 15849                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15850     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15851     IF PB-COMPANY-ID = 'DCC'
 15852        AND CP-CANCEL-REASON = 'R'
 15853        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15854        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15855     END-IF
 15856     IF PB-COMPANY-ID = 'DCC'
 15857        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15858        AND (CP-EARNING-METHOD = 'D')
 15859        AND (CP-CANCEL-REASON NOT = 'R')
 15860        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 287
* EL050.cbl
 15861     ELSE
 15862        GO TO 3750-CONTINUE
 15863     END-IF
 15864     MOVE ' '                    TO DD-IU-SW
 15865     IF NOT PDEF-MASTER-FOUND
 15866        MOVE ' '                 TO PDEF-MASTER-SW
 15867        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15868        MOVE PB-STATE            TO ERPDEF-STATE
 15869        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15870        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15871        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15872        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15873        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15874        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15875        IF PDEF-MASTER-FOUND
 15876           MOVE 'N'              TO PDEF-MASTER-SW
 15877           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15878           IF PDEF-MASTER-FOUND
 15879              IF (ERPDEF-KEY-SAVE (1:16) =
 15880                           PD-CONTROL-PRIMARY (1:16))
 15881                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15882                 CONTINUE
 15883              ELSE
 15884                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15885                 IF (ERPDEF-KEY-SAVE (1:16) =
 15886                           PD-CONTROL-PRIMARY (1:16))
 15887                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15888                    CONTINUE
 15889                 ELSE
 15890                    MOVE ER-2740 TO WS-ERROR
 15891                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15892                    GO TO 3770-CHECK-REFUNDS
 15893                 END-IF
 15894              END-IF
 15895           END-IF
 15896           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15897        END-IF
 15898     END-IF
 15899     IF PDEF-MASTER-FOUND
 15900        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15901           (V1 > +8)
 15902           OR (PD-PROD-CODE (V1) = 'I')
 15903        END-PERFORM
 15904        IF V1 < +9
 15905           SET DD-IU-PRESENT        TO TRUE
 15906        END-IF
 15907        IF WS-AH-DCC-TRUNC = 'T'
 15908           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 15909        ELSE
 15910           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 15911        END-IF
 15912        EVALUATE TRUE
 15913           WHEN WS-TERM > +168
 15914              MOVE 15               TO V1
 15915           WHEN WS-TERM > +156
 15916              MOVE 14               TO V1
 15917           WHEN WS-TERM > +144
 15918              MOVE 13               TO V1
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 288
* EL050.cbl
 15919           WHEN WS-TERM > +132
 15920              MOVE 12               TO V1
 15921           WHEN WS-TERM > +120
 15922              MOVE 11               TO V1
 15923           WHEN WS-TERM > +108
 15924              MOVE 10               TO V1
 15925           WHEN WS-TERM > +96
 15926              MOVE 9                TO V1
 15927           WHEN WS-TERM > +84
 15928              MOVE 8                TO V1
 15929           WHEN WS-TERM > +72
 15930              MOVE 7                TO V1
 15931           WHEN WS-TERM > +60
 15932              MOVE 6                TO V1
 15933           WHEN WS-TERM > +48
 15934              MOVE 5                TO V1
 15935           WHEN WS-TERM > +36
 15936              MOVE 4                TO V1
 15937           WHEN WS-TERM > +24
 15938              MOVE 3                TO V1
 15939           WHEN WS-TERM > +12
 15940              MOVE 2                TO V1
 15941           WHEN OTHER
 15942              MOVE 1                TO V1
 15943        END-EVALUATE
 15944
 15945        EVALUATE TRUE
 15946*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 15947*             < +13)
 15948*             AND (DD-IU-PRESENT)
 15949*             MOVE 2                TO V2
 15950*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15951*             MOVE 1                TO V2
 15952           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 15953              MOVE 2                TO V2
 15954           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 15955              MOVE 3                TO V2
 15956           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 15957              MOVE 4                TO V2
 15958           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 15959              MOVE 5                TO V2
 15960           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 15961              MOVE 6                TO V2
 15962           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 15963              MOVE 7                TO V2
 15964           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 15965              MOVE 8                TO V2
 15966           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 15967              MOVE 9                TO V2
 15968           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 15969              MOVE 10               TO V2
 15970           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 15971              MOVE 11               TO V2
 15972           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 15973              MOVE 12               TO V2
 15974           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 15975              MOVE 13               TO V2
 15976           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 289
* EL050.cbl
 15977              MOVE 14               TO V2
 15978           WHEN OTHER
 15979              MOVE 15               TO V2
 15980        END-EVALUATE
 15981
 15982        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 15983                                 TO CP-DDF-LO-FACT
 15984        MOVE PD-UEP-FACTOR (V1 V2)
 15985                                 TO CP-DDF-HI-FACT
 15986
 15987        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 15988        MOVE CM-AH-CLP     TO CP-DDF-CLP
 15989        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 15990           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 15991        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 15992        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 15993        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 15994           + PD-1ST-YR-ADMIN-ALLOW
 15995
 15996        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15997*       IF PI-CLP-YN = 'Y'
 15998*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 15999*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16000*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16001*       END-IF
 16002
 16003        IF DD-IU-PRESENT
 16004           MOVE 'I'              TO CP-EARNING-METHOD
 16005        END-IF
 16006        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16007                                     CP-CLP-RATE-UP
 16008        IF CP-IU-RATE-UP NOT = ZEROS
 16009           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16010              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16011           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16012              / (1 - WS-WORK-FACT)
 16013        END-IF
 16014     END-IF
 16015     .
 16016 3750-CONTINUE.
 16017     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16018
 16019     IF CP-REFUND-TYPE-USED NOT = SPACE
 16020         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16021
 16022     IF CP-ERROR-RATE-IS-ZERO OR
 16023        CP-ERROR-RATE-NOT-FOUND
 16024        MOVE ER-2740             TO WS-ERROR
 16025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16026
 16027     IF CP-ERROR-RATE-FILE-NOTOPEN
 16028        MOVE ER-2617             TO WS-ERROR
 16029        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16030     IF PB-COMPANY-ID = 'DCC'
 16031        AND PB-CI-ENTRY-STATUS = 'M'
 16032        MOVE +0                  TO PB-C-AH-REF-CALC
 16033     ELSE
 16034        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 290
* EL050.cbl
 16035     END-IF
 16036     IF PB-COMPANY-ID = 'DCC'
 16037        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16038        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16039        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16040        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16041        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16042        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16043        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16044        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16045        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16046     END-IF
 16047     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 291
* EL050.cbl
 16049
 16050 3770-CHECK-REFUNDS.
 16051
 16052     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16053        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16054           MOVE ER-2766          TO WS-ERROR
 16055           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16056           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16057           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16058              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16059
 16060     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16061        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16062           MOVE ER-2766          TO WS-ERROR
 16063           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16064           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16065           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16066              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16067
 16068     IF PB-COMP-LF-CANCEL
 16069        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16070        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16071           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16072              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16073
 16074     IF PB-COMP-AH-CANCEL
 16075        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16076        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16077           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16078              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16079
 16080     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16081             GIVING WS-UNSIGN-WRK1
 16082     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16083             GIVING WS-UNSIGN-WRK2.
 16084
 16085     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16086         MOVE ZERO TO WS-UNSIGN-WRK1.
 16087
 16088     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16089         MOVE ZERO TO WS-UNSIGN-WRK2.
 16090
 16091     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16092
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 292
* EL050.cbl
 16094
 16095 3772-CONTINUE.
 16096
 16097**********************************
 16098*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16099*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16100*** DOUBLES THE TOLERANCE AMOUNT.
 16101***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16102**********************************
 16103     IF PB-COMPANY-ID = 'MON'
 16104     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16105         IF WS-REF-REJECT-SW = SPACE
 16106             MOVE ER-2754        TO WS-ERROR
 16107             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16108           ELSE
 16109             MOVE ER-2736        TO WS-ERROR
 16110             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16111**********************************
 16112
 16113 3773-CONTINUE.
 16114
 16115     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16116        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16117           MOVE ER-2723          TO WS-ERROR
 16118           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16119
 16120     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16121        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16122           MOVE ER-2724          TO WS-ERROR
 16123           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16124
 16125     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16126         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16127             (1 + WS-LF-REFUND-OVS-PCT)
 16128     ELSE
 16129         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16130
 16131     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16132         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16133             (1 - WS-TOL-LF-REFUND-PCT)
 16134     ELSE
 16135         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16136
 16137     IF (PB-COMPANY-ID = 'DCC')
 16138        AND (PB-CI-ENTRY-STATUS = 'M')
 16139        AND (PB-C-LF-CANCEL-AMT > +0)
 16140        MOVE ER-3843             TO WS-ERROR
 16141        PERFORM 9900-ERROR-FORMAT
 16142                                 THRU 9900-EXIT
 16143     END-IF
 16144     EVALUATE TRUE
 16145        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16146           CONTINUE
 16147        WHEN PB-C-LF-CANCEL-AMT = +0
 16148                 AND PB-C-LF-REF-CALC > +0
 16149           CONTINUE
 16150        WHEN WS-LF-REFUND-OVS-AMT = 0
 16151                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 293
* EL050.cbl
 16152           CONTINUE
 16153        WHEN OTHER
 16154           IF WS-TOL-LF-REFUND  = +0
 16155              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16156           END-IF
 16157           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16158                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16159                          (PB-C-LF-CANCEL-AMT))
 16160              CONTINUE
 16161           ELSE
 16162              IF WS-LF-REFUND-OVS-AMT = +0
 16163                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16164              END-IF
 16165              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16166                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16167                                       PB-C-LF-CANCEL-AMT)
 16168                 CONTINUE
 16169              ELSE
 16170                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16171                   MOVE ER-2754   TO  WS-ERROR
 16172                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16173                 ELSE
 16174                    MOVE ER-2736   TO  WS-ERROR
 16175                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16176                 END-IF
 16177              END-IF
 16178           END-IF
 16179     END-EVALUATE.
 16180
 16181     EVALUATE TRUE
 16182        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16183           CONTINUE
 16184        WHEN PB-C-LF-CANCEL-AMT = +0
 16185                 AND PB-C-LF-REF-CALC > +0
 16186           CONTINUE
 16187        WHEN OTHER
 16188           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16189               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16190              CONTINUE
 16191           ELSE
 16192              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16193               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16194                CONTINUE
 16195              ELSE
 16196                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16197                     MOVE ER-2754   TO  WS-ERROR
 16198                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16199                 ELSE
 16200                     MOVE ER-2736   TO  WS-ERROR
 16201                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16202                 END-IF
 16203              END-IF
 16204           END-IF
 16205     END-EVALUATE.
 16206
 16207     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16208         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16209             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 294
* EL050.cbl
 16210     ELSE
 16211         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16212
 16213     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16214         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16215             (1 - WS-TOL-AH-REFUND-PCT)
 16216     ELSE
 16217         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16218
 16219     IF (PB-COMPANY-ID = 'DCC')
 16220        AND (PB-CI-ENTRY-STATUS = 'M')
 16221        AND (PB-C-AH-CANCEL-AMT > +0)
 16222        MOVE ER-3843             TO WS-ERROR
 16223        PERFORM 9900-ERROR-FORMAT
 16224                                 THRU 9900-EXIT
 16225     END-IF
 16226     EVALUATE TRUE
 16227        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16228           CONTINUE
 16229*       WHEN PB-C-AH-REF-CALC = +0 AND
 16230*                  PB-C-AH-CANCEL-AMT > +0
 16231        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16232                   PB-C-AH-REF-CALC > +0
 16233           CONTINUE
 16234        WHEN WS-AH-REFUND-OVS-AMT = +0
 16235                AND WS-TOL-AH-REFUND = +0
 16236           CONTINUE
 16237        WHEN OTHER
 16238           IF WS-TOL-AH-REFUND = +0
 16239              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16240           END-IF
 16241           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16242               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16243                                         PB-C-AH-CANCEL-AMT)
 16244              CONTINUE
 16245           ELSE
 16246              IF WS-AH-REFUND-OVS-AMT = +0
 16247                 MOVE +9999999.99 TO
 16248                         WS-AH-REFUND-OVS-AMT
 16249              END-IF
 16250              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16251                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16252                                         PB-C-AH-CANCEL-AMT)
 16253                 CONTINUE
 16254              ELSE
 16255                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16256                    MOVE ER-2754   TO  WS-ERROR
 16257                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16258                 ELSE
 16259                    MOVE ER-2736   TO  WS-ERROR
 16260                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16261                 END-IF
 16262              END-IF
 16263           END-IF
 16264     END-EVALUATE.
 16265
 16266     EVALUATE TRUE
 16267        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 295
* EL050.cbl
 16268           CONTINUE
 16269*       WHEN PB-C-AH-REF-CALC > +0 AND
 16270*                  PB-C-AH-CANCEL-AMT = +0
 16271        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16272                   PB-C-AH-REF-CALC = +0
 16273           CONTINUE
 16274        WHEN OTHER
 16275           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16276               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16277              CONTINUE
 16278           ELSE
 16279              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16280                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16281                 CONTINUE
 16282              ELSE
 16283                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16284                     MOVE ER-2754   TO  WS-ERROR
 16285                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16286                 ELSE
 16287                     MOVE ER-2736   TO  WS-ERROR
 16288                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16289                 END-IF
 16290              END-IF
 16291           END-IF
 16292     END-EVALUATE.
 16293
 16294     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16295        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16296        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16297           AND  PB-C-LF-REF-CALC < +1.00
 16298           AND  PB-C-AH-REF-CALC < +1.00
 16299           CONTINUE
 16300        ELSE
 16301           IF (PB-COMPANY-ID = 'DCC')
 16302              AND (PB-CI-ENTRY-STATUS = 'M')
 16303              CONTINUE
 16304           ELSE
 16305              MOVE ER-2741       TO WS-ERROR
 16306              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16307           END-IF
 16308        END-IF
 16309     END-IF
 16310
 16311     IF (PB-C-LF-CANCEL-AMT = ZERO
 16312        AND WS-LF-BENEFIT-CD NOT = ZERO
 16313        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16314        AND PB-C-LF-REF-CALC NOT = ZERO)
 16315        OR
 16316        (PB-C-LF-CANCEL-AMT = ZERO
 16317        AND WS-LF-BENEFIT-CD NOT = ZERO
 16318        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16319             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16320                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16321                NEXT SENTENCE
 16322             ELSE
 16323                MOVE ER-2739        TO WS-ERROR
 16324                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16325
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 296
* EL050.cbl
 16326     IF (PB-C-AH-CANCEL-AMT = ZERO
 16327        AND WS-AH-BENEFIT-CD NOT = ZERO
 16328        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16329        AND PB-C-AH-REF-CALC NOT = ZERO)
 16330        OR
 16331        (PB-C-AH-CANCEL-AMT = ZERO
 16332        AND WS-AH-BENEFIT-CD NOT = ZERO
 16333        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16334             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16335                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16336                NEXT SENTENCE
 16337             ELSE
 16338                MOVE ER-2738        TO WS-ERROR
 16339                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16340
 16341 3775-OVER-REF-CHK.
 16342
 16343     IF PB-CI-ENTRY-STATUS = '5'
 16344        GO TO 3780-UPDATE-CANCEL-CERT.
 16345
 16346     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16347                              PB-CI-LF-ALT-PREMIUM-AMT.
 16348
 16349     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16350        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16351                                 PB-C-LF-REF-CALC
 16352      ELSE
 16353        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16354                                 PB-C-LF-CANCEL-AMT.
 16355
 16356     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16357        MOVE ER-2755             TO WS-ERROR
 16358        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16359
 16360     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16361
 16362     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16363        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16364                                 PB-C-AH-REF-CALC
 16365      ELSE
 16366        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16367                                 PB-C-AH-CANCEL-AMT.
 16368
 16369     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16370        MOVE ER-2778             TO WS-ERROR
 16371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16372
 16373     IF PB-CI-OB-FLAG NOT = 'Z'
 16374        NEXT SENTENCE
 16375       ELSE
 16376         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16377            MOVE ER-2757           TO WS-ERROR
 16378            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16379
 16380 3780-UPDATE-CANCEL-CERT.
 16381
 16382     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16383        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 297
* EL050.cbl
 16384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16385
 16386     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16387         MOVE ER-2729              TO WS-ERROR
 16388         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16389
 16390     IF PB-CI-LF-BENEFIT-CD = ZERO
 16391         GO TO 3780-UPDATE-CONT-1.
 16392
 16393     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16394         GO TO 3780-UPDATE-CONT-1.
 16395
 16396     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16397       AND
 16398        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16399       AND
 16400        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16401       AND
 16402        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16403            NEXT SENTENCE
 16404       ELSE
 16405        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16406          AND
 16407***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16408***       AND
 16409           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16410            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16411               MOVE ER-2730      TO WS-ERROR
 16412               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16413               GO TO 3999-END-EDIT
 16414            ELSE
 16415               GO TO 3999-END-EDIT
 16416        ELSE
 16417            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16418               MOVE ER-2765           TO WS-ERROR
 16419               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16420               GO TO 3785-CHECK-NH.
 16421*              GO TO 3999-END-EDIT.
 16422
 16423 3780-UPDATE-CONT-1.
 16424     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16425
 16426     IF PB-CI-AH-BENEFIT-CD = ZERO
 16427         GO TO 3780-UPDATE-CONT-2.
 16428
 16429     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16430         GO TO 3780-UPDATE-CONT-2.
 16431
 16432     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16433
 16434     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16435       AND
 16436        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16437       AND
 16438        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16439       AND
 16440        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16441            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 298
* EL050.cbl
 16442       ELSE
 16443        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16444          AND
 16445***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16446***       AND
 16447           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16448           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16449            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16450               MOVE ER-2773      TO WS-ERROR
 16451               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16452               GO TO 3999-END-EDIT
 16453            ELSE
 16454               GO TO 3999-END-EDIT
 16455            END-IF
 16456           ELSE
 16457             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16458                MOVE ER-2890 TO WS-ERROR
 16459                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16460                GO TO 3999-END-EDIT
 16461             ELSE
 16462                GO TO 3785-CHECK-NH
 16463             END-IF
 16464           END-IF
 16465          ELSE
 16466            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16467              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16468                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16469                   MOVE ER-2890 TO WS-ERROR
 16470                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16471                   GO TO 3999-END-EDIT
 16472                ELSE
 16473                   MOVE ER-2765 TO WS-ERROR
 16474                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16475                   GO TO 3785-CHECK-NH
 16476                END-IF
 16477              ELSE
 16478               MOVE ER-2765      TO WS-ERROR
 16479               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16480               GO TO 3785-CHECK-NH.
 16481*              GO TO 3999-END-EDIT.
 16482
 16483 3780-UPDATE-CONT-2.
 16484
 16485     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16486        AND WS-LF-BENEFIT-CD = ZERO
 16487           MOVE ER-2743           TO WS-ERROR
 16488           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16489
 16490     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16491        AND WS-AH-BENEFIT-CD = ZERO
 16492           MOVE ER-2744           TO WS-ERROR
 16493           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16494
 16495     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16496        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16497        AND
 16498        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16499         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 299
* EL050.cbl
 16500           MOVE ER-2746           TO WS-ERROR
 16501           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16502
 16503     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16504       AND
 16505        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16506             MOVE ER-2737        TO WS-ERROR
 16507             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16508
 16509     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16510       AND
 16511        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16512             MOVE ER-2737        TO WS-ERROR
 16513             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16514
 16515     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16516         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16517             OR 'CID' OR 'DCC' OR 'AHL'
 16518             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16519         ELSE
 16520             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16521                 MOVE ER-2768    TO WS-ERROR
 16522                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16523             ELSE
 16524                 MOVE ER-2756    TO WS-ERROR
 16525                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16526
 16527     IF CERT-PEND-ISSUE-RETURNED
 16528        MOVE ER-2772             TO WS-ERROR
 16529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16530 3785-CHECK-NH.
 16531     IF PB-STATE NOT = 'NH'
 16532        GO TO 3999-END-EDIT
 16533     END-IF
 16534
 16535     MOVE ER-2796                TO WS-ERROR
 16536     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16537     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16538        OR (CM-NH-INTERFACE-SW = 'Y')
 16539        MOVE ER-2793             TO WS-ERROR
 16540        PERFORM 9900-ERROR-FORMAT
 16541                                 THRU 9900-EXIT
 16542     END-IF
 16543     MOVE +0                     TO WS-PAYMENT-AMT
 16544     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16545        GO TO 3999-END-EDIT
 16546     END-IF
 16547     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16548        GO TO 3999-END-EDIT
 16549     END-IF
 16550     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16551     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16552     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16553        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16554     END-IF
 16555     MOVE '1'                    TO DC-OPTION-CODE
 16556     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16557     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 300
* EL050.cbl
 16558        IF DC-ELAPSED-DAYS < +16
 16559           GO TO 3999-END-EDIT
 16560        END-IF
 16561     END-IF
 16562     MOVE +0                     TO DC-ELAPSED-DAYS
 16563     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16564     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16565     MOVE '1'                    TO DC-OPTION-CODE
 16566     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16567     IF NO-CONVERSION-ERROR
 16568        IF DC-ELAPSED-DAYS > +30
 16569           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16570        ELSE
 16571           GO TO 3999-END-EDIT
 16572        END-IF
 16573     ELSE
 16574        GO TO 3999-END-EDIT
 16575     END-IF
 16576     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16577        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16578           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16579     IF WS-PAYMENT-AMT < 600.00
 16580        GO TO 3999-END-EDIT
 16581     END-IF
 16582     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16583
 16584     IF (ERMAIL-FOUND = ' ')
 16585         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16586         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16587        GO TO 3999-END-EDIT
 16588     END-IF
 16589     MOVE ER-2795                TO WS-ERROR
 16590     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16591
 16592     GO TO 3999-END-EDIT.
 16593******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 301
* EL050.cbl
 16595 3990-FILES-NOT-OPEN.
 16596
 16597     MOVE ER-2617                TO WS-ERROR.
 16598     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16599     GO TO 9990-RETURN.
 16600
 16601 3999-END-EDIT.
 16602
 16603     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16604
 16605     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16606         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16607         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16608             PERFORM 9250-UNLOCK-RETURN
 16609             GO TO 9990-RETURN
 16610          ELSE
 16611             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16612             GO TO 9990-RETURN.
 16613
 16614     IF PB-CANCELLATION
 16615          GO TO 9990-RETURN.
 16616
 16617     IF CERT-WAS-NOT-FOUND
 16618        MOVE SPACES              TO CERTIFICATE-MASTER.
 16619
 16620     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16621
 16622     IF CERT-WAS-FOUND
 16623         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16624             PERFORM 9250-UNLOCK-RETURN
 16625          ELSE
 16626            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16627      ELSE
 16628         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16629
 16630     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16631        IF PB-COMPANY-ID = 'DCC' AND
 16632           (PB-CARRIER = '2' OR '4' OR '6')
 16633              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16634        END-IF
 16635     END-IF.
 16636
 16637     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16638     IF ((PB-COMPANY-ID = 'DCC')
 16639        AND (WS-NO-SECURE-PAY))
 16640                  OR
 16641        (WS-LF-SPECIAL-CALC-CD = 'O'
 16642        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16643        SET SKIP-ADDR-EDIT       TO TRUE
 16644     END-IF
 16645     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16646        AND (NOT SKIP-ADDR-EDIT)
 16647        MOVE ER-2963             TO WS-ERROR
 16648        PERFORM 9900-ERROR-FORMAT
 16649                                 THRU 9900-EXIT
 16650        GO TO 9990-RETURN
 16651     END-IF
 16652     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 302
* EL050.cbl
 16653     IF ERPNDM-FOUND NOT = 'X'
 16654        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16655           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16656           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16657           AND (NOT SKIP-ADDR-EDIT)
 16658           MOVE ER-2694          TO WS-ERROR
 16659           PERFORM 9900-ERROR-FORMAT
 16660                                 THRU 9900-EXIT
 16661        END-IF
 16662        MOVE ' '                 TO STATE-RECORD-ERROR
 16663        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16664        MOVE PM-STATE            TO CNTL-ACCESS
 16665        MOVE '3'                 TO CNTL-REC-TYPE
 16666        MOVE +0                  TO CNTL-SEQ-NO
 16667        MOVE '0'                 TO RC-SW-2
 16668        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16669        IF (NO-STATE-RECORD)
 16670           OR (CF-RECORD-TYPE NOT = '3')
 16671           OR (PM-STATE NOT = CF-STATE-CODE)
 16672           IF (PM-STATE = SPACES)
 16673              AND (SKIP-ADDR-EDIT)
 16674              CONTINUE
 16675           ELSE
 16676              MOVE ER-2963       TO WS-ERROR
 16677              PERFORM 9900-ERROR-FORMAT
 16678                                 THRU 9900-EXIT
 16679           END-IF
 16680        END-IF
 16681        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16682           MOVE ER-2883          TO WS-ERROR
 16683           PERFORM 9900-ERROR-FORMAT
 16684                                 THRU 9900-EXIT
 16685        END-IF
 16686        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16687           MOVE ' '                 TO STATE-RECORD-ERROR
 16688           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16689           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16690           MOVE '3'                 TO CNTL-REC-TYPE
 16691           MOVE +0                  TO CNTL-SEQ-NO
 16692           MOVE '0'                 TO RC-SW-2
 16693           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16694           IF NO-STATE-RECORD
 16695              OR (CF-RECORD-TYPE NOT = '3')
 16696              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16697              MOVE ER-2964          TO WS-ERROR
 16698              PERFORM 9900-ERROR-FORMAT
 16699                                    THRU 9900-EXIT
 16700           END-IF
 16701        END-IF
 16702     ELSE
 16703        IF NOT SKIP-ADDR-EDIT
 16704           MOVE ER-2393          TO WS-ERROR
 16705           PERFORM 9900-ERROR-FORMAT
 16706                                 THRU 9900-EXIT
 16707        END-IF
 16708     END-IF
 16709
 16710     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 303
* EL050.cbl
 16711
 16712     IF (ERMAIL-FOUND = ' ' AND
 16713        ERPNDM-FOUND = ' ')
 16714        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16715           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16716           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16717          OR
 16718           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16719          OR
 16720           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16721           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16722           GO TO 3999-UNLOCK-ERMAIL.
 16723
 16724     IF ERPNDM-FOUND = 'X'
 16725        GO TO 3999-UNLOCK-ERMAIL.
 16726
 16727     IF PM-INSURED-LAST-NAME      = SPACES
 16728        AND PM-INSURED-FIRST-NAME = SPACES
 16729        AND PM-ADDRESS-LINE-1     = SPACES
 16730        AND PM-ADDRESS-LINE-2     = SPACES
 16731        AND PM-CITY-STATE         = SPACES
 16732        AND PM-CRED-BENE-NAME     = SPACES
 16733        AND PM-CRED-BENE-ADDR     = SPACES
 16734        AND PM-CRED-BENE-CTYST    = SPACES
 16735        GO TO 3999-UNLOCK-ERMAIL
 16736     END-IF
 16737
 16738     MOVE SPACES                 TO MAILING-DATA.
 16739
 16740     MOVE 'MA'                   TO MA-RECORD-ID.
 16741     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16742     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16743     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16744     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16745     MOVE PB-SV-STATE            TO MA-STATE.
 16746     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16747     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16748
 16749     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16750     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16751
 16752     IF ERMAIL-FOUND = ' '
 16753        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16754     ELSE
 16755        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16756        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16757        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16758
 16759     GO TO 9990-RETURN.
 16760
 16761 3999-UNLOCK-ERMAIL.
 16762     IF ERMAIL-FOUND = ' '
 16763        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16764
 16765     GO TO 9990-RETURN.
 16766******************************************************************
 16767
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 304
* EL050.cbl
 16769 4000-UPDATE-CANCELLED-CERT.
 16770     IF CERT-WAS-NOT-FOUND
 16771        GO TO 4299-EXIT.
 16772
 16773*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16774     IF PB-C-NH-INT-ON-REFS > ZEROS
 16775        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16776     END-IF
 16777     IF PB-C-REF-INTERFACE-SW = 'Y'
 16778        MOVE PB-C-REF-INTERFACE-SW
 16779                                 TO CM-NH-INTERFACE-SW
 16780     END-IF
 16781     IF PB-C-POST-CARD-IND = 'Y'
 16782        MOVE +8                  TO SUB
 16783        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16784        IF ERMAIL-FOUND = ' '
 16785           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16786              (SUB > +7)
 16787              OR (MA-MAIL-STATUS (SUB) = '1')
 16788           END-PERFORM
 16789        END-IF
 16790        IF (SUB > +7)
 16791           OR (ERMAIL-FOUND = 'X')
 16792           MOVE ER-3789          TO WS-ERROR
 16793           PERFORM 9900-ERROR-FORMAT
 16794                                 THRU 9900-EXIT
 16795        END-IF
 16796     ELSE
 16797        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16798     END-IF
 16799     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16800
 16801     IF PB-CI-OB-FLAG = 'Z'
 16802        GO TO 4150-SUMMARY-CERT-CANCEL.
 16803
 16804     IF PB-C-LF-CANCEL-VOIDED
 16805         PERFORM 4200-REVERSE-LF-CANCEL.
 16806     IF PB-C-AH-CANCEL-VOIDED
 16807         PERFORM 4200-REVERSE-AH-CANCEL.
 16808
 16809 4100-APPLY-LF-CANCEL.
 16810
 16811     MOVE +0                     TO WS-SUB.
 16812
 16813 4100-CHECK-LF-ERRORS.
 16814
 16815     ADD +1                       TO WS-SUB.
 16816
 16817     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16818        IF LF-COVERAGE-CANCELLED
 16819           GO TO 4100-LF-CANCEL-CONT
 16820        ELSE
 16821           GO TO 4100-UPDATE-LF-COVERAGE.
 16822
 16823     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16824                                   ER-2729 OR
 16825                                   ER-2730 OR
 16826                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 305
* EL050.cbl
 16827                                   ER-2732 OR
 16828                                   ER-2737 OR
 16829                                   ER-2740 OR
 16830                                   ER-2743 OR
 16831                                   ER-2749 OR
 16832                                   ER-2750 OR
 16833                                   ER-2755 OR
 16834                                   ER-2757 OR
 16835                                   ER-2760 OR
 16836                                   ER-2772 OR
 16837                                   ER-2774 OR
 16838                                   ER-2776 OR
 16839                                   ER-2794
 16840        GO TO 4100-UPDATE-LF-COVERAGE.
 16841
 16842     GO TO 4100-CHECK-LF-ERRORS.
 16843
 16844 4100-UPDATE-LF-COVERAGE.
 16845
 16846     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16847     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16848     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16849        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16850     END-IF
 16851     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16852                                      TO CM-CREDIT-INTERFACE-SW-2.
 16853     IF CM-LF-CANCEL-DT = LOW-VALUE
 16854         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16855
 16856     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16857         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16858                                         CM-LF-STATUS-AT-CANCEL.
 16859
 16860     GO TO 4100-APPLY-AH-CANCEL.
 16861
 16862 4100-LF-CANCEL-CONT.
 16863     IF PB-C-LF-CANCEL-VOIDED
 16864         GO TO 4100-APPLY-AH-CANCEL.
 16865
 16866     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16867         GO TO 4100-APPLY-AH-CANCEL.
 16868
 16869     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16870        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16871           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16872        ELSE
 16873           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16874
 16875     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16876     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16877
 16878     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16879         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 16880
 16881     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 16882        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 16883         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 16884         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 306
* EL050.cbl
 16885
 16886     IF PB-RECORD-RETURNED
 16887        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16888      ELSE
 16889        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 16890
 16891 4100-APPLY-AH-CANCEL.
 16892
 16893     MOVE +0                      TO WS-SUB.
 16894
 16895 4100-CHECK-AH-ERRORS.
 16896
 16897     ADD +1                       TO WS-SUB.
 16898
 16899     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16900        IF AH-COVERAGE-CANCELLED
 16901           GO TO 4100-AH-CANCEL-CONT
 16902        ELSE
 16903           GO TO 4100-UPDATE-AH-COVERAGE.
 16904
 16905     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16906                                   ER-2729 OR
 16907                                   ER-2732 OR
 16908                                   ER-2737 OR
 16909                                   ER-2740 OR
 16910                                   ER-2744 OR
 16911                                   ER-2749 OR
 16912                                   ER-2750 OR
 16913                                   ER-2755 OR
 16914                                   ER-2757 OR
 16915                                   ER-2760 OR
 16916                                   ER-2771 OR
 16917                                   ER-2772 OR
 16918                                   ER-2773 OR
 16919                                   ER-2775 OR
 16920                                   ER-2777 OR
 16921                                   ER-2794
 16922        GO TO 4100-UPDATE-AH-COVERAGE.
 16923
 16924     GO TO 4100-CHECK-AH-ERRORS.
 16925
 16926 4100-UPDATE-AH-COVERAGE.
 16927
 16928     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 16929     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 16930     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 16931     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16932                                      TO CM-CREDIT-INTERFACE-SW-2.
 16933     IF CM-AH-CANCEL-DT = LOW-VALUE
 16934         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 16935
 16936     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 16937         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 16938                                         CM-AH-STATUS-AT-CANCEL.
 16939
 16940     IF LF-COVERAGE-CANCELLED
 16941         IF PB-RECORD-RETURNED
 16942              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 307
* EL050.cbl
 16943          ELSE
 16944              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 16945
 16946     GO TO 4299-EXIT.
 16947
 16948 4100-AH-CANCEL-CONT.
 16949     IF PB-C-AH-CANCEL-VOIDED
 16950         GO TO 4299-EXIT.
 16951
 16952     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16953         GO TO 4299-EXIT.
 16954
 16955     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 16956        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16957           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 16958        ELSE
 16959           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 16960
 16961     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 16962     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 16963
 16964     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 16965         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 16966
 16967     IF CM-AH-STATUS-AT-CANCEL = SPACE
 16968         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 16969         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 16970
 16971     IF PB-RECORD-RETURNED
 16972        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 16973      ELSE
 16974        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 16975
 16976     GO TO 4299-EXIT.
 16977
 16978 4150-SUMMARY-CERT-CANCEL.
 16979     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 16980
 16981     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16982        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16983                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 16984     ELSE
 16985        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16986                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 16987
 16988     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16989        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16990                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 16991     ELSE
 16992        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16993                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 16994
 16995     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16996        NEXT SENTENCE
 16997     ELSE
 16998        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 16999
 17000     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 308
* EL050.cbl
 17001
 17002 4200-REVERSE-LF-CANCEL.
 17003     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17004
 17005     IF CM-LF-CANCEL-APPLIED
 17006        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17007        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17008        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17009
 17010     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17011
 17012     IF PB-RECORD-RETURNED
 17013        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17014       ELSE
 17015        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17016
 17017 4200-REVERSE-LF-EXIT.
 17018       EXIT.
 17019
 17020 4200-REVERSE-AH-CANCEL.
 17021     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17022
 17023     IF CM-AH-CANCEL-APPLIED
 17024        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17025        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17026        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17027
 17028     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17029
 17030     IF PB-RECORD-RETURNED
 17031        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17032       ELSE
 17033        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17034
 17035 4200-REVERSE-AH-EXIT.
 17036       EXIT.
 17037
 17038 4299-EXIT.
 17039       EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 309
* EL050.cbl
 17041
 17042 4500-UPDATE-NEW-CERT.
 17043     IF CERT-WAS-FOUND
 17044         NEXT SENTENCE
 17045       ELSE
 17046         GO TO 4520-BUILD-NEW-KEY.
 17047
 17048     IF  CLASIC-CREATED-CERT
 17049         GO TO 4999-EXIT.
 17050
 17051     IF  CERT-WAS-CREATED-FOR-CLAIM
 17052         GO TO 4520-BUILD-NEW-KEY.
 17053
 17054     IF CERT-ADDED-BATCH
 17055        IF CM-RECORD-ID = 'CM'
 17056            GO TO 4999-EXIT.
 17057
 17058 4520-BUILD-NEW-KEY.
 17059* BUILD CONTROL PRIMARY
 17060
 17061     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17062                                       CM-COMPANY-CD-A1
 17063                                       CM-COMPANY-CD-A2
 17064                                       CM-COMPANY-CD-A4
 17065                                       CM-COMPANY-CD-A5.
 17066
 17067     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17068     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17069     MOVE PB-SV-STATE               TO CM-STATE.
 17070     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17071     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17072     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17073     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17074
 17075     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17076
 17077     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17078     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17079     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17080     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17081
 17082     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17083        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17084
 17085     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17086         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17087         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17088         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17089         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17090     ELSE
 17091         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17092
 17093     IF PB-COMPANY-ID   EQUAL  'CRI'
 17094         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17095         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17096         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17097         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17098         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 310
* EL050.cbl
 17099
 17100     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17101        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17102         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17103
 17104     IF PB-COMPANY-ID  = 'LBL'
 17105        IF PB-I-JOINT-COVERAGE
 17106            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17107                                           PB-I-MEMBER-NO
 17108            GO TO 4550-CONT-CERT-PROCESS.
 17109
 17110     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17111        NEXT SENTENCE
 17112     ELSE
 17113        GO TO 4540-BUILD-MEMBER-NO.
 17114
 17115******************************************************************
 17116*                                                                *
 17117*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17118*    FOR 'MON'.                                                  *
 17119*                                                                *
 17120******************************************************************
 17121
 17122     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17123     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17124     MOVE +1                     TO WS-SUB1
 17125                                    WS-SUB2.
 17126
 17127 4530-EDIT-MEMB-NAME.
 17128
 17129     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17130        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17131        ADD +1                       TO WS-SUB2.
 17132
 17133     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17134        ADD +1                       TO WS-SUB1
 17135        GO TO 4530-EDIT-MEMB-NAME.
 17136
 17137     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17138     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17139     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17140*    MOVE SPACE                      TO DC-OPTION-CODE.
 17141     SET  BIN-TO-GREG                TO TRUE.
 17142     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17143     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17144
 17145     GO TO 4550-CONT-CERT-PROCESS.
 17146
 17147******************************************************************
 17148*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17149******************************************************************
 17150
 17151 4540-BUILD-MEMBER-NO.
 17152
 17153     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17154         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17155         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17156         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 311
* EL050.cbl
 17157         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17158     ELSE
 17159         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17160
 17161     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17162        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17163         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17164
 17165 4550-CONT-CERT-PROCESS.
 17166
 17167*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17168*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17169*    ELSE
 17170*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17171
 17172     IF CERT-WAS-CREATED-FOR-CLAIM
 17173        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17174        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17175
 17176     IF CERT-AND-CLAIM-ONLINE
 17177        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17178        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17179
 17180     MOVE 'CM'                     TO CM-RECORD-ID.
 17181     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17182
 17183     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17184        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17185        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17186     ELSE
 17187        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17188        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17189
 17190     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17191     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17192     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17193     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17194     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17195     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17196     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17197                                      CM-LF-ITD-CANCEL-AMT
 17198                                      CM-LF-ITD-DEATH-AMT
 17199                                      CM-AH-ITD-AH-PMT
 17200                                      CM-AH-ITD-LUMP-PMT
 17201                                      CM-AH-ITD-CANCEL-AMT
 17202                                      CM-LF-NSP-PREMIUM-AMT
 17203                                      CM-AH-NSP-PREMIUM-AMT.
 17204*                                     CM-CLAIM-DEDUCT-WITHHELD
 17205*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17206     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17207     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17208     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17209     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17210     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17211     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17212     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17213     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17214     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 312
* EL050.cbl
 17215     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17216     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17217     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17218
 17219     IF PB-I-LIVES NOT NUMERIC
 17220         MOVE ZERO                 TO PB-I-LIVES.
 17221
 17222     IF PB-I-NUM-BILLED NOT NUMERIC
 17223         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17224
 17225     MOVE PB-I-LIVES               TO CM-LIVES.
 17226     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17227
 17228     IF PB-COMPANY-ID EQUAL  'DMD'
 17229         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17230         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17231
 17232     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17233     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17234     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17235     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17236     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17237     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17238
 17239     IF PB-I-LF-POLICY-FEE NUMERIC
 17240        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17241     ELSE
 17242        MOVE +0                    TO CM-LF-POLICY-FEE.
 17243
 17244     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17245        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17246        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17247     ELSE
 17248        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17249
 17250     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17251     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17252     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17253     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17254     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17255     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17256     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17257     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17258     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17259
 17260     IF PB-I-AH-POLICY-FEE NUMERIC
 17261        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17262     ELSE
 17263        MOVE +0                    TO CM-AH-POLICY-FEE.
 17264
 17265     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17266        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17267     ELSE
 17268        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17269
 17270     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17271     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17272
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 313
* EL050.cbl
 17273     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17274                                      CM-LF-DEATH-EXIT-DT
 17275                                      CM-AH-SETTLEMENT-EXIT-DT.
 17276
 17277*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17278*                       'TIH' OR 'OFL' OR 'FLA' OR
 17279*                       'TII' OR 'TMS' OR 'CRI' OR
 17280*                       'NCL'
 17281     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17282
 17283     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17284         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17285            MOVE '2'                TO CM-PREMIUM-TYPE.
 17286
 17287     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17288         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17289            MOVE '2'                TO CM-PREMIUM-TYPE.
 17290
 17291     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17292         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17293     ELSE
 17294         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17295         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17296
 17297     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17298     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17299     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17300     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17301     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17302     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17303     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17304     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17305
 17306     IF PB-NO-MONTHS-SKIPPED
 17307         MOVE SPACE                 TO CM-SKIP-CODE
 17308     ELSE
 17309         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17310
 17311     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17312     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17313                                       CM-LF-STATUS-AT-CANCEL.
 17314
 17315     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17316     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17317                                       CM-AH-STATUS-AT-CANCEL.
 17318
 17319     MOVE '1'                       TO CM-ENTRY-STATUS.
 17320
 17321     IF PB-REISSUED-CERT
 17322        MOVE '5'                    TO CM-ENTRY-STATUS.
 17323
 17324     IF PB-MONTHLY-CERT
 17325        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17326
 17327     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17328     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17329     IF PB-POLICY-IS-DECLINED
 17330        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 314
* EL050.cbl
 17331
 17332     IF PB-POLICY-IS-VOIDED
 17333        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17334
 17335     IF PB-NEEDS-UNDERWRITING
 17336        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17337
 17338     IF PB-REIN-ONLY-CERT
 17339        MOVE '9'                    TO CM-ENTRY-STATUS.
 17340
 17341     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17342         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17343     ELSE
 17344         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17345
 17346     IF PB-RECORD-RETURNED
 17347        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17348      ELSE
 17349        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17350
 17351     IF PB-I-MAIL-ADDRS-PRESENT
 17352        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17353
 17354     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17355                                       CM-ENTRY-DT.
 17356
 17357 4999-EXIT.
 17358     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 315
* EL050.cbl
 17360
 17361 5000-PROCESS-REPS.
 17362     MOVE ' '                    TO AGTC-MASTER-SW
 17363     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17364     MOVE CO-TYPE                TO AGTC-TYPE
 17365     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17366     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17367     IF (AGTC-MASTER-SW NOT = 'N')
 17368        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17369        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17370        PERFORM 8583-READ-ERAGTC-NEXT
 17371                                 THRU 8583-EXIT
 17372     END-IF
 17373     IF AGTC-MASTER-SW = 'N'
 17374        CONTINUE
 17375     ELSE
 17376        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17377           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17378              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17379              MOVE 'Y'           TO AGTC-MASTER-SW
 17380           END-IF
 17381        END-IF
 17382     END-IF
 17383     .
 17384 5000-EXIT.
 17385     EXIT.
 17386 6370-EDIT-INPUT-LF-CODE.
 17387     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17388        MOVE +1                  TO SUB
 17389        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17390        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17391        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17392        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17393        GO TO 6370-SEARCH-LOOP.
 17394
 17395     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17396
 17397     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17398     MOVE SPACES                 TO CNTL-ACCESS.
 17399*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17400     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17401     MOVE +0                     TO CNTL-SEQ-NO.
 17402     MOVE '4' TO RC-SW-2.
 17403     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17404
 17405     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17406        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17407        GO TO 6370-NO-LF-FOUND.
 17408
 17409     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17410     MOVE +1                     TO SUB.
 17411
 17412 6370-SEARCH-LOOP.
 17413     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17414         GO TO 6370-NO-LF-FOUND.
 17415
 17416     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17417         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 316
* EL050.cbl
 17418         GO TO 6370-HER-NET-PAY-CHECK.
 17419
 17420     ADD 1   TO SUB.
 17421*    IF SUB GREATER 120
 17422     IF SUB GREATER 200
 17423         GO TO 6370-NO-LF-FOUND.
 17424
 17425     GO TO 6370-SEARCH-LOOP.
 17426
 17427 6370-NO-LF-FOUND.
 17428
 17429     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17430
 17431 6370-HER-NET-PAY-CHECK.
 17432
 17433     IF PB-COMPANY-ID = 'CID'
 17434        IF PB-SV-STATE = 'CA' OR 'MN'
 17435           IF PB-I-LF-BENEFIT-CD = '02'
 17436              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17437           ELSE
 17438              IF PB-I-LF-BENEFIT-CD = '04'
 17439                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17440              END-IF
 17441           END-IF
 17442        END-IF
 17443     END-IF
 17444
 17445     IF PB-COMPANY-ID NOT = 'HER'
 17446         GO TO 6370-EXIT.
 17447
 17448     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17449         GO TO 6370-EXIT.
 17450
 17451     IF PB-I-LF-TERM NOT NUMERIC
 17452         MOVE ZEROS              TO PB-I-LF-TERM.
 17453
 17454     IF PB-I-LOAN-TERM NOT NUMERIC
 17455         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17456
 17457     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17458         GO TO 6370-EXIT.
 17459
 17460     IF PB-I-LF-BENEFIT-CD = '33'
 17461         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17462
 17463     IF PB-I-LF-BENEFIT-CD = '34'
 17464         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17465
 17466 6370-EXIT.
 17467     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 317
* EL050.cbl
 17469
 17470 6380-EDIT-INPUT-AH-CODE.
 17471     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17472        MOVE +1                  TO SUB
 17473        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17474        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17475        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17476        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17477        GO TO 6380-SEARCH-LOOP.
 17478
 17479     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17480
 17481     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17482     MOVE SPACES                 TO CNTL-ACCESS.
 17483     MOVE 'A'                    TO CNTL-REC-TYPE.
 17484*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17485     MOVE +0                     TO CNTL-SEQ-NO.
 17486     MOVE '5' TO RC-SW-2.
 17487     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17488
 17489     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17490        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17491        GO TO 6380-NO-AH-FOUND.
 17492
 17493     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17494     MOVE +1 TO SUB.
 17495
 17496 6380-SEARCH-LOOP.
 17497     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17498         GO TO 6380-NO-AH-FOUND.
 17499
 17500     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17501         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17502         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17503
 17504     ADD 1   TO SUB.
 17505     IF SUB GREATER THAN 96
 17506*    IF SUB GREATER THAN 300
 17507         GO TO 6380-NO-AH-FOUND.
 17508
 17509     GO TO 6380-SEARCH-LOOP.
 17510
 17511 6380-NO-AH-FOUND.
 17512
 17513     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17514
 17515     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17516         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17517     ELSE
 17518         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17519
 17520 6380-CSO-AH-ONLY-CHECKS.
 17521
 17522     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17523        NEXT SENTENCE
 17524      ELSE
 17525        GO TO 6380-EXIT.
 17526
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 318
* EL050.cbl
 17527     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17528         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17529
 17530
 17531     GO TO 6380-EXIT
 17532     .
 17533 6380-CSO-LIFE-WITH-AH-CHECKS.
 17534
 17535
 17536     .
 17537 6380-EXIT.
 17538     EXIT.
 17539
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 319
* EL050.cbl
 17541
 17542 6400-COMPUTE-EXTENSION-DAYS.
 17543
 17544******************************************************************
 17545*                                                                *
 17546*                   COMPUTE EXTENSION DAYS                       *
 17547*                                                                *
 17548*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17549*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17550*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17551*    THE EXTENSION DAYS.                                         *
 17552*                                                                *
 17553******************************************************************
 17554
 17555     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17556     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17557
 17558******************************************************************
 17559*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17560*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17561******************************************************************
 17562
 17563     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17564        COMPUTE WS-ODD-DAYS-OVER =
 17565               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17566     ELSE
 17567        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17568
 17569     IF WS-ODD-DAYS-OVER = ZEROS
 17570           GO TO 6499-EXIT
 17571     ELSE
 17572        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17573           IF WS-WDF-MONTH = 02
 17574              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17575              ADD 2       TO  WS-ODD-DAYS-OVER
 17576              GO TO 6499-EXIT
 17577           ELSE
 17578              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17579                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17580                 GO TO 6499-EXIT
 17581               ELSE
 17582                 GO TO 6499-EXIT
 17583        ELSE
 17584           GO TO 6499-EXIT.
 17585
 17586 6412-CHECK-TO-DAY.
 17587
 17588        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17589           IF WS-WDT-DAY = 28
 17590              ADD 2              TO WS-ODD-DAYS-OVER
 17591           ELSE
 17592              IF WS-WDT-DAY = 29
 17593                 ADD 1           TO WS-ODD-DAYS-OVER
 17594              ELSE
 17595                 NEXT SENTENCE
 17596        ELSE
 17597           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17598              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 320
* EL050.cbl
 17599
 17600     GO TO 6499-EXIT.
 17601
 17602
 17603 6415-CHECK-LEAP-YEAR.
 17604
 17605     IF DC-DAYS-IN-MONTH = 29
 17606        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17607
 17608 6415-EXIT.
 17609     EXIT.
 17610
 17611 6499-EXIT.
 17612      EXIT.
 17613
 17614 6500-END.
 17615     EXIT.
 17616
 17617
 17618******************************************************************
 17619************* PROCEDURE DIVISION FOR EL050 ***********************
 17620********************** ELC50PD END *******************************
 17621
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 321
* EL050.cbl
 17623
 17624**START***********************************************************
 17625*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17626*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17627******************************************************************
 17628*
 17629 6600-GET-STATE-MUNICIPAL-TAX.
 17630
 17631     IF PB-COMPANY-ID NOT = 'DMD'
 17632         GO TO 6640-EXIT.
 17633
 17634     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17635     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17636     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17637*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17638*
 17639***  Y2K PROJ 7744
 17640     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17641     SET BIN-TO-GREG          TO TRUE.
 17642     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17643
 17644     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17645
 17646     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17647     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17648
 17649
 17650* EXEC CICS HANDLE CONDITION
 17651*        INVREQ    (6610-START-BROWSE)
 17652*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17653*        NOTFND    (6630-END-OF-FILE)
 17654*    END-EXEC.
 17655*    MOVE '"$8JI                 ! # #00017637' TO DFHEIV0
 17656     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17658     MOVE X'2320233030303137363337' TO DFHEIV0(25:11)
 17659     CALL 'kxdfhei1' USING DFHEIV0
 17660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17661
 17662
 17663 6610-START-BROWSE.
 17664
 17665
 17666* EXEC CICS HANDLE CONDITION
 17667*        NOTFND    (6630-END-OF-FILE)
 17668*        DISABLED  (6630-ERRESS-PROBLEM)
 17669*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17670*        ENDFILE   (6630-END-OF-FILE)
 17671*    END-EXEC.
 17672*    MOVE '"$IcJ''                ! $ #00017645' TO DFHEIV0
 17673     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17674     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17675     MOVE X'2420233030303137363435' TO DFHEIV0(25:11)
 17676     CALL 'kxdfhei1' USING DFHEIV0
 17677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17678
 17679
 17680
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 322
* EL050.cbl
 17681* EXEC CICS STARTBR
 17682*        DATASET (FILE-ID-ERRESS)
 17683*        RIDFLD  (WS-ERRESS-KEY)
 17684*        GTEQ
 17685*    END-EXEC.
 17686     MOVE 0
 17687       TO DFHEIV11
 17688*    MOVE '&,         G          &   #00017652' TO DFHEIV0
 17689     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17690     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17691     MOVE X'2020233030303137363532' TO DFHEIV0(25:11)
 17692     CALL 'kxdfhei1' USING DFHEIV0,
 17693           FILE-ID-ERRESS,
 17694           WS-ERRESS-KEY,
 17695           DFHEIV99,
 17696           DFHEIV11,
 17697           DFHEIV99
 17698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17699
 17700
 17701 6620-READ-NEXT-ERRESS-MASTER.
 17702
 17703
 17704* EXEC CICS HANDLE CONDITION
 17705*        NOTFND    (6630-END-OF-FILE)
 17706*        ENDFILE   (6630-END-OF-FILE)
 17707*        DISABLED  (6630-ERRESS-PROBLEM)
 17708*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17709*    END-EXEC.
 17710*    MOVE '"$I''cJ                ! % #00017660' TO DFHEIV0
 17711     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17712     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17713     MOVE X'2520233030303137363630' TO DFHEIV0(25:11)
 17714     CALL 'kxdfhei1' USING DFHEIV0
 17715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17716
 17717
 17718
 17719* EXEC CICS READNEXT
 17720*        DATASET (FILE-ID-ERRESS)
 17721*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17722*        RIDFLD  (WS-ERRESS-KEY)
 17723*    END-EXEC.
 17724     MOVE LENGTH OF
 17725      RESIDENT-STATE-TAX-MASTER
 17726       TO DFHEIV12
 17727     MOVE 0
 17728       TO DFHEIV11
 17729*    MOVE '&.IL                  )   #00017667' TO DFHEIV0
 17730     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17731     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17732     MOVE X'2020233030303137363637' TO DFHEIV0(25:11)
 17733     CALL 'kxdfhei1' USING DFHEIV0,
 17734           FILE-ID-ERRESS,
 17735           RESIDENT-STATE-TAX-MASTER,
 17736           DFHEIV12,
 17737           WS-ERRESS-KEY,
 17738           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 323
* EL050.cbl
 17739           DFHEIV11,
 17740           DFHEIV99,
 17741           DFHEIV99
 17742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17743
 17744
 17745     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17746
 17747* EXEC CICS ENDBR
 17748*            DATASET (FILE-ID-ERRESS)
 17749*       END-EXEC
 17750     MOVE 0
 17751       TO DFHEIV11
 17752*    MOVE '&2                    $   #00017674' TO DFHEIV0
 17753     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17754     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17755     MOVE X'2020233030303137363734' TO DFHEIV0(25:11)
 17756     CALL 'kxdfhei1' USING DFHEIV0,
 17757           FILE-ID-ERRESS,
 17758           DFHEIV11,
 17759           DFHEIV99
 17760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17761        GO TO 6630-END-OF-FILE.
 17762
 17763     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17764        NEXT SENTENCE
 17765      ELSE
 17766        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17767
 17768*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17769*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17770*
 17771     MOVE +2                     TO WS-SUB1.
 17772
 17773     IF PB-ISSUE
 17774     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17775        MOVE +1                  TO WS-SUB1.
 17776
 17777     IF PB-CANCELLATION
 17778     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17779        MOVE +1                  TO WS-SUB1.
 17780*
 17781*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17782*
 17783***  Y2K PROJ 7744
 17784     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17785***  Y2K PROJ 7744
 17786
 17787*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17788* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17789* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17790
 17791     ADD 1                    TO WS-YEAR-YY.
 17792
 17793     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17794         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17795                              TO WS-RES-STATE-TAX
 17796         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 324
* EL050.cbl
 17797                              TO WS-RES-MUNI-TAX
 17798     ELSE
 17799         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17800                              TO WS-RES-STATE-TAX
 17801         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17802                              TO WS-RES-MUNI-TAX.
 17803
 17804*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17805
 17806     IF PB-CANCELLATION
 17807         GO TO 6640-CANCEL-TAX.
 17808
 17809     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17810         COMPUTE PB-I-STATE-TAX ROUNDED =
 17811                                   PB-I-LF-PREMIUM-AMT
 17812                                 * WS-RES-STATE-TAX
 17813         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17814                                   PB-I-LF-PREMIUM-AMT
 17815                                 * WS-RES-MUNI-TAX
 17816     ELSE
 17817     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17818         COMPUTE PB-I-STATE-TAX ROUNDED =
 17819                                   PB-I-AH-PREMIUM-AMT
 17820                                 * WS-RES-STATE-TAX
 17821         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17822                                   PB-I-AH-PREMIUM-AMT
 17823                                 * WS-RES-MUNI-TAX.
 17824
 17825
 17826* EXEC CICS ENDBR
 17827*         DATASET (FILE-ID-ERRESS)
 17828*    END-EXEC.
 17829     MOVE 0
 17830       TO DFHEIV11
 17831*    MOVE '&2                    $   #00017741' TO DFHEIV0
 17832     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17833     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17834     MOVE X'2020233030303137373431' TO DFHEIV0(25:11)
 17835     CALL 'kxdfhei1' USING DFHEIV0,
 17836           FILE-ID-ERRESS,
 17837           DFHEIV11,
 17838           DFHEIV99
 17839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17840
 17841
 17842     GO TO 6640-EXIT.
 17843
 17844 6640-CANCEL-TAX.
 17845     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17846
 17847     IF PB-C-LF-CANCEL-AMT > ZEROS
 17848         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17849                                   PB-C-LF-CANCEL-AMT
 17850                                 * WS-RES-STATE-TAX
 17851         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17852                                   PB-C-LF-CANCEL-AMT
 17853                                *  WS-RES-MUNI-TAX
 17854     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 325
* EL050.cbl
 17855     IF PB-C-AH-CANCEL-AMT > ZEROS
 17856         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17857                                   PB-C-AH-CANCEL-AMT
 17858                                 * WS-RES-STATE-TAX
 17859         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17860                                   PB-C-AH-CANCEL-AMT
 17861                                *  WS-RES-MUNI-TAX.
 17862
 17863
 17864* EXEC CICS ENDBR
 17865*         DATASET (FILE-ID-ERRESS)
 17866*    END-EXEC.
 17867     MOVE 0
 17868       TO DFHEIV11
 17869*    MOVE '&2                    $   #00017766' TO DFHEIV0
 17870     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17871     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17872     MOVE X'2020233030303137373636' TO DFHEIV0(25:11)
 17873     CALL 'kxdfhei1' USING DFHEIV0,
 17874           FILE-ID-ERRESS,
 17875           DFHEIV11,
 17876           DFHEIV99
 17877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17878
 17879
 17880     GO TO 6640-EXIT.
 17881
 17882 6630-END-OF-FILE.
 17883     MOVE ER-8002              TO WS-ERROR.
 17884     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17885
 17886     GO TO 6640-EXIT.
 17887
 17888 6630-ERRESS-PROBLEM.
 17889     MOVE ER-8044              TO WS-ERROR.
 17890     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17891
 17892 6640-EXIT.
 17893     EXIT.
 17894
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 326
* EL050.cbl
 17896 6650-GET-RES-STATE-COMM.
 17897
 17898     IF PB-COMPANY-ID NOT = 'DMD'
 17899         GO TO 6700-COMM-EXIT.
 17900
 17901     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 17902     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 17903     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 17904     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 17905     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 17906     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 17907     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 17908
 17909*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 17910*
 17911***  Y2K PROJ 7744
 17912     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17913     SET BIN-TO-GREG          TO TRUE.
 17914     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17915
 17916     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17917***  Y2K PROJ 7744
 17918
 17919     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 17920
 17921
 17922* EXEC CICS HANDLE CONDITION
 17923*        INVREQ    (6660-START-BROWSE)
 17924*        DISABLED  (6690-ERRESC-PROBLEM)
 17925*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17926*        NOTFND    (6690-END-OF-FILE)
 17927*    END-EXEC.
 17928*    MOVE '"$8cJI                ! & #00017811' TO DFHEIV0
 17929     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 17930     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17931     MOVE X'2620233030303137383131' TO DFHEIV0(25:11)
 17932     CALL 'kxdfhei1' USING DFHEIV0
 17933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17934
 17935
 17936
 17937* EXEC CICS RESETBR
 17938*        DATASET (FILE-ID-ERRESC)
 17939*        RIDFLD  (WS-ERRESC-KEY)
 17940*    END-EXEC.
 17941     MOVE 0
 17942       TO DFHEIV11
 17943*    MOVE '&4         G          &   #00017818' TO DFHEIV0
 17944     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17945     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17946     MOVE X'2020233030303137383138' TO DFHEIV0(25:11)
 17947     CALL 'kxdfhei1' USING DFHEIV0,
 17948           FILE-ID-ERRESC,
 17949           WS-ERRESC-KEY,
 17950           DFHEIV99,
 17951           DFHEIV11,
 17952           DFHEIV99
 17953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 327
* EL050.cbl
 17954
 17955
 17956 6660-START-BROWSE.
 17957
 17958
 17959* EXEC CICS HANDLE CONDITION
 17960*        NOTFND    (6690-END-OF-FILE)
 17961*        DISABLED  (6690-ERRESC-PROBLEM)
 17962*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17963*        ENDFILE   (6690-END-OF-FILE)
 17964*    END-EXEC.
 17965*    MOVE '"$IcJ''                ! '' #00017825' TO DFHEIV0
 17966     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17968     MOVE X'2720233030303137383235' TO DFHEIV0(25:11)
 17969     CALL 'kxdfhei1' USING DFHEIV0
 17970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17971
 17972
 17973
 17974* EXEC CICS STARTBR
 17975*        DATASET (FILE-ID-ERRESC)
 17976*        RIDFLD  (WS-ERRESC-KEY)
 17977*        GTEQ
 17978*    END-EXEC.
 17979     MOVE 0
 17980       TO DFHEIV11
 17981*    MOVE '&,         G          &   #00017832' TO DFHEIV0
 17982     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17983     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17984     MOVE X'2020233030303137383332' TO DFHEIV0(25:11)
 17985     CALL 'kxdfhei1' USING DFHEIV0,
 17986           FILE-ID-ERRESC,
 17987           WS-ERRESC-KEY,
 17988           DFHEIV99,
 17989           DFHEIV11,
 17990           DFHEIV99
 17991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17992
 17993
 17994     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 17995
 17996 6670-READ-NEXT-ERRESC-MASTER.
 17997
 17998
 17999* EXEC CICS HANDLE CONDITION
 18000*        NOTFND    (6690-END-OF-FILE)
 18001*        DISABLED  (6690-ERRESC-PROBLEM)
 18002*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18003*        ENDFILE   (6690-END-OF-FILE)
 18004*    END-EXEC.
 18005*    MOVE '"$IcJ''                ! ( #00017842' TO DFHEIV0
 18006     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18007     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18008     MOVE X'2820233030303137383432' TO DFHEIV0(25:11)
 18009     CALL 'kxdfhei1' USING DFHEIV0
 18010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18011
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 328
* EL050.cbl
 18012
 18013
 18014* EXEC CICS READNEXT
 18015*        DATASET (FILE-ID-ERRESC)
 18016*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18017*        RIDFLD  (ERRESC-RECORD-KEY)
 18018*    END-EXEC.
 18019     MOVE LENGTH OF
 18020      ACCOUNT-RESIDENT-ST-COMMISSION
 18021       TO DFHEIV12
 18022     MOVE 0
 18023       TO DFHEIV11
 18024*    MOVE '&.IL                  )   #00017849' TO DFHEIV0
 18025     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18026     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18027     MOVE X'2020233030303137383439' TO DFHEIV0(25:11)
 18028     CALL 'kxdfhei1' USING DFHEIV0,
 18029           FILE-ID-ERRESC,
 18030           ACCOUNT-RESIDENT-ST-COMMISSION,
 18031           DFHEIV12,
 18032           ERRESC-RECORD-KEY,
 18033           DFHEIV99,
 18034           DFHEIV11,
 18035           DFHEIV99,
 18036           DFHEIV99
 18037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18038
 18039
 18040     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18041        NEXT SENTENCE
 18042     ELSE
 18043
 18044* EXEC CICS ENDBR
 18045*            DATASET (FILE-ID-ERRESC)
 18046*       END-EXEC
 18047     MOVE 0
 18048       TO DFHEIV11
 18049*    MOVE '&2                    $   #00017858' TO DFHEIV0
 18050     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18051     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18052     MOVE X'2020233030303137383538' TO DFHEIV0(25:11)
 18053     CALL 'kxdfhei1' USING DFHEIV0,
 18054           FILE-ID-ERRESC,
 18055           DFHEIV11,
 18056           DFHEIV99
 18057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18058        GO TO 6690-END-OF-FILE.
 18059
 18060     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18061
 18062* EXEC CICS ENDBR
 18063*            DATASET (FILE-ID-ERRESC)
 18064*       END-EXEC
 18065     MOVE 0
 18066       TO DFHEIV11
 18067*    MOVE '&2                    $   #00017864' TO DFHEIV0
 18068     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18069     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 329
* EL050.cbl
 18070     MOVE X'2020233030303137383634' TO DFHEIV0(25:11)
 18071     CALL 'kxdfhei1' USING DFHEIV0,
 18072           FILE-ID-ERRESC,
 18073           DFHEIV11,
 18074           DFHEIV99
 18075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18076        GO TO 6690-END-OF-FILE.
 18077
 18078     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18079        NEXT SENTENCE
 18080      ELSE
 18081        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18082
 18083* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18084*
 18085     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18086
 18087     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18088
 18089     IF WS-SUB1 > ZERO
 18090         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18091             PERFORM 6680-SET-COMMISSION
 18092         ELSE
 18093             PERFORM 6680-SET-TABLE-CODE.
 18094
 18095
 18096* EXEC CICS ENDBR
 18097*         DATASET (FILE-ID-ERRESC)
 18098*    END-EXEC.
 18099     MOVE 0
 18100       TO DFHEIV11
 18101*    MOVE '&2                    $   #00017886' TO DFHEIV0
 18102     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18103     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18104     MOVE X'2020233030303137383836' TO DFHEIV0(25:11)
 18105     CALL 'kxdfhei1' USING DFHEIV0,
 18106           FILE-ID-ERRESC,
 18107           DFHEIV11,
 18108           DFHEIV99
 18109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18110
 18111
 18112     GO TO 6700-COMM-EXIT.
 18113
 18114 6680-SET-TABLE-CODE.
 18115     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18116        MOVE ZEROS             TO WS-SUB1
 18117     ELSE
 18118* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18119* TO COMPUTE AH COMMISSION.
 18120        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18121        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18122        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18123        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18124        PERFORM 6680-READ-CTBL-TABLE
 18125        IF WS-CTBL-READ-SW NOT = 'Y'
 18126           MOVE ZEROS          TO WS-SUB1.
 18127
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 330
* EL050.cbl
 18128 6680-READ-CTBL-TABLE.
 18129*
 18130* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18131* TO COMPUTE LIFE COMMISSION
 18132
 18133     IF CTBL-SW = '0540'
 18134        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18135        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18136        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18137
 18138     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18139
 18140     IF CTBL-TABLE-FOUND
 18141        IF CTBL-SW = '0530'
 18142             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18143                                    * PB-I-AH-TERM
 18144             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18145             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18146        ELSE
 18147             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18148             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18149             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18150     ELSE
 18151        IF FIRST-TIME-THROUGH
 18152            GO TO 6680-READ-CTBL-TABLE
 18153        ELSE
 18154            MOVE ZEROS         TO WS-SUB1.
 18155
 18156 6680-SET-COMMISSION.
 18157     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18158           MOVE ZEROS          TO WS-SUB1
 18159       ELSE
 18160           MOVE RESC-COMMISSION-PER (WS-SUB)
 18161                               TO WS-COMMISSION
 18162           IF CTBL-SW = '0530'
 18163               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18164           ELSE
 18165               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18166
 18167 6680-SEARCH-CATEGORY.
 18168     ADD +1                   TO WS-SUB.
 18169     IF WS-SUB > +12
 18170         GO TO 6680-EXIT.
 18171
 18172     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18173          MOVE WS-SUB         TO WS-SUB1
 18174          GO TO 6680-EXIT.
 18175
 18176     GO TO 6680-SEARCH-CATEGORY.
 18177
 18178 6680-EXIT.
 18179     EXIT.
 18180
 18181 6690-END-OF-FILE.
 18182     GO TO 6700-COMM-EXIT.
 18183
 18184 6690-ERRESC-PROBLEM.
 18185      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 331
* EL050.cbl
 18186      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18187
 18188      GO TO 6700-COMM-EXIT.
 18189
 18190 6700-COMM-EXIT.
 18191     EXIT.
 18192
 18193 7000-GET-RATE.
 18194
 18195* EXEC CICS LINK
 18196*        PROGRAM    ('ELRATE')
 18197*        COMMAREA   (CALCULATION-PASS-AREA)
 18198*        LENGTH     (CP-COMM-LENGTH)
 18199*    END-EXEC.
 18200     MOVE 'ELRATE' TO DFHEIV1
 18201*    MOVE '."C                   ''   #00017972' TO DFHEIV0
 18202     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18203     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18204     MOVE X'2020233030303137393732' TO DFHEIV0(25:11)
 18205     CALL 'kxdfhei1' USING DFHEIV0,
 18206           DFHEIV1,
 18207           CALCULATION-PASS-AREA,
 18208           CP-COMM-LENGTH,
 18209           DFHEIV99,
 18210           DFHEIV99,
 18211           DFHEIV99
 18212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18213
 18214
 18215 7000-EXIT.
 18216     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 332
* EL050.cbl
 18218 7100-FIND-BENEFIT-IN-STATE.
 18219     MOVE 'N'                    TO BEN-SEARCH-SW.
 18220
 18221     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18222         VARYING SUB3 FROM 1 BY 1 UNTIL
 18223            ((SUB3 GREATER 50) OR
 18224              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18225               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18226
 18227     IF SUB3 NOT = 51
 18228         MOVE 'Y'                TO BEN-SEARCH-SW.
 18229
 18230     GO TO 7199-EXIT.
 18231
 18232 7100-BENEFIT-DUMMY.
 18233
 18234 7100-DUMMY-EXIT.
 18235     EXIT.
 18236
 18237 7199-EXIT.
 18238     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 333
* EL050.cbl
 18240 7200-FIND-BENEFIT.
 18241     MOVE 'N'                    TO BEN-SEARCH-SW.
 18242
 18243     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18244         VARYING SUB3 FROM 1 BY 1 UNTIL
 18245            ((SUB3 GREATER 8) OR
 18246            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18247
 18248     IF SUB3 NOT = 9
 18249         MOVE 'Y'                TO BEN-SEARCH-SW.
 18250
 18251     GO TO 7200-EXIT.
 18252
 18253 7200-BENEFIT-DUMMY.
 18254
 18255 7200-DUMMY-EXIT.
 18256     EXIT.
 18257
 18258 7200-EXIT.
 18259     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 334
* EL050.cbl
 18261 7250-LOOK-FOR-RESCINDED-CLAIM.
 18262     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18263                                    W-CL-COMP-CD.
 18264     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18265                                    W-CL-CERT-NO.
 18266
 18267
 18268* EXEC CICS HANDLE CONDITION
 18269*        NOTFND  (7250-CONTINUE)
 18270*        ENDFILE (7250-CONTINUE)
 18271*    END-EXEC.
 18272*    MOVE '"$I''                  ! ) #00018030' TO DFHEIV0
 18273     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18275     MOVE X'2920233030303138303330' TO DFHEIV0(25:11)
 18276     CALL 'kxdfhei1' USING DFHEIV0
 18277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18278
 18279
 18280
 18281* EXEC CICS IGNORE CONDITION
 18282*        DUPKEY
 18283*    END-EXEC.
 18284*    MOVE '"*$                   !   #00018035' TO DFHEIV0
 18285     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18286     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18287     MOVE X'2020233030303138303335' TO DFHEIV0(25:11)
 18288     CALL 'kxdfhei1' USING DFHEIV0
 18289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18290
 18291
 18292
 18293* EXEC CICS STARTBR
 18294*        DATASET   (CLMS-ID)
 18295*        RIDFLD    (ELMSTR-KEY)
 18296*        GENERIC   EQUAL
 18297*        KEYLENGTH (ELMSTR-LENGTH)
 18298*    END-EXEC.
 18299     MOVE 0
 18300       TO DFHEIV11
 18301*    MOVE '&,   KG    E          &   #00018039' TO DFHEIV0
 18302     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18303     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18304     MOVE X'2020233030303138303339' TO DFHEIV0(25:11)
 18305     CALL 'kxdfhei1' USING DFHEIV0,
 18306           CLMS-ID,
 18307           ELMSTR-KEY,
 18308           ELMSTR-LENGTH,
 18309           DFHEIV11,
 18310           DFHEIV99
 18311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18312
 18313
 18314     MOVE 'Y'                    TO W-BROWSE-SW.
 18315
 18316 7250-NEXT-CLAIM.
 18317
 18318
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 335
* EL050.cbl
 18319* EXEC CICS READNEXT
 18320*        DATASET   (CLMS-ID)
 18321*        RIDFLD    (ELMSTR-KEY)
 18322*        SET       (ADDRESS OF CLAIM-MASTER)
 18323*    END-EXEC.
 18324     MOVE 0
 18325       TO DFHEIV11
 18326*    MOVE '&.S                   )   #00018050' TO DFHEIV0
 18327     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18328     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18329     MOVE X'2020233030303138303530' TO DFHEIV0(25:11)
 18330     CALL 'kxdfhei1' USING DFHEIV0,
 18331           CLMS-ID,
 18332           DFHEIV20,
 18333           DFHEIV99,
 18334           ELMSTR-KEY,
 18335           DFHEIV99,
 18336           DFHEIV11,
 18337           DFHEIV99,
 18338           DFHEIV99
 18339     SET ADDRESS OF CLAIM-MASTER TO
 18340         DFHEIV20
 18341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18342
 18343
 18344     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18345        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18346         GO TO 7250-CONTINUE
 18347     END-IF.
 18348
 18349     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18350        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18351        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18352        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18353        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18354         GO TO 7250-NEXT-CLAIM
 18355     END-IF.
 18356
 18357     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18358        OR (CL-CLAIM-TYPE = 'I')
 18359        OR (CL-CLAIM-TYPE = 'G')
 18360          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18361              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18362              GO TO 7250-CONTINUE
 18363          END-IF
 18364     END-IF.
 18365
 18366     GO TO 7250-NEXT-CLAIM.
 18367
 18368 7250-CONTINUE.
 18369
 18370     IF W-BROWSE-SW = 'Y'
 18371
 18372* EXEC CICS ENDBR
 18373*            DATASET   (CLMS-ID)
 18374*        END-EXEC
 18375     MOVE 0
 18376       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 336
* EL050.cbl
 18377*    MOVE '&2                    $   #00018083' TO DFHEIV0
 18378     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18379     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18380     MOVE X'2020233030303138303833' TO DFHEIV0(25:11)
 18381     CALL 'kxdfhei1' USING DFHEIV0,
 18382           CLMS-ID,
 18383           DFHEIV11,
 18384           DFHEIV99
 18385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18386         MOVE 'N' TO W-BROWSE-SW
 18387     END-IF.
 18388
 18389 7250-EXIT.
 18390     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 337
* EL050.cbl
 18392 7300-CHECK-FOR-OPEN-CLMS.
 18393
 18394*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18395*    MOVE SPACES                 TO CNTL-ACCESS.
 18396*    MOVE '1'                    TO CNTL-REC-TYPE.
 18397*    MOVE +0                     TO CNTL-SEQ-NO.
 18398
 18399*    MOVE '3'                    TO RC-SW-1.
 18400*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18401
 18402*    IF NOT CF-COMPANY-MASTER
 18403*         PERFORM 0099-COMPANY-NOT-FOUND
 18404*         GO TO 7300-EXIT.
 18405
 18406     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18407                                    W-CL-COMP-CD.
 18408     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18409                                    W-CL-CERT-NO.
 18410
 18411
 18412* EXEC CICS HANDLE CONDITION
 18413*        NOTFND  (7300-CONTINUE)
 18414*        ENDFILE (7300-CONTINUE)
 18415*    END-EXEC.
 18416*    MOVE '"$I''                  ! * #00018111' TO DFHEIV0
 18417     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18419     MOVE X'2A20233030303138313131' TO DFHEIV0(25:11)
 18420     CALL 'kxdfhei1' USING DFHEIV0
 18421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18422
 18423
 18424
 18425* EXEC CICS IGNORE CONDITION
 18426*        DUPKEY
 18427*    END-EXEC.
 18428*    MOVE '"*$                   !   #00018116' TO DFHEIV0
 18429     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18431     MOVE X'2020233030303138313136' TO DFHEIV0(25:11)
 18432     CALL 'kxdfhei1' USING DFHEIV0
 18433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18434
 18435
 18436
 18437* EXEC CICS STARTBR
 18438*        DATASET   (CLMS-ID)
 18439*        RIDFLD    (ELMSTR-KEY)
 18440*        GENERIC   EQUAL
 18441*        KEYLENGTH (ELMSTR-LENGTH)
 18442*    END-EXEC.
 18443     MOVE 0
 18444       TO DFHEIV11
 18445*    MOVE '&,   KG    E          &   #00018120' TO DFHEIV0
 18446     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18447     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18448     MOVE X'2020233030303138313230' TO DFHEIV0(25:11)
 18449     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 338
* EL050.cbl
 18450           CLMS-ID,
 18451           ELMSTR-KEY,
 18452           ELMSTR-LENGTH,
 18453           DFHEIV11,
 18454           DFHEIV99
 18455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18456
 18457
 18458     MOVE 'Y'                    TO W-BROWSE-SW.
 18459
 18460 7300-NEXT-CLAIM.
 18461
 18462
 18463* EXEC CICS READNEXT
 18464*        DATASET   (CLMS-ID)
 18465*        RIDFLD    (ELMSTR-KEY)
 18466*        SET       (ADDRESS OF CLAIM-MASTER)
 18467*    END-EXEC.
 18468     MOVE 0
 18469       TO DFHEIV11
 18470*    MOVE '&.S                   )   #00018131' TO DFHEIV0
 18471     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18472     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18473     MOVE X'2020233030303138313331' TO DFHEIV0(25:11)
 18474     CALL 'kxdfhei1' USING DFHEIV0,
 18475           CLMS-ID,
 18476           DFHEIV20,
 18477           DFHEIV99,
 18478           ELMSTR-KEY,
 18479           DFHEIV99,
 18480           DFHEIV11,
 18481           DFHEIV99,
 18482           DFHEIV99
 18483     SET ADDRESS OF CLAIM-MASTER TO
 18484         DFHEIV20
 18485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18486
 18487
 18488     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18489        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18490         GO TO 7300-CONTINUE.
 18491
 18492     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18493        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18494        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18495        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18496        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18497         GO TO 7300-NEXT-CLAIM.
 18498
 18499*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18500     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18501        OR (CL-CLAIM-TYPE = 'I')
 18502        OR (CL-CLAIM-TYPE = 'G')
 18503        IF CLAIM-IS-OPEN
 18504           EVALUATE TRUE
 18505             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18506                 MOVE ER-2884      TO WS-ERROR
 18507             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 339
* EL050.cbl
 18508                 MOVE ER-2887      TO WS-ERROR
 18509             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18510                 MOVE ER-2886      TO WS-ERROR
 18511             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18512                 MOVE ER-2888      TO WS-ERROR
 18513             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18514                 MOVE ER-2885      TO WS-ERROR
 18515             WHEN OTHER
 18516                 MOVE ER-2768      TO WS-ERROR
 18517           END-EVALUATE
 18518           IF PB-C-AH-CANCEL-VOIDED OR
 18519              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18520                NOT AH-COVERAGE-CANCELLED)
 18521               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18522               MOVE ER-2768      TO WS-ERROR
 18523           END-IF
 18524           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18525           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18526              PB-FORCE-CODE NOT EQUAL '8'
 18527               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18528           END-IF
 18529           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18530           GO TO 7300-CONTINUE
 18531        ELSE
 18532           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18533*****THIS IS A RESCISSION OR REFORMATION
 18534              IF (AH-COVERAGE-CANCELLED AND
 18535                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18536                    MOVE ER-2890 TO WS-ERROR
 18537                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18538                    GO TO 7300-CONTINUE
 18539              END-IF
 18540           ELSE
 18541              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18542                 MOVE ER-2756        TO WS-ERROR
 18543                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18544                 GO TO 7300-CONTINUE
 18545              END-IF
 18546           END-IF
 18547        END-IF
 18548     ELSE
 18549*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18550        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18551           IF CLAIM-IS-OPEN
 18552              MOVE ER-2889      TO WS-ERROR
 18553              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18554              GO TO 7300-CONTINUE
 18555           ELSE
 18556              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18557*****THIS IS A RESCISSION OR REFORMATION
 18558                 IF (LF-COVERAGE-CANCELLED AND
 18559                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18560                       MOVE ER-2890 TO WS-ERROR
 18561                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18562                       GO TO 7300-CONTINUE
 18563                 END-IF
 18564              ELSE
 18565                 IF (AH-COVERAGE-CANCELLED AND
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 340
* EL050.cbl
 18566                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18567                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18568                    (LF-COVERAGE-CANCELLED AND
 18569                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18570                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18571                       MOVE ER-2965 TO WS-ERROR
 18572                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18573                       GO TO 7300-CONTINUE
 18574                 END-IF
 18575                 IF LF-COVERAGE-CANCELLED
 18576                  IF CL-TOTAL-PAID-AMT > 0
 18577                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18578                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18579                        MOVE ER-2891 TO WS-ERROR
 18580                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18581                        GO TO 7300-CONTINUE
 18582                      END-IF
 18583                    ELSE
 18584                      MOVE ER-2892 TO WS-ERROR
 18585                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18586                      GO TO 7300-CONTINUE
 18587                    END-IF
 18588                  END-IF
 18589                 END-IF
 18590              END-IF
 18591           END-IF
 18592        END-IF
 18593     END-IF
 18594
 18595     GO TO 7300-NEXT-CLAIM.
 18596
 18597 7300-CONTINUE.
 18598
 18599     IF W-BROWSE-SW = 'Y'
 18600
 18601* EXEC CICS ENDBR
 18602*            DATASET   (CLMS-ID)
 18603*        END-EXEC.
 18604     MOVE 0
 18605       TO DFHEIV11
 18606*    MOVE '&2                    $   #00018249' TO DFHEIV0
 18607     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18608     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18609     MOVE X'2020233030303138323439' TO DFHEIV0(25:11)
 18610     CALL 'kxdfhei1' USING DFHEIV0,
 18611           CLMS-ID,
 18612           DFHEIV11,
 18613           DFHEIV99
 18614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18615
 18616
 18617 7300-EXIT.
 18618     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 341
* EL050.cbl
 18620
 18621 7400-GET-REMAIN-TERM.
 18622
 18623* EXEC CICS LINK
 18624*        PROGRAM    ('ELRTRM')
 18625*        COMMAREA   (CALCULATION-PASS-AREA)
 18626*        LENGTH     (CP-COMM-LENGTH)
 18627*    END-EXEC.
 18628     MOVE 'ELRTRM' TO DFHEIV1
 18629*    MOVE '."C                   ''   #00018258' TO DFHEIV0
 18630     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18631     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18632     MOVE X'2020233030303138323538' TO DFHEIV0(25:11)
 18633     CALL 'kxdfhei1' USING DFHEIV0,
 18634           DFHEIV1,
 18635           CALCULATION-PASS-AREA,
 18636           CP-COMM-LENGTH,
 18637           DFHEIV99,
 18638           DFHEIV99,
 18639           DFHEIV99
 18640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18641
 18642
 18643 7400-EXIT.
 18644     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 342
* EL050.cbl
 18646
 18647 7500-GET-REMAIN-AMOUNT.
 18648
 18649* EXEC CICS LINK
 18650*        PROGRAM    ('ELRAMT')
 18651*        COMMAREA   (CALCULATION-PASS-AREA)
 18652*        LENGTH     (CP-COMM-LENGTH)
 18653*    END-EXEC.
 18654     MOVE 'ELRAMT' TO DFHEIV1
 18655*    MOVE '."C                   ''   #00018269' TO DFHEIV0
 18656     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18657     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18658     MOVE X'2020233030303138323639' TO DFHEIV0(25:11)
 18659     CALL 'kxdfhei1' USING DFHEIV0,
 18660           DFHEIV1,
 18661           CALCULATION-PASS-AREA,
 18662           CP-COMM-LENGTH,
 18663           DFHEIV99,
 18664           DFHEIV99,
 18665           DFHEIV99
 18666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18667
 18668
 18669 7500-EXIT.
 18670     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 343
* EL050.cbl
 18672
 18673 7600-GET-REFUND.
 18674
 18675* EXEC CICS LINK
 18676*        PROGRAM    ('ELRFND')
 18677*        COMMAREA   (CALCULATION-PASS-AREA)
 18678*        LENGTH     (CP-COMM-LENGTH)
 18679*    END-EXEC.
 18680     MOVE 'ELRFND' TO DFHEIV1
 18681*    MOVE '."C                   ''   #00018280' TO DFHEIV0
 18682     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18683     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18684     MOVE X'2020233030303138323830' TO DFHEIV0(25:11)
 18685     CALL 'kxdfhei1' USING DFHEIV0,
 18686           DFHEIV1,
 18687           CALCULATION-PASS-AREA,
 18688           CP-COMM-LENGTH,
 18689           DFHEIV99,
 18690           DFHEIV99,
 18691           DFHEIV99
 18692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18693
 18694
 18695 7600-EXIT.
 18696     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 344
* EL050.cbl
 18698 7700-CALL-DL1.
 18699
 18700* EXEC CICS LINK
 18701*        PROGRAM    ('DLO001')
 18702*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18703*        LENGTH     (DLO001-COMM-LENGTH)
 18704*    END-EXEC.
 18705     MOVE 'DLO001' TO DFHEIV1
 18706*    MOVE '."C                   ''   #00018290' TO DFHEIV0
 18707     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18708     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18709     MOVE X'2020233030303138323930' TO DFHEIV0(25:11)
 18710     CALL 'kxdfhei1' USING DFHEIV0,
 18711           DFHEIV1,
 18712           WS-DLO-MASTER-POLICY-FORM,
 18713           DLO001-COMM-LENGTH,
 18714           DFHEIV99,
 18715           DFHEIV99,
 18716           DFHEIV99
 18717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18718
 18719
 18720 7700-EXIT.
 18721     EXIT.
 18722
 18723 7710-CALL-DL2.
 18724
 18725* EXEC CICS LINK
 18726*        PROGRAM    ('DLO002')
 18727*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18728*        LENGTH     (DLO002-COMM-LENGTH)
 18729*    END-EXEC.
 18730     MOVE 'DLO002' TO DFHEIV1
 18731*    MOVE '."C                   ''   #00018300' TO DFHEIV0
 18732     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18733     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18734     MOVE X'2020233030303138333030' TO DFHEIV0(25:11)
 18735     CALL 'kxdfhei1' USING DFHEIV0,
 18736           DFHEIV1,
 18737           WS-DLO-INTERNAL-POLICY-FORM,
 18738           DLO002-COMM-LENGTH,
 18739           DFHEIV99,
 18740           DFHEIV99,
 18741           DFHEIV99
 18742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18743
 18744
 18745 7710-EXIT.
 18746     EXIT.
 18747
 18748 7720-CALL-DL3.
 18749
 18750* EXEC CICS LINK
 18751*        PROGRAM    ('DLO003')
 18752*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18753*        LENGTH     (DLO003-COMM-LENGTH)
 18754*    END-EXEC.
 18755     MOVE 'DLO003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 345
* EL050.cbl
 18756*    MOVE '."C                   ''   #00018310' TO DFHEIV0
 18757     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18758     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18759     MOVE X'2020233030303138333130' TO DFHEIV0(25:11)
 18760     CALL 'kxdfhei1' USING DFHEIV0,
 18761           DFHEIV1,
 18762           WS-DLO-VALID-BANK-ID,
 18763           DLO003-COMM-LENGTH,
 18764           DFHEIV99,
 18765           DFHEIV99,
 18766           DFHEIV99
 18767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18768
 18769
 18770 7720-EXIT.
 18771     EXIT.
 18772
 18773 7730-CALL-DL7.
 18774
 18775* EXEC CICS LINK
 18776*        PROGRAM    ('DLO007')
 18777*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18778*        LENGTH     (DLO007-COMM-LENGTH)
 18779*    END-EXEC.
 18780     MOVE 'DLO007' TO DFHEIV1
 18781*    MOVE '."C                   ''   #00018320' TO DFHEIV0
 18782     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18783     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18784     MOVE X'2020233030303138333230' TO DFHEIV0(25:11)
 18785     CALL 'kxdfhei1' USING DFHEIV0,
 18786           DFHEIV1,
 18787           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18788           DLO007-COMM-LENGTH,
 18789           DFHEIV99,
 18790           DFHEIV99,
 18791           DFHEIV99
 18792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18793
 18794
 18795 7730-EXIT.
 18796     EXIT.
 18797
 18798 7740-CALL-DL11.
 18799
 18800* EXEC CICS LINK
 18801*        PROGRAM    ('DLO011')
 18802*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18803*        LENGTH     (DLO011-COMM-LENGTH)
 18804*    END-EXEC.
 18805     MOVE 'DLO011' TO DFHEIV1
 18806*    MOVE '."C                   ''   #00018330' TO DFHEIV0
 18807     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18808     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18809     MOVE X'2020233030303138333330' TO DFHEIV0(25:11)
 18810     CALL 'kxdfhei1' USING DFHEIV0,
 18811           DFHEIV1,
 18812           WS-DLO-PREM-RATES-BEN-TYPE,
 18813           DLO011-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 346
* EL050.cbl
 18814           DFHEIV99,
 18815           DFHEIV99,
 18816           DFHEIV99
 18817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18818
 18819
 18820 7740-EXIT.
 18821     EXIT.
 18822
 18823 7750-CALL-DL17.
 18824
 18825* EXEC CICS LINK
 18826*        PROGRAM    ('DLO017')
 18827*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18828*        LENGTH     (DLO017-COMM-LENGTH)
 18829*    END-EXEC.
 18830     MOVE 'DLO017' TO DFHEIV1
 18831*    MOVE '."C                   ''   #00018340' TO DFHEIV0
 18832     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18833     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18834     MOVE X'2020233030303138333430' TO DFHEIV0(25:11)
 18835     CALL 'kxdfhei1' USING DFHEIV0,
 18836           DFHEIV1,
 18837           WS-DLO-VALID-RATE-CODE,
 18838           DLO017-COMM-LENGTH,
 18839           DFHEIV99,
 18840           DFHEIV99,
 18841           DFHEIV99
 18842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18843
 18844
 18845 7750-EXIT.
 18846     EXIT.
 18847
 18848 7755-CALL-DL19.
 18849
 18850* EXEC CICS LINK
 18851*        PROGRAM    ('DLO019')
 18852*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18853*        LENGTH     (DLO019-COMM-LENGTH)
 18854*    END-EXEC.
 18855     MOVE 'DLO019' TO DFHEIV1
 18856*    MOVE '."C                   ''   #00018350' TO DFHEIV0
 18857     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18858     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18859     MOVE X'2020233030303138333530' TO DFHEIV0(25:11)
 18860     CALL 'kxdfhei1' USING DFHEIV0,
 18861           DFHEIV1,
 18862           WS-DLO-ORIG-COV-CAT,
 18863           DLO019-COMM-LENGTH,
 18864           DFHEIV99,
 18865           DFHEIV99,
 18866           DFHEIV99
 18867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18868
 18869
 18870 7755-EXIT.
 18871     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 347
* EL050.cbl
 18872
 18873 7760-CALL-DL21.
 18874
 18875* EXEC CICS LINK
 18876*        PROGRAM    ('DLO021')
 18877*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 18878*        LENGTH     (DLO021-COMM-LENGTH)
 18879*    END-EXEC.
 18880     MOVE 'DLO021' TO DFHEIV1
 18881*    MOVE '."C                   ''   #00018360' TO DFHEIV0
 18882     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18883     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18884     MOVE X'2020233030303138333630' TO DFHEIV0(25:11)
 18885     CALL 'kxdfhei1' USING DFHEIV0,
 18886           DFHEIV1,
 18887           WS-DLO-VALID-LOAN-OFFICER,
 18888           DLO021-COMM-LENGTH,
 18889           DFHEIV99,
 18890           DFHEIV99,
 18891           DFHEIV99
 18892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18893
 18894
 18895 7760-EXIT.
 18896     EXIT.
 18897
 18898 7770-CALL-DL22.
 18899
 18900* EXEC CICS LINK
 18901*        PROGRAM    ('DLO022')
 18902*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 18903*        LENGTH     (DLO022-COMM-LENGTH)
 18904*    END-EXEC.
 18905     MOVE 'DLO022' TO DFHEIV1
 18906*    MOVE '."C                   ''   #00018370' TO DFHEIV0
 18907     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18908     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18909     MOVE X'2020233030303138333730' TO DFHEIV0(25:11)
 18910     CALL 'kxdfhei1' USING DFHEIV0,
 18911           DFHEIV1,
 18912           WS-DLO-VALID-STATE-CODE,
 18913           DLO022-COMM-LENGTH,
 18914           DFHEIV99,
 18915           DFHEIV99,
 18916           DFHEIV99
 18917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18918
 18919
 18920 7770-EXIT.
 18921     EXIT.
 18922
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 348
* EL050.cbl
 18924
 18925 7800-REWRITE-CERT.
 18926******************************************************************
 18927*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 18928*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 18929******************************************************************
 18930
 18931     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 18932        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 18933        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 18934        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 18935
 18936* EXEC CICS REWRITE
 18937*                  DATASET (CERT-ID)
 18938*                  FROM    (CERTIFICATE-MASTER)
 18939*              END-EXEC
 18940     MOVE LENGTH OF
 18941      CERTIFICATE-MASTER
 18942       TO DFHEIV11
 18943*    MOVE '&& L                  %   #00018391' TO DFHEIV0
 18944     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18945     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18946     MOVE X'2020233030303138333931' TO DFHEIV0(25:11)
 18947     CALL 'kxdfhei1' USING DFHEIV0,
 18948           CERT-ID,
 18949           CERTIFICATE-MASTER,
 18950           DFHEIV11,
 18951           DFHEIV99
 18952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18953        GO TO 7800-EXIT.
 18954
 18955       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 18956       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 18957
 18958 7800-EXIT.
 18959      EXIT.
 18960
 18961 7900-DELETE-CERT.
 18962
 18963* EXEC CICS DELETE
 18964*        DATASET (CERT-ID)
 18965*    END-EXEC.
 18966*    MOVE '&(                    &   #00018404' TO DFHEIV0
 18967     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 18968     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18969     MOVE X'2020233030303138343034' TO DFHEIV0(25:11)
 18970     CALL 'kxdfhei1' USING DFHEIV0,
 18971           CERT-ID,
 18972           DFHEIV99,
 18973           DFHEIV99,
 18974           DFHEIV99,
 18975           DFHEIV99
 18976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18977
 18978
 18979 7900-EXIT.
 18980     EXIT.
 18981
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 349
* EL050.cbl
 18982 8000-WRITE-CERT.
 18983
 18984* EXEC CICS HANDLE CONDITION
 18985*        DUPKEY    (8000-FREE-MAIN)
 18986*    END-EXEC.
 18987*    MOVE '"$$                   ! + #00018412' TO DFHEIV0
 18988     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 18989     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18990     MOVE X'2B20233030303138343132' TO DFHEIV0(25:11)
 18991     CALL 'kxdfhei1' USING DFHEIV0
 18992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18993
 18994
 18995
 18996* EXEC CICS WRITE
 18997*        DATASET     (CERT-ID)
 18998*        FROM        (CERTIFICATE-MASTER)
 18999*        RIDFLD      (ELCERT-KEY)
 19000*    END-EXEC.
 19001     MOVE LENGTH OF
 19002      CERTIFICATE-MASTER
 19003       TO DFHEIV11
 19004*    MOVE '&$ L                  ''   #00018416' TO DFHEIV0
 19005     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19006     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19007     MOVE X'2020233030303138343136' TO DFHEIV0(25:11)
 19008     CALL 'kxdfhei1' USING DFHEIV0,
 19009           CERT-ID,
 19010           CERTIFICATE-MASTER,
 19011           DFHEIV11,
 19012           ELCERT-KEY,
 19013           DFHEIV99,
 19014           DFHEIV99
 19015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19016
 19017
 19018 8000-FREE-MAIN.
 19019
 19020 8000-EXIT.
 19021      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 350
* EL050.cbl
 19023
 19024 8100-READ-ERPNDM.
 19025
 19026* EXEC CICS HANDLE CONDITION
 19027*         NOTFND     (8100-NOTFND)
 19028*         ENDFILE    (8100-NOTFND)
 19029*    END-EXEC.
 19030*    MOVE '"$I''                  ! , #00018429' TO DFHEIV0
 19031     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19032     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19033     MOVE X'2C20233030303138343239' TO DFHEIV0(25:11)
 19034     CALL 'kxdfhei1' USING DFHEIV0
 19035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19036
 19037
 19038     MOVE SPACES                 TO ERPNDM-FOUND.
 19039     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19040
 19041
 19042* EXEC CICS READ
 19043*         DATASET   (FILE-ERPNDM)
 19044*         RIDFLD    (PM-CONTROL-PRIMARY)
 19045*         INTO      (PENDING-MAILING-DATA)
 19046*    END-EXEC.
 19047     MOVE LENGTH OF
 19048      PENDING-MAILING-DATA
 19049       TO DFHEIV11
 19050*    MOVE '&"IL       E          (   #00018437' TO DFHEIV0
 19051     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19052     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19053     MOVE X'2020233030303138343337' TO DFHEIV0(25:11)
 19054     CALL 'kxdfhei1' USING DFHEIV0,
 19055           FILE-ERPNDM,
 19056           PENDING-MAILING-DATA,
 19057           DFHEIV11,
 19058           PM-CONTROL-PRIMARY,
 19059           DFHEIV99,
 19060           DFHEIV99,
 19061           DFHEIV99
 19062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19063
 19064
 19065     GO TO 8100-EXIT.
 19066
 19067 8100-NOTFND.
 19068
 19069     MOVE 'X'                    TO ERPNDM-FOUND.
 19070     MOVE ER-2694                TO WS-ERROR.
 19071     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19072     MOVE ER-2883                TO WS-ERROR
 19073     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19074     .
 19075 8100-EXIT.
 19076     EXIT.
 19077
 19078 8110-READ-ERMAIL.
 19079
 19080* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 351
* EL050.cbl
 19081*         NOTFND     (8110-NOTFND)
 19082*         ENDFILE    (8110-NOTFND)
 19083*    END-EXEC.
 19084*    MOVE '"$I''                  ! - #00018457' TO DFHEIV0
 19085     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19087     MOVE X'2D20233030303138343537' TO DFHEIV0(25:11)
 19088     CALL 'kxdfhei1' USING DFHEIV0
 19089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19090
 19091
 19092     MOVE SPACES                 TO ERMAIL-FOUND.
 19093     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19094     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19095     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19096     MOVE PB-SV-STATE            TO MA-STATE.
 19097
 19098
 19099* EXEC CICS READ
 19100*         UPDATE
 19101*         DATASET   (FILE-ERMAIL)
 19102*         RIDFLD    (MA-CONTROL-PRIMARY)
 19103*         INTO      (MAILING-DATA)
 19104*    END-EXEC.
 19105     MOVE LENGTH OF
 19106      MAILING-DATA
 19107       TO DFHEIV11
 19108*    MOVE '&"IL       EU         (   #00018468' TO DFHEIV0
 19109     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19110     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19111     MOVE X'2020233030303138343638' TO DFHEIV0(25:11)
 19112     CALL 'kxdfhei1' USING DFHEIV0,
 19113           FILE-ERMAIL,
 19114           MAILING-DATA,
 19115           DFHEIV11,
 19116           MA-CONTROL-PRIMARY,
 19117           DFHEIV99,
 19118           DFHEIV99,
 19119           DFHEIV99
 19120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19121
 19122
 19123     GO TO 8110-EXIT.
 19124
 19125 8110-NOTFND.
 19126     MOVE 'X'                    TO ERMAIL-FOUND.
 19127
 19128 8110-EXIT.
 19129     EXIT.
 19130
 19131 8120-REWRITE-ERMAIL.
 19132
 19133* EXEC CICS REWRITE
 19134*         DATASET    (FILE-ERMAIL)
 19135*         FROM       (MAILING-DATA)
 19136*    END-EXEC.
 19137     MOVE LENGTH OF
 19138      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 352
* EL050.cbl
 19139       TO DFHEIV11
 19140*    MOVE '&& L                  %   #00018484' TO DFHEIV0
 19141     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19142     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19143     MOVE X'2020233030303138343834' TO DFHEIV0(25:11)
 19144     CALL 'kxdfhei1' USING DFHEIV0,
 19145           FILE-ERMAIL,
 19146           MAILING-DATA,
 19147           DFHEIV11,
 19148           DFHEIV99
 19149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19150
 19151
 19152 8120-EXIT.
 19153     EXIT.
 19154
 19155 8130-WRITE-ERMAIL.
 19156
 19157* EXEC CICS HANDLE CONDITION
 19158*         DUPKEY   (8130-EXIT)
 19159*    END-EXEC.
 19160*    MOVE '"$$                   ! . #00018493' TO DFHEIV0
 19161     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19163     MOVE X'2E20233030303138343933' TO DFHEIV0(25:11)
 19164     CALL 'kxdfhei1' USING DFHEIV0
 19165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19166
 19167
 19168
 19169* EXEC CICS WRITE
 19170*         DATASET     (FILE-ERMAIL)
 19171*         RIDFLD      (MA-CONTROL-PRIMARY)
 19172*         FROM        (MAILING-DATA)
 19173*    END-EXEC.
 19174     MOVE LENGTH OF
 19175      MAILING-DATA
 19176       TO DFHEIV11
 19177*    MOVE '&$ L                  ''   #00018497' TO DFHEIV0
 19178     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19179     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19180     MOVE X'2020233030303138343937' TO DFHEIV0(25:11)
 19181     CALL 'kxdfhei1' USING DFHEIV0,
 19182           FILE-ERMAIL,
 19183           MAILING-DATA,
 19184           DFHEIV11,
 19185           MA-CONTROL-PRIMARY,
 19186           DFHEIV99,
 19187           DFHEIV99
 19188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19189
 19190
 19191 8130-EXIT.
 19192     EXIT.
 19193
 19194 8140-UNLOCK-ERMAIL.
 19195
 19196* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 353
* EL050.cbl
 19197*         DATASET   (FILE-ERMAIL)
 19198*    END-EXEC.
 19199*    MOVE '&*                    #   #00018507' TO DFHEIV0
 19200     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19201     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19202     MOVE X'2020233030303138353037' TO DFHEIV0(25:11)
 19203     CALL 'kxdfhei1' USING DFHEIV0,
 19204           FILE-ERMAIL,
 19205           DFHEIV99
 19206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19207
 19208
 19209 8140-EXIT.
 19210     EXIT.
 19211
 19212 8180-UPDATE-VIN-NUMBER.
 19213
 19214* EXEC CICS HANDLE CONDITION
 19215*        NOTFND   (8180-NOTFND)
 19216*    END-EXEC.
 19217*    MOVE '"$I                   ! / #00018515' TO DFHEIV0
 19218     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19220     MOVE X'2F20233030303138353135' TO DFHEIV0(25:11)
 19221     CALL 'kxdfhei1' USING DFHEIV0
 19222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19223
 19224
 19225     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19226     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19227
 19228
 19229* EXEC CICS READ
 19230*        UPDATE
 19231*        DATASET  (CRTT-ID)
 19232*        RIDFLD   (WS-ELCRTT-KEY)
 19233*        INTO     (CERTIFICATE-TRAILERS)
 19234*    END-EXEC.
 19235     MOVE LENGTH OF
 19236      CERTIFICATE-TRAILERS
 19237       TO DFHEIV11
 19238*    MOVE '&"IL       EU         (   #00018522' TO DFHEIV0
 19239     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19240     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19241     MOVE X'2020233030303138353232' TO DFHEIV0(25:11)
 19242     CALL 'kxdfhei1' USING DFHEIV0,
 19243           CRTT-ID,
 19244           CERTIFICATE-TRAILERS,
 19245           DFHEIV11,
 19246           WS-ELCRTT-KEY,
 19247           DFHEIV99,
 19248           DFHEIV99,
 19249           DFHEIV99
 19250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19251
 19252
 19253     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19254         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 354
* EL050.cbl
 19255
 19256* EXEC CICS REWRITE
 19257*           DATASET  (CRTT-ID)
 19258*           FROM     (CERTIFICATE-TRAILERS)
 19259*        END-EXEC
 19260     MOVE LENGTH OF
 19261      CERTIFICATE-TRAILERS
 19262       TO DFHEIV11
 19263*    MOVE '&& L                  %   #00018531' TO DFHEIV0
 19264     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19265     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19266     MOVE X'2020233030303138353331' TO DFHEIV0(25:11)
 19267     CALL 'kxdfhei1' USING DFHEIV0,
 19268           CRTT-ID,
 19269           CERTIFICATE-TRAILERS,
 19270           DFHEIV11,
 19271           DFHEIV99
 19272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19273     ELSE
 19274
 19275* EXEC CICS UNLOCK
 19276*          DATASET  (CRTT-ID)
 19277*       END-EXEC
 19278*    MOVE '&*                    #   #00018536' TO DFHEIV0
 19279     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19280     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19281     MOVE X'2020233030303138353336' TO DFHEIV0(25:11)
 19282     CALL 'kxdfhei1' USING DFHEIV0,
 19283           CRTT-ID,
 19284           DFHEIV99
 19285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19286     END-IF.
 19287
 19288     GO TO 8180-EXIT.
 19289
 19290 8180-NOTFND.
 19291
 19292     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19293     MOVE 'CS'         TO CS-RECORD-ID.
 19294     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19295     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19296     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19297     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19298
 19299* EXEC CICS WRITE
 19300*       DATASET  (CRTT-ID)
 19301*       RIDFLD   (WS-ELCRTT-KEY)
 19302*       FROM     (CERTIFICATE-TRAILERS)
 19303*    END-EXEC.
 19304     MOVE LENGTH OF
 19305      CERTIFICATE-TRAILERS
 19306       TO DFHEIV11
 19307*    MOVE '&$ L                  ''   #00018551' TO DFHEIV0
 19308     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19309     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19310     MOVE X'2020233030303138353531' TO DFHEIV0(25:11)
 19311     CALL 'kxdfhei1' USING DFHEIV0,
 19312           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 355
* EL050.cbl
 19313           CERTIFICATE-TRAILERS,
 19314           DFHEIV11,
 19315           WS-ELCRTT-KEY,
 19316           DFHEIV99,
 19317           DFHEIV99
 19318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19319
 19320
 19321 8180-EXIT.
 19322     EXIT.
 19323
 19324 8190-UPDATE-REFUND-CLAIM-FLAG.
 19325
 19326* EXEC CICS HANDLE CONDITION
 19327*        NOTFND   (8190-NOTFND)
 19328*    END-EXEC.
 19329*    MOVE '"$I                   ! 0 #00018561' TO DFHEIV0
 19330     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19332     MOVE X'3020233030303138353631' TO DFHEIV0(25:11)
 19333     CALL 'kxdfhei1' USING DFHEIV0
 19334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19335
 19336
 19337     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19338     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19339
 19340
 19341* EXEC CICS READ
 19342*        UPDATE
 19343*        DATASET  (CRTT-ID)
 19344*        RIDFLD   (WS-ELCRTT-KEY)
 19345*        INTO     (CERTIFICATE-TRAILERS)
 19346*    END-EXEC.
 19347     MOVE LENGTH OF
 19348      CERTIFICATE-TRAILERS
 19349       TO DFHEIV11
 19350*    MOVE '&"IL       EU         (   #00018568' TO DFHEIV0
 19351     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19352     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19353     MOVE X'2020233030303138353638' TO DFHEIV0(25:11)
 19354     CALL 'kxdfhei1' USING DFHEIV0,
 19355           CRTT-ID,
 19356           CERTIFICATE-TRAILERS,
 19357           DFHEIV11,
 19358           WS-ELCRTT-KEY,
 19359           DFHEIV99,
 19360           DFHEIV99,
 19361           DFHEIV99
 19362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19363
 19364
 19365     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19366
 19367* EXEC CICS REWRITE
 19368*       DATASET  (CRTT-ID)
 19369*       FROM     (CERTIFICATE-TRAILERS)
 19370*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 356
* EL050.cbl
 19371     MOVE LENGTH OF
 19372      CERTIFICATE-TRAILERS
 19373       TO DFHEIV11
 19374*    MOVE '&& L                  %   #00018576' TO DFHEIV0
 19375     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19376     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19377     MOVE X'2020233030303138353736' TO DFHEIV0(25:11)
 19378     CALL 'kxdfhei1' USING DFHEIV0,
 19379           CRTT-ID,
 19380           CERTIFICATE-TRAILERS,
 19381           DFHEIV11,
 19382           DFHEIV99
 19383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19384
 19385
 19386     GO TO 8190-EXIT.
 19387
 19388 8190-NOTFND.
 19389
 19390     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19391     MOVE 'CS'         TO CS-RECORD-ID.
 19392     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19393     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19394     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19395     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19396
 19397* EXEC CICS WRITE
 19398*       DATASET  (CRTT-ID)
 19399*       RIDFLD   (WS-ELCRTT-KEY)
 19400*       FROM     (CERTIFICATE-TRAILERS)
 19401*    END-EXEC.
 19402     MOVE LENGTH OF
 19403      CERTIFICATE-TRAILERS
 19404       TO DFHEIV11
 19405*    MOVE '&$ L                  ''   #00018591' TO DFHEIV0
 19406     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19407     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19408     MOVE X'2020233030303138353931' TO DFHEIV0(25:11)
 19409     CALL 'kxdfhei1' USING DFHEIV0,
 19410           CRTT-ID,
 19411           CERTIFICATE-TRAILERS,
 19412           DFHEIV11,
 19413           WS-ELCRTT-KEY,
 19414           DFHEIV99,
 19415           DFHEIV99
 19416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19417
 19418
 19419 8190-EXIT.
 19420     EXIT.
 19421
 19422 8200-READ-REIN-TABLE.
 19423
 19424* EXEC CICS HANDLE CONDITION
 19425*         NOTFND   (8200-NOTFND)
 19426*    END-EXEC.
 19427*    MOVE '"$I                   ! 1 #00018601' TO DFHEIV0
 19428     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 357
* EL050.cbl
 19429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19430     MOVE X'3120233030303138363031' TO DFHEIV0(25:11)
 19431     CALL 'kxdfhei1' USING DFHEIV0
 19432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19433
 19434
 19435
 19436* EXEC CICS READ
 19437*        DATASET     (REIN-ID)
 19438*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19439*        RIDFLD      (ERREIN-KEY)
 19440*    END-EXEC.
 19441*    MOVE '&"S        E          (   #00018605' TO DFHEIV0
 19442     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19443     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19444     MOVE X'2020233030303138363035' TO DFHEIV0(25:11)
 19445     CALL 'kxdfhei1' USING DFHEIV0,
 19446           REIN-ID,
 19447           DFHEIV20,
 19448           DFHEIV99,
 19449           ERREIN-KEY,
 19450           DFHEIV99,
 19451           DFHEIV99,
 19452           DFHEIV99
 19453     SET ADDRESS OF REINSURANCE-RECORD TO
 19454         DFHEIV20
 19455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19456
 19457
 19458     GO TO 8200-EXIT.
 19459
 19460 8200-NOTFND.
 19461     MOVE 'N'             TO WS-REIN-READ-SW.
 19462
 19463 8200-EXIT.
 19464      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 358
* EL050.cbl
 19466
 19467 8300-READ-CTBL-TABLE.
 19468
 19469* EXEC CICS HANDLE CONDITION
 19470*        NOTFND    (8300-NOTFND)
 19471*        DISABLED  (8300-ERRESS-PROBLEM)
 19472*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19473*        ENDFILE   (8300-NOTFND)
 19474*    END-EXEC.
 19475*    MOVE '"$IcJ''                ! 2 #00018621' TO DFHEIV0
 19476     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19478     MOVE X'3220233030303138363231' TO DFHEIV0(25:11)
 19479     CALL 'kxdfhei1' USING DFHEIV0
 19480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19481
 19482
 19483
 19484* EXEC CICS READ
 19485*        DATASET     (CTBL-ID)
 19486*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19487*        RIDFLD      (ERCTBL-KEY)
 19488*    END-EXEC.
 19489*    MOVE '&"S        E          (   #00018628' TO DFHEIV0
 19490     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19491     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19492     MOVE X'2020233030303138363238' TO DFHEIV0(25:11)
 19493     CALL 'kxdfhei1' USING DFHEIV0,
 19494           CTBL-ID,
 19495           DFHEIV20,
 19496           DFHEIV99,
 19497           ERCTBL-KEY,
 19498           DFHEIV99,
 19499           DFHEIV99,
 19500           DFHEIV99
 19501     SET ADDRESS OF COMM-TABLE-RECORD TO
 19502         DFHEIV20
 19503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19504
 19505
 19506     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19507
 19508     GO TO 8300-EXIT.
 19509
 19510 8300-NOTFND.
 19511
 19512     IF CTBL-SW = '0530'
 19513         MOVE 'AA'                     TO WS-AH-COMP-CD
 19514         MOVE '0550'                   TO CTBL-SW
 19515         MOVE '1'                      TO WS-CTBL-READ-SW
 19516         GO TO 8300-EXIT.
 19517
 19518     IF CTBL-SW = '0540'
 19519         MOVE 'AA'                     TO WS-LF-COMP-CD
 19520         MOVE '0550'                   TO CTBL-SW
 19521         MOVE '1'                      TO WS-CTBL-READ-SW
 19522         GO TO 8300-EXIT.
 19523
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 359
* EL050.cbl
 19524     IF CTBL-SW = '0550'
 19525         MOVE '2'                      TO WS-CTBL-READ-SW
 19526         GO TO 8300-EXIT.
 19527
 19528     GO TO 8300-EXIT.
 19529
 19530 8300-ERRESS-PROBLEM.
 19531
 19532      MOVE ER-8050              TO WS-ERROR.
 19533      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19534
 19535     GO TO 8300-EXIT.
 19536
 19537 8300-EXIT.
 19538      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 360
* EL050.cbl
 19540
 19541
 19542 8400-GETMAIN-ERFORM.
 19543
 19544
 19545* EXEC CICS   GETMAIN
 19546*        LENGTH  (500)
 19547*        SET     (ADDRESS OF FORM-MASTER)
 19548*    END-EXEC.
 19549     MOVE 500
 19550       TO DFHEIV11
 19551*    MOVE '," L                  $   #00018672' TO DFHEIV0
 19552     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19553     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19554     MOVE X'2020233030303138363732' TO DFHEIV0(25:11)
 19555     CALL 'kxdfhei1' USING DFHEIV0,
 19556           DFHEIV20,
 19557           DFHEIV11,
 19558           DFHEIV99
 19559     SET ADDRESS OF FORM-MASTER TO
 19560         DFHEIV20
 19561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19562
 19563
 19564     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19565
 19566 8400-EXIT.
 19567      EXIT.
 19568
 19569 8450-READ-FORM-MASTER.
 19570
 19571
 19572* EXEC CICS  HANDLE CONDITION
 19573*        NOTFND   (8450-FORM-NOT-FOUND)
 19574*        ENDFILE  (8450-FORM-NOT-FOUND)
 19575*    END-EXEC.
 19576*    MOVE '"$I''                  ! 3 #00018684' TO DFHEIV0
 19577     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19579     MOVE X'3320233030303138363834' TO DFHEIV0(25:11)
 19580     CALL 'kxdfhei1' USING DFHEIV0
 19581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19582
 19583
 19584
 19585* EXEC CICS   READ
 19586*        DATASET   (FORM-ID)
 19587*        RIDFLD    (ERFORM-KEY)
 19588*        INTO      (FORM-MASTER)
 19589*        GTEQ
 19590*    END-EXEC.
 19591     MOVE LENGTH OF
 19592      FORM-MASTER
 19593       TO DFHEIV11
 19594*    MOVE '&"IL       G          (   #00018689' TO DFHEIV0
 19595     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19596     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19597     MOVE X'2020233030303138363839' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 361
* EL050.cbl
 19598     CALL 'kxdfhei1' USING DFHEIV0,
 19599           FORM-ID,
 19600           FORM-MASTER,
 19601           DFHEIV11,
 19602           ERFORM-KEY,
 19603           DFHEIV99,
 19604           DFHEIV99,
 19605           DFHEIV99
 19606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19607
 19608
 19609     MOVE  'Y'           TO  FORM-MASTER-SW.
 19610
 19611     GO TO  8450-EXIT.
 19612
 19613 8450-FORM-NOT-FOUND.
 19614
 19615     MOVE  'N'           TO  FORM-MASTER-SW.
 19616
 19617 8450-EXIT.
 19618      EXIT.
 19619
 19620 8500-DATE-CONVERT.
 19621
 19622* EXEC CICS LINK
 19623*        PROGRAM    ('ELDATCV')
 19624*        COMMAREA   (DATE-CONVERSION-DATA)
 19625*        LENGTH     (DC-COMM-LENGTH)
 19626*    END-EXEC.
 19627     MOVE 'ELDATCV' TO DFHEIV1
 19628*    MOVE '."C                   ''   #00018708' TO DFHEIV0
 19629     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19630     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19631     MOVE X'2020233030303138373038' TO DFHEIV0(25:11)
 19632     CALL 'kxdfhei1' USING DFHEIV0,
 19633           DFHEIV1,
 19634           DATE-CONVERSION-DATA,
 19635           DC-COMM-LENGTH,
 19636           DFHEIV99,
 19637           DFHEIV99,
 19638           DFHEIV99
 19639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19640
 19641
 19642 8500-EXIT.
 19643     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 362
* EL050.cbl
 19645
 19646 8555-RELOAD-CONTROL-FILE.
 19647     CONTINUE.
 19648
 19649 8555-EXIT.
 19650     EXIT.
 19651
 19652 8557-GETMAIN-ERPLAN.
 19653
 19654
 19655* EXEC CICS GETMAIN
 19656*        LENGTH    (840)
 19657*        SET       (ADDRESS OF PLAN-RECORDS)
 19658*    END-EXEC.
 19659     MOVE 840
 19660       TO DFHEIV11
 19661*    MOVE '," L                  $   #00018726' TO DFHEIV0
 19662     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19663     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19664     MOVE X'2020233030303138373236' TO DFHEIV0(25:11)
 19665     CALL 'kxdfhei1' USING DFHEIV0,
 19666           DFHEIV20,
 19667           DFHEIV11,
 19668           DFHEIV99
 19669     SET ADDRESS OF PLAN-RECORDS TO
 19670         DFHEIV20
 19671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19672
 19673
 19674     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19675
 19676 8557-EXIT.
 19677     EXIT.
 19678
 19679 8560-GETMAIN.
 19680
 19681* EXEC CICS GETMAIN
 19682*        LENGTH    (2000)
 19683*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19684*    END-EXEC.
 19685     MOVE 2000
 19686       TO DFHEIV11
 19687*    MOVE '," L                  $   #00018737' TO DFHEIV0
 19688     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19689     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19690     MOVE X'2020233030303138373337' TO DFHEIV0(25:11)
 19691     CALL 'kxdfhei1' USING DFHEIV0,
 19692           DFHEIV20,
 19693           DFHEIV11,
 19694           DFHEIV99
 19695     SET ADDRESS OF ACCOUNT-MASTER TO
 19696         DFHEIV20
 19697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19698
 19699
 19700     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19701
 19702 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 363
* EL050.cbl
 19703     EXIT.
 19704
 19705 8570-START-ACCOUNT-MASTER.
 19706
 19707* EXEC CICS HANDLE CONDITION
 19708*        NOTFND    (0199-ACCT-NOT-FOUND)
 19709*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19710*    END-EXEC.
 19711*    MOVE '"$I''                  ! 4 #00018748' TO DFHEIV0
 19712     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19714     MOVE X'3420233030303138373438' TO DFHEIV0(25:11)
 19715     CALL 'kxdfhei1' USING DFHEIV0
 19716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19717
 19718
 19719
 19720* EXEC CICS STARTBR
 19721*        DATASET    (ACCT-ID)
 19722*        RIDFLD     (ERACCT-KEY)
 19723*        GTEQ
 19724*    END-EXEC.
 19725     MOVE 0
 19726       TO DFHEIV11
 19727*    MOVE '&,         G          &   #00018753' TO DFHEIV0
 19728     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19729     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19730     MOVE X'2020233030303138373533' TO DFHEIV0(25:11)
 19731     CALL 'kxdfhei1' USING DFHEIV0,
 19732           ACCT-ID,
 19733           ERACCT-KEY,
 19734           DFHEIV99,
 19735           DFHEIV11,
 19736           DFHEIV99
 19737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19738
 19739
 19740 8570-EXIT.
 19741     EXIT.
 19742
 19743 8580-READ-ACCOUNT-MASTER.
 19744
 19745* EXEC CICS HANDLE CONDITION
 19746*        NOTFND    (0199-ACCT-NOT-FOUND)
 19747*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19748*    END-EXEC.
 19749*    MOVE '"$I''                  ! 5 #00018763' TO DFHEIV0
 19750     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19752     MOVE X'3520233030303138373633' TO DFHEIV0(25:11)
 19753     CALL 'kxdfhei1' USING DFHEIV0
 19754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19755
 19756
 19757
 19758* EXEC CICS READNEXT
 19759*        DATASET     (ACCT-ID)
 19760*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 364
* EL050.cbl
 19761*        RIDFLD      (ERACCT-KEY)
 19762*    END-EXEC.
 19763     MOVE LENGTH OF
 19764      ACCOUNT-MASTER
 19765       TO DFHEIV12
 19766     MOVE 0
 19767       TO DFHEIV11
 19768*    MOVE '&.IL                  )   #00018768' TO DFHEIV0
 19769     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19770     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19771     MOVE X'2020233030303138373638' TO DFHEIV0(25:11)
 19772     CALL 'kxdfhei1' USING DFHEIV0,
 19773           ACCT-ID,
 19774           ACCOUNT-MASTER,
 19775           DFHEIV12,
 19776           ERACCT-KEY,
 19777           DFHEIV99,
 19778           DFHEIV11,
 19779           DFHEIV99,
 19780           DFHEIV99
 19781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19782
 19783
 19784 8580-EXIT.
 19785     EXIT.
 19786
 19787 8582-READ-COMPENSATION-MASTER.
 19788
 19789* EXEC CICS HANDLE CONDITION
 19790*        NOTFND    (8582-COMP-NOT-FOUND)
 19791*        ENDFILE   (8582-COMP-NOT-FOUND)
 19792*    END-EXEC.
 19793*    MOVE '"$I''                  ! 6 #00018778' TO DFHEIV0
 19794     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19795     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19796     MOVE X'3620233030303138373738' TO DFHEIV0(25:11)
 19797     CALL 'kxdfhei1' USING DFHEIV0
 19798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19799
 19800
 19801
 19802* EXEC CICS READ
 19803*        DATASET     (COMP-ID)
 19804*        INTO        (COMPENSATION-MASTER)
 19805*        RIDFLD      (ERCOMP-KEY)
 19806*    END-EXEC.
 19807     MOVE LENGTH OF
 19808      COMPENSATION-MASTER
 19809       TO DFHEIV11
 19810*    MOVE '&"IL       E          (   #00018783' TO DFHEIV0
 19811     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19812     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19813     MOVE X'2020233030303138373833' TO DFHEIV0(25:11)
 19814     CALL 'kxdfhei1' USING DFHEIV0,
 19815           COMP-ID,
 19816           COMPENSATION-MASTER,
 19817           DFHEIV11,
 19818           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 365
* EL050.cbl
 19819           DFHEIV99,
 19820           DFHEIV99,
 19821           DFHEIV99
 19822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19823
 19824
 19825     MOVE 'Y'                    TO COMP-MASTER-SW
 19826
 19827     GO TO 8582-EXIT
 19828     .
 19829 8582-COMP-NOT-FOUND.
 19830
 19831     MOVE 'N'                    TO COMP-MASTER-SW.
 19832
 19833 8582-EXIT.
 19834     EXIT.
 19835
 19836 8583-READ-ERAGTC.
 19837
 19838* EXEC CICS HANDLE CONDITION
 19839*        NOTFND    (8583-AGTC-NOT-FOUND)
 19840*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19841*    END-EXEC.
 19842*    MOVE '"$I''                  ! 7 #00018801' TO DFHEIV0
 19843     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19845     MOVE X'3720233030303138383031' TO DFHEIV0(25:11)
 19846     CALL 'kxdfhei1' USING DFHEIV0
 19847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19848
 19849
 19850
 19851* EXEC CICS STARTBR
 19852*        DATASET    (AGTC-ID)
 19853*        RIDFLD     (ERAGTC-KEY)
 19854*        GTEQ
 19855*    END-EXEC.
 19856     MOVE 0
 19857       TO DFHEIV11
 19858*    MOVE '&,         G          &   #00018806' TO DFHEIV0
 19859     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19860     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19861     MOVE X'2020233030303138383036' TO DFHEIV0(25:11)
 19862     CALL 'kxdfhei1' USING DFHEIV0,
 19863           AGTC-ID,
 19864           ERAGTC-KEY,
 19865           DFHEIV99,
 19866           DFHEIV11,
 19867           DFHEIV99
 19868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19869
 19870
 19871 8583-READ-ERAGTC-NEXT.
 19872
 19873* EXEC CICS READNEXT
 19874*        DATASET     (AGTC-ID)
 19875*        INTO        (AGENT-COMMISSIONS)
 19876*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 366
* EL050.cbl
 19877*    END-EXEC.
 19878     MOVE LENGTH OF
 19879      AGENT-COMMISSIONS
 19880       TO DFHEIV12
 19881     MOVE 0
 19882       TO DFHEIV11
 19883*    MOVE '&.IL                  )   #00018813' TO DFHEIV0
 19884     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19885     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19886     MOVE X'2020233030303138383133' TO DFHEIV0(25:11)
 19887     CALL 'kxdfhei1' USING DFHEIV0,
 19888           AGTC-ID,
 19889           AGENT-COMMISSIONS,
 19890           DFHEIV12,
 19891           ERAGTC-KEY,
 19892           DFHEIV99,
 19893           DFHEIV11,
 19894           DFHEIV99,
 19895           DFHEIV99
 19896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19897
 19898
 19899*    MOVE 'Y'                    TO AGTC-MASTER-SW
 19900
 19901     GO TO 8583-EXIT
 19902     .
 19903 8583-AGTC-NOT-FOUND.
 19904
 19905     MOVE 'N'                    TO AGTC-MASTER-SW.
 19906
 19907 8583-EXIT.
 19908     EXIT.
 19909
 19910 8584-READ-BANK-CROSS-REF.
 19911
 19912* EXEC CICS HANDLE CONDITION
 19913*        NOTFND    (8584-BXRF-NOT-FOUND)
 19914*        ENDFILE   (8584-BXRF-NOT-FOUND)
 19915*    END-EXEC.
 19916*    MOVE '"$I''                  ! 8 #00018831' TO DFHEIV0
 19917     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19919     MOVE X'3820233030303138383331' TO DFHEIV0(25:11)
 19920     CALL 'kxdfhei1' USING DFHEIV0
 19921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19922
 19923
 19924
 19925* EXEC CICS READ
 19926*        DATASET     (BXRF-ID)
 19927*        INTO        (BANK-CROSS-REFERENCE)
 19928*        RIDFLD      (ERBXRF-KEY)
 19929*        LENGTH      (BXRF-REC-LENGTH)
 19930*    END-EXEC.
 19931*    MOVE '&"IL       E          (   #00018836' TO DFHEIV0
 19932     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19934     MOVE X'2020233030303138383336' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 367
* EL050.cbl
 19935     CALL 'kxdfhei1' USING DFHEIV0,
 19936           BXRF-ID,
 19937           BANK-CROSS-REFERENCE,
 19938           BXRF-REC-LENGTH,
 19939           ERBXRF-KEY,
 19940           DFHEIV99,
 19941           DFHEIV99,
 19942           DFHEIV99
 19943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19944
 19945
 19946     MOVE 'Y'                    TO BXRF-MASTER-SW
 19947
 19948     GO TO 8584-EXIT
 19949     .
 19950 8584-BXRF-NOT-FOUND.
 19951
 19952     MOVE 'N'                    TO BXRF-MASTER-SW.
 19953
 19954 8584-EXIT.
 19955     EXIT.
 19956
 19957 8585-READ-PLAN-MASTER.
 19958
 19959
 19960* EXEC CICS HANDLE CONDITION
 19961*        NOTFND    (8585-PLAN-NOT-FOUND)
 19962*        ENDFILE   (8585-PLAN-NOT-FOUND)
 19963*    END-EXEC.
 19964*    MOVE '"$I''                  ! 9 #00018856' TO DFHEIV0
 19965     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19966     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19967     MOVE X'3920233030303138383536' TO DFHEIV0(25:11)
 19968     CALL 'kxdfhei1' USING DFHEIV0
 19969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19970
 19971
 19972
 19973* EXEC CICS READ
 19974*        DATASET     (PLAN-ID)
 19975*        INTO        (PLAN-MASTER)
 19976*        RIDFLD      (ERPLAN-KEY)
 19977*    END-EXEC.
 19978     MOVE LENGTH OF
 19979      PLAN-MASTER
 19980       TO DFHEIV11
 19981*    MOVE '&"IL       E          (   #00018861' TO DFHEIV0
 19982     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19983     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19984     MOVE X'2020233030303138383631' TO DFHEIV0(25:11)
 19985     CALL 'kxdfhei1' USING DFHEIV0,
 19986           PLAN-ID,
 19987           PLAN-MASTER,
 19988           DFHEIV11,
 19989           ERPLAN-KEY,
 19990           DFHEIV99,
 19991           DFHEIV99,
 19992           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 368
* EL050.cbl
 19993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19994
 19995
 19996     MOVE 'Y'                    TO PLAN-MASTER-SW.
 19997
 19998     GO TO 8585-EXIT.
 19999
 20000 8585-PLAN-NOT-FOUND.
 20001
 20002     MOVE 'N'                    TO PLAN-MASTER-SW.
 20003
 20004 8585-EXIT.
 20005     EXIT.
 20006
 20007 8586-READ-LOAN-OFFICER.
 20008
 20009* EXEC CICS READ
 20010*        DATASET     (LOFC-ID)
 20011*        INTO        (LOAN-OFFICER-MASTER)
 20012*        RIDFLD      (ERLOFC-KEY)
 20013*        RESP        (WS-RESPONSE)
 20014*    END-EXEC
 20015     MOVE LENGTH OF
 20016      LOAN-OFFICER-MASTER
 20017       TO DFHEIV11
 20018*    MOVE '&"IL       E          (  N#00018879' TO DFHEIV0
 20019     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20021     MOVE X'204E233030303138383739' TO DFHEIV0(25:11)
 20022     CALL 'kxdfhei1' USING DFHEIV0,
 20023           LOFC-ID,
 20024           LOAN-OFFICER-MASTER,
 20025           DFHEIV11,
 20026           ERLOFC-KEY,
 20027           DFHEIV99,
 20028           DFHEIV99,
 20029           DFHEIV99
 20030     MOVE EIBRESP  TO WS-RESPONSE
 20031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20032
 20033     IF WS-RESP-NORMAL
 20034        MOVE 'Y'                 TO LOFC-MASTER-SW
 20035     ELSE
 20036        MOVE 'N'                 TO LOFC-MASTER-SW
 20037     END-IF
 20038     .
 20039 8586-EXIT.
 20040     EXIT.
 20041 8587-START-ERPDEF.
 20042
 20043* EXEC CICS STARTBR
 20044*       DATASET   (PDEF-ID)
 20045*       RIDFLD    (ERPDEF-KEY)
 20046*       GTEQ
 20047*       RESP      (WS-RESPONSE)
 20048*    END-EXEC
 20049     MOVE 0
 20050       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 369
* EL050.cbl
 20051*    MOVE '&,         G          &  N#00018895' TO DFHEIV0
 20052     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20053     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20054     MOVE X'204E233030303138383935' TO DFHEIV0(25:11)
 20055     CALL 'kxdfhei1' USING DFHEIV0,
 20056           PDEF-ID,
 20057           ERPDEF-KEY,
 20058           DFHEIV99,
 20059           DFHEIV11,
 20060           DFHEIV99
 20061     MOVE EIBRESP  TO WS-RESPONSE
 20062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20063     IF WS-RESP-NORMAL
 20064        MOVE 'Y'                 TO PDEF-MASTER-SW
 20065     ELSE
 20066        MOVE 'N'                 TO PDEF-MASTER-SW
 20067     END-IF
 20068     .
 20069 8587-EXIT.
 20070     EXIT.
 20071 8588-READ-ERPDEF.
 20072
 20073* EXEC CICS READNEXT
 20074*       DATASET   (PDEF-ID)
 20075*       RIDFLD    (ERPDEF-KEY)
 20076*       INTO      (PRODUCT-MASTER)
 20077*       RESP      (WS-RESPONSE)
 20078*    END-EXEC
 20079     MOVE LENGTH OF
 20080      PRODUCT-MASTER
 20081       TO DFHEIV12
 20082     MOVE 0
 20083       TO DFHEIV11
 20084*    MOVE '&.IL                  )  N#00018910' TO DFHEIV0
 20085     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20086     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20087     MOVE X'204E233030303138393130' TO DFHEIV0(25:11)
 20088     CALL 'kxdfhei1' USING DFHEIV0,
 20089           PDEF-ID,
 20090           PRODUCT-MASTER,
 20091           DFHEIV12,
 20092           ERPDEF-KEY,
 20093           DFHEIV99,
 20094           DFHEIV11,
 20095           DFHEIV99,
 20096           DFHEIV99
 20097     MOVE EIBRESP  TO WS-RESPONSE
 20098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20099     IF WS-RESP-NORMAL
 20100        MOVE 'Y'                 TO PDEF-MASTER-SW
 20101     ELSE
 20102        MOVE 'N'                 TO PDEF-MASTER-SW
 20103     END-IF
 20104     .
 20105 8588-EXIT.
 20106     EXIT.
 20107 8589-ENDBR-ERPDEF.
 20108
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 370
* EL050.cbl
 20109* EXEC CICS ENDBR
 20110*       DATASET   (PDEF-ID)
 20111*    END-EXEC
 20112     MOVE 0
 20113       TO DFHEIV11
 20114*    MOVE '&2                    $   #00018925' TO DFHEIV0
 20115     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20116     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20117     MOVE X'2020233030303138393235' TO DFHEIV0(25:11)
 20118     CALL 'kxdfhei1' USING DFHEIV0,
 20119           PDEF-ID,
 20120           DFHEIV11,
 20121           DFHEIV99
 20122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20123     .
 20124 8589-EXIT.
 20125     EXIT.
 20126 8590-READ-CERT-MASTER.
 20127     IF PB-COMPANY-ID = 'UCL'
 20128         GO TO 8690-READ-CERT-MASTER-UCL.
 20129
 20130
 20131* EXEC CICS HANDLE CONDITION
 20132*         NOTFND    (0299-CERT-NOT-FOUND)
 20133*    END-EXEC.
 20134*    MOVE '"$I                   ! : #00018935' TO DFHEIV0
 20135     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20136     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20137     MOVE X'3A20233030303138393335' TO DFHEIV0(25:11)
 20138     CALL 'kxdfhei1' USING DFHEIV0
 20139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20140
 20141
 20142
 20143* EXEC CICS READ
 20144*        DATASET     (CERT-ID)
 20145*        INTO        (CERTIFICATE-MASTER)
 20146*        RIDFLD      (ELCERT-KEY)
 20147*        UPDATE
 20148*    END-EXEC.
 20149     MOVE LENGTH OF
 20150      CERTIFICATE-MASTER
 20151       TO DFHEIV11
 20152*    MOVE '&"IL       EU         (   #00018939' TO DFHEIV0
 20153     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20154     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20155     MOVE X'2020233030303138393339' TO DFHEIV0(25:11)
 20156     CALL 'kxdfhei1' USING DFHEIV0,
 20157           CERT-ID,
 20158           CERTIFICATE-MASTER,
 20159           DFHEIV11,
 20160           ELCERT-KEY,
 20161           DFHEIV99,
 20162           DFHEIV99,
 20163           DFHEIV99
 20164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20165
 20166
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 371
* EL050.cbl
 20167 8590-EXIT.
 20168     EXIT.
 20169
 20170 8690-READ-CERT-MASTER-UCL.
 20171
 20172* EXEC CICS HANDLE CONDITION
 20173*         NOTFND    (8700-READ-CERT-MASTER)
 20174*    END-EXEC.
 20175*    MOVE '"$I                   ! ; #00018950' TO DFHEIV0
 20176     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20177     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20178     MOVE X'3B20233030303138393530' TO DFHEIV0(25:11)
 20179     CALL 'kxdfhei1' USING DFHEIV0
 20180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20181
 20182
 20183 8690-READ-CERT-CONT.
 20184
 20185* EXEC CICS READ
 20186*        DATASET     (CERT-ID)
 20187*        INTO        (CERTIFICATE-MASTER)
 20188*        RIDFLD      (ELCERT-KEY)
 20189*        UPDATE
 20190*    END-EXEC.
 20191     MOVE LENGTH OF
 20192      CERTIFICATE-MASTER
 20193       TO DFHEIV11
 20194*    MOVE '&"IL       EU         (   #00018955' TO DFHEIV0
 20195     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20196     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20197     MOVE X'2020233030303138393535' TO DFHEIV0(25:11)
 20198     CALL 'kxdfhei1' USING DFHEIV0,
 20199           CERT-ID,
 20200           CERTIFICATE-MASTER,
 20201           DFHEIV11,
 20202           ELCERT-KEY,
 20203           DFHEIV99,
 20204           DFHEIV99,
 20205           DFHEIV99
 20206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20207
 20208
 20209     GO TO 8590-EXIT.
 20210
 20211 8700-READ-CERT-MASTER.
 20212     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20213     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20214
 20215* EXEC CICS HANDLE CONDITION
 20216*         DUPKEY    (8720-COMP-ACCOUNTS)
 20217*         ENDFILE   (8730-END-BROWSE)
 20218*         NOTFND    (8740-NOT-FOUND)
 20219*    END-EXEC.
 20220*    MOVE '"$$''I                 ! < #00018967' TO DFHEIV0
 20221     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20223     MOVE X'3C20233030303138393637' TO DFHEIV0(25:11)
 20224     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 372
* EL050.cbl
 20225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20226
 20227
 20228
 20229* EXEC CICS STARTBR
 20230*        DATASET     ('ELCERT5')
 20231*        RIDFLD      (ELCERT2-KEY)
 20232*        EQUAL
 20233*    END-EXEC.
 20234     MOVE 'ELCERT5' TO DFHEIV1
 20235     MOVE 0
 20236       TO DFHEIV11
 20237*    MOVE '&,         E          &   #00018973' TO DFHEIV0
 20238     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20239     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20240     MOVE X'2020233030303138393733' TO DFHEIV0(25:11)
 20241     CALL 'kxdfhei1' USING DFHEIV0,
 20242           DFHEIV1,
 20243           ELCERT2-KEY,
 20244           DFHEIV99,
 20245           DFHEIV11,
 20246           DFHEIV99
 20247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20248
 20249
 20250 8710-READ-NEXT.
 20251
 20252* EXEC CICS READNEXT
 20253*        DATASET     ('ELCERT5')
 20254*        INTO        (CERTIFICATE-MASTER)
 20255*        RIDFLD      (ELCERT2-KEY)
 20256*    END-EXEC.
 20257     MOVE LENGTH OF
 20258      CERTIFICATE-MASTER
 20259       TO DFHEIV12
 20260     MOVE 'ELCERT5' TO DFHEIV1
 20261     MOVE 0
 20262       TO DFHEIV11
 20263*    MOVE '&.IL                  )   #00018980' TO DFHEIV0
 20264     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20265     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20266     MOVE X'2020233030303138393830' TO DFHEIV0(25:11)
 20267     CALL 'kxdfhei1' USING DFHEIV0,
 20268           DFHEIV1,
 20269           CERTIFICATE-MASTER,
 20270           DFHEIV12,
 20271           ELCERT2-KEY,
 20272           DFHEIV99,
 20273           DFHEIV11,
 20274           DFHEIV99,
 20275           DFHEIV99
 20276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20277
 20278
 20279 8720-COMP-ACCOUNTS.
 20280
 20281* EXEC CICS ENTER
 20282*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 373
* EL050.cbl
 20283*         FROM (PB-C-LAST-NAME)
 20284*    END-EXEC.
 20285     MOVE 001
 20286       TO DFHEIV11
 20287*    MOVE ':$F                   %   #00018987' TO DFHEIV0
 20288     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20289     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20290     MOVE X'2020233030303138393837' TO DFHEIV0(25:11)
 20291     CALL 'kxdfhei1' USING DFHEIV0,
 20292           DFHEIV11,
 20293           PB-C-LAST-NAME,
 20294           DFHEIV99,
 20295           DFHEIV99
 20296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20297
 20298
 20299
 20300* EXEC CICS ENTER
 20301*         TRACEID (002)
 20302*         FROM (CM-INSURED-LAST-NAME)
 20303*    END-EXEC.
 20304     MOVE 002
 20305       TO DFHEIV11
 20306*    MOVE ':$F                   %   #00018992' TO DFHEIV0
 20307     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20308     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20309     MOVE X'2020233030303138393932' TO DFHEIV0(25:11)
 20310     CALL 'kxdfhei1' USING DFHEIV0,
 20311           DFHEIV11,
 20312           CM-INSURED-LAST-NAME,
 20313           DFHEIV99,
 20314           DFHEIV99
 20315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20316
 20317
 20318     IF PB-CERT-NO NOT = CM-CERT-NO
 20319         GO TO 8730-END-BROWSE.
 20320
 20321     IF PB-ACCOUNT = CM-ACCOUNT
 20322         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20323             MOVE ER-2799        TO WS-ERROR
 20324             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20325             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20326             GO TO 8730-END-BROWSE.
 20327
 20328     GO TO 8710-READ-NEXT.
 20329
 20330 8730-END-BROWSE.
 20331
 20332* EXEC CICS ENDBR
 20333*         DATASET    ('ELCERT5')
 20334*    END-EXEC.
 20335     MOVE 'ELCERT5' TO DFHEIV1
 20336     MOVE 0
 20337       TO DFHEIV11
 20338*    MOVE '&2                    $   #00019010' TO DFHEIV0
 20339     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20340     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 374
* EL050.cbl
 20341     MOVE X'2020233030303139303130' TO DFHEIV0(25:11)
 20342     CALL 'kxdfhei1' USING DFHEIV0,
 20343           DFHEIV1,
 20344           DFHEIV11,
 20345           DFHEIV99
 20346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20347
 20348
 20349 8740-NOT-FOUND.
 20350     GO TO 0299-CERT-NOT-FOUND.
 20351
 20352 8750-START-ELSTAT.
 20353
 20354* EXEC CICS STARTBR
 20355*       DATASET   (STAT-ID)
 20356*       RIDFLD    (ELSTAT-KEY)
 20357*       GTEQ
 20358*       RESP      (WS-RESPONSE)
 20359*    END-EXEC
 20360     MOVE 0
 20361       TO DFHEIV11
 20362*    MOVE '&,         G          &  N#00019018' TO DFHEIV0
 20363     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20364     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20365     MOVE X'204E233030303139303138' TO DFHEIV0(25:11)
 20366     CALL 'kxdfhei1' USING DFHEIV0,
 20367           STAT-ID,
 20368           ELSTAT-KEY,
 20369           DFHEIV99,
 20370           DFHEIV11,
 20371           DFHEIV99
 20372     MOVE EIBRESP  TO WS-RESPONSE
 20373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20374     IF WS-RESP-NORMAL
 20375        MOVE 'Y'                 TO STAT-MASTER-SW
 20376     ELSE
 20377        MOVE 'N'                 TO STAT-MASTER-SW
 20378     END-IF
 20379     .
 20380 8750-EXIT.
 20381     EXIT.
 20382 8752-READ-ELSTAT.
 20383
 20384* EXEC CICS READNEXT
 20385*       DATASET   (STAT-ID)
 20386*       RIDFLD    (ELSTAT-KEY)
 20387*       INTO      (STATE-FILE)
 20388*       RESP      (WS-RESPONSE)
 20389*    END-EXEC
 20390     MOVE LENGTH OF
 20391      STATE-FILE
 20392       TO DFHEIV12
 20393     MOVE 0
 20394       TO DFHEIV11
 20395*    MOVE '&.IL                  )  N#00019033' TO DFHEIV0
 20396     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20397     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20398     MOVE X'204E233030303139303333' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 375
* EL050.cbl
 20399     CALL 'kxdfhei1' USING DFHEIV0,
 20400           STAT-ID,
 20401           STATE-FILE,
 20402           DFHEIV12,
 20403           ELSTAT-KEY,
 20404           DFHEIV99,
 20405           DFHEIV11,
 20406           DFHEIV99,
 20407           DFHEIV99
 20408     MOVE EIBRESP  TO WS-RESPONSE
 20409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20410     IF WS-RESP-NORMAL
 20411        MOVE 'Y'                 TO STAT-MASTER-SW
 20412     ELSE
 20413        MOVE 'N'                 TO STAT-MASTER-SW
 20414     END-IF
 20415     .
 20416 8752-EXIT.
 20417     EXIT.
 20418 8800-GET-COMP-RATE.
 20419     MOVE +1 TO IB.
 20420     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20421         ADD +9 TO IB
 20422         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20423             ADD +9 TO IB
 20424             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20425                MOVE ZEROS       TO WS-WK-RATE
 20426                GO TO 8800-EXIT.
 20427
 20428     IF PB-I-AGE GREATER CT-AGE (1)
 20429         ADD +3 TO IB
 20430         IF PB-I-AGE GREATER CT-AGE (2)
 20431             ADD +3 TO IB
 20432             IF PB-I-AGE GREATER CT-AGE (3)
 20433                MOVE ZEROS       TO WS-WK-RATE
 20434                GO TO 8800-EXIT.
 20435
 20436     IF WS-WORK-TERM GREATER CT-TRM (1)
 20437         ADD +1 TO IB
 20438         IF WS-WORK-TERM GREATER CT-TRM (2)
 20439             ADD +1 TO IB
 20440             IF WS-WORK-TERM GREATER CT-TRM (3)
 20441                MOVE ZEROS       TO WS-WK-RATE
 20442                GO TO 8800-EXIT.
 20443
 20444     IF CT-RT (IB) NOT NUMERIC
 20445         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20446         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20447         GO TO 8800-GET-COMP-RATE.
 20448
 20449     MOVE CT-RT (IB) TO WS-WK-RATE.
 20450
 20451 8800-EXIT.
 20452     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 376
* EL050.cbl
 20454 8900-ADDRESS-FILE.
 20455     IF ERACCT-FILE-ADDRESSED
 20456         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20457         GO TO 8900-ADDRESS-EXIT.
 20458
 20459     IF ELCNTL-FILE-ADDRESSED
 20460         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20461         GO TO 8900-ADDRESS-EXIT.
 20462
 20463     IF ERPLAN-FILE-ADDRESSED
 20464         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20465         GO TO 8900-ADDRESS-EXIT.
 20466
 20467     IF ERFORM-FILE-ADDRESSED
 20468         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20469         GO TO 8900-ADDRESS-EXIT.
 20470
 20471 8900-ADDRESS-EXIT.
 20472     EXIT.
 20473
 20474 9000-READ-CONTROL.
 20475
 20476* EXEC CICS HANDLE CONDITION
 20477*        NOTFND    (9000-NOTFND)
 20478*    END-EXEC.
 20479*    MOVE '"$I                   ! = #00019104' TO DFHEIV0
 20480     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20482     MOVE X'3D20233030303139313034' TO DFHEIV0(25:11)
 20483     CALL 'kxdfhei1' USING DFHEIV0
 20484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20485
 20486
 20487
 20488* EXEC CICS READ
 20489*        DATASET     (CNTL-ID)
 20490*        SET         (ADDRESS OF CONTROL-FILE)
 20491*        RIDFLD      (ELCNTL-KEY)
 20492*        GTEQ
 20493*    END-EXEC.
 20494*    MOVE '&"S        G          (   #00019108' TO DFHEIV0
 20495     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20496     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20497     MOVE X'2020233030303139313038' TO DFHEIV0(25:11)
 20498     CALL 'kxdfhei1' USING DFHEIV0,
 20499           CNTL-ID,
 20500           DFHEIV20,
 20501           DFHEIV99,
 20502           ELCNTL-KEY,
 20503           DFHEIV99,
 20504           DFHEIV99,
 20505           DFHEIV99
 20506     SET ADDRESS OF CONTROL-FILE TO
 20507         DFHEIV20
 20508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20509
 20510
 20511     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 377
* EL050.cbl
 20512
 20513 9000-NOTFND.
 20514     IF RC-SW-1 = '1'
 20515        MOVE ER-2616              TO WS-ERROR
 20516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20517        GO TO 9000-EXIT.
 20518
 20519     IF RC-SW-1 = '2'
 20520        MOVE ER-2602              TO WS-ERROR
 20521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20522
 20523 9000-EXIT.
 20524      EXIT.
 20525
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 378
* EL050.cbl
 20527 9100-READ-CONTROL.
 20528
 20529* EXEC CICS HANDLE CONDITION
 20530*        NOTFND  (9100-NOTFND)
 20531*        ENDFILE (9100-NOTFND)
 20532*    END-EXEC.
 20533*    MOVE '"$I''                  ! > #00019132' TO DFHEIV0
 20534     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20535     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20536     MOVE X'3E20233030303139313332' TO DFHEIV0(25:11)
 20537     CALL 'kxdfhei1' USING DFHEIV0
 20538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20539
 20540
 20541
 20542* EXEC CICS READ
 20543*        DATASET     (CNTL-ID)
 20544*        INTO        (CONTROL-FILE)
 20545*        RIDFLD      (ELCNTL-KEY)
 20546*        GTEQ
 20547*    END-EXEC.
 20548     MOVE LENGTH OF
 20549      CONTROL-FILE
 20550       TO DFHEIV11
 20551*    MOVE '&"IL       G          (   #00019137' TO DFHEIV0
 20552     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20554     MOVE X'2020233030303139313337' TO DFHEIV0(25:11)
 20555     CALL 'kxdfhei1' USING DFHEIV0,
 20556           CNTL-ID,
 20557           CONTROL-FILE,
 20558           DFHEIV11,
 20559           ELCNTL-KEY,
 20560           DFHEIV99,
 20561           DFHEIV99,
 20562           DFHEIV99
 20563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20564
 20565
 20566     GO TO 9100-EXIT.
 20567
 20568 9100-NOTFND.
 20569     IF RC-SW-2 = '0'
 20570        MOVE '1'                  TO STATE-RECORD-ERROR
 20571        GO TO 9100-EXIT
 20572     END-IF
 20573     IF RC-SW-2 = '1'
 20574        MOVE '1'                  TO LF-BENEFIT-ERROR
 20575        MOVE ER-2604              TO WS-ERROR
 20576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20577        GO TO 9100-EXIT.
 20578
 20579     IF RC-SW-2 = '2'
 20580        MOVE '1'                  TO AH-BENEFIT-ERROR
 20581        MOVE ER-2605              TO WS-ERROR
 20582        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20583        GO TO 9100-EXIT.
 20584
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 379
* EL050.cbl
 20585     IF RC-SW-2 = '3'
 20586         MOVE ER-2603           TO WS-ERROR
 20587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20588         GO TO 9100-EXIT.
 20589
 20590     IF RC-SW-2 = '4'
 20591         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20592         GO TO 9100-EXIT.
 20593
 20594     IF RC-SW-2 = '5'
 20595         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20596         IF WS-AH-INPUT-CD-1 = SPACE
 20597             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20598         ELSE
 20599             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20600
 20601 9100-EXIT.
 20602      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 380
* EL050.cbl
 20604 9200-CONTROL-GETMAIN.
 20605
 20606* EXEC CICS GETMAIN
 20607*         LENGTH   (750)
 20608*         SET      (ADDRESS OF CONTROL-FILE)
 20609*    END-EXEC.
 20610     MOVE 750
 20611       TO DFHEIV11
 20612*    MOVE '," L                  $   #00019183' TO DFHEIV0
 20613     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20614     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20615     MOVE X'2020233030303139313833' TO DFHEIV0(25:11)
 20616     CALL 'kxdfhei1' USING DFHEIV0,
 20617           DFHEIV20,
 20618           DFHEIV11,
 20619           DFHEIV99
 20620     SET ADDRESS OF CONTROL-FILE TO
 20621         DFHEIV20
 20622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20623
 20624
 20625     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20626
 20627 9200-EXIT.
 20628     EXIT.
 20629
 20630 9250-UNLOCK-RETURN.
 20631
 20632* EXEC CICS UNLOCK
 20633*        DATASET   (CERT-ID)
 20634*    END-EXEC.
 20635*    MOVE '&*                    #   #00019194' TO DFHEIV0
 20636     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20637     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20638     MOVE X'2020233030303139313934' TO DFHEIV0(25:11)
 20639     CALL 'kxdfhei1' USING DFHEIV0,
 20640           CERT-ID,
 20641           DFHEIV99
 20642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20643
 20644
 20645 9300-ABEND.
 20646     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20647
 20648
 20649* EXEC CICS LINK
 20650*        PROGRAM   ('EL004')
 20651*        COMMAREA  (WS-ERROR-LINE)
 20652*        LENGTH    (72)
 20653*    END-EXEC.
 20654     MOVE 'EL004' TO DFHEIV1
 20655     MOVE 72
 20656       TO DFHEIV11
 20657*    MOVE '."C                   ''   #00019201' TO DFHEIV0
 20658     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20659     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20660     MOVE X'2020233030303139323031' TO DFHEIV0(25:11)
 20661     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 381
* EL050.cbl
 20662           DFHEIV1,
 20663           WS-ERROR-LINE,
 20664           DFHEIV11,
 20665           DFHEIV99,
 20666           DFHEIV99,
 20667           DFHEIV99
 20668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20669
 20670
 20671     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20672
 20673
 20674* EXEC CICS ABEND
 20675*        ABCODE ('EL50')
 20676*    END-EXEC.
 20677     MOVE 'EL50' TO DFHEIV5
 20678*    MOVE '.,A                   "   #00019209' TO DFHEIV0
 20679     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20680     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20681     MOVE X'2020233030303139323039' TO DFHEIV0(25:11)
 20682     CALL 'kxdfhei1' USING DFHEIV0,
 20683           DFHEIV5
 20684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20685
 20686
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 382
* EL050.cbl
 20688
 20689******************************************************************
 20690*                                                                *
 20691*            E R R O R   F O R M A T   R O U T I N E             *
 20692*                                                                *
 20693******************************************************************
 20694
 20695 9900-ERROR-FORMAT.
 20696
 20697     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20698                    PB-COMMON-ERROR (2) OR
 20699                    PB-COMMON-ERROR (3) OR
 20700                    PB-COMMON-ERROR (4) OR
 20701                    PB-COMMON-ERROR (5) OR
 20702                    PB-COMMON-ERROR (6) OR
 20703                    PB-COMMON-ERROR (7) OR
 20704                    PB-COMMON-ERROR (8) OR
 20705                    PB-COMMON-ERROR (9) OR
 20706                    PB-COMMON-ERROR (10)
 20707        GO TO 9900-EXIT.
 20708
 20709     IF PB-NO-OF-ERRORS = +10
 20710        GO TO 9900-EXIT.
 20711
 20712     ADD +1  TO PB-NO-OF-ERRORS.
 20713     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20714                                       (PB-NO-OF-ERRORS).
 20715 9900-EXIT.
 20716     EXIT.
 20717
 20718 9990-RETURN.
 20719     IF BROWSE-STARTED
 20720
 20721* EXEC CICS ENDBR
 20722*            DATASET  (ACCT-ID)
 20723*       END-EXEC.
 20724     MOVE 0
 20725       TO DFHEIV11
 20726*    MOVE '&2                    $   #00019246' TO DFHEIV0
 20727     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20728     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20729     MOVE X'2020233030303139323436' TO DFHEIV0(25:11)
 20730     CALL 'kxdfhei1' USING DFHEIV0,
 20731           ACCT-ID,
 20732           DFHEIV11,
 20733           DFHEIV99
 20734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20735
 20736
 20737 9990-EXIT.
 20738     EXIT.
 20739
 20740 9999-RETURN.
 20741     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 20742
 20743
 20744* EXEC CICS RETURN
 20745*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 383
* EL050.cbl
 20746*    MOVE '.(                    &   #00019256' TO DFHEIV0
 20747     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20748     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20749     MOVE X'2020233030303139323536' TO DFHEIV0(25:11)
 20750     CALL 'kxdfhei1' USING DFHEIV0,
 20751           DFHEIV99,
 20752           DFHEIV99,
 20753           DFHEIV99,
 20754           DFHEIV99,
 20755           DFHEIV99
 20756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20757
 20758
 20759
 20760* GOBACK.
 20761     MOVE '9%                    "   ' TO DFHEIV0
 20762     MOVE 'EL050' TO DFHEIV1
 20763     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20764     GOBACK.
 20765
 20766 9999-DFHBACK SECTION.
 20767     MOVE '9%                    "   ' TO DFHEIV0
 20768     MOVE 'EL050' TO DFHEIV1
 20769     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20770     GOBACK.
 20771 9999-DFHEXIT.
 20772     IF DFHEIGDJ EQUAL 0001
 20773         NEXT SENTENCE
 20774     ELSE IF DFHEIGDJ EQUAL 2
 20775         GO TO 9300-ABEND,
 20776               3990-FILES-NOT-OPEN
 20777         DEPENDING ON DFHEIGDI
 20778     ELSE IF DFHEIGDJ EQUAL 3
 20779         GO TO 6610-START-BROWSE,
 20780               6630-ERRESS-PROBLEM,
 20781               6630-END-OF-FILE
 20782         DEPENDING ON DFHEIGDI
 20783     ELSE IF DFHEIGDJ EQUAL 4
 20784         GO TO 6630-END-OF-FILE,
 20785               6630-ERRESS-PROBLEM,
 20786               6630-ERRESS-PROBLEM,
 20787               6630-END-OF-FILE
 20788         DEPENDING ON DFHEIGDI
 20789     ELSE IF DFHEIGDJ EQUAL 5
 20790         GO TO 6630-END-OF-FILE,
 20791               6630-END-OF-FILE,
 20792               6630-ERRESS-PROBLEM,
 20793               6630-ERRESS-PROBLEM
 20794         DEPENDING ON DFHEIGDI
 20795     ELSE IF DFHEIGDJ EQUAL 6
 20796         GO TO 6660-START-BROWSE,
 20797               6690-ERRESC-PROBLEM,
 20798               6690-ERRESC-PROBLEM,
 20799               6690-END-OF-FILE
 20800         DEPENDING ON DFHEIGDI
 20801     ELSE IF DFHEIGDJ EQUAL 7
 20802         GO TO 6690-END-OF-FILE,
 20803               6690-ERRESC-PROBLEM,
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 384
* EL050.cbl
 20804               6690-ERRESC-PROBLEM,
 20805               6690-END-OF-FILE
 20806         DEPENDING ON DFHEIGDI
 20807     ELSE IF DFHEIGDJ EQUAL 8
 20808         GO TO 6690-END-OF-FILE,
 20809               6690-ERRESC-PROBLEM,
 20810               6690-ERRESC-PROBLEM,
 20811               6690-END-OF-FILE
 20812         DEPENDING ON DFHEIGDI
 20813     ELSE IF DFHEIGDJ EQUAL 9
 20814         GO TO 7250-CONTINUE,
 20815               7250-CONTINUE
 20816         DEPENDING ON DFHEIGDI
 20817     ELSE IF DFHEIGDJ EQUAL 10
 20818         GO TO 7300-CONTINUE,
 20819               7300-CONTINUE
 20820         DEPENDING ON DFHEIGDI
 20821     ELSE IF DFHEIGDJ EQUAL 11
 20822         GO TO 8000-FREE-MAIN
 20823         DEPENDING ON DFHEIGDI
 20824     ELSE IF DFHEIGDJ EQUAL 12
 20825         GO TO 8100-NOTFND,
 20826               8100-NOTFND
 20827         DEPENDING ON DFHEIGDI
 20828     ELSE IF DFHEIGDJ EQUAL 13
 20829         GO TO 8110-NOTFND,
 20830               8110-NOTFND
 20831         DEPENDING ON DFHEIGDI
 20832     ELSE IF DFHEIGDJ EQUAL 14
 20833         GO TO 8130-EXIT
 20834         DEPENDING ON DFHEIGDI
 20835     ELSE IF DFHEIGDJ EQUAL 15
 20836         GO TO 8180-NOTFND
 20837         DEPENDING ON DFHEIGDI
 20838     ELSE IF DFHEIGDJ EQUAL 16
 20839         GO TO 8190-NOTFND
 20840         DEPENDING ON DFHEIGDI
 20841     ELSE IF DFHEIGDJ EQUAL 17
 20842         GO TO 8200-NOTFND
 20843         DEPENDING ON DFHEIGDI
 20844     ELSE IF DFHEIGDJ EQUAL 18
 20845         GO TO 8300-NOTFND,
 20846               8300-ERRESS-PROBLEM,
 20847               8300-ERRESS-PROBLEM,
 20848               8300-NOTFND
 20849         DEPENDING ON DFHEIGDI
 20850     ELSE IF DFHEIGDJ EQUAL 19
 20851         GO TO 8450-FORM-NOT-FOUND,
 20852               8450-FORM-NOT-FOUND
 20853         DEPENDING ON DFHEIGDI
 20854     ELSE IF DFHEIGDJ EQUAL 20
 20855         GO TO 0199-ACCT-NOT-FOUND,
 20856               0199-ACCT-NOT-FOUND
 20857         DEPENDING ON DFHEIGDI
 20858     ELSE IF DFHEIGDJ EQUAL 21
 20859         GO TO 0199-ACCT-NOT-FOUND,
 20860               0199-ACCT-NOT-FOUND
 20861         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 20-Apr-12 17:05 Page 385
* EL050.cbl
 20862     ELSE IF DFHEIGDJ EQUAL 22
 20863         GO TO 8582-COMP-NOT-FOUND,
 20864               8582-COMP-NOT-FOUND
 20865         DEPENDING ON DFHEIGDI
 20866     ELSE IF DFHEIGDJ EQUAL 23
 20867         GO TO 8583-AGTC-NOT-FOUND,
 20868               8583-AGTC-NOT-FOUND
 20869         DEPENDING ON DFHEIGDI
 20870     ELSE IF DFHEIGDJ EQUAL 24
 20871         GO TO 8584-BXRF-NOT-FOUND,
 20872               8584-BXRF-NOT-FOUND
 20873         DEPENDING ON DFHEIGDI
 20874     ELSE IF DFHEIGDJ EQUAL 25
 20875         GO TO 8585-PLAN-NOT-FOUND,
 20876               8585-PLAN-NOT-FOUND
 20877         DEPENDING ON DFHEIGDI
 20878     ELSE IF DFHEIGDJ EQUAL 26
 20879         GO TO 0299-CERT-NOT-FOUND
 20880         DEPENDING ON DFHEIGDI
 20881     ELSE IF DFHEIGDJ EQUAL 27
 20882         GO TO 8700-READ-CERT-MASTER
 20883         DEPENDING ON DFHEIGDI
 20884     ELSE IF DFHEIGDJ EQUAL 28
 20885         GO TO 8720-COMP-ACCOUNTS,
 20886               8730-END-BROWSE,
 20887               8740-NOT-FOUND
 20888         DEPENDING ON DFHEIGDI
 20889     ELSE IF DFHEIGDJ EQUAL 29
 20890         GO TO 9000-NOTFND
 20891         DEPENDING ON DFHEIGDI
 20892     ELSE IF DFHEIGDJ EQUAL 30
 20893         GO TO 9100-NOTFND,
 20894               9100-NOTFND
 20895         DEPENDING ON DFHEIGDI.
 20896     MOVE '9%                    "   ' TO DFHEIV0
 20897     MOVE 'EL050' TO DFHEIV1
 20898     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20899     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       39416     Code:       84573
