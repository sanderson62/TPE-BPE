* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84* 021519  CR2019021100001  PEMA  non-monthly al calcs
    85* 012220  CR2018092700002  TANA  Add letter reqd field
    86* 012820  CR2020012800001  PEMA  Addd minimum term edit for extd t
    87* 031620  CR2019092700001  PEMA  Remove post card indicator
    88* 041320  CR2020040200001  PEMA  PENDING BUSINESS JOURNALING
    89******************************************************************
    90
    91 ENVIRONMENT DIVISION.
    92
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page   4
* EL6311.cbl
    94 DATA DIVISION.
    95 WORKING-STORAGE SECTION.
    96 01  DFH-START PIC X(04).
    97 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    98 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    99 77  FILLER  PIC X(32)  VALUE '********************************'.
   100 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
   101 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
   102 77  A1                          PIC S999 COMP-3 VALUE +0.
   103 77  N1                          PIC S999 COMP-3 VALUE +0.
   104 77  N2                          PIC S999 COMP-3 VALUE +0.
   105 77  N3                          PIC S999 COMP-3 VALUE +0.
   106 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   107 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   108 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   109     88  REVERSAL                    VALUE 'Y'.
   110 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   111 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   112 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   113 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   114 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   115     88  ERMAIL-FOUND                 VALUE 'Y'.
   116 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   117 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   118 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   119 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   120     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   121 77  ws-stop-sw                  pic x value ' '.
   122     88  i-say-stop                 value 'Y'.
   123 77  ws-check-sw                 pic x value ' '.
   124     88  i-have-checks              value 'Y'.
   125 77  ws-proc-check-sw            pic x value ' '.
   126     88  i-have-processed-checks    value 'Y'.
   127 77  ws-any-check-sw             pic x value ' '.
   128     88  i-have-a-check-period      value 'Y'.
   129 77  ws-chek-browse-sw           pic x value ' '.
   130 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   131 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   132 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   133 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   134 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   135 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   136 77  ws-elcrtt-update-sw         pic x value ' '.
   137     88  update-elcrtt              value 'Y'.
   138 01  P pointer.
   139 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   140 01  var-ptr pointer.
   141 01  env-var-len                 pic 9(4)  binary.
   142 01  rc                          pic 9(9)  binary.
   143 01  WS-KIXSYS.
   144     05  WS-KIX-FIL1             PIC X(10).
   145     05  WS-KIX-APPS             PIC X(10).
   146     05  WS-KIX-ENV              PIC X(10).
   147     05  WS-KIX-MYENV            PIC X(10).
   148     05  WS-KIX-SYS              PIC X(10).
   149*    COPY ELCSCTM.
   150******************************************************************
   151*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page   5
* EL6311.cbl
   152*                                                                *
   153*                            ELCSCTM                             *
   154*                            VMOD=2.001                          *
   155*                                                                *
   156*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   157*                                                                *
   158******************************************************************
   159 01  SECURITY-MESSAGE.
   160     12  FILLER                          PIC X(30)
   161            VALUE '** LOGIC SECURITY VIOLATION -'.
   162     12  SM-READ                         PIC X(6).
   163     12  FILLER                          PIC X(5)
   164            VALUE ' PGM='.
   165     12  SM-PGM                          PIC X(6).
   166     12  FILLER                          PIC X(5)
   167            VALUE ' OPR='.
   168     12  SM-PROCESSOR-ID                 PIC X(4).
   169     12  FILLER                          PIC X(6)
   170            VALUE ' TERM='.
   171     12  SM-TERMID                       PIC X(4).
   172     12  FILLER                          PIC XX   VALUE SPACE.
   173     12  SM-JUL-DATE                     PIC 9(5).
   174     12  FILLER                          PIC X    VALUE SPACE.
   175     12  SM-TIME                         PIC 99.99.
   176
   177
   178*    COPY ELCSCRTY.
   179******************************************************************
   180*                                                                *
   181*                                                                *
   182*                            ELCSCRTY                            *
   183*                            VMOD=2.001                          *
   184*                                                                *
   185*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   186*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   187*        SAVED IN PI-SECURITY-ADDRESS.                           *
   188*                                                                *
   189******************************************************************
   190 01  SECURITY-CONTROL.
   191     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   192     12  FILLER                       PIC XX    VALUE 'SC'.
   193     12  SC-CREDIT-CODES.
   194         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   195             20  SC-CREDIT-DISPLAY    PIC X.
   196             20  SC-CREDIT-UPDATE     PIC X.
   197     12  SC-CLAIMS-CODES.
   198         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   199             20  SC-CLAIMS-DISPLAY    PIC X.
   200             20  SC-CLAIMS-UPDATE     PIC X.
   201
   202 01  WS-VA-NO-COMM-MESS.
   203     12  FILLER                  PIC X(41) VALUE
   204        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   205 01  WS-OC-MESSAGE.
   206     12  FILLER                  PIC X(43) VALUE
   207        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   208     12  WS-OC-DIS-AMT           PIC -----9.99.
   209     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page   6
* EL6311.cbl
   210     12  WS-OC-DATE              PIC X(10).
   211 01  WS-DATE-AREA.
   212     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   213     12  WS-CURRENT-DT.
   214         16  FILLER              PIC X(6)    VALUE SPACES.
   215         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   216     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   217     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   218     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   219
   220 01  STANDARD-AREAS.
   221     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   222     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   223     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   224     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   225     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   226     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   227     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   228     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   229     12  PGM-NAME                PIC X(8).
   230     12  TIME-IN                 PIC S9(7).
   231     12  TIME-OUT-R  REDEFINES TIME-IN.
   232         16  FILLER              PIC X.
   233         16  TIME-OUT            PIC 99V99.
   234         16  FILLER              PIC XX.
   235     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   236     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   237     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   238     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   239     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   240     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   241     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   242     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   243     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   244     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   245     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   246     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   247     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   248     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   249     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   250     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   251     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   252     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   253     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   254     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   255     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   256     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   257     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   258     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   259     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   260     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   261     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   262     12  FILE-ID                 PIC X(8).
   263     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   264     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   265     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   266     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   267     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page   7
* EL6311.cbl
   268     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   269     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   270     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   271     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   272     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   273     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   274     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   275     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   276     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   277     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   278
   279 01  WS-PASS-AREA.
   280     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   281     05  WS-PASS-VADS-REC    PIC X(350).
   282*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   283*                                COPY ELCZREC.
   284******************************************************************
   285*                                                                *
   286*                                                                *
   287*                            ELCZREC.                            *
   288*                                                                *
   289*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   290*                                                                *
   291******************************************************************
   292*-----------------------------------------------------------------
   293*                   C H A N G E   L O G
   294*
   295* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   296*-----------------------------------------------------------------
   297*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   298* EFFECTIVE    NUMBER
   299*-----------------------------------------------------------------
   300* 122011    2011022800001  AJRA  NEW FILE
   301* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   302* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   303* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   304* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   305*-----------------------------------------------------------------
   306 01  W-Z-CONTROL-DATA.
   307     05  W-NUMBER-OF-COPIES      PIC  9.
   308     05  FILLER                  PIC  X.
   309     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   310     05  FILLER                  PIC  X.
   311     05  W-DAYS-TO-RESEND        PIC  999.
   312     05  FILLER                  PIC  X.
   313     05  W-FORM-TO-RESEND        PIC  X(4).
   314     05  W-ADD-BAR-CODE          PIC  X.
   315     05  W-PROMPT-LETTER         PIC  X.
   316     05  W-HAS-RETURN-ENV        PIC  X.
   317     05  W-ENCLOSURE-CD          PIC  XXX.
   318     05  W-SIG-FLAG-DEFAULT      PIC  X.
   319     05  W-AUTO-CLOSE-IND        PIC  X.
   320     05  FILLER                  PIC  X.
   321     05  W-LETTER-TO-BENE        PIC  X.
   322     05  FILLER                  PIC  X.
   323     05  W-LETTER-TO-ACCT        PIC  X.
   324     05  FILLER                  PIC  X.
   325     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page   8
* EL6311.cbl
   326     05  FILLER                  PIC  X.
   327     05  W-PRINT-CERTIFICATE     PIC  X.
   328     05  FILLER                  PIC  X.
   329     05  W-REFUND-REQUIRED       PIC  X.
   330     05  FILLER                  PIC  X.
   331     05  W-ONBASE-CODE           PIC  XX.
   332     05  FILLER                  PIC  X.
   333     05  W-ACCT-SUMM             PIC  X.
   334     05  FILLER                  PIC  X.
   335     05  W-CSO-SUMM              PIC  X.
   336     05  FILLER                  PIC  X.
   337     05  W-REASONS-REQUIRED      PIC  X.
   338     05  FILLER                  PIC  X(29).
   339******************************************************************
   340*                                                                *
   341*              A C C E S S   K E Y S                             *
   342*                                                                *
   343******************************************************************
   344
   345 01  ACCESS-KEYS.
   346     12  ERPYAJ-KEY.
   347         16  ERPYAJ-COMPANY-CD       PIC X.
   348         16  ERPYAJ-CARRIER          PIC X.
   349         16  ERPYAJ-GROUPING         PIC X(6).
   350         16  ERPYAJ-FIN-RESP         PIC X(10).
   351         16  ERPYAJ-ACCOUNT          PIC X(10).
   352         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   353         16  ERPYAJ-TYPE             PIC X.
   354     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   355     12  ELCERT-KEY.
   356         16  ELCERT-COMPANY-CD       PIC X.
   357         16  ELCERT-CARRIER          PIC X.
   358         16  ELCERT-GROUPING         PIC X(6).
   359         16  ELCERT-STATE            PIC XX.
   360         16  ELCERT-ACCOUNT          PIC X(10).
   361         16  ELCERT-CERT-EFF-DT      PIC XX.
   362         16  ELCERT-CERT-NO.
   363             20  ELCERT-CERT-PRIME   PIC X(10).
   364             20  ELCERT-CERT-SFX     PIC X.
   365
   366     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   367     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   368     12  ELCRTO-KEY.
   369         16  ELCRTO-COMPANY-CD       PIC X.
   370         16  ELCRTO-CARRIER          PIC X.
   371         16  ELCRTO-GROUPING         PIC X(6).
   372         16  ELCRTO-STATE            PIC XX.
   373         16  ELCRTO-ACCOUNT          PIC X(10).
   374         16  ELCRTO-CERT-EFF-DT      PIC XX.
   375         16  ELCRTO-CERT-NO.
   376             20  ELCRTO-CERT-PRIME   PIC X(10).
   377             20  ELCRTO-CERT-SFX     PIC X.
   378         16  ELCRTO-RECORD-TYPE      PIC X.
   379         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   380
   381     12  ELCRTT-KEY.
   382         16  ELCRTT-PRIMARY          PIC X(33).
   383         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page   9
* EL6311.cbl
   384     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   385     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   386
   387     12  ERPNDB-KEY.
   388         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   389         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   390         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   391         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   392             ERPNDB-BATCH-SEQ-NO     PIC XX.
   393         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   394
   395     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   396     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   397     12  ERCHEK-KEY.
   398         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   399         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   400         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   401         16  CHEK-STATE              PIC XX      VALUE SPACES.
   402         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   403         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   404         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   405         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   406         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   407     12  ELLETR-KEY.
   408         16  LETR-COMPANY-CD     PIC X.
   409         16  LETR-LETTER-ID      PIC X(4).
   410         16  LETR-FILLER         PIC X(8).
   411         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   412     12  ERPNDM-KEY.
   413         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   414         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   415         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   416         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   417
   418*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   419     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   420*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   421     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   422
   423     12  ERPNDB-ALT-KEY.
   424         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   425         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   426         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   427         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   428         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   429         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   430         16  ERPNDB-CERT-NO.
   431             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   432             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   433         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   434         16  ERPNDB-RECORD-TYPE      PIC X.
   435
   436      12  ERPNDB-CSR-KEY.
   437          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   438          20  ERPNDB-CSR-ID                PIC X(4).
   439          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   440          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   441          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  10
* EL6311.cbl
   442
   443     12  ERNOTE-KEY.
   444         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   445         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   446         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   447         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   448         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   449         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   450         16  ERNOTE-CERT-NO.
   451             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   452             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   453
   454     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   455     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   456
   457     12  ERCNOT-KEY.
   458         16  ERCNOT-PART-KEY.
   459             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   460             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   461             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   462             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   463             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   464             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   465             20  ERCNOT-CERT-NO.
   466                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   467                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   468         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   469         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   470
   471     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   472     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   473
   474     12  ERMAIL-KEY.
   475         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   476         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   477         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   478         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   479         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   480         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   481         16  ERMAIL-CERT-NO.
   482             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   483             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   484
   485     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   486     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   487
   488     12  ERRQST-KEY.
   489         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   490         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   491
   492     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   493     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   494
   495     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   496
   497     12  ERLOFC-KEY.
   498         16  ERLOFC-COMPANY-CD          PIC  X.
   499         16  ERLOFC-CARRIER             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  11
* EL6311.cbl
   500         16  ERLOFC-GROUPING            PIC  X(6).
   501         16  ERLOFC-STATE               PIC  XX.
   502         16  ERLOFC-ACCOUNT             PIC  X(10).
   503         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   504*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   505
   506     12  ERACCT-KEY.
   507         16  ERACCT-COMPANY-CD          PIC  X.
   508         16  ERACCT-CARRIER             PIC  X.
   509         16  ERACCT-GROUPING            PIC  X(6).
   510         16  ERACCT-STATE               PIC  XX.
   511         16  ERACCT-ACCOUNT             PIC  X(10).
   512         16  ERACCT-EXP-DT.
   513             20  ERACCT-DT              PIC  XX.
   514             20  ERACCT-FILL            PIC  X(4).
   515     12  ERACNT-KEY.
   516         16  ERACNT-COMPANY-CD          PIC  X.
   517         16  ERACNT-CARRIER             PIC  X.
   518         16  ERACNT-GROUPING            PIC  X(6).
   519         16  ERACNT-STATE               PIC  XX.
   520         16  ERACNT-ACCOUNT             PIC  X(10).
   521         16  ERACNT-REC-TYPE            PIC  X.
   522         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   523     12  ERENDT-KEY.
   524         16  ENDT-COMPANY-CD       PIC X.
   525         16  ENDT-CARRIER          PIC X.
   526         16  ENDT-GROUPING         PIC X(6).
   527         16  ENDT-STATE            PIC XX.
   528         16  ENDT-ACCOUNT          PIC X(10).
   529         16  ENDT-CERT-EFF-DT      PIC XX.
   530         16  ENDT-CERT-PRIME       PIC X(10).
   531         16  ENDT-CERT-SFX         PIC X.
   532         16  ENDT-RECORD-TYPE      PIC X.
   533         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   534
   535 01  WS-ELMSTR-WORK.
   536     12  ELMSTR-KEY.
   537         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   538         16  MSTR-CERT-NO.
   539             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   540             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   541     12  W-CLAIM-KEY.
   542         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   543         16  W-CL-CERT-NO.
   544             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   545             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   546      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   547 01  CANCEL-GEN-PASS-AREA.
   548     05  CG-OPTION-CODE          PIC X.
   549         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   550         88  CG-FLAT-CANCEL        VALUE '1'.
   551         88  CG-CANCEL             VALUE '2'.
   552         88  CG-CANCEL-REISSUE     VALUE '3'.
   553     05  CG-ERROR-CODE           PIC 99.
   554         88  CG-SUCCESS            VALUE 00.
   555         88  CG-DATE-ERROR         VALUE 01.
   556         88  CG-CERT-NOT-FOUND     VALUE 02.
   557         88  CG-AMOUNT-ERROR       VALUE 04.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  12
* EL6311.cbl
   558         88  CG-OPTION-ERROR       VALUE 05.
   559         88  CG-PREV-CAN           VALUE 06.
   560         88  CG-INVALID-DATA       VALUE 07.
   561         88  CG-NO-ACCT-MSTR       VALUE 08.
   562         88  CG-SFX-A-EXIST        VALUE 09.
   563         88  CG-MISC-ERROR         VALUE 99.
   564     05  CG-COMPANY-ID           PIC XXX.
   565     05  CG-PROC-ID              PIC XXXX.
   566     05  CG-CURRENT-DT           PIC XX.
   567     05  CG-MONTH-END-DT         PIC XX.
   568     05  CG-CERT-KEY.
   569         10  CG-CERT-COMPANY-CD  PIC X.
   570         10  CG-CERT-CARRIER     PIC X.
   571         10  CG-CERT-GROUP       PIC X(6).
   572         10  CG-CERT-STATE       PIC XX.
   573         10  CG-CERT-ACCOUNT     PIC X(10).
   574         10  CG-CERT-EFF-DT      PIC XX.
   575         10  CG-CERT-CERT-NO     PIC X(11).
   576     05  CG-LF-CAN-DATA.
   577         10  CG-LF-CAN-DT        PIC XX.
   578         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   579     05  CG-AH-CAN-DATA.
   580         10  CG-AH-CAN-DT        PIC XX.
   581         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   582     05  CG-CERT-PROFILE-DATA.
   583         10  CG-INS-LNAME        PIC X(15).
   584         10  CG-INS-FNAME        PIC X(10).
   585         10  CG-INS-MID-INIT     PIC X.
   586         10  CG-INS-AGE          PIC 99.
   587         10  CG-JNT-LNAME        PIC X(15).
   588         10  CG-JNT-FNAME        PIC X(10).
   589         10  CG-JNT-MID-INIT     PIC X.
   590         10  CG-JNT-AGE          PIC 99.
   591     05  CG-LF-ISS-DATA.
   592         10  CG-LF-BENCD         PIC XX.
   593         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   594         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   595     05  CG-AH-ISS-DATA.
   596         10  CG-AH-BENCD         PIC XX.
   597         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   598     05  CG-BATCH-NO             PIC X(6).
   599     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   600     05  FILLER                  PIC X(306).
   601******************************************************************
   602*                                                                *
   603*            G E N E R A L   W O R K   A R E A                   *
   604*                                                                *
   605******************************************************************
   606
   607 01  WORK-AREA.
   608     12  WS-RESPONSE             PIC S9(8)   COMP.
   609         88  RESP-NORMAL           VALUE +0.
   610         88  resp-file-notfnd      value +12.
   611         88  RESP-NOTFND           VALUE +13.
   612         88  resp-duprec           value +14.
   613         88  resp-dupkey           value +15.
   614         88  resp-invreq           value +16.
   615         88  RESP-NOTOPEN          VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  13
* EL6311.cbl
   616         88  RESP-ENDFILE          VALUE +20.
   617         88  resp-lengtherr        value +22.
   618     12  DEEDIT-FIELD            PIC X(15).
   619     12  FILLER          REDEFINES DEEDIT-FIELD.
   620         16  FILLER              PIC X(4).
   621         16  DEEDIT-FIELD-X11    PIC X(11).
   622     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   623                                 PIC S9(15).
   624     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   625                                 PIC S9(13)V99.
   626     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   627                                 PIC S9(11)V9999.
   628     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   629     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   630     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   631         16  WS-CALC-TERM-WHOLE  PIC S999.
   632         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   633
   634     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   635     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   636         16  WS-HR-MINS          PIC 99V99.
   637         16  FILLER              PIC XX.
   638
   639     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   640     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   641
   642     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   643     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   644
   645     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   646     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   647     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   648     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   649     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   650     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   651     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   652
   653     12  QID.
   654         16  QID-TERM            PIC X(4).
   655         16  FILLER              PIC X(4)    VALUE '607B'.
   656
   657     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   658         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   659
   660     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   661         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   662
   663     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   664         88 WS-MODE-CODE-VALID     VALUE ' '
   665                                         'W'     *> Weekly
   666                                         'B'     *> Bi-weekly
   667                                         'S'     *> Semi-monthly
   668                                         'M'     *> Monthly (Def)
   669                                         'Q'     *> Quarterly
   670                                         'N'     *> Bi-Monthly??
   671                                         'T'     *> Semi-annual
   672                                         'A'.    *> Annual Pay
   673
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  14
* EL6311.cbl
   674     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   675
   676     12  WS-NUMERIC-SW           PIC X.
   677        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   678
   679     12  WS-EDIT-CSO-FIELD.
   680         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   681                                 PIC X.
   682     12  WS-SAVE-PEND-ISSUE          PIC X(375).
   683     12  WS-ARCHIVE-LETTER-SW    PIC X    VALUE 'N'.
   684        88  ARCHIVE-LETTER-RELEASED   VALUE 'Y'.
   685        88  CALLED-FROM-6315          VALUE '5'.
   686
   687     12  WS-SAVE-INPUT-FIELDS.
   688         16  WS-BAGE             PIC 99       VALUE ZERO.
   689*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   690         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   691         16  FILLER REDEFINES WS-BAPR.
   692             20  WS-APR-WHOLE-NUM    PIC 99.
   693             20  WS-APR-DEC          PIC 9999.
   694         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   695         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   696
   697         16  WS-B-COVERAGE OCCURS 2 TIMES.
   698             20  WS-TERM-IN-DAYS-SW  PIC X.
   699                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   700             20  WS-BTERM        PIC 999       COMP-3.
   701             20  WS-BALT-TERM    PIC 999       COMP-3.
   702             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   703             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   704             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   705             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   706             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   707             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   708
   709         16  WS-C-FIELDS COMP-3.
   710             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   711             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   712             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   713
   714         16  WS-D-FIELDS COMP-3.
   715             20  WS-DRISS        PIC S9(5)    VALUE +0.
   716             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   717             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   718             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   719             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   720             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   721
   722     12  WS-SAVE-BIRTH-DATE.
   723         16  FILLER              PIC X(4)   VALUE SPACES.
   724         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   725
   726     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   727     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   728     12  FILLER REDEFINES WS-WORK-BIN-RED.
   729         16  FILLER              PIC X(02).
   730         16  WS-WORK-BIN-DT      PIC X(02).
   731     12  WS-SW-1                 PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  15
* EL6311.cbl
   732     12  WS-SW-2                 PIC X     VALUE SPACE.
   733     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   734         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   735     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   736         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   737
   738     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   739     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   740     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   741     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   742     12  WS-CONVERTED-CANCEL-DATES.
   743         16  WS-CONVERTED-CANDT1                  PIC XX.
   744         16  WS-CONVERTED-CANDT2                  PIC XX.
   745
   746     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   747
   748     12  WS-REC-FOUND-SW         PIC X.
   749         88  RECORD-NOT-FOUND    VALUE 'N'.
   750
   751     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   752         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   753         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   754
   755     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   756         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   757         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   758
   759     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   760         88  BROWSE-STARTED      VALUE 'Y'.
   761
   762     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   763         88  FIRST-TIME          VALUE 'Y'.
   764
   765     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   766         88  FIRST-ENTRY         VALUE 'Y'.
   767
   768     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   769         88  REC-BILLED          VALUE 'Y'.
   770
   771     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   772         88  NO-CURSOR-SET       VALUE +0.
   773         88  CURSOR-SET          VALUE +1.
   774
   775     12  WS-ERR-SW               PIC X.
   776         88  STD-ERRORS          VALUE 'S'.
   777         88  TRN-ERRORS          VALUE 'T'.
   778
   779     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   780         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   781
   782     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   783         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   784
   785     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   786         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   787
   788     12  WS-ERR-CODE.
   789         16  FILLER              PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  16
* EL6311.cbl
   790         16  WS-ERROR-SUB        PIC 99.
   791
   792     12  WS-DATE-WORK.
   793         16  WS-WORK-MM          PIC XX.
   794         16  WS-WORK-DD          PIC XX.
   795         16  WS-WORK-YY          PIC XX.
   796
   797     12  WS-MM-YY.
   798         16  WS-MM               PIC XX.
   799         16  FILLER              PIC X     VALUE '/'.
   800         16  WS-YY               PIC XX.
   801
   802     12  WS-CERT-EFF-DT          PIC XX.
   803
   804     12  WS-MEMBER-NO            PIC X(12).
   805     12  FILLER  REDEFINES  WS-MEMBER-NO.
   806         16  WS-MEMBER-NO-1-8    PIC 9(8).
   807         16  FILLER              PIC X(4).
   808
   809     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   810
   811     12  WS-ERPNDB-ALT-KEY.
   812         16  WS-PB-COMPANY-CD-A1         PIC X.
   813         16  WS-PB-CARRIER               PIC X.
   814         16  WS-PB-GROUPING              PIC X(6).
   815         16  WS-PB-STATE                 PIC XX.
   816         16  WS-PB-ACCOUNT               PIC X(10).
   817         16  WS-PB-CERT-EFF-DT           PIC XX.
   818         16  WS-PB-CERT-NO.
   819             20  WS-PB-CERT-PRIME        PIC X(10).
   820             20  WS-PB-CERT-SFX          PIC X.
   821         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   822         16  WS-PB-RECORD-TYPE           PIC X.
   823
   824     12  WS-SHOW-SAVE-AREAS.
   825         16  WS-NEW-CERT-NO.
   826             20  WS-NEW-PRIME    PIC X(10).
   827             20  WS-NEW-SUFFIX   PIC X.
   828         16  WS-NEW-CERT-EFF-DT  PIC XX.
   829         16  WS-NEW-RECORD-TYPE  PIC X.
   830         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   831             88   SHOW-RECORD            VALUE 'Y'.
   832
   833     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   834
   835     12  WS-BATCH-NO.
   836         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   837         16  FILLER              PIC X(5) VALUE SPACES.
   838
   839     12  WS-FIRST-NAME.
   840         16  WS-1ST-INIT         PIC X.
   841         16  FILLER              PIC X(9).
   842
   843     12  WS-INITIALS.
   844         16  WS-INITIAL-1        PIC X.
   845         16  WS-INITIAL-2        PIC X.
   846
   847     12  WS-C-HDG.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  17
* EL6311.cbl
   848         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   849         16  FILLER              PIC X(4) VALUE '-REF'.
   850
   851     12  WS-D-PREM-HDG.
   852         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   853         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   854
   855     12  WS-D-REFUND-HDG.
   856         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   857         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   858
   859     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   860
   861     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   862     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   863     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   864     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   865     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   866     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   867     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   868
   869     12  WS-01-CANCEL-ERR        PIC X(25)
   870         VALUE 'CANCEL DATE ERROR'.
   871     12  WS-02-CANCEL-ERR        PIC X(25)
   872         VALUE 'CERT NOT FOUND'.
   873     12  WS-04-CANCEL-ERR        PIC X(25)
   874         VALUE 'CANCEL AMOUNT ERROR'.
   875     12  WS-05-CANCEL-ERR        PIC X(25)
   876         VALUE 'CANCEL OPTION ERROR'.
   877     12  WS-06-CANCEL-ERR        PIC X(25)
   878         VALUE 'PREVIOUSLY CANCELLED'.
   879     12  WS-07-CANCEL-ERR        PIC X(25)
   880         VALUE 'INVALID DATA'.
   881     12  WS-08-CANCEL-ERR        PIC X(25)
   882         VALUE 'NO ACCOUNT MASTER'.
   883     12  WS-09-CANCEL-ERR        PIC X(25)
   884         VALUE 'SUFFIX ALREADY EXISTS'.
   885     12  WS-99-CANCEL-ERR        PIC X(25)
   886         VALUE 'MISC CANCEL ERROR'.
   887
   888     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   889     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   890
   891     12  WS-AGE-FIELDS.
   892         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   893         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   894         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   895         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   896
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  18
* EL6311.cbl
   898
   899******************************************************************
   900*                                                                *
   901*                 B A T C H   T O T A L S                        *
   902*                                                                *
   903******************************************************************
   904
   905     12  WS-BATCH-RECORD.
   906         16  FILLER                       PIC X(10).
   907         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   908         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   909         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   910         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   911         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   912         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   913         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   914         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   915         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   916         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   917         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   918         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   919         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   920         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   921         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   922         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   923         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   924         16  WS-ACCOUNT-NAME              PIC X(30).
   925         16  FILLER                       PIC X.
   926         16  WS-REFERENCE                 PIC X(12).
   927         16  FILLER                       PIC X(197).
   928
   929     12  WS-BATCH-TOTALS.
   930         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   931         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   932         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   933         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   934         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   935         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   936         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   937         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   938         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   939         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   940         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   941         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   942         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   943         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   944         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   945         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   946         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   947         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   948         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   949
   950     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   951
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  19
* EL6311.cbl
   953
   954******************************************************************
   955*                                                                *
   956*                E R R O R   M E S S A G E S                     *
   957*                                                                *
   958******************************************************************
   959
   960 01  ERROR-MESSAGES.
   961     12  ER-0004                 PIC  9(4) VALUE 0004.
   962     12  ER-0008                 PIC  9(4) VALUE 0008.
   963     12  ER-0023                 PIC  9(4) VALUE 0023.
   964     12  ER-0029                 PIC  9(4) VALUE 0029.
   965     12  ER-0033                 PIC  9(4) VALUE 0033.
   966     12  ER-0070                 PIC  9(4) VALUE 0070.
   967     12  ER-0220                 PIC  9(4) VALUE 0220.
   968     12  ER-0248                 PIC  9(4) VALUE 0248.
   969     12  ER-0280                 PIC  9(4) VALUE 0280.
   970     12  ER-0348                 PIC  9(4) VALUE 0348.
   971     12  ER-0582                 PIC  9(4) VALUE 0582.
   972     12  ER-0877                 PIC  9(4) VALUE 0877.
   973     12  ER-1236                 PIC  9(4) VALUE 1236.
   974     12  ER-1570                 PIC  9(4) VALUE 1570.
   975     12  ER-1575                 PIC  9(4) VALUE 1575.
   976     12  ER-1577                 PIC  9(4) VALUE 1577.
   977     12  ER-1584                 PIC  9(4) VALUE 1584.
   978     12  ER-1585                 PIC  9(4) VALUE 1585.
   979     12  ER-1609                 PIC  9(4) VALUE 1609.
   980     12  er-1762                 pic  9(4) value 1762.
   981     12  ER-1819                 PIC  9(4) VALUE 1819.
   982     12  ER-2077                 PIC  9(4) VALUE 2077.
   983     12  ER-2129                 PIC  9(4) VALUE 2129.
   984     12  ER-2188                 PIC  9(4) VALUE 2188.
   985     12  ER-2192                 PIC  9(4) VALUE 2192.
   986     12  ER-2196                 PIC  9(4) VALUE 2196.
   987     12  ER-2197                 PIC  9(4) VALUE 2197.
   988     12  ER-2198                 PIC  9(4) VALUE 2198.
   989     12  ER-2200                 PIC  9(4) VALUE 2200.
   990     12  ER-2212                 PIC  9(4) VALUE 2212.
   991     12  ER-2218                 PIC  9(4) VALUE 2218.
   992     12  ER-2220                 PIC  9(4) VALUE 2220.
   993     12  ER-2222                 PIC  9(4) VALUE 2222.
   994     12  ER-2223                 PIC  9(4) VALUE 2223.
   995     12  ER-2224                 PIC  9(4) VALUE 2224.
   996     12  ER-2225                 PIC  9(4) VALUE 2225.
   997     12  ER-2226                 PIC  9(4) VALUE 2226.
   998     12  ER-2227                 PIC  9(4) VALUE 2227.
   999     12  ER-2228                 PIC  9(4) VALUE 2228.
  1000     12  ER-2240                 PIC  9(4) VALUE 2240.
  1001     12  ER-2241                 PIC  9(4) VALUE 2241.
  1002     12  ER-2242                 PIC  9(4) VALUE 2242.
  1003     12  ER-2243                 PIC  9(4) VALUE 2243.
  1004     12  ER-2244                 PIC  9(4) VALUE 2244.
  1005     12  ER-2245                 PIC  9(4) VALUE 2245.
  1006     12  ER-2246                 PIC  9(4) VALUE 2246.
  1007     12  ER-2247                 PIC  9(4) VALUE 2247.
  1008     12  ER-2251                 PIC  9(4) VALUE 2251.
  1009     12  ER-2252                 PIC  9(4) VALUE 2252.
  1010     12  ER-2253                 PIC  9(4) VALUE 2253.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  20
* EL6311.cbl
  1011     12  ER-2254                 PIC  9(4) VALUE 2254.
  1012     12  ER-2255                 PIC  9(4) VALUE 2255.
  1013     12  ER-2256                 PIC  9(4) VALUE 2256.
  1014     12  ER-2257                 PIC  9(4) VALUE 2257.
  1015     12  ER-2258                 PIC  9(4) VALUE 2258.
  1016     12  ER-2259                 PIC  9(4) VALUE 2259.
  1017     12  ER-2260                 PIC  9(4) VALUE 2260.
  1018     12  ER-2261                 PIC  9(4) VALUE 2261.
  1019     12  ER-2287                 PIC  9(4) VALUE 2287.
  1020     12  ER-2336                 PIC  9(4) VALUE 2336.
  1021     12  ER-2337                 PIC  9(4) VALUE 2337.
  1022     12  ER-2437                 PIC  9(4) VALUE 2437.
  1023     12  ER-2471                 PIC  9(4) VALUE 2471.
  1024     12  ER-2530                 PIC  9(4) VALUE 2530.
  1025     12  ER-2531                 PIC  9(4) VALUE 2531.
  1026     12  ER-2532                 PIC  9(4) VALUE 2532.
  1027     12  ER-2533                 PIC  9(4) VALUE 2533.
  1028     12  ER-2547                 PIC  9(4) VALUE 2547.
  1029     12  ER-2591                 PIC  9(4) VALUE 2591.
  1030     12  ER-2592                 PIC  9(4) VALUE 2592.
  1031     12  ER-2593                 PIC  9(4) VALUE 2593.
  1032     12  ER-2600                 PIC  9(4) VALUE 2600.
  1033     12  ER-2601                 PIC  9(4) VALUE 2601.
  1034     12  ER-2604                 PIC  9(4) VALUE 2604.
  1035     12  ER-2605                 PIC  9(4) VALUE 2605.
  1036     12  ER-2606                 PIC  9(4) VALUE 2606.
  1037     12  ER-2607                 PIC  9(4) VALUE 2607.
  1038     12  ER-2622                 PIC  9(4) VALUE 2622.
  1039     12  ER-2625                 PIC  9(4) VALUE 2625.
  1040     12  ER-2626                 PIC  9(4) VALUE 2626.
  1041     12  ER-2627                 PIC  9(4) VALUE 2627.
  1042     12  ER-2628                 PIC  9(4) VALUE 2628.
  1043     12  ER-2629                 PIC  9(4) VALUE 2629.
  1044     12  ER-2630                 PIC  9(4) VALUE 2630.
  1045     12  ER-2631                 PIC  9(4) VALUE 2631.
  1046     12  ER-2632                 PIC  9(4) VALUE 2632.
  1047     12  ER-2633                 PIC  9(4) VALUE 2633.
  1048     12  ER-2634                 PIC  9(4) VALUE 2634.
  1049     12  ER-2635                 PIC  9(4) VALUE 2635.
  1050     12  ER-2636                 PIC  9(4) VALUE 2636.
  1051     12  ER-2639                 PIC  9(4) VALUE 2639.
  1052     12  ER-2640                 PIC  9(4) VALUE 2640.
  1053     12  ER-2647                 PIC  9(4) VALUE 2647.
  1054     12  ER-2648                 PIC  9(4) VALUE 2648.
  1055     12  ER-2649                 PIC  9(4) VALUE 2649.
  1056     12  ER-2650                 PIC  9(4) VALUE 2650.
  1057     12  ER-2651                 PIC  9(4) VALUE 2651.
  1058     12  ER-2653                 PIC  9(4) VALUE 2653.
  1059     12  ER-2654                 PIC  9(4) VALUE 2654.
  1060     12  ER-2655                 PIC  9(4) VALUE 2655.
  1061     12  ER-2656                 PIC  9(4) VALUE 2656.
  1062     12  ER-2657                 PIC  9(4) VALUE 2657.
  1063     12  ER-2660                 PIC  9(4) VALUE 2660.
  1064     12  ER-2661                 PIC  9(4) VALUE 2661.
  1065     12  ER-2662                 PIC  9(4) VALUE 2662.
  1066     12  ER-2663                 PIC  9(4) VALUE 2663.
  1067     12  ER-2664                 PIC  9(4) VALUE 2664.
  1068     12  ER-2667                 PIC  9(4) VALUE 2667.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  21
* EL6311.cbl
  1069     12  ER-2668                 PIC  9(4) VALUE 2668.
  1070     12  ER-2669                 PIC  9(4) VALUE 2669.
  1071     12  ER-2670                 PIC  9(4) VALUE 2670.
  1072     12  ER-2671                 PIC  9(4) VALUE 2671.
  1073     12  ER-2672                 PIC  9(4) VALUE 2672.
  1074     12  ER-2673                 PIC  9(4) VALUE 2673.
  1075     12  ER-2677                 PIC  9(4) VALUE 2677.
  1076     12  ER-2678                 PIC  9(4) VALUE 2678.
  1077     12  ER-2679                 PIC  9(4) VALUE 2679.
  1078     12  ER-2680                 PIC  9(4) VALUE 2680.
  1079     12  ER-2681                 PIC  9(4) VALUE 2681.
  1080     12  ER-2682                 PIC  9(4) VALUE 2682.
  1081     12  ER-2683                 PIC  9(4) VALUE 2683.
  1082     12  ER-2684                 PIC  9(4) VALUE 2684.
  1083     12  ER-2686                 PIC  9(4) VALUE 2686.
  1084     12  ER-2689                 PIC  9(4) VALUE 2689.
  1085     12  ER-2690                 PIC  9(4) VALUE 2690.
  1086     12  ER-2693                 PIC  9(4) VALUE 2693.
  1087     12  ER-2695                 PIC  9(4) VALUE 2695.
  1088     12  ER-2701                 PIC  9(4) VALUE 2701.
  1089     12  ER-2720                 PIC  9(4) VALUE 2720.
  1090     12  ER-2709                 PIC  9(4) VALUE 2709.
  1091     12  ER-2704                 PIC  9(4) VALUE 2704.
  1092     12  ER-2725                 PIC  9(4) VALUE 2725.
  1093     12  ER-2726                 PIC  9(4) VALUE 2726.
  1094     12  ER-2728                 PIC  9(4) VALUE 2728.
  1095     12  ER-2729                 PIC  9(4) VALUE 2729.
  1096     12  ER-2731                 PIC  9(4) VALUE 2731.
  1097     12  ER-2732                 PIC  9(4) VALUE 2732.
  1098     12  ER-2733                 PIC  9(4) VALUE 2733.
  1099     12  ER-2735                 PIC  9(4) VALUE 2735.
  1100     12  ER-2738                 PIC  9(4) VALUE 2738.
  1101     12  ER-2742                 PIC  9(4) VALUE 2742.
  1102     12  ER-2743                 PIC  9(4) VALUE 2743.
  1103     12  ER-2744                 PIC  9(4) VALUE 2744.
  1104     12  ER-2747                 PIC  9(4) VALUE 2747.
  1105     12  ER-2749                 PIC  9(4) VALUE 2749.
  1106     12  ER-2753                 PIC  9(4) VALUE 2753.
  1107     12  ER-2755                 PIC  9(4) VALUE 2755.
  1108     12  ER-2757                 PIC  9(4) VALUE 2757.
  1109     12  ER-2771                 PIC  9(4) VALUE 2771.
  1110     12  ER-2774                 PIC  9(4) VALUE 2774.
  1111     12  ER-2775                 PIC  9(4) VALUE 2775.
  1112     12  ER-2776                 PIC  9(4) VALUE 2776.
  1113     12  ER-2777                 PIC  9(4) VALUE 2777.
  1114     12  ER-2794                 PIC  9(4) VALUE 2794.
  1115     12  ER-2799                 PIC  9(4) VALUE 2799.
  1116     12  ER-2900                 PIC  9(4) VALUE 2900.
  1117     12  ER-2902                 PIC  9(4) VALUE 2902.
  1118     12  ER-2945                 PIC  9(4) VALUE 2945.
  1119     12  ER-3000                 PIC  9(4) VALUE 3000.
  1120     12  ER-3006                 PIC  9(4) VALUE 3006.
  1121     12  ER-3054                 PIC  9(4) VALUE 3054.
  1122     12  er-3070                 pic  9(4) value 3070.
  1123     12  ER-3224                 PIC  9(4) VALUE 3224.
  1124     12  ER-3269                 PIC  9(4) VALUE 3269.
  1125     12  er-3444                 pic  9(4) value 3444.
  1126     12  er-3446                 pic  9(4) value 3446.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  22
* EL6311.cbl
  1127     12  er-3447                 pic  9(4) value 3447.
  1128     12  er-3448                 pic  9(4) value 3448.
  1129     12  er-3449                 pic  9(4) value 3449.
  1130     12  ER-3456                 PIC  9(4) VALUE 3456.
  1131     12  ER-3457                 PIC  9(4) VALUE 3457.
  1132     12  ER-3458                 PIC  9(4) VALUE 3458.
  1133     12  ER-3504                 PIC  9(4) VALUE 3504.
  1134     12  ER-3513                 PIC  9(4) VALUE 3513.
  1135     12  ER-3831                 PIC  9(4) VALUE 3831.
  1136     12  ER-3834                 PIC  9(4) VALUE 3834.
  1137     12  ER-3835                 PIC  9(4) VALUE 3835.
  1138     12  ER-4005                 PIC  9(4) VALUE 4005.
  1139     12  ER-7144                 PIC  9(4) VALUE 7144.
  1140     12  ER-7401                 PIC  9(4) VALUE 7401.
  1141     12  ER-7402                 PIC  9(4) VALUE 7402.
  1142     12  ER-7403                 PIC  9(4) VALUE 7403.
  1143     12  ER-7404                 PIC  9(4) VALUE 7404.
  1144     12  ER-7423                 PIC  9(4) VALUE 7423.
  1145     12  ER-7424                 PIC  9(4) VALUE 7424.
  1146     12  ER-7433                 PIC  9(4) VALUE 7433.
  1147     12  ER-7450                 PIC  9(4) VALUE 7450.
  1148     12  ER-7451                 PIC  9(4) VALUE 7451.
  1149     12  ER-7530                 PIC  9(4) VALUE 7530.
  1150     12  ER-7573                 PIC  9(4) VALUE 7573.
  1151     12  ER-7631                 PIC  9(4) VALUE 7631.
  1152     12  ER-7632                 PIC  9(4) VALUE 7632.
  1153     12  ER-7633                 PIC  9(4) VALUE 7633.
  1154     12  ER-7537                 PIC  9(4) VALUE 7537.
  1155     12  ER-7538                 PIC  9(4) VALUE 7538.
  1156     12  ER-7574                 PIC  9(4) VALUE 7574.
  1157     12  ER-7997                 PIC  9(4) VALUE 7997.
  1158     12  ER-7998                 PIC  9(4) VALUE 7998.
  1159     12  ER-8148                 PIC  9(4) VALUE 8148.
  1160     12  ER-9063                 PIC  9(4) VALUE 9063.
  1161     12  ER-9076                 PIC  9(4) VALUE 9076.
  1162     12  ER-9618                 PIC  9(4) VALUE 9618.
  1163     12  ER-9841                 PIC  9(4) VALUE 9841.
  1164
  1165*                                COPY ELCTEXT.
  1166******************************************************************
  1167*                                                                *
  1168*                                                                *
  1169*                            ELCTEXT.                            *
  1170*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1171*                            VMOD=2.008                          *
  1172*                                                                *
  1173*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1174*                                     FORM LETTERS,              *
  1175*                                     CERT FORM DISPLAY.
  1176*                                                                *
  1177*   FILE TYPE = VSAM,KSDS                                        *
  1178*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1179*                                                                *
  1180*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1181*       ALTERNATE INDEX = NONE                                   *
  1182*                                                                *
  1183*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1184*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  23
* EL6311.cbl
  1185*                                                                *
  1186*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1187*       ALTERNATE INDEX = NONE                                   *
  1188*                                                                *
  1189*   LOG = NO                                                     *
  1190*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1191******************************************************************
  1192 01  TEXT-FILES.
  1193     12  TEXT-FILE-ID                PIC XX.
  1194         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1195         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1196         88  HELP-FILE-TEXT             VALUE 'TH'.
  1197
  1198     12  TX-CONTROL-PRIMARY.
  1199         16  TX-COMPANY-CD           PIC X.
  1200             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1201         16  TX-ACCESS-CD-GENL       PIC X(12).
  1202
  1203         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1204             20  TX-LETTER-NO        PIC X(4).
  1205             20  FILLER              PIC X(8).
  1206
  1207         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1208             20  TX-FORM-NO          PIC X(12).
  1209
  1210         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1211             20  TX-HELP-TYPE        PIC X.
  1212                 88  HELP-FOR-GENERAL   VALUE ' '.
  1213                 88  HELP-BY-SCREEN     VALUE 'S'.
  1214                 88  HELP-BY-ERROR      VALUE 'E'.
  1215             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1216                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1217             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1218                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1219             20  FILLER              PIC X(4).
  1220
  1221         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1222
  1223     12  TX-PROCESS-CONTROL          PIC XX.
  1224         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1225
  1226     12  TX-TEXT-LINE                PIC X(70).
  1227
  1228     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1229         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1230         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1231         88  TX-VALID-FORM-SQUEEZE-VALUE
  1232                                        VALUE 'Y' ' '.
  1233
  1234     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1235         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1236         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1237         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1238         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1239         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1240         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1241         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1242                                              'K' 'N' ' '
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  24
* EL6311.cbl
  1243                                              'Z'.
  1244
  1245     12  TX-ARCHIVE-SW               PIC X.
  1246         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1247         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1248         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1249
  1250     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1251     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1252
  1253     12  TX-BSR-CODE                 PIC X.
  1254         88  TX-BSR-LETTER              VALUE 'B'.
  1255         88  TX-NON-BSR-LETTER          VALUE ' '.
  1256
  1257     12  FILLER                      PIC X.
  1258*****************************************************************
  1259*                                COPY ELCCRTO.
  1260******************************************************************
  1261*                                                                *
  1262*                            ELCCRTO.                            *
  1263*                                                                *
  1264*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1265*                                                                *
  1266*   FILE TYPE = VSAM,KSDS                                        *
  1267*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1268*                                                                *
  1269*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1270*                                                                *
  1271*   LOG = YES                                                    *
  1272*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1273******************************************************************
  1274*                   C H A N G E   L O G
  1275*
  1276* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1277*-----------------------------------------------------------------
  1278*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1279* EFFECTIVE    NUMBER
  1280*-----------------------------------------------------------------
  1281* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1282* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1283* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1284* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1285* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1286******************************************************************
  1287 01  ORIGINAL-CERTIFICATE.
  1288     12  OC-RECORD-ID                      PIC XX.
  1289         88  VALID-OC-ID                      VALUE 'OC'.
  1290     12  OC-CONTROL-PRIMARY.
  1291         16  OC-COMPANY-CD                 PIC X.
  1292         16  OC-CARRIER                    PIC X.
  1293         16  OC-GROUPING                   PIC X(6).
  1294         16  OC-STATE                      PIC XX.
  1295         16  OC-ACCOUNT                    PIC X(10).
  1296         16  OC-CERT-EFF-DT                PIC XX.
  1297         16  OC-CERT-NO.
  1298             20  OC-CERT-PRIME             PIC X(10).
  1299             20  OC-CERT-SFX               PIC X.
  1300         16  OC-RECORD-TYPE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  25
* EL6311.cbl
  1301         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1302     12  OC-LAST-MAINT-DT                  PIC XX.
  1303     12  OC-LAST-MAINT-BY                  PIC X(4).
  1304     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1305     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1306     12  FILLER                            PIC X(49).
  1307     12  OC-ORIG-REC.
  1308         16  OC-INS-LAST-NAME              PIC X(15).
  1309         16  OC-INS-FIRST-NAME             PIC X(10).
  1310         16  OC-INS-MIDDLE-INIT            PIC X.
  1311         16  OC-INS-AGE                    PIC S999     COMP-3.
  1312         16  OC-JNT-LAST-NAME              PIC X(15).
  1313         16  OC-JNT-FIRST-NAME             PIC X(10).
  1314         16  OC-JNT-MIDDLE-INIT            PIC X.
  1315         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1316         16  OC-LF-BENCD                   PIC XX.
  1317         16  OC-LF-TERM                    PIC S999      COMP-3.
  1318         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1319         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1320         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1321         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1322         16  OC-LF-EXP-DT                  PIC XX.
  1323         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1324         16  OC-LF-CANCEL-DT               PIC XX.
  1325         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1326         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1327         16  OC-AH-BENCD                   PIC XX.
  1328         16  OC-AH-TERM                    PIC S999      COMP-3.
  1329         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1330         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1331         16  OC-AH-EXP-DT                  PIC XX.
  1332         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1333         16  OC-AH-CP                      PIC 99.
  1334         16  OC-AH-CANCEL-DT               PIC XX.
  1335         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1336         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1337         16  OC-CRED-BENE-NAME             PIC X(25).
  1338         16  OC-1ST-PMT-DT                 PIC XX.
  1339         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1340         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1341         16  OC-ISSUE-TRAN-IND             PIC X.
  1342         16  OC-CANCEL-TRAN-IND            PIC X.
  1343         16  FILLER                        PIC X(211).
  1344
  1345     12  FILLER                            PIC X(50).
  1346******************************************************************
  1347*                                COPY ERCACCT.
  1348******************************************************************
  1349*                                                                *
  1350*                                                                *
  1351*                            ERCACCT                             *
  1352*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1353*                            VMOD=2.031                          *
  1354*                                                                *
  1355*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1356*                                                                *
  1357*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1358*   VSAM ACCOUNT MASTER FILES.                                   *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  26
* EL6311.cbl
  1359*                                                                *
  1360*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1361*                                                                *
  1362*   FILE TYPE = VSAM,KSDS                                        *
  1363*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1364*                                                                *
  1365*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1366*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1367*                                                                *
  1368*   LOG = NO                                                     *
  1369*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1370*                                                                *
  1371*                                                                *
  1372******************************************************************
  1373*                   C H A N G E   L O G
  1374*
  1375* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1376*-----------------------------------------------------------------
  1377*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1378* EFFECTIVE    NUMBER
  1379*-----------------------------------------------------------------
  1380* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1381* 092705    2005050300006  PEMA  ADD SPP LEASES
  1382* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1383* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1384* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1385* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1386* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1387* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1388******************************************************************
  1389
  1390 01  ACCOUNT-MASTER.
  1391     12  AM-RECORD-ID                      PIC XX.
  1392         88  VALID-AM-ID                      VALUE 'AM'.
  1393
  1394     12  AM-CONTROL-PRIMARY.
  1395         16  AM-COMPANY-CD                 PIC X.
  1396         16  AM-MSTR-CNTRL.
  1397             20  AM-CONTROL-A.
  1398                 24  AM-CARRIER            PIC X.
  1399                 24  AM-GROUPING.
  1400                     28 AM-GROUPING-PREFIX PIC XXX.
  1401                     28 AM-GROUPING-PRIME  PIC XXX.
  1402                 24  AM-STATE              PIC XX.
  1403                 24  AM-ACCOUNT.
  1404                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1405                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1406             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1407                                           PIC X(19).
  1408             20  AM-CNTRL-B.
  1409                 24  AM-EXPIRATION-DT      PIC XX.
  1410                 24  FILLER                PIC X(4).
  1411             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1412                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1413
  1414     12  AM-CONTROL-BY-VAR-GRP.
  1415         16  AM-COMPANY-CD-A1              PIC X.
  1416         16  AM-VG-CARRIER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  27
* EL6311.cbl
  1417         16  AM-VG-GROUPING                PIC X(6).
  1418         16  AM-VG-STATE                   PIC XX.
  1419         16  AM-VG-ACCOUNT                 PIC X(10).
  1420         16  AM-VG-DATE.
  1421             20  AM-VG-EXPIRATION-DT       PIC XX.
  1422             20  FILLER                    PIC X(4).
  1423         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1424                                           PIC 9(11)      COMP-3.
  1425     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1426         16  FILLER                        PIC X(10).
  1427         16  AM-VG-KEY3.
  1428             20  AM-VG3-ACCOUNT            PIC X(10).
  1429             20  AM-VG3-EXP-DT             PIC XX.
  1430         16  FILLER                        PIC X(4).
  1431     12  AM-MAINT-INFORMATION.
  1432         16  AM-LAST-MAINT-DT              PIC XX.
  1433         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1434         16  AM-LAST-MAINT-USER            PIC X(4).
  1435         16  FILLER                        PIC XX.
  1436
  1437     12  AM-EFFECTIVE-DT                   PIC XX.
  1438     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1439
  1440     12  AM-PREV-DATES  COMP-3.
  1441         16  AM-PREV-EXP-DT                PIC 9(11).
  1442         16  AM-PREV-EFF-DT                PIC 9(11).
  1443
  1444     12  AM-REPORT-CODE-1                  PIC X(10).
  1445     12  AM-REPORT-CODE-2                  PIC X(10).
  1446
  1447     12  AM-CITY-CODE                      PIC X(4).
  1448     12  AM-COUNTY-PARISH                  PIC X(6).
  1449
  1450     12  AM-NAME                           PIC X(30).
  1451     12  AM-PERSON                         PIC X(30).
  1452     12  AM-ADDRS                          PIC X(30).
  1453     12  AM-CITY.
  1454         16  AM-ADDR-CITY                  PIC X(28).
  1455         16  AM-ADDR-STATE                 PIC XX.
  1456     12  AM-ZIP.
  1457         16  AM-ZIP-PRIME.
  1458             20  AM-ZIP-PRI-1ST            PIC X.
  1459                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1460             20  FILLER                    PIC X(4).
  1461         16  AM-ZIP-PLUS4                  PIC X(4).
  1462     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1463         16  AM-CAN-POSTAL-1               PIC XXX.
  1464         16  AM-CAN-POSTAL-2               PIC XXX.
  1465         16  FILLER                        PIC XXX.
  1466     12  AM-TEL-NO.
  1467         16  AM-AREA-CODE                  PIC 999.
  1468         16  AM-TEL-PRE                    PIC 999.
  1469         16  AM-TEL-NBR                    PIC 9(4).
  1470     12  AM-TEL-LOC                        PIC X.
  1471         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1472         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1473
  1474     12  AM-COMM-STRUCTURE.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  28
* EL6311.cbl
  1475         16  AM-DEFN-1.
  1476             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1477                 24  AM-AGT.
  1478                     28  AM-AGT-PREFIX     PIC X(4).
  1479                     28  AM-AGT-PRIME      PIC X(6).
  1480                 24  AM-COM-TYP            PIC X.
  1481                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1482                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1483                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1484                 24  AM-RECALC-LV-INDIC    PIC X.
  1485                 24  AM-RETRO-LV-INDIC     PIC X.
  1486                 24  AM-GL-CODES           PIC X.
  1487                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1488                 24  FILLER                PIC X(01).
  1489         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1490             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1491                 24  FILLER                PIC X(11).
  1492                 24  AM-L-COMA             PIC XXX.
  1493                 24  AM-J-COMA             PIC XXX.
  1494                 24  AM-A-COMA             PIC XXX.
  1495                 24  FILLER                PIC X(6).
  1496
  1497     12  AM-COMM-CHANGE-STATUS             PIC X.
  1498         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1499
  1500     12  AM-CSR-CODE                       PIC X(4).
  1501
  1502     12  AM-BILLING-STATUS                 PIC X.
  1503         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1504         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1505     12  AM-AUTO-REFUND-SW                 PIC X.
  1506         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1507         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1508     12  AM-GPCD                           PIC 99.
  1509     12  AM-IG                             PIC X.
  1510         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1511         88  AM-HAS-GROUP                     VALUE '2'.
  1512     12  AM-STATUS                         PIC X.
  1513         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1514         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1515         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1516         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1517         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1518         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1519         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1520         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1521         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1522         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1523     12  AM-REMIT-TO                       PIC 99.
  1524     12  AM-ID-NO                          PIC X(11).
  1525
  1526     12  AM-CAL-TABLE                      PIC XX.
  1527     12  AM-LF-DEVIATION                   PIC XXX.
  1528     12  AM-AH-DEVIATION                   PIC XXX.
  1529     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1530     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1531     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1532     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  29
* EL6311.cbl
  1533     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1534     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1535
  1536     12  AM-USER-FIELDS.
  1537         16  AM-FLD-1                      PIC XX.
  1538         16  AM-FLD-2                      PIC XX.
  1539         16  AM-FLD-3                      PIC XX.
  1540         16  AM-FLD-4                      PIC XX.
  1541         16  AM-FLD-5                      PIC XX.
  1542
  1543     12  AM-1ST-PROD-DATE.
  1544         16  AM-1ST-PROD-YR                PIC XX.
  1545         16  AM-1ST-PROD-MO                PIC XX.
  1546         16  AM-1ST-PROD-DA                PIC XX.
  1547     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1548     12  AM-CERTS-PURGED-DATE.
  1549         16  AM-PUR-YR                     PIC XX.
  1550         16  AM-PUR-MO                     PIC XX.
  1551         16  AM-PUR-DA                     PIC XX.
  1552     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1553     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1554     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1555     12  AM-INACTIVE-DATE.
  1556         16  AM-INA-MO                     PIC 99.
  1557         16  AM-INA-DA                     PIC 99.
  1558         16  AM-INA-YR                     PIC 99.
  1559     12  AM-AR-HI-CERT-DATE                PIC XX.
  1560
  1561     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1562     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1563
  1564     12  AM-OB-PAYMENT-MODE                PIC X.
  1565         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1566         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1567         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1568         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1569
  1570     12  AM-AH-ONLY-INDICATOR              PIC X.
  1571         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1572         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1573
  1574     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1575
  1576     12  AM-OVER-SHORT.
  1577         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1578         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1579
  1580     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1581     12  AM-DCC-CLP-STATE                  PIC XX.
  1582
  1583     12  AM-RECALC-COMM                    PIC X.
  1584     12  AM-RECALC-REIN                    PIC X.
  1585
  1586     12  AM-REI-TABLE                      PIC XXX.
  1587     12  AM-REI-ET-LF                      PIC X.
  1588     12  AM-REI-ET-AH                      PIC X.
  1589     12  AM-REI-PE-LF                      PIC X.
  1590     12  AM-REI-PE-AH                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  30
* EL6311.cbl
  1591     12  AM-REI-PRT-ST                     PIC X.
  1592     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1593     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1594     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1595     12  AM-REI-GROUP-A                    PIC X(6).
  1596     12  AM-REI-MORT                       PIC X(4).
  1597     12  AM-REI-PRT-OW                     PIC X.
  1598     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1599     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1600     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1601     12  AM-REI-GROUP-B                    PIC X(6).
  1602
  1603     12  AM-TRUST-TYPE                     PIC X(2).
  1604
  1605     12  AM-EMPLOYER-STMT-USED             PIC X.
  1606     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1607
  1608     12  AM-STD-AH-TYPE                    PIC XX.
  1609     12  AM-EARN-METHODS.
  1610         16  AM-EARN-METHOD-R              PIC X.
  1611             88 AM-REF-RL-R78                 VALUE 'R'.
  1612             88 AM-REF-RL-PR                  VALUE 'P'.
  1613             88 AM-REF-RL-MEAN                VALUE 'M'.
  1614             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1615         16  AM-EARN-METHOD-L              PIC X.
  1616             88 AM-REF-LL-R78                 VALUE 'R'.
  1617             88 AM-REF-LL-PR                  VALUE 'P'.
  1618             88 AM-REF-LL-MEAN                VALUE 'M'.
  1619             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1620         16  AM-EARN-METHOD-A              PIC X.
  1621             88 AM-REF-AH-R78                 VALUE 'R'.
  1622             88 AM-REF-AH-PR                  VALUE 'P'.
  1623             88 AM-REF-AH-MEAN                VALUE 'M'.
  1624             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1625             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1626             88 AM-REF-AH-NET                 VALUE 'N'.
  1627
  1628     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1629     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1630     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1631
  1632     12  AM-RET-Y-N                        PIC X.
  1633     12  AM-RET-P-E                        PIC X.
  1634     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1635     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1636     12  AM-RET-GRP                        PIC X(6).
  1637     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1638         16  AM-POOL-PRIME                 PIC XXX.
  1639         16  AM-POOL-SUB                   PIC XXX.
  1640     12  AM-RETRO-EARNINGS.
  1641         16  AM-RET-EARN-R                 PIC X.
  1642         16  AM-RET-EARN-L                 PIC X.
  1643         16  AM-RET-EARN-A                 PIC X.
  1644     12  AM-RET-ST-TAX-USE                 PIC X.
  1645         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1646         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1647     12  AM-RETRO-BEG-EARNINGS.
  1648         16  AM-RET-BEG-EARN-R             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  31
* EL6311.cbl
  1649         16  AM-RET-BEG-EARN-L             PIC X.
  1650         16  AM-RET-BEG-EARN-A             PIC X.
  1651     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1652     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1653
  1654     12  AM-USER-SELECT-OPTIONS.
  1655         16  AM-USER-SELECT-1              PIC X(10).
  1656         16  AM-USER-SELECT-2              PIC X(10).
  1657         16  AM-USER-SELECT-3              PIC X(10).
  1658         16  AM-USER-SELECT-4              PIC X(10).
  1659         16  AM-USER-SELECT-5              PIC X(10).
  1660
  1661     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1662
  1663     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1664
  1665     12  AM-RPT045A-SWITCH                 PIC X.
  1666         88  RPT045A-OFF                   VALUE 'N'.
  1667
  1668     12  AM-INSURANCE-LIMITS.
  1669         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1670         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1671
  1672     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1673         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1674
  1675     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1676         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1677         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1678
  1679     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1680
  1681     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1682     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1683     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1684     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1685     12  AM-DCC-UEF-STATE                  PIC XX.
  1686     12  FILLER                            PIC XXX.
  1687     12  AM-REPORT-CODE-3                  PIC X(10).
  1688*    12  FILLER                            PIC X(22).
  1689
  1690     12  AM-RESERVE-DATE.
  1691         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1692         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1693         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1694
  1695     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1696     12  AM-NOTIFICATION-TYPES.
  1697         16  AM-NOTIF-OF-LETTERS           PIC X.
  1698         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1699         16  AM-NOTIF-OF-REPORTS           PIC X.
  1700         16  AM-NOTIF-OF-STATUS            PIC X.
  1701
  1702     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1703         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1704         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1705         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1706         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  32
* EL6311.cbl
  1707
  1708     12  AM-BENEFIT-CONTROLS.
  1709         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1710             20  AM-BENEFIT-CODE           PIC XX.
  1711             20  AM-BENEFIT-TYPE           PIC X.
  1712             20  AM-BENEFIT-REVISION       PIC XXX.
  1713             20  AM-BENEFIT-REM-TERM       PIC X.
  1714             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1715             20  FILLER                    PIC XX.
  1716         16  FILLER                        PIC X(80).
  1717
  1718     12  AM-TRANSFER-DATA.
  1719         16  AM-TRANSFERRED-FROM.
  1720             20  AM-TRNFROM-CARRIER        PIC X.
  1721             20  AM-TRNFROM-GROUPING.
  1722                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1723                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1724             20  AM-TRNFROM-STATE          PIC XX.
  1725             20  AM-TRNFROM-ACCOUNT.
  1726                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1727                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1728             20  AM-TRNFROM-DTE            PIC XX.
  1729         16  AM-TRANSFERRED-TO.
  1730             20  AM-TRNTO-CARRIER          PIC X.
  1731             20  AM-TRNTO-GROUPING.
  1732                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1733                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1734             20  AM-TRNTO-STATE            PIC XX.
  1735             20  AM-TRNTO-ACCOUNT.
  1736                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1737                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1738             20  AM-TRNTO-DTE              PIC XX.
  1739         16  FILLER                        PIC X(10).
  1740
  1741     12  AM-SAVED-REMIT-TO                 PIC 99.
  1742
  1743     12  AM-COMM-STRUCTURE-SAVED.
  1744         16  AM-DEFN-1-SAVED.
  1745             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1746                 24  AM-AGT-SV             PIC X(10).
  1747                 24  AM-COM-TYP-SV         PIC X.
  1748                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1749                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1750                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1751                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1752                 24  FILLER                PIC X.
  1753                 24  AM-GL-CODES-SV        PIC X.
  1754                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1755                 24  FILLER                PIC X.
  1756         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1757             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1758                 24  FILLER                PIC X(11).
  1759                 24  AM-L-COMA-SV          PIC XXX.
  1760                 24  AM-J-COMA-SV          PIC XXX.
  1761                 24  AM-A-COMA-SV          PIC XXX.
  1762                 24  FILLER                PIC X(6).
  1763
  1764     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  33
* EL6311.cbl
  1765         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1766            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1767            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1768            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1769
  1770     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1771     12  FILLER                            PIC X(120).
  1772
  1773     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1774         16  AM-CONTROL-NAME               PIC X(30).
  1775         16  AM-EXECUTIVE-ONE.
  1776             20  AM-EXEC1-NAME             PIC X(15).
  1777             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1778                                                          COMP-3.
  1779             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1780                                                          COMP-3.
  1781         16  AM-EXECUTIVE-TWO.
  1782             20  AM-EXEC2-NAME             PIC X(15).
  1783             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1784                                                          COMP-3.
  1785             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1786                                                          COMP-3.
  1787
  1788     12  AM-RETRO-ADDITIONAL-DATA.
  1789         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1790         16  AM-RETRO-PREM-P-E             PIC X.
  1791         16  AM-RETRO-CLMS-P-I             PIC X.
  1792         16  AM-RETRO-RET-BRACKET-LF.
  1793             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1794                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1795                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1796             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1797                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1798                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1799             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1800                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1801                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1802         16  AM-RETRO-RET-BRACKET-AH.
  1803             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1804                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1805                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1806                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1807             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1808                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1809                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1810             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1811                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1812                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1813
  1814     12  AM-COMMENTS.
  1815         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1816
  1817     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1818         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1819         16  AM-FLI-BILLING-CODE           PIC X.
  1820         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1821         16  AM-FLI-UNITED-IDENT           PIC X.
  1822         16  AM-FLI-INTEREST-LOST-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  34
* EL6311.cbl
  1823             20  AM-FLI-BANK-NO            PIC X(5).
  1824             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1825             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1826             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1827         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1828             20  AM-FLI-AGT                PIC X(9).
  1829             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1830             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1831         16  FILLER                        PIC X(102).
  1832
  1833     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1834         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1835             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1836             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1837             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1838             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1839             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1840         16  FILLER                          PIC X(10).
  1841******************************************************************
  1842*                                copy ERCACNT.
  1843******************************************************************
  1844*                                                                *
  1845*                                                                *
  1846*                            ERCACNT.                            *
  1847*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1848*                            VMOD=2.002                          *
  1849*                                                                *
  1850*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1851*                                                                *
  1852*   FILE TYPE = VSAM,KSDS                                        *
  1853*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1854*                                                                *
  1855*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1856*       ALTERNATE INDEX = NONE                                   *
  1857*                                                                *
  1858*                                                                *
  1859*   LOG = YES                                                    *
  1860*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1861******************************************************************
  1862*                   C H A N G E   L O G
  1863*
  1864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1865*-----------------------------------------------------------------
  1866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1867* EFFECTIVE    NUMBER
  1868*-----------------------------------------------------------------
  1869* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1870*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1871******************************************************************
  1872 01  NOTE-FILE.
  1873     12  NT-FILE-ID                  PIC XX.
  1874         88  VALID-NOTE-ID              VALUE 'NT'.
  1875
  1876     12  NT-CONTROL-PRIMARY.
  1877         16  NT-COMPANY-CD           PIC X.
  1878         16  NT-ACCT-NOTE-KEY.
  1879             18  NT-CARRIER              PIC X.
  1880             18  NT-GROUPING             PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  35
* EL6311.cbl
  1881             18  NT-STATE                PIC XX.
  1882             18  NT-ACCOUNT              PIC X(10).
  1883         16  NT-RECORD-TYPE          PIC X.
  1884              88  ACCT-NOTE          VALUE '1'.
  1885              88  ACCT-BRANCH-LOC    VALUE '2'.
  1886              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1887         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1888
  1889     12  NT-LAST-MAINT-DT            PIC XX.
  1890     12  NT-LAST-MAINT-BY            PIC X(4).
  1891     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1892
  1893*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1894*     SEQUENCE NUMBERS
  1895     12  NT-NOTE-INFORMATION.
  1896         16  NT-NOTE-LINE            PIC X(60).
  1897         16  FILLER                  PIC X(25).
  1898*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1899     12  NT-LOCATION-INFORMATION REDEFINES
  1900                         NT-NOTE-INFORMATION.
  1901         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1902         16  FILLER                  PIC X(25).
  1903* Account special indicator is record type '2', sequence 3
  1904     12  filler REDEFINES NT-NOTE-INFORMATION.
  1905         16  nt-account-special      PIC X.
  1906         16  FILLER                  PIC X(84).
  1907*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1908*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1909*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1910*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1911*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1912*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1913*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1914     12  NT-SHIPPING-INFORMATION REDEFINES
  1915                         NT-NOTE-INFORMATION.
  1916         16  NT-SHIPPING-LINE        PIC X(60).
  1917         16  NT-SHIP-STATE           PIC XX.
  1918         16  NT-SHIP-ZIP             PIC X(10).
  1919         16  FILLER                  PIC X(13).
  1920*****************************************************************
  1921*                                COPY ELCVADS.
  1922******************************************************************
  1923*                                                                *
  1924*                                                                *
  1925*                            ELCVADS.                            *
  1926*                                                                *
  1927*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1928*   ELVADS                  LENGTH = 350                         *
  1929******************************************************************
  1930******************************************************************
  1931*                   C H A N G E   L O G
  1932*
  1933* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1934*-----------------------------------------------------------------
  1935*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1936* EFFECTIVE    NUMBER
  1937*-----------------------------------------------------------------
  1938* 100111    2011022800001  AJRA  NAPERSOFT
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  36
* EL6311.cbl
  1939******************************************************************
  1940
  1941 01  VIRGINIA-DISCLOSURE.
  1942     12  VD-COMPANY-CD              PIC X.
  1943     12  VD-CARRIER                 PIC X.
  1944     12  VD-GROUPING.
  1945         20  VD-GROUPING-PREFIX     PIC XXX.
  1946         20  VD-GROUPING-PRIME      PIC XXX.
  1947     12  VD-STATE                   PIC XX.
  1948     12  VD-ACCOUNT.
  1949         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1950         20  VD-ACCOUNT-PRIME       PIC X(6).
  1951     12  VD-CERT-EFF-DT             PIC XX.
  1952     12  VD-CERT-NO.
  1953         20  VD-CERT-PRIME          PIC X(10).
  1954         20  VD-CERT-SFX            PIC X.
  1955     12  VD-ENTRY-BATCH             PIC X(6).
  1956     12  VD-CSR-ID                  PIC X(4).
  1957     12  VD-NAME.
  1958         20  VD-INSURED-LAST-NAME   PIC X(15).
  1959         20  VD-INSURED-FIRST-NAME.
  1960             24  VD-INSURED-1ST-INIT PIC X.
  1961             24  FILLER             PIC X(9).
  1962         20  VD-INSURED-MIDDLE-INIT PIC X.
  1963     12  VD-JOINT-INSURED.
  1964         20 VD-JOINT-LAST-NAME      PIC X(15).
  1965         20 VD-JOINT-FIRST-NAME.
  1966            24  VD-JOINT-FIRST-INIT PIC X.
  1967            24  FILLER              PIC X(9).
  1968         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1969     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1970     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1971     12  VD-INSURED-CITY-STATE.
  1972         20  VD-INSURED-CITY        PIC X(28).
  1973         20  VD-INSURED-STATE       PIC XX.
  1974     12  VD-INSURED-ZIP-CODE.
  1975         20  VD-INSURED-ZIP-PRIME.
  1976             24  VD-INSURED-ZIP-1   PIC X.
  1977                 88  VD-CANADIAN-POST-CODE
  1978                                       VALUE 'A' THRU 'Z'.
  1979             24  FILLER             PIC X(4).
  1980         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1981     12  VD-BENEFICIARY-NAME        PIC X(30).
  1982     12  VD-ACCOUNT-NAME            PIC X(30).
  1983     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1984     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1985     12  VD-1ST-PMT-DT              PIC XX.
  1986     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1987         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1988         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1989                                             '90' THRU '99'.
  1990     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1991                                    PIC XX.
  1992     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1993     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1994     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1995     12  VD-LF-TERM                 PIC S999   COMP-3.
  1996     12  VD-AH-BENEFIT-CD           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  37
* EL6311.cbl
  1997         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1998         88  VD-INVALID-AH             VALUE '  ' '00'
  1999                                             '90' THRU '99'.
  2000     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2001     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2002     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  2003     12  VD-AH-TERM                 PIC S999   COMP-3.
  2004     12  VD-LETTER-ID               PIC X(4).
  2005     12  VD-PROC-ID                 PIC X(4).
  2006     12  VD-COMP-ID                 PIC X(3).
  2007     12  VD-CURRENT-DATE            PIC XX.
  2008     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  2009     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  2010     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  38
* EL6311.cbl
  2012*    COPY ELCDATE.
  2013******************************************************************
  2014*                                                                *
  2015*                                                                *
  2016*                            ELCDATE.                            *
  2017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2018*                            VMOD=2.003
  2019*                                                                *
  2020*                                                                *
  2021*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2022*                 LENGTH = 200                                   *
  2023******************************************************************
  2024
  2025 01  DATE-CONVERSION-DATA.
  2026     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2027     12  DC-OPTION-CODE                PIC X.
  2028         88  BIN-TO-GREG                VALUE ' '.
  2029         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2030         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2031         88  YMD-GREG-TO-BIN            VALUE '3'.
  2032         88  MDY-GREG-TO-BIN            VALUE '4'.
  2033         88  JULIAN-TO-BIN              VALUE '5'.
  2034         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2035         88  FIND-CENTURY               VALUE '7'.
  2036         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2037         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2038         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2039         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2040         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2041         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2042         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2043         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2044         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2045         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2046         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2047         88  BIN-3-TO-GREG              VALUE 'I'.
  2048         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2049         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2050         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2051         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2052         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2053         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2054         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2055         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2056         88  THREE-CHARACTER-BIN
  2057                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2058         88  GREGORIAN-TO-BIN
  2059                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2060         88  BIN-TO-GREGORIAN
  2061                  VALUES ' ' '1' 'I' '8' 'G'.
  2062         88  JULIAN-TO-BINARY
  2063                  VALUES '5' 'C' 'E' 'F'.
  2064     12  DC-ERROR-CODE                 PIC X.
  2065         88  NO-CONVERSION-ERROR        VALUE ' '.
  2066         88  DATE-CONVERSION-ERROR
  2067                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2068         88  DATE-IS-ZERO               VALUE '1'.
  2069         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  39
* EL6311.cbl
  2070         88  DATE-IS-INVALID            VALUE '3'.
  2071         88  DATE1-GREATER-DATE2        VALUE '4'.
  2072         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2073         88  DATE-INVALID-OPTION        VALUE '9'.
  2074         88  INVALID-CENTURY            VALUE 'A'.
  2075         88  ONLY-CENTURY               VALUE 'B'.
  2076         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2077         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2078     12  DC-END-OF-MONTH               PIC X.
  2079         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2080     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2081         88  USE-NORMAL-PROCESS         VALUE ' '.
  2082         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2083         88  ADJUST-UP-100-YRS          VALUE '2'.
  2084     12  FILLER                        PIC X.
  2085     12  DC-CONVERSION-DATES.
  2086         16  DC-BIN-DATE-1             PIC XX.
  2087         16  DC-BIN-DATE-2             PIC XX.
  2088         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2089         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2090                       DC-GREG-DATE-1-EDIT.
  2091             20  DC-EDIT1-MONTH        PIC 99.
  2092             20  SLASH1-1              PIC X.
  2093             20  DC-EDIT1-DAY          PIC 99.
  2094             20  SLASH1-2              PIC X.
  2095             20  DC-EDIT1-YEAR         PIC 99.
  2096         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2097         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2098                     DC-GREG-DATE-2-EDIT.
  2099             20  DC-EDIT2-MONTH        PIC 99.
  2100             20  SLASH2-1              PIC X.
  2101             20  DC-EDIT2-DAY          PIC 99.
  2102             20  SLASH2-2              PIC X.
  2103             20  DC-EDIT2-YEAR         PIC 99.
  2104         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2105         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2106                     DC-GREG-DATE-1-YMD.
  2107             20  DC-YMD-YEAR           PIC 99.
  2108             20  DC-YMD-MONTH          PIC 99.
  2109             20  DC-YMD-DAY            PIC 99.
  2110         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2111         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2112                      DC-GREG-DATE-1-MDY.
  2113             20  DC-MDY-MONTH          PIC 99.
  2114             20  DC-MDY-DAY            PIC 99.
  2115             20  DC-MDY-YEAR           PIC 99.
  2116         16  DC-GREG-DATE-1-ALPHA.
  2117             20  DC-ALPHA-MONTH        PIC X(10).
  2118             20  DC-ALPHA-DAY          PIC 99.
  2119             20  FILLER                PIC XX.
  2120             20  DC-ALPHA-CENTURY.
  2121                 24 DC-ALPHA-CEN-N     PIC 99.
  2122             20  DC-ALPHA-YEAR         PIC 99.
  2123         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2124         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2125         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2126         16  DC-JULIAN-DATE            PIC 9(05).
  2127         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  40
* EL6311.cbl
  2128                                       PIC 9(05).
  2129         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2130             20  DC-JULIAN-YEAR        PIC 99.
  2131             20  DC-JULIAN-DAYS        PIC 999.
  2132         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2133         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2134         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2135     12  DATE-CONVERSION-VARIBLES.
  2136         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2137         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2138             20  FILLER                PIC 9(3).
  2139             20  HOLD-CEN-1-CCYY.
  2140                 24  HOLD-CEN-1-CC     PIC 99.
  2141                 24  HOLD-CEN-1-YY     PIC 99.
  2142             20  HOLD-CEN-1-MO         PIC 99.
  2143             20  HOLD-CEN-1-DA         PIC 99.
  2144         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2145             20  HOLD-CEN-1-R-MO       PIC 99.
  2146             20  HOLD-CEN-1-R-DA       PIC 99.
  2147             20  HOLD-CEN-1-R-CCYY.
  2148                 24  HOLD-CEN-1-R-CC   PIC 99.
  2149                 24  HOLD-CEN-1-R-YY   PIC 99.
  2150             20  FILLER                PIC 9(3).
  2151         16  HOLD-CENTURY-1-X.
  2152             20  FILLER                PIC X(3)  VALUE SPACES.
  2153             20  HOLD-CEN-1-X-CCYY.
  2154                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2155                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2156             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2157             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2158         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2159             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2160             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2161             20  HOLD-CEN-1-R-X-CCYY.
  2162                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2163                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2164             20  FILLER                PIC XXX.
  2165         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2166         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2167         16  DC-JULIAN-DATE-1          PIC 9(07).
  2168         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2169             20  DC-JULIAN-1-CCYY.
  2170                 24  DC-JULIAN-1-CC    PIC 99.
  2171                 24  DC-JULIAN-1-YR    PIC 99.
  2172             20  DC-JULIAN-DA-1        PIC 999.
  2173         16  DC-JULIAN-DATE-2          PIC 9(07).
  2174         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2175             20  DC-JULIAN-2-CCYY.
  2176                 24  DC-JULIAN-2-CC    PIC 99.
  2177                 24  DC-JULIAN-2-YR    PIC 99.
  2178             20  DC-JULIAN-DA-2        PIC 999.
  2179         16  DC-GREG-DATE-A-EDIT.
  2180             20  DC-EDITA-MONTH        PIC 99.
  2181             20  SLASHA-1              PIC X VALUE '/'.
  2182             20  DC-EDITA-DAY          PIC 99.
  2183             20  SLASHA-2              PIC X VALUE '/'.
  2184             20  DC-EDITA-CCYY.
  2185                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  41
* EL6311.cbl
  2186                 24  DC-EDITA-YEAR     PIC 99.
  2187         16  DC-GREG-DATE-B-EDIT.
  2188             20  DC-EDITB-MONTH        PIC 99.
  2189             20  SLASHB-1              PIC X VALUE '/'.
  2190             20  DC-EDITB-DAY          PIC 99.
  2191             20  SLASHB-2              PIC X VALUE '/'.
  2192             20  DC-EDITB-CCYY.
  2193                 24  DC-EDITB-CENT     PIC 99.
  2194                 24  DC-EDITB-YEAR     PIC 99.
  2195         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2196         16  DC-GREG-DATE-CYMD-R REDEFINES
  2197                              DC-GREG-DATE-CYMD.
  2198             20  DC-CYMD-CEN           PIC 99.
  2199             20  DC-CYMD-YEAR          PIC 99.
  2200             20  DC-CYMD-MONTH         PIC 99.
  2201             20  DC-CYMD-DAY           PIC 99.
  2202         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2203         16  DC-GREG-DATE-MDCY-R REDEFINES
  2204                              DC-GREG-DATE-MDCY.
  2205             20  DC-MDCY-MONTH         PIC 99.
  2206             20  DC-MDCY-DAY           PIC 99.
  2207             20  DC-MDCY-CEN           PIC 99.
  2208             20  DC-MDCY-YEAR          PIC 99.
  2209    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2210        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2211    12  DC-EL310-DATE                  PIC X(21).
  2212    12  FILLER                         PIC X(28).
  2213
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  42
* EL6311.cbl
  2215*    COPY ELCLOGOF.
  2216******************************************************************
  2217*                                                                *
  2218*                                                                *
  2219*                            ELCLOGOF.                           *
  2220*                            VMOD=2.001                          *
  2221*                                                                *
  2222*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2223*                                                                *
  2224******************************************************************
  2225 01  CLASIC-LOGOFF.
  2226     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2227     12  LOGOFF-TEXT.
  2228         16  FILLER          PIC X(5)    VALUE SPACES.
  2229         16  LOGOFF-MSG.
  2230             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2231             20  FILLER      PIC X       VALUE SPACES.
  2232             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2233         16  FILLER          PIC X(80)
  2234           VALUE '* YOU ARE NOW LOGGED OFF'.
  2235         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2236         16  FILLER          PIC X       VALUE QUOTE.
  2237         16  LOGOFF-SYS-MSG  PIC X(17)
  2238           VALUE 'S CLAS-IC SYSTEM '.
  2239     12  TEXT-MESSAGES.
  2240         16  UNACCESS-MSG    PIC X(29)
  2241             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2242         16  PGMIDERR-MSG    PIC X(17)
  2243             VALUE 'PROGRAM NOT FOUND'.
  2244
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  43
* EL6311.cbl
  2246*    COPY ELCATTR.
  2247******************************************************************
  2248*                                                                *
  2249*                            ELCATTR.                            *
  2250*                            VMOD=2.001                          *
  2251*                                                                *
  2252*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2253*                                                                *
  2254*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2255*                                                                *
  2256*                   POS 1   P=PROTECTED                          *
  2257*                           U=UNPROTECTED                        *
  2258*                           S=ASKIP                              *
  2259*                   POS 2   A=ALPHA/NUMERIC                      *
  2260*                           N=NUMERIC                            *
  2261*                   POS 3   N=NORMAL                             *
  2262*                           B=BRIGHT                             *
  2263*                           D=DARK                               *
  2264*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2265*                           OF=MODIFIED DATA TAG OFF             *
  2266*                                                                *
  2267*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2268******************************************************************
  2269 01  ATTRIBUTE-LIST.
  2270     12  AL-PABOF            PIC X       VALUE 'Y'.
  2271     12  AL-PABON            PIC X       VALUE 'Z'.
  2272     12  AL-PADOF            PIC X       VALUE '%'.
  2273     12  AL-PADON            PIC X       VALUE '_'.
  2274     12  AL-PANOF            PIC X       VALUE '-'.
  2275     12  AL-PANON            PIC X       VALUE '/'.
  2276     12  AL-SABOF            PIC X       VALUE '8'.
  2277     12  AL-SABON            PIC X       VALUE '9'.
  2278     12  AL-SADOF            PIC X       VALUE '@'.
  2279     12  AL-SADON            PIC X       VALUE QUOTE.
  2280     12  AL-SANOF            PIC X       VALUE '0'.
  2281     12  AL-SANON            PIC X       VALUE '1'.
  2282     12  AL-UABOF            PIC X       VALUE 'H'.
  2283     12  AL-UABON            PIC X       VALUE 'I'.
  2284     12  AL-UADOF            PIC X       VALUE '<'.
  2285     12  AL-UADON            PIC X       VALUE '('.
  2286     12  AL-UANOF            PIC X       VALUE ' '.
  2287     12  AL-UANON            PIC X       VALUE 'A'.
  2288     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2289     12  AL-UNBON            PIC X       VALUE 'R'.
  2290     12  AL-UNDOF            PIC X       VALUE '*'.
  2291     12  AL-UNDON            PIC X       VALUE ')'.
  2292     12  AL-UNNOF            PIC X       VALUE '&'.
  2293     12  AL-UNNON            PIC X       VALUE 'J'.
  2294
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  44
* EL6311.cbl
  2296*    COPY ELCEMIB.
  2297******************************************************************
  2298*                                                                *
  2299*                                                                *
  2300*                            ELCEMIB.                            *
  2301*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2302*                            VMOD=2.005                          *
  2303*                                                                *
  2304*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2305*                                                                *
  2306******************************************************************
  2307 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2308     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2309     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2310     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2311     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2312     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2313     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2314     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2315     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2316     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2317         88  EMI-NO-ERRORS                    VALUE '1'.
  2318         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2319         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2320     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2321         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2322     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2323         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2324         88  EMI-AREA1-FULL                   VALUE '2'.
  2325     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2326         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2327         88  EMI-AREA2-FULL                   VALUE '2'.
  2328     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2329         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2330         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2331         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2332         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2333         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2334     12  EMI-ERROR-LINES.
  2335         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2336         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2337         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2338         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2339             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2340                 24  EMI-ERR-NUM         PIC X(4).
  2341                 24  EMI-FILLER          PIC X.
  2342                 24  EMI-SEV             PIC X.
  2343                 24  FILLER              PIC X.
  2344             20  FILLER                  PIC X(02).
  2345     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2346         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2347             20  EMI-ERROR-NUMBER    PIC X(4).
  2348             20  EMI-FILL            PIC X.
  2349             20  EMI-SEVERITY        PIC X.
  2350             20  FILLER              PIC X.
  2351             20  EMI-ERROR-TEXT.
  2352                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2353                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  45
* EL6311.cbl
  2354     12  EMI-SEVERITY-SAVE           PIC X.
  2355         88  EMI-NOTE                    VALUE 'N'.
  2356         88  EMI-WARNING                 VALUE 'W'.
  2357         88  EMI-FORCABLE                VALUE 'F'.
  2358         88  EMI-FATAL                   VALUE 'X'.
  2359     12  EMI-MESSAGE-FLAG            PIC X.
  2360         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2361         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2362     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2363     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2364         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2365         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2366         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2367     12  emi-claim-no                pic x(7).
  2368     12  emi-claim-type              pic x(6).
  2369     12  FILLER                      PIC X(124)  VALUE SPACES.
  2370     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2371     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2372     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2373     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2374
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  46
* EL6311.cbl
  2376*    COPY ELCINTF.
  2377******************************************************************
  2378*                                                                *
  2379*                                                                *
  2380*                            ELCINTF.                            *
  2381*                            VMOD=2.017                          *
  2382*                                                                *
  2383*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2384*                                                                *
  2385*       LENGTH = 1024                                            *
  2386*                                                                *
  2387******************************************************************
  2388*                   C H A N G E   L O G
  2389*
  2390* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2391*-----------------------------------------------------------------
  2392*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2393* EFFECTIVE    NUMBER
  2394*-----------------------------------------------------------------
  2395* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2396******************************************************************
  2397 01  PROGRAM-INTERFACE-BLOCK.
  2398     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2399     12  PI-CALLING-PROGRAM              PIC X(8).
  2400     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2401     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2402     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2403     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2404     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2405     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2406     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2407     12  PI-COMPANY-ID                   PIC XXX.
  2408     12  PI-COMPANY-CD                   PIC X.
  2409
  2410     12  PI-COMPANY-PASSWORD             PIC X(8).
  2411
  2412     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2413
  2414     12  PI-CONTROL-IN-PROGRESS.
  2415         16  PI-CARRIER                  PIC X.
  2416         16  PI-GROUPING                 PIC X(6).
  2417         16  PI-STATE                    PIC XX.
  2418         16  PI-ACCOUNT                  PIC X(10).
  2419         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2420                                         PIC X(10).
  2421         16  PI-CLAIM-CERT-GRP.
  2422             20  PI-CLAIM-NO             PIC X(7).
  2423             20  PI-CERT-NO.
  2424                 25  PI-CERT-PRIME       PIC X(10).
  2425                 25  PI-CERT-SFX         PIC X.
  2426             20  PI-CERT-EFF-DT          PIC XX.
  2427         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2428             20  PI-PLAN-CODE            PIC X(2).
  2429             20  PI-REVISION-NUMBER      PIC X(3).
  2430             20  PI-PLAN-EFF-DT          PIC X(2).
  2431             20  PI-PLAN-EXP-DT          PIC X(2).
  2432             20  FILLER                  PIC X(11).
  2433         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  47
* EL6311.cbl
  2434             20  PI-OE-REFERENCE-1.
  2435                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2436                 25  PI-OE-REF-1-SUFF    PIC XX.
  2437
  2438     12  PI-SESSION-IN-PROGRESS          PIC X.
  2439         88  CLAIM-SESSION                   VALUE '1'.
  2440         88  CREDIT-SESSION                  VALUE '2'.
  2441         88  WARRANTY-SESSION                VALUE '3'.
  2442         88  MORTGAGE-SESSION                VALUE '4'.
  2443         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2444
  2445
  2446*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2447
  2448     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2449     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2450
  2451     12  PI-CREDIT-USER                  PIC X.
  2452         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2453         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2454
  2455     12  PI-CLAIM-USER                   PIC X.
  2456         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2457         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2458
  2459     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2460         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2461         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2462         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2463         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2464         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2465
  2466     12  PI-PROCESSOR-ID                 PIC X(4).
  2467
  2468     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2469
  2470     12  PI-MEMBER-CAPTION               PIC X(10).
  2471
  2472     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2473         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2474
  2475     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2476     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2477     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2478     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2479
  2480     12  PI-AH-OVERRIDE-L1               PIC X.
  2481     12  PI-AH-OVERRIDE-L2               PIC XX.
  2482     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2483     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2484
  2485     12  PI-NEW-SYSTEM                   PIC X(2).
  2486
  2487     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2488     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2489         88  PI-USES-PAID-TO                 VALUE '1'.
  2490     12  PI-CRDTCRD-SYSTEM.
  2491         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  48
* EL6311.cbl
  2492             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2493             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2494         16  PI-CC-MONTH-END-DT          PIC XX.
  2495     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2496
  2497     12  PI-OE-REFERENCE-2.
  2498         16  PI-OE-REF-2-PRIME           PIC X(10).
  2499         16  PI-OE-REF-2-SUFF            PIC X.
  2500
  2501     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2502
  2503     12  PI-LANGUAGE-TYPE                PIC X.
  2504             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2505             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2506             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2507
  2508     12  PI-POLICY-LINKAGE-IND           PIC X.
  2509         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2510         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2511                                                   LOW-VALUES.
  2512
  2513     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2514     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2515         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2516         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2517
  2518     12  PI-PROCESSOR-CSR-IND            PIC X.
  2519         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2520         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2521
  2522     12  FILLER                          PIC X(3).
  2523
  2524     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2525
  2526     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2527         PI-SYSTEM-LEVEL.
  2528
  2529         16  PI-ENTRY-CODES.
  2530             20  PI-ENTRY-CD-1           PIC X.
  2531             20  PI-ENTRY-CD-2           PIC X.
  2532
  2533         16  PI-RETURN-CODES.
  2534             20  PI-RETURN-CD-1          PIC X.
  2535             20  PI-RETURN-CD-2          PIC X.
  2536
  2537         16  PI-UPDATE-STATUS-SAVE.
  2538             20  PI-UPDATE-BY            PIC X(4).
  2539             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2540
  2541         16  PI-LOWER-CASE-LETTERS       PIC X.
  2542             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2543
  2544*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2545*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2546*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2547
  2548         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2549             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  49
* EL6311.cbl
  2550             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2551             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2552             88  ACCNT-CNTL                  VALUE '3'.
  2553             88  CARR-ACCNT-CNTL             VALUE '4'.
  2554
  2555         16  PI-PROCESSOR-CAP-LIST.
  2556             20  PI-SYSTEM-CONTROLS.
  2557                24 PI-SYSTEM-DISPLAY     PIC X.
  2558                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2559                24 PI-SYSTEM-MODIFY      PIC X.
  2560                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2561             20  FILLER                  PIC XX.
  2562             20  PI-DISPLAY-CAP          PIC X.
  2563                 88  DISPLAY-CAP             VALUE 'Y'.
  2564             20  PI-MODIFY-CAP           PIC X.
  2565                 88  MODIFY-CAP              VALUE 'Y'.
  2566             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2567                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2568             20  PI-FORCE-CAP            PIC X.
  2569                 88  FORCE-CAP               VALUE 'Y'.
  2570
  2571         16  PI-PROGRAM-CONTROLS.
  2572             20  PI-PGM-PRINT-OPT        PIC X.
  2573             20  PI-PGM-FORMAT-OPT       PIC X.
  2574             20  PI-PGM-PROCESS-OPT      PIC X.
  2575             20  PI-PGM-TOTALS-OPT       PIC X.
  2576
  2577         16  PI-HELP-INTERFACE.
  2578             20  PI-LAST-ERROR-NO        PIC X(4).
  2579             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2580
  2581         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2582             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2583
  2584         16  PI-CR-CONTROL-IN-PROGRESS.
  2585             20  PI-CR-CARRIER           PIC X.
  2586             20  PI-CR-GROUPING          PIC X(6).
  2587             20  PI-CR-STATE             PIC XX.
  2588             20  PI-CR-ACCOUNT           PIC X(10).
  2589             20  PI-CR-FIN-RESP          PIC X(10).
  2590             20  PI-CR-TYPE              PIC X.
  2591
  2592         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2593
  2594         16  PI-CR-MONTH-END-DT          PIC XX.
  2595
  2596         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2597             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2598             88  PI-ZERO-CARRIER             VALUE '1'.
  2599             88  PI-ZERO-GROUPING            VALUE '2'.
  2600             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2601
  2602         16  PI-CARRIER-SECURITY         PIC X.
  2603             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2604
  2605         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2606             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2607             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  50
* EL6311.cbl
  2608
  2609         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2610             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2611                                         INDEXED BY PI-ACCESS-NDX
  2612                                         PIC X.
  2613
  2614         16  PI-GA-BILLING-CONTROL       PIC X.
  2615             88  PI-GA-BILLING               VALUE '1'.
  2616
  2617         16  PI-MAIL-PROCESSING          PIC X.
  2618             88  PI-MAIL-YES                 VALUE 'Y'.
  2619
  2620         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2621
  2622         16  PI-AR-SYSTEM.
  2623             20  PI-AR-PROCESSING-CNTL   PIC X.
  2624                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2625             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2626             20  PI-AR-MONTH-END-DT      PIC XX.
  2627
  2628         16  PI-MP-SYSTEM.
  2629             20  PI-MORTGAGE-USER            PIC X.
  2630                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2631                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2632             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2633                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2634                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2635                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2636                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2637                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2638             20  PI-MP-MONTH-END-DT          PIC XX.
  2639             20  PI-MP-REFERENCE-NO.
  2640                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2641                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2642
  2643         16  PI-LABEL-CONTROL            PIC X(01).
  2644             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2645             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2646
  2647         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2648             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2649
  2650         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2651             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2652             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2653
  2654         16  FILLER                      PIC X(14).
  2655
  2656     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2657******************************************************************
  2658
  2659     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2660*    COPY ELC631PI.
  2661******************************************************************
  2662*                                                                *
  2663*                                                                *
  2664*                            ELC631PI                            *
  2665*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  51
* EL6311.cbl
  2666*                                                                *
  2667*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2668*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2669*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2670*                                                                *
  2671*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2672*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2673*    BETWEEN PROGRAMS.                                           *
  2674*                                                                *
  2675*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2676*                                                                *
  2677*               EL631 - EL6311 - EL6312 - EL6313                 *
  2678*                                                                *
  2679******************************************************************
  2680*                   C H A N G E   L O G
  2681*
  2682* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2683*-----------------------------------------------------------------
  2684*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2685* EFFECTIVE    NUMBER
  2686*-----------------------------------------------------------------
  2687* 021414    2003053000001  PEMA  changes for auto chk request
  2688******************************************************************
  2689
  2690         16  PI-631-DATA.
  2691             20  PI-ERPNDB-KEY.
  2692                 24  PI-PB-COMPANY-CD     PIC X.
  2693                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2694                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2695                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2696
  2697             20  PI-ERPNDB-ALT-KEY.
  2698                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2699                 24  PI-PB-CARRIER        PIC X.
  2700                 24  PI-PB-GROUPING       PIC X(6).
  2701                 24  PI-PB-STATE          PIC XX.
  2702                 24  PI-PB-ACCOUNT        PIC X(10).
  2703                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2704                 24  PI-PB-CERT-NO.
  2705                     28  PI-PB-CERT-PRIME PIC X(10).
  2706                     28  PI-PB-CERT-SFX   PIC X.
  2707                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2708                 24  PI-PB-RECORD-TYPE    PIC X.
  2709
  2710             20  PI-ERPNDB-CSR-KEY.
  2711                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2712                 24  PI-PB-CSR-ID             PIC X(4).
  2713                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2714                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2715                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2716
  2717             20  PI-BROWSE-TYPE               PIC X.
  2718                 88  PI-FILE-BROWSE             VALUE ' '.
  2719                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2720                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2721                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2722                 88  PI-CSR-BROWSE              VALUE '4'.
  2723
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  52
* EL6311.cbl
  2724             20  PI-MAINT-FUNCTION            PIC X.
  2725                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2726                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2727                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2728                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2729                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2730                 88  PI-PF5-FUNCTION            VALUE '5'.
  2731                 88  PI-PF6-FUNCTION            VALUE '6'.
  2732
  2733             20  PI-FILE-SWITCHES.
  2734                 24  PI-ALL-ISSUES-SW         PIC X.
  2735                     88  ALL-ISSUES             VALUE 'Y'.
  2736                 24  PI-ALL-CANCELS-SW        PIC X.
  2737                     88  ALL-CANCELS            VALUE 'Y'.
  2738                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2739                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2740                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2741                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2742                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2743                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2744                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2745                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2746                 24  PI-HOLD-REC-SW           PIC X.
  2747                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2748                 24  PI-CHANGE-REC-SW         PIC X.
  2749                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2750                 24  PI-CHK-REQ-REC-SW        PIC X.
  2751                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2752                 24  PI-ISSUE-WARNING-SW      PIC X.
  2753                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2754                 24  PI-CANCEL-WARNING-SW     PIC X.
  2755                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2756             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2757                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2758             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2759                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2760
  2761             20  PI-MAP-NAME                  PIC X(8).
  2762
  2763             20  PI-CURSOR                    PIC S9(4) COMP.
  2764
  2765             20  PI-PREV-ALT-KEY              PIC X(36).
  2766             20  PI-PREV-CSR-KEY              PIC X(15).
  2767             20  PI-PREV-KEY.
  2768                 24  PI-PREV-COMPANY-CD       PIC X.
  2769                 24  PI-PREV-BATCH            PIC X(6).
  2770                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2771                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2772             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2773             20  PI-BROWSE-SW                 PIC X.
  2774                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2775                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2776             20  PI-SV-CARRIER                PIC X.
  2777             20  PI-SV-GROUPING               PIC X(6).
  2778             20  PI-SV-STATE                  PIC XX.
  2779             20  PI-EDIT-SW                   PIC X.
  2780             20  PI-DISPLAY-SW                PIC XX.
  2781                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  53
* EL6311.cbl
  2782                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2783             20  PI-CRITERIA-DATA             PIC X(350).
  2784             20  PI-BMODE                     PIC X.
  2785             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2786             20  PI-BPMTS                     PIC S999     COMP-3.
  2787             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2788             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2789             20  PI-CSR-SESSION-SW            PIC X.
  2790                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2791             20  PI-ERRORS-SW                 PIC X.
  2792                 88  FATAL-ERRORS               VALUE 'X'.
  2793*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2794             20  pi-unforced-sw               pic x.
  2795                 88  unforced-errors            value 'X'.
  2796             20  FILLER                       PIC X(4).
  2797
  2798        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2799        16  FILLER             PIC X(92).
  2800
  2801 01  W-LETTER-COMMUNICATION-AREAS.
  2802*    COPY ELC1042.
  2803******************************************************************
  2804*                                                                *
  2805*                                                                *
  2806*                           ELC1042                              *
  2807*                            VMOD=2.002                          *
  2808*                                                                *
  2809*    NOTE                                                        *
  2810*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2811*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2812*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2813*        TO THESE PROGRAMS.                                      *
  2814*                                                                *
  2815*    NOTE                                                        *
  2816*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2817*        USE ONLY!                                               *
  2818*                                                                *
  2819******************************************************************
  2820
  2821         16  PI-1042-WA.
  2822             20  PI-ACTION       PIC  X(01).
  2823                 88 PI-SHOW-MODE           VALUE '1'.
  2824                 88 PI-CLEAR-MODE          VALUE '2'.
  2825                 88 PI-CREATE-MODE         VALUE '3'.
  2826             20  PI-COMM-CONTROL PIC  X(12).
  2827             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2828             20  PI-EOF-SW       PIC  X(01).
  2829                 88  PI-FILE-EOF           VALUE 'Y'.
  2830             20  PI-FILETYP      PIC  X(01).
  2831             20  PI-FORM-SQUEEZE-CONTROL
  2832                                 PIC  X(01).
  2833                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2834                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2835             20  PI-LAST-CONTROL PIC  X(12).
  2836             20  PI-TEMP-STOR-ITEMS
  2837                                 PIC S9(04) COMP.
  2838             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2839             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  54
* EL6311.cbl
  2840                 88 ANY-UPDATES            VALUE 1.
  2841             20  PI-104-SCREEN-SENT-IND
  2842                                 PIC  X(01).
  2843                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2844                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2845             20  PI-1042-SCREEN-SENT-IND
  2846                                 PIC  X(01).
  2847                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2848                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2849             20  PI-1042-ARCHIVE-IND
  2850                                 PIC  X(01).
  2851                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2852             20  FILLER          PIC  X(29).
  2853*    COPY ELC689PI.
  2854******************************************************************
  2855*                                                                *
  2856*                            ELC689PI                            *
  2857*                            VMOD=2.003                          *
  2858*                                                                *
  2859*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2860*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2861*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2862*                                                                *
  2863*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2864*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2865*    BETWEEN PROGRAMS.                                           *
  2866*                                                                *
  2867*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2868*                                                                *
  2869*               EL631 - EL689  - EL6891 - EL6892                 *
  2870*                                                                *
  2871******************************************************************
  2872*                   C H A N G E   L O G
  2873*
  2874* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2875*-----------------------------------------------------------------
  2876*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2877* EFFECTIVE    NUMBER
  2878*-----------------------------------------------------------------
  2879* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2880* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2881* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2882******************************************************************
  2883
  2884
  2885         16  PI-689-WORK-AREA.
  2886             20  PI-689-ALT-PRINTER-ID
  2887                                 PIC  X(04).
  2888             20  PI-689-ARCHIVE-NUMBER
  2889                                 PIC  9(08).
  2890             20  PI-689-ARCHIVE-SW
  2891                                 PIC  X(01).
  2892                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2893             20  PI-689-DATA-SOURCE
  2894                                 PIC  X(01).
  2895                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2896                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2897                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  55
* EL6311.cbl
  2898                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2899                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2900             20  PI-689-ERROR-IND
  2901                                 PIC  X(01).
  2902                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2903             20  PI-689-ERROR    PIC  9(04).
  2904                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2905                 88  PI-689-FATAL-ERROR
  2906                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2907                            0042 0047 0051 0066 0067 0070
  2908                            0168 0169 0174 0175 0176 0177 0179
  2909                            0180 0181 0182 0184 0185 0189 0190
  2910                            0191
  2911                            0215 0279 0280
  2912                            0412 0413 0454
  2913                            0533 0537
  2914                            2055 2114 2208 2209 2216 2232 2369
  2915                            2398 2433 2908 2999
  2916                            3000 3770 3771 3775
  2917                            7250 7365 7367 7368 7369 7370 7371
  2918                            7272 7373 7374 7376 7377 7378 7379
  2919                            7381 7388 7390 7393 7395 7396 7398
  2920                            9095 9096 9281 9298 9299 9320 9327
  2921                            9426 9427.
  2922                 88  PI-689-STOP-ERROR
  2923                     VALUES 0004 0008 0013 0023 0029 0033
  2924                            0042 0047 0066 0067 0070
  2925                            0168 0169 0174 0175 0176 0177
  2926                            0181 0182 0184 0185 0189 0190
  2927                            0279 0280
  2928                            0412 0413 0454
  2929                            2055 2208 2209 2216 2232
  2930                            2398 2999
  2931                            3000 3770 3771 3775
  2932                            7250 7365 7369 7370 7371
  2933                            7272 7373 7374 7376 7377 7378 7379
  2934                            7381 7388 7390 7393 7396 7398
  2935                            9095 9096 9299 9320 9426.
  2936             20  PI-689-FOLLOW-UP-DATE
  2937                                 PIC  X(02).
  2938             20  PI-689-FORM-NUMBER
  2939                                 PIC  X(04).
  2940             20  PI-689-LABEL-SOURCE
  2941                                 PIC X(01).
  2942                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2943                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2944                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2945                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2946                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2947                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2948                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2949             20  PI-689-NUMBER-COPIES
  2950                                 PIC  9(01).
  2951             20  PI-689-NUMBER-LABEL-LINES
  2952                                 PIC  9(01).
  2953             20  PI-689-NUMBER-TEXT-RECORDS
  2954                                 PIC  9(03).
  2955             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  56
* EL6311.cbl
  2956                                 PIC  X(01).
  2957                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2958                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2959                 88  PI-689-PRINT-LATER     VALUE '3'.
  2960                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2961             20  PI-689-PRINT-RESTRICTION
  2962                                 PIC  X(01).
  2963                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2964                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2965                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2966             20  PI-689-PRINT-SW PIC  X(01).
  2967                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2968             20  PI-689-RESEND-DATE-1
  2969                                 PIC  X(02).
  2970             20  PI-689-RESEND-LETR-1
  2971                                 PIC X(4).
  2972             20  PI-689-TEMP-STOR-ID
  2973                                 PIC  X(08).
  2974             20  PI-689-USE-SCREEN-IND
  2975                                 PIC  X(01).
  2976                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2977             20  PI-689-ARCH-POINTER
  2978                                 PIC S9(08) COMP.
  2979                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2980             20  PI-689-ARCT-POINTER
  2981                                 PIC S9(08) COMP.
  2982                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2983             20  PI-689-VARIABLE-DATA-GRP.
  2984                 24  PI-689-VARIABLE-DATA-1
  2985                                 PIC  X(30).
  2986                 24  PI-689-VARIABLE-DATA-2
  2987                                 PIC  X(30).
  2988                 24  PI-689-VARIABLE-DATA-3
  2989                                 PIC  X(30).
  2990                 24  PI-689-VARIABLE-DATA-4
  2991                                 PIC  X(30).
  2992
  2993         16  PI-689-KEY-DATA-FIELDS.
  2994             20  PI-689-ACCOUNT  PIC  X(10).
  2995             20  PI-689-CARRIER  PIC  X(01).
  2996             20  PI-689-CERT-NO.
  2997                 24  PI-689-CERT-PRIME
  2998                                 PIC  X(10).
  2999                 24  PI-689-CERT-SFX
  3000                                 PIC  X(01).
  3001             20  PI-689-CHG-SEQ-NO
  3002                                 PIC S9(04)    COMP.
  3003             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  3004                                 PIC  X(02).
  3005             20  PI-689-ENTRY-BATCH
  3006                                 PIC  X(06).
  3007             20  PI-689-EFF-DATE PIC  X(02).
  3008             20  PI-689-EXP-DATE PIC  X(02).
  3009             20  PI-689-GROUPING PIC  X(06).
  3010             20  PI-689-RESP-PERSON
  3011                                 PIC  X(10).
  3012             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  3013             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  57
* EL6311.cbl
  3014                                 PIC  X(04).
  3015             20  PI-689-STATE    PIC  X(02).
  3016             20  PI-689-TYPE     PIC  X(01).
  3017             20  PI-689-CONTROL  PIC S9(08)    COMP.
  3018             20  PI-689-ALT-SEQ-NO
  3019                                 PIC S9(04)    COMP.
  3020         16  PI-689-DATE-EDIT    PIC  X(08).
  3021         16  PI-689-FOLLOW-UP-EDIT
  3022                                 PIC  X(08).
  3023         16  PI-689-RESEND1-EDIT PIC  X(08).
  3024         16  PI-689-SEQ-EDIT     PIC  X(08).
  3025         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3026         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3027             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3028         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3029         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  58
* EL6311.cbl
  3031
  3032 01  WS-EL6315-PASS-AREA.
  3033        16  PI-6315-ISS-CAN-SW      PIC X.
  3034        16  FILLER                  PIC X(120).
  3035        16  PI-RES-REF-CLM-TYPE     PIC X.
  3036        16  FILLER                  PIC X.
  3037        16  PI-6315-PASS-AREA.
  3038            20 FILLER               PIC X(236).
  3039            20 PI-6315-FINALIZED    PIC X.
  3040            20 FILLER               PIC X(280).
  3041
  3042 01  WS-EL6316-PASS-AREA.
  3043        16  PI-ISS-CAN-SW           PIC X.
  3044        16  FILLER                  PIC X(121).
  3045        16  PI-CLM-RESC-IND         PIC X.
  3046        16  PI-6316-PASS-AREA.
  3047            20 FILLER               PIC X(236).
  3048            20 PI-6316-FINALIZED    PIC X.
  3049            20 FILLER               PIC X(280).
  3050
  3051******************************************************************
  3052*                                                                *
  3053*         P A S S   A R E A   F O R   E D I T                    *
  3054*                                                                *
  3055******************************************************************
  3056
  3057 01  PASSED-RECORD.
  3058     12  RECORD-SAVE                  PIC X(585).
  3059* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3060*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3061*                    BY  WK-CURRENT-DATE.
  3062******************************************************************
  3063*                                                                *
  3064*                                                                *
  3065*                             ELC50W1                            *
  3066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3067*                            VMOD=2.004                          *
  3068*                                                                *
  3069*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3070*                                                                *
  3071*                                                                *
  3072******************************************************************
  3073
  3074     12  WK-WORK-AREA.
  3075         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3076         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3077         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3078         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3079         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3080         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3081         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3082         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3083         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3084         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3085         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3086         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3087         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3088         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  59
* EL6311.cbl
  3089         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3090         16  WK-CREDIT-EDIT-CONTROLS.
  3091             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3092             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3093             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3094             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3095             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3096             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3097         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3098         16  WK-SAVE-REIN-DATA.
  3099             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3100             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3101             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3102         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3103             88  ENTRY-FROM-EL6311       VALUE '6'.
  3104         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3105         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3106     12  WK-RECORD-ADDRESSES.
  3107         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3108         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3109         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3110         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3111         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3112         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3113         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3114         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3115     12  WK-OVER-SHORT-AREA.
  3116         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3117         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3118         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3119             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3120         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  60
* EL6311.cbl
  3122
  3123*    COPY ELCEDITC.
  3124******************************************************************
  3125*                                                                *
  3126*                                                                *
  3127*                            ELCEDITC                            *
  3128*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3129*                            VMOD=2.012                          *
  3130*                                                                *
  3131*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3132*                     EL6313, EL050 AND EL517.                   *
  3133*                                                                *
  3134******************************************************************
  3135******************************************************************
  3136*                   C H A N G E   L O G
  3137*
  3138* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3139*-----------------------------------------------------------------
  3140*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3141* EFFECTIVE    NUMBER
  3142*-----------------------------------------------------------------
  3143* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3144******************************************************************
  3145
  3146     12  EDIT-CRITERIA-DATA.
  3147         16  EC-CO-MONTH-END-DT       PIC XX.
  3148         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3149         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3150         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3151         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3152         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3153         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3154         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3155         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3156         16  EC-CO-REM-TERM-CALC      PIC X.
  3157               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3158               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3159               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3160               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3161
  3162         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3163               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3164               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3165               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3166               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3167               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3168               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3169               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3170               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3171               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3172               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3173
  3174         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3175               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3176               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3177               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3178               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3179               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  61
* EL6311.cbl
  3180               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3181               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3182               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3183
  3184         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3185                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3186                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3187
  3188         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3189                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3190                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3191                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3192                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3193                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3194                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3195                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3196                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3197
  3198         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3199               88  EC-BR-REDUCING                   VALUE 'R'.
  3200               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3201
  3202         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3203         16  EC-BR-LF-DESC             PIC X(10).
  3204         16  EC-BR-AH-DESC             PIC X(10).
  3205         16  EC-BR-LF-COMMENT          PIC X(10).
  3206         16  EC-BR-AH-COMMENT          PIC X(10).
  3207
  3208         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3209               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3210               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3211               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3212               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3213
  3214         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3215               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3216               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3217               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3218               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3219
  3220         16  EC-BR-LF-REFUND-CALC      PIC X.
  3221                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3222                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3223                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3224                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3225                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3226                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3227                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3228
  3229         16  EC-BR-AH-REFUND-CALC      PIC X.
  3230                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3231                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3232                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3233                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3234                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3235                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3236                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3237                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  62
* EL6311.cbl
  3238
  3239         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3240                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3241                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3242                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3243
  3244         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3245                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3246                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3247                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3248
  3249         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3250         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3251         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3252         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3253
  3254         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3255         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3256                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3257                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3258                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3259                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3260
  3261         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3262               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3263               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3264               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3265               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3266               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3267
  3268         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3269               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3270               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3271               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3272               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3273               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3274
  3275         16  EC-ST-LF-REFUND-CALC      PIC X.
  3276                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3277                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3278                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3279                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3280                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3281                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3282                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3283                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3284
  3285         16  EC-ST-AH-REFUND-CALC      PIC X.
  3286                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3287                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3288                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3289                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3290                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3291                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3292                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3293                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3294
  3295         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  63
* EL6311.cbl
  3296         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3297         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3298         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3299         16  EC-AM-EXPIRATION-DT       PIC XX.
  3300         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3301         16  EC-AM-CLASS-CD            PIC XX.
  3302         16  EC-AM-LF-DEVIATION        PIC XXX.
  3303         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3304         16  EC-AM-AH-DEVIATION        PIC XXX.
  3305         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3306         16  EC-AM-PHONE-NO            PIC X(10).
  3307
  3308         16  EC-AM-LF-REFUND-CALC      PIC X.
  3309                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3310                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3311                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3312                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3313                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3314                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3315                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3316
  3317         16  EC-AM-AH-REFUND-CALC      PIC X.
  3318                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3319                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3320                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3321                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3322                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3323                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3324                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3325
  3326         16  EC-AM-BEN-I-G-CD          PIC X.
  3327                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3328                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3329                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3330
  3331         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3332         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3333         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3334         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3335         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3336         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3337         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3338         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3339         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3340
  3341         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3342         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3343         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3344         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3345         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3346         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3347         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3348         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3349         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3350         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3351         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3352         16  EC-RT-LF-NSP-ST           PIC XX.
  3353         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  64
* EL6311.cbl
  3354         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3355         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3356
  3357         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3358             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3359                                             'M' '5' '9' '2'.
  3360             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3361             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3362             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3363             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3364             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3365             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3366             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3367             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3368             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3369             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3370
  3371         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3372             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3373                                             'M' '5' '9' '2'.
  3374             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3375             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3376             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3377             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3378             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3379             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3380             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3381             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3382             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3383             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3384
  3385         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3386         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3387         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3388         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3389         16  EC-CM-DEATH-DT            PIC XX.
  3390
  3391*DMD CUSTOM CODING FIELDS BELOW
  3392*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3393         16  EC-BR-DMD-RATING-SW       PIC X.
  3394                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3395                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3396                 88  NO-DMD-RATING               VALUE 'N'.
  3397
  3398         16  EC-NEW-CERT               PIC X(11).
  3399         16  EC-NEW-STATE              PIC XX.
  3400         16  FILLER                    PIC X.
  3401*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3402         16  OVER-SHORT-EDIT-FIELDS.
  3403             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3404             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3405             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3406             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3407             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3408             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3409             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3410             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3411             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  65
* EL6311.cbl
  3412         16  FILLER                    PIC X(71).
  3413
  3414******************************************************************
  3415
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  66
* EL6311.cbl
  3417
  3418*    COPY ELCJPFX.
  3419******************************************************************
  3420*                                                                *
  3421*                                                                *
  3422*                            ELCJPFX.                            *
  3423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3424*                            VMOD=2.002                          *
  3425*                                                                *
  3426*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3427*                                                                *
  3428*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3429*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3430*        ELCNTL - CONTROL FILE                                   *
  3431*        ELMSTR - CLAIM MASTERS                                  *
  3432*        ELTRLR - ACTIVITY TRAILERS                              *
  3433*        ELCHKQ - CHECK QUE                                      *
  3434******************************************************************
  3435 01  JOURNAL-RECORD.
  3436     12  jp-date                     pic s9(5) comp-3.
  3437     12  jp-time                     pic s9(7) comp-3.
  3438     12  JP-USER-ID                  PIC X(4).
  3439     12  JP-FILE-ID                  PIC X(8).
  3440     12  JP-PROGRAM-ID               PIC X(8).
  3441     12  JP-RECORD-TYPE              PIC X.
  3442         88 JP-ADD              VALUE 'A'.
  3443         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3444         88 JP-AFTER-CHANGE     VALUE 'C'.
  3445         88 JP-DELETE           VALUE 'D'.
  3446         88 JP-GENERIC-DELETE   VALUE 'G'.
  3447         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3448         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3449     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3450     12  JP-RECORD-AREA
  3451
  3452
  3453                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  67
* EL6311.cbl
  3455*    COPY ELCAID.
  3456******************************************************************
  3457*                                                                *
  3458*                            ELCAID.                             *
  3459*                            VMOD=2.001                          *
  3460*                                                                *
  3461*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3462*                                                                *
  3463*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3464*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3465******************************************************************
  3466
  3467 01  DFHAID.
  3468   02  DFHNULL   PIC  X  VALUE  ' '.
  3469   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3470   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3471   02  DFHPEN    PIC  X  VALUE  '='.
  3472   02  DFHOPID   PIC  X  VALUE  'W'.
  3473   02  DFHPA1    PIC  X  VALUE  '%'.
  3474   02  DFHPA2    PIC  X  VALUE  '>'.
  3475   02  DFHPA3    PIC  X  VALUE  ','.
  3476   02  DFHPF1    PIC  X  VALUE  '1'.
  3477   02  DFHPF2    PIC  X  VALUE  '2'.
  3478   02  DFHPF3    PIC  X  VALUE  '3'.
  3479   02  DFHPF4    PIC  X  VALUE  '4'.
  3480   02  DFHPF5    PIC  X  VALUE  '5'.
  3481   02  DFHPF6    PIC  X  VALUE  '6'.
  3482   02  DFHPF7    PIC  X  VALUE  '7'.
  3483   02  DFHPF8    PIC  X  VALUE  '8'.
  3484   02  DFHPF9    PIC  X  VALUE  '9'.
  3485   02  DFHPF10   PIC  X  VALUE  ':'.
  3486   02  DFHPF11   PIC  X  VALUE  '#'.
  3487   02  DFHPF12   PIC  X  VALUE  '@'.
  3488   02  DFHPF13   PIC  X  VALUE  'A'.
  3489   02  DFHPF14   PIC  X  VALUE  'B'.
  3490   02  DFHPF15   PIC  X  VALUE  'C'.
  3491   02  DFHPF16   PIC  X  VALUE  'D'.
  3492   02  DFHPF17   PIC  X  VALUE  'E'.
  3493   02  DFHPF18   PIC  X  VALUE  'F'.
  3494   02  DFHPF19   PIC  X  VALUE  'G'.
  3495   02  DFHPF20   PIC  X  VALUE  'H'.
  3496   02  DFHPF21   PIC  X  VALUE  'I'.
  3497*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3498   02  DFHPF22   PIC  X  VALUE  '['.
  3499   02  DFHPF23   PIC  X  VALUE  '.'.
  3500   02  DFHPF24   PIC  X  VALUE  '<'.
  3501   02  DFHMSRE   PIC  X  VALUE  'X'.
  3502   02  DFHSTRF   PIC  X  VALUE  'h'.
  3503   02  DFHTRIG   PIC  X  VALUE  '"'.
  3504
  3505 01  FILLER    REDEFINES DFHAID.
  3506     12  FILLER              PIC X(8).
  3507     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3508
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  68
* EL6311.cbl
  3510*    COPY EL6311S.
  3511 01  EL631BI.
  3512     05  FILLER            PIC  X(0012).
  3513*    -------------------------------
  3514     05  BDATEL PIC S9(0004) COMP.
  3515     05  BDATEF PIC  X(0001).
  3516     05  FILLER REDEFINES BDATEF.
  3517         10  BDATEA PIC  X(0001).
  3518     05  BDATEI PIC  X(0008).
  3519*    -------------------------------
  3520     05  BTIMEL PIC S9(0004) COMP.
  3521     05  BTIMEF PIC  X(0001).
  3522     05  FILLER REDEFINES BTIMEF.
  3523         10  BTIMEA PIC  X(0001).
  3524     05  BTIMEI PIC  X(0005).
  3525*    -------------------------------
  3526     05  BHEADL PIC S9(0004) COMP.
  3527     05  BHEADF PIC  X(0001).
  3528     05  FILLER REDEFINES BHEADF.
  3529         10  BHEADA PIC  X(0001).
  3530     05  BHEADI PIC  X(0038).
  3531*    -------------------------------
  3532     05  BNCERTLL PIC S9(0004) COMP.
  3533     05  BNCERTLF PIC  X(0001).
  3534     05  FILLER REDEFINES BNCERTLF.
  3535         10  BNCERTLA PIC  X(0001).
  3536     05  BNCERTLI PIC  X(0008).
  3537*    -------------------------------
  3538     05  BNCERTL PIC S9(0004) COMP.
  3539     05  BNCERTF PIC  X(0001).
  3540     05  FILLER REDEFINES BNCERTF.
  3541         10  BNCERTA PIC  X(0001).
  3542     05  BNCERTI PIC  X(0011).
  3543*    -------------------------------
  3544     05  BNSTATLL PIC S9(0004) COMP.
  3545     05  BNSTATLF PIC  X(0001).
  3546     05  FILLER REDEFINES BNSTATLF.
  3547         10  BNSTATLA PIC  X(0001).
  3548     05  BNSTATLI PIC  X(0009).
  3549*    -------------------------------
  3550     05  BNSTATL PIC S9(0004) COMP.
  3551     05  BNSTATF PIC  X(0001).
  3552     05  FILLER REDEFINES BNSTATF.
  3553         10  BNSTATA PIC  X(0001).
  3554     05  BNSTATI PIC  X(0002).
  3555*    -------------------------------
  3556     05  BCHGTL PIC S9(0004) COMP.
  3557     05  BCHGTF PIC  X(0001).
  3558     05  FILLER REDEFINES BCHGTF.
  3559         10  BCHGTA PIC  X(0001).
  3560     05  BCHGTI PIC  X(0004).
  3561*    -------------------------------
  3562     05  BCHGL PIC S9(0004) COMP.
  3563     05  BCHGF PIC  X(0001).
  3564     05  FILLER REDEFINES BCHGF.
  3565         10  BCHGA PIC  X(0001).
  3566     05  BCHGI PIC  X(0004).
  3567*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  69
* EL6311.cbl
  3568     05  BCOMPIDL PIC S9(0004) COMP.
  3569     05  BCOMPIDF PIC  X(0001).
  3570     05  FILLER REDEFINES BCOMPIDF.
  3571         10  BCOMPIDA PIC  X(0001).
  3572     05  BCOMPIDI PIC  X(0003).
  3573*    -------------------------------
  3574     05  BREGIONL PIC S9(0004) COMP.
  3575     05  BREGIONF PIC  X(0001).
  3576     05  FILLER REDEFINES BREGIONF.
  3577         10  BREGIONA PIC  X(0001).
  3578     05  BREGIONI PIC  X(0006).
  3579*    -------------------------------
  3580     05  BUSERL PIC S9(0004) COMP.
  3581     05  BUSERF PIC  X(0001).
  3582     05  FILLER REDEFINES BUSERF.
  3583         10  BUSERA PIC  X(0001).
  3584     05  BUSERI PIC  X(0004).
  3585*    -------------------------------
  3586     05  BMAINTL PIC S9(0004) COMP.
  3587     05  BMAINTF PIC  X(0001).
  3588     05  FILLER REDEFINES BMAINTF.
  3589         10  BMAINTA PIC  X(0001).
  3590     05  BMAINTI PIC  X(0001).
  3591*    -------------------------------
  3592     05  BMANTBYL PIC S9(0004) COMP.
  3593     05  BMANTBYF PIC  X(0001).
  3594     05  FILLER REDEFINES BMANTBYF.
  3595         10  BMANTBYA PIC  X(0001).
  3596     05  BMANTBYI PIC  X(0004).
  3597*    -------------------------------
  3598     05  BCHGHDGL PIC S9(0004) COMP.
  3599     05  BCHGHDGF PIC  X(0001).
  3600     05  FILLER REDEFINES BCHGHDGF.
  3601         10  BCHGHDGA PIC  X(0001).
  3602     05  BCHGHDGI PIC  X(0003).
  3603*    -------------------------------
  3604     05  BMANTDTL PIC S9(0004) COMP.
  3605     05  BMANTDTF PIC  X(0001).
  3606     05  FILLER REDEFINES BMANTDTF.
  3607         10  BMANTDTA PIC  X(0001).
  3608     05  BMANTDTI PIC  X(0008).
  3609*    -------------------------------
  3610     05  BMANTATL PIC S9(0004) COMP.
  3611     05  BMANTATF PIC  X(0001).
  3612     05  FILLER REDEFINES BMANTATF.
  3613         10  BMANTATA PIC  X(0001).
  3614     05  BMANTATI PIC  X(0005).
  3615*    -------------------------------
  3616     05  BCSRL PIC S9(0004) COMP.
  3617     05  BCSRF PIC  X(0001).
  3618     05  FILLER REDEFINES BCSRF.
  3619         10  BCSRA PIC  X(0001).
  3620     05  BCSRI PIC  X(0004).
  3621*    -------------------------------
  3622     05  BBATCHL PIC S9(0004) COMP.
  3623     05  BBATCHF PIC  X(0001).
  3624     05  FILLER REDEFINES BBATCHF.
  3625         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  70
* EL6311.cbl
  3626     05  BBATCHI PIC  X(0006).
  3627*    -------------------------------
  3628     05  BSEQL PIC S9(0004) COMP.
  3629     05  BSEQF PIC  X(0001).
  3630     05  FILLER REDEFINES BSEQF.
  3631         10  BSEQA PIC  X(0001).
  3632     05  BSEQI PIC  X(0004).
  3633*    -------------------------------
  3634     05  BMOENDTL PIC S9(0004) COMP.
  3635     05  BMOENDTF PIC  X(0001).
  3636     05  FILLER REDEFINES BMOENDTF.
  3637         10  BMOENDTA PIC  X(0001).
  3638     05  BMOENDTI PIC  X(0008).
  3639*    -------------------------------
  3640     05  BCARRL PIC S9(0004) COMP.
  3641     05  BCARRF PIC  X(0001).
  3642     05  FILLER REDEFINES BCARRF.
  3643         10  BCARRA PIC  X(0001).
  3644     05  BCARRI PIC  X(0001).
  3645*    -------------------------------
  3646     05  BGROUPL PIC S9(0004) COMP.
  3647     05  BGROUPF PIC  X(0001).
  3648     05  FILLER REDEFINES BGROUPF.
  3649         10  BGROUPA PIC  X(0001).
  3650     05  BGROUPI PIC  X(0006).
  3651*    -------------------------------
  3652     05  BSTATEL PIC S9(0004) COMP.
  3653     05  BSTATEF PIC  X(0001).
  3654     05  FILLER REDEFINES BSTATEF.
  3655         10  BSTATEA PIC  X(0001).
  3656     05  BSTATEI PIC  X(0002).
  3657*    -------------------------------
  3658     05  BACCTL PIC S9(0004) COMP.
  3659     05  BACCTF PIC  X(0001).
  3660     05  FILLER REDEFINES BACCTF.
  3661         10  BACCTA PIC  X(0001).
  3662     05  BACCTI PIC  X(0010).
  3663*    -------------------------------
  3664     05  BVINHL PIC S9(0004) COMP.
  3665     05  BVINHF PIC  X(0001).
  3666     05  FILLER REDEFINES BVINHF.
  3667         10  BVINHA PIC  X(0001).
  3668     05  BVINHI PIC  X(0004).
  3669*    -------------------------------
  3670     05  BVINL PIC S9(0004) COMP.
  3671     05  BVINF PIC  X(0001).
  3672     05  FILLER REDEFINES BVINF.
  3673         10  BVINA PIC  X(0001).
  3674     05  BVINI PIC  X(0017).
  3675*    -------------------------------
  3676     05  BREFHDGL PIC S9(0004) COMP.
  3677     05  BREFHDGF PIC  X(0001).
  3678     05  FILLER REDEFINES BREFHDGF.
  3679         10  BREFHDGA PIC  X(0001).
  3680     05  BREFHDGI PIC  X(0004).
  3681*    -------------------------------
  3682     05  BREFL PIC S9(0004) COMP.
  3683     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  71
* EL6311.cbl
  3684     05  FILLER REDEFINES BREFF.
  3685         10  BREFA PIC  X(0001).
  3686     05  BREFI PIC  X(0012).
  3687*    -------------------------------
  3688     05  LETRREQL PIC S9(0004) COMP.
  3689     05  LETRREQF PIC  X(0001).
  3690     05  FILLER REDEFINES LETRREQF.
  3691         10  LETRREQA PIC  X(0001).
  3692     05  LETRREQI PIC  X(0001).
  3693*    -------------------------------
  3694     05  BAGEDEFL PIC S9(0004) COMP.
  3695     05  BAGEDEFF PIC  X(0001).
  3696     05  FILLER REDEFINES BAGEDEFF.
  3697         10  BAGEDEFA PIC  X(0001).
  3698     05  BAGEDEFI PIC  X(0004).
  3699*    -------------------------------
  3700     05  BCERTNOL PIC S9(0004) COMP.
  3701     05  BCERTNOF PIC  X(0001).
  3702     05  FILLER REDEFINES BCERTNOF.
  3703         10  BCERTNOA PIC  X(0001).
  3704     05  BCERTNOI PIC  X(0010).
  3705*    -------------------------------
  3706     05  BSUFIXL PIC S9(0004) COMP.
  3707     05  BSUFIXF PIC  X(0001).
  3708     05  FILLER REDEFINES BSUFIXF.
  3709         10  BSUFIXA PIC  X(0001).
  3710     05  BSUFIXI PIC  X(0001).
  3711*    -------------------------------
  3712     05  BEFFDTL PIC S9(0004) COMP.
  3713     05  BEFFDTF PIC  X(0001).
  3714     05  FILLER REDEFINES BEFFDTF.
  3715         10  BEFFDTA PIC  X(0001).
  3716     05  BEFFDTI PIC  X(0008).
  3717*    -------------------------------
  3718     05  BLSTNML PIC S9(0004) COMP.
  3719     05  BLSTNMF PIC  X(0001).
  3720     05  FILLER REDEFINES BLSTNMF.
  3721         10  BLSTNMA PIC  X(0001).
  3722     05  BLSTNMI PIC  X(0015).
  3723*    -------------------------------
  3724     05  B1STNML PIC S9(0004) COMP.
  3725     05  B1STNMF PIC  X(0001).
  3726     05  FILLER REDEFINES B1STNMF.
  3727         10  B1STNMA PIC  X(0001).
  3728     05  B1STNMI PIC  X(0010).
  3729*    -------------------------------
  3730     05  BINITL PIC S9(0004) COMP.
  3731     05  BINITF PIC  X(0001).
  3732     05  FILLER REDEFINES BINITF.
  3733         10  BINITA PIC  X(0001).
  3734     05  BINITI PIC  X(0001).
  3735*    -------------------------------
  3736     05  BSEXL PIC S9(0004) COMP.
  3737     05  BSEXF PIC  X(0001).
  3738     05  FILLER REDEFINES BSEXF.
  3739         10  BSEXA PIC  X(0001).
  3740     05  BSEXI PIC  X(0001).
  3741*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  72
* EL6311.cbl
  3742     05  BAGEL PIC S9(0004) COMP.
  3743     05  BAGEF PIC  X(0001).
  3744     05  FILLER REDEFINES BAGEF.
  3745         10  BAGEA PIC  X(0001).
  3746     05  BAGEI PIC  X(0002).
  3747*    -------------------------------
  3748     05  BBIRTHL PIC S9(0004) COMP.
  3749     05  BBIRTHF PIC  X(0001).
  3750     05  FILLER REDEFINES BBIRTHF.
  3751         10  BBIRTHA PIC  X(0001).
  3752     05  BBIRTHI PIC  X(0008).
  3753*    -------------------------------
  3754     05  B1STPMTL PIC S9(0004) COMP.
  3755     05  B1STPMTF PIC  X(0001).
  3756     05  FILLER REDEFINES B1STPMTF.
  3757         10  B1STPMTA PIC  X(0001).
  3758     05  B1STPMTI PIC  X(0008).
  3759*    -------------------------------
  3760     05  BDAYSL PIC S9(0004) COMP.
  3761     05  BDAYSF PIC  X(0001).
  3762     05  FILLER REDEFINES BDAYSF.
  3763         10  BDAYSA PIC  X(0001).
  3764     05  BDAYSI PIC  X(0003).
  3765*    -------------------------------
  3766     05  BLNTRML PIC S9(0004) COMP.
  3767     05  BLNTRMF PIC  X(0001).
  3768     05  FILLER REDEFINES BLNTRMF.
  3769         10  BLNTRMA PIC  X(0001).
  3770     05  BLNTRMI PIC  X(0003).
  3771*    -------------------------------
  3772     05  BLNOFCRL PIC S9(0004) COMP.
  3773     05  BLNOFCRF PIC  X(0001).
  3774     05  FILLER REDEFINES BLNOFCRF.
  3775         10  BLNOFCRA PIC  X(0001).
  3776     05  BLNOFCRI PIC  X(0005).
  3777*    -------------------------------
  3778     05  BMODEL PIC S9(0004) COMP.
  3779     05  BMODEF PIC  X(0001).
  3780     05  FILLER REDEFINES BMODEF.
  3781         10  BMODEA PIC  X(0001).
  3782     05  BMODEI PIC  X(0001).
  3783*    -------------------------------
  3784     05  BFREQL PIC S9(0004) COMP.
  3785     05  BFREQF PIC  X(0001).
  3786     05  FILLER REDEFINES BFREQF.
  3787         10  BFREQA PIC  X(0001).
  3788     05  BFREQI PIC  X(0002).
  3789*    -------------------------------
  3790     05  BPMTSL PIC S9(0004) COMP.
  3791     05  BPMTSF PIC  X(0001).
  3792     05  FILLER REDEFINES BPMTSF.
  3793         10  BPMTSA PIC  X(0001).
  3794     05  BPMTSI PIC  999.
  3795*    -------------------------------
  3796     05  BPMTAMTL PIC S9(0004) COMP.
  3797     05  BPMTAMTF PIC  X(0001).
  3798     05  FILLER REDEFINES BPMTAMTF.
  3799         10  BPMTAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  73
* EL6311.cbl
  3800     05  BPMTAMTI PIC  9(7)V99.
  3801*    -------------------------------
  3802     05  BAPRL PIC S9(0004) COMP.
  3803     05  BAPRF PIC  X(0001).
  3804     05  FILLER REDEFINES BAPRF.
  3805         10  BAPRA PIC  X(0001).
  3806     05  BAPRI PIC  X(7).
  3807*    -------------------------------
  3808     05  BLIVESL PIC S9(0004) COMP.
  3809     05  BLIVESF PIC  X(0001).
  3810     05  FILLER REDEFINES BLIVESF.
  3811         10  BLIVESA PIC  X(0001).
  3812     05  BLIVESI PIC  X(0009).
  3813*    -------------------------------
  3814     05  BMEMCAPL PIC S9(0004) COMP.
  3815     05  BMEMCAPF PIC  X(0001).
  3816     05  FILLER REDEFINES BMEMCAPF.
  3817         10  BMEMCAPA PIC  X(0001).
  3818     05  BMEMCAPI PIC  X(0011).
  3819*    -------------------------------
  3820     05  BORIGHDL PIC S9(0004) COMP.
  3821     05  BORIGHDF PIC  X(0001).
  3822     05  FILLER REDEFINES BORIGHDF.
  3823         10  BORIGHDA PIC  X(0001).
  3824     05  BORIGHDI PIC  X(0009).
  3825*    -------------------------------
  3826     05  DMDBILL PIC S9(0004) COMP.
  3827     05  DMDBILF PIC  X(0001).
  3828     05  FILLER REDEFINES DMDBILF.
  3829         10  DMDBILA PIC  X(0001).
  3830     05  DMDBILI PIC  X(0006).
  3831*    -------------------------------
  3832     05  BFORCEL PIC S9(0004) COMP.
  3833     05  BFORCEF PIC  X(0001).
  3834     05  FILLER REDEFINES BFORCEF.
  3835         10  BFORCEA PIC  X(0001).
  3836     05  BFORCEI PIC  X(0001).
  3837*    -------------------------------
  3838     05  BENTRYL PIC S9(0004) COMP.
  3839     05  BENTRYF PIC  X(0001).
  3840     05  FILLER REDEFINES BENTRYF.
  3841         10  BENTRYA PIC  X(0001).
  3842     05  BENTRYI PIC  X(0001).
  3843*    -------------------------------
  3844     05  BREINL PIC S9(0004) COMP.
  3845     05  BREINF PIC  X(0001).
  3846     05  FILLER REDEFINES BREINF.
  3847         10  BREINA PIC  X(0001).
  3848     05  BREINI PIC  X(0001).
  3849*    -------------------------------
  3850     05  BBILCDL PIC S9(0004) COMP.
  3851     05  BBILCDF PIC  X(0001).
  3852     05  FILLER REDEFINES BBILCDF.
  3853         10  BBILCDA PIC  X(0001).
  3854     05  BBILCDI PIC  X(0001).
  3855*    -------------------------------
  3856     05  BUNWRITL PIC S9(0004) COMP.
  3857     05  BUNWRITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  74
* EL6311.cbl
  3858     05  FILLER REDEFINES BUNWRITF.
  3859         10  BUNWRITA PIC  X(0001).
  3860     05  BUNWRITI PIC  X(0001).
  3861*    -------------------------------
  3862     05  BSKPCDL PIC S9(0004) COMP.
  3863     05  BSKPCDF PIC  X(0001).
  3864     05  FILLER REDEFINES BSKPCDF.
  3865         10  BSKPCDA PIC  X(0001).
  3866     05  BSKPCDI PIC  X(0001).
  3867*    -------------------------------
  3868     05  BINDGRPL PIC S9(0004) COMP.
  3869     05  BINDGRPF PIC  X(0001).
  3870     05  FILLER REDEFINES BINDGRPF.
  3871         10  BINDGRPA PIC  X(0001).
  3872     05  BINDGRPI PIC  X(0001).
  3873*    -------------------------------
  3874     05  BSIGL PIC S9(0004) COMP.
  3875     05  BSIGF PIC  X(0001).
  3876     05  FILLER REDEFINES BSIGF.
  3877         10  BSIGA PIC  X(0001).
  3878     05  BSIGI PIC  X(0001).
  3879*    -------------------------------
  3880     05  BRTCLSL PIC S9(0004) COMP.
  3881     05  BRTCLSF PIC  X(0001).
  3882     05  FILLER REDEFINES BRTCLSF.
  3883         10  BRTCLSA PIC  X(0001).
  3884     05  BRTCLSI PIC  X(0002).
  3885*    -------------------------------
  3886     05  BCHGCNTL PIC S9(0004) COMP.
  3887     05  BCHGCNTF PIC  X(0001).
  3888     05  FILLER REDEFINES BCHGCNTF.
  3889         10  BCHGCNTA PIC  X(0001).
  3890     05  BCHGCNTI PIC  X(0003).
  3891*    -------------------------------
  3892     05  BMEMBERL PIC S9(0004) COMP.
  3893     05  BMEMBERF PIC  X(0001).
  3894     05  FILLER REDEFINES BMEMBERF.
  3895         10  BMEMBERA PIC  X(0001).
  3896     05  BMEMBERI PIC  X(0012).
  3897*    -------------------------------
  3898     05  BORGNOL PIC S9(0004) COMP.
  3899     05  BORGNOF PIC  X(0001).
  3900     05  FILLER REDEFINES BORGNOF.
  3901         10  BORGNOA PIC  X(0001).
  3902     05  BORGNOI PIC  X(0006).
  3903*    -------------------------------
  3904     05  BORGSEQL PIC S9(0004) COMP.
  3905     05  BORGSEQF PIC  X(0001).
  3906     05  FILLER REDEFINES BORGSEQF.
  3907         10  BORGSEQA PIC  X(0001).
  3908     05  BORGSEQI PIC  X(0004).
  3909*    -------------------------------
  3910     05  BBILLEDL PIC S9(0004) COMP.
  3911     05  BBILLEDF PIC  X(0001).
  3912     05  FILLER REDEFINES BBILLEDF.
  3913         10  BBILLEDA PIC  X(0001).
  3914     05  BBILLEDI PIC  9(9).
  3915*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  75
* EL6311.cbl
  3916     05  BKIND1L PIC S9(0004) COMP.
  3917     05  BKIND1F PIC  X(0001).
  3918     05  FILLER REDEFINES BKIND1F.
  3919         10  BKIND1A PIC  X(0001).
  3920     05  BKIND1I PIC  X(0002).
  3921*    -------------------------------
  3922     05  BTYPE1L PIC S9(0004) COMP.
  3923     05  BTYPE1F PIC  X(0001).
  3924     05  FILLER REDEFINES BTYPE1F.
  3925         10  BTYPE1A PIC  X(0001).
  3926     05  BTYPE1I PIC  X(0003).
  3927*    -------------------------------
  3928     05  BTERM1L PIC S9(0004) COMP.
  3929     05  BTERM1F PIC  X(0001).
  3930     05  FILLER REDEFINES BTERM1F.
  3931         10  BTERM1A PIC  X(0001).
  3932     05  BTERM1I PIC  X(0003).
  3933*    -------------------------------
  3934     05  BBEN1L PIC S9(0004) COMP.
  3935     05  BBEN1F PIC  X(0001).
  3936     05  FILLER REDEFINES BBEN1F.
  3937         10  BBEN1A PIC  X(0001).
  3938     05  BBEN1I PIC  X(0012).
  3939*    -------------------------------
  3940     05  BPREM1L PIC S9(0004) COMP.
  3941     05  BPREM1F PIC  X(0001).
  3942     05  FILLER REDEFINES BPREM1F.
  3943         10  BPREM1A PIC  X(0001).
  3944     05  BPREM1I PIC  X(0011).
  3945*    -------------------------------
  3946     05  BEXPIR1L PIC S9(0004) COMP.
  3947     05  BEXPIR1F PIC  X(0001).
  3948     05  FILLER REDEFINES BEXPIR1F.
  3949         10  BEXPIR1A PIC  X(0001).
  3950     05  BEXPIR1I PIC  X(0008).
  3951*    -------------------------------
  3952     05  BCP1L PIC S9(0004) COMP.
  3953     05  BCP1F PIC  X(0001).
  3954     05  FILLER REDEFINES BCP1F.
  3955         10  BCP1A PIC  X(0001).
  3956     05  BCP1I PIC  X(0002).
  3957*    -------------------------------
  3958     05  BALTBN1L PIC S9(0004) COMP.
  3959     05  BALTBN1F PIC  X(0001).
  3960     05  FILLER REDEFINES BALTBN1F.
  3961         10  BALTBN1A PIC  X(0001).
  3962     05  BALTBN1I PIC  X(0012).
  3963*    -------------------------------
  3964     05  BALTPR1L PIC S9(0004) COMP.
  3965     05  BALTPR1F PIC  X(0001).
  3966     05  FILLER REDEFINES BALTPR1F.
  3967         10  BALTPR1A PIC  X(0001).
  3968     05  BALTPR1I PIC  X(0011).
  3969*    -------------------------------
  3970     05  BBNCD1L PIC S9(0004) COMP.
  3971     05  BBNCD1F PIC  X(0001).
  3972     05  FILLER REDEFINES BBNCD1F.
  3973         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  76
* EL6311.cbl
  3974     05  BBNCD1I PIC  X(0003).
  3975*    -------------------------------
  3976     05  BCPRM1L PIC S9(0004) COMP.
  3977     05  BCPRM1F PIC  X(0001).
  3978     05  FILLER REDEFINES BCPRM1F.
  3979         10  BCPRM1A PIC  X(0001).
  3980     05  BCPRM1I PIC  X(0011).
  3981*    -------------------------------
  3982     05  BCAPRM1L PIC S9(0004) COMP.
  3983     05  BCAPRM1F PIC  X(0001).
  3984     05  FILLER REDEFINES BCAPRM1F.
  3985         10  BCAPRM1A PIC  X(0001).
  3986     05  BCAPRM1I PIC  X(0011).
  3987*    -------------------------------
  3988     05  BENABR1L PIC S9(0004) COMP.
  3989     05  BENABR1F PIC  X(0001).
  3990     05  FILLER REDEFINES BENABR1F.
  3991         10  BENABR1A PIC  X(0001).
  3992     05  BENABR1I PIC  X(0005).
  3993*    -------------------------------
  3994     05  BDIFF1L PIC S9(0004) COMP.
  3995     05  BDIFF1F PIC  X(0001).
  3996     05  FILLER REDEFINES BDIFF1F.
  3997         10  BDIFF1A PIC  X(0001).
  3998     05  BDIFF1I PIC  X(0011).
  3999*    -------------------------------
  4000     05  BBILIT1L PIC S9(0004) COMP.
  4001     05  BBILIT1F PIC  X(0001).
  4002     05  FILLER REDEFINES BBILIT1F.
  4003         10  BBILIT1A PIC  X(0001).
  4004     05  BBILIT1I PIC  X(0008).
  4005*    -------------------------------
  4006     05  BADIFF1L PIC S9(0004) COMP.
  4007     05  BADIFF1F PIC  X(0001).
  4008     05  FILLER REDEFINES BADIFF1F.
  4009         10  BADIFF1A PIC  X(0001).
  4010     05  BADIFF1I PIC  X(0011).
  4011*    -------------------------------
  4012     05  BKIND2L PIC S9(0004) COMP.
  4013     05  BKIND2F PIC  X(0001).
  4014     05  FILLER REDEFINES BKIND2F.
  4015         10  BKIND2A PIC  X(0001).
  4016     05  BKIND2I PIC  X(0002).
  4017*    -------------------------------
  4018     05  BTYPE2L PIC S9(0004) COMP.
  4019     05  BTYPE2F PIC  X(0001).
  4020     05  FILLER REDEFINES BTYPE2F.
  4021         10  BTYPE2A PIC  X(0001).
  4022     05  BTYPE2I PIC  X(0003).
  4023*    -------------------------------
  4024     05  BTERM2L PIC S9(0004) COMP.
  4025     05  BTERM2F PIC  X(0001).
  4026     05  FILLER REDEFINES BTERM2F.
  4027         10  BTERM2A PIC  X(0001).
  4028     05  BTERM2I PIC  X(0003).
  4029*    -------------------------------
  4030     05  BBEN2L PIC S9(0004) COMP.
  4031     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  77
* EL6311.cbl
  4032     05  FILLER REDEFINES BBEN2F.
  4033         10  BBEN2A PIC  X(0001).
  4034     05  BBEN2I PIC  X(0012).
  4035*    -------------------------------
  4036     05  BPREM2L PIC S9(0004) COMP.
  4037     05  BPREM2F PIC  X(0001).
  4038     05  FILLER REDEFINES BPREM2F.
  4039         10  BPREM2A PIC  X(0001).
  4040     05  BPREM2I PIC  X(0011).
  4041*    -------------------------------
  4042     05  BEXPIR2L PIC S9(0004) COMP.
  4043     05  BEXPIR2F PIC  X(0001).
  4044     05  FILLER REDEFINES BEXPIR2F.
  4045         10  BEXPIR2A PIC  X(0001).
  4046     05  BEXPIR2I PIC  X(0008).
  4047*    -------------------------------
  4048     05  BCP2L PIC S9(0004) COMP.
  4049     05  BCP2F PIC  X(0001).
  4050     05  FILLER REDEFINES BCP2F.
  4051         10  BCP2A PIC  X(0001).
  4052     05  BCP2I PIC  X(0002).
  4053*    -------------------------------
  4054     05  BALTBN2L PIC S9(0004) COMP.
  4055     05  BALTBN2F PIC  X(0001).
  4056     05  FILLER REDEFINES BALTBN2F.
  4057         10  BALTBN2A PIC  X(0001).
  4058     05  BALTBN2I PIC  X(0012).
  4059*    -------------------------------
  4060     05  BALTPR2L PIC S9(0004) COMP.
  4061     05  BALTPR2F PIC  X(0001).
  4062     05  FILLER REDEFINES BALTPR2F.
  4063         10  BALTPR2A PIC  X(0001).
  4064     05  BALTPR2I PIC  X(0011).
  4065*    -------------------------------
  4066     05  BBNCD2L PIC S9(0004) COMP.
  4067     05  BBNCD2F PIC  X(0001).
  4068     05  FILLER REDEFINES BBNCD2F.
  4069         10  BBNCD2A PIC  X(0001).
  4070     05  BBNCD2I PIC  X(0003).
  4071*    -------------------------------
  4072     05  BCPRM2L PIC S9(0004) COMP.
  4073     05  BCPRM2F PIC  X(0001).
  4074     05  FILLER REDEFINES BCPRM2F.
  4075         10  BCPRM2A PIC  X(0001).
  4076     05  BCPRM2I PIC  X(0011).
  4077*    -------------------------------
  4078     05  BCAPRM2L PIC S9(0004) COMP.
  4079     05  BCAPRM2F PIC  X(0001).
  4080     05  FILLER REDEFINES BCAPRM2F.
  4081         10  BCAPRM2A PIC  X(0001).
  4082     05  BCAPRM2I PIC  X(0011).
  4083*    -------------------------------
  4084     05  BENABR2L PIC S9(0004) COMP.
  4085     05  BENABR2F PIC  X(0001).
  4086     05  FILLER REDEFINES BENABR2F.
  4087         10  BENABR2A PIC  X(0001).
  4088     05  BENABR2I PIC  X(0005).
  4089*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  78
* EL6311.cbl
  4090     05  BDIFF2L PIC S9(0004) COMP.
  4091     05  BDIFF2F PIC  X(0001).
  4092     05  FILLER REDEFINES BDIFF2F.
  4093         10  BDIFF2A PIC  X(0001).
  4094     05  BDIFF2I PIC  X(0011).
  4095*    -------------------------------
  4096     05  BBILIT2L PIC S9(0004) COMP.
  4097     05  BBILIT2F PIC  X(0001).
  4098     05  FILLER REDEFINES BBILIT2F.
  4099         10  BBILIT2A PIC  X(0001).
  4100     05  BBILIT2I PIC  X(0008).
  4101*    -------------------------------
  4102     05  BADIFF2L PIC S9(0004) COMP.
  4103     05  BADIFF2F PIC  X(0001).
  4104     05  FILLER REDEFINES BADIFF2F.
  4105         10  BADIFF2A PIC  X(0001).
  4106     05  BADIFF2I PIC  X(0011).
  4107*    -------------------------------
  4108     05  BERMSG1L PIC S9(0004) COMP.
  4109     05  BERMSG1F PIC  X(0001).
  4110     05  FILLER REDEFINES BERMSG1F.
  4111         10  BERMSG1A PIC  X(0001).
  4112     05  BERMSG1I PIC  X(0078).
  4113*    -------------------------------
  4114     05  BERMSG2L PIC S9(0004) COMP.
  4115     05  BERMSG2F PIC  X(0001).
  4116     05  FILLER REDEFINES BERMSG2F.
  4117         10  BERMSG2A PIC  X(0001).
  4118     05  BERMSG2I PIC  X(0078).
  4119*    -------------------------------
  4120     05  BERMSG3L PIC S9(0004) COMP.
  4121     05  BERMSG3F PIC  X(0001).
  4122     05  FILLER REDEFINES BERMSG3F.
  4123         10  BERMSG3A PIC  X(0001).
  4124     05  BERMSG3I PIC  X(0078).
  4125*    -------------------------------
  4126     05  BPFENTRL PIC S9(0004) COMP.
  4127     05  BPFENTRF PIC  X(0001).
  4128     05  FILLER REDEFINES BPFENTRF.
  4129         10  BPFENTRA PIC  X(0001).
  4130     05  BPFENTRI PIC  9(2).
  4131*    -------------------------------
  4132     05  BPF5HDRL PIC S9(0004) COMP.
  4133     05  BPF5HDRF PIC  X(0001).
  4134     05  FILLER REDEFINES BPF5HDRF.
  4135         10  BPF5HDRA PIC  X(0001).
  4136     05  BPF5HDRI PIC  X(0005).
  4137*    -------------------------------
  4138     05  BPF4HDRL PIC S9(0004) COMP.
  4139     05  BPF4HDRF PIC  X(0001).
  4140     05  FILLER REDEFINES BPF4HDRF.
  4141         10  BPF4HDRA PIC  X(0001).
  4142     05  BPF4HDRI PIC  X(0013).
  4143*    -------------------------------
  4144     05  BF15HDRL PIC S9(0004) COMP.
  4145     05  BF15HDRF PIC  X(0001).
  4146     05  FILLER REDEFINES BF15HDRF.
  4147         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  79
* EL6311.cbl
  4148     05  BF15HDRI PIC  X(0010).
  4149 01  EL631BO REDEFINES EL631BI.
  4150     05  FILLER            PIC  X(0012).
  4151*    -------------------------------
  4152     05  FILLER            PIC  X(0003).
  4153     05  BDATEO PIC  X(0008).
  4154*    -------------------------------
  4155     05  FILLER            PIC  X(0003).
  4156     05  BTIMEO PIC  99.99.
  4157*    -------------------------------
  4158     05  FILLER            PIC  X(0003).
  4159     05  BHEADO PIC  X(0038).
  4160*    -------------------------------
  4161     05  FILLER            PIC  X(0003).
  4162     05  BNCERTLO PIC  X(0008).
  4163*    -------------------------------
  4164     05  FILLER            PIC  X(0003).
  4165     05  BNCERTO PIC  X(0011).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BNSTATLO PIC  X(0009).
  4169*    -------------------------------
  4170     05  FILLER            PIC  X(0003).
  4171     05  BNSTATO PIC  X(0002).
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BCHGTO PIC  X(0004).
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BCHGO PIC  ZZZ9.
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BCOMPIDO PIC  X(0003).
  4181*    -------------------------------
  4182     05  FILLER            PIC  X(0003).
  4183     05  BREGIONO PIC  X(0006).
  4184*    -------------------------------
  4185     05  FILLER            PIC  X(0003).
  4186     05  BUSERO PIC  X(0004).
  4187*    -------------------------------
  4188     05  FILLER            PIC  X(0003).
  4189     05  BMAINTO PIC  X(0001).
  4190*    -------------------------------
  4191     05  FILLER            PIC  X(0003).
  4192     05  BMANTBYO PIC  X(0004).
  4193*    -------------------------------
  4194     05  FILLER            PIC  X(0003).
  4195     05  BCHGHDGO PIC  X(0003).
  4196*    -------------------------------
  4197     05  FILLER            PIC  X(0003).
  4198     05  BMANTDTO PIC  X(0008).
  4199*    -------------------------------
  4200     05  FILLER            PIC  X(0003).
  4201     05  BMANTATO PIC  99.99.
  4202*    -------------------------------
  4203     05  FILLER            PIC  X(0003).
  4204     05  BCSRO PIC  X(0004).
  4205*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  80
* EL6311.cbl
  4206     05  FILLER            PIC  X(0003).
  4207     05  BBATCHO PIC  X(0006).
  4208*    -------------------------------
  4209     05  FILLER            PIC  X(0003).
  4210     05  BSEQO PIC  X(0004).
  4211*    -------------------------------
  4212     05  FILLER            PIC  X(0003).
  4213     05  BMOENDTO PIC  X(0008).
  4214*    -------------------------------
  4215     05  FILLER            PIC  X(0003).
  4216     05  BCARRO PIC  X(0001).
  4217*    -------------------------------
  4218     05  FILLER            PIC  X(0003).
  4219     05  BGROUPO PIC  X(0006).
  4220*    -------------------------------
  4221     05  FILLER            PIC  X(0003).
  4222     05  BSTATEO PIC  X(0002).
  4223*    -------------------------------
  4224     05  FILLER            PIC  X(0003).
  4225     05  BACCTO PIC  X(0010).
  4226*    -------------------------------
  4227     05  FILLER            PIC  X(0003).
  4228     05  BVINHO PIC  X(0004).
  4229*    -------------------------------
  4230     05  FILLER            PIC  X(0003).
  4231     05  BVINO PIC  X(0017).
  4232*    -------------------------------
  4233     05  FILLER            PIC  X(0003).
  4234     05  BREFHDGO PIC  X(0004).
  4235*    -------------------------------
  4236     05  FILLER            PIC  X(0003).
  4237     05  BREFO PIC  X(0012).
  4238*    -------------------------------
  4239     05  FILLER            PIC  X(0003).
  4240     05  LETRREQO PIC  X(0001).
  4241*    -------------------------------
  4242     05  FILLER            PIC  X(0003).
  4243     05  BAGEDEFO PIC  X(0004).
  4244*    -------------------------------
  4245     05  FILLER            PIC  X(0003).
  4246     05  BCERTNOO PIC  X(0010).
  4247*    -------------------------------
  4248     05  FILLER            PIC  X(0003).
  4249     05  BSUFIXO PIC  X(0001).
  4250*    -------------------------------
  4251     05  FILLER            PIC  X(0003).
  4252     05  BEFFDTO PIC  X(0008).
  4253*    -------------------------------
  4254     05  FILLER            PIC  X(0003).
  4255     05  BLSTNMO PIC  X(0015).
  4256*    -------------------------------
  4257     05  FILLER            PIC  X(0003).
  4258     05  B1STNMO PIC  X(0010).
  4259*    -------------------------------
  4260     05  FILLER            PIC  X(0003).
  4261     05  BINITO PIC  X(0001).
  4262*    -------------------------------
  4263     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  81
* EL6311.cbl
  4264     05  BSEXO PIC  X(0001).
  4265*    -------------------------------
  4266     05  FILLER            PIC  X(0003).
  4267     05  BAGEO PIC  X(0002).
  4268*    -------------------------------
  4269     05  FILLER            PIC  X(0003).
  4270     05  BBIRTHO PIC  X(0008).
  4271*    -------------------------------
  4272     05  FILLER            PIC  X(0003).
  4273     05  B1STPMTO PIC  X(0008).
  4274*    -------------------------------
  4275     05  FILLER            PIC  X(0003).
  4276     05  BDAYSO PIC  X(0003).
  4277*    -------------------------------
  4278     05  FILLER            PIC  X(0003).
  4279     05  BLNTRMO PIC  X(0003).
  4280*    -------------------------------
  4281     05  FILLER            PIC  X(0003).
  4282     05  BLNOFCRO PIC  X(0005).
  4283*    -------------------------------
  4284     05  FILLER            PIC  X(0003).
  4285     05  BMODEO PIC  X(0001).
  4286*    -------------------------------
  4287     05  FILLER            PIC  X(0003).
  4288     05  BFREQO PIC  X(0002).
  4289*    -------------------------------
  4290     05  FILLER            PIC  X(0003).
  4291     05  BPMTSO PIC  X(0003).
  4292*    -------------------------------
  4293     05  FILLER            PIC  X(0003).
  4294     05  BPMTAMTO PIC  ZZZZZ9.99.
  4295*    -------------------------------
  4296     05  FILLER            PIC  X(0003).
  4297     05  BAPRO PIC  99.9999.
  4298*    -------------------------------
  4299     05  FILLER            PIC  X(0003).
  4300     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4301*    -------------------------------
  4302     05  FILLER            PIC  X(0003).
  4303     05  BMEMCAPO PIC  X(0011).
  4304*    -------------------------------
  4305     05  FILLER            PIC  X(0003).
  4306     05  BORIGHDO PIC  X(0009).
  4307*    -------------------------------
  4308     05  FILLER            PIC  X(0003).
  4309     05  DMDBILO PIC  X(0006).
  4310*    -------------------------------
  4311     05  FILLER            PIC  X(0003).
  4312     05  BFORCEO PIC  X(0001).
  4313*    -------------------------------
  4314     05  FILLER            PIC  X(0003).
  4315     05  BENTRYO PIC  X(0001).
  4316*    -------------------------------
  4317     05  FILLER            PIC  X(0003).
  4318     05  BREINO PIC  X(0001).
  4319*    -------------------------------
  4320     05  FILLER            PIC  X(0003).
  4321     05  BBILCDO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  82
* EL6311.cbl
  4322*    -------------------------------
  4323     05  FILLER            PIC  X(0003).
  4324     05  BUNWRITO PIC  X(0001).
  4325*    -------------------------------
  4326     05  FILLER            PIC  X(0003).
  4327     05  BSKPCDO PIC  X(0001).
  4328*    -------------------------------
  4329     05  FILLER            PIC  X(0003).
  4330     05  BINDGRPO PIC  X(0001).
  4331*    -------------------------------
  4332     05  FILLER            PIC  X(0003).
  4333     05  BSIGO PIC  X(0001).
  4334*    -------------------------------
  4335     05  FILLER            PIC  X(0003).
  4336     05  BRTCLSO PIC  X(0002).
  4337*    -------------------------------
  4338     05  FILLER            PIC  X(0003).
  4339     05  BCHGCNTO PIC  X(0003).
  4340*    -------------------------------
  4341     05  FILLER            PIC  X(0003).
  4342     05  BMEMBERO PIC  X(0012).
  4343*    -------------------------------
  4344     05  FILLER            PIC  X(0003).
  4345     05  BORGNOO PIC  X(0006).
  4346*    -------------------------------
  4347     05  FILLER            PIC  X(0003).
  4348     05  BORGSEQO PIC  X(0004).
  4349*    -------------------------------
  4350     05  FILLER            PIC  X(0003).
  4351     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4352*    -------------------------------
  4353     05  FILLER            PIC  X(0003).
  4354     05  BKIND1O PIC  X(0002).
  4355*    -------------------------------
  4356     05  FILLER            PIC  X(0003).
  4357     05  BTYPE1O PIC  X(0003).
  4358*    -------------------------------
  4359     05  FILLER            PIC  X(0003).
  4360     05  BTERM1O PIC  X(0003).
  4361*    -------------------------------
  4362     05  FILLER            PIC  X(0003).
  4363     05  BBEN1O PIC  X(0012).
  4364*    -------------------------------
  4365     05  FILLER            PIC  X(0003).
  4366     05  BPREM1O PIC  X(0011).
  4367*    -------------------------------
  4368     05  FILLER            PIC  X(0003).
  4369     05  BEXPIR1O PIC  X(0008).
  4370*    -------------------------------
  4371     05  FILLER            PIC  X(0003).
  4372     05  BCP1O PIC  X(0002).
  4373*    -------------------------------
  4374     05  FILLER            PIC  X(0003).
  4375     05  BALTBN1O PIC  X(0012).
  4376*    -------------------------------
  4377     05  FILLER            PIC  X(0003).
  4378     05  BALTPR1O PIC  X(0011).
  4379*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  83
* EL6311.cbl
  4380     05  FILLER            PIC  X(0003).
  4381     05  BBNCD1O PIC  X(0003).
  4382*    -------------------------------
  4383     05  FILLER            PIC  X(0003).
  4384     05  BCPRM1O PIC  X(0011).
  4385*    -------------------------------
  4386     05  FILLER            PIC  X(0003).
  4387     05  BCAPRM1O PIC  X(0011).
  4388*    -------------------------------
  4389     05  FILLER            PIC  X(0003).
  4390     05  BENABR1O PIC  X(0005).
  4391*    -------------------------------
  4392     05  FILLER            PIC  X(0003).
  4393     05  BDIFF1O PIC  X(0011).
  4394*    -------------------------------
  4395     05  FILLER            PIC  X(0003).
  4396     05  BBILIT1O PIC  X(0008).
  4397*    -------------------------------
  4398     05  FILLER            PIC  X(0003).
  4399     05  BADIFF1O PIC  X(0011).
  4400*    -------------------------------
  4401     05  FILLER            PIC  X(0003).
  4402     05  BKIND2O PIC  X(0002).
  4403*    -------------------------------
  4404     05  FILLER            PIC  X(0003).
  4405     05  BTYPE2O PIC  X(0003).
  4406*    -------------------------------
  4407     05  FILLER            PIC  X(0003).
  4408     05  BTERM2O PIC  X(0003).
  4409*    -------------------------------
  4410     05  FILLER            PIC  X(0003).
  4411     05  BBEN2O PIC  X(0012).
  4412*    -------------------------------
  4413     05  FILLER            PIC  X(0003).
  4414     05  BPREM2O PIC  X(0011).
  4415*    -------------------------------
  4416     05  FILLER            PIC  X(0003).
  4417     05  BEXPIR2O PIC  X(0008).
  4418*    -------------------------------
  4419     05  FILLER            PIC  X(0003).
  4420     05  BCP2O PIC  X(0002).
  4421*    -------------------------------
  4422     05  FILLER            PIC  X(0003).
  4423     05  BALTBN2O PIC  X(0012).
  4424*    -------------------------------
  4425     05  FILLER            PIC  X(0003).
  4426     05  BALTPR2O PIC  X(0011).
  4427*    -------------------------------
  4428     05  FILLER            PIC  X(0003).
  4429     05  BBNCD2O PIC  X(0003).
  4430*    -------------------------------
  4431     05  FILLER            PIC  X(0003).
  4432     05  BCPRM2O PIC  X(0011).
  4433*    -------------------------------
  4434     05  FILLER            PIC  X(0003).
  4435     05  BCAPRM2O PIC  X(0011).
  4436*    -------------------------------
  4437     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  84
* EL6311.cbl
  4438     05  BENABR2O PIC  X(0005).
  4439*    -------------------------------
  4440     05  FILLER            PIC  X(0003).
  4441     05  BDIFF2O PIC  X(0011).
  4442*    -------------------------------
  4443     05  FILLER            PIC  X(0003).
  4444     05  BBILIT2O PIC  X(0008).
  4445*    -------------------------------
  4446     05  FILLER            PIC  X(0003).
  4447     05  BADIFF2O PIC  X(0011).
  4448*    -------------------------------
  4449     05  FILLER            PIC  X(0003).
  4450     05  BERMSG1O PIC  X(0078).
  4451*    -------------------------------
  4452     05  FILLER            PIC  X(0003).
  4453     05  BERMSG2O PIC  X(0078).
  4454*    -------------------------------
  4455     05  FILLER            PIC  X(0003).
  4456     05  BERMSG3O PIC  X(0078).
  4457*    -------------------------------
  4458     05  FILLER            PIC  X(0003).
  4459     05  BPFENTRO PIC  X(0002).
  4460*    -------------------------------
  4461     05  FILLER            PIC  X(0003).
  4462     05  BPF5HDRO PIC  X(0005).
  4463*    -------------------------------
  4464     05  FILLER            PIC  X(0003).
  4465     05  BPF4HDRO PIC  X(0013).
  4466*    -------------------------------
  4467     05  FILLER            PIC  X(0003).
  4468     05  BF15HDRO PIC  X(0010).
  4469*    -------------------------------
  4470 01  EL631CI REDEFINES EL631BI.
  4471     05  FILLER            PIC  X(0012).
  4472*    -------------------------------
  4473     05  CDATEL PIC S9(0004) COMP.
  4474     05  CDATEF PIC  X(0001).
  4475     05  FILLER REDEFINES CDATEF.
  4476         10  CDATEA PIC  X(0001).
  4477     05  CDATEI PIC  X(0008).
  4478*    -------------------------------
  4479     05  CTIMEL PIC S9(0004) COMP.
  4480     05  CTIMEF PIC  X(0001).
  4481     05  FILLER REDEFINES CTIMEF.
  4482         10  CTIMEA PIC  X(0001).
  4483     05  CTIMEI PIC  X(0005).
  4484*    -------------------------------
  4485     05  CHEADL PIC S9(0004) COMP.
  4486     05  CHEADF PIC  X(0001).
  4487     05  FILLER REDEFINES CHEADF.
  4488         10  CHEADA PIC  X(0001).
  4489     05  CHEADI PIC  X(0038).
  4490*    -------------------------------
  4491     05  CCHGTL PIC S9(0004) COMP.
  4492     05  CCHGTF PIC  X(0001).
  4493     05  FILLER REDEFINES CCHGTF.
  4494         10  CCHGTA PIC  X(0001).
  4495     05  CCHGTI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  85
* EL6311.cbl
  4496*    -------------------------------
  4497     05  CCHGL PIC S9(0004) COMP.
  4498     05  CCHGF PIC  X(0001).
  4499     05  FILLER REDEFINES CCHGF.
  4500         10  CCHGA PIC  X(0001).
  4501     05  CCHGI PIC  X(0004).
  4502*    -------------------------------
  4503     05  CMAINTL PIC S9(0004) COMP.
  4504     05  CMAINTF PIC  X(0001).
  4505     05  FILLER REDEFINES CMAINTF.
  4506         10  CMAINTA PIC  X(0001).
  4507     05  CMAINTI PIC  X(0001).
  4508*    -------------------------------
  4509     05  CMANTBYL PIC S9(0004) COMP.
  4510     05  CMANTBYF PIC  X(0001).
  4511     05  FILLER REDEFINES CMANTBYF.
  4512         10  CMANTBYA PIC  X(0001).
  4513     05  CMANTBYI PIC  X(0004).
  4514*    -------------------------------
  4515     05  CCHGHDGL PIC S9(0004) COMP.
  4516     05  CCHGHDGF PIC  X(0001).
  4517     05  FILLER REDEFINES CCHGHDGF.
  4518         10  CCHGHDGA PIC  X(0001).
  4519     05  CCHGHDGI PIC  X(0003).
  4520*    -------------------------------
  4521     05  CMANTDTL PIC S9(0004) COMP.
  4522     05  CMANTDTF PIC  X(0001).
  4523     05  FILLER REDEFINES CMANTDTF.
  4524         10  CMANTDTA PIC  X(0001).
  4525     05  CMANTDTI PIC  X(0008).
  4526*    -------------------------------
  4527     05  CMANTATL PIC S9(0004) COMP.
  4528     05  CMANTATF PIC  X(0001).
  4529     05  FILLER REDEFINES CMANTATF.
  4530         10  CMANTATA PIC  X(0001).
  4531     05  CMANTATI PIC  X(0005).
  4532*    -------------------------------
  4533     05  CCSRL PIC S9(0004) COMP.
  4534     05  CCSRF PIC  X(0001).
  4535     05  FILLER REDEFINES CCSRF.
  4536         10  CCSRA PIC  X(0001).
  4537     05  CCSRI PIC  X(0004).
  4538*    -------------------------------
  4539     05  CBATCHL PIC S9(0004) COMP.
  4540     05  CBATCHF PIC  X(0001).
  4541     05  FILLER REDEFINES CBATCHF.
  4542         10  CBATCHA PIC  X(0001).
  4543     05  CBATCHI PIC  X(0006).
  4544*    -------------------------------
  4545     05  CSEQL PIC S9(0004) COMP.
  4546     05  CSEQF PIC  X(0001).
  4547     05  FILLER REDEFINES CSEQF.
  4548         10  CSEQA PIC  X(0001).
  4549     05  CSEQI PIC  X(0004).
  4550*    -------------------------------
  4551     05  CMOENDTL PIC S9(0004) COMP.
  4552     05  CMOENDTF PIC  X(0001).
  4553     05  FILLER REDEFINES CMOENDTF.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  86
* EL6311.cbl
  4554         10  CMOENDTA PIC  X(0001).
  4555     05  CMOENDTI PIC  X(0008).
  4556*    -------------------------------
  4557     05  CCARRL PIC S9(0004) COMP.
  4558     05  CCARRF PIC  X(0001).
  4559     05  FILLER REDEFINES CCARRF.
  4560         10  CCARRA PIC  X(0001).
  4561     05  CCARRI PIC  X(0001).
  4562*    -------------------------------
  4563     05  CGROUPL PIC S9(0004) COMP.
  4564     05  CGROUPF PIC  X(0001).
  4565     05  FILLER REDEFINES CGROUPF.
  4566         10  CGROUPA PIC  X(0001).
  4567     05  CGROUPI PIC  X(0006).
  4568*    -------------------------------
  4569     05  CSTATEL PIC S9(0004) COMP.
  4570     05  CSTATEF PIC  X(0001).
  4571     05  FILLER REDEFINES CSTATEF.
  4572         10  CSTATEA PIC  X(0001).
  4573     05  CSTATEI PIC  X(0002).
  4574*    -------------------------------
  4575     05  CACCTL PIC S9(0004) COMP.
  4576     05  CACCTF PIC  X(0001).
  4577     05  FILLER REDEFINES CACCTF.
  4578         10  CACCTA PIC  X(0001).
  4579     05  CACCTI PIC  X(0010).
  4580*    -------------------------------
  4581     05  CORIGHDL PIC S9(0004) COMP.
  4582     05  CORIGHDF PIC  X(0001).
  4583     05  FILLER REDEFINES CORIGHDF.
  4584         10  CORIGHDA PIC  X(0001).
  4585     05  CORIGHDI PIC  X(0011).
  4586*    -------------------------------
  4587     05  CORGNOL PIC S9(0004) COMP.
  4588     05  CORGNOF PIC  X(0001).
  4589     05  FILLER REDEFINES CORGNOF.
  4590         10  CORGNOA PIC  X(0001).
  4591     05  CORGNOI PIC  X(0006).
  4592*    -------------------------------
  4593     05  CORGSEQL PIC S9(0004) COMP.
  4594     05  CORGSEQF PIC  X(0001).
  4595     05  FILLER REDEFINES CORGSEQF.
  4596         10  CORGSEQA PIC  X(0001).
  4597     05  CORGSEQI PIC  X(0004).
  4598*    -------------------------------
  4599     05  CREFHDGL PIC S9(0004) COMP.
  4600     05  CREFHDGF PIC  X(0001).
  4601     05  FILLER REDEFINES CREFHDGF.
  4602         10  CREFHDGA PIC  X(0001).
  4603     05  CREFHDGI PIC  X(0010).
  4604*    -------------------------------
  4605     05  CREFL PIC S9(0004) COMP.
  4606     05  CREFF PIC  X(0001).
  4607     05  FILLER REDEFINES CREFF.
  4608         10  CREFA PIC  X(0001).
  4609     05  CREFI PIC  X(0012).
  4610*    -------------------------------
  4611     05  CNHINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  87
* EL6311.cbl
  4612     05  CNHINTF PIC  X(0001).
  4613     05  FILLER REDEFINES CNHINTF.
  4614         10  CNHINTA PIC  X(0001).
  4615     05  CNHINTI PIC  9(7)V99.
  4616*    -------------------------------
  4617     05  CCERTNOL PIC S9(0004) COMP.
  4618     05  CCERTNOF PIC  X(0001).
  4619     05  FILLER REDEFINES CCERTNOF.
  4620         10  CCERTNOA PIC  X(0001).
  4621     05  CCERTNOI PIC  X(0010).
  4622*    -------------------------------
  4623     05  CSUFIXL PIC S9(0004) COMP.
  4624     05  CSUFIXF PIC  X(0001).
  4625     05  FILLER REDEFINES CSUFIXF.
  4626         10  CSUFIXA PIC  X(0001).
  4627     05  CSUFIXI PIC  X(0001).
  4628*    -------------------------------
  4629     05  CEFFDTL PIC S9(0004) COMP.
  4630     05  CEFFDTF PIC  X(0001).
  4631     05  FILLER REDEFINES CEFFDTF.
  4632         10  CEFFDTA PIC  X(0001).
  4633     05  CEFFDTI PIC  X(0008).
  4634*    -------------------------------
  4635     05  CLSTNML PIC S9(0004) COMP.
  4636     05  CLSTNMF PIC  X(0001).
  4637     05  FILLER REDEFINES CLSTNMF.
  4638         10  CLSTNMA PIC  X(0001).
  4639     05  CLSTNMI PIC  X(0015).
  4640*    -------------------------------
  4641     05  CINAMEL PIC S9(0004) COMP.
  4642     05  CINAMEF PIC  X(0001).
  4643     05  FILLER REDEFINES CINAMEF.
  4644         10  CINAMEA PIC  X(0001).
  4645     05  CINAMEI PIC  X(0015).
  4646*    -------------------------------
  4647     05  CINITSL PIC S9(0004) COMP.
  4648     05  CINITSF PIC  X(0001).
  4649     05  FILLER REDEFINES CINITSF.
  4650         10  CINITSA PIC  X(0001).
  4651     05  CINITSI PIC  X(0010).
  4652*    -------------------------------
  4653     05  CCANREAL PIC S9(0004) COMP.
  4654     05  CCANREAF PIC  X(0001).
  4655     05  FILLER REDEFINES CCANREAF.
  4656         10  CCANREAA PIC  X(0001).
  4657     05  CCANREAI PIC  X(0001).
  4658*    -------------------------------
  4659     05  ACTSPCL PIC S9(0004) COMP.
  4660     05  ACTSPCF PIC  X(0001).
  4661     05  FILLER REDEFINES ACTSPCF.
  4662         10  ACTSPCA PIC  X(0001).
  4663     05  ACTSPCI PIC  X(0001).
  4664*    -------------------------------
  4665     05  CKIND1L PIC S9(0004) COMP.
  4666     05  CKIND1F PIC  X(0001).
  4667     05  FILLER REDEFINES CKIND1F.
  4668         10  CKIND1A PIC  X(0001).
  4669     05  CKIND1I PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  88
* EL6311.cbl
  4670*    -------------------------------
  4671     05  CCANDT1L PIC S9(0004) COMP.
  4672     05  CCANDT1F PIC  X(0001).
  4673     05  FILLER REDEFINES CCANDT1F.
  4674         10  CCANDT1A PIC  X(0001).
  4675     05  CCANDT1I PIC  X(0008).
  4676*    -------------------------------
  4677     05  CREFND1L PIC S9(0004) COMP.
  4678     05  CREFND1F PIC  X(0001).
  4679     05  FILLER REDEFINES CREFND1F.
  4680         10  CREFND1A PIC  X(0001).
  4681     05  CREFND1I PIC  S9(9)V99.
  4682*    -------------------------------
  4683     05  CMTHD1L PIC S9(0004) COMP.
  4684     05  CMTHD1F PIC  X(0001).
  4685     05  FILLER REDEFINES CMTHD1F.
  4686         10  CMTHD1A PIC  X(0001).
  4687     05  CMTHD1I PIC  X(0001).
  4688*    -------------------------------
  4689     05  CKIND2L PIC S9(0004) COMP.
  4690     05  CKIND2F PIC  X(0001).
  4691     05  FILLER REDEFINES CKIND2F.
  4692         10  CKIND2A PIC  X(0001).
  4693     05  CKIND2I PIC  X(0002).
  4694*    -------------------------------
  4695     05  CCANDT2L PIC S9(0004) COMP.
  4696     05  CCANDT2F PIC  X(0001).
  4697     05  FILLER REDEFINES CCANDT2F.
  4698         10  CCANDT2A PIC  X(0001).
  4699     05  CCANDT2I PIC  X(0008).
  4700*    -------------------------------
  4701     05  CREFND2L PIC S9(0004) COMP.
  4702     05  CREFND2F PIC  X(0001).
  4703     05  FILLER REDEFINES CREFND2F.
  4704         10  CREFND2A PIC  X(0001).
  4705     05  CREFND2I PIC  S9(9)V99.
  4706*    -------------------------------
  4707     05  CMTHD2L PIC S9(0004) COMP.
  4708     05  CMTHD2F PIC  X(0001).
  4709     05  FILLER REDEFINES CMTHD2F.
  4710         10  CMTHD2A PIC  X(0001).
  4711     05  CMTHD2I PIC  X(0001).
  4712*    -------------------------------
  4713     05  CLIVESL PIC S9(0004) COMP.
  4714     05  CLIVESF PIC  X(0001).
  4715     05  FILLER REDEFINES CLIVESF.
  4716         10  CLIVESA PIC  X(0001).
  4717     05  CLIVESI PIC  X(0003).
  4718*    -------------------------------
  4719     05  CFORCEL PIC S9(0004) COMP.
  4720     05  CFORCEF PIC  X(0001).
  4721     05  FILLER REDEFINES CFORCEF.
  4722         10  CFORCEA PIC  X(0001).
  4723     05  CFORCEI PIC  X(0001).
  4724*    -------------------------------
  4725     05  CBILCDL PIC S9(0004) COMP.
  4726     05  CBILCDF PIC  X(0001).
  4727     05  FILLER REDEFINES CBILCDF.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  89
* EL6311.cbl
  4728         10  CBILCDA PIC  X(0001).
  4729     05  CBILCDI PIC  X(0001).
  4730*    -------------------------------
  4731     05  CCRFND1L PIC S9(0004) COMP.
  4732     05  CCRFND1F PIC  X(0001).
  4733     05  FILLER REDEFINES CCRFND1F.
  4734         10  CCRFND1A PIC  X(0001).
  4735     05  CCRFND1I PIC  X(0011).
  4736*    -------------------------------
  4737     05  CCRFND2L PIC S9(0004) COMP.
  4738     05  CCRFND2F PIC  X(0001).
  4739     05  FILLER REDEFINES CCRFND2F.
  4740         10  CCRFND2A PIC  X(0001).
  4741     05  CCRFND2I PIC  X(0011).
  4742*    -------------------------------
  4743     05  CBILIT1L PIC S9(0004) COMP.
  4744     05  CBILIT1F PIC  X(0001).
  4745     05  FILLER REDEFINES CBILIT1F.
  4746         10  CBILIT1A PIC  X(0001).
  4747     05  CBILIT1I PIC  X(0008).
  4748*    -------------------------------
  4749     05  CDRFND1L PIC S9(0004) COMP.
  4750     05  CDRFND1F PIC  X(0001).
  4751     05  FILLER REDEFINES CDRFND1F.
  4752         10  CDRFND1A PIC  X(0001).
  4753     05  CDRFND1I PIC  X(0011).
  4754*    -------------------------------
  4755     05  CBILIT2L PIC S9(0004) COMP.
  4756     05  CBILIT2F PIC  X(0001).
  4757     05  FILLER REDEFINES CBILIT2F.
  4758         10  CBILIT2A PIC  X(0001).
  4759     05  CBILIT2I PIC  X(0008).
  4760*    -------------------------------
  4761     05  CDRFND2L PIC S9(0004) COMP.
  4762     05  CDRFND2F PIC  X(0001).
  4763     05  FILLER REDEFINES CDRFND2F.
  4764         10  CDRFND2A PIC  X(0001).
  4765     05  CDRFND2I PIC  X(0011).
  4766*    -------------------------------
  4767     05  CCANTXTL PIC S9(0004) COMP.
  4768     05  CCANTXTF PIC  X(0001).
  4769     05  FILLER REDEFINES CCANTXTF.
  4770         10  CCANTXTA PIC  X(0001).
  4771     05  CCANTXTI PIC  X(0005).
  4772*    -------------------------------
  4773     05  CCANFEEL PIC S9(0004) COMP.
  4774     05  CCANFEEF PIC  X(0001).
  4775     05  FILLER REDEFINES CCANFEEF.
  4776         10  CCANFEEA PIC  X(0001).
  4777     05  CCANFEEI PIC  X(0002).
  4778*    -------------------------------
  4779     05  CTERM1L PIC S9(0004) COMP.
  4780     05  CTERM1F PIC  X(0001).
  4781     05  FILLER REDEFINES CTERM1F.
  4782         10  CTERM1A PIC  X(0001).
  4783     05  CTERM1I PIC  X(0003).
  4784*    -------------------------------
  4785     05  CRTERM1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  90
* EL6311.cbl
  4786     05  CRTERM1F PIC  X(0001).
  4787     05  FILLER REDEFINES CRTERM1F.
  4788         10  CRTERM1A PIC  X(0001).
  4789     05  CRTERM1I PIC  X(0003).
  4790*    -------------------------------
  4791     05  CPREM1L PIC S9(0004) COMP.
  4792     05  CPREM1F PIC  X(0001).
  4793     05  FILLER REDEFINES CPREM1F.
  4794         10  CPREM1A PIC  X(0001).
  4795     05  CPREM1I PIC  X(0011).
  4796*    -------------------------------
  4797     05  CTERM2L PIC S9(0004) COMP.
  4798     05  CTERM2F PIC  X(0001).
  4799     05  FILLER REDEFINES CTERM2F.
  4800         10  CTERM2A PIC  X(0001).
  4801     05  CTERM2I PIC  X(0003).
  4802*    -------------------------------
  4803     05  CRTERM2L PIC S9(0004) COMP.
  4804     05  CRTERM2F PIC  X(0001).
  4805     05  FILLER REDEFINES CRTERM2F.
  4806         10  CRTERM2A PIC  X(0001).
  4807     05  CRTERM2I PIC  X(0003).
  4808*    -------------------------------
  4809     05  CPREM2L PIC S9(0004) COMP.
  4810     05  CPREM2F PIC  X(0001).
  4811     05  FILLER REDEFINES CPREM2F.
  4812         10  CPREM2A PIC  X(0001).
  4813     05  CPREM2I PIC  X(0011).
  4814*    -------------------------------
  4815     05  CENTRDTL PIC S9(0004) COMP.
  4816     05  CENTRDTF PIC  X(0001).
  4817     05  FILLER REDEFINES CENTRDTF.
  4818         10  CENTRDTA PIC  X(0001).
  4819     05  CENTRDTI PIC  X(0008).
  4820*    -------------------------------
  4821     05  CPAYEEL PIC S9(0004) COMP.
  4822     05  CPAYEEF PIC  X(0001).
  4823     05  FILLER REDEFINES CPAYEEF.
  4824         10  CPAYEEA PIC  X(0001).
  4825     05  CPAYEEI PIC  X(0006).
  4826*    -------------------------------
  4827     05  CRFNDSWL PIC S9(0004) COMP.
  4828     05  CRFNDSWF PIC  X(0001).
  4829     05  FILLER REDEFINES CRFNDSWF.
  4830         10  CRFNDSWA PIC  X(0001).
  4831     05  CRFNDSWI PIC  X(0003).
  4832*    -------------------------------
  4833     05  CLFHDGL PIC S9(0004) COMP.
  4834     05  CLFHDGF PIC  X(0001).
  4835     05  FILLER REDEFINES CLFHDGF.
  4836         10  CLFHDGA PIC  X(0001).
  4837     05  CLFHDGI PIC  X(0006).
  4838*    -------------------------------
  4839     05  CAHHDGL PIC S9(0004) COMP.
  4840     05  CAHHDGF PIC  X(0001).
  4841     05  FILLER REDEFINES CAHHDGF.
  4842         10  CAHHDGA PIC  X(0001).
  4843     05  CAHHDGI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  91
* EL6311.cbl
  4844*    -------------------------------
  4845     05  CENTDTL PIC S9(0004) COMP.
  4846     05  CENTDTF PIC  X(0001).
  4847     05  FILLER REDEFINES CENTDTF.
  4848         10  CENTDTA PIC  X(0001).
  4849     05  CENTDTI PIC  X(0008).
  4850*    -------------------------------
  4851     05  CENTBYL PIC S9(0004) COMP.
  4852     05  CENTBYF PIC  X(0001).
  4853     05  FILLER REDEFINES CENTBYF.
  4854         10  CENTBYA PIC  X(0001).
  4855     05  CENTBYI PIC  X(0004).
  4856*    -------------------------------
  4857     05  CCHGCNTL PIC S9(0004) COMP.
  4858     05  CCHGCNTF PIC  X(0001).
  4859     05  FILLER REDEFINES CCHGCNTF.
  4860         10  CCHGCNTA PIC  X(0001).
  4861     05  CCHGCNTI PIC  X(0003).
  4862*    -------------------------------
  4863     05  CLFREFNL PIC S9(0004) COMP.
  4864     05  CLFREFNF PIC  X(0001).
  4865     05  FILLER REDEFINES CLFREFNF.
  4866         10  CLFREFNA PIC  X(0001).
  4867     05  CLFREFNI PIC  X(0006).
  4868*    -------------------------------
  4869     05  CAHREFNL PIC S9(0004) COMP.
  4870     05  CAHREFNF PIC  X(0001).
  4871     05  FILLER REDEFINES CAHREFNF.
  4872         10  CAHREFNA PIC  X(0001).
  4873     05  CAHREFNI PIC  X(0006).
  4874*    -------------------------------
  4875     05  CREINCDL PIC S9(0004) COMP.
  4876     05  CREINCDF PIC  X(0001).
  4877     05  FILLER REDEFINES CREINCDF.
  4878         10  CREINCDA PIC  X(0001).
  4879     05  CREINCDI PIC  X(0003).
  4880*    -------------------------------
  4881     05  CAEFFDTL PIC S9(0004) COMP.
  4882     05  CAEFFDTF PIC  X(0001).
  4883     05  FILLER REDEFINES CAEFFDTF.
  4884         10  CAEFFDTA PIC  X(0001).
  4885     05  CAEFFDTI PIC  X(0008).
  4886*    -------------------------------
  4887     05  CAEXPDTL PIC S9(0004) COMP.
  4888     05  CAEXPDTF PIC  X(0001).
  4889     05  FILLER REDEFINES CAEXPDTF.
  4890         10  CAEXPDTA PIC  X(0001).
  4891     05  CAEXPDTI PIC  X(0008).
  4892*    -------------------------------
  4893     05  COMMLFL PIC S9(0004) COMP.
  4894     05  COMMLFF PIC  X(0001).
  4895     05  FILLER REDEFINES COMMLFF.
  4896         10  COMMLFA PIC  X(0001).
  4897     05  COMMLFI PIC  X(0006).
  4898*    -------------------------------
  4899     05  COMMAHL PIC S9(0004) COMP.
  4900     05  COMMAHF PIC  X(0001).
  4901     05  FILLER REDEFINES COMMAHF.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  92
* EL6311.cbl
  4902         10  COMMAHA PIC  X(0001).
  4903     05  COMMAHI PIC  X(0006).
  4904*    -------------------------------
  4905     05  CERMSG1L PIC S9(0004) COMP.
  4906     05  CERMSG1F PIC  X(0001).
  4907     05  FILLER REDEFINES CERMSG1F.
  4908         10  CERMSG1A PIC  X(0001).
  4909     05  CERMSG1I PIC  X(0078).
  4910*    -------------------------------
  4911     05  CERMSG2L PIC S9(0004) COMP.
  4912     05  CERMSG2F PIC  X(0001).
  4913     05  FILLER REDEFINES CERMSG2F.
  4914         10  CERMSG2A PIC  X(0001).
  4915     05  CERMSG2I PIC  X(0078).
  4916*    -------------------------------
  4917     05  CERMSG3L PIC S9(0004) COMP.
  4918     05  CERMSG3F PIC  X(0001).
  4919     05  FILLER REDEFINES CERMSG3F.
  4920         10  CERMSG3A PIC  X(0001).
  4921     05  CERMSG3I PIC  X(0078).
  4922*    -------------------------------
  4923     05  CPFENTRL PIC S9(0004) COMP.
  4924     05  CPFENTRF PIC  X(0001).
  4925     05  FILLER REDEFINES CPFENTRF.
  4926         10  CPFENTRA PIC  X(0001).
  4927     05  CPFENTRI PIC  9(2).
  4928*    -------------------------------
  4929     05  CPF5HDRL PIC S9(0004) COMP.
  4930     05  CPF5HDRF PIC  X(0001).
  4931     05  FILLER REDEFINES CPF5HDRF.
  4932         10  CPF5HDRA PIC  X(0001).
  4933     05  CPF5HDRI PIC  X(0005).
  4934*    -------------------------------
  4935     05  CPF4HDRL PIC S9(0004) COMP.
  4936     05  CPF4HDRF PIC  X(0001).
  4937     05  FILLER REDEFINES CPF4HDRF.
  4938         10  CPF4HDRA PIC  X(0001).
  4939     05  CPF4HDRI PIC  X(0013).
  4940*    -------------------------------
  4941     05  CF15HDRL PIC S9(0004) COMP.
  4942     05  CF15HDRF PIC  X(0001).
  4943     05  FILLER REDEFINES CF15HDRF.
  4944         10  CF15HDRA PIC  X(0001).
  4945     05  CF15HDRI PIC  X(0022).
  4946 01  EL631CO REDEFINES EL631BI.
  4947     05  FILLER            PIC  X(0012).
  4948*    -------------------------------
  4949     05  FILLER            PIC  X(0003).
  4950     05  CDATEO PIC  X(0008).
  4951*    -------------------------------
  4952     05  FILLER            PIC  X(0003).
  4953     05  CTIMEO PIC  99.99.
  4954*    -------------------------------
  4955     05  FILLER            PIC  X(0003).
  4956     05  CHEADO PIC  X(0038).
  4957*    -------------------------------
  4958     05  FILLER            PIC  X(0003).
  4959     05  CCHGTO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  93
* EL6311.cbl
  4960*    -------------------------------
  4961     05  FILLER            PIC  X(0003).
  4962     05  CCHGO PIC  ZZZ9.
  4963*    -------------------------------
  4964     05  FILLER            PIC  X(0003).
  4965     05  CMAINTO PIC  X(0001).
  4966*    -------------------------------
  4967     05  FILLER            PIC  X(0003).
  4968     05  CMANTBYO PIC  X(0004).
  4969*    -------------------------------
  4970     05  FILLER            PIC  X(0003).
  4971     05  CCHGHDGO PIC  X(0003).
  4972*    -------------------------------
  4973     05  FILLER            PIC  X(0003).
  4974     05  CMANTDTO PIC  X(0008).
  4975*    -------------------------------
  4976     05  FILLER            PIC  X(0003).
  4977     05  CMANTATO PIC  99.99.
  4978*    -------------------------------
  4979     05  FILLER            PIC  X(0003).
  4980     05  CCSRO PIC  X(0004).
  4981*    -------------------------------
  4982     05  FILLER            PIC  X(0003).
  4983     05  CBATCHO PIC  X(0006).
  4984*    -------------------------------
  4985     05  FILLER            PIC  X(0003).
  4986     05  CSEQO PIC  X(0004).
  4987*    -------------------------------
  4988     05  FILLER            PIC  X(0003).
  4989     05  CMOENDTO PIC  X(0008).
  4990*    -------------------------------
  4991     05  FILLER            PIC  X(0003).
  4992     05  CCARRO PIC  X(0001).
  4993*    -------------------------------
  4994     05  FILLER            PIC  X(0003).
  4995     05  CGROUPO PIC  X(0006).
  4996*    -------------------------------
  4997     05  FILLER            PIC  X(0003).
  4998     05  CSTATEO PIC  X(0002).
  4999*    -------------------------------
  5000     05  FILLER            PIC  X(0003).
  5001     05  CACCTO PIC  X(0010).
  5002*    -------------------------------
  5003     05  FILLER            PIC  X(0003).
  5004     05  CORIGHDO PIC  X(0011).
  5005*    -------------------------------
  5006     05  FILLER            PIC  X(0003).
  5007     05  CORGNOO PIC  X(0006).
  5008*    -------------------------------
  5009     05  FILLER            PIC  X(0003).
  5010     05  CORGSEQO PIC  X(0004).
  5011*    -------------------------------
  5012     05  FILLER            PIC  X(0003).
  5013     05  CREFHDGO PIC  X(0010).
  5014*    -------------------------------
  5015     05  FILLER            PIC  X(0003).
  5016     05  CREFO PIC  X(0012).
  5017*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  94
* EL6311.cbl
  5018     05  FILLER            PIC  X(0003).
  5019     05  CNHINTO PIC  ZZZZZ9.99.
  5020*    -------------------------------
  5021     05  FILLER            PIC  X(0003).
  5022     05  CCERTNOO PIC  X(0010).
  5023*    -------------------------------
  5024     05  FILLER            PIC  X(0003).
  5025     05  CSUFIXO PIC  X(0001).
  5026*    -------------------------------
  5027     05  FILLER            PIC  X(0003).
  5028     05  CEFFDTO PIC  X(0008).
  5029*    -------------------------------
  5030     05  FILLER            PIC  X(0003).
  5031     05  CLSTNMO PIC  X(0015).
  5032*    -------------------------------
  5033     05  FILLER            PIC  X(0003).
  5034     05  CINAMEO PIC  X(0015).
  5035*    -------------------------------
  5036     05  FILLER            PIC  X(0003).
  5037     05  CINITSO PIC  X(0010).
  5038*    -------------------------------
  5039     05  FILLER            PIC  X(0003).
  5040     05  CCANREAO PIC  X(0001).
  5041*    -------------------------------
  5042     05  FILLER            PIC  X(0003).
  5043     05  ACTSPCO PIC  X(0001).
  5044*    -------------------------------
  5045     05  FILLER            PIC  X(0003).
  5046     05  CKIND1O PIC  X(0002).
  5047*    -------------------------------
  5048     05  FILLER            PIC  X(0003).
  5049     05  CCANDT1O PIC  X(0008).
  5050*    -------------------------------
  5051     05  FILLER            PIC  X(0003).
  5052     05  CREFND1O PIC  Z(7).99-.
  5053*    -------------------------------
  5054     05  FILLER            PIC  X(0003).
  5055     05  CMTHD1O PIC  X(0001).
  5056*    -------------------------------
  5057     05  FILLER            PIC  X(0003).
  5058     05  CKIND2O PIC  X(0002).
  5059*    -------------------------------
  5060     05  FILLER            PIC  X(0003).
  5061     05  CCANDT2O PIC  X(0008).
  5062*    -------------------------------
  5063     05  FILLER            PIC  X(0003).
  5064     05  CREFND2O PIC  Z(7).99-.
  5065*    -------------------------------
  5066     05  FILLER            PIC  X(0003).
  5067     05  CMTHD2O PIC  X(0001).
  5068*    -------------------------------
  5069     05  FILLER            PIC  X(0003).
  5070     05  CLIVESO PIC  X(0003).
  5071*    -------------------------------
  5072     05  FILLER            PIC  X(0003).
  5073     05  CFORCEO PIC  X(0001).
  5074*    -------------------------------
  5075     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  95
* EL6311.cbl
  5076     05  CBILCDO PIC  X(0001).
  5077*    -------------------------------
  5078     05  FILLER            PIC  X(0003).
  5079     05  CCRFND1O PIC  Z(7).99-.
  5080*    -------------------------------
  5081     05  FILLER            PIC  X(0003).
  5082     05  CCRFND2O PIC  Z(7).99-.
  5083*    -------------------------------
  5084     05  FILLER            PIC  X(0003).
  5085     05  CBILIT1O PIC  X(0008).
  5086*    -------------------------------
  5087     05  FILLER            PIC  X(0003).
  5088     05  CDRFND1O PIC  Z(7).99-.
  5089*    -------------------------------
  5090     05  FILLER            PIC  X(0003).
  5091     05  CBILIT2O PIC  X(0008).
  5092*    -------------------------------
  5093     05  FILLER            PIC  X(0003).
  5094     05  CDRFND2O PIC  Z(7).99-.
  5095*    -------------------------------
  5096     05  FILLER            PIC  X(0003).
  5097     05  CCANTXTO PIC  X(0005).
  5098*    -------------------------------
  5099     05  FILLER            PIC  X(0003).
  5100     05  CCANFEEO PIC  Z9.
  5101*    -------------------------------
  5102     05  FILLER            PIC  X(0003).
  5103     05  CTERM1O PIC  ZZ9.
  5104*    -------------------------------
  5105     05  FILLER            PIC  X(0003).
  5106     05  CRTERM1O PIC  ZZ9.
  5107*    -------------------------------
  5108     05  FILLER            PIC  X(0003).
  5109     05  CPREM1O PIC  ZZZZZZ9.99-.
  5110*    -------------------------------
  5111     05  FILLER            PIC  X(0003).
  5112     05  CTERM2O PIC  ZZ9.
  5113*    -------------------------------
  5114     05  FILLER            PIC  X(0003).
  5115     05  CRTERM2O PIC  ZZ9.
  5116*    -------------------------------
  5117     05  FILLER            PIC  X(0003).
  5118     05  CPREM2O PIC  ZZZZZZ9.99-.
  5119*    -------------------------------
  5120     05  FILLER            PIC  X(0003).
  5121     05  CENTRDTO PIC  X(0008).
  5122*    -------------------------------
  5123     05  FILLER            PIC  X(0003).
  5124     05  CPAYEEO PIC  X(0006).
  5125*    -------------------------------
  5126     05  FILLER            PIC  X(0003).
  5127     05  CRFNDSWO PIC  X(0003).
  5128*    -------------------------------
  5129     05  FILLER            PIC  X(0003).
  5130     05  CLFHDGO PIC  X(0006).
  5131*    -------------------------------
  5132     05  FILLER            PIC  X(0003).
  5133     05  CAHHDGO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  96
* EL6311.cbl
  5134*    -------------------------------
  5135     05  FILLER            PIC  X(0003).
  5136     05  CENTDTO PIC  X(0008).
  5137*    -------------------------------
  5138     05  FILLER            PIC  X(0003).
  5139     05  CENTBYO PIC  X(0004).
  5140*    -------------------------------
  5141     05  FILLER            PIC  X(0003).
  5142     05  CCHGCNTO PIC  X(0003).
  5143*    -------------------------------
  5144     05  FILLER            PIC  X(0003).
  5145     05  CLFREFNO PIC  X(0006).
  5146*    -------------------------------
  5147     05  FILLER            PIC  X(0003).
  5148     05  CAHREFNO PIC  X(0006).
  5149*    -------------------------------
  5150     05  FILLER            PIC  X(0003).
  5151     05  CREINCDO PIC  X(0003).
  5152*    -------------------------------
  5153     05  FILLER            PIC  X(0003).
  5154     05  CAEFFDTO PIC  X(0008).
  5155*    -------------------------------
  5156     05  FILLER            PIC  X(0003).
  5157     05  CAEXPDTO PIC  X(0008).
  5158*    -------------------------------
  5159     05  FILLER            PIC  X(0003).
  5160     05  COMMLFO PIC  .99999.
  5161*    -------------------------------
  5162     05  FILLER            PIC  X(0003).
  5163     05  COMMAHO PIC  .99999.
  5164*    -------------------------------
  5165     05  FILLER            PIC  X(0003).
  5166     05  CERMSG1O PIC  X(0078).
  5167*    -------------------------------
  5168     05  FILLER            PIC  X(0003).
  5169     05  CERMSG2O PIC  X(0078).
  5170*    -------------------------------
  5171     05  FILLER            PIC  X(0003).
  5172     05  CERMSG3O PIC  X(0078).
  5173*    -------------------------------
  5174     05  FILLER            PIC  X(0003).
  5175     05  CPFENTRO PIC  X(0002).
  5176*    -------------------------------
  5177     05  FILLER            PIC  X(0003).
  5178     05  CPF5HDRO PIC  X(0005).
  5179*    -------------------------------
  5180     05  FILLER            PIC  X(0003).
  5181     05  CPF4HDRO PIC  X(0013).
  5182*    -------------------------------
  5183     05  FILLER            PIC  X(0003).
  5184     05  CF15HDRO PIC  X(0022).
  5185*    -------------------------------
  5186 01  EL631DI REDEFINES EL631BI.
  5187     05  FILLER            PIC  X(0012).
  5188*    -------------------------------
  5189     05  DDATEL PIC S9(0004) COMP.
  5190     05  DDATEF PIC  X(0001).
  5191     05  FILLER REDEFINES DDATEF.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  97
* EL6311.cbl
  5192         10  DDATEA PIC  X(0001).
  5193     05  DDATEI PIC  X(0008).
  5194*    -------------------------------
  5195     05  DTIMEL PIC S9(0004) COMP.
  5196     05  DTIMEF PIC  X(0001).
  5197     05  FILLER REDEFINES DTIMEF.
  5198         10  DTIMEA PIC  X(0001).
  5199     05  DTIMEI PIC  X(0005).
  5200*    -------------------------------
  5201     05  DHEADL PIC S9(0004) COMP.
  5202     05  DHEADF PIC  X(0001).
  5203     05  FILLER REDEFINES DHEADF.
  5204         10  DHEADA PIC  X(0001).
  5205     05  DHEADI PIC  X(0038).
  5206*    -------------------------------
  5207     05  DLDATEL PIC S9(0004) COMP.
  5208     05  DLDATEF PIC  X(0001).
  5209     05  FILLER REDEFINES DLDATEF.
  5210         10  DLDATEA PIC  X(0001).
  5211     05  DLDATEI PIC  X(0010).
  5212*    -------------------------------
  5213     05  DBATCHL PIC S9(0004) COMP.
  5214     05  DBATCHF PIC  X(0001).
  5215     05  FILLER REDEFINES DBATCHF.
  5216         10  DBATCHA PIC  X(0001).
  5217     05  DBATCHI PIC  X(0011).
  5218*    -------------------------------
  5219     05  DACCTNML PIC S9(0004) COMP.
  5220     05  DACCTNMF PIC  X(0001).
  5221     05  FILLER REDEFINES DACCTNMF.
  5222         10  DACCTNMA PIC  X(0001).
  5223     05  DACCTNMI PIC  X(0030).
  5224*    -------------------------------
  5225     05  DPROCDTL PIC S9(0004) COMP.
  5226     05  DPROCDTF PIC  X(0001).
  5227     05  FILLER REDEFINES DPROCDTF.
  5228         10  DPROCDTA PIC  X(0001).
  5229     05  DPROCDTI PIC  X(0008).
  5230*    -------------------------------
  5231     05  DINPUTL PIC S9(0004) COMP.
  5232     05  DINPUTF PIC  X(0001).
  5233     05  FILLER REDEFINES DINPUTF.
  5234         10  DINPUTA PIC  X(0001).
  5235     05  DINPUTI PIC  X(0008).
  5236*    -------------------------------
  5237     05  DMAINDTL PIC S9(0004) COMP.
  5238     05  DMAINDTF PIC  X(0001).
  5239     05  FILLER REDEFINES DMAINDTF.
  5240         10  DMAINDTA PIC  X(0001).
  5241     05  DMAINDTI PIC  X(0008).
  5242*    -------------------------------
  5243     05  DCARRL PIC S9(0004) COMP.
  5244     05  DCARRF PIC  X(0001).
  5245     05  FILLER REDEFINES DCARRF.
  5246         10  DCARRA PIC  X(0001).
  5247     05  DCARRI PIC  X(0001).
  5248*    -------------------------------
  5249     05  DGROUPL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  98
* EL6311.cbl
  5250     05  DGROUPF PIC  X(0001).
  5251     05  FILLER REDEFINES DGROUPF.
  5252         10  DGROUPA PIC  X(0001).
  5253     05  DGROUPI PIC  X(0006).
  5254*    -------------------------------
  5255     05  DSTATEL PIC S9(0004) COMP.
  5256     05  DSTATEF PIC  X(0001).
  5257     05  FILLER REDEFINES DSTATEF.
  5258         10  DSTATEA PIC  X(0001).
  5259     05  DSTATEI PIC  X(0002).
  5260*    -------------------------------
  5261     05  DACCTL PIC S9(0004) COMP.
  5262     05  DACCTF PIC  X(0001).
  5263     05  FILLER REDEFINES DACCTF.
  5264         10  DACCTA PIC  X(0001).
  5265     05  DACCTI PIC  X(0010).
  5266*    -------------------------------
  5267     05  DRECVDTL PIC S9(0004) COMP.
  5268     05  DRECVDTF PIC  X(0001).
  5269     05  FILLER REDEFINES DRECVDTF.
  5270         10  DRECVDTA PIC  X(0001).
  5271     05  DRECVDTI PIC  X(0008).
  5272*    -------------------------------
  5273     05  DCSRL PIC S9(0004) COMP.
  5274     05  DCSRF PIC  X(0001).
  5275     05  FILLER REDEFINES DCSRF.
  5276         10  DCSRA PIC  X(0001).
  5277     05  DCSRI PIC  X(0004).
  5278*    -------------------------------
  5279     05  DREFHDGL PIC S9(0004) COMP.
  5280     05  DREFHDGF PIC  X(0001).
  5281     05  FILLER REDEFINES DREFHDGF.
  5282         10  DREFHDGA PIC  X(0001).
  5283     05  DREFHDGI PIC  X(0010).
  5284*    -------------------------------
  5285     05  DREFL PIC S9(0004) COMP.
  5286     05  DREFF PIC  X(0001).
  5287     05  FILLER REDEFINES DREFF.
  5288         10  DREFA PIC  X(0001).
  5289     05  DREFI PIC  X(0012).
  5290*    -------------------------------
  5291     05  DLFPHDGL PIC S9(0004) COMP.
  5292     05  DLFPHDGF PIC  X(0001).
  5293     05  FILLER REDEFINES DLFPHDGF.
  5294         10  DLFPHDGA PIC  X(0001).
  5295     05  DLFPHDGI PIC  X(0010).
  5296*    -------------------------------
  5297     05  DAHPHDGL PIC S9(0004) COMP.
  5298     05  DAHPHDGF PIC  X(0001).
  5299     05  FILLER REDEFINES DAHPHDGF.
  5300         10  DAHPHDGA PIC  X(0001).
  5301     05  DAHPHDGI PIC  X(0010).
  5302*    -------------------------------
  5303     05  DLFRHDGL PIC S9(0004) COMP.
  5304     05  DLFRHDGF PIC  X(0001).
  5305     05  FILLER REDEFINES DLFRHDGF.
  5306         10  DLFRHDGA PIC  X(0001).
  5307     05  DLFRHDGI PIC  X(0009).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page  99
* EL6311.cbl
  5308*    -------------------------------
  5309     05  DAHRHDGL PIC S9(0004) COMP.
  5310     05  DAHRHDGF PIC  X(0001).
  5311     05  FILLER REDEFINES DAHRHDGF.
  5312         10  DAHRHDGA PIC  X(0001).
  5313     05  DAHRHDGI PIC  X(0009).
  5314*    -------------------------------
  5315     05  DRISSL PIC S9(0004) COMP.
  5316     05  DRISSF PIC  X(0001).
  5317     05  FILLER REDEFINES DRISSF.
  5318         10  DRISSA PIC  X(0001).
  5319     05  DRISSI PIC  X(0005).
  5320*    -------------------------------
  5321     05  DRLFPRML PIC S9(0004) COMP.
  5322     05  DRLFPRMF PIC  X(0001).
  5323     05  FILLER REDEFINES DRLFPRMF.
  5324         10  DRLFPRMA PIC  X(0001).
  5325     05  DRLFPRMI PIC  S9(9)V99.
  5326*    -------------------------------
  5327     05  DRAHPRML PIC S9(0004) COMP.
  5328     05  DRAHPRMF PIC  X(0001).
  5329     05  FILLER REDEFINES DRAHPRMF.
  5330         10  DRAHPRMA PIC  X(0001).
  5331     05  DRAHPRMI PIC  S9(9)V99.
  5332*    -------------------------------
  5333     05  DRCANCL PIC S9(0004) COMP.
  5334     05  DRCANCF PIC  X(0001).
  5335     05  FILLER REDEFINES DRCANCF.
  5336         10  DRCANCA PIC  X(0001).
  5337     05  DRCANCI PIC  X(0005).
  5338*    -------------------------------
  5339     05  DRLFRFDL PIC S9(0004) COMP.
  5340     05  DRLFRFDF PIC  X(0001).
  5341     05  FILLER REDEFINES DRLFRFDF.
  5342         10  DRLFRFDA PIC  X(0001).
  5343     05  DRLFRFDI PIC  S9(9)V99.
  5344*    -------------------------------
  5345     05  DRAHRFDL PIC S9(0004) COMP.
  5346     05  DRAHRFDF PIC  X(0001).
  5347     05  FILLER REDEFINES DRAHRFDF.
  5348         10  DRAHRFDA PIC  X(0001).
  5349     05  DRAHRFDI PIC  S9(9)V99.
  5350*    -------------------------------
  5351     05  DEISSL PIC S9(0004) COMP.
  5352     05  DEISSF PIC  X(0001).
  5353     05  FILLER REDEFINES DEISSF.
  5354         10  DEISSA PIC  X(0001).
  5355     05  DEISSI PIC  X(0005).
  5356*    -------------------------------
  5357     05  DELFPRML PIC S9(0004) COMP.
  5358     05  DELFPRMF PIC  X(0001).
  5359     05  FILLER REDEFINES DELFPRMF.
  5360         10  DELFPRMA PIC  X(0001).
  5361     05  DELFPRMI PIC  X(0011).
  5362*    -------------------------------
  5363     05  DEAHPRML PIC S9(0004) COMP.
  5364     05  DEAHPRMF PIC  X(0001).
  5365     05  FILLER REDEFINES DEAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 100
* EL6311.cbl
  5366         10  DEAHPRMA PIC  X(0001).
  5367     05  DEAHPRMI PIC  X(0011).
  5368*    -------------------------------
  5369     05  DECANCL PIC S9(0004) COMP.
  5370     05  DECANCF PIC  X(0001).
  5371     05  FILLER REDEFINES DECANCF.
  5372         10  DECANCA PIC  X(0001).
  5373     05  DECANCI PIC  X(0005).
  5374*    -------------------------------
  5375     05  DELFRFDL PIC S9(0004) COMP.
  5376     05  DELFRFDF PIC  X(0001).
  5377     05  FILLER REDEFINES DELFRFDF.
  5378         10  DELFRFDA PIC  X(0001).
  5379     05  DELFRFDI PIC  X(0011).
  5380*    -------------------------------
  5381     05  DEAHRFDL PIC S9(0004) COMP.
  5382     05  DEAHRFDF PIC  X(0001).
  5383     05  FILLER REDEFINES DEAHRFDF.
  5384         10  DEAHRFDA PIC  X(0001).
  5385     05  DEAHRFDI PIC  X(0011).
  5386*    -------------------------------
  5387     05  DCISSL PIC S9(0004) COMP.
  5388     05  DCISSF PIC  X(0001).
  5389     05  FILLER REDEFINES DCISSF.
  5390         10  DCISSA PIC  X(0001).
  5391     05  DCISSI PIC  X(0005).
  5392*    -------------------------------
  5393     05  DCLFPRML PIC S9(0004) COMP.
  5394     05  DCLFPRMF PIC  X(0001).
  5395     05  FILLER REDEFINES DCLFPRMF.
  5396         10  DCLFPRMA PIC  X(0001).
  5397     05  DCLFPRMI PIC  X(0011).
  5398*    -------------------------------
  5399     05  DCAHPRML PIC S9(0004) COMP.
  5400     05  DCAHPRMF PIC  X(0001).
  5401     05  FILLER REDEFINES DCAHPRMF.
  5402         10  DCAHPRMA PIC  X(0001).
  5403     05  DCAHPRMI PIC  X(0011).
  5404*    -------------------------------
  5405     05  DCCANCL PIC S9(0004) COMP.
  5406     05  DCCANCF PIC  X(0001).
  5407     05  FILLER REDEFINES DCCANCF.
  5408         10  DCCANCA PIC  X(0001).
  5409     05  DCCANCI PIC  X(0005).
  5410*    -------------------------------
  5411     05  DCLFRFDL PIC S9(0004) COMP.
  5412     05  DCLFRFDF PIC  X(0001).
  5413     05  FILLER REDEFINES DCLFRFDF.
  5414         10  DCLFRFDA PIC  X(0001).
  5415     05  DCLFRFDI PIC  X(0011).
  5416*    -------------------------------
  5417     05  DCAHRFDL PIC S9(0004) COMP.
  5418     05  DCAHRFDF PIC  X(0001).
  5419     05  FILLER REDEFINES DCAHRFDF.
  5420         10  DCAHRFDA PIC  X(0001).
  5421     05  DCAHRFDI PIC  X(0011).
  5422*    -------------------------------
  5423     05  DOISSL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 101
* EL6311.cbl
  5424     05  DOISSF PIC  X(0001).
  5425     05  FILLER REDEFINES DOISSF.
  5426         10  DOISSA PIC  X(0001).
  5427     05  DOISSI PIC  X(0005).
  5428*    -------------------------------
  5429     05  DOLFPRML PIC S9(0004) COMP.
  5430     05  DOLFPRMF PIC  X(0001).
  5431     05  FILLER REDEFINES DOLFPRMF.
  5432         10  DOLFPRMA PIC  X(0001).
  5433     05  DOLFPRMI PIC  X(0011).
  5434*    -------------------------------
  5435     05  DOAHPRML PIC S9(0004) COMP.
  5436     05  DOAHPRMF PIC  X(0001).
  5437     05  FILLER REDEFINES DOAHPRMF.
  5438         10  DOAHPRMA PIC  X(0001).
  5439     05  DOAHPRMI PIC  X(0011).
  5440*    -------------------------------
  5441     05  DOCANCL PIC S9(0004) COMP.
  5442     05  DOCANCF PIC  X(0001).
  5443     05  FILLER REDEFINES DOCANCF.
  5444         10  DOCANCA PIC  X(0001).
  5445     05  DOCANCI PIC  X(0005).
  5446*    -------------------------------
  5447     05  DOLFRFDL PIC S9(0004) COMP.
  5448     05  DOLFRFDF PIC  X(0001).
  5449     05  FILLER REDEFINES DOLFRFDF.
  5450         10  DOLFRFDA PIC  X(0001).
  5451     05  DOLFRFDI PIC  X(0011).
  5452*    -------------------------------
  5453     05  DOAHRFDL PIC S9(0004) COMP.
  5454     05  DOAHRFDF PIC  X(0001).
  5455     05  FILLER REDEFINES DOAHRFDF.
  5456         10  DOAHRFDA PIC  X(0001).
  5457     05  DOAHRFDI PIC  X(0011).
  5458*    -------------------------------
  5459     05  DITOTALL PIC S9(0004) COMP.
  5460     05  DITOTALF PIC  X(0001).
  5461     05  FILLER REDEFINES DITOTALF.
  5462         10  DITOTALA PIC  X(0001).
  5463     05  DITOTALI PIC  X(0005).
  5464*    -------------------------------
  5465     05  DIFATALL PIC S9(0004) COMP.
  5466     05  DIFATALF PIC  X(0001).
  5467     05  FILLER REDEFINES DIFATALF.
  5468         10  DIFATALA PIC  X(0001).
  5469     05  DIFATALI PIC  X(0005).
  5470*    -------------------------------
  5471     05  DIFORCEL PIC S9(0004) COMP.
  5472     05  DIFORCEF PIC  X(0001).
  5473     05  FILLER REDEFINES DIFORCEF.
  5474         10  DIFORCEA PIC  X(0001).
  5475     05  DIFORCEI PIC  X(0005).
  5476*    -------------------------------
  5477     05  DIHOLDL PIC S9(0004) COMP.
  5478     05  DIHOLDF PIC  X(0001).
  5479     05  FILLER REDEFINES DIHOLDF.
  5480         10  DIHOLDA PIC  X(0001).
  5481     05  DIHOLDI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 102
* EL6311.cbl
  5482*    -------------------------------
  5483     05  DIAVAILL PIC S9(0004) COMP.
  5484     05  DIAVAILF PIC  X(0001).
  5485     05  FILLER REDEFINES DIAVAILF.
  5486         10  DIAVAILA PIC  X(0001).
  5487     05  DIAVAILI PIC  X(0005).
  5488*    -------------------------------
  5489     05  DIGPREML PIC S9(0004) COMP.
  5490     05  DIGPREMF PIC  X(0001).
  5491     05  FILLER REDEFINES DIGPREMF.
  5492         10  DIGPREMA PIC  X(0001).
  5493     05  DIGPREMI PIC  X(0011).
  5494*    -------------------------------
  5495     05  DIBPREML PIC S9(0004) COMP.
  5496     05  DIBPREMF PIC  X(0001).
  5497     05  FILLER REDEFINES DIBPREMF.
  5498         10  DIBPREMA PIC  X(0001).
  5499     05  DIBPREMI PIC  X(0011).
  5500*    -------------------------------
  5501     05  DCTOTALL PIC S9(0004) COMP.
  5502     05  DCTOTALF PIC  X(0001).
  5503     05  FILLER REDEFINES DCTOTALF.
  5504         10  DCTOTALA PIC  X(0001).
  5505     05  DCTOTALI PIC  X(0005).
  5506*    -------------------------------
  5507     05  DCFATALL PIC S9(0004) COMP.
  5508     05  DCFATALF PIC  X(0001).
  5509     05  FILLER REDEFINES DCFATALF.
  5510         10  DCFATALA PIC  X(0001).
  5511     05  DCFATALI PIC  X(0005).
  5512*    -------------------------------
  5513     05  DCFORCEL PIC S9(0004) COMP.
  5514     05  DCFORCEF PIC  X(0001).
  5515     05  FILLER REDEFINES DCFORCEF.
  5516         10  DCFORCEA PIC  X(0001).
  5517     05  DCFORCEI PIC  X(0005).
  5518*    -------------------------------
  5519     05  DCHOLDL PIC S9(0004) COMP.
  5520     05  DCHOLDF PIC  X(0001).
  5521     05  FILLER REDEFINES DCHOLDF.
  5522         10  DCHOLDA PIC  X(0001).
  5523     05  DCHOLDI PIC  X(0005).
  5524*    -------------------------------
  5525     05  DCAVAILL PIC S9(0004) COMP.
  5526     05  DCAVAILF PIC  X(0001).
  5527     05  FILLER REDEFINES DCAVAILF.
  5528         10  DCAVAILA PIC  X(0001).
  5529     05  DCAVAILI PIC  X(0005).
  5530*    -------------------------------
  5531     05  DCGPREML PIC S9(0004) COMP.
  5532     05  DCGPREMF PIC  X(0001).
  5533     05  FILLER REDEFINES DCGPREMF.
  5534         10  DCGPREMA PIC  X(0001).
  5535     05  DCGPREMI PIC  X(0011).
  5536*    -------------------------------
  5537     05  DCBPREML PIC S9(0004) COMP.
  5538     05  DCBPREMF PIC  X(0001).
  5539     05  FILLER REDEFINES DCBPREMF.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 103
* EL6311.cbl
  5540         10  DCBPREMA PIC  X(0001).
  5541     05  DCBPREMI PIC  X(0011).
  5542*    -------------------------------
  5543     05  DNTOTALL PIC S9(0004) COMP.
  5544     05  DNTOTALF PIC  X(0001).
  5545     05  FILLER REDEFINES DNTOTALF.
  5546         10  DNTOTALA PIC  X(0001).
  5547     05  DNTOTALI PIC  X(0005).
  5548*    -------------------------------
  5549     05  DNFATALL PIC S9(0004) COMP.
  5550     05  DNFATALF PIC  X(0001).
  5551     05  FILLER REDEFINES DNFATALF.
  5552         10  DNFATALA PIC  X(0001).
  5553     05  DNFATALI PIC  X(0005).
  5554*    -------------------------------
  5555     05  DNFORCEL PIC S9(0004) COMP.
  5556     05  DNFORCEF PIC  X(0001).
  5557     05  FILLER REDEFINES DNFORCEF.
  5558         10  DNFORCEA PIC  X(0001).
  5559     05  DNFORCEI PIC  X(0005).
  5560*    -------------------------------
  5561     05  DNHOLDL PIC S9(0004) COMP.
  5562     05  DNHOLDF PIC  X(0001).
  5563     05  FILLER REDEFINES DNHOLDF.
  5564         10  DNHOLDA PIC  X(0001).
  5565     05  DNHOLDI PIC  X(0005).
  5566*    -------------------------------
  5567     05  DNAVAILL PIC S9(0004) COMP.
  5568     05  DNAVAILF PIC  X(0001).
  5569     05  FILLER REDEFINES DNAVAILF.
  5570         10  DNAVAILA PIC  X(0001).
  5571     05  DNAVAILI PIC  X(0005).
  5572*    -------------------------------
  5573     05  DNGPREML PIC S9(0004) COMP.
  5574     05  DNGPREMF PIC  X(0001).
  5575     05  FILLER REDEFINES DNGPREMF.
  5576         10  DNGPREMA PIC  X(0001).
  5577     05  DNGPREMI PIC  X(0011).
  5578*    -------------------------------
  5579     05  DNBPREML PIC S9(0004) COMP.
  5580     05  DNBPREMF PIC  X(0001).
  5581     05  FILLER REDEFINES DNBPREMF.
  5582         10  DNBPREMA PIC  X(0001).
  5583     05  DNBPREMI PIC  X(0011).
  5584*    -------------------------------
  5585     05  DERMSGL PIC S9(0004) COMP.
  5586     05  DERMSGF PIC  X(0001).
  5587     05  FILLER REDEFINES DERMSGF.
  5588         10  DERMSGA PIC  X(0001).
  5589     05  DERMSGI PIC  X(0075).
  5590*    -------------------------------
  5591     05  DPFENTRL PIC S9(0004) COMP.
  5592     05  DPFENTRF PIC  X(0001).
  5593     05  FILLER REDEFINES DPFENTRF.
  5594         10  DPFENTRA PIC  X(0001).
  5595     05  DPFENTRI PIC  9(2).
  5596 01  EL631DO REDEFINES EL631BI.
  5597     05  FILLER            PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 104
* EL6311.cbl
  5598*    -------------------------------
  5599     05  FILLER            PIC  X(0003).
  5600     05  DDATEO PIC  X(0008).
  5601*    -------------------------------
  5602     05  FILLER            PIC  X(0003).
  5603     05  DTIMEO PIC  99.99.
  5604*    -------------------------------
  5605     05  FILLER            PIC  X(0003).
  5606     05  DHEADO PIC  X(0038).
  5607*    -------------------------------
  5608     05  FILLER            PIC  X(0003).
  5609     05  DLDATEO PIC  X(0010).
  5610*    -------------------------------
  5611     05  FILLER            PIC  X(0003).
  5612     05  DBATCHO PIC  X(0011).
  5613*    -------------------------------
  5614     05  FILLER            PIC  X(0003).
  5615     05  DACCTNMO PIC  X(0030).
  5616*    -------------------------------
  5617     05  FILLER            PIC  X(0003).
  5618     05  DPROCDTO PIC  X(0008).
  5619*    -------------------------------
  5620     05  FILLER            PIC  X(0003).
  5621     05  DINPUTO PIC  X(0008).
  5622*    -------------------------------
  5623     05  FILLER            PIC  X(0003).
  5624     05  DMAINDTO PIC  X(0008).
  5625*    -------------------------------
  5626     05  FILLER            PIC  X(0003).
  5627     05  DCARRO PIC  X(0001).
  5628*    -------------------------------
  5629     05  FILLER            PIC  X(0003).
  5630     05  DGROUPO PIC  X(0006).
  5631*    -------------------------------
  5632     05  FILLER            PIC  X(0003).
  5633     05  DSTATEO PIC  X(0002).
  5634*    -------------------------------
  5635     05  FILLER            PIC  X(0003).
  5636     05  DACCTO PIC  X(0010).
  5637*    -------------------------------
  5638     05  FILLER            PIC  X(0003).
  5639     05  DRECVDTO PIC  X(0008).
  5640*    -------------------------------
  5641     05  FILLER            PIC  X(0003).
  5642     05  DCSRO PIC  X(0004).
  5643*    -------------------------------
  5644     05  FILLER            PIC  X(0003).
  5645     05  DREFHDGO PIC  X(0010).
  5646*    -------------------------------
  5647     05  FILLER            PIC  X(0003).
  5648     05  DREFO PIC  X(0012).
  5649*    -------------------------------
  5650     05  FILLER            PIC  X(0003).
  5651     05  DLFPHDGO PIC  X(0010).
  5652*    -------------------------------
  5653     05  FILLER            PIC  X(0003).
  5654     05  DAHPHDGO PIC  X(0010).
  5655*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 105
* EL6311.cbl
  5656     05  FILLER            PIC  X(0003).
  5657     05  DLFRHDGO PIC  X(0009).
  5658*    -------------------------------
  5659     05  FILLER            PIC  X(0003).
  5660     05  DAHRHDGO PIC  X(0009).
  5661*    -------------------------------
  5662     05  FILLER            PIC  X(0003).
  5663     05  DRISSO PIC  ZZ99-.
  5664*    -------------------------------
  5665     05  FILLER            PIC  X(0003).
  5666     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5667*    -------------------------------
  5668     05  FILLER            PIC  X(0003).
  5669     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5670*    -------------------------------
  5671     05  FILLER            PIC  X(0003).
  5672     05  DRCANCO PIC  ZZ99-.
  5673*    -------------------------------
  5674     05  FILLER            PIC  X(0003).
  5675     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5676*    -------------------------------
  5677     05  FILLER            PIC  X(0003).
  5678     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5679*    -------------------------------
  5680     05  FILLER            PIC  X(0003).
  5681     05  DEISSO PIC  ZZ99-.
  5682*    -------------------------------
  5683     05  FILLER            PIC  X(0003).
  5684     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5685*    -------------------------------
  5686     05  FILLER            PIC  X(0003).
  5687     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5688*    -------------------------------
  5689     05  FILLER            PIC  X(0003).
  5690     05  DECANCO PIC  ZZ99-.
  5691*    -------------------------------
  5692     05  FILLER            PIC  X(0003).
  5693     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5694*    -------------------------------
  5695     05  FILLER            PIC  X(0003).
  5696     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5697*    -------------------------------
  5698     05  FILLER            PIC  X(0003).
  5699     05  DCISSO PIC  ZZ99-.
  5700*    -------------------------------
  5701     05  FILLER            PIC  X(0003).
  5702     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5703*    -------------------------------
  5704     05  FILLER            PIC  X(0003).
  5705     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5706*    -------------------------------
  5707     05  FILLER            PIC  X(0003).
  5708     05  DCCANCO PIC  ZZ99-.
  5709*    -------------------------------
  5710     05  FILLER            PIC  X(0003).
  5711     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5712*    -------------------------------
  5713     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 106
* EL6311.cbl
  5714     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5715*    -------------------------------
  5716     05  FILLER            PIC  X(0003).
  5717     05  DOISSO PIC  ZZ99-.
  5718*    -------------------------------
  5719     05  FILLER            PIC  X(0003).
  5720     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5721*    -------------------------------
  5722     05  FILLER            PIC  X(0003).
  5723     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5724*    -------------------------------
  5725     05  FILLER            PIC  X(0003).
  5726     05  DOCANCO PIC  ZZ99-.
  5727*    -------------------------------
  5728     05  FILLER            PIC  X(0003).
  5729     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5730*    -------------------------------
  5731     05  FILLER            PIC  X(0003).
  5732     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5733*    -------------------------------
  5734     05  FILLER            PIC  X(0003).
  5735     05  DITOTALO PIC  ZZZ99.
  5736*    -------------------------------
  5737     05  FILLER            PIC  X(0003).
  5738     05  DIFATALO PIC  ZZZ99.
  5739*    -------------------------------
  5740     05  FILLER            PIC  X(0003).
  5741     05  DIFORCEO PIC  ZZZ99.
  5742*    -------------------------------
  5743     05  FILLER            PIC  X(0003).
  5744     05  DIHOLDO PIC  ZZZ99.
  5745*    -------------------------------
  5746     05  FILLER            PIC  X(0003).
  5747     05  DIAVAILO PIC  ZZZ99.
  5748*    -------------------------------
  5749     05  FILLER            PIC  X(0003).
  5750     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5751*    -------------------------------
  5752     05  FILLER            PIC  X(0003).
  5753     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5754*    -------------------------------
  5755     05  FILLER            PIC  X(0003).
  5756     05  DCTOTALO PIC  ZZZ99.
  5757*    -------------------------------
  5758     05  FILLER            PIC  X(0003).
  5759     05  DCFATALO PIC  ZZZ99.
  5760*    -------------------------------
  5761     05  FILLER            PIC  X(0003).
  5762     05  DCFORCEO PIC  ZZZ99.
  5763*    -------------------------------
  5764     05  FILLER            PIC  X(0003).
  5765     05  DCHOLDO PIC  ZZZ99.
  5766*    -------------------------------
  5767     05  FILLER            PIC  X(0003).
  5768     05  DCAVAILO PIC  ZZZ99.
  5769*    -------------------------------
  5770     05  FILLER            PIC  X(0003).
  5771     05  DCGPREMO PIC  ZZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 107
* EL6311.cbl
  5772*    -------------------------------
  5773     05  FILLER            PIC  X(0003).
  5774     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5775*    -------------------------------
  5776     05  FILLER            PIC  X(0003).
  5777     05  DNTOTALO PIC  ---99.
  5778*    -------------------------------
  5779     05  FILLER            PIC  X(0003).
  5780     05  DNFATALO PIC  ---99.
  5781*    -------------------------------
  5782     05  FILLER            PIC  X(0003).
  5783     05  DNFORCEO PIC  ---99.
  5784*    -------------------------------
  5785     05  FILLER            PIC  X(0003).
  5786     05  DNHOLDO PIC  ---99.
  5787*    -------------------------------
  5788     05  FILLER            PIC  X(0003).
  5789     05  DNAVAILO PIC  ---99.
  5790*    -------------------------------
  5791     05  FILLER            PIC  X(0003).
  5792     05  DNGPREMO PIC  -------9.99.
  5793*    -------------------------------
  5794     05  FILLER            PIC  X(0003).
  5795     05  DNBPREMO PIC  -------9.99.
  5796*    -------------------------------
  5797     05  FILLER            PIC  X(0003).
  5798     05  DERMSGO PIC  X(0075).
  5799*    -------------------------------
  5800     05  FILLER            PIC  X(0003).
  5801     05  DPFENTRO PIC  X(0002).
  5802*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 108
* EL6311.cbl
  5804 01  MAP-B REDEFINES EL631BI.
  5805     12  FILLER                  PIC X(595).
  5806*    12  FILLER                  PIC X(591).
  5807*    12  FILLER                  PIC X(512).
  5808*    12  FILLER                  PIC X(510).
  5809     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5810         16  BKIND-LEN               PIC S9(4)  COMP.
  5811         16  BKIND-ATTRB             PIC X.
  5812         16  BKIND                   PIC XX.
  5813         16  BTYPE-LEN               PIC S9(4)  COMP.
  5814         16  BTYPE-ATTRB             PIC X.
  5815         16  BTYPE                   PIC X(3).
  5816         16  BTERM-LEN               PIC S9(4)  COMP.
  5817         16  BTERM-ATTRB             PIC X.
  5818         16  BTERMI                  PIC 999.
  5819         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5820         16  BBEN-LEN                PIC S9(4)  COMP.
  5821         16  BBEN-ATTRB              PIC X.
  5822         16  BBENI                   PIC 9(10)V99.
  5823*        16  BBENI                   PIC 9(12).
  5824         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5825         16  BPREM-LEN               PIC S9(4)  COMP.
  5826         16  BPREM-ATTRB             PIC X.
  5827         16  BPREMI                  PIC S9(9)V99.
  5828*        16  BPREMI                  PIC 9(11).
  5829         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5830         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5831         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5832         16  BEXPIRE-ATTRB           PIC X.
  5833         16  BEXPIRE                 PIC X(8).
  5834         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5835         16  BCRIT-PERD-ATTRB        PIC X.
  5836         16  BCRIT-PERDI             PIC 99.
  5837         16  BCRIT-PERDO REDEFINES
  5838                         BCRIT-PERDI PIC ZZ.
  5839         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5840         16  BALT-BEN-ATTRB          PIC X.
  5841         16  BALT-BENI               PIC 9(10)V99.
  5842*        16  BALT-BENI               PIC 9(12).
  5843         16  BALT-BENO REDEFINES
  5844                           BALT-BENI PIC Z(9).ZZ.
  5845         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5846         16  BALT-PREM-ATTRB         PIC X.
  5847         16  BALT-PREMI              PIC 9(9)V99.
  5848*        16  BALT-PREMI              PIC 9(11).
  5849         16  BALT-PREMO REDEFINES
  5850                          BALT-PREMI PIC Z(7).ZZ-.
  5851         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5852         16  BBEN-CD-ATTRB           PIC X.
  5853         16  BBEN-CD                 PIC XXX.
  5854         16  BCPREM-LEN              PIC S9(4)  COMP.
  5855         16  BCPREM-ATTRB            PIC X.
  5856         16  BCPREMI                 PIC S9(9)V99.
  5857*        16  BCPREMI                 PIC X(11).
  5858         16  BCPREMO REDEFINES BCPREMI
  5859                                     PIC Z(7).99-.
  5860         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5861         16  BCALT-PREM-ATTRB        PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 109
* EL6311.cbl
  5862         16  BCALT-PREM              PIC Z(7).99-.
  5863         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5864         16  BBEN-ABBR-ATTRB         PIC X.
  5865         16  BBEN-ABBR               PIC X(5).
  5866         16  BDIFF-LEN               PIC S9(4)  COMP.
  5867         16  BDIFF-ATTRB             PIC X.
  5868         16  BDIFFO                  PIC Z(7).99-.
  5869         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5870         16  BBILL-LIT-ATTRB         PIC X.
  5871         16  BBILL-LIT               PIC X(8).
  5872         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5873         16  BDALT-PREM-ATTRB        PIC X.
  5874         16  BDALT-PREM              PIC Z(7).99-.
  5875
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 110
* EL6311.cbl
  5877
  5878****************************************************************
  5879*
  5880* Copyright (c) 2007-2013 Dell Inc.
  5881* All rights reserved.
  5882*
  5883****************************************************************
  5884 01  DFHEIV.
  5885   02  DFHEIV0               PIC X(35).
  5886   02  DFHEIV1               PIC X(08).
  5887   02  DFHEIV2               PIC X(08).
  5888   02  DFHEIV3               PIC X(08).
  5889   02  DFHEIV4               PIC X(06).
  5890   02  DFHEIV5               PIC X(04).
  5891   02  DFHEIV6               PIC X(04).
  5892   02  DFHEIV7               PIC X(02).
  5893   02  DFHEIV8               PIC X(02).
  5894   02  DFHEIV9               PIC X(01).
  5895   02  DFHEIV10              PIC S9(7) COMP-3.
  5896   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5897   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5898   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5899   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5900   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5901   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5902   02  DFHEIV17              PIC X(04).
  5903   02  DFHEIV18              PIC X(04).
  5904   02  DFHEIV19              PIC X(04).
  5905   02  DFHEIV20              USAGE IS POINTER.
  5906   02  DFHEIV21              USAGE IS POINTER.
  5907   02  DFHEIV22              USAGE IS POINTER.
  5908   02  DFHEIV23              USAGE IS POINTER.
  5909   02  DFHEIV24              USAGE IS POINTER.
  5910   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5911   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5912   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5913   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5914   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5915   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5916   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5917   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5918   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5919   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5920   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5921   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5922   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5923   02  FILLER                PIC X(02).
  5924   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5925   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5926   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5927   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5928   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5929   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5930   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5931 LINKAGE  SECTION.
  5932*****************************************************************
  5933*                                                               *
  5934* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 111
* EL6311.cbl
  5935* All rights reserved.                                          *
  5936*                                                               *
  5937*****************************************************************
  5938 01  dfheiblk.
  5939     02  eibtime          pic s9(7) comp-3.
  5940     02  eibdate          pic s9(7) comp-3.
  5941     02  eibtrnid         pic x(4).
  5942     02  eibtaskn         pic s9(7) comp-3.
  5943     02  eibtrmid         pic x(4).
  5944     02  dfheigdi         pic s9(4) comp.
  5945     02  eibcposn         pic s9(4) comp.
  5946     02  eibcalen         pic s9(4) comp.
  5947     02  eibaid           pic x(1).
  5948     02  eibfiller1       pic x(1).
  5949     02  eibfn            pic x(2).
  5950     02  eibfiller2       pic x(2).
  5951     02  eibrcode         pic x(6).
  5952     02  eibfiller3       pic x(2).
  5953     02  eibds            pic x(8).
  5954     02  eibreqid         pic x(8).
  5955     02  eibrsrce         pic x(8).
  5956     02  eibsync          pic x(1).
  5957     02  eibfree          pic x(1).
  5958     02  eibrecv          pic x(1).
  5959     02  eibsend          pic x(1).
  5960     02  eibatt           pic x(1).
  5961     02  eibeoc           pic x(1).
  5962     02  eibfmh           pic x(1).
  5963     02  eibcompl         pic x(1).
  5964     02  eibsig           pic x(1).
  5965     02  eibconf          pic x(1).
  5966     02  eiberr           pic x(1).
  5967     02  eibrldbk         pic x(1).
  5968     02  eiberrcd         pic x(4).
  5969     02  eibsynrb         pic x(1).
  5970     02  eibnodat         pic x(1).
  5971     02  eibfiller5       pic x(2).
  5972     02  eibresp          pic s9(8) comp.
  5973     02  eibresp2         pic s9(8) comp.
  5974     02  dfheigdj         pic s9(4) comp.
  5975     02  dfheigdk         pic s9(4) comp.
  5976 01  DFHCOMMAREA                 PIC X(1300).
  5977*                                COPY ERCPNDB.
  5978******************************************************************
  5979*                                                                *
  5980*                                                                *
  5981*                            ERCPNDB.                            *
  5982*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5983*                            VMOD=2.025                          *
  5984*                                                                *
  5985*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5986*                                                                *
  5987******************************************************************
  5988*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5989*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5990******************************************************************
  5991*                                                                *
  5992*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 112
* EL6311.cbl
  5993*   FILE TYPE = VSAM,KSDS                                        *
  5994*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5995*                                                                *
  5996*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5997*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5998*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5999*                                                 RKP=13,LEN=36  *
  6000*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6001*                                      AND CHG-SEQ.)             *
  6002*                                                RKP=49,LEN=11   *
  6003*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6004*                                      AND CHG-SEQ.)             *
  6005*                                                RKP=60,LEN=15   *
  6006*                                                                *
  6007*   LOG = NO                                                     *
  6008*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6009******************************************************************
  6010******************************************************************
  6011*                   C H A N G E   L O G
  6012*
  6013* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6014*-----------------------------------------------------------------
  6015*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6016* EFFECTIVE    NUMBER
  6017*-----------------------------------------------------------------
  6018* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6019* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6020* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6021* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6022* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6023* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6024* 032306                   PEMA  ADD BOW LOAN NUMBER
  6025* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6026* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6027* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6028* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6029* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6030* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6031* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6032* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6033* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6034* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6035* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6036* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6037* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  6038******************************************************************
  6039
  6040 01  PENDING-BUSINESS.
  6041     12  PB-RECORD-ID                     PIC XX.
  6042         88  VALID-PB-ID                        VALUE 'PB'.
  6043
  6044     12  PB-CONTROL-PRIMARY.
  6045         16  PB-COMPANY-CD                PIC X.
  6046         16  PB-ENTRY-BATCH               PIC X(6).
  6047         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6048         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6049
  6050     12  PB-CONTROL-BY-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 113
* EL6311.cbl
  6051         16  PB-COMPANY-CD-A1             PIC X.
  6052         16  PB-CARRIER                   PIC X.
  6053         16  PB-GROUPING.
  6054             20  PB-GROUPING-PREFIX       PIC XXX.
  6055             20  PB-GROUPING-PRIME        PIC XXX.
  6056         16  PB-STATE                     PIC XX.
  6057         16  PB-ACCOUNT.
  6058             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6059             20  PB-ACCOUNT-PRIME         PIC X(6).
  6060         16  PB-CERT-EFF-DT               PIC XX.
  6061         16  PB-CERT-NO.
  6062             20  PB-CERT-PRIME            PIC X(10).
  6063             20  PB-CERT-SFX              PIC X.
  6064         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6065
  6066         16  PB-RECORD-TYPE               PIC X.
  6067             88  PB-MAILING-DATA                VALUE '0'.
  6068             88  PB-ISSUE                       VALUE '1'.
  6069             88  PB-CANCELLATION                VALUE '2'.
  6070             88  PB-BATCH-TRAILER               VALUE '9'.
  6071
  6072     12  PB-CONTROL-BY-ORIG-BATCH.
  6073         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6074         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6075         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6076         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6077
  6078     12  PB-CONTROL-BY-CSR.
  6079         16  PB-CSR-COMPANY-CD            PIC X.
  6080         16  PB-CSR-ID                    PIC X(4).
  6081         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6082         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6083         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6084******************************************************************
  6085*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6086******************************************************************
  6087
  6088     12  PB-LAST-MAINT-DT                 PIC XX.
  6089     12  PB-LAST-MAINT-BY                 PIC X(4).
  6090     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6091
  6092     12  PB-RECORD-BODY                   PIC X(375).
  6093
  6094     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6095         16  PB-CERT-ORIGIN               PIC X.
  6096             88  CLASIC-CREATED-CERT         VALUE '1'.
  6097         16  PB-I-NAME.
  6098             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6099             20  PB-I-INSURED-FIRST-NAME.
  6100                 24  PB-I-INSURED-1ST-INIT PIC X.
  6101                 24  FILLER                PIC X(9).
  6102             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6103         16  PB-I-AGE                     PIC S99   COMP-3.
  6104         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6105         16  PB-I-BIRTHDAY                PIC XX.
  6106         16  PB-I-INSURED-SEX             PIC X.
  6107             88  PB-SEX-MALE     VALUE 'M'.
  6108             88  PB-SEX-FEMALE   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 114
* EL6311.cbl
  6109
  6110         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6111         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6112         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6113         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6114         16  PB-I-SKIP-CODE               PIC X.
  6115             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6116             88  PB-SKIP-JULY              VALUE '1'.
  6117             88  PB-SKIP-AUGUST            VALUE '2'.
  6118             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6119             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6120             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6121             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6122             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6123             88  PB-SKIP-JUNE              VALUE '8'.
  6124             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6125             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6126             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6127         16  PB-I-TERM-TYPE               PIC X.
  6128             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6129             88  PB-PAID-WEEKLY            VALUE 'W'.
  6130             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6131             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6132             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6133         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6134         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6135         16  PB-I-DATA-ENTRY-SW           PIC X.
  6136             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6137             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6138             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6139             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6140         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6141         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6142*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6143         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6144         16  PB-I-LETTER-REQD             PIC X.
  6145
  6146         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6147             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6148             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6149                                                   '90' THRU '99'.
  6150         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6151                                          PIC XX.
  6152         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6153         16  PB-I-AMOUNT-FINANCED REDEFINES
  6154                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6155         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6156         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6157                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6158         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6159         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6160         16  PB-I-CLP-AMOUNT REDEFINES
  6161                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6162         16  PB-I-LF-CALC-FLAG            PIC X.
  6163             88 PB-COMP-LF-PREM               VALUE '?'.
  6164         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6165         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6166         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 115
* EL6311.cbl
  6167         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6168         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6169         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6170         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6171         16  PB-I-LF-ABBR                 PIC XXX.
  6172         16  PB-I-LF-INPUT-CD             PIC XX.
  6173
  6174         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6175             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6176             88  PB-INVALID-AH               VALUE '  ' '00'
  6177                                                   '90' THRU '99'.
  6178         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6179         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6180         16  PB-I-AH-CALC-FLAG            PIC X.
  6181             88 PB-COMP-AH-PREM                  VALUE '?'.
  6182         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6183         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6184         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6185         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6186         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6187         16  PB-I-AH-ABBR                 PIC XXX.
  6188         16  PB-I-AH-INPUT-CD             PIC XXX.
  6189
  6190         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6191         16  PB-I-REIN-TABLE              PIC XXX.
  6192         16  PB-I-BUSINESS-TYPE           PIC 99.
  6193         16  PB-I-INDV-GRP-CD             PIC X.
  6194         16  PB-I-MORT-CODE.
  6195             20  PB-I-TABLE               PIC X.
  6196             20  PB-I-INTEREST            PIC XX.
  6197             20  PB-I-MORT-TYP            PIC X.
  6198         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6199         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6200         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6201         16  PB-I-INDV-GRP-OVRD           PIC X.
  6202         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6203         16  PB-I-SIG-SW                  PIC X.
  6204             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6205         16  PB-I-RATE-CLASS              PIC XX.
  6206         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6207         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6208         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6209         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6210         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6211         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6212         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6213         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6214         16  PB-I-OB-FLAG                 PIC X.
  6215             88  PB-I-OB                      VALUE 'B'.
  6216             88  PB-I-SUMMARY                 VALUE 'Z'.
  6217         16  PB-I-ENTRY-STATUS            PIC X.
  6218             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6219                                              'M' '5' '9' '2'.
  6220             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6221             88  PB-I-POLICY-PENDING          VALUE '2'.
  6222             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6223             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6224             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 116
* EL6311.cbl
  6225             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6226             88  PB-I-REIN-ONLY               VALUE '9'.
  6227             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6228             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6229             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6230             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6231         16  PB-I-INT-CODE                PIC X.
  6232             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6233             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6234         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6235         16  PB-I-SOC-SEC-NO              PIC X(11).
  6236         16  PB-I-MEMBER-NO               PIC X(12).
  6237         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6238*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6239         16  PB-I-OLD-LOF                 PIC XXX.
  6240         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6241         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6242         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6243         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6244         16  PB-I-LIFE-INDICATOR          PIC X.
  6245             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6246         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6247         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6248                                          PIC S9(5)V99    COMP-3.
  6249         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6250             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6251             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6252         16  PB-I-1ST-PMT-DT              PIC XX.
  6253         16  PB-I-JOINT-INSURED.
  6254             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6255             20 PB-I-JOINT-FIRST-NAME.
  6256                24  PB-I-JOINT-FIRST-INIT PIC X.
  6257                24  FILLER                PIC X(9).
  6258             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6259*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6260         16  PB-I-BENEFICIARY-NAME.
  6261             20  PB-I-BANK-NUMBER         PIC X(10).
  6262             20  FILLER                   PIC X(15).
  6263         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6264         16  PB-I-REFERENCE               PIC X(12).
  6265         16  FILLER REDEFINES PB-I-REFERENCE.
  6266             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6267             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6268             20  PB-I-CLP-STATE           PIC XX.
  6269         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6270             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6271             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6272             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6273         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6274         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6275         16  PB-I-RESIDENT-STATE          PIC XX.
  6276         16  PB-I-RATE-CODE               PIC X(4).
  6277         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6278         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6279         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6280         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6281         16  PB-I-BANK-NOCHRGB            PIC 99.
  6282         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 117
* EL6311.cbl
  6283         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6284
  6285     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6286         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6287             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6288         16  PB-C-CANCEL-ORIGIN           PIC X.
  6289             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6290         16  PB-C-LF-CANCEL-DT            PIC XX.
  6291         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6292         16  PB-C-LF-CALC-REQ             PIC X.
  6293             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6294         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6295         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6296         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6297             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6298         16  PB-C-AH-CANCEL-DT            PIC XX.
  6299         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6300         16  PB-C-AH-CALC-REQ             PIC X.
  6301             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6302         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6303         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6304         16  PB-C-LAST-NAME               PIC X(15).
  6305         16  PB-C-REFUND-SW               PIC X.
  6306             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6307             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6308         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6309         16  PB-C-PAYEE-CODE              PIC X(6).
  6310         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6311         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6312         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6313         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6314         16  PB-C-REFERENCE               PIC X(12).
  6315         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6316         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6317         16  PB-C-POST-CARD-IND           PIC X.
  6318         16  PB-C-CANCEL-REASON           PIC X.
  6319         16  PB-C-REF-INTERFACE-SW        PIC X.
  6320         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6321         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6322         16  FILLER                       PIC X(01).
  6323*        16  FILLER                       PIC X(18).
  6324         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6325*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6326         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6327         16  PB-CANCELED-CERT-DATA.
  6328             20  PB-CI-INSURED-NAME.
  6329                 24  PB-CI-LAST-NAME      PIC X(15).
  6330                 24  PB-CI-INITIALS       PIC XX.
  6331             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6332             20  PB-CI-INSURED-SEX        PIC X.
  6333             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6334             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6335             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6336             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6337             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6338             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6339             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6340             20  PB-CI-AH-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 118
* EL6311.cbl
  6341             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6342             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6343             20  PB-CI-RATE-CLASS         PIC XX.
  6344             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6345             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6346             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6347             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6348             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6349             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6350             20  PB-CI-LF-ABBR            PIC X(3).
  6351             20  PB-CI-AH-ABBR            PIC X(3).
  6352             20  PB-CI-OB-FLAG            PIC X.
  6353                 88  PB-CI-OB                VALUE 'B'.
  6354             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6355                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6356                                           'M' '4' '5' '9' '2'.
  6357                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6358                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6359                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6360                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6361                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6362                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6363                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6364                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6365                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6366                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6367                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6368                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6369                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6370             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6371                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6372                                           'M' '4' '5' '9' '2'.
  6373                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6374                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6375                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6376                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6377                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6378                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6379                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6380                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6381                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6382                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6383                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6384                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6385                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6386             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6387             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6388             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6389             20  PB-CI-MEMBER-NO          PIC X(12).
  6390             20  PB-CI-INT-CODE           PIC X.
  6391                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6392                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6393             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6394             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6395             20  PB-CI-COMP-EXCP-SW       PIC X.
  6396                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6397                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6398             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 119
* EL6311.cbl
  6399             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6400             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6401             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6402             20  PB-CI-DEATH-DT           PIC XX.
  6403             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6404             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6405             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6406             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6407             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6408             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6409             20  PB-CI-ENTRY-DT              PIC XX.
  6410             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6411             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6412             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6413             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6414             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6415             20  PB-CI-OLD-LOF               PIC XXX.
  6416*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6417             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6418             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6419             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6420             20  PB-CI-INDV-GRP-CD           PIC X.
  6421             20  PB-CI-BENEFICIARY-NAME.
  6422                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6423                 24  FILLER                  PIC X(15).
  6424             20  PB-CI-NOTE-SW               PIC X.
  6425             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6426             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6427             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6428             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6429             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6430             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6431             20  PB-CI-FIRST-NAME            PIC X(10).
  6432             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6433
  6434         16  FILLER                       PIC X(13).
  6435*032306  16  FILLER                       PIC X(27).
  6436*        16  FILLER                       PIC X(46).
  6437
  6438     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6439         16  FILLER                       PIC X(10).
  6440         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6441         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6442         16  PB-M-INSURED-MID-INIT        PIC X.
  6443         16  PB-M-INSURED-AGE             PIC 99.
  6444         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6445         16  PB-M-INSURED-SEX             PIC X.
  6446         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6447         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6448         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6449         16  PB-M-INSURED-CITY-STATE.
  6450             20  PB-M-INSURED-CITY        PIC X(28).
  6451             20  PB-M-INSURED-STATE       PIC XX.
  6452         16  PB-M-INSURED-ZIP-CODE.
  6453             20  PB-M-INSURED-ZIP-PRIME.
  6454                 24  PB-M-INSURED-ZIP-1   PIC X.
  6455                     88  PB-M-CANADIAN-POST-CODE
  6456                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 120
* EL6311.cbl
  6457                 24  FILLER               PIC X(4).
  6458             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6459         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6460                                        PB-M-INSURED-ZIP-CODE.
  6461             20  PM-M-INS-CAN-POST1       PIC XXX.
  6462             20  PM-M-INS-CAN-POST2       PIC XXX.
  6463             20  FILLER                   PIC XXX.
  6464         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6465         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6466         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6467         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6468         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6469         16  PB-M-CRED-BENE-CITYST.
  6470             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6471             20  PB-M-CRED-BENE-STATE     PIC XX.
  6472         16  FILLER                       PIC X(92).
  6473
  6474     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6475         16  FILLER                       PIC X(10).
  6476         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6477         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6478         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6479         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6480         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6481         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6482         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6483         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6484         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6485         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6486         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6487         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6488         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6489         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6490         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6491         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6492         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6493         16  PB-ACCOUNT-NAME              PIC X(30).
  6494         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6495         16  PB-REFERENCE                 PIC X(12).
  6496         16  PB-B-RECEIVED-DT             PIC XX.
  6497         16  FILLER                       PIC X(234).
  6498
  6499     12  PB-RECORD-STATUS.
  6500         16  PB-CREDIT-SELECT-DT          PIC XX.
  6501         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6502         16  PB-BILLED-DT                 PIC XX.
  6503         16  PB-BILLING-STATUS            PIC X.
  6504             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6505             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6506             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6507         16  PB-RECORD-BILL               PIC X.
  6508             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6509             88  PB-RECORD-RETURNED           VALUE 'R'.
  6510             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6511             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6512             88  PB-OVERRIDE-AH               VALUE 'A'.
  6513             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6514         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 121
* EL6311.cbl
  6515             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6516             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6517             88  PB-REISSUED-CERT             VALUE 'E'.
  6518             88  PB-CASH-CERT                 VALUE 'C'.
  6519             88  PB-MONTHLY-CERT              VALUE 'M'.
  6520             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6521             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6522             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6523         16  PB-FORCE-CODE                PIC X.
  6524             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6525             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6526             88  PB-CANCEL-FORCE              VALUE '8'.
  6527             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6528             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6529             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6530             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6531             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6532             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6533             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6534             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6535         16  PB-FATAL-FLAG                PIC X.
  6536             88  PB-FATAL-ERRORS              VALUE 'X'.
  6537         16  PB-FORCE-ER-CD               PIC X.
  6538             88  PB-FORCE-ERRORS              VALUE 'F'.
  6539             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6540         16  PB-WARN-ER-CD                PIC X.
  6541             88  PB-WARNING-ERRORS            VALUE 'W'.
  6542         16  FILLER                       PIC X.
  6543         16  PB-OUT-BAL-CD                PIC X.
  6544             88  PB-OUT-OF-BAL                VALUE 'O'.
  6545         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6546         16  PB-AH-OVERRIDE-L1            PIC X.
  6547         16  PB-INPUT-DT                  PIC XX.
  6548         16  PB-INPUT-BY                  PIC X(4).
  6549         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6550         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6551         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6552         16  PB-LF-EARNING-METHOD         PIC X.
  6553         16  PB-AH-EARNING-METHOD         PIC X.
  6554         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6555         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6556         16  PB-REIN-CD                   PIC XXX.
  6557         16  PB-LF-REFUND-TYPE            PIC X.
  6558         16  PB-AH-REFUND-TYPE            PIC X.
  6559         16  PB-ACCT-EFF-DT               PIC XX.
  6560         16  PB-ACCT-EXP-DT               PIC XX.
  6561         16  PB-COMPANY-ID                PIC X(3).
  6562         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6563         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6564         16  PB-SV-CARRIER                PIC X.
  6565         16  PB-SV-GROUPING               PIC X(6).
  6566         16  PB-SV-STATE                  PIC XX.
  6567         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6568         16  PB-GA-BILLING-INFO.
  6569             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6570                                          PIC XX.
  6571         16  PB-SV-REMIT-TO  REDEFINES
  6572             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 122
* EL6311.cbl
  6573         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6574         16  PB-I-LOAN-OFFICER            PIC X(5).
  6575         16  PB-I-VIN                     PIC X(17).
  6576
  6577         16  FILLER                       PIC X(04).
  6578         16  IMNET-BYPASS-SW              PIC X.
  6579
  6580******************************************************************
  6581*                COMMON EDIT ERRORS                              *
  6582******************************************************************
  6583
  6584     12  PB-COMMON-ERRORS.
  6585         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6586                                           PIC S9(4)     COMP.
  6587
  6588******************************************************************
  6589*                                COPY ELCCERT.
  6590******************************************************************
  6591*                                                                *
  6592*                            ELCCERT.                            *
  6593*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6594*                            VMOD=2.013                          *
  6595*                                                                *
  6596*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6597*                                                                *
  6598*   FILE TYPE = VSAM,KSDS                                        *
  6599*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6600*                                                                *
  6601*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6602*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6603*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6604*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6605*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6606*                                                                *
  6607*   LOG = YES                                                    *
  6608*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6609******************************************************************
  6610*                   C H A N G E   L O G
  6611*
  6612* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6613*-----------------------------------------------------------------
  6614*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6615* EFFECTIVE    NUMBER
  6616*-----------------------------------------------------------------
  6617* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6618* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6619* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6620* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6621* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6622* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6623* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6624* 032612  CR2011110200001  PEMA  AHL CHANGES
  6625* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6626* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6627* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6628******************************************************************
  6629
  6630 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 123
* EL6311.cbl
  6631     12  CM-RECORD-ID                      PIC XX.
  6632         88  VALID-CM-ID                      VALUE 'CM'.
  6633
  6634     12  CM-CONTROL-PRIMARY.
  6635         16  CM-COMPANY-CD                 PIC X.
  6636         16  CM-CARRIER                    PIC X.
  6637         16  CM-GROUPING.
  6638             20  CM-GROUPING-PREFIX        PIC X(3).
  6639             20  CM-GROUPING-PRIME         PIC X(3).
  6640         16  CM-STATE                      PIC XX.
  6641         16  CM-ACCOUNT.
  6642             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6643             20  CM-ACCOUNT-PRIME          PIC X(6).
  6644         16  CM-CERT-EFF-DT                PIC XX.
  6645         16  CM-CERT-NO.
  6646             20  CM-CERT-PRIME             PIC X(10).
  6647             20  CM-CERT-SFX               PIC X.
  6648
  6649     12  CM-CONTROL-BY-NAME.
  6650         16  CM-COMPANY-CD-A1              PIC X.
  6651         16  CM-INSURED-LAST-NAME          PIC X(15).
  6652         16  CM-INSURED-INITIALS.
  6653             20  CM-INSURED-INITIAL1       PIC X.
  6654             20  CM-INSURED-INITIAL2       PIC X.
  6655
  6656     12  CM-CONTROL-BY-SSN.
  6657         16  CM-COMPANY-CD-A2              PIC X.
  6658         16  CM-SOC-SEC-NO.
  6659             20  CM-SSN-STATE              PIC XX.
  6660             20  CM-SSN-ACCOUNT            PIC X(6).
  6661             20  CM-SSN-LN3.
  6662                 25  CM-INSURED-INITIALS-A2.
  6663                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6664                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6665                 25 CM-PART-LAST-NAME-A2         PIC X.
  6666
  6667     12  CM-CONTROL-BY-CERT-NO.
  6668         16  CM-COMPANY-CD-A4              PIC X.
  6669         16  CM-CERT-NO-A4                 PIC X(11).
  6670
  6671     12  CM-CONTROL-BY-MEMB.
  6672         16  CM-COMPANY-CD-A5              PIC X.
  6673         16  CM-MEMBER-NO.
  6674             20  CM-MEMB-STATE             PIC XX.
  6675             20  CM-MEMB-ACCOUNT           PIC X(6).
  6676             20  CM-MEMB-LN4.
  6677                 25  CM-INSURED-INITIALS-A5.
  6678                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6679                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6680                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6681
  6682     12  CM-INSURED-PROFILE-DATA.
  6683         16  CM-INSURED-FIRST-NAME.
  6684             20  CM-INSURED-1ST-INIT       PIC X.
  6685             20  FILLER                    PIC X(9).
  6686         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6687         16  CM-INSURED-SEX                PIC X.
  6688             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 124
* EL6311.cbl
  6689             88  CM-SEX-FEMAL                 VALUE 'F'.
  6690         16  CM-INSURED-JOINT-AGE          PIC 99.
  6691         16  CM-JOINT-INSURED-NAME.
  6692             20  CM-JT-LAST-NAME           PIC X(15).
  6693             20  CM-JT-FIRST-NAME.
  6694                 24  CM-JT-1ST-INIT        PIC X.
  6695                 24  FILLER                PIC X(9).
  6696             20  CM-JT-INITIAL             PIC X.
  6697
  6698     12  CM-LIFE-DATA.
  6699         16  CM-LF-BENEFIT-CD              PIC XX.
  6700         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6701         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6702         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6703         16  CM-LF-DEV-CODE                PIC XXX.
  6704         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6705         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6706         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6707         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6708         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6709         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6710         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6711         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6712         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6713         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6714         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6715         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6716         16  cm-temp-epiq                  pic xx.
  6717             88  EPIQ-CLASS                  value 'EQ'.
  6718*        16  FILLER                        PIC XX.
  6719
  6720     12  CM-AH-DATA.
  6721         16  CM-AH-BENEFIT-CD              PIC XX.
  6722         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6723         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6724         16  CM-AH-DEV-CODE                PIC XXX.
  6725         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6726         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6727         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6728         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6729         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6730         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6731         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6732         16  CM-AH-PAID-THRU-DT            PIC XX.
  6733             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6734         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6735         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6736         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6737         16  FILLER                        PIC X.
  6738
  6739     12  CM-LOAN-INFORMATION.
  6740         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6741         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6742                                           PIC S9(5)V99  COMP-3.
  6743         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6744         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6745         16  CM-PAY-FREQUENCY              PIC S99.
  6746         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 125
* EL6311.cbl
  6747         16  CM-RATE-CLASS                 PIC XX.
  6748         16  CM-BENEFICIARY                PIC X(25).
  6749         16  CM-POLICY-FORM-NO             PIC X(12).
  6750         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6751         16  CM-LAST-ADD-ON-DT             PIC XX.
  6752         16  CM-DEDUCTIBLE-AMOUNTS.
  6753             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6754             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6755         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6756             20  CM-RESIDENT-STATE         PIC XX.
  6757             20  CM-RATE-CODE              PIC X(4).
  6758             20  FILLER                    PIC XX.
  6759         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6760             20  CM-LOAN-OFFICER           PIC X(5).
  6761             20  FILLER                    PIC XXX.
  6762         16  CM-CSR-CODE                   PIC XXX.
  6763         16  CM-UNDERWRITING-CODE          PIC X.
  6764             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6765         16  CM-POST-CARD-IND              PIC X.
  6766         16  CM-REF-INTERFACE-SW           PIC X.
  6767         16  CM-PREMIUM-TYPE               PIC X.
  6768             88  CM-SING-PRM                  VALUE '1'.
  6769             88  CM-O-B-COVERAGE              VALUE '2'.
  6770             88  CM-OPEN-END                  VALUE '3'.
  6771         16  CM-IND-GRP-TYPE               PIC X.
  6772             88  CM-INDIVIDUAL                VALUE 'I'.
  6773             88  CM-GROUP                     VALUE 'G'.
  6774         16  CM-SKIP-CODE                  PIC X.
  6775             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6776             88  SKIP-JULY                    VALUE '1'.
  6777             88  SKIP-AUGUST                  VALUE '2'.
  6778             88  SKIP-SEPTEMBER               VALUE '3'.
  6779             88  SKIP-JULY-AUG                VALUE '4'.
  6780             88  SKIP-AUG-SEPT                VALUE '5'.
  6781             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6782             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6783             88  SKIP-JUNE                    VALUE '8'.
  6784             88  SKIP-JUNE-JULY               VALUE '9'.
  6785             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6786             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6787         16  CM-PAYMENT-MODE               PIC X.
  6788             88  PAY-MONTHLY                  VALUE SPACE.
  6789             88  PAY-WEEKLY                   VALUE '1'.
  6790             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6791             88  PAY-BI-WEEKLY                VALUE '3'.
  6792             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6793         16  CM-LOAN-NUMBER                PIC X(8).
  6794         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6795         16  CM-OLD-LOF                    PIC XXX.
  6796*        16  CM-LOAN-OFFICER               PIC XXX.
  6797         16  CM-REIN-TABLE                 PIC XXX.
  6798         16  CM-SPECIAL-REIN-CODE          PIC X.
  6799         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6800         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6801         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6802
  6803     12  CM-STATUS-DATA.
  6804         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 126
* EL6311.cbl
  6805         16  CM-ENTRY-DT                   PIC XX.
  6806
  6807         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6808         16  CM-LF-CANCEL-DT               PIC XX.
  6809         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6810
  6811         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6812         16  CM-LF-DEATH-DT                PIC XX.
  6813         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6814
  6815         16  CM-LF-CURRENT-STATUS          PIC X.
  6816             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6817                                                'M' '4' '5' '9'.
  6818             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6819             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6820             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6821             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6822             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6823             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6824             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6825             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6826             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6827             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6828             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6829             88  CM-LF-DECLINED               VALUE 'D'.
  6830             88  CM-LF-VOIDED                 VALUE 'V'.
  6831
  6832         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6833         16  CM-AH-CANCEL-DT               PIC XX.
  6834         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6835
  6836         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6837         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6838         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6839
  6840         16  CM-AH-CURRENT-STATUS          PIC X.
  6841             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6842                                                'M' '4' '5' '9'.
  6843             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6844             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6845             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6846             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6847             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6848             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6849             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6850             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6851             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6852             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6853             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6854             88  CM-AH-DECLINED               VALUE 'D'.
  6855             88  CM-AH-VOIDED                 VALUE 'V'.
  6856
  6857         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6858             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6859             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6860             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6861         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6862
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 127
* EL6311.cbl
  6863         16  CM-ENTRY-BATCH                PIC X(6).
  6864         16  CM-LF-EXIT-BATCH              PIC X(6).
  6865         16  CM-AH-EXIT-BATCH              PIC X(6).
  6866         16  CM-LAST-MONTH-END             PIC XX.
  6867
  6868     12  CM-NOTE-SW                        PIC X.
  6869         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6870         88  CERT-NOTES-PRESENT               VALUE '1'.
  6871         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6872         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6873         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6874         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6875         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6876         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6877     12  CM-COMP-EXCP-SW                   PIC X.
  6878         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6879         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6880     12  CM-INSURED-ADDRESS-SW             PIC X.
  6881         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6882         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6883
  6884*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6885     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6886     12  FILLER                            PIC X.
  6887
  6888*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6889     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6890     12  FILLER                            PIC X.
  6891*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6892     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6893
  6894     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6895         88  CERT-ADDED-BATCH                 VALUE ' '.
  6896         88  CERT-ADDED-ONLINE                VALUE '1'.
  6897         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6898         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6899         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6900     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6901         88  CERT-AS-LOADED                   VALUE ' '.
  6902         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6903         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6904         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6905         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6906         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6907         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6908         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6909
  6910     12  CM-ACCOUNT-COMM-PCTS.
  6911         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6912         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6913
  6914     12  CM-USER-FIELD                     PIC X.
  6915     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6916     12  CM-CLP-STATE                      PIC XX.
  6917     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6918     12  CM-USER-RESERVED                  PIC XXX.
  6919     12  FILLER REDEFINES CM-USER-RESERVED.
  6920         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 128
* EL6311.cbl
  6921         16  F                             PIC X.
  6922******************************************************************
  6923*                                COPY ERCNOTE.
  6924******************************************************************
  6925*                                                                *
  6926*                                                                *
  6927*                            ERCNOTE                             *
  6928*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6929*                            VMOD=2.003                          *
  6930*                                                                *
  6931*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6932*                                                                *
  6933*        FILE TYPE= VSAM,KSDS                                    *
  6934*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6935*                                                                *
  6936*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6937*                                                                *
  6938*        LOG = YES                                               *
  6939*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6940*                                                                *
  6941******************************************************************
  6942*                   C H A N G E   L O G
  6943*
  6944* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6945*-----------------------------------------------------------------
  6946*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6947* EFFECTIVE    NUMBER
  6948*-----------------------------------------------------------------
  6949* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6950*                                FILE WILL CONTAIN BILLING NOTES O
  6951******************************************************************
  6952
  6953 01  CERTIFICATE-NOTE.
  6954     12  CN-RECORD-ID                PIC  XX.
  6955         88  VALID-CN-ID                  VALUE 'CN'.
  6956
  6957     12  CN-CONTROL-PRIMARY.
  6958         16  CN-COMPANY-CD           PIC X.
  6959         16  CN-CARRIER              PIC X.
  6960         16  CN-GROUPING.
  6961             20 CN-GROUPING-PREFIX   PIC XXX.
  6962             20 CN-GROUPING-PRIME    PIC XXX.
  6963         16  CN-STATE                PIC XX.
  6964         16  CN-ACCOUNT.
  6965             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6966             20 CN-ACCOUNT-PRIME     PIC X(6).
  6967         16  CN-CERT-EFF-DT          PIC XX.
  6968         16  CN-CERT-NO.
  6969             20  CN-CERT-PRIME       PIC X(10).
  6970             20  CN-CERT-SFX         PIC X.
  6971
  6972     12  CN-BILLING-START-LINE-NO    PIC 99.
  6973     12  CN-BILLING-END-LINE-NO      PIC 99.
  6974
  6975     12  CN-LINES.
  6976         16  CN-LINE OCCURS 10       PIC X(77).
  6977
  6978     12  CN-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 129
* EL6311.cbl
  6979     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6980     12  CN-LAST-MAINT-USER          PIC X(4).
  6981     12  FILLER                      PIC X(6).
  6982******************************************************************
  6983*                                COPY ERCPNDM.
  6984******************************************************************
  6985*                                                                *
  6986*                                                                *
  6987*                            ERCPNDM                             *
  6988*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6989*                            VMOD=2.003                          *
  6990*                                                                *
  6991*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6992*                                                                *
  6993*   FILE TYPE = VSAM,KSDS                                        *
  6994*   RECORD SIZE = 374   RECFORM = FIX                            *
  6995*                                                                *
  6996*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6997*   ALTERNATE PATH    = NOT USED                                 *
  6998*                                                                *
  6999*   LOG = YES                                                    *
  7000*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7001******************************************************************
  7002*                   C H A N G E   L O G
  7003*
  7004* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7005*-----------------------------------------------------------------
  7006*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7007* EFFECTIVE    NUMBER
  7008*-----------------------------------------------------------------
  7009* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7010* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  7011* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7012* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7013******************************************************************
  7014
  7015 01  PENDING-MAILING-DATA.
  7016     12  PM-RECORD-ID                      PIC XX.
  7017         88  VALID-MA-ID                       VALUE 'PM'.
  7018
  7019     12  PM-CONTROL-PRIMARY.
  7020         16  PM-COMPANY-CD                 PIC X.
  7021         16  PM-ENTRY-BATCH                PIC X(6).
  7022         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7023         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7024
  7025     12  FILLER                            PIC X(14).
  7026
  7027     12  PM-ACCESS-CONTROL.
  7028         16  PM-SOURCE-SYSTEM              PIC XX.
  7029             88  PM-FROM-CREDIT                VALUE 'CR'.
  7030             88  PM-FROM-VSI                   VALUE 'VS'.
  7031             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7032             88  PM-FROM-OTHER                 VALUE 'OT'.
  7033         16  PM-RECORD-ADD-DT              PIC XX.
  7034         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7035         16  PM-LAST-MAINT-DT              PIC XX.
  7036         16  PM-LAST-MAINT-BY              PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 130
* EL6311.cbl
  7037         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7038
  7039     12  PM-PROFILE-INFO.
  7040         16  PM-QUALIFY-CODE-1             PIC XX.
  7041         16  PM-QUALIFY-CODE-2             PIC XX.
  7042         16  PM-QUALIFY-CODE-3             PIC XX.
  7043         16  PM-QUALIFY-CODE-4             PIC XX.
  7044         16  PM-QUALIFY-CODE-5             PIC XX.
  7045
  7046         16  PM-INSURED-LAST-NAME          PIC X(15).
  7047         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7048         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7049         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7050         16  PM-INSURED-BIRTH-DT           PIC XX.
  7051         16  PM-INSURED-SEX                PIC X.
  7052             88  PM-SEX-MALE                   VALUE 'M'.
  7053             88  PM-SEX-FEMALE                 VALUE 'F'.
  7054         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7055
  7056         16  PM-ADDRESS-CORRECTED          PIC X.
  7057         16  PM-JOINT-BIRTH-DT             PIC XX.
  7058*        16  FILLER                        PIC X(12).
  7059
  7060         16  PM-ADDRESS-LINE-1             PIC X(30).
  7061         16  PM-ADDRESS-LINE-2             PIC X(30).
  7062         16  PM-CITY-STATE.
  7063             20  PM-CITY                   PIC X(28).
  7064             20  PM-STATE                  PIC XX.
  7065         16  PM-ZIP.
  7066             20  PM-ZIP-CODE.
  7067                 24  PM-ZIP-1              PIC X.
  7068                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7069                 24  FILLER                PIC X(4).
  7070             20  PM-ZIP-PLUS4              PIC X(4).
  7071         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7072             20  PM-CAN-POST1              PIC XXX.
  7073             20  PM-CAN-POST2              PIC XXX.
  7074             20  FILLER                    PIC XXX.
  7075
  7076         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7077         16  pm-city-st-zip-verified       pic x.
  7078         16  FILLER                        PIC XX.
  7079
  7080     12  PM-CRED-BENE-INFO.
  7081         16  PM-CRED-BENE-NAME             PIC X(25).
  7082         16  PM-CRED-BENE-ADDR             PIC X(30).
  7083         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7084         16  PM-CRED-BENE-CTYST.
  7085             20  PM-CRED-BENE-CITY         PIC X(28).
  7086             20  PM-CRED-BENE-STATE        PIC XX.
  7087         16  PM-CRED-BENE-ZIP.
  7088             20  PM-CB-ZIP-CODE.
  7089                 24  PM-CB-ZIP-1           PIC X.
  7090                     88  PM-CB-CANADIAN-POST-CODE
  7091                                  VALUE 'A' THRU 'Z'.
  7092                 24  FILLER                PIC X(4).
  7093             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7094         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 131
* EL6311.cbl
  7095             20  PM-CB-CAN-POST1           PIC XXX.
  7096             20  PM-CB-CAN-POST2           PIC XXX.
  7097             20  FILLER                    PIC XXX.
  7098     12  PM-POST-CARD-MAIL-DATA.
  7099         16  PM-MAIL-DATA OCCURS 7.
  7100             20  PM-MAIL-TYPE              PIC X.
  7101                 88  PM-12MO-MAILING           VALUE '1'.
  7102                 88  PM-EXP-MAILING            VALUE '2'.
  7103             20  PM-MAIL-STATUS            PIC X.
  7104                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7105                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7106                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7107             20  PM-MAIL-DATE              PIC XX.
  7108     12  FILLER                            PIC XX.
  7109     12  FILLER                            PIC X(12).
  7110*    12  FILLER                            PIC X(30).
  7111
  7112******************************************************************
  7113*                                COPY ERCMAIL.
  7114******************************************************************
  7115*                                                                *
  7116*                                                                *
  7117*                            ERCMAIL                             *
  7118*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7119*                            VMOD=2.003                          *
  7120*                                                                *
  7121*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7122*                                                                *
  7123*   FILE TYPE = VSAM,KSDS                                        *
  7124*   RECORD SIZE = 374   RECFORM = FIX                            *
  7125*                                                                *
  7126*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7127*   ALTERNATE PATH    = NOT USED                                 *
  7128*                                                                *
  7129*   LOG = YES                                                    *
  7130*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7131******************************************************************
  7132*                   C H A N G E   L O G
  7133*
  7134* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7135*-----------------------------------------------------------------
  7136*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7137* EFFECTIVE    NUMBER
  7138*-----------------------------------------------------------------
  7139* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7140* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7141* 111108                   PEMA  ADD CRED BENE ADDR2
  7142******************************************************************
  7143
  7144 01  MAILING-DATA.
  7145     12  MA-RECORD-ID                      PIC XX.
  7146         88  VALID-MA-ID                       VALUE 'MA'.
  7147
  7148     12  MA-CONTROL-PRIMARY.
  7149         16  MA-COMPANY-CD                 PIC X.
  7150         16  MA-CARRIER                    PIC X.
  7151         16  MA-GROUPING.
  7152             20  MA-GROUPING-PREFIX        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 132
* EL6311.cbl
  7153             20  MA-GROUPING-PRIME         PIC XXX.
  7154         16  MA-STATE                      PIC XX.
  7155         16  MA-ACCOUNT.
  7156             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7157             20  MA-ACCOUNT-PRIME          PIC X(6).
  7158         16  MA-CERT-EFF-DT                PIC XX.
  7159         16  MA-CERT-NO.
  7160             20  MA-CERT-PRIME             PIC X(10).
  7161             20  MA-CERT-SFX               PIC X.
  7162
  7163     12  FILLER                            PIC XX.
  7164
  7165     12  MA-ACCESS-CONTROL.
  7166         16  MA-SOURCE-SYSTEM              PIC XX.
  7167             88  MA-FROM-CREDIT                VALUE 'CR'.
  7168             88  MA-FROM-VSI                   VALUE 'VS'.
  7169             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7170             88  MA-FROM-OTHER                 VALUE 'OT'.
  7171         16  MA-RECORD-ADD-DT              PIC XX.
  7172         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7173         16  MA-LAST-MAINT-DT              PIC XX.
  7174         16  MA-LAST-MAINT-BY              PIC XXXX.
  7175         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7176
  7177     12  MA-PROFILE-INFO.
  7178         16  MA-QUALIFY-CODE-1             PIC XX.
  7179         16  MA-QUALIFY-CODE-2             PIC XX.
  7180         16  MA-QUALIFY-CODE-3             PIC XX.
  7181         16  MA-QUALIFY-CODE-4             PIC XX.
  7182         16  MA-QUALIFY-CODE-5             PIC XX.
  7183
  7184         16  MA-INSURED-LAST-NAME          PIC X(15).
  7185         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7186         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7187         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7188         16  MA-INSURED-BIRTH-DT           PIC XX.
  7189         16  MA-INSURED-SEX                PIC X.
  7190             88  MA-SEX-MALE                   VALUE 'M'.
  7191             88  MA-SEX-FEMALE                 VALUE 'F'.
  7192         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7193
  7194         16  MA-ADDRESS-CORRECTED          PIC X.
  7195         16  MA-JOINT-BIRTH-DT             PIC XX.
  7196*        16  FILLER                        PIC X(12).
  7197
  7198         16  MA-ADDRESS-LINE-1             PIC X(30).
  7199         16  MA-ADDRESS-LINE-2             PIC X(30).
  7200         16  MA-CITY-STATE.
  7201             20  MA-CITY                   PIC X(28).
  7202             20  MA-ADDR-STATE             PIC XX.
  7203         16  MA-ZIP.
  7204             20  MA-ZIP-CODE.
  7205                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7206                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7207                 24  FILLER                PIC X(4).
  7208             20  MA-ZIP-PLUS4              PIC X(4).
  7209         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7210             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 133
* EL6311.cbl
  7211             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7212             20  FILLER                    PIC X(3).
  7213
  7214         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7215
  7216         16  FILLER                        PIC XXX.
  7217*        16  FILLER                        PIC X(10).
  7218
  7219     12  MA-CRED-BENE-INFO.
  7220         16  MA-CRED-BENE-NAME                 PIC X(25).
  7221         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7222         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7223         16  MA-CRED-BENE-CTYST.
  7224             20  MA-CRED-BENE-CITY             PIC X(28).
  7225             20  MA-CRED-BENE-STATE            PIC XX.
  7226         16  MA-CRED-BENE-ZIP.
  7227             20  MA-CB-ZIP-CODE.
  7228                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7229                     88  MA-CB-CANADIAN-POST-CODE
  7230                                           VALUE 'A' THRU 'Z'.
  7231                 24  FILLER                    PIC X(4).
  7232             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7233         16  MA-CB-CANADIAN-POSTAL-CODE
  7234                            REDEFINES MA-CRED-BENE-ZIP.
  7235             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7236             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7237             20  FILLER                        PIC X(3).
  7238     12  MA-POST-CARD-MAIL-DATA.
  7239         16  MA-MAIL-DATA OCCURS 7.
  7240             20  MA-MAIL-TYPE              PIC X.
  7241                 88  MA-12MO-MAILING           VALUE '1'.
  7242                 88  MA-EXP-MAILING            VALUE '2'.
  7243             20  MA-MAIL-STATUS            PIC X.
  7244                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7245                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7246                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7247             20  MA-MAIL-DATE              PIC XX.
  7248     12  FILLER                            PIC XX.
  7249     12  FILLER                            PIC XX.
  7250*    12  FILLER                            PIC X(30).
  7251******************************************************************
  7252*                                COPY ERCRQST.
  7253******************************************************************
  7254*                                                                *
  7255*                                                                *
  7256*                            ERCRQST.                            *
  7257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7258*                            VMOD=2.002                          *
  7259*                                                                *
  7260*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7261*                                                                *
  7262*   FILE TYPE = VSAM,KSDS                                        *
  7263*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7264*                                                                *
  7265*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7266*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7267*                                   ACCOUNT, REF, BATCH)         *
  7268*                                                RKP=9, LEN=38   *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 134
* EL6311.cbl
  7269*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7270*                                   ACCOUNT, REF, BATCH)         *
  7271*                                                RKP=47, LEN=46  *
  7272*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7273*                                   BATCH)                       *
  7274*                                                RKP=93, LEN=24  *
  7275*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7276*                                   REF, BATCH)                  *
  7277*                                                RKP=117, LEN=35 *
  7278*   LOG = NO                                                     *
  7279*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7280******************************************************************
  7281
  7282 01  AR-REQUEST-RECORD.
  7283     12  RQ-RECORD-ID                     PIC XX.
  7284         88  VALID-RQ-ID                        VALUE 'RQ'.
  7285
  7286     12  RQ-CONTROL-PRIMARY.
  7287         16  RQ-COMPANY-CD                PIC X.
  7288         16  RQ-ENTRY-BATCH               PIC X(6).
  7289
  7290     12  RQ-CONTROL-BY-ACCT-REF.
  7291         16  RQ-COMPANY-CD-A1             PIC X.
  7292         16  RQ-CARRIER-A1                PIC X.
  7293         16  RQ-GROUPING-A1               PIC X(6).
  7294         16  RQ-STATE-A1                  PIC XX.
  7295         16  RQ-ACCOUNT-A1                PIC X(10).
  7296         16  RQ-REFERENCE-A1              PIC X(12).
  7297         16  RQ-BATCH-A1                  PIC X(6).
  7298
  7299     12  RQ-CONTROL-BY-FIN-RESP.
  7300         16  RQ-COMPANY-CD-A2             PIC X.
  7301         16  RQ-CARRIER-A2                PIC X.
  7302         16  RQ-GROUPING-A2               PIC X(6).
  7303         16  RQ-FIN-RESP-A2               PIC X(10).
  7304         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7305         16  RQ-REFERENCE-A2              PIC X(12).
  7306         16  RQ-BATCH-A2                  PIC X(6).
  7307
  7308     12  RQ-CONTROL-BY-ACCT-AGENT.
  7309         16  RQ-COMPANY-CD-A3             PIC X.
  7310         16  RQ-CARRIER-A3                PIC X.
  7311         16  RQ-GROUPING-A3               PIC X(6).
  7312         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7313         16  RQ-BATCH-A3                  PIC X(6).
  7314
  7315     12  RQ-CONTROL-BY-SUMMARY.
  7316         16  RQ-COMPANY-CD-A4             PIC X.
  7317         16  RQ-SUMMARY-CODE              PIC X(6).
  7318         16  RQ-ACCOUNT-A4                PIC X(10).
  7319         16  RQ-REFERENCE-A4              PIC X(12).
  7320         16  RQ-BATCH-A4                  PIC X(6).
  7321
  7322     12  RQ-REQUEST-METHOD                PIC X.
  7323         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7324         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7325         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7326         88 RQ-BATCH-REQUEST                  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 135
* EL6311.cbl
  7327     12  FILLER                           PIC X.
  7328     12  RQ-STATUS                        PIC X.
  7329         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7330         88  RQ-RESUBMIT                      VALUE 'R'.
  7331     12  RQ-PROCESSOR-ID                  PIC X(4).
  7332     12  RQ-ENTRY-DT                      PIC XX.
  7333     12  RQ-MO-END-DT                     PIC XX.
  7334     12  RQ-REQUEST-DT                    PIC XX.
  7335     12  RQ-STMT-DT                       PIC XX.
  7336     12  RQ-REVERSAL-DT                   PIC XX.
  7337     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7338     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7339
  7340     12  FILLER                           PIC X(27).
  7341
  7342******************************************************************
  7343
  7344*                                COPY ERCLOFC.
  7345******************************************************************
  7346*                                                                *
  7347*                                                                *
  7348*                            ERCLOFC                             *
  7349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7350*                            VMOD=2.003                          *
  7351*                                                                *
  7352*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7353*                                                                *
  7354*   FILE TYPE = VSAM,KSDS                                        *
  7355*   RECORD SIZE = 670   RECFORM = FIX                            *
  7356*                                                                *
  7357*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7358*                                                                *
  7359*   LOG = YES                                                    *
  7360*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7361*                                                                *
  7362******************************************************************
  7363
  7364 01  LOAN-OFFICER-MASTER.
  7365     12  LO-RECORD-ID                PIC XX.
  7366         88  VALID-LO-ID                VALUE 'LO'.
  7367
  7368     12  LO-CONTROL-PRIMARY.
  7369         16  LO-COMPANY-CD           PIC X.
  7370         16  LO-CARRIER              PIC X.
  7371         16  LO-GROUPING.
  7372             20  LO-GROUPING-PREFIX  PIC XXX.
  7373             20  LO-GROUPING-PRIME   PIC XXX.
  7374         16  LO-STATE                PIC XX.
  7375         16  LO-ACCOUNT.
  7376             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7377             20  LO-ACCOUNT-PRIME    PIC X(6).
  7378         16  LO-OFFICER-CODE         PIC X(5).
  7379
  7380     12  LO-OFFICER-NAME             PIC X(30).
  7381
  7382     12  LO-LAST-MAINT-DT            PIC XX.
  7383     12  LO-LAST-USER                PIC X(4).
  7384     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 136
* EL6311.cbl
  7385
  7386     12  LO-COMP-CONTROL             PIC X.
  7387             88  LO-SHOW-COMP           VALUE 'Y'.
  7388             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7389     12  LO-DETAIL-CONTROL           PIC X.
  7390             88  LO-PRINT-DETAIL        VALUE 'D'.
  7391             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7392
  7393     12  LO-SV-CARRIER               PIC X.
  7394     12  LO-SV-GROUPING              PIC X(6).
  7395     12  LO-SV-STATE                 PIC XX.
  7396
  7397     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7398     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7399
  7400     12  LO-OFFICER-INFO.
  7401         16  FILLER OCCURS 12 TIMES.
  7402             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7403             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7404             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7405             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7406             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7407             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7408             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7409             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7410     12  FILLER                      PIC X(198).
  7411******************************************************************
  7412*                                COPY ERCPYAJ.
  7413******************************************************************
  7414*                                                                *
  7415*                            ERCPYAJ                             *
  7416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7417*                            VMOD=2.015                          *
  7418*                                                                *
  7419*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7420*                                                                *
  7421*                                                                *
  7422*   FILE TYPE = VSAM,KSDS                                        *
  7423*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7424*                                                                *
  7425*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7426*       ALTERNATE PATHS = NONE                                   *
  7427*                                                                *
  7428*   LOG = YES                                                    *
  7429*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7430******************************************************************
  7431******************************************************************
  7432*                   C H A N G E   L O G
  7433*
  7434* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7435*-----------------------------------------------------------------
  7436*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7437* EFFECTIVE    NUMBER
  7438*-----------------------------------------------------------------
  7439* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7440* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7441******************************************************************
  7442
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 137
* EL6311.cbl
  7443 01  PENDING-PAY-ADJ.
  7444     12  PY-RECORD-ID                     PIC XX.
  7445         88  VALID-PY-ID                        VALUE 'PY'.
  7446
  7447     12  PY-CONTROL-PRIMARY.
  7448         16  PY-COMPANY-CD                PIC X.
  7449         16  PY-CARRIER                   PIC X.
  7450         16  PY-GROUPING                  PIC X(6).
  7451         16  PY-FIN-RESP                  PIC X(10).
  7452         16  PY-ACCOUNT                   PIC X(10).
  7453         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7454                                          PIC X(10).
  7455         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7456         16  PY-RECORD-TYPE               PIC X.
  7457             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7458             88  PY-DEPOSIT                   VALUE 'D'.
  7459             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7460             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7461             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7462             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7463             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7464             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7465             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7466             88  PY-FICA-ENTRY                VALUE 'F'.
  7467             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7468             88  PY-POLICY-FEE                VALUE 'W'.
  7469             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7470
  7471     12  PY-PYMT-TYPE                     PIC X.
  7472             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7473             88  PY-REINS-PYMT                VALUE 'R'.
  7474             88  PY-EXP-PYMT                  VALUE 'E'.
  7475
  7476     12  PY-BIL-INV                       PIC X(6).
  7477     12  PY-REF-NO                        PIC X(12).
  7478
  7479     12  PY-LAST-MAINT-DT                 PIC XX.
  7480     12  PY-LAST-MAINT-BY                 PIC X(4).
  7481     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7482
  7483     12  PY-PYADJ-RECORD.
  7484         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7485         16  PY-ENTRY-COMMENT             PIC X(30).
  7486         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7487             20  PY-GL-ACCOUNT            PIC X(10).
  7488             20  PY-GL-STATE              PIC X(02).
  7489             20  PY-GL-CANC-SW            PIC X(01).
  7490                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7491                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7492             20  PY-GL-COMMENT            PIC X(10).
  7493             20  FILLER      REDEFINES PY-GL-COMMENT.
  7494                 24  PY-GL-CHECK-NO       PIC 9(06).
  7495                 24  FILLER               PIC X(04).
  7496             20  FILLER                   PIC X(07).
  7497         16  PY-SAVE-ACCOUNT              PIC X(10).
  7498         16  PY-SAVE-TYPE                 PIC X(01).
  7499
  7500         16  PY-LETTERS.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 138
* EL6311.cbl
  7501             20  PY-LETTER OCCURS 3 TIMES
  7502                           INDEXED BY PY-LET-NDX
  7503                                          PIC X(04).
  7504
  7505         16  PY-ERCOMP-TYPE               PIC X.
  7506             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7507             88  PY-GA-TYPE                   VALUE 'G'.
  7508             88  PY-BANK-TYPE                 VALUE 'B'.
  7509         16  FILLER                       PIC X(05).
  7510
  7511     12  PY-RECORD-STATUS.
  7512         16  PY-CREDIT-SELECT-DT          PIC XX.
  7513         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7514         16  PY-BILLED-DATE               PIC XX.
  7515         16  PY-REPORTED-DT               PIC XX.
  7516         16  PY-PMT-APPLIED               PIC X.
  7517             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7518             88  PY-GA-PMT                    VALUE 'G'.
  7519             88  PY-OVWRITE-PMT               VALUE 'O'.
  7520             88  PY-NON-AR-PMT                VALUE 'N'.
  7521         16  FILLER                       PIC X(5).
  7522         16  PY-INPUT-DT                  PIC XX.
  7523         16  PY-CHECK-NUMBER              PIC X(6).
  7524         16  PY-VOID-SW                   PIC X.
  7525             88  PY-CHECK-VOIDED              VALUE 'V'.
  7526         16  PY-CHECK-ORIGIN-SW           PIC X.
  7527             88  PY-BILLING-CHECK             VALUE 'B'.
  7528             88  PY-REFUND-CHECK              VALUE 'R'.
  7529             88  PY-GA-CHECK                  VALUE 'G'.
  7530             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7531             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7532         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7533         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7534         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7535         16  PY-BILL-FLAG                 PIC X.
  7536             88  PY-BILLED                    VALUE 'B'.
  7537         16  PY-AR-FLAG                   PIC X.
  7538             88  PY-AR-CYCLE                  VALUE 'C'.
  7539             88  PY-AR-MONTH-END              VALUE 'M'.
  7540         16  PY-AR-DATE                   PIC XX.
  7541
  7542     12  PY-GL-CODES.
  7543         16  PY-GL-DB                     PIC X(14).
  7544         16  PY-GL-CR                     PIC X(14).
  7545         16  PY-GL-FLAG                   PIC X.
  7546         16  PY-GL-DATE                   PIC XX.
  7547
  7548     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7549     12  FILLER                           PIC X(3).
  7550******************************************************************
  7551*                                COPY ERCCNOT.
  7552******************************************************************
  7553*                                                                *
  7554*                            ERCCNOT                             *
  7555*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7556*                            VMOD=2.003                          *
  7557*                                                                *
  7558*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 139
* EL6311.cbl
  7559*                                                                *
  7560*        FILE TYPE= VSAM,KSDS                                    *
  7561*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7562*                                                                *
  7563*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7564*                                                                *
  7565*        LOG = YES                                               *
  7566*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7567*                                                                *
  7568******************************************************************
  7569*                   C H A N G E   L O G
  7570*
  7571* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7572*-----------------------------------------------------------------
  7573*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7574* EFFECTIVE    NUMBER
  7575*-----------------------------------------------------------------
  7576* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7577******************************************************************
  7578
  7579 01  CERT-NOTE-FILE.
  7580     12  CZ-RECORD-ID                PIC  XX.
  7581         88  VALID-CZ-ID                  VALUE 'CZ'.
  7582
  7583     12  CZ-CONTROL-PRIMARY.
  7584         16  CZ-COMPANY-CD           PIC X.
  7585         16  CZ-CARRIER              PIC X.
  7586         16  CZ-GROUPING.
  7587             20 CZ-GROUPING-PREFIX   PIC XXX.
  7588             20 CZ-GROUPING-PRIME    PIC XXX.
  7589         16  CZ-STATE                PIC XX.
  7590         16  CZ-ACCOUNT.
  7591             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7592             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7593         16  CZ-CERT-EFF-DT          PIC XX.
  7594         16  CZ-CERT-NO.
  7595             20  CZ-CERT-PRIME       PIC X(10).
  7596             20  CZ-CERT-SFX         PIC X.
  7597         16  CZ-RECORD-TYPE          PIC X.
  7598             88  CERT-NOTE           VALUE '1'.
  7599             88  CLAIM-CERT-NOTE     VALUE '2'.
  7600         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7601
  7602     12  CZ-LAST-MAINT-DT            PIC XX.
  7603     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7604     12  CZ-LAST-MAINT-USER          PIC X(4).
  7605
  7606     12  CZ-NOTE-INFORMATION.
  7607         16  CZ-NOTE                 PIC X(63).
  7608         16  FILLER                  PIC X(39).
  7609******************************************************************
  7610*                                COPY ELCMSTR.
  7611******************************************************************
  7612*                                                                *
  7613*                            ELCMSTR.                            *
  7614*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7615*                            VMOD=2.012                          *
  7616*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 140
* EL6311.cbl
  7617*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7618*                                                                *
  7619*   FILE TYPE = VSAM,KSDS                                        *
  7620*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7621*                                                                *
  7622*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7623*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7624*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7625*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7626*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7627*                                                 RKP=75,LEN=21  *
  7628*                                                                *
  7629*   **** NOTE ****                                               *
  7630*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7631*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7632*                                                                *
  7633*   LOG = YES                                                    *
  7634*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7635******************************************************************
  7636*                   C H A N G E   L O G
  7637*
  7638* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7639*-----------------------------------------------------------------
  7640*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7641* EFFECTIVE    NUMBER
  7642*-----------------------------------------------------------------
  7643* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7644* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7645* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7646* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7647* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7648* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7649* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7650******************************************************************
  7651 01  CLAIM-MASTER.
  7652     12  CL-RECORD-ID                PIC XX.
  7653         88  VALID-CL-ID         VALUE 'CL'.
  7654
  7655     12  CL-CONTROL-PRIMARY.
  7656         16  CL-COMPANY-CD           PIC X.
  7657         16  CL-CARRIER              PIC X.
  7658         16  CL-CLAIM-NO             PIC X(7).
  7659         16  CL-CERT-NO.
  7660             20  CL-CERT-PRIME       PIC X(10).
  7661             20  CL-CERT-SFX         PIC X.
  7662
  7663     12  CL-CONTROL-BY-NAME.
  7664         16  CL-COMPANY-CD-A1        PIC X.
  7665         16  CL-INSURED-LAST-NAME    PIC X(15).
  7666         16  CL-INSURED-NAME.
  7667             20  CL-INSURED-1ST-NAME PIC X(12).
  7668             20  CL-INSURED-MID-INIT PIC X.
  7669
  7670     12  CL-CONTROL-BY-SSN.
  7671         16  CL-COMPANY-CD-A2        PIC X.
  7672         16  CL-SOC-SEC-NO.
  7673             20  CL-SSN-STATE        PIC XX.
  7674             20  CL-SSN-ACCOUNT      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 141
* EL6311.cbl
  7675             20  CL-SSN-LN3          PIC X(3).
  7676
  7677     12  CL-CONTROL-BY-CERT-NO.
  7678         16  CL-COMPANY-CD-A4        PIC X.
  7679         16  CL-CERT-NO-A4.
  7680             20  CL-CERT-A4-PRIME    PIC X(10).
  7681             20  CL-CERT-A4-SFX      PIC X.
  7682
  7683     12  CL-CONTROL-BY-CCN.
  7684         16  CL-COMPANY-CD-A5        PIC X.
  7685         16  CL-CCN-A5.
  7686             20  CL-CCN.
  7687                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7688                 24  CL-CCN-PRIME-A5 PIC X(12).
  7689             20  CL-CCN-FILLER-A5    PIC X(4).
  7690
  7691     12  CL-INSURED-PROFILE-DATA.
  7692         16  CL-INSURED-BIRTH-DT     PIC XX.
  7693         16  CL-INSURED-SEX-CD       PIC X.
  7694             88  INSURED-IS-MALE        VALUE 'M'.
  7695             88  INSURED-IS-FEMALE      VALUE 'F'.
  7696             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7697         16  CL-INSURED-OCC-CD       PIC X(6).
  7698         16  FILLER                  PIC X(5).
  7699
  7700     12  CL-PROCESSING-INFO.
  7701         16  CL-PROCESSOR-ID         PIC X(4).
  7702         16  CL-CLAIM-STATUS         PIC X.
  7703             88  CLAIM-IS-OPEN          VALUE 'O'.
  7704             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7705         16  CL-CLAIM-TYPE           PIC X.
  7706*            88  AH-CLAIM               VALUE 'A'.
  7707*            88  LIFE-CLAIM             VALUE 'L'.
  7708*            88  PROPERTY-CLAIM         VALUE 'P'.
  7709*            88  IUI-CLAIM              VALUE 'I'.
  7710*            88  GAP-CLAIM              VALUE 'G'.
  7711*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7712*            88  OTHER-CLAIM            VALUE 'O'.
  7713         16  CL-CLAIM-PREM-TYPE      PIC X.
  7714             88  SINGLE-PREMIUM         VALUE '1'.
  7715             88  O-B-COVERAGE           VALUE '2'.
  7716             88  OPEN-END-COVERAGE      VALUE '3'.
  7717         16  CL-INCURRED-DT          PIC XX.
  7718         16  CL-REPORTED-DT          PIC XX.
  7719         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7720         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7721         16  CL-LAST-PMT-DT          PIC XX.
  7722         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7723         16  CL-PAID-THRU-DT         PIC XX.
  7724         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7725         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7726         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7727         16  CL-PMT-CALC-METHOD      PIC X.
  7728             88  CL-360-DAY-YR          VALUE '1'.
  7729             88  CL-365-DAY-YR          VALUE '2'.
  7730             88  CL-FULL-MONTHS         VALUE '3'.
  7731         16  CL-CAUSE-CD             PIC X(6).
  7732
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 142
* EL6311.cbl
  7733         16  CL-PRIME-CERT-NO.
  7734             20  CL-PRIME-CERT-PRIME PIC X(10).
  7735             20  CL-PRIME-CERT-SFX   PIC X.
  7736
  7737         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7738             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7739             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7740
  7741         16  CL-MICROFILM-NO         PIC X(10).
  7742         16  FILLER REDEFINES CL-MICROFILM-NO.
  7743             20  CL-BENEFIT-PERIOD   PIC 99.
  7744             20  FILLER              PIC X(8).
  7745         16  CL-PROG-FORM-TYPE       PIC X.
  7746         16  CL-LAST-ADD-ON-DT       PIC XX.
  7747
  7748         16  CL-LAST-REOPEN-DT       PIC XX.
  7749         16  CL-LAST-CLOSE-DT        PIC XX.
  7750         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7751             88  FINAL-PAID             VALUE '1'.
  7752             88  CLAIM-DENIED           VALUE '2'.
  7753             88  AUTO-CLOSE             VALUE '3'.
  7754             88  MANUAL-CLOSE           VALUE '4'.
  7755             88  BENEFITS-CHANGED       VALUE 'C'.
  7756             88  SETUP-ERRORS           VALUE 'E'.
  7757         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7758         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7759         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7760             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7761         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7762         16  FILLER                  PIC X.
  7763
  7764     12  CL-CERTIFICATE-DATA.
  7765         16  CL-CERT-ORIGIN          PIC X.
  7766             88  CERT-WAS-ONLINE        VALUE '1'.
  7767             88  CERT-WAS-CREATED       VALUE '2'.
  7768             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7769         16  CL-CERT-KEY-DATA.
  7770             20  CL-CERT-CARRIER     PIC X.
  7771             20  CL-CERT-GROUPING    PIC X(6).
  7772             20  CL-CERT-STATE       PIC XX.
  7773             20  CL-CERT-ACCOUNT.
  7774                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7775                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7776             20  CL-CERT-EFF-DT      PIC XX.
  7777
  7778     12  CL-STATUS-CONTROLS.
  7779         16  CL-PRIORITY-CD          PIC X.
  7780             88  CONFIDENTIAL-DATA      VALUE '8'.
  7781             88  HIGHEST-PRIORITY       VALUE '9'.
  7782         16  CL-SUPV-ATTN-CD         PIC X.
  7783             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7784             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7785         16  CL-PURGED-DT            PIC XX.
  7786         16  CL-RESTORED-DT          PIC XX.
  7787         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7788         16  CL-NEXT-RESEND-DT       PIC XX.
  7789         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7790         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 143
* EL6311.cbl
  7791*        16  FILLER                  PIC XX.
  7792         16  CL-LAST-MAINT-DT        PIC XX.
  7793         16  CL-LAST-MAINT-USER      PIC X(4).
  7794         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7795         16  CL-LAST-MAINT-TYPE      PIC X.
  7796             88  CLAIM-SET-UP           VALUE ' '.
  7797             88  PAYMENT-MADE           VALUE '1'.
  7798             88  LETTER-SENT            VALUE '2'.
  7799             88  MASTER-WAS-ALTERED     VALUE '3'.
  7800             88  MASTER-WAS-RESTORED    VALUE '4'.
  7801             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7802             88  FILE-CONVERTED         VALUE '6'.
  7803             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7804             88  ERROR-CORRECTION       VALUE 'E'.
  7805         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7806         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7807         16  CL-BENEFICIARY          PIC X(10).
  7808         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7809         16  CL-DENIAL-TYPE          PIC X.
  7810             88  CL-TYPE-DENIAL          VALUE '1'.
  7811             88  CL-TYPE-RESCISSION      VALUE '2'.
  7812             88  CL-TYPE-REFORMATION     VALUE '3'.
  7813             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7814             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7815         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7816         16  filler                  pic x(3).
  7817*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7818*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7819*        16  CL-RTW-DT               PIC XX.
  7820
  7821     12  CL-TRAILER-CONTROLS.
  7822         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7823             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7824             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7825             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7826         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7827         16  FILLER                  PIC XX.
  7828         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7829         16  CL-ADDRESS-TRAILER-CNT.
  7830             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7831                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7832             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7833                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7834             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7835                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7836             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7837                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7838             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7839                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7840             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7841                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7842             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7843                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7844
  7845     12  CL-CV-REFERENCE-NO.
  7846         16  CL-CV-REFNO-PRIME       PIC X(18).
  7847         16  CL-CV-REFNO-SFX         PIC XX.
  7848
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 144
* EL6311.cbl
  7849     12  CL-FILE-LOCATION            PIC X(4).
  7850
  7851     12  CL-PROCESS-ERRORS.
  7852         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7853             88  NO-FATAL-ERRORS        VALUE ZERO.
  7854         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7855             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7856
  7857     12  CL-PRODUCT-CD               PIC X.
  7858
  7859     12  CL-CURRENT-KEY-DATA.
  7860         16  CL-CURRENT-CARRIER      PIC X.
  7861         16  CL-CURRENT-GROUPING     PIC X(6).
  7862         16  CL-CURRENT-STATE        PIC XX.
  7863         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7864
  7865     12  CL-ASSOCIATES               PIC X.
  7866         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7867         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7868         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7869         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7870
  7871     12  CL-ACTIVITY-CODE            PIC 99.
  7872     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7873     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7874
  7875     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7876     12  CL-LAG-REPORT-CODE          PIC 9.
  7877     12  CL-LOAN-TYPE                PIC XX.
  7878     12  CL-LEGAL-STATE              PIC XX.
  7879
  7880     12  CL-YESNOSW                  PIC X.
  7881     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7882         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7883         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7884         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7885     12  cl-insured-type             pic x.
  7886         88  cl-claim-on-primary         value 'P'.
  7887         88  cl-claim-on-co-borrower     value 'C'.
  7888     12  cl-benefit-expiration-dt    PIC XX.
  7889*                                COPY ERCENDT.
  7890******************************************************************
  7891*                                                                *
  7892*                                                                *
  7893*                            ERCENDT.                            *
  7894*                            VMOD=2.001                          *
  7895*                                                                *
  7896*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7897*                                                                *
  7898*   FILE TYPE = VSAM,KSDS                                        *
  7899*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7900*                                                                *
  7901*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7902*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7903*                                                                *
  7904*   LOG = NO                                                     *
  7905*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7906******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 145
* EL6311.cbl
  7907*-----------------------------------------------------------------
  7908*                   C H A N G E   L O G
  7909*
  7910* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7911*-----------------------------------------------------------------
  7912*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7913* EFFECTIVE    NUMBER
  7914*-----------------------------------------------------------------
  7915* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7916*                                WITH OPEN CLAIMS
  7917* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7918* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7919* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7920* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7921*-----------------------------------------------------------------
  7922 01  ENDORSEMENT-RECORD.
  7923     12  EN-RECORD-ID                PIC XX.
  7924         88  VALID-EN-ID                VALUE 'EN'.
  7925     12  EN-CONTROL-PRIMARY.
  7926         16  EN-COMPANY-CD           PIC X.
  7927         16  EN-CARRIER              PIC X.
  7928         16  EN-GROUPING             PIC X(6).
  7929         16  EN-STATE                PIC XX.
  7930         16  EN-ACCOUNT              PIC X(10).
  7931         16  EN-CERT-EFF-DT          PIC XX.
  7932         16  EN-CERT-NO.
  7933             20  EN-CERT-PRIME       PIC X(10).
  7934             20  EN-CERT-SFX         PIC X.
  7935         16  EN-REC-TYPE             PIC X.
  7936             88  EN-ISSUE               VALUE 'I'.
  7937             88  EN-CANCELLATION        VALUE 'C'.
  7938         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7939     12  EN-CONTROL-BY-ARCH-NO.
  7940         16  EN-COMPANY-CD-A1              PIC X.
  7941         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7942     12  EN-LAST-MAINT-DT            PIC XX.
  7943     12  EN-LAST-MAINT-BY            PIC X(4).
  7944     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7945     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7946     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7947         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7948         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7949         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7950         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7951         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7952         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7953         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7954         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7955         16  EN-LF-ORIG-BENCD        PIC XX.
  7956         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7957         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7958         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7959         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7960         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7961         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7962*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7963         16  EN-ORIG-CRED-BENE       PIC X(25).
  7964         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 146
* EL6311.cbl
  7965         16  FILLER                  PIC X.
  7966         16  EN-AH-ORIG-BENCD        PIC XX.
  7967         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7968         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7969         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7970         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7971*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7972*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7973         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7974         16  F                       PIC X(09).
  7975         16  EN-AH-ORIG-CP           PIC 99.
  7976         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7977         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7978         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7979         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7980         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7981         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7982         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7983         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7984         16  EN-LF-NEW-BENCD         PIC XX.
  7985         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7986         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7987         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7988         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7989         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7990         16  EN-LF-NEW-EXP-DT        PIC XX.
  7991         16  EN-NEW-CRED-BENE        PIC X(25).
  7992         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7993         16  FILLER                  PIC X.
  7994         16  EN-AH-NEW-BENCD         PIC XX.
  7995         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7996         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7997         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7998         16  EN-AH-NEW-EXP-DT        PIC XX.
  7999*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8000*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8001*        16  F                       PIC X(12).
  8002         16  EN-AH-NEW-CP            PIC 99.
  8003         16  EN-SIG-SW               PIC X.
  8004         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8005         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8006         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8007         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8008         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8009         16  FILLER                  PIC X(33).
  8010     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8011         16  EN-LF-ORIG-REF-DT       PIC XX.
  8012         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8013         16  EN-AH-ORIG-REF-DT       PIC XX.
  8014         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8015         16  EN-LF-NEW-REF-DT        PIC XX.
  8016         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8017         16  EN-AH-NEW-REF-DT        PIC XX.
  8018         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8019         16  EN-FLAG-CERT            PIC X.
  8020         16  EN-INS-LAST-NAME        PIC X(15).
  8021         16  EN-INS-FIRST-NAME       PIC X(10).
  8022         16  EN-INS-MIDDLE-INIT      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 147
* EL6311.cbl
  8023         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8024         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8025         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8026         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8027         16  FILLER                  PIC X(262).
  8028     12  EN-MONEY-SW             PIC X.
  8029     12  EN-HEALTH-APP           PIC X.
  8030     12  EN-VOUCHER-SW           PIC X.
  8031     12  EN-PAYEE                PIC X(14).
  8032     12  EN-INPUT-DT             PIC XX.
  8033     12  EN-PROCESS-DT           PIC XX.
  8034     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8035     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8036     12  EN-REASON-CODES.
  8037         16  F OCCURS 12.
  8038             20  EN-REASON-CODE  PIC X(4).
  8039     12  EN-TEMPLATE-USED        PIC X(8).
  8040     12  EN-DOCU-TYPE            PIC X.
  8041         88  EN-VERI-DOCU          VALUE 'V'.
  8042         88  EN-GCE-DOCU           VALUE 'G'.
  8043         88  EN-CANC-DOCU          VALUE 'C'.
  8044     12  EN-COMMENTS1            PIC X(13).
  8045     12  EN-COMMENTS2            PIC X(70).
  8046     12  EN-COMM-CHGBK           PIC X.
  8047         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8048         88  EN-CHG-ACCT           VALUE 'Y'.
  8049     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8050     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8051     12  EN-BATCH-NUMBER         PIC X(6).
  8052     12  EN-ACCT-SUMM            PIC X.
  8053     12  EN-CSO-SUMM             PIC X.
  8054     12  en-check-type           pic x.
  8055     12  FILLER                  PIC X(12).
  8056******************************************************************
  8057*                                COPY ELCCRTT.
  8058******************************************************************
  8059*                                                                *
  8060*                            ELCCRTT.                            *
  8061*                                                                *
  8062*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8063*                                                                *
  8064*   FILE TYPE = VSAM,KSDS                                        *
  8065*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8066*                                                                *
  8067*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8068*                                                                *
  8069*   LOG = YES                                                    *
  8070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8071******************************************************************
  8072*                   C H A N G E   L O G
  8073*
  8074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8075*-----------------------------------------------------------------
  8076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8077* EFFECTIVE    NUMBER
  8078*-----------------------------------------------------------------
  8079* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8080* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 148
* EL6311.cbl
  8081* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8082* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8083* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8084* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8085* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8086* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8087* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8088* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8089* 091318  CR2018073000001  PEMA  ADD Refund methods
  8090* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8091******************************************************************
  8092
  8093 01  CERTIFICATE-TRAILERS.
  8094     12  CS-RECORD-ID                      PIC XX.
  8095         88  VALID-CS-ID                      VALUE 'CS'.
  8096
  8097     12  CS-CONTROL-PRIMARY.
  8098         16  CS-COMPANY-CD                 PIC X.
  8099         16  CS-CARRIER                    PIC X.
  8100         16  CS-GROUPING                   PIC X(6).
  8101         16  CS-STATE                      PIC XX.
  8102         16  CS-ACCOUNT                    PIC X(10).
  8103         16  CS-CERT-EFF-DT                PIC XX.
  8104         16  CS-CERT-NO.
  8105             20  CS-CERT-PRIME             PIC X(10).
  8106             20  CS-CERT-SFX               PIC X.
  8107         16  CS-TRAILER-TYPE               PIC X.
  8108             88  COMM-TRLR           VALUE 'A'.
  8109             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8110             88  CERT-DATA-TRLR      VALUE 'C'.
  8111
  8112     12  CS-DATA-AREA                      PIC X(516).
  8113
  8114     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8115         16  CS-BANK-COMMISSION-AREA.
  8116             20  CS-BANK-COMMS       OCCURS 10.
  8117                 24  CS-AGT                PIC X(10).
  8118                 24  CS-COM-TYP            PIC X.
  8119                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8120                 24  CS-RECALC-LV-INDIC    PIC X.
  8121                 24  FILLER                PIC X(10).
  8122         16  FILLER                        PIC X(256).
  8123
  8124     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8125****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8126         16  CS-MB-CLAIM-DATA OCCURS 24.
  8127             20  CS-CLAIM-NO               PIC X(7).
  8128             20  CS-CLAIM-TYPE             PIC X.
  8129                 88  CS-AH-CLM               VALUE 'A'.
  8130                 88  CS-IU-CLM               VALUE 'I'.
  8131                 88  CS-GP-CLM               VALUE 'G'.
  8132                 88  CS-LF-CLM               VALUE 'L'.
  8133                 88  CS-PR-CLM               VALUE 'P'.
  8134                 88  CS-FL-CLM               VALUE 'F'.
  8135                 88  CS-OT-CLM               VALUE 'O'.
  8136             20  CS-INSURED-TYPE           PIC X.
  8137                 88  CS-PRIM-INSURED          VALUE 'P'.
  8138                 88  CS-CO-BORROWER           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 149
* EL6311.cbl
  8139             20  CS-BENEFIT-PERIOD         PIC 99.
  8140             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8141             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8142             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8143         16  FILLER                        PIC X(12).
  8144     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8145         16  CS-VIN-NUMBER                 PIC X(17).
  8146         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8147         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8148         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8149         16  cs-agent-name.
  8150             20  cs-agent-fname            pic x(20).
  8151             20  cs-agent-mi               pic x.
  8152             20  cs-agent-lname            pic x(25).
  8153         16  cs-license-no                 pic x(15).
  8154         16  cs-npn-number                 pic x(10).
  8155         16  cs-agent-edit-status          pic x.
  8156             88  cs-ae-refer-to-manager      value 'M'.
  8157             88  cs-ae-cover-sheet           value 'C'.
  8158             88  cs-ae-sig-form              value 'S'.
  8159             88  cs-ae-verified              value 'V'.
  8160             88  cs-unidentified-signature   value 'U'.
  8161             88  cs-cert-returned            value 'R'.
  8162             88  cs-accept-no-commission     value 'N'.
  8163         16  cs-year                       pic 9999.
  8164         16  cs-make                       pic x(20).
  8165         16  cs-model                      pic x(20).
  8166         16  cs-future                     pic x(20).
  8167         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8168         16  cs-claim-verification-status  pic x.
  8169             88  cs-clm-ver-eligible         value 'A'.
  8170             88  cs-clm-ver-partial-elig     value 'B'.
  8171             88  cs-clm-ver-not-eligible     value 'C'.
  8172             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8173             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8174             88  cs-clm-ver-ND-CERT          value 'F'.
  8175             88  cs-clm-ver-spec-other       value 'G'.
  8176             88  cs-clam-ver-pratial-corrected
  8177                                             value 'H'.
  8178             88  cs-clm-ver-no-matches       value 'I'.
  8179             88  cs-clm-ver-not-elig-corrected
  8180                                             value 'J'.
  8181             88  cs-clm-ver-needs-review     value 'R'.
  8182             88  cs-clm-ver-sent-to-claims   value 'W'.
  8183         16  CS-LF-REFUND-METHOD           PIC X.
  8184         16  CS-AH-REFUND-METHOD           PIC X.
  8185         16  FILLER                        PIC X(353). *> was 420
  8186*        16  FILLER                        PIC X(496).
  8187*                                COPY ERCCHEK.
  8188******************************************************************
  8189*                                                                *
  8190*                                                                *
  8191*                            ERCCHEK                             *
  8192*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8193*                            VMOD=2.008                          *
  8194*                                                                *
  8195*   FILE DESCRIPTION = CHECK RECORDS                             *
  8196*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 150
* EL6311.cbl
  8197*   FILE TYPE = VSAM,KSDS                                        *
  8198*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8199*                                                                *
  8200*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8201*       ALTERNATE INDEX = NONE                                   *
  8202*                                                                *
  8203*   LOG = YES                                                    *
  8204*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8205******************************************************************
  8206*                   C H A N G E   L O G
  8207*
  8208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8209*-----------------------------------------------------------------
  8210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8211* EFFECTIVE    NUMBER
  8212*-----------------------------------------------------------------
  8213* 021414    2003053000001  PEMA  changes for auto chk request
  8214******************************************************************
  8215 01  CHECK-RECORDS.
  8216     12  CH-RECORD-ID                      PIC XX.
  8217         88  VALID-CH-ID                      VALUE 'CH'.
  8218
  8219     12  CH-CONTROL-PRIMARY.
  8220         16  CH-COMPANY-CD                 PIC X.
  8221         16  CH-CARRIER                    PIC X.
  8222         16  CH-GROUPING                   PIC X(6).
  8223         16  CH-STATE                      PIC XX.
  8224         16  CH-ACCOUNT                    PIC X(10).
  8225         16  CH-CERT-EFF-DT                PIC XX.
  8226         16  CH-CERT-NO.
  8227             20  CH-CERT-PRIME             PIC X(10).
  8228             20  CH-CERT-SFX               PIC X.
  8229         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8230
  8231     12  CH-RECORDED-DT                    PIC XX.
  8232     12  CH-RECORDED-BY                    PIC X(4).
  8233     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8234
  8235     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8236     12  CH-CHECK-NO                       PIC X(7).
  8237     12  CH-REASON-FOR-CHECK               PIC X(25).
  8238     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8239     12  FILLER                            PIC X.
  8240
  8241     12  CH-PAYEE-INFO.
  8242         16  CH-PAYEE-NAME-1               PIC X(30).
  8243         16  CH-PAYEE-NAME-2               PIC X(30).
  8244         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8245         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8246         16  CH-PAYEE-CITY-ST.
  8247             20  CH-PAYEE-CITY             PIC X(28).
  8248             20  CH-PAYEE-STATE            PIC XX.
  8249         16  CH-PAYEE-ZIP-CODE.
  8250             20  CH-PAYEE-ZIP.
  8251                 24  CH-ZIP-PRI-1ST        PIC X.
  8252                     88  CH-CANADIAN-POST-CODE
  8253                                           VALUES 'A' THRU 'Z'.
  8254                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 151
* EL6311.cbl
  8255             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8256         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8257             20  CH-CAN-POSTAL-1           PIC XXX.
  8258             20  CH-CAN-POSTAL-2           PIC XXX.
  8259             20  FILLER                    PIC XXX.
  8260
  8261     12  CH-CHECK-STUB-TEXT.
  8262         16  CH-STUB-LINE-1                PIC X(30).
  8263         16  CH-TEXT-LINE-1                PIC X(50).
  8264         16  CH-TEXT-LINE-2                PIC X(50).
  8265         16  CH-TEXT-LINE-3                PIC X(40).
  8266     12  CH-RETURN-TO                      PIC X(30).
  8267
  8268     12  CH-COMPENSATION-CONTROL.
  8269         16  CH-COMP-CARRIER               PIC X.
  8270         16  CH-COMP-GROUPING              PIC X(6).
  8271         16  CH-COMP-FIN-RESP              PIC X(10).
  8272         16  CH-COMP-ACCOUNT               PIC X(10).
  8273
  8274     12  CH-CREDIT-SELECT-DT               PIC XX.
  8275     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8276     12  CH-PAYEE-CODE                     PIC X(6).
  8277
  8278     12  CH-VOID-DATA.
  8279         20  CH-VOID-DT                    PIC XX.
  8280         20  CH-VOID-BY                    PIC X(4).
  8281         20  CH-VOID-REASON                PIC X(25).
  8282
  8283     12  CH-APPROVAL-DATA.
  8284         20  CH-APPROVAL-DT                PIC XX.
  8285         20  CH-APPROVAL-STATUS            PIC X.
  8286             88  CH-IN-LIMBO                  VALUE ' '.
  8287             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8288             88  CH-APPROVED                  VALUE 'A'.
  8289             88  CH-DENIED                    VALUE 'D'.
  8290         20  CH-APPROVED-BY                PIC XXXX.
  8291     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8292             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8293     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8294
  8295     12  ch-released-dt                    pic xx.
  8296     12  ch-check-cashed-dt                pic xx.
  8297     12  FILLER                            PIC X.
  8298*    12  CH-CHECK-REFERENCE                PIC X(12).
  8299     12  CH-CHECK-ORIGIN-SW                PIC X.
  8300             88  CH-REFUND-CHECK              VALUE 'R'.
  8301             88  CH-MAINT-CHECK               VALUE 'M'.
  8302
  8303     12  CH-CANC-DT                        PIC XX.
  8304     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8305     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8306
  8307     12  CH-INSURED-NAME                   PIC X(28).
  8308
  8309     12  ch-released-by                    pic x(4).
  8310     12  ch-csr                            pic x(4).
  8311     12  ch-deduct-commission              pic x.
  8312         88  ch-deduct-comm                  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 152
* EL6311.cbl
  8313         88  ch-do-not-deduct-comm           value 'N'.
  8314
  8315     12  FILLER                            PIC X(11).
  8316*    12  CH-LETTER-TABLE.
  8317*        16  CH-LETTERS OCCURS 3 TIMES
  8318*                       INDEXED BY CH-LT-NDX
  8319*                                          PIC X(04).
  8320
  8321     12  FILLER                            PIC X(07).
  8322
  8323 01  var                         pic x(30).
  8324 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8325                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8326                          PENDING-MAILING-DATA MAILING-DATA
  8327                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8328                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8329                          CLAIM-MASTER ENDORSEMENT-RECORD
  8330                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8331                          VAR.
  8332 0000-DFHEXIT SECTION.
  8333     MOVE '9#                    $   ' TO DFHEIV0.
  8334     MOVE 'EL6311' TO DFHEIV1.
  8335     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8336
  8337     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8338     MOVE EIBTRMID               TO QID-TERM.
  8339     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8340     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8341     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8342     MOVE 2                      TO EMI-SWITCH2.
  8343
  8344     move spaces to ws-kix-myenv
  8345     set P to address of KIXSYS
  8346     CALL "getenv" using by value P returning var-ptr
  8347     if var-ptr = null then
  8348        display ' kixsys not set '
  8349     else
  8350        set address of var to var-ptr
  8351        move 0 to env-var-len
  8352        inspect var tallying env-var-len
  8353          for characters before X'00'
  8354        unstring var (1:env-var-len) delimited by '/'
  8355           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8356              WS-KIX-SYS
  8357        end-unstring
  8358     end-if
  8359     perform varying a1 from +1 by +1 until a1 > +10
  8360        if ws-kix-myenv (a1:1) = low-values or high-values
  8361           display ' found low or hi val '
  8362           move spaces to ws-kix-myenv (a1:1)
  8363        end-if
  8364     end-perform
  8365*    display ' env *' ws-kix-myenv '*'
  8366     IF EIBCALEN = 0
  8367         GO TO 8800-UNAUTHORIZED-ACCESS.
  8368
  8369     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8370     MOVE '5'                   TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 153
* EL6311.cbl
  8371     PERFORM 9700-DATE-LINK.
  8372     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8373     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8374
  8375     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8376     MOVE SPACE                  TO DC-OPTION-CODE.
  8377     PERFORM 9700-DATE-LINK.
  8378     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8379     MOVE LOW-VALUES             TO EL631BI.
  8380
  8381
  8382* EXEC CICS HANDLE CONDITION
  8383*        PGMIDERR  (9600-PGMID-ERROR)
  8384*        ERROR     (9990-ABEND)
  8385*        INVREQ    (9990-ABEND)
  8386*        QIDERR    (0010-MAIN-LOGIC)
  8387*    END-EXEC.
  8388*    MOVE '"$L.8N                ! " #00008377' TO DFHEIV0
  8389     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8391     MOVE X'2220233030303038333737' TO DFHEIV0(25:11)
  8392     CALL 'kxdfhei1' USING DFHEIV0
  8393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8394
  8395
  8396     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8397         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8398             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8399             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8400             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8401             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8402             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8403             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8404             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8405             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8406
  8407             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8408                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8409
  8410             ELSE
  8411                 NEXT SENTENCE
  8412
  8413         ELSE
  8414             IF PI-CALLING-PROGRAM = 'EL6315'
  8415                SET CALLED-FROM-6315 TO TRUE
  8416             END-IF
  8417             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8418             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8419             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8420             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8421             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8422             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8423             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8424             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8425             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8426             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8427             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8428             GO TO 3900-RE-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 154
* EL6311.cbl
  8429     ELSE
  8430         GO TO 0020-MAIN-LOGIC.
  8431
  8432 0010-MAIN-LOGIC.
  8433     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8434                                    WS-FIRST-ENTRY-SW.
  8435
  8436     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8437
  8438     MOVE LOW-VALUES             TO EC-NEW-CERT
  8439                                    EC-NEW-STATE.
  8440
  8441     IF PI-DISPLAY-ORIGINAL-BATCH
  8442         NEXT SENTENCE
  8443     ELSE
  8444         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8445             GO TO 5000-BROWSE-BATCH-HEADERS.
  8446
  8447     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8448         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8449
  8450     IF PI-CSR-BROWSE
  8451        GO TO 4200-BROWSE-CSR-FORWARD.
  8452
  8453     IF PI-FILE-BROWSE
  8454         GO TO 4300-BROWSE-FILE-FORWARD.
  8455
  8456     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8457
  8458 0020-MAIN-LOGIC.
  8459     IF EIBAID = DFHCLEAR
  8460         GO TO 9400-CLEAR.
  8461
  8462     MOVE LOW-VALUES             TO EC-NEW-CERT
  8463                                    EC-NEW-STATE.
  8464
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 155
* EL6311.cbl
  8466
  8467******************************************************************
  8468*                                                                *
  8469*              R E C E I V E   M A P                             *
  8470*                                                                *
  8471******************************************************************
  8472
  8473 0200-RECEIVE.
  8474     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8475         MOVE ER-0008            TO EMI-ERROR
  8476         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8477         IF PI-MAP-NAME = EL631B
  8478             MOVE -1                 TO BMAINTL
  8479             GO TO 8200-SEND-DATAONLY
  8480         ELSE
  8481             IF PI-MAP-NAME = EL631C
  8482                 MOVE -1                 TO CMAINTL
  8483                 GO TO 8200-SEND-DATAONLY
  8484             ELSE
  8485                 IF PI-MAP-NAME = EL631D
  8486                     MOVE -1                 TO DPFENTRL
  8487                     GO TO 8200-SEND-DATAONLY.
  8488
  8489
  8490* EXEC CICS RECEIVE
  8491*        MAP      (PI-MAP-NAME)
  8492*        MAPSET   (MAPSET-EL6311S)
  8493*        INTO     (EL631BI)
  8494*    END-EXEC.
  8495     MOVE LENGTH OF
  8496      EL631BI
  8497       TO DFHEIV11
  8498*    MOVE '8"T I  L              ''   #00008477' TO DFHEIV0
  8499     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8500     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8501     MOVE X'2020233030303038343737' TO DFHEIV0(25:11)
  8502     CALL 'kxdfhei1' USING DFHEIV0,
  8503           PI-MAP-NAME,
  8504           EL631BI,
  8505           DFHEIV11,
  8506           MAPSET-EL6311S,
  8507           DFHEIV99,
  8508           DFHEIV99
  8509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8510
  8511
  8512******************************************************************
  8513*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8514******************************************************************
  8515
  8516     IF BTYPE-LEN (1) EQUAL +3
  8517        IF BTYPE (1) EQUAL ALL ' '
  8518            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8519
  8520     IF BTYPE-LEN (2) EQUAL +3
  8521        IF BTYPE (2) EQUAL ALL ' '
  8522            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8523
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 156
* EL6311.cbl
  8524     INSPECT EL631BI CONVERTING '_' TO ' '.
  8525
  8526     IF PI-MAP-NAME = EL631B
  8527         IF BPFENTRL GREATER THAN ZEROS
  8528             IF EIBAID NOT = DFHENTER
  8529                 MOVE ER-0004       TO EMI-ERROR
  8530                 MOVE -1            TO BPFENTRL
  8531                 MOVE AL-UNBOF      TO BPFENTRA
  8532                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8533                 GO TO 8200-SEND-DATAONLY
  8534             ELSE
  8535                 IF BPFENTRI NUMERIC AND
  8536                   (BPFENTRI GREATER 0 AND LESS 25)
  8537                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8538                 ELSE
  8539                     MOVE ER-0029  TO EMI-ERROR
  8540                     MOVE AL-UNBON TO BPFENTRA
  8541                     MOVE -1       TO BPFENTRL
  8542                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8543                     GO TO 8200-SEND-DATAONLY
  8544         ELSE
  8545             NEXT SENTENCE
  8546     ELSE
  8547         IF PI-MAP-NAME = EL631C
  8548            IF CPFENTRL GREATER THAN ZEROS
  8549                IF EIBAID NOT = DFHENTER
  8550                 MOVE ER-0004         TO EMI-ERROR
  8551                 MOVE -1              TO CPFENTRL
  8552                 MOVE AL-UNBOF        TO CPFENTRA
  8553                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8554                 GO TO 8200-SEND-DATAONLY
  8555             ELSE
  8556                 IF CPFENTRI NUMERIC AND
  8557                   (CPFENTRI GREATER 0 AND LESS 25)
  8558                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8559                 ELSE
  8560                     MOVE ER-0029      TO EMI-ERROR
  8561                     MOVE AL-UNBON     TO CPFENTRA
  8562                     MOVE -1           TO CPFENTRL
  8563                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8564                     GO TO 8200-SEND-DATAONLY
  8565         ELSE
  8566             NEXT SENTENCE
  8567     ELSE
  8568     IF PI-MAP-NAME = EL631D
  8569         IF DPFENTRL GREATER THAN ZEROS
  8570             IF EIBAID NOT = DFHENTER
  8571                 MOVE ER-0004         TO EMI-ERROR
  8572                 MOVE -1              TO DPFENTRL
  8573                 MOVE AL-UNBOF        TO DPFENTRA
  8574                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8575                 GO TO 8200-SEND-DATAONLY
  8576             ELSE
  8577                 IF DPFENTRI NUMERIC AND
  8578                   (DPFENTRI GREATER 0 AND LESS 25)
  8579                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8580                 ELSE
  8581                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 157
* EL6311.cbl
  8582                     MOVE AL-UNBON     TO DPFENTRA
  8583                     MOVE -1           TO DPFENTRL
  8584                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8585                     GO TO 8200-SEND-DATAONLY.
  8586
  8587     IF EIBAID = DFHPF23
  8588         GO TO 8810-PF23.
  8589
  8590     IF EIBAID = DFHPF24
  8591         GO TO 9200-RETURN-MAIN-MENU.
  8592
  8593     IF EIBAID = DFHPF12
  8594         GO TO 9500-PF12.
  8595
  8596     IF PI-MAP-NAME = EL631B
  8597        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8598
  8599     IF PI-MAP-NAME = EL631C
  8600        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8601
  8602     IF PI-MAP-NAME = EL631D
  8603        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8604
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 158
* EL6311.cbl
  8606
  8607******************************************************************
  8608*                                                                *
  8609*      ISSUE SCREEN PF KEY CHECKING                              *
  8610*                                                                *
  8611******************************************************************
  8612
  8613******************************************************************
  8614*                                                                *
  8615*      PF KEY FUNCTIONS:                                         *
  8616*                                                                *
  8617*      PF1  = BROWSE FORWARD                                     *
  8618*      PF2  = BROWSE BACKWARD                                    *
  8619*      PF3  = CERTIFICATE LOOKUP                                 *
  8620*      PF4  = DISPLAY BATCH HEADER                               *
  8621*      PF5  = ADD ISSUE  SCREEN                                  *
  8622*      PF6  = ADD CANCEL SCREEN                                  *
  8623*      PF7  = CERTIFICATE DISPLAY                                *
  8624*      PF8  = CERTIFICATE NOTES                                  *
  8625*      PF9  = EDIT CONTROL                                       *
  8626*      PF10 = DISPLAY LETTER SCREEN                              *
  8627*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8628*      PF12 = HELP SCREEN                                        *
  8629*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8630*      PF14 = ACCOUNT MASTER                                     *
  8631*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8632*      PF16 = DISPLAY LETTER REVIEW                              *
  8633*                                                                *
  8634******************************************************************
  8635
  8636 0300-CHECK-ISSUE-PF-KEYS.
  8637     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8638        MOVE ER-2337            TO EMI-ERROR
  8639        MOVE -1                  TO BMAINTL
  8640        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8641        GO TO 8200-SEND-DATAONLY.
  8642
  8643     IF EIBAID = DFHPF1
  8644        MOVE '0'                TO PI-EDIT-SW
  8645        IF PI-PRIMARY-BROWSE
  8646           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8647        ELSE
  8648           IF PI-PRIMARY-WITH-SELECT
  8649              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8650           ELSE
  8651              IF PI-FILE-BROWSE
  8652                 GO TO 4300-BROWSE-FILE-FORWARD
  8653              ELSE
  8654                 IF PI-CSR-BROWSE
  8655                    GO TO 4200-BROWSE-CSR-FORWARD
  8656                 ELSE
  8657                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8658
  8659     IF EIBAID = DFHPF2
  8660        MOVE '0'                TO PI-EDIT-SW
  8661        IF PI-PRIMARY-BROWSE
  8662           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8663        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 159
* EL6311.cbl
  8664           IF PI-PRIMARY-WITH-SELECT
  8665              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8666           ELSE
  8667              IF PI-FILE-BROWSE
  8668                 GO TO 4800-BROWSE-FILE-BACKWARD
  8669              ELSE
  8670                 IF PI-CSR-BROWSE
  8671                    GO TO 4900-BROWSE-CSR-BACKWARD
  8672                 ELSE
  8673                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8674
  8675     IF EIBAID = DFHPF3
  8676        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8677        MOVE XCTL-EL127         TO PGM-NAME
  8678        GO TO 9300-XCTL.
  8679
  8680     IF (EIBAID = DFHPF15 OR DFHPF6)
  8681        AND (CSR-EDIT-SESSION)
  8682*       AND (FATAL-OR-UNFORCED)
  8683*       AND (FATAL-ERRORS)
  8684        and (pi-6311-fatal-ctr <> +0)
  8685        MOVE ER-1819             TO EMI-ERROR
  8686        MOVE -1                  TO BMAINTL
  8687        MOVE AL-UANON            TO BMAINTA
  8688        PERFORM 9900-ERROR-FORMAT
  8689                                 THRU 9900-EXIT
  8690        GO TO 8200-SEND-DATAONLY
  8691     END-IF
  8692     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8693      OR (EIBAID = DFHPF10)
  8694        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8695        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8696        IF (RESP-NORMAL)
  8697           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8698              AM-CONTROL-PRIMARY (1:20))
  8699            IF AM-NAME NOT GREATER THAN SPACES OR
  8700               AM-ADDRS NOT GREATER THAN SPACES  OR
  8701               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8702               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8703               AM-ZIP NOT GREATER THAN SPACES
  8704               MOVE ER-3834             TO EMI-ERROR
  8705               MOVE -1                  TO BMAINTL
  8706               MOVE AL-UANON            TO BMAINTA
  8707               PERFORM 9900-ERROR-FORMAT
  8708                                 THRU 9900-EXIT
  8709               GO TO 8200-SEND-DATAONLY
  8710            END-IF
  8711        ELSE
  8712           MOVE ER-1609             TO EMI-ERROR
  8713           MOVE -1                  TO BMAINTL
  8714           MOVE AL-UANON            TO BMAINTA
  8715           PERFORM 9900-ERROR-FORMAT
  8716                                THRU 9900-EXIT
  8717           GO TO 8200-SEND-DATAONLY
  8718        END-IF
  8719
  8720        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8721        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 160
* EL6311.cbl
  8722        IF (ERMAIL-FOUND)
  8723            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8724               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8725               MA-CITY NOT GREATER THAN SPACES OR
  8726               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8727               MA-ZIP-CODE NOT GREATER THAN SPACES
  8728               MOVE ER-3835             TO EMI-ERROR
  8729               MOVE -1                  TO BMAINTL
  8730               MOVE AL-UANON            TO BMAINTA
  8731               PERFORM 9900-ERROR-FORMAT
  8732                                 THRU 9900-EXIT
  8733               GO TO 8200-SEND-DATAONLY
  8734            END-IF
  8735        ELSE
  8736           MOVE ER-3000             TO EMI-ERROR
  8737           MOVE -1                  TO BMAINTL
  8738           MOVE AL-UANON            TO BMAINTA
  8739           PERFORM 9900-ERROR-FORMAT
  8740                                THRU 9900-EXIT
  8741           GO TO 8200-SEND-DATAONLY
  8742        END-IF
  8743
  8744     END-IF
  8745     IF (EIBAID = DFHPF15)
  8746        AND (CSR-EDIT-SESSION)
  8747        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8748        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8749        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8750        MOVE PI-SV-STATE         TO PI-STATE
  8751        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8752        MOVE BCERTNOI            TO PI-CERT-PRIME
  8753        MOVE BSUFIXI             TO PI-CERT-SFX
  8754        MOVE BEFFDTI             TO DEEDIT-FIELD
  8755        PERFORM 8600-DEEDIT
  8756        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8757        MOVE '4'                 TO DC-OPTION-CODE
  8758        PERFORM 9700-DATE-LINK
  8759        IF DATE-CONVERSION-ERROR
  8760           MOVE ER-0348          TO EMI-ERROR
  8761           MOVE -1               TO BEFFDTL
  8762           MOVE AL-UABON         TO BEFFDTA
  8763           PERFORM 9900-ERROR-FORMAT
  8764                                 THRU 9900-EXIT
  8765           GO TO 8200-SEND-DATAONLY
  8766        ELSE
  8767           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8768           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8769           MOVE XCTL-EL6315      TO PGM-NAME
  8770           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8771           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8772           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8773           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8774           GO TO 9300-XCTL
  8775        END-IF
  8776     END-IF
  8777
  8778     IF EIBAID = DFHPF4
  8779        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 161
* EL6311.cbl
  8780        IF PI-DISPLAY-ORIGINAL-BATCH
  8781           NEXT SENTENCE
  8782        ELSE
  8783           GO TO 7200-DISPLAY-BATCHES.
  8784
  8785     IF EIBAID = DFHPF5
  8786        MOVE ER-0029                TO EMI-ERROR
  8787        MOVE -1                     TO BPFENTRL
  8788        MOVE AL-UNBON               TO BPFENTRA
  8789        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8790        GO TO 8200-SEND-DATAONLY.
  8791*        MOVE '0'                TO PI-EDIT-SW
  8792*        IF PI-DISPLAY-ORIGINAL-BATCH
  8793*           NEXT SENTENCE
  8794*        ELSE
  8795*           MOVE EL631B              TO PI-MAP-NAME
  8796*           MOVE LOW-VALUES          TO EL631BI
  8797*           MOVE 'A'                 TO BMAINTO
  8798*           MOVE AL-UANON            TO BMAINTA
  8799*           MOVE -1                  TO BMAINTL
  8800*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8801*           GO TO 8100-SEND-INITIAL-MAP.
  8802
  8803     IF EIBAID = DFHPF6
  8804        IF NOT CSR-EDIT-SESSION
  8805           MOVE ER-0029                TO EMI-ERROR
  8806           MOVE -1                     TO BPFENTRL
  8807           MOVE AL-UNBON               TO BPFENTRA
  8808           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8809           GO TO 8200-SEND-DATAONLY
  8810*           MOVE '0'              TO PI-EDIT-SW
  8811*           IF PI-DISPLAY-ORIGINAL-BATCH
  8812*              NEXT SENTENCE
  8813*           ELSE
  8814*              MOVE EL631C        TO PI-MAP-NAME
  8815*              MOVE LOW-VALUES    TO EL631CI
  8816*              MOVE 'A'           TO CMAINTO
  8817*              MOVE AL-UANON      TO CMAINTA
  8818*              MOVE -1            TO CMAINTL
  8819*              MOVE '6'           TO PI-MAINT-FUNCTION
  8820*              GO TO 8100-SEND-INITIAL-MAP
  8821*           END-IF
  8822        ELSE
  8823           PERFORM 5100-PROCESS-POL-RESC
  8824                                 THRU 5100-EXIT
  8825           MOVE  PI-PREV-CONTROL-PRIMARY
  8826                                 TO ERPNDB-KEY
  8827
  8828* EXEC CICS READ
  8829*              SET     (ADDRESS OF PENDING-BUSINESS)
  8830*              DATASET (FILE-ID-ERPNDB)
  8831*              RIDFLD  (ERPNDB-KEY)
  8832*          END-EXEC
  8833*    MOVE '&"S        E          (   #00008798' TO DFHEIV0
  8834     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8836     MOVE X'2020233030303038373938' TO DFHEIV0(25:11)
  8837     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 162
* EL6311.cbl
  8838           FILE-ID-ERPNDB,
  8839           DFHEIV20,
  8840           DFHEIV99,
  8841           ERPNDB-KEY,
  8842           DFHEIV99,
  8843           DFHEIV99,
  8844           DFHEIV99
  8845     SET ADDRESS OF PENDING-BUSINESS TO
  8846         DFHEIV20
  8847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8848           PERFORM 9800-LINK-PENDING-EDIT
  8849                                 THRU 9800-EXIT
  8850           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8851           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8852                                    PI-PREV-SEQ-NO
  8853           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8854*                                    WS-CANCEL-LETTER-SW
  8855                                    PI-ALL-ISSUES-SW
  8856                                    PI-ALL-CANCELS-SW
  8857           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8858        END-IF
  8859     END-IF
  8860     IF EIBAID = DFHPF7
  8861        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8862        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8863        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8864        MOVE PI-SV-STATE            TO PI-STATE
  8865        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8866        MOVE BCERTNOI               TO PI-CERT-PRIME
  8867        MOVE BSUFIXI                TO PI-CERT-SFX
  8868        MOVE BEFFDTI                TO DEEDIT-FIELD
  8869        PERFORM 8600-DEEDIT
  8870        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8871        MOVE '4'                    TO DC-OPTION-CODE
  8872        PERFORM 9700-DATE-LINK
  8873        IF DATE-CONVERSION-ERROR
  8874           MOVE ER-0348            TO EMI-ERROR
  8875           MOVE -1                  TO BEFFDTL
  8876           MOVE AL-UABON            TO BEFFDTA
  8877           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8878           GO TO 8200-SEND-DATAONLY
  8879        ELSE
  8880           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8881           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8882           MOVE XCTL-EL1273        TO PGM-NAME
  8883           GO TO 9300-XCTL.
  8884
  8885     IF EIBAID = DFHPF8
  8886        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8887        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8888        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8889        MOVE PI-SV-STATE            TO PI-STATE
  8890        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8891        MOVE BCERTNOI               TO PI-CERT-PRIME
  8892        MOVE BSUFIXI                TO PI-CERT-SFX
  8893        MOVE BEFFDTI                TO DEEDIT-FIELD
  8894        PERFORM 8600-DEEDIT
  8895        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 163
* EL6311.cbl
  8896        MOVE '4'                    TO DC-OPTION-CODE
  8897        PERFORM 9700-DATE-LINK
  8898        IF DATE-CONVERSION-ERROR
  8899           MOVE ER-0348            TO EMI-ERROR
  8900           MOVE -1                  TO BEFFDTL
  8901           MOVE AL-UABON            TO BEFFDTA
  8902           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8903           GO TO 8200-SEND-DATAONLY
  8904        ELSE
  8905           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8906           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8907           IF PI-COMPANY-ID = 'DMD'
  8908               MOVE XCTL-EL401DMD      TO PGM-NAME
  8909             ELSE
  8910               MOVE XCTL-EL1279        TO PGM-NAME
  8911           END-IF
  8912           GO TO 9300-XCTL.
  8913
  8914     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8915        MOVE XCTL-EL6312         TO PGM-NAME
  8916
  8917* EXEC CICS XCTL
  8918*           PROGRAM   (PGM-NAME)
  8919*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8920*           LENGTH    (WS-COMM-LENGTH)
  8921*       END-EXEC
  8922*    MOVE '.$C                   %   #00008871' TO DFHEIV0
  8923     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8924     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8925     MOVE X'2020233030303038383731' TO DFHEIV0(25:11)
  8926     CALL 'kxdfhei1' USING DFHEIV0,
  8927           PGM-NAME,
  8928           PROGRAM-INTERFACE-BLOCK,
  8929           WS-COMM-LENGTH,
  8930           DFHEIV99
  8931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8932     ELSE
  8933        MOVE '0'                 TO  PI-EDIT-SW.
  8934
  8935     IF  EIBAID = DFHPF10
  8936         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8937         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8938         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8939                                    PI-1042-WA
  8940         MOVE 4                  TO PI-689-DATA-SOURCE
  8941         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8942         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8943         MOVE PI-SV-STATE        TO PI-689-STATE
  8944         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8945         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8946         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8947         MOVE PI-PB-ALT-CHG-SEQ-NO
  8948                                 TO PI-689-ALT-SEQ-NO
  8949         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8950         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8951         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8952         MOVE +0                 TO PI-689-CONTROL
  8953         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 164
* EL6311.cbl
  8954                                    PI-689-EXP-DATE
  8955                                    PI-689-RESP-PERSON
  8956                                    PI-689-TYPE
  8957                                    PI-689-FOLLOW-UP-EDIT
  8958                                    PI-689-RESEND1-EDIT
  8959                                    PI-689-SEQ-EDIT
  8960                                    PI-689-BCSEQ-EDIT
  8961                                    PI-689-LBL-OVERRIDE
  8962         MOVE W-LETTER-COMMUNICATION-AREAS
  8963                                 TO PI-PROGRAM-WORK-AREA
  8964         MOVE XCTL-EL689         TO PGM-NAME
  8965         GO TO 9300-XCTL.
  8966
  8967     IF  EIBAID = DFHPF16
  8968         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8969         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8970         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8971                                    PI-1042-WA
  8972         MOVE 4                  TO PI-689-DATA-SOURCE
  8973         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8974         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8975         MOVE PI-SV-STATE        TO PI-689-STATE
  8976         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8977         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8978         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8979         MOVE PI-PB-ALT-CHG-SEQ-NO
  8980                                 TO PI-689-ALT-SEQ-NO
  8981         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8982         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8983         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8984         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8985         MOVE W-LETTER-COMMUNICATION-AREAS
  8986                                 TO PI-PROGRAM-WORK-AREA
  8987         MOVE XCTL-EL690         TO PGM-NAME
  8988         GO TO 9300-XCTL.
  8989
  8990     IF EIBAID = DFHPF13
  8991         MOVE XCTL-EL6313        TO PGM-NAME
  8992         GO TO 9300-XCTL.
  8993
  8994     IF EIBAID = DFHPF17
  8995        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8996        IF (PB-I-LOAN-APR numeric)
  8997           and (pb-i-loan-apr < 99.9999)
  8998           AND (PB-I-BENEFICIARY-NAME NOT
  8999              = SPACES AND LOW-VALUES)
  9000
  9001           MOVE LINK-ELVADS          TO PGM-NAME
  9002
  9003* EXEC CICS LINK
  9004*              PROGRAM    (PGM-NAME)
  9005*              COMMAREA   (WS-PASS-AREA)
  9006*              LENGTH     (WS-PASS-AREA-LENGTH)
  9007*          END-EXEC
  9008*    MOVE '."C                   (   #00008946' TO DFHEIV0
  9009     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9010     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9011     MOVE X'2020233030303038393436' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 165
* EL6311.cbl
  9012     CALL 'kxdfhei1' USING DFHEIV0,
  9013           PGM-NAME,
  9014           WS-PASS-AREA,
  9015           WS-PASS-AREA-LENGTH,
  9016           DFHEIV99,
  9017           DFHEIV99,
  9018           DFHEIV99,
  9019           DFHEIV99
  9020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9021
  9022           MOVE 0000             TO EMI-ERROR
  9023           MOVE -1               TO BMAINTL
  9024           PERFORM 9900-ERROR-FORMAT
  9025                                 THRU 9900-EXIT
  9026           GO TO 8200-SEND-DATAONLY
  9027        ELSE
  9028           MOVE ER-0877            TO EMI-ERROR
  9029           MOVE -1                  TO BEFFDTL
  9030           MOVE AL-UABON            TO BEFFDTA
  9031           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9032           GO TO 8200-SEND-DATAONLY
  9033        END-IF
  9034     END-IF
  9035     IF EIBAID = DFHPF14
  9036        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9037        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9038        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9039        MOVE PI-SV-STATE            TO PI-CR-STATE
  9040        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9041        MOVE SPACE                  TO PI-EDIT-SW
  9042        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9043        MOVE XCTL-EL650             TO PGM-NAME
  9044        GO TO 9300-XCTL.
  9045
  9046     IF EIBAID = DFHPF15
  9047        IF PI-COMPANY-ID  =  'HER'
  9048            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9049            MOVE XCTL-EL680         TO PGM-NAME
  9050            GO TO 9300-XCTL.
  9051
  9052     IF EIBAID = DFHENTER OR DFHPF11
  9053        GO TO 1000-ISSUE-MAINLINE.
  9054
  9055     MOVE ER-0029                TO EMI-ERROR
  9056     MOVE -1                     TO BPFENTRL
  9057     MOVE AL-UNBON               TO BPFENTRA
  9058     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9059     GO TO 8200-SEND-DATAONLY.
  9060
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 166
* EL6311.cbl
  9062
  9063******************************************************************
  9064*                                                                *
  9065*      CANCEL SCREEN PF KEY CHECKING                             *
  9066*                                                                *
  9067******************************************************************
  9068
  9069******************************************************************
  9070*                                                                *
  9071*      PF KEY FUNCTIONS:                                         *
  9072*                                                                *
  9073*      PF1  = BROWSE FORWARD                                     *
  9074*      PF2  = BROWSE BACKWARD                                    *
  9075*      PF3  = CERTIFICATE LOOKUP                                 *
  9076*      PF4  = DISPLAY BATCH HEADER                               *
  9077*      PF5  = ADD ISSUE SCREEN                                   *
  9078*      PF6  = ADD CANCEL SCREEN                                  *
  9079*      PF7  = CERTIFICATE DISPLAY                                *
  9080*      PF8  = CERTIFICATE NOTES                                  *
  9081*      PF9  = EDIT CONTROL                                       *
  9082*      PF10 = DISPLAY LETTER SCREEN                              *
  9083*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9084*      PF12 = DISPLAY HELP SCREEN                                *
  9085*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9086*      PF14 = ACCOUNT MASTER                                     *
  9087*      PF16 = LETTER REVIEW                                      *
  9088*                                                                *
  9089******************************************************************
  9090
  9091 0400-CHECK-CANCEL-PF-KEYS.
  9092     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9093        MOVE ER-2337             TO EMI-ERROR
  9094        MOVE -1                  TO CMAINTL
  9095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9096        GO TO 8200-SEND-DATAONLY.
  9097
  9098     IF EIBAID = DFHPF1
  9099        MOVE '0'                TO PI-EDIT-SW
  9100        IF PI-PRIMARY-BROWSE
  9101           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9102        ELSE
  9103           IF PI-PRIMARY-WITH-SELECT
  9104              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9105           ELSE
  9106              IF PI-FILE-BROWSE
  9107                 GO TO 4300-BROWSE-FILE-FORWARD
  9108              ELSE
  9109                 IF PI-CSR-BROWSE
  9110                    GO TO 4200-BROWSE-CSR-FORWARD
  9111                 ELSE
  9112                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9113
  9114     IF EIBAID = DFHPF2
  9115        MOVE '0'                TO PI-EDIT-SW
  9116        IF PI-PRIMARY-BROWSE
  9117           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9118        ELSE
  9119           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 167
* EL6311.cbl
  9120              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9121           ELSE
  9122              IF PI-FILE-BROWSE
  9123                 GO TO 4800-BROWSE-FILE-BACKWARD
  9124              ELSE
  9125                 IF PI-CSR-BROWSE
  9126                    GO TO 4900-BROWSE-CSR-BACKWARD
  9127                 ELSE
  9128                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9129
  9130     IF EIBAID = DFHPF3
  9131        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9132        MOVE XCTL-EL127         TO PGM-NAME
  9133        GO TO 9300-XCTL.
  9134
  9135     IF (EIBAID = DFHPF15 OR DFHPF17)
  9136        AND (CSR-EDIT-SESSION)
  9137*       AND (FATAL-OR-UNFORCED)
  9138        AND (FATAL-ERRORS)
  9139        MOVE ER-1819             TO EMI-ERROR
  9140        MOVE -1                  TO CMAINTL
  9141        MOVE AL-UANON            TO CMAINTA
  9142        PERFORM 9900-ERROR-FORMAT
  9143                                 THRU 9900-EXIT
  9144        GO TO 8200-SEND-DATAONLY
  9145     END-IF
  9146     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9147       AND (CSR-EDIT-SESSION)
  9148        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9149        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9150        IF (RESP-NORMAL)
  9151           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9152              AM-CONTROL-PRIMARY (1:20))
  9153            IF AM-NAME NOT GREATER THAN SPACES OR
  9154               AM-ADDRS NOT GREATER THAN SPACES  OR
  9155               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9156               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9157               AM-ZIP NOT GREATER THAN SPACES
  9158               MOVE ER-3834             TO EMI-ERROR
  9159               MOVE -1                  TO BMAINTL
  9160               MOVE AL-UANON            TO BMAINTA
  9161               PERFORM 9900-ERROR-FORMAT
  9162                                 THRU 9900-EXIT
  9163               GO TO 8200-SEND-DATAONLY
  9164            END-IF
  9165        ELSE
  9166           MOVE ER-1609             TO EMI-ERROR
  9167           MOVE -1                  TO BMAINTL
  9168           MOVE AL-UANON            TO BMAINTA
  9169           PERFORM 9900-ERROR-FORMAT
  9170                                THRU 9900-EXIT
  9171           GO TO 8200-SEND-DATAONLY
  9172        END-IF
  9173
  9174        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9175        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9176        IF (ERMAIL-FOUND)
  9177            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 168
* EL6311.cbl
  9178               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9179               MA-CITY NOT GREATER THAN SPACES OR
  9180               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9181               MA-ZIP-CODE NOT GREATER THAN SPACES
  9182               MOVE ER-3835             TO EMI-ERROR
  9183               MOVE -1                  TO BMAINTL
  9184               MOVE AL-UANON            TO BMAINTA
  9185               PERFORM 9900-ERROR-FORMAT
  9186                                 THRU 9900-EXIT
  9187               GO TO 8200-SEND-DATAONLY
  9188            END-IF
  9189        ELSE
  9190           MOVE ER-3000             TO EMI-ERROR
  9191           MOVE -1                  TO BMAINTL
  9192           MOVE AL-UANON            TO BMAINTA
  9193           PERFORM 9900-ERROR-FORMAT
  9194                                THRU 9900-EXIT
  9195           GO TO 8200-SEND-DATAONLY
  9196        END-IF
  9197
  9198     END-IF
  9199     IF (EIBAID = DFHPF15 OR DFHPF17)
  9200        AND (CSR-EDIT-SESSION)
  9201        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9202        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9203        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9204        MOVE PI-SV-STATE         TO PI-STATE
  9205        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9206        MOVE CCERTNOI            TO PI-CERT-PRIME
  9207        MOVE CSUFIXI             TO PI-CERT-SFX
  9208        MOVE CEFFDTI             TO DEEDIT-FIELD
  9209        PERFORM 8600-DEEDIT
  9210        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9211        MOVE '4'                 TO DC-OPTION-CODE
  9212        PERFORM 9700-DATE-LINK
  9213        IF DATE-CONVERSION-ERROR
  9214           MOVE ER-0348          TO EMI-ERROR
  9215           MOVE -1               TO CEFFDTL
  9216           MOVE AL-UABON         TO CEFFDTA
  9217           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9218           GO TO 8200-SEND-DATAONLY
  9219        ELSE
  9220           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9221           PERFORM 6000-CREATE-TEMP-STORAGE
  9222                                 THRU 6000-EXIT
  9223           IF EIBAID = DFHPF17
  9224               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9225                                  THRU 6400-EXIT
  9226               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9227                                 '2' AND '3' AND '4'
  9228                  MOVE ER-3831     TO  EMI-ERROR
  9229                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9230                  GO TO 8200-SEND-DATAONLY
  9231               END-IF
  9232               MOVE 'Y'          TO PI-CLM-RESC-IND
  9233           ELSE
  9234               MOVE 'N'          TO PI-CLM-RESC-IND
  9235           END-IF
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 169
* EL6311.cbl
  9236           MOVE XCTL-EL6316      TO PGM-NAME
  9237           MOVE '2'              TO PI-ISS-CAN-SW
  9238           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9239           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9240           GO TO 9300-XCTL
  9241        END-IF
  9242     END-IF
  9243
  9244     IF EIBAID = DFHPF4
  9245        MOVE '0'                TO PI-EDIT-SW
  9246        IF PI-DISPLAY-ORIGINAL-BATCH
  9247           NEXT SENTENCE
  9248        ELSE
  9249           GO TO 7200-DISPLAY-BATCHES.
  9250
  9251     IF EIBAID = DFHPF5
  9252        MOVE ER-0029                TO EMI-ERROR
  9253        MOVE -1                     TO BPFENTRL
  9254        MOVE AL-UNBON               TO BPFENTRA
  9255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9256        GO TO 8200-SEND-DATAONLY.
  9257*        MOVE '0'                TO PI-EDIT-SW
  9258*        IF PI-DISPLAY-ORIGINAL-BATCH
  9259*           NEXT SENTENCE
  9260*        ELSE
  9261*           MOVE EL631B              TO PI-MAP-NAME
  9262*           MOVE LOW-VALUES          TO EL631BI
  9263*           MOVE 'A'                 TO BMAINTO
  9264*           MOVE AL-UANON            TO BMAINTA
  9265*           MOVE -1                  TO BMAINTL
  9266*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9267*           GO TO 8100-SEND-INITIAL-MAP.
  9268
  9269     IF EIBAID = DFHPF6
  9270        MOVE ER-0029                TO EMI-ERROR
  9271        MOVE -1                     TO BPFENTRL
  9272        MOVE AL-UNBON               TO BPFENTRA
  9273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9274        GO TO 8200-SEND-DATAONLY.
  9275*        MOVE '0'                TO PI-EDIT-SW
  9276*        IF PI-DISPLAY-ORIGINAL-BATCH
  9277*           NEXT SENTENCE
  9278*        ELSE
  9279*           MOVE EL631C              TO PI-MAP-NAME
  9280*           MOVE LOW-VALUES          TO EL631CI
  9281*           MOVE 'A'                 TO CMAINTO
  9282*           MOVE AL-UANON            TO CMAINTA
  9283*           MOVE -1                  TO CMAINTL
  9284*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9285*           GO TO 8100-SEND-INITIAL-MAP.
  9286
  9287     IF EIBAID = DFHPF7
  9288        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9289        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9290        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9291        MOVE PI-SV-STATE            TO PI-STATE
  9292        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9293        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 170
* EL6311.cbl
  9294        MOVE CSUFIXI                TO PI-CERT-SFX
  9295        MOVE CEFFDTI                TO DEEDIT-FIELD
  9296        PERFORM 8600-DEEDIT
  9297        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9298        MOVE '4'                    TO DC-OPTION-CODE
  9299        PERFORM 9700-DATE-LINK
  9300        IF DATE-CONVERSION-ERROR
  9301           MOVE ER-0348            TO EMI-ERROR
  9302           MOVE -1                  TO BEFFDTL
  9303           MOVE AL-UABON            TO BEFFDTA
  9304           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9305           GO TO 8200-SEND-DATAONLY
  9306        ELSE
  9307           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9308           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9309           MOVE XCTL-EL1273        TO PGM-NAME
  9310           GO TO 9300-XCTL.
  9311
  9312     IF EIBAID = DFHPF8
  9313        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9314        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9315        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9316        MOVE PI-SV-STATE            TO PI-STATE
  9317        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9318        MOVE CCERTNOI               TO PI-CERT-PRIME
  9319        MOVE CSUFIXI                TO PI-CERT-SFX
  9320        MOVE CEFFDTI                TO DEEDIT-FIELD
  9321        PERFORM 8600-DEEDIT
  9322        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9323        MOVE '4'                    TO DC-OPTION-CODE
  9324        PERFORM 9700-DATE-LINK
  9325        IF DATE-CONVERSION-ERROR
  9326           MOVE ER-0348             TO EMI-ERROR
  9327           MOVE -1                  TO BEFFDTL
  9328           MOVE AL-UABON            TO BEFFDTA
  9329           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9330           GO TO 8200-SEND-DATAONLY
  9331        ELSE
  9332           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9333           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9334           IF PI-COMPANY-ID = 'DMD'
  9335               MOVE XCTL-EL401DMD      TO PGM-NAME
  9336             ELSE
  9337               MOVE XCTL-EL1279        TO PGM-NAME
  9338           END-IF
  9339           GO TO 9300-XCTL.
  9340
  9341     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9342        MOVE XCTL-EL6312     TO PGM-NAME
  9343
  9344* EXEC CICS XCTL
  9345*           PROGRAM  (PGM-NAME)
  9346*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9347*           LENGTH   (WS-COMM-LENGTH)
  9348*       END-EXEC
  9349*    MOVE '.$C                   %   #00009273' TO DFHEIV0
  9350     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9351     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 171
* EL6311.cbl
  9352     MOVE X'2020233030303039323733' TO DFHEIV0(25:11)
  9353     CALL 'kxdfhei1' USING DFHEIV0,
  9354           PGM-NAME,
  9355           PROGRAM-INTERFACE-BLOCK,
  9356           WS-COMM-LENGTH,
  9357           DFHEIV99
  9358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9359     ELSE
  9360        MOVE '0'                 TO  PI-EDIT-SW.
  9361
  9362     IF EIBAID = DFHPF10
  9363         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9364         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9365         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9366         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9367                                    PI-1042-WA
  9368         MOVE 4                  TO PI-689-DATA-SOURCE
  9369         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9370         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9371         MOVE PI-SV-STATE        TO PI-689-STATE
  9372         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9373         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9374         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9375         MOVE PI-PB-ALT-CHG-SEQ-NO
  9376                                 TO PI-689-ALT-SEQ-NO
  9377         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9378         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9379         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9380         MOVE +0                 TO PI-689-CONTROL
  9381         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9382                                    PI-689-EXP-DATE
  9383                                    PI-689-RESP-PERSON
  9384                                    PI-689-TYPE
  9385                                    PI-689-FOLLOW-UP-EDIT
  9386                                    PI-689-RESEND1-EDIT
  9387                                    PI-689-SEQ-EDIT
  9388                                    PI-689-BCSEQ-EDIT
  9389                                    PI-689-LBL-OVERRIDE
  9390         MOVE W-LETTER-COMMUNICATION-AREAS
  9391                                 TO PI-PROGRAM-WORK-AREA
  9392         MOVE XCTL-EL689         TO PGM-NAME
  9393         GO TO 9300-XCTL.
  9394
  9395     IF  EIBAID = DFHPF16
  9396         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9397         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9398         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9399                                    PI-1042-WA
  9400         MOVE 4                  TO PI-689-DATA-SOURCE
  9401         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9402         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9403         MOVE PI-SV-STATE        TO PI-689-STATE
  9404         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9405         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9406         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9407         MOVE PI-PB-ALT-CHG-SEQ-NO
  9408                                 TO PI-689-ALT-SEQ-NO
  9409         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 172
* EL6311.cbl
  9410         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9411         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9412         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9413         MOVE W-LETTER-COMMUNICATION-AREAS
  9414                                 TO PI-PROGRAM-WORK-AREA
  9415         MOVE XCTL-EL690         TO PGM-NAME
  9416         GO TO 9300-XCTL.
  9417     IF (EIBAID = DFHPF13)
  9418        if (not fatal-errors)
  9419           and (not unforced-errors)
  9420           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9421           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9422           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9423           MOVE PI-SV-STATE      TO PI-STATE
  9424           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9425           MOVE CCERTNOI         TO PI-CERT-PRIME
  9426           MOVE CSUFIXI          TO PI-CERT-SFX
  9427           MOVE CEFFDTI          TO DEEDIT-FIELD
  9428           PERFORM 8600-DEEDIT
  9429           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9430           MOVE '4'              TO DC-OPTION-CODE
  9431           PERFORM 9700-DATE-LINK
  9432           IF DATE-CONVERSION-ERROR
  9433              MOVE ER-0348       TO EMI-ERROR
  9434              MOVE -1            TO CEFFDTL
  9435              MOVE AL-UABON      TO CEFFDTA
  9436              PERFORM 9900-ERROR-FORMAT
  9437                                 THRU 9900-EXIT
  9438              GO TO 8200-SEND-DATAONLY
  9439           ELSE
  9440              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9441              MOVE AL-UANON      TO CEFFDTA
  9442              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9443              PERFORM 6000-CREATE-TEMP-STORAGE
  9444                                 THRU 6000-EXIT
  9445              MOVE XCTL-EL677    TO PGM-NAME
  9446              GO TO 9300-XCTL
  9447           end-if
  9448        else
  9449           MOVE ER-3444          TO EMI-ERROR
  9450           MOVE -1               TO CPFENTRL
  9451           MOVE AL-UNBON         TO CPFENTRA
  9452           PERFORM 9900-ERROR-FORMAT
  9453                                 THRU 9900-EXIT
  9454           GO TO 8200-SEND-DATAONLY
  9455        end-if
  9456     end-if
  9457
  9458     IF EIBAID = DFHPF14
  9459        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9460        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9461        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9462        MOVE PI-SV-STATE            TO PI-CR-STATE
  9463        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9464        MOVE SPACE                  TO PI-EDIT-SW
  9465        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9466        MOVE XCTL-EL650             TO PGM-NAME
  9467        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 173
* EL6311.cbl
  9468
  9469     IF EIBAID = DFHENTER OR DFHPF11
  9470        GO TO 2000-CANCEL-MAINLINE.
  9471
  9472     MOVE ER-0029                TO EMI-ERROR.
  9473     MOVE -1                     TO CPFENTRL.
  9474     MOVE AL-UNBON               TO CPFENTRA.
  9475     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9476     GO TO 8200-SEND-DATAONLY.
  9477
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 174
* EL6311.cbl
  9479
  9480******************************************************************
  9481*                                                                *
  9482*      BATCH SCREEN PF KEY CHECKING                              *
  9483*                                                                *
  9484******************************************************************
  9485
  9486******************************************************************
  9487*                                                                *
  9488*      PF KEY FUNCTIONS:                                         *
  9489*                                                                *
  9490*      PF1 = BROWSE FORWARD                                      *
  9491*      PF2 = BROWSE BACKWARD                                     *
  9492*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9493*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9494*                                                                *
  9495*                                                                *
  9496******************************************************************
  9497
  9498 0500-CHECK-BATCH-PF-KEYS.
  9499     IF EIBAID = DFHPF1
  9500        MOVE '0'                TO PI-EDIT-SW
  9501        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9502           GO TO 5000-BROWSE-BATCH-HEADERS
  9503        ELSE
  9504           IF PI-GOOD-BROWSE
  9505              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9506                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9507              ELSE
  9508                 IF PI-FILE-BROWSE
  9509                    GO TO 4300-BROWSE-FILE-FORWARD
  9510                 ELSE
  9511                    IF PI-CSR-BROWSE
  9512                       GO TO 4200-BROWSE-CSR-FORWARD
  9513                    ELSE
  9514                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9515           ELSE
  9516              GO TO 0800-BROWSE-ERROR.
  9517
  9518     IF EIBAID = DFHPF2
  9519        MOVE '0'                TO PI-EDIT-SW
  9520        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9521           GO TO 5500-BROWSE-BATCH-BACKWARD
  9522        ELSE
  9523           IF PI-GOOD-BROWSE
  9524              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9525                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9526              ELSE
  9527                 IF PI-FILE-BROWSE
  9528                    GO TO 4800-BROWSE-FILE-BACKWARD
  9529                 ELSE
  9530                    IF PI-CSR-BROWSE
  9531                       GO TO 4900-BROWSE-CSR-BACKWARD
  9532                    ELSE
  9533                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9534           ELSE
  9535              GO TO 0800-BROWSE-ERROR.
  9536
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 175
* EL6311.cbl
  9537     IF EIBAID = DFHPF3
  9538        GO TO 3000-BATCH-MAINLINE.
  9539
  9540     IF  EIBAID = DFHPF4
  9541        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9542        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9543        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9544        MOVE PI-SV-STATE            TO PI-CR-STATE
  9545        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9546                                       PI-CR-FIN-RESP
  9547        MOVE 'A'                    TO PI-CR-TYPE
  9548        MOVE SPACE                  TO PI-EDIT-SW
  9549        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9550        MOVE XCTL-EL640             TO PGM-NAME
  9551        GO TO 9300-XCTL.
  9552
  9553     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9554       AND
  9555        (EIBAID = DFHENTER)
  9556           GO TO 3500-EDIT-BATCH-DATA.
  9557
  9558     IF EIBAID = DFHENTER
  9559        GO TO 3500-EDIT-BATCH-DATA.
  9560
  9561     MOVE ER-0029             TO EMI-ERROR.
  9562     MOVE -1                  TO DPFENTRL.
  9563     MOVE AL-UNBON            TO DPFENTRA.
  9564     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9565     GO TO 8200-SEND-DATAONLY.
  9566
  9567 0800-BROWSE-ERROR.
  9568     MOVE ER-2258                TO EMI-ERROR.
  9569     MOVE -1                     TO DPFENTRL.
  9570     MOVE AL-UNBON               TO DPFENTRA.
  9571     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9572     GO TO 8200-SEND-DATAONLY.
  9573
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 176
* EL6311.cbl
  9575
  9576******************************************************************
  9577*                                                                *
  9578*                I S S U E   M A I N L I N E                     *
  9579*                                                                *
  9580******************************************************************
  9581
  9582 1000-ISSUE-MAINLINE.
  9583     IF PI-DISPLAY-ORIGINAL-BATCH
  9584        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9585           MOVE ER-0023             TO EMI-ERROR
  9586           MOVE -1                  TO BMAINTL
  9587           MOVE AL-UABON            TO BMAINTA
  9588           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9589           GO TO 8200-SEND-DATAONLY
  9590        ELSE
  9591           NEXT SENTENCE
  9592     ELSE
  9593        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9594           MOVE ER-0023             TO EMI-ERROR
  9595           MOVE -1                  TO BMAINTL
  9596           MOVE AL-UABON            TO BMAINTA
  9597           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9598           GO TO 8200-SEND-DATAONLY.
  9599
  9600     IF BMAINTI = 'S'
  9601        GO TO 1100-SHOW-REQUEST.
  9602
  9603     IF NOT MODIFY-CAP
  9604         MOVE 'UPDATE'       TO SM-READ
  9605         PERFORM 9995-SECURITY-VIOLATION
  9606         MOVE ER-0070        TO EMI-ERROR
  9607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9608         GO TO 8100-SEND-INITIAL-MAP.
  9609
  9610     IF BMAINTL GREATER THAN ZEROS
  9611        IF PI-PF5-FUNCTION
  9612           IF BMAINTI NOT = 'A'
  9613              MOVE AL-UABON  TO BMAINTA
  9614              MOVE -1        TO BMAINTL
  9615              MOVE ER-2260   TO EMI-ERROR
  9616              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9617              GO TO 8200-SEND-DATAONLY.
  9618
  9619     IF BCERTNOL = ZEROS
  9620       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9621         NEXT SENTENCE
  9622     ELSE
  9623         IF BCERTNOL NOT = ZEROS
  9624             MOVE AL-UANON       TO BCERTNOA
  9625         ELSE
  9626             MOVE -1             TO BCERTNOL
  9627             MOVE  1             TO SET-CURSOR-SW
  9628             MOVE ER-2218        TO EMI-ERROR
  9629             MOVE AL-UABON       TO BCERTNOA
  9630             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9631
  9632     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 177
* EL6311.cbl
  9633         MOVE AL-UANON       TO BSUFIXA
  9634     ELSE
  9635         MOVE AL-SANOF       TO BSUFIXA.
  9636
  9637
  9638* EXEC CICS READ
  9639*        DATASET (FILE-ID-ERPNDB)
  9640*        INTO    (PENDING-BUSINESS)
  9641*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9642*    END-EXEC.
  9643     MOVE LENGTH OF
  9644      PENDING-BUSINESS
  9645       TO DFHEIV11
  9646*    MOVE '&"IL       E          (   #00009556' TO DFHEIV0
  9647     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9648     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9649     MOVE X'2020233030303039353536' TO DFHEIV0(25:11)
  9650     CALL 'kxdfhei1' USING DFHEIV0,
  9651           FILE-ID-ERPNDB,
  9652           PENDING-BUSINESS,
  9653           DFHEIV11,
  9654           PI-PREV-CONTROL-PRIMARY,
  9655           DFHEIV99,
  9656           DFHEIV99,
  9657           DFHEIV99
  9658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9659
  9660
  9661     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9662        NEXT SENTENCE
  9663     ELSE
  9664        IF BEFFDTL NOT = ZEROS
  9665           MOVE AL-UNNON             TO BEFFDTA
  9666           MOVE BEFFDTI              TO DEEDIT-FIELD
  9667           PERFORM 8600-DEEDIT
  9668           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9669           MOVE 4                    TO DC-OPTION-CODE
  9670           PERFORM 9700-DATE-LINK
  9671           IF NO-CONVERSION-ERROR
  9672              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9673              ELSE
  9674              MOVE -1                TO BEFFDTL
  9675              MOVE  1                TO SET-CURSOR-SW
  9676              MOVE ER-2226           TO EMI-ERROR
  9677              MOVE AL-UNBON          TO BEFFDTA
  9678              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9679           ELSE
  9680              MOVE -1                TO BEFFDTL
  9681              MOVE  1                TO SET-CURSOR-SW
  9682              MOVE ER-2220           TO EMI-ERROR
  9683              MOVE AL-UNBON          TO BEFFDTA
  9684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9685
  9686     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9687
  9688     IF BCERTNOL NOT = ZEROS
  9689        MOVE BCERTNOI                TO WS-NEW-PRIME
  9690     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 178
* EL6311.cbl
  9691        MOVE SPACES                  TO WS-NEW-PRIME.
  9692
  9693     IF BSUFIXL NOT = ZEROS
  9694        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9695     ELSE
  9696        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9697
  9698     IF BEFFDTL NOT = ZEROS
  9699        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9700     ELSE
  9701        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9702
  9703     IF BMAINTI = 'A' OR 'K' OR 'S'
  9704        NEXT SENTENCE
  9705     ELSE
  9706        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9707        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9708           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9709           WS-PB-RECORD-TYPE NOT = '1'
  9710           IF BMAINTI = 'C'
  9711               MOVE ER-2287          TO EMI-ERROR
  9712               MOVE -1               TO BCERTNOL
  9713               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9714               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9715               GO TO 8200-SEND-DATAONLY
  9716             ELSE
  9717               MOVE ER-2260          TO EMI-ERROR
  9718               MOVE -1               TO BCERTNOL
  9719               MOVE AL-UABON         TO BCERTNOA
  9720               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9721               GO TO 8200-SEND-DATAONLY.
  9722
  9723     IF BMAINTI = 'D'
  9724         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9725
  9726*    IF BMICRNOL  NOT =  ZEROS
  9727*        IF BMICRNOI  NUMERIC
  9728*            MOVE AL-UNNON       TO  BMICRNOA
  9729*        ELSE
  9730*            MOVE -1             TO  BMICRNOL
  9731*            MOVE 1              TO  SET-CURSOR-SW
  9732*            MOVE AL-UNBON       TO  BMICRNOA
  9733*            MOVE ER-2701        TO  EMI-ERROR
  9734*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9735     IF BVINL NOT = ZEROS
  9736        MOVE AL-UANON            TO BVINA
  9737     END-IF
  9738
  9739     IF LETRREQL   GREATER THAN ZEROS
  9740        IF LETRREQI = 'Y'
  9741          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9742           CONTINUE
  9743        ELSE
  9744        IF LETRREQI = 'N'
  9745          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9746           CONTINUE
  9747        ELSE
  9748           MOVE -1               TO LETRREQL
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 179
* EL6311.cbl
  9749           MOVE ER-1585          TO EMI-ERROR
  9750           MOVE AL-UABON         TO LETRREQA
  9751           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9752        END-IF
  9753     END-IF.
  9754     IF B1STNML NOT = ZEROS
  9755         MOVE AL-UANON                TO B1STNMA.
  9756
  9757     IF BINITL  NOT = ZEROS
  9758        MOVE AL-UANON                TO BINITA.
  9759
  9760     IF BSEXL NOT = ZEROS
  9761        IF BSEXI = 'M' OR 'F'
  9762           MOVE AL-UANON             TO BSEXA
  9763        ELSE
  9764           MOVE -1               TO BSEXL
  9765           MOVE ER-2629          TO EMI-ERROR
  9766           MOVE AL-UABON         TO BSEXA
  9767           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9768
  9769     IF BAGEL NOT = ZEROS
  9770         IF BAGEI NUMERIC
  9771             MOVE BAGEI              TO WS-BAGE
  9772             MOVE AL-UNNON           TO BAGEA
  9773         ELSE
  9774             MOVE -1                 TO BAGEL
  9775             MOVE  1                 TO SET-CURSOR-SW
  9776             MOVE ER-2223            TO EMI-ERROR
  9777             MOVE AL-UNBON           TO BAGEA
  9778             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9779
  9780     IF BLSTNML NOT = ZERO  OR
  9781        B1STNML NOT = ZERO  OR
  9782        BINITL NOT = ZERO
  9783         IF BAGEL = ZEROS
  9784             MOVE -1                 TO BAGEL
  9785             MOVE  1                 TO SET-CURSOR-SW
  9786             MOVE ER-3269            TO EMI-ERROR
  9787             MOVE AL-UNBON           TO BAGEA
  9788             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9789         END-IF
  9790     END-IF.
  9791
  9792     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9793
  9794     IF (BBIRTHL GREATER THAN +0) AND
  9795        (BBIRTHI NOT EQUAL SPACES)
  9796        NEXT SENTENCE
  9797     ELSE
  9798        GO TO 1010-CHECK-AGE.
  9799
  9800     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9801     PERFORM 8600-DEEDIT.
  9802     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9803     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9804     MOVE AL-UNNON               TO BBIRTHA.
  9805     MOVE '4'                    TO DC-OPTION-CODE.
  9806     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 180
* EL6311.cbl
  9807     IF DATE-CONVERSION-ERROR
  9808        MOVE -1                  TO BBIRTHL
  9809        MOVE  1                  TO SET-CURSOR-SW
  9810        MOVE ER-2228             TO EMI-ERROR
  9811        MOVE AL-UNBON            TO BBIRTHA
  9812        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9813        GO TO 1010-CHECK-AGE.
  9814
  9815     IF (NO-CONVERSION-ERROR) AND
  9816        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9817        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9818        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9819        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9820                                    WS-CONVERTED-BIRTH
  9821        MOVE AL-UANON            TO BBIRTHA
  9822     ELSE
  9823        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9824        MOVE AL-UANON            TO BBIRTHA.
  9825
  9826 1010-CHECK-AGE.
  9827
  9828*    IF BAGEL = ZERO
  9829*       IF BBIRTHL GREATER THAN ZERO
  9830*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9831
  9832     IF B1STPMTL NOT = ZEROS
  9833        IF B1STPMTI = SPACES
  9834           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9835        ELSE
  9836           MOVE B1STPMTI             TO DEEDIT-FIELD
  9837           PERFORM 8600-DEEDIT
  9838           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9839           MOVE AL-UNNON             TO B1STPMTA
  9840           MOVE 4                    TO DC-OPTION-CODE
  9841           PERFORM 9700-DATE-LINK
  9842           IF NO-CONVERSION-ERROR
  9843              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9844              MOVE AL-UANON          TO B1STPMTA
  9845           ELSE
  9846              MOVE -1                TO B1STPMTL
  9847              MOVE  1                TO SET-CURSOR-SW
  9848              MOVE ER-2200           TO EMI-ERROR
  9849              MOVE AL-UNBON          TO B1STPMTA
  9850              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9851
  9852     IF BDAYSL NOT = ZEROS
  9853         IF BDAYSI NUMERIC
  9854             MOVE AL-UNNON           TO BDAYSA
  9855         ELSE
  9856             MOVE -1                 TO BDAYSL
  9857             MOVE ER-2530            TO EMI-ERROR
  9858             MOVE AL-UNBON           TO BDAYSA
  9859             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9860
  9861     IF BLNTRML NOT = ZEROS
  9862         IF BLNTRMI NUMERIC
  9863             MOVE AL-UNNON       TO BLNTRMA
  9864         ELSE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 181
* EL6311.cbl
  9865             MOVE -1             TO BLNTRML
  9866             MOVE ER-2533        TO EMI-ERROR
  9867             MOVE AL-UNBON       TO BLNTRMA
  9868             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9869
  9870**   IF PI-COMPANY-ID = 'DMD'
  9871     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9872        NEXT SENTENCE
  9873     ELSE
  9874         IF BLNOFCRL NOT = ZEROS
  9875            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9876            IF LOAN-OFFICER-FOUND
  9877                MOVE AL-UANON        TO BLNOFCRA
  9878             ELSE
  9879                 MOVE SPACE          TO WS-LOAN-OFFICER
  9880                 MOVE -1             TO BLNOFCRL
  9881                 MOVE  1             TO SET-CURSOR-SW
  9882                 MOVE ER-3006        TO EMI-ERROR
  9883                 MOVE AL-UNBON       TO BLNOFCRA
  9884                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9885
  9886     IF BFREQL NOT = ZEROS
  9887         IF BFREQI NUMERIC
  9888             MOVE AL-UNNON       TO BFREQA
  9889         ELSE
  9890             MOVE -1             TO BFREQL
  9891             MOVE  1             TO SET-CURSOR-SW
  9892             MOVE ER-2223        TO EMI-ERROR
  9893             MOVE AL-UNBON       TO BFREQA
  9894             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9895
  9896     IF BMODEL NOT = ZEROS
  9897         MOVE BMODEI             TO WS-MODE-CODE
  9898                                    PI-BMODE
  9899         IF WS-MODE-CODE-VALID
  9900             MOVE AL-UANON       TO BMODEA
  9901         ELSE
  9902             MOVE -1             TO BMODEL
  9903             MOVE ER-2591        TO EMI-ERROR
  9904             MOVE AL-UABON       TO BMODEA
  9905             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9906
  9907     IF BPMTSL NOT = ZEROS
  9908         IF BPMTSI NUMERIC
  9909             MOVE AL-UNNON           TO BPMTSA
  9910             MOVE BPMTSI             TO PI-BPMTS
  9911         ELSE
  9912             MOVE -1                 TO BPMTSL
  9913             MOVE ER-2592            TO EMI-ERROR
  9914             MOVE AL-UNBON           TO BPMTSA
  9915             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9916
  9917     IF BPMTAMTL NOT = ZEROS
  9918
  9919* EXEC CICS BIF DEEDIT
  9920*            FIELD  (BPMTAMTI)
  9921*            LENGTH (9)
  9922*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 182
* EL6311.cbl
  9923     MOVE 9
  9924       TO DFHEIV11
  9925*    MOVE '@"L                   #   #00009819' TO DFHEIV0
  9926     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9927     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9928     MOVE X'2020233030303039383139' TO DFHEIV0(25:11)
  9929     CALL 'kxdfhei1' USING DFHEIV0,
  9930           BPMTAMTI,
  9931           DFHEIV11
  9932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9933        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9934*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9935*        PERFORM 8600-DEEDIT
  9936*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9937
  9938*    IF BAPRL NOT = ZEROS
  9939*        EXEC CICS BIF DEEDIT
  9940*            FIELD  (BAPRI)
  9941*            LENGTH (7)
  9942*        END-EXEC
  9943*        MOVE BAPRI              TO WS-BAPR.
  9944
  9945     IF BAPRL > 0
  9946        MOVE +0                  TO  WS-BAPR
  9947        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9948           (WS-SUB > 7)
  9949           OR (BAPRI (WS-SUB:1) NUMERIC)
  9950           OR (BAPRI (WS-SUB:1) = '.')
  9951        END-PERFORM
  9952        IF WS-SUB > 7
  9953           MOVE ER-2471       TO EMI-ERROR
  9954           MOVE -1            TO BAPRL
  9955           MOVE AL-UNBON      TO BAPRA
  9956           PERFORM 9900-ERROR-FORMAT
  9957                                 THRU 9900-EXIT
  9958        ELSE
  9959           IF BAPRI (WS-SUB:1) NUMERIC
  9960              MOVE WS-SUB           TO WS-BEG
  9961              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9962                 (WS-SUB > 7)
  9963                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9964              END-PERFORM
  9965              COMPUTE WS-END = WS-SUB - WS-BEG
  9966              MOVE BAPRI (WS-BEG:WS-END)
  9967                                 TO WS-APR-WHOLE-NUM
  9968           END-IF
  9969           IF BAPRI (WS-SUB:1) = '.'
  9970              COMPUTE WS-BEG = WS-SUB + 1
  9971              IF (WS-BEG < 8)
  9972                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9973                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9974                    (WS-SUB > 7)
  9975                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9976                 END-PERFORM
  9977                 COMPUTE WS-END = WS-SUB - WS-BEG
  9978                 MOVE BAPRI (WS-BEG:WS-END)
  9979                                 TO WS-APR-DEC (1:WS-END)
  9980              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 183
* EL6311.cbl
  9981           END-IF
  9982           MOVE AL-UNNON      TO BAPRA
  9983           MOVE WS-BAPR       TO BAPRO
  9984        END-IF
  9985     END-IF
  9986*     IF BAPRL NOT = ZEROS
  9987*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9988*        PERFORM 8600-DEEDIT
  9989*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9990
  9991     IF BLIVESL NOT = ZEROS
  9992        MOVE BLIVESI             TO DEEDIT-FIELD
  9993        PERFORM 8600-DEEDIT
  9994        IF DEEDIT-FIELD-V0 NUMERIC
  9995           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9996           MOVE AL-UNNON         TO BLIVESA
  9997        ELSE
  9998           MOVE -1               TO BLIVESL
  9999           MOVE AL-UNBON         TO BLIVESA
 10000           MOVE ER-2223          TO EMI-ERROR
 10001           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10002
 10003*DMD CUSTOM CODING*************START
 10004*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
 10005     IF PI-COMPANY-ID NOT = 'DMD'
 10006         MOVE ZEROS               TO BBILLEDL
 10007         GO TO 1010-EDIT-CONT.
 10008
 10009     IF BBILLEDL NOT = ZEROS
 10010        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
 10011        MOVE 'Y'                 TO WS-NUMERIC-SW
 10012        MOVE +1                  TO WS-CSO-SUB
 10013        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
 10014        IF CSO-NUMERIC-FIELD
 10015
 10016* EXEC CICS BIF DEEDIT
 10017*              FIELD  (BBILLEDI)
 10018*              LENGTH (9)
 10019*          END-EXEC
 10020     MOVE 9
 10021       TO DFHEIV11
 10022*    MOVE '@"L                   #   #00009905' TO DFHEIV0
 10023     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10024     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10025     MOVE X'2020233030303039393035' TO DFHEIV0(25:11)
 10026     CALL 'kxdfhei1' USING DFHEIV0,
 10027           BBILLEDI,
 10028           DFHEIV11
 10029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10030           MOVE BBILLEDI         TO WS-BILLED
 10031           MOVE AL-UNNON         TO BBILLEDA
 10032        ELSE
 10033           MOVE -1               TO BBILLEDL
 10034           MOVE AL-UNBON         TO BBILLEDA
 10035           MOVE ER-2547          TO EMI-ERROR
 10036           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10037     ELSE
 10038        IF BMAINTI EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 184
* EL6311.cbl
 10039           MOVE -1               TO BBILLEDL
 10040           MOVE AL-UNBON         TO BBILLEDA
 10041           MOVE ER-8148          TO EMI-ERROR
 10042           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10043
 10044 1010-EDIT-CONT.
 10045
 10046     IF BFORCEL  NOT = ZEROS
 10047         IF FORCE-CAP
 10048            MOVE AL-UANON            TO BFORCEA
 10049         ELSE
 10050            MOVE ER-2945             TO EMI-ERROR
 10051            MOVE AL-UABON            TO BFORCEA
 10052            MOVE -1                  TO BFORCEL
 10053            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10054
 10055     if (bforcel not = zeros)
 10056        and (bforcei = 'L')
 10057        and (not csr-edit-session)
 10058        and (emi-error <> er-2945)
 10059        MOVE ER-2670             TO EMI-ERROR
 10060        MOVE AL-UABON            TO BFORCEA
 10061        MOVE -1                  TO BFORCEL
 10062        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10063     end-if
 10064     IF BENTRYL NOT = ZEROS
 10065        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
 10066                 'C' and 'D' AND 'V' AND 'U' AND 'M'
 10067           MOVE ER-2224              TO EMI-ERROR
 10068           MOVE AL-UABON             TO BENTRYA
 10069           MOVE -1                   TO BENTRYL
 10070           MOVE  1                   TO SET-CURSOR-SW
 10071           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10072        ELSE
 10073           MOVE AL-UANON             TO BENTRYA.
 10074
 10075     IF BUNWRITL NOT = ZEROS
 10076        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10077           MOVE ER-7574              TO EMI-ERROR
 10078           MOVE AL-UABON             TO BUNWRITA
 10079           MOVE -1                   TO BUNWRITL
 10080           MOVE  1                   TO SET-CURSOR-SW
 10081           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10082        ELSE
 10083           MOVE AL-UANON             TO BUNWRITA.
 10084
 10085     IF BREINL  NOT = ZEROS
 10086         MOVE AL-UANON               TO BREINA.
 10087
 10088     IF BBILCDL NOT = ZEROS
 10089        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10090                             AND 'A' AND 'B' AND 'E'
 10091           MOVE ER-2225              TO EMI-ERROR
 10092           MOVE AL-UABON             TO BBILCDA
 10093           MOVE -1                   TO BBILCDL
 10094           MOVE  1                   TO SET-CURSOR-SW
 10095           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10096        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 185
* EL6311.cbl
 10097           MOVE AL-UANON             TO BBILCDA.
 10098
 10099     IF BSKPCDL NOT = ZEROS
 10100         MOVE AL-UANON               TO BSKPCDA.
 10101
 10102     IF BINDGRPL NOT = ZEROS
 10103         MOVE AL-UANON               TO BINDGRPA.
 10104
 10105     IF BSIGL   NOT = ZEROS
 10106         MOVE AL-UANON               TO BSIGA.
 10107
 10108     IF BRTCLSL NOT = ZEROS
 10109         MOVE AL-UANON               TO BRTCLSA.
 10110
 10111     IF BMEMBERL NOT = ZEROS
 10112         MOVE AL-UANON               TO BMEMBERA.
 10113
 10114     MOVE +0                         TO WS-SUB1.
 10115
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 186
* EL6311.cbl
 10117
 10118******************************************************************
 10119*                                                                *
 10120*           E D I T   I S S U E   C O V E R A G E S              *
 10121*                                                                *
 10122******************************************************************
 10123
 10124 1020-EDIT-COVERAGES.
 10125     ADD +1                      TO WS-SUB1.
 10126
 10127     IF WS-SUB1 GREATER +2
 10128        GO TO 1025-EDIT-CONTINUE
 10129     END-IF
 10130
 10131     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10132       IF (BMODEL   GREATER ZERO  OR
 10133            BPMTSL   GREATER ZERO  OR
 10134            BPMTAMTL GREATER ZERO)
 10135          AND
 10136            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10137               GO TO 1021-CONT-EDIT.
 10138
 10139     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10140        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10141        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10142        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10143        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10144        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10145        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10146        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10147        NEXT SENTENCE
 10148         ELSE
 10149            GO TO 1020-EDIT-COVERAGES.
 10150
 10151 1021-CONT-EDIT.
 10152
 10153     IF BMAINTI = 'A'
 10154        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10155           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10156        ELSE
 10157           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10158           MOVE ER-7404          TO EMI-ERROR
 10159           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10160           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10161     ELSE
 10162        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10163           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10164
 10165     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10166        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10167        PERFORM 8600-DEEDIT
 10168        IF DEEDIT-FIELD-V0 NUMERIC
 10169           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10170        ELSE
 10171           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10172
 10173     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10174*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 187
* EL6311.cbl
 10175        IF BMODEL  GREATER THAN ZEROS  AND
 10176           BPMTSL  GREATER THAN ZEROS
 10177           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10178
 10179     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10180         IF BMODEL   GREATER THAN ZEROS  OR
 10181            BPMTSL   GREATER THAN ZEROS  OR
 10182            BPMTAMTL GREATER THAN ZEROS
 10183             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10184
 10185     IF BMAINTI = ('C' OR 'K')
 10186        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10187           NEXT SENTENCE
 10188        ELSE
 10189           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10190           PERFORM 8600-DEEDIT
 10191           IF DEEDIT-FIELD-V0 NUMERIC
 10192              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10193              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10194                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10195              ELSE
 10196                    MOVE ER-2241      TO EMI-ERROR
 10197                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10198                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10199                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10200           ELSE
 10201              MOVE ER-2223          TO EMI-ERROR
 10202              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10203              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10204              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10205     ELSE
 10206        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10207            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10208            PERFORM 8600-DEEDIT
 10209            IF DEEDIT-FIELD-V0      NUMERIC
 10210               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10211                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10212                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10213               ELSE
 10214                  MOVE ER-2241         TO EMI-ERROR
 10215                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10216                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10217                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10218            ELSE
 10219              MOVE ER-2223             TO EMI-ERROR
 10220              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10221              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10222              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10223        ELSE
 10224            MOVE ER-2240               TO EMI-ERROR
 10225            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10226            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10227*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10228*        IF BMODEL  GREATER THAN ZEROS  AND
 10229*           BPMTSL  GREATER THAN ZEROS
 10230*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10231
 10232     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 188
* EL6311.cbl
 10233        AND BMAINTI = ('C' OR 'K')
 10234           NEXT SENTENCE
 10235     ELSE
 10236        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10237           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10238
 10239* EXEC CICS BIF DEEDIT
 10240*              FIELD  (BBENI (WS-SUB1))
 10241*              LENGTH (12)
 10242*          END-EXEC
 10243     MOVE 12
 10244       TO DFHEIV11
 10245*    MOVE '@"L                   #   #00010117' TO DFHEIV0
 10246     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10247     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10248     MOVE X'2020233030303130313137' TO DFHEIV0(25:11)
 10249     CALL 'kxdfhei1' USING DFHEIV0,
 10250           BBENI(WS-SUB1),
 10251           DFHEIV11
 10252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10253           IF BBENI (WS-SUB1)  NUMERIC
 10254              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10255                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10256*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10257*          PERFORM 8600-DEEDIT
 10258*          IF DEEDIT-FIELD-V2  NUMERIC
 10259*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10260*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10261              ELSE
 10262                 MOVE ER-7632    TO EMI-ERROR
 10263                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10264                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10265                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10266           ELSE
 10267              MOVE ER-2223         TO EMI-ERROR
 10268              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10269              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10270              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10271        ELSE
 10272           MOVE ER-7632    TO EMI-ERROR
 10273           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10274           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10275           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10276
 10277     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10278        AND (BMAINTI = ('C' OR 'K'))
 10279        CONTINUE
 10280     ELSE
 10281        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10282           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10283           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10284              FOR ALL '.'
 10285           IF WS-TALLY > 1
 10286              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10287                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10288              END-PERFORM
 10289              IF A1 < 9
 10290                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 189
* EL6311.cbl
 10291                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10292              END-IF
 10293           ELSE
 10294              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10295                (A1 > 11)
 10296                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10297                  LOW-VALUES OR SPACES)
 10298              END-PERFORM
 10299              IF A1 > 1 AND < 12
 10300                 MOVE SPACES
 10301                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10302              END-IF
 10303           END-IF
 10304
 10305* EXEC CICS BIF DEEDIT
 10306*              FIELD  (BPREMI (WS-SUB1))
 10307*              LENGTH (11)
 10308*          END-EXEC
 10309     MOVE 11
 10310       TO DFHEIV11
 10311*    MOVE '@"L                   #   #00010172' TO DFHEIV0
 10312     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10313     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10314     MOVE X'2020233030303130313732' TO DFHEIV0(25:11)
 10315     CALL 'kxdfhei1' USING DFHEIV0,
 10316           BPREMI(WS-SUB1),
 10317           DFHEIV11
 10318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10319           IF BPREMI (WS-SUB1) NUMERIC
 10320              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10321                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10322*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10323*          PERFORM 8600-DEEDIT
 10324*          IF DEEDIT-FIELD-V2  NUMERIC
 10325*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10326*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10327              ELSE
 10328                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10329                    MOVE ER-7633    TO EMI-ERROR
 10330                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10331                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10332                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10333                 END-IF
 10334              END-IF
 10335           ELSE
 10336              MOVE ER-2223         TO EMI-ERROR
 10337              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10338              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10339              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10340           END-IF
 10341        ELSE
 10342           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10343              MOVE ER-7633         TO EMI-ERROR
 10344              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10345              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10346              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10347           END-IF
 10348        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 190
* EL6311.cbl
 10349     END-IF
 10350
 10351     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10352        NEXT SENTENCE
 10353     ELSE
 10354        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10355
 10356* EXEC CICS BIF DEEDIT
 10357*           FIELD  (BCPREMI (WS-SUB1))
 10358*           LENGTH (11)
 10359*       END-EXEC
 10360     MOVE 11
 10361       TO DFHEIV11
 10362*    MOVE '@"L                   #   #00010212' TO DFHEIV0
 10363     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10364     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10365     MOVE X'2020233030303130323132' TO DFHEIV0(25:11)
 10366     CALL 'kxdfhei1' USING DFHEIV0,
 10367           BCPREMI(WS-SUB1),
 10368           DFHEIV11
 10369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10370        IF BCPREMI (WS-SUB1) NUMERIC
 10371           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10372*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10373*       PERFORM 8600-DEEDIT
 10374*       IF DEEDIT-FIELD-V2  NUMERIC
 10375*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10376        ELSE
 10377           MOVE ER-2223         TO EMI-ERROR
 10378           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10379           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10380           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10381
 10382     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10383        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10384        PERFORM 8600-DEEDIT
 10385        IF DEEDIT-FIELD-V0 NUMERIC
 10386           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10387           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10388         ELSE
 10389           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10390           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10391           MOVE ER-2223              TO EMI-ERROR
 10392           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10393
 10394     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10395        IF BEXPIRE   (WS-SUB1) = SPACES
 10396           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10397        ELSE
 10398           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10399           PERFORM 8600-DEEDIT
 10400           IF DEEDIT-FIELD-V0        NUMERIC
 10401              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10402              MOVE 4                TO DC-OPTION-CODE
 10403              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10404              PERFORM 9700-DATE-LINK
 10405              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10406                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 191
* EL6311.cbl
 10407              IF NO-CONVERSION-ERROR
 10408                 NEXT SENTENCE
 10409              ELSE
 10410                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10411                 MOVE ER-2531    TO EMI-ERROR
 10412                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10413                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10414           ELSE
 10415             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10416             MOVE ER-2532        TO EMI-ERROR
 10417             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10418             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10419
 10420     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10421        NEXT SENTENCE
 10422     ELSE
 10423
 10424* EXEC CICS BIF DEEDIT
 10425*           FIELD  (BALT-BENI (WS-SUB1))
 10426*           LENGTH (12)
 10427*       END-EXEC
 10428     MOVE 12
 10429       TO DFHEIV11
 10430*    MOVE '@"L                   #   #00010269' TO DFHEIV0
 10431     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10432     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10433     MOVE X'2020233030303130323639' TO DFHEIV0(25:11)
 10434     CALL 'kxdfhei1' USING DFHEIV0,
 10435           BALT-BENI(WS-SUB1),
 10436           DFHEIV11
 10437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10438        IF BALT-BENI (WS-SUB1) NUMERIC
 10439           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10440*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10441*       PERFORM 8600-DEEDIT
 10442*       IF DEEDIT-FIELD-V0 NUMERIC
 10443*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10444        ELSE
 10445           MOVE ER-2223         TO EMI-ERROR
 10446           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10447           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10448           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10449
 10450     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10451        NEXT SENTENCE
 10452     ELSE
 10453
 10454* EXEC CICS BIF DEEDIT
 10455*           FIELD  (BALT-PREMI (WS-SUB1))
 10456*           LENGTH (11)
 10457*       END-EXEC
 10458     MOVE 11
 10459       TO DFHEIV11
 10460*    MOVE '@"L                   #   #00010288' TO DFHEIV0
 10461     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10462     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10463     MOVE X'2020233030303130323838' TO DFHEIV0(25:11)
 10464     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 192
* EL6311.cbl
 10465           BALT-PREMI(WS-SUB1),
 10466           DFHEIV11
 10467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10468        IF BALT-PREMI (WS-SUB1) NUMERIC
 10469           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10470*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10471*       PERFORM 8600-DEEDIT
 10472*       IF DEEDIT-FIELD-V0 NUMERIC
 10473*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10474        ELSE
 10475           MOVE ER-2223         TO EMI-ERROR
 10476           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10477           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10478           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10479
 10480      GO TO 1020-EDIT-COVERAGES.
 10481     .
 10482 1025-edit-continue.
 10483     IF PI-COMPANY-ID  =  'DMD'
 10484        MOVE LOW-VALUES             TO BNCERTI
 10485                                       BNSTATI.
 10486
 10487     IF EMI-ERROR = ZEROS
 10488         NEXT SENTENCE
 10489     ELSE
 10490         GO TO 8200-SEND-DATAONLY.
 10491
 10492     IF BMAINTI = 'A'
 10493         GO TO 1200-ADD-ISSUE-ROUTINE.
 10494
 10495     IF BMAINTI = 'C'
 10496         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10497
 10498     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10499
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 193
* EL6311.cbl
 10501
 10502 1030-EDIT-FOR-NUMERICS.
 10503     IF WS-CSO-SUB EQUAL 10
 10504        GO TO 1030-EDIT-EXIT.
 10505
 10506     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10507        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10508        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10509           ADD +1               TO WS-CSO-SUB
 10510           GO TO 1030-EDIT-FOR-NUMERICS.
 10511
 10512     MOVE 'N'                   TO WS-NUMERIC-SW.
 10513
 10514 1030-EDIT-EXIT.
 10515******************************************************************
 10516*                                                                *
 10517*                 C A L C U L A T E   A G E                      *
 10518*                                                                *
 10519******************************************************************
 10520
 10521
 10522 1095-CALC-AGE.
 10523
 10524     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10525     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10526     MOVE 1                  TO DC-OPTION-CODE.
 10527     PERFORM 9700-DATE-LINK
 10528     IF NO-CONVERSION-ERROR
 10529         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10530         MOVE WS-BAGE            TO BAGEI
 10531         MOVE +2                 TO BAGEL
 10532         MOVE AL-UNNON TO BAGEA.
 10533
 10534 1099-EXIT.
 10535     EXIT.
 10536
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 194
* EL6311.cbl
 10538
 10539******************************************************************
 10540*                                                                *
 10541*                   S H O W   I S S U E                          *
 10542*                                                                *
 10543******************************************************************
 10544
 10545 1100-SHOW-REQUEST.
 10546     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10547
 10548     IF BCERTNOL = ZEROS AND
 10549        BEFFDTL  = ZEROS
 10550        MOVE -1                  TO BMAINTL
 10551        GO TO 8200-SEND-DATAONLY.
 10552
 10553     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10554
 10555     IF BSUFIXL NOT = ZEROS
 10556        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10557     ELSE
 10558        MOVE SPACE               TO WS-NEW-SUFFIX.
 10559
 10560     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10561     PERFORM 8600-DEEDIT.
 10562     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10563     MOVE '4'                    TO DC-OPTION-CODE.
 10564     PERFORM 9700-DATE-LINK.
 10565     IF DATE-CONVERSION-ERROR
 10566        MOVE ER-0348             TO EMI-ERROR
 10567        MOVE -1                  TO BEFFDTL
 10568        MOVE AL-UABON            TO BEFFDTA
 10569        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10570        GO TO 8200-SEND-DATAONLY
 10571     ELSE
 10572        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10573        MOVE AL-UANON            TO BEFFDTA
 10574        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10575
 10576     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10577
 10578     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10579        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10580          MOVE 'Y'                    TO WS-SHOW-SW
 10581          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10582             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10583           ELSE
 10584             IF PI-FILE-BROWSE
 10585                GO TO 4300-BROWSE-FILE-FORWARD
 10586              ELSE
 10587                IF PI-CSR-BROWSE
 10588                   GO TO 4200-BROWSE-CSR-FORWARD
 10589                ELSE
 10590                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10591        ELSE
 10592           GO TO 3900-RE-DISPLAY-RECORD.
 10593
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 195
* EL6311.cbl
 10595
 10596******************************************************************
 10597*                                                                *
 10598*            A D D   I S S U E   R O U T I N E                   *
 10599*                                                                *
 10600******************************************************************
 10601
 10602***************************************************************
 10603*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10604*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10605*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10606*     4. LINK TO THE EDIT ROUTINE.                            *
 10607*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10608*     6. WRITE THE NEW ISSUE RECORD.                          *
 10609*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10610*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10611*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10612*        ELSE                                                 *
 10613*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10614***************************************************************
 10615
 10616 1200-ADD-ISSUE-ROUTINE.
 10617     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10618
 10619
 10620* EXEC CICS GETMAIN
 10621*        SET     (ADDRESS OF PENDING-BUSINESS)
 10622*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10623*    END-EXEC.
 10624*    MOVE '," L                  $   #00010443' TO DFHEIV0
 10625     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10626     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10627     MOVE X'2020233030303130343433' TO DFHEIV0(25:11)
 10628     CALL 'kxdfhei1' USING DFHEIV0,
 10629           DFHEIV20,
 10630           ERPNDB-RECORD-LENGTH,
 10631           DFHEIV99
 10632     SET ADDRESS OF PENDING-BUSINESS TO
 10633         DFHEIV20
 10634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10635
 10636
 10637
 10638* EXEC CICS HANDLE CONDITION
 10639*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10640*    END-EXEC.
 10641*    MOVE '"$I                   ! # #00010448' TO DFHEIV0
 10642     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10644     MOVE X'2320233030303130343438' TO DFHEIV0(25:11)
 10645     CALL 'kxdfhei1' USING DFHEIV0
 10646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10647
 10648
 10649     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10650     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10651     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10652
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 196
* EL6311.cbl
 10653
 10654* EXEC CICS READ
 10655*        INTO    (PENDING-BUSINESS)
 10656*        DATASET (FILE-ID-ERPNDB)
 10657*        RIDFLD  (ERPNDB-KEY)
 10658*    END-EXEC.
 10659     MOVE LENGTH OF
 10660      PENDING-BUSINESS
 10661       TO DFHEIV11
 10662*    MOVE '&"IL       E          (   #00010456' TO DFHEIV0
 10663     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10665     MOVE X'2020233030303130343536' TO DFHEIV0(25:11)
 10666     CALL 'kxdfhei1' USING DFHEIV0,
 10667           FILE-ID-ERPNDB,
 10668           PENDING-BUSINESS,
 10669           DFHEIV11,
 10670           ERPNDB-KEY,
 10671           DFHEIV99,
 10672           DFHEIV99,
 10673           DFHEIV99
 10674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10675
 10676
 10677     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10678
 10679     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10680     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10681     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10682     MOVE SPACES                 TO PENDING-BUSINESS.
 10683     MOVE 'PB'                   TO PB-RECORD-ID.
 10684     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10685     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10686     MOVE SPACES                 TO PB-CERT-SFX.
 10687     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10688     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10689                                    PB-ALT-CHG-SEQ-NO.
 10690
 10691     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10692     MOVE '1'                    TO PB-RECORD-TYPE.
 10693
 10694     IF BSUFIXL NOT = ZEROS
 10695        MOVE BSUFIXI             TO PB-CERT-SFX.
 10696
 10697     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10698
 10699     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10700     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10701
 10702     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10703                                    PB-I-LF-PREM-CALC
 10704                                    PB-I-LF-ALT-PREM-CALC
 10705                                    PB-I-LF-RATE
 10706                                    PB-I-LF-ALT-RATE
 10707                                    PB-I-LF-REI-RATE
 10708                                    PB-I-LF-ALT-REI-RATE
 10709                                    PB-I-RATE-DEV-PCT-LF
 10710                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 197
* EL6311.cbl
 10711                                    PB-I-AH-RATE
 10712                                    PB-I-AH-REI-RATE
 10713                                    PB-I-AH-RATE-TRM
 10714                                    PB-I-RATE-DEV-PCT-AH
 10715                                    PB-I-BUSINESS-TYPE
 10716                                    PB-I-LIFE-COMMISSION
 10717                                    PB-I-JOINT-COMMISSION
 10718                                    PB-I-JOINT-AGE
 10719                                    PB-I-AH-COMMISSION
 10720                                    PB-I-CURR-SEQ
 10721                                    PB-CHG-COUNT
 10722                                    PB-LF-BILLED-AMTS
 10723                                    PB-AH-BILLED-AMTS
 10724                                    PB-CALC-TOLERANCE
 10725                                    PB-I-EXTENTION-DAYS
 10726*                                   PB-I-MICROFILM-NO
 10727                                    PB-I-TERM-IN-DAYS.
 10728
 10729     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10730                                    PB-I-LF-EXPIRE-DT
 10731                                    PB-I-AH-EXPIRE-DT
 10732                                    PB-BILLED-DT
 10733                                    PB-ACCT-EFF-DT
 10734                                    PB-ACCT-EXP-DT
 10735                                    PB-I-1ST-PMT-DT.
 10736
 10737     MOVE 'X'                    TO PB-FATAL-FLAG.
 10738
 10739     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10740
 10741     IF BLSTNML GREATER THAN ZEROS
 10742         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10743
 10744*    IF BMICRNOL  GREATER  ZEROS
 10745*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10746*    ELSE
 10747*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10748     IF BVINL > ZEROS
 10749        MOVE BVINI               TO PB-I-VIN
 10750     END-IF
 10751     IF B1STNML GREATER THAN ZEROS
 10752         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10753
 10754     IF BINITL  GREATER THAN ZEROS
 10755         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10756
 10757     IF BBIRTHL GREATER THAN ZERO
 10758         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10759     ELSE
 10760         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10761
 10762     IF B1STPMTL GREATER THAN ZERO
 10763         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10764     ELSE
 10765         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10766
 10767     IF BAGEL    GREATER THAN ZEROS
 10768         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 198
* EL6311.cbl
 10769        ELSE
 10770         MOVE ZEROS              TO PB-I-AGE.
 10771
 10772     IF BSEXL    GREATER THAN ZEROS
 10773         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10774
 10775     IF BTERM-LEN (1) GREATER THAN ZEROS
 10776        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10777     ELSE
 10778        MOVE ZEROS               TO PB-I-LF-TERM.
 10779
 10780     IF BTERM-LEN (2) GREATER THAN ZEROS
 10781        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10782     ELSE
 10783        MOVE ZEROS               TO PB-I-AH-TERM.
 10784
 10785     IF BLNTRML       GREATER THAN ZEROS
 10786         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10787        ELSE
 10788         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10789
 10790     IF BFREQL        GREATER THAN ZEROS
 10791         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10792        ELSE
 10793         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10794
 10795     IF BSKPCDL       GREATER THAN ZEROS
 10796         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10797
 10798     IF BMODEL        GREATER THAN ZEROS
 10799         MOVE BMODEI             TO PB-I-TERM-TYPE
 10800                                    PI-BMODE.
 10801
 10802     IF BPMTSL        GREATER THAN ZEROS
 10803         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10804                                    PI-BPMTS
 10805        ELSE
 10806         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10807                                    PI-BPMTS.
 10808
 10809     IF BPMTAMTL      GREATER THAN ZEROS
 10810         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10811        ELSE
 10812         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10813
 10814     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10815        IF BTYPE  (1)   NOT = ZEROS
 10816           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10817                                    PI-BTYPE (1)
 10818           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10819           MOVE SPACES           TO PB-I-LF-ABBR
 10820        ELSE
 10821           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10822                                    PB-I-LF-ABBR
 10823           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10824     ELSE
 10825        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10826                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 199
* EL6311.cbl
 10827        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10828
 10829     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10830         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10831     ELSE
 10832         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10833
 10834     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10835         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10836     ELSE
 10837         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10838
 10839     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10840         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10841            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10842            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10843         ELSE
 10844            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10845*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10846*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10847         END-IF
 10848     ELSE
 10849         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10850
 10851     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10852         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10853
 10854     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10855         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10856         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10857     ELSE
 10858         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10859
 10860     IF  BALT-PREM-LEN     (2) > ZEROS
 10861         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10862     ELSE
 10863         MOVE ZEROS            TO PB-I-TOT-FEES.
 10864
 10865     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10866        IF BTYPE      (2)   NOT = ZEROS
 10867           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10868                                  PI-BTYPE (2)
 10869           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10870           MOVE SPACES         TO PB-I-AH-ABBR
 10871        ELSE
 10872           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10873                                  PB-I-AH-ABBR
 10874           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10875     ELSE
 10876        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10877                                  PB-I-AH-ABBR
 10878        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10879
 10880     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10881         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10882     ELSE
 10883         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10884
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 200
* EL6311.cbl
 10885     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10886         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10887            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10888            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10889         ELSE
 10890            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10891*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10892*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10893         END-IF
 10894     ELSE
 10895         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10896
 10897     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10898         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10899
 10900     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10901        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10902     ELSE
 10903        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10904
 10905     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10906        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10907     ELSE
 10908        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10909
 10910     IF BINDGRPL  GREATER THAN ZEROS
 10911         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10912
 10913     IF BRTCLSL   GREATER THAN ZEROS
 10914         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10915
 10916     IF BSIGL     GREATER THAN ZEROS
 10917         MOVE BSIGI              TO PB-I-SIG-SW.
 10918     IF BAPRL > ZEROS
 10919         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10920     ELSE
 10921        if pi-company-id = 'CID'
 10922           move +99.9999         to pb-i-loan-apr
 10923        else
 10924           MOVE ZEROS            TO PB-I-LOAN-APR
 10925        end-if
 10926     end-if
 10927     IF BMEMBERL  GREATER THAN ZEROS
 10928         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10929
 10930     IF BLNOFCRL  GREATER THAN ZEROS
 10931         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10932
 10933     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10934        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10935     ELSE
 10936        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10937
 10938     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10939        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10940     ELSE
 10941        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10942
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 201
* EL6311.cbl
 10943     IF BDAYSL   GREATER THAN ZEROS
 10944        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10945                                    PB-I-EXTENTION-DAYS
 10946     ELSE
 10947        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10948                                    PB-I-EXTENTION-DAYS.
 10949
 10950     IF BDAYSL GREATER THAN ZEROS
 10951        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10952
 10953     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10954        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10955           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10956
 10957     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10958        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10959           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10960
 10961     IF B1STPMTL GREATER THAN ZEROS
 10962        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10963
 10964     IF PB-EXT-DAYS-PROCESSING
 10965        IF PB-I-EXTENTION-DAYS = ZEROS
 10966           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10967
 10968     IF PB-EXPIRE-DT-PROCESSING
 10969        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10970           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10971             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10972
 10973     IF PB-1ST-PMT-DT-PROCESSING
 10974        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10975           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10976
 10977     IF BREINL GREATER THAN ZEROS
 10978        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10979
 10980     IF BENTRYL NOT = ZEROS
 10981        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10982        IF PI-COMPANY-ID = 'CID'
 10983           AND (PB-BATCH-ENTRY = 'P')
 10984           AND (PB-STATE = 'VA')
 10985           PERFORM 1500-UPDATE-ERNOTE
 10986                                 THRU 1500-EXIT
 10987        END-IF
 10988     END-IF
 10989     IF BUNWRITL NOT = ZEROS
 10990        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10991
 10992     IF BFORCEL NOT = ZEROS
 10993        MOVE BFORCEI             TO PB-FORCE-CODE.
 10994
 10995     IF BBILCDL NOT = ZEROS
 10996        MOVE BBILCDI             TO PB-RECORD-BILL.
 10997
 10998     IF BLIVESL GREATER THAN ZEROS
 10999        MOVE WS-BLIVES           TO PB-I-LIVES
 11000     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 202
* EL6311.cbl
 11001        MOVE ZEROS               TO PB-I-LIVES.
 11002
 11003     IF BBILLEDL GREATER THAN ZEROS
 11004        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 11005     ELSE
 11006        MOVE ZEROS               TO PB-I-NUM-BILLED.
 11007
 11008*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 11009
 11010 1260-WRITE-PB-RECORD.
 11011     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 11012                                    PB-INPUT-BY.
 11013     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11014     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 11015                                    PB-INPUT-DT.
 11016
 11017     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11018     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 11019                                    PB-CONTROL-BY-ORIG-BATCH.
 11020
 11021
 11022     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11023     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 11024     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11025     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11026     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11027
 11028     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11029
 11030     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11031
 11032     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11033     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11034     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11035
 11036     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 11037     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 11038
 11039 1275-WRITE-PENDING-BUSINESS.
 11040     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11041     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11042     MOVE 'A'                    TO JP-RECORD-TYPE.
 11043     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11044
 11045
 11046* EXEC CICS HANDLE CONDITION
 11047*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 11048*    END-EXEC.
 11049*    MOVE '"$%                   ! $ #00010830' TO DFHEIV0
 11050     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11052     MOVE X'2420233030303130383330' TO DFHEIV0(25:11)
 11053     CALL 'kxdfhei1' USING DFHEIV0
 11054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11055
 11056
 11057
 11058* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 203
* EL6311.cbl
 11059*        DATASET (FILE-ID-ERPNDB)
 11060*        FROM    (PENDING-BUSINESS)
 11061*        RIDFLD  (PB-CONTROL-PRIMARY)
 11062*    END-EXEC.
 11063     MOVE LENGTH OF
 11064      PENDING-BUSINESS
 11065       TO DFHEIV11
 11066*    MOVE '&$ L                  ''   #00010834' TO DFHEIV0
 11067     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11068     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11069     MOVE X'2020233030303130383334' TO DFHEIV0(25:11)
 11070     CALL 'kxdfhei1' USING DFHEIV0,
 11071           FILE-ID-ERPNDB,
 11072           PENDING-BUSINESS,
 11073           DFHEIV11,
 11074           PB-CONTROL-PRIMARY,
 11075           DFHEIV99,
 11076           DFHEIV99
 11077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11078
 11079
 11080     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11081
 11082     PERFORM 8400-LOG-JOURNAL-RECORD *> New Issue record
 11083
 11084******************************************************************
 11085*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11086******************************************************************
 11087     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11088     MOVE ' '                    TO WS-ERMAIL-SW
 11089
 11090* EXEC CICS READ
 11091*       DATASET   (FILE-ID-ERMAIL)
 11092*       SET       (ADDRESS OF MAILING-DATA)
 11093*       RIDFLD    (ERMAIL-KEY)
 11094*       RESP      (WS-RESPONSE)
 11095*    END-EXEC
 11096*    MOVE '&"S        E          (  N#00010850' TO DFHEIV0
 11097     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11099     MOVE X'204E233030303130383530' TO DFHEIV0(25:11)
 11100     CALL 'kxdfhei1' USING DFHEIV0,
 11101           FILE-ID-ERMAIL,
 11102           DFHEIV20,
 11103           DFHEIV99,
 11104           ERMAIL-KEY,
 11105           DFHEIV99,
 11106           DFHEIV99,
 11107           DFHEIV99
 11108     SET ADDRESS OF MAILING-DATA TO
 11109         DFHEIV20
 11110     MOVE EIBRESP  TO WS-RESPONSE
 11111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11112     IF RESP-NORMAL
 11113        SET ERMAIL-FOUND TO TRUE
 11114     END-IF
 11115
 11116     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 204
* EL6311.cbl
 11117     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11118     MOVE 'OC'                   TO OC-RECORD-ID
 11119     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11120                                 TO OC-CONTROL-PRIMARY (1:33)
 11121     MOVE 'I'                    TO OC-RECORD-TYPE
 11122     MOVE +4096                  TO OC-KEY-SEQ-NO
 11123     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11124     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11125     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11126     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11127     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11128     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11129     MOVE PB-I-AGE               TO OC-INS-AGE
 11130     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11131     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11132     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11133     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11134     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11135     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11136     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11137     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11138     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11139     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11140     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11141     IF PB-I-JOINT-COMMISSION > +0
 11142         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11143     ELSE
 11144         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11145     END-IF
 11146     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11147     MOVE +0                     TO OC-LF-CANCEL-AMT
 11148                                    OC-LF-ITD-CANCEL-AMT
 11149     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11150     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11151     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11152     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11153     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11154     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11155     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11156     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11157     MOVE +0                     TO OC-AH-CANCEL-AMT
 11158                                    OC-AH-ITD-CANCEL-AMT
 11159     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11160     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11161     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11162     IF ERMAIL-FOUND
 11163        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11164     END-IF
 11165     IF NOT CERT-TRL-REC-NOT-FOUND
 11166        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11167                           OC-INS-AGE-DEFAULT-FLAG
 11168        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11169                           OC-JNT-AGE-DEFAULT-FLAG
 11170     END-IF
 11171     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11172     .
 11173 1275-WRITE-ELCRTO.
 11174
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 205
* EL6311.cbl
 11175* EXEC CICS WRITE
 11176*       DATASET   ('ELCRTO')
 11177*       FROM      (ORIGINAL-CERTIFICATE)
 11178*       RIDFLD    (OC-CONTROL-PRIMARY)
 11179*       RESP      (WS-RESPONSE)
 11180*    END-EXEC
 11181     MOVE LENGTH OF
 11182      ORIGINAL-CERTIFICATE
 11183       TO DFHEIV11
 11184     MOVE 'ELCRTO' TO DFHEIV1
 11185*    MOVE '&$ L                  ''  N#00010918' TO DFHEIV0
 11186     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11187     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11188     MOVE X'204E233030303130393138' TO DFHEIV0(25:11)
 11189     CALL 'kxdfhei1' USING DFHEIV0,
 11190           DFHEIV1,
 11191           ORIGINAL-CERTIFICATE,
 11192           DFHEIV11,
 11193           OC-CONTROL-PRIMARY,
 11194           DFHEIV99,
 11195           DFHEIV99
 11196     MOVE EIBRESP  TO WS-RESPONSE
 11197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11198*    display ' just wrote 1275 ' ws-response
 11199     IF RESP-DUPKEY
 11200        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11201        GO TO 1275-WRITE-ELCRTO
 11202     ELSE
 11203        IF NOT RESP-NORMAL
 11204           MOVE -1               TO BMAINTL
 11205           MOVE ER-7450          TO EMI-ERROR
 11206           PERFORM 9900-ERROR-FORMAT
 11207                                 THRU 9900-EXIT
 11208           GO TO 8200-SEND-DATAONLY
 11209        END-IF
 11210     END-IF
 11211******************************************************************
 11212*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11213******************************************************************
 11214
 11215
 11216* EXEC CICS READ
 11217*        INTO    (PENDING-BUSINESS)
 11218*        DATASET (FILE-ID-ERPNDB)
 11219*        RIDFLD  (ERPNDB-KEY)
 11220*        UPDATE
 11221*    END-EXEC.
 11222     MOVE LENGTH OF
 11223      PENDING-BUSINESS
 11224       TO DFHEIV11
 11225*    MOVE '&"IL       EU         (   #00010941' TO DFHEIV0
 11226     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11227     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11228     MOVE X'2020233030303130393431' TO DFHEIV0(25:11)
 11229     CALL 'kxdfhei1' USING DFHEIV0,
 11230           FILE-ID-ERPNDB,
 11231           PENDING-BUSINESS,
 11232           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 206
* EL6311.cbl
 11233           ERPNDB-KEY,
 11234           DFHEIV99,
 11235           DFHEIV99,
 11236           DFHEIV99
 11237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11238
 11239
 11240     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11241     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11242     MOVE 'B'                    TO JP-RECORD-TYPE.
 11243     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11244
 11245     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 11246
 11247     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11248
 11249
 11250* EXEC CICS REWRITE
 11251*        DATASET (FILE-ID-ERPNDB)
 11252*        FROM    (PENDING-BUSINESS)
 11253*    END-EXEC.
 11254     MOVE LENGTH OF
 11255      PENDING-BUSINESS
 11256       TO DFHEIV11
 11257*    MOVE '&& L                  %   #00010957' TO DFHEIV0
 11258     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11259     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11260     MOVE X'2020233030303130393537' TO DFHEIV0(25:11)
 11261     CALL 'kxdfhei1' USING DFHEIV0,
 11262           FILE-ID-ERPNDB,
 11263           PENDING-BUSINESS,
 11264           DFHEIV11,
 11265           DFHEIV99
 11266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11267
 11268
 11269     MOVE 'C'                    TO JP-RECORD-TYPE.
 11270     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11271
 11272     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 11273
 11274     IF WS-ERRORS-PRESENT
 11275         GO TO 3900-RE-DISPLAY-RECORD.
 11276
 11277     MOVE ZEROS                  TO EMI-ERROR.
 11278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11279     MOVE LOW-VALUES             TO EL631BI.
 11280     MOVE  -1                    TO BMAINTL.
 11281     GO TO 8100-SEND-INITIAL-MAP.
 11282
 11283 1280-BATCH-HDR-NOT-FOUND.
 11284     MOVE -1                     TO BMAINTL.
 11285     MOVE ER-7450                TO EMI-ERROR.
 11286     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11287     GO TO 8200-SEND-DATAONLY.
 11288
 11289 1290-DUPLICATE-ALT-INDEX.
 11290
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 207
* EL6311.cbl
 11291******************************************************************
 11292*                                                                *
 11293*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11294*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11295*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11296*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11297*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11298*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11299*                                                                *
 11300******************************************************************
 11301
 11302     IF LCP-ONCTR-01 =  0
 11303         ADD 1 TO LCP-ONCTR-01
 11304        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11305
 11306     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11307
 11308     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11309         NEXT SENTENCE
 11310     ELSE
 11311         ADD +1 TO PB-BATCH-SEQ-NO
 11312                   PB-CSR-BATCH-SEQ-NO
 11313         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11314         GO TO 1275-WRITE-PENDING-BUSINESS.
 11315
 11316     MOVE -1                     TO BCERTNOL.
 11317     MOVE AL-UABON               TO BCERTNOA.
 11318     MOVE AL-UNBON               TO BEFFDTA.
 11319
 11320     MOVE 1                      TO EMI-SUB
 11321                                    EMI-SWITCH1
 11322                                    EMI-SWITCH-AREA-1
 11323                                    EMI-SWITCH-AREA-2.
 11324
 11325     MOVE SPACES                 TO EMI-ERROR-LINES.
 11326
 11327
 11328* EXEC CICS SYNCPOINT ROLLBACK
 11329*    END-EXEC.
 11330*    MOVE '6"R                   !   #00011020' TO DFHEIV0
 11331     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11332     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11333     MOVE X'2020233030303131303230' TO DFHEIV0(25:11)
 11334     CALL 'kxdfhei1' USING DFHEIV0
 11335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11336
 11337
 11338     MOVE ER-2247                TO EMI-ERROR.
 11339     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11340     GO TO 8200-SEND-DATAONLY.
 11341
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 208
* EL6311.cbl
 11343
 11344
 11345 1295-READ-CERT-TRAILER.
 11346
 11347
 11348* EXEC CICS GETMAIN
 11349*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11350*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11351*        INITIMG (GETMAIN-SPACE)
 11352*    END-EXEC
 11353*    MOVE ',"IL                  $   #00011032' TO DFHEIV0
 11354     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11355     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11356     MOVE X'2020233030303131303332' TO DFHEIV0(25:11)
 11357     CALL 'kxdfhei1' USING DFHEIV0,
 11358           DFHEIV20,
 11359           ELCRTT-RECORD-LENGTH,
 11360           GETMAIN-SPACE
 11361     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11362         DFHEIV20
 11363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11364
 11365     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11366     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11367     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11368
 11369
 11370* EXEC CICS HANDLE CONDITION
 11371*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11372*    END-EXEC.
 11373*    MOVE '"$I                   ! % #00011042' TO DFHEIV0
 11374     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11376     MOVE X'2520233030303131303432' TO DFHEIV0(25:11)
 11377     CALL 'kxdfhei1' USING DFHEIV0
 11378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11379
 11380
 11381
 11382* EXEC CICS READ
 11383*        DATASET  (CRTT-ID)
 11384*        RIDFLD   (ELCRTT-KEY)
 11385*        INTO     (CERTIFICATE-TRAILERS)
 11386*    END-EXEC.
 11387     MOVE LENGTH OF
 11388      CERTIFICATE-TRAILERS
 11389       TO DFHEIV11
 11390*    MOVE '&"IL       E          (   #00011046' TO DFHEIV0
 11391     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11393     MOVE X'2020233030303131303436' TO DFHEIV0(25:11)
 11394     CALL 'kxdfhei1' USING DFHEIV0,
 11395           CRTT-ID,
 11396           CERTIFICATE-TRAILERS,
 11397           DFHEIV11,
 11398           ELCRTT-KEY,
 11399           DFHEIV99,
 11400           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 209
* EL6311.cbl
 11401           DFHEIV99
 11402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11403
 11404
 11405     GO TO 1295-EXIT.
 11406
 11407 1295-CERT-TRL-REC-NOTFND.
 11408     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11409
 11410 1295-EXIT.
 11411     EXIT.
 11412
 11413******************************************************************
 11414*                                                                *
 11415*          C H A N G E   I S S U E   R O U T I N E               *
 11416*                                                                *
 11417******************************************************************
 11418
 11419***************************************************************
 11420*                                                             *
 11421*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11422*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11423*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11424*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11425*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11426*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11427*     5. LINK TO THE EDIT ROUTINE.                            *
 11428*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11429*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11430*              THE EDIT ROUTINE.                              *
 11431*     7. REWRITE THE NEW ISSUE                                *
 11432*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11433*                                                             *
 11434***************************************************************
 11435
 11436 1300-CHANGE-ISSUE-ROUTINE.
 11437     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11438
 11439     IF BCHGL NOT = ZEROS
 11440        MOVE ER-2196             TO EMI-ERROR
 11441        MOVE AL-UABON            TO BMAINTA
 11442        MOVE -1                  TO BMAINTL
 11443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11444        GO TO 8200-SEND-DATAONLY.
 11445
 11446     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11447
 11448     IF BSUFIXL NOT = ZEROS
 11449        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11450     ELSE
 11451        MOVE SPACE               TO WS-NEW-SUFFIX.
 11452
 11453     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11454     PERFORM 8600-DEEDIT.
 11455     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11456     MOVE '4'                    TO DC-OPTION-CODE.
 11457     PERFORM 9700-DATE-LINK.
 11458     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 210
* EL6311.cbl
 11459        MOVE ER-0348             TO EMI-ERROR
 11460        MOVE -1                  TO BEFFDTL
 11461        MOVE AL-UABON            TO BEFFDTA
 11462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11463        GO TO 8200-SEND-DATAONLY
 11464     ELSE
 11465        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11466        MOVE AL-UANON            TO BEFFDTA
 11467        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11468
 11469 1325-PROCESS-ISSUE-CHANGES.
 11470
 11471* EXEC CICS HANDLE CONDITION
 11472*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11473*    END-EXEC.
 11474*    MOVE '"$I                   ! & #00011117' TO DFHEIV0
 11475     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11476     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11477     MOVE X'2620233030303131313137' TO DFHEIV0(25:11)
 11478     CALL 'kxdfhei1' USING DFHEIV0
 11479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11480
 11481
 11482     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11483     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11484     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11485
 11486
 11487* EXEC CICS GETMAIN
 11488*        SET      (ADDRESS OF PENDING-BUSINESS)
 11489*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11490*        INITIMG  (GETMAIN-SPACE)
 11491*     END-EXEC.
 11492*    MOVE ',"IL                  $   #00011125' TO DFHEIV0
 11493     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11494     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11495     MOVE X'2020233030303131313235' TO DFHEIV0(25:11)
 11496     CALL 'kxdfhei1' USING DFHEIV0,
 11497           DFHEIV20,
 11498           ERPNDB-RECORD-LENGTH,
 11499           GETMAIN-SPACE
 11500     SET ADDRESS OF PENDING-BUSINESS TO
 11501         DFHEIV20
 11502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11503
 11504
 11505
 11506* EXEC CICS READ
 11507*        INTO    (PENDING-BUSINESS)
 11508*        DATASET (FILE-ID-ERPNDB)
 11509*        RIDFLD  (ERPNDB-KEY)
 11510*    END-EXEC.
 11511     MOVE LENGTH OF
 11512      PENDING-BUSINESS
 11513       TO DFHEIV11
 11514*    MOVE '&"IL       E          (   #00011131' TO DFHEIV0
 11515     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 211
* EL6311.cbl
 11517     MOVE X'2020233030303131313331' TO DFHEIV0(25:11)
 11518     CALL 'kxdfhei1' USING DFHEIV0,
 11519           FILE-ID-ERPNDB,
 11520           PENDING-BUSINESS,
 11521           DFHEIV11,
 11522           ERPNDB-KEY,
 11523           DFHEIV99,
 11524           DFHEIV99,
 11525           DFHEIV99
 11526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11527
 11528
 11529     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11530
 11531
 11532* EXEC CICS HANDLE CONDITION
 11533*         NOTFND     (1385-REC-NOT-FOUND)
 11534*    END-EXEC.
 11535*    MOVE '"$I                   ! '' #00011139' TO DFHEIV0
 11536     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11538     MOVE X'2720233030303131313339' TO DFHEIV0(25:11)
 11539     CALL 'kxdfhei1' USING DFHEIV0
 11540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11541
 11542
 11543**********************************************************
 11544*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11545*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11546**********************************************************
 11547
 11548
 11549* EXEC CICS READ
 11550*        DATASET (FILE-ID-ERPNDB)
 11551*        INTO    (PENDING-BUSINESS)
 11552*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11553*    END-EXEC.
 11554     MOVE LENGTH OF
 11555      PENDING-BUSINESS
 11556       TO DFHEIV11
 11557*    MOVE '&"IL       E          (   #00011148' TO DFHEIV0
 11558     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11560     MOVE X'2020233030303131313438' TO DFHEIV0(25:11)
 11561     CALL 'kxdfhei1' USING DFHEIV0,
 11562           FILE-ID-ERPNDB,
 11563           PENDING-BUSINESS,
 11564           DFHEIV11,
 11565           PI-PREV-CONTROL-PRIMARY,
 11566           DFHEIV99,
 11567           DFHEIV99,
 11568           DFHEIV99
 11569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11570
 11571
 11572********** DO NOT ALLOW CHANGES IF THRU A/R
 11573     IF BMAINTI = 'C'
 11574         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 212
* EL6311.cbl
 11575             MOVE ER-4005          TO EMI-ERROR
 11576             MOVE -1               TO BMAINTL
 11577             MOVE AL-UABON         TO BMAINTA
 11578             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11579             GO TO 8200-SEND-DATAONLY.
 11580**********
 11581     MOVE PB-ISSUE-RECORD TO WS-SAVE-PEND-ISSUE
 11582
 11583     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11584        MOVE -1                 TO BMAINTL
 11585        MOVE ER-2197            TO EMI-ERROR
 11586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11587        GO TO 8200-SEND-DATAONLY.
 11588
 11589     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11590        MOVE ER-2196             TO EMI-ERROR
 11591        MOVE AL-UABON            TO BMAINTA
 11592        MOVE -1                  TO BMAINTL
 11593        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11594        GO TO 8200-SEND-DATAONLY.
 11595
 11596     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11597
 11598     IF PB-BILLED-DT = LOW-VALUES AND
 11599        PB-CHG-COUNT = ZEROS
 11600        NEXT SENTENCE
 11601     ELSE
 11602        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11603            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11604           OR
 11605           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11606            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11607           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11608     move zeros                  to ws-check-amts
 11609     move ' '                    to ws-stop-sw
 11610                                    ws-check-sw
 11611                                    ws-proc-check-sw
 11612                                    ws-any-check-sw
 11613                                    ws-chek-browse-sw
 11614
 11615     perform 2500-browse-checks  thru 2500-exit
 11616
 11617     if i-have-processed-checks
 11618        or i-have-checks
 11619        continue
 11620     else
 11621        go to 1330-continue
 11622     end-if
 11623
 11624     compute ws-tot-orig-prem =
 11625        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11626        pb-i-lf-alt-premium-amt
 11627
 11628     if bprem1l <> zeros
 11629        MOVE AL-UNNON            TO bprem1a
 11630        move ws-bprem (1)        to ws-new-iss-total
 11631     else
 11632        move pb-i-lf-premium-amt to ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 213
* EL6311.cbl
 11633     end-if
 11634     display ' new iss totala ' ws-new-iss-total
 11635
 11636     if baltpr1l <> zeros
 11637        MOVE AL-UNNON            TO baltpr1a
 11638        compute ws-new-iss-total =
 11639           ws-new-iss-total + ws-balt-prem(1)
 11640     else
 11641        compute ws-new-iss-total =
 11642           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11643     end-if
 11644
 11645     if bprem2l <> zeros
 11646        MOVE AL-UNNON            TO bprem2a
 11647        compute ws-new-iss-total = ws-new-iss-total +
 11648           ws-bprem (2)
 11649     else
 11650        compute ws-new-iss-total = ws-new-iss-total +
 11651           pb-i-ah-premium-amt
 11652     end-if
 11653
 11654     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11655        if ((bprem1l <> zeros)
 11656           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11657                      or
 11658           ((bprem2l <> zeros)
 11659           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11660           move er-3456          to emi-error
 11661           perform 9900-error-format
 11662                                 thru 9900-exit
 11663           go to 1330-continue
 11664        end-if
 11665     end-if
 11666
 11667     if ws-new-iss-total > ws-tot-orig-prem
 11668        move er-3458             to emi-error
 11669        perform 9900-error-format thru 9900-exit
 11670        move al-uabon            to bmainta
 11671        move -1                  to bmaintl
 11672        go to 8200-send-dataonly
 11673     end-if
 11674
 11675     if ws-new-iss-total < ws-tot-orig-prem
 11676        move er-3457             to emi-error
 11677        move al-uabon            to bprem1a
 11678                                    bprem2a
 11679        move +0 to bprem1l bprem2l
 11680        perform 9900-error-format thru 9900-exit
 11681        move -1                  to bmaintl
 11682        go to 1330-continue
 11683     end-if
 11684
 11685     .
 11686 1330-continue.
 11687
 11688
 11689* EXEC CICS READ
 11690*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 214
* EL6311.cbl
 11691*        INTO    (PENDING-BUSINESS)
 11692*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11693*        UPDATE
 11694*    END-EXEC.
 11695     MOVE LENGTH OF
 11696      PENDING-BUSINESS
 11697       TO DFHEIV11
 11698*    MOVE '&"IL       EU         (   #00011270' TO DFHEIV0
 11699     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11700     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11701     MOVE X'2020233030303131323730' TO DFHEIV0(25:11)
 11702     CALL 'kxdfhei1' USING DFHEIV0,
 11703           FILE-ID-ERPNDB,
 11704           PENDING-BUSINESS,
 11705           DFHEIV11,
 11706           PI-PREV-CONTROL-PRIMARY,
 11707           DFHEIV99,
 11708           DFHEIV99,
 11709           DFHEIV99
 11710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11711
 11712
 11713     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11714     MOVE 'B'                    TO JP-RECORD-TYPE
 11715     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11716     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11717
 11718*    PERFORM 8400-LOG-JOURNAL-RECORD. *> move closer to rewite
 11719
 11720     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11721        PB-CHG-COUNT NOT = ZEROS
 11722        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11723            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11724           OR
 11725           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11726            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11727            MOVE LOW-VALUES             TO PB-BILLED-DT
 11728            ADD +1                      TO PB-CHG-COUNT.
 11729
 11730     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11731     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11732     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11733     MOVE '5'                    TO DC-OPTION-CODE.
 11734     PERFORM 9700-DATE-LINK
 11735     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11736
 11737*    IF BMICRNOL  GREATER  ZEROS
 11738*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11739
 11740     IF BVINL > ZEROS
 11741        MOVE BVINI               TO PB-I-VIN
 11742     END-IF
 11743     IF (BFORCEL NOT = ZEROS)
 11744        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11745        AND (BFORCEI = ' ')
 11746        AND (PB-FORCE-CODE = 'O')
 11747        COMPUTE PB-I-AH-PREMIUM-AMT =
 11748           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 215
* EL6311.cbl
 11749        PERFORM 1800-REMOVE-CERT-NOTES
 11750                                 THRU 1800-EXIT
 11751        PERFORM 1900-DELETE-ERPYAJ
 11752                                 THRU 1900-EXIT
 11753        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11754     END-IF
 11755     IF (BFORCEL NOT = ZEROS)
 11756        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11757        AND (BFORCEI = 'O')
 11758        AND (PB-FORCE-CODE NOT = 'O')
 11759        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11760           PB-I-AH-PREM-CALC
 11761        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11762        MOVE SPACE               TO DC-OPTION-CODE
 11763        PERFORM 9700-DATE-LINK
 11764        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11765        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11766        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11767        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11768        PERFORM 1500-UPDATE-ERNOTE
 11769                                 THRU 1500-EXIT
 11770        PERFORM 1600-UPDATE-ERPYAJ
 11771                                 THRU 1600-EXIT
 11772     END-IF
 11773     IF BLSTNML  GREATER THAN ZEROS
 11774         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11775
 11776     IF B1STNML  GREATER THAN ZEROS
 11777         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11778
 11779     IF BINITL   GREATER THAN ZEROS
 11780         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11781
 11782     IF BBIRTHL  GREATER THAN ZERO
 11783         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11784
 11785     IF B1STPMTL GREATER THAN ZERO
 11786         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11787
 11788     IF BAGEL    GREATER THAN ZEROS
 11789         MOVE BAGEI              TO PB-I-AGE.
 11790
 11791     MOVE 'N'                    TO WS-INS-AGE-SET
 11792                                    WS-JNT-AGE-SET.
 11793     IF BAGEL    GREATER THAN ZEROS
 11794        MOVE 'Y'                TO WS-INS-AGE-SET
 11795        IF BAGEI = ZERO AND
 11796             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11797           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11798           MOVE 'AGE*'          TO BAGEDEFO
 11799        ELSE
 11800           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11801           MOVE 'AGE '          TO BAGEDEFO
 11802        END-IF
 11803        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11804     END-IF.
 11805
 11806     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 216
* EL6311.cbl
 11807         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11808
 11809     IF LETRREQL   GREATER THAN ZEROS
 11810        MOVE LETRREQI TO PB-I-LETTER-REQD
 11811     END-IF.
 11812
 11813     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11814        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11815
 11816     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11817        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11818
 11819     IF BLNTRML  GREATER THAN ZEROS
 11820         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11821
 11822     IF BFREQL   GREATER THAN ZEROS
 11823         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11824
 11825     IF BSKPCDL  GREATER THAN ZEROS
 11826         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11827
 11828     IF BMODEL   GREATER THAN ZEROS
 11829         MOVE BMODEI             TO PB-I-TERM-TYPE
 11830                                    PI-BMODE.
 11831
 11832     IF BPMTSL   GREATER THAN ZEROS
 11833         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11834                                    PI-BPMTS.
 11835
 11836     IF BPMTAMTL GREATER THAN ZEROS
 11837         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11838
 11839     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11840         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11841
 11842     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11843         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11844
 11845     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11846
 11847     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11848         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11849            SUBTRACT PB-I-LF-PREMIUM-AMT
 11850                     FROM WS-B-LF-ISS-PRM-ENTERED
 11851            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11852            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11853            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11854         ELSE
 11855            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11856*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11857*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11858         END-IF
 11859     END-IF.
 11860
 11861     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11862            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11863                     FROM WS-B-LF-ISS-PRM-ENTERED
 11864         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 217
* EL6311.cbl
 11865         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11866
 11867     IF  BALT-PREM-LEN     (2)  > ZEROS
 11868         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11869
 11870     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11871         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11872
 11873     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11874         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11875            SUBTRACT PB-I-AH-PREMIUM-AMT
 11876                     FROM WS-B-AH-ISS-PRM-ENTERED
 11877            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11878            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11879            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11880         ELSE
 11881            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11882*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11883*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11884         END-IF
 11885     END-IF
 11886
 11887     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11888        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11889
 11890     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11891        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11892
 11893     IF BINDGRPL            GREATER THAN ZEROS
 11894         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11895
 11896     IF BRTCLSL             GREATER THAN ZEROS
 11897         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11898
 11899     IF BSIGL               GREATER THAN ZEROS
 11900         MOVE BSIGI              TO PB-I-SIG-SW.
 11901
 11902     IF BAPRL               GREATER THAN ZEROS
 11903         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11904
 11905     IF BMEMBERL            GREATER THAN ZEROS
 11906         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11907
 11908     IF BLNOFCRL            GREATER THAN ZEROS
 11909         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11910
 11911     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11912        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11913
 11914     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11915        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11916
 11917     IF BDAYSL              GREATER THAN ZEROS
 11918        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11919                                    PB-I-EXTENTION-DAYS.
 11920
 11921     IF BDAYSL GREATER THAN ZEROS
 11922        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 218
* EL6311.cbl
 11923
 11924     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11925        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11926           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11927
 11928     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11929        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11930           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11931
 11932     IF B1STPMTL GREATER THAN ZEROS
 11933        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11934
 11935     IF PB-EXT-DAYS-PROCESSING
 11936        IF PB-I-EXTENTION-DAYS = ZEROS
 11937           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11938
 11939     IF PB-EXPIRE-DT-PROCESSING
 11940        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11941           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11942             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11943
 11944     IF PB-1ST-PMT-DT-PROCESSING
 11945        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11946           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11947
 11948     IF BREINL GREATER THAN ZEROS
 11949        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11950
 11951     IF BFORCEL NOT = ZEROS
 11952        MOVE BFORCEI             TO PB-FORCE-CODE.
 11953     IF (BENTRYL NOT = ZEROS)
 11954        AND (PB-COMPANY-ID = 'CID')
 11955        AND (PB-STATE = 'VA')
 11956        AND (BENTRYI NOT = 'P')
 11957        AND (PB-BATCH-ENTRY = 'P')
 11958        PERFORM 1800-REMOVE-CERT-NOTES
 11959                                 THRU 1800-EXIT
 11960     END-IF
 11961     IF BENTRYL NOT = ZEROS
 11962        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11963        IF PI-COMPANY-ID = 'CID'
 11964           AND (PB-BATCH-ENTRY = 'P')
 11965           AND (PB-STATE = 'VA')
 11966           PERFORM 1500-UPDATE-ERNOTE
 11967                                 THRU 1500-EXIT
 11968        END-IF
 11969     END-IF
 11970
 11971     IF BUNWRITL NOT = ZEROS
 11972        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11973
 11974     IF BBILCDL NOT = ZEROS
 11975        MOVE BBILCDI             TO PB-RECORD-BILL.
 11976
 11977     IF BLIVESL GREATER THAN ZEROS
 11978        MOVE WS-BLIVES           TO PB-I-LIVES.
 11979
 11980
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 219
* EL6311.cbl
 11981*DMD CUSTOM CODING*************START
 11982     IF PI-COMPANY-ID NOT = 'DMD'
 11983         MOVE ZEROS               TO BBILLEDL.
 11984*DMD CUSTOM CODING*************END
 11985
 11986     IF BBILLEDL GREATER THAN ZEROS
 11987        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11988
 11989
 11990*****************************************************************
 11991*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11992*****************************************************************
 11993
 11994     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11995        IF BTYPE  (1)   = ZEROS OR SPACES
 11996           IF REMOVE-LF-COVERAGE
 11997               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11998                                        PI-BTYPE (1)
 11999               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 12000                                        WS-B-LF-ISS-PRM-ENTERED
 12001               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 12002                                        WS-B-LF-ISS-PRM-ENTERED
 12003               SUBTRACT PB-I-LF-PREM-CALC FROM
 12004                                        WS-B-LF-ISS-PRM-COMPUTED
 12005               MOVE ZEROS            TO PB-I-LF-TERM
 12006                                        PB-I-LF-BENEFIT-AMT
 12007                                        PB-I-LF-PREMIUM-AMT
 12008                                        PB-I-LF-BENEFIT-CD
 12009                                        PB-I-LF-PREM-CALC
 12010                                        PB-I-LF-CRIT-PER
 12011                                        PB-I-LF-ALT-BENEFIT-AMT
 12012                                        PB-I-LF-ALT-PREMIUM-AMT
 12013               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 12014           ELSE
 12015               NEXT SENTENCE
 12016        ELSE
 12017           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 12018                                    PI-BTYPE (1).
 12019     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 12020        IF BTYPE  (2)   = ZEROS OR SPACES
 12021           IF  REMOVE-AH-COVERAGE
 12022               MOVE SPACES           TO PB-I-AH-INPUT-CD
 12023                                        PI-BTYPE (2)
 12024               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 12025                                        WS-B-AH-ISS-PRM-ENTERED
 12026               SUBTRACT PB-I-AH-PREM-CALC FROM
 12027                                        WS-B-AH-ISS-PRM-COMPUTED
 12028               MOVE ZEROS            TO PB-I-AH-TERM
 12029                                        PB-I-AH-BENEFIT-AMT
 12030                                        PB-I-AH-PREMIUM-AMT
 12031                                        PB-I-AH-BENEFIT-CD
 12032                                        PB-I-AH-PREM-CALC
 12033                                        PB-I-AH-CRIT-PER
 12034               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 12035           ELSE
 12036               NEXT SENTENCE
 12037        ELSE
 12038           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 220
* EL6311.cbl
 12039                                    PI-BTYPE (2).
 12040 1360-REWRITE-PB-RECORD.
 12041     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 12042
 12043     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12044     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 12045
 12046     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12047
 12048     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 12049     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 12050
 12051     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 12052         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 12053
 12054     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 12055         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 12056
 12057     IF CSR-EDIT-SESSION
 12058        PERFORM 139A-SET-LETTER-REQD THRU 139A-EXIT
 12059     END-IF.
 12060
 12061     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 12062
 12063     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12064
 12065     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12066
 12067     IF ARCHIVE-LETTER-RELEASED
 12068        MOVE 'C' TO PB-I-LETTER-REQD
 12069        PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT
 12070        PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT
 12071     END-IF
 12072
 12073     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12074     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12075     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12076
 12077     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 12078     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 12079
 12080 1375-REWRITE-PB-RECORD.
 12081     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Issue image
 12082     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12083     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12084     MOVE 'C'                    TO JP-RECORD-TYPE.
 12085     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12086
 12087
 12088* EXEC CICS REWRITE
 12089*        DATASET (FILE-ID-ERPNDB)
 12090*        FROM    (PENDING-BUSINESS)
 12091*    END-EXEC.
 12092     MOVE LENGTH OF
 12093      PENDING-BUSINESS
 12094       TO DFHEIV11
 12095*    MOVE '&& L                  %   #00011651' TO DFHEIV0
 12096     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 221
* EL6311.cbl
 12097     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12098     MOVE X'2020233030303131363531' TO DFHEIV0(25:11)
 12099     CALL 'kxdfhei1' USING DFHEIV0,
 12100           FILE-ID-ERPNDB,
 12101           PENDING-BUSINESS,
 12102           DFHEIV11,
 12103           DFHEIV99
 12104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12105
 12106
 12107     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Issue Image
 12108******************************************************************
 12109*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12110******************************************************************
 12111     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12112     MOVE ' '                    TO WS-ERMAIL-SW
 12113
 12114* EXEC CICS READ
 12115*       DATASET   (FILE-ID-ERMAIL)
 12116*       SET       (ADDRESS OF MAILING-DATA)
 12117*       RIDFLD    (ERMAIL-KEY)
 12118*       RESP      (WS-RESPONSE)
 12119*    END-EXEC
 12120*    MOVE '&"S        E          (  N#00011662' TO DFHEIV0
 12121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12123     MOVE X'204E233030303131363632' TO DFHEIV0(25:11)
 12124     CALL 'kxdfhei1' USING DFHEIV0,
 12125           FILE-ID-ERMAIL,
 12126           DFHEIV20,
 12127           DFHEIV99,
 12128           ERMAIL-KEY,
 12129           DFHEIV99,
 12130           DFHEIV99,
 12131           DFHEIV99
 12132     SET ADDRESS OF MAILING-DATA TO
 12133         DFHEIV20
 12134     MOVE EIBRESP  TO WS-RESPONSE
 12135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12136     IF RESP-NORMAL
 12137        SET ERMAIL-FOUND TO TRUE
 12138     END-IF
 12139
 12140     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12141     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12142                                 TO ELCRTO-KEY
 12143     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12144     MOVE +0                     TO ELCRTO-SEQ-NO
 12145
 12146* EXEC CICS READ
 12147*       DATASET   ('ELCRTO')
 12148*       INTO      (ORIGINAL-CERTIFICATE)
 12149*       RIDFLD    (ELCRTO-KEY)
 12150*       GTEQ
 12151*       RESP      (WS-RESPONSE)
 12152*    END-EXEC
 12153     MOVE LENGTH OF
 12154      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 222
* EL6311.cbl
 12155       TO DFHEIV11
 12156     MOVE 'ELCRTO' TO DFHEIV1
 12157*    MOVE '&"IL       G          (  N#00011677' TO DFHEIV0
 12158     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12160     MOVE X'204E233030303131363737' TO DFHEIV0(25:11)
 12161     CALL 'kxdfhei1' USING DFHEIV0,
 12162           DFHEIV1,
 12163           ORIGINAL-CERTIFICATE,
 12164           DFHEIV11,
 12165           ELCRTO-KEY,
 12166           DFHEIV99,
 12167           DFHEIV99,
 12168           DFHEIV99
 12169     MOVE EIBRESP  TO WS-RESPONSE
 12170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12171*    display ' just read gteq ' ws-response
 12172     IF RESP-NORMAL
 12173        AND (OC-CONTROL-PRIMARY (1:33) =
 12174                 PB-CONTROL-BY-ACCOUNT (1:33))
 12175        AND (OC-RECORD-TYPE = 'I')
 12176        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12177           display ' csr edit session ' PI-CSR-SESSION-SW
 12178           IF NOT CSR-EDIT-SESSION
 12179
 12180* EXEC CICS READ
 12181*                DATASET   ('ELCRTO')
 12182*                INTO      (ORIGINAL-CERTIFICATE)
 12183*                RIDFLD    (OC-CONTROL-PRIMARY)
 12184*                UPDATE
 12185*                RESP      (WS-RESPONSE)
 12186*             END-EXEC
 12187     MOVE LENGTH OF
 12188      ORIGINAL-CERTIFICATE
 12189       TO DFHEIV11
 12190     MOVE 'ELCRTO' TO DFHEIV1
 12191*    MOVE '&"IL       EU         (  N#00011694' TO DFHEIV0
 12192     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12193     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12194     MOVE X'204E233030303131363934' TO DFHEIV0(25:11)
 12195     CALL 'kxdfhei1' USING DFHEIV0,
 12196           DFHEIV1,
 12197           ORIGINAL-CERTIFICATE,
 12198           DFHEIV11,
 12199           OC-CONTROL-PRIMARY,
 12200           DFHEIV99,
 12201           DFHEIV99,
 12202           DFHEIV99
 12203     MOVE EIBRESP  TO WS-RESPONSE
 12204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12205              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12206              IF RESP-NORMAL
 12207                 display ' good read upd '
 12208                 MOVE PB-I-INSURED-LAST-NAME TO
 12209                         OC-INS-LAST-NAME
 12210                 MOVE PB-I-INSURED-FIRST-NAME TO
 12211                         OC-INS-FIRST-NAME
 12212                 MOVE PB-I-INSURED-MIDDLE-INIT TO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 223
* EL6311.cbl
 12213                         OC-INS-MIDDLE-INIT
 12214                 MOVE PB-I-AGE         TO OC-INS-AGE
 12215                 MOVE PB-I-JOINT-LAST-NAME   TO
 12216                         OC-JNT-LAST-NAME
 12217                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12218                         OC-JNT-FIRST-NAME
 12219                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12220                         OC-JNT-MIDDLE-INIT
 12221                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12222                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12223                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12224                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12225                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12226                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12227                         OC-LF-ALT-BEN-AMT
 12228                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 12229                         OC-LF-ALT-PRM-AMT
 12230                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12231                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12232                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12233                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12234                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12235                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12236                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12237                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12238                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12239                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12240                 IF OC-CANCEL-TRAN-IND = 'N'
 12241                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12242                    MOVE +0            TO OC-LF-CANCEL-AMT
 12243                                          OC-LF-ITD-CANCEL-AMT
 12244                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12245                    MOVE +0            TO OC-AH-CANCEL-AMT
 12246                                          OC-AH-ITD-CANCEL-AMT
 12247                 END-IF
 12248                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12249                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12250                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12251                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12252                 IF ERMAIL-FOUND
 12253                    MOVE MA-CRED-BENE-NAME
 12254                                 TO OC-CRED-BENE-NAME
 12255                 END-IF
 12256                 IF NOT CERT-TRL-REC-NOT-FOUND
 12257                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12258                           OC-INS-AGE-DEFAULT-FLAG
 12259                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12260                           OC-JNT-AGE-DEFAULT-FLAG
 12261                 END-IF
 12262
 12263* EXEC CICS REWRITE
 12264*                   DATASET   ('ELCRTO')
 12265*                   FROM      (ORIGINAL-CERTIFICATE)
 12266*                   RESP      (WS-RESPONSE)
 12267*                END-EXEC
 12268     MOVE LENGTH OF
 12269      ORIGINAL-CERTIFICATE
 12270       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 224
* EL6311.cbl
 12271     MOVE 'ELCRTO' TO DFHEIV1
 12272*    MOVE '&& L                  %  N#00011758' TO DFHEIV0
 12273     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12274     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12275     MOVE X'204E233030303131373538' TO DFHEIV0(25:11)
 12276     CALL 'kxdfhei1' USING DFHEIV0,
 12277           DFHEIV1,
 12278           ORIGINAL-CERTIFICATE,
 12279           DFHEIV11,
 12280           DFHEIV99
 12281     MOVE EIBRESP  TO WS-RESPONSE
 12282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12283                 display ' just rewrote ' ws-response
 12284              END-IF
 12285           END-IF
 12286        ELSE
 12287           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12288           MOVE 'OC'             TO OC-RECORD-ID
 12289           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12290           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12291           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12292           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12293           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12294           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12295           MOVE PB-I-AGE         TO OC-INS-AGE
 12296           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12297           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12298           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12299           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12300           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12301           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12302           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12303           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12304           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12305           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12306           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12307           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12308           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12309           MOVE +0               TO OC-LF-CANCEL-AMT
 12310                                    OC-LF-ITD-CANCEL-AMT
 12311           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12312           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12313           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12314           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12315           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12316           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12317           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12318           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12319           MOVE +0               TO OC-AH-CANCEL-AMT
 12320                                    OC-AH-ITD-CANCEL-AMT
 12321           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12322           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12323           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12324           IF ERMAIL-FOUND
 12325              MOVE MA-CRED-BENE-NAME
 12326                                 TO OC-CRED-BENE-NAME
 12327           END-IF
 12328           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 225
* EL6311.cbl
 12329              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12330                           OC-INS-AGE-DEFAULT-FLAG
 12331              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12332                           OC-JNT-AGE-DEFAULT-FLAG
 12333           END-IF
 12334           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12335
 12336* EXEC CICS WRITE
 12337*             DATASET   ('ELCRTO')
 12338*             FROM      (ORIGINAL-CERTIFICATE)
 12339*             RIDFLD    (OC-CONTROL-PRIMARY)
 12340*             RESP      (WS-RESPONSE)
 12341*          END-EXEC
 12342     MOVE LENGTH OF
 12343      ORIGINAL-CERTIFICATE
 12344       TO DFHEIV11
 12345     MOVE 'ELCRTO' TO DFHEIV1
 12346*    MOVE '&$ L                  ''  N#00011815' TO DFHEIV0
 12347     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12348     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12349     MOVE X'204E233030303131383135' TO DFHEIV0(25:11)
 12350     CALL 'kxdfhei1' USING DFHEIV0,
 12351           DFHEIV1,
 12352           ORIGINAL-CERTIFICATE,
 12353           DFHEIV11,
 12354           OC-CONTROL-PRIMARY,
 12355           DFHEIV99,
 12356           DFHEIV99
 12357     MOVE EIBRESP  TO WS-RESPONSE
 12358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12359        END-IF
 12360     ELSE
 12361        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12362        MOVE 'OC'                TO OC-RECORD-ID
 12363        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12364                                 TO OC-CONTROL-PRIMARY (1:33)
 12365        MOVE 'I'                 TO OC-RECORD-TYPE
 12366        MOVE +4096               TO OC-KEY-SEQ-NO
 12367        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12368        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12369        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12370        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12371        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12372        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12373        MOVE PB-I-AGE            TO OC-INS-AGE
 12374        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12375        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12376        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12377        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12378        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12379        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12380        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12381        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12382        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12383        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12384        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12385        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12386        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 226
* EL6311.cbl
 12387        MOVE +0                  TO OC-LF-CANCEL-AMT
 12388                                    OC-LF-ITD-CANCEL-AMT
 12389        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12390        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12391        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12392        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12393        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12394        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12395        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12396        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12397        MOVE +0                  TO OC-AH-CANCEL-AMT
 12398                                    OC-AH-ITD-CANCEL-AMT
 12399        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12400        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12401        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12402        IF ERMAIL-FOUND
 12403           MOVE MA-CRED-BENE-NAME
 12404                                 TO OC-CRED-BENE-NAME
 12405        END-IF
 12406        IF NOT CERT-TRL-REC-NOT-FOUND
 12407           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12408                           OC-INS-AGE-DEFAULT-FLAG
 12409           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12410                           OC-JNT-AGE-DEFAULT-FLAG
 12411        END-IF
 12412        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12413
 12414* EXEC CICS WRITE
 12415*          DATASET   ('ELCRTO')
 12416*          FROM      (ORIGINAL-CERTIFICATE)
 12417*          RIDFLD    (OC-CONTROL-PRIMARY)
 12418*          RESP      (WS-RESPONSE)
 12419*       END-EXEC
 12420     MOVE LENGTH OF
 12421      ORIGINAL-CERTIFICATE
 12422       TO DFHEIV11
 12423     MOVE 'ELCRTO' TO DFHEIV1
 12424*    MOVE '&$ L                  ''  N#00011875' TO DFHEIV0
 12425     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12426     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12427     MOVE X'204E233030303131383735' TO DFHEIV0(25:11)
 12428     CALL 'kxdfhei1' USING DFHEIV0,
 12429           DFHEIV1,
 12430           ORIGINAL-CERTIFICATE,
 12431           DFHEIV11,
 12432           OC-CONTROL-PRIMARY,
 12433           DFHEIV99,
 12434           DFHEIV99
 12435     MOVE EIBRESP  TO WS-RESPONSE
 12436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12437     END-IF
 12438******************************************************************
 12439*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12440******************************************************************
 12441
 12442     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12443     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12444
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 227
* EL6311.cbl
 12445
 12446* EXEC CICS READ
 12447*        INTO    (PENDING-BUSINESS)
 12448*        DATASET (FILE-ID-ERPNDB)
 12449*        RIDFLD  (ERPNDB-KEY)
 12450*        UPDATE
 12451*    END-EXEC.
 12452     MOVE LENGTH OF
 12453      PENDING-BUSINESS
 12454       TO DFHEIV11
 12455*    MOVE '&"IL       EU         (   #00011889' TO DFHEIV0
 12456     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12457     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12458     MOVE X'2020233030303131383839' TO DFHEIV0(25:11)
 12459     CALL 'kxdfhei1' USING DFHEIV0,
 12460           FILE-ID-ERPNDB,
 12461           PENDING-BUSINESS,
 12462           DFHEIV11,
 12463           ERPNDB-KEY,
 12464           DFHEIV99,
 12465           DFHEIV99,
 12466           DFHEIV99
 12467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12468
 12469
 12470     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12471     MOVE 'B'                    TO JP-RECORD-TYPE.
 12472     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12473
 12474     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12475
 12476     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 12477
 12478     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12479
 12480     MOVE 'C'                    TO JP-RECORD-TYPE.
 12481     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12482
 12483
 12484* EXEC CICS REWRITE
 12485*        DATASET    (FILE-ID-ERPNDB)
 12486*        FROM       (PENDING-BUSINESS)
 12487*    END-EXEC.
 12488     MOVE LENGTH OF
 12489      PENDING-BUSINESS
 12490       TO DFHEIV11
 12491*    MOVE '&& L                  %   #00011909' TO DFHEIV0
 12492     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12493     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12494     MOVE X'2020233030303131393039' TO DFHEIV0(25:11)
 12495     CALL 'kxdfhei1' USING DFHEIV0,
 12496           FILE-ID-ERPNDB,
 12497           PENDING-BUSINESS,
 12498           DFHEIV11,
 12499           DFHEIV99
 12500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12501
 12502
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 228
* EL6311.cbl
 12503     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 12504
 12505     IF WS-ERRORS-PRESENT
 12506        GO TO 3900-RE-DISPLAY-RECORD.
 12507
 12508     MOVE ZEROS                  TO EMI-ERROR.
 12509     MOVE -1                     TO BMAINTL.
 12510     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12511     GO TO 3900-RE-DISPLAY-RECORD.
 12512
 12513 1380-BATCH-HDR-NOT-FOUND.
 12514     MOVE -1                     TO BMAINTL.
 12515     MOVE ER-7450                TO EMI-ERROR.
 12516     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12517     GO TO 8200-SEND-DATAONLY.
 12518
 12519 1385-REC-NOT-FOUND.
 12520     MOVE -1                     TO BMAINTL.
 12521     MOVE ER-7451                TO EMI-ERROR.
 12522     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12523     GO TO 8200-SEND-DATAONLY.
 12524
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 229
* EL6311.cbl
 12526
 12527 1386-UPDATE-AGE-FLAGS.
 12528
 12529
 12530* EXEC CICS GETMAIN
 12531*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12532*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12533*        INITIMG (GETMAIN-SPACE)
 12534*    END-EXEC
 12535*    MOVE ',"IL                  $   #00011940' TO DFHEIV0
 12536     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12537     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12538     MOVE X'2020233030303131393430' TO DFHEIV0(25:11)
 12539     CALL 'kxdfhei1' USING DFHEIV0,
 12540           DFHEIV20,
 12541           ELCRTT-RECORD-LENGTH,
 12542           GETMAIN-SPACE
 12543     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12544         DFHEIV20
 12545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12546
 12547
 12548* EXEC CICS HANDLE CONDITION
 12549*        NOTFND   (1386-NOTFND)
 12550*    END-EXEC.
 12551*    MOVE '"$I                   ! ( #00011946' TO DFHEIV0
 12552     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12554     MOVE X'2820233030303131393436' TO DFHEIV0(25:11)
 12555     CALL 'kxdfhei1' USING DFHEIV0
 12556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12557
 12558
 12559     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12560     MOVE 'C'                TO ELCRTT-REC-TYPE
 12561
 12562
 12563* EXEC CICS READ
 12564*        UPDATE
 12565*        DATASET  (CRTT-ID)
 12566*        RIDFLD   (ELCRTT-KEY)
 12567*        INTO     (CERTIFICATE-TRAILERS)
 12568*    END-EXEC.
 12569     MOVE LENGTH OF
 12570      CERTIFICATE-TRAILERS
 12571       TO DFHEIV11
 12572*    MOVE '&"IL       EU         (   #00011953' TO DFHEIV0
 12573     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12574     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12575     MOVE X'2020233030303131393533' TO DFHEIV0(25:11)
 12576     CALL 'kxdfhei1' USING DFHEIV0,
 12577           CRTT-ID,
 12578           CERTIFICATE-TRAILERS,
 12579           DFHEIV11,
 12580           ELCRTT-KEY,
 12581           DFHEIV99,
 12582           DFHEIV99,
 12583           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 230
* EL6311.cbl
 12584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12585
 12586
 12587     IF WS-INS-AGE-SET = 'Y'
 12588        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12589     END-IF
 12590     IF WS-JNT-AGE-SET = 'Y'
 12591        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12592     END-IF
 12593
 12594
 12595* EXEC CICS REWRITE
 12596*       DATASET  (CRTT-ID)
 12597*       FROM     (CERTIFICATE-TRAILERS)
 12598*    END-EXEC.
 12599     MOVE LENGTH OF
 12600      CERTIFICATE-TRAILERS
 12601       TO DFHEIV11
 12602*    MOVE '&& L                  %   #00011967' TO DFHEIV0
 12603     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12604     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12605     MOVE X'2020233030303131393637' TO DFHEIV0(25:11)
 12606     CALL 'kxdfhei1' USING DFHEIV0,
 12607           CRTT-ID,
 12608           CERTIFICATE-TRAILERS,
 12609           DFHEIV11,
 12610           DFHEIV99
 12611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12612
 12613
 12614     GO TO 1386-EXIT.
 12615
 12616 1386-NOTFND.
 12617
 12618     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12619     MOVE 'CS'         TO CS-RECORD-ID.
 12620     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12621     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12622     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12623     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12624     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12625
 12626* EXEC CICS WRITE
 12627*       DATASET  (CRTT-ID)
 12628*       RIDFLD   (ELCRTT-KEY)
 12629*       FROM     (CERTIFICATE-TRAILERS)
 12630*    END-EXEC.
 12631     MOVE LENGTH OF
 12632      CERTIFICATE-TRAILERS
 12633       TO DFHEIV11
 12634*    MOVE '&$ L                  ''   #00011983' TO DFHEIV0
 12635     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12636     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12637     MOVE X'2020233030303131393833' TO DFHEIV0(25:11)
 12638     CALL 'kxdfhei1' USING DFHEIV0,
 12639           CRTT-ID,
 12640           CERTIFICATE-TRAILERS,
 12641           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 231
* EL6311.cbl
 12642           ELCRTT-KEY,
 12643           DFHEIV99,
 12644           DFHEIV99
 12645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12646
 12647
 12648 1386-EXIT.
 12649     EXIT.
 12650
 12651 1390-UPDATE-ERPNDM.
 12652
 12653
 12654* EXEC CICS HANDLE CONDITION
 12655*        NOTFND (1399-EXIT)
 12656*    END-EXEC.
 12657*    MOVE '"$I                   ! ) #00011994' TO DFHEIV0
 12658     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12659     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12660     MOVE X'2920233030303131393934' TO DFHEIV0(25:11)
 12661     CALL 'kxdfhei1' USING DFHEIV0
 12662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12663
 12664
 12665     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12666
 12667
 12668* EXEC CICS READ
 12669*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12670*        DATASET (FILE-ID-ERPNDM)
 12671*        RIDFLD  (ERPNDM-KEY)
 12672*        UPDATE
 12673*    END-EXEC.
 12674*    MOVE '&"S        EU         (   #00012000' TO DFHEIV0
 12675     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12676     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12677     MOVE X'2020233030303132303030' TO DFHEIV0(25:11)
 12678     CALL 'kxdfhei1' USING DFHEIV0,
 12679           FILE-ID-ERPNDM,
 12680           DFHEIV20,
 12681           DFHEIV99,
 12682           ERPNDM-KEY,
 12683           DFHEIV99,
 12684           DFHEIV99,
 12685           DFHEIV99
 12686     SET ADDRESS OF PENDING-MAILING-DATA TO
 12687         DFHEIV20
 12688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12689
 12690
 12691     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12692     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12693     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12694
 12695     IF BLSTNML GREATER THAN ZEROS
 12696         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12697
 12698     IF B1STNML GREATER  THAN ZEROS
 12699         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 232
* EL6311.cbl
 12700
 12701     IF BINITL GREATER THAN ZEROS
 12702         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12703
 12704     IF BAGEL GREATER THAN ZEROS
 12705         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12706
 12707     IF BBIRTHL GREATER THAN ZEROS
 12708         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12709
 12710     IF BSEXL GREATER THAN ZEROS
 12711         MOVE  BSEXI             TO PM-INSURED-SEX.
 12712
 12713
 12714* EXEC CICS REWRITE
 12715*        DATASET (FILE-ID-ERPNDM)
 12716*        FROM    (PENDING-MAILING-DATA)
 12717*    END-EXEC.
 12718     MOVE LENGTH OF
 12719      PENDING-MAILING-DATA
 12720       TO DFHEIV11
 12721*    MOVE '&& L                  %   #00012029' TO DFHEIV0
 12722     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12723     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12724     MOVE X'2020233030303132303239' TO DFHEIV0(25:11)
 12725     CALL 'kxdfhei1' USING DFHEIV0,
 12726           FILE-ID-ERPNDM,
 12727           PENDING-MAILING-DATA,
 12728           DFHEIV11,
 12729           DFHEIV99
 12730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12731
 12732
 12733 1399-EXIT.
 12734     EXIT.
 12735 139A-SET-LETTER-REQD.
 12736*  COMPARE BEFORE AND AFTER CHANGE
 12737     IF PB-ISSUE-RECORD = WS-SAVE-PEND-ISSUE
 12738        GO TO 139A-EXIT
 12739     END-IF
 12740
 12741*  READ ELCRTO
 12742     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12743                                 TO ELCRTO-KEY
 12744     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12745     MOVE +0                     TO ELCRTO-SEQ-NO
 12746
 12747
 12748* EXEC CICS READ
 12749*       DATASET   ('ELCRTO')
 12750*       INTO      (ORIGINAL-CERTIFICATE)
 12751*       RIDFLD    (ELCRTO-KEY)
 12752*       GTEQ
 12753*       RESP      (WS-RESPONSE)
 12754*    END-EXEC
 12755     MOVE LENGTH OF
 12756      ORIGINAL-CERTIFICATE
 12757       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 233
* EL6311.cbl
 12758     MOVE 'ELCRTO' TO DFHEIV1
 12759*    MOVE '&"IL       G          (  N#00012048' TO DFHEIV0
 12760     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12761     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12762     MOVE X'204E233030303132303438' TO DFHEIV0(25:11)
 12763     CALL 'kxdfhei1' USING DFHEIV0,
 12764           DFHEIV1,
 12765           ORIGINAL-CERTIFICATE,
 12766           DFHEIV11,
 12767           ELCRTO-KEY,
 12768           DFHEIV99,
 12769           DFHEIV99,
 12770           DFHEIV99
 12771     MOVE EIBRESP  TO WS-RESPONSE
 12772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12773
 12774*    display ' just read gteq ' ws-response
 12775     IF RESP-NORMAL
 12776        AND (OC-CONTROL-PRIMARY (1:33) =
 12777                 PB-CONTROL-BY-ACCOUNT (1:33))
 12778        AND (OC-RECORD-TYPE = 'I')
 12779*      compare individual fields
 12780        IF LETRREQL   GREATER THAN ZEROS
 12781           CONTINUE
 12782        ELSE
 12783        IF OC-CERT-NO = PB-CERT-NO
 12784          AND OC-CERT-EFF-DT = PB-CERT-EFF-DT
 12785          AND OC-INS-LAST-NAME = PB-I-INSURED-LAST-NAME
 12786          AND OC-INS-FIRST-NAME = PB-I-INSURED-FIRST-NAME
 12787          AND OC-INS-MIDDLE-INIT =  PB-I-INSURED-MIDDLE-INIT
 12788          AND OC-INS-AGE = PB-I-AGE
 12789          AND OC-LF-BENCD = PB-I-LIFE-BENEFIT-CD
 12790          AND OC-LF-TERM = PB-I-LF-TERM
 12791          AND OC-LF-BEN-AMT = PB-I-LF-BENEFIT-AMT
 12792          AND OC-LF-PRM-AMT = PB-I-LF-PREMIUM-AMT
 12793          AND OC-LF-EXP-DT = PB-I-LF-EXPIRE-DT
 12794          AND OC-LF-ALT-BEN-AMT = PB-I-LF-ALT-BENEFIT-AMT
 12795          AND PB-I-LF-ALT-PREMIUM-AMT = OC-LF-ALT-PRM-AMT
 12796          AND PB-I-LF-EXPIRE-DT = OC-LF-EXP-DT
 12797          AND PB-I-AH-BENEFIT-CD     = OC-AH-BENCD
 12798          AND PB-I-AH-TERM           = OC-AH-TERM
 12799          AND PB-I-AH-BENEFIT-AMT    = OC-AH-BEN-AMT
 12800          AND PB-I-AH-PREMIUM-AMT    = OC-AH-PRM-AMT
 12801          AND PB-I-AH-EXPIRE-DT      = OC-AH-EXP-DT
 12802          AND PB-I-AH-COMMISSION     = OC-AH-COMM-PCT
 12803          AND PB-I-AH-CRIT-PER       = OC-AH-CP
 12804           MOVE SPACE TO PB-I-LETTER-REQD
 12805        ELSE
 12806           MOVE 'Y' TO PB-I-LETTER-REQD
 12807        END-IF
 12808     END-IF.
 12809
 12810 139A-EXIT.
 12811     EXIT.
 12812
 12813******************************************************************
 12814*                                                                *
 12815*          D E L E T E   I S S U E   R O U T I N E               *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 234
* EL6311.cbl
 12816*                                                                *
 12817******************************************************************
 12818
 12819 1400-DELETE-ISSUE-ROUTINE.
 12820     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12821
 12822     IF BCHGL NOT = ZEROS
 12823        MOVE ER-2196             TO EMI-ERROR
 12824        MOVE AL-UABON            TO BMAINTA
 12825        MOVE -1                  TO BMAINTL
 12826        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12827        GO TO 8200-SEND-DATAONLY.
 12828
 12829
 12830* EXEC CICS HANDLE CONDITION
 12831*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12832*    END-EXEC.
 12833*    MOVE '"$I                   ! * #00012111' TO DFHEIV0
 12834     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12836     MOVE X'2A20233030303132313131' TO DFHEIV0(25:11)
 12837     CALL 'kxdfhei1' USING DFHEIV0
 12838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12839
 12840
 12841     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12842     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12843     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12844
 12845
 12846* EXEC CICS READ
 12847*        SET     (ADDRESS OF PENDING-BUSINESS)
 12848*        DATASET (FILE-ID-ERPNDB)
 12849*        RIDFLD  (ERPNDB-KEY)
 12850*    END-EXEC.
 12851*    MOVE '&"S        E          (   #00012119' TO DFHEIV0
 12852     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12853     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12854     MOVE X'2020233030303132313139' TO DFHEIV0(25:11)
 12855     CALL 'kxdfhei1' USING DFHEIV0,
 12856           FILE-ID-ERPNDB,
 12857           DFHEIV20,
 12858           DFHEIV99,
 12859           ERPNDB-KEY,
 12860           DFHEIV99,
 12861           DFHEIV99,
 12862           DFHEIV99
 12863     SET ADDRESS OF PENDING-BUSINESS TO
 12864         DFHEIV20
 12865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12866
 12867
 12868     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12869
 12870     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12871
 12872     IF BSUFIXL NOT = ZEROS
 12873        MOVE BSUFIXI             TO WS-NEW-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 235
* EL6311.cbl
 12874     ELSE
 12875        MOVE SPACE               TO WS-NEW-SUFFIX.
 12876
 12877     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12878     PERFORM 8600-DEEDIT.
 12879     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12880     MOVE '4'                    TO DC-OPTION-CODE.
 12881     PERFORM 9700-DATE-LINK.
 12882     IF DATE-CONVERSION-ERROR
 12883        MOVE ER-0348             TO EMI-ERROR
 12884        MOVE -1                  TO BEFFDTL
 12885        MOVE AL-UABON            TO BEFFDTA
 12886        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12887        GO TO 8200-SEND-DATAONLY
 12888     ELSE
 12889        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12890        MOVE AL-UANON            TO BEFFDTA
 12891        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12892
 12893
 12894* EXEC CICS HANDLE CONDITION
 12895*         NOTFND    (1490-RECORD-NOT-FOUND)
 12896*    END-EXEC.
 12897*    MOVE '"$I                   ! + #00012150' TO DFHEIV0
 12898     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12899     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12900     MOVE X'2B20233030303132313530' TO DFHEIV0(25:11)
 12901     CALL 'kxdfhei1' USING DFHEIV0
 12902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12903
 12904
 12905
 12906* EXEC CICS READ
 12907*        SET     (ADDRESS OF PENDING-BUSINESS)
 12908*        DATASET (FILE-ID-ERPNDB)
 12909*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12910*        UPDATE
 12911*    END-EXEC.
 12912*    MOVE '&"S        EU         (   #00012154' TO DFHEIV0
 12913     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12914     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12915     MOVE X'2020233030303132313534' TO DFHEIV0(25:11)
 12916     CALL 'kxdfhei1' USING DFHEIV0,
 12917           FILE-ID-ERPNDB,
 12918           DFHEIV20,
 12919           DFHEIV99,
 12920           PI-PREV-CONTROL-PRIMARY,
 12921           DFHEIV99,
 12922           DFHEIV99,
 12923           DFHEIV99
 12924     SET ADDRESS OF PENDING-BUSINESS TO
 12925         DFHEIV20
 12926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12927
 12928
 12929     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12930        MOVE -1                 TO BMAINTL
 12931        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 236
* EL6311.cbl
 12932        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12933        GO TO 8200-SEND-DATAONLY.
 12934
 12935     IF PB-BILLED-DT NOT = LOW-VALUES
 12936        MOVE -1                 TO BMAINTL
 12937        MOVE ER-2129            TO EMI-ERROR
 12938        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12939        GO TO 8200-SEND-DATAONLY.
 12940
 12941     IF PB-CHG-COUNT NOT = ZEROS
 12942        MOVE ER-2336            TO EMI-ERROR
 12943        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12944        MOVE AL-UABON            TO BMAINTA
 12945        MOVE -1                  TO BMAINTL
 12946        GO TO 8200-SEND-DATAONLY.
 12947
 12948     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12949        PB-CHG-COUNT NOT = ZEROS
 12950        MOVE ER-2196             TO EMI-ERROR
 12951        MOVE AL-UABON            TO BMAINTA
 12952        MOVE -1                  TO BMAINTL
 12953        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12954        GO TO 8200-SEND-DATAONLY.
 12955******************************************************************
 12956*                                                                *
 12957*       Determine if there have been any checks created          *
 12958*                                                                *
 12959******************************************************************
 12960
 12961     perform 2500-browse-checks  thru 2500-exit
 12962
 12963     if i-have-processed-checks
 12964        or i-have-checks
 12965        or i-have-a-check-period
 12966        move er-3446             to emi-error
 12967        perform 9900-error-format thru 9900-exit
 12968        move al-uabon            to bmainta
 12969        move -1                  to bmaintl
 12970        go to 8200-send-dataonly
 12971     end-if
 12972******************************************************************
 12973*                                                                *
 12974*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12975*                                                                *
 12976******************************************************************
 12977     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12978     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12979     MOVE +0                     TO ELCRTO-SEQ-NO
 12980
 12981* EXEC CICS READ
 12982*       DATASET   ('ELCRTO')
 12983*       INTO      (ORIGINAL-CERTIFICATE)
 12984*       RIDFLD    (ELCRTO-KEY)
 12985*       GTEQ
 12986*       RESP      (WS-RESPONSE)
 12987*    END-EXEC
 12988     MOVE LENGTH OF
 12989      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 237
* EL6311.cbl
 12990       TO DFHEIV11
 12991     MOVE 'ELCRTO' TO DFHEIV1
 12992*    MOVE '&"IL       G          (  N#00012212' TO DFHEIV0
 12993     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12995     MOVE X'204E233030303132323132' TO DFHEIV0(25:11)
 12996     CALL 'kxdfhei1' USING DFHEIV0,
 12997           DFHEIV1,
 12998           ORIGINAL-CERTIFICATE,
 12999           DFHEIV11,
 13000           ELCRTO-KEY,
 13001           DFHEIV99,
 13002           DFHEIV99,
 13003           DFHEIV99
 13004     MOVE EIBRESP  TO WS-RESPONSE
 13005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13006     IF RESP-NORMAL
 13007        AND (OC-CONTROL-PRIMARY (1:33) =
 13008                 PB-CONTROL-BY-ACCOUNT (1:33))
 13009        AND (OC-RECORD-TYPE = 'I')
 13010
 13011* EXEC CICS READ
 13012*          DATASET   ('ELCRTO')
 13013*          INTO      (ORIGINAL-CERTIFICATE)
 13014*          RIDFLD    (ELCRTO-KEY)
 13015*          UPDATE
 13016*          RESP      (WS-RESPONSE)
 13017*       END-EXEC
 13018     MOVE LENGTH OF
 13019      ORIGINAL-CERTIFICATE
 13020       TO DFHEIV11
 13021     MOVE 'ELCRTO' TO DFHEIV1
 13022*    MOVE '&"IL       EU         (  N#00012223' TO DFHEIV0
 13023     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13024     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13025     MOVE X'204E233030303132323233' TO DFHEIV0(25:11)
 13026     CALL 'kxdfhei1' USING DFHEIV0,
 13027           DFHEIV1,
 13028           ORIGINAL-CERTIFICATE,
 13029           DFHEIV11,
 13030           ELCRTO-KEY,
 13031           DFHEIV99,
 13032           DFHEIV99,
 13033           DFHEIV99
 13034     MOVE EIBRESP  TO WS-RESPONSE
 13035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13036        IF RESP-NORMAL
 13037
 13038* EXEC CICS DELETE
 13039*             DATASET   ('ELCRTO')
 13040*          END-EXEC
 13041     MOVE 'ELCRTO' TO DFHEIV1
 13042*    MOVE '&(                    &   #00012231' TO DFHEIV0
 13043     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13044     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13045     MOVE X'2020233030303132323331' TO DFHEIV0(25:11)
 13046     CALL 'kxdfhei1' USING DFHEIV0,
 13047           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 238
* EL6311.cbl
 13048           DFHEIV99,
 13049           DFHEIV99,
 13050           DFHEIV99,
 13051           DFHEIV99
 13052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13053        END-IF
 13054     END-IF
 13055******************************************************************
 13056*                                                                *
 13057*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 13058*                                                                *
 13059******************************************************************
 13060
 13061* EXEC CICS HANDLE CONDITION
 13062*        NOTFND    (1405-DELETE-CERTIFICATE)
 13063*    END-EXEC.
 13064*    MOVE '"$I                   ! , #00012241' TO DFHEIV0
 13065     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13067     MOVE X'2C20233030303132323431' TO DFHEIV0(25:11)
 13068     CALL 'kxdfhei1' USING DFHEIV0
 13069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13070
 13071
 13072
 13073* EXEC CICS READ
 13074*        EQUAL
 13075*        DATASET   (FILE-ID-ERPNDM)
 13076*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 13077*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 13078*        UPDATE
 13079*    END-EXEC.
 13080*    MOVE '&"S        EU         (   #00012245' TO DFHEIV0
 13081     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13082     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13083     MOVE X'2020233030303132323435' TO DFHEIV0(25:11)
 13084     CALL 'kxdfhei1' USING DFHEIV0,
 13085           FILE-ID-ERPNDM,
 13086           DFHEIV20,
 13087           DFHEIV99,
 13088           PI-PREV-CONTROL-PRIMARY,
 13089           DFHEIV99,
 13090           DFHEIV99,
 13091           DFHEIV99
 13092     SET ADDRESS OF PENDING-MAILING-DATA TO
 13093         DFHEIV20
 13094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13095
 13096
 13097     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 13098     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13099     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 13100
 13101     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13102
 13103
 13104* EXEC CICS DELETE
 13105*        DATASET   (FILE-ID-ERPNDM)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 239
* EL6311.cbl
 13106*    END-EXEC.
 13107*    MOVE '&(                    &   #00012259' TO DFHEIV0
 13108     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13109     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13110     MOVE X'2020233030303132323539' TO DFHEIV0(25:11)
 13111     CALL 'kxdfhei1' USING DFHEIV0,
 13112           FILE-ID-ERPNDM,
 13113           DFHEIV99,
 13114           DFHEIV99,
 13115           DFHEIV99,
 13116           DFHEIV99
 13117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13118
 13119
 13120******************************************************************
 13121*                PROCESS   CERTIFICATE                           *
 13122******************************************************************
 13123
 13124 1405-DELETE-CERTIFICATE.
 13125
 13126* EXEC CICS HANDLE CONDITION
 13127*         NOTFND  (1420-CONTINUE-DELETE)
 13128*    END-EXEC.
 13129*    MOVE '"$I                   ! - #00012268' TO DFHEIV0
 13130     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13132     MOVE X'2D20233030303132323638' TO DFHEIV0(25:11)
 13133     CALL 'kxdfhei1' USING DFHEIV0
 13134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13135
 13136
 13137     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13138     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13139     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13140     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13141
 13142
 13143* EXEC CICS READ
 13144*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13145*        DATASET (FILE-ID-ELCERT)
 13146*        RIDFLD  (ELCERT-KEY)
 13147*        UPDATE
 13148*    END-EXEC.
 13149*    MOVE '&"S        EU         (   #00012277' TO DFHEIV0
 13150     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13151     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13152     MOVE X'2020233030303132323737' TO DFHEIV0(25:11)
 13153     CALL 'kxdfhei1' USING DFHEIV0,
 13154           FILE-ID-ELCERT,
 13155           DFHEIV20,
 13156           DFHEIV99,
 13157           ELCERT-KEY,
 13158           DFHEIV99,
 13159           DFHEIV99,
 13160           DFHEIV99
 13161     SET ADDRESS OF CERTIFICATE-MASTER TO
 13162         DFHEIV20
 13163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 240
* EL6311.cbl
 13164
 13165
 13166     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13167
 13168     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13169     MOVE 'B'                    TO JP-RECORD-TYPE
 13170     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13171
 13172     PERFORM 8400-LOG-JOURNAL-RECORD.
 13173
 13174     IF CERT-NOTES-ARE-NOT-PRESENT
 13175        MOVE ' '                 TO WS-CERT-NOTE-SW
 13176     ELSE
 13177        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13178
 13179     IF INSURED-ADDR-PRESENT
 13180        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13181
 13182******************************************************************
 13183******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13184******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13185******************************************************************
 13186******************************************************************
 13187
 13188     IF CERT-ADDED-BATCH AND
 13189        (NOT NO-CLAIM-ATTACHED
 13190         OR
 13191         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13192        GO TO 1410-REWRITE-CERT.
 13193
 13194******************************************************************
 13195******************************************************************
 13196
 13197     IF CERT-ADDED-BATCH  AND
 13198        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13199        GO TO 1410-REWRITE-CERT.
 13200
 13201     IF NO-CLAIM-ATTACHED
 13202        NEXT SENTENCE
 13203     ELSE
 13204        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13205        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13206        GO TO 1410-REWRITE-CERT.
 13207
 13208     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13209     MOVE 'D'                      TO JP-RECORD-TYPE.
 13210     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13211
 13212
 13213* EXEC CICS DELETE
 13214*         DATASET    (FILE-ID-ELCERT)
 13215*    END-EXEC.
 13216*    MOVE '&(                    &   #00012330' TO DFHEIV0
 13217     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13218     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13219     MOVE X'2020233030303132333330' TO DFHEIV0(25:11)
 13220     CALL 'kxdfhei1' USING DFHEIV0,
 13221           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 241
* EL6311.cbl
 13222           DFHEIV99,
 13223           DFHEIV99,
 13224           DFHEIV99,
 13225           DFHEIV99
 13226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13227
 13228
 13229     PERFORM 8400-LOG-JOURNAL-RECORD.
 13230
 13231******************************************************************
 13232*                                                                *
 13233*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13234*                                                                *
 13235******************************************************************
 13236
 13237     IF  CERT-NOTES-ARE-PRESENT
 13238         NEXT SENTENCE
 13239     ELSE
 13240         GO TO 1407-DELETE-MAILING.
 13241
 13242
 13243* EXEC CICS HANDLE CONDITION
 13244*         NOTFND  (1406-DELETE-ERNOTE)
 13245*    END-EXEC.
 13246*    MOVE '"$I                   ! . #00012347' TO DFHEIV0
 13247     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13249     MOVE X'2E20233030303132333437' TO DFHEIV0(25:11)
 13250     CALL 'kxdfhei1' USING DFHEIV0
 13251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13252
 13253
 13254     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13255     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13256     MOVE 0                     TO ERCNOT-SEQUENCE.
 13257
 13258 1406-DELETE-ERCNOT-LOOP.
 13259
 13260
 13261* EXEC CICS READ
 13262*        GTEQ
 13263*        DATASET   (FILE-ID-ERCNOT)
 13264*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13265*        RIDFLD    (ERCNOT-KEY)
 13266*    END-EXEC.
 13267*    MOVE '&"S        G          (   #00012357' TO DFHEIV0
 13268     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13269     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13270     MOVE X'2020233030303132333537' TO DFHEIV0(25:11)
 13271     CALL 'kxdfhei1' USING DFHEIV0,
 13272           FILE-ID-ERCNOT,
 13273           DFHEIV20,
 13274           DFHEIV99,
 13275           ERCNOT-KEY,
 13276           DFHEIV99,
 13277           DFHEIV99,
 13278           DFHEIV99
 13279     SET ADDRESS OF CERT-NOTE-FILE TO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 242
* EL6311.cbl
 13280         DFHEIV20
 13281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13282
 13283
 13284     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13285     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13286         GO TO 1406-DELETE-ERNOTE
 13287     END-IF.
 13288
 13289     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13290     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13291     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13292
 13293     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13294
 13295
 13296* EXEC CICS DELETE
 13297*        DATASET   (FILE-ID-ERCNOT)
 13298*        RIDFLD    (ERCNOT-KEY)
 13299*        END-EXEC.
 13300*    MOVE '&(  R                 &   #00012375' TO DFHEIV0
 13301     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13302     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13303     MOVE X'2020233030303132333735' TO DFHEIV0(25:11)
 13304     CALL 'kxdfhei1' USING DFHEIV0,
 13305           FILE-ID-ERCNOT,
 13306           ERCNOT-KEY,
 13307           DFHEIV99,
 13308           DFHEIV99,
 13309           DFHEIV99
 13310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13311
 13312
 13313     PERFORM 8400-LOG-JOURNAL-RECORD.
 13314
 13315     GO TO 1406-DELETE-ERCNOT-LOOP.
 13316
 13317 1406-DELETE-ERNOTE.
 13318
 13319
 13320* EXEC CICS HANDLE CONDITION
 13321*         NOTFND  (1407-DELETE-MAILING)
 13322*    END-EXEC.
 13323*    MOVE '"$I                   ! / #00012386' TO DFHEIV0
 13324     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13325     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13326     MOVE X'2F20233030303132333836' TO DFHEIV0(25:11)
 13327     CALL 'kxdfhei1' USING DFHEIV0
 13328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13329
 13330
 13331
 13332* EXEC CICS READ
 13333*        EQUAL
 13334*        DATASET   (FILE-ID-ERNOTE)
 13335*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13336*        RIDFLD    (ELCERT-KEY)
 13337*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 243
* EL6311.cbl
 13338*    END-EXEC.
 13339*    MOVE '&"S        EU         (   #00012390' TO DFHEIV0
 13340     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13341     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13342     MOVE X'2020233030303132333930' TO DFHEIV0(25:11)
 13343     CALL 'kxdfhei1' USING DFHEIV0,
 13344           FILE-ID-ERNOTE,
 13345           DFHEIV20,
 13346           DFHEIV99,
 13347           ELCERT-KEY,
 13348           DFHEIV99,
 13349           DFHEIV99,
 13350           DFHEIV99
 13351     SET ADDRESS OF CERTIFICATE-NOTE TO
 13352         DFHEIV20
 13353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13354
 13355
 13356     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 13357     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13358     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13359
 13360     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13361
 13362
 13363* EXEC CICS DELETE
 13364*        DATASET   (FILE-ID-ERNOTE)
 13365*        END-EXEC.
 13366*    MOVE '&(                    &   #00012404' TO DFHEIV0
 13367     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13368     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13369     MOVE X'2020233030303132343034' TO DFHEIV0(25:11)
 13370     CALL 'kxdfhei1' USING DFHEIV0,
 13371           FILE-ID-ERNOTE,
 13372           DFHEIV99,
 13373           DFHEIV99,
 13374           DFHEIV99,
 13375           DFHEIV99
 13376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13377
 13378
 13379     PERFORM 8400-LOG-JOURNAL-RECORD.
 13380
 13381******************************************************************
 13382*                                                                *
 13383*                DELETE MAILING ADDRESS RECORDS                  *
 13384*                                                                *
 13385******************************************************************
 13386
 13387 1407-DELETE-MAILING.
 13388     IF CERT-ADDRESS-PRESENT
 13389        NEXT SENTENCE
 13390     ELSE
 13391        GO TO 1420-CONTINUE-DELETE.
 13392
 13393
 13394* EXEC CICS HANDLE CONDITION
 13395*         NOTFND  (1420-CONTINUE-DELETE)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 244
* EL6311.cbl
 13396*    END-EXEC.
 13397*    MOVE '"$I                   ! 0 #00012422' TO DFHEIV0
 13398     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13400     MOVE X'3020233030303132343232' TO DFHEIV0(25:11)
 13401     CALL 'kxdfhei1' USING DFHEIV0
 13402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13403
 13404
 13405
 13406* EXEC CICS READ
 13407*        EQUAL
 13408*        DATASET   (FILE-ID-ERMAIL)
 13409*        SET       (ADDRESS OF MAILING-DATA)
 13410*        RIDFLD    (ELCERT-KEY)
 13411*        UPDATE
 13412*    END-EXEC.
 13413*    MOVE '&"S        EU         (   #00012426' TO DFHEIV0
 13414     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13415     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13416     MOVE X'2020233030303132343236' TO DFHEIV0(25:11)
 13417     CALL 'kxdfhei1' USING DFHEIV0,
 13418           FILE-ID-ERMAIL,
 13419           DFHEIV20,
 13420           DFHEIV99,
 13421           ELCERT-KEY,
 13422           DFHEIV99,
 13423           DFHEIV99,
 13424           DFHEIV99
 13425     SET ADDRESS OF MAILING-DATA TO
 13426         DFHEIV20
 13427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13428
 13429
 13430     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13431     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13432     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13433
 13434     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13435
 13436
 13437* EXEC CICS DELETE
 13438*        DATASET   (FILE-ID-ERMAIL)
 13439*    END-EXEC.
 13440*    MOVE '&(                    &   #00012440' TO DFHEIV0
 13441     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13442     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13443     MOVE X'2020233030303132343430' TO DFHEIV0(25:11)
 13444     CALL 'kxdfhei1' USING DFHEIV0,
 13445           FILE-ID-ERMAIL,
 13446           DFHEIV99,
 13447           DFHEIV99,
 13448           DFHEIV99,
 13449           DFHEIV99
 13450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13451
 13452
 13453     GO TO 1420-CONTINUE-DELETE.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 245
* EL6311.cbl
 13454
 13455 1410-REWRITE-CERT.
 13456     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13457     MOVE 'C'                      TO JP-RECORD-TYPE.
 13458     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13459     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13460
 13461
 13462* EXEC CICS REWRITE
 13463*         DATASET    (FILE-ID-ELCERT)
 13464*         FROM       (CERTIFICATE-MASTER)
 13465*         END-EXEC.
 13466     MOVE LENGTH OF
 13467      CERTIFICATE-MASTER
 13468       TO DFHEIV11
 13469*    MOVE '&& L                  %   #00012452' TO DFHEIV0
 13470     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13471     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13472     MOVE X'2020233030303132343532' TO DFHEIV0(25:11)
 13473     CALL 'kxdfhei1' USING DFHEIV0,
 13474           FILE-ID-ELCERT,
 13475           CERTIFICATE-MASTER,
 13476           DFHEIV11,
 13477           DFHEIV99
 13478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13479
 13480
 13481     PERFORM 8400-LOG-JOURNAL-RECORD.
 13482
 13483 1420-CONTINUE-DELETE.
 13484     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13485     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13486
 13487     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13488     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13489
 13490     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13491
 13492 1450-DELETE-PB-RECORD.
 13493     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13494     MOVE 'D'                      TO JP-RECORD-TYPE
 13495     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13496
 13497
 13498* EXEC CICS DELETE
 13499*        DATASET    (FILE-ID-ERPNDB)
 13500*    END-EXEC.
 13501*    MOVE '&(                    &   #00012473' TO DFHEIV0
 13502     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13503     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13504     MOVE X'2020233030303132343733' TO DFHEIV0(25:11)
 13505     CALL 'kxdfhei1' USING DFHEIV0,
 13506           FILE-ID-ERPNDB,
 13507           DFHEIV99,
 13508           DFHEIV99,
 13509           DFHEIV99,
 13510           DFHEIV99
 13511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 246
* EL6311.cbl
 13512
 13513
 13514     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13515
 13516     PERFORM 8400-LOG-JOURNAL-RECORD *> Journal Delete
 13517
 13518     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13519     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13520     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13521
 13522
 13523* EXEC CICS HANDLE CONDITION
 13524*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13525*    END-EXEC.
 13526*    MOVE '"$I                   ! 1 #00012485' TO DFHEIV0
 13527     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13529     MOVE X'3120233030303132343835' TO DFHEIV0(25:11)
 13530     CALL 'kxdfhei1' USING DFHEIV0
 13531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13532
 13533
 13534
 13535* EXEC CICS READ
 13536*        SET     (ADDRESS OF PENDING-BUSINESS)
 13537*        DATASET (FILE-ID-ERPNDB)
 13538*        RIDFLD  (ERPNDB-KEY)
 13539*        UPDATE
 13540*    END-EXEC.
 13541*    MOVE '&"S        EU         (   #00012489' TO DFHEIV0
 13542     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13543     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13544     MOVE X'2020233030303132343839' TO DFHEIV0(25:11)
 13545     CALL 'kxdfhei1' USING DFHEIV0,
 13546           FILE-ID-ERPNDB,
 13547           DFHEIV20,
 13548           DFHEIV99,
 13549           ERPNDB-KEY,
 13550           DFHEIV99,
 13551           DFHEIV99,
 13552           DFHEIV99
 13553     SET ADDRESS OF PENDING-BUSINESS TO
 13554         DFHEIV20
 13555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13556
 13557
 13558     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13559
 13560     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13561
 13562     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13563        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13564        MOVE 'D'                   TO JP-RECORD-TYPE
 13565        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13566
 13567* EXEC CICS DELETE
 13568*            DATASET    (FILE-ID-ERPNDB)
 13569*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 247
* EL6311.cbl
 13570*    MOVE '&(                    &   #00012504' TO DFHEIV0
 13571     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13572     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13573     MOVE X'2020233030303132353034' TO DFHEIV0(25:11)
 13574     CALL 'kxdfhei1' USING DFHEIV0,
 13575           FILE-ID-ERPNDB,
 13576           DFHEIV99,
 13577           DFHEIV99,
 13578           DFHEIV99,
 13579           DFHEIV99
 13580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13581        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Delete
 13582     ELSE
 13583        MOVE 'B'                 TO JP-RECORD-TYPE
 13584        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13585        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before Image
 13586        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13587        MOVE 'C'                 TO JP-RECORD-TYPE
 13588        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13589
 13590* EXEC CICS REWRITE
 13591*            DATASET    (FILE-ID-ERPNDB)
 13592*            FROM       (PENDING-BUSINESS)
 13593*       END-EXEC
 13594     MOVE LENGTH OF
 13595      PENDING-BUSINESS
 13596       TO DFHEIV11
 13597*    MOVE '&& L                  %   #00012515' TO DFHEIV0
 13598     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13599     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13600     MOVE X'2020233030303132353135' TO DFHEIV0(25:11)
 13601     CALL 'kxdfhei1' USING DFHEIV0,
 13602           FILE-ID-ERPNDB,
 13603           PENDING-BUSINESS,
 13604           DFHEIV11,
 13605           DFHEIV99
 13606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13607        PERFORM 8400-LOG-JOURNAL-RECORD  *> After Image
 13608     end-if
 13609******************************************************************
 13610*                                                                *
 13611*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13612*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13613*                                                                *
 13614******************************************************************
 13615
 13616     IF NOT PI-AR-PROCESSING
 13617        GO TO 1475-DELETE-FINISHED.
 13618
 13619     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13620        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13621        NEXT SENTENCE
 13622     ELSE
 13623        GO TO 1475-DELETE-FINISHED.
 13624
 13625
 13626* EXEC CICS HANDLE CONDITION
 13627*         NOTFND    (1475-DELETE-FINISHED)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 248
* EL6311.cbl
 13628*         END-EXEC.
 13629*    MOVE '"$I                   ! 2 #00012537' TO DFHEIV0
 13630     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13632     MOVE X'3220233030303132353337' TO DFHEIV0(25:11)
 13633     CALL 'kxdfhei1' USING DFHEIV0
 13634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13635
 13636
 13637     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13638     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13639
 13640
 13641* EXEC CICS READ
 13642*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13643*        DATASET (FILE-ID-ERRQST)
 13644*        RIDFLD  (ERRQST-KEY)
 13645*        UPDATE
 13646*    END-EXEC.
 13647*    MOVE '&"S        EU         (   #00012544' TO DFHEIV0
 13648     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13649     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13650     MOVE X'2020233030303132353434' TO DFHEIV0(25:11)
 13651     CALL 'kxdfhei1' USING DFHEIV0,
 13652           FILE-ID-ERRQST,
 13653           DFHEIV20,
 13654           DFHEIV99,
 13655           ERRQST-KEY,
 13656           DFHEIV99,
 13657           DFHEIV99,
 13658           DFHEIV99
 13659     SET ADDRESS OF AR-REQUEST-RECORD TO
 13660         DFHEIV20
 13661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13662
 13663
 13664     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13665
 13666     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13667
 13668     MOVE 'D'                      TO JP-RECORD-TYPE.
 13669     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13670
 13671
 13672* EXEC CICS DELETE
 13673*         DATASET    (FILE-ID-ERRQST)
 13674*    END-EXEC.
 13675*    MOVE '&(                    &   #00012558' TO DFHEIV0
 13676     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13677     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13678     MOVE X'2020233030303132353538' TO DFHEIV0(25:11)
 13679     CALL 'kxdfhei1' USING DFHEIV0,
 13680           FILE-ID-ERRQST,
 13681           DFHEIV99,
 13682           DFHEIV99,
 13683           DFHEIV99,
 13684           DFHEIV99
 13685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 249
* EL6311.cbl
 13686
 13687
 13688     PERFORM 8400-LOG-JOURNAL-RECORD.
 13689
 13690 1475-DELETE-FINISHED.
 13691     MOVE ZEROS                  TO EMI-ERROR.
 13692     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13693     MOVE LOW-VALUES             TO EL631BI.
 13694     MOVE -1                     TO BMAINTL.
 13695     GO TO 8100-SEND-INITIAL-MAP.
 13696
 13697 1480-BATCH-HDR-NOT-FOUND.
 13698     MOVE -1                     TO BMAINTL.
 13699     MOVE ER-7450                TO EMI-ERROR.
 13700     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13701     GO TO 8200-SEND-DATAONLY.
 13702
 13703 1490-RECORD-NOT-FOUND.
 13704     MOVE -1                     TO BMAINTL.
 13705     MOVE ER-7451                TO EMI-ERROR.
 13706     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13707     GO TO 8200-SEND-DATAONLY.
 13708
 13709******************************************************************
 13710*            O V E R   C H A R G E   P R O C E S S I N G         *
 13711******************************************************************
 13712 1500-UPDATE-ERNOTE.
 13713     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13714     MOVE 'A'                    TO WS-NOTE-SW
 13715     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13716     .
 13717 1500-EXIT.
 13718     EXIT.
 13719 1510-ADD-ERNOTE-REC.
 13720
 13721* EXEC CICS GETMAIN
 13722*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13723*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13724*        INITIMG (GETMAIN-SPACE)
 13725*    END-EXEC
 13726*    MOVE ',"IL                  $   #00012594' TO DFHEIV0
 13727     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13728     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13729     MOVE X'2020233030303132353934' TO DFHEIV0(25:11)
 13730     CALL 'kxdfhei1' USING DFHEIV0,
 13731           DFHEIV20,
 13732           ERNOTE-RECORD-LENGTH,
 13733           GETMAIN-SPACE
 13734     SET ADDRESS OF CERTIFICATE-NOTE TO
 13735         DFHEIV20
 13736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13737     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13738                                 TO ERNOTE-KEY
 13739
 13740* EXEC CICS READ
 13741*       DATASET    (FILE-ID-ERNOTE)
 13742*       RIDFLD     (ERNOTE-KEY)
 13743*       INTO       (CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 250
* EL6311.cbl
 13744*       RESP       (WS-RESPONSE)
 13745*       UPDATE
 13746*    END-EXEC
 13747     MOVE LENGTH OF
 13748      CERTIFICATE-NOTE
 13749       TO DFHEIV11
 13750*    MOVE '&"IL       EU         (  N#00012601' TO DFHEIV0
 13751     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13752     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13753     MOVE X'204E233030303132363031' TO DFHEIV0(25:11)
 13754     CALL 'kxdfhei1' USING DFHEIV0,
 13755           FILE-ID-ERNOTE,
 13756           CERTIFICATE-NOTE,
 13757           DFHEIV11,
 13758           ERNOTE-KEY,
 13759           DFHEIV99,
 13760           DFHEIV99,
 13761           DFHEIV99
 13762     MOVE EIBRESP  TO WS-RESPONSE
 13763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13764     IF RESP-NORMAL
 13765        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13766           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13767        END-IF
 13768        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13769           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13770        END-IF
 13771        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13772           (N1 > +10)
 13773           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13774           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13775        END-PERFORM
 13776        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13777          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13778
 13779* EXEC CICS UNLOCK
 13780*            DATASET    (FILE-ID-ERNOTE)
 13781*          END-EXEC
 13782*    MOVE '&*                    #   #00012622' TO DFHEIV0
 13783     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13784     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13785     MOVE X'2020233030303132363232' TO DFHEIV0(25:11)
 13786     CALL 'kxdfhei1' USING DFHEIV0,
 13787           FILE-ID-ERNOTE,
 13788           DFHEIV99
 13789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13790        ELSE
 13791          PERFORM VARYING N1 FROM +1 BY +1
 13792           UNTIL (N1 > +10)
 13793           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13794          END-PERFORM
 13795          IF (N1 < +11)
 13796            IF N1 >= CN-BILLING-START-LINE-NO AND
 13797              N1 <= CN-BILLING-END-LINE-NO
 13798              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13799                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13800              ELSE
 13801                 MOVE WS-VA-NO-COMM-MESS
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 251
* EL6311.cbl
 13802                                    TO CN-LINE (N1)
 13803              END-IF
 13804            ELSE
 13805              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13806               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13807                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13808                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13809                ELSE
 13810                  MOVE WS-VA-NO-COMM-MESS
 13811                                    TO CN-LINE (N1)
 13812                END-IF
 13813                MOVE N1             TO CN-BILLING-END-LINE-NO
 13814              ELSE
 13815                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13816                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13817                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13818                  ELSE
 13819                     MOVE WS-VA-NO-COMM-MESS
 13820                                    TO CN-LINE (N1)
 13821                  END-IF
 13822                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13823                                      CN-BILLING-START-LINE-NO
 13824                ELSE
 13825                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13826                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13827                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13828                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13829                     ELSE
 13830                       MOVE WS-VA-NO-COMM-MESS
 13831                                    TO CN-LINE (N1)
 13832                     END-IF
 13833                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13834                  ELSE
 13835                     PERFORM 1700-SQUEEZE-IT-IN
 13836                                 THRU 1700-EXIT
 13837                  END-IF
 13838                END-IF
 13839              END-IF
 13840            END-IF
 13841            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13842            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13843            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13844
 13845* EXEC CICS REWRITE
 13846*              DATASET    (FILE-ID-ERNOTE)
 13847*              FROM       (CERTIFICATE-NOTE)
 13848*              RESP       (WS-RESPONSE)
 13849*           END-EXEC
 13850     MOVE LENGTH OF
 13851      CERTIFICATE-NOTE
 13852       TO DFHEIV11
 13853*    MOVE '&& L                  %  N#00012679' TO DFHEIV0
 13854     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13855     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13856     MOVE X'204E233030303132363739' TO DFHEIV0(25:11)
 13857     CALL 'kxdfhei1' USING DFHEIV0,
 13858           FILE-ID-ERNOTE,
 13859           CERTIFICATE-NOTE,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 252
* EL6311.cbl
 13860           DFHEIV11,
 13861           DFHEIV99
 13862     MOVE EIBRESP  TO WS-RESPONSE
 13863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13864          END-IF
 13865        END-IF
 13866     ELSE
 13867        MOVE SPACES              TO CERTIFICATE-NOTE
 13868        MOVE 'CN'                TO CN-RECORD-ID
 13869        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13870                                 TO CN-CONTROL-PRIMARY
 13871                                    ERNOTE-KEY
 13872        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13873                                    CN-BILLING-END-LINE-NO
 13874        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13875           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13876        ELSE
 13877           MOVE WS-VA-NO-COMM-MESS
 13878                                 TO CN-LINE (1)
 13879        END-IF
 13880        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13881        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13882        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13883
 13884* EXEC CICS WRITE
 13885*          DATASET    (FILE-ID-ERNOTE)
 13886*          FROM       (CERTIFICATE-NOTE)
 13887*          RIDFLD     (ERNOTE-KEY)
 13888*          RESP       (WS-RESPONSE)
 13889*       END-EXEC
 13890     MOVE LENGTH OF
 13891      CERTIFICATE-NOTE
 13892       TO DFHEIV11
 13893*    MOVE '&$ L                  ''  N#00012703' TO DFHEIV0
 13894     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13895     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13896     MOVE X'204E233030303132373033' TO DFHEIV0(25:11)
 13897     CALL 'kxdfhei1' USING DFHEIV0,
 13898           FILE-ID-ERNOTE,
 13899           CERTIFICATE-NOTE,
 13900           DFHEIV11,
 13901           ERNOTE-KEY,
 13902           DFHEIV99,
 13903           DFHEIV99
 13904     MOVE EIBRESP  TO WS-RESPONSE
 13905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13906     END-IF
 13907     .
 13908 1510-EXIT.
 13909     EXIT.
 13910 1520-UPDATE-ELCERT.
 13911     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13912                                 TO ELCERT-KEY
 13913
 13914* EXEC CICS READ
 13915*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13916*        DATASET (FILE-ID-ELCERT)
 13917*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 253
* EL6311.cbl
 13918*        UPDATE
 13919*        RESP    (WS-RESPONSE)
 13920*    END-EXEC
 13921*    MOVE '&"S        EU         (  N#00012716' TO DFHEIV0
 13922     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13923     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13924     MOVE X'204E233030303132373136' TO DFHEIV0(25:11)
 13925     CALL 'kxdfhei1' USING DFHEIV0,
 13926           FILE-ID-ELCERT,
 13927           DFHEIV20,
 13928           DFHEIV99,
 13929           ELCERT-KEY,
 13930           DFHEIV99,
 13931           DFHEIV99,
 13932           DFHEIV99
 13933     SET ADDRESS OF CERTIFICATE-MASTER TO
 13934         DFHEIV20
 13935     MOVE EIBRESP  TO WS-RESPONSE
 13936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13937     IF RESP-NORMAL
 13938        IF WS-NOTE-SW = 'A'
 13939           IF CM-NOTE-SW = ' '
 13940              MOVE '2'             TO CM-NOTE-SW
 13941           ELSE
 13942             IF CM-NOTE-SW = '1'
 13943                MOVE '3'           TO CM-NOTE-SW
 13944             ELSE
 13945               IF CM-NOTE-SW = '4'
 13946                  MOVE '6'         TO CM-NOTE-SW
 13947               ELSE
 13948                 IF CM-NOTE-SW = '5'
 13949                    MOVE '7'       TO CM-NOTE-SW
 13950                 END-IF
 13951               END-IF
 13952             END-IF
 13953           END-IF
 13954        ELSE
 13955           IF CM-NOTE-SW = '2'
 13956              MOVE ' '             TO CM-NOTE-SW
 13957           ELSE
 13958             IF CM-NOTE-SW = '3'
 13959                MOVE '1'           TO CM-NOTE-SW
 13960             ELSE
 13961               IF CM-NOTE-SW = '6'
 13962                  MOVE '4'         TO CM-NOTE-SW
 13963               ELSE
 13964                 IF CM-NOTE-SW = '7'
 13965                    MOVE '5'       TO CM-NOTE-SW
 13966                 END-IF
 13967               END-IF
 13968             END-IF
 13969           END-IF
 13970        END-IF
 13971
 13972* EXEC CICS REWRITE
 13973*          DATASET    (FILE-ID-ELCERT)
 13974*          FROM       (CERTIFICATE-MASTER)
 13975*          RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 254
* EL6311.cbl
 13976*       END-EXEC
 13977     MOVE LENGTH OF
 13978      CERTIFICATE-MASTER
 13979       TO DFHEIV11
 13980*    MOVE '&& L                  %  N#00012757' TO DFHEIV0
 13981     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13982     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13983     MOVE X'204E233030303132373537' TO DFHEIV0(25:11)
 13984     CALL 'kxdfhei1' USING DFHEIV0,
 13985           FILE-ID-ELCERT,
 13986           CERTIFICATE-MASTER,
 13987           DFHEIV11,
 13988           DFHEIV99
 13989     MOVE EIBRESP  TO WS-RESPONSE
 13990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13991        IF RESP-NORMAL
 13992           CONTINUE
 13993        ELSE
 13994           MOVE WS-RESPONSE TO EMI-ERROR
 13995           PERFORM 9900-ERROR-FORMAT
 13996                                 THRU 9900-EXIT
 13997           GO TO 8200-SEND-DATAONLY
 13998        END-IF
 13999     ELSE
 14000        MOVE -1                  TO BMAINTL
 14001        MOVE 0249                TO EMI-ERROR
 14002        PERFORM 9900-ERROR-FORMAT
 14003                                 THRU 9900-EXIT
 14004        GO TO 8200-SEND-DATAONLY
 14005     END-IF
 14006     .
 14007 1520-EXIT.
 14008     EXIT.
 14009 1600-UPDATE-ERPYAJ.
 14010     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 14011                                 THRU 1610-EXIT
 14012     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 14013                                 THRU 1620-EXIT
 14014     .
 14015 1600-EXIT.
 14016     EXIT.
 14017 1610-ADD-ERPYAJ-BANK-REC.
 14018
 14019* EXEC CICS GETMAIN
 14020*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 14021*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 14022*        INITIMG (GETMAIN-SPACE)
 14023*    END-EXEC
 14024*    MOVE ',"IL                  $   #00012789' TO DFHEIV0
 14025     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14026     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14027     MOVE X'2020233030303132373839' TO DFHEIV0(25:11)
 14028     CALL 'kxdfhei1' USING DFHEIV0,
 14029           DFHEIV20,
 14030           ERPYAJ-RECORD-LENGTH,
 14031           GETMAIN-SPACE
 14032     SET ADDRESS OF PENDING-PAY-ADJ TO
 14033         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 255
* EL6311.cbl
 14034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14035     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14036     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14037     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14038     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14039     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14040     MOVE +10                    TO ERPYAJ-SEQ-NO
 14041     MOVE 'R'                    TO ERPYAJ-TYPE
 14042     IF REVERSAL
 14043        MOVE 'C'                 TO ERPYAJ-TYPE
 14044     END-IF
 14045     MOVE SPACES                 TO PENDING-PAY-ADJ
 14046     MOVE 'PY'                   TO PY-RECORD-ID
 14047     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14048     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 14049     IF REVERSAL
 14050        MOVE PB-I-DCC-OVER-CHG-AMT
 14051                                 TO PY-ENTRY-AMT
 14052     END-IF
 14053     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 14054                                    PY-INPUT-DT
 14055*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 14056*                                   PY-INPUT-DT
 14057     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 14058     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 14059     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 14060     MOVE 'B'                    TO PY-ERCOMP-TYPE
 14061     IF PB-CARRIER = '2'
 14062        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14063     ELSE
 14064        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14065     END-IF
 14066     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 14067                                    PY-BILLED-DATE
 14068                                    PY-AR-DATE
 14069                                    PY-REPORTED-DT
 14070                                    PY-CHECK-WRITTEN-DT
 14071     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 14072                                    PY-CHECK-QUE-SEQUENCE
 14073     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 14074     PERFORM WITH TEST AFTER
 14075        UNTIL (NOT RESP-DUPKEY)
 14076           AND (NOT RESP-DUPREC)
 14077
 14078* EXEC CICS WRITE
 14079*          DATASET    (FILE-ID-ERPYAJ)
 14080*          FROM       (PENDING-PAY-ADJ)
 14081*          RIDFLD     (ERPYAJ-KEY)
 14082*          RESP       (WS-RESPONSE)
 14083*       END-EXEC
 14084     MOVE LENGTH OF
 14085      PENDING-PAY-ADJ
 14086       TO DFHEIV11
 14087*    MOVE '&$ L                  ''  N#00012836' TO DFHEIV0
 14088     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14089     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14090     MOVE X'204E233030303132383336' TO DFHEIV0(25:11)
 14091     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 256
* EL6311.cbl
 14092           FILE-ID-ERPYAJ,
 14093           PENDING-PAY-ADJ,
 14094           DFHEIV11,
 14095           ERPYAJ-KEY,
 14096           DFHEIV99,
 14097           DFHEIV99
 14098     MOVE EIBRESP  TO WS-RESPONSE
 14099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14100        IF RESP-DUPKEY OR RESP-DUPREC
 14101           ADD +1                TO ERPYAJ-SEQ-NO
 14102           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14103        END-IF
 14104     END-PERFORM
 14105     .
 14106 1610-EXIT.
 14107     EXIT.
 14108 1620-ADD-ERPYAJ-DLR-REC.
 14109     MOVE 'C'                    TO ERPYAJ-TYPE
 14110     IF REVERSAL
 14111        MOVE 'R'                 TO ERPYAJ-TYPE
 14112     END-IF
 14113     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14114                                    ERPYAJ-ACCOUNT
 14115     ADD +1                      TO ERPYAJ-SEQ-NO
 14116     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14117     MOVE 'A'                    TO PY-ERCOMP-TYPE
 14118     IF PB-CARRIER = '2'
 14119        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14120     ELSE
 14121        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14122     END-IF
 14123     PERFORM WITH TEST AFTER
 14124        UNTIL (NOT RESP-DUPKEY)
 14125           AND (NOT RESP-DUPREC)
 14126
 14127* EXEC CICS WRITE
 14128*          DATASET    (FILE-ID-ERPYAJ)
 14129*          FROM       (PENDING-PAY-ADJ)
 14130*          RIDFLD     (ERPYAJ-KEY)
 14131*          RESP       (WS-RESPONSE)
 14132*       END-EXEC
 14133     MOVE LENGTH OF
 14134      PENDING-PAY-ADJ
 14135       TO DFHEIV11
 14136*    MOVE '&$ L                  ''  N#00012868' TO DFHEIV0
 14137     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14138     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14139     MOVE X'204E233030303132383638' TO DFHEIV0(25:11)
 14140     CALL 'kxdfhei1' USING DFHEIV0,
 14141           FILE-ID-ERPYAJ,
 14142           PENDING-PAY-ADJ,
 14143           DFHEIV11,
 14144           ERPYAJ-KEY,
 14145           DFHEIV99,
 14146           DFHEIV99
 14147     MOVE EIBRESP  TO WS-RESPONSE
 14148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14149        IF RESP-DUPKEY OR RESP-DUPREC
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 257
* EL6311.cbl
 14150           ADD +1                TO ERPYAJ-SEQ-NO
 14151           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14152        END-IF
 14153     END-PERFORM
 14154     .
 14155 1620-EXIT.
 14156     EXIT.
 14157 1700-SQUEEZE-IT-IN.
 14158     IF (N1 > CN-BILLING-END-LINE-NO)
 14159        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 14160           N1 = +1
 14161           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 14162           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 14163              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14164                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 14165              ELSE
 14166                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14167              END-IF
 14168              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 14169              MOVE +2 TO N1
 14170           END-IF
 14171        END-PERFORM
 14172     ELSE
 14173        IF (N1 < CN-BILLING-START-LINE-NO)
 14174           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14175              N1 = +10
 14176              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14177              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 14178                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14179                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14180                 ELSE
 14181                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14182                 END-IF
 14183                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14184                 MOVE +9 TO N1
 14185              END-IF
 14186           END-PERFORM
 14187        END-IF
 14188     END-IF
 14189     .
 14190 1700-EXIT.
 14191     EXIT.
 14192 1800-REMOVE-CERT-NOTES.
 14193     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14194                                 TO ERNOTE-KEY
 14195
 14196* EXEC CICS READ
 14197*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14198*       DATASET    (FILE-ID-ERNOTE)
 14199*       RIDFLD     (ERNOTE-KEY)
 14200*       RESP       (WS-RESPONSE)
 14201*       UPDATE
 14202*    END-EXEC
 14203*    MOVE '&"S        EU         (  N#00012920' TO DFHEIV0
 14204     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14205     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14206     MOVE X'204E233030303132393230' TO DFHEIV0(25:11)
 14207     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 258
* EL6311.cbl
 14208           FILE-ID-ERNOTE,
 14209           DFHEIV20,
 14210           DFHEIV99,
 14211           ERNOTE-KEY,
 14212           DFHEIV99,
 14213           DFHEIV99,
 14214           DFHEIV99
 14215     SET ADDRESS OF CERTIFICATE-NOTE TO
 14216         DFHEIV20
 14217     MOVE EIBRESP  TO WS-RESPONSE
 14218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14219     IF RESP-NORMAL
 14220        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14221           (N1 > +10)
 14222           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14223           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14224        END-PERFORM
 14225        IF N1 < +11
 14226           MOVE SPACES              TO CN-LINE (N1)
 14227           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14228              N1 <= CN-BILLING-END-LINE-NO
 14229              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 14230              IF CN-BILLING-END-LINE-NO <
 14231                               CN-BILLING-START-LINE-NO
 14232                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14233                                     CN-BILLING-START-LINE-NO
 14234              END-IF
 14235              PERFORM 1820-SQUEEZE-ERNOTE
 14236                                  THRU 1820-EXIT
 14237           END-IF
 14238           IF CN-LINES = SPACES
 14239
 14240* EXEC CICS DELETE
 14241*                DATASET    (FILE-ID-ERNOTE)
 14242*                RESP       (WS-RESPONSE)
 14243*             END-EXEC
 14244*    MOVE '&(                    &  N#00012947' TO DFHEIV0
 14245     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14246     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14247     MOVE X'204E233030303132393437' TO DFHEIV0(25:11)
 14248     CALL 'kxdfhei1' USING DFHEIV0,
 14249           FILE-ID-ERNOTE,
 14250           DFHEIV99,
 14251           DFHEIV99,
 14252           DFHEIV99,
 14253           DFHEIV99
 14254     MOVE EIBRESP  TO WS-RESPONSE
 14255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14256              IF RESP-NORMAL
 14257                 MOVE 'D'        TO WS-NOTE-SW
 14258                 PERFORM 1520-UPDATE-ELCERT
 14259                                 THRU 1520-EXIT
 14260              END-IF
 14261           ELSE
 14262
 14263* EXEC CICS REWRITE
 14264*                DATASET    (FILE-ID-ERNOTE)
 14265*                FROM       (CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 259
* EL6311.cbl
 14266*                RESP       (WS-RESPONSE)
 14267*             END-EXEC
 14268     MOVE LENGTH OF
 14269      CERTIFICATE-NOTE
 14270       TO DFHEIV11
 14271*    MOVE '&& L                  %  N#00012957' TO DFHEIV0
 14272     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14273     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14274     MOVE X'204E233030303132393537' TO DFHEIV0(25:11)
 14275     CALL 'kxdfhei1' USING DFHEIV0,
 14276           FILE-ID-ERNOTE,
 14277           CERTIFICATE-NOTE,
 14278           DFHEIV11,
 14279           DFHEIV99
 14280     MOVE EIBRESP  TO WS-RESPONSE
 14281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14282           END-IF
 14283        END-IF
 14284     END-IF
 14285     .
 14286 1800-EXIT.
 14287     EXIT.
 14288 1820-SQUEEZE-ERNOTE.
 14289     MOVE CN-BILLING-START-LINE-NO TO N2
 14290     IF N2 = 0
 14291         MOVE +1                 TO N2
 14292     END-IF
 14293     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14294        (N1 > +9)
 14295        IF CN-LINE (N1) = SPACES
 14296           MOVE CN-LINE (N1 + +1)
 14297                                 TO CN-LINE (N1)
 14298           MOVE SPACES           TO CN-LINE (N1 + +1)
 14299        END-IF
 14300     END-PERFORM
 14301     .
 14302 1820-EXIT.
 14303     EXIT.
 14304 1900-DELETE-ERPYAJ.
 14305     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14306     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14307     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14308     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14309     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14310     MOVE +10                    TO ERPYAJ-SEQ-NO
 14311     MOVE 'R'                    TO ERPYAJ-TYPE
 14312     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14313
 14314* EXEC CICS STARTBR
 14315*       DATASET    (FILE-ID-ERPYAJ)
 14316*       RIDFLD     (ERPYAJ-KEY)
 14317*       RESP       (WS-RESPONSE)
 14318*    END-EXEC
 14319     MOVE 0
 14320       TO DFHEIV11
 14321*    MOVE '&,         G          &  N#00012993' TO DFHEIV0
 14322     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14323     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 260
* EL6311.cbl
 14324     MOVE X'204E233030303132393933' TO DFHEIV0(25:11)
 14325     CALL 'kxdfhei1' USING DFHEIV0,
 14326           FILE-ID-ERPYAJ,
 14327           ERPYAJ-KEY,
 14328           DFHEIV99,
 14329           DFHEIV11,
 14330           DFHEIV99
 14331     MOVE EIBRESP  TO WS-RESPONSE
 14332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14333     IF RESP-NORMAL
 14334        CONTINUE
 14335     ELSE
 14336        GO TO 1900-GET-DEALER
 14337     END-IF
 14338     .
 14339 1900-READNEXT-ERPYAJ-B.
 14340*  GET THE BANK ERPYAJ RECORD
 14341
 14342* EXEC CICS READNEXT
 14343*       DATASET    (FILE-ID-ERPYAJ)
 14344*       RIDFLD     (ERPYAJ-KEY)
 14345*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14346*       RESP       (WS-RESPONSE)
 14347*    END-EXEC
 14348     MOVE 0
 14349       TO DFHEIV11
 14350*    MOVE '&.S                   )  N#00013006' TO DFHEIV0
 14351     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14352     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14353     MOVE X'204E233030303133303036' TO DFHEIV0(25:11)
 14354     CALL 'kxdfhei1' USING DFHEIV0,
 14355           FILE-ID-ERPYAJ,
 14356           DFHEIV20,
 14357           DFHEIV99,
 14358           ERPYAJ-KEY,
 14359           DFHEIV99,
 14360           DFHEIV11,
 14361           DFHEIV99,
 14362           DFHEIV99
 14363     SET ADDRESS OF PENDING-PAY-ADJ TO
 14364         DFHEIV20
 14365     MOVE EIBRESP  TO WS-RESPONSE
 14366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14367     IF RESP-NORMAL
 14368        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14369           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14370              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14371                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14372
 14373* EXEC CICS READ
 14374*                   DATASET    (FILE-ID-ERPYAJ)
 14375*                   RIDFLD     (ERPYAJ-KEY)
 14376*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14377*                   RESP       (WS-RESPONSE)
 14378*                   UPDATE
 14379*                END-EXEC
 14380*    MOVE '&"S        EU         (  N#00013017' TO DFHEIV0
 14381     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 261
* EL6311.cbl
 14382     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14383     MOVE X'204E233030303133303137' TO DFHEIV0(25:11)
 14384     CALL 'kxdfhei1' USING DFHEIV0,
 14385           FILE-ID-ERPYAJ,
 14386           DFHEIV20,
 14387           DFHEIV99,
 14388           ERPYAJ-KEY,
 14389           DFHEIV99,
 14390           DFHEIV99,
 14391           DFHEIV99
 14392     SET ADDRESS OF PENDING-PAY-ADJ TO
 14393         DFHEIV20
 14394     MOVE EIBRESP  TO WS-RESPONSE
 14395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14396                 IF RESP-NORMAL
 14397
 14398* EXEC CICS DELETE
 14399*                      DATASET   (FILE-ID-ERPYAJ)
 14400*                      RESP      (WS-RESPONSE)
 14401*                   END-EXEC
 14402*    MOVE '&(                    &  N#00013025' TO DFHEIV0
 14403     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14404     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14405     MOVE X'204E233030303133303235' TO DFHEIV0(25:11)
 14406     CALL 'kxdfhei1' USING DFHEIV0,
 14407           FILE-ID-ERPYAJ,
 14408           DFHEIV99,
 14409           DFHEIV99,
 14410           DFHEIV99,
 14411           DFHEIV99
 14412     MOVE EIBRESP  TO WS-RESPONSE
 14413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14414                 END-IF
 14415              ELSE
 14416                 SET REVERSAL    TO TRUE
 14417                 PERFORM 1600-UPDATE-ERPYAJ
 14418                                 THRU 1600-EXIT
 14419                 GO TO 1900-EXIT
 14420              END-IF
 14421           ELSE
 14422              GO TO 1900-READNEXT-ERPYAJ-B
 14423           END-IF
 14424        END-IF
 14425
 14426* EXEC CICS ENDBR
 14427*          DATASET   (FILE-ID-ERPYAJ)
 14428*       END-EXEC
 14429     MOVE 0
 14430       TO DFHEIV11
 14431*    MOVE '&2                    $   #00013040' TO DFHEIV0
 14432     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14433     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14434     MOVE X'2020233030303133303430' TO DFHEIV0(25:11)
 14435     CALL 'kxdfhei1' USING DFHEIV0,
 14436           FILE-ID-ERPYAJ,
 14437           DFHEIV11,
 14438           DFHEIV99
 14439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 262
* EL6311.cbl
 14440     END-IF
 14441     .
 14442 1900-GET-DEALER.
 14443     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14444     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14445     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14446     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14447     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14448     MOVE +10                    TO ERPYAJ-SEQ-NO
 14449     MOVE 'C'                    TO ERPYAJ-TYPE
 14450     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14451
 14452* EXEC CICS STARTBR
 14453*       DATASET    (FILE-ID-ERPYAJ)
 14454*       RIDFLD     (ERPYAJ-KEY)
 14455*       RESP       (WS-RESPONSE)
 14456*    END-EXEC
 14457     MOVE 0
 14458       TO DFHEIV11
 14459*    MOVE '&,         G          &  N#00013054' TO DFHEIV0
 14460     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14461     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14462     MOVE X'204E233030303133303534' TO DFHEIV0(25:11)
 14463     CALL 'kxdfhei1' USING DFHEIV0,
 14464           FILE-ID-ERPYAJ,
 14465           ERPYAJ-KEY,
 14466           DFHEIV99,
 14467           DFHEIV11,
 14468           DFHEIV99
 14469     MOVE EIBRESP  TO WS-RESPONSE
 14470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14471     IF RESP-NORMAL
 14472        CONTINUE
 14473     ELSE
 14474        GO TO 1900-EXIT
 14475     END-IF
 14476     .
 14477 1900-READNEXT-ERPYAJ-D.
 14478*  GET THE DEALER ERPYAJ RECORD
 14479
 14480* EXEC CICS READNEXT
 14481*       DATASET    (FILE-ID-ERPYAJ)
 14482*       RIDFLD     (ERPYAJ-KEY)
 14483*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14484*       RESP       (WS-RESPONSE)
 14485*    END-EXEC
 14486     MOVE 0
 14487       TO DFHEIV11
 14488*    MOVE '&.S                   )  N#00013067' TO DFHEIV0
 14489     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14490     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14491     MOVE X'204E233030303133303637' TO DFHEIV0(25:11)
 14492     CALL 'kxdfhei1' USING DFHEIV0,
 14493           FILE-ID-ERPYAJ,
 14494           DFHEIV20,
 14495           DFHEIV99,
 14496           ERPYAJ-KEY,
 14497           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 263
* EL6311.cbl
 14498           DFHEIV11,
 14499           DFHEIV99,
 14500           DFHEIV99
 14501     SET ADDRESS OF PENDING-PAY-ADJ TO
 14502         DFHEIV20
 14503     MOVE EIBRESP  TO WS-RESPONSE
 14504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14505     IF RESP-NORMAL
 14506        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14507           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14508              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14509                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14510
 14511* EXEC CICS READ
 14512*                   DATASET    (FILE-ID-ERPYAJ)
 14513*                   RIDFLD     (ERPYAJ-KEY)
 14514*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14515*                   RESP       (WS-RESPONSE)
 14516*                   UPDATE
 14517*                END-EXEC
 14518*    MOVE '&"S        EU         (  N#00013078' TO DFHEIV0
 14519     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14520     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14521     MOVE X'204E233030303133303738' TO DFHEIV0(25:11)
 14522     CALL 'kxdfhei1' USING DFHEIV0,
 14523           FILE-ID-ERPYAJ,
 14524           DFHEIV20,
 14525           DFHEIV99,
 14526           ERPYAJ-KEY,
 14527           DFHEIV99,
 14528           DFHEIV99,
 14529           DFHEIV99
 14530     SET ADDRESS OF PENDING-PAY-ADJ TO
 14531         DFHEIV20
 14532     MOVE EIBRESP  TO WS-RESPONSE
 14533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14534                 IF RESP-NORMAL
 14535
 14536* EXEC CICS DELETE
 14537*                      DATASET   (FILE-ID-ERPYAJ)
 14538*                      RESP      (WS-RESPONSE)
 14539*                   END-EXEC
 14540*    MOVE '&(                    &  N#00013086' TO DFHEIV0
 14541     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14542     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14543     MOVE X'204E233030303133303836' TO DFHEIV0(25:11)
 14544     CALL 'kxdfhei1' USING DFHEIV0,
 14545           FILE-ID-ERPYAJ,
 14546           DFHEIV99,
 14547           DFHEIV99,
 14548           DFHEIV99,
 14549           DFHEIV99
 14550     MOVE EIBRESP  TO WS-RESPONSE
 14551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14552                 END-IF
 14553              ELSE
 14554                 SET REVERSAL    TO TRUE
 14555              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 264
* EL6311.cbl
 14556           ELSE
 14557              GO TO 1900-READNEXT-ERPYAJ-D
 14558           END-IF
 14559        END-IF
 14560
 14561* EXEC CICS ENDBR
 14562*          DATASET   (FILE-ID-ERPYAJ)
 14563*       END-EXEC
 14564     MOVE 0
 14565       TO DFHEIV11
 14566*    MOVE '&2                    $   #00013098' TO DFHEIV0
 14567     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14568     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14569     MOVE X'2020233030303133303938' TO DFHEIV0(25:11)
 14570     CALL 'kxdfhei1' USING DFHEIV0,
 14571           FILE-ID-ERPYAJ,
 14572           DFHEIV11,
 14573           DFHEIV99
 14574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14575     END-IF
 14576     .
 14577 1900-EXIT.
 14578     EXIT.
 14579******************************************************************
 14580*            C A N C E L   M A I N L I N E                       *
 14581******************************************************************
 14582
 14583 2000-CANCEL-MAINLINE.
 14584     IF PI-DISPLAY-ORIGINAL-BATCH
 14585        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14586           MOVE ER-0023             TO EMI-ERROR
 14587           MOVE -1                  TO CMAINTL
 14588           MOVE AL-UABON            TO CMAINTA
 14589           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14590           GO TO 8200-SEND-DATAONLY
 14591        ELSE
 14592           NEXT SENTENCE
 14593     ELSE
 14594        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14595           MOVE ER-0023             TO EMI-ERROR
 14596           MOVE -1                  TO CMAINTL
 14597           MOVE AL-UABON            TO CMAINTA
 14598           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14599           GO TO 8200-SEND-DATAONLY.
 14600
 14601     IF CMAINTI = 'S'
 14602        GO TO 2100-SHOW-REQUEST.
 14603
 14604     IF NOT MODIFY-CAP
 14605         MOVE 'UPDATE'       TO SM-READ
 14606         PERFORM 9995-SECURITY-VIOLATION
 14607         MOVE ER-0070        TO EMI-ERROR
 14608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14609         GO TO 8100-SEND-INITIAL-MAP.
 14610
 14611     IF CMAINTL GREATER THAN ZEROS
 14612        IF PI-PF6-FUNCTION
 14613           IF CMAINTI NOT = 'A'
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 265
* EL6311.cbl
 14614              MOVE AL-UABON  TO CMAINTA
 14615              MOVE -1        TO CMAINTL
 14616              MOVE ER-2260   TO EMI-ERROR
 14617              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14618              GO TO 8200-SEND-DATAONLY.
 14619
 14620     IF CCERTNOL = ZEROS
 14621       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14622         NEXT SENTENCE
 14623     ELSE
 14624         IF CCERTNOL NOT = ZEROS
 14625             MOVE AL-UANON       TO CCERTNOA
 14626         ELSE
 14627             MOVE -1             TO CCERTNOL
 14628             MOVE  1             TO SET-CURSOR-SW
 14629             MOVE ER-2218       TO EMI-ERROR
 14630             MOVE AL-UABON       TO CCERTNOA
 14631             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14632
 14633     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14634        NEXT SENTENCE
 14635     ELSE
 14636        IF CEFFDTL NOT = ZEROS
 14637           MOVE AL-UNNON         TO CEFFDTA
 14638           MOVE CEFFDTI TO DEEDIT-FIELD
 14639           PERFORM 8600-DEEDIT
 14640           MOVE 4                TO DC-OPTION-CODE
 14641           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14642           PERFORM 9700-DATE-LINK
 14643           IF NO-CONVERSION-ERROR
 14644              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14645              ELSE
 14646              MOVE -1            TO CEFFDTL
 14647              MOVE  1            TO SET-CURSOR-SW
 14648              MOVE ER-2226      TO EMI-ERROR
 14649              MOVE AL-UNBON      TO CEFFDTA
 14650              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14651          ELSE
 14652          MOVE -1                 TO CEFFDTL
 14653          MOVE  1                 TO SET-CURSOR-SW
 14654          MOVE ER-2220            TO EMI-ERROR
 14655          MOVE AL-UNBON           TO CEFFDTA
 14656          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14657
 14658     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14659
 14660     IF CCERTNOL NOT = ZEROS
 14661        MOVE CCERTNOI                TO WS-NEW-PRIME
 14662     ELSE
 14663        MOVE SPACES                  TO WS-NEW-PRIME.
 14664
 14665     IF CSUFIXL NOT = ZEROS
 14666        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14667     ELSE
 14668        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14669
 14670     IF CEFFDTL NOT = ZEROS
 14671        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 266
* EL6311.cbl
 14672     ELSE
 14673        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14674
 14675     IF CMAINTI = 'A' OR 'K' OR 'S'
 14676        NEXT SENTENCE
 14677     ELSE
 14678        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14679        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14680           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14681           WS-PB-RECORD-TYPE NOT = '2'
 14682           IF CMAINTI = 'C'
 14683              MOVE ER-2287          TO EMI-ERROR
 14684              MOVE -1               TO CCERTNOL
 14685              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14686              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14687              GO TO 8200-SEND-DATAONLY
 14688             ELSE
 14689              MOVE ER-2260          TO EMI-ERROR
 14690              MOVE -1               TO CCERTNOL
 14691              MOVE AL-UABON         TO CCERTNOA
 14692              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14693              GO TO 8200-SEND-DATAONLY.
 14694
 14695     IF CMAINTI = 'D'
 14696        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14697
 14698     IF CLSTNML GREATER THAN ZEROS
 14699         MOVE AL-UANON           TO CLSTNMA.
 14700
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 267
* EL6311.cbl
 14702
 14703******************************************************************
 14704*                                                                *
 14705*           E D I T   C A N C E L   C O V E R A G E S            *
 14706*                                                                *
 14707******************************************************************
 14708
 14709 2015-EDIT-COVERAGES.
 14710     IF CCANDT1L      GREATER THAN ZEROS OR
 14711        CREFND1L      GREATER THAN ZEROS OR
 14712        CCANDT2L      GREATER THAN ZEROS OR
 14713        CREFND2L      GREATER THAN ZEROS OR
 14714        CMTHD1L       GREATER THAN ZEROS OR
 14715        CMTHD2L       GREATER THAN ZEROS OR
 14716        CLIVESL       GREATER THAN ZEROS OR
 14717        CPAYEEL       GREATER THAN ZEROS OR
 14718        CFORCEL       GREATER THAN ZEROS OR
 14719        CBILCDL       GREATER THAN ZEROS OR
 14720        CCANREAL      GREATER THAN ZEROS
 14721            NEXT SENTENCE
 14722         ELSE
 14723            GO TO 2030-EDIT-COMPLETE.
 14724
 14725     IF CCANDT1L = ZEROS
 14726        AND (CMAINTI = 'C' OR 'K')
 14727        NEXT SENTENCE
 14728     ELSE
 14729        IF CCANDT1L      GREATER THAN ZEROS
 14730            MOVE AL-UNNON            TO CCANDT1A
 14731            IF CCANDT1I = SPACES
 14732               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14733            ELSE
 14734               MOVE CCANDT1I            TO DEEDIT-FIELD
 14735               PERFORM 8600-DEEDIT
 14736               IF DEEDIT-FIELD-V0   NUMERIC
 14737                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14738                  MOVE 4                TO DC-OPTION-CODE
 14739                  PERFORM 9700-DATE-LINK
 14740                  IF NO-CONVERSION-ERROR
 14741                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14742                  ELSE
 14743                      MOVE -1        TO CCANDT1L
 14744                      MOVE ER-2227   TO EMI-ERROR
 14745                      MOVE AL-UNBON  TO CCANDT1A
 14746                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14747               ELSE
 14748                  MOVE -1         TO CCANDT1L
 14749                  MOVE ER-2223    TO EMI-ERROR
 14750                  MOVE AL-UNBON   TO CCANDT1A
 14751                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14752        ELSE
 14753            IF CREFND1L GREATER THAN ZEROS
 14754               MOVE -1             TO CCANDT1L
 14755               MOVE ER-2222        TO EMI-ERROR
 14756               MOVE AL-UNBOF       TO CCANDT1A
 14757               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14758
 14759     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 268
* EL6311.cbl
 14760        AND (CMAINTI = 'C' OR 'K')
 14761         NEXT SENTENCE
 14762     ELSE
 14763         IF CREFND1L NOT = ZEROS
 14764            MOVE AL-UNNON        TO CREFND1A
 14765
 14766* EXEC CICS BIF DEEDIT
 14767*               FIELD  (CREFND1I)
 14768*               LENGTH (11)
 14769*           END-EXEC
 14770     MOVE 11
 14771       TO DFHEIV11
 14772*    MOVE '@"L                   #   #00013291' TO DFHEIV0
 14773     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14774     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14775     MOVE X'2020233030303133323931' TO DFHEIV0(25:11)
 14776     CALL 'kxdfhei1' USING DFHEIV0,
 14777           CREFND1I,
 14778           DFHEIV11
 14779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14780            MOVE CREFND1I        TO WS-CREFND1
 14781*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14782*           PERFORM 8600-DEEDIT
 14783*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14784            IF WS-CREFND1  = ZEROS
 14785               AND CMAINTI = 'A'
 14786             MOVE ER-2437        TO EMI-ERROR
 14787             MOVE -1             TO CREFND1L
 14788             MOVE AL-UNBON       TO CREFND1A
 14789             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14790
 14791     IF CCANREAL > +0
 14792        MOVE AL-UANON            TO CCANREAA
 14793        IF CCANREAI = 'R' OR ' '
 14794           CONTINUE
 14795        ELSE
 14796           MOVE ER-9841        TO EMI-ERROR
 14797           MOVE -1             TO CCANREAL
 14798           MOVE AL-UABON       TO CCANREAA
 14799           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14800        END-IF
 14801     END-IF
 14802     IF CMTHD1L EQUAL +0
 14803        NEXT SENTENCE
 14804     ELSE
 14805        IF CMTHD1L NOT = +0
 14806           MOVE AL-UNNON        TO CMTHD1A
 14807           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14808                         OR '5' OR '6' OR '8' OR '9'
 14809                         OR 'R' OR ' '
 14810              NEXT SENTENCE
 14811           ELSE
 14812              MOVE ER-0582        TO EMI-ERROR
 14813              MOVE -1             TO CMTHD1L
 14814              MOVE AL-UNBON       TO CMTHD1A
 14815              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14816
 14817     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 269
* EL6311.cbl
 14818        AND (CMAINTI = 'C' OR 'K')
 14819         NEXT SENTENCE
 14820     ELSE
 14821         IF CCANDT2L  GREATER THAN ZEROS
 14822             MOVE AL-UNNON       TO CCANDT2A
 14823             IF CCANDT2I = SPACES
 14824                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14825             ELSE
 14826                MOVE CCANDT2I       TO DEEDIT-FIELD
 14827                PERFORM 8600-DEEDIT
 14828                IF DEEDIT-FIELD-V0   NUMERIC
 14829                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14830                   MOVE 4                TO DC-OPTION-CODE
 14831                   PERFORM 9700-DATE-LINK
 14832                   IF NO-CONVERSION-ERROR
 14833                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14834                   ELSE
 14835                      MOVE -1       TO CCANDT2L
 14836                      MOVE ER-2227  TO EMI-ERROR
 14837                      MOVE AL-UNBON TO CCANDT2A
 14838                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14839                ELSE
 14840                   MOVE -1         TO CCANDT2L
 14841                   MOVE ER-2223    TO EMI-ERROR
 14842                   MOVE AL-UNBON   TO CCANDT2A
 14843                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14844         ELSE
 14845            IF CREFND2L GREATER THAN ZEROS
 14846               MOVE -1             TO CCANDT2L
 14847               MOVE ER-2222        TO EMI-ERROR
 14848               MOVE AL-UNBOF       TO CCANDT2A
 14849               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14850
 14851     IF CREFND2L = ZEROS
 14852        AND (CMAINTI = 'C' OR 'K')
 14853         NEXT SENTENCE
 14854     ELSE
 14855         IF CREFND2L NOT = ZEROS
 14856            MOVE AL-UNNON        TO CREFND2A
 14857
 14858* EXEC CICS BIF DEEDIT
 14859*               FIELD  (CREFND2I)
 14860*               LENGTH (11)
 14861*           END-EXEC
 14862     MOVE 11
 14863       TO DFHEIV11
 14864*    MOVE '@"L                   #   #00013372' TO DFHEIV0
 14865     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14866     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14867     MOVE X'2020233030303133333732' TO DFHEIV0(25:11)
 14868     CALL 'kxdfhei1' USING DFHEIV0,
 14869           CREFND2I,
 14870           DFHEIV11
 14871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14872            MOVE CREFND2I        TO WS-CREFND2
 14873*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14874*           PERFORM 8600-DEEDIT
 14875*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 270
* EL6311.cbl
 14876            IF WS-CREFND2  = ZEROS
 14877               AND CMAINTI = 'A'
 14878             MOVE ER-2437        TO EMI-ERROR
 14879             MOVE -1             TO CREFND2L
 14880             MOVE AL-UNBON       TO CREFND2A
 14881             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14882
 14883     IF CMTHD2L EQUAL +0
 14884        NEXT SENTENCE
 14885     ELSE
 14886        IF CMTHD2L NOT = +0
 14887           MOVE AL-UNNON        TO CMTHD2A
 14888           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14889                         OR '5' OR '6' OR '8' OR '9'
 14890                         OR ' ' OR 'R'
 14891              NEXT SENTENCE
 14892           ELSE
 14893              MOVE ER-0582        TO EMI-ERROR
 14894              MOVE -1             TO CMTHD2L
 14895              MOVE AL-UNBON       TO CMTHD2A
 14896              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14897
 14898     IF CLIVESL GREATER THAN ZEROS
 14899         MOVE CLIVESI            TO DEEDIT-FIELD
 14900         PERFORM 8600-DEEDIT
 14901         IF DEEDIT-FIELD-V0 NUMERIC
 14902             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14903             MOVE AL-UNNON       TO CLIVESA
 14904         ELSE
 14905             MOVE -1             TO CLIVESL
 14906             MOVE AL-UNBON       TO CLIVESA
 14907             MOVE ER-2223        TO EMI-ERROR
 14908             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14909
 14910     IF CFORCEL  NOT = ZEROS
 14911         IF FORCE-CAP
 14912            MOVE AL-UANON            TO CFORCEA
 14913         ELSE
 14914            MOVE ER-2945             TO EMI-ERROR
 14915            MOVE AL-UABON            TO CFORCEA
 14916            MOVE -1                  TO CFORCEL
 14917            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14918
 14919     IF CPAYEEL GREATER THAN ZEROS
 14920        MOVE AL-UANON            TO CPAYEEA.
 14921
 14922     IF CBILCDL NOT = ZEROS
 14923        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14924                             AND 'A' AND 'B' AND 'E'
 14925           MOVE ER-2225              TO EMI-ERROR
 14926           MOVE AL-UABON             TO CBILCDA
 14927           MOVE -1                   TO CBILCDL
 14928           MOVE  1                   TO SET-CURSOR-SW
 14929           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14930        ELSE
 14931           MOVE AL-UANON             TO CBILCDA.
 14932
 14933 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 271
* EL6311.cbl
 14934     IF EMI-ERROR = ZEROS
 14935         NEXT SENTENCE
 14936     ELSE
 14937         GO TO 8200-SEND-DATAONLY.
 14938
 14939     IF CMAINTI = 'A'
 14940        GO TO 2200-ADD-CANCEL-ROUTINE.
 14941
 14942     IF CMAINTI = 'C'
 14943        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14944
 14945     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14946
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 272
* EL6311.cbl
 14948
 14949******************************************************************
 14950*                                                                *
 14951*                   S H O W   C A N C E L                        *
 14952*                                                                *
 14953******************************************************************
 14954
 14955 2100-SHOW-REQUEST.
 14956     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14957
 14958     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14959        MOVE -1                  TO CMAINTL
 14960        GO TO 8200-SEND-DATAONLY.
 14961
 14962     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14963
 14964     IF CSUFIXL NOT = ZEROS
 14965        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14966       ELSE
 14967        MOVE SPACE            TO WS-NEW-SUFFIX.
 14968
 14969     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14970     PERFORM 8600-DEEDIT.
 14971     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14972     MOVE '4'                    TO DC-OPTION-CODE.
 14973     PERFORM 9700-DATE-LINK.
 14974     IF DATE-CONVERSION-ERROR
 14975        MOVE ER-0348             TO EMI-ERROR
 14976        MOVE -1                  TO CEFFDTL
 14977        MOVE AL-UABON            TO CEFFDTA
 14978        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14979        GO TO 8200-SEND-DATAONLY
 14980     ELSE
 14981        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14982        MOVE AL-UANON            TO CEFFDTA
 14983        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14984
 14985     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14986
 14987     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14988        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14989        MOVE 'Y'                    TO WS-SHOW-SW
 14990        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14991           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14992        ELSE
 14993           IF PI-FILE-BROWSE
 14994              GO TO 4300-BROWSE-FILE-FORWARD
 14995           ELSE
 14996              IF PI-CSR-BROWSE
 14997                 GO TO 4200-BROWSE-CSR-FORWARD
 14998              ELSE
 14999                 GO TO 4000-BROWSE-DETAIL-FORWARD
 15000     ELSE
 15001        GO TO 3900-RE-DISPLAY-RECORD.
 15002
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 273
* EL6311.cbl
 15004
 15005
 15006******************************************************************
 15007*                                                                *
 15008*            A D D   C A N C E L   R O U T I N E                 *
 15009*                                                                *
 15010******************************************************************
 15011
 15012 2200-ADD-CANCEL-ROUTINE.
 15013     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 15014
 15015
 15016* EXEC CICS GETMAIN
 15017*        SET     (ADDRESS OF PENDING-BUSINESS)
 15018*        LENGTH  (ERPNDB-RECORD-LENGTH)
 15019*    END-EXEC.
 15020*    MOVE '," L                  $   #00013519' TO DFHEIV0
 15021     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 15022     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15023     MOVE X'2020233030303133353139' TO DFHEIV0(25:11)
 15024     CALL 'kxdfhei1' USING DFHEIV0,
 15025           DFHEIV20,
 15026           ERPNDB-RECORD-LENGTH,
 15027           DFHEIV99
 15028     SET ADDRESS OF PENDING-BUSINESS TO
 15029         DFHEIV20
 15030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15031
 15032
 15033
 15034* EXEC CICS HANDLE CONDITION
 15035*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 15036*    END-EXEC.
 15037*    MOVE '"$I                   ! 3 #00013524' TO DFHEIV0
 15038     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15040     MOVE X'3320233030303133353234' TO DFHEIV0(25:11)
 15041     CALL 'kxdfhei1' USING DFHEIV0
 15042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15043
 15044
 15045     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 15046     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15047     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15048
 15049
 15050* EXEC CICS READ
 15051*        INTO    (PENDING-BUSINESS)
 15052*        DATASET (FILE-ID-ERPNDB)
 15053*        RIDFLD  (ERPNDB-KEY)
 15054*    END-EXEC.
 15055     MOVE LENGTH OF
 15056      PENDING-BUSINESS
 15057       TO DFHEIV11
 15058*    MOVE '&"IL       E          (   #00013532' TO DFHEIV0
 15059     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15061     MOVE X'2020233030303133353332' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 274
* EL6311.cbl
 15062     CALL 'kxdfhei1' USING DFHEIV0,
 15063           FILE-ID-ERPNDB,
 15064           PENDING-BUSINESS,
 15065           DFHEIV11,
 15066           ERPNDB-KEY,
 15067           DFHEIV99,
 15068           DFHEIV99,
 15069           DFHEIV99
 15070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15071
 15072
 15073     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 15074
 15075     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15076     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 15077     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 15078     MOVE SPACES                 TO PENDING-BUSINESS.
 15079     MOVE 'PB'                   TO PB-RECORD-ID.
 15080     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 15081     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 15082     MOVE SPACES                 TO PB-CERT-SFX.
 15083     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 15084     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15085                                    PB-ALT-CHG-SEQ-NO.
 15086
 15087     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 15088     MOVE CCERTNOI               TO PB-CERT-PRIME.
 15089     MOVE '2'                    TO PB-RECORD-TYPE.
 15090
 15091     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 15092     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 15093
 15094
 15095     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15096                                    PB-ALT-CHG-SEQ-NO
 15097                                    PB-C-LF-REF-CALC
 15098                                    PB-C-AH-REF-CALC
 15099                                    PB-C-LF-RFND-CLP
 15100                                    PB-C-AH-RFND-CLP
 15101                                    PB-CI-INSURED-AGE
 15102                                    PB-CI-LF-TERM
 15103                                    PB-CI-AH-TERM
 15104                                    PB-CI-LF-BENEFIT-CD
 15105                                    PB-CI-LF-BENEFIT-AMT
 15106                                    PB-CI-LF-ALT-BENEFIT-AMT
 15107                                    PB-CI-LF-PREMIUM-AMT
 15108                                    PB-CI-LF-ALT-PREMIUM-AMT
 15109                                    PB-CI-AH-BENEFIT-CD
 15110                                    PB-CI-AH-BENEFIT-AMT
 15111                                    PB-CI-AH-PREMIUM-AMT
 15112                                    PB-CI-PAY-FREQUENCY
 15113                                    PB-CI-LOAN-APR
 15114                                    PB-CI-LOAN-TERM
 15115                                    PB-CI-LIFE-COMMISSION
 15116                                    PB-CI-AH-COMMISSION
 15117                                    PB-CI-CURR-SEQ
 15118                                    PB-CI-AH-CANCEL-AMT
 15119                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 275
* EL6311.cbl
 15120                                    PB-CI-RATE-DEV-PCT-LF
 15121                                    PB-CI-RATE-DEV-PCT-AH
 15122                                    PB-CI-EXTENTION-DAYS
 15123                                    PB-CI-TERM-IN-DAYS
 15124                                    PB-CI-LIVES
 15125                                    PB-CI-LF-CRIT-PER
 15126                                    PB-CI-AH-CRIT-PER
 15127                                    PB-C-LF-REM-TERM
 15128                                    PB-C-AH-REM-TERM
 15129                                    PB-CHG-COUNT
 15130                                    PB-LF-BILLED-AMTS
 15131                                    PB-AH-BILLED-AMTS
 15132                                    PB-C-INT-ON-REFS
 15133*                                   PB-C-MICROFILM-NO
 15134                                    PB-CALC-TOLERANCE.
 15135
 15136     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 15137                                    PB-CI-AH-SETTLEMENT-DT
 15138                                    PB-CI-DEATH-DT
 15139                                    PB-CI-LF-PRIOR-CANCEL-DT
 15140                                    PB-CI-AH-PRIOR-CANCEL-DT
 15141                                    PB-CI-ENTRY-DT
 15142                                    PB-CI-LF-EXPIRE-DT
 15143                                    PB-CI-AH-EXPIRE-DT
 15144                                    PB-CI-LOAN-1ST-PMT-DT
 15145                                    PB-C-LF-CANCEL-DT
 15146                                    PB-C-AH-CANCEL-DT
 15147                                    PB-CREDIT-ACCEPT-DT
 15148                                    PB-BILLED-DT
 15149                                    PB-ACCT-EFF-DT
 15150                                    PB-ACCT-EXP-DT.
 15151
 15152     MOVE 'X'                    TO PB-FATAL-FLAG.
 15153
 15154     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 15155
 15156     IF CSUFIXL     GREATER THAN ZEROS
 15157        MOVE CSUFIXI             TO PB-CERT-SFX.
 15158
 15159*    IF CMICRNOL  GREATER  ZEROS
 15160*        IF CMICRNOI  NUMERIC
 15161*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15162*            MOVE AL-UNNON       TO  CMICRNOA
 15163*        ELSE
 15164*            MOVE -1             TO  CMICRNOL
 15165*            MOVE AL-UNBON       TO  CMICRNOA
 15166*            MOVE ER-2701        TO  EMI-ERROR
 15167*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15168
 15169     IF CLSTNML     GREATER THAN ZEROS
 15170        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15171
 15172     IF CCANREAL > ZEROS
 15173        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15174     END-IF
 15175     IF CCANDT1L    GREATER THAN ZEROS
 15176        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15177
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 276
* EL6311.cbl
 15178     IF CCANDT2L    GREATER THAN ZEROS
 15179        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15180
 15181     IF CMTHD1L    GREATER THAN +0
 15182        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15183
 15184     IF CMTHD2L    GREATER THAN +0
 15185        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15186
 15187     IF CREFND1L    GREATER THAN ZEROS
 15188        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15189        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15190     ELSE
 15191        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15192
 15193     IF CREFND2L    GREATER THAN ZEROS
 15194        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15195        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15196     ELSE
 15197        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15198
 15199     IF CLIVESL     GREATER THAN ZEROS
 15200        MOVE WS-CLIVES           TO PB-C-LIVES
 15201     ELSE
 15202        MOVE ZEROS               TO PB-C-LIVES.
 15203
 15204     IF CPAYEEL     GREATER THAN ZEROS
 15205        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15206
 15207     IF CFORCEL     GREATER THAN ZEROS
 15208        MOVE CFORCEI             TO PB-FORCE-CODE.
 15209
 15210     IF CBILCDL     GREATER THAN ZEROS
 15211        MOVE CBILCDI             TO PB-RECORD-BILL.
 15212
 15213*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15214
 15215 2260-WRITE-PB-RECORD.
 15216     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15217                                    PB-INPUT-BY.
 15218     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15219     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15220                                    PB-INPUT-DT.
 15221
 15222     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15223     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15224                                    PB-CONTROL-BY-ORIG-BATCH.
 15225
 15226     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15227     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15228     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15229     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15230     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15231
 15232     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15233
 15234     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15235
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 277
* EL6311.cbl
 15236     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15237     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15238     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15239
 15240     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15241     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15242
 15243 2275-WRITE-PENDING-BUSINESS.
 15244     MOVE 'A'                    TO JP-RECORD-TYPE.
 15245     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15246     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15247     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15248
 15249
 15250* EXEC CICS HANDLE CONDITION
 15251*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15252*    END-EXEC.
 15253*    MOVE '"$%                   ! 4 #00013714' TO DFHEIV0
 15254     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15255     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15256     MOVE X'3420233030303133373134' TO DFHEIV0(25:11)
 15257     CALL 'kxdfhei1' USING DFHEIV0
 15258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15259
 15260
 15261
 15262* EXEC CICS WRITE
 15263*        DATASET (FILE-ID-ERPNDB)
 15264*        FROM    (PENDING-BUSINESS)
 15265*        RIDFLD  (PB-CONTROL-PRIMARY)
 15266*    END-EXEC.
 15267     MOVE LENGTH OF
 15268      PENDING-BUSINESS
 15269       TO DFHEIV11
 15270*    MOVE '&$ L                  ''   #00013718' TO DFHEIV0
 15271     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15272     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15273     MOVE X'2020233030303133373138' TO DFHEIV0(25:11)
 15274     CALL 'kxdfhei1' USING DFHEIV0,
 15275           FILE-ID-ERPNDB,
 15276           PENDING-BUSINESS,
 15277           DFHEIV11,
 15278           PB-CONTROL-PRIMARY,
 15279           DFHEIV99,
 15280           DFHEIV99
 15281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15282
 15283
 15284     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15285
 15286     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 15287
 15288******************************************************************
 15289*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15290******************************************************************
 15291
 15292     display ' made it to add orig CANCEL cert '
 15293     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 278
* EL6311.cbl
 15294     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15295     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15296     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15297
 15298
 15299* EXEC CICS READ
 15300*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15301*        DATASET (FILE-ID-ELCERT)
 15302*        RIDFLD  (ELCERT-KEY)
 15303*        RESP    (WS-RESPONSE)
 15304*    END-EXEC.
 15305*    MOVE '&"S        E          (  N#00013738' TO DFHEIV0
 15306     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15307     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15308     MOVE X'204E233030303133373338' TO DFHEIV0(25:11)
 15309     CALL 'kxdfhei1' USING DFHEIV0,
 15310           FILE-ID-ELCERT,
 15311           DFHEIV20,
 15312           DFHEIV99,
 15313           ELCERT-KEY,
 15314           DFHEIV99,
 15315           DFHEIV99,
 15316           DFHEIV99
 15317     SET ADDRESS OF CERTIFICATE-MASTER TO
 15318         DFHEIV20
 15319     MOVE EIBRESP  TO WS-RESPONSE
 15320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15321
 15322
 15323     IF NOT RESP-NORMAL
 15324        GO TO 2276-BYPASS-CRTO
 15325     END-IF
 15326
 15327     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15328     MOVE ' '                    TO WS-ERMAIL-SW
 15329
 15330
 15331* EXEC CICS READ
 15332*       DATASET   (FILE-ID-ERMAIL)
 15333*       SET       (ADDRESS OF MAILING-DATA)
 15334*       RIDFLD    (ERMAIL-KEY)
 15335*       RESP      (WS-RESPONSE)
 15336*    END-EXEC
 15337*    MOVE '&"S        E          (  N#00013752' TO DFHEIV0
 15338     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15339     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15340     MOVE X'204E233030303133373532' TO DFHEIV0(25:11)
 15341     CALL 'kxdfhei1' USING DFHEIV0,
 15342           FILE-ID-ERMAIL,
 15343           DFHEIV20,
 15344           DFHEIV99,
 15345           ERMAIL-KEY,
 15346           DFHEIV99,
 15347           DFHEIV99,
 15348           DFHEIV99
 15349     SET ADDRESS OF MAILING-DATA TO
 15350         DFHEIV20
 15351     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 279
* EL6311.cbl
 15352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15353
 15354     IF RESP-NORMAL
 15355        SET ERMAIL-FOUND TO TRUE
 15356     END-IF
 15357
 15358     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15359
 15360     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15361     MOVE 'OC'                   TO OC-RECORD-ID
 15362     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15363                                 TO OC-CONTROL-PRIMARY (1:33)
 15364     MOVE 'I'                    TO OC-RECORD-TYPE
 15365     MOVE +4096                  TO OC-KEY-SEQ-NO
 15366     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15367     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15368     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15369
 15370     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15371     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15372     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15373     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15374     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15375     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15376     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15377     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15378     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15379     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15380     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15381     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15382     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15383     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15384     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15385     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15386     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15387     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15388     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15389     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15390     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15391     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15392     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15393     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15394     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15395     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15396     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15397     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15398     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15399     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15400     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15401     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15402
 15403     IF ERMAIL-FOUND
 15404        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15405     END-IF
 15406     IF NOT CERT-TRL-REC-NOT-FOUND
 15407        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15408                           OC-INS-AGE-DEFAULT-FLAG
 15409        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 280
* EL6311.cbl
 15410                           OC-JNT-AGE-DEFAULT-FLAG
 15411     END-IF
 15412     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15413     .
 15414 2275-WRITE-ELCRTO.
 15415
 15416
 15417* EXEC CICS WRITE
 15418*       DATASET   ('ELCRTO')
 15419*       FROM      (ORIGINAL-CERTIFICATE)
 15420*       RIDFLD    (OC-CONTROL-PRIMARY)
 15421*       RESP      (WS-RESPONSE)
 15422*    END-EXEC
 15423     MOVE LENGTH OF
 15424      ORIGINAL-CERTIFICATE
 15425       TO DFHEIV11
 15426     MOVE 'ELCRTO' TO DFHEIV1
 15427*    MOVE '&$ L                  ''  N#00013821' TO DFHEIV0
 15428     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15429     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15430     MOVE X'204E233030303133383231' TO DFHEIV0(25:11)
 15431     CALL 'kxdfhei1' USING DFHEIV0,
 15432           DFHEIV1,
 15433           ORIGINAL-CERTIFICATE,
 15434           DFHEIV11,
 15435           OC-CONTROL-PRIMARY,
 15436           DFHEIV99,
 15437           DFHEIV99
 15438     MOVE EIBRESP  TO WS-RESPONSE
 15439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15440
 15441     display ' just wrote 2275 ' ws-response
 15442     IF RESP-DUPKEY
 15443        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15444        GO TO 2275-WRITE-ELCRTO
 15445     ELSE
 15446        IF NOT RESP-NORMAL
 15447           MOVE -1               TO BMAINTL
 15448           MOVE ER-7450          TO EMI-ERROR
 15449           PERFORM 9900-ERROR-FORMAT
 15450                                 THRU 9900-EXIT
 15451           GO TO 8200-SEND-DATAONLY
 15452        END-IF
 15453     END-IF.
 15454
 15455 2276-BYPASS-CRTO.
 15456******************************************************************
 15457*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15458******************************************************************
 15459
 15460
 15461* EXEC CICS READ
 15462*        INTO    (PENDING-BUSINESS)
 15463*        DATASET (FILE-ID-ERPNDB)
 15464*        RIDFLD  (ERPNDB-KEY)
 15465*        UPDATE
 15466*    END-EXEC.
 15467     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 281
* EL6311.cbl
 15468      PENDING-BUSINESS
 15469       TO DFHEIV11
 15470*    MOVE '&"IL       EU         (   #00013847' TO DFHEIV0
 15471     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15472     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15473     MOVE X'2020233030303133383437' TO DFHEIV0(25:11)
 15474     CALL 'kxdfhei1' USING DFHEIV0,
 15475           FILE-ID-ERPNDB,
 15476           PENDING-BUSINESS,
 15477           DFHEIV11,
 15478           ERPNDB-KEY,
 15479           DFHEIV99,
 15480           DFHEIV99,
 15481           DFHEIV99
 15482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15483
 15484
 15485     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15486     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15487     MOVE 'B'                    TO JP-RECORD-TYPE.
 15488     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15489
 15490     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 15491
 15492     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15493
 15494
 15495* EXEC CICS REWRITE
 15496*        DATASET (FILE-ID-ERPNDB)
 15497*        FROM    (PENDING-BUSINESS)
 15498*    END-EXEC.
 15499     MOVE LENGTH OF
 15500      PENDING-BUSINESS
 15501       TO DFHEIV11
 15502*    MOVE '&& L                  %   #00013863' TO DFHEIV0
 15503     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15504     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15505     MOVE X'2020233030303133383633' TO DFHEIV0(25:11)
 15506     CALL 'kxdfhei1' USING DFHEIV0,
 15507           FILE-ID-ERPNDB,
 15508           PENDING-BUSINESS,
 15509           DFHEIV11,
 15510           DFHEIV99
 15511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15512
 15513
 15514     MOVE 'C'                    TO JP-RECORD-TYPE.
 15515     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15516
 15517     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 15518
 15519     IF WS-ERRORS-PRESENT
 15520        GO TO 3900-RE-DISPLAY-RECORD.
 15521
 15522     MOVE ZEROS                  TO EMI-ERROR.
 15523     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15524     MOVE LOW-VALUES             TO EL631CI.
 15525     MOVE  -1                    TO CMAINTL.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 282
* EL6311.cbl
 15526     GO TO 8100-SEND-INITIAL-MAP.
 15527
 15528 2280-BATCH-HDR-NOT-FOUND.
 15529     MOVE -1                     TO BMAINTL.
 15530     MOVE ER-7450                TO EMI-ERROR.
 15531     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15532     GO TO 8200-SEND-DATAONLY.
 15533
 15534 2290-DUPLICATE-ALT-INDEX.
 15535
 15536******************************************************************
 15537*                                                                *
 15538*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15539*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15540*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15541*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15542*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15543*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15544*                                                                *
 15545******************************************************************
 15546
 15547     IF LCP-ONCTR-02 =  0
 15548         ADD 1 TO LCP-ONCTR-02
 15549        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15550
 15551     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15552
 15553     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15554         NEXT SENTENCE
 15555     ELSE
 15556         ADD +1 TO PB-BATCH-SEQ-NO
 15557                   PB-CSR-BATCH-SEQ-NO
 15558         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15559         GO TO 2275-WRITE-PENDING-BUSINESS.
 15560
 15561     MOVE -1                     TO CCERTNOL.
 15562     MOVE AL-UABON               TO CCERTNOA.
 15563     MOVE AL-UNBON               TO CEFFDTA.
 15564
 15565     MOVE 1                      TO EMI-SUB
 15566                                    EMI-SWITCH1
 15567                                    EMI-SWITCH-AREA-1
 15568                                    EMI-SWITCH-AREA-2.
 15569
 15570     MOVE SPACES                 TO EMI-ERROR-LINES.
 15571
 15572
 15573* EXEC CICS SYNCPOINT ROLLBACK
 15574*    END-EXEC.
 15575*    MOVE '6"R                   !   #00013926' TO DFHEIV0
 15576     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15578     MOVE X'2020233030303133393236' TO DFHEIV0(25:11)
 15579     CALL 'kxdfhei1' USING DFHEIV0
 15580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15581
 15582
 15583     MOVE ER-2247                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 283
* EL6311.cbl
 15584     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15585     GO TO 8200-SEND-DATAONLY.
 15586
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 284
* EL6311.cbl
 15588
 15589******************************************************************
 15590*                                                                *
 15591*          C H A N G E   C A N C E L   R O U T I N E             *
 15592*                                                                *
 15593******************************************************************
 15594
 15595***************************************************************
 15596*                                                             *
 15597*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15598*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15599*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15600*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15601*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15602*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15603*     5. LINK TO THE EDIT ROUTINE.                            *
 15604*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15605*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15606*              THE EDIT ROUTINE.                              *
 15607*     7. REWRITE THE NEW ISSUE                                *
 15608*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15609*                                                             *
 15610***************************************************************
 15611 2300-CHANGE-CANCEL-ROUTINE.
 15612     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15613
 15614     IF CCHGL NOT = ZEROS
 15615        MOVE ER-2196             TO EMI-ERROR
 15616        MOVE AL-UABON            TO CMAINTA
 15617        MOVE -1                  TO CMAINTL
 15618        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15619        GO TO 8200-SEND-DATAONLY.
 15620
 15621     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15622
 15623     IF CSUFIXL NOT = ZEROS
 15624        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15625     ELSE
 15626        MOVE SPACE               TO WS-NEW-SUFFIX.
 15627
 15628     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15629     PERFORM 8600-DEEDIT.
 15630     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15631     MOVE '4'                    TO DC-OPTION-CODE.
 15632
 15633     PERFORM 9700-DATE-LINK.
 15634
 15635     IF DATE-CONVERSION-ERROR
 15636        MOVE ER-0348             TO EMI-ERROR
 15637        MOVE -1                  TO CEFFDTL
 15638        MOVE AL-UABON            TO CEFFDTA
 15639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15640        GO TO 8200-SEND-DATAONLY
 15641     ELSE
 15642        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15643        MOVE AL-UANON            TO CEFFDTA
 15644        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15645
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 285
* EL6311.cbl
 15646 2325-PROCESS-CANCEL-CHANGES.
 15647
 15648* EXEC CICS HANDLE CONDITION
 15649*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15650*    END-EXEC.
 15651*    MOVE '"$I                   ! 5 #00013993' TO DFHEIV0
 15652     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15653     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15654     MOVE X'3520233030303133393933' TO DFHEIV0(25:11)
 15655     CALL 'kxdfhei1' USING DFHEIV0
 15656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15657
 15658
 15659     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15660     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15661     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15662
 15663
 15664* EXEC CICS GETMAIN
 15665*        SET      (ADDRESS OF PENDING-BUSINESS)
 15666*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15667*        INITIMG  (GETMAIN-SPACE)
 15668*     END-EXEC.
 15669*    MOVE ',"IL                  $   #00014001' TO DFHEIV0
 15670     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15672     MOVE X'2020233030303134303031' TO DFHEIV0(25:11)
 15673     CALL 'kxdfhei1' USING DFHEIV0,
 15674           DFHEIV20,
 15675           ERPNDB-RECORD-LENGTH,
 15676           GETMAIN-SPACE
 15677     SET ADDRESS OF PENDING-BUSINESS TO
 15678         DFHEIV20
 15679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15680
 15681
 15682
 15683* EXEC CICS READ
 15684*        INTO    (PENDING-BUSINESS)
 15685*        DATASET (FILE-ID-ERPNDB)
 15686*        RIDFLD  (ERPNDB-KEY)
 15687*    END-EXEC.
 15688     MOVE LENGTH OF
 15689      PENDING-BUSINESS
 15690       TO DFHEIV11
 15691*    MOVE '&"IL       E          (   #00014007' TO DFHEIV0
 15692     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15694     MOVE X'2020233030303134303037' TO DFHEIV0(25:11)
 15695     CALL 'kxdfhei1' USING DFHEIV0,
 15696           FILE-ID-ERPNDB,
 15697           PENDING-BUSINESS,
 15698           DFHEIV11,
 15699           ERPNDB-KEY,
 15700           DFHEIV99,
 15701           DFHEIV99,
 15702           DFHEIV99
 15703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 286
* EL6311.cbl
 15704
 15705
 15706     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15707
 15708
 15709* EXEC CICS HANDLE CONDITION
 15710*         NOTFND     (2385-REC-NOT-FOUND)
 15711*    END-EXEC.
 15712*    MOVE '"$I                   ! 6 #00014015' TO DFHEIV0
 15713     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15715     MOVE X'3620233030303134303135' TO DFHEIV0(25:11)
 15716     CALL 'kxdfhei1' USING DFHEIV0
 15717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15718
 15719
 15720**********************************************************
 15721*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15722*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15723**********************************************************
 15724
 15725
 15726* EXEC CICS READ
 15727*        DATASET (FILE-ID-ERPNDB)
 15728*        INTO    (PENDING-BUSINESS)
 15729*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15730*    END-EXEC.
 15731     MOVE LENGTH OF
 15732      PENDING-BUSINESS
 15733       TO DFHEIV11
 15734*    MOVE '&"IL       E          (   #00014024' TO DFHEIV0
 15735     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15737     MOVE X'2020233030303134303234' TO DFHEIV0(25:11)
 15738     CALL 'kxdfhei1' USING DFHEIV0,
 15739           FILE-ID-ERPNDB,
 15740           PENDING-BUSINESS,
 15741           DFHEIV11,
 15742           PI-PREV-CONTROL-PRIMARY,
 15743           DFHEIV99,
 15744           DFHEIV99,
 15745           DFHEIV99
 15746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15747
 15748
 15749********** DO NOT ALLOW CHANGES IF THRU A/R
 15750     IF BMAINTI = 'C'
 15751         IF PB-EL860-INTERNAL-PROCESS
 15752             MOVE ER-4005          TO EMI-ERROR
 15753             MOVE -1               TO BMAINTL
 15754             MOVE AL-UABON         TO BMAINTA
 15755             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15756             GO TO 8200-SEND-DATAONLY.
 15757**********
 15758
 15759     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15760        MOVE -1                 TO CMAINTL
 15761        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 287
* EL6311.cbl
 15762        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15763        GO TO 8200-SEND-DATAONLY.
 15764
 15765     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15766        MOVE ER-2196             TO EMI-ERROR
 15767        MOVE AL-UABON            TO CMAINTA
 15768        MOVE -1                  TO CMAINTL
 15769        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15770        GO TO 8200-SEND-DATAONLY.
 15771     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15772
 15773     IF PB-BILLED-DT = LOW-VALUES AND
 15774        PB-CHG-COUNT = ZEROS
 15775        NEXT SENTENCE
 15776     ELSE
 15777        IF (CREFND1L GREATER THAN ZEROS AND
 15778            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15779           OR
 15780           (CREFND2L GREATER THAN ZEROS AND
 15781            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15782           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15783     if ((crefnd1l <> zeros)
 15784        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15785                      or
 15786        ((crefnd2l <> zeros)
 15787        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15788        continue
 15789     else
 15790        go to 2330-continue-change
 15791     end-if
 15792
 15793     move zeros                  to ws-check-amts
 15794     move ' '                    to ws-stop-sw
 15795                                    ws-check-sw
 15796                                    ws-any-check-sw
 15797                                    ws-proc-check-sw
 15798                                    ws-chek-browse-sw
 15799
 15800     perform 2500-browse-checks  thru 2500-exit
 15801
 15802     if i-have-processed-checks
 15803        or i-have-checks
 15804        continue
 15805     else
 15806        go to 2330-continue-change
 15807     end-if
 15808
 15809     if crefnd1l <> zeros
 15810        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15811        move ws-crefnd1 to ws-new-ref-total
 15812     else
 15813        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15814     end-if
 15815     if crefnd2l <> zeros
 15816        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15817        compute ws-new-ref-total = ws-new-ref-total +
 15818           ws-crefnd2
 15819     else
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 288
* EL6311.cbl
 15820        compute ws-new-ref-total = ws-new-ref-total +
 15821           pb-c-ah-cancel-amt
 15822     end-if
 15823
 15824     if zeros = (ws-lf-diff + ws-ah-diff)
 15825        move er-3449             to emi-error
 15826        perform 9900-error-format thru 9900-exit
 15827        go to 2330-continue-change
 15828     end-if
 15829
 15830     if (ws-new-ref-total < ws-check-amts)
 15831        and (pb-c-refund-sw = 'Y')
 15832        move er-3447             to emi-error
 15833        perform 9900-error-format thru 9900-exit
 15834        move al-uabon            to cmainta
 15835        move -1                  to cmaintl
 15836        go to 8200-send-dataonly
 15837     end-if
 15838
 15839     if (ws-new-ref-total > ws-check-amts)
 15840        and (ws-check-amts not = zeros)
 15841        move er-3448             to emi-error
 15842        move al-uabon            to crefnd1a
 15843                                    crefnd2a
 15844        perform 9900-error-format thru 9900-exit
 15845     end-if
 15846
 15847*     if (ws-lf-diff + ws-ah-diff) < zeros
 15848*        move er-3447             to emi-error
 15849*        perform 9900-error-format thru 9900-exit
 15850*        move al-uabon            to cmainta
 15851*        move -1                  to cmaintl
 15852*        go to 8200-send-dataonly
 15853*     end-if
 15854     .
 15855 2330-continue-change.
 15856
 15857
 15858* EXEC CICS READ
 15859*        DATASET (FILE-ID-ERPNDB)
 15860*        INTO    (PENDING-BUSINESS)
 15861*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15862*        UPDATE
 15863*    END-EXEC.
 15864     MOVE LENGTH OF
 15865      PENDING-BUSINESS
 15866       TO DFHEIV11
 15867*    MOVE '&"IL       EU         (   #00014138' TO DFHEIV0
 15868     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15869     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15870     MOVE X'2020233030303134313338' TO DFHEIV0(25:11)
 15871     CALL 'kxdfhei1' USING DFHEIV0,
 15872           FILE-ID-ERPNDB,
 15873           PENDING-BUSINESS,
 15874           DFHEIV11,
 15875           PI-PREV-CONTROL-PRIMARY,
 15876           DFHEIV99,
 15877           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 289
* EL6311.cbl
 15878           DFHEIV99
 15879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15880
 15881
 15882     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15883     MOVE 'B'                    TO JP-RECORD-TYPE
 15884     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15885     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15886
 15887*    PERFORM 8400-LOG-JOURNAL-RECORD  *>Move closer to rewrite
 15888
 15889     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15890          PB-CHG-COUNT NOT = ZEROS
 15891        IF (CREFND1L GREATER THAN ZEROS AND
 15892            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15893           OR
 15894           (CREFND2L GREATER THAN ZEROS AND
 15895            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15896            ADD +1                      TO PB-CHG-COUNT
 15897            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15898
 15899*    IF CMICRNOL  GREATER  ZEROS
 15900*        IF CMICRNOI  NUMERIC
 15901*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15902*            MOVE AL-UNNON       TO  CMICRNOA
 15903*        ELSE
 15904*            MOVE -1             TO  CMICRNOL
 15905*            MOVE AL-UNBON       TO  CMICRNOA
 15906*            MOVE ER-2701        TO  EMI-ERROR
 15907*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15908
 15909     IF CSUFIXL GREATER THAN ZEROS
 15910        MOVE CSUFIXI             TO PB-CERT-SFX.
 15911
 15912     IF CLSTNML GREATER THAN ZEROS
 15913         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15914
 15915     IF CCANREAL > ZEROS
 15916        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15917     END-IF
 15918     IF CCANDT1L    GREATER THAN ZEROS
 15919        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15920
 15921     IF CCANDT2L    GREATER THAN ZEROS
 15922        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15923
 15924     IF CMTHD1L    GREATER THAN +0
 15925        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15926
 15927     IF CMTHD2L    GREATER THAN +0
 15928        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15929
 15930     IF CREFND1L    GREATER THAN ZEROS
 15931        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15932        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15933        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15934        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15935
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 290
* EL6311.cbl
 15936     IF CREFND2L    GREATER THAN ZEROS
 15937        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15938        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15939        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15940        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15941
 15942     IF CLIVESL     GREATER THAN ZEROS
 15943        MOVE WS-CLIVES           TO PB-C-LIVES.
 15944
 15945     IF CPAYEEL     GREATER THAN ZEROS
 15946        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15947
 15948     IF CFORCEL     GREATER THAN ZEROS
 15949        MOVE CFORCEI             TO PB-FORCE-CODE.
 15950
 15951     IF CBILCDL     GREATER THAN ZEROS
 15952        MOVE CBILCDI             TO PB-RECORD-BILL.
 15953
 15954 2360-REWRITE-PB-RECORD.
 15955     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15956     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15957     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15958*    MOVE 'C'                    TO JP-RECORD-TYPE.
 15959*    MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15960     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15961*    MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15962
 15963     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15964
 15965     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15966     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15967
 15968     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15969
 15970     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15971
 15972     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15973     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15974     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15975
 15976     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15977     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15978
 15979 2375-REWRITE-PENDING-BUSINESS.
 15980     PERFORM 8400-LOG-JOURNAL-RECORD  *>Before Cancel Image
 15981     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15982     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15983     MOVE 'C'                    TO JP-RECORD-TYPE.
 15984     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15985
 15986
 15987* EXEC CICS REWRITE
 15988*        DATASET (FILE-ID-ERPNDB)
 15989*        FROM    (PENDING-BUSINESS)
 15990*    END-EXEC.
 15991     MOVE LENGTH OF
 15992      PENDING-BUSINESS
 15993       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 291
* EL6311.cbl
 15994*    MOVE '&& L                  %   #00014249' TO DFHEIV0
 15995     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15996     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15997     MOVE X'2020233030303134323439' TO DFHEIV0(25:11)
 15998     CALL 'kxdfhei1' USING DFHEIV0,
 15999           FILE-ID-ERPNDB,
 16000           PENDING-BUSINESS,
 16001           DFHEIV11,
 16002           DFHEIV99
 16003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16004
 16005
 16006     PERFORM 8400-LOG-JOURNAL-RECORD  *> After Cancel Image
 16007
 16008******************************************************************
 16009*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 16010******************************************************************
 16011
 16012     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16013     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16014     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16015     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16016
 16017
 16018* EXEC CICS READ
 16019*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16020*        DATASET (FILE-ID-ELCERT)
 16021*        RIDFLD  (ELCERT-KEY)
 16022*        RESP    (WS-RESPONSE)
 16023*    END-EXEC.
 16024*    MOVE '&"S        E          (  N#00014265' TO DFHEIV0
 16025     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16026     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16027     MOVE X'204E233030303134323635' TO DFHEIV0(25:11)
 16028     CALL 'kxdfhei1' USING DFHEIV0,
 16029           FILE-ID-ELCERT,
 16030           DFHEIV20,
 16031           DFHEIV99,
 16032           ELCERT-KEY,
 16033           DFHEIV99,
 16034           DFHEIV99,
 16035           DFHEIV99
 16036     SET ADDRESS OF CERTIFICATE-MASTER TO
 16037         DFHEIV20
 16038     MOVE EIBRESP  TO WS-RESPONSE
 16039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16040
 16041
 16042     IF NOT RESP-NORMAL
 16043        GO TO 2376-BYPASS-CRTO
 16044     END-IF
 16045
 16046
 16047     MOVE ELCERT-KEY             TO ERMAIL-KEY
 16048     MOVE ' '                    TO WS-ERMAIL-SW
 16049
 16050
 16051* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 292
* EL6311.cbl
 16052*       DATASET   (FILE-ID-ERMAIL)
 16053*       SET       (ADDRESS OF MAILING-DATA)
 16054*       RIDFLD    (ERMAIL-KEY)
 16055*       RESP      (WS-RESPONSE)
 16056*    END-EXEC
 16057*    MOVE '&"S        E          (  N#00014280' TO DFHEIV0
 16058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16060     MOVE X'204E233030303134323830' TO DFHEIV0(25:11)
 16061     CALL 'kxdfhei1' USING DFHEIV0,
 16062           FILE-ID-ERMAIL,
 16063           DFHEIV20,
 16064           DFHEIV99,
 16065           ERMAIL-KEY,
 16066           DFHEIV99,
 16067           DFHEIV99,
 16068           DFHEIV99
 16069     SET ADDRESS OF MAILING-DATA TO
 16070         DFHEIV20
 16071     MOVE EIBRESP  TO WS-RESPONSE
 16072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16073
 16074     IF RESP-NORMAL
 16075        SET ERMAIL-FOUND TO TRUE
 16076     END-IF
 16077
 16078     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 16079
 16080     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16081                                 TO ELCRTO-KEY
 16082     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 16083     MOVE +0                     TO ELCRTO-SEQ-NO
 16084
 16085
 16086* EXEC CICS READ
 16087*       DATASET   ('ELCRTO')
 16088*       INTO      (ORIGINAL-CERTIFICATE)
 16089*       RIDFLD    (ELCRTO-KEY)
 16090*       GTEQ
 16091*       RESP      (WS-RESPONSE)
 16092*    END-EXEC
 16093     MOVE LENGTH OF
 16094      ORIGINAL-CERTIFICATE
 16095       TO DFHEIV11
 16096     MOVE 'ELCRTO' TO DFHEIV1
 16097*    MOVE '&"IL       G          (  N#00014298' TO DFHEIV0
 16098     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 16099     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16100     MOVE X'204E233030303134323938' TO DFHEIV0(25:11)
 16101     CALL 'kxdfhei1' USING DFHEIV0,
 16102           DFHEIV1,
 16103           ORIGINAL-CERTIFICATE,
 16104           DFHEIV11,
 16105           ELCRTO-KEY,
 16106           DFHEIV99,
 16107           DFHEIV99,
 16108           DFHEIV99
 16109     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 293
* EL6311.cbl
 16110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16111
 16112     IF RESP-NORMAL
 16113        AND (OC-CONTROL-PRIMARY (1:33) =
 16114                 PB-CONTROL-BY-ACCOUNT (1:33))
 16115        AND (OC-RECORD-TYPE = 'I')
 16116        display ' resp norm, key =, type i '
 16117        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 16118           display ' end proc blank '
 16119           display ' csr edit session ' PI-CSR-SESSION-SW
 16120           IF NOT CSR-EDIT-SESSION
 16121
 16122* EXEC CICS READ
 16123*                DATASET   ('ELCRTO')
 16124*                INTO      (ORIGINAL-CERTIFICATE)
 16125*                RIDFLD    (OC-CONTROL-PRIMARY)
 16126*                UPDATE
 16127*                RESP      (WS-RESPONSE)
 16128*             END-EXEC
 16129     MOVE LENGTH OF
 16130      ORIGINAL-CERTIFICATE
 16131       TO DFHEIV11
 16132     MOVE 'ELCRTO' TO DFHEIV1
 16133*    MOVE '&"IL       EU         (  N#00014315' TO DFHEIV0
 16134     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16135     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16136     MOVE X'204E233030303134333135' TO DFHEIV0(25:11)
 16137     CALL 'kxdfhei1' USING DFHEIV0,
 16138           DFHEIV1,
 16139           ORIGINAL-CERTIFICATE,
 16140           DFHEIV11,
 16141           OC-CONTROL-PRIMARY,
 16142           DFHEIV99,
 16143           DFHEIV99,
 16144           DFHEIV99
 16145     MOVE EIBRESP  TO WS-RESPONSE
 16146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16147              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 16148              IF RESP-NORMAL
 16149                 display ' good read upd '
 16150                 IF OC-ISSUE-TRAN-IND = 'N'
 16151                    MOVE CM-INSURED-LAST-NAME   TO
 16152                         OC-INS-LAST-NAME
 16153                    MOVE CM-INSURED-FIRST-NAME  TO
 16154                         OC-INS-FIRST-NAME
 16155                    MOVE CM-INSURED-INITIAL2    TO
 16156                         OC-INS-MIDDLE-INIT
 16157                    MOVE CM-INSURED-ISSUE-AGE   TO
 16158                         OC-INS-AGE
 16159                    MOVE CM-JT-LAST-NAME        TO
 16160                         OC-JNT-LAST-NAME
 16161                    MOVE CM-JT-FIRST-NAME       TO
 16162                         OC-JNT-FIRST-NAME
 16163                    MOVE CM-JT-INITIAL          TO
 16164                         OC-JNT-MIDDLE-INIT
 16165                    MOVE CM-INSURED-JOINT-AGE   TO
 16166                         OC-JNT-AGE
 16167                    MOVE CM-LF-BENEFIT-CD       TO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 294
* EL6311.cbl
 16168                         OC-LF-BENCD
 16169                    MOVE CM-LF-ORIG-TERM        TO
 16170                         OC-LF-TERM
 16171                    MOVE CM-LF-BENEFIT-AMT      TO
 16172                         OC-LF-BEN-AMT
 16173                    MOVE CM-LF-PREMIUM-AMT      TO
 16174                         OC-LF-PRM-AMT
 16175                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16176                         OC-LF-ALT-BEN-AMT
 16177                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16178                         OC-LF-ALT-PRM-AMT
 16179                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16180                         OC-LF-EXP-DT
 16181                    MOVE CM-LIFE-COMM-PCT       TO
 16182                         OC-LF-COMM-PCT
 16183                    MOVE CM-AH-BENEFIT-CD       TO
 16184                         OC-AH-BENCD
 16185                    MOVE CM-AH-ORIG-TERM        TO
 16186                         OC-AH-TERM
 16187                    MOVE CM-AH-BENEFIT-AMT      TO
 16188                         OC-AH-BEN-AMT
 16189                    MOVE CM-AH-PREMIUM-AMT      TO
 16190                         OC-AH-PRM-AMT
 16191                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16192                         OC-AH-EXP-DT
 16193                    MOVE CM-AH-COMM-PCT         TO
 16194                         OC-AH-COMM-PCT
 16195                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16196                         OC-AH-CP
 16197                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16198                         OC-1ST-PMT-DT
 16199                 END-IF
 16200                 MOVE PB-C-LF-CANCEL-DT      TO
 16201                         OC-LF-CANCEL-DT
 16202                 MOVE PB-C-LF-CANCEL-AMT     TO
 16203                         OC-LF-CANCEL-AMT
 16204                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16205                         OC-LF-ITD-CANCEL-AMT
 16206                 MOVE PB-C-AH-CANCEL-DT      TO
 16207                         OC-AH-CANCEL-DT
 16208                 MOVE PB-C-AH-CANCEL-AMT     TO
 16209                         OC-AH-CANCEL-AMT
 16210                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16211                         OC-AH-ITD-CANCEL-AMT
 16212                 MOVE 'Y'                    TO
 16213                         OC-CANCEL-TRAN-IND
 16214                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16215                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16216                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16217                 IF ERMAIL-FOUND
 16218                    MOVE MA-CRED-BENE-NAME
 16219                                 TO OC-CRED-BENE-NAME
 16220                 END-IF
 16221                 IF NOT CERT-TRL-REC-NOT-FOUND
 16222                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16223                           OC-INS-AGE-DEFAULT-FLAG
 16224                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16225                           OC-JNT-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 295
* EL6311.cbl
 16226                 END-IF
 16227
 16228* EXEC CICS REWRITE
 16229*                   DATASET   ('ELCRTO')
 16230*                   FROM      (ORIGINAL-CERTIFICATE)
 16231*                   RESP      (WS-RESPONSE)
 16232*                END-EXEC
 16233     MOVE LENGTH OF
 16234      ORIGINAL-CERTIFICATE
 16235       TO DFHEIV11
 16236     MOVE 'ELCRTO' TO DFHEIV1
 16237*    MOVE '&& L                  %  N#00014402' TO DFHEIV0
 16238     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16239     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16240     MOVE X'204E233030303134343032' TO DFHEIV0(25:11)
 16241     CALL 'kxdfhei1' USING DFHEIV0,
 16242           DFHEIV1,
 16243           ORIGINAL-CERTIFICATE,
 16244           DFHEIV11,
 16245           DFHEIV99
 16246     MOVE EIBRESP  TO WS-RESPONSE
 16247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16248                 display ' just rewrote ' ws-response
 16249              END-IF
 16250           END-IF
 16251        ELSE
 16252           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16253           MOVE 'OC'             TO OC-RECORD-ID
 16254           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16255           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16256           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16257           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16258           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16259           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16260           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16261           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16262           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16263           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16264           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16265           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16266           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16267           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16268           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16269           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16270           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16271           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16272           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16273           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16274           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16275           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16276           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16277           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16278           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16279           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16280           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16281           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16282           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16283           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 296
* EL6311.cbl
 16284           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16285           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16286           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16287           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16288           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16289           IF ERMAIL-FOUND
 16290              MOVE MA-CRED-BENE-NAME
 16291                                 TO OC-CRED-BENE-NAME
 16292           END-IF
 16293           IF NOT CERT-TRL-REC-NOT-FOUND
 16294              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16295                           OC-INS-AGE-DEFAULT-FLAG
 16296              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16297                           OC-JNT-AGE-DEFAULT-FLAG
 16298           END-IF
 16299           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16300
 16301* EXEC CICS WRITE
 16302*             DATASET   ('ELCRTO')
 16303*             FROM      (ORIGINAL-CERTIFICATE)
 16304*             RIDFLD    (OC-CONTROL-PRIMARY)
 16305*             RESP      (WS-RESPONSE)
 16306*          END-EXEC
 16307     MOVE LENGTH OF
 16308      ORIGINAL-CERTIFICATE
 16309       TO DFHEIV11
 16310     MOVE 'ELCRTO' TO DFHEIV1
 16311*    MOVE '&$ L                  ''  N#00014459' TO DFHEIV0
 16312     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16313     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16314     MOVE X'204E233030303134343539' TO DFHEIV0(25:11)
 16315     CALL 'kxdfhei1' USING DFHEIV0,
 16316           DFHEIV1,
 16317           ORIGINAL-CERTIFICATE,
 16318           DFHEIV11,
 16319           OC-CONTROL-PRIMARY,
 16320           DFHEIV99,
 16321           DFHEIV99
 16322     MOVE EIBRESP  TO WS-RESPONSE
 16323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16324        END-IF
 16325     ELSE
 16326        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16327        MOVE 'OC'                TO OC-RECORD-ID
 16328        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16329                                 TO OC-CONTROL-PRIMARY (1:33)
 16330        MOVE 'I'                 TO OC-RECORD-TYPE
 16331        MOVE +4096               TO OC-KEY-SEQ-NO
 16332        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16333        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16334        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16335        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16336        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16337        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16338        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16339        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16340        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16341        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 297
* EL6311.cbl
 16342        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16343        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16344        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16345        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16346        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16347        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16348        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16349        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16350        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16351        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16352        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16353        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16354        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16355        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16356        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16357        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16358        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16359        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16360        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16361        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16362        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16363        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16364        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16365        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16366        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16367        IF ERMAIL-FOUND
 16368           MOVE MA-CRED-BENE-NAME
 16369                                 TO OC-CRED-BENE-NAME
 16370        END-IF
 16371        IF NOT CERT-TRL-REC-NOT-FOUND
 16372           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16373                           OC-INS-AGE-DEFAULT-FLAG
 16374           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16375                           OC-JNT-AGE-DEFAULT-FLAG
 16376        END-IF
 16377        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16378
 16379
 16380* EXEC CICS WRITE
 16381*          DATASET   ('ELCRTO')
 16382*          FROM      (ORIGINAL-CERTIFICATE)
 16383*          RIDFLD    (OC-CONTROL-PRIMARY)
 16384*          RESP      (WS-RESPONSE)
 16385*       END-EXEC
 16386     MOVE LENGTH OF
 16387      ORIGINAL-CERTIFICATE
 16388       TO DFHEIV11
 16389     MOVE 'ELCRTO' TO DFHEIV1
 16390*    MOVE '&$ L                  ''  N#00014520' TO DFHEIV0
 16391     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16392     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16393     MOVE X'204E233030303134353230' TO DFHEIV0(25:11)
 16394     CALL 'kxdfhei1' USING DFHEIV0,
 16395           DFHEIV1,
 16396           ORIGINAL-CERTIFICATE,
 16397           DFHEIV11,
 16398           OC-CONTROL-PRIMARY,
 16399           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 298
* EL6311.cbl
 16400           DFHEIV99
 16401     MOVE EIBRESP  TO WS-RESPONSE
 16402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16403     END-IF.
 16404
 16405 2376-BYPASS-CRTO.
 16406******************************************************************
 16407*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16408******************************************************************
 16409
 16410
 16411* EXEC CICS HANDLE CONDITION
 16412*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16413*    END-EXEC.
 16414*    MOVE '"$I                   ! 7 #00014533' TO DFHEIV0
 16415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16417     MOVE X'3720233030303134353333' TO DFHEIV0(25:11)
 16418     CALL 'kxdfhei1' USING DFHEIV0
 16419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16420
 16421
 16422
 16423* EXEC CICS READ
 16424*        INTO    (PENDING-BUSINESS)
 16425*        DATASET (FILE-ID-ERPNDB)
 16426*        RIDFLD  (ERPNDB-KEY)
 16427*        UPDATE
 16428*    END-EXEC.
 16429     MOVE LENGTH OF
 16430      PENDING-BUSINESS
 16431       TO DFHEIV11
 16432*    MOVE '&"IL       EU         (   #00014537' TO DFHEIV0
 16433     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16434     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16435     MOVE X'2020233030303134353337' TO DFHEIV0(25:11)
 16436     CALL 'kxdfhei1' USING DFHEIV0,
 16437           FILE-ID-ERPNDB,
 16438           PENDING-BUSINESS,
 16439           DFHEIV11,
 16440           ERPNDB-KEY,
 16441           DFHEIV99,
 16442           DFHEIV99,
 16443           DFHEIV99
 16444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16445
 16446
 16447     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16448     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16449     MOVE 'B'                    TO JP-RECORD-TYPE.
 16450     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16451
 16452     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16453
 16454     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16455
 16456
 16457* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 299
* EL6311.cbl
 16458*        DATASET (FILE-ID-ERPNDB)
 16459*        FROM    (PENDING-BUSINESS)
 16460*    END-EXEC.
 16461     MOVE LENGTH OF
 16462      PENDING-BUSINESS
 16463       TO DFHEIV11
 16464*    MOVE '&& L                  %   #00014553' TO DFHEIV0
 16465     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16466     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16467     MOVE X'2020233030303134353533' TO DFHEIV0(25:11)
 16468     CALL 'kxdfhei1' USING DFHEIV0,
 16469           FILE-ID-ERPNDB,
 16470           PENDING-BUSINESS,
 16471           DFHEIV11,
 16472           DFHEIV99
 16473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16474
 16475
 16476     MOVE 'C'                    TO JP-RECORD-TYPE.
 16477     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16478
 16479     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 16480
 16481     IF WS-ERRORS-PRESENT
 16482         GO TO 3900-RE-DISPLAY-RECORD.
 16483
 16484     MOVE ZEROS                  TO EMI-ERROR
 16485     MOVE -1                     TO CMAINTL
 16486     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16487     GO TO 3900-RE-DISPLAY-RECORD.
 16488
 16489 2380-BATCH-HDR-NOT-FOUND.
 16490     MOVE -1                     TO BMAINTL.
 16491     MOVE ER-7450                TO EMI-ERROR.
 16492     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16493     GO TO 8200-SEND-DATAONLY.
 16494
 16495 2385-REC-NOT-FOUND.
 16496     MOVE -1                     TO BMAINTL.
 16497     MOVE ER-7451                TO EMI-ERROR.
 16498     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16499     GO TO 8200-SEND-DATAONLY.
 16500
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 300
* EL6311.cbl
 16502
 16503******************************************************************
 16504*                                                                *
 16505*          D E L E T E   C A N C E L   R O U T I N E             *
 16506*                                                                *
 16507******************************************************************
 16508
 16509 2400-DELETE-CANCEL-ROUTINE.
 16510     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16511
 16512     IF CCHGL NOT = ZEROS
 16513        MOVE ER-2196             TO EMI-ERROR
 16514        MOVE AL-UABON            TO CMAINTA
 16515        MOVE -1                  TO CMAINTL
 16516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16517        GO TO 8200-SEND-DATAONLY.
 16518
 16519
 16520* EXEC CICS HANDLE CONDITION
 16521*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16522*    END-EXEC.
 16523*    MOVE '"$I                   ! 8 #00014601' TO DFHEIV0
 16524     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16525     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16526     MOVE X'3820233030303134363031' TO DFHEIV0(25:11)
 16527     CALL 'kxdfhei1' USING DFHEIV0
 16528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16529
 16530
 16531     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16532     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16533     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16534
 16535
 16536* EXEC CICS READ
 16537*        SET     (ADDRESS OF PENDING-BUSINESS)
 16538*        DATASET (FILE-ID-ERPNDB)
 16539*        RIDFLD  (ERPNDB-KEY)
 16540*    END-EXEC.
 16541*    MOVE '&"S        E          (   #00014609' TO DFHEIV0
 16542     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16544     MOVE X'2020233030303134363039' TO DFHEIV0(25:11)
 16545     CALL 'kxdfhei1' USING DFHEIV0,
 16546           FILE-ID-ERPNDB,
 16547           DFHEIV20,
 16548           DFHEIV99,
 16549           ERPNDB-KEY,
 16550           DFHEIV99,
 16551           DFHEIV99,
 16552           DFHEIV99
 16553     SET ADDRESS OF PENDING-BUSINESS TO
 16554         DFHEIV20
 16555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16556
 16557
 16558     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16559
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 301
* EL6311.cbl
 16560     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16561
 16562     IF CSUFIXL NOT = ZEROS
 16563        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16564     ELSE
 16565        MOVE SPACE               TO WS-NEW-SUFFIX.
 16566
 16567     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16568
 16569     PERFORM 8600-DEEDIT.
 16570     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16571     MOVE '4'                    TO DC-OPTION-CODE.
 16572     PERFORM 9700-DATE-LINK.
 16573
 16574     IF DATE-CONVERSION-ERROR
 16575        MOVE ER-0348             TO EMI-ERROR
 16576        MOVE -1                  TO CEFFDTL
 16577        MOVE AL-UABON            TO CEFFDTA
 16578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16579        GO TO 8200-SEND-DATAONLY
 16580     ELSE
 16581        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16582        MOVE AL-UANON            TO CEFFDTA
 16583        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16584
 16585
 16586* EXEC CICS HANDLE CONDITION
 16587*         NOTFND    (2490-RECORD-NOT-FOUND)
 16588*    END-EXEC.
 16589*    MOVE '"$I                   ! 9 #00014642' TO DFHEIV0
 16590     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16592     MOVE X'3920233030303134363432' TO DFHEIV0(25:11)
 16593     CALL 'kxdfhei1' USING DFHEIV0
 16594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16595
 16596
 16597
 16598* EXEC CICS READ
 16599*        SET     (ADDRESS OF PENDING-BUSINESS)
 16600*        DATASET (FILE-ID-ERPNDB)
 16601*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16602*        UPDATE
 16603*    END-EXEC.
 16604*    MOVE '&"S        EU         (   #00014646' TO DFHEIV0
 16605     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16606     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16607     MOVE X'2020233030303134363436' TO DFHEIV0(25:11)
 16608     CALL 'kxdfhei1' USING DFHEIV0,
 16609           FILE-ID-ERPNDB,
 16610           DFHEIV20,
 16611           DFHEIV99,
 16612           PI-PREV-CONTROL-PRIMARY,
 16613           DFHEIV99,
 16614           DFHEIV99,
 16615           DFHEIV99
 16616     SET ADDRESS OF PENDING-BUSINESS TO
 16617         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 302
* EL6311.cbl
 16618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16619
 16620
 16621     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16622        MOVE -1                 TO CMAINTL
 16623        MOVE ER-2197            TO EMI-ERROR
 16624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16625        GO TO 8200-SEND-DATAONLY.
 16626
 16627     IF PB-BILLED-DT NOT = LOW-VALUES
 16628        MOVE -1                 TO CMAINTL
 16629        MOVE ER-2129            TO EMI-ERROR
 16630        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16631        GO TO 8200-SEND-DATAONLY.
 16632
 16633     IF PB-CHG-COUNT NOT = ZEROS
 16634        MOVE ER-2336            TO EMI-ERROR
 16635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16636        MOVE AL-UABON            TO CMAINTA
 16637        MOVE -1                  TO CMAINTL
 16638        GO TO 8200-SEND-DATAONLY.
 16639
 16640     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16641        PB-CHG-COUNT NOT = ZEROS
 16642        MOVE ER-2196             TO EMI-ERROR
 16643        MOVE AL-UABON            TO CMAINTA
 16644        MOVE -1                  TO CMAINTL
 16645        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16646        GO TO 8200-SEND-DATAONLY.
 16647
 16648     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16649        MOVE ER-2900 TO EMI-ERROR
 16650        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16651        MOVE AL-UABON         TO CMAINTA
 16652        MOVE -1               TO CMAINTL
 16653        GO TO 8200-SEND-DATAONLY.
 16654     move ' '                    to ws-stop-sw
 16655                                    ws-check-sw
 16656                                    ws-any-check-sw
 16657                                    ws-proc-check-sw
 16658                                    ws-chek-browse-sw
 16659
 16660     perform 2500-browse-checks  thru 2500-exit
 16661     if (i-have-processed-checks)
 16662        and (pb-c-refund-sw = 'Y')
 16663        move er-3446             to emi-error
 16664        perform 9900-error-format thru 9900-exit
 16665        move al-uabon            to cmainta
 16666        move -1                  to cmaintl
 16667        go to 8200-send-dataonly
 16668     end-if
 16669
 16670* EXEC CICS HANDLE CONDITION
 16671*         NOTFND  (2475-CONTINUE-DELETE)
 16672*    END-EXEC
 16673*    MOVE '"$I                   ! : #00014701' TO DFHEIV0
 16674     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16675     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 303
* EL6311.cbl
 16676     MOVE X'3A20233030303134373031' TO DFHEIV0(25:11)
 16677     CALL 'kxdfhei1' USING DFHEIV0
 16678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16679
 16680     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16681     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16682     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16683     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16684
 16685
 16686* EXEC CICS READ
 16687*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16688*        DATASET (FILE-ID-ELCERT)
 16689*        RIDFLD  (ELCERT-KEY)
 16690*        UPDATE
 16691*    END-EXEC.
 16692*    MOVE '&"S        EU         (   #00014710' TO DFHEIV0
 16693     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16694     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16695     MOVE X'2020233030303134373130' TO DFHEIV0(25:11)
 16696     CALL 'kxdfhei1' USING DFHEIV0,
 16697           FILE-ID-ELCERT,
 16698           DFHEIV20,
 16699           DFHEIV99,
 16700           ELCERT-KEY,
 16701           DFHEIV99,
 16702           DFHEIV99,
 16703           DFHEIV99
 16704     SET ADDRESS OF CERTIFICATE-MASTER TO
 16705         DFHEIV20
 16706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16707
 16708
 16709     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16710
 16711     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16712     MOVE 'B'                    TO JP-RECORD-TYPE.
 16713     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16714     PERFORM 8400-LOG-JOURNAL-RECORD.
 16715
 16716     IF PB-CI-LIVES NOT NUMERIC
 16717         MOVE ZERO                    TO PB-CI-LIVES.
 16718
 16719     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16720        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16721           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16722           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16723           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16724                                            CM-LF-CANCEL-DT
 16725           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16726        ELSE
 16727           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16728           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16729           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16730           MOVE PB-CI-LIVES              TO CM-LIVES.
 16731
 16732     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16733        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 304
* EL6311.cbl
 16734           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16735               MOVE CM-LF-STATUS-AT-CANCEL
 16736                                        TO CM-LF-CURRENT-STATUS
 16737               MOVE SPACE
 16738                                        TO CM-LF-STATUS-AT-CANCEL
 16739           ELSE
 16740               MOVE PB-CI-LF-POLICY-STATUS
 16741                                        TO CM-LF-CURRENT-STATUS
 16742        ELSE
 16743           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16744
 16745
 16746     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16747        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16748           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16749           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16750           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16751                                            CM-AH-CANCEL-DT
 16752           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16753        ELSE
 16754           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16755           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16756           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16757           MOVE PB-CI-LIVES              TO CM-LIVES.
 16758
 16759     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16760        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16761           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16762               MOVE CM-AH-STATUS-AT-CANCEL
 16763                                        TO CM-AH-CURRENT-STATUS
 16764               MOVE SPACE
 16765                                        TO CM-AH-STATUS-AT-CANCEL
 16766           ELSE
 16767               MOVE PB-CI-AH-POLICY-STATUS
 16768                                        TO CM-AH-CURRENT-STATUS
 16769        ELSE
 16770           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16771
 16772 2450-REWRITE-CERT.
 16773     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16774     MOVE 'C'                      TO JP-RECORD-TYPE.
 16775     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16776
 16777
 16778* EXEC CICS REWRITE
 16779*        DATASET  (FILE-ID-ELCERT)
 16780*        FROM     (CERTIFICATE-MASTER)
 16781*    END-EXEC.
 16782     MOVE LENGTH OF
 16783      CERTIFICATE-MASTER
 16784       TO DFHEIV11
 16785*    MOVE '&& L                  %   #00014785' TO DFHEIV0
 16786     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16787     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16788     MOVE X'2020233030303134373835' TO DFHEIV0(25:11)
 16789     CALL 'kxdfhei1' USING DFHEIV0,
 16790           FILE-ID-ELCERT,
 16791           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 305
* EL6311.cbl
 16792           DFHEIV11,
 16793           DFHEIV99
 16794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16795
 16796
 16797     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16798
 16799     PERFORM 8400-LOG-JOURNAL-RECORD.
 16800
 16801     move ' '                    to ws-stop-sw
 16802                                    ws-any-check-sw
 16803                                    ws-proc-check-sw
 16804                                    ws-chek-browse-sw
 16805
 16806     if i-have-checks
 16807        perform until i-say-stop
 16808           perform 2510-startbr-erchek
 16809                                 thru 2510-exit
 16810           if resp-normal
 16811              perform 2520-readnext-erchek
 16812                                 thru 2520-exit
 16813           end-if
 16814           if (not resp-normal)
 16815              or (pb-control-by-account (1:33) not =
 16816                 ch-control-primary (1:33))
 16817                 set i-say-stop to true
 16818           else
 16819              perform 2530-readupd-erchek
 16820                                 thru 2530-exit
 16821              if resp-normal
 16822                 perform 2540-delete-erchek
 16823                                 thru 2540-exit
 16824              end-if
 16825              if ws-chek-browse-sw = 'Y'
 16826                 perform 2525-endbr-erchek
 16827                                 thru 2525-exit
 16828                 move ' '        to ws-chek-browse-sw
 16829              end-if
 16830           end-if
 16831        end-perform
 16832     end-if
 16833
 16834     if ws-chek-browse-sw = 'Y'
 16835        perform 2525-endbr-erchek thru 2525-exit
 16836     end-if
 16837     .
 16838 2475-CONTINUE-DELETE.
 16839     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16840     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16841
 16842     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16843     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16844
 16845     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16846
 16847     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16848     MOVE 'D'                    TO JP-RECORD-TYPE
 16849     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 306
* EL6311.cbl
 16850
 16851
 16852* EXEC CICS DELETE
 16853*        DATASET    (FILE-ID-ERPNDB)
 16854*    END-EXEC.
 16855*    MOVE '&(                    &   #00014844' TO DFHEIV0
 16856     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16857     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16858     MOVE X'2020233030303134383434' TO DFHEIV0(25:11)
 16859     CALL 'kxdfhei1' USING DFHEIV0,
 16860           FILE-ID-ERPNDB,
 16861           DFHEIV99,
 16862           DFHEIV99,
 16863           DFHEIV99,
 16864           DFHEIV99
 16865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16866
 16867
 16868     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16869
 16870     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 16871
 16872     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16873     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16874
 16875
 16876* EXEC CICS HANDLE CONDITION
 16877*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16878*    END-EXEC.
 16879*    MOVE '"$I                   ! ; #00014855' TO DFHEIV0
 16880     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16882     MOVE X'3B20233030303134383535' TO DFHEIV0(25:11)
 16883     CALL 'kxdfhei1' USING DFHEIV0
 16884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16885
 16886
 16887
 16888* EXEC CICS READ
 16889*        SET     (ADDRESS OF PENDING-BUSINESS)
 16890*        DATASET (FILE-ID-ERPNDB)
 16891*        RIDFLD  (ERPNDB-KEY)
 16892*        UPDATE
 16893*    END-EXEC.
 16894*    MOVE '&"S        EU         (   #00014859' TO DFHEIV0
 16895     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16896     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16897     MOVE X'2020233030303134383539' TO DFHEIV0(25:11)
 16898     CALL 'kxdfhei1' USING DFHEIV0,
 16899           FILE-ID-ERPNDB,
 16900           DFHEIV20,
 16901           DFHEIV99,
 16902           ERPNDB-KEY,
 16903           DFHEIV99,
 16904           DFHEIV99,
 16905           DFHEIV99
 16906     SET ADDRESS OF PENDING-BUSINESS TO
 16907         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 307
* EL6311.cbl
 16908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16909
 16910
 16911     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16912     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16913
 16914     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16915        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16916        MOVE 'D'                 TO JP-RECORD-TYPE
 16917        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16918
 16919* EXEC CICS DELETE
 16920*            DATASET    (FILE-ID-ERPNDB)
 16921*       END-EXEC
 16922*    MOVE '&(                    &   #00014873' TO DFHEIV0
 16923     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16924     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16925     MOVE X'2020233030303134383733' TO DFHEIV0(25:11)
 16926     CALL 'kxdfhei1' USING DFHEIV0,
 16927           FILE-ID-ERPNDB,
 16928           DFHEIV99,
 16929           DFHEIV99,
 16930           DFHEIV99,
 16931           DFHEIV99
 16932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16933        PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal BHDR Delete
 16934     ELSE
 16935        MOVE 'B'                 TO JP-RECORD-TYPE
 16936        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16937        PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 16938        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16939        MOVE 'C'                 TO JP-RECORD-TYPE
 16940        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16941
 16942* EXEC CICS REWRITE
 16943*            DATASET    (FILE-ID-ERPNDB)
 16944*            FROM       (PENDING-BUSINESS)
 16945*       END-EXEC
 16946     MOVE LENGTH OF
 16947      PENDING-BUSINESS
 16948       TO DFHEIV11
 16949*    MOVE '&& L                  %   #00014884' TO DFHEIV0
 16950     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16951     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16952     MOVE X'2020233030303134383834' TO DFHEIV0(25:11)
 16953     CALL 'kxdfhei1' USING DFHEIV0,
 16954           FILE-ID-ERPNDB,
 16955           PENDING-BUSINESS,
 16956           DFHEIV11,
 16957           DFHEIV99
 16958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16959        PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 16960     end-if
 16961
 16962******************************************************************
 16963*                                                                *
 16964*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16965*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 308
* EL6311.cbl
 16966*                                                                *
 16967******************************************************************
 16968
 16969     IF NOT PI-AR-PROCESSING
 16970        GO TO 2480-DELETE-FINISHED.
 16971
 16972     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16973        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16974        NEXT SENTENCE
 16975     ELSE
 16976        GO TO 2480-DELETE-FINISHED.
 16977
 16978
 16979* EXEC CICS HANDLE CONDITION
 16980*         NOTFND    (2480-DELETE-FINISHED)
 16981*    END-EXEC.
 16982*    MOVE '"$I                   ! < #00014907' TO DFHEIV0
 16983     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16984     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16985     MOVE X'3C20233030303134393037' TO DFHEIV0(25:11)
 16986     CALL 'kxdfhei1' USING DFHEIV0
 16987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16988
 16989
 16990     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16991     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16992
 16993
 16994* EXEC CICS READ
 16995*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16996*        DATASET (FILE-ID-ERRQST)
 16997*        RIDFLD  (ERRQST-KEY)
 16998*        UPDATE
 16999*    END-EXEC.
 17000*    MOVE '&"S        EU         (   #00014914' TO DFHEIV0
 17001     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17002     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17003     MOVE X'2020233030303134393134' TO DFHEIV0(25:11)
 17004     CALL 'kxdfhei1' USING DFHEIV0,
 17005           FILE-ID-ERRQST,
 17006           DFHEIV20,
 17007           DFHEIV99,
 17008           ERRQST-KEY,
 17009           DFHEIV99,
 17010           DFHEIV99,
 17011           DFHEIV99
 17012     SET ADDRESS OF AR-REQUEST-RECORD TO
 17013         DFHEIV20
 17014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17015
 17016
 17017     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17018
 17019     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 17020
 17021     MOVE 'D'                      TO JP-RECORD-TYPE.
 17022     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 17023
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 309
* EL6311.cbl
 17024
 17025* EXEC CICS DELETE
 17026*         DATASET    (FILE-ID-ERRQST)
 17027*    END-EXEC.
 17028*    MOVE '&(                    &   #00014928' TO DFHEIV0
 17029     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17030     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17031     MOVE X'2020233030303134393238' TO DFHEIV0(25:11)
 17032     CALL 'kxdfhei1' USING DFHEIV0,
 17033           FILE-ID-ERRQST,
 17034           DFHEIV99,
 17035           DFHEIV99,
 17036           DFHEIV99,
 17037           DFHEIV99
 17038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17039
 17040
 17041     PERFORM 8400-LOG-JOURNAL-RECORD.
 17042
 17043 2480-DELETE-FINISHED.
 17044     MOVE ZEROS                  TO EMI-ERROR.
 17045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17046     MOVE LOW-VALUES             TO EL631CI.
 17047     MOVE -1                     TO CMAINTL.
 17048     GO TO 8100-SEND-INITIAL-MAP.
 17049
 17050 2485-BATCH-HDR-NOT-FOUND.
 17051     MOVE -1                     TO CMAINTL
 17052     MOVE AL-UABON               TO CMAINTA.
 17053     MOVE ER-7450                TO EMI-ERROR.
 17054     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17055     GO TO 8200-SEND-DATAONLY.
 17056
 17057 2490-RECORD-NOT-FOUND.
 17058     MOVE -1                     TO CMAINTL
 17059     MOVE AL-UABON               TO CMAINTA.
 17060     MOVE ER-7451                TO EMI-ERROR.
 17061     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17062     GO TO 8200-SEND-DATAONLY.
 17063***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 17064***                                                            ***
 17065***     2500  B R O W S E   C H E C K S                        ***
 17066***  We perform this routine from 2 different places.          ***
 17067***  1. If the user changes the refund amount on a cancel, we  ***
 17068***    want to.........                                        ***
 17069***    a. determine if prior checks have been processed        ***
 17070***    b. If the amt is larger, display message instructing    ***
 17071***     them to create another check to make up the difference.***
 17072***    c. If the amt is less, do not allow the change and      ***
 17073***     display a FATAL error suggesting they deal with check  ***
 17074***     records befor continuing.                              ***
 17075***  2. If the user wants to delete a cancel record we......   ***
 17076***    a. browse through all the checks and if there is a      ***
 17077***     processed check, send FATAL message.                   ***
 17078***    b. If there is a non-released check, then delete that   ***
 17079***     check after you delete the pending cancel record.      ***
 17080***                                                            ***
 17081***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 310
* EL6311.cbl
 17082
 17083 2500-browse-checks.
 17084
 17085     perform 2510-startbr-erchek thru 2510-exit
 17086
 17087     if not resp-normal
 17088        go to 2500-exit
 17089     end-if
 17090
 17091     perform until i-say-stop
 17092        perform 2520-readnext-erchek
 17093                                 thru 2520-exit
 17094        if (not resp-normal)
 17095           or (pb-control-by-account (1:33) not =
 17096              ch-control-primary (1:33))
 17097              set i-say-stop to true
 17098        else
 17099           set i-have-a-check-period to true
 17100           if (ch-approval-status) = ' '
 17101              and (ch-void-dt = low-values)
 17102              and (ch-released-dt = low-values)
 17103              set i-have-checks to true
 17104           else
 17105              if ch-void-dt = low-values
 17106                 set i-have-processed-checks to true
 17107              end-if
 17108           end-if
 17109           if (ch-credit-accept-dt = low-values)
 17110              and (ch-void-dt = low-values)
 17111              and (ch-approval-status = ' ' OR 'P' OR 'A')
 17112              if (ch-check-origin-sw not = 'R')
 17113                 and (pb-record-type = '2')
 17114                 continue
 17115              else
 17116                 compute ws-check-amts =
 17117                    ws-check-amts + ch-amount-paid
 17118              end-if
 17119           end-if
 17120        end-if
 17121     end-perform
 17122
 17123     if ws-chek-browse-sw = 'Y'
 17124        perform 2525-endbr-erchek thru 2525-exit
 17125     end-if
 17126
 17127    .
 17128 2500-exit.
 17129     exit.
 17130
 17131 2510-startbr-erchek.
 17132
 17133     move pb-control-by-account  to erchek-key
 17134     move +0                     to chek-record-seq
 17135
 17136
 17137* exec cics startbr
 17138*       dataset   ('ERCHEK')
 17139*       ridfld    (erchek-key)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 311
* EL6311.cbl
 17140*       gteq
 17141*       resp      (ws-response)
 17142*    end-exec
 17143     MOVE 'ERCHEK' TO DFHEIV1
 17144     MOVE 0
 17145       TO DFHEIV11
 17146*    MOVE '&,         G          &  N#00015027' TO DFHEIV0
 17147     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17148     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17149     MOVE X'204E233030303135303237' TO DFHEIV0(25:11)
 17150     CALL 'kxdfhei1' USING DFHEIV0,
 17151           DFHEIV1,
 17152           erchek-key,
 17153           DFHEIV99,
 17154           DFHEIV11,
 17155           DFHEIV99
 17156     MOVE EIBRESP  TO ws-response
 17157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17158
 17159     IF RESP-NORMAL
 17160        move 'Y'                 to ws-chek-browse-sw
 17161     end-if
 17162
 17163     .
 17164 2510-exit.
 17165     exit.
 17166
 17167 2520-readnext-erchek.
 17168
 17169
 17170* EXEC CICS READNEXT
 17171*       SET     (ADDRESS OF CHECK-RECORDS)
 17172*       DATASET ('ERCHEK')
 17173*       RIDFLD  (ERCHEK-KEY)
 17174*       RESP    (WS-RESPONSE)
 17175*    END-EXEC
 17176     MOVE 'ERCHEK' TO DFHEIV1
 17177     MOVE 0
 17178       TO DFHEIV11
 17179*    MOVE '&.S                   )  N#00015044' TO DFHEIV0
 17180     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17181     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17182     MOVE X'204E233030303135303434' TO DFHEIV0(25:11)
 17183     CALL 'kxdfhei1' USING DFHEIV0,
 17184           DFHEIV1,
 17185           DFHEIV20,
 17186           DFHEIV99,
 17187           ERCHEK-KEY,
 17188           DFHEIV99,
 17189           DFHEIV11,
 17190           DFHEIV99,
 17191           DFHEIV99
 17192     SET ADDRESS OF CHECK-RECORDS TO
 17193         DFHEIV20
 17194     MOVE EIBRESP  TO WS-RESPONSE
 17195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17196
 17197     .
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 312
* EL6311.cbl
 17198 2520-exit.
 17199     exit.
 17200
 17201 2525-endbr-erchek.
 17202
 17203
 17204* exec cics endbr
 17205*       dataset  ('ERCHEK')
 17206*    end-exec
 17207     MOVE 'ERCHEK' TO DFHEIV1
 17208     MOVE 0
 17209       TO DFHEIV11
 17210*    MOVE '&2                    $   #00015057' TO DFHEIV0
 17211     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17212     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17213     MOVE X'2020233030303135303537' TO DFHEIV0(25:11)
 17214     CALL 'kxdfhei1' USING DFHEIV0,
 17215           DFHEIV1,
 17216           DFHEIV11,
 17217           DFHEIV99
 17218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17219
 17220     .
 17221 2525-exit.
 17222     exit.
 17223
 17224 2530-readupd-erchek.
 17225
 17226
 17227* EXEC CICS READ
 17228*       UPDATE
 17229*       SET     (ADDRESS OF CHECK-RECORDS)
 17230*       DATASET ('ERCHEK')
 17231*       RIDFLD  (ERCHEK-KEY)
 17232*       RESP    (WS-RESPONSE)
 17233*    END-EXEC
 17234     MOVE 'ERCHEK' TO DFHEIV1
 17235*    MOVE '&"S        EU         (  N#00015067' TO DFHEIV0
 17236     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17237     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17238     MOVE X'204E233030303135303637' TO DFHEIV0(25:11)
 17239     CALL 'kxdfhei1' USING DFHEIV0,
 17240           DFHEIV1,
 17241           DFHEIV20,
 17242           DFHEIV99,
 17243           ERCHEK-KEY,
 17244           DFHEIV99,
 17245           DFHEIV99,
 17246           DFHEIV99
 17247     SET ADDRESS OF CHECK-RECORDS TO
 17248         DFHEIV20
 17249     MOVE EIBRESP  TO WS-RESPONSE
 17250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17251
 17252     .
 17253 2530-exit.
 17254     exit.
 17255
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 313
* EL6311.cbl
 17256 2540-delete-erchek.
 17257
 17258
 17259* EXEC CICS DELETE
 17260*       DATASET ('ERCHEK')
 17261*       RESP    (WS-RESPONSE)
 17262*    END-EXEC
 17263     MOVE 'ERCHEK' TO DFHEIV1
 17264*    MOVE '&(                    &  N#00015081' TO DFHEIV0
 17265     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17266     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17267     MOVE X'204E233030303135303831' TO DFHEIV0(25:11)
 17268     CALL 'kxdfhei1' USING DFHEIV0,
 17269           DFHEIV1,
 17270           DFHEIV99,
 17271           DFHEIV99,
 17272           DFHEIV99,
 17273           DFHEIV99
 17274     MOVE EIBRESP  TO WS-RESPONSE
 17275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17276
 17277     .
 17278 2540-exit.
 17279     exit.
 17280***************************************************************
 17281*                                                             *
 17282*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17283*                                                             *
 17284***************************************************************
 17285
 17286***************************************************************
 17287*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17288*     AN ALREADY BILLED RECORD.                               *
 17289***************************************************************
 17290
 17291 2700-BUILD-CORRECTION-RECORD.
 17292     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17293     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17294     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17295     MOVE '5'                    TO DC-OPTION-CODE.
 17296     PERFORM 9700-DATE-LINK.
 17297     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17298
 17299     IF PB-CHG-COUNT = ZEROS
 17300        MOVE +1                  TO WS-SEQ-SAVE
 17301     ELSE
 17302        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17303
 17304     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17305     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17306
 17307     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17308
 17309     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17310     MOVE 'A'                    TO JP-RECORD-TYPE.
 17311     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17312
 17313
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 314
* EL6311.cbl
 17314* EXEC CICS WRITE
 17315*        DATASET    (FILE-ID-ERPNDB)
 17316*        FROM       (PENDING-BUSINESS)
 17317*        RIDFLD     (PB-CONTROL-PRIMARY)
 17318*    END-EXEC.
 17319     MOVE LENGTH OF
 17320      PENDING-BUSINESS
 17321       TO DFHEIV11
 17322*    MOVE '&$ L                  ''   #00015122' TO DFHEIV0
 17323     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17324     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17325     MOVE X'2020233030303135313232' TO DFHEIV0(25:11)
 17326     CALL 'kxdfhei1' USING DFHEIV0,
 17327           FILE-ID-ERPNDB,
 17328           PENDING-BUSINESS,
 17329           DFHEIV11,
 17330           PB-CONTROL-PRIMARY,
 17331           DFHEIV99,
 17332           DFHEIV99
 17333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17334
 17335
 17336     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17337
 17338     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Add
 17339     .
 17340 2799-EXIT.
 17341      EXIT.
 17342
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 315
* EL6311.cbl
 17344
 17345******************************************************************
 17346*                                                                *
 17347*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17348*                                                                *
 17349******************************************************************
 17350
 17351 2800-REWRITE-ISSUE-CERT-KEY.
 17352     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17353
 17354     IF  BCERTNOL GREATER THAN ZEROS
 17355         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17356
 17357     IF  BSUFIXL  GREATER THAN ZEROS
 17358         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17359
 17360     IF  BEFFDTL  GREATER THAN ZEROS
 17361         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17362
 17363 2810-READ-BY-ACCOUNT.
 17364
 17365* EXEC CICS HANDLE CONDITION
 17366*         NOTFND    (2820-PROCESS-REWRITE)
 17367*    END-EXEC.
 17368*    MOVE '"$I                   ! = #00015156' TO DFHEIV0
 17369     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17371     MOVE X'3D20233030303135313536' TO DFHEIV0(25:11)
 17372     CALL 'kxdfhei1' USING DFHEIV0
 17373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17374
 17375
 17376***  read pndb using new key
 17377
 17378* EXEC CICS READ
 17379*        SET     (ADDRESS OF PENDING-BUSINESS)
 17380*        DATASET (FILE-ID-ERPNDB2)
 17381*        RIDFLD  (ERPNDB-ALT-KEY)
 17382*    END-EXEC.
 17383*    MOVE '&"S        E          (   #00015161' TO DFHEIV0
 17384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17386     MOVE X'2020233030303135313631' TO DFHEIV0(25:11)
 17387     CALL 'kxdfhei1' USING DFHEIV0,
 17388           FILE-ID-ERPNDB2,
 17389           DFHEIV20,
 17390           DFHEIV99,
 17391           ERPNDB-ALT-KEY,
 17392           DFHEIV99,
 17393           DFHEIV99,
 17394           DFHEIV99
 17395     SET ADDRESS OF PENDING-BUSINESS TO
 17396         DFHEIV20
 17397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17398
 17399
 17400     GO TO 2890-DUPLICATE-RECORD.
 17401
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 316
* EL6311.cbl
 17402  2820-PROCESS-REWRITE.
 17403
 17404* EXEC CICS HANDLE CONDITION
 17405*         NOTFND    (2885-RECORD-MISSING)
 17406*    END-EXEC.
 17407*    MOVE '"$I                   ! > #00015170' TO DFHEIV0
 17408     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17409     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17410     MOVE X'3E20233030303135313730' TO DFHEIV0(25:11)
 17411     CALL 'kxdfhei1' USING DFHEIV0
 17412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17413
 17414
 17415     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17416
 17417***  read pndb using original key
 17418
 17419* EXEC CICS READ
 17420*        SET     (ADDRESS OF PENDING-BUSINESS)
 17421*        DATASET (FILE-ID-ERPNDB)
 17422*        RIDFLD  (ERPNDB-KEY)
 17423*        UPDATE
 17424*    END-EXEC.
 17425*    MOVE '&"S        EU         (   #00015177' TO DFHEIV0
 17426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17427     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17428     MOVE X'2020233030303135313737' TO DFHEIV0(25:11)
 17429     CALL 'kxdfhei1' USING DFHEIV0,
 17430           FILE-ID-ERPNDB,
 17431           DFHEIV20,
 17432           DFHEIV99,
 17433           ERPNDB-KEY,
 17434           DFHEIV99,
 17435           DFHEIV99,
 17436           DFHEIV99
 17437     SET ADDRESS OF PENDING-BUSINESS TO
 17438         DFHEIV20
 17439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17440
 17441
 17442     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17443     MOVE 'D'                    TO JP-RECORD-TYPE.
 17444     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17445     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17446
 17447     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17448
 17449     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17450     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17451     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17452
 17453***  delete pndb using original key
 17454
 17455* EXEC CICS DELETE
 17456*        DATASET    (FILE-ID-ERPNDB)
 17457*    END-EXEC.
 17458*    MOVE '&(                    &   #00015196' TO DFHEIV0
 17459     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 317
* EL6311.cbl
 17460     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17461     MOVE X'2020233030303135313936' TO DFHEIV0(25:11)
 17462     CALL 'kxdfhei1' USING DFHEIV0,
 17463           FILE-ID-ERPNDB,
 17464           DFHEIV99,
 17465           DFHEIV99,
 17466           DFHEIV99,
 17467           DFHEIV99
 17468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17469
 17470
 17471     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Delete
 17472
 17473
 17474* EXEC CICS GETMAIN
 17475*        SET      (ADDRESS OF PENDING-BUSINESS)
 17476*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17477*        INITIMG  (GETMAIN-SPACE)
 17478*    END-EXEC.
 17479*    MOVE ',"IL                  $   #00015202' TO DFHEIV0
 17480     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17481     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17482     MOVE X'2020233030303135323032' TO DFHEIV0(25:11)
 17483     CALL 'kxdfhei1' USING DFHEIV0,
 17484           DFHEIV20,
 17485           ERPNDB-RECORD-LENGTH,
 17486           GETMAIN-SPACE
 17487     SET ADDRESS OF PENDING-BUSINESS TO
 17488         DFHEIV20
 17489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17490
 17491
 17492***  pending-business now has original record
 17493     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17494
 17495
 17496* EXEC CICS HANDLE CONDITION
 17497*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17498*    END-EXEC.
 17499*    MOVE '"$I                   ! ? #00015211' TO DFHEIV0
 17500     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17502     MOVE X'3F20233030303135323131' TO DFHEIV0(25:11)
 17503     CALL 'kxdfhei1' USING DFHEIV0
 17504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17505
 17506
 17507***  read elcert using original key
 17508
 17509* EXEC CICS READ
 17510*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17511*        DATASET (FILE-ID-ELCERT)
 17512*        RIDFLD  (ELCERT-KEY)
 17513*        UPDATE
 17514*    END-EXEC.
 17515*    MOVE '&"S        EU         (   #00015216' TO DFHEIV0
 17516     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17517     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 318
* EL6311.cbl
 17518     MOVE X'2020233030303135323136' TO DFHEIV0(25:11)
 17519     CALL 'kxdfhei1' USING DFHEIV0,
 17520           FILE-ID-ELCERT,
 17521           DFHEIV20,
 17522           DFHEIV99,
 17523           ELCERT-KEY,
 17524           DFHEIV99,
 17525           DFHEIV99,
 17526           DFHEIV99
 17527     SET ADDRESS OF CERTIFICATE-MASTER TO
 17528         DFHEIV20
 17529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17530
 17531
 17532     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17533     MOVE 'B'                    TO JP-RECORD-TYPE
 17534     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17535     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17536
 17537     IF INSURED-ADDR-PRESENT
 17538        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17539
 17540     IF CERT-NOTES-ARE-NOT-PRESENT
 17541        MOVE SPACE               TO WS-CERT-NOTE-SW
 17542     ELSE
 17543        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17544
 17545     IF CERT-ADDED-BATCH      OR
 17546        CERT-AND-CLAIM-ONLINE OR
 17547        CERT-WAS-CREATED-FOR-CLAIM
 17548        NEXT SENTENCE
 17549     ELSE
 17550        GO TO 2825-DELETE-CERTIFICATE.
 17551
 17552     PERFORM 8400-LOG-JOURNAL-RECORD.
 17553
 17554*********************************************************
 17555** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17556     IF CERT-ADDED-BATCH
 17557         GO TO 2822-REWRITE-ELCERT.
 17558*********************************************************
 17559
 17560     IF NO-CLAIM-ATTACHED
 17561        NEXT SENTENCE
 17562     ELSE
 17563        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17564        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17565
 17566 2822-REWRITE-ELCERT.
 17567     MOVE 'C'                    TO JP-RECORD-TYPE
 17568     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17569
 17570     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17571
 17572
 17573* EXEC CICS REWRITE
 17574*         DATASET    (FILE-ID-ELCERT)
 17575*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 319
* EL6311.cbl
 17576*    END-EXEC.
 17577     MOVE LENGTH OF
 17578      CERTIFICATE-MASTER
 17579       TO DFHEIV11
 17580*    MOVE '&& L                  %   #00015263' TO DFHEIV0
 17581     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17582     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17583     MOVE X'2020233030303135323633' TO DFHEIV0(25:11)
 17584     CALL 'kxdfhei1' USING DFHEIV0,
 17585           FILE-ID-ELCERT,
 17586           CERTIFICATE-MASTER,
 17587           DFHEIV11,
 17588           DFHEIV99
 17589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17590
 17591
 17592     PERFORM 8400-LOG-JOURNAL-RECORD.
 17593
 17594     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17595
 17596 2825-DELETE-CERTIFICATE.
 17597     MOVE 'D'                      TO JP-RECORD-TYPE.
 17598     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA
 17599
 17600     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17601
 17602
 17603* EXEC CICS DELETE
 17604*         DATASET    (FILE-ID-ELCERT)
 17605*    END-EXEC.
 17606*    MOVE '&(                    &   #00015278' TO DFHEIV0
 17607     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17608     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17609     MOVE X'2020233030303135323738' TO DFHEIV0(25:11)
 17610     CALL 'kxdfhei1' USING DFHEIV0,
 17611           FILE-ID-ELCERT,
 17612           DFHEIV99,
 17613           DFHEIV99,
 17614           DFHEIV99,
 17615           DFHEIV99
 17616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17617
 17618
 17619     PERFORM 8400-LOG-JOURNAL-RECORD.
 17620
 17621******************************************************************
 17622*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17623******************************************************************
 17624
 17625     IF CERT-NOTES-ARE-PRESENT
 17626        NEXT SENTENCE
 17627     ELSE
 17628        GO TO 2827-DELETE-MAILING.
 17629
 17630
 17631* EXEC CICS HANDLE CONDITION
 17632*         NOTFND  (2827-DELETE-MAILING)
 17633*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 320
* EL6311.cbl
 17634*    MOVE '"$I                   ! @ #00015293' TO DFHEIV0
 17635     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17636     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17637     MOVE X'4020233030303135323933' TO DFHEIV0(25:11)
 17638     CALL 'kxdfhei1' USING DFHEIV0
 17639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17640
 17641
 17642
 17643* EXEC CICS READ
 17644*        EQUAL
 17645*        DATASET   (FILE-ID-ERNOTE)
 17646*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17647*        RIDFLD    (ELCERT-KEY)
 17648*        UPDATE
 17649*    END-EXEC.
 17650*    MOVE '&"S        EU         (   #00015297' TO DFHEIV0
 17651     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17652     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17653     MOVE X'2020233030303135323937' TO DFHEIV0(25:11)
 17654     CALL 'kxdfhei1' USING DFHEIV0,
 17655           FILE-ID-ERNOTE,
 17656           DFHEIV20,
 17657           DFHEIV99,
 17658           ELCERT-KEY,
 17659           DFHEIV99,
 17660           DFHEIV99,
 17661           DFHEIV99
 17662     SET ADDRESS OF CERTIFICATE-NOTE TO
 17663         DFHEIV20
 17664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17665
 17666
 17667     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17668     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17669     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17670
 17671     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17672
 17673
 17674* EXEC CICS DELETE
 17675*        DATASET   (FILE-ID-ERNOTE)
 17676*    END-EXEC.
 17677*    MOVE '&(                    &   #00015311' TO DFHEIV0
 17678     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17679     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17680     MOVE X'2020233030303135333131' TO DFHEIV0(25:11)
 17681     CALL 'kxdfhei1' USING DFHEIV0,
 17682           FILE-ID-ERNOTE,
 17683           DFHEIV99,
 17684           DFHEIV99,
 17685           DFHEIV99,
 17686           DFHEIV99
 17687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17688
 17689
 17690     PERFORM 8400-LOG-JOURNAL-RECORD.
 17691
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 321
* EL6311.cbl
 17692******************************************************************
 17693*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17694******************************************************************
 17695
 17696 2827-DELETE-MAILING.
 17697     IF CERT-ADDRESS-PRESENT
 17698        NEXT SENTENCE
 17699     ELSE
 17700        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17701
 17702
 17703* EXEC CICS HANDLE CONDITION
 17704*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17705*    END-EXEC.
 17706*    MOVE '"$I                   ! A #00015327' TO DFHEIV0
 17707     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17708     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17709     MOVE X'4120233030303135333237' TO DFHEIV0(25:11)
 17710     CALL 'kxdfhei1' USING DFHEIV0
 17711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17712
 17713
 17714     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17715
 17716
 17717* EXEC CICS READ
 17718*        EQUAL
 17719*        DATASET   (FILE-ID-ERMAIL)
 17720*        SET       (ADDRESS OF MAILING-DATA)
 17721*        RIDFLD    (ERMAIL-KEY)
 17722*        UPDATE
 17723*    END-EXEC.
 17724*    MOVE '&"S        EU         (   #00015333' TO DFHEIV0
 17725     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17726     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17727     MOVE X'2020233030303135333333' TO DFHEIV0(25:11)
 17728     CALL 'kxdfhei1' USING DFHEIV0,
 17729           FILE-ID-ERMAIL,
 17730           DFHEIV20,
 17731           DFHEIV99,
 17732           ERMAIL-KEY,
 17733           DFHEIV99,
 17734           DFHEIV99,
 17735           DFHEIV99
 17736     SET ADDRESS OF MAILING-DATA TO
 17737         DFHEIV20
 17738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17739
 17740
 17741     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17742     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17743     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17744
 17745     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17746
 17747
 17748* EXEC CICS DELETE
 17749*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 322
* EL6311.cbl
 17750*    END-EXEC.
 17751*    MOVE '&(                    &   #00015347' TO DFHEIV0
 17752     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17753     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17754     MOVE X'2020233030303135333437' TO DFHEIV0(25:11)
 17755     CALL 'kxdfhei1' USING DFHEIV0,
 17756           FILE-ID-ERMAIL,
 17757           DFHEIV99,
 17758           DFHEIV99,
 17759           DFHEIV99,
 17760           DFHEIV99
 17761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17762
 17763
 17764     PERFORM 8400-LOG-JOURNAL-RECORD.
 17765
 17766 2830-BUILD-NEW-ISSUE-RECORD.
 17767     MOVE SPACES                 TO ELCERT-KEY.
 17768
 17769     IF  BCERTNOL GREATER THAN ZEROS
 17770         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17771
 17772     IF  BSUFIXL  GREATER THAN ZEROS
 17773         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17774
 17775     IF BEFFDTL GREATER THAN ZEROS
 17776        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17777
 17778 2870-WRITE-PENDING-BUSINESS.
 17779     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17780     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17781     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17782     MOVE '5'                    TO DC-OPTION-CODE.
 17783     PERFORM 9700-DATE-LINK.
 17784     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17785
 17786     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17787
 17788     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17789     MOVE 'A'                    TO JP-RECORD-TYPE.
 17790     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17791
 17792
 17793* EXEC CICS WRITE
 17794*        DATASET  (FILE-ID-ERPNDB)
 17795*        FROM     (PENDING-BUSINESS)
 17796*        RIDFLD   (PB-CONTROL-PRIMARY)
 17797*    END-EXEC.
 17798     MOVE LENGTH OF
 17799      PENDING-BUSINESS
 17800       TO DFHEIV11
 17801*    MOVE '&$ L                  ''   #00015379' TO DFHEIV0
 17802     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17803     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17804     MOVE X'2020233030303135333739' TO DFHEIV0(25:11)
 17805     CALL 'kxdfhei1' USING DFHEIV0,
 17806           FILE-ID-ERPNDB,
 17807           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 323
* EL6311.cbl
 17808           DFHEIV11,
 17809           PB-CONTROL-PRIMARY,
 17810           DFHEIV99,
 17811           DFHEIV99
 17812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17813
 17814
 17815     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17816
 17817     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Issue Add
 17818
 17819     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17820
 17821 2885-RECORD-MISSING.
 17822     MOVE -1                     TO BMAINTL
 17823     MOVE AL-UABON               TO BMAINTA
 17824     MOVE ER-2902                TO EMI-ERROR.
 17825     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17826     GO TO 8200-SEND-DATAONLY.
 17827
 17828 2890-DUPLICATE-RECORD.
 17829     MOVE -1                     TO BMAINTL.
 17830     MOVE AL-UABON               TO BCERTNOA.
 17831     MOVE AL-UNBON               TO BEFFDTA.
 17832     MOVE SPACE                  TO BMAINTI.
 17833
 17834     MOVE 1                      TO EMI-SUB
 17835                                    EMI-SWITCH1
 17836                                    EMI-SWITCH-AREA-1
 17837                                    EMI-SWITCH-AREA-2.
 17838
 17839     MOVE SPACES                 TO EMI-ERROR-LINES.
 17840
 17841
 17842* EXEC CICS SYNCPOINT ROLLBACK
 17843*    END-EXEC.
 17844*    MOVE '6"R                   !   #00015411' TO DFHEIV0
 17845     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17847     MOVE X'2020233030303135343131' TO DFHEIV0(25:11)
 17848     CALL 'kxdfhei1' USING DFHEIV0
 17849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17850
 17851
 17852     MOVE ER-2247                TO EMI-ERROR.
 17853     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17854     GO TO 8200-SEND-DATAONLY.
 17855
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 324
* EL6311.cbl
 17857
 17858******************************************************************
 17859*                                                                *
 17860*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17861*                                                                *
 17862******************************************************************
 17863
 17864 2900-REWRITE-CAN-CERT-KEY.
 17865     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17866
 17867     IF  CCERTNOL GREATER THAN ZEROS
 17868         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17869
 17870     IF  CSUFIXL  GREATER THAN ZEROS
 17871         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17872
 17873     IF  CEFFDTL  GREATER THAN ZEROS
 17874         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17875
 17876 2910-READ-BY-ACCOUNT.
 17877
 17878* EXEC CICS HANDLE CONDITION
 17879*         NOTFND    (2920-PROCESS-REWRITE)
 17880*    END-EXEC.
 17881*    MOVE '"$I                   ! B #00015439' TO DFHEIV0
 17882     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17883     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17884     MOVE X'4220233030303135343339' TO DFHEIV0(25:11)
 17885     CALL 'kxdfhei1' USING DFHEIV0
 17886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17887
 17888
 17889
 17890* EXEC CICS READ
 17891*        SET     (ADDRESS OF PENDING-BUSINESS)
 17892*        DATASET (FILE-ID-ERPNDB2)
 17893*        RIDFLD  (ERPNDB-ALT-KEY)
 17894*    END-EXEC.
 17895*    MOVE '&"S        E          (   #00015443' TO DFHEIV0
 17896     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17898     MOVE X'2020233030303135343433' TO DFHEIV0(25:11)
 17899     CALL 'kxdfhei1' USING DFHEIV0,
 17900           FILE-ID-ERPNDB2,
 17901           DFHEIV20,
 17902           DFHEIV99,
 17903           ERPNDB-ALT-KEY,
 17904           DFHEIV99,
 17905           DFHEIV99,
 17906           DFHEIV99
 17907     SET ADDRESS OF PENDING-BUSINESS TO
 17908         DFHEIV20
 17909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17910
 17911
 17912     GO TO 2990-DUPLICATE-RECORD.
 17913
 17914  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 325
* EL6311.cbl
 17915
 17916* EXEC CICS HANDLE CONDITION
 17917*         NOTFND    (2985-RECORD-MISSING)
 17918*    END-EXEC.
 17919*    MOVE '"$I                   ! C #00015452' TO DFHEIV0
 17920     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17922     MOVE X'4320233030303135343532' TO DFHEIV0(25:11)
 17923     CALL 'kxdfhei1' USING DFHEIV0
 17924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17925
 17926
 17927     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17928
 17929
 17930* EXEC CICS READ
 17931*        SET     (ADDRESS OF PENDING-BUSINESS)
 17932*        DATASET (FILE-ID-ERPNDB)
 17933*        RIDFLD  (ERPNDB-KEY)
 17934*        UPDATE
 17935*    END-EXEC.
 17936*    MOVE '&"S        EU         (   #00015458' TO DFHEIV0
 17937     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17938     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17939     MOVE X'2020233030303135343538' TO DFHEIV0(25:11)
 17940     CALL 'kxdfhei1' USING DFHEIV0,
 17941           FILE-ID-ERPNDB,
 17942           DFHEIV20,
 17943           DFHEIV99,
 17944           ERPNDB-KEY,
 17945           DFHEIV99,
 17946           DFHEIV99,
 17947           DFHEIV99
 17948     SET ADDRESS OF PENDING-BUSINESS TO
 17949         DFHEIV20
 17950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17951
 17952
 17953     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17954     MOVE 'D'                    TO JP-RECORD-TYPE.
 17955     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17956     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17957
 17958     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17959
 17960     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17961     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17962     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17963
 17964
 17965* EXEC CICS DELETE
 17966*        DATASET    (FILE-ID-ERPNDB)
 17967*    END-EXEC.
 17968*    MOVE '&(                    &   #00015476' TO DFHEIV0
 17969     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17971     MOVE X'2020233030303135343736' TO DFHEIV0(25:11)
 17972     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 326
* EL6311.cbl
 17973           FILE-ID-ERPNDB,
 17974           DFHEIV99,
 17975           DFHEIV99,
 17976           DFHEIV99,
 17977           DFHEIV99
 17978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17979
 17980
 17981     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Delete
 17982
 17983
 17984* EXEC CICS GETMAIN
 17985*        SET      (ADDRESS OF PENDING-BUSINESS)
 17986*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17987*        INITIMG  (GETMAIN-SPACE)
 17988*    END-EXEC.
 17989*    MOVE ',"IL                  $   #00015482' TO DFHEIV0
 17990     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17991     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17992     MOVE X'2020233030303135343832' TO DFHEIV0(25:11)
 17993     CALL 'kxdfhei1' USING DFHEIV0,
 17994           DFHEIV20,
 17995           ERPNDB-RECORD-LENGTH,
 17996           GETMAIN-SPACE
 17997     SET ADDRESS OF PENDING-BUSINESS TO
 17998         DFHEIV20
 17999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18000
 18001
 18002     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 18003
 18004 2950-PROCESS-CANCELS.
 18005
 18006
 18007* EXEC CICS HANDLE CONDITION
 18008*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 18009*    END-EXEC.
 18010*    MOVE '"$I                   ! D #00015492' TO DFHEIV0
 18011     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18013     MOVE X'4420233030303135343932' TO DFHEIV0(25:11)
 18014     CALL 'kxdfhei1' USING DFHEIV0
 18015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18016
 18017
 18018
 18019* EXEC CICS READ
 18020*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 18021*        DATASET (FILE-ID-ELCERT)
 18022*        RIDFLD  (ELCERT-KEY)
 18023*        UPDATE
 18024*    END-EXEC.
 18025*    MOVE '&"S        EU         (   #00015496' TO DFHEIV0
 18026     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18027     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18028     MOVE X'2020233030303135343936' TO DFHEIV0(25:11)
 18029     CALL 'kxdfhei1' USING DFHEIV0,
 18030           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 327
* EL6311.cbl
 18031           DFHEIV20,
 18032           DFHEIV99,
 18033           ELCERT-KEY,
 18034           DFHEIV99,
 18035           DFHEIV99,
 18036           DFHEIV99
 18037     SET ADDRESS OF CERTIFICATE-MASTER TO
 18038         DFHEIV20
 18039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18040
 18041
 18042     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 18043
 18044     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 18045     MOVE 'B'                      TO JP-RECORD-TYPE.
 18046     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 18047     PERFORM 8400-LOG-JOURNAL-RECORD.
 18048
 18049     IF PB-CI-LIVES NOT NUMERIC
 18050         MOVE ZERO                    TO PB-CI-LIVES.
 18051
 18052     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 18053        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18054        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 18055        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 18056                                         CM-LF-CANCEL-DT
 18057     ELSE
 18058        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18059        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 18060        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 18061        MOVE PB-CI-LIVES              TO CM-LIVES.
 18062
 18063     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 18064        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 18065            MOVE CM-LF-STATUS-AT-CANCEL
 18066                                     TO CM-LF-CURRENT-STATUS
 18067            MOVE SPACE
 18068                                     TO CM-LF-STATUS-AT-CANCEL
 18069        ELSE
 18070            MOVE PB-CI-LF-POLICY-STATUS
 18071                                     TO CM-LF-CURRENT-STATUS
 18072     ELSE
 18073        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 18074
 18075     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 18076        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18077        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 18078        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 18079                                         CM-AH-CANCEL-DT
 18080     ELSE
 18081        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18082        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 18083        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 18084        MOVE PB-CI-LIVES              TO CM-LIVES.
 18085
 18086     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 18087        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 18088            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 328
* EL6311.cbl
 18089                                     TO CM-AH-CURRENT-STATUS
 18090            MOVE SPACE
 18091                                     TO CM-AH-STATUS-AT-CANCEL
 18092        ELSE
 18093            MOVE PB-CI-AH-POLICY-STATUS
 18094                                     TO CM-AH-CURRENT-STATUS
 18095     ELSE
 18096        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 18097
 18098 2975-REWRITE-CERT.
 18099     MOVE 'C'                      TO JP-RECORD-TYPE.
 18100     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 18101
 18102
 18103* EXEC CICS REWRITE
 18104*        DATASET    (FILE-ID-ELCERT)
 18105*        FROM       (CERTIFICATE-MASTER)
 18106*    END-EXEC.
 18107     MOVE LENGTH OF
 18108      CERTIFICATE-MASTER
 18109       TO DFHEIV11
 18110*    MOVE '&& L                  %   #00015563' TO DFHEIV0
 18111     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18112     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18113     MOVE X'2020233030303135353633' TO DFHEIV0(25:11)
 18114     CALL 'kxdfhei1' USING DFHEIV0,
 18115           FILE-ID-ELCERT,
 18116           CERTIFICATE-MASTER,
 18117           DFHEIV11,
 18118           DFHEIV99
 18119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18120
 18121
 18122     PERFORM 8400-LOG-JOURNAL-RECORD.
 18123
 18124 2960-BUILD-NEW-CANCEL-RECORD.
 18125     IF  CCERTNOL GREATER THAN ZEROS
 18126         MOVE CCERTNOI            TO PB-CERT-PRIME.
 18127
 18128     IF  CSUFIXL  GREATER THAN ZEROS
 18129         MOVE CSUFIXI             TO PB-CERT-SFX.
 18130
 18131     IF  CEFFDTL  GREATER  THAN ZEROS
 18132         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 18133
 18134 2970-WRITE-PENDING-BUSINESS.
 18135     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 18136     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 18137     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 18138     MOVE '5'                    TO DC-OPTION-CODE.
 18139     PERFORM 9700-DATE-LINK.
 18140     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 18141
 18142     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 18143
 18144     MOVE SPACES                 TO PB-CI-INSURED-NAME
 18145                                    PB-CI-INSURED-SEX
 18146                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 329
* EL6311.cbl
 18147                                    PB-CI-AH-BENEFIT-CD
 18148                                    PB-CI-RATE-CLASS
 18149                                    PB-CI-RATE-DEV-LF
 18150                                    PB-CI-RATE-DEV-AH
 18151                                    PB-CI-LF-ABBR
 18152                                    PB-CI-AH-ABBR
 18153                                    PB-CI-OB-FLAG
 18154                                    PB-CI-LF-POLICY-STATUS
 18155                                    PB-CI-AH-POLICY-STATUS
 18156                                    PB-CI-INDV-GRP-CD
 18157                                    PB-CI-BENEFICIARY-NAME
 18158                                    PB-CI-NOTE-SW
 18159                                    PB-CI-SOC-SEC-NO
 18160                                    PB-CI-MEMBER-NO
 18161                                    PB-CI-INT-CODE
 18162                                    PB-CI-COMP-EXCP-SW
 18163                                    PB-CI-ENTRY-STATUS
 18164                                    PB-CI-CREDIT-INTERFACE-SW-1
 18165                                    PB-CI-CREDIT-INTERFACE-SW-2
 18166                                    PB-CI-ENTRY-BATCH.
 18167
 18168     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 18169                                    PB-CI-AH-SETTLEMENT-DT
 18170                                    PB-CI-DEATH-DT
 18171                                    PB-CI-LF-PRIOR-CANCEL-DT
 18172                                    PB-CI-AH-PRIOR-CANCEL-DT
 18173                                    PB-CI-LOAN-1ST-PMT-DT
 18174                                    PB-CI-ENTRY-DT
 18175                                    PB-CI-LF-EXPIRE-DT
 18176                                    PB-CI-AH-EXPIRE-DT.
 18177
 18178     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 18179                                    PB-CI-LF-TERM
 18180                                    PB-CI-LF-BENEFIT-AMT
 18181                                    PB-CI-LF-ALT-BENEFIT-AMT
 18182                                    PB-CI-LF-PREMIUM-AMT
 18183                                    PB-CI-LF-ALT-PREMIUM-AMT
 18184                                    PB-CI-AH-TERM
 18185                                    PB-CI-AH-BENEFIT-AMT
 18186                                    PB-CI-AH-PREMIUM-AMT
 18187                                    PB-CI-RATE-DEV-PCT-LF
 18188                                    PB-CI-RATE-DEV-PCT-AH
 18189                                    PB-CI-LIFE-COMMISSION
 18190                                    PB-CI-AH-COMMISSION
 18191                                    PB-CI-PAY-FREQUENCY
 18192                                    PB-CI-LOAN-APR
 18193                                    PB-CI-LOAN-TERM
 18194                                    PB-CI-CURR-SEQ
 18195                                    PB-CI-AH-CANCEL-AMT
 18196                                    PB-CI-LF-CANCEL-AMT
 18197                                    PB-CI-EXTENTION-DAYS
 18198                                    PB-CI-TERM-IN-DAYS
 18199                                    PB-CI-LOAN-OFFICER
 18200                                    PB-CI-LIVES
 18201                                    PB-CI-LF-CRIT-PER
 18202                                    PB-CI-AH-CRIT-PER
 18203                                    PB-C-LF-REM-TERM
 18204                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 330
* EL6311.cbl
 18205
 18206     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 18207     MOVE 'A'                    TO JP-RECORD-TYPE.
 18208     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18209
 18210
 18211* EXEC CICS HANDLE CONDITION
 18212*        DUPREC   (2990-DUPLICATE-RECORD)
 18213*    END-EXEC.
 18214*    MOVE '"$%                   ! E #00015656' TO DFHEIV0
 18215     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18217     MOVE X'4520233030303135363536' TO DFHEIV0(25:11)
 18218     CALL 'kxdfhei1' USING DFHEIV0
 18219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18220
 18221
 18222
 18223* EXEC CICS WRITE
 18224*        DATASET  (FILE-ID-ERPNDB)
 18225*        FROM     (PENDING-BUSINESS)
 18226*        RIDFLD   (PB-CONTROL-PRIMARY)
 18227*    END-EXEC.
 18228     MOVE LENGTH OF
 18229      PENDING-BUSINESS
 18230       TO DFHEIV11
 18231*    MOVE '&$ L                  ''   #00015660' TO DFHEIV0
 18232     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18233     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18234     MOVE X'2020233030303135363630' TO DFHEIV0(25:11)
 18235     CALL 'kxdfhei1' USING DFHEIV0,
 18236           FILE-ID-ERPNDB,
 18237           PENDING-BUSINESS,
 18238           DFHEIV11,
 18239           PB-CONTROL-PRIMARY,
 18240           DFHEIV99,
 18241           DFHEIV99
 18242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18243
 18244
 18245     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 18246
 18247     PERFORM 8400-LOG-JOURNAL-RECORD  *> Journal Cancel Add
 18248
 18249     GO TO 2325-PROCESS-CANCEL-CHANGES.
 18250
 18251 2985-RECORD-MISSING.
 18252     MOVE -1                     TO CMAINTL
 18253     MOVE AL-UABON               TO CMAINTA.
 18254
 18255     MOVE ER-2902                TO EMI-ERROR.
 18256     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18257     GO TO 8200-SEND-DATAONLY.
 18258
 18259 2990-DUPLICATE-RECORD.
 18260     MOVE SPACE                  TO CMAINTI.
 18261     MOVE -1                     TO CMAINTL.
 18262     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 331
* EL6311.cbl
 18263     MOVE AL-UNBON               TO CEFFDTA.
 18264
 18265     MOVE 1                      TO EMI-SUB
 18266                                    EMI-SWITCH1
 18267                                    EMI-SWITCH-AREA-1
 18268                                    EMI-SWITCH-AREA-2.
 18269     MOVE SPACES                 TO EMI-ERROR-LINES.
 18270
 18271
 18272* EXEC CICS SYNCPOINT ROLLBACK
 18273*    END-EXEC.
 18274*    MOVE '6"R                   !   #00015692' TO DFHEIV0
 18275     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18277     MOVE X'2020233030303135363932' TO DFHEIV0(25:11)
 18278     CALL 'kxdfhei1' USING DFHEIV0
 18279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18280
 18281
 18282     MOVE ER-2247                TO EMI-ERROR.
 18283     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18284     GO TO 8200-SEND-DATAONLY.
 18285
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 332
* EL6311.cbl
 18287
 18288***************************************************************
 18289*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 18290*     PREMIUM FOR A SINGLE BATCH.                             *
 18291*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 18292***************************************************************
 18293
 18294 3000-BATCH-MAINLINE.
 18295     IF PI-PREV-KEY NOT = SPACES
 18296         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 18297     ELSE
 18298         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 18299
 18300     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 18301
 18302 3010-READNEXT.
 18303
 18304* EXEC CICS READ
 18305*         DATASET    (FILE-ID-ERPNDB)
 18306*         SET        (ADDRESS OF PENDING-BUSINESS)
 18307*         RIDFLD     (ERPNDB-KEY)
 18308*         GTEQ
 18309*    END-EXEC.
 18310*    MOVE '&"S        G          (   #00015716' TO DFHEIV0
 18311     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18312     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18313     MOVE X'2020233030303135373136' TO DFHEIV0(25:11)
 18314     CALL 'kxdfhei1' USING DFHEIV0,
 18315           FILE-ID-ERPNDB,
 18316           DFHEIV20,
 18317           DFHEIV99,
 18318           ERPNDB-KEY,
 18319           DFHEIV99,
 18320           DFHEIV99,
 18321           DFHEIV99
 18322     SET ADDRESS OF PENDING-BUSINESS TO
 18323         DFHEIV20
 18324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18325
 18326
 18327     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 18328        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 18329          GO TO 3030-END-BATCH.
 18330
 18331     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 18332
 18333     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 18334        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18335          GO TO 3020-BUMP-SEQ.
 18336
 18337     IF PB-ISSUE
 18338        ADD +1                   TO WS-ISS-TOTAL-CNT
 18339        IF PB-FATAL-ERRORS
 18340           ADD +1                      TO WS-ISS-FATAL-CNT
 18341           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18342           GO TO 3020-BUMP-SEQ
 18343        ELSE
 18344           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 333
* EL6311.cbl
 18345              ADD +1                      TO WS-ISS-FORCE-CNT
 18346              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18347              GO TO 3020-BUMP-SEQ
 18348           ELSE
 18349              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18350                 ADD +1                      TO WS-ISS-HOLD-CNT
 18351                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18352                 GO TO 3020-BUMP-SEQ
 18353              ELSE
 18354                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18355                     THRU  3299-EXIT
 18356                 GO TO 3020-BUMP-SEQ.
 18357
 18358     IF PB-CANCELLATION
 18359        ADD +1                   TO WS-CAN-TOTAL-CNT
 18360        IF PB-FATAL-ERRORS
 18361           ADD +1                 TO WS-CAN-FATAL-CNT
 18362           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18363           GO TO 3020-BUMP-SEQ
 18364        ELSE
 18365           IF PB-UNFORCED-ERRORS
 18366              ADD +1                 TO WS-CAN-FORCE-CNT
 18367              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18368              GO TO 3020-BUMP-SEQ
 18369           ELSE
 18370              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18371                 ADD +1                 TO WS-CAN-HOLD-CNT
 18372                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18373                 GO TO 3020-BUMP-SEQ
 18374              ELSE
 18375                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18376                     THRU  3499-EXIT
 18377                 GO TO 3020-BUMP-SEQ.
 18378
 18379     IF PB-BATCH-TRAILER
 18380         GO TO 3030-END-BATCH.
 18381
 18382 3020-BUMP-SEQ.
 18383     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18384     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18385     GO TO 3010-READNEXT.
 18386
 18387 3030-END-BATCH.
 18388     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18389     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18390     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18391     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18392
 18393     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18394                                          - WS-ISS-FORCE-CNT
 18395                                          - WS-ISS-HOLD-CNT).
 18396
 18397     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18398     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18399
 18400     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18401     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18402     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 334
* EL6311.cbl
 18403     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18404     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18405                                          - WS-CAN-FORCE-CNT
 18406                                          - WS-CAN-HOLD-CNT).
 18407     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18408     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18409
 18410     COMPUTE WS-NET-TOTAL-CNT
 18411         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18412     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18413     COMPUTE WS-NET-FATAL-CNT
 18414         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18415     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18416     COMPUTE WS-NET-FORCE-CNT
 18417         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18418     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18419     COMPUTE WS-NET-HOLD-CNT
 18420         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18421     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18422
 18423     COMPUTE WS-NET-AVAIL-CNT
 18424          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18425                              - WS-ISS-FORCE-CNT
 18426                              - WS-ISS-HOLD-CNT)
 18427          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18428                              - WS-CAN-FORCE-CNT
 18429                              - WS-CAN-HOLD-CNT).
 18430     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18431
 18432     COMPUTE WS-NET-GOOD-PREM
 18433         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18434     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18435     COMPUTE WS-NET-BAD-PREM
 18436         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18437     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18438
 18439     MOVE 0000                   TO EMI-ERROR.
 18440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18441     MOVE -1                     TO DPFENTRL.
 18442     GO TO 8200-SEND-DATAONLY.
 18443
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 335
* EL6311.cbl
 18445
 18446******************************************************************
 18447*                                                                *
 18448*           A D D    B A D   I S S U E   P R E M I U M           *
 18449*                                                                *
 18450******************************************************************
 18451
 18452 3100-ADD-BAD-ISSUE-PREM.
 18453     IF PB-OVERRIDE-LIFE
 18454       OR PB-OVERRIDE-BOTH
 18455           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18456           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18457       ELSE
 18458           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18459           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18460
 18461     IF PB-OVERRIDE-AH
 18462       OR PB-OVERRIDE-BOTH
 18463           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18464       ELSE
 18465           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18466
 18467 3199-EXIT.
 18468     EXIT.
 18469
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 336
* EL6311.cbl
 18471
 18472******************************************************************
 18473*                                                                *
 18474*       A D D   G O O D   I S S U E   P R E M I U M              *
 18475*                                                                *
 18476******************************************************************
 18477
 18478 3200-ADD-GOOD-ISSUE-PREM.
 18479     IF PB-OVERRIDE-LIFE
 18480       OR PB-OVERRIDE-BOTH
 18481           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18482           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18483       ELSE
 18484           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18485           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18486
 18487     IF PB-OVERRIDE-AH
 18488       OR PB-OVERRIDE-BOTH
 18489           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18490       ELSE
 18491           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18492
 18493 3299-EXIT.
 18494     EXIT.
 18495
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 337
* EL6311.cbl
 18497
 18498
 18499******************************************************************
 18500*                                                                *
 18501*        A D D   B A D   C A N C E L   P R E M I U M             *
 18502*                                                                *
 18503******************************************************************
 18504
 18505 3300-ADD-BAD-CANCEL-PREM.
 18506     IF PB-OVERRIDE-LIFE
 18507       OR PB-OVERRIDE-BOTH
 18508           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18509       ELSE
 18510           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18511
 18512     IF PB-OVERRIDE-AH
 18513       OR PB-OVERRIDE-BOTH
 18514           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18515       ELSE
 18516           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18517
 18518 3399-EXIT.
 18519     EXIT.
 18520
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 338
* EL6311.cbl
 18522
 18523******************************************************************
 18524*                                                                *
 18525*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18526*                                                                *
 18527******************************************************************
 18528
 18529 3400-ADD-GOOD-CANCEL-PREM.
 18530     IF PB-OVERRIDE-LIFE
 18531       OR PB-OVERRIDE-BOTH
 18532           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18533       ELSE
 18534           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18535
 18536     IF PB-OVERRIDE-AH
 18537       OR PB-OVERRIDE-BOTH
 18538           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18539       ELSE
 18540           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18541
 18542 3499-EXIT.
 18543     EXIT.
 18544
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 339
* EL6311.cbl
 18546
 18547******************************************************************
 18548*                                                                *
 18549*           E D I T   B A T C H   D A T A                        *
 18550*                                                                *
 18551******************************************************************
 18552
 18553 3500-EDIT-BATCH-DATA.
 18554     IF PI-PREV-KEY NOT = SPACES
 18555        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18556     ELSE
 18557        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18558
 18559     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18560     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18561
 18562
 18563* EXEC CICS HANDLE CONDITION
 18564*         NOTFND      (3590-NOT-FOUND)
 18565*    END-EXEC.
 18566*    MOVE '"$I                   ! F #00015958' TO DFHEIV0
 18567     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18569     MOVE X'4620233030303135393538' TO DFHEIV0(25:11)
 18570     CALL 'kxdfhei1' USING DFHEIV0
 18571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18572
 18573
 18574     IF DRISSL   GREATER THAN ZEROS OR
 18575        DRISSL   GREATER THAN ZEROS OR
 18576        DRLFPRML GREATER THAN ZEROS OR
 18577        DRAHPRML GREATER THAN ZEROS OR
 18578        DRCANCL  GREATER THAN ZEROS OR
 18579        DRLFRFDL GREATER THAN ZEROS OR
 18580        DRAHRFDL GREATER THAN ZEROS
 18581              NEXT SENTENCE
 18582          ELSE
 18583              MOVE ER-3224    TO EMI-ERROR
 18584              MOVE -1         TO DPFENTRL
 18585              MOVE AL-UNBON   TO DPFENTRA
 18586              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18587              GO TO 8200-SEND-DATAONLY.
 18588
 18589     IF NOT MODIFY-CAP
 18590         MOVE 'UPDATE'       TO SM-READ
 18591         PERFORM 9995-SECURITY-VIOLATION
 18592         MOVE ER-0070        TO EMI-ERROR
 18593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18594         GO TO 8100-SEND-INITIAL-MAP.
 18595
 18596        IF DRISSL GREATER THAN ZEROS
 18597           MOVE AL-UNNON         TO DRISSA
 18598           MOVE DRISSI           TO DEEDIT-FIELD
 18599           PERFORM 8600-DEEDIT
 18600           IF DEEDIT-FIELD-V0  NUMERIC
 18601              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18602           ELSE
 18603              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 340
* EL6311.cbl
 18604              MOVE -1         TO DRISSL
 18605              MOVE AL-UNBON   TO DRISSA
 18606              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18607
 18608        IF DRLFPRML GREATER THAN ZEROS
 18609           MOVE AL-UNNON         TO DRLFPRMA
 18610
 18611* EXEC CICS BIF DEEDIT
 18612*              FIELD  (DRLFPRMI)
 18613*              LENGTH (11)
 18614*          END-EXEC
 18615     MOVE 11
 18616       TO DFHEIV11
 18617*    MOVE '@"L                   #   #00015998' TO DFHEIV0
 18618     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18619     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18620     MOVE X'2020233030303135393938' TO DFHEIV0(25:11)
 18621     CALL 'kxdfhei1' USING DFHEIV0,
 18622           DRLFPRMI,
 18623           DFHEIV11
 18624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18625           IF DRLFPRMI NUMERIC
 18626              MOVE DRLFPRMI   TO WS-DRLFPRM
 18627*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18628*          PERFORM 8600-DEEDIT
 18629*          IF DEEDIT-FIELD-V2  NUMERIC
 18630*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18631           ELSE
 18632              MOVE ER-2223    TO EMI-ERROR
 18633              MOVE -1         TO DRLFPRML
 18634              MOVE AL-UNBON   TO DRLFPRMA
 18635              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18636
 18637        IF DRAHPRML GREATER THAN ZEROS
 18638           MOVE AL-UNNON         TO DRAHPRMA
 18639
 18640* EXEC CICS BIF DEEDIT
 18641*              FIELD  (DRAHPRMI)
 18642*              LENGTH (11)
 18643*          END-EXEC
 18644     MOVE 11
 18645       TO DFHEIV11
 18646*    MOVE '@"L                   #   #00016016' TO DFHEIV0
 18647     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18648     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18649     MOVE X'2020233030303136303136' TO DFHEIV0(25:11)
 18650     CALL 'kxdfhei1' USING DFHEIV0,
 18651           DRAHPRMI,
 18652           DFHEIV11
 18653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18654           IF DRAHPRMI NUMERIC
 18655              MOVE DRAHPRMI   TO WS-DRAHPRM
 18656*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18657*          PERFORM 8600-DEEDIT
 18658*          IF DEEDIT-FIELD-V2  NUMERIC
 18659*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18660           ELSE
 18661              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 341
* EL6311.cbl
 18662              MOVE -1         TO DRAHPRML
 18663              MOVE AL-UNBON   TO DRAHPRMA
 18664              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18665
 18666        IF DRCANCL GREATER THAN ZEROS
 18667           MOVE AL-UNNON         TO DRCANCA
 18668           MOVE DRCANCI          TO DEEDIT-FIELD
 18669           PERFORM 8600-DEEDIT
 18670           IF DEEDIT-FIELD-V0  NUMERIC
 18671              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18672           ELSE
 18673              MOVE ER-2223    TO EMI-ERROR
 18674              MOVE -1         TO DRCANCL
 18675              MOVE AL-UNBON   TO DRCANCL
 18676              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18677
 18678        IF DRLFRFDL GREATER THAN ZEROS
 18679           MOVE AL-UNNON         TO DRLFRFDA
 18680
 18681* EXEC CICS BIF DEEDIT
 18682*              FIELD  (DRLFRFDI)
 18683*              LENGTH (11)
 18684*          END-EXEC
 18685     MOVE 11
 18686       TO DFHEIV11
 18687*    MOVE '@"L                   #   #00016046' TO DFHEIV0
 18688     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18689     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18690     MOVE X'2020233030303136303436' TO DFHEIV0(25:11)
 18691     CALL 'kxdfhei1' USING DFHEIV0,
 18692           DRLFRFDI,
 18693           DFHEIV11
 18694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18695           IF DRLFRFDI NUMERIC
 18696              MOVE DRLFRFDI   TO WS-DRLFRFD
 18697*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18698*          PERFORM 8600-DEEDIT
 18699*          IF DEEDIT-FIELD-V2  NUMERIC
 18700*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18701           ELSE
 18702              MOVE ER-2223    TO EMI-ERROR
 18703              MOVE -1         TO DRLFRFDL
 18704              MOVE AL-UNBON   TO DRLFRFDA
 18705              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18706
 18707        IF DRAHRFDL GREATER THAN ZEROS
 18708           MOVE AL-UNNON         TO DRAHRFDA
 18709
 18710* EXEC CICS BIF DEEDIT
 18711*              FIELD  (DRAHRFDI)
 18712*              LENGTH (11)
 18713*          END-EXEC
 18714     MOVE 11
 18715       TO DFHEIV11
 18716*    MOVE '@"L                   #   #00016064' TO DFHEIV0
 18717     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18718     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18719     MOVE X'2020233030303136303634' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 342
* EL6311.cbl
 18720     CALL 'kxdfhei1' USING DFHEIV0,
 18721           DRAHRFDI,
 18722           DFHEIV11
 18723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18724           IF DRAHRFDI NUMERIC
 18725              MOVE DRAHRFDI   TO WS-DRAHRFD
 18726*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18727*          PERFORM 8600-DEEDIT
 18728*          IF DEEDIT-FIELD-V2  NUMERIC
 18729*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18730           ELSE
 18731              MOVE ER-2223    TO EMI-ERROR
 18732              MOVE -1         TO DRAHRFDL
 18733              MOVE AL-UNBON   TO DRAHRFDA
 18734              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18735
 18736     IF EMI-ERROR = ZEROS
 18737        GO 3600-UPDATE-BATCH-HEADER.
 18738
 18739     GO TO 8200-SEND-DATAONLY.
 18740
 18741 3590-NOT-FOUND.
 18742     MOVE ER-2192                TO EMI-ERROR.
 18743     MOVE -1                     TO DPFENTRL.
 18744     MOVE AL-UNBON               TO DPFENTRA.
 18745     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18746     GO TO 8200-SEND-DATAONLY.
 18747
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 343
* EL6311.cbl
 18749
 18750******************************************************************
 18751*                                                                *
 18752*           U P D A T E   B A T C H   H E A D E R                *
 18753*                                                                *
 18754******************************************************************
 18755
 18756 3600-UPDATE-BATCH-HEADER.
 18757
 18758* EXEC CICS HANDLE CONDITION
 18759*         NOTFND      (3690-NOT-FOUND)
 18760*    END-EXEC.
 18761*    MOVE '"$I                   ! G #00016101' TO DFHEIV0
 18762     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18764     MOVE X'4720233030303136313031' TO DFHEIV0(25:11)
 18765     CALL 'kxdfhei1' USING DFHEIV0
 18766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18767
 18768
 18769
 18770* EXEC CICS READ
 18771*        DATASET (FILE-ID-ERPNDB)
 18772*        RIDFLD  (ERPNDB-KEY)
 18773*        SET     (ADDRESS OF PENDING-BUSINESS)
 18774*        UPDATE
 18775*    END-EXEC.
 18776*    MOVE '&"S        EU         (   #00016105' TO DFHEIV0
 18777     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18778     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18779     MOVE X'2020233030303136313035' TO DFHEIV0(25:11)
 18780     CALL 'kxdfhei1' USING DFHEIV0,
 18781           FILE-ID-ERPNDB,
 18782           DFHEIV20,
 18783           DFHEIV99,
 18784           ERPNDB-KEY,
 18785           DFHEIV99,
 18786           DFHEIV99,
 18787           DFHEIV99
 18788     SET ADDRESS OF PENDING-BUSINESS TO
 18789         DFHEIV20
 18790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18791
 18792
 18793     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18794     MOVE 'B'                    TO JP-RECORD-TYPE.
 18795     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18796
 18797     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18798
 18799     PERFORM 8400-LOG-JOURNAL-RECORD  *> Before BHDR Image
 18800
 18801     IF DRISSL GREATER THAN ZEROS
 18802        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18803
 18804     IF DRCANCL GREATER THAN ZEROS
 18805        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18806
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 344
* EL6311.cbl
 18807
 18808     IF DRLFPRML GREATER THAN ZEROS
 18809        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18810
 18811     IF DRAHPRML GREATER THAN ZEROS
 18812        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18813
 18814     IF DRLFRFDL GREATER THAN ZEROS
 18815        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18816
 18817     IF DRAHRFDL GREATER THAN ZEROS
 18818        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18819
 18820 3670-REWRITE-BATCH-HEADER.
 18821     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18822        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18823        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18824        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18825        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18826        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18827        MOVE SPACE               TO PB-OUT-BAL-CD
 18828     ELSE
 18829        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18830
 18831     MOVE 'C'                    TO JP-RECORD-TYPE.
 18832     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18833
 18834
 18835* EXEC CICS REWRITE
 18836*         DATASET      (FILE-ID-ERPNDB)
 18837*         FROM         (PENDING-BUSINESS)
 18838*    END-EXEC.
 18839     MOVE LENGTH OF
 18840      PENDING-BUSINESS
 18841       TO DFHEIV11
 18842*    MOVE '&& L                  %   #00016153' TO DFHEIV0
 18843     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18844     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18845     MOVE X'2020233030303136313533' TO DFHEIV0(25:11)
 18846     CALL 'kxdfhei1' USING DFHEIV0,
 18847           FILE-ID-ERPNDB,
 18848           PENDING-BUSINESS,
 18849           DFHEIV11,
 18850           DFHEIV99
 18851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18852
 18853
 18854     PERFORM 8400-LOG-JOURNAL-RECORD  *> After BHDR Image
 18855
 18856     GO TO 7200-DISPLAY-BATCHES.
 18857
 18858 3690-NOT-FOUND.
 18859     MOVE ER-2192                TO EMI-ERROR.
 18860     MOVE -1                     TO DPFENTRL.
 18861     MOVE AL-UNBON               TO DPFENTRA.
 18862     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18863     GO TO 8200-SEND-DATAONLY.
 18864
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 345
* EL6311.cbl
 18866
 18867******************************************************************
 18868*                                                                *
 18869*           R E - D I S P L A Y   R E C O R D                    *
 18870*                                                                *
 18871******************************************************************
 18872
 18873 3900-RE-DISPLAY-RECORD.
 18874
 18875* EXEC CICS HANDLE CONDITION
 18876*         NOTFND   (3990-NOT-FOUND)
 18877*    END-EXEC.
 18878*    MOVE '"$I                   ! H #00016178' TO DFHEIV0
 18879     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18881     MOVE X'4820233030303136313738' TO DFHEIV0(25:11)
 18882     CALL 'kxdfhei1' USING DFHEIV0
 18883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18884
 18885
 18886     IF PI-DISPLAY-ORIGINAL-BATCH
 18887         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18888     ELSE
 18889         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18890
 18891
 18892* EXEC CICS READ
 18893*         DATASET   (FILE-ID)
 18894*         RIDFLD    (PI-PREV-KEY)
 18895*         SET       (ADDRESS OF PENDING-BUSINESS)
 18896*    END-EXEC.
 18897*    MOVE '&"S        E          (   #00016187' TO DFHEIV0
 18898     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18900     MOVE X'2020233030303136313837' TO DFHEIV0(25:11)
 18901     CALL 'kxdfhei1' USING DFHEIV0,
 18902           FILE-ID,
 18903           DFHEIV20,
 18904           DFHEIV99,
 18905           PI-PREV-KEY,
 18906           DFHEIV99,
 18907           DFHEIV99,
 18908           DFHEIV99
 18909     SET ADDRESS OF PENDING-BUSINESS TO
 18910         DFHEIV20
 18911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18912
 18913
 18914     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18915
 18916     IF PB-ISSUE
 18917         GO TO 7000-DISPLAY-ISSUES.
 18918
 18919     IF PB-CANCELLATION
 18920         GO TO 7100-DISPLAY-CANCELS.
 18921
 18922     IF PB-BATCH-TRAILER
 18923         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 346
* EL6311.cbl
 18924
 18925 3990-NOT-FOUND.
 18926     MOVE LOW-VALUES             TO EL631BI.
 18927
 18928     IF PI-MAP-NAME = EL631B
 18929         MOVE -1                  TO BMAINTL
 18930     ELSE
 18931         MOVE -1                  TO CMAINTL.
 18932
 18933     GO TO 8100-SEND-INITIAL-MAP.
 18934
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 347
* EL6311.cbl
 18936
 18937***************************************************************
 18938*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18939*                                                             *
 18940*      1. START BROWSE WITH                                   *
 18941*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18942*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18943*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18944*                                                             *
 18945*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18946*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18947*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18948*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18949*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18950*               AND IS IT TO BE DISPLAYED.                    *
 18951*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18952*               DISPLAYED.                                    *
 18953*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18954*               DISPLAYED.                                    *
 18955*                                                             *
 18956*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18957*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18958***************************************************************
 18959
 18960 4000-BROWSE-DETAIL-FORWARD.
 18961     IF FIRST-TIME
 18962        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18963     ELSE
 18964        IF SHOW-RECORD
 18965           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18966           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18967           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18968           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18969           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18970        ELSE
 18971           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18972
 18973
 18974* EXEC CICS HANDLE CONDITION
 18975*         NOTFND   (4050-END-RECORDS)
 18976*         ENDFILE  (4050-END-RECORDS)
 18977*    END-EXEC.
 18978*    MOVE '"$I''                  ! I #00016252' TO DFHEIV0
 18979     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18980     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18981     MOVE X'4920233030303136323532' TO DFHEIV0(25:11)
 18982     CALL 'kxdfhei1' USING DFHEIV0
 18983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18984
 18985
 18986
 18987* EXEC CICS STARTBR
 18988*         DATASET   (FILE-ID-ERPNDB2)
 18989*         RIDFLD    (ERPNDB-ALT-KEY)
 18990*    END-EXEC.
 18991     MOVE 0
 18992       TO DFHEIV11
 18993*    MOVE '&,         G          &   #00016257' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 348
* EL6311.cbl
 18994     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18995     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18996     MOVE X'2020233030303136323537' TO DFHEIV0(25:11)
 18997     CALL 'kxdfhei1' USING DFHEIV0,
 18998           FILE-ID-ERPNDB2,
 18999           ERPNDB-ALT-KEY,
 19000           DFHEIV99,
 19001           DFHEIV11,
 19002           DFHEIV99
 19003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19004
 19005
 19006     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19007
 19008     IF FIRST-TIME OR SHOW-RECORD
 19009        MOVE SPACE               TO WS-FIRST-TIME-SW
 19010        GO TO 4005-READ-NEXT-RECORD.
 19011
 19012
 19013* EXEC CICS READNEXT
 19014*         DATASET    (FILE-ID-ERPNDB2)
 19015*         SET        (ADDRESS OF PENDING-BUSINESS)
 19016*         RIDFLD     (ERPNDB-ALT-KEY)
 19017*    END-EXEC.
 19018     MOVE 0
 19019       TO DFHEIV11
 19020*    MOVE '&.S                   )   #00016268' TO DFHEIV0
 19021     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19022     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19023     MOVE X'2020233030303136323638' TO DFHEIV0(25:11)
 19024     CALL 'kxdfhei1' USING DFHEIV0,
 19025           FILE-ID-ERPNDB2,
 19026           DFHEIV20,
 19027           DFHEIV99,
 19028           ERPNDB-ALT-KEY,
 19029           DFHEIV99,
 19030           DFHEIV11,
 19031           DFHEIV99,
 19032           DFHEIV99
 19033     SET ADDRESS OF PENDING-BUSINESS TO
 19034         DFHEIV20
 19035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19036
 19037
 19038 4005-READ-NEXT-RECORD.
 19039
 19040* EXEC CICS READNEXT
 19041*         DATASET    (FILE-ID-ERPNDB2)
 19042*         SET        (ADDRESS OF PENDING-BUSINESS)
 19043*         RIDFLD     (ERPNDB-ALT-KEY)
 19044*    END-EXEC.
 19045     MOVE 0
 19046       TO DFHEIV11
 19047*    MOVE '&.S                   )   #00016275' TO DFHEIV0
 19048     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19049     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19050     MOVE X'2020233030303136323735' TO DFHEIV0(25:11)
 19051     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 349
* EL6311.cbl
 19052           FILE-ID-ERPNDB2,
 19053           DFHEIV20,
 19054           DFHEIV99,
 19055           ERPNDB-ALT-KEY,
 19056           DFHEIV99,
 19057           DFHEIV11,
 19058           DFHEIV99,
 19059           DFHEIV99
 19060     SET ADDRESS OF PENDING-BUSINESS TO
 19061         DFHEIV20
 19062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19063
 19064
 19065     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19066
 19067     IF WS-BATCH-PREFIX = '#CL'
 19068        GO TO 4005-READ-NEXT-RECORD.
 19069
 19070     IF SHOW-RECORD
 19071        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 19072           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 19073           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 19074           PB-STATE         NOT = PI-PB-STATE          OR
 19075           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 19076           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 19077           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 19078           GO TO 4050-END-RECORDS
 19079        ELSE
 19080           GO TO 4010-CHECK-REC-TYPE.
 19081
 19082     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 19083        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 19084        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 19085        PB-STATE            NOT = PI-PB-STATE          OR
 19086        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 19087        GO TO 4050-END-RECORDS.
 19088
 19089     IF PB-BATCH-TRAILER
 19090        GO TO 4005-READ-NEXT-RECORD.
 19091
 19092     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19093        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19094           GO TO 4005-READ-NEXT-RECORD
 19095        ELSE
 19096           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19097              GO TO 4010-CHECK-REC-TYPE
 19098           ELSE
 19099              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19100                 GO TO 4010-CHECK-REC-TYPE
 19101              ELSE
 19102                 GO TO 4005-READ-NEXT-RECORD.
 19103
 19104     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19105        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19106           GO TO 4005-READ-NEXT-RECORD.
 19107
 19108 4010-CHECK-REC-TYPE.
 19109     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 350
* EL6311.cbl
 19110         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19111             NEXT SENTENCE
 19112         ELSE
 19113             GO TO 4005-READ-NEXT-RECORD.
 19114
 19115     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19116         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19117             NEXT SENTENCE
 19118        ELSE
 19119             GO TO 4005-READ-NEXT-RECORD.
 19120
 19121     IF NOT DISPLAY-CHANGE-RECORDS AND
 19122            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19123        GO TO 4005-READ-NEXT-RECORD.
 19124
 19125     IF DISPLAY-HOLD-RECORDS AND
 19126        NOT PB-RECORD-ON-HOLD
 19127          GO TO 4005-READ-NEXT-RECORD.
 19128
 19129     IF PB-ISSUE
 19130        IF DISPLAY-CHK-REQ-RECORDS
 19131            GO TO 4005-READ-NEXT-RECORD.
 19132
 19133     IF PB-ISSUE
 19134        IF ISSUE-WITH-WARNING
 19135           IF PB-WARNING-ERRORS
 19136              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19137                  GO TO 4005-READ-NEXT-RECORD
 19138              ELSE
 19139                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19140                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19141                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19142                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19143                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19144                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19145                 GO TO 7000-DISPLAY-ISSUES
 19146           ELSE
 19147              GO TO 4005-READ-NEXT-RECORD.
 19148
 19149     IF PB-ISSUE
 19150        IF (ISSUES-IN-ERROR AND
 19151            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19152            ALL-ISSUES
 19153            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19154            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19155            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19156            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19157            MOVE PB-SV-STATE            TO PI-SV-STATE
 19158            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19159            GO TO 7000-DISPLAY-ISSUES
 19160        ELSE
 19161            GO TO 4005-READ-NEXT-RECORD.
 19162
 19163     IF PB-CANCELLATION
 19164        IF DISPLAY-CHK-REQ-RECORDS
 19165           IF PB-C-REFUND-REQUESTED
 19166              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19167              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 351
* EL6311.cbl
 19168              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19169              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19170              MOVE PB-SV-STATE            TO PI-SV-STATE
 19171              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19172              GO TO 7100-DISPLAY-CANCELS
 19173           ELSE
 19174               GO TO 4005-READ-NEXT-RECORD.
 19175
 19176     IF PB-CANCELLATION
 19177        IF CANCEL-WITH-WARNING
 19178           IF PB-WARNING-ERRORS
 19179              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19180                  GO TO 4005-READ-NEXT-RECORD
 19181              ELSE
 19182                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19183                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19184                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19185                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19186                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19187                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19188                 GO TO 7100-DISPLAY-CANCELS
 19189           ELSE
 19190              GO TO 4005-READ-NEXT-RECORD.
 19191
 19192     IF PB-CANCELLATION
 19193        IF (CANCEL-IN-ERROR  AND
 19194            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19195            ALL-CANCELS
 19196            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19197            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19198            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19199            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19200            MOVE PB-SV-STATE            TO PI-SV-STATE
 19201            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19202            GO TO 7100-DISPLAY-CANCELS.
 19203
 19204     GO TO 4005-READ-NEXT-RECORD.
 19205
 19206 4050-END-RECORDS.
 19207******************************************************************
 19208*                                                                *
 19209*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19210*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19211*         PROGRAM.                                               *
 19212*                                                                *
 19213******************************************************************
 19214
 19215     IF BROWSE-STARTED
 19216        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19217
 19218* EXEC CICS ENDBR
 19219*            DATASET  (FILE-ID-ERPNDB2)
 19220*       END-EXEC.
 19221     MOVE 0
 19222       TO DFHEIV11
 19223*    MOVE '&2                    $   #00016433' TO DFHEIV0
 19224     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19225     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 352
* EL6311.cbl
 19226     MOVE X'2020233030303136343333' TO DFHEIV0(25:11)
 19227     CALL 'kxdfhei1' USING DFHEIV0,
 19228           FILE-ID-ERPNDB2,
 19229           DFHEIV11,
 19230           DFHEIV99
 19231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19232
 19233
 19234     IF  EIBTRNID NOT = TRANS-EXB1
 19235         IF PENDING-BUS-RECS-FOUND
 19236             NEXT SENTENCE
 19237           ELSE
 19238             MOVE '9'            TO PI-BROWSE-SW
 19239             GO TO 9400-CLEAR.
 19240
 19241     IF SHOW-RECORD
 19242        MOVE ER-2253            TO EMI-ERROR
 19243       ELSE
 19244        MOVE ER-2254            TO EMI-ERROR.
 19245
 19246     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19247
 19248     IF PI-MAP-NAME = SPACES
 19249        MOVE -1                  TO DPFENTRL
 19250        MOVE EL631D               TO PI-MAP-NAME
 19251        GO TO 8100-SEND-INITIAL-MAP.
 19252
 19253     IF PI-MAP-NAME = EL631B
 19254        MOVE -1                  TO BMAINTL
 19255     ELSE
 19256        IF PI-MAP-NAME = EL631C
 19257           MOVE -1               TO CMAINTL
 19258        ELSE
 19259           MOVE -1               TO DPFENTRL.
 19260
 19261     GO TO 8200-SEND-DATAONLY.
 19262
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 353
* EL6311.cbl
 19264
 19265***************************************************************
 19266*                                                             *
 19267*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 19268*                                                             *
 19269*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 19270*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19271*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19272*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 19273*                                                             *
 19274*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19275*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19276*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 19277*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19278*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19279*                AND IS IT TO BE DISPLAYED.                   *
 19280*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19281*                DISPLAYED.                                   *
 19282*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19283*                DISPLAYED.                                   *
 19284*                                                             *
 19285*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19286*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19287*                                                             *
 19288*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19289*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19290*                THEY ARE NOT TO BE DISPLAYED.                *
 19291*                                                             *
 19292***************************************************************
 19293
 19294 4100-BROWSE-PRIMARY-FORWARD.
 19295     IF FIRST-TIME  OR SHOW-RECORD
 19296        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 19297        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 19298        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 19299     ELSE
 19300        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 19301        IF ERPNDB-BATCH-SEQ-NO = +9999
 19302           GO TO 4150-END-BATCH
 19303        ELSE
 19304           IF DISPLAY-CHANGE-RECORDS
 19305              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19306           ELSE
 19307              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19308              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19309
 19310     IF FIRST-TIME
 19311         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 19312            PI-PB-BATCH-SEQ-NO NOT = ZERO
 19313              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 19314
 19315
 19316* EXEC CICS HANDLE CONDITION
 19317*         ENDFILE  (4150-END-BATCH)
 19318*    END-EXEC.
 19319*    MOVE '"$''                   ! J #00016518' TO DFHEIV0
 19320     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 354
* EL6311.cbl
 19322     MOVE X'4A20233030303136353138' TO DFHEIV0(25:11)
 19323     CALL 'kxdfhei1' USING DFHEIV0
 19324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19325
 19326
 19327 4105-READ-NEXT.
 19328
 19329* EXEC CICS HANDLE CONDITION
 19330*         NOTFND    (4150-END-BATCH)
 19331*    END-EXEC.
 19332*    MOVE '"$I                   ! K #00016523' TO DFHEIV0
 19333     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19335     MOVE X'4B20233030303136353233' TO DFHEIV0(25:11)
 19336     CALL 'kxdfhei1' USING DFHEIV0
 19337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19338
 19339
 19340     MOVE SPACES                 TO WS-REC-FOUND-SW.
 19341
 19342     IF PI-DISPLAY-ORIGINAL-BATCH
 19343        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19344     ELSE
 19345        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19346
 19347
 19348* EXEC CICS READ
 19349*         DATASET   (FILE-ID)
 19350*         SET       (ADDRESS OF PENDING-BUSINESS)
 19351*         RIDFLD    (ERPNDB-KEY)
 19352*         GTEQ
 19353*    END-EXEC.
 19354*    MOVE '&"S        G          (   #00016534' TO DFHEIV0
 19355     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19356     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19357     MOVE X'2020233030303136353334' TO DFHEIV0(25:11)
 19358     CALL 'kxdfhei1' USING DFHEIV0,
 19359           FILE-ID,
 19360           DFHEIV20,
 19361           DFHEIV99,
 19362           ERPNDB-KEY,
 19363           DFHEIV99,
 19364           DFHEIV99,
 19365           DFHEIV99
 19366     SET ADDRESS OF PENDING-BUSINESS TO
 19367         DFHEIV20
 19368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19369
 19370
 19371     IF PI-DISPLAY-ORIGINAL-BATCH
 19372        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19373           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19374           GO TO 4150-END-BATCH
 19375        ELSE
 19376           IF PB-BATCH-TRAILER
 19377              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19378              GO TO 4105-READ-NEXT
 19379           ELSE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 355
* EL6311.cbl
 19380              NEXT SENTENCE
 19381     ELSE
 19382        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19383           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19384           GO TO 4150-END-BATCH.
 19385
 19386     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19387
 19388     IF WS-BATCH-PREFIX = '#CL'
 19389         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19390         GO TO 4105-READ-NEXT.
 19391
 19392     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19393     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19394     MOVE PB-STATE               TO PI-PB-STATE.
 19395     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19396
 19397     IF PB-BATCH-TRAILER
 19398        IF SHOW-RECORD
 19399           GO TO 4150-END-BATCH
 19400        ELSE
 19401           MOVE ER-2251         TO EMI-ERROR
 19402           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19403           MOVE 1               TO PI-BROWSE-TYPE
 19404           GO TO 7200-DISPLAY-BATCHES.
 19405
 19406     IF SHOW-RECORD
 19407           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19408              GO TO 4110-BUMP-SEQ
 19409           ELSE
 19410              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19411                 GO TO 4110-BUMP-SEQ
 19412              ELSE
 19413                 GO TO 4107-CHECK-REC-TYPE.
 19414
 19415     IF NOT  PI-PRIMARY-WITH-SELECT
 19416        GO TO 4107-CHECK-REC-TYPE.
 19417
 19418     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19419        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19420           GO TO 4110-BUMP-SEQ
 19421        ELSE
 19422           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19423              GO TO 4107-CHECK-REC-TYPE
 19424           ELSE
 19425              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19426                 GO TO 4107-CHECK-REC-TYPE
 19427              ELSE
 19428                 GO TO 4110-BUMP-SEQ.
 19429
 19430     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19431        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19432           GO TO 4110-BUMP-SEQ.
 19433
 19434 4107-CHECK-REC-TYPE.
 19435     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19436         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19437             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 356
* EL6311.cbl
 19438           ELSE
 19439             GO TO 4110-BUMP-SEQ.
 19440
 19441     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19442         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19443             NEXT SENTENCE
 19444           ELSE
 19445             GO TO 4110-BUMP-SEQ.
 19446
 19447     IF NOT DISPLAY-CHANGE-RECORDS AND
 19448        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19449           GO TO 4110-BUMP-SEQ.
 19450
 19451     IF DISPLAY-HOLD-RECORDS AND
 19452        NOT PB-RECORD-ON-HOLD
 19453          GO TO 4110-BUMP-SEQ.
 19454
 19455     IF PB-ISSUE
 19456        IF DISPLAY-CHK-REQ-RECORDS
 19457            GO TO 4110-BUMP-SEQ.
 19458
 19459     IF PB-ISSUE
 19460        IF ISSUE-WITH-WARNING
 19461           IF PB-WARNING-ERRORS
 19462              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19463                  GO TO 4110-BUMP-SEQ
 19464              ELSE
 19465                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19466                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19467                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19468                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19469                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19470                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19471                 GO TO 7000-DISPLAY-ISSUES
 19472        ELSE
 19473            GO TO 4110-BUMP-SEQ.
 19474
 19475     IF PB-ISSUE
 19476        IF (ISSUES-IN-ERROR AND
 19477            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19478            ALL-ISSUES
 19479            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19480            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19481            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19482            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19483            MOVE PB-SV-STATE            TO PI-SV-STATE
 19484            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19485            GO TO 7000-DISPLAY-ISSUES
 19486        ELSE
 19487            GO TO 4110-BUMP-SEQ.
 19488
 19489     IF PB-CANCELLATION
 19490        IF DISPLAY-CHK-REQ-RECORDS
 19491           IF PB-C-REFUND-REQUESTED
 19492              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19493              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19494              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19495              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 357
* EL6311.cbl
 19496              MOVE PB-SV-STATE            TO PI-SV-STATE
 19497              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19498              GO TO 7100-DISPLAY-CANCELS
 19499           ELSE
 19500              GO TO 4110-BUMP-SEQ.
 19501
 19502     IF PB-CANCELLATION
 19503        IF CANCEL-WITH-WARNING
 19504           IF PB-WARNING-ERRORS
 19505              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19506                  GO TO 4110-BUMP-SEQ
 19507              ELSE
 19508                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19509                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19510                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19511                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19512                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19513                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19514                 GO TO 7100-DISPLAY-CANCELS
 19515           ELSE
 19516              GO TO 4110-BUMP-SEQ.
 19517
 19518     IF PB-CANCELLATION
 19519        IF (CANCEL-IN-ERROR  AND
 19520            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19521            ALL-CANCELS
 19522            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19523            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19524            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19525            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19526            MOVE PB-SV-STATE            TO PI-SV-STATE
 19527            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19528            GO TO 7100-DISPLAY-CANCELS.
 19529
 19530 4110-BUMP-SEQ.
 19531     IF NOT DISPLAY-CHANGE-RECORDS
 19532        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19533        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19534     ELSE
 19535        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19536           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19537           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19538        ELSE
 19539           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19540           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19541
 19542     GO TO 4105-READ-NEXT.
 19543
 19544 4150-END-BATCH.
 19545******************************************************************
 19546*                                                                *
 19547*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19548*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19549*         PROGRAM.                                               *
 19550*                                                                *
 19551******************************************************************
 19552
 19553     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 358
* EL6311.cbl
 19554         IF PENDING-BUS-RECS-FOUND
 19555             NEXT SENTENCE
 19556           ELSE
 19557             MOVE '9'            TO PI-BROWSE-SW
 19558             GO TO 9400-CLEAR.
 19559
 19560     IF SHOW-RECORD
 19561        MOVE ER-2253             TO EMI-ERROR
 19562     ELSE
 19563        MOVE ER-2251             TO EMI-ERROR.
 19564
 19565     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19566
 19567     IF PI-MAP-NAME = SPACES
 19568        MOVE -1                  TO BMAINTL
 19569        MOVE EL631B              TO PI-MAP-NAME
 19570        GO TO 8100-SEND-INITIAL-MAP.
 19571
 19572     IF PI-MAP-NAME = EL631B
 19573        MOVE -1                  TO BMAINTL
 19574     ELSE
 19575        IF PI-MAP-NAME = EL631C
 19576           MOVE -1               TO CMAINTL
 19577        ELSE
 19578           MOVE -1               TO DPFENTRL.
 19579
 19580     GO TO 8200-SEND-DATAONLY.
 19581
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 359
* EL6311.cbl
 19583
 19584***************************************************************
 19585*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19586*                                                             *
 19587*      1. START BROWSE WITH                                   *
 19588*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19589*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19590*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19591*                                                             *
 19592*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19593*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19594*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19595*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19596*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19597*               AND IS IT TO BE DISPLAYED.                    *
 19598*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19599*               DISPLAYED.                                    *
 19600*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19601*               DISPLAYED.                                    *
 19602*                                                             *
 19603*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19604*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19605***************************************************************
 19606
 19607 4200-BROWSE-CSR-FORWARD.
 19608
 19609     IF FIRST-TIME
 19610        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19611     ELSE
 19612        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19613
 19614
 19615* EXEC CICS HANDLE CONDITION
 19616*         NOTFND   (4250-END-RECORDS)
 19617*         ENDFILE  (4250-END-RECORDS)
 19618*    END-EXEC.
 19619*    MOVE '"$I''                  ! L #00016784' TO DFHEIV0
 19620     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19622     MOVE X'4C20233030303136373834' TO DFHEIV0(25:11)
 19623     CALL 'kxdfhei1' USING DFHEIV0
 19624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19625
 19626
 19627
 19628* EXEC CICS STARTBR
 19629*         DATASET   (FILE-ID-ERPNDB4)
 19630*         RIDFLD    (ERPNDB-CSR-KEY)
 19631*    END-EXEC.
 19632     MOVE 0
 19633       TO DFHEIV11
 19634*    MOVE '&,         G          &   #00016789' TO DFHEIV0
 19635     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19636     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19637     MOVE X'2020233030303136373839' TO DFHEIV0(25:11)
 19638     CALL 'kxdfhei1' USING DFHEIV0,
 19639           FILE-ID-ERPNDB4,
 19640           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 360
* EL6311.cbl
 19641           DFHEIV99,
 19642           DFHEIV11,
 19643           DFHEIV99
 19644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19645
 19646
 19647     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19648
 19649     IF FIRST-TIME
 19650        MOVE SPACE               TO WS-FIRST-TIME-SW
 19651        GO TO 4205-READ-NEXT-RECORD.
 19652
 19653
 19654* EXEC CICS READNEXT
 19655*         DATASET    (FILE-ID-ERPNDB4)
 19656*         SET        (ADDRESS OF PENDING-BUSINESS)
 19657*         RIDFLD     (ERPNDB-CSR-KEY)
 19658*    END-EXEC.
 19659     MOVE 0
 19660       TO DFHEIV11
 19661*    MOVE '&.S                   )   #00016800' TO DFHEIV0
 19662     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19663     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19664     MOVE X'2020233030303136383030' TO DFHEIV0(25:11)
 19665     CALL 'kxdfhei1' USING DFHEIV0,
 19666           FILE-ID-ERPNDB4,
 19667           DFHEIV20,
 19668           DFHEIV99,
 19669           ERPNDB-CSR-KEY,
 19670           DFHEIV99,
 19671           DFHEIV11,
 19672           DFHEIV99,
 19673           DFHEIV99
 19674     SET ADDRESS OF PENDING-BUSINESS TO
 19675         DFHEIV20
 19676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19677
 19678
 19679 4205-READ-NEXT-RECORD.
 19680
 19681
 19682* EXEC CICS READNEXT
 19683*         DATASET    (FILE-ID-ERPNDB4)
 19684*         SET        (ADDRESS OF PENDING-BUSINESS)
 19685*         RIDFLD     (ERPNDB-CSR-KEY)
 19686*    END-EXEC.
 19687     MOVE 0
 19688       TO DFHEIV11
 19689*    MOVE '&.S                   )   #00016808' TO DFHEIV0
 19690     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19691     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19692     MOVE X'2020233030303136383038' TO DFHEIV0(25:11)
 19693     CALL 'kxdfhei1' USING DFHEIV0,
 19694           FILE-ID-ERPNDB4,
 19695           DFHEIV20,
 19696           DFHEIV99,
 19697           ERPNDB-CSR-KEY,
 19698           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 361
* EL6311.cbl
 19699           DFHEIV11,
 19700           DFHEIV99,
 19701           DFHEIV99
 19702     SET ADDRESS OF PENDING-BUSINESS TO
 19703         DFHEIV20
 19704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19705
 19706
 19707     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19708
 19709     IF WS-BATCH-PREFIX = '#CL'
 19710        GO TO 4205-READ-NEXT-RECORD.
 19711
 19712     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19713        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19714        GO TO 4250-END-RECORDS.
 19715
 19716     IF PB-BATCH-TRAILER
 19717        GO TO 4205-READ-NEXT-RECORD.
 19718
 19719     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19720        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19721           GO TO 4205-READ-NEXT-RECORD
 19722        ELSE
 19723           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19724              GO TO 4210-CHECK-REC-TYPE
 19725           ELSE
 19726              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19727                 GO TO 4210-CHECK-REC-TYPE
 19728              ELSE
 19729                 GO TO 4205-READ-NEXT-RECORD.
 19730
 19731     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19732        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19733           GO TO 4205-READ-NEXT-RECORD.
 19734
 19735 4210-CHECK-REC-TYPE.
 19736     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19737         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19738             NEXT SENTENCE
 19739         ELSE
 19740             GO TO 4205-READ-NEXT-RECORD.
 19741
 19742     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19743         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19744             NEXT SENTENCE
 19745        ELSE
 19746             GO TO 4205-READ-NEXT-RECORD.
 19747
 19748     IF NOT DISPLAY-CHANGE-RECORDS AND
 19749            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19750        GO TO 4205-READ-NEXT-RECORD.
 19751
 19752     IF DISPLAY-HOLD-RECORDS AND
 19753        NOT PB-RECORD-ON-HOLD
 19754          GO TO 4205-READ-NEXT-RECORD.
 19755
 19756     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 362
* EL6311.cbl
 19757        IF DISPLAY-CHK-REQ-RECORDS
 19758            GO TO 4205-READ-NEXT-RECORD.
 19759
 19760     IF PB-ISSUE
 19761        IF ISSUE-WITH-WARNING
 19762           IF PB-WARNING-ERRORS
 19763              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19764                  GO TO 4205-READ-NEXT-RECORD
 19765              ELSE
 19766                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19767                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19768                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19769                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19770                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19771                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19772                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19773                 GO TO 7000-DISPLAY-ISSUES
 19774           ELSE
 19775              GO TO 4205-READ-NEXT-RECORD.
 19776
 19777     IF PB-ISSUE
 19778        IF (ISSUES-IN-ERROR AND
 19779            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19780            ALL-ISSUES
 19781            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19782            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19783            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19784            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19785            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19786            MOVE PB-SV-STATE            TO PI-SV-STATE
 19787            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19788            GO TO 7000-DISPLAY-ISSUES
 19789        ELSE
 19790            GO TO 4205-READ-NEXT-RECORD.
 19791
 19792     IF PB-CANCELLATION
 19793        IF DISPLAY-CHK-REQ-RECORDS
 19794           IF PB-C-REFUND-REQUESTED
 19795              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19796              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19797              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19798              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19799              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19800              MOVE PB-SV-STATE            TO PI-SV-STATE
 19801              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19802              GO TO 7100-DISPLAY-CANCELS
 19803           ELSE
 19804               GO TO 4205-READ-NEXT-RECORD.
 19805
 19806     IF PB-CANCELLATION
 19807        IF CANCEL-WITH-WARNING
 19808           IF PB-WARNING-ERRORS
 19809              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19810                  GO TO 4205-READ-NEXT-RECORD
 19811              ELSE
 19812                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19813                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19814                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 363
* EL6311.cbl
 19815                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19816                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19817                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19818                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19819                 GO TO 7100-DISPLAY-CANCELS
 19820           ELSE
 19821              GO TO 4205-READ-NEXT-RECORD.
 19822
 19823     IF PB-CANCELLATION
 19824        IF (CANCEL-IN-ERROR  AND
 19825            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19826            ALL-CANCELS
 19827            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19828            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19829            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19830            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19831            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19832            MOVE PB-SV-STATE            TO PI-SV-STATE
 19833            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19834            GO TO 7100-DISPLAY-CANCELS.
 19835
 19836     GO TO 4205-READ-NEXT-RECORD.
 19837
 19838 4250-END-RECORDS.
 19839******************************************************************
 19840*                                                                *
 19841*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19842*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19843*         PROGRAM.                                               *
 19844*                                                                *
 19845******************************************************************
 19846
 19847     IF BROWSE-STARTED
 19848        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19849
 19850* EXEC CICS ENDBR
 19851*            DATASET  (FILE-ID-ERPNDB4)
 19852*       END-EXEC.
 19853     MOVE 0
 19854       TO DFHEIV11
 19855*    MOVE '&2                    $   #00016956' TO DFHEIV0
 19856     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19857     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19858     MOVE X'2020233030303136393536' TO DFHEIV0(25:11)
 19859     CALL 'kxdfhei1' USING DFHEIV0,
 19860           FILE-ID-ERPNDB4,
 19861           DFHEIV11,
 19862           DFHEIV99
 19863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19864
 19865
 19866     IF  EIBTRNID NOT = TRANS-EXB1
 19867         IF PENDING-BUS-RECS-FOUND
 19868             NEXT SENTENCE
 19869           ELSE
 19870             MOVE '9'            TO PI-BROWSE-SW
 19871             GO TO 9400-CLEAR.
 19872
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 364
* EL6311.cbl
 19873     IF SHOW-RECORD
 19874        MOVE ER-2253            TO EMI-ERROR
 19875       ELSE
 19876        MOVE ER-2254            TO EMI-ERROR.
 19877
 19878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19879
 19880     IF PI-MAP-NAME = SPACES
 19881        MOVE -1                  TO DPFENTRL
 19882        MOVE EL631D               TO PI-MAP-NAME
 19883        GO TO 8100-SEND-INITIAL-MAP.
 19884
 19885     IF PI-MAP-NAME = EL631B
 19886        MOVE -1                  TO BMAINTL
 19887     ELSE
 19888        IF PI-MAP-NAME = EL631C
 19889           MOVE -1               TO CMAINTL
 19890        ELSE
 19891           MOVE -1               TO DPFENTRL.
 19892
 19893     GO TO 8200-SEND-DATAONLY.
 19894
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 365
* EL6311.cbl
 19896
 19897***************************************************************
 19898*                                                             *
 19899*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19900*                                                             *
 19901*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19902*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19903*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19904*                                                             *
 19905*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19906*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19907*          A. IS IT WITHIN THE SAME COMPANY                   *
 19908*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19909*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19910*                AND IS IT TO BE DISPLAYED.                   *
 19911*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19912*                DISPLAYED.                                   *
 19913*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19914*                DISPLAYED.                                   *
 19915*                                                             *
 19916*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19917*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19918*                                                             *
 19919*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19920*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19921*                THEY ARE NOT TO BE DISPLAYED.                *
 19922*                                                             *
 19923***************************************************************
 19924
 19925 4300-BROWSE-FILE-FORWARD.
 19926     IF FIRST-TIME OR SHOW-RECORD
 19927        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19928        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19929        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19930     ELSE
 19931        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19932        IF ERPNDB-BATCH-SEQ-NO = +9999
 19933           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19934        ELSE
 19935           IF DISPLAY-CHANGE-RECORDS
 19936              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19937           ELSE
 19938              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19939              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19940
 19941
 19942* EXEC CICS HANDLE CONDITION
 19943*         ENDFILE  (4350-END-BATCH)
 19944*         NOTFND   (4350-END-BATCH)
 19945*    END-EXEC.
 19946*    MOVE '"$''I                  ! M #00017035' TO DFHEIV0
 19947     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19948     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19949     MOVE X'4D20233030303137303335' TO DFHEIV0(25:11)
 19950     CALL 'kxdfhei1' USING DFHEIV0
 19951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19952
 19953
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 366
* EL6311.cbl
 19954 4305-READ-NEXT.
 19955     IF PI-DISPLAY-ORIGINAL-BATCH
 19956        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19957     ELSE
 19958        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19959
 19960
 19961* EXEC CICS READ
 19962*         DATASET   (FILE-ID)
 19963*         SET       (ADDRESS OF PENDING-BUSINESS)
 19964*         RIDFLD    (ERPNDB-KEY)
 19965*         GTEQ
 19966*    END-EXEC.
 19967*    MOVE '&"S        G          (   #00017046' TO DFHEIV0
 19968     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19969     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19970     MOVE X'2020233030303137303436' TO DFHEIV0(25:11)
 19971     CALL 'kxdfhei1' USING DFHEIV0,
 19972           FILE-ID,
 19973           DFHEIV20,
 19974           DFHEIV99,
 19975           ERPNDB-KEY,
 19976           DFHEIV99,
 19977           DFHEIV99,
 19978           DFHEIV99
 19979     SET ADDRESS OF PENDING-BUSINESS TO
 19980         DFHEIV20
 19981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19982
 19983
 19984     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19985        GO TO 4350-END-BATCH.
 19986
 19987     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19988                                    WS-BATCH-NO.
 19989
 19990     IF  WS-BATCH-PREFIX = '#CL'
 19991         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19992         GO TO 4305-READ-NEXT.
 19993
 19994     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19995     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19996     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19997     MOVE PB-STATE               TO PI-PB-STATE.
 19998     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19999
 20000     IF PB-BATCH-TRAILER
 20001        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 20002        GO TO 4305-READ-NEXT.
 20003
 20004     IF SHOW-RECORD
 20005           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 20006              GO TO 4310-BUMP-SEQ
 20007           ELSE
 20008              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20009                 GO TO 4310-BUMP-SEQ
 20010              ELSE
 20011                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 367
* EL6311.cbl
 20012
 20013     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20014        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20015           GO TO 4310-BUMP-SEQ
 20016        ELSE
 20017           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20018              GO TO 4307-CHECK-REC-TYPE
 20019           ELSE
 20020              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20021                 GO TO 4307-CHECK-REC-TYPE
 20022              ELSE
 20023                 GO TO 4310-BUMP-SEQ.
 20024
 20025     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20026        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20027           GO TO 4310-BUMP-SEQ.
 20028
 20029 4307-CHECK-REC-TYPE.
 20030     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20031         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20032             NEXT SENTENCE
 20033         ELSE
 20034             GO TO 4310-BUMP-SEQ.
 20035
 20036     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20037         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20038             NEXT SENTENCE
 20039        ELSE
 20040             GO TO 4310-BUMP-SEQ.
 20041
 20042     IF NOT DISPLAY-CHANGE-RECORDS AND
 20043            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20044        GO TO 4310-BUMP-SEQ.
 20045
 20046     IF DISPLAY-HOLD-RECORDS AND
 20047        NOT PB-RECORD-ON-HOLD
 20048          GO TO 4310-BUMP-SEQ.
 20049
 20050     IF PB-ISSUE
 20051        IF DISPLAY-CHK-REQ-RECORDS
 20052           GO TO 4310-BUMP-SEQ.
 20053
 20054     IF PB-ISSUE
 20055        IF ISSUE-WITH-WARNING
 20056           IF PB-WARNING-ERRORS
 20057              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20058                  GO TO 4310-BUMP-SEQ
 20059              ELSE
 20060                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20061                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20062                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20063                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20064                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20065                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20066                 GO TO 7000-DISPLAY-ISSUES
 20067           ELSE
 20068              GO TO 4310-BUMP-SEQ.
 20069
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 368
* EL6311.cbl
 20070     IF PB-ISSUE
 20071        IF (ISSUES-IN-ERROR AND
 20072            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20073            ALL-ISSUES
 20074            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20075            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20076            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20077            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20078            MOVE PB-SV-STATE            TO PI-SV-STATE
 20079            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20080            GO TO 7000-DISPLAY-ISSUES
 20081        ELSE
 20082            GO TO 4310-BUMP-SEQ.
 20083
 20084     IF PB-CANCELLATION
 20085        IF DISPLAY-CHK-REQ-RECORDS
 20086           IF PB-C-REFUND-REQUESTED
 20087              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20088              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20089              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20090              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20091              MOVE PB-SV-STATE            TO PI-SV-STATE
 20092              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20093              GO TO 7100-DISPLAY-CANCELS
 20094           ELSE
 20095              GO TO 4310-BUMP-SEQ.
 20096
 20097     IF PB-CANCELLATION
 20098        IF CANCEL-WITH-WARNING
 20099           IF PB-WARNING-ERRORS
 20100              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20101                  GO TO 4310-BUMP-SEQ
 20102              ELSE
 20103                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20104                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20105                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20106                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20107                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20108                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20109                 GO TO 7100-DISPLAY-CANCELS
 20110           ELSE
 20111              GO TO 4310-BUMP-SEQ.
 20112
 20113     IF PB-CANCELLATION
 20114        IF (CANCEL-IN-ERROR  AND
 20115            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20116            ALL-CANCELS
 20117            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20118            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20119            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20120            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20121            MOVE PB-SV-STATE            TO PI-SV-STATE
 20122            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20123            GO TO 7100-DISPLAY-CANCELS.
 20124
 20125 4310-BUMP-SEQ.
 20126     IF NOT DISPLAY-CHANGE-RECORDS
 20127        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 369
* EL6311.cbl
 20128        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 20129     ELSE
 20130        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 20131           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 20132           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 20133        ELSE
 20134           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 20135           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 20136
 20137     GO TO 4305-READ-NEXT.
 20138
 20139 4350-END-BATCH.
 20140
 20141******************************************************************
 20142*                                                                *
 20143*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20144*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 20145*         PROGRAM.                                               *
 20146*                                                                *
 20147******************************************************************
 20148
 20149     IF  EIBTRNID NOT = TRANS-EXB1
 20150         IF PENDING-BUS-RECS-FOUND
 20151             NEXT SENTENCE
 20152           ELSE
 20153             MOVE '9'            TO PI-BROWSE-SW
 20154             GO TO 9400-CLEAR.
 20155
 20156     IF SHOW-RECORD
 20157        MOVE ER-2253            TO EMI-ERROR
 20158     ELSE
 20159        MOVE ER-2251            TO EMI-ERROR.
 20160
 20161     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20162
 20163     IF PI-MAP-NAME = SPACES
 20164        MOVE -1                  TO BMAINTL
 20165        MOVE EL631B               TO PI-MAP-NAME
 20166        GO TO 8100-SEND-INITIAL-MAP.
 20167
 20168     IF PI-MAP-NAME = EL631B
 20169        MOVE -1                  TO BMAINTL
 20170     ELSE
 20171        IF PI-MAP-NAME = EL631C
 20172           MOVE -1               TO CMAINTL
 20173        ELSE
 20174           MOVE -1               TO DPFENTRL.
 20175
 20176     GO TO 8200-SEND-DATAONLY.
 20177
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 370
* EL6311.cbl
 20179
 20180******************************************************************
 20181*                                                                *
 20182*        B R O W S E   D E T A I L   B A C K W A R D             *
 20183*                                                                *
 20184******************************************************************
 20185
 20186 4500-BROWSE-DETAIL-BACKWARD.
 20187
 20188     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 20189
 20190
 20191* EXEC CICS HANDLE CONDITION
 20192*         NOTFND   (4570-NOT-FOUND)
 20193*         ENDFILE  (4550-END-RECORDS)
 20194*    END-EXEC
 20195*    MOVE '"$I''                  ! N #00017259' TO DFHEIV0
 20196     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20197     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20198     MOVE X'4E20233030303137323539' TO DFHEIV0(25:11)
 20199     CALL 'kxdfhei1' USING DFHEIV0
 20200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20201
 20202
 20203* EXEC CICS STARTBR
 20204*         DATASET   (FILE-ID-ERPNDB2)
 20205*         RIDFLD    (ERPNDB-ALT-KEY)
 20206*    END-EXEC.
 20207     MOVE 0
 20208       TO DFHEIV11
 20209*    MOVE '&,         G          &   #00017264' TO DFHEIV0
 20210     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20211     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20212     MOVE X'2020233030303137323634' TO DFHEIV0(25:11)
 20213     CALL 'kxdfhei1' USING DFHEIV0,
 20214           FILE-ID-ERPNDB2,
 20215           ERPNDB-ALT-KEY,
 20216           DFHEIV99,
 20217           DFHEIV11,
 20218           DFHEIV99
 20219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20220
 20221
 20222     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20223                                    WS-FIRST-TIME-SW.
 20224
 20225 4505-READ-PREV-RECORD.
 20226
 20227* EXEC CICS READPREV
 20228*         DATASET    (FILE-ID-ERPNDB2)
 20229*         SET        (ADDRESS OF PENDING-BUSINESS)
 20230*         RIDFLD     (ERPNDB-ALT-KEY)
 20231*    END-EXEC.
 20232     MOVE 0
 20233       TO DFHEIV11
 20234*    MOVE '&0S                   )   #00017273' TO DFHEIV0
 20235     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20236     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 371
* EL6311.cbl
 20237     MOVE X'2020233030303137323733' TO DFHEIV0(25:11)
 20238     CALL 'kxdfhei1' USING DFHEIV0,
 20239           FILE-ID-ERPNDB2,
 20240           DFHEIV20,
 20241           DFHEIV99,
 20242           ERPNDB-ALT-KEY,
 20243           DFHEIV99,
 20244           DFHEIV11,
 20245           DFHEIV99,
 20246           DFHEIV99
 20247     SET ADDRESS OF PENDING-BUSINESS TO
 20248         DFHEIV20
 20249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20250
 20251
 20252     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20253
 20254     IF WS-BATCH-PREFIX = '#CL'
 20255         GO TO 4505-READ-PREV-RECORD.
 20256
 20257     IF FIRST-TIME
 20258         MOVE SPACE               TO WS-FIRST-TIME-SW
 20259         GO TO 4505-READ-PREV-RECORD.
 20260
 20261     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 20262        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 20263        PB-GROUPING      NOT = PI-PB-GROUPING OR
 20264        PB-STATE         NOT = PI-PB-STATE    OR
 20265        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 20266          GO TO 4550-END-RECORDS.
 20267
 20268
 20269     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20270
 20271     IF PB-BATCH-TRAILER
 20272        GO TO 4505-READ-PREV-RECORD.
 20273
 20274     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20275
 20276     IF  WS-BATCH-PREFIX = '#CL'
 20277         GO TO 4505-READ-PREV-RECORD.
 20278
 20279     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20280        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20281           GO TO 4505-READ-PREV-RECORD
 20282        ELSE
 20283           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20284              GO TO 4510-CHECK-REC-TYPE
 20285           ELSE
 20286              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20287                 GO TO 4510-CHECK-REC-TYPE
 20288              ELSE
 20289                 GO TO 4505-READ-PREV-RECORD.
 20290
 20291     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20292        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20293           GO TO 4505-READ-PREV-RECORD.
 20294
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 372
* EL6311.cbl
 20295 4510-CHECK-REC-TYPE.
 20296     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20297         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20298             NEXT SENTENCE
 20299         ELSE
 20300             GO TO 4505-READ-PREV-RECORD.
 20301
 20302     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20303         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20304             NEXT SENTENCE
 20305        ELSE
 20306             GO TO 4505-READ-PREV-RECORD.
 20307
 20308     IF NOT DISPLAY-CHANGE-RECORDS AND
 20309            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20310        GO TO 4505-READ-PREV-RECORD.
 20311
 20312     IF DISPLAY-HOLD-RECORDS AND
 20313        NOT PB-RECORD-ON-HOLD
 20314          GO TO 4505-READ-PREV-RECORD.
 20315
 20316     IF PB-ISSUE
 20317        IF DISPLAY-CHK-REQ-RECORDS
 20318           GO TO 4505-READ-PREV-RECORD.
 20319
 20320     IF PB-ISSUE
 20321        IF ISSUE-WITH-WARNING
 20322           IF PB-WARNING-ERRORS
 20323              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20324                  GO TO 4505-READ-PREV-RECORD
 20325              ELSE
 20326                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20327                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20328                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20329                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20330                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20331                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20332                 GO TO 7000-DISPLAY-ISSUES
 20333           ELSE
 20334              GO TO 4505-READ-PREV-RECORD.
 20335
 20336     IF PB-ISSUE
 20337        IF (ISSUES-IN-ERROR AND
 20338            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20339            ALL-ISSUES
 20340            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20341            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20342            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20343            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20344            MOVE PB-SV-STATE            TO PI-SV-STATE
 20345            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20346            GO TO 7000-DISPLAY-ISSUES
 20347        ELSE
 20348            GO TO 4505-READ-PREV-RECORD.
 20349
 20350     IF PB-CANCELLATION
 20351        IF DISPLAY-CHK-REQ-RECORDS
 20352           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 373
* EL6311.cbl
 20353              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20354              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20355              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20356              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20357              MOVE PB-SV-STATE            TO PI-SV-STATE
 20358              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20359              GO TO 7100-DISPLAY-CANCELS
 20360           ELSE
 20361              GO TO 4505-READ-PREV-RECORD.
 20362
 20363     IF PB-CANCELLATION
 20364        IF CANCEL-WITH-WARNING
 20365           IF PB-WARNING-ERRORS
 20366              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20367                  GO TO 4505-READ-PREV-RECORD
 20368              ELSE
 20369                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20370                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20371                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20372                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20373                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20374                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20375                 GO TO 7100-DISPLAY-CANCELS
 20376           ELSE
 20377              GO TO 4505-READ-PREV-RECORD.
 20378
 20379     IF PB-CANCELLATION
 20380        IF (CANCEL-IN-ERROR  AND
 20381            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20382            ALL-CANCELS
 20383            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20384            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20385            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20386            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20387            MOVE PB-SV-STATE            TO PI-SV-STATE
 20388            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20389            GO TO 7100-DISPLAY-CANCELS.
 20390
 20391     GO TO 4505-READ-PREV-RECORD.
 20392
 20393 4550-END-RECORDS.
 20394     IF PI-MAP-NAME = EL631B
 20395        MOVE -1                  TO BMAINTL
 20396     ELSE
 20397        IF PI-MAP-NAME = EL631C
 20398           MOVE -1               TO CMAINTL
 20399        ELSE
 20400           MOVE -1               TO DPFENTRL.
 20401
 20402     MOVE ER-2255               TO EMI-ERROR.
 20403     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20404     GO TO 8200-SEND-DATAONLY.
 20405
 20406 4570-NOT-FOUND.
 20407
 20408******************************************************************
 20409*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20410******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 374
* EL6311.cbl
 20411
 20412
 20413* EXEC CICS RESETBR
 20414*         DATASET    (FILE-ID-ERPNDB2)
 20415*         RIDFLD     (ERPNDB-ALT-KEY)
 20416*    END-EXEC.
 20417     MOVE 0
 20418       TO DFHEIV11
 20419*    MOVE '&4         G          &   #00017439' TO DFHEIV0
 20420     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20422     MOVE X'2020233030303137343339' TO DFHEIV0(25:11)
 20423     CALL 'kxdfhei1' USING DFHEIV0,
 20424           FILE-ID-ERPNDB2,
 20425           ERPNDB-ALT-KEY,
 20426           DFHEIV99,
 20427           DFHEIV11,
 20428           DFHEIV99
 20429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20430
 20431
 20432
 20433* EXEC CICS READNEXT
 20434*         DATASET    (FILE-ID-ERPNDB2)
 20435*         SET        (ADDRESS OF PENDING-BUSINESS)
 20436*         RIDFLD     (ERPNDB-ALT-KEY)
 20437*    END-EXEC.
 20438     MOVE 0
 20439       TO DFHEIV11
 20440*    MOVE '&.S                   )   #00017444' TO DFHEIV0
 20441     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20442     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20443     MOVE X'2020233030303137343434' TO DFHEIV0(25:11)
 20444     CALL 'kxdfhei1' USING DFHEIV0,
 20445           FILE-ID-ERPNDB2,
 20446           DFHEIV20,
 20447           DFHEIV99,
 20448           ERPNDB-ALT-KEY,
 20449           DFHEIV99,
 20450           DFHEIV11,
 20451           DFHEIV99,
 20452           DFHEIV99
 20453     SET ADDRESS OF PENDING-BUSINESS TO
 20454         DFHEIV20
 20455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20456
 20457
 20458
 20459* EXEC CICS READPREV
 20460*         DATASET    (FILE-ID-ERPNDB2)
 20461*         SET        (ADDRESS OF PENDING-BUSINESS)
 20462*         RIDFLD     (ERPNDB-ALT-KEY)
 20463*    END-EXEC.
 20464     MOVE 0
 20465       TO DFHEIV11
 20466*    MOVE '&0S                   )   #00017450' TO DFHEIV0
 20467     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20468     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 375
* EL6311.cbl
 20469     MOVE X'2020233030303137343530' TO DFHEIV0(25:11)
 20470     CALL 'kxdfhei1' USING DFHEIV0,
 20471           FILE-ID-ERPNDB2,
 20472           DFHEIV20,
 20473           DFHEIV99,
 20474           ERPNDB-ALT-KEY,
 20475           DFHEIV99,
 20476           DFHEIV11,
 20477           DFHEIV99,
 20478           DFHEIV99
 20479     SET ADDRESS OF PENDING-BUSINESS TO
 20480         DFHEIV20
 20481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20482
 20483
 20484 4580-READ-PREV-RECORD.
 20485
 20486* EXEC CICS READPREV
 20487*         DATASET    (FILE-ID-ERPNDB2)
 20488*         SET        (ADDRESS OF PENDING-BUSINESS)
 20489*         RIDFLD     (ERPNDB-ALT-KEY)
 20490*    END-EXEC.
 20491     MOVE 0
 20492       TO DFHEIV11
 20493*    MOVE '&0S                   )   #00017457' TO DFHEIV0
 20494     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20495     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20496     MOVE X'2020233030303137343537' TO DFHEIV0(25:11)
 20497     CALL 'kxdfhei1' USING DFHEIV0,
 20498           FILE-ID-ERPNDB2,
 20499           DFHEIV20,
 20500           DFHEIV99,
 20501           ERPNDB-ALT-KEY,
 20502           DFHEIV99,
 20503           DFHEIV11,
 20504           DFHEIV99,
 20505           DFHEIV99
 20506     SET ADDRESS OF PENDING-BUSINESS TO
 20507         DFHEIV20
 20508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20509
 20510
 20511     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20512
 20513     IF WS-BATCH-PREFIX = '#CL'
 20514        GO TO 4580-READ-PREV-RECORD.
 20515
 20516     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20517     GO TO 4505-READ-PREV-RECORD.
 20518
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 376
* EL6311.cbl
 20520
 20521******************************************************************
 20522*                                                                *
 20523*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20524*                                                                *
 20525******************************************************************
 20526
 20527 4600-BROWSE-PRIMARY-BACKWARD.
 20528        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20529
 20530     IF ERPNDB-BATCH-SEQ-NO = +9999
 20531        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20532
 20533        IF ERPNDB-BATCH-SEQ-NO = +0000
 20534           GO TO 4650-END-BATCH
 20535        ELSE
 20536           IF PI-MAP-NAME NOT = EL631D
 20537              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20538                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20539              ELSE
 20540                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20541                 IF DISPLAY-CHANGE-RECORDS
 20542                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20543                 ELSE
 20544                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20545
 20546
 20547* EXEC CICS HANDLE CONDITION
 20548*         NOTFND    (4680-NOT-FOUND)
 20549*         ENDFILE   (4680-NOT-FOUND)
 20550*    END-EXEC.
 20551*    MOVE '"$I''                  ! O #00017498' TO DFHEIV0
 20552     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20554     MOVE X'4F20233030303137343938' TO DFHEIV0(25:11)
 20555     CALL 'kxdfhei1' USING DFHEIV0
 20556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20557
 20558
 20559 4605-READ-NEXT.
 20560     IF ERPNDB-BATCH-SEQ-NO = +0000
 20561        GO TO 4650-END-BATCH.
 20562
 20563     IF PI-DISPLAY-ORIGINAL-BATCH
 20564        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20565     ELSE
 20566        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20567
 20568
 20569* EXEC CICS READ
 20570*         DATASET   (FILE-ID)
 20571*         SET       (ADDRESS OF PENDING-BUSINESS)
 20572*         RIDFLD    (ERPNDB-KEY)
 20573*    END-EXEC.
 20574*    MOVE '&"S        E          (   #00017512' TO DFHEIV0
 20575     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20576     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20577     MOVE X'2020233030303137353132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 377
* EL6311.cbl
 20578     CALL 'kxdfhei1' USING DFHEIV0,
 20579           FILE-ID,
 20580           DFHEIV20,
 20581           DFHEIV99,
 20582           ERPNDB-KEY,
 20583           DFHEIV99,
 20584           DFHEIV99,
 20585           DFHEIV99
 20586     SET ADDRESS OF PENDING-BUSINESS TO
 20587         DFHEIV20
 20588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20589
 20590
 20591     IF NOT  PI-PRIMARY-WITH-SELECT
 20592        GO TO 4607-CHECK-REC-TYPE.
 20593
 20594     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20595
 20596     IF  WS-BATCH-PREFIX = '#CL'
 20597         GO TO 4610-BUMP-SEQ.
 20598
 20599     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20600        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20601           GO TO 4610-BUMP-SEQ
 20602        ELSE
 20603           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20604              GO TO 4607-CHECK-REC-TYPE
 20605           ELSE
 20606              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20607                 GO TO 4607-CHECK-REC-TYPE
 20608              ELSE
 20609                 GO TO 4610-BUMP-SEQ.
 20610
 20611     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20612        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20613           GO TO 4610-BUMP-SEQ.
 20614
 20615 4607-CHECK-REC-TYPE.
 20616     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20617         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20618             NEXT SENTENCE
 20619         ELSE
 20620             GO TO 4610-BUMP-SEQ.
 20621
 20622     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20623         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20624             NEXT SENTENCE
 20625        ELSE
 20626             GO TO 4610-BUMP-SEQ.
 20627
 20628     IF NOT DISPLAY-CHANGE-RECORDS AND
 20629            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20630        GO TO 4610-BUMP-SEQ.
 20631
 20632     IF DISPLAY-HOLD-RECORDS AND
 20633        NOT PB-RECORD-ON-HOLD
 20634          GO TO 4610-BUMP-SEQ.
 20635
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 378
* EL6311.cbl
 20636     IF PB-ISSUE
 20637        IF DISPLAY-CHK-REQ-RECORDS
 20638           GO TO 4610-BUMP-SEQ.
 20639
 20640     IF PB-ISSUE
 20641        IF ISSUE-WITH-WARNING
 20642           IF PB-WARNING-ERRORS
 20643              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20644                  GO TO 4610-BUMP-SEQ
 20645              ELSE
 20646                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20647                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20648                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20649                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20650                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20651                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20652                 GO TO 7000-DISPLAY-ISSUES
 20653           ELSE
 20654              GO TO 4610-BUMP-SEQ.
 20655
 20656     IF PB-ISSUE
 20657        IF (ISSUES-IN-ERROR AND
 20658            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20659            ALL-ISSUES
 20660            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20661            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20662            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20663            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20664            MOVE PB-SV-STATE            TO PI-SV-STATE
 20665            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20666            GO TO 7000-DISPLAY-ISSUES
 20667        ELSE
 20668            GO TO 4610-BUMP-SEQ.
 20669
 20670     IF PB-CANCELLATION
 20671        IF DISPLAY-CHK-REQ-RECORDS
 20672           IF PB-C-REFUND-REQUESTED
 20673              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20674              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20675              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20676              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20677              MOVE PB-SV-STATE            TO PI-SV-STATE
 20678              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20679              GO TO 7100-DISPLAY-CANCELS
 20680           ELSE
 20681              GO TO 4610-BUMP-SEQ.
 20682
 20683     IF PB-CANCELLATION
 20684        IF CANCEL-WITH-WARNING
 20685           IF PB-WARNING-ERRORS
 20686              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20687                  GO TO 4610-BUMP-SEQ
 20688              ELSE
 20689                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20690                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20691                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20692                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20693                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 379
* EL6311.cbl
 20694                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20695                 GO TO 7100-DISPLAY-CANCELS
 20696           ELSE
 20697              GO TO 4610-BUMP-SEQ.
 20698
 20699     IF PB-CANCELLATION
 20700        IF (CANCEL-IN-ERROR  AND
 20701            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20702            ALL-CANCELS
 20703            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20704            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20705            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20706            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20707            MOVE PB-SV-STATE            TO PI-SV-STATE
 20708            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20709            GO TO 7100-DISPLAY-CANCELS.
 20710
 20711 4610-BUMP-SEQ.
 20712     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20713        GO TO 4650-END-BATCH.
 20714
 20715     IF DISPLAY-CHANGE-RECORDS
 20716        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20717           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20718        ELSE
 20719           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20720           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20721        ELSE
 20722           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20723           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20724
 20725        GO TO 4605-READ-NEXT.
 20726
 20727 4650-END-BATCH.
 20728     IF PI-MAP-NAME = EL631B
 20729        MOVE -1                  TO BMAINTL
 20730     ELSE
 20731        IF PI-MAP-NAME = EL631C
 20732           MOVE -1               TO CMAINTL
 20733        ELSE
 20734           MOVE -1               TO DPFENTRL.
 20735
 20736     MOVE ER-2252               TO EMI-ERROR.
 20737     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20738     GO TO 8200-SEND-DATAONLY.
 20739
 20740 4680-NOT-FOUND.
 20741     IF DISPLAY-CHANGE-RECORDS
 20742        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20743           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20744        ELSE
 20745           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20746           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20747     ELSE
 20748        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20749
 20750     GO TO 4605-READ-NEXT.
 20751
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 380
* EL6311.cbl
 20753
 20754******************************************************************
 20755*                                                                *
 20756*        B R O W S E   F I L E   B A C K W A R D S               *
 20757*                                                                *
 20758******************************************************************
 20759
 20760 4800-BROWSE-FILE-BACKWARD.
 20761
 20762* EXEC CICS HANDLE CONDITION
 20763*         NOTFND   (4860-NOT-FOUND)
 20764*         ENDFILE  (4850-END-RECORDS)
 20765*    END-EXEC.
 20766*    MOVE '"$I''                  ! P #00017688' TO DFHEIV0
 20767     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20768     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20769     MOVE X'5020233030303137363838' TO DFHEIV0(25:11)
 20770     CALL 'kxdfhei1' USING DFHEIV0
 20771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20772
 20773
 20774     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20775
 20776     IF PI-DISPLAY-ORIGINAL-BATCH
 20777        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20778     ELSE
 20779        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20780
 20781
 20782* EXEC CICS STARTBR
 20783*         DATASET   (FILE-ID)
 20784*         RIDFLD    (ERPNDB-KEY)
 20785*    END-EXEC.
 20786     MOVE 0
 20787       TO DFHEIV11
 20788*    MOVE '&,         G          &   #00017700' TO DFHEIV0
 20789     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20790     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20791     MOVE X'2020233030303137373030' TO DFHEIV0(25:11)
 20792     CALL 'kxdfhei1' USING DFHEIV0,
 20793           FILE-ID,
 20794           ERPNDB-KEY,
 20795           DFHEIV99,
 20796           DFHEIV11,
 20797           DFHEIV99
 20798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20799
 20800
 20801     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20802
 20803
 20804* EXEC CICS READPREV
 20805*         DATASET    (FILE-ID-ERPNDB)
 20806*         SET        (ADDRESS OF PENDING-BUSINESS)
 20807*         RIDFLD     (ERPNDB-KEY)
 20808*    END-EXEC.
 20809     MOVE 0
 20810       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 381
* EL6311.cbl
 20811*    MOVE '&0S                   )   #00017707' TO DFHEIV0
 20812     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20813     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20814     MOVE X'2020233030303137373037' TO DFHEIV0(25:11)
 20815     CALL 'kxdfhei1' USING DFHEIV0,
 20816           FILE-ID-ERPNDB,
 20817           DFHEIV20,
 20818           DFHEIV99,
 20819           ERPNDB-KEY,
 20820           DFHEIV99,
 20821           DFHEIV11,
 20822           DFHEIV99,
 20823           DFHEIV99
 20824     SET ADDRESS OF PENDING-BUSINESS TO
 20825         DFHEIV20
 20826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20827
 20828
 20829 4810-READ-PREV-RECORD.
 20830
 20831* EXEC CICS READPREV
 20832*         DATASET    (FILE-ID-ERPNDB)
 20833*         SET        (ADDRESS OF PENDING-BUSINESS)
 20834*         RIDFLD     (ERPNDB-KEY)
 20835*    END-EXEC.
 20836     MOVE 0
 20837       TO DFHEIV11
 20838*    MOVE '&0S                   )   #00017714' TO DFHEIV0
 20839     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20840     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20841     MOVE X'2020233030303137373134' TO DFHEIV0(25:11)
 20842     CALL 'kxdfhei1' USING DFHEIV0,
 20843           FILE-ID-ERPNDB,
 20844           DFHEIV20,
 20845           DFHEIV99,
 20846           ERPNDB-KEY,
 20847           DFHEIV99,
 20848           DFHEIV11,
 20849           DFHEIV99,
 20850           DFHEIV99
 20851     SET ADDRESS OF PENDING-BUSINESS TO
 20852         DFHEIV20
 20853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20854
 20855
 20856     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20857        GO TO 4850-END-RECORDS.
 20858
 20859     IF PB-BATCH-TRAILER
 20860        GO TO 4810-READ-PREV-RECORD.
 20861
 20862     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20863
 20864     IF  WS-BATCH-PREFIX = '#CL'
 20865         GO TO 4810-READ-PREV-RECORD.
 20866
 20867     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20868        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 382
* EL6311.cbl
 20869           GO TO 4810-READ-PREV-RECORD
 20870        ELSE
 20871           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20872              GO TO 4820-CHECK-REC-TYPE
 20873           ELSE
 20874              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20875                 GO TO 4820-CHECK-REC-TYPE
 20876              ELSE
 20877                 GO TO 4810-READ-PREV-RECORD.
 20878
 20879     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20880        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20881           GO TO 4810-READ-PREV-RECORD.
 20882
 20883 4820-CHECK-REC-TYPE.
 20884     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20885         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20886             NEXT SENTENCE
 20887         ELSE
 20888             GO TO 4810-READ-PREV-RECORD.
 20889
 20890     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20891         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20892             NEXT SENTENCE
 20893        ELSE
 20894             GO TO 4810-READ-PREV-RECORD.
 20895
 20896     IF NOT DISPLAY-CHANGE-RECORDS AND
 20897            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20898        GO TO 4810-READ-PREV-RECORD.
 20899
 20900     IF DISPLAY-HOLD-RECORDS AND
 20901        NOT PB-RECORD-ON-HOLD
 20902          GO TO 4810-READ-PREV-RECORD.
 20903
 20904     IF PB-ISSUE
 20905        IF DISPLAY-CHK-REQ-RECORDS
 20906           GO TO 4810-READ-PREV-RECORD.
 20907
 20908     IF PB-ISSUE
 20909        IF ISSUE-WITH-WARNING
 20910           IF PB-WARNING-ERRORS
 20911              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20912                  GO TO 4810-READ-PREV-RECORD
 20913              ELSE
 20914                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20915                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20916                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20917                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20918                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20919                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20920                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20921                 GO TO 7000-DISPLAY-ISSUES
 20922           ELSE
 20923              GO TO 4810-READ-PREV-RECORD.
 20924
 20925     IF PB-ISSUE
 20926        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 383
* EL6311.cbl
 20927            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20928            ALL-ISSUES
 20929            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20930            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20931            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20932            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20933            MOVE PB-SV-STATE            TO PI-SV-STATE
 20934            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20935            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20936            GO TO 7000-DISPLAY-ISSUES
 20937        ELSE
 20938            GO TO 4810-READ-PREV-RECORD.
 20939
 20940     IF PB-CANCELLATION
 20941        IF DISPLAY-CHK-REQ-RECORDS
 20942           IF PB-C-REFUND-REQUESTED
 20943              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20944              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20945              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20946              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20947              MOVE PB-SV-STATE            TO PI-SV-STATE
 20948              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20949              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20950              GO TO 7100-DISPLAY-CANCELS
 20951           ELSE
 20952              GO TO 4810-READ-PREV-RECORD.
 20953
 20954     IF PB-CANCELLATION
 20955        IF CANCEL-WITH-WARNING
 20956           IF PB-WARNING-ERRORS
 20957              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20958                  GO TO 4810-READ-PREV-RECORD
 20959              ELSE
 20960                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20961                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20962                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20963                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20964                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20965                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20966                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20967                 GO TO 7100-DISPLAY-CANCELS
 20968           ELSE
 20969              GO TO 4810-READ-PREV-RECORD.
 20970
 20971     IF PB-CANCELLATION
 20972        IF (CANCEL-IN-ERROR  AND
 20973            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20974            ALL-CANCELS
 20975            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20976            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20977            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20978            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20979            MOVE PB-SV-STATE            TO PI-SV-STATE
 20980            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20981            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20982            GO TO 7100-DISPLAY-CANCELS.
 20983
 20984     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 384
* EL6311.cbl
 20985
 20986 4850-END-RECORDS.
 20987     MOVE ER-2252                TO EMI-ERROR.
 20988     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20989
 20990     IF PI-MAP-NAME = EL631B
 20991        MOVE -1                  TO BPFENTRL
 20992     ELSE
 20993        MOVE -1                  TO CPFENTRL.
 20994
 20995     GO TO 8200-SEND-DATAONLY.
 20996
 20997 4860-NOT-FOUND.
 20998
 20999******************************************************************
 21000*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 21001******************************************************************
 21002
 21003
 21004* EXEC CICS RESETBR
 21005*         DATASET    (FILE-ID-ERPNDB)
 21006*         RIDFLD     (ERPNDB-KEY)
 21007*     END-EXEC.
 21008     MOVE 0
 21009       TO DFHEIV11
 21010*    MOVE '&4         G          &   #00017867' TO DFHEIV0
 21011     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21012     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21013     MOVE X'2020233030303137383637' TO DFHEIV0(25:11)
 21014     CALL 'kxdfhei1' USING DFHEIV0,
 21015           FILE-ID-ERPNDB,
 21016           ERPNDB-KEY,
 21017           DFHEIV99,
 21018           DFHEIV11,
 21019           DFHEIV99
 21020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21021
 21022
 21023
 21024* EXEC CICS READNEXT
 21025*         DATASET    (FILE-ID-ERPNDB)
 21026*         SET        (ADDRESS OF PENDING-BUSINESS)
 21027*         RIDFLD     (ERPNDB-KEY)
 21028*    END-EXEC.
 21029     MOVE 0
 21030       TO DFHEIV11
 21031*    MOVE '&.S                   )   #00017872' TO DFHEIV0
 21032     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21033     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21034     MOVE X'2020233030303137383732' TO DFHEIV0(25:11)
 21035     CALL 'kxdfhei1' USING DFHEIV0,
 21036           FILE-ID-ERPNDB,
 21037           DFHEIV20,
 21038           DFHEIV99,
 21039           ERPNDB-KEY,
 21040           DFHEIV99,
 21041           DFHEIV11,
 21042           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 385
* EL6311.cbl
 21043           DFHEIV99
 21044     SET ADDRESS OF PENDING-BUSINESS TO
 21045         DFHEIV20
 21046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21047
 21048
 21049
 21050* EXEC CICS READPREV
 21051*         DATASET    (FILE-ID-ERPNDB)
 21052*         SET        (ADDRESS OF PENDING-BUSINESS)
 21053*         RIDFLD     (ERPNDB-KEY)
 21054*    END-EXEC.
 21055     MOVE 0
 21056       TO DFHEIV11
 21057*    MOVE '&0S                   )   #00017878' TO DFHEIV0
 21058     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21059     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21060     MOVE X'2020233030303137383738' TO DFHEIV0(25:11)
 21061     CALL 'kxdfhei1' USING DFHEIV0,
 21062           FILE-ID-ERPNDB,
 21063           DFHEIV20,
 21064           DFHEIV99,
 21065           ERPNDB-KEY,
 21066           DFHEIV99,
 21067           DFHEIV11,
 21068           DFHEIV99,
 21069           DFHEIV99
 21070     SET ADDRESS OF PENDING-BUSINESS TO
 21071         DFHEIV20
 21072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21073
 21074
 21075     GO TO 4810-READ-PREV-RECORD.
 21076
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 386
* EL6311.cbl
 21078
 21079******************************************************************
 21080*                                                                *
 21081*           B R O W S E   C S R   B A C K W A R D                *
 21082*                                                                *
 21083******************************************************************
 21084
 21085 4900-BROWSE-CSR-BACKWARD.
 21086
 21087     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 21088
 21089
 21090* EXEC CICS HANDLE CONDITION
 21091*         NOTFND   (4970-NOT-FOUND)
 21092*         ENDFILE  (4950-END-RECORDS)
 21093*    END-EXEC
 21094*    MOVE '"$I''                  ! Q #00017898' TO DFHEIV0
 21095     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21097     MOVE X'5120233030303137383938' TO DFHEIV0(25:11)
 21098     CALL 'kxdfhei1' USING DFHEIV0
 21099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21100
 21101
 21102* EXEC CICS STARTBR
 21103*         DATASET   (FILE-ID-ERPNDB4)
 21104*         RIDFLD    (ERPNDB-CSR-KEY)
 21105*    END-EXEC.
 21106     MOVE 0
 21107       TO DFHEIV11
 21108*    MOVE '&,         G          &   #00017903' TO DFHEIV0
 21109     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21110     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21111     MOVE X'2020233030303137393033' TO DFHEIV0(25:11)
 21112     CALL 'kxdfhei1' USING DFHEIV0,
 21113           FILE-ID-ERPNDB4,
 21114           ERPNDB-CSR-KEY,
 21115           DFHEIV99,
 21116           DFHEIV11,
 21117           DFHEIV99
 21118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21119
 21120
 21121     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 21122                                    WS-FIRST-TIME-SW.
 21123
 21124 4905-READ-PREV-RECORD.
 21125
 21126* EXEC CICS READPREV
 21127*         DATASET    (FILE-ID-ERPNDB4)
 21128*         SET        (ADDRESS OF PENDING-BUSINESS)
 21129*         RIDFLD     (ERPNDB-CSR-KEY)
 21130*    END-EXEC.
 21131     MOVE 0
 21132       TO DFHEIV11
 21133*    MOVE '&0S                   )   #00017912' TO DFHEIV0
 21134     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21135     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 387
* EL6311.cbl
 21136     MOVE X'2020233030303137393132' TO DFHEIV0(25:11)
 21137     CALL 'kxdfhei1' USING DFHEIV0,
 21138           FILE-ID-ERPNDB4,
 21139           DFHEIV20,
 21140           DFHEIV99,
 21141           ERPNDB-CSR-KEY,
 21142           DFHEIV99,
 21143           DFHEIV11,
 21144           DFHEIV99,
 21145           DFHEIV99
 21146     SET ADDRESS OF PENDING-BUSINESS TO
 21147         DFHEIV20
 21148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21149
 21150
 21151     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21152
 21153     IF WS-BATCH-PREFIX = '#CL'
 21154         GO TO 4905-READ-PREV-RECORD.
 21155
 21156     IF FIRST-TIME
 21157         MOVE SPACE               TO WS-FIRST-TIME-SW
 21158         GO TO 4905-READ-PREV-RECORD.
 21159
 21160     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 21161        PB-CSR-ID           NOT = PI-PB-CSR-ID
 21162        GO TO 4950-END-RECORDS.
 21163
 21164     IF PB-BATCH-TRAILER
 21165        GO TO 4905-READ-PREV-RECORD.
 21166
 21167     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21168
 21169     IF  WS-BATCH-PREFIX = '#CL'
 21170         GO TO 4905-READ-PREV-RECORD.
 21171
 21172     IF PI-PB-CERT-NO NOT = LOW-VALUES
 21173        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 21174           GO TO 4905-READ-PREV-RECORD
 21175        ELSE
 21176           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 21177              GO TO 4910-CHECK-REC-TYPE
 21178           ELSE
 21179              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 21180                 GO TO 4910-CHECK-REC-TYPE
 21181              ELSE
 21182                 GO TO 4905-READ-PREV-RECORD.
 21183
 21184     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 21185        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 21186           GO TO 4905-READ-PREV-RECORD.
 21187
 21188 4910-CHECK-REC-TYPE.
 21189     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21190         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21191             NEXT SENTENCE
 21192         ELSE
 21193             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 388
* EL6311.cbl
 21194
 21195     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21196         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21197             NEXT SENTENCE
 21198        ELSE
 21199             GO TO 4905-READ-PREV-RECORD.
 21200
 21201     IF NOT DISPLAY-CHANGE-RECORDS AND
 21202            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21203        GO TO 4905-READ-PREV-RECORD.
 21204
 21205     IF DISPLAY-HOLD-RECORDS AND
 21206        NOT PB-RECORD-ON-HOLD
 21207          GO TO 4905-READ-PREV-RECORD.
 21208
 21209     IF PB-ISSUE
 21210        IF DISPLAY-CHK-REQ-RECORDS
 21211           GO TO 4905-READ-PREV-RECORD.
 21212
 21213     IF PB-ISSUE
 21214        IF ISSUE-WITH-WARNING
 21215           IF PB-WARNING-ERRORS
 21216              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21217                  GO TO 4505-READ-PREV-RECORD
 21218              ELSE
 21219                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21220                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21221                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21222                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21223                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21224                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21225                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21226                 GO TO 7000-DISPLAY-ISSUES
 21227           ELSE
 21228              GO TO 4905-READ-PREV-RECORD.
 21229
 21230     IF PB-ISSUE
 21231        IF (ISSUES-IN-ERROR AND
 21232            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21233            ALL-ISSUES
 21234            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21235            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21236            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21237            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21238            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21239            MOVE PB-SV-STATE            TO PI-SV-STATE
 21240            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21241            GO TO 7000-DISPLAY-ISSUES
 21242        ELSE
 21243            GO TO 4905-READ-PREV-RECORD.
 21244
 21245     IF PB-CANCELLATION
 21246        IF DISPLAY-CHK-REQ-RECORDS
 21247           IF PB-C-REFUND-REQUESTED
 21248              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21249              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21250              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21251              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 389
* EL6311.cbl
 21252              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21253              MOVE PB-SV-STATE            TO PI-SV-STATE
 21254              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21255              GO TO 7100-DISPLAY-CANCELS
 21256           ELSE
 21257              GO TO 4905-READ-PREV-RECORD.
 21258
 21259     IF PB-CANCELLATION
 21260        IF CANCEL-WITH-WARNING
 21261           IF PB-WARNING-ERRORS
 21262              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21263                  GO TO 4505-READ-PREV-RECORD
 21264              ELSE
 21265                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21266                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21267                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21268                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21269                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21270                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21271                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21272                 GO TO 7100-DISPLAY-CANCELS
 21273           ELSE
 21274              GO TO 4905-READ-PREV-RECORD.
 21275
 21276     IF PB-CANCELLATION
 21277        IF (CANCEL-IN-ERROR  AND
 21278            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21279            ALL-CANCELS
 21280            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21281            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21282            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21283            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21284            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21285            MOVE PB-SV-STATE            TO PI-SV-STATE
 21286            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21287            GO TO 7100-DISPLAY-CANCELS.
 21288
 21289     GO TO 4905-READ-PREV-RECORD.
 21290
 21291 4950-END-RECORDS.
 21292     IF PI-MAP-NAME = EL631B
 21293        MOVE -1                  TO BMAINTL
 21294     ELSE
 21295        IF PI-MAP-NAME = EL631C
 21296           MOVE -1               TO CMAINTL
 21297        ELSE
 21298           MOVE -1               TO DPFENTRL.
 21299
 21300     MOVE ER-2255               TO EMI-ERROR.
 21301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21302     GO TO 8200-SEND-DATAONLY.
 21303
 21304 4970-NOT-FOUND.
 21305
 21306******************************************************************
 21307*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 21308******************************************************************
 21309
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 390
* EL6311.cbl
 21310
 21311* EXEC CICS RESETBR
 21312*         DATASET    (FILE-ID-ERPNDB4)
 21313*         RIDFLD     (ERPNDB-CSR-KEY)
 21314*    END-EXEC.
 21315     MOVE 0
 21316       TO DFHEIV11
 21317*    MOVE '&4         G          &   #00018077' TO DFHEIV0
 21318     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21320     MOVE X'2020233030303138303737' TO DFHEIV0(25:11)
 21321     CALL 'kxdfhei1' USING DFHEIV0,
 21322           FILE-ID-ERPNDB4,
 21323           ERPNDB-CSR-KEY,
 21324           DFHEIV99,
 21325           DFHEIV11,
 21326           DFHEIV99
 21327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21328
 21329
 21330
 21331* EXEC CICS READNEXT
 21332*         DATASET    (FILE-ID-ERPNDB4)
 21333*         SET        (ADDRESS OF PENDING-BUSINESS)
 21334*         RIDFLD     (ERPNDB-CSR-KEY)
 21335*    END-EXEC.
 21336     MOVE 0
 21337       TO DFHEIV11
 21338*    MOVE '&.S                   )   #00018082' TO DFHEIV0
 21339     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21340     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21341     MOVE X'2020233030303138303832' TO DFHEIV0(25:11)
 21342     CALL 'kxdfhei1' USING DFHEIV0,
 21343           FILE-ID-ERPNDB4,
 21344           DFHEIV20,
 21345           DFHEIV99,
 21346           ERPNDB-CSR-KEY,
 21347           DFHEIV99,
 21348           DFHEIV11,
 21349           DFHEIV99,
 21350           DFHEIV99
 21351     SET ADDRESS OF PENDING-BUSINESS TO
 21352         DFHEIV20
 21353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21354
 21355
 21356
 21357* EXEC CICS READPREV
 21358*         DATASET    (FILE-ID-ERPNDB4)
 21359*         SET        (ADDRESS OF PENDING-BUSINESS)
 21360*         RIDFLD     (ERPNDB-CSR-KEY)
 21361*    END-EXEC.
 21362     MOVE 0
 21363       TO DFHEIV11
 21364*    MOVE '&0S                   )   #00018088' TO DFHEIV0
 21365     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21366     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21367     MOVE X'2020233030303138303838' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 391
* EL6311.cbl
 21368     CALL 'kxdfhei1' USING DFHEIV0,
 21369           FILE-ID-ERPNDB4,
 21370           DFHEIV20,
 21371           DFHEIV99,
 21372           ERPNDB-CSR-KEY,
 21373           DFHEIV99,
 21374           DFHEIV11,
 21375           DFHEIV99,
 21376           DFHEIV99
 21377     SET ADDRESS OF PENDING-BUSINESS TO
 21378         DFHEIV20
 21379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21380
 21381
 21382 4980-READ-PREV-RECORD.
 21383
 21384* EXEC CICS READPREV
 21385*         DATASET    (FILE-ID-ERPNDB4)
 21386*         SET        (ADDRESS OF PENDING-BUSINESS)
 21387*         RIDFLD     (ERPNDB-CSR-KEY)
 21388*    END-EXEC.
 21389     MOVE 0
 21390       TO DFHEIV11
 21391*    MOVE '&0S                   )   #00018095' TO DFHEIV0
 21392     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21393     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21394     MOVE X'2020233030303138303935' TO DFHEIV0(25:11)
 21395     CALL 'kxdfhei1' USING DFHEIV0,
 21396           FILE-ID-ERPNDB4,
 21397           DFHEIV20,
 21398           DFHEIV99,
 21399           ERPNDB-CSR-KEY,
 21400           DFHEIV99,
 21401           DFHEIV11,
 21402           DFHEIV99,
 21403           DFHEIV99
 21404     SET ADDRESS OF PENDING-BUSINESS TO
 21405         DFHEIV20
 21406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21407
 21408
 21409     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21410
 21411     IF WS-BATCH-PREFIX = '#CL'
 21412        GO TO 4980-READ-PREV-RECORD.
 21413
 21414     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21415     GO TO 4905-READ-PREV-RECORD.
 21416
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 392
* EL6311.cbl
 21418
 21419
 21420******************************************************************
 21421*                                                                *
 21422*        B R O W S E   B A T C H   H E A D E R S                 *
 21423*                                                                *
 21424******************************************************************
 21425
 21426 5000-BROWSE-BATCH-HEADERS.
 21427
 21428     IF EIBTRNID NOT = TRANS-EXB1
 21429        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21430        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21431        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21432        GO TO 5010-READ-NEXT-RECORD.
 21433
 21434     IF EIBAID = DFHPF4
 21435        MOVE '0'                TO PI-EDIT-SW
 21436        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21437        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21438        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21439        GO TO 5010-READ-NEXT-RECORD.
 21440
 21441     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21442     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21443     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21444
 21445
 21446* EXEC CICS HANDLE CONDITION
 21447*         ENDFILE  (5050-NOT-FOUND)
 21448*    END-EXEC.
 21449*    MOVE '"$''                   ! R #00018137' TO DFHEIV0
 21450     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21451     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21452     MOVE X'5220233030303138313337' TO DFHEIV0(25:11)
 21453     CALL 'kxdfhei1' USING DFHEIV0
 21454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21455
 21456
 21457 5010-READ-NEXT-RECORD.
 21458
 21459* EXEC CICS HANDLE CONDITION
 21460*         NOTFND    (5050-NOT-FOUND)
 21461*    END-EXEC.
 21462*    MOVE '"$I                   ! S #00018142' TO DFHEIV0
 21463     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21465     MOVE X'5320233030303138313432' TO DFHEIV0(25:11)
 21466     CALL 'kxdfhei1' USING DFHEIV0
 21467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21468
 21469
 21470
 21471* EXEC CICS READ
 21472*         DATASET   (FILE-ID-ERPNDB)
 21473*         SET       (ADDRESS OF PENDING-BUSINESS)
 21474*         RIDFLD    (ERPNDB-KEY)
 21475*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 393
* EL6311.cbl
 21476*    END-EXEC.
 21477*    MOVE '&"S        G          (   #00018146' TO DFHEIV0
 21478     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21479     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21480     MOVE X'2020233030303138313436' TO DFHEIV0(25:11)
 21481     CALL 'kxdfhei1' USING DFHEIV0,
 21482           FILE-ID-ERPNDB,
 21483           DFHEIV20,
 21484           DFHEIV99,
 21485           ERPNDB-KEY,
 21486           DFHEIV99,
 21487           DFHEIV99,
 21488           DFHEIV99
 21489     SET ADDRESS OF PENDING-BUSINESS TO
 21490         DFHEIV20
 21491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21492
 21493
 21494     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21495         GO TO 5050-NOT-FOUND.
 21496
 21497     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21498
 21499     IF WS-BATCH-PREFIX = '#CL'
 21500         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21501         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21502         GO TO 5010-READ-NEXT-RECORD.
 21503
 21504     IF NOT PB-BATCH-TRAILER
 21505         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21506         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21507         GO TO 5010-READ-NEXT-RECORD.
 21508
 21509     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21510         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21511             NEXT SENTENCE
 21512         ELSE
 21513             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21514             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21515             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21516             GO TO 5010-READ-NEXT-RECORD.
 21517
 21518     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21519         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21520             NEXT SENTENCE
 21521        ELSE
 21522             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21523             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21524             GO TO 5010-READ-NEXT-RECORD.
 21525
 21526     IF EIBAID = DFHPF4
 21527        MOVE '0'                TO PI-EDIT-SW
 21528        GO TO 7200-DISPLAY-BATCHES.
 21529
 21530     IF PI-CSR-BROWSE
 21531        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21532           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21533           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 394
* EL6311.cbl
 21534           GO TO 5010-READ-NEXT-RECORD.
 21535
 21536     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21537       IF PI-PB-CARRIER    = SPACES AND
 21538          PI-PB-GROUPING   = SPACES AND
 21539          PI-PB-STATE      = SPACES AND
 21540          PI-PB-ACCOUNT    = SPACES
 21541            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21542            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21543            GO TO 7200-DISPLAY-BATCHES
 21544         ELSE
 21545           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21546              PI-PB-GROUPING   = PB-GROUPING AND
 21547              PI-PB-STATE      = PB-STATE    AND
 21548              PI-PB-ACCOUNT    = PB-ACCOUNT
 21549              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21550              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21551              GO TO 7200-DISPLAY-BATCHES.
 21552
 21553     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21554     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21555
 21556
 21557* EXEC CICS HANDLE CONDITION
 21558*         NOTFND    (5050-NOT-FOUND)
 21559*    END-EXEC.
 21560*    MOVE '"$I                   ! T #00018215' TO DFHEIV0
 21561     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21562     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21563     MOVE X'5420233030303138323135' TO DFHEIV0(25:11)
 21564     CALL 'kxdfhei1' USING DFHEIV0
 21565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21566
 21567
 21568
 21569* EXEC CICS READ
 21570*         DATASET   (FILE-ID-ERPNDB)
 21571*         SET       (ADDRESS OF PENDING-BUSINESS)
 21572*         RIDFLD    (ERPNDB-KEY)
 21573*         GTEQ
 21574*    END-EXEC.
 21575*    MOVE '&"S        G          (   #00018219' TO DFHEIV0
 21576     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21578     MOVE X'2020233030303138323139' TO DFHEIV0(25:11)
 21579     CALL 'kxdfhei1' USING DFHEIV0,
 21580           FILE-ID-ERPNDB,
 21581           DFHEIV20,
 21582           DFHEIV99,
 21583           ERPNDB-KEY,
 21584           DFHEIV99,
 21585           DFHEIV99,
 21586           DFHEIV99
 21587     SET ADDRESS OF PENDING-BUSINESS TO
 21588         DFHEIV20
 21589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21590
 21591
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 395
* EL6311.cbl
 21592     GO TO 5010-READ-NEXT-RECORD.
 21593
 21594 5050-NOT-FOUND.
 21595
 21596******************************************************************
 21597*                                                                *
 21598*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21599*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21600*         PROGRAM.                                               *
 21601*                                                                *
 21602******************************************************************
 21603
 21604     IF EIBTRNID NOT = TRANS-EXB1
 21605        IF PENDING-BUS-RECS-FOUND
 21606            NEXT SENTENCE
 21607          ELSE
 21608            MOVE '9'            TO PI-BROWSE-SW
 21609            GO TO 9400-CLEAR.
 21610
 21611     MOVE ER-2256                TO EMI-ERROR.
 21612     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21613
 21614     IF PI-MAP-NAME = SPACES
 21615        MOVE EL631D              TO PI-MAP-NAME
 21616        MOVE -1                  TO DPFENTRL
 21617        GO TO 8100-SEND-INITIAL-MAP.
 21618
 21619     IF PI-MAP-NAME = EL631B
 21620        MOVE -1                  TO BMAINTL
 21621     ELSE
 21622        IF PI-MAP-NAME = EL631C
 21623           MOVE -1               TO CMAINTL
 21624        ELSE
 21625           MOVE -1               TO DPFENTRL
 21626           GO TO 8200-SEND-DATAONLY.
 21627
 21628     GO TO 8100-SEND-INITIAL-MAP.
 21629
 21630     .
 21631 5100-PROCESS-POL-RESC.
 21632     MOVE ZEROS                  TO CG-LF-BENCD
 21633                                    CG-AH-BENCD
 21634                                    CG-LF-CAN-AMT
 21635                                    CG-AH-CAN-AMT
 21636     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21637                                    CG-AH-CAN-DT
 21638     MOVE SPACES                 TO CG-BATCH-NO
 21639     MOVE '4'                    TO CG-OPTION-CODE
 21640     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21641     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21642     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21643     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21644     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21645     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21646     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21647     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21648     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21649     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 396
* EL6311.cbl
 21650     MOVE PI-PREV-ALT-KEY (1:33)
 21651                                 TO CG-CERT-KEY
 21652     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21653     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21654                                    CG-AH-CAN-AMT
 21655     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21656                                    CG-AH-CAN-DT
 21657     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21658     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21659      display 'about to cancel ' cg-cert-key
 21660
 21661* EXEC CICS LINK
 21662*        PROGRAM  ('ELCANC')
 21663*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21664*    END-EXEC
 21665     MOVE LENGTH OF
 21666      CANCEL-GEN-PASS-AREA
 21667       TO DFHEIV11
 21668     MOVE 'ELCANC' TO DFHEIV1
 21669*    MOVE '."C                   (   #00018294' TO DFHEIV0
 21670     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21671     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21672     MOVE X'2020233030303138323934' TO DFHEIV0(25:11)
 21673     CALL 'kxdfhei1' USING DFHEIV0,
 21674           DFHEIV1,
 21675           CANCEL-GEN-PASS-AREA,
 21676           DFHEIV11,
 21677           DFHEIV99,
 21678           DFHEIV99,
 21679           DFHEIV99,
 21680           DFHEIV99
 21681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21682     IF CG-SUCCESS
 21683        CONTINUE
 21684     ELSE
 21685        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21686        MOVE '3'                 TO EMI-SWITCH1
 21687        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21688        EVALUATE TRUE
 21689           WHEN CG-DATE-ERROR
 21690             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21691           WHEN CG-CERT-NOT-FOUND
 21692             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21693           WHEN CG-AMOUNT-ERROR
 21694             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21695           WHEN CG-OPTION-ERROR
 21696             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21697           WHEN CG-PREV-CAN
 21698             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21699           WHEN CG-INVALID-DATA
 21700             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21701           WHEN CG-NO-ACCT-MSTR
 21702             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21703           WHEN CG-SFX-A-EXIST
 21704             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21705           WHEN CG-MISC-ERROR
 21706             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21707           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 397
* EL6311.cbl
 21708             MOVE ' ERROR - ELCANC - RETURN '
 21709                                 TO EMI-ERROR-TEXT (1) (12:25)
 21710        END-EVALUATE
 21711        GO TO 8200-SEND-DATAONLY
 21712     END-IF
 21713
 21714* EXEC CICS GETMAIN
 21715*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21716*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21717*        INITIMG (GETMAIN-SPACE)
 21718*    END-EXEC
 21719*    MOVE ',"IL                  $   #00018329' TO DFHEIV0
 21720     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21722     MOVE X'2020233030303138333239' TO DFHEIV0(25:11)
 21723     CALL 'kxdfhei1' USING DFHEIV0,
 21724           DFHEIV20,
 21725           ELCRTT-RECORD-LENGTH,
 21726           GETMAIN-SPACE
 21727     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21728         DFHEIV20
 21729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21730
 21731     move ' '                    to ws-elcrtt-update-sw
 21732     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21733     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21734
 21735
 21736* EXEC CICS READ
 21737*        UPDATE
 21738*        DATASET  (CRTT-ID)
 21739*        RIDFLD   (ELCRTT-KEY)
 21740*        INTO     (CERTIFICATE-TRAILERS)
 21741*        resp     (ws-response)
 21742*    END-EXEC
 21743     MOVE LENGTH OF
 21744      CERTIFICATE-TRAILERS
 21745       TO DFHEIV11
 21746*    MOVE '&"IL       EU         (  N#00018339' TO DFHEIV0
 21747     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21748     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21749     MOVE X'204E233030303138333339' TO DFHEIV0(25:11)
 21750     CALL 'kxdfhei1' USING DFHEIV0,
 21751           CRTT-ID,
 21752           CERTIFICATE-TRAILERS,
 21753           DFHEIV11,
 21754           ELCRTT-KEY,
 21755           DFHEIV99,
 21756           DFHEIV99,
 21757           DFHEIV99
 21758     MOVE EIBRESP  TO ws-response
 21759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21760
 21761     if resp-normal
 21762        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21763                  'E' or 'F' or 'G'
 21764           move 'J'              to cs-claim-verification-status
 21765           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 398
* EL6311.cbl
 21766        end-if
 21767        if update-elcrtt
 21768
 21769* EXEC CICS REWRITE
 21770*             DATASET    (crtt-ID)
 21771*             FROM       (CERTIFICATE-TRAILERS)
 21772*          END-EXEC
 21773     MOVE LENGTH OF
 21774      CERTIFICATE-TRAILERS
 21775       TO DFHEIV11
 21776*    MOVE '&& L                  %   #00018354' TO DFHEIV0
 21777     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21778     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21779     MOVE X'2020233030303138333534' TO DFHEIV0(25:11)
 21780     CALL 'kxdfhei1' USING DFHEIV0,
 21781           crtt-ID,
 21782           CERTIFICATE-TRAILERS,
 21783           DFHEIV11,
 21784           DFHEIV99
 21785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21786        else
 21787
 21788* exec cics unlock
 21789*             dataset    (crtt-ID)
 21790*          end-exec
 21791*    MOVE '&*                    #   #00018359' TO DFHEIV0
 21792     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21793     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21794     MOVE X'2020233030303138333539' TO DFHEIV0(25:11)
 21795     CALL 'kxdfhei1' USING DFHEIV0,
 21796           crtt-ID,
 21797           DFHEIV99
 21798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21799        end-if
 21800     end-if
 21801     .
 21802 5100-EXIT.
 21803     EXIT.
 21804
 21805******************************************************************
 21806*                                                                *
 21807*        B R O W S E   B A T C H   B A C K W A R D S             *
 21808*                                                                *
 21809******************************************************************
 21810
 21811 5500-BROWSE-BATCH-BACKWARD.
 21812
 21813* EXEC CICS HANDLE CONDITION
 21814*         NOTFND   (5550-END-RECORDS)
 21815*         ENDFILE  (5550-END-RECORDS)
 21816*    END-EXEC.
 21817*    MOVE '"$I''                  ! U #00018375' TO DFHEIV0
 21818     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21820     MOVE X'5520233030303138333735' TO DFHEIV0(25:11)
 21821     CALL 'kxdfhei1' USING DFHEIV0
 21822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21823
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 399
* EL6311.cbl
 21824
 21825 5505-START-BROWSE.
 21826     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21827     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21828     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21829
 21830
 21831* EXEC CICS STARTBR
 21832*         DATASET   (FILE-ID-ERPNDB)
 21833*         RIDFLD    (ERPNDB-ALT-KEY)
 21834*    END-EXEC.
 21835     MOVE 0
 21836       TO DFHEIV11
 21837*    MOVE '&,         G          &   #00018385' TO DFHEIV0
 21838     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21839     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21840     MOVE X'2020233030303138333835' TO DFHEIV0(25:11)
 21841     CALL 'kxdfhei1' USING DFHEIV0,
 21842           FILE-ID-ERPNDB,
 21843           ERPNDB-ALT-KEY,
 21844           DFHEIV99,
 21845           DFHEIV11,
 21846           DFHEIV99
 21847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21848
 21849
 21850     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21851
 21852
 21853* EXEC CICS READNEXT
 21854*         DATASET    (FILE-ID-ERPNDB)
 21855*         SET        (ADDRESS OF PENDING-BUSINESS)
 21856*         RIDFLD     (ERPNDB-KEY)
 21857*    END-EXEC.
 21858     MOVE 0
 21859       TO DFHEIV11
 21860*    MOVE '&.S                   )   #00018392' TO DFHEIV0
 21861     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21862     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21863     MOVE X'2020233030303138333932' TO DFHEIV0(25:11)
 21864     CALL 'kxdfhei1' USING DFHEIV0,
 21865           FILE-ID-ERPNDB,
 21866           DFHEIV20,
 21867           DFHEIV99,
 21868           ERPNDB-KEY,
 21869           DFHEIV99,
 21870           DFHEIV11,
 21871           DFHEIV99,
 21872           DFHEIV99
 21873     SET ADDRESS OF PENDING-BUSINESS TO
 21874         DFHEIV20
 21875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21876
 21877
 21878
 21879* EXEC CICS READPREV
 21880*         DATASET    (FILE-ID-ERPNDB)
 21881*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 400
* EL6311.cbl
 21882*         RIDFLD     (ERPNDB-KEY)
 21883*    END-EXEC.
 21884     MOVE 0
 21885       TO DFHEIV11
 21886*    MOVE '&0S                   )   #00018398' TO DFHEIV0
 21887     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21888     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21889     MOVE X'2020233030303138333938' TO DFHEIV0(25:11)
 21890     CALL 'kxdfhei1' USING DFHEIV0,
 21891           FILE-ID-ERPNDB,
 21892           DFHEIV20,
 21893           DFHEIV99,
 21894           ERPNDB-KEY,
 21895           DFHEIV99,
 21896           DFHEIV11,
 21897           DFHEIV99,
 21898           DFHEIV99
 21899     SET ADDRESS OF PENDING-BUSINESS TO
 21900         DFHEIV20
 21901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21902
 21903
 21904
 21905* EXEC CICS READPREV
 21906*         DATASET    (FILE-ID-ERPNDB)
 21907*         SET        (ADDRESS OF PENDING-BUSINESS)
 21908*         RIDFLD     (ERPNDB-KEY)
 21909*    END-EXEC.
 21910     MOVE 0
 21911       TO DFHEIV11
 21912*    MOVE '&0S                   )   #00018404' TO DFHEIV0
 21913     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21914     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21915     MOVE X'2020233030303138343034' TO DFHEIV0(25:11)
 21916     CALL 'kxdfhei1' USING DFHEIV0,
 21917           FILE-ID-ERPNDB,
 21918           DFHEIV20,
 21919           DFHEIV99,
 21920           ERPNDB-KEY,
 21921           DFHEIV99,
 21922           DFHEIV11,
 21923           DFHEIV99,
 21924           DFHEIV99
 21925     SET ADDRESS OF PENDING-BUSINESS TO
 21926         DFHEIV20
 21927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21928
 21929
 21930     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21931        GO TO 5550-END-RECORDS.
 21932
 21933     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21934
 21935     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21936
 21937     IF  WS-BATCH-PREFIX = '#CL'
 21938             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21939
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 401
* EL6311.cbl
 21940* EXEC CICS ENDBR
 21941*                 DATASET  (FILE-ID-ERPNDB)
 21942*            END-EXEC
 21943     MOVE 0
 21944       TO DFHEIV11
 21945*    MOVE '&2                    $   #00018419' TO DFHEIV0
 21946     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21947     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21948     MOVE X'2020233030303138343139' TO DFHEIV0(25:11)
 21949     CALL 'kxdfhei1' USING DFHEIV0,
 21950           FILE-ID-ERPNDB,
 21951           DFHEIV11,
 21952           DFHEIV99
 21953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21954         GO TO 5505-START-BROWSE.
 21955
 21956     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21957         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21958             NEXT SENTENCE
 21959         ELSE
 21960             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21961
 21962* EXEC CICS ENDBR
 21963*                 DATASET  (FILE-ID-ERPNDB)
 21964*            END-EXEC
 21965     MOVE 0
 21966       TO DFHEIV11
 21967*    MOVE '&2                    $   #00018429' TO DFHEIV0
 21968     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21969     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21970     MOVE X'2020233030303138343239' TO DFHEIV0(25:11)
 21971     CALL 'kxdfhei1' USING DFHEIV0,
 21972           FILE-ID-ERPNDB,
 21973           DFHEIV11,
 21974           DFHEIV99
 21975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21976             GO TO 5505-START-BROWSE.
 21977
 21978
 21979     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21980         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21981             NEXT SENTENCE
 21982        ELSE
 21983             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21984
 21985* EXEC CICS ENDBR
 21986*                 DATASET  (FILE-ID-ERPNDB)
 21987*            END-EXEC
 21988     MOVE 0
 21989       TO DFHEIV11
 21990*    MOVE '&2                    $   #00018440' TO DFHEIV0
 21991     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21992     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21993     MOVE X'2020233030303138343430' TO DFHEIV0(25:11)
 21994     CALL 'kxdfhei1' USING DFHEIV0,
 21995           FILE-ID-ERPNDB,
 21996           DFHEIV11,
 21997           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 402
* EL6311.cbl
 21998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21999             GO TO 5505-START-BROWSE.
 22000
 22001     IF NOT PB-BATCH-TRAILER
 22002        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 22003
 22004* EXEC CICS ENDBR
 22005*            DATASET  (FILE-ID-ERPNDB)
 22006*       END-EXEC
 22007     MOVE 0
 22008       TO DFHEIV11
 22009*    MOVE '&2                    $   #00018447' TO DFHEIV0
 22010     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22011     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22012     MOVE X'2020233030303138343437' TO DFHEIV0(25:11)
 22013     CALL 'kxdfhei1' USING DFHEIV0,
 22014           FILE-ID-ERPNDB,
 22015           DFHEIV11,
 22016           DFHEIV99
 22017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22018        GO TO 5505-START-BROWSE.
 22019
 22020     IF PI-CSR-BROWSE
 22021        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 22022           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 22023
 22024* EXEC CICS ENDBR
 22025*               DATASET  (FILE-ID-ERPNDB)
 22026*          END-EXEC
 22027     MOVE 0
 22028       TO DFHEIV11
 22029*    MOVE '&2                    $   #00018455' TO DFHEIV0
 22030     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22031     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22032     MOVE X'2020233030303138343535' TO DFHEIV0(25:11)
 22033     CALL 'kxdfhei1' USING DFHEIV0,
 22034           FILE-ID-ERPNDB,
 22035           DFHEIV11,
 22036           DFHEIV99
 22037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22038           GO TO 5505-START-BROWSE.
 22039
 22040     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 22041        IF PI-PB-CARRIER    = SPACES AND
 22042           PI-PB-GROUPING   = SPACES AND
 22043           PI-PB-STATE      = SPACES AND
 22044           PI-PB-ACCOUNT    = SPACES
 22045             GO TO 7200-DISPLAY-BATCHES
 22046          ELSE
 22047            IF PI-PB-CARRIER    = PB-CARRIER  AND
 22048               PI-PB-GROUPING   = PB-GROUPING AND
 22049               PI-PB-STATE      = PB-STATE    AND
 22050               PI-PB-ACCOUNT    = PB-ACCOUNT
 22051                 GO TO 7200-DISPLAY-BATCHES.
 22052
 22053     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 22054
 22055
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 403
* EL6311.cbl
 22056* EXEC CICS ENDBR
 22057*         DATASET  (FILE-ID-ERPNDB)
 22058*    END-EXEC.
 22059     MOVE 0
 22060       TO DFHEIV11
 22061*    MOVE '&2                    $   #00018475' TO DFHEIV0
 22062     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22063     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22064     MOVE X'2020233030303138343735' TO DFHEIV0(25:11)
 22065     CALL 'kxdfhei1' USING DFHEIV0,
 22066           FILE-ID-ERPNDB,
 22067           DFHEIV11,
 22068           DFHEIV99
 22069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22070
 22071
 22072     GO TO 5505-START-BROWSE.
 22073
 22074 5550-END-RECORDS.
 22075     MOVE ER-2257                TO EMI-ERROR.
 22076     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22077     MOVE -1                     TO DPFENTRL.
 22078
 22079     GO TO 8200-SEND-DATAONLY.
 22080
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 404
* EL6311.cbl
 22082
 22083******************************************************************
 22084*                                                                *
 22085*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 22086*                                                                *
 22087******************************************************************
 22088
 22089 6000-CREATE-TEMP-STORAGE.
 22090
 22091
 22092* EXEC CICS HANDLE CONDITION
 22093*        QIDERR  (6050-QID-ERROR)
 22094*    END-EXEC.
 22095*    MOVE '"$N                   ! V #00018498' TO DFHEIV0
 22096     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 22097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22098     MOVE X'5620233030303138343938' TO DFHEIV0(25:11)
 22099     CALL 'kxdfhei1' USING DFHEIV0
 22100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22101
 22102
 22103
 22104* EXEC CICS WRITEQ TS
 22105*        QUEUE    (QID)
 22106*        FROM     (PROGRAM-INTERFACE-BLOCK)
 22107*        LENGTH   (WS-COMM-LENGTH)
 22108*        ITEM     (W-ONE)
 22109*    END-EXEC.
 22110*    MOVE '*" I   L              ''   #00018502' TO DFHEIV0
 22111     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 22112     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22113     MOVE X'2020233030303138353032' TO DFHEIV0(25:11)
 22114     CALL 'kxdfhei1' USING DFHEIV0,
 22115           QID,
 22116           PROGRAM-INTERFACE-BLOCK,
 22117           WS-COMM-LENGTH,
 22118           W-ONE,
 22119           DFHEIV99,
 22120           DFHEIV99
 22121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22122
 22123
 22124 6000-EXIT.
 22125      EXIT.
 22126
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 405
* EL6311.cbl
 22128
 22129******************************************************************
 22130*                                                                *
 22131*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 22132*                                                                *
 22133******************************************************************
 22134
 22135 6050-RECOVER-TEMP-STORAGE.
 22136     IF PGM-NAME = XCTL-EL6312
 22137        GO TO 6050-EXIT.
 22138
 22139     IF PGM-NAME = XCTL-EL6313
 22140        GO TO 6050-EXIT.
 22141
 22142     IF PGM-NAME = XCTL-EL6315
 22143         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 22144     END-IF
 22145
 22146     IF PGM-NAME = XCTL-EL6316
 22147         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 22148     END-IF
 22149
 22150
 22151* EXEC CICS HANDLE CONDITION
 22152*        QIDERR  (6050-QID-ERROR)
 22153*    END-EXEC.
 22154*    MOVE '"$N                   ! W #00018535' TO DFHEIV0
 22155     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 22156     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22157     MOVE X'5720233030303138353335' TO DFHEIV0(25:11)
 22158     CALL 'kxdfhei1' USING DFHEIV0
 22159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22160
 22161
 22162
 22163* EXEC CICS READQ TS
 22164*         QUEUE   (QID)
 22165*         INTO    (PROGRAM-INTERFACE-BLOCK)
 22166*         LENGTH  (WS-COMM-LENGTH)
 22167*         ITEM    (W-ONE)
 22168*     END-EXEC.
 22169*    MOVE '*$II   L              ''   #00018539' TO DFHEIV0
 22170     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 22171     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22172     MOVE X'2020233030303138353339' TO DFHEIV0(25:11)
 22173     CALL 'kxdfhei1' USING DFHEIV0,
 22174           QID,
 22175           PROGRAM-INTERFACE-BLOCK,
 22176           WS-COMM-LENGTH,
 22177           W-ONE,
 22178           DFHEIV99,
 22179           DFHEIV99
 22180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22181
 22182
 22183 6050-DELETE-TEMP-STORAGE.
 22184
 22185
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 406
* EL6311.cbl
 22186* EXEC CICS DELETEQ TS
 22187*        QUEUE   (QID)
 22188*    END-EXEC.
 22189*    MOVE '*&                    #   #00018548' TO DFHEIV0
 22190     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 22191     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22192     MOVE X'2020233030303138353438' TO DFHEIV0(25:11)
 22193     CALL 'kxdfhei1' USING DFHEIV0,
 22194           QID,
 22195           DFHEIV99
 22196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22197
 22198
 22199     GO TO 6050-EXIT.
 22200
 22201 6050-QID-ERROR.
 22202     MOVE ER-0033                TO EMI-ERROR
 22203     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22204
 22205 6050-EXIT.
 22206      EXIT.
 22207
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 407
* EL6311.cbl
 22209
 22210******************************************************************
 22211*                                                                *
 22212*            T E R M   C O N V E R S I O N                       *
 22213*                                                                *
 22214******************************************************************
 22215
 22216 6100-TERM-CONVERSION.
 22217
 22218     IF PI-BPMTS = ZERO
 22219         GO TO 6199-EXIT.
 22220
 22221     IF PI-BMODE = ' ' OR 'M'
 22222         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 22223         GO TO 6105-ROUND-TERM.
 22224
 22225     IF PI-BMODE = 'S'
 22226         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 22227         GO TO 6105-ROUND-TERM.
 22228
 22229     IF PI-BMODE = 'W'
 22230         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 22231         GO TO 6105-ROUND-TERM.
 22232
 22233     IF PI-BMODE = 'B'
 22234         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 22235         GO TO 6105-ROUND-TERM.
 22236
 22237     IF PI-BMODE = 'T'
 22238         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 22239
 22240 6105-ROUND-TERM.
 22241
 22242     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 22243         ADD +1                  TO WS-CALC-TERM-WHOLE
 22244         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 22245
 22246     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 22247         GO TO 6125-COMPUTE-TERM-BENEFIT.
 22248
 22249     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 22250         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 22251                                      WS-BTERM    (WS-SUB1)
 22252         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 22253
 22254     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 22255         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 22256             MOVE -1               TO BMODEL
 22257             MOVE ER-2593          TO EMI-ERROR
 22258             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 22259             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22260
 22261 6124-CHECK-BENEFIT.
 22262
 22263     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 22264        GO TO 6126-COMPUTE-BENEFIT.
 22265
 22266     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 408
* EL6311.cbl
 22267
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 409
* EL6311.cbl
 22269******************************************************************
 22270**         COMPUTE TERM AND BENEFIT
 22271******************************************************************
 22272 6125-COMPUTE-TERM-BENEFIT.
 22273
 22274     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 22275        PI-BPMTAMT = ZERO
 22276         GO TO 6199-EXIT.
 22277
 22278     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 22279                                     WS-BTERM  (WS-SUB1).
 22280     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 22281
 22282 6126-COMPUTE-BENEFIT.
 22283
 22284     IF PI-BMODE = 'M' OR  ' '
 22285         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 22286
 22287     IF PI-BMODE = 'W'
 22288         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 22289
 22290     IF PI-BMODE = 'S'
 22291         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 22292
 22293     IF PI-BMODE = 'B'
 22294         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 22295
 22296     IF PI-BMODE = 'T'
 22297         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 22298
 22299     IF WS-SUB1 = +1
 22300        COMPUTE WS-BBEN (WS-SUB1) =
 22301                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 22302
 22303     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 22304     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 22305     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 22306
 22307 6199-EXIT.
 22308     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 410
* EL6311.cbl
 22310
 22311******************************************************************
 22312*                                                                *
 22313*             D I S P L A Y   I S S U E S                        *
 22314*                                                                *
 22315******************************************************************
 22316
 22317 6200-CREATE-VADS.
 22318     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 22319     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 22320     MOVE SPACES                 TO WS-PASS-VADS-REC
 22321
 22322* EXEC CICS GETMAIN
 22323*       SET      (ADDRESS OF PENDING-BUSINESS)
 22324*       LENGTH   (ERPNDB-RECORD-LENGTH)
 22325*       INITIMG  (GETMAIN-SPACE)
 22326*       RESP     (WS-RESPONSE)
 22327*    END-EXEC
 22328*    MOVE ',"IL                  $  N#00018674' TO DFHEIV0
 22329     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22330     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22331     MOVE X'204E233030303138363734' TO DFHEIV0(25:11)
 22332     CALL 'kxdfhei1' USING DFHEIV0,
 22333           DFHEIV20,
 22334           ERPNDB-RECORD-LENGTH,
 22335           GETMAIN-SPACE
 22336     SET ADDRESS OF PENDING-BUSINESS TO
 22337         DFHEIV20
 22338     MOVE EIBRESP  TO WS-RESPONSE
 22339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22340
 22341* EXEC CICS READ
 22342*       INTO    (PENDING-BUSINESS)
 22343*       DATASET (FILE-ID-ERPNDB)
 22344*       RIDFLD  (ERPNDB-KEY)
 22345*       RESP    (WS-RESPONSE)
 22346*    END-EXEC
 22347     MOVE LENGTH OF
 22348      PENDING-BUSINESS
 22349       TO DFHEIV11
 22350*    MOVE '&"IL       E          (  N#00018680' TO DFHEIV0
 22351     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22352     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22353     MOVE X'204E233030303138363830' TO DFHEIV0(25:11)
 22354     CALL 'kxdfhei1' USING DFHEIV0,
 22355           FILE-ID-ERPNDB,
 22356           PENDING-BUSINESS,
 22357           DFHEIV11,
 22358           ERPNDB-KEY,
 22359           DFHEIV99,
 22360           DFHEIV99,
 22361           DFHEIV99
 22362     MOVE EIBRESP  TO WS-RESPONSE
 22363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22364     IF RESP-NORMAL
 22365        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22366        IF (RESP-NORMAL)
 22367           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 411
* EL6311.cbl
 22368              AM-CONTROL-PRIMARY (1:20))
 22369           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 22370        ELSE
 22371           MOVE 'ACCOUNT NOT FOUND'
 22372                                 TO VD-ACCOUNT-NAME
 22373        END-IF
 22374        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 22375                                    TO M1
 22376        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 22377        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 22378           (A2 > M1)
 22379           OR (WS-WORK-FIELD (A2:1) = '*')
 22380           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 22381           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 22382        END-PERFORM
 22383        IF A2 > M1
 22384           CONTINUE
 22385        ELSE
 22386           MOVE WS-WORK-FIELD (1:A2 - 1)
 22387                                    TO VD-ACCOUNT-NAME
 22388        END-IF
 22389        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 22390        MOVE PB-CARRIER          TO VD-CARRIER
 22391        MOVE PB-GROUPING         TO VD-GROUPING
 22392        MOVE PB-STATE            TO VD-STATE
 22393        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 22394        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 22395        MOVE PB-CERT-NO          TO VD-CERT-NO
 22396        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 22397        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 22398        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 22399        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22400        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22401        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22402        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22403        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22404        MOVE PB-CSR-ID           TO VD-CSR-ID
 22405        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22406        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22407        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22408        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22409        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22410        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22411        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22412        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22413        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22414        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22415        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22416        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22417        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22418     END-IF
 22419     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22420
 22421
 22422* EXEC CICS GETMAIN
 22423*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22424*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22425*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 412
* EL6311.cbl
 22426*       RESP     (WS-RESPONSE)
 22427*    END-EXEC
 22428*    MOVE ',"IL                  $  N#00018743' TO DFHEIV0
 22429     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22430     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22431     MOVE X'204E233030303138373433' TO DFHEIV0(25:11)
 22432     CALL 'kxdfhei1' USING DFHEIV0,
 22433           DFHEIV20,
 22434           ERPNDM-RECORD-LENGTH,
 22435           GETMAIN-SPACE
 22436     SET ADDRESS OF PENDING-MAILING-DATA TO
 22437         DFHEIV20
 22438     MOVE EIBRESP  TO WS-RESPONSE
 22439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22440
 22441
 22442* EXEC CICS READ
 22443*       INTO    (PENDING-MAILING-DATA)
 22444*       DATASET (FILE-ID-ERPNDM)
 22445*       RIDFLD  (ERPNDM-KEY)
 22446*       RESP    (WS-RESPONSE)
 22447*    END-EXEC
 22448     MOVE LENGTH OF
 22449      PENDING-MAILING-DATA
 22450       TO DFHEIV11
 22451*    MOVE '&"IL       E          (  N#00018750' TO DFHEIV0
 22452     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22454     MOVE X'204E233030303138373530' TO DFHEIV0(25:11)
 22455     CALL 'kxdfhei1' USING DFHEIV0,
 22456           FILE-ID-ERPNDM,
 22457           PENDING-MAILING-DATA,
 22458           DFHEIV11,
 22459           ERPNDM-KEY,
 22460           DFHEIV99,
 22461           DFHEIV99,
 22462           DFHEIV99
 22463     MOVE EIBRESP  TO WS-RESPONSE
 22464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22465
 22466     IF RESP-NORMAL
 22467        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22468        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22469        MOVE PM-CITY              TO VD-INSURED-CITY
 22470        MOVE PM-STATE             TO VD-INSURED-STATE
 22471        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22472     END-IF
 22473
 22474     MOVE 'VAC1'                  TO VD-LETTER-ID
 22475     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22476     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22477     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22478     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22479     MOVE +0                      TO VD-ARCHIVE-NO
 22480     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22481     .
 22482 6200-EXIT.
 22483     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 413
* EL6311.cbl
 22484 6210-READ-ERACCT.
 22485     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22486     MOVE LOW-VALUES             TO ERACCT-FILL
 22487
 22488* EXEC CICS READ
 22489*         DATASET   ('ERACCT')
 22490*         INTO      (ACCOUNT-MASTER)
 22491*         RIDFLD    (ERACCT-KEY)
 22492*         GTEQ
 22493*         RESP      (WS-RESPONSE)
 22494*    END-EXEC
 22495     MOVE LENGTH OF
 22496      ACCOUNT-MASTER
 22497       TO DFHEIV11
 22498     MOVE 'ERACCT' TO DFHEIV1
 22499*    MOVE '&"IL       G          (  N#00018778' TO DFHEIV0
 22500     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22502     MOVE X'204E233030303138373738' TO DFHEIV0(25:11)
 22503     CALL 'kxdfhei1' USING DFHEIV0,
 22504           DFHEIV1,
 22505           ACCOUNT-MASTER,
 22506           DFHEIV11,
 22507           ERACCT-KEY,
 22508           DFHEIV99,
 22509           DFHEIV99,
 22510           DFHEIV99
 22511     MOVE EIBRESP  TO WS-RESPONSE
 22512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22513     .
 22514 6210-EXIT.
 22515     EXIT.
 22516
 22517 6220-READ-ERMAIL.
 22518
 22519     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22520     MOVE ' '                    TO WS-ERMAIL-SW
 22521
 22522
 22523* EXEC CICS READ
 22524*       DATASET   (FILE-ID-ERMAIL)
 22525*       SET       (ADDRESS OF MAILING-DATA)
 22526*       RIDFLD    (ERMAIL-KEY)
 22527*       RESP      (WS-RESPONSE)
 22528*    END-EXEC
 22529*    MOVE '&"S        E          (  N#00018794' TO DFHEIV0
 22530     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22532     MOVE X'204E233030303138373934' TO DFHEIV0(25:11)
 22533     CALL 'kxdfhei1' USING DFHEIV0,
 22534           FILE-ID-ERMAIL,
 22535           DFHEIV20,
 22536           DFHEIV99,
 22537           ERMAIL-KEY,
 22538           DFHEIV99,
 22539           DFHEIV99,
 22540           DFHEIV99
 22541     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 414
* EL6311.cbl
 22542         DFHEIV20
 22543     MOVE EIBRESP  TO WS-RESPONSE
 22544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22545
 22546     IF RESP-NORMAL
 22547        SET ERMAIL-FOUND TO TRUE
 22548     END-IF
 22549     .
 22550 6220-EXIT.
 22551     EXIT.
 22552
 22553 6400-CHECK-FOR-RES-REF-CLAIM.
 22554     display 'made it to 6400- for ' pi-cert-no
 22555     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22556
 22557     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22558                                    W-CL-COMP-CD.
 22559     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22560                                    W-CL-CERT-NO.
 22561     MOVE SPACES                 TO MSTR-CERT-SFX.
 22562
 22563
 22564* EXEC CICS HANDLE CONDITION
 22565*        NOTFND  (6400-CONTINUE)
 22566*        ENDFILE (6400-CONTINUE)
 22567*    END-EXEC.
 22568*    MOVE '"$I''                  ! X #00018818' TO DFHEIV0
 22569     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22571     MOVE X'5820233030303138383138' TO DFHEIV0(25:11)
 22572     CALL 'kxdfhei1' USING DFHEIV0
 22573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22574
 22575
 22576
 22577* EXEC CICS IGNORE CONDITION
 22578*        DUPKEY
 22579*    END-EXEC.
 22580*    MOVE '"*$                   !   #00018823' TO DFHEIV0
 22581     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22582     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22583     MOVE X'2020233030303138383233' TO DFHEIV0(25:11)
 22584     CALL 'kxdfhei1' USING DFHEIV0
 22585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22586
 22587
 22588
 22589* EXEC CICS STARTBR
 22590*        DATASET   (CLMS-ID)
 22591*        RIDFLD    (ELMSTR-KEY)
 22592*        GENERIC   EQUAL
 22593*        KEYLENGTH (ELMSTR-LENGTH)
 22594*    END-EXEC.
 22595     MOVE 0
 22596       TO DFHEIV11
 22597*    MOVE '&,   KG    E          &   #00018827' TO DFHEIV0
 22598     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22599     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 415
* EL6311.cbl
 22600     MOVE X'2020233030303138383237' TO DFHEIV0(25:11)
 22601     CALL 'kxdfhei1' USING DFHEIV0,
 22602           CLMS-ID,
 22603           ELMSTR-KEY,
 22604           ELMSTR-LENGTH,
 22605           DFHEIV11,
 22606           DFHEIV99
 22607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22608
 22609
 22610     display 'browse started'
 22611     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22612
 22613 6400-NEXT-CLAIM.
 22614
 22615
 22616* EXEC CICS READNEXT
 22617*        DATASET   (CLMS-ID)
 22618*        RIDFLD    (ELMSTR-KEY)
 22619*        SET       (ADDRESS OF CLAIM-MASTER)
 22620*    END-EXEC.
 22621     MOVE 0
 22622       TO DFHEIV11
 22623*    MOVE '&.S                   )   #00018839' TO DFHEIV0
 22624     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22625     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22626     MOVE X'2020233030303138383339' TO DFHEIV0(25:11)
 22627     CALL 'kxdfhei1' USING DFHEIV0,
 22628           CLMS-ID,
 22629           DFHEIV20,
 22630           DFHEIV99,
 22631           ELMSTR-KEY,
 22632           DFHEIV99,
 22633           DFHEIV11,
 22634           DFHEIV99,
 22635           DFHEIV99
 22636     SET ADDRESS OF CLAIM-MASTER TO
 22637         DFHEIV20
 22638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22639
 22640
 22641     display 'read claim for ' mstr-cert-no
 22642     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22643        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22644         GO TO 6400-CONTINUE
 22645     END-IF.
 22646
 22647     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22648        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22649        PI-STATE       NOT = CL-CERT-STATE     OR
 22650        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22651        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22652         GO TO 6400-NEXT-CLAIM
 22653     END-IF.
 22654
 22655     display 'found claim ' cl-claim-no
 22656        ' with denial type ' cl-denial-type
 22657     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 416
* EL6311.cbl
 22658         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22659         GO TO 6400-CONTINUE
 22660     END-IF.
 22661
 22662     GO TO 6400-NEXT-CLAIM.
 22663
 22664 6400-CONTINUE.
 22665
 22666     IF WS-BROWSE-STARTED-SW = 'Y'
 22667
 22668* EXEC CICS ENDBR
 22669*            DATASET   (CLMS-ID)
 22670*        END-EXEC
 22671     MOVE 0
 22672       TO DFHEIV11
 22673*    MOVE '&2                    $   #00018871' TO DFHEIV0
 22674     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22675     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22676     MOVE X'2020233030303138383731' TO DFHEIV0(25:11)
 22677     CALL 'kxdfhei1' USING DFHEIV0,
 22678           CLMS-ID,
 22679           DFHEIV11,
 22680           DFHEIV99
 22681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22682         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22683     END-IF.
 22684
 22685 6400-EXIT.
 22686     EXIT.
 22687
 22688 7000-DISPLAY-ISSUES.
 22689
 22690     IF PI-DISPLAY-ORIGINAL-BATCH
 22691        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22692        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22693     ELSE
 22694        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22695
 22696     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22697
 22698     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22699     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22700
 22701     MOVE LOW-VALUES                 TO EL631BI.
 22702     MOVE ZEROS                      TO PI-BPMTAMT
 22703                                        PI-BPMTS.
 22704     MOVE SPACE                      TO PI-BMODE
 22705                                        PI-BTYPE (1)
 22706                                        PI-BTYPE (2).
 22707     MOVE EL631B                     TO PI-MAP-NAME.
 22708     MOVE 'Y'                        TO PI-BROWSE-SW.
 22709     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22710                                        PI-HIGH-SEQ-NO.
 22711
 22712     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22713        MOVE AL-SABOF                TO BCHGTA
 22714        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22715        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 417
* EL6311.cbl
 22716     ELSE
 22717        MOVE AL-SADOF                TO BCHGTA
 22718                                        BCHGA
 22719        MOVE PB-CHG-COUNT            TO BCHGO.
 22720
 22721     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22722     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22723     MOVE WS-HR-MINS                 TO BMANTATO.
 22724
 22725     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22726        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22727        MOVE SPACE                   TO DC-OPTION-CODE
 22728        PERFORM 9700-DATE-LINK
 22729        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22730        MOVE 'INACTIVE'              TO BMOENDTO
 22731     ELSE
 22732        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22733        MOVE SPACE                   TO DC-OPTION-CODE
 22734        PERFORM 9700-DATE-LINK
 22735        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22736        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22737        MOVE SPACE                   TO DC-OPTION-CODE
 22738        PERFORM 9700-DATE-LINK
 22739        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22740
 22741*    MOVE PB-I-REFERENCE             TO BREFO.
 22742
 22743*    IF PI-COMPANY-ID EQUAL 'HER'
 22744*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22745*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22746*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22747*                MOVE WS-MEMBER-NO-1-8
 22748*                                TO  BMICRNOO.
 22749
 22750*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22751*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22752*            MOVE PB-I-MICROFILM-NO
 22753*                                TO  BMICRNOO.
 22754     IF PB-I-VIN NOT = SPACES
 22755        MOVE PB-I-VIN            TO BVINO
 22756     END-IF
 22757     MOVE PB-I-LETTER-REQD           TO LETRREQO
 22758
 22759
 22760     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22761     MOVE PB-CERT-SFX                TO BSUFIXO.
 22762     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22763     MOVE SPACE                      TO DC-OPTION-CODE.
 22764     PERFORM 9700-DATE-LINK.
 22765     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22766
 22767     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22768     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22769     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22770     MOVE PB-I-INSURED-SEX           TO BSEXO
 22771
 22772     IF PB-I-AGE NOT = ZEROS
 22773         MOVE PB-I-AGE               TO BAGEO.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 418
* EL6311.cbl
 22774
 22775     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22776                                 TO ELCERT-KEY
 22777     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22778     IF NOT CERT-TRL-REC-NOT-FOUND
 22779         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22780             MOVE 'AGE*'             TO BAGEDEFO
 22781         ELSE
 22782             MOVE 'AGE '             TO BAGEDEFO
 22783         END-IF
 22784     ELSE
 22785         MOVE 'AGE '             TO BAGEDEFO
 22786     END-IF
 22787
 22788     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22789         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22790         MOVE SPACE                  TO DC-OPTION-CODE
 22791         PERFORM 9700-DATE-LINK
 22792         IF NO-CONVERSION-ERROR
 22793            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22794
 22795     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22796         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22797         MOVE SPACE                  TO DC-OPTION-CODE
 22798         PERFORM 9700-DATE-LINK
 22799         IF NO-CONVERSION-ERROR
 22800            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22801
 22802     IF PB-I-EXTENTION-DAYS NUMERIC
 22803        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22804           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22805        ELSE
 22806           IF PB-I-TERM-IN-DAYS NUMERIC
 22807              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22808                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22809
 22810     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22811        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22812
 22813     MOVE PB-FORCE-CODE              TO BFORCEO.
 22814     MOVE PB-I-TERM-TYPE             TO BMODEO
 22815                                        PI-BMODE.
 22816
 22817     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22818        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22819
 22820     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22821         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22822                                        PI-BPMTS.
 22823
 22824     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22825         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22826           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22827                                        PI-BPMTAMT.
 22828
 22829     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22830     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22831     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 419
* EL6311.cbl
 22832     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22833     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22834     MOVE PB-I-SIG-SW                TO BSIGO.
 22835     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22836     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22837     MOVE PB-RECORD-BILL             TO BBILCDO.
 22838     MOVE PB-FORCE-CODE              TO BFORCEO.
 22839
 22840     IF (PB-I-LIVES NUMERIC)
 22841        AND (PB-I-LIVES > ZEROS)
 22842        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22843        IF (RESP-NORMAL)
 22844           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22845           CONTINUE
 22846        ELSE
 22847           MOVE PB-I-LIVES       TO BLIVESO
 22848        END-IF
 22849     END-IF
 22850
 22851     IF PB-I-NUM-BILLED NUMERIC AND
 22852        PB-I-NUM-BILLED GREATER THAN ZEROS
 22853        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22854*    ELSE
 22855*       MOVE ZEROS                   TO BBILLEDO.
 22856
 22857     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22858
 22859     IF PB-I-LOAN-APR NOT = +99.9999
 22860        MOVE PB-I-LOAN-APR           TO BAPRO.
 22861
 22862     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22863        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22864
 22865     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22866        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22867           MOVE AL-SANOF                TO BORIGHDA
 22868           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22869           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22870
 22871     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22872
 22873     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22874        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22875
 22876     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22877        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22878                                        PI-BTYPE (1).
 22879
 22880     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22881        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22882
 22883     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22884        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22885
 22886     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22887        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22888
 22889     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 420
* EL6311.cbl
 22890        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22891
 22892     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22893        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22894
 22895     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22896         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22897         MOVE SPACE                  TO DC-OPTION-CODE
 22898         PERFORM 9700-DATE-LINK
 22899         IF NO-CONVERSION-ERROR
 22900            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22901
 22902     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22903        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22904        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22905        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22906        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22907                 GIVING BDIFFO (1)
 22908     ELSE
 22909        MOVE SPACES                  TO BBEN-CD     (1)
 22910                                        BBEN-ABBR   (1).
 22911
 22912     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22913        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22914        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22915                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22916
 22917     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22918       IF PB-RECORD-ON-HOLD
 22919          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22920
 22921     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22922       IF PB-RECORD-RETURNED
 22923          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22924
 22925     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22926        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22927             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22928
 22929     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22930
 22931     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22932        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22933
 22934     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22935        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22936                                        PI-BTYPE (2).
 22937
 22938     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22939        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22940
 22941     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22942        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22943
 22944     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22945        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22946
 22947     IF PB-I-TOT-FEES NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 421
* EL6311.cbl
 22948        MOVE ZEROS               TO PB-I-TOT-FEES
 22949     END-IF
 22950     IF PB-I-TOT-FEES > ZEROS
 22951        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22952
 22953     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22954         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22955         MOVE SPACE                  TO DC-OPTION-CODE
 22956         PERFORM 9700-DATE-LINK
 22957         IF NO-CONVERSION-ERROR
 22958            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22959
 22960     IF PB-I-TOT-FEES > ZEROS
 22961        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22962        SUBTRACT PB-I-TOT-FEES FROM
 22963                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22964
 22965     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22966        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22967        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22968        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22969        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22970                 GIVING BDIFFO (2)
 22971     ELSE
 22972        MOVE SPACES                  TO BBEN-CD     (2)
 22973                                        BBEN-ABBR   (2).
 22974
 22975     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22976       IF PB-RECORD-ON-HOLD
 22977          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22978
 22979     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22980       IF PB-RECORD-RETURNED
 22981          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22982
 22983     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22984        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22985             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22986
 22987     MOVE PB-CSR-ID                  TO BCSRO.
 22988
 22989     IF PI-COMPANY-ID  =  'DMD'
 22990        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22991            NEXT SENTENCE
 22992        ELSE
 22993            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22994               MOVE 'NEW CERT'       TO BNCERTLI
 22995               MOVE EC-NEW-CERT      TO BNCERTO.
 22996
 22997     IF PI-COMPANY-ID  =  'DMD'
 22998        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22999            NEXT SENTENCE
 23000        ELSE
 23001           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 23002               MOVE 'NEW STATE'      TO BNSTATLI
 23003               MOVE EC-NEW-STATE     TO BNSTATO.
 23004
 23005 7000-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 422
* EL6311.cbl
 23006     MOVE 'C'                        TO BMAINTI.
 23007     MOVE AL-UANON                   TO BMAINTA.
 23008
 23009     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23010        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23011
 23012     IF ARCHIVE-LETTER-RELEASED
 23013        PERFORM 7050-UPDATE-PENDING THRU 7050-EXIT
 23014     END-IF
 23015     IF PI-6315-FINALIZED = 'Y'   AND
 23016        PB-UNFORCED-ERRORS
 23017          MOVE -1                TO BFORCEL
 23018          MOVE  1                TO SET-CURSOR-SW
 23019     END-IF
 23020
 23021     IF NO-CURSOR-SET
 23022        MOVE -1                      TO BMAINTL.
 23023
 23024     GO TO 8100-SEND-INITIAL-MAP.
 23025
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 423
* EL6311.cbl
 23027
 23028 7050-UPDATE-PENDING.
 23029
 23030* EXEC CICS READ
 23031*        DATASET (FILE-ID-ERPNDB)
 23032*        INTO    (PENDING-BUSINESS)
 23033*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 23034*        UPDATE
 23035*    END-EXEC.
 23036     MOVE LENGTH OF
 23037      PENDING-BUSINESS
 23038       TO DFHEIV11
 23039*    MOVE '&"IL       EU         (   #00019221' TO DFHEIV0
 23040     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23041     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23042     MOVE X'2020233030303139323231' TO DFHEIV0(25:11)
 23043     CALL 'kxdfhei1' USING DFHEIV0,
 23044           FILE-ID-ERPNDB,
 23045           PENDING-BUSINESS,
 23046           DFHEIV11,
 23047           PI-PREV-CONTROL-PRIMARY,
 23048           DFHEIV99,
 23049           DFHEIV99,
 23050           DFHEIV99
 23051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23052
 23053
 23054     MOVE 'C' TO PB-I-LETTER-REQD
 23055     MOVE PB-I-LETTER-REQD       TO LETRREQO
 23056     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 23057     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 23058     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 23059     MOVE '5'                    TO DC-OPTION-CODE.
 23060     PERFORM 9700-DATE-LINK
 23061     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 23062
 23063
 23064* EXEC CICS REWRITE
 23065*        DATASET (FILE-ID-ERPNDB)
 23066*        FROM    (PENDING-BUSINESS)
 23067*    END-EXEC.
 23068     MOVE LENGTH OF
 23069      PENDING-BUSINESS
 23070       TO DFHEIV11
 23071*    MOVE '&& L                  %   #00019237' TO DFHEIV0
 23072     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23073     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23074     MOVE X'2020233030303139323337' TO DFHEIV0(25:11)
 23075     CALL 'kxdfhei1' USING DFHEIV0,
 23076           FILE-ID-ERPNDB,
 23077           PENDING-BUSINESS,
 23078           DFHEIV11,
 23079           DFHEIV99
 23080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23081
 23082
 23083 7050-EXIT.
 23084      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 424
* EL6311.cbl
 23085
 23086******************************************************************
 23087*                                                                *
 23088*             D I S P L A Y   C A N C E L S                      *
 23089*                                                                *
 23090******************************************************************
 23091
 23092 7100-DISPLAY-CANCELS.
 23093     IF PI-DISPLAY-ORIGINAL-BATCH
 23094        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 23095        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 23096     ELSE
 23097        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 23098
 23099     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 23100
 23101     MOVE 'Y'                        TO WS-DISPLAY-SW.
 23102     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 23103
 23104     MOVE LOW-VALUES                 TO EL631CI.
 23105     MOVE EL631C                     TO PI-MAP-NAME.
 23106     MOVE 'Y'                        TO PI-BROWSE-SW.
 23107     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 23108                                        PI-HIGH-SEQ-NO.
 23109
 23110     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 23111        MOVE AL-SABOF                TO CCHGTA
 23112        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 23113        MOVE AL-SANON                TO CCHGA
 23114      ELSE
 23115        MOVE AL-SADOF                TO CCHGTA
 23116                                        CCHGA
 23117        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 23118
 23119*    MOVE PB-C-REFERENCE             TO CREFO.
 23120
 23121*    IF PB-C-MICROFILM-NO IS NUMERIC
 23122*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 23123*          MOVE PB-C-MICROFILM-NO
 23124*                                TO CMICRNOO
 23125*          MOVE AL-UNNON         TO CMICRNOA
 23126*       END-IF
 23127*    END-IF
 23128     IF PB-C-INT-ON-REFS NUMERIC
 23129        IF PB-C-INT-ON-REFS NOT = ZEROS
 23130           MOVE PB-C-INT-ON-REFS
 23131                                 TO CNHINTO
 23132           MOVE AL-SANOF         TO CNHINTA
 23133        END-IF
 23134     END-IF
 23135     MOVE PB-CERT-PRIME              TO CCERTNOO.
 23136     MOVE PB-CERT-SFX                TO CSUFIXO.
 23137     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 23138     MOVE SPACE                      TO DC-OPTION-CODE.
 23139     PERFORM 9700-DATE-LINK.
 23140     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 23141
 23142     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 425
* EL6311.cbl
 23143        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 23144        MOVE SPACE                   TO DC-OPTION-CODE
 23145        PERFORM 9700-DATE-LINK
 23146        IF NO-CONVERSION-ERROR
 23147           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 23148
 23149     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 23150        NEXT SENTENCE
 23151     ELSE
 23152        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 23153
 23154     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 23155        NEXT SENTENCE
 23156     ELSE
 23157        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 23158
 23159     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 23160        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 23161        MOVE SPACE                   TO DC-OPTION-CODE
 23162        PERFORM 9700-DATE-LINK
 23163        IF NO-CONVERSION-ERROR
 23164           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 23165
 23166     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23167         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 23168
 23169     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23170         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 23171
 23172     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 23173        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 23174        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 23175                 GIVING CDRFND1O.
 23176
 23177     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 23178        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 23179        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 23180                 GIVING CDRFND2O.
 23181
 23182     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23183       IF PB-RECORD-ON-HOLD
 23184          MOVE 'ON HOLD'             TO CBILIT1O.
 23185
 23186     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23187       IF PB-RECORD-RETURNED
 23188          MOVE 'RETURNED'            TO CBILIT1O.
 23189
 23190     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23191        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 23192             MOVE 'OVERRIDE'         TO CBILIT1O.
 23193
 23194     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23195       IF PB-RECORD-ON-HOLD
 23196          MOVE 'ON HOLD'             TO CBILIT2O.
 23197
 23198     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23199       IF PB-RECORD-RETURNED
 23200          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 426
* EL6311.cbl
 23201
 23202     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23203        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 23204             MOVE 'OVERRIDE'         TO CBILIT2O.
 23205
 23206     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 23207     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 23208     MOVE PB-FORCE-CODE              TO CFORCEO.
 23209     MOVE PB-RECORD-BILL             TO CBILCDO.
 23210     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 23211     MOVE SPACES                     TO CINITSO.
 23212     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 23213         MOVE PB-CI-FIRST-NAME       TO CINITSO
 23214     ELSE
 23215         MOVE PB-CI-INITIALS         TO CINITSO
 23216     END-IF.
 23217
 23218     IF PB-CI-CANCEL-FEE NUMERIC
 23219        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 23220        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 23221     ELSE
 23222        MOVE ZEROES                  TO W-CANCEL-FEE.
 23223
 23224     MOVE W-CANCEL-FEE               TO CCANFEEO.
 23225
 23226     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 23227        ADD PB-CI-LF-PREMIUM-AMT
 23228             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 23229
 23230     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 23231        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 23232
 23233     MOVE PB-CI-LF-TERM              TO CTERM1O.
 23234     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 23235     MOVE PB-CI-AH-TERM              TO CTERM2O.
 23236     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 23237
 23238     IF PB-C-LIVES NUMERIC
 23239        MOVE PB-C-LIVES              TO CLIVESO.
 23240
 23241     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 23242        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 23243
 23244     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 23245        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 23246        MOVE SPACE                   TO DC-OPTION-CODE
 23247        PERFORM 9700-DATE-LINK
 23248        IF NO-CONVERSION-ERROR
 23249           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 23250
 23251     IF  PB-C-REFUND-CREATED
 23252         MOVE 'YES'                  TO CRFNDSWO
 23253     ELSE
 23254         IF PB-C-REFUND-REQUESTED
 23255            MOVE 'REQ'               TO CRFNDSWO
 23256         ELSE
 23257            MOVE 'NO'                TO CRFNDSWO.
 23258
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 427
* EL6311.cbl
 23259     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 23260     MOVE SPACE                      TO DC-OPTION-CODE.
 23261     PERFORM 9700-DATE-LINK.
 23262     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 23263     MOVE PB-INPUT-BY                TO CENTBYO.
 23264
 23265     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23266        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 23267        MOVE SPACE                   TO DC-OPTION-CODE
 23268        PERFORM 9700-DATE-LINK
 23269        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23270        MOVE 'INACTIVE'              TO CMOENDTO
 23271     ELSE
 23272        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 23273        MOVE SPACE                   TO DC-OPTION-CODE
 23274        PERFORM 9700-DATE-LINK
 23275        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23276        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 23277        MOVE SPACE                   TO DC-OPTION-CODE
 23278        PERFORM 9700-DATE-LINK
 23279        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 23280
 23281     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 23282
 23283     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 23284     MOVE WS-HR-MINS                 TO CMANTATO.
 23285
 23286     EVALUATE PB-LF-REFUND-TYPE
 23287        WHEN '1'
 23288           MOVE 'RULE78'            TO CLFREFNO
 23289        WHEN '2'
 23290           MOVE 'PRORAT'            TO CLFREFNO
 23291        WHEN '3'
 23292           MOVE 'CALIF'             TO CLFREFNO
 23293        WHEN '4'
 23294           MOVE 'IRREG'             TO CLFREFNO
 23295        WHEN '5'
 23296           MOVE 'NETPAY'            TO CLFREFNO
 23297        WHEN '6'
 23298           MOVE 'ATCP'              TO CLFREFNO
 23299        WHEN '7'
 23300           MOVE 'UTAH'              TO CLFREFNO
 23301        WHEN '8'
 23302           MOVE 'MEAN'              TO CLFREFNO
 23303        WHEN '9'
 23304           MOVE 'SUM '              TO CLFREFNO
 23305        WHEN 'B'
 23306           MOVE 'BALN'              TO CLFREFNO
 23307     END-EVALUATE.
 23308
 23309     EVALUATE TRUE
 23310        WHEN PB-AH-REFUND-TYPE =  '1'
 23311           MOVE 'RULE78'            TO CAHREFNO
 23312        WHEN PB-AH-REFUND-TYPE =  '2'
 23313           MOVE 'PRORAT'            TO CAHREFNO
 23314        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 23315           MOVE 'CALIF'             TO CAHREFNO
 23316        WHEN PB-AH-REFUND-TYPE =  '4'
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 428
* EL6311.cbl
 23317           MOVE 'IRREG'             TO CAHREFNO
 23318        WHEN PB-AH-REFUND-TYPE =  '5'
 23319           MOVE 'NETPAY'            TO CAHREFNO
 23320        WHEN PB-AH-REFUND-TYPE =  '6'
 23321           MOVE 'ATCP'              TO CAHREFNO
 23322        WHEN PB-AH-REFUND-TYPE =  '7'
 23323           MOVE 'UTAH'              TO CAHREFNO
 23324        WHEN PB-AH-REFUND-TYPE =  '8'
 23325           MOVE 'MEAN'              TO CAHREFNO
 23326        WHEN PB-AH-REFUND-TYPE =  '9'
 23327           MOVE 'SUM '              TO CAHREFNO
 23328        WHEN PB-AH-REFUND-TYPE =  'B'
 23329           MOVE 'BALN'              TO CAHREFNO
 23330     END-EVALUATE.
 23331
 23332     MOVE PB-REIN-CD                 TO CREINCDO.
 23333
 23334     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 23335        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 23336        MOVE SPACE                   TO DC-OPTION-CODE
 23337        PERFORM 9700-DATE-LINK
 23338        IF NO-CONVERSION-ERROR
 23339           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 23340
 23341     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 23342        MOVE 999999                  TO WS-EXP-DT-EDIT
 23343        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 23344        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 23345     ELSE
 23346        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 23347           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 23348           MOVE SPACE                   TO DC-OPTION-CODE
 23349           PERFORM 9700-DATE-LINK
 23350           IF NO-CONVERSION-ERROR
 23351              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 23352
 23353     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 23354        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 23355           MOVE AL-SANOF                TO CORIGHDA
 23356           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 23357           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 23358
 23359     MOVE PB-CSR-ID              TO CCSRO.
 23360
 23361     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 23362     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 23363     MOVE 'N'                    TO ACTSPCO
 23364     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 23365     MOVE '2'                    TO ERACNT-REC-TYPE
 23366     MOVE +3                     TO ERACNT-SEQ-NO
 23367
 23368
 23369* EXEC CICS READ
 23370*         DATASET   ('ERACNT')
 23371*         INTO      (NOTE-FILE)
 23372*         RIDFLD    (ERACNT-KEY)
 23373*         RESP      (WS-RESPONSE)
 23374*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 429
* EL6311.cbl
 23375     MOVE LENGTH OF
 23376      NOTE-FILE
 23377       TO DFHEIV11
 23378     MOVE 'ERACNT' TO DFHEIV1
 23379*    MOVE '&"IL       E          (  N#00019527' TO DFHEIV0
 23380     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23381     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23382     MOVE X'204E233030303139353237' TO DFHEIV0(25:11)
 23383     CALL 'kxdfhei1' USING DFHEIV0,
 23384           DFHEIV1,
 23385           NOTE-FILE,
 23386           DFHEIV11,
 23387           ERACNT-KEY,
 23388           DFHEIV99,
 23389           DFHEIV99,
 23390           DFHEIV99
 23391     MOVE EIBRESP  TO WS-RESPONSE
 23392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23393
 23394     IF RESP-NORMAL
 23395        IF NT-account-special = 'Y'
 23396           MOVE 'Y'              TO actspcO
 23397           MOVE ER-1762          TO EMI-ERROR
 23398           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23399        END-IF
 23400     END-IF
 23401     MOVE 'C'                    TO CMAINTI.
 23402     MOVE AL-UANON               TO CMAINTA.
 23403
 23404     IF PI-6316-FINALIZED = 'Y'  AND
 23405        PB-UNFORCED-ERRORS
 23406          MOVE -1                TO CFORCEL
 23407          MOVE  1                TO SET-CURSOR-SW
 23408     END-IF
 23409
 23410     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23411        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23412
 23413     IF NO-CURSOR-SET
 23414        MOVE -1                  TO CMAINTL.
 23415
 23416     GO TO 8100-SEND-INITIAL-MAP.
 23417
 23418
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 430
* EL6311.cbl
 23420***************************************************************
 23421*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23422*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23423***************************************************************
 23424
 23425 7200-DISPLAY-BATCHES.
 23426     MOVE EL631D                 TO PI-MAP-NAME.
 23427     MOVE LOW-VALUES             TO EL631DI.
 23428
 23429     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23430
 23431
 23432* EXEC CICS HANDLE CONDITION
 23433*         NOTFND   (3690-NOT-FOUND)
 23434*    END-EXEC.
 23435*    MOVE '"$I                   ! Y #00019571' TO DFHEIV0
 23436     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23437     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23438     MOVE X'5920233030303139353731' TO DFHEIV0(25:11)
 23439     CALL 'kxdfhei1' USING DFHEIV0
 23440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23441
 23442
 23443     IF PI-DISPLAY-SCREEN
 23444        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23445     ELSE
 23446        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23447
 23448     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23449     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23450
 23451
 23452* EXEC CICS READ
 23453*         DATASET   (FILE-ID-ERPNDB)
 23454*         RIDFLD    (ERPNDB-KEY)
 23455*         SET       (ADDRESS OF PENDING-BUSINESS)
 23456*    END-EXEC.
 23457*    MOVE '&"S        E          (   #00019583' TO DFHEIV0
 23458     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23459     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23460     MOVE X'2020233030303139353833' TO DFHEIV0(25:11)
 23461     CALL 'kxdfhei1' USING DFHEIV0,
 23462           FILE-ID-ERPNDB,
 23463           DFHEIV20,
 23464           DFHEIV99,
 23465           ERPNDB-KEY,
 23466           DFHEIV99,
 23467           DFHEIV99,
 23468           DFHEIV99
 23469     SET ADDRESS OF PENDING-BUSINESS TO
 23470         DFHEIV20
 23471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23472
 23473
 23474     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23475     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23476     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23477     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 431
* EL6311.cbl
 23478     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23479
 23480     MOVE EL631D                 TO PI-MAP-NAME.
 23481     MOVE LOW-VALUES             TO EL631DI.
 23482     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23483
 23484*    IF PI-AR-PROCESSING
 23485*       MOVE PB-REFERENCE        TO DREFO.
 23486
 23487     MOVE PB-CSR-ID              TO DCSRO.
 23488
 23489     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23490        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23491        MOVE SPACE               TO DC-OPTION-CODE
 23492        PERFORM 9700-DATE-LINK
 23493        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23494        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23495        MOVE 'INACTIVE'          TO DLDATEO
 23496     ELSE
 23497        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23498        MOVE SPACE               TO DC-OPTION-CODE
 23499        PERFORM 9700-DATE-LINK
 23500        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23501
 23502     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23503     MOVE SPACE                  TO DC-OPTION-CODE.
 23504     PERFORM 9700-DATE-LINK.
 23505     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23506
 23507     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23508        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23509     ELSE
 23510        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23511        MOVE SPACE               TO DC-OPTION-CODE
 23512        PERFORM 9700-DATE-LINK
 23513        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23514
 23515     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23516     MOVE SPACE                  TO DC-OPTION-CODE.
 23517     PERFORM 9700-DATE-LINK.
 23518     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23519
 23520     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23521     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23522
 23523     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23524        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23525                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23526
 23527     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23528     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23529     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23530
 23531     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23532        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23533                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23534
 23535     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 432
* EL6311.cbl
 23536     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23537     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23538
 23539     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23540        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23541                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23542
 23543     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23544     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23545
 23546     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23547        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23548                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23549
 23550     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23551     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23552     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23553
 23554     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23555        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23556                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23557
 23558     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23559     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23560     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23561
 23562     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23563        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23564                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23565
 23566     MOVE -1                     TO DPFENTRL.
 23567     GO TO 8100-SEND-INITIAL-MAP.
 23568
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 433
* EL6311.cbl
 23570
 23571***************************************************************
 23572*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23573*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23574*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23575*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23576*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23577*     ARE THEN SET ACCORDINGLY.                               *
 23578*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23579*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23580*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23581***************************************************************
 23582
 23583******************************************************************
 23584*                                                                *
 23585*            E R R O R   A N A L Y S I S                         *
 23586*                                                                *
 23587******************************************************************
 23588
 23589******************************************************************
 23590*                                                                *
 23591*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23592*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23593*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23594*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23595*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23596*                                                                *
 23597*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23598*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23599*                                                                *
 23600******************************************************************
 23601
 23602 7300-FORMAT-ERRORS.
 23603     MOVE ' '                    TO PI-ERRORS-SW
 23604     IF PB-COMMON-ERRORS = LOW-VALUES
 23605        IF PB-FATAL-ERRORS
 23606           MOVE ER-2695          TO EMI-ERROR
 23607           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23608           GO TO 7399-EXIT.
 23609
 23610     MOVE +0                     TO WS-SUB4
 23611     move +0                     to pi-6311-fatal-ctr
 23612     .
 23613 7310-ERROR-LOOP.
 23614
 23615     ADD +1                      TO WS-SUB4.
 23616
 23617     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23618        GO TO 7350-SET-ERROR-FLAGS.
 23619
 23620     IF PI-COMPANY-ID = 'UCL'
 23621         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23622             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23623             MOVE ' '                   TO DC-OPTION-CODE
 23624             PERFORM 9700-DATE-LINK
 23625             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23626
 23627     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 434
* EL6311.cbl
 23628     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23629     if (emi-fatal)
 23630        and (emi-error not = 1753 and 1754 and 1757 and
 23631                             1758 and 1759 and 1760)
 23632        add +1                   to pi-6311-fatal-ctr
 23633     end-if
 23634     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23635
 23636     GO TO 7310-ERROR-LOOP.
 23637
 23638
 23639 7350-SET-ERROR-FLAGS.
 23640
 23641     IF EMI-FATAL-CTR NOT = ZEROS
 23642        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23643        MOVE 'X'                 TO PB-FATAL-FLAG
 23644                                    PI-ERRORS-SW
 23645        GO TO 7355-SET-ERROR-FLAGS.
 23646
 23647     move ' ' to pi-unforced-sw
 23648     IF EMI-FORCABLE-CTR NOT = ZEROS
 23649        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23650        IF PB-ISSUE
 23651           IF PB-ISSUE-FORCE
 23652              MOVE 'F'           TO PB-FORCE-ER-CD
 23653              MOVE ER-2600       TO EMI-ERROR
 23654              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23655             ELSE
 23656              MOVE 'X'           TO PB-FORCE-ER-CD
 23657*                                   PI-ERRORS-SW
 23658          ELSE
 23659           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23660              MOVE 'F'           TO PB-FORCE-ER-CD
 23661                                    pi-unforced-sw
 23662              MOVE ER-2600       TO EMI-ERROR
 23663              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23664             ELSE
 23665              MOVE 'X'           TO PB-FORCE-ER-CD
 23666                                    pi-unforced-sw.
 23667*                                   PI-ERRORS-SW.
 23668
 23669     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23670     IF PB-ISSUE
 23671         MOVE 'I'                TO ENDT-RECORD-TYPE
 23672     ELSE
 23673         MOVE 'C'                TO ENDT-RECORD-TYPE
 23674     END-IF
 23675     MOVE +0                     TO ENDT-SEQ-NO
 23676
 23677
 23678* EXEC CICS READ
 23679*        DATASET   (FILE-ID-ERENDT)
 23680*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23681*        RIDFLD    (ERENDT-KEY)
 23682*        RESP      (WS-RESPONSE)
 23683*        GTEQ
 23684*    END-EXEC
 23685*    MOVE '&"S        G          (  N#00019792' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 435
* EL6311.cbl
 23686     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23688     MOVE X'204E233030303139373932' TO DFHEIV0(25:11)
 23689     CALL 'kxdfhei1' USING DFHEIV0,
 23690           FILE-ID-ERENDT,
 23691           DFHEIV20,
 23692           DFHEIV99,
 23693           ERENDT-KEY,
 23694           DFHEIV99,
 23695           DFHEIV99,
 23696           DFHEIV99
 23697     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23698         DFHEIV20
 23699     MOVE EIBRESP  TO WS-RESPONSE
 23700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23701
 23702     IF RESP-NORMAL
 23703        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23704        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23705            MOVE ER-0280          TO EMI-ERROR
 23706            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23707            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23708            IF CALLED-FROM-6315
 23709               MOVE 'Y' TO WS-ARCHIVE-LETTER-SW
 23710            END-IF
 23711            EVALUATE TRUE
 23712              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23713                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23714              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23715                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23716              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23717                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23718            END-EVALUATE
 23719        END-IF
 23720     END-IF
 23721
 23722
 23723
 23724     IF FIRST-ENTRY OR
 23725        EIBAID = DFHPF1 OR DFHPF2
 23726        MOVE '0'                TO PI-EDIT-SW
 23727        GO TO 7399-EXIT.
 23728
 23729 7355-SET-ERROR-FLAGS.
 23730
 23731     IF EMI-WARNING-CTR NOT = ZEROS
 23732        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23733        MOVE 'W'                 TO PB-WARN-ER-CD.
 23734
 23735     IF PB-UNFORCED-ERRORS OR
 23736        PB-FATAL-ERRORS    OR
 23737        PB-RECORD-ON-HOLD  OR
 23738        PB-RECORD-RETURNED OR
 23739        PB-CANCELLATION
 23740          NEXT SENTENCE
 23741        ELSE
 23742          GO TO 7399-EXIT.
 23743
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 436
* EL6311.cbl
 23744
 23745* EXEC CICS  HANDLE CONDITION
 23746*           NOTFND   (7399-EXIT)
 23747*    END-EXEC.
 23748*    MOVE '"$I                   ! Z #00019842' TO DFHEIV0
 23749     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23750     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23751     MOVE X'5A20233030303139383432' TO DFHEIV0(25:11)
 23752     CALL 'kxdfhei1' USING DFHEIV0
 23753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23754
 23755
 23756     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23757     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23758     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23759     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23760
 23761
 23762* EXEC CICS READ
 23763*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23764*        DATASET (FILE-ID-ELCERT)
 23765*        RIDFLD  (ELCERT-KEY)
 23766*        UPDATE
 23767*    END-EXEC.
 23768*    MOVE '&"S        EU         (   #00019851' TO DFHEIV0
 23769     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23770     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23771     MOVE X'2020233030303139383531' TO DFHEIV0(25:11)
 23772     CALL 'kxdfhei1' USING DFHEIV0,
 23773           FILE-ID-ELCERT,
 23774           DFHEIV20,
 23775           DFHEIV99,
 23776           ELCERT-KEY,
 23777           DFHEIV99,
 23778           DFHEIV99,
 23779           DFHEIV99
 23780     SET ADDRESS OF CERTIFICATE-MASTER TO
 23781         DFHEIV20
 23782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23783
 23784
 23785
 23786     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23787     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23788
 23789     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23790        GO TO 7360-REWRITE-CERT-MASTER.
 23791
 23792     IF PB-ISSUE
 23793        IF PB-RECORD-RETURNED
 23794            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23795            GO TO 7360-REWRITE-CERT-MASTER
 23796        ELSE
 23797            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23798            GO TO 7360-REWRITE-CERT-MASTER.
 23799
 23800     IF PB-RECORD-RETURNED
 23801         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 437
* EL6311.cbl
 23802         GO TO 7360-REWRITE-CERT-MASTER.
 23803
 23804     IF (PB-C-LF-CANCEL-VOIDED)
 23805        or (pb-c-ah-cancel-voided)
 23806        IF (PB-UNFORCED-ERRORS OR
 23807            PB-FATAL-ERRORS    OR
 23808            PB-RECORD-ON-HOLD)
 23809            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23810            GO TO 7360-REWRITE-CERT-MASTER
 23811        ELSE
 23812            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23813            GO TO 7360-REWRITE-CERT-MASTER.
 23814
 23815     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23816                            OR PB-RECORD-ON-HOLD)
 23817        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23818     ELSE
 23819        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23820
 23821 7360-REWRITE-CERT-MASTER.
 23822
 23823     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23824        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23825
 23826* EXEC CICS UNLOCK
 23827*            DATASET    (FILE-ID-ELCERT)
 23828*       END-EXEC
 23829*    MOVE '&*                    #   #00019898' TO DFHEIV0
 23830     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23831     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23832     MOVE X'2020233030303139383938' TO DFHEIV0(25:11)
 23833     CALL 'kxdfhei1' USING DFHEIV0,
 23834           FILE-ID-ELCERT,
 23835           DFHEIV99
 23836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23837        GO TO 7399-EXIT.
 23838
 23839
 23840* EXEC CICS REWRITE
 23841*         DATASET    (FILE-ID-ELCERT)
 23842*         FROM       (CERTIFICATE-MASTER)
 23843*    END-EXEC.
 23844     MOVE LENGTH OF
 23845      CERTIFICATE-MASTER
 23846       TO DFHEIV11
 23847*    MOVE '&& L                  %   #00019903' TO DFHEIV0
 23848     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23849     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23850     MOVE X'2020233030303139393033' TO DFHEIV0(25:11)
 23851     CALL 'kxdfhei1' USING DFHEIV0,
 23852           FILE-ID-ELCERT,
 23853           CERTIFICATE-MASTER,
 23854           DFHEIV11,
 23855           DFHEIV99
 23856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23857
 23858
 23859 7399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 438
* EL6311.cbl
 23860      EXIT.
 23861
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 439
* EL6311.cbl
 23863
 23864*************************************************************
 23865*                                                           *
 23866*              S E T   A T T R I B U T E S                  *
 23867*                                                           *
 23868*************************************************************
 23869
 23870 7400-SET-ATTRIBUTES.
 23871
 23872     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23873        GO TO 7499-EXIT.
 23874
 23875**2601**
 23876
 23877     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23878        IF PB-ISSUE
 23879           MOVE AL-UABON         TO BEFFDTA
 23880           GO TO 7499-EXIT
 23881         ELSE
 23882           MOVE AL-UABON         TO CEFFDTA
 23883           GO TO 7499-EXIT.
 23884
 23885**2604**
 23886
 23887     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23888        IF PB-ISSUE
 23889           MOVE AL-UABON         TO BTYPE1A
 23890           MOVE -1               TO BTYPE1L
 23891           MOVE  1               TO SET-CURSOR-SW
 23892           GO TO 7499-EXIT.
 23893
 23894**2605**
 23895
 23896     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23897        IF PB-ISSUE
 23898           MOVE AL-UABON         TO BTYPE2A
 23899           MOVE -1               TO BTYPE2L
 23900           MOVE  1               TO SET-CURSOR-SW
 23901           GO TO 7499-EXIT.
 23902
 23903**2606**
 23904
 23905     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23906        IF PB-ISSUE
 23907           MOVE AL-UABON         TO BSIGA
 23908           MOVE -1               TO BSIGL
 23909           MOVE  1               TO SET-CURSOR-SW
 23910           GO TO 7499-EXIT.
 23911
 23912**2607**
 23913
 23914     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23915        IF PB-ISSUE
 23916           MOVE AL-UABON         TO BSIGA
 23917           MOVE -1               TO BSIGL
 23918           MOVE  1               TO SET-CURSOR-SW
 23919           GO TO 7499-EXIT.
 23920
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 440
* EL6311.cbl
 23921**2615**
 23922
 23923     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23924        IF PB-ISSUE
 23925           MOVE AL-UABOF         TO BREINA
 23926           MOVE -1               TO BREINL
 23927           GO TO 7499-EXIT.
 23928
 23929**2622**
 23930
 23931     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23932        IF PB-ISSUE
 23933           MOVE AL-UABON         TO BEFFDTA
 23934           GO TO 7499-EXIT
 23935        ELSE
 23936           MOVE AL-UABON         TO CEFFDTA
 23937           GO TO 7499-EXIT.
 23938
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 441
* EL6311.cbl
 23940
 23941*************************************************************
 23942*                                                           *
 23943*              I S S U E   E R R O R S                      *
 23944*                                                           *
 23945*************************************************************
 23946
 23947 7420-ISSUE-ERRORS.
 23948
 23949     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1577
 23950        MOVE -1                  TO LETRREQL
 23951        MOVE AL-UABOF            TO LETRREQA
 23952        MOVE  1                  TO SET-CURSOR-SW
 23953        GO TO 7499-EXIT.
 23954
 23955     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1584
 23956        MOVE AL-UABOF            TO LETRREQA
 23957        GO TO 7499-EXIT.
 23958
 23959**2626**
 23960
 23961     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23962        MOVE AL-UABON            TO BCERTNOA
 23963        GO TO 7499-EXIT.
 23964
 23965**2627**
 23966
 23967     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23968        MOVE AL-UNBON            TO BAGEA
 23969        MOVE -1                  TO BAGEL
 23970        MOVE  1                  TO SET-CURSOR-SW
 23971        GO TO 7499-EXIT.
 23972
 23973**2628**
 23974
 23975     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23976        MOVE AL-UNBON            TO BAGEA
 23977        MOVE -1                  TO BAGEL
 23978        MOVE  1                  TO SET-CURSOR-SW
 23979        GO TO 7499-EXIT.
 23980
 23981**2629**
 23982
 23983     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23984        MOVE AL-UABON            TO BSEXA
 23985        MOVE -1                  TO BSEXL
 23986        MOVE  1                  TO SET-CURSOR-SW
 23987        GO TO 7499-EXIT.
 23988
 23989**2630**
 23990
 23991     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23992        MOVE -1                  TO BTYPE1L
 23993        MOVE  1                  TO SET-CURSOR-SW
 23994        GO TO 7499-EXIT.
 23995
 23996**2631**
 23997
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 442
* EL6311.cbl
 23998     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23999        MOVE -1                  TO BTYPE1L
 24000        MOVE  1                  TO SET-CURSOR-SW
 24001        GO TO 7499-EXIT.
 24002
 24003**2632**
 24004
 24005     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 24006        MOVE AL-UNBON            TO BBEN1A
 24007        MOVE -1                  TO BBEN1L
 24008        MOVE  1                  TO SET-CURSOR-SW
 24009        GO TO 7499-EXIT.
 24010
 24011**2633**
 24012
 24013     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 24014        MOVE AL-UNBON            TO BPREM1A
 24015        MOVE -1                  TO BPREM1L
 24016        MOVE  1                  TO SET-CURSOR-SW
 24017        GO TO 7499-EXIT.
 24018
 24019**2634**
 24020
 24021     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 24022        MOVE -1                  TO BTYPE2L
 24023        MOVE  1                  TO SET-CURSOR-SW
 24024        GO TO 7499-EXIT.
 24025
 24026**2635**
 24027
 24028     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 24029        MOVE AL-UNBON            TO BBEN2A
 24030        MOVE -1                  TO BBEN2L
 24031        MOVE  1                  TO SET-CURSOR-SW
 24032        GO TO 7499-EXIT.
 24033
 24034**2636**
 24035
 24036     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 24037        MOVE AL-UNBON            TO BPREM2A
 24038        MOVE -1                  TO BPREM2L
 24039        MOVE  1                  TO SET-CURSOR-SW
 24040        GO TO 7499-EXIT.
 24041
 24042**2639**
 24043
 24044     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 24045        MOVE AL-UNBON            TO BBEN1A
 24046        MOVE -1                  TO BBEN1L
 24047        MOVE  1                  TO SET-CURSOR-SW
 24048        GO TO 7499-EXIT.
 24049
 24050**2640**
 24051
 24052     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 24053        MOVE AL-UNBON            TO BBEN2A
 24054        MOVE -1                  TO BBEN2L
 24055        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 443
* EL6311.cbl
 24056        GO TO 7499-EXIT.
 24057
 24058**2647**
 24059
 24060     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 24061        MOVE AL-UNBON            TO BTERM1A
 24062        MOVE -1                  TO BTERM1L
 24063        MOVE  1                  TO SET-CURSOR-SW
 24064        GO TO 7499-EXIT.
 24065
 24066**2648**
 24067
 24068     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 24069              or er-3070
 24070        MOVE AL-UNBON            TO BLNTRMA
 24071        MOVE -1                  TO BLNTRML
 24072        MOVE  1                  TO SET-CURSOR-SW
 24073        GO TO 7499-EXIT.
 24074
 24075**2649**
 24076
 24077     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 24078        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 24079            MOVE AL-UNBON            TO BPREM1A
 24080            MOVE -1                  TO BPREM1L
 24081            MOVE  1                  TO SET-CURSOR-SW
 24082            GO TO 7499-EXIT
 24083     ELSE
 24084        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 24085           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24086            MOVE AL-UNBON            TO BPREM2A
 24087            MOVE -1                  TO BPREM2L
 24088            MOVE  1                  TO SET-CURSOR-SW
 24089            GO TO 7499-EXIT.
 24090
 24091**2650**
 24092
 24093     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 24094        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 24095            MOVE AL-UNBON        TO BPREM1A
 24096            MOVE -1              TO BPREM1L
 24097            MOVE  1              TO SET-CURSOR-SW
 24098            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24099                MOVE AL-UNBON        TO BPREM2A
 24100                MOVE -1              TO BPREM2L
 24101                MOVE  1              TO SET-CURSOR-SW
 24102                GO TO 7499-EXIT
 24103            ELSE
 24104                GO TO 7499-EXIT
 24105        ELSE
 24106            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24107                MOVE AL-UNBON        TO BPREM2A
 24108                MOVE -1              TO BPREM2L
 24109                MOVE  1              TO SET-CURSOR-SW
 24110                GO TO 7499-EXIT
 24111            ELSE
 24112                GO TO 7499-EXIT.
 24113
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 444
* EL6311.cbl
 24114**2651**
 24115
 24116     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2651
 24117        MOVE AL-UABON            TO BSIGA
 24118        MOVE -1                  TO BSIGL
 24119        MOVE  1                  TO SET-CURSOR-SW
 24120        GO TO 7499-EXIT.
 24121
 24122**2653**
 24123
 24124     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
 24125        MOVE AL-UABON            TO BFREQA
 24126        MOVE -1                  TO BFREQL
 24127        MOVE  1                  TO SET-CURSOR-SW
 24128        GO TO 7499-EXIT.
 24129
 24130**2654**
 24131
 24132     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 24133        MOVE AL-UABON            TO BFREQA
 24134        MOVE -1                  TO BFREQL
 24135        MOVE  1                  TO SET-CURSOR-SW
 24136        GO TO 7499-EXIT.
 24137
 24138**2655**
 24139
 24140     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 24141        MOVE AL-UABON            TO BFREQA
 24142        MOVE -1                  TO BFREQL
 24143        MOVE  1                  TO SET-CURSOR-SW
 24144        GO TO 7499-EXIT.
 24145
 24146**2656**
 24147
 24148     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 24149        MOVE AL-UNBON            TO BAPRA
 24150        MOVE -1                  TO BAPRL
 24151        MOVE  1                  TO SET-CURSOR-SW
 24152        GO TO 7499-EXIT.
 24153
 24154**2657**
 24155
 24156     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 24157        MOVE AL-UNBON            TO BAPRA
 24158        MOVE -1                  TO BAPRL
 24159        MOVE  1                  TO SET-CURSOR-SW
 24160        GO TO 7499-EXIT.
 24161
 24162**2658**
 24163
 24164     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 24165        MOVE AL-UNBON            TO BTERM2A
 24166        MOVE -1                  TO BTERM2L
 24167        MOVE  1                  TO SET-CURSOR-SW
 24168        GO TO 7499-EXIT.
 24169
 24170**2660**
 24171
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 445
* EL6311.cbl
 24172     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 24173        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 24174        MOVE -1                  TO BLSTNML
 24175        MOVE  1                  TO SET-CURSOR-SW
 24176        GO TO 7499-EXIT.
 24177
 24178
 24179**2662**
 24180
 24181     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 24182        MOVE AL-UNBON            TO BAGEA
 24183        MOVE -1                  TO BAGEL
 24184        MOVE  1                  TO SET-CURSOR-SW
 24185        GO TO 7499-EXIT.
 24186
 24187**2663**
 24188
 24189     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 24190        MOVE AL-UNBON            TO BAGEA
 24191        MOVE -1                  TO BAGEL
 24192        MOVE  1                  TO SET-CURSOR-SW
 24193        GO TO 7499-EXIT.
 24194
 24195**2664**
 24196
 24197     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 24198        MOVE AL-UABON            TO BREINA
 24199        MOVE -1                  TO BREINL
 24200        MOVE  1                  TO SET-CURSOR-SW
 24201        GO TO 7499-EXIT.
 24202
 24203**2667**
 24204
 24205     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 24206        MOVE AL-UNBON            TO BBEN2A
 24207        MOVE -1                  TO BBEN2L
 24208        MOVE  1                  TO SET-CURSOR-SW
 24209        GO TO 7499-EXIT.
 24210
 24211**2668**
 24212
 24213     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 24214        MOVE AL-UABON            TO BEFFDTA
 24215        GO TO 7499-EXIT.
 24216
 24217**2669**
 24218
 24219     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 24220       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 24221       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 24222        MOVE AL-UNBON            TO BAGEA
 24223        MOVE -1                  TO BAGEL
 24224        MOVE  1                  TO SET-CURSOR-SW
 24225        GO TO 7499-EXIT.
 24226
 24227**2670**
 24228
 24229     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 446
* EL6311.cbl
 24230        MOVE AL-UABON            TO BFORCEA
 24231        MOVE -1                  TO BFORCEL
 24232        MOVE  1                  TO SET-CURSOR-SW
 24233        GO TO 7499-EXIT.
 24234
 24235**2671**
 24236
 24237     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 24238        MOVE AL-UABON            TO BEFFDTA
 24239        GO TO 7499-EXIT.
 24240
 24241**2672**
 24242
 24243     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 24244        MOVE AL-UABON            TO BEFFDTA
 24245        GO TO 7499-EXIT.
 24246
 24247**2673**
 24248
 24249     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24250        MOVE AL-UABON            TO BEFFDTA
 24251        GO TO 7499-EXIT.
 24252
 24253**2674**
 24254
 24255     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24256        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 24257        MOVE -1                  TO BTYPE1L
 24258        MOVE  1                  TO SET-CURSOR-SW
 24259        GO TO 7499-EXIT.
 24260
 24261**2677**
 24262
 24263     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 24264        MOVE AL-UNBON            TO BTERM1A
 24265        MOVE -1                  TO BTERM1L
 24266        MOVE  1                  TO SET-CURSOR-SW
 24267        GO TO 7499-EXIT.
 24268
 24269**2678**
 24270
 24271     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 24272        MOVE AL-UNBON            TO BTERM2A
 24273        MOVE -1                  TO BTERM2L
 24274        MOVE  1                  TO SET-CURSOR-SW
 24275        GO TO 7499-EXIT.
 24276
 24277**2679**
 24278
 24279     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 24280        MOVE AL-UABON            TO BTYPE1A
 24281        MOVE -1                  TO BTYPE1L
 24282        MOVE  1                  TO SET-CURSOR-SW
 24283        GO TO 7499-EXIT.
 24284
 24285**2680**
 24286
 24287     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 447
* EL6311.cbl
 24288        MOVE AL-UABOF            TO B1STPMTA
 24289        MOVE -1                  TO B1STPMTL
 24290        MOVE  1                  TO SET-CURSOR-SW
 24291        GO TO 7499-EXIT.
 24292
 24293**2681**
 24294
 24295     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 24296        MOVE AL-UABON            TO BDAYSA
 24297        MOVE -1                  TO BDAYSL
 24298        MOVE  1                  TO SET-CURSOR-SW
 24299        GO TO 7499-EXIT.
 24300
 24301**2682**
 24302
 24303     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 24304        MOVE AL-UABON            TO BTERM1A
 24305        MOVE -1                  TO BTERM1L
 24306        MOVE  1                  TO SET-CURSOR-SW
 24307        GO TO 7499-EXIT.
 24308
 24309**2683**
 24310
 24311     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 24312        MOVE AL-UABON            TO BSKPCDA
 24313        MOVE -1                  TO BSKPCDL
 24314        MOVE  1                  TO SET-CURSOR-SW
 24315        GO TO 7499-EXIT.
 24316
 24317**2684**
 24318
 24319     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 24320        MOVE AL-UABON            TO BTYPE2A
 24321        MOVE -1                  TO BTYPE2L
 24322        MOVE  1                  TO SET-CURSOR-SW
 24323        GO TO 7499-EXIT.
 24324
 24325**2686**
 24326
 24327     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 24328        MOVE AL-UABON            TO BTYPE2A
 24329        MOVE -1                  TO BTYPE2L
 24330        MOVE  1                  TO SET-CURSOR-SW
 24331        GO TO 7499-EXIT.
 24332
 24333**2689**
 24334
 24335     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 24336        MOVE AL-UABON            TO BSIGA
 24337        MOVE -1                  TO BSIGL
 24338        MOVE  1                  TO SET-CURSOR-SW
 24339        GO TO 7499-EXIT.
 24340
 24341**2690**
 24342
 24343     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 24344        MOVE AL-UABOF            TO BLNOFCRA
 24345        MOVE -1                  TO BLNOFCRL
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 448
* EL6311.cbl
 24346        MOVE  1                  TO SET-CURSOR-SW
 24347        GO TO 7499-EXIT.
 24348
 24349**2693**
 24350
 24351     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 24352        MOVE AL-UABOF            TO BLNOFCRA
 24353        MOVE AL-UNBON            TO BBEN1A
 24354        MOVE -1                  TO BBEN1L
 24355        MOVE  1                  TO SET-CURSOR-SW
 24356        GO TO 7499-EXIT.
 24357
 24358**2720**
 24359
 24360     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 24361        MOVE AL-UNBON            TO BBEN1A
 24362        MOVE -1                  TO BBEN1L
 24363        MOVE  1                  TO SET-CURSOR-SW
 24364        GO TO 7499-EXIT.
 24365
 24366**2709**
 24367
 24368*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 24369*       MOVE AL-UNBON            TO BBEN1A
 24370*       MOVE -1                  TO BBEN1L
 24371*       MOVE  1                  TO SET-CURSOR-SW
 24372*       GO TO 7499-EXIT.
 24373
 24374*************************************************************
 24375*                                                           *
 24376*            C A N C E L   E R R O R S                      *
 24377*                                                           *
 24378*************************************************************
 24379
 24380**2726**
 24381
 24382     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 24383        MOVE AL-UABON            TO CCERTNOA
 24384        GO TO 7499-EXIT.
 24385
 24386**2728**
 24387
 24388     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 24389        MOVE AL-UABON            TO CCERTNOA
 24390        GO TO 7499-EXIT.
 24391
 24392**2729**
 24393
 24394     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24395        MOVE AL-UABON            TO CCERTNOA
 24396        GO TO 7499-EXIT.
 24397
 24398**2730**
 24399
 24400     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24401        MOVE AL-UABON            TO CCERTNOA
 24402        GO TO 7499-EXIT.
 24403
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 449
* EL6311.cbl
 24404**2731**
 24405
 24406     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24407        MOVE AL-UABON            TO CCANDT1A
 24408        MOVE -1                  TO CCANDT1L
 24409        MOVE  1                  TO SET-CURSOR-SW
 24410        GO TO 7499-EXIT.
 24411
 24412**2732**
 24413
 24414     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 24415        MOVE AL-UABON            TO CCANDT1A
 24416        MOVE -1                  TO CCANDT1L
 24417        MOVE  1                  TO SET-CURSOR-SW
 24418        GO TO 7499-EXIT.
 24419
 24420**2733**
 24421
 24422     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24423        MOVE AL-UABON            TO CCANDT1A
 24424        MOVE -1                  TO CCANDT1L
 24425        MOVE  1                  TO SET-CURSOR-SW
 24426        GO TO 7499-EXIT.
 24427
 24428**2734**
 24429
 24430     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24431        MOVE AL-UNBON            TO CREFND1A
 24432        MOVE -1                  TO CREFND1L
 24433        MOVE  1                  TO SET-CURSOR-SW
 24434        GO TO 7499-EXIT.
 24435
 24436**2735**
 24437
 24438     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24439        MOVE AL-UABON            TO CCANDT2A
 24440        MOVE -1                  TO CCANDT2L
 24441        MOVE  1                  TO SET-CURSOR-SW
 24442        GO TO 7499-EXIT.
 24443
 24444**2736**
 24445
 24446     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24447        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24448            MOVE AL-UNBON        TO CREFND1A
 24449            MOVE -1              TO CREFND1L
 24450            MOVE  1              TO SET-CURSOR-SW
 24451            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24452                MOVE AL-UNBON        TO CREFND2A
 24453                MOVE -1              TO CREFND2L
 24454                MOVE  1              TO SET-CURSOR-SW
 24455                GO TO 7499-EXIT
 24456            ELSE
 24457                GO TO 7499-EXIT
 24458        ELSE
 24459            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24460                MOVE AL-UNBON        TO CREFND2A
 24461                MOVE -1              TO CREFND2L
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 450
* EL6311.cbl
 24462                MOVE  1              TO SET-CURSOR-SW
 24463                GO TO 7499-EXIT
 24464            ELSE
 24465                GO TO 7499-EXIT.
 24466
 24467**2738**
 24468
 24469     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24470        MOVE -1                  TO CREFND2L
 24471        MOVE  1                  TO SET-CURSOR-SW
 24472        GO TO 7499-EXIT.
 24473
 24474**2739**
 24475
 24476     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24477        MOVE -1                  TO CREFND1L
 24478        MOVE  1                  TO SET-CURSOR-SW
 24479        GO TO 7499-EXIT.
 24480
 24481**2741**
 24482
 24483     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24484        MOVE -1                  TO CREFND1L
 24485        MOVE  1                  TO SET-CURSOR-SW
 24486        GO TO 7499-EXIT.
 24487
 24488**2743**
 24489
 24490     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24491        MOVE AL-UNBON            TO CCANDT1A
 24492        MOVE -1                  TO CCANDT1L
 24493        MOVE  1                  TO SET-CURSOR-SW
 24494        GO TO 7499-EXIT.
 24495
 24496**2744**
 24497
 24498     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24499        MOVE AL-UNBON            TO CCANDT2A
 24500        MOVE -1                  TO CCANDT2L
 24501        MOVE  1                  TO SET-CURSOR-SW
 24502        GO TO 7499-EXIT.
 24503
 24504**2747**
 24505
 24506     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24507        MOVE AL-UABON            TO CLSTNMA
 24508        MOVE -1                  TO CLSTNML
 24509        MOVE  1                  TO SET-CURSOR-SW
 24510        GO TO 7499-EXIT.
 24511
 24512**2749**
 24513
 24514     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24515        MOVE AL-UABON            TO CFORCEA
 24516        MOVE -1                  TO CFORCEL
 24517        MOVE  1                  TO SET-CURSOR-SW
 24518        GO TO 7499-EXIT.
 24519
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 451
* EL6311.cbl
 24520**2753**
 24521
 24522     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24523        MOVE AL-UNBON            TO CCANDT1A
 24524        MOVE -1                  TO CCANDT1L
 24525        MOVE  1                  TO SET-CURSOR-SW
 24526        GO TO 7499-EXIT.
 24527
 24528**2755**
 24529
 24530     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 24531        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24532            MOVE AL-UNBON        TO CREFND1A
 24533            MOVE -1              TO CREFND1L
 24534            MOVE  1              TO SET-CURSOR-SW
 24535            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24536                MOVE AL-UNBON        TO CREFND2A
 24537                MOVE -1              TO CREFND2L
 24538                MOVE  1              TO SET-CURSOR-SW
 24539                GO TO 7499-EXIT
 24540            ELSE
 24541                GO TO 7499-EXIT
 24542        ELSE
 24543            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24544                MOVE AL-UNBON        TO CREFND2A
 24545                MOVE -1              TO CREFND2L
 24546                MOVE  1              TO SET-CURSOR-SW
 24547            ELSE
 24548                GO TO 7499-EXIT.
 24549
 24550**2757**
 24551
 24552     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24553        MOVE AL-UNBON            TO CLIVESA
 24554        MOVE -1                  TO CLIVESL
 24555        MOVE  1                  TO SET-CURSOR-SW
 24556        GO TO 7499-EXIT.
 24557
 24558**2771**
 24559
 24560     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24561        MOVE AL-UABON            TO CCANDT2A
 24562        MOVE -1                  TO CCANDT2L
 24563        MOVE  1                  TO SET-CURSOR-SW
 24564        GO TO 7499-EXIT.
 24565
 24566**2774**
 24567
 24568     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24569        MOVE AL-UABON            TO CCANDT1A
 24570        MOVE -1                  TO CCANDT1L
 24571        MOVE  1                  TO SET-CURSOR-SW
 24572        GO TO 7499-EXIT.
 24573
 24574**2775**
 24575
 24576     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24577        MOVE AL-UABON            TO CCANDT2A
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 452
* EL6311.cbl
 24578        MOVE -1                  TO CCANDT2L
 24579        MOVE  1                  TO SET-CURSOR-SW
 24580        GO TO 7499-EXIT.
 24581
 24582**2776**
 24583
 24584     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24585        MOVE AL-UABON            TO CCANDT1A
 24586        MOVE -1                  TO CCANDT1L
 24587        MOVE  1                  TO SET-CURSOR-SW
 24588        GO TO 7499-EXIT.
 24589
 24590
 24591**2777**
 24592
 24593     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24594        MOVE AL-UABON            TO CCANDT2A
 24595        MOVE -1                  TO CCANDT2L
 24596        MOVE  1                  TO SET-CURSOR-SW
 24597        GO TO 7499-EXIT.
 24598
 24599**2794**
 24600
 24601     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24602        MOVE AL-UABON            TO CFORCEA
 24603        MOVE -1                  TO CFORCEL
 24604        MOVE  1                  TO SET-CURSOR-SW
 24605        GO TO 7499-EXIT.
 24606
 24607**2799**
 24608
 24609     IF PI-COMPANY-ID = 'UCL'
 24610         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24611             MOVE AL-UNBON            TO BEFFDTA
 24612             MOVE -1                  TO BEFFDTL
 24613             MOVE  1                  TO SET-CURSOR-SW
 24614             GO TO 7499-EXIT.
 24615
 24616 7499-EXIT.
 24617      EXIT.
 24618
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 453
* EL6311.cbl
 24620
 24621 7500-READ-ERLOFC.
 24622     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24623                                     ERLOFC-KEY.
 24624
 24625     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24626
 24627     IF ST-ACCNT-CNTL
 24628         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24629
 24630     IF CARR-GROUP-ST-ACCNT-CNTL
 24631         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24632         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24633         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24634
 24635     IF CARR-ST-ACCNT-CNTL
 24636         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24637         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24638
 24639     IF CARR-ACCNT-CNTL
 24640         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24641
 24642     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24643
 24644     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24645
 24646
 24647* EXEC CICS HANDLE CONDITION
 24648*        NOTFND   (7550-OFFICER-NOTFND)
 24649*    END-EXEC.
 24650*    MOVE '"$I                   ! [ #00020695' TO DFHEIV0
 24651     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24653     MOVE X'5B20233030303230363935' TO DFHEIV0(25:11)
 24654     CALL 'kxdfhei1' USING DFHEIV0
 24655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24656
 24657
 24658
 24659* EXEC CICS READ
 24660*        DATASET   (FILE-ID-ERLOFC)
 24661*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24662*        RIDFLD    (ERLOFC-KEY)
 24663*        EQUAL
 24664*    END-EXEC.
 24665*    MOVE '&"S        E          (   #00020699' TO DFHEIV0
 24666     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24668     MOVE X'2020233030303230363939' TO DFHEIV0(25:11)
 24669     CALL 'kxdfhei1' USING DFHEIV0,
 24670           FILE-ID-ERLOFC,
 24671           DFHEIV20,
 24672           DFHEIV99,
 24673           ERLOFC-KEY,
 24674           DFHEIV99,
 24675           DFHEIV99,
 24676           DFHEIV99
 24677     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 454
* EL6311.cbl
 24678         DFHEIV20
 24679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24680
 24681
 24682     GO TO 7599-EXIT.
 24683
 24684 7550-OFFICER-NOTFND.
 24685     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24686
 24687 7599-EXIT.
 24688      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 455
* EL6311.cbl
 24690******************************************************************
 24691*                                                                *
 24692*            S  E N D    I N I T I A L   M A P                   *
 24693*                                                                *
 24694******************************************************************
 24695
 24696 8100-SEND-INITIAL-MAP.
 24697     MOVE EIBTIME                TO TIME-IN.
 24698
 24699     IF EIBAID = DFHPF11
 24700        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24701        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24702
 24703
 24704     IF PI-COMPANY-ID = CLIENT-GIC
 24705        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24706                                       BCPREM-ATTRB (2).
 24707
 24708     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24709                         CLIENT-PEM OR
 24710                         CLIENT-CSO)
 24711        AND PI-DISPLAY-ORIGINAL-BATCH
 24712          IF PI-MAP-NAME = EL631B
 24713             MOVE AL-SADOF               TO BPF5HDRA
 24714                                            BPF4HDRA
 24715          ELSE
 24716             IF PI-MAP-NAME = EL631C
 24717                MOVE AL-SADOF            TO CPF5HDRA
 24718                                            CPF4HDRA.
 24719
 24720     IF PI-MAP-NAME = EL631B
 24721        MOVE AL-SADOF               TO BPF5HDRA
 24722     ELSE
 24723        MOVE AL-SADOF               TO CPF5HDRA
 24724     END-IF
 24725
 24726*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24727     IF PI-MAP-NAME = EL631B
 24728          IF PI-COMPANY-ID NOT = 'DMD'
 24729             MOVE AL-SANOF            TO BBILLEDA
 24730             MOVE AL-SADOF            TO DMDBILA.
 24731*DMD CUSTOM CODING*************END
 24732
 24733     IF PI-PROCESSOR-ID = 'LGXX'
 24734        IF PI-MAP-NAME = EL631B
 24735           MOVE AL-SABOF                    TO BREFHDGA
 24736           MOVE AL-SANOF                    TO BREFA
 24737        ELSE
 24738           IF PI-MAP-NAME = EL631C
 24739              MOVE AL-SABOF                 TO CREFHDGA
 24740              MOVE AL-SANOF                 TO CREFA.
 24741
 24742     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24743        continue
 24744     ELSE
 24745        IF PI-MAP-NAME = EL631C
 24746           MOVE AL-SADOF         TO CCANTXTA
 24747                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 456
* EL6311.cbl
 24748        end-if
 24749     end-if
 24750     IF PI-MAP-NAME = EL631D
 24751        IF PI-AR-PROCESSING
 24752           MOVE AL-SANOF            TO DREFHDGA
 24753        ELSE
 24754           MOVE AL-SADOF            TO DREFHDGA.
 24755
 24756     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24757        AND (PI-MAP-NAME = EL631B)
 24758        MOVE AL-SADOF            TO BVINHA
 24759                                    BVINA
 24760     END-IF
 24761     IF PI-MAP-NAME = EL631B
 24762        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24763        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24764                                 TO BREGIONO
 24765        MOVE PI-PROCESSOR-ID     TO BUSERO
 24766        IF CSR-EDIT-SESSION
 24767           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24768                                 TO BHEADO
 24769           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24770        ELSE
 24771           MOVE AL-SADOF         TO BF15HDRA
 24772           MOVE '4=B-HDR      '  TO BPF4HDRO
 24773        END-IF
 24774        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24775        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24776        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24777        MOVE WS-CURRENT-DT          TO BDATEO
 24778        MOVE TIME-OUT               TO BTIMEO
 24779        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24780        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24781        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24782        IF   WS-DISPLAY-SCREEN
 24783             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24784             MOVE PB-SV-CARRIER     TO BCARRO
 24785             MOVE PB-SV-GROUPING    TO BGROUPO
 24786             MOVE PB-SV-STATE       TO BSTATEO
 24787             MOVE PB-ACCOUNT        TO BACCTO
 24788        ELSE
 24789             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24790     ELSE
 24791        IF PI-MAP-NAME = EL631C
 24792           MOVE '4=B-HDR      '     TO CPF4HDRO
 24793           IF CSR-EDIT-SESSION
 24794              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24795                                 TO CHEADO
 24796           ELSE
 24797              MOVE AL-SADOF      TO CF15HDRA
 24798           END-IF
 24799           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24800           MOVE WS-CURRENT-DT          TO CDATEO
 24801           MOVE TIME-OUT               TO CTIMEO
 24802           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24803           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24804           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24805           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 457
* EL6311.cbl
 24806           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24807           MOVE WS-C-HDG               TO CAHHDGO
 24808           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24809           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24810           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24811           IF   WS-DISPLAY-SCREEN
 24812                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24813                MOVE PB-SV-CARRIER     TO CCARRO
 24814                MOVE PB-SV-GROUPING    TO CGROUPO
 24815                MOVE PB-SV-STATE       TO CSTATEO
 24816                MOVE PB-ACCOUNT        TO CACCTO
 24817           ELSE
 24818                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24819        ELSE
 24820           MOVE WS-CURRENT-DT          TO DDATEO
 24821           MOVE TIME-OUT               TO DTIMEO
 24822           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24823                                          WS-REFUND-HDG-OVERRIDE
 24824           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24825           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24826           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24827                                          WS-REFUND-HDG-OVERRIDE
 24828           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24829           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24830           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24831           IF CSR-EDIT-SESSION
 24832              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24833                                 TO DHEADO
 24834           END-IF
 24835           IF  WS-DISPLAY-SCREEN
 24836               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24837               MOVE PB-CARRIER         TO DCARRO
 24838               MOVE PB-GROUPING        TO DGROUPO
 24839               MOVE PB-STATE           TO DSTATEO
 24840               MOVE PB-ACCOUNT         TO DACCTO
 24841               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24842           ELSE
 24843               MOVE EL631D             TO PI-MAP-NAME
 24844               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24845               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24846
 24847     MOVE SPACE                        TO WS-DISPLAY-SW.
 24848
 24849
 24850* EXEC CICS SEND
 24851*        MAP      (PI-MAP-NAME)
 24852*        MAPSET   (MAPSET-EL6311S)
 24853*        FROM     (EL631BI)
 24854*        ERASE
 24855*        CURSOR
 24856*    END-EXEC.
 24857     MOVE LENGTH OF
 24858      EL631BI
 24859       TO DFHEIV12
 24860     MOVE -1
 24861       TO DFHEIV11
 24862*    MOVE '8$     CT  E    H L F ,   #00020873' TO DFHEIV0
 24863     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 458
* EL6311.cbl
 24864     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24865     MOVE X'2020233030303230383733' TO DFHEIV0(25:11)
 24866     CALL 'kxdfhei1' USING DFHEIV0,
 24867           PI-MAP-NAME,
 24868           EL631BI,
 24869           DFHEIV12,
 24870           MAPSET-EL6311S,
 24871           DFHEIV99,
 24872           DFHEIV99,
 24873           DFHEIV99,
 24874           DFHEIV11,
 24875           DFHEIV99,
 24876           DFHEIV99,
 24877           DFHEIV99
 24878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24879
 24880
 24881     GO TO 9100-RETURN-TRAN.
 24882
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 459
* EL6311.cbl
 24884
 24885******************************************************************
 24886*                                                                *
 24887*              S E N D    D A T A O N L Y                        *
 24888*                                                                *
 24889******************************************************************
 24890
 24891 8200-SEND-DATAONLY.
 24892     MOVE EIBTIME                TO TIME-IN.
 24893
 24894     IF PI-COMPANY-ID = CLIENT-GIC
 24895        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24896                                       BCPREM-ATTRB (2).
 24897
 24898     IF PI-MAP-NAME = EL631B
 24899        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24900        MOVE WS-CURRENT-DT          TO BDATEO
 24901        MOVE TIME-OUT               TO BTIMEO
 24902        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24903        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24904        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24905        MOVE SPACES                 TO BPFENTRO
 24906        MOVE AL-UANOF               TO BPFENTRA
 24907
 24908*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24909        IF PI-COMPANY-ID NOT = 'DMD'
 24910             MOVE AL-SANOF            TO BBILLEDA
 24911             MOVE AL-SADOF            TO DMDBILA
 24912         ELSE
 24913            NEXT SENTENCE
 24914*DMD CUSTOM CODING*************END
 24915     ELSE
 24916        IF PI-MAP-NAME = EL631C
 24917           MOVE WS-CURRENT-DT          TO CDATEO
 24918           MOVE TIME-OUT               TO CTIMEO
 24919           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24920           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24921           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24922           MOVE SPACES                 TO CPFENTRO
 24923           MOVE AL-UANOF               TO CPFENTRA
 24924        ELSE
 24925           MOVE WS-CURRENT-DT          TO DDATEO
 24926           MOVE TIME-OUT               TO DTIMEO
 24927           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24928
 24929
 24930* EXEC CICS SEND
 24931*        MAP      (PI-MAP-NAME)
 24932*        MAPSET   (MAPSET-EL6311S)
 24933*        FROM     (EL631BI)
 24934*        DATAONLY
 24935*        CURSOR
 24936*    END-EXEC.
 24937     MOVE LENGTH OF
 24938      EL631BI
 24939       TO DFHEIV12
 24940     MOVE -1
 24941       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 460
* EL6311.cbl
 24942*    MOVE '8$D    CT       H L F ,   #00020929' TO DFHEIV0
 24943     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24944     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24945     MOVE X'2020233030303230393239' TO DFHEIV0(25:11)
 24946     CALL 'kxdfhei1' USING DFHEIV0,
 24947           PI-MAP-NAME,
 24948           EL631BI,
 24949           DFHEIV12,
 24950           MAPSET-EL6311S,
 24951           DFHEIV99,
 24952           DFHEIV99,
 24953           DFHEIV99,
 24954           DFHEIV11,
 24955           DFHEIV99,
 24956           DFHEIV99,
 24957           DFHEIV99
 24958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24959
 24960
 24961     GO TO 9100-RETURN-TRAN.
 24962
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 461
* EL6311.cbl
 24964
 24965******************************************************************
 24966*                                                                *
 24967*           U T I L I T Y   R O U T I N E S                      *
 24968*                                                                *
 24969******************************************************************
 24970
 24971 8300-SEND-TEXT.
 24972
 24973* EXEC CICS SEND TEXT
 24974*        FROM     (LOGOFF-TEXT)
 24975*        LENGTH   (LOGOFF-LENGTH)
 24976*        ERASE
 24977*        FREEKB
 24978*    END-EXEC.
 24979*    MOVE '8&      T  E F  H   F -   #00020948' TO DFHEIV0
 24980     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24981     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24982     MOVE X'2020233030303230393438' TO DFHEIV0(25:11)
 24983     CALL 'kxdfhei1' USING DFHEIV0,
 24984           LOGOFF-TEXT,
 24985           LOGOFF-LENGTH,
 24986           DFHEIV99,
 24987           DFHEIV99,
 24988           DFHEIV99,
 24989           DFHEIV99,
 24990           DFHEIV99,
 24991           DFHEIV99,
 24992           DFHEIV99,
 24993           DFHEIV99,
 24994           DFHEIV99,
 24995           DFHEIV99
 24996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24997
 24998
 24999
 25000* EXEC CICS RETURN
 25001*    END-EXEC.
 25002*    MOVE '.(                    ''   #00020955' TO DFHEIV0
 25003     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 25004     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 25005     MOVE X'2020233030303230393535' TO DFHEIV0(25:11)
 25006     CALL 'kxdfhei1' USING DFHEIV0,
 25007           DFHEIV99,
 25008           DFHEIV99,
 25009           DFHEIV99,
 25010           DFHEIV99,
 25011           DFHEIV99,
 25012           DFHEIV99
 25013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25014
 25015
 25016 8400-LOG-JOURNAL-RECORD.
 25017     if (pi-journal-file-id > 0)
 25018        and (jp-file-id = file-id-erpndb)
 25019        move eibdate             to jp-date
 25020        move eibtime             to jp-time
 25021        MOVE PI-PROCESSOR-ID     TO JP-USER-ID
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 462
* EL6311.cbl
 25022        MOVE 03                  TO PI-JOURNAL-FILE-ID
 25023        if csr-edit-session
 25024           move 'EL6311C'        to jp-program-id
 25025        else
 25026           MOVE THIS-PGM         TO JP-PROGRAM-ID
 25027        end-if
 25028
 25029**      length is 585 plus 30 extra for jrnl stuff
 25030**      system already accounts for the 34
 25031
 25032
 25033* EXEC CICS JOURNAL
 25034*          JFILEID   (PI-JOURNAL-FILE-ID)
 25035*          JTYPEID   ('EL')
 25036*          FROM      (JOURNAL-RECORD)
 25037*          LENGTH    (615)
 25038*          resp      (ws-response)
 25039*       END-EXEC
 25040     MOVE 'EL' TO DFHEIV7
 25041     MOVE 615
 25042       TO DFHEIV11
 25043*    MOVE '4"LF                  (  N#00020974' TO DFHEIV0
 25044     MOVE X'34224C462020202020202020' TO DFHEIV0(1:12)
 25045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25046     MOVE X'204E233030303230393734' TO DFHEIV0(25:11)
 25047     CALL 'kxdfhei1' USING DFHEIV0,
 25048           PI-JOURNAL-FILE-ID,
 25049           DFHEIV7,
 25050           JOURNAL-RECORD,
 25051           DFHEIV11,
 25052           DFHEIV99,
 25053           DFHEIV99,
 25054           DFHEIV99
 25055     MOVE EIBRESP  TO ws-response
 25056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 25057
 25058        if resp-normal
 25059           continue
 25060        else
 25061           display ' error-el6311-journal ' ws-response
 25062        end-if
 25063     end-if
 25064
 25065*    EXEC CICS JOURNAL
 25066*        JFILEID     (PI-JOURNAL-FILE-ID)
 25067*        JTYPEID     ('EL')
 25068*        FROM        (JOURNAL-RECORD)
 25069*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 25070*    END-EXEC.
 25071     .
 25072 8400-exit.
 25073     exit.
 25074 8600-DEEDIT.
 25075
 25076* EXEC CICS BIF DEEDIT
 25077*         FIELD   (DEEDIT-FIELD)
 25078*         LENGTH  (15)
 25079*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 463
* EL6311.cbl
 25080     MOVE 15
 25081       TO DFHEIV11
 25082*    MOVE '@"L                   #   #00020999' TO DFHEIV0
 25083     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 25084     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 25085     MOVE X'2020233030303230393939' TO DFHEIV0(25:11)
 25086     CALL 'kxdfhei1' USING DFHEIV0,
 25087           DEEDIT-FIELD,
 25088           DFHEIV11
 25089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25090
 25091
 25092 8800-UNAUTHORIZED-ACCESS.
 25093     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 25094     GO TO 8300-SEND-TEXT.
 25095
 25096 8810-PF23.
 25097     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 25098     MOVE XCTL-EL005             TO PGM-NAME.
 25099     GO TO 9300-XCTL.
 25100
 25101 9100-RETURN-TRAN.
 25102     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 25103
 25104     IF  PI-MAP-NAME =  EL631B
 25105         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 25106
 25107     IF  PI-MAP-NAME =  EL631C
 25108         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 25109
 25110     IF  PI-MAP-NAME =  EL631D
 25111         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 25112
 25113
 25114* EXEC CICS RETURN
 25115*        TRANSID    (TRANS-EXB1)
 25116*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 25117*        LENGTH     (1300)
 25118*    END-EXEC.
 25119     MOVE 1300
 25120       TO DFHEIV11
 25121*    MOVE '.(CT                  ''   #00021025' TO DFHEIV0
 25122     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 25123     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 25124     MOVE X'2020233030303231303235' TO DFHEIV0(25:11)
 25125     CALL 'kxdfhei1' USING DFHEIV0,
 25126           TRANS-EXB1,
 25127           PROGRAM-INTERFACE-BLOCK,
 25128           DFHEIV11,
 25129           DFHEIV99,
 25130           DFHEIV99,
 25131           DFHEIV99
 25132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25133
 25134
 25135 9200-RETURN-MAIN-MENU.
 25136     MOVE XCTL-EL626             TO PGM-NAME.
 25137     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 464
* EL6311.cbl
 25138
 25139 9300-XCTL.
 25140
 25141* EXEC CICS XCTL
 25142*        PROGRAM    (PGM-NAME)
 25143*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 25144*        LENGTH     (PI-COMM-LENGTH)
 25145*    END-EXEC.
 25146*    MOVE '.$C                   %   #00021036' TO DFHEIV0
 25147     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 25148     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 25149     MOVE X'2020233030303231303336' TO DFHEIV0(25:11)
 25150     CALL 'kxdfhei1' USING DFHEIV0,
 25151           PGM-NAME,
 25152           PROGRAM-INTERFACE-BLOCK,
 25153           PI-COMM-LENGTH,
 25154           DFHEIV99
 25155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25156
 25157
 25158 9400-CLEAR.
 25159     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 25160     GO TO 9300-XCTL.
 25161
 25162 9500-PF12.
 25163     MOVE XCTL-EL010             TO PGM-NAME.
 25164     GO TO 9300-XCTL.
 25165
 25166 9600-PGMID-ERROR.
 25167
 25168* EXEC CICS HANDLE CONDITION
 25169*        PGMIDERR    (8300-SEND-TEXT)
 25170*    END-EXEC.
 25171*    MOVE '"$L                   ! \ #00021051' TO DFHEIV0
 25172     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 25173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 25174     MOVE X'5C20233030303231303531' TO DFHEIV0(25:11)
 25175     CALL 'kxdfhei1' USING DFHEIV0
 25176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25177
 25178
 25179     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 25180     MOVE ' '                    TO PI-ENTRY-CD-1.
 25181     MOVE XCTL-EL005             TO PGM-NAME.
 25182     MOVE PGM-NAME               TO LOGOFF-PGM.
 25183     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 25184     GO TO 9300-XCTL.
 25185
 25186 9700-DATE-LINK.
 25187     MOVE LINK-ELDATCV           TO PGM-NAME.
 25188
 25189* EXEC CICS LINK
 25190*        PROGRAM    (PGM-NAME)
 25191*        COMMAREA   (DATE-CONVERSION-DATA)
 25192*        LENGTH     (DC-COMM-LENGTH)
 25193*    END-EXEC.
 25194*    MOVE '."C                   (   #00021064' TO DFHEIV0
 25195     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 465
* EL6311.cbl
 25196     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25197     MOVE X'2020233030303231303634' TO DFHEIV0(25:11)
 25198     CALL 'kxdfhei1' USING DFHEIV0,
 25199           PGM-NAME,
 25200           DATE-CONVERSION-DATA,
 25201           DC-COMM-LENGTH,
 25202           DFHEIV99,
 25203           DFHEIV99,
 25204           DFHEIV99,
 25205           DFHEIV99
 25206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25207
 25208
 25209 9800-LINK-PENDING-EDIT.
 25210     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 25211     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 25212
 25213     MOVE LINK-EL050             TO PGM-NAME
 25214     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 25215     MOVE ZEROS                  TO WK-CO-MAX-CAP
 25216                                    WK-CO-TOL-CLAIM
 25217                                    WK-CO-TOL-PREM
 25218                                    WK-CO-TOL-REFUND
 25219                                    WK-CO-TOL-PREM-PCT
 25220                                    WK-CO-TOL-REFUND-PCT
 25221                                    WK-REFUND-OVS-AMT
 25222                                    WK-REFUND-OVS-PCT
 25223                                    WK-ACCT-ADDR
 25224                                    WK-LIFE-EDIT-ADDR
 25225                                    WK-AH-EDIT-ADDR
 25226                                    WK-LIFE-BEN-ADDR
 25227                                    WK-AH-BEN-ADDR
 25228                                    WK-STATE-ADDR
 25229                                    WK-PLAN-ADDR
 25230                                    WK-FORM-ADDR
 25231     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 25232
 25233     MOVE '6'                    TO WK-ENTRY-SW.
 25234
 25235     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 25236
 25237     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 25238                                    EC-AM-EXPIRATION-DT
 25239                                    EC-AM-EFFECTIVE-DT
 25240                                    EC-CM-LF-CANCEL-DT
 25241                                    EC-CM-AH-CANCEL-DT
 25242                                    EC-CM-DEATH-DT.
 25243
 25244     MOVE ZEROS                  TO EC-CO-TOL-PREM
 25245                                    EC-CO-TOL-REFUND
 25246                                    EC-CO-MIN-AGE
 25247                                    EC-CO-MIN-PREMIUM
 25248                                    EC-CO-MIN-TERM
 25249                                    EC-CO-MAX-TERM
 25250                                    EC-ST-TOL-PREM
 25251                                    EC-ST-TOL-REFUND
 25252                                    EC-AM-LF-TOL-PREM
 25253                                    EC-AM-AH-TOL-PREM
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 466
* EL6311.cbl
 25254                                    EC-AM-LF-MAX-ATT-AGE
 25255                                    EC-AM-LF-MAX-AGE
 25256                                    EC-AM-LF-MAX-TERM
 25257                                    EC-AM-LF-MAX-TOT-BEN
 25258                                    EC-AM-AH-MAX-ATT-AGE
 25259                                    EC-AM-AH-MAX-AGE
 25260                                    EC-AM-AH-MAX-TERM
 25261                                    EC-AM-AH-MAX-TOT-BEN
 25262                                    EC-AM-AH-MAX-MON-BEN
 25263                                    EC-RT-LF-MAX-ATT-AGE
 25264                                    EC-RT-LF-MAX-AGE
 25265                                    EC-RT-LF-MAX-TERM
 25266                                    EC-RT-LF-MAX-TOT-BEN
 25267                                    EC-RT-AH-MAX-ATT-AGE
 25268                                    EC-RT-AH-MAX-AGE
 25269                                    EC-RT-AH-MAX-TERM
 25270                                    EC-RT-AH-MAX-TOT-BEN
 25271                                    EC-RT-AH-MAX-MON-BEN
 25272                                    EC-RT-AH-RATE
 25273                                    EC-RT-LF-RATE
 25274                                    EC-RT-LF-NSP-RATE
 25275                                    EC-RT-AH-NSP-RATE
 25276                                    EC-CM-LF-PRIOR-REFUND
 25277                                    EC-CM-AH-PRIOR-REFUND.
 25278
 25279     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 25280                                    EC-ST-TOL-PREM-PCT
 25281                                    EC-AM-LF-TOL-REFUND
 25282                                    EC-AM-LF-DEV-PERCENT
 25283                                    EC-CO-TOL-REFUND-PCT
 25284                                    EC-ST-TOL-REFUND-PCT
 25285                                    EC-AM-AH-TOL-REFUND
 25286                                    EC-AM-AH-DEV-PERCENT.
 25287
 25288
 25289* EXEC CICS LINK
 25290*         PROGRAM   (PGM-NAME)
 25291*         COMMAREA  (PASSED-RECORD)
 25292*         LENGTH    (WS-EDIT-PASS-LENGTH)
 25293*    END-EXEC.
 25294*    MOVE '."C                   (   #00021149' TO DFHEIV0
 25295     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25297     MOVE X'2020233030303231313439' TO DFHEIV0(25:11)
 25298     CALL 'kxdfhei1' USING DFHEIV0,
 25299           PGM-NAME,
 25300           PASSED-RECORD,
 25301           WS-EDIT-PASS-LENGTH,
 25302           DFHEIV99,
 25303           DFHEIV99,
 25304           DFHEIV99,
 25305           DFHEIV99
 25306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25307
 25308
 25309     MOVE '1'                    TO PI-EDIT-SW.
 25310     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 25311
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 467
* EL6311.cbl
 25312     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 25313
 25314     IF PI-COMPANY-ID = 'UCL'
 25315         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 25316
 25317     IF VALID-PB-ID
 25318        GO TO 9800-EXIT.
 25319
 25320     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 25321
 25322     IF PI-MAP-NAME = EL631B
 25323        MOVE -1                  TO BMAINTL
 25324       ELSE
 25325        MOVE -1                  TO CMAINTL.
 25326
 25327     GO TO 8200-SEND-DATAONLY.
 25328
 25329 9800-EXIT.
 25330      EXIT.
 25331
 25332 9900-ERROR-FORMAT.
 25333
 25334     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 25335
 25336     IF NOT EMI-ERRORS-COMPLETE
 25337         MOVE LINK-EL001         TO PGM-NAME
 25338
 25339* EXEC CICS LINK
 25340*            PROGRAM    (PGM-NAME)
 25341*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 25342*            LENGTH     (EMI-COMM-LENGTH)
 25343*        END-EXEC.
 25344*    MOVE '."C                   (   #00021184' TO DFHEIV0
 25345     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25347     MOVE X'2020233030303231313834' TO DFHEIV0(25:11)
 25348     CALL 'kxdfhei1' USING DFHEIV0,
 25349           PGM-NAME,
 25350           ERROR-MESSAGE-INTERFACE-BLOCK,
 25351           EMI-COMM-LENGTH,
 25352           DFHEIV99,
 25353           DFHEIV99,
 25354           DFHEIV99,
 25355           DFHEIV99
 25356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25357
 25358
 25359 9900-EXIT.
 25360     EXIT.
 25361
 25362 9990-ABEND.
 25363     MOVE LINK-EL004             TO PGM-NAME.
 25364     MOVE DFHEIBLK               TO EMI-LINE1.
 25365
 25366* EXEC CICS LINK
 25367*        PROGRAM   (PGM-NAME)
 25368*        COMMAREA  (EMI-LINE1)
 25369*        LENGTH    (72)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 468
* EL6311.cbl
 25370*    END-EXEC.
 25371     MOVE 72
 25372       TO DFHEIV11
 25373*    MOVE '."C                   (   #00021196' TO DFHEIV0
 25374     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25376     MOVE X'2020233030303231313936' TO DFHEIV0(25:11)
 25377     CALL 'kxdfhei1' USING DFHEIV0,
 25378           PGM-NAME,
 25379           EMI-LINE1,
 25380           DFHEIV11,
 25381           DFHEIV99,
 25382           DFHEIV99,
 25383           DFHEIV99,
 25384           DFHEIV99
 25385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25386
 25387
 25388     IF PI-MAP-NAME = EL631B
 25389        MOVE -1                  TO BMAINTL
 25390       ELSE
 25391        MOVE -1                  TO CMAINTL.
 25392
 25393     IF EIBTRNID NOT = TRANS-EXB1
 25394        GO TO 8100-SEND-INITIAL-MAP
 25395       ELSE
 25396        GO TO 8200-SEND-DATAONLY.
 25397
 25398 9995-SECURITY-VIOLATION.
 25399*                            COPY ELCSCTP.
 25400******************************************************************
 25401*                                                                *
 25402*                            ELCSCTP                             *
 25403*                            VMOD=2.001                          *
 25404*                                                                *
 25405*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 25406******************************************************************
 25407
 25408
 25409     MOVE EIBDATE          TO SM-JUL-DATE.
 25410     MOVE EIBTRMID         TO SM-TERMID.
 25411     MOVE THIS-PGM         TO SM-PGM.
 25412     MOVE EIBTIME          TO TIME-IN.
 25413     MOVE TIME-OUT         TO SM-TIME.
 25414     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 25415
 25416
 25417* EXEC CICS LINK
 25418*         PROGRAM  ('EL003')
 25419*         COMMAREA (SECURITY-MESSAGE)
 25420*         LENGTH   (80)
 25421*    END-EXEC.
 25422     MOVE 'EL003' TO DFHEIV1
 25423     MOVE 80
 25424       TO DFHEIV11
 25425*    MOVE '."C                   (   #00021230' TO DFHEIV0
 25426     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 469
* EL6311.cbl
 25428     MOVE X'2020233030303231323330' TO DFHEIV0(25:11)
 25429     CALL 'kxdfhei1' USING DFHEIV0,
 25430           DFHEIV1,
 25431           SECURITY-MESSAGE,
 25432           DFHEIV11,
 25433           DFHEIV99,
 25434           DFHEIV99,
 25435           DFHEIV99,
 25436           DFHEIV99
 25437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25438
 25439
 25440******************************************************************
 25441
 25442
 25443 9999-DFHBACK SECTION.
 25444     MOVE '9%                    "   ' TO DFHEIV0
 25445     MOVE 'EL6311' TO DFHEIV1
 25446     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25447     GOBACK.
 25448 9999-DFHEXIT.
 25449     IF DFHEIGDJ EQUAL 0001
 25450         NEXT SENTENCE
 25451     ELSE IF DFHEIGDJ EQUAL 2
 25452         GO TO 9600-PGMID-ERROR,
 25453               9990-ABEND,
 25454               9990-ABEND,
 25455               0010-MAIN-LOGIC
 25456         DEPENDING ON DFHEIGDI
 25457     ELSE IF DFHEIGDJ EQUAL 3
 25458         GO TO 1280-BATCH-HDR-NOT-FOUND
 25459         DEPENDING ON DFHEIGDI
 25460     ELSE IF DFHEIGDJ EQUAL 4
 25461         GO TO 1290-DUPLICATE-ALT-INDEX
 25462         DEPENDING ON DFHEIGDI
 25463     ELSE IF DFHEIGDJ EQUAL 5
 25464         GO TO 1295-CERT-TRL-REC-NOTFND
 25465         DEPENDING ON DFHEIGDI
 25466     ELSE IF DFHEIGDJ EQUAL 6
 25467         GO TO 1380-BATCH-HDR-NOT-FOUND
 25468         DEPENDING ON DFHEIGDI
 25469     ELSE IF DFHEIGDJ EQUAL 7
 25470         GO TO 1385-REC-NOT-FOUND
 25471         DEPENDING ON DFHEIGDI
 25472     ELSE IF DFHEIGDJ EQUAL 8
 25473         GO TO 1386-NOTFND
 25474         DEPENDING ON DFHEIGDI
 25475     ELSE IF DFHEIGDJ EQUAL 9
 25476         GO TO 1399-EXIT
 25477         DEPENDING ON DFHEIGDI
 25478     ELSE IF DFHEIGDJ EQUAL 10
 25479         GO TO 1480-BATCH-HDR-NOT-FOUND
 25480         DEPENDING ON DFHEIGDI
 25481     ELSE IF DFHEIGDJ EQUAL 11
 25482         GO TO 1490-RECORD-NOT-FOUND
 25483         DEPENDING ON DFHEIGDI
 25484     ELSE IF DFHEIGDJ EQUAL 12
 25485         GO TO 1405-DELETE-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 470
* EL6311.cbl
 25486         DEPENDING ON DFHEIGDI
 25487     ELSE IF DFHEIGDJ EQUAL 13
 25488         GO TO 1420-CONTINUE-DELETE
 25489         DEPENDING ON DFHEIGDI
 25490     ELSE IF DFHEIGDJ EQUAL 14
 25491         GO TO 1406-DELETE-ERNOTE
 25492         DEPENDING ON DFHEIGDI
 25493     ELSE IF DFHEIGDJ EQUAL 15
 25494         GO TO 1407-DELETE-MAILING
 25495         DEPENDING ON DFHEIGDI
 25496     ELSE IF DFHEIGDJ EQUAL 16
 25497         GO TO 1420-CONTINUE-DELETE
 25498         DEPENDING ON DFHEIGDI
 25499     ELSE IF DFHEIGDJ EQUAL 17
 25500         GO TO 1480-BATCH-HDR-NOT-FOUND
 25501         DEPENDING ON DFHEIGDI
 25502     ELSE IF DFHEIGDJ EQUAL 18
 25503         GO TO 1475-DELETE-FINISHED
 25504         DEPENDING ON DFHEIGDI
 25505     ELSE IF DFHEIGDJ EQUAL 19
 25506         GO TO 2280-BATCH-HDR-NOT-FOUND
 25507         DEPENDING ON DFHEIGDI
 25508     ELSE IF DFHEIGDJ EQUAL 20
 25509         GO TO 2290-DUPLICATE-ALT-INDEX
 25510         DEPENDING ON DFHEIGDI
 25511     ELSE IF DFHEIGDJ EQUAL 21
 25512         GO TO 2380-BATCH-HDR-NOT-FOUND
 25513         DEPENDING ON DFHEIGDI
 25514     ELSE IF DFHEIGDJ EQUAL 22
 25515         GO TO 2385-REC-NOT-FOUND
 25516         DEPENDING ON DFHEIGDI
 25517     ELSE IF DFHEIGDJ EQUAL 23
 25518         GO TO 2380-BATCH-HDR-NOT-FOUND
 25519         DEPENDING ON DFHEIGDI
 25520     ELSE IF DFHEIGDJ EQUAL 24
 25521         GO TO 2485-BATCH-HDR-NOT-FOUND
 25522         DEPENDING ON DFHEIGDI
 25523     ELSE IF DFHEIGDJ EQUAL 25
 25524         GO TO 2490-RECORD-NOT-FOUND
 25525         DEPENDING ON DFHEIGDI
 25526     ELSE IF DFHEIGDJ EQUAL 26
 25527         GO TO 2475-CONTINUE-DELETE
 25528         DEPENDING ON DFHEIGDI
 25529     ELSE IF DFHEIGDJ EQUAL 27
 25530         GO TO 2485-BATCH-HDR-NOT-FOUND
 25531         DEPENDING ON DFHEIGDI
 25532     ELSE IF DFHEIGDJ EQUAL 28
 25533         GO TO 2480-DELETE-FINISHED
 25534         DEPENDING ON DFHEIGDI
 25535     ELSE IF DFHEIGDJ EQUAL 29
 25536         GO TO 2820-PROCESS-REWRITE
 25537         DEPENDING ON DFHEIGDI
 25538     ELSE IF DFHEIGDJ EQUAL 30
 25539         GO TO 2885-RECORD-MISSING
 25540         DEPENDING ON DFHEIGDI
 25541     ELSE IF DFHEIGDJ EQUAL 31
 25542         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25543         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 471
* EL6311.cbl
 25544     ELSE IF DFHEIGDJ EQUAL 32
 25545         GO TO 2827-DELETE-MAILING
 25546         DEPENDING ON DFHEIGDI
 25547     ELSE IF DFHEIGDJ EQUAL 33
 25548         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25549         DEPENDING ON DFHEIGDI
 25550     ELSE IF DFHEIGDJ EQUAL 34
 25551         GO TO 2920-PROCESS-REWRITE
 25552         DEPENDING ON DFHEIGDI
 25553     ELSE IF DFHEIGDJ EQUAL 35
 25554         GO TO 2985-RECORD-MISSING
 25555         DEPENDING ON DFHEIGDI
 25556     ELSE IF DFHEIGDJ EQUAL 36
 25557         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25558         DEPENDING ON DFHEIGDI
 25559     ELSE IF DFHEIGDJ EQUAL 37
 25560         GO TO 2990-DUPLICATE-RECORD
 25561         DEPENDING ON DFHEIGDI
 25562     ELSE IF DFHEIGDJ EQUAL 38
 25563         GO TO 3590-NOT-FOUND
 25564         DEPENDING ON DFHEIGDI
 25565     ELSE IF DFHEIGDJ EQUAL 39
 25566         GO TO 3690-NOT-FOUND
 25567         DEPENDING ON DFHEIGDI
 25568     ELSE IF DFHEIGDJ EQUAL 40
 25569         GO TO 3990-NOT-FOUND
 25570         DEPENDING ON DFHEIGDI
 25571     ELSE IF DFHEIGDJ EQUAL 41
 25572         GO TO 4050-END-RECORDS,
 25573               4050-END-RECORDS
 25574         DEPENDING ON DFHEIGDI
 25575     ELSE IF DFHEIGDJ EQUAL 42
 25576         GO TO 4150-END-BATCH
 25577         DEPENDING ON DFHEIGDI
 25578     ELSE IF DFHEIGDJ EQUAL 43
 25579         GO TO 4150-END-BATCH
 25580         DEPENDING ON DFHEIGDI
 25581     ELSE IF DFHEIGDJ EQUAL 44
 25582         GO TO 4250-END-RECORDS,
 25583               4250-END-RECORDS
 25584         DEPENDING ON DFHEIGDI
 25585     ELSE IF DFHEIGDJ EQUAL 45
 25586         GO TO 4350-END-BATCH,
 25587               4350-END-BATCH
 25588         DEPENDING ON DFHEIGDI
 25589     ELSE IF DFHEIGDJ EQUAL 46
 25590         GO TO 4570-NOT-FOUND,
 25591               4550-END-RECORDS
 25592         DEPENDING ON DFHEIGDI
 25593     ELSE IF DFHEIGDJ EQUAL 47
 25594         GO TO 4680-NOT-FOUND,
 25595               4680-NOT-FOUND
 25596         DEPENDING ON DFHEIGDI
 25597     ELSE IF DFHEIGDJ EQUAL 48
 25598         GO TO 4860-NOT-FOUND,
 25599               4850-END-RECORDS
 25600         DEPENDING ON DFHEIGDI
 25601     ELSE IF DFHEIGDJ EQUAL 49
* Micro Focus Server Express         V5.1 revision 000 05-May-20 10:54 Page 472
* EL6311.cbl
 25602         GO TO 4970-NOT-FOUND,
 25603               4950-END-RECORDS
 25604         DEPENDING ON DFHEIGDI
 25605     ELSE IF DFHEIGDJ EQUAL 50
 25606         GO TO 5050-NOT-FOUND
 25607         DEPENDING ON DFHEIGDI
 25608     ELSE IF DFHEIGDJ EQUAL 51
 25609         GO TO 5050-NOT-FOUND
 25610         DEPENDING ON DFHEIGDI
 25611     ELSE IF DFHEIGDJ EQUAL 52
 25612         GO TO 5050-NOT-FOUND
 25613         DEPENDING ON DFHEIGDI
 25614     ELSE IF DFHEIGDJ EQUAL 53
 25615         GO TO 5550-END-RECORDS,
 25616               5550-END-RECORDS
 25617         DEPENDING ON DFHEIGDI
 25618     ELSE IF DFHEIGDJ EQUAL 54
 25619         GO TO 6050-QID-ERROR
 25620         DEPENDING ON DFHEIGDI
 25621     ELSE IF DFHEIGDJ EQUAL 55
 25622         GO TO 6050-QID-ERROR
 25623         DEPENDING ON DFHEIGDI
 25624     ELSE IF DFHEIGDJ EQUAL 56
 25625         GO TO 6400-CONTINUE,
 25626               6400-CONTINUE
 25627         DEPENDING ON DFHEIGDI
 25628     ELSE IF DFHEIGDJ EQUAL 57
 25629         GO TO 3690-NOT-FOUND
 25630         DEPENDING ON DFHEIGDI
 25631     ELSE IF DFHEIGDJ EQUAL 58
 25632         GO TO 7399-EXIT
 25633         DEPENDING ON DFHEIGDI
 25634     ELSE IF DFHEIGDJ EQUAL 59
 25635         GO TO 7550-OFFICER-NOTFND
 25636         DEPENDING ON DFHEIGDI
 25637     ELSE IF DFHEIGDJ EQUAL 60
 25638         GO TO 8300-SEND-TEXT
 25639         DEPENDING ON DFHEIGDI.
 25640     MOVE '9%                    "   ' TO DFHEIV0
 25641     MOVE 'EL6311' TO DFHEIV1
 25642     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25643     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16372     Code:      101698
