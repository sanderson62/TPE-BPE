* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75******************************************************************
    76
    77 ENVIRONMENT DIVISION.
    78
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page   4
* EL6311.cbl
    80 DATA DIVISION.
    81 WORKING-STORAGE SECTION.
    82 01  DFH-START PIC X(04).
    83 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    84 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    85 77  FILLER  PIC X(32)  VALUE '********************************'.
    86 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    87 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    88 77  A1                          PIC S999 COMP-3 VALUE +0.
    89 77  N1                          PIC S999 COMP-3 VALUE +0.
    90 77  N2                          PIC S999 COMP-3 VALUE +0.
    91 77  N3                          PIC S999 COMP-3 VALUE +0.
    92 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    93 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    94 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    95     88  REVERSAL                    VALUE 'Y'.
    96 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    97 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    98 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    99 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   100 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   101     88  ERMAIL-FOUND                 VALUE 'Y'.
   102 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   103 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   104 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   105 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   106     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   107 77  ws-stop-sw                  pic x value ' '.
   108     88  i-say-stop                 value 'Y'.
   109 77  ws-check-sw                 pic x value ' '.
   110     88  i-have-checks              value 'Y'.
   111 77  ws-proc-check-sw            pic x value ' '.
   112     88  i-have-processed-checks    value 'Y'.
   113 77  ws-chek-browse-sw           pic x value ' '.
   114 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   115 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   116 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   117 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   118
   119*    COPY ELCSCTM.
   120******************************************************************
   121*                                                                *
   122*                                                                *
   123*                            ELCSCTM                             *
   124*                            VMOD=2.001                          *
   125*                                                                *
   126*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   127*                                                                *
   128******************************************************************
   129 01  SECURITY-MESSAGE.
   130     12  FILLER                          PIC X(30)
   131            VALUE '** LOGIC SECURITY VIOLATION -'.
   132     12  SM-READ                         PIC X(6).
   133     12  FILLER                          PIC X(5)
   134            VALUE ' PGM='.
   135     12  SM-PGM                          PIC X(6).
   136     12  FILLER                          PIC X(5)
   137            VALUE ' OPR='.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page   5
* EL6311.cbl
   138     12  SM-PROCESSOR-ID                 PIC X(4).
   139     12  FILLER                          PIC X(6)
   140            VALUE ' TERM='.
   141     12  SM-TERMID                       PIC X(4).
   142     12  FILLER                          PIC XX   VALUE SPACE.
   143     12  SM-JUL-DATE                     PIC 9(5).
   144     12  FILLER                          PIC X    VALUE SPACE.
   145     12  SM-TIME                         PIC 99.99.
   146
   147
   148*    COPY ELCSCRTY.
   149******************************************************************
   150*                                                                *
   151*                                                                *
   152*                            ELCSCRTY                            *
   153*                            VMOD=2.001                          *
   154*                                                                *
   155*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   156*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   157*        SAVED IN PI-SECURITY-ADDRESS.                           *
   158*                                                                *
   159******************************************************************
   160 01  SECURITY-CONTROL.
   161     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   162     12  FILLER                       PIC XX    VALUE 'SC'.
   163     12  SC-CREDIT-CODES.
   164         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   165             20  SC-CREDIT-DISPLAY    PIC X.
   166             20  SC-CREDIT-UPDATE     PIC X.
   167     12  SC-CLAIMS-CODES.
   168         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   169             20  SC-CLAIMS-DISPLAY    PIC X.
   170             20  SC-CLAIMS-UPDATE     PIC X.
   171
   172 01  WS-VA-NO-COMM-MESS.
   173     12  FILLER                  PIC X(41) VALUE
   174        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   175 01  WS-OC-MESSAGE.
   176     12  FILLER                  PIC X(43) VALUE
   177        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   178     12  WS-OC-DIS-AMT           PIC -----9.99.
   179     12  FILLER                  PIC X(4) VALUE ' ON '.
   180     12  WS-OC-DATE              PIC X(10).
   181 01  WS-DATE-AREA.
   182     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   183     12  WS-CURRENT-DT.
   184         16  FILLER              PIC X(6)    VALUE SPACES.
   185         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   186     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   187     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   188     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   189
   190 01  STANDARD-AREAS.
   191     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   192     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   193     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   194     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   195     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page   6
* EL6311.cbl
   196     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   197     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   198     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   199     12  PGM-NAME                PIC X(8).
   200     12  TIME-IN                 PIC S9(7).
   201     12  TIME-OUT-R  REDEFINES TIME-IN.
   202         16  FILLER              PIC X.
   203         16  TIME-OUT            PIC 99V99.
   204         16  FILLER              PIC XX.
   205     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   206     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   207     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   208     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   209     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   210     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   211     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   212     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   213     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   214     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   215     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   216     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   217     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   218     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   219     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   220     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   221     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   222     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   223     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   224     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   225     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   226     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   227     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   228     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   229     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   230     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   231     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   232     12  FILE-ID                 PIC X(8).
   233     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   234     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   235     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   236     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   237     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   238     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   239     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   240     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   241     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   242     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   243     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   244     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   245     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   246     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   247     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   248
   249 01  WS-PASS-AREA.
   250     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   251     05  WS-PASS-VADS-REC    PIC X(350).
   252*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   253*                                COPY ELCZREC.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page   7
* EL6311.cbl
   254******************************************************************
   255*                                                                *
   256*                                                                *
   257*                            ELCZREC.                            *
   258*                                                                *
   259*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   260*                                                                *
   261******************************************************************
   262*-----------------------------------------------------------------
   263*                   C H A N G E   L O G
   264*
   265* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   266*-----------------------------------------------------------------
   267*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   268* EFFECTIVE    NUMBER
   269*-----------------------------------------------------------------
   270* 122011    2011022800001  AJRA  NEW FILE
   271* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   272* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   273* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   274* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   275*-----------------------------------------------------------------
   276 01  W-Z-CONTROL-DATA.
   277     05  W-NUMBER-OF-COPIES      PIC  9.
   278     05  FILLER                  PIC  X.
   279     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   280     05  FILLER                  PIC  X.
   281     05  W-DAYS-TO-RESEND        PIC  999.
   282     05  FILLER                  PIC  X.
   283     05  W-FORM-TO-RESEND        PIC  X(4).
   284     05  W-ADD-BAR-CODE          PIC  X.
   285     05  W-PROMPT-LETTER         PIC  X.
   286     05  W-HAS-RETURN-ENV        PIC  X.
   287     05  W-ENCLOSURE-CD          PIC  XXX.
   288     05  W-SIG-FLAG-DEFAULT      PIC  X.
   289     05  W-AUTO-CLOSE-IND        PIC  X.
   290     05  FILLER                  PIC  X.
   291     05  W-LETTER-TO-BENE        PIC  X.
   292     05  FILLER                  PIC  X.
   293     05  W-LETTER-TO-ACCT        PIC  X.
   294     05  FILLER                  PIC  X.
   295     05  W-LETTER-TYPE           PIC  X.
   296     05  FILLER                  PIC  X.
   297     05  W-PRINT-CERTIFICATE     PIC  X.
   298     05  FILLER                  PIC  X.
   299     05  W-REFUND-REQUIRED       PIC  X.
   300     05  FILLER                  PIC  X.
   301     05  W-ONBASE-CODE           PIC  XX.
   302     05  FILLER                  PIC  X.
   303     05  W-ACCT-SUMM             PIC  X.
   304     05  FILLER                  PIC  X.
   305     05  W-CSO-SUMM              PIC  X.
   306     05  FILLER                  PIC  X.
   307     05  W-REASONS-REQUIRED      PIC  X.
   308     05  FILLER                  PIC  X(29).
   309******************************************************************
   310*                                                                *
   311*              A C C E S S   K E Y S                             *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page   8
* EL6311.cbl
   312*                                                                *
   313******************************************************************
   314
   315 01  ACCESS-KEYS.
   316     12  ERPYAJ-KEY.
   317         16  ERPYAJ-COMPANY-CD       PIC X.
   318         16  ERPYAJ-CARRIER          PIC X.
   319         16  ERPYAJ-GROUPING         PIC X(6).
   320         16  ERPYAJ-FIN-RESP         PIC X(10).
   321         16  ERPYAJ-ACCOUNT          PIC X(10).
   322         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   323         16  ERPYAJ-TYPE             PIC X.
   324     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   325     12  ELCERT-KEY.
   326         16  ELCERT-COMPANY-CD       PIC X.
   327         16  ELCERT-CARRIER          PIC X.
   328         16  ELCERT-GROUPING         PIC X(6).
   329         16  ELCERT-STATE            PIC XX.
   330         16  ELCERT-ACCOUNT          PIC X(10).
   331         16  ELCERT-CERT-EFF-DT      PIC XX.
   332         16  ELCERT-CERT-NO.
   333             20  ELCERT-CERT-PRIME   PIC X(10).
   334             20  ELCERT-CERT-SFX     PIC X.
   335
   336     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   337     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   338     12  ELCRTO-KEY.
   339         16  ELCRTO-COMPANY-CD       PIC X.
   340         16  ELCRTO-CARRIER          PIC X.
   341         16  ELCRTO-GROUPING         PIC X(6).
   342         16  ELCRTO-STATE            PIC XX.
   343         16  ELCRTO-ACCOUNT          PIC X(10).
   344         16  ELCRTO-CERT-EFF-DT      PIC XX.
   345         16  ELCRTO-CERT-NO.
   346             20  ELCRTO-CERT-PRIME   PIC X(10).
   347             20  ELCRTO-CERT-SFX     PIC X.
   348         16  ELCRTO-RECORD-TYPE      PIC X.
   349         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   350
   351     12  ELCRTT-KEY.
   352         16  ELCRTT-PRIMARY          PIC X(33).
   353         16  ELCRTT-REC-TYPE         PIC X(1).
   354     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   355     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   356
   357     12  ERPNDB-KEY.
   358         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   359         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   360         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   361         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   362             ERPNDB-BATCH-SEQ-NO     PIC XX.
   363         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   364
   365     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   366     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   367     12  ERCHEK-KEY.
   368         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   369         16  CHEK-CARRIER            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page   9
* EL6311.cbl
   370         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   371         16  CHEK-STATE              PIC XX      VALUE SPACES.
   372         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   373         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   374         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   375         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   376         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   377     12  ELLETR-KEY.
   378         16  LETR-COMPANY-CD     PIC X.
   379         16  LETR-LETTER-ID      PIC X(4).
   380         16  LETR-FILLER         PIC X(8).
   381         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   382     12  ERPNDM-KEY.
   383         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   384         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   385         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   386         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   387
   388*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   389     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   390*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   391     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   392
   393     12  ERPNDB-ALT-KEY.
   394         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   395         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   396         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   397         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   398         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   399         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   400         16  ERPNDB-CERT-NO.
   401             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   402             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   403         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   404         16  ERPNDB-RECORD-TYPE      PIC X.
   405
   406      12  ERPNDB-CSR-KEY.
   407          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   408          20  ERPNDB-CSR-ID                PIC X(4).
   409          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   410          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   411          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   412
   413     12  ERNOTE-KEY.
   414         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   415         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   416         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   417         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   418         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   419         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   420         16  ERNOTE-CERT-NO.
   421             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   422             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   423
   424     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   425     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   426
   427     12  ERCNOT-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  10
* EL6311.cbl
   428         16  ERCNOT-PART-KEY.
   429             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   430             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   431             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   432             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   433             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   434             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   435             20  ERCNOT-CERT-NO.
   436                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   437                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   438         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   439         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   440
   441     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   442     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   443
   444     12  ERMAIL-KEY.
   445         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   446         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   447         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   448         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   449         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   450         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   451         16  ERMAIL-CERT-NO.
   452             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   453             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   454
   455     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   456     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   457
   458     12  ERRQST-KEY.
   459         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   460         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   461
   462     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   463     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   464
   465     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   466
   467     12  ERLOFC-KEY.
   468         16  ERLOFC-COMPANY-CD          PIC  X.
   469         16  ERLOFC-CARRIER             PIC  X.
   470         16  ERLOFC-GROUPING            PIC  X(6).
   471         16  ERLOFC-STATE               PIC  XX.
   472         16  ERLOFC-ACCOUNT             PIC  X(10).
   473         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   474*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   475
   476     12  ERACCT-KEY.
   477         16  ERACCT-COMPANY-CD          PIC  X.
   478         16  ERACCT-CARRIER             PIC  X.
   479         16  ERACCT-GROUPING            PIC  X(6).
   480         16  ERACCT-STATE               PIC  XX.
   481         16  ERACCT-ACCOUNT             PIC  X(10).
   482         16  ERACCT-EXP-DT.
   483             20  ERACCT-DT              PIC  XX.
   484             20  ERACCT-FILL            PIC  X(4).
   485
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  11
* EL6311.cbl
   486     12  ERENDT-KEY.
   487         16  ENDT-COMPANY-CD       PIC X.
   488         16  ENDT-CARRIER          PIC X.
   489         16  ENDT-GROUPING         PIC X(6).
   490         16  ENDT-STATE            PIC XX.
   491         16  ENDT-ACCOUNT          PIC X(10).
   492         16  ENDT-CERT-EFF-DT      PIC XX.
   493         16  ENDT-CERT-PRIME       PIC X(10).
   494         16  ENDT-CERT-SFX         PIC X.
   495         16  ENDT-RECORD-TYPE      PIC X.
   496         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   497
   498 01  WS-ELMSTR-WORK.
   499     12  ELMSTR-KEY.
   500         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   501         16  MSTR-CERT-NO.
   502             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   503             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   504     12  W-CLAIM-KEY.
   505         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   506         16  W-CL-CERT-NO.
   507             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   508             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   509      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   510 01  CANCEL-GEN-PASS-AREA.
   511     05  CG-OPTION-CODE          PIC X.
   512         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   513         88  CG-FLAT-CANCEL        VALUE '1'.
   514         88  CG-CANCEL             VALUE '2'.
   515         88  CG-CANCEL-REISSUE     VALUE '3'.
   516     05  CG-ERROR-CODE           PIC 99.
   517         88  CG-SUCCESS            VALUE 00.
   518         88  CG-DATE-ERROR         VALUE 01.
   519         88  CG-CERT-NOT-FOUND     VALUE 02.
   520         88  CG-AMOUNT-ERROR       VALUE 04.
   521         88  CG-OPTION-ERROR       VALUE 05.
   522         88  CG-PREV-CAN           VALUE 06.
   523         88  CG-INVALID-DATA       VALUE 07.
   524         88  CG-NO-ACCT-MSTR       VALUE 08.
   525         88  CG-SFX-A-EXIST        VALUE 09.
   526         88  CG-MISC-ERROR         VALUE 99.
   527     05  CG-COMPANY-ID           PIC XXX.
   528     05  CG-PROC-ID              PIC XXXX.
   529     05  CG-CURRENT-DT           PIC XX.
   530     05  CG-MONTH-END-DT         PIC XX.
   531     05  CG-CERT-KEY.
   532         10  CG-CERT-COMPANY-CD  PIC X.
   533         10  CG-CERT-CARRIER     PIC X.
   534         10  CG-CERT-GROUP       PIC X(6).
   535         10  CG-CERT-STATE       PIC XX.
   536         10  CG-CERT-ACCOUNT     PIC X(10).
   537         10  CG-CERT-EFF-DT      PIC XX.
   538         10  CG-CERT-CERT-NO     PIC X(11).
   539     05  CG-LF-CAN-DATA.
   540         10  CG-LF-CAN-DT        PIC XX.
   541         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   542     05  CG-AH-CAN-DATA.
   543         10  CG-AH-CAN-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  12
* EL6311.cbl
   544         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   545     05  CG-CERT-PROFILE-DATA.
   546         10  CG-INS-LNAME        PIC X(15).
   547         10  CG-INS-FNAME        PIC X(10).
   548         10  CG-INS-MID-INIT     PIC X.
   549         10  CG-INS-AGE          PIC 99.
   550         10  CG-JNT-LNAME        PIC X(15).
   551         10  CG-JNT-FNAME        PIC X(10).
   552         10  CG-JNT-MID-INIT     PIC X.
   553         10  CG-JNT-AGE          PIC 99.
   554     05  CG-LF-ISS-DATA.
   555         10  CG-LF-BENCD         PIC XX.
   556         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   557         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   558     05  CG-AH-ISS-DATA.
   559         10  CG-AH-BENCD         PIC XX.
   560         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   561     05  CG-BATCH-NO             PIC X(6).
   562     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   563     05  FILLER                  PIC X(306).
   564******************************************************************
   565*                                                                *
   566*            G E N E R A L   W O R K   A R E A                   *
   567*                                                                *
   568******************************************************************
   569
   570 01  WORK-AREA.
   571     12  WS-RESPONSE             PIC S9(8)   COMP.
   572         88  RESP-NORMAL           VALUE +0.
   573         88  resp-file-notfnd      value +12.
   574         88  RESP-NOTFND           VALUE +13.
   575         88  resp-duprec           value +14.
   576         88  resp-dupkey           value +15.
   577         88  resp-invreq           value +16.
   578         88  RESP-NOTOPEN          VALUE +19.
   579         88  RESP-ENDFILE          VALUE +20.
   580         88  resp-lengtherr        value +22.
   581     12  DEEDIT-FIELD            PIC X(15).
   582     12  FILLER          REDEFINES DEEDIT-FIELD.
   583         16  FILLER              PIC X(4).
   584         16  DEEDIT-FIELD-X11    PIC X(11).
   585     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   586                                 PIC S9(15).
   587     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   588                                 PIC S9(13)V99.
   589     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   590                                 PIC S9(11)V9999.
   591     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   592     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   593     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   594         16  WS-CALC-TERM-WHOLE  PIC S999.
   595         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   596
   597     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   598     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   599         16  WS-HR-MINS          PIC 99V99.
   600         16  FILLER              PIC XX.
   601
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  13
* EL6311.cbl
   602     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   603     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   604
   605     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   606     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   607
   608     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   609     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   610     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   611     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   612     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   613     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   614     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   615
   616     12  QID.
   617         16  QID-TERM            PIC X(4).
   618         16  FILLER              PIC X(4)    VALUE '607B'.
   619
   620     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   621         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   622
   623     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   624         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   625
   626     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   627         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   628                                         'A'.
   629
   630     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   631
   632     12  WS-NUMERIC-SW           PIC X.
   633        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   634
   635     12  WS-EDIT-CSO-FIELD.
   636         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   637                                 PIC X.
   638
   639     12  WS-SAVE-INPUT-FIELDS.
   640         16  WS-BAGE             PIC 99       VALUE ZERO.
   641*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   642         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   643         16  FILLER REDEFINES WS-BAPR.
   644             20  WS-APR-WHOLE-NUM    PIC 99.
   645             20  WS-APR-DEC          PIC 9999.
   646         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   647         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   648
   649         16  WS-B-COVERAGE OCCURS 2 TIMES.
   650             20  WS-TERM-IN-DAYS-SW  PIC X.
   651                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   652             20  WS-BTERM        PIC 999       COMP-3.
   653             20  WS-BALT-TERM    PIC 999       COMP-3.
   654             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   655             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   656             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   657             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   658             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   659             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  14
* EL6311.cbl
   660
   661         16  WS-C-FIELDS COMP-3.
   662             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   663             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   664             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   665
   666         16  WS-D-FIELDS COMP-3.
   667             20  WS-DRISS        PIC S9(5)    VALUE +0.
   668             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   669             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   670             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   671             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   672             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   673
   674     12  WS-SAVE-BIRTH-DATE.
   675         16  FILLER              PIC X(4)   VALUE SPACES.
   676         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   677
   678     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   679     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   680     12  FILLER REDEFINES WS-WORK-BIN-RED.
   681         16  FILLER              PIC X(02).
   682         16  WS-WORK-BIN-DT      PIC X(02).
   683     12  WS-SW-1                 PIC X     VALUE SPACE.
   684     12  WS-SW-2                 PIC X     VALUE SPACE.
   685     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   686         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   687     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   688         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   689
   690     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   691     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   692     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   693     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   694     12  WS-CONVERTED-CANCEL-DATES.
   695         16  WS-CONVERTED-CANDT1                  PIC XX.
   696         16  WS-CONVERTED-CANDT2                  PIC XX.
   697
   698     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   699
   700     12  WS-REC-FOUND-SW         PIC X.
   701         88  RECORD-NOT-FOUND    VALUE 'N'.
   702
   703     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   704         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   705         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   706
   707     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   708         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   709         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   710
   711     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   712         88  BROWSE-STARTED      VALUE 'Y'.
   713
   714     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   715         88  FIRST-TIME          VALUE 'Y'.
   716
   717     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  15
* EL6311.cbl
   718         88  FIRST-ENTRY         VALUE 'Y'.
   719
   720     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   721         88  REC-BILLED          VALUE 'Y'.
   722
   723     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   724         88  NO-CURSOR-SET       VALUE +0.
   725         88  CURSOR-SET          VALUE +1.
   726
   727     12  WS-ERR-SW               PIC X.
   728         88  STD-ERRORS          VALUE 'S'.
   729         88  TRN-ERRORS          VALUE 'T'.
   730
   731     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   732         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   733
   734     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   735         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   736
   737     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   738         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   739
   740     12  WS-ERR-CODE.
   741         16  FILLER              PIC 99.
   742         16  WS-ERROR-SUB        PIC 99.
   743
   744     12  WS-DATE-WORK.
   745         16  WS-WORK-MM          PIC XX.
   746         16  WS-WORK-DD          PIC XX.
   747         16  WS-WORK-YY          PIC XX.
   748
   749     12  WS-MM-YY.
   750         16  WS-MM               PIC XX.
   751         16  FILLER              PIC X     VALUE '/'.
   752         16  WS-YY               PIC XX.
   753
   754     12  WS-CERT-EFF-DT          PIC XX.
   755
   756     12  WS-MEMBER-NO            PIC X(12).
   757     12  FILLER  REDEFINES  WS-MEMBER-NO.
   758         16  WS-MEMBER-NO-1-8    PIC 9(8).
   759         16  FILLER              PIC X(4).
   760
   761     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   762
   763     12  WS-ERPNDB-ALT-KEY.
   764         16  WS-PB-COMPANY-CD-A1         PIC X.
   765         16  WS-PB-CARRIER               PIC X.
   766         16  WS-PB-GROUPING              PIC X(6).
   767         16  WS-PB-STATE                 PIC XX.
   768         16  WS-PB-ACCOUNT               PIC X(10).
   769         16  WS-PB-CERT-EFF-DT           PIC XX.
   770         16  WS-PB-CERT-NO.
   771             20  WS-PB-CERT-PRIME        PIC X(10).
   772             20  WS-PB-CERT-SFX          PIC X.
   773         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   774         16  WS-PB-RECORD-TYPE           PIC X.
   775
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  16
* EL6311.cbl
   776     12  WS-SHOW-SAVE-AREAS.
   777         16  WS-NEW-CERT-NO.
   778             20  WS-NEW-PRIME    PIC X(10).
   779             20  WS-NEW-SUFFIX   PIC X.
   780         16  WS-NEW-CERT-EFF-DT  PIC XX.
   781         16  WS-NEW-RECORD-TYPE  PIC X.
   782         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   783             88   SHOW-RECORD            VALUE 'Y'.
   784
   785     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   786
   787     12  WS-BATCH-NO.
   788         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   789         16  FILLER              PIC X(5) VALUE SPACES.
   790
   791     12  WS-FIRST-NAME.
   792         16  WS-1ST-INIT         PIC X.
   793         16  FILLER              PIC X(9).
   794
   795     12  WS-INITIALS.
   796         16  WS-INITIAL-1        PIC X.
   797         16  WS-INITIAL-2        PIC X.
   798
   799     12  WS-C-HDG.
   800         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   801         16  FILLER              PIC X(4) VALUE '-REF'.
   802
   803     12  WS-D-PREM-HDG.
   804         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   805         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   806
   807     12  WS-D-REFUND-HDG.
   808         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   809         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   810
   811     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   812
   813     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   814     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   815     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   816     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   817     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   818     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   819     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   820
   821     12  WS-01-CANCEL-ERR        PIC X(25)
   822         VALUE 'CANCEL DATE ERROR'.
   823     12  WS-02-CANCEL-ERR        PIC X(25)
   824         VALUE 'CERT NOT FOUND'.
   825     12  WS-04-CANCEL-ERR        PIC X(25)
   826         VALUE 'CANCEL AMOUNT ERROR'.
   827     12  WS-05-CANCEL-ERR        PIC X(25)
   828         VALUE 'CANCEL OPTION ERROR'.
   829     12  WS-06-CANCEL-ERR        PIC X(25)
   830         VALUE 'PREVIOUSLY CANCELLED'.
   831     12  WS-07-CANCEL-ERR        PIC X(25)
   832         VALUE 'INVALID DATA'.
   833     12  WS-08-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  17
* EL6311.cbl
   834         VALUE 'NO ACCOUNT MASTER'.
   835     12  WS-09-CANCEL-ERR        PIC X(25)
   836         VALUE 'SUFFIX ALREADY EXISTS'.
   837     12  WS-99-CANCEL-ERR        PIC X(25)
   838         VALUE 'MISC CANCEL ERROR'.
   839
   840     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   841     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   842
   843     12  WS-AGE-FIELDS.
   844         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   845         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   846         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   847         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   848
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  18
* EL6311.cbl
   850
   851******************************************************************
   852*                                                                *
   853*                 B A T C H   T O T A L S                        *
   854*                                                                *
   855******************************************************************
   856
   857     12  WS-BATCH-RECORD.
   858         16  FILLER                       PIC X(10).
   859         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   860         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   861         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   862         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   863         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   864         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   865         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   866         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   867         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   868         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   869         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   870         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   871         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   872         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   873         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   874         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   875         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   876         16  WS-ACCOUNT-NAME              PIC X(30).
   877         16  FILLER                       PIC X.
   878         16  WS-REFERENCE                 PIC X(12).
   879         16  FILLER                       PIC X(197).
   880
   881     12  WS-BATCH-TOTALS.
   882         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   883         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   884         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   885         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   886         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   887         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   888         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   889         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   890         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   891         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   892         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   893         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   894         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   895         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   896         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   897         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   898         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   899         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   900         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   901
   902     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   903
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  19
* EL6311.cbl
   905
   906******************************************************************
   907*                                                                *
   908*                E R R O R   M E S S A G E S                     *
   909*                                                                *
   910******************************************************************
   911
   912 01  ERROR-MESSAGES.
   913     12  ER-0004                 PIC  9(4) VALUE 0004.
   914     12  ER-0008                 PIC  9(4) VALUE 0008.
   915     12  ER-0023                 PIC  9(4) VALUE 0023.
   916     12  ER-0029                 PIC  9(4) VALUE 0029.
   917     12  ER-0033                 PIC  9(4) VALUE 0033.
   918     12  ER-0070                 PIC  9(4) VALUE 0070.
   919     12  ER-0220                 PIC  9(4) VALUE 0220.
   920     12  ER-0248                 PIC  9(4) VALUE 0248.
   921     12  ER-0280                 PIC  9(4) VALUE 0280.
   922     12  ER-0348                 PIC  9(4) VALUE 0348.
   923     12  ER-0582                 PIC  9(4) VALUE 0582.
   924     12  ER-0877                 PIC  9(4) VALUE 0877.
   925     12  ER-1236                 PIC  9(4) VALUE 1236.
   926     12  ER-1570                 PIC  9(4) VALUE 1570.
   927     12  ER-1575                 PIC  9(4) VALUE 1575.
   928     12  ER-1609                 PIC  9(4) VALUE 1609.
   929     12  ER-1819                 PIC  9(4) VALUE 1819.
   930     12  ER-2077                 PIC  9(4) VALUE 2077.
   931     12  ER-2129                 PIC  9(4) VALUE 2129.
   932     12  ER-2188                 PIC  9(4) VALUE 2188.
   933     12  ER-2192                 PIC  9(4) VALUE 2192.
   934     12  ER-2196                 PIC  9(4) VALUE 2196.
   935     12  ER-2197                 PIC  9(4) VALUE 2197.
   936     12  ER-2198                 PIC  9(4) VALUE 2198.
   937     12  ER-2200                 PIC  9(4) VALUE 2200.
   938     12  ER-2212                 PIC  9(4) VALUE 2212.
   939     12  ER-2218                 PIC  9(4) VALUE 2218.
   940     12  ER-2220                 PIC  9(4) VALUE 2220.
   941     12  ER-2222                 PIC  9(4) VALUE 2222.
   942     12  ER-2223                 PIC  9(4) VALUE 2223.
   943     12  ER-2224                 PIC  9(4) VALUE 2224.
   944     12  ER-2225                 PIC  9(4) VALUE 2225.
   945     12  ER-2226                 PIC  9(4) VALUE 2226.
   946     12  ER-2227                 PIC  9(4) VALUE 2227.
   947     12  ER-2228                 PIC  9(4) VALUE 2228.
   948     12  ER-2240                 PIC  9(4) VALUE 2240.
   949     12  ER-2241                 PIC  9(4) VALUE 2241.
   950     12  ER-2242                 PIC  9(4) VALUE 2242.
   951     12  ER-2243                 PIC  9(4) VALUE 2243.
   952     12  ER-2244                 PIC  9(4) VALUE 2244.
   953     12  ER-2245                 PIC  9(4) VALUE 2245.
   954     12  ER-2246                 PIC  9(4) VALUE 2246.
   955     12  ER-2247                 PIC  9(4) VALUE 2247.
   956     12  ER-2251                 PIC  9(4) VALUE 2251.
   957     12  ER-2252                 PIC  9(4) VALUE 2252.
   958     12  ER-2253                 PIC  9(4) VALUE 2253.
   959     12  ER-2254                 PIC  9(4) VALUE 2254.
   960     12  ER-2255                 PIC  9(4) VALUE 2255.
   961     12  ER-2256                 PIC  9(4) VALUE 2256.
   962     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  20
* EL6311.cbl
   963     12  ER-2258                 PIC  9(4) VALUE 2258.
   964     12  ER-2259                 PIC  9(4) VALUE 2259.
   965     12  ER-2260                 PIC  9(4) VALUE 2260.
   966     12  ER-2261                 PIC  9(4) VALUE 2261.
   967     12  ER-2287                 PIC  9(4) VALUE 2287.
   968     12  ER-2336                 PIC  9(4) VALUE 2336.
   969     12  ER-2337                 PIC  9(4) VALUE 2337.
   970     12  ER-2437                 PIC  9(4) VALUE 2437.
   971     12  ER-2471                 PIC  9(4) VALUE 2471.
   972     12  ER-2530                 PIC  9(4) VALUE 2530.
   973     12  ER-2531                 PIC  9(4) VALUE 2531.
   974     12  ER-2532                 PIC  9(4) VALUE 2532.
   975     12  ER-2533                 PIC  9(4) VALUE 2533.
   976     12  ER-2547                 PIC  9(4) VALUE 2547.
   977     12  ER-2591                 PIC  9(4) VALUE 2591.
   978     12  ER-2592                 PIC  9(4) VALUE 2592.
   979     12  ER-2593                 PIC  9(4) VALUE 2593.
   980     12  ER-2600                 PIC  9(4) VALUE 2600.
   981     12  ER-2601                 PIC  9(4) VALUE 2601.
   982     12  ER-2604                 PIC  9(4) VALUE 2604.
   983     12  ER-2605                 PIC  9(4) VALUE 2605.
   984     12  ER-2606                 PIC  9(4) VALUE 2606.
   985     12  ER-2607                 PIC  9(4) VALUE 2607.
   986     12  ER-2622                 PIC  9(4) VALUE 2622.
   987     12  ER-2625                 PIC  9(4) VALUE 2625.
   988     12  ER-2626                 PIC  9(4) VALUE 2626.
   989     12  ER-2627                 PIC  9(4) VALUE 2627.
   990     12  ER-2628                 PIC  9(4) VALUE 2628.
   991     12  ER-2629                 PIC  9(4) VALUE 2629.
   992     12  ER-2630                 PIC  9(4) VALUE 2630.
   993     12  ER-2631                 PIC  9(4) VALUE 2631.
   994     12  ER-2632                 PIC  9(4) VALUE 2632.
   995     12  ER-2633                 PIC  9(4) VALUE 2633.
   996     12  ER-2634                 PIC  9(4) VALUE 2634.
   997     12  ER-2635                 PIC  9(4) VALUE 2635.
   998     12  ER-2636                 PIC  9(4) VALUE 2636.
   999     12  ER-2639                 PIC  9(4) VALUE 2639.
  1000     12  ER-2640                 PIC  9(4) VALUE 2640.
  1001     12  ER-2647                 PIC  9(4) VALUE 2647.
  1002     12  ER-2648                 PIC  9(4) VALUE 2648.
  1003     12  ER-2649                 PIC  9(4) VALUE 2649.
  1004     12  ER-2650                 PIC  9(4) VALUE 2650.
  1005     12  ER-2653                 PIC  9(4) VALUE 2653.
  1006     12  ER-2654                 PIC  9(4) VALUE 2654.
  1007     12  ER-2655                 PIC  9(4) VALUE 2655.
  1008     12  ER-2656                 PIC  9(4) VALUE 2656.
  1009     12  ER-2657                 PIC  9(4) VALUE 2657.
  1010     12  ER-2660                 PIC  9(4) VALUE 2660.
  1011     12  ER-2661                 PIC  9(4) VALUE 2661.
  1012     12  ER-2662                 PIC  9(4) VALUE 2662.
  1013     12  ER-2663                 PIC  9(4) VALUE 2663.
  1014     12  ER-2664                 PIC  9(4) VALUE 2664.
  1015     12  ER-2667                 PIC  9(4) VALUE 2667.
  1016     12  ER-2668                 PIC  9(4) VALUE 2668.
  1017     12  ER-2669                 PIC  9(4) VALUE 2669.
  1018     12  ER-2670                 PIC  9(4) VALUE 2670.
  1019     12  ER-2671                 PIC  9(4) VALUE 2671.
  1020     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  21
* EL6311.cbl
  1021     12  ER-2673                 PIC  9(4) VALUE 2673.
  1022     12  ER-2677                 PIC  9(4) VALUE 2677.
  1023     12  ER-2678                 PIC  9(4) VALUE 2678.
  1024     12  ER-2679                 PIC  9(4) VALUE 2679.
  1025     12  ER-2680                 PIC  9(4) VALUE 2680.
  1026     12  ER-2681                 PIC  9(4) VALUE 2681.
  1027     12  ER-2682                 PIC  9(4) VALUE 2682.
  1028     12  ER-2683                 PIC  9(4) VALUE 2683.
  1029     12  ER-2684                 PIC  9(4) VALUE 2684.
  1030     12  ER-2686                 PIC  9(4) VALUE 2686.
  1031     12  ER-2689                 PIC  9(4) VALUE 2689.
  1032     12  ER-2690                 PIC  9(4) VALUE 2690.
  1033     12  ER-2693                 PIC  9(4) VALUE 2693.
  1034     12  ER-2695                 PIC  9(4) VALUE 2695.
  1035     12  ER-2701                 PIC  9(4) VALUE 2701.
  1036     12  ER-2720                 PIC  9(4) VALUE 2720.
  1037     12  ER-2709                 PIC  9(4) VALUE 2709.
  1038     12  ER-2704                 PIC  9(4) VALUE 2704.
  1039     12  ER-2725                 PIC  9(4) VALUE 2725.
  1040     12  ER-2726                 PIC  9(4) VALUE 2726.
  1041     12  ER-2728                 PIC  9(4) VALUE 2728.
  1042     12  ER-2729                 PIC  9(4) VALUE 2729.
  1043     12  ER-2731                 PIC  9(4) VALUE 2731.
  1044     12  ER-2732                 PIC  9(4) VALUE 2732.
  1045     12  ER-2733                 PIC  9(4) VALUE 2733.
  1046     12  ER-2735                 PIC  9(4) VALUE 2735.
  1047     12  ER-2738                 PIC  9(4) VALUE 2738.
  1048     12  ER-2742                 PIC  9(4) VALUE 2742.
  1049     12  ER-2743                 PIC  9(4) VALUE 2743.
  1050     12  ER-2744                 PIC  9(4) VALUE 2744.
  1051     12  ER-2747                 PIC  9(4) VALUE 2747.
  1052     12  ER-2749                 PIC  9(4) VALUE 2749.
  1053     12  ER-2753                 PIC  9(4) VALUE 2753.
  1054     12  ER-2755                 PIC  9(4) VALUE 2755.
  1055     12  ER-2757                 PIC  9(4) VALUE 2757.
  1056     12  ER-2771                 PIC  9(4) VALUE 2771.
  1057     12  ER-2774                 PIC  9(4) VALUE 2774.
  1058     12  ER-2775                 PIC  9(4) VALUE 2775.
  1059     12  ER-2776                 PIC  9(4) VALUE 2776.
  1060     12  ER-2777                 PIC  9(4) VALUE 2777.
  1061     12  ER-2794                 PIC  9(4) VALUE 2794.
  1062     12  ER-2799                 PIC  9(4) VALUE 2799.
  1063     12  ER-2900                 PIC  9(4) VALUE 2900.
  1064     12  ER-2902                 PIC  9(4) VALUE 2902.
  1065     12  ER-2945                 PIC  9(4) VALUE 2945.
  1066     12  ER-3000                 PIC  9(4) VALUE 3000.
  1067     12  ER-3006                 PIC  9(4) VALUE 3006.
  1068     12  ER-3054                 PIC  9(4) VALUE 3054.
  1069     12  ER-3224                 PIC  9(4) VALUE 3224.
  1070     12  ER-3269                 PIC  9(4) VALUE 3269.
  1071     12  er-3444                 pic  9(4) value 3444.
  1072     12  er-3446                 pic  9(4) value 3446.
  1073     12  er-3447                 pic  9(4) value 3447.
  1074     12  er-3448                 pic  9(4) value 3448.
  1075     12  er-3449                 pic  9(4) value 3449.
  1076     12  ER-3504                 PIC  9(4) VALUE 3504.
  1077     12  ER-3513                 PIC  9(4) VALUE 3513.
  1078     12  ER-3831                 PIC  9(4) VALUE 3831.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  22
* EL6311.cbl
  1079     12  ER-3834                 PIC  9(4) VALUE 3834.
  1080     12  ER-3835                 PIC  9(4) VALUE 3835.
  1081     12  ER-4005                 PIC  9(4) VALUE 4005.
  1082     12  ER-7144                 PIC  9(4) VALUE 7144.
  1083     12  ER-7401                 PIC  9(4) VALUE 7401.
  1084     12  ER-7402                 PIC  9(4) VALUE 7402.
  1085     12  ER-7403                 PIC  9(4) VALUE 7403.
  1086     12  ER-7404                 PIC  9(4) VALUE 7404.
  1087     12  ER-7423                 PIC  9(4) VALUE 7423.
  1088     12  ER-7424                 PIC  9(4) VALUE 7424.
  1089     12  ER-7433                 PIC  9(4) VALUE 7433.
  1090     12  ER-7450                 PIC  9(4) VALUE 7450.
  1091     12  ER-7451                 PIC  9(4) VALUE 7451.
  1092     12  ER-7530                 PIC  9(4) VALUE 7530.
  1093     12  ER-7573                 PIC  9(4) VALUE 7573.
  1094     12  ER-7631                 PIC  9(4) VALUE 7631.
  1095     12  ER-7632                 PIC  9(4) VALUE 7632.
  1096     12  ER-7633                 PIC  9(4) VALUE 7633.
  1097     12  ER-7537                 PIC  9(4) VALUE 7537.
  1098     12  ER-7538                 PIC  9(4) VALUE 7538.
  1099     12  ER-7574                 PIC  9(4) VALUE 7574.
  1100     12  ER-7997                 PIC  9(4) VALUE 7997.
  1101     12  ER-7998                 PIC  9(4) VALUE 7998.
  1102     12  ER-8148                 PIC  9(4) VALUE 8148.
  1103     12  ER-9063                 PIC  9(4) VALUE 9063.
  1104     12  ER-9076                 PIC  9(4) VALUE 9076.
  1105     12  ER-9618                 PIC  9(4) VALUE 9618.
  1106     12  ER-9841                 PIC  9(4) VALUE 9841.
  1107
  1108*                                COPY ELCTEXT.
  1109******************************************************************
  1110*                                                                *
  1111*                                                                *
  1112*                            ELCTEXT.                            *
  1113*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1114*                            VMOD=2.008                          *
  1115*                                                                *
  1116*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1117*                                     FORM LETTERS,              *
  1118*                                     CERT FORM DISPLAY.
  1119*                                                                *
  1120*   FILE TYPE = VSAM,KSDS                                        *
  1121*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1122*                                                                *
  1123*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1124*       ALTERNATE INDEX = NONE                                   *
  1125*                                                                *
  1126*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1127*       ALTERNATE INDEX = NONE                                   *
  1128*                                                                *
  1129*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1130*       ALTERNATE INDEX = NONE                                   *
  1131*                                                                *
  1132*   LOG = NO                                                     *
  1133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1134******************************************************************
  1135 01  TEXT-FILES.
  1136     12  TEXT-FILE-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  23
* EL6311.cbl
  1137         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1138         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1139         88  HELP-FILE-TEXT             VALUE 'TH'.
  1140
  1141     12  TX-CONTROL-PRIMARY.
  1142         16  TX-COMPANY-CD           PIC X.
  1143             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1144         16  TX-ACCESS-CD-GENL       PIC X(12).
  1145
  1146         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1147             20  TX-LETTER-NO        PIC X(4).
  1148             20  FILLER              PIC X(8).
  1149
  1150         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1151             20  TX-FORM-NO          PIC X(12).
  1152
  1153         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1154             20  TX-HELP-TYPE        PIC X.
  1155                 88  HELP-FOR-GENERAL   VALUE ' '.
  1156                 88  HELP-BY-SCREEN     VALUE 'S'.
  1157                 88  HELP-BY-ERROR      VALUE 'E'.
  1158             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1159                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1160             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1161                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1162             20  FILLER              PIC X(4).
  1163
  1164         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1165
  1166     12  TX-PROCESS-CONTROL          PIC XX.
  1167         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1168
  1169     12  TX-TEXT-LINE                PIC X(70).
  1170
  1171     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1172         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1173         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1174         88  TX-VALID-FORM-SQUEEZE-VALUE
  1175                                        VALUE 'Y' ' '.
  1176
  1177     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1178         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1179         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1180         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1181         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1182         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1183         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1184         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1185                                              'K' 'N' ' '
  1186                                              'Z'.
  1187
  1188     12  TX-ARCHIVE-SW               PIC X.
  1189         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1190         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1191         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1192
  1193     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1194     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  24
* EL6311.cbl
  1195
  1196     12  TX-BSR-CODE                 PIC X.
  1197         88  TX-BSR-LETTER              VALUE 'B'.
  1198         88  TX-NON-BSR-LETTER          VALUE ' '.
  1199
  1200     12  FILLER                      PIC X.
  1201*****************************************************************
  1202*                                COPY ELCCRTO.
  1203******************************************************************
  1204*                                                                *
  1205*                            ELCCRTO.                            *
  1206*                                                                *
  1207*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1208*                                                                *
  1209*   FILE TYPE = VSAM,KSDS                                        *
  1210*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1211*                                                                *
  1212*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1213*                                                                *
  1214*   LOG = YES                                                    *
  1215*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1216******************************************************************
  1217*                   C H A N G E   L O G
  1218*
  1219* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1220*-----------------------------------------------------------------
  1221*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1222* EFFECTIVE    NUMBER
  1223*-----------------------------------------------------------------
  1224* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1225* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1226* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1227* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1228* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1229******************************************************************
  1230 01  ORIGINAL-CERTIFICATE.
  1231     12  OC-RECORD-ID                      PIC XX.
  1232         88  VALID-OC-ID                      VALUE 'OC'.
  1233     12  OC-CONTROL-PRIMARY.
  1234         16  OC-COMPANY-CD                 PIC X.
  1235         16  OC-CARRIER                    PIC X.
  1236         16  OC-GROUPING                   PIC X(6).
  1237         16  OC-STATE                      PIC XX.
  1238         16  OC-ACCOUNT                    PIC X(10).
  1239         16  OC-CERT-EFF-DT                PIC XX.
  1240         16  OC-CERT-NO.
  1241             20  OC-CERT-PRIME             PIC X(10).
  1242             20  OC-CERT-SFX               PIC X.
  1243         16  OC-RECORD-TYPE                PIC X.
  1244         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1245     12  OC-LAST-MAINT-DT                  PIC XX.
  1246     12  OC-LAST-MAINT-BY                  PIC X(4).
  1247     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1248     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1249     12  FILLER                            PIC X(49).
  1250     12  OC-ORIG-REC.
  1251         16  OC-INS-LAST-NAME              PIC X(15).
  1252         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  25
* EL6311.cbl
  1253         16  OC-INS-MIDDLE-INIT            PIC X.
  1254         16  OC-INS-AGE                    PIC S999     COMP-3.
  1255         16  OC-JNT-LAST-NAME              PIC X(15).
  1256         16  OC-JNT-FIRST-NAME             PIC X(10).
  1257         16  OC-JNT-MIDDLE-INIT            PIC X.
  1258         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1259         16  OC-LF-BENCD                   PIC XX.
  1260         16  OC-LF-TERM                    PIC S999      COMP-3.
  1261         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1262         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1263         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1264         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1265         16  OC-LF-EXP-DT                  PIC XX.
  1266         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1267         16  OC-LF-CANCEL-DT               PIC XX.
  1268         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1269         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1270         16  OC-AH-BENCD                   PIC XX.
  1271         16  OC-AH-TERM                    PIC S999      COMP-3.
  1272         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1273         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1274         16  OC-AH-EXP-DT                  PIC XX.
  1275         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1276         16  OC-AH-CP                      PIC 99.
  1277         16  OC-AH-CANCEL-DT               PIC XX.
  1278         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1279         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1280         16  OC-CRED-BENE-NAME             PIC X(25).
  1281         16  OC-1ST-PMT-DT                 PIC XX.
  1282         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1283         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1284         16  OC-ISSUE-TRAN-IND             PIC X.
  1285         16  OC-CANCEL-TRAN-IND            PIC X.
  1286         16  FILLER                        PIC X(211).
  1287
  1288     12  FILLER                            PIC X(50).
  1289******************************************************************
  1290*                                COPY ERCACCT.
  1291******************************************************************
  1292*                                                                *
  1293*                                                                *
  1294*                            ERCACCT                             *
  1295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1296*                            VMOD=2.031                          *
  1297*                                                                *
  1298*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1299*                                                                *
  1300*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1301*   VSAM ACCOUNT MASTER FILES.                                   *
  1302*                                                                *
  1303*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1304*                                                                *
  1305*   FILE TYPE = VSAM,KSDS                                        *
  1306*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1307*                                                                *
  1308*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1309*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1310*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  26
* EL6311.cbl
  1311*   LOG = NO                                                     *
  1312*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1313*                                                                *
  1314*                                                                *
  1315******************************************************************
  1316*                   C H A N G E   L O G
  1317*
  1318* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1319*-----------------------------------------------------------------
  1320*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1321* EFFECTIVE    NUMBER
  1322*-----------------------------------------------------------------
  1323* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1324* 092705    2005050300006  PEMA  ADD SPP LEASES
  1325* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1326* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1327* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1328* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1329* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1330******************************************************************
  1331
  1332 01  ACCOUNT-MASTER.
  1333     12  AM-RECORD-ID                      PIC XX.
  1334         88  VALID-AM-ID                      VALUE 'AM'.
  1335
  1336     12  AM-CONTROL-PRIMARY.
  1337         16  AM-COMPANY-CD                 PIC X.
  1338         16  AM-MSTR-CNTRL.
  1339             20  AM-CONTROL-A.
  1340                 24  AM-CARRIER            PIC X.
  1341                 24  AM-GROUPING.
  1342                     28 AM-GROUPING-PREFIX PIC XXX.
  1343                     28 AM-GROUPING-PRIME  PIC XXX.
  1344                 24  AM-STATE              PIC XX.
  1345                 24  AM-ACCOUNT.
  1346                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1347                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1348             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1349                                           PIC X(19).
  1350             20  AM-CNTRL-B.
  1351                 24  AM-EXPIRATION-DT      PIC XX.
  1352                 24  FILLER                PIC X(4).
  1353             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1354                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1355
  1356     12  AM-CONTROL-BY-VAR-GRP.
  1357         16  AM-COMPANY-CD-A1              PIC X.
  1358         16  AM-VG-CARRIER                 PIC X.
  1359         16  AM-VG-GROUPING                PIC X(6).
  1360         16  AM-VG-STATE                   PIC XX.
  1361         16  AM-VG-ACCOUNT                 PIC X(10).
  1362         16  AM-VG-DATE.
  1363             20  AM-VG-EXPIRATION-DT       PIC XX.
  1364             20  FILLER                    PIC X(4).
  1365         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1366                                           PIC 9(11)      COMP-3.
  1367     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1368         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  27
* EL6311.cbl
  1369         16  AM-VG-KEY3.
  1370             20  AM-VG3-ACCOUNT            PIC X(10).
  1371             20  AM-VG3-EXP-DT             PIC XX.
  1372         16  FILLER                        PIC X(4).
  1373     12  AM-MAINT-INFORMATION.
  1374         16  AM-LAST-MAINT-DT              PIC XX.
  1375         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1376         16  AM-LAST-MAINT-USER            PIC X(4).
  1377         16  FILLER                        PIC XX.
  1378
  1379     12  AM-EFFECTIVE-DT                   PIC XX.
  1380     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1381
  1382     12  AM-PREV-DATES  COMP-3.
  1383         16  AM-PREV-EXP-DT                PIC 9(11).
  1384         16  AM-PREV-EFF-DT                PIC 9(11).
  1385
  1386     12  AM-REPORT-CODE-1                  PIC X(10).
  1387     12  AM-REPORT-CODE-2                  PIC X(10).
  1388
  1389     12  AM-CITY-CODE                      PIC X(4).
  1390     12  AM-COUNTY-PARISH                  PIC X(6).
  1391
  1392     12  AM-NAME                           PIC X(30).
  1393     12  AM-PERSON                         PIC X(30).
  1394     12  AM-ADDRS                          PIC X(30).
  1395     12  AM-CITY.
  1396         16  AM-ADDR-CITY                  PIC X(28).
  1397         16  AM-ADDR-STATE                 PIC XX.
  1398     12  AM-ZIP.
  1399         16  AM-ZIP-PRIME.
  1400             20  AM-ZIP-PRI-1ST            PIC X.
  1401                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1402             20  FILLER                    PIC X(4).
  1403         16  AM-ZIP-PLUS4                  PIC X(4).
  1404     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1405         16  AM-CAN-POSTAL-1               PIC XXX.
  1406         16  AM-CAN-POSTAL-2               PIC XXX.
  1407         16  FILLER                        PIC XXX.
  1408     12  AM-TEL-NO.
  1409         16  AM-AREA-CODE                  PIC 999.
  1410         16  AM-TEL-PRE                    PIC 999.
  1411         16  AM-TEL-NBR                    PIC 9(4).
  1412     12  AM-TEL-LOC                        PIC X.
  1413         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1414         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1415
  1416     12  AM-COMM-STRUCTURE.
  1417         16  AM-DEFN-1.
  1418             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1419                 24  AM-AGT.
  1420                     28  AM-AGT-PREFIX     PIC X(4).
  1421                     28  AM-AGT-PRIME      PIC X(6).
  1422                 24  AM-COM-TYP            PIC X.
  1423                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1424                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1425                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1426                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  28
* EL6311.cbl
  1427                 24  AM-RETRO-LV-INDIC     PIC X.
  1428                 24  AM-GL-CODES           PIC X.
  1429                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1430                 24  FILLER                PIC X(01).
  1431         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1432             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1433                 24  FILLER                PIC X(11).
  1434                 24  AM-L-COMA             PIC XXX.
  1435                 24  AM-J-COMA             PIC XXX.
  1436                 24  AM-A-COMA             PIC XXX.
  1437                 24  FILLER                PIC X(6).
  1438
  1439     12  AM-COMM-CHANGE-STATUS             PIC X.
  1440         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1441
  1442     12  AM-CSR-CODE                       PIC X(4).
  1443
  1444     12  AM-BILLING-STATUS                 PIC X.
  1445         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1446         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1447     12  AM-AUTO-REFUND-SW                 PIC X.
  1448         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1449         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1450     12  AM-GPCD                           PIC 99.
  1451     12  AM-IG                             PIC X.
  1452         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1453         88  AM-HAS-GROUP                     VALUE '2'.
  1454     12  AM-STATUS                         PIC X.
  1455         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1456         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1457         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1458         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1459         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1460         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1461     12  AM-REMIT-TO                       PIC 99.
  1462     12  AM-ID-NO                          PIC X(11).
  1463
  1464     12  AM-CAL-TABLE                      PIC XX.
  1465     12  AM-LF-DEVIATION                   PIC XXX.
  1466     12  AM-AH-DEVIATION                   PIC XXX.
  1467     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1468     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1469     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1470     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1471     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1472     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1473
  1474     12  AM-USER-FIELDS.
  1475         16  AM-FLD-1                      PIC XX.
  1476         16  AM-FLD-2                      PIC XX.
  1477         16  AM-FLD-3                      PIC XX.
  1478         16  AM-FLD-4                      PIC XX.
  1479         16  AM-FLD-5                      PIC XX.
  1480
  1481     12  AM-1ST-PROD-DATE.
  1482         16  AM-1ST-PROD-YR                PIC XX.
  1483         16  AM-1ST-PROD-MO                PIC XX.
  1484         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  29
* EL6311.cbl
  1485     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1486     12  AM-CERTS-PURGED-DATE.
  1487         16  AM-PUR-YR                     PIC XX.
  1488         16  AM-PUR-MO                     PIC XX.
  1489         16  AM-PUR-DA                     PIC XX.
  1490     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1491     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1492     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1493     12  AM-INACTIVE-DATE.
  1494         16  AM-INA-MO                     PIC 99.
  1495         16  AM-INA-DA                     PIC 99.
  1496         16  AM-INA-YR                     PIC 99.
  1497     12  AM-AR-HI-CERT-DATE                PIC XX.
  1498
  1499     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1500     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1501
  1502     12  AM-OB-PAYMENT-MODE                PIC X.
  1503         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1504         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1505         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1506         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1507
  1508     12  AM-AH-ONLY-INDICATOR              PIC X.
  1509         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1510         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1511
  1512     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1513
  1514     12  AM-OVER-SHORT.
  1515         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1516         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1517
  1518     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1519     12  AM-DCC-CLP-STATE                  PIC XX.
  1520
  1521     12  AM-RECALC-COMM                    PIC X.
  1522     12  AM-RECALC-REIN                    PIC X.
  1523
  1524     12  AM-REI-TABLE                      PIC XXX.
  1525     12  AM-REI-ET-LF                      PIC X.
  1526     12  AM-REI-ET-AH                      PIC X.
  1527     12  AM-REI-PE-LF                      PIC X.
  1528     12  AM-REI-PE-AH                      PIC X.
  1529     12  AM-REI-PRT-ST                     PIC X.
  1530     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1531     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1532     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1533     12  AM-REI-GROUP-A                    PIC X(6).
  1534     12  AM-REI-MORT                       PIC X(4).
  1535     12  AM-REI-PRT-OW                     PIC X.
  1536     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1537     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1538     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1539     12  AM-REI-GROUP-B                    PIC X(6).
  1540
  1541     12  AM-TRUST-TYPE                     PIC X(2).
  1542
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  30
* EL6311.cbl
  1543     12  AM-EMPLOYER-STMT-USED             PIC X.
  1544     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1545
  1546     12  AM-STD-AH-TYPE                    PIC XX.
  1547     12  AM-EARN-METHODS.
  1548         16  AM-EARN-METHOD-R              PIC X.
  1549             88 AM-REF-RL-R78                 VALUE 'R'.
  1550             88 AM-REF-RL-PR                  VALUE 'P'.
  1551             88 AM-REF-RL-MEAN                VALUE 'M'.
  1552             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1553         16  AM-EARN-METHOD-L              PIC X.
  1554             88 AM-REF-LL-R78                 VALUE 'R'.
  1555             88 AM-REF-LL-PR                  VALUE 'P'.
  1556             88 AM-REF-LL-MEAN                VALUE 'M'.
  1557             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1558         16  AM-EARN-METHOD-A              PIC X.
  1559             88 AM-REF-AH-R78                 VALUE 'R'.
  1560             88 AM-REF-AH-PR                  VALUE 'P'.
  1561             88 AM-REF-AH-MEAN                VALUE 'M'.
  1562             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1563             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1564             88 AM-REF-AH-NET                 VALUE 'N'.
  1565
  1566     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1567     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1568     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1569
  1570     12  AM-RET-Y-N                        PIC X.
  1571     12  AM-RET-P-E                        PIC X.
  1572     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1573     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1574     12  AM-RET-GRP                        PIC X(6).
  1575     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1576         16  AM-POOL-PRIME                 PIC XXX.
  1577         16  AM-POOL-SUB                   PIC XXX.
  1578     12  AM-RETRO-EARNINGS.
  1579         16  AM-RET-EARN-R                 PIC X.
  1580         16  AM-RET-EARN-L                 PIC X.
  1581         16  AM-RET-EARN-A                 PIC X.
  1582     12  AM-RET-ST-TAX-USE                 PIC X.
  1583         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1584         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1585     12  AM-RETRO-BEG-EARNINGS.
  1586         16  AM-RET-BEG-EARN-R             PIC X.
  1587         16  AM-RET-BEG-EARN-L             PIC X.
  1588         16  AM-RET-BEG-EARN-A             PIC X.
  1589     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1590     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1591
  1592     12  AM-USER-SELECT-OPTIONS.
  1593         16  AM-USER-SELECT-1              PIC X(10).
  1594         16  AM-USER-SELECT-2              PIC X(10).
  1595         16  AM-USER-SELECT-3              PIC X(10).
  1596         16  AM-USER-SELECT-4              PIC X(10).
  1597         16  AM-USER-SELECT-5              PIC X(10).
  1598
  1599     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1600
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  31
* EL6311.cbl
  1601     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1602
  1603     12  AM-RPT045A-SWITCH                 PIC X.
  1604         88  RPT045A-OFF                   VALUE 'N'.
  1605
  1606     12  AM-INSURANCE-LIMITS.
  1607         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1608         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1609
  1610     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1611         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1612
  1613     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1614         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1615         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1616
  1617     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1618
  1619     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1620     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1621     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1622     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1623     12  AM-DCC-UEF-STATE                  PIC XX.
  1624     12  FILLER                            PIC XXX.
  1625     12  AM-REPORT-CODE-3                  PIC X(10).
  1626*    12  FILLER                            PIC X(22).
  1627
  1628     12  AM-RESERVE-DATE.
  1629         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1630         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1631         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1632
  1633     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1634     12  AM-NOTIFICATION-TYPES.
  1635         16  AM-NOTIF-OF-LETTERS           PIC X.
  1636         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1637         16  AM-NOTIF-OF-REPORTS           PIC X.
  1638         16  AM-NOTIF-OF-STATUS            PIC X.
  1639
  1640     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1641         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1642         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1643         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1644         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1645
  1646     12  AM-BENEFIT-CONTROLS.
  1647         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1648             20  AM-BENEFIT-CODE           PIC XX.
  1649             20  AM-BENEFIT-TYPE           PIC X.
  1650             20  AM-BENEFIT-REVISION       PIC XXX.
  1651             20  AM-BENEFIT-REM-TERM       PIC X.
  1652             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1653             20  FILLER                    PIC XX.
  1654         16  FILLER                        PIC X(80).
  1655
  1656     12  AM-TRANSFER-DATA.
  1657         16  AM-TRANSFERRED-FROM.
  1658             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  32
* EL6311.cbl
  1659             20  AM-TRNFROM-GROUPING.
  1660                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1661                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1662             20  AM-TRNFROM-STATE          PIC XX.
  1663             20  AM-TRNFROM-ACCOUNT.
  1664                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1665                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1666             20  AM-TRNFROM-DTE            PIC XX.
  1667         16  AM-TRANSFERRED-TO.
  1668             20  AM-TRNTO-CARRIER          PIC X.
  1669             20  AM-TRNTO-GROUPING.
  1670                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1671                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1672             20  AM-TRNTO-STATE            PIC XX.
  1673             20  AM-TRNTO-ACCOUNT.
  1674                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1675                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1676             20  AM-TRNTO-DTE              PIC XX.
  1677         16  FILLER                        PIC X(10).
  1678
  1679     12  AM-SAVED-REMIT-TO                 PIC 99.
  1680
  1681     12  AM-COMM-STRUCTURE-SAVED.
  1682         16  AM-DEFN-1-SAVED.
  1683             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1684                 24  AM-AGT-SV             PIC X(10).
  1685                 24  AM-COM-TYP-SV         PIC X.
  1686                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1687                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1688                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1689                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1690                 24  FILLER                PIC X.
  1691                 24  AM-GL-CODES-SV        PIC X.
  1692                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1693                 24  FILLER                PIC X.
  1694         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1695             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1696                 24  FILLER                PIC X(11).
  1697                 24  AM-L-COMA-SV          PIC XXX.
  1698                 24  AM-J-COMA-SV          PIC XXX.
  1699                 24  AM-A-COMA-SV          PIC XXX.
  1700                 24  FILLER                PIC X(6).
  1701
  1702     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1703         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1704            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1705            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1706            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1707
  1708     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1709     12  FILLER                            PIC X(120).
  1710
  1711     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1712         16  AM-CONTROL-NAME               PIC X(30).
  1713         16  AM-EXECUTIVE-ONE.
  1714             20  AM-EXEC1-NAME             PIC X(15).
  1715             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1716                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  33
* EL6311.cbl
  1717             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1718                                                          COMP-3.
  1719         16  AM-EXECUTIVE-TWO.
  1720             20  AM-EXEC2-NAME             PIC X(15).
  1721             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1722                                                          COMP-3.
  1723             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1724                                                          COMP-3.
  1725
  1726     12  AM-RETRO-ADDITIONAL-DATA.
  1727         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1728         16  AM-RETRO-PREM-P-E             PIC X.
  1729         16  AM-RETRO-CLMS-P-I             PIC X.
  1730         16  AM-RETRO-RET-BRACKET-LF.
  1731             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1732                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1733                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1734             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1735                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1736                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1737             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1738                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1739                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1740         16  AM-RETRO-RET-BRACKET-AH.
  1741             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1742                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1743                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1744                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1745             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1746                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1747                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1748             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1749                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1750                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1751
  1752     12  AM-COMMENTS.
  1753         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1754
  1755     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1756         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1757         16  AM-FLI-BILLING-CODE           PIC X.
  1758         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1759         16  AM-FLI-UNITED-IDENT           PIC X.
  1760         16  AM-FLI-INTEREST-LOST-DATA.
  1761             20  AM-FLI-BANK-NO            PIC X(5).
  1762             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1763             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1764             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1765         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1766             20  AM-FLI-AGT                PIC X(9).
  1767             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1768             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1769         16  FILLER                        PIC X(102).
  1770
  1771     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1772         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1773             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1774             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  34
* EL6311.cbl
  1775             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1776             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1777             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1778         16  FILLER                          PIC X(10).
  1779******************************************************************
  1780*                                COPY ELCVADS.
  1781******************************************************************
  1782*                                                                *
  1783*                                                                *
  1784*                            ELCVADS.                            *
  1785*                                                                *
  1786*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1787*   ELVADS                  LENGTH = 350                         *
  1788******************************************************************
  1789******************************************************************
  1790*                   C H A N G E   L O G
  1791*
  1792* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1793*-----------------------------------------------------------------
  1794*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1795* EFFECTIVE    NUMBER
  1796*-----------------------------------------------------------------
  1797* 100111    2011022800001  AJRA  NAPERSOFT
  1798******************************************************************
  1799
  1800 01  VIRGINIA-DISCLOSURE.
  1801     12  VD-COMPANY-CD              PIC X.
  1802     12  VD-CARRIER                 PIC X.
  1803     12  VD-GROUPING.
  1804         20  VD-GROUPING-PREFIX     PIC XXX.
  1805         20  VD-GROUPING-PRIME      PIC XXX.
  1806     12  VD-STATE                   PIC XX.
  1807     12  VD-ACCOUNT.
  1808         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1809         20  VD-ACCOUNT-PRIME       PIC X(6).
  1810     12  VD-CERT-EFF-DT             PIC XX.
  1811     12  VD-CERT-NO.
  1812         20  VD-CERT-PRIME          PIC X(10).
  1813         20  VD-CERT-SFX            PIC X.
  1814     12  VD-ENTRY-BATCH             PIC X(6).
  1815     12  VD-CSR-ID                  PIC X(4).
  1816     12  VD-NAME.
  1817         20  VD-INSURED-LAST-NAME   PIC X(15).
  1818         20  VD-INSURED-FIRST-NAME.
  1819             24  VD-INSURED-1ST-INIT PIC X.
  1820             24  FILLER             PIC X(9).
  1821         20  VD-INSURED-MIDDLE-INIT PIC X.
  1822     12  VD-JOINT-INSURED.
  1823         20 VD-JOINT-LAST-NAME      PIC X(15).
  1824         20 VD-JOINT-FIRST-NAME.
  1825            24  VD-JOINT-FIRST-INIT PIC X.
  1826            24  FILLER              PIC X(9).
  1827         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1828     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1829     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1830     12  VD-INSURED-CITY-STATE.
  1831         20  VD-INSURED-CITY        PIC X(28).
  1832         20  VD-INSURED-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  35
* EL6311.cbl
  1833     12  VD-INSURED-ZIP-CODE.
  1834         20  VD-INSURED-ZIP-PRIME.
  1835             24  VD-INSURED-ZIP-1   PIC X.
  1836                 88  VD-CANADIAN-POST-CODE
  1837                                       VALUE 'A' THRU 'Z'.
  1838             24  FILLER             PIC X(4).
  1839         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1840     12  VD-BENEFICIARY-NAME        PIC X(30).
  1841     12  VD-ACCOUNT-NAME            PIC X(30).
  1842     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1843     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1844     12  VD-1ST-PMT-DT              PIC XX.
  1845     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1846         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1847         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1848                                             '90' THRU '99'.
  1849     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1850                                    PIC XX.
  1851     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1852     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1853     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1854     12  VD-LF-TERM                 PIC S999   COMP-3.
  1855     12  VD-AH-BENEFIT-CD           PIC XX.
  1856         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1857         88  VD-INVALID-AH             VALUE '  ' '00'
  1858                                             '90' THRU '99'.
  1859     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1860     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1861     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1862     12  VD-AH-TERM                 PIC S999   COMP-3.
  1863     12  VD-LETTER-ID               PIC X(4).
  1864     12  VD-PROC-ID                 PIC X(4).
  1865     12  VD-COMP-ID                 PIC X(3).
  1866     12  VD-CURRENT-DATE            PIC XX.
  1867     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1868     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1869     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  36
* EL6311.cbl
  1871*    COPY ELCDATE.
  1872******************************************************************
  1873*                                                                *
  1874*                                                                *
  1875*                            ELCDATE.                            *
  1876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1877*                            VMOD=2.003
  1878*                                                                *
  1879*                                                                *
  1880*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1881*                 LENGTH = 200                                   *
  1882******************************************************************
  1883
  1884 01  DATE-CONVERSION-DATA.
  1885     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1886     12  DC-OPTION-CODE                PIC X.
  1887         88  BIN-TO-GREG                VALUE ' '.
  1888         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1889         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1890         88  YMD-GREG-TO-BIN            VALUE '3'.
  1891         88  MDY-GREG-TO-BIN            VALUE '4'.
  1892         88  JULIAN-TO-BIN              VALUE '5'.
  1893         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1894         88  FIND-CENTURY               VALUE '7'.
  1895         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1896         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1897         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1898         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1899         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1900         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1901         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1902         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1903         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1904         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1905         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1906         88  BIN-3-TO-GREG              VALUE 'I'.
  1907         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1908         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1909         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1910         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1911         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1912         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1913         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1914         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1915         88  THREE-CHARACTER-BIN
  1916                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1917         88  GREGORIAN-TO-BIN
  1918                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1919         88  BIN-TO-GREGORIAN
  1920                  VALUES ' ' '1' 'I' '8' 'G'.
  1921         88  JULIAN-TO-BINARY
  1922                  VALUES '5' 'C' 'E' 'F'.
  1923     12  DC-ERROR-CODE                 PIC X.
  1924         88  NO-CONVERSION-ERROR        VALUE ' '.
  1925         88  DATE-CONVERSION-ERROR
  1926                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1927         88  DATE-IS-ZERO               VALUE '1'.
  1928         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  37
* EL6311.cbl
  1929         88  DATE-IS-INVALID            VALUE '3'.
  1930         88  DATE1-GREATER-DATE2        VALUE '4'.
  1931         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1932         88  DATE-INVALID-OPTION        VALUE '9'.
  1933         88  INVALID-CENTURY            VALUE 'A'.
  1934         88  ONLY-CENTURY               VALUE 'B'.
  1935         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1936         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1937     12  DC-END-OF-MONTH               PIC X.
  1938         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1939     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1940         88  USE-NORMAL-PROCESS         VALUE ' '.
  1941         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1942         88  ADJUST-UP-100-YRS          VALUE '2'.
  1943     12  FILLER                        PIC X.
  1944     12  DC-CONVERSION-DATES.
  1945         16  DC-BIN-DATE-1             PIC XX.
  1946         16  DC-BIN-DATE-2             PIC XX.
  1947         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1948         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1949                       DC-GREG-DATE-1-EDIT.
  1950             20  DC-EDIT1-MONTH        PIC 99.
  1951             20  SLASH1-1              PIC X.
  1952             20  DC-EDIT1-DAY          PIC 99.
  1953             20  SLASH1-2              PIC X.
  1954             20  DC-EDIT1-YEAR         PIC 99.
  1955         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1956         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1957                     DC-GREG-DATE-2-EDIT.
  1958             20  DC-EDIT2-MONTH        PIC 99.
  1959             20  SLASH2-1              PIC X.
  1960             20  DC-EDIT2-DAY          PIC 99.
  1961             20  SLASH2-2              PIC X.
  1962             20  DC-EDIT2-YEAR         PIC 99.
  1963         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1964         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1965                     DC-GREG-DATE-1-YMD.
  1966             20  DC-YMD-YEAR           PIC 99.
  1967             20  DC-YMD-MONTH          PIC 99.
  1968             20  DC-YMD-DAY            PIC 99.
  1969         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1970         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1971                      DC-GREG-DATE-1-MDY.
  1972             20  DC-MDY-MONTH          PIC 99.
  1973             20  DC-MDY-DAY            PIC 99.
  1974             20  DC-MDY-YEAR           PIC 99.
  1975         16  DC-GREG-DATE-1-ALPHA.
  1976             20  DC-ALPHA-MONTH        PIC X(10).
  1977             20  DC-ALPHA-DAY          PIC 99.
  1978             20  FILLER                PIC XX.
  1979             20  DC-ALPHA-CENTURY.
  1980                 24 DC-ALPHA-CEN-N     PIC 99.
  1981             20  DC-ALPHA-YEAR         PIC 99.
  1982         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1983         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1984         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1985         16  DC-JULIAN-DATE            PIC 9(05).
  1986         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  38
* EL6311.cbl
  1987                                       PIC 9(05).
  1988         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1989             20  DC-JULIAN-YEAR        PIC 99.
  1990             20  DC-JULIAN-DAYS        PIC 999.
  1991         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1992         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1993         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1994     12  DATE-CONVERSION-VARIBLES.
  1995         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1996         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1997             20  FILLER                PIC 9(3).
  1998             20  HOLD-CEN-1-CCYY.
  1999                 24  HOLD-CEN-1-CC     PIC 99.
  2000                 24  HOLD-CEN-1-YY     PIC 99.
  2001             20  HOLD-CEN-1-MO         PIC 99.
  2002             20  HOLD-CEN-1-DA         PIC 99.
  2003         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2004             20  HOLD-CEN-1-R-MO       PIC 99.
  2005             20  HOLD-CEN-1-R-DA       PIC 99.
  2006             20  HOLD-CEN-1-R-CCYY.
  2007                 24  HOLD-CEN-1-R-CC   PIC 99.
  2008                 24  HOLD-CEN-1-R-YY   PIC 99.
  2009             20  FILLER                PIC 9(3).
  2010         16  HOLD-CENTURY-1-X.
  2011             20  FILLER                PIC X(3)  VALUE SPACES.
  2012             20  HOLD-CEN-1-X-CCYY.
  2013                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2014                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2015             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2016             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2017         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2018             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2019             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2020             20  HOLD-CEN-1-R-X-CCYY.
  2021                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2022                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2023             20  FILLER                PIC XXX.
  2024         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2025         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2026         16  DC-JULIAN-DATE-1          PIC 9(07).
  2027         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2028             20  DC-JULIAN-1-CCYY.
  2029                 24  DC-JULIAN-1-CC    PIC 99.
  2030                 24  DC-JULIAN-1-YR    PIC 99.
  2031             20  DC-JULIAN-DA-1        PIC 999.
  2032         16  DC-JULIAN-DATE-2          PIC 9(07).
  2033         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2034             20  DC-JULIAN-2-CCYY.
  2035                 24  DC-JULIAN-2-CC    PIC 99.
  2036                 24  DC-JULIAN-2-YR    PIC 99.
  2037             20  DC-JULIAN-DA-2        PIC 999.
  2038         16  DC-GREG-DATE-A-EDIT.
  2039             20  DC-EDITA-MONTH        PIC 99.
  2040             20  SLASHA-1              PIC X VALUE '/'.
  2041             20  DC-EDITA-DAY          PIC 99.
  2042             20  SLASHA-2              PIC X VALUE '/'.
  2043             20  DC-EDITA-CCYY.
  2044                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  39
* EL6311.cbl
  2045                 24  DC-EDITA-YEAR     PIC 99.
  2046         16  DC-GREG-DATE-B-EDIT.
  2047             20  DC-EDITB-MONTH        PIC 99.
  2048             20  SLASHB-1              PIC X VALUE '/'.
  2049             20  DC-EDITB-DAY          PIC 99.
  2050             20  SLASHB-2              PIC X VALUE '/'.
  2051             20  DC-EDITB-CCYY.
  2052                 24  DC-EDITB-CENT     PIC 99.
  2053                 24  DC-EDITB-YEAR     PIC 99.
  2054         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2055         16  DC-GREG-DATE-CYMD-R REDEFINES
  2056                              DC-GREG-DATE-CYMD.
  2057             20  DC-CYMD-CEN           PIC 99.
  2058             20  DC-CYMD-YEAR          PIC 99.
  2059             20  DC-CYMD-MONTH         PIC 99.
  2060             20  DC-CYMD-DAY           PIC 99.
  2061         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2062         16  DC-GREG-DATE-MDCY-R REDEFINES
  2063                              DC-GREG-DATE-MDCY.
  2064             20  DC-MDCY-MONTH         PIC 99.
  2065             20  DC-MDCY-DAY           PIC 99.
  2066             20  DC-MDCY-CEN           PIC 99.
  2067             20  DC-MDCY-YEAR          PIC 99.
  2068    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2069        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2070    12  DC-EL310-DATE                  PIC X(21).
  2071    12  FILLER                         PIC X(28).
  2072
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  40
* EL6311.cbl
  2074*    COPY ELCLOGOF.
  2075******************************************************************
  2076*                                                                *
  2077*                                                                *
  2078*                            ELCLOGOF.                           *
  2079*                            VMOD=2.001                          *
  2080*                                                                *
  2081*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2082*                                                                *
  2083******************************************************************
  2084 01  CLASIC-LOGOFF.
  2085     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2086     12  LOGOFF-TEXT.
  2087         16  FILLER          PIC X(5)    VALUE SPACES.
  2088         16  LOGOFF-MSG.
  2089             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2090             20  FILLER      PIC X       VALUE SPACES.
  2091             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2092         16  FILLER          PIC X(80)
  2093           VALUE '* YOU ARE NOW LOGGED OFF'.
  2094         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2095         16  FILLER          PIC X       VALUE QUOTE.
  2096         16  LOGOFF-SYS-MSG  PIC X(17)
  2097           VALUE 'S CLAS-IC SYSTEM '.
  2098     12  TEXT-MESSAGES.
  2099         16  UNACCESS-MSG    PIC X(29)
  2100             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2101         16  PGMIDERR-MSG    PIC X(17)
  2102             VALUE 'PROGRAM NOT FOUND'.
  2103
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  41
* EL6311.cbl
  2105*    COPY ELCATTR.
  2106******************************************************************
  2107*                                                                *
  2108*                            ELCATTR.                            *
  2109*                            VMOD=2.001                          *
  2110*                                                                *
  2111*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2112*                                                                *
  2113*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2114*                                                                *
  2115*                   POS 1   P=PROTECTED                          *
  2116*                           U=UNPROTECTED                        *
  2117*                           S=ASKIP                              *
  2118*                   POS 2   A=ALPHA/NUMERIC                      *
  2119*                           N=NUMERIC                            *
  2120*                   POS 3   N=NORMAL                             *
  2121*                           B=BRIGHT                             *
  2122*                           D=DARK                               *
  2123*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2124*                           OF=MODIFIED DATA TAG OFF             *
  2125*                                                                *
  2126*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2127******************************************************************
  2128 01  ATTRIBUTE-LIST.
  2129     12  AL-PABOF            PIC X       VALUE 'Y'.
  2130     12  AL-PABON            PIC X       VALUE 'Z'.
  2131     12  AL-PADOF            PIC X       VALUE '%'.
  2132     12  AL-PADON            PIC X       VALUE '_'.
  2133     12  AL-PANOF            PIC X       VALUE '-'.
  2134     12  AL-PANON            PIC X       VALUE '/'.
  2135     12  AL-SABOF            PIC X       VALUE '8'.
  2136     12  AL-SABON            PIC X       VALUE '9'.
  2137     12  AL-SADOF            PIC X       VALUE '@'.
  2138     12  AL-SADON            PIC X       VALUE QUOTE.
  2139     12  AL-SANOF            PIC X       VALUE '0'.
  2140     12  AL-SANON            PIC X       VALUE '1'.
  2141     12  AL-UABOF            PIC X       VALUE 'H'.
  2142     12  AL-UABON            PIC X       VALUE 'I'.
  2143     12  AL-UADOF            PIC X       VALUE '<'.
  2144     12  AL-UADON            PIC X       VALUE '('.
  2145     12  AL-UANOF            PIC X       VALUE ' '.
  2146     12  AL-UANON            PIC X       VALUE 'A'.
  2147     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2148     12  AL-UNBON            PIC X       VALUE 'R'.
  2149     12  AL-UNDOF            PIC X       VALUE '*'.
  2150     12  AL-UNDON            PIC X       VALUE ')'.
  2151     12  AL-UNNOF            PIC X       VALUE '&'.
  2152     12  AL-UNNON            PIC X       VALUE 'J'.
  2153
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  42
* EL6311.cbl
  2155*    COPY ELCEMIB.
  2156******************************************************************
  2157*                                                                *
  2158*                                                                *
  2159*                            ELCEMIB.                            *
  2160*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2161*                            VMOD=2.005                          *
  2162*                                                                *
  2163*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2164*                                                                *
  2165******************************************************************
  2166 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2167     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2168     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2169     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2170     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2171     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2172     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2173     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2174     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2175     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2176         88  EMI-NO-ERRORS                    VALUE '1'.
  2177         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2178         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2179     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2180         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2181     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2182         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2183         88  EMI-AREA1-FULL                   VALUE '2'.
  2184     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2185         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2186         88  EMI-AREA2-FULL                   VALUE '2'.
  2187     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2188         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2189         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2190         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2191         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2192         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2193     12  EMI-ERROR-LINES.
  2194         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2195         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2196         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2197         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2198             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2199                 24  EMI-ERR-NUM         PIC X(4).
  2200                 24  EMI-FILLER          PIC X.
  2201                 24  EMI-SEV             PIC X.
  2202                 24  FILLER              PIC X.
  2203             20  FILLER                  PIC X(02).
  2204     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2205         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2206             20  EMI-ERROR-NUMBER    PIC X(4).
  2207             20  EMI-FILL            PIC X.
  2208             20  EMI-SEVERITY        PIC X.
  2209             20  FILLER              PIC X.
  2210             20  EMI-ERROR-TEXT.
  2211                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2212                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  43
* EL6311.cbl
  2213     12  EMI-SEVERITY-SAVE           PIC X.
  2214         88  EMI-NOTE                    VALUE 'N'.
  2215         88  EMI-WARNING                 VALUE 'W'.
  2216         88  EMI-FORCABLE                VALUE 'F'.
  2217         88  EMI-FATAL                   VALUE 'X'.
  2218     12  EMI-MESSAGE-FLAG            PIC X.
  2219         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2220         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2221     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2222     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2223         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2224         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2225         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2226     12  emi-claim-no                pic x(7).
  2227     12  emi-claim-type              pic x(6).
  2228     12  FILLER                      PIC X(124)  VALUE SPACES.
  2229     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2230     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2231     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2232     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2233
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  44
* EL6311.cbl
  2235*    COPY ELCINTF.
  2236******************************************************************
  2237*                                                                *
  2238*                                                                *
  2239*                            ELCINTF.                            *
  2240*                            VMOD=2.017                          *
  2241*                                                                *
  2242*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2243*                                                                *
  2244*       LENGTH = 1024                                            *
  2245*                                                                *
  2246******************************************************************
  2247*                   C H A N G E   L O G
  2248*
  2249* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2250*-----------------------------------------------------------------
  2251*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2252* EFFECTIVE    NUMBER
  2253*-----------------------------------------------------------------
  2254* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2255******************************************************************
  2256 01  PROGRAM-INTERFACE-BLOCK.
  2257     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2258     12  PI-CALLING-PROGRAM              PIC X(8).
  2259     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2260     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2261     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2262     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2263     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2264     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2265     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2266     12  PI-COMPANY-ID                   PIC XXX.
  2267     12  PI-COMPANY-CD                   PIC X.
  2268
  2269     12  PI-COMPANY-PASSWORD             PIC X(8).
  2270
  2271     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2272
  2273     12  PI-CONTROL-IN-PROGRESS.
  2274         16  PI-CARRIER                  PIC X.
  2275         16  PI-GROUPING                 PIC X(6).
  2276         16  PI-STATE                    PIC XX.
  2277         16  PI-ACCOUNT                  PIC X(10).
  2278         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2279                                         PIC X(10).
  2280         16  PI-CLAIM-CERT-GRP.
  2281             20  PI-CLAIM-NO             PIC X(7).
  2282             20  PI-CERT-NO.
  2283                 25  PI-CERT-PRIME       PIC X(10).
  2284                 25  PI-CERT-SFX         PIC X.
  2285             20  PI-CERT-EFF-DT          PIC XX.
  2286         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2287             20  PI-PLAN-CODE            PIC X(2).
  2288             20  PI-REVISION-NUMBER      PIC X(3).
  2289             20  PI-PLAN-EFF-DT          PIC X(2).
  2290             20  PI-PLAN-EXP-DT          PIC X(2).
  2291             20  FILLER                  PIC X(11).
  2292         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  45
* EL6311.cbl
  2293             20  PI-OE-REFERENCE-1.
  2294                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2295                 25  PI-OE-REF-1-SUFF    PIC XX.
  2296
  2297     12  PI-SESSION-IN-PROGRESS          PIC X.
  2298         88  CLAIM-SESSION                   VALUE '1'.
  2299         88  CREDIT-SESSION                  VALUE '2'.
  2300         88  WARRANTY-SESSION                VALUE '3'.
  2301         88  MORTGAGE-SESSION                VALUE '4'.
  2302         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2303
  2304
  2305*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2306
  2307     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2308     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2309
  2310     12  PI-CREDIT-USER                  PIC X.
  2311         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2312         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2313
  2314     12  PI-CLAIM-USER                   PIC X.
  2315         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2316         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2317
  2318     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2319         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2320         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2321         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2322         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2323         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2324
  2325     12  PI-PROCESSOR-ID                 PIC X(4).
  2326
  2327     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2328
  2329     12  PI-MEMBER-CAPTION               PIC X(10).
  2330
  2331     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2332         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2333
  2334     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2335     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2336     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2337     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2338
  2339     12  PI-AH-OVERRIDE-L1               PIC X.
  2340     12  PI-AH-OVERRIDE-L2               PIC XX.
  2341     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2342     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2343
  2344     12  PI-NEW-SYSTEM                   PIC X(2).
  2345
  2346     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2347     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2348         88  PI-USES-PAID-TO                 VALUE '1'.
  2349     12  PI-CRDTCRD-SYSTEM.
  2350         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  46
* EL6311.cbl
  2351             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2352             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2353         16  PI-CC-MONTH-END-DT          PIC XX.
  2354     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2355
  2356     12  PI-OE-REFERENCE-2.
  2357         16  PI-OE-REF-2-PRIME           PIC X(10).
  2358         16  PI-OE-REF-2-SUFF            PIC X.
  2359
  2360     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2361
  2362     12  PI-LANGUAGE-TYPE                PIC X.
  2363             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2364             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2365             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2366
  2367     12  PI-POLICY-LINKAGE-IND           PIC X.
  2368         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2369         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2370                                                   LOW-VALUES.
  2371
  2372     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2373     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2374         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2375         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2376
  2377     12  PI-PROCESSOR-CSR-IND            PIC X.
  2378         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2379         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2380
  2381     12  FILLER                          PIC X(3).
  2382
  2383     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2384
  2385     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2386         PI-SYSTEM-LEVEL.
  2387
  2388         16  PI-ENTRY-CODES.
  2389             20  PI-ENTRY-CD-1           PIC X.
  2390             20  PI-ENTRY-CD-2           PIC X.
  2391
  2392         16  PI-RETURN-CODES.
  2393             20  PI-RETURN-CD-1          PIC X.
  2394             20  PI-RETURN-CD-2          PIC X.
  2395
  2396         16  PI-UPDATE-STATUS-SAVE.
  2397             20  PI-UPDATE-BY            PIC X(4).
  2398             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2399
  2400         16  PI-LOWER-CASE-LETTERS       PIC X.
  2401             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2402
  2403*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2404*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2405*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2406
  2407         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2408             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  47
* EL6311.cbl
  2409             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2410             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2411             88  ACCNT-CNTL                  VALUE '3'.
  2412             88  CARR-ACCNT-CNTL             VALUE '4'.
  2413
  2414         16  PI-PROCESSOR-CAP-LIST.
  2415             20  PI-SYSTEM-CONTROLS.
  2416                24 PI-SYSTEM-DISPLAY     PIC X.
  2417                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2418                24 PI-SYSTEM-MODIFY      PIC X.
  2419                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2420             20  FILLER                  PIC XX.
  2421             20  PI-DISPLAY-CAP          PIC X.
  2422                 88  DISPLAY-CAP             VALUE 'Y'.
  2423             20  PI-MODIFY-CAP           PIC X.
  2424                 88  MODIFY-CAP              VALUE 'Y'.
  2425             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2426                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2427             20  PI-FORCE-CAP            PIC X.
  2428                 88  FORCE-CAP               VALUE 'Y'.
  2429
  2430         16  PI-PROGRAM-CONTROLS.
  2431             20  PI-PGM-PRINT-OPT        PIC X.
  2432             20  PI-PGM-FORMAT-OPT       PIC X.
  2433             20  PI-PGM-PROCESS-OPT      PIC X.
  2434             20  PI-PGM-TOTALS-OPT       PIC X.
  2435
  2436         16  PI-HELP-INTERFACE.
  2437             20  PI-LAST-ERROR-NO        PIC X(4).
  2438             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2439
  2440         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2441             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2442
  2443         16  PI-CR-CONTROL-IN-PROGRESS.
  2444             20  PI-CR-CARRIER           PIC X.
  2445             20  PI-CR-GROUPING          PIC X(6).
  2446             20  PI-CR-STATE             PIC XX.
  2447             20  PI-CR-ACCOUNT           PIC X(10).
  2448             20  PI-CR-FIN-RESP          PIC X(10).
  2449             20  PI-CR-TYPE              PIC X.
  2450
  2451         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2452
  2453         16  PI-CR-MONTH-END-DT          PIC XX.
  2454
  2455         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2456             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2457             88  PI-ZERO-CARRIER             VALUE '1'.
  2458             88  PI-ZERO-GROUPING            VALUE '2'.
  2459             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2460
  2461         16  PI-CARRIER-SECURITY         PIC X.
  2462             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2463
  2464         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2465             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2466             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  48
* EL6311.cbl
  2467
  2468         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2469             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2470                                         INDEXED BY PI-ACCESS-NDX
  2471                                         PIC X.
  2472
  2473         16  PI-GA-BILLING-CONTROL       PIC X.
  2474             88  PI-GA-BILLING               VALUE '1'.
  2475
  2476         16  PI-MAIL-PROCESSING          PIC X.
  2477             88  PI-MAIL-YES                 VALUE 'Y'.
  2478
  2479         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2480
  2481         16  PI-AR-SYSTEM.
  2482             20  PI-AR-PROCESSING-CNTL   PIC X.
  2483                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2484             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2485             20  PI-AR-MONTH-END-DT      PIC XX.
  2486
  2487         16  PI-MP-SYSTEM.
  2488             20  PI-MORTGAGE-USER            PIC X.
  2489                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2490                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2491             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2492                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2493                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2494                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2495                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2496                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2497             20  PI-MP-MONTH-END-DT          PIC XX.
  2498             20  PI-MP-REFERENCE-NO.
  2499                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2500                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2501
  2502         16  PI-LABEL-CONTROL            PIC X(01).
  2503             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2504             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2505
  2506         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2507             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2508
  2509         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2510             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2511             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2512
  2513         16  FILLER                      PIC X(14).
  2514
  2515     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2516******************************************************************
  2517
  2518     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2519*    COPY ELC631PI.
  2520******************************************************************
  2521*                                                                *
  2522*                                                                *
  2523*                            ELC631PI                            *
  2524*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  49
* EL6311.cbl
  2525*                                                                *
  2526*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2527*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2528*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2529*                                                                *
  2530*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2531*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2532*    BETWEEN PROGRAMS.                                           *
  2533*                                                                *
  2534*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2535*                                                                *
  2536*               EL631 - EL6311 - EL6312 - EL6313                 *
  2537*                                                                *
  2538******************************************************************
  2539*                   C H A N G E   L O G
  2540*
  2541* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2542*-----------------------------------------------------------------
  2543*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2544* EFFECTIVE    NUMBER
  2545*-----------------------------------------------------------------
  2546* 021414    2003053000001  PEMA  changes for auto chk request
  2547******************************************************************
  2548
  2549         16  PI-631-DATA.
  2550             20  PI-ERPNDB-KEY.
  2551                 24  PI-PB-COMPANY-CD     PIC X.
  2552                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2553                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2554                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2555
  2556             20  PI-ERPNDB-ALT-KEY.
  2557                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2558                 24  PI-PB-CARRIER        PIC X.
  2559                 24  PI-PB-GROUPING       PIC X(6).
  2560                 24  PI-PB-STATE          PIC XX.
  2561                 24  PI-PB-ACCOUNT        PIC X(10).
  2562                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2563                 24  PI-PB-CERT-NO.
  2564                     28  PI-PB-CERT-PRIME PIC X(10).
  2565                     28  PI-PB-CERT-SFX   PIC X.
  2566                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2567                 24  PI-PB-RECORD-TYPE    PIC X.
  2568
  2569             20  PI-ERPNDB-CSR-KEY.
  2570                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2571                 24  PI-PB-CSR-ID             PIC X(4).
  2572                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2573                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2574                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2575
  2576             20  PI-BROWSE-TYPE               PIC X.
  2577                 88  PI-FILE-BROWSE             VALUE ' '.
  2578                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2579                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2580                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2581                 88  PI-CSR-BROWSE              VALUE '4'.
  2582
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  50
* EL6311.cbl
  2583             20  PI-MAINT-FUNCTION            PIC X.
  2584                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2585                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2586                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2587                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2588                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2589                 88  PI-PF5-FUNCTION            VALUE '5'.
  2590                 88  PI-PF6-FUNCTION            VALUE '6'.
  2591
  2592             20  PI-FILE-SWITCHES.
  2593                 24  PI-ALL-ISSUES-SW         PIC X.
  2594                     88  ALL-ISSUES             VALUE 'Y'.
  2595                 24  PI-ALL-CANCELS-SW        PIC X.
  2596                     88  ALL-CANCELS            VALUE 'Y'.
  2597                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2598                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2599                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2600                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2601                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2602                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2603                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2604                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2605                 24  PI-HOLD-REC-SW           PIC X.
  2606                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2607                 24  PI-CHANGE-REC-SW         PIC X.
  2608                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2609                 24  PI-CHK-REQ-REC-SW        PIC X.
  2610                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2611                 24  PI-ISSUE-WARNING-SW      PIC X.
  2612                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2613                 24  PI-CANCEL-WARNING-SW     PIC X.
  2614                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2615             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2616                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2617             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2618                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2619
  2620             20  PI-MAP-NAME                  PIC X(8).
  2621
  2622             20  PI-CURSOR                    PIC S9(4) COMP.
  2623
  2624             20  PI-PREV-ALT-KEY              PIC X(36).
  2625             20  PI-PREV-CSR-KEY              PIC X(15).
  2626             20  PI-PREV-KEY.
  2627                 24  PI-PREV-COMPANY-CD       PIC X.
  2628                 24  PI-PREV-BATCH            PIC X(6).
  2629                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2630                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2631             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2632             20  PI-BROWSE-SW                 PIC X.
  2633                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2634                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2635             20  PI-SV-CARRIER                PIC X.
  2636             20  PI-SV-GROUPING               PIC X(6).
  2637             20  PI-SV-STATE                  PIC XX.
  2638             20  PI-EDIT-SW                   PIC X.
  2639             20  PI-DISPLAY-SW                PIC XX.
  2640                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  51
* EL6311.cbl
  2641                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2642             20  PI-CRITERIA-DATA             PIC X(350).
  2643             20  PI-BMODE                     PIC X.
  2644             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2645             20  PI-BPMTS                     PIC S999     COMP-3.
  2646             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2647             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2648             20  PI-CSR-SESSION-SW            PIC X.
  2649                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2650             20  PI-ERRORS-SW                 PIC X.
  2651                 88  FATAL-ERRORS               VALUE 'X'.
  2652*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2653             20  pi-unforced-sw               pic x.
  2654                 88  unforced-errors            value 'X'.
  2655             20  FILLER                       PIC X(4).
  2656
  2657        16  FILLER             PIC X(94).
  2658
  2659 01  W-LETTER-COMMUNICATION-AREAS.
  2660*    COPY ELC1042.
  2661******************************************************************
  2662*                                                                *
  2663*                                                                *
  2664*                           ELC1042                              *
  2665*                            VMOD=2.002                          *
  2666*                                                                *
  2667*    NOTE                                                        *
  2668*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2669*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2670*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2671*        TO THESE PROGRAMS.                                      *
  2672*                                                                *
  2673*    NOTE                                                        *
  2674*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2675*        USE ONLY!                                               *
  2676*                                                                *
  2677******************************************************************
  2678
  2679         16  PI-1042-WA.
  2680             20  PI-ACTION       PIC  X(01).
  2681                 88 PI-SHOW-MODE           VALUE '1'.
  2682                 88 PI-CLEAR-MODE          VALUE '2'.
  2683                 88 PI-CREATE-MODE         VALUE '3'.
  2684             20  PI-COMM-CONTROL PIC  X(12).
  2685             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2686             20  PI-EOF-SW       PIC  X(01).
  2687                 88  PI-FILE-EOF           VALUE 'Y'.
  2688             20  PI-FILETYP      PIC  X(01).
  2689             20  PI-FORM-SQUEEZE-CONTROL
  2690                                 PIC  X(01).
  2691                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2692                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2693             20  PI-LAST-CONTROL PIC  X(12).
  2694             20  PI-TEMP-STOR-ITEMS
  2695                                 PIC S9(04) COMP.
  2696             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2697             20  PI-UPDATE-SW    PIC  9(01).
  2698                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  52
* EL6311.cbl
  2699             20  PI-104-SCREEN-SENT-IND
  2700                                 PIC  X(01).
  2701                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2702                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2703             20  PI-1042-SCREEN-SENT-IND
  2704                                 PIC  X(01).
  2705                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2706                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2707             20  PI-1042-ARCHIVE-IND
  2708                                 PIC  X(01).
  2709                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2710             20  FILLER          PIC  X(29).
  2711*    COPY ELC689PI.
  2712******************************************************************
  2713*                                                                *
  2714*                            ELC689PI                            *
  2715*                            VMOD=2.003                          *
  2716*                                                                *
  2717*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2718*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2719*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2720*                                                                *
  2721*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2722*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2723*    BETWEEN PROGRAMS.                                           *
  2724*                                                                *
  2725*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2726*                                                                *
  2727*               EL631 - EL689  - EL6891 - EL6892                 *
  2728*                                                                *
  2729******************************************************************
  2730*                   C H A N G E   L O G
  2731*
  2732* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2733*-----------------------------------------------------------------
  2734*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2735* EFFECTIVE    NUMBER
  2736*-----------------------------------------------------------------
  2737* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2738* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2739* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2740******************************************************************
  2741
  2742
  2743         16  PI-689-WORK-AREA.
  2744             20  PI-689-ALT-PRINTER-ID
  2745                                 PIC  X(04).
  2746             20  PI-689-ARCHIVE-NUMBER
  2747                                 PIC  9(08).
  2748             20  PI-689-ARCHIVE-SW
  2749                                 PIC  X(01).
  2750                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2751             20  PI-689-DATA-SOURCE
  2752                                 PIC  X(01).
  2753                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2754                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2755                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2756                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  53
* EL6311.cbl
  2757                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2758             20  PI-689-ERROR-IND
  2759                                 PIC  X(01).
  2760                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2761             20  PI-689-ERROR    PIC  9(04).
  2762                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2763                 88  PI-689-FATAL-ERROR
  2764                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2765                            0042 0047 0051 0066 0067 0070
  2766                            0168 0169 0174 0175 0176 0177 0179
  2767                            0180 0181 0182 0184 0185 0189 0190
  2768                            0191
  2769                            0215 0279 0280
  2770                            0412 0413 0454
  2771                            0533 0537
  2772                            2055 2114 2208 2209 2216 2232 2369
  2773                            2398 2433 2908 2999
  2774                            3000 3770 3771 3775
  2775                            7250 7365 7367 7368 7369 7370 7371
  2776                            7272 7373 7374 7376 7377 7378 7379
  2777                            7381 7388 7390 7393 7395 7396 7398
  2778                            9095 9096 9281 9298 9299 9320 9327
  2779                            9426 9427.
  2780                 88  PI-689-STOP-ERROR
  2781                     VALUES 0004 0008 0013 0023 0029 0033
  2782                            0042 0047 0066 0067 0070
  2783                            0168 0169 0174 0175 0176 0177
  2784                            0181 0182 0184 0185 0189 0190
  2785                            0279 0280
  2786                            0412 0413 0454
  2787                            2055 2208 2209 2216 2232
  2788                            2398 2999
  2789                            3000 3770 3771 3775
  2790                            7250 7365 7369 7370 7371
  2791                            7272 7373 7374 7376 7377 7378 7379
  2792                            7381 7388 7390 7393 7396 7398
  2793                            9095 9096 9299 9320 9426.
  2794             20  PI-689-FOLLOW-UP-DATE
  2795                                 PIC  X(02).
  2796             20  PI-689-FORM-NUMBER
  2797                                 PIC  X(04).
  2798             20  PI-689-LABEL-SOURCE
  2799                                 PIC X(01).
  2800                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2801                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2802                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2803                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2804                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2805                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2806                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2807             20  PI-689-NUMBER-COPIES
  2808                                 PIC  9(01).
  2809             20  PI-689-NUMBER-LABEL-LINES
  2810                                 PIC  9(01).
  2811             20  PI-689-NUMBER-TEXT-RECORDS
  2812                                 PIC  9(03).
  2813             20  PI-689-PRINT-ORDER-SW
  2814                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  54
* EL6311.cbl
  2815                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2816                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2817                 88  PI-689-PRINT-LATER     VALUE '3'.
  2818                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2819             20  PI-689-PRINT-RESTRICTION
  2820                                 PIC  X(01).
  2821                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2822                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2823                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2824             20  PI-689-PRINT-SW PIC  X(01).
  2825                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2826             20  PI-689-RESEND-DATE-1
  2827                                 PIC  X(02).
  2828             20  PI-689-RESEND-LETR-1
  2829                                 PIC X(4).
  2830             20  PI-689-TEMP-STOR-ID
  2831                                 PIC  X(08).
  2832             20  PI-689-USE-SCREEN-IND
  2833                                 PIC  X(01).
  2834                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2835             20  PI-689-ARCH-POINTER
  2836                                 PIC S9(08) COMP.
  2837                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2838             20  PI-689-ARCT-POINTER
  2839                                 PIC S9(08) COMP.
  2840                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2841             20  PI-689-VARIABLE-DATA-GRP.
  2842                 24  PI-689-VARIABLE-DATA-1
  2843                                 PIC  X(30).
  2844                 24  PI-689-VARIABLE-DATA-2
  2845                                 PIC  X(30).
  2846                 24  PI-689-VARIABLE-DATA-3
  2847                                 PIC  X(30).
  2848                 24  PI-689-VARIABLE-DATA-4
  2849                                 PIC  X(30).
  2850
  2851         16  PI-689-KEY-DATA-FIELDS.
  2852             20  PI-689-ACCOUNT  PIC  X(10).
  2853             20  PI-689-CARRIER  PIC  X(01).
  2854             20  PI-689-CERT-NO.
  2855                 24  PI-689-CERT-PRIME
  2856                                 PIC  X(10).
  2857                 24  PI-689-CERT-SFX
  2858                                 PIC  X(01).
  2859             20  PI-689-CHG-SEQ-NO
  2860                                 PIC S9(04)    COMP.
  2861             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2862                                 PIC  X(02).
  2863             20  PI-689-ENTRY-BATCH
  2864                                 PIC  X(06).
  2865             20  PI-689-EFF-DATE PIC  X(02).
  2866             20  PI-689-EXP-DATE PIC  X(02).
  2867             20  PI-689-GROUPING PIC  X(06).
  2868             20  PI-689-RESP-PERSON
  2869                                 PIC  X(10).
  2870             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2871             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2872                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  55
* EL6311.cbl
  2873             20  PI-689-STATE    PIC  X(02).
  2874             20  PI-689-TYPE     PIC  X(01).
  2875             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2876             20  PI-689-ALT-SEQ-NO
  2877                                 PIC S9(04)    COMP.
  2878         16  PI-689-DATE-EDIT    PIC  X(08).
  2879         16  PI-689-FOLLOW-UP-EDIT
  2880                                 PIC  X(08).
  2881         16  PI-689-RESEND1-EDIT PIC  X(08).
  2882         16  PI-689-SEQ-EDIT     PIC  X(08).
  2883         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2884         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2885             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2886         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2887         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  56
* EL6311.cbl
  2889
  2890 01  WS-EL6315-PASS-AREA.
  2891        16  PI-6315-ISS-CAN-SW      PIC X.
  2892        16  FILLER                  PIC X(120).
  2893        16  PI-RES-REF-CLM-TYPE     PIC X.
  2894        16  FILLER                  PIC X.
  2895        16  PI-6315-PASS-AREA.
  2896            20 FILLER               PIC X(236).
  2897            20 PI-6315-FINALIZED    PIC X.
  2898            20 FILLER               PIC X(280).
  2899
  2900 01  WS-EL6316-PASS-AREA.
  2901        16  PI-ISS-CAN-SW           PIC X.
  2902        16  FILLER                  PIC X(121).
  2903        16  PI-CLM-RESC-IND         PIC X.
  2904        16  PI-6316-PASS-AREA.
  2905            20 FILLER               PIC X(236).
  2906            20 PI-6316-FINALIZED    PIC X.
  2907            20 FILLER               PIC X(280).
  2908
  2909******************************************************************
  2910*                                                                *
  2911*         P A S S   A R E A   F O R   E D I T                    *
  2912*                                                                *
  2913******************************************************************
  2914
  2915 01  PASSED-RECORD.
  2916     12  RECORD-SAVE                  PIC X(585).
  2917* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2918*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2919*                    BY  WK-CURRENT-DATE.
  2920******************************************************************
  2921*                                                                *
  2922*                                                                *
  2923*                             ELC50W1                            *
  2924*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2925*                            VMOD=2.004                          *
  2926*                                                                *
  2927*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2928*                                                                *
  2929*                                                                *
  2930******************************************************************
  2931
  2932     12  WK-WORK-AREA.
  2933         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2934         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2935         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2936         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2937         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2938         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2939         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2940         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2941         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2942         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2943         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2944         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2945         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2946         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  57
* EL6311.cbl
  2947         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2948         16  WK-CREDIT-EDIT-CONTROLS.
  2949             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2950             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2951             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2952             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2953             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2954             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2955         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2956         16  WK-SAVE-REIN-DATA.
  2957             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2958             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2959             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2960         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2961             88  ENTRY-FROM-EL6311       VALUE '6'.
  2962         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2963         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2964     12  WK-RECORD-ADDRESSES.
  2965         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2966         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2967         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2968         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2969         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2970         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2971         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2972         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2973     12  WK-OVER-SHORT-AREA.
  2974         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2975         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2976         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2977             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2978         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  58
* EL6311.cbl
  2980
  2981*    COPY ELCEDITC.
  2982******************************************************************
  2983*                                                                *
  2984*                                                                *
  2985*                            ELCEDITC                            *
  2986*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2987*                            VMOD=2.012                          *
  2988*                                                                *
  2989*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2990*                     EL6313, EL050 AND EL517.                   *
  2991*                                                                *
  2992******************************************************************
  2993******************************************************************
  2994*                   C H A N G E   L O G
  2995*
  2996* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2997*-----------------------------------------------------------------
  2998*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2999* EFFECTIVE    NUMBER
  3000*-----------------------------------------------------------------
  3001* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3002******************************************************************
  3003
  3004     12  EDIT-CRITERIA-DATA.
  3005         16  EC-CO-MONTH-END-DT       PIC XX.
  3006         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3007         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3008         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3009         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3010         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3011         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3012         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3013         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3014         16  EC-CO-REM-TERM-CALC      PIC X.
  3015               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3016               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3017               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3018               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3019
  3020         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3021               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3022               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3023               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3024               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3025               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3026               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3027               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3028               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3029               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3030               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3031
  3032         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3033               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3034               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3035               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3036               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3037               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  59
* EL6311.cbl
  3038               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3039               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3040               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3041
  3042         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3043                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3044                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3045
  3046         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3047                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3048                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3049                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3050                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3051                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3052                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3053                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3054                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3055
  3056         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3057               88  EC-BR-REDUCING                   VALUE 'R'.
  3058               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3059
  3060         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3061         16  EC-BR-LF-DESC             PIC X(10).
  3062         16  EC-BR-AH-DESC             PIC X(10).
  3063         16  EC-BR-LF-COMMENT          PIC X(10).
  3064         16  EC-BR-AH-COMMENT          PIC X(10).
  3065
  3066         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3067               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3068               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3069               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3070               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3071
  3072         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3073               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3074               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3075               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3076               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3077
  3078         16  EC-BR-LF-REFUND-CALC      PIC X.
  3079                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3080                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3081                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3082                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3083                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3084                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3085                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3086
  3087         16  EC-BR-AH-REFUND-CALC      PIC X.
  3088                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3089                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3090                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3091                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3092                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3093                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3094                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3095                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  60
* EL6311.cbl
  3096
  3097         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3098                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3099                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3100                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3101
  3102         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3103                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3104                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3105                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3106
  3107         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3108         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3109         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3110         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3111
  3112         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3113         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3114                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3115                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3116                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3117                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3118
  3119         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3120               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3121               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3122               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3123               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3124               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3125
  3126         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3127               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3128               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3129               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3130               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3131               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3132
  3133         16  EC-ST-LF-REFUND-CALC      PIC X.
  3134                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3135                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3136                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3137                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3138                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3139                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3140                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3141                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3142
  3143         16  EC-ST-AH-REFUND-CALC      PIC X.
  3144                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3145                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3146                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3147                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3148                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3149                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3150                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3151                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3152
  3153         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  61
* EL6311.cbl
  3154         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3155         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3156         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3157         16  EC-AM-EXPIRATION-DT       PIC XX.
  3158         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3159         16  EC-AM-CLASS-CD            PIC XX.
  3160         16  EC-AM-LF-DEVIATION        PIC XXX.
  3161         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3162         16  EC-AM-AH-DEVIATION        PIC XXX.
  3163         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3164         16  EC-AM-PHONE-NO            PIC X(10).
  3165
  3166         16  EC-AM-LF-REFUND-CALC      PIC X.
  3167                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3168                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3169                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3170                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3171                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3172                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3173                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3174
  3175         16  EC-AM-AH-REFUND-CALC      PIC X.
  3176                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3177                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3178                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3179                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3180                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3181                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3182                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3183
  3184         16  EC-AM-BEN-I-G-CD          PIC X.
  3185                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3186                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3187                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3188
  3189         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3190         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3191         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3192         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3193         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3194         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3195         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3196         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3197         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3198
  3199         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3200         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3201         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3202         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3203         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3204         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3205         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3206         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3207         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3208         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3209         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3210         16  EC-RT-LF-NSP-ST           PIC XX.
  3211         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  62
* EL6311.cbl
  3212         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3213         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3214
  3215         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3216             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3217                                             'M' '5' '9' '2'.
  3218             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3219             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3220             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3221             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3222             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3223             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3224             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3225             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3226             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3227             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3228
  3229         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3230             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3231                                             'M' '5' '9' '2'.
  3232             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3233             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3234             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3235             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3236             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3237             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3238             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3239             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3240             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3241             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3242
  3243         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3244         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3245         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3246         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3247         16  EC-CM-DEATH-DT            PIC XX.
  3248
  3249*DMD CUSTOM CODING FIELDS BELOW
  3250*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3251         16  EC-BR-DMD-RATING-SW       PIC X.
  3252                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3253                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3254                 88  NO-DMD-RATING               VALUE 'N'.
  3255
  3256         16  EC-NEW-CERT               PIC X(11).
  3257         16  EC-NEW-STATE              PIC XX.
  3258         16  FILLER                    PIC X.
  3259*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3260         16  OVER-SHORT-EDIT-FIELDS.
  3261             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3262             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3263             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3264             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3265             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3266             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3267             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3268             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3269             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  63
* EL6311.cbl
  3270         16  FILLER                    PIC X(71).
  3271
  3272******************************************************************
  3273
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  64
* EL6311.cbl
  3275
  3276*    COPY ELCJPFX.
  3277******************************************************************
  3278*                                                                *
  3279*                                                                *
  3280*                            ELCJPFX.                            *
  3281*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3282*                            VMOD=2.002                          *
  3283*                                                                *
  3284*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3285*                                                                *
  3286*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3287*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3288*        ELCNTL - CONTROL FILE                                   *
  3289*        ELMSTR - CLAIM MASTERS                                  *
  3290*        ELTRLR - ACTIVITY TRAILERS                              *
  3291*        ELCHKQ - CHECK QUE                                      *
  3292******************************************************************
  3293 01  JOURNAL-RECORD.
  3294     12  jp-date                     pic s9(5) comp-3.
  3295     12  jp-time                     pic s9(7) comp-3.
  3296     12  JP-USER-ID                  PIC X(4).
  3297     12  JP-FILE-ID                  PIC X(8).
  3298     12  JP-PROGRAM-ID               PIC X(8).
  3299     12  JP-RECORD-TYPE              PIC X.
  3300         88 JP-ADD              VALUE 'A'.
  3301         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3302         88 JP-AFTER-CHANGE     VALUE 'C'.
  3303         88 JP-DELETE           VALUE 'D'.
  3304         88 JP-GENERIC-DELETE   VALUE 'G'.
  3305         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3306         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3307     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3308     12  JP-RECORD-AREA
  3309
  3310
  3311                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  65
* EL6311.cbl
  3313*    COPY ELCAID.
  3314******************************************************************
  3315*                                                                *
  3316*                            ELCAID.                             *
  3317*                            VMOD=2.001                          *
  3318*                                                                *
  3319*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3320*                                                                *
  3321*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3322*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3323******************************************************************
  3324
  3325 01  DFHAID.
  3326   02  DFHNULL   PIC  X  VALUE  ' '.
  3327   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3328   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3329   02  DFHPEN    PIC  X  VALUE  '='.
  3330   02  DFHOPID   PIC  X  VALUE  'W'.
  3331   02  DFHPA1    PIC  X  VALUE  '%'.
  3332   02  DFHPA2    PIC  X  VALUE  '>'.
  3333   02  DFHPA3    PIC  X  VALUE  ','.
  3334   02  DFHPF1    PIC  X  VALUE  '1'.
  3335   02  DFHPF2    PIC  X  VALUE  '2'.
  3336   02  DFHPF3    PIC  X  VALUE  '3'.
  3337   02  DFHPF4    PIC  X  VALUE  '4'.
  3338   02  DFHPF5    PIC  X  VALUE  '5'.
  3339   02  DFHPF6    PIC  X  VALUE  '6'.
  3340   02  DFHPF7    PIC  X  VALUE  '7'.
  3341   02  DFHPF8    PIC  X  VALUE  '8'.
  3342   02  DFHPF9    PIC  X  VALUE  '9'.
  3343   02  DFHPF10   PIC  X  VALUE  ':'.
  3344   02  DFHPF11   PIC  X  VALUE  '#'.
  3345   02  DFHPF12   PIC  X  VALUE  '@'.
  3346   02  DFHPF13   PIC  X  VALUE  'A'.
  3347   02  DFHPF14   PIC  X  VALUE  'B'.
  3348   02  DFHPF15   PIC  X  VALUE  'C'.
  3349   02  DFHPF16   PIC  X  VALUE  'D'.
  3350   02  DFHPF17   PIC  X  VALUE  'E'.
  3351   02  DFHPF18   PIC  X  VALUE  'F'.
  3352   02  DFHPF19   PIC  X  VALUE  'G'.
  3353   02  DFHPF20   PIC  X  VALUE  'H'.
  3354   02  DFHPF21   PIC  X  VALUE  'I'.
  3355*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3356   02  DFHPF22   PIC  X  VALUE  '['.
  3357   02  DFHPF23   PIC  X  VALUE  '.'.
  3358   02  DFHPF24   PIC  X  VALUE  '<'.
  3359   02  DFHMSRE   PIC  X  VALUE  'X'.
  3360   02  DFHSTRF   PIC  X  VALUE  'h'.
  3361   02  DFHTRIG   PIC  X  VALUE  '"'.
  3362
  3363 01  FILLER    REDEFINES DFHAID.
  3364     12  FILLER              PIC X(8).
  3365     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3366
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  66
* EL6311.cbl
  3368*    COPY EL6311S.
  3369 01  EL631BI.
  3370     05  FILLER            PIC  X(0012).
  3371*    -------------------------------
  3372     05  BDATEL PIC S9(0004) COMP.
  3373     05  BDATEF PIC  X(0001).
  3374     05  FILLER REDEFINES BDATEF.
  3375         10  BDATEA PIC  X(0001).
  3376     05  BDATEI PIC  X(0008).
  3377*    -------------------------------
  3378     05  BTIMEL PIC S9(0004) COMP.
  3379     05  BTIMEF PIC  X(0001).
  3380     05  FILLER REDEFINES BTIMEF.
  3381         10  BTIMEA PIC  X(0001).
  3382     05  BTIMEI PIC  X(0005).
  3383*    -------------------------------
  3384     05  BHEADL PIC S9(0004) COMP.
  3385     05  BHEADF PIC  X(0001).
  3386     05  FILLER REDEFINES BHEADF.
  3387         10  BHEADA PIC  X(0001).
  3388     05  BHEADI PIC  X(0038).
  3389*    -------------------------------
  3390     05  BNCERTLL PIC S9(0004) COMP.
  3391     05  BNCERTLF PIC  X(0001).
  3392     05  FILLER REDEFINES BNCERTLF.
  3393         10  BNCERTLA PIC  X(0001).
  3394     05  BNCERTLI PIC  X(0008).
  3395*    -------------------------------
  3396     05  BNCERTL PIC S9(0004) COMP.
  3397     05  BNCERTF PIC  X(0001).
  3398     05  FILLER REDEFINES BNCERTF.
  3399         10  BNCERTA PIC  X(0001).
  3400     05  BNCERTI PIC  X(0011).
  3401*    -------------------------------
  3402     05  BNSTATLL PIC S9(0004) COMP.
  3403     05  BNSTATLF PIC  X(0001).
  3404     05  FILLER REDEFINES BNSTATLF.
  3405         10  BNSTATLA PIC  X(0001).
  3406     05  BNSTATLI PIC  X(0009).
  3407*    -------------------------------
  3408     05  BNSTATL PIC S9(0004) COMP.
  3409     05  BNSTATF PIC  X(0001).
  3410     05  FILLER REDEFINES BNSTATF.
  3411         10  BNSTATA PIC  X(0001).
  3412     05  BNSTATI PIC  X(0002).
  3413*    -------------------------------
  3414     05  BCHGTL PIC S9(0004) COMP.
  3415     05  BCHGTF PIC  X(0001).
  3416     05  FILLER REDEFINES BCHGTF.
  3417         10  BCHGTA PIC  X(0001).
  3418     05  BCHGTI PIC  X(0004).
  3419*    -------------------------------
  3420     05  BCHGL PIC S9(0004) COMP.
  3421     05  BCHGF PIC  X(0001).
  3422     05  FILLER REDEFINES BCHGF.
  3423         10  BCHGA PIC  X(0001).
  3424     05  BCHGI PIC  X(0004).
  3425*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  67
* EL6311.cbl
  3426     05  BMAINTL PIC S9(0004) COMP.
  3427     05  BMAINTF PIC  X(0001).
  3428     05  FILLER REDEFINES BMAINTF.
  3429         10  BMAINTA PIC  X(0001).
  3430     05  BMAINTI PIC  X(0001).
  3431*    -------------------------------
  3432     05  BMANTBYL PIC S9(0004) COMP.
  3433     05  BMANTBYF PIC  X(0001).
  3434     05  FILLER REDEFINES BMANTBYF.
  3435         10  BMANTBYA PIC  X(0001).
  3436     05  BMANTBYI PIC  X(0004).
  3437*    -------------------------------
  3438     05  BCHGHDGL PIC S9(0004) COMP.
  3439     05  BCHGHDGF PIC  X(0001).
  3440     05  FILLER REDEFINES BCHGHDGF.
  3441         10  BCHGHDGA PIC  X(0001).
  3442     05  BCHGHDGI PIC  X(0003).
  3443*    -------------------------------
  3444     05  BMANTDTL PIC S9(0004) COMP.
  3445     05  BMANTDTF PIC  X(0001).
  3446     05  FILLER REDEFINES BMANTDTF.
  3447         10  BMANTDTA PIC  X(0001).
  3448     05  BMANTDTI PIC  X(0008).
  3449*    -------------------------------
  3450     05  BMANTATL PIC S9(0004) COMP.
  3451     05  BMANTATF PIC  X(0001).
  3452     05  FILLER REDEFINES BMANTATF.
  3453         10  BMANTATA PIC  X(0001).
  3454     05  BMANTATI PIC  X(0005).
  3455*    -------------------------------
  3456     05  BCSRL PIC S9(0004) COMP.
  3457     05  BCSRF PIC  X(0001).
  3458     05  FILLER REDEFINES BCSRF.
  3459         10  BCSRA PIC  X(0001).
  3460     05  BCSRI PIC  X(0004).
  3461*    -------------------------------
  3462     05  BBATCHL PIC S9(0004) COMP.
  3463     05  BBATCHF PIC  X(0001).
  3464     05  FILLER REDEFINES BBATCHF.
  3465         10  BBATCHA PIC  X(0001).
  3466     05  BBATCHI PIC  X(0006).
  3467*    -------------------------------
  3468     05  BSEQL PIC S9(0004) COMP.
  3469     05  BSEQF PIC  X(0001).
  3470     05  FILLER REDEFINES BSEQF.
  3471         10  BSEQA PIC  X(0001).
  3472     05  BSEQI PIC  X(0004).
  3473*    -------------------------------
  3474     05  BMOENDTL PIC S9(0004) COMP.
  3475     05  BMOENDTF PIC  X(0001).
  3476     05  FILLER REDEFINES BMOENDTF.
  3477         10  BMOENDTA PIC  X(0001).
  3478     05  BMOENDTI PIC  X(0008).
  3479*    -------------------------------
  3480     05  BCARRL PIC S9(0004) COMP.
  3481     05  BCARRF PIC  X(0001).
  3482     05  FILLER REDEFINES BCARRF.
  3483         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  68
* EL6311.cbl
  3484     05  BCARRI PIC  X(0001).
  3485*    -------------------------------
  3486     05  BGROUPL PIC S9(0004) COMP.
  3487     05  BGROUPF PIC  X(0001).
  3488     05  FILLER REDEFINES BGROUPF.
  3489         10  BGROUPA PIC  X(0001).
  3490     05  BGROUPI PIC  X(0006).
  3491*    -------------------------------
  3492     05  BSTATEL PIC S9(0004) COMP.
  3493     05  BSTATEF PIC  X(0001).
  3494     05  FILLER REDEFINES BSTATEF.
  3495         10  BSTATEA PIC  X(0001).
  3496     05  BSTATEI PIC  X(0002).
  3497*    -------------------------------
  3498     05  BACCTL PIC S9(0004) COMP.
  3499     05  BACCTF PIC  X(0001).
  3500     05  FILLER REDEFINES BACCTF.
  3501         10  BACCTA PIC  X(0001).
  3502     05  BACCTI PIC  X(0010).
  3503*    -------------------------------
  3504     05  BVINHL PIC S9(0004) COMP.
  3505     05  BVINHF PIC  X(0001).
  3506     05  FILLER REDEFINES BVINHF.
  3507         10  BVINHA PIC  X(0001).
  3508     05  BVINHI PIC  X(0004).
  3509*    -------------------------------
  3510     05  BVINL PIC S9(0004) COMP.
  3511     05  BVINF PIC  X(0001).
  3512     05  FILLER REDEFINES BVINF.
  3513         10  BVINA PIC  X(0001).
  3514     05  BVINI PIC  X(0017).
  3515*    -------------------------------
  3516     05  BREFHDGL PIC S9(0004) COMP.
  3517     05  BREFHDGF PIC  X(0001).
  3518     05  FILLER REDEFINES BREFHDGF.
  3519         10  BREFHDGA PIC  X(0001).
  3520     05  BREFHDGI PIC  X(0004).
  3521*    -------------------------------
  3522     05  BREFL PIC S9(0004) COMP.
  3523     05  BREFF PIC  X(0001).
  3524     05  FILLER REDEFINES BREFF.
  3525         10  BREFA PIC  X(0001).
  3526     05  BREFI PIC  X(0012).
  3527*    -------------------------------
  3528     05  BAGEDEFL PIC S9(0004) COMP.
  3529     05  BAGEDEFF PIC  X(0001).
  3530     05  FILLER REDEFINES BAGEDEFF.
  3531         10  BAGEDEFA PIC  X(0001).
  3532     05  BAGEDEFI PIC  X(0004).
  3533*    -------------------------------
  3534     05  BCERTNOL PIC S9(0004) COMP.
  3535     05  BCERTNOF PIC  X(0001).
  3536     05  FILLER REDEFINES BCERTNOF.
  3537         10  BCERTNOA PIC  X(0001).
  3538     05  BCERTNOI PIC  X(0010).
  3539*    -------------------------------
  3540     05  BSUFIXL PIC S9(0004) COMP.
  3541     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  69
* EL6311.cbl
  3542     05  FILLER REDEFINES BSUFIXF.
  3543         10  BSUFIXA PIC  X(0001).
  3544     05  BSUFIXI PIC  X(0001).
  3545*    -------------------------------
  3546     05  BEFFDTL PIC S9(0004) COMP.
  3547     05  BEFFDTF PIC  X(0001).
  3548     05  FILLER REDEFINES BEFFDTF.
  3549         10  BEFFDTA PIC  X(0001).
  3550     05  BEFFDTI PIC  X(0008).
  3551*    -------------------------------
  3552     05  BLSTNML PIC S9(0004) COMP.
  3553     05  BLSTNMF PIC  X(0001).
  3554     05  FILLER REDEFINES BLSTNMF.
  3555         10  BLSTNMA PIC  X(0001).
  3556     05  BLSTNMI PIC  X(0015).
  3557*    -------------------------------
  3558     05  B1STNML PIC S9(0004) COMP.
  3559     05  B1STNMF PIC  X(0001).
  3560     05  FILLER REDEFINES B1STNMF.
  3561         10  B1STNMA PIC  X(0001).
  3562     05  B1STNMI PIC  X(0010).
  3563*    -------------------------------
  3564     05  BINITL PIC S9(0004) COMP.
  3565     05  BINITF PIC  X(0001).
  3566     05  FILLER REDEFINES BINITF.
  3567         10  BINITA PIC  X(0001).
  3568     05  BINITI PIC  X(0001).
  3569*    -------------------------------
  3570     05  BSEXL PIC S9(0004) COMP.
  3571     05  BSEXF PIC  X(0001).
  3572     05  FILLER REDEFINES BSEXF.
  3573         10  BSEXA PIC  X(0001).
  3574     05  BSEXI PIC  X(0001).
  3575*    -------------------------------
  3576     05  BAGEL PIC S9(0004) COMP.
  3577     05  BAGEF PIC  X(0001).
  3578     05  FILLER REDEFINES BAGEF.
  3579         10  BAGEA PIC  X(0001).
  3580     05  BAGEI PIC  X(0002).
  3581*    -------------------------------
  3582     05  BBIRTHL PIC S9(0004) COMP.
  3583     05  BBIRTHF PIC  X(0001).
  3584     05  FILLER REDEFINES BBIRTHF.
  3585         10  BBIRTHA PIC  X(0001).
  3586     05  BBIRTHI PIC  X(0008).
  3587*    -------------------------------
  3588     05  B1STPMTL PIC S9(0004) COMP.
  3589     05  B1STPMTF PIC  X(0001).
  3590     05  FILLER REDEFINES B1STPMTF.
  3591         10  B1STPMTA PIC  X(0001).
  3592     05  B1STPMTI PIC  X(0008).
  3593*    -------------------------------
  3594     05  BDAYSL PIC S9(0004) COMP.
  3595     05  BDAYSF PIC  X(0001).
  3596     05  FILLER REDEFINES BDAYSF.
  3597         10  BDAYSA PIC  X(0001).
  3598     05  BDAYSI PIC  X(0003).
  3599*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  70
* EL6311.cbl
  3600     05  BLNTRML PIC S9(0004) COMP.
  3601     05  BLNTRMF PIC  X(0001).
  3602     05  FILLER REDEFINES BLNTRMF.
  3603         10  BLNTRMA PIC  X(0001).
  3604     05  BLNTRMI PIC  X(0003).
  3605*    -------------------------------
  3606     05  BLNOFCRL PIC S9(0004) COMP.
  3607     05  BLNOFCRF PIC  X(0001).
  3608     05  FILLER REDEFINES BLNOFCRF.
  3609         10  BLNOFCRA PIC  X(0001).
  3610     05  BLNOFCRI PIC  X(0005).
  3611*    -------------------------------
  3612     05  BMODEL PIC S9(0004) COMP.
  3613     05  BMODEF PIC  X(0001).
  3614     05  FILLER REDEFINES BMODEF.
  3615         10  BMODEA PIC  X(0001).
  3616     05  BMODEI PIC  X(0001).
  3617*    -------------------------------
  3618     05  BFREQL PIC S9(0004) COMP.
  3619     05  BFREQF PIC  X(0001).
  3620     05  FILLER REDEFINES BFREQF.
  3621         10  BFREQA PIC  X(0001).
  3622     05  BFREQI PIC  X(0002).
  3623*    -------------------------------
  3624     05  BPMTSL PIC S9(0004) COMP.
  3625     05  BPMTSF PIC  X(0001).
  3626     05  FILLER REDEFINES BPMTSF.
  3627         10  BPMTSA PIC  X(0001).
  3628     05  BPMTSI PIC  999.
  3629*    -------------------------------
  3630     05  BPMTAMTL PIC S9(0004) COMP.
  3631     05  BPMTAMTF PIC  X(0001).
  3632     05  FILLER REDEFINES BPMTAMTF.
  3633         10  BPMTAMTA PIC  X(0001).
  3634     05  BPMTAMTI PIC  9(7)V99.
  3635*    -------------------------------
  3636     05  BAPRL PIC S9(0004) COMP.
  3637     05  BAPRF PIC  X(0001).
  3638     05  FILLER REDEFINES BAPRF.
  3639         10  BAPRA PIC  X(0001).
  3640     05  BAPRI PIC  X(7).
  3641*    -------------------------------
  3642     05  BLIVESL PIC S9(0004) COMP.
  3643     05  BLIVESF PIC  X(0001).
  3644     05  FILLER REDEFINES BLIVESF.
  3645         10  BLIVESA PIC  X(0001).
  3646     05  BLIVESI PIC  X(0009).
  3647*    -------------------------------
  3648     05  BMEMCAPL PIC S9(0004) COMP.
  3649     05  BMEMCAPF PIC  X(0001).
  3650     05  FILLER REDEFINES BMEMCAPF.
  3651         10  BMEMCAPA PIC  X(0001).
  3652     05  BMEMCAPI PIC  X(0011).
  3653*    -------------------------------
  3654     05  BORIGHDL PIC S9(0004) COMP.
  3655     05  BORIGHDF PIC  X(0001).
  3656     05  FILLER REDEFINES BORIGHDF.
  3657         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  71
* EL6311.cbl
  3658     05  BORIGHDI PIC  X(0009).
  3659*    -------------------------------
  3660     05  DMDBILL PIC S9(0004) COMP.
  3661     05  DMDBILF PIC  X(0001).
  3662     05  FILLER REDEFINES DMDBILF.
  3663         10  DMDBILA PIC  X(0001).
  3664     05  DMDBILI PIC  X(0006).
  3665*    -------------------------------
  3666     05  BFORCEL PIC S9(0004) COMP.
  3667     05  BFORCEF PIC  X(0001).
  3668     05  FILLER REDEFINES BFORCEF.
  3669         10  BFORCEA PIC  X(0001).
  3670     05  BFORCEI PIC  X(0001).
  3671*    -------------------------------
  3672     05  BENTRYL PIC S9(0004) COMP.
  3673     05  BENTRYF PIC  X(0001).
  3674     05  FILLER REDEFINES BENTRYF.
  3675         10  BENTRYA PIC  X(0001).
  3676     05  BENTRYI PIC  X(0001).
  3677*    -------------------------------
  3678     05  BREINL PIC S9(0004) COMP.
  3679     05  BREINF PIC  X(0001).
  3680     05  FILLER REDEFINES BREINF.
  3681         10  BREINA PIC  X(0001).
  3682     05  BREINI PIC  X(0001).
  3683*    -------------------------------
  3684     05  BBILCDL PIC S9(0004) COMP.
  3685     05  BBILCDF PIC  X(0001).
  3686     05  FILLER REDEFINES BBILCDF.
  3687         10  BBILCDA PIC  X(0001).
  3688     05  BBILCDI PIC  X(0001).
  3689*    -------------------------------
  3690     05  BUNWRITL PIC S9(0004) COMP.
  3691     05  BUNWRITF PIC  X(0001).
  3692     05  FILLER REDEFINES BUNWRITF.
  3693         10  BUNWRITA PIC  X(0001).
  3694     05  BUNWRITI PIC  X(0001).
  3695*    -------------------------------
  3696     05  BSKPCDL PIC S9(0004) COMP.
  3697     05  BSKPCDF PIC  X(0001).
  3698     05  FILLER REDEFINES BSKPCDF.
  3699         10  BSKPCDA PIC  X(0001).
  3700     05  BSKPCDI PIC  X(0001).
  3701*    -------------------------------
  3702     05  BINDGRPL PIC S9(0004) COMP.
  3703     05  BINDGRPF PIC  X(0001).
  3704     05  FILLER REDEFINES BINDGRPF.
  3705         10  BINDGRPA PIC  X(0001).
  3706     05  BINDGRPI PIC  X(0001).
  3707*    -------------------------------
  3708     05  BSIGL PIC S9(0004) COMP.
  3709     05  BSIGF PIC  X(0001).
  3710     05  FILLER REDEFINES BSIGF.
  3711         10  BSIGA PIC  X(0001).
  3712     05  BSIGI PIC  X(0001).
  3713*    -------------------------------
  3714     05  BRTCLSL PIC S9(0004) COMP.
  3715     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  72
* EL6311.cbl
  3716     05  FILLER REDEFINES BRTCLSF.
  3717         10  BRTCLSA PIC  X(0001).
  3718     05  BRTCLSI PIC  X(0002).
  3719*    -------------------------------
  3720     05  BCHGCNTL PIC S9(0004) COMP.
  3721     05  BCHGCNTF PIC  X(0001).
  3722     05  FILLER REDEFINES BCHGCNTF.
  3723         10  BCHGCNTA PIC  X(0001).
  3724     05  BCHGCNTI PIC  X(0003).
  3725*    -------------------------------
  3726     05  BMEMBERL PIC S9(0004) COMP.
  3727     05  BMEMBERF PIC  X(0001).
  3728     05  FILLER REDEFINES BMEMBERF.
  3729         10  BMEMBERA PIC  X(0001).
  3730     05  BMEMBERI PIC  X(0012).
  3731*    -------------------------------
  3732     05  BORGNOL PIC S9(0004) COMP.
  3733     05  BORGNOF PIC  X(0001).
  3734     05  FILLER REDEFINES BORGNOF.
  3735         10  BORGNOA PIC  X(0001).
  3736     05  BORGNOI PIC  X(0006).
  3737*    -------------------------------
  3738     05  BORGSEQL PIC S9(0004) COMP.
  3739     05  BORGSEQF PIC  X(0001).
  3740     05  FILLER REDEFINES BORGSEQF.
  3741         10  BORGSEQA PIC  X(0001).
  3742     05  BORGSEQI PIC  X(0004).
  3743*    -------------------------------
  3744     05  BBILLEDL PIC S9(0004) COMP.
  3745     05  BBILLEDF PIC  X(0001).
  3746     05  FILLER REDEFINES BBILLEDF.
  3747         10  BBILLEDA PIC  X(0001).
  3748     05  BBILLEDI PIC  9(9).
  3749*    -------------------------------
  3750     05  BKIND1L PIC S9(0004) COMP.
  3751     05  BKIND1F PIC  X(0001).
  3752     05  FILLER REDEFINES BKIND1F.
  3753         10  BKIND1A PIC  X(0001).
  3754     05  BKIND1I PIC  X(0002).
  3755*    -------------------------------
  3756     05  BTYPE1L PIC S9(0004) COMP.
  3757     05  BTYPE1F PIC  X(0001).
  3758     05  FILLER REDEFINES BTYPE1F.
  3759         10  BTYPE1A PIC  X(0001).
  3760     05  BTYPE1I PIC  X(0003).
  3761*    -------------------------------
  3762     05  BTERM1L PIC S9(0004) COMP.
  3763     05  BTERM1F PIC  X(0001).
  3764     05  FILLER REDEFINES BTERM1F.
  3765         10  BTERM1A PIC  X(0001).
  3766     05  BTERM1I PIC  X(0003).
  3767*    -------------------------------
  3768     05  BBEN1L PIC S9(0004) COMP.
  3769     05  BBEN1F PIC  X(0001).
  3770     05  FILLER REDEFINES BBEN1F.
  3771         10  BBEN1A PIC  X(0001).
  3772     05  BBEN1I PIC  X(0012).
  3773*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  73
* EL6311.cbl
  3774     05  BPREM1L PIC S9(0004) COMP.
  3775     05  BPREM1F PIC  X(0001).
  3776     05  FILLER REDEFINES BPREM1F.
  3777         10  BPREM1A PIC  X(0001).
  3778     05  BPREM1I PIC  X(0011).
  3779*    -------------------------------
  3780     05  BEXPIR1L PIC S9(0004) COMP.
  3781     05  BEXPIR1F PIC  X(0001).
  3782     05  FILLER REDEFINES BEXPIR1F.
  3783         10  BEXPIR1A PIC  X(0001).
  3784     05  BEXPIR1I PIC  X(0008).
  3785*    -------------------------------
  3786     05  BCP1L PIC S9(0004) COMP.
  3787     05  BCP1F PIC  X(0001).
  3788     05  FILLER REDEFINES BCP1F.
  3789         10  BCP1A PIC  X(0001).
  3790     05  BCP1I PIC  X(0002).
  3791*    -------------------------------
  3792     05  BALTBN1L PIC S9(0004) COMP.
  3793     05  BALTBN1F PIC  X(0001).
  3794     05  FILLER REDEFINES BALTBN1F.
  3795         10  BALTBN1A PIC  X(0001).
  3796     05  BALTBN1I PIC  X(0012).
  3797*    -------------------------------
  3798     05  BALTPR1L PIC S9(0004) COMP.
  3799     05  BALTPR1F PIC  X(0001).
  3800     05  FILLER REDEFINES BALTPR1F.
  3801         10  BALTPR1A PIC  X(0001).
  3802     05  BALTPR1I PIC  X(0011).
  3803*    -------------------------------
  3804     05  BBNCD1L PIC S9(0004) COMP.
  3805     05  BBNCD1F PIC  X(0001).
  3806     05  FILLER REDEFINES BBNCD1F.
  3807         10  BBNCD1A PIC  X(0001).
  3808     05  BBNCD1I PIC  X(0003).
  3809*    -------------------------------
  3810     05  BCPRM1L PIC S9(0004) COMP.
  3811     05  BCPRM1F PIC  X(0001).
  3812     05  FILLER REDEFINES BCPRM1F.
  3813         10  BCPRM1A PIC  X(0001).
  3814     05  BCPRM1I PIC  X(0011).
  3815*    -------------------------------
  3816     05  BCAPRM1L PIC S9(0004) COMP.
  3817     05  BCAPRM1F PIC  X(0001).
  3818     05  FILLER REDEFINES BCAPRM1F.
  3819         10  BCAPRM1A PIC  X(0001).
  3820     05  BCAPRM1I PIC  X(0011).
  3821*    -------------------------------
  3822     05  BENABR1L PIC S9(0004) COMP.
  3823     05  BENABR1F PIC  X(0001).
  3824     05  FILLER REDEFINES BENABR1F.
  3825         10  BENABR1A PIC  X(0001).
  3826     05  BENABR1I PIC  X(0005).
  3827*    -------------------------------
  3828     05  BDIFF1L PIC S9(0004) COMP.
  3829     05  BDIFF1F PIC  X(0001).
  3830     05  FILLER REDEFINES BDIFF1F.
  3831         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  74
* EL6311.cbl
  3832     05  BDIFF1I PIC  X(0011).
  3833*    -------------------------------
  3834     05  BBILIT1L PIC S9(0004) COMP.
  3835     05  BBILIT1F PIC  X(0001).
  3836     05  FILLER REDEFINES BBILIT1F.
  3837         10  BBILIT1A PIC  X(0001).
  3838     05  BBILIT1I PIC  X(0008).
  3839*    -------------------------------
  3840     05  BADIFF1L PIC S9(0004) COMP.
  3841     05  BADIFF1F PIC  X(0001).
  3842     05  FILLER REDEFINES BADIFF1F.
  3843         10  BADIFF1A PIC  X(0001).
  3844     05  BADIFF1I PIC  X(0011).
  3845*    -------------------------------
  3846     05  BKIND2L PIC S9(0004) COMP.
  3847     05  BKIND2F PIC  X(0001).
  3848     05  FILLER REDEFINES BKIND2F.
  3849         10  BKIND2A PIC  X(0001).
  3850     05  BKIND2I PIC  X(0002).
  3851*    -------------------------------
  3852     05  BTYPE2L PIC S9(0004) COMP.
  3853     05  BTYPE2F PIC  X(0001).
  3854     05  FILLER REDEFINES BTYPE2F.
  3855         10  BTYPE2A PIC  X(0001).
  3856     05  BTYPE2I PIC  X(0003).
  3857*    -------------------------------
  3858     05  BTERM2L PIC S9(0004) COMP.
  3859     05  BTERM2F PIC  X(0001).
  3860     05  FILLER REDEFINES BTERM2F.
  3861         10  BTERM2A PIC  X(0001).
  3862     05  BTERM2I PIC  X(0003).
  3863*    -------------------------------
  3864     05  BBEN2L PIC S9(0004) COMP.
  3865     05  BBEN2F PIC  X(0001).
  3866     05  FILLER REDEFINES BBEN2F.
  3867         10  BBEN2A PIC  X(0001).
  3868     05  BBEN2I PIC  X(0012).
  3869*    -------------------------------
  3870     05  BPREM2L PIC S9(0004) COMP.
  3871     05  BPREM2F PIC  X(0001).
  3872     05  FILLER REDEFINES BPREM2F.
  3873         10  BPREM2A PIC  X(0001).
  3874     05  BPREM2I PIC  X(0011).
  3875*    -------------------------------
  3876     05  BEXPIR2L PIC S9(0004) COMP.
  3877     05  BEXPIR2F PIC  X(0001).
  3878     05  FILLER REDEFINES BEXPIR2F.
  3879         10  BEXPIR2A PIC  X(0001).
  3880     05  BEXPIR2I PIC  X(0008).
  3881*    -------------------------------
  3882     05  BCP2L PIC S9(0004) COMP.
  3883     05  BCP2F PIC  X(0001).
  3884     05  FILLER REDEFINES BCP2F.
  3885         10  BCP2A PIC  X(0001).
  3886     05  BCP2I PIC  X(0002).
  3887*    -------------------------------
  3888     05  BALTBN2L PIC S9(0004) COMP.
  3889     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  75
* EL6311.cbl
  3890     05  FILLER REDEFINES BALTBN2F.
  3891         10  BALTBN2A PIC  X(0001).
  3892     05  BALTBN2I PIC  X(0012).
  3893*    -------------------------------
  3894     05  BALTPR2L PIC S9(0004) COMP.
  3895     05  BALTPR2F PIC  X(0001).
  3896     05  FILLER REDEFINES BALTPR2F.
  3897         10  BALTPR2A PIC  X(0001).
  3898     05  BALTPR2I PIC  X(0011).
  3899*    -------------------------------
  3900     05  BBNCD2L PIC S9(0004) COMP.
  3901     05  BBNCD2F PIC  X(0001).
  3902     05  FILLER REDEFINES BBNCD2F.
  3903         10  BBNCD2A PIC  X(0001).
  3904     05  BBNCD2I PIC  X(0003).
  3905*    -------------------------------
  3906     05  BCPRM2L PIC S9(0004) COMP.
  3907     05  BCPRM2F PIC  X(0001).
  3908     05  FILLER REDEFINES BCPRM2F.
  3909         10  BCPRM2A PIC  X(0001).
  3910     05  BCPRM2I PIC  X(0011).
  3911*    -------------------------------
  3912     05  BCAPRM2L PIC S9(0004) COMP.
  3913     05  BCAPRM2F PIC  X(0001).
  3914     05  FILLER REDEFINES BCAPRM2F.
  3915         10  BCAPRM2A PIC  X(0001).
  3916     05  BCAPRM2I PIC  X(0011).
  3917*    -------------------------------
  3918     05  BENABR2L PIC S9(0004) COMP.
  3919     05  BENABR2F PIC  X(0001).
  3920     05  FILLER REDEFINES BENABR2F.
  3921         10  BENABR2A PIC  X(0001).
  3922     05  BENABR2I PIC  X(0005).
  3923*    -------------------------------
  3924     05  BDIFF2L PIC S9(0004) COMP.
  3925     05  BDIFF2F PIC  X(0001).
  3926     05  FILLER REDEFINES BDIFF2F.
  3927         10  BDIFF2A PIC  X(0001).
  3928     05  BDIFF2I PIC  X(0011).
  3929*    -------------------------------
  3930     05  BBILIT2L PIC S9(0004) COMP.
  3931     05  BBILIT2F PIC  X(0001).
  3932     05  FILLER REDEFINES BBILIT2F.
  3933         10  BBILIT2A PIC  X(0001).
  3934     05  BBILIT2I PIC  X(0008).
  3935*    -------------------------------
  3936     05  BADIFF2L PIC S9(0004) COMP.
  3937     05  BADIFF2F PIC  X(0001).
  3938     05  FILLER REDEFINES BADIFF2F.
  3939         10  BADIFF2A PIC  X(0001).
  3940     05  BADIFF2I PIC  X(0011).
  3941*    -------------------------------
  3942     05  BERMSG1L PIC S9(0004) COMP.
  3943     05  BERMSG1F PIC  X(0001).
  3944     05  FILLER REDEFINES BERMSG1F.
  3945         10  BERMSG1A PIC  X(0001).
  3946     05  BERMSG1I PIC  X(0078).
  3947*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  76
* EL6311.cbl
  3948     05  BERMSG2L PIC S9(0004) COMP.
  3949     05  BERMSG2F PIC  X(0001).
  3950     05  FILLER REDEFINES BERMSG2F.
  3951         10  BERMSG2A PIC  X(0001).
  3952     05  BERMSG2I PIC  X(0078).
  3953*    -------------------------------
  3954     05  BERMSG3L PIC S9(0004) COMP.
  3955     05  BERMSG3F PIC  X(0001).
  3956     05  FILLER REDEFINES BERMSG3F.
  3957         10  BERMSG3A PIC  X(0001).
  3958     05  BERMSG3I PIC  X(0078).
  3959*    -------------------------------
  3960     05  BPFENTRL PIC S9(0004) COMP.
  3961     05  BPFENTRF PIC  X(0001).
  3962     05  FILLER REDEFINES BPFENTRF.
  3963         10  BPFENTRA PIC  X(0001).
  3964     05  BPFENTRI PIC  9(2).
  3965*    -------------------------------
  3966     05  BPF5HDRL PIC S9(0004) COMP.
  3967     05  BPF5HDRF PIC  X(0001).
  3968     05  FILLER REDEFINES BPF5HDRF.
  3969         10  BPF5HDRA PIC  X(0001).
  3970     05  BPF5HDRI PIC  X(0005).
  3971*    -------------------------------
  3972     05  BPF4HDRL PIC S9(0004) COMP.
  3973     05  BPF4HDRF PIC  X(0001).
  3974     05  FILLER REDEFINES BPF4HDRF.
  3975         10  BPF4HDRA PIC  X(0001).
  3976     05  BPF4HDRI PIC  X(0013).
  3977*    -------------------------------
  3978     05  BF15HDRL PIC S9(0004) COMP.
  3979     05  BF15HDRF PIC  X(0001).
  3980     05  FILLER REDEFINES BF15HDRF.
  3981         10  BF15HDRA PIC  X(0001).
  3982     05  BF15HDRI PIC  X(0010).
  3983 01  EL631BO REDEFINES EL631BI.
  3984     05  FILLER            PIC  X(0012).
  3985*    -------------------------------
  3986     05  FILLER            PIC  X(0003).
  3987     05  BDATEO PIC  X(0008).
  3988*    -------------------------------
  3989     05  FILLER            PIC  X(0003).
  3990     05  BTIMEO PIC  99.99.
  3991*    -------------------------------
  3992     05  FILLER            PIC  X(0003).
  3993     05  BHEADO PIC  X(0038).
  3994*    -------------------------------
  3995     05  FILLER            PIC  X(0003).
  3996     05  BNCERTLO PIC  X(0008).
  3997*    -------------------------------
  3998     05  FILLER            PIC  X(0003).
  3999     05  BNCERTO PIC  X(0011).
  4000*    -------------------------------
  4001     05  FILLER            PIC  X(0003).
  4002     05  BNSTATLO PIC  X(0009).
  4003*    -------------------------------
  4004     05  FILLER            PIC  X(0003).
  4005     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  77
* EL6311.cbl
  4006*    -------------------------------
  4007     05  FILLER            PIC  X(0003).
  4008     05  BCHGTO PIC  X(0004).
  4009*    -------------------------------
  4010     05  FILLER            PIC  X(0003).
  4011     05  BCHGO PIC  ZZZ9.
  4012*    -------------------------------
  4013     05  FILLER            PIC  X(0003).
  4014     05  BMAINTO PIC  X(0001).
  4015*    -------------------------------
  4016     05  FILLER            PIC  X(0003).
  4017     05  BMANTBYO PIC  X(0004).
  4018*    -------------------------------
  4019     05  FILLER            PIC  X(0003).
  4020     05  BCHGHDGO PIC  X(0003).
  4021*    -------------------------------
  4022     05  FILLER            PIC  X(0003).
  4023     05  BMANTDTO PIC  X(0008).
  4024*    -------------------------------
  4025     05  FILLER            PIC  X(0003).
  4026     05  BMANTATO PIC  99.99.
  4027*    -------------------------------
  4028     05  FILLER            PIC  X(0003).
  4029     05  BCSRO PIC  X(0004).
  4030*    -------------------------------
  4031     05  FILLER            PIC  X(0003).
  4032     05  BBATCHO PIC  X(0006).
  4033*    -------------------------------
  4034     05  FILLER            PIC  X(0003).
  4035     05  BSEQO PIC  X(0004).
  4036*    -------------------------------
  4037     05  FILLER            PIC  X(0003).
  4038     05  BMOENDTO PIC  X(0008).
  4039*    -------------------------------
  4040     05  FILLER            PIC  X(0003).
  4041     05  BCARRO PIC  X(0001).
  4042*    -------------------------------
  4043     05  FILLER            PIC  X(0003).
  4044     05  BGROUPO PIC  X(0006).
  4045*    -------------------------------
  4046     05  FILLER            PIC  X(0003).
  4047     05  BSTATEO PIC  X(0002).
  4048*    -------------------------------
  4049     05  FILLER            PIC  X(0003).
  4050     05  BACCTO PIC  X(0010).
  4051*    -------------------------------
  4052     05  FILLER            PIC  X(0003).
  4053     05  BVINHO PIC  X(0004).
  4054*    -------------------------------
  4055     05  FILLER            PIC  X(0003).
  4056     05  BVINO PIC  X(0017).
  4057*    -------------------------------
  4058     05  FILLER            PIC  X(0003).
  4059     05  BREFHDGO PIC  X(0004).
  4060*    -------------------------------
  4061     05  FILLER            PIC  X(0003).
  4062     05  BREFO PIC  X(0012).
  4063*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  78
* EL6311.cbl
  4064     05  FILLER            PIC  X(0003).
  4065     05  BAGEDEFO PIC  X(0004).
  4066*    -------------------------------
  4067     05  FILLER            PIC  X(0003).
  4068     05  BCERTNOO PIC  X(0010).
  4069*    -------------------------------
  4070     05  FILLER            PIC  X(0003).
  4071     05  BSUFIXO PIC  X(0001).
  4072*    -------------------------------
  4073     05  FILLER            PIC  X(0003).
  4074     05  BEFFDTO PIC  X(0008).
  4075*    -------------------------------
  4076     05  FILLER            PIC  X(0003).
  4077     05  BLSTNMO PIC  X(0015).
  4078*    -------------------------------
  4079     05  FILLER            PIC  X(0003).
  4080     05  B1STNMO PIC  X(0010).
  4081*    -------------------------------
  4082     05  FILLER            PIC  X(0003).
  4083     05  BINITO PIC  X(0001).
  4084*    -------------------------------
  4085     05  FILLER            PIC  X(0003).
  4086     05  BSEXO PIC  X(0001).
  4087*    -------------------------------
  4088     05  FILLER            PIC  X(0003).
  4089     05  BAGEO PIC  X(0002).
  4090*    -------------------------------
  4091     05  FILLER            PIC  X(0003).
  4092     05  BBIRTHO PIC  X(0008).
  4093*    -------------------------------
  4094     05  FILLER            PIC  X(0003).
  4095     05  B1STPMTO PIC  X(0008).
  4096*    -------------------------------
  4097     05  FILLER            PIC  X(0003).
  4098     05  BDAYSO PIC  X(0003).
  4099*    -------------------------------
  4100     05  FILLER            PIC  X(0003).
  4101     05  BLNTRMO PIC  X(0003).
  4102*    -------------------------------
  4103     05  FILLER            PIC  X(0003).
  4104     05  BLNOFCRO PIC  X(0005).
  4105*    -------------------------------
  4106     05  FILLER            PIC  X(0003).
  4107     05  BMODEO PIC  X(0001).
  4108*    -------------------------------
  4109     05  FILLER            PIC  X(0003).
  4110     05  BFREQO PIC  X(0002).
  4111*    -------------------------------
  4112     05  FILLER            PIC  X(0003).
  4113     05  BPMTSO PIC  X(0003).
  4114*    -------------------------------
  4115     05  FILLER            PIC  X(0003).
  4116     05  BPMTAMTO PIC  ZZZZZ9.99.
  4117*    -------------------------------
  4118     05  FILLER            PIC  X(0003).
  4119     05  BAPRO PIC  99.9999.
  4120*    -------------------------------
  4121     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  79
* EL6311.cbl
  4122     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4123*    -------------------------------
  4124     05  FILLER            PIC  X(0003).
  4125     05  BMEMCAPO PIC  X(0011).
  4126*    -------------------------------
  4127     05  FILLER            PIC  X(0003).
  4128     05  BORIGHDO PIC  X(0009).
  4129*    -------------------------------
  4130     05  FILLER            PIC  X(0003).
  4131     05  DMDBILO PIC  X(0006).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  BFORCEO PIC  X(0001).
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BENTRYO PIC  X(0001).
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  BREINO PIC  X(0001).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BBILCDO PIC  X(0001).
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  BUNWRITO PIC  X(0001).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BSKPCDO PIC  X(0001).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BINDGRPO PIC  X(0001).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BSIGO PIC  X(0001).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BRTCLSO PIC  X(0002).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BCHGCNTO PIC  X(0003).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BMEMBERO PIC  X(0012).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BORGNOO PIC  X(0006).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BORGSEQO PIC  X(0004).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BKIND1O PIC  X(0002).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  80
* EL6311.cbl
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BTERM1O PIC  X(0003).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BBEN1O PIC  X(0012).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BPREM1O PIC  X(0011).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BEXPIR1O PIC  X(0008).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BCP1O PIC  X(0002).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BALTBN1O PIC  X(0012).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BALTPR1O PIC  X(0011).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BBNCD1O PIC  X(0003).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BCPRM1O PIC  X(0011).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BCAPRM1O PIC  X(0011).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BENABR1O PIC  X(0005).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BDIFF1O PIC  X(0011).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BBILIT1O PIC  X(0008).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BADIFF1O PIC  X(0011).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BKIND2O PIC  X(0002).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BTYPE2O PIC  X(0003).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BTERM2O PIC  X(0003).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BBEN2O PIC  X(0012).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BPREM2O PIC  X(0011).
  4237*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  81
* EL6311.cbl
  4238     05  FILLER            PIC  X(0003).
  4239     05  BEXPIR2O PIC  X(0008).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BCP2O PIC  X(0002).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BALTBN2O PIC  X(0012).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BALTPR2O PIC  X(0011).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  BBNCD2O PIC  X(0003).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BCPRM2O PIC  X(0011).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BCAPRM2O PIC  X(0011).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BENABR2O PIC  X(0005).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BDIFF2O PIC  X(0011).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  BBILIT2O PIC  X(0008).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  BADIFF2O PIC  X(0011).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  BERMSG1O PIC  X(0078).
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
  4275     05  BERMSG2O PIC  X(0078).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  BERMSG3O PIC  X(0078).
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BPFENTRO PIC  X(0002).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  BPF5HDRO PIC  X(0005).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  BPF4HDRO PIC  X(0013).
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  BF15HDRO PIC  X(0010).
  4291*    -------------------------------
  4292 01  EL631CI REDEFINES EL631BI.
  4293     05  FILLER            PIC  X(0012).
  4294*    -------------------------------
  4295     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  82
* EL6311.cbl
  4296     05  CDATEF PIC  X(0001).
  4297     05  FILLER REDEFINES CDATEF.
  4298         10  CDATEA PIC  X(0001).
  4299     05  CDATEI PIC  X(0008).
  4300*    -------------------------------
  4301     05  CTIMEL PIC S9(0004) COMP.
  4302     05  CTIMEF PIC  X(0001).
  4303     05  FILLER REDEFINES CTIMEF.
  4304         10  CTIMEA PIC  X(0001).
  4305     05  CTIMEI PIC  X(0005).
  4306*    -------------------------------
  4307     05  CHEADL PIC S9(0004) COMP.
  4308     05  CHEADF PIC  X(0001).
  4309     05  FILLER REDEFINES CHEADF.
  4310         10  CHEADA PIC  X(0001).
  4311     05  CHEADI PIC  X(0038).
  4312*    -------------------------------
  4313     05  CCHGTL PIC S9(0004) COMP.
  4314     05  CCHGTF PIC  X(0001).
  4315     05  FILLER REDEFINES CCHGTF.
  4316         10  CCHGTA PIC  X(0001).
  4317     05  CCHGTI PIC  X(0004).
  4318*    -------------------------------
  4319     05  CCHGL PIC S9(0004) COMP.
  4320     05  CCHGF PIC  X(0001).
  4321     05  FILLER REDEFINES CCHGF.
  4322         10  CCHGA PIC  X(0001).
  4323     05  CCHGI PIC  X(0004).
  4324*    -------------------------------
  4325     05  CMAINTL PIC S9(0004) COMP.
  4326     05  CMAINTF PIC  X(0001).
  4327     05  FILLER REDEFINES CMAINTF.
  4328         10  CMAINTA PIC  X(0001).
  4329     05  CMAINTI PIC  X(0001).
  4330*    -------------------------------
  4331     05  CMANTBYL PIC S9(0004) COMP.
  4332     05  CMANTBYF PIC  X(0001).
  4333     05  FILLER REDEFINES CMANTBYF.
  4334         10  CMANTBYA PIC  X(0001).
  4335     05  CMANTBYI PIC  X(0004).
  4336*    -------------------------------
  4337     05  CCHGHDGL PIC S9(0004) COMP.
  4338     05  CCHGHDGF PIC  X(0001).
  4339     05  FILLER REDEFINES CCHGHDGF.
  4340         10  CCHGHDGA PIC  X(0001).
  4341     05  CCHGHDGI PIC  X(0003).
  4342*    -------------------------------
  4343     05  CMANTDTL PIC S9(0004) COMP.
  4344     05  CMANTDTF PIC  X(0001).
  4345     05  FILLER REDEFINES CMANTDTF.
  4346         10  CMANTDTA PIC  X(0001).
  4347     05  CMANTDTI PIC  X(0008).
  4348*    -------------------------------
  4349     05  CMANTATL PIC S9(0004) COMP.
  4350     05  CMANTATF PIC  X(0001).
  4351     05  FILLER REDEFINES CMANTATF.
  4352         10  CMANTATA PIC  X(0001).
  4353     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  83
* EL6311.cbl
  4354*    -------------------------------
  4355     05  CCSRL PIC S9(0004) COMP.
  4356     05  CCSRF PIC  X(0001).
  4357     05  FILLER REDEFINES CCSRF.
  4358         10  CCSRA PIC  X(0001).
  4359     05  CCSRI PIC  X(0004).
  4360*    -------------------------------
  4361     05  CBATCHL PIC S9(0004) COMP.
  4362     05  CBATCHF PIC  X(0001).
  4363     05  FILLER REDEFINES CBATCHF.
  4364         10  CBATCHA PIC  X(0001).
  4365     05  CBATCHI PIC  X(0006).
  4366*    -------------------------------
  4367     05  CSEQL PIC S9(0004) COMP.
  4368     05  CSEQF PIC  X(0001).
  4369     05  FILLER REDEFINES CSEQF.
  4370         10  CSEQA PIC  X(0001).
  4371     05  CSEQI PIC  X(0004).
  4372*    -------------------------------
  4373     05  CMOENDTL PIC S9(0004) COMP.
  4374     05  CMOENDTF PIC  X(0001).
  4375     05  FILLER REDEFINES CMOENDTF.
  4376         10  CMOENDTA PIC  X(0001).
  4377     05  CMOENDTI PIC  X(0008).
  4378*    -------------------------------
  4379     05  CCARRL PIC S9(0004) COMP.
  4380     05  CCARRF PIC  X(0001).
  4381     05  FILLER REDEFINES CCARRF.
  4382         10  CCARRA PIC  X(0001).
  4383     05  CCARRI PIC  X(0001).
  4384*    -------------------------------
  4385     05  CGROUPL PIC S9(0004) COMP.
  4386     05  CGROUPF PIC  X(0001).
  4387     05  FILLER REDEFINES CGROUPF.
  4388         10  CGROUPA PIC  X(0001).
  4389     05  CGROUPI PIC  X(0006).
  4390*    -------------------------------
  4391     05  CSTATEL PIC S9(0004) COMP.
  4392     05  CSTATEF PIC  X(0001).
  4393     05  FILLER REDEFINES CSTATEF.
  4394         10  CSTATEA PIC  X(0001).
  4395     05  CSTATEI PIC  X(0002).
  4396*    -------------------------------
  4397     05  CACCTL PIC S9(0004) COMP.
  4398     05  CACCTF PIC  X(0001).
  4399     05  FILLER REDEFINES CACCTF.
  4400         10  CACCTA PIC  X(0001).
  4401     05  CACCTI PIC  X(0010).
  4402*    -------------------------------
  4403     05  CORIGHDL PIC S9(0004) COMP.
  4404     05  CORIGHDF PIC  X(0001).
  4405     05  FILLER REDEFINES CORIGHDF.
  4406         10  CORIGHDA PIC  X(0001).
  4407     05  CORIGHDI PIC  X(0011).
  4408*    -------------------------------
  4409     05  CORGNOL PIC S9(0004) COMP.
  4410     05  CORGNOF PIC  X(0001).
  4411     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  84
* EL6311.cbl
  4412         10  CORGNOA PIC  X(0001).
  4413     05  CORGNOI PIC  X(0006).
  4414*    -------------------------------
  4415     05  CORGSEQL PIC S9(0004) COMP.
  4416     05  CORGSEQF PIC  X(0001).
  4417     05  FILLER REDEFINES CORGSEQF.
  4418         10  CORGSEQA PIC  X(0001).
  4419     05  CORGSEQI PIC  X(0004).
  4420*    -------------------------------
  4421     05  CREFHDGL PIC S9(0004) COMP.
  4422     05  CREFHDGF PIC  X(0001).
  4423     05  FILLER REDEFINES CREFHDGF.
  4424         10  CREFHDGA PIC  X(0001).
  4425     05  CREFHDGI PIC  X(0010).
  4426*    -------------------------------
  4427     05  CREFL PIC S9(0004) COMP.
  4428     05  CREFF PIC  X(0001).
  4429     05  FILLER REDEFINES CREFF.
  4430         10  CREFA PIC  X(0001).
  4431     05  CREFI PIC  X(0012).
  4432*    -------------------------------
  4433     05  CNHINTL PIC S9(0004) COMP.
  4434     05  CNHINTF PIC  X(0001).
  4435     05  FILLER REDEFINES CNHINTF.
  4436         10  CNHINTA PIC  X(0001).
  4437     05  CNHINTI PIC  9(7)V99.
  4438*    -------------------------------
  4439     05  CCERTNOL PIC S9(0004) COMP.
  4440     05  CCERTNOF PIC  X(0001).
  4441     05  FILLER REDEFINES CCERTNOF.
  4442         10  CCERTNOA PIC  X(0001).
  4443     05  CCERTNOI PIC  X(0010).
  4444*    -------------------------------
  4445     05  CSUFIXL PIC S9(0004) COMP.
  4446     05  CSUFIXF PIC  X(0001).
  4447     05  FILLER REDEFINES CSUFIXF.
  4448         10  CSUFIXA PIC  X(0001).
  4449     05  CSUFIXI PIC  X(0001).
  4450*    -------------------------------
  4451     05  CEFFDTL PIC S9(0004) COMP.
  4452     05  CEFFDTF PIC  X(0001).
  4453     05  FILLER REDEFINES CEFFDTF.
  4454         10  CEFFDTA PIC  X(0001).
  4455     05  CEFFDTI PIC  X(0008).
  4456*    -------------------------------
  4457     05  CLSTNML PIC S9(0004) COMP.
  4458     05  CLSTNMF PIC  X(0001).
  4459     05  FILLER REDEFINES CLSTNMF.
  4460         10  CLSTNMA PIC  X(0001).
  4461     05  CLSTNMI PIC  X(0015).
  4462*    -------------------------------
  4463     05  CPCYNL PIC S9(0004) COMP.
  4464     05  CPCYNF PIC  X(0001).
  4465     05  FILLER REDEFINES CPCYNF.
  4466         10  CPCYNA PIC  X(0001).
  4467     05  CPCYNI PIC  X(0001).
  4468*    -------------------------------
  4469     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  85
* EL6311.cbl
  4470     05  CINAMEF PIC  X(0001).
  4471     05  FILLER REDEFINES CINAMEF.
  4472         10  CINAMEA PIC  X(0001).
  4473     05  CINAMEI PIC  X(0015).
  4474*    -------------------------------
  4475     05  CINITSL PIC S9(0004) COMP.
  4476     05  CINITSF PIC  X(0001).
  4477     05  FILLER REDEFINES CINITSF.
  4478         10  CINITSA PIC  X(0001).
  4479     05  CINITSI PIC  X(0010).
  4480*    -------------------------------
  4481     05  CCANREAL PIC S9(0004) COMP.
  4482     05  CCANREAF PIC  X(0001).
  4483     05  FILLER REDEFINES CCANREAF.
  4484         10  CCANREAA PIC  X(0001).
  4485     05  CCANREAI PIC  X(0001).
  4486*    -------------------------------
  4487     05  CKIND1L PIC S9(0004) COMP.
  4488     05  CKIND1F PIC  X(0001).
  4489     05  FILLER REDEFINES CKIND1F.
  4490         10  CKIND1A PIC  X(0001).
  4491     05  CKIND1I PIC  X(0002).
  4492*    -------------------------------
  4493     05  CCANDT1L PIC S9(0004) COMP.
  4494     05  CCANDT1F PIC  X(0001).
  4495     05  FILLER REDEFINES CCANDT1F.
  4496         10  CCANDT1A PIC  X(0001).
  4497     05  CCANDT1I PIC  X(0008).
  4498*    -------------------------------
  4499     05  CREFND1L PIC S9(0004) COMP.
  4500     05  CREFND1F PIC  X(0001).
  4501     05  FILLER REDEFINES CREFND1F.
  4502         10  CREFND1A PIC  X(0001).
  4503     05  CREFND1I PIC  S9(9)V99.
  4504*    -------------------------------
  4505     05  CMTHD1L PIC S9(0004) COMP.
  4506     05  CMTHD1F PIC  X(0001).
  4507     05  FILLER REDEFINES CMTHD1F.
  4508         10  CMTHD1A PIC  X(0001).
  4509     05  CMTHD1I PIC  X(0001).
  4510*    -------------------------------
  4511     05  CKIND2L PIC S9(0004) COMP.
  4512     05  CKIND2F PIC  X(0001).
  4513     05  FILLER REDEFINES CKIND2F.
  4514         10  CKIND2A PIC  X(0001).
  4515     05  CKIND2I PIC  X(0002).
  4516*    -------------------------------
  4517     05  CCANDT2L PIC S9(0004) COMP.
  4518     05  CCANDT2F PIC  X(0001).
  4519     05  FILLER REDEFINES CCANDT2F.
  4520         10  CCANDT2A PIC  X(0001).
  4521     05  CCANDT2I PIC  X(0008).
  4522*    -------------------------------
  4523     05  CREFND2L PIC S9(0004) COMP.
  4524     05  CREFND2F PIC  X(0001).
  4525     05  FILLER REDEFINES CREFND2F.
  4526         10  CREFND2A PIC  X(0001).
  4527     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  86
* EL6311.cbl
  4528*    -------------------------------
  4529     05  CMTHD2L PIC S9(0004) COMP.
  4530     05  CMTHD2F PIC  X(0001).
  4531     05  FILLER REDEFINES CMTHD2F.
  4532         10  CMTHD2A PIC  X(0001).
  4533     05  CMTHD2I PIC  X(0001).
  4534*    -------------------------------
  4535     05  CLIVESL PIC S9(0004) COMP.
  4536     05  CLIVESF PIC  X(0001).
  4537     05  FILLER REDEFINES CLIVESF.
  4538         10  CLIVESA PIC  X(0001).
  4539     05  CLIVESI PIC  X(0003).
  4540*    -------------------------------
  4541     05  CFORCEL PIC S9(0004) COMP.
  4542     05  CFORCEF PIC  X(0001).
  4543     05  FILLER REDEFINES CFORCEF.
  4544         10  CFORCEA PIC  X(0001).
  4545     05  CFORCEI PIC  X(0001).
  4546*    -------------------------------
  4547     05  CBILCDL PIC S9(0004) COMP.
  4548     05  CBILCDF PIC  X(0001).
  4549     05  FILLER REDEFINES CBILCDF.
  4550         10  CBILCDA PIC  X(0001).
  4551     05  CBILCDI PIC  X(0001).
  4552*    -------------------------------
  4553     05  CCRFND1L PIC S9(0004) COMP.
  4554     05  CCRFND1F PIC  X(0001).
  4555     05  FILLER REDEFINES CCRFND1F.
  4556         10  CCRFND1A PIC  X(0001).
  4557     05  CCRFND1I PIC  X(0011).
  4558*    -------------------------------
  4559     05  CCRFND2L PIC S9(0004) COMP.
  4560     05  CCRFND2F PIC  X(0001).
  4561     05  FILLER REDEFINES CCRFND2F.
  4562         10  CCRFND2A PIC  X(0001).
  4563     05  CCRFND2I PIC  X(0011).
  4564*    -------------------------------
  4565     05  CBILIT1L PIC S9(0004) COMP.
  4566     05  CBILIT1F PIC  X(0001).
  4567     05  FILLER REDEFINES CBILIT1F.
  4568         10  CBILIT1A PIC  X(0001).
  4569     05  CBILIT1I PIC  X(0008).
  4570*    -------------------------------
  4571     05  CDRFND1L PIC S9(0004) COMP.
  4572     05  CDRFND1F PIC  X(0001).
  4573     05  FILLER REDEFINES CDRFND1F.
  4574         10  CDRFND1A PIC  X(0001).
  4575     05  CDRFND1I PIC  X(0011).
  4576*    -------------------------------
  4577     05  CBILIT2L PIC S9(0004) COMP.
  4578     05  CBILIT2F PIC  X(0001).
  4579     05  FILLER REDEFINES CBILIT2F.
  4580         10  CBILIT2A PIC  X(0001).
  4581     05  CBILIT2I PIC  X(0008).
  4582*    -------------------------------
  4583     05  CDRFND2L PIC S9(0004) COMP.
  4584     05  CDRFND2F PIC  X(0001).
  4585     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  87
* EL6311.cbl
  4586         10  CDRFND2A PIC  X(0001).
  4587     05  CDRFND2I PIC  X(0011).
  4588*    -------------------------------
  4589     05  CCANTXTL PIC S9(0004) COMP.
  4590     05  CCANTXTF PIC  X(0001).
  4591     05  FILLER REDEFINES CCANTXTF.
  4592         10  CCANTXTA PIC  X(0001).
  4593     05  CCANTXTI PIC  X(0005).
  4594*    -------------------------------
  4595     05  CCANFEEL PIC S9(0004) COMP.
  4596     05  CCANFEEF PIC  X(0001).
  4597     05  FILLER REDEFINES CCANFEEF.
  4598         10  CCANFEEA PIC  X(0001).
  4599     05  CCANFEEI PIC  X(0002).
  4600*    -------------------------------
  4601     05  CTERM1L PIC S9(0004) COMP.
  4602     05  CTERM1F PIC  X(0001).
  4603     05  FILLER REDEFINES CTERM1F.
  4604         10  CTERM1A PIC  X(0001).
  4605     05  CTERM1I PIC  X(0003).
  4606*    -------------------------------
  4607     05  CRTERM1L PIC S9(0004) COMP.
  4608     05  CRTERM1F PIC  X(0001).
  4609     05  FILLER REDEFINES CRTERM1F.
  4610         10  CRTERM1A PIC  X(0001).
  4611     05  CRTERM1I PIC  X(0003).
  4612*    -------------------------------
  4613     05  CPREM1L PIC S9(0004) COMP.
  4614     05  CPREM1F PIC  X(0001).
  4615     05  FILLER REDEFINES CPREM1F.
  4616         10  CPREM1A PIC  X(0001).
  4617     05  CPREM1I PIC  X(0011).
  4618*    -------------------------------
  4619     05  CTERM2L PIC S9(0004) COMP.
  4620     05  CTERM2F PIC  X(0001).
  4621     05  FILLER REDEFINES CTERM2F.
  4622         10  CTERM2A PIC  X(0001).
  4623     05  CTERM2I PIC  X(0003).
  4624*    -------------------------------
  4625     05  CRTERM2L PIC S9(0004) COMP.
  4626     05  CRTERM2F PIC  X(0001).
  4627     05  FILLER REDEFINES CRTERM2F.
  4628         10  CRTERM2A PIC  X(0001).
  4629     05  CRTERM2I PIC  X(0003).
  4630*    -------------------------------
  4631     05  CPREM2L PIC S9(0004) COMP.
  4632     05  CPREM2F PIC  X(0001).
  4633     05  FILLER REDEFINES CPREM2F.
  4634         10  CPREM2A PIC  X(0001).
  4635     05  CPREM2I PIC  X(0011).
  4636*    -------------------------------
  4637     05  CENTRDTL PIC S9(0004) COMP.
  4638     05  CENTRDTF PIC  X(0001).
  4639     05  FILLER REDEFINES CENTRDTF.
  4640         10  CENTRDTA PIC  X(0001).
  4641     05  CENTRDTI PIC  X(0008).
  4642*    -------------------------------
  4643     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  88
* EL6311.cbl
  4644     05  CPAYEEF PIC  X(0001).
  4645     05  FILLER REDEFINES CPAYEEF.
  4646         10  CPAYEEA PIC  X(0001).
  4647     05  CPAYEEI PIC  X(0006).
  4648*    -------------------------------
  4649     05  CRFNDSWL PIC S9(0004) COMP.
  4650     05  CRFNDSWF PIC  X(0001).
  4651     05  FILLER REDEFINES CRFNDSWF.
  4652         10  CRFNDSWA PIC  X(0001).
  4653     05  CRFNDSWI PIC  X(0003).
  4654*    -------------------------------
  4655     05  CLFHDGL PIC S9(0004) COMP.
  4656     05  CLFHDGF PIC  X(0001).
  4657     05  FILLER REDEFINES CLFHDGF.
  4658         10  CLFHDGA PIC  X(0001).
  4659     05  CLFHDGI PIC  X(0006).
  4660*    -------------------------------
  4661     05  CAHHDGL PIC S9(0004) COMP.
  4662     05  CAHHDGF PIC  X(0001).
  4663     05  FILLER REDEFINES CAHHDGF.
  4664         10  CAHHDGA PIC  X(0001).
  4665     05  CAHHDGI PIC  X(0006).
  4666*    -------------------------------
  4667     05  CENTDTL PIC S9(0004) COMP.
  4668     05  CENTDTF PIC  X(0001).
  4669     05  FILLER REDEFINES CENTDTF.
  4670         10  CENTDTA PIC  X(0001).
  4671     05  CENTDTI PIC  X(0008).
  4672*    -------------------------------
  4673     05  CENTBYL PIC S9(0004) COMP.
  4674     05  CENTBYF PIC  X(0001).
  4675     05  FILLER REDEFINES CENTBYF.
  4676         10  CENTBYA PIC  X(0001).
  4677     05  CENTBYI PIC  X(0004).
  4678*    -------------------------------
  4679     05  CCHGCNTL PIC S9(0004) COMP.
  4680     05  CCHGCNTF PIC  X(0001).
  4681     05  FILLER REDEFINES CCHGCNTF.
  4682         10  CCHGCNTA PIC  X(0001).
  4683     05  CCHGCNTI PIC  X(0003).
  4684*    -------------------------------
  4685     05  CLFREFNL PIC S9(0004) COMP.
  4686     05  CLFREFNF PIC  X(0001).
  4687     05  FILLER REDEFINES CLFREFNF.
  4688         10  CLFREFNA PIC  X(0001).
  4689     05  CLFREFNI PIC  X(0006).
  4690*    -------------------------------
  4691     05  CAHREFNL PIC S9(0004) COMP.
  4692     05  CAHREFNF PIC  X(0001).
  4693     05  FILLER REDEFINES CAHREFNF.
  4694         10  CAHREFNA PIC  X(0001).
  4695     05  CAHREFNI PIC  X(0006).
  4696*    -------------------------------
  4697     05  CREINCDL PIC S9(0004) COMP.
  4698     05  CREINCDF PIC  X(0001).
  4699     05  FILLER REDEFINES CREINCDF.
  4700         10  CREINCDA PIC  X(0001).
  4701     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  89
* EL6311.cbl
  4702*    -------------------------------
  4703     05  CAEFFDTL PIC S9(0004) COMP.
  4704     05  CAEFFDTF PIC  X(0001).
  4705     05  FILLER REDEFINES CAEFFDTF.
  4706         10  CAEFFDTA PIC  X(0001).
  4707     05  CAEFFDTI PIC  X(0008).
  4708*    -------------------------------
  4709     05  CAEXPDTL PIC S9(0004) COMP.
  4710     05  CAEXPDTF PIC  X(0001).
  4711     05  FILLER REDEFINES CAEXPDTF.
  4712         10  CAEXPDTA PIC  X(0001).
  4713     05  CAEXPDTI PIC  X(0008).
  4714*    -------------------------------
  4715     05  COMMLFL PIC S9(0004) COMP.
  4716     05  COMMLFF PIC  X(0001).
  4717     05  FILLER REDEFINES COMMLFF.
  4718         10  COMMLFA PIC  X(0001).
  4719     05  COMMLFI PIC  X(0006).
  4720*    -------------------------------
  4721     05  COMMAHL PIC S9(0004) COMP.
  4722     05  COMMAHF PIC  X(0001).
  4723     05  FILLER REDEFINES COMMAHF.
  4724         10  COMMAHA PIC  X(0001).
  4725     05  COMMAHI PIC  X(0006).
  4726*    -------------------------------
  4727     05  CERMSG1L PIC S9(0004) COMP.
  4728     05  CERMSG1F PIC  X(0001).
  4729     05  FILLER REDEFINES CERMSG1F.
  4730         10  CERMSG1A PIC  X(0001).
  4731     05  CERMSG1I PIC  X(0078).
  4732*    -------------------------------
  4733     05  CERMSG2L PIC S9(0004) COMP.
  4734     05  CERMSG2F PIC  X(0001).
  4735     05  FILLER REDEFINES CERMSG2F.
  4736         10  CERMSG2A PIC  X(0001).
  4737     05  CERMSG2I PIC  X(0078).
  4738*    -------------------------------
  4739     05  CERMSG3L PIC S9(0004) COMP.
  4740     05  CERMSG3F PIC  X(0001).
  4741     05  FILLER REDEFINES CERMSG3F.
  4742         10  CERMSG3A PIC  X(0001).
  4743     05  CERMSG3I PIC  X(0078).
  4744*    -------------------------------
  4745     05  CPFENTRL PIC S9(0004) COMP.
  4746     05  CPFENTRF PIC  X(0001).
  4747     05  FILLER REDEFINES CPFENTRF.
  4748         10  CPFENTRA PIC  X(0001).
  4749     05  CPFENTRI PIC  9(2).
  4750*    -------------------------------
  4751     05  CPF5HDRL PIC S9(0004) COMP.
  4752     05  CPF5HDRF PIC  X(0001).
  4753     05  FILLER REDEFINES CPF5HDRF.
  4754         10  CPF5HDRA PIC  X(0001).
  4755     05  CPF5HDRI PIC  X(0005).
  4756*    -------------------------------
  4757     05  CPF4HDRL PIC S9(0004) COMP.
  4758     05  CPF4HDRF PIC  X(0001).
  4759     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  90
* EL6311.cbl
  4760         10  CPF4HDRA PIC  X(0001).
  4761     05  CPF4HDRI PIC  X(0013).
  4762*    -------------------------------
  4763     05  CF15HDRL PIC S9(0004) COMP.
  4764     05  CF15HDRF PIC  X(0001).
  4765     05  FILLER REDEFINES CF15HDRF.
  4766         10  CF15HDRA PIC  X(0001).
  4767     05  CF15HDRI PIC  X(0022).
  4768 01  EL631CO REDEFINES EL631BI.
  4769     05  FILLER            PIC  X(0012).
  4770*    -------------------------------
  4771     05  FILLER            PIC  X(0003).
  4772     05  CDATEO PIC  X(0008).
  4773*    -------------------------------
  4774     05  FILLER            PIC  X(0003).
  4775     05  CTIMEO PIC  99.99.
  4776*    -------------------------------
  4777     05  FILLER            PIC  X(0003).
  4778     05  CHEADO PIC  X(0038).
  4779*    -------------------------------
  4780     05  FILLER            PIC  X(0003).
  4781     05  CCHGTO PIC  X(0004).
  4782*    -------------------------------
  4783     05  FILLER            PIC  X(0003).
  4784     05  CCHGO PIC  ZZZ9.
  4785*    -------------------------------
  4786     05  FILLER            PIC  X(0003).
  4787     05  CMAINTO PIC  X(0001).
  4788*    -------------------------------
  4789     05  FILLER            PIC  X(0003).
  4790     05  CMANTBYO PIC  X(0004).
  4791*    -------------------------------
  4792     05  FILLER            PIC  X(0003).
  4793     05  CCHGHDGO PIC  X(0003).
  4794*    -------------------------------
  4795     05  FILLER            PIC  X(0003).
  4796     05  CMANTDTO PIC  X(0008).
  4797*    -------------------------------
  4798     05  FILLER            PIC  X(0003).
  4799     05  CMANTATO PIC  99.99.
  4800*    -------------------------------
  4801     05  FILLER            PIC  X(0003).
  4802     05  CCSRO PIC  X(0004).
  4803*    -------------------------------
  4804     05  FILLER            PIC  X(0003).
  4805     05  CBATCHO PIC  X(0006).
  4806*    -------------------------------
  4807     05  FILLER            PIC  X(0003).
  4808     05  CSEQO PIC  X(0004).
  4809*    -------------------------------
  4810     05  FILLER            PIC  X(0003).
  4811     05  CMOENDTO PIC  X(0008).
  4812*    -------------------------------
  4813     05  FILLER            PIC  X(0003).
  4814     05  CCARRO PIC  X(0001).
  4815*    -------------------------------
  4816     05  FILLER            PIC  X(0003).
  4817     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  91
* EL6311.cbl
  4818*    -------------------------------
  4819     05  FILLER            PIC  X(0003).
  4820     05  CSTATEO PIC  X(0002).
  4821*    -------------------------------
  4822     05  FILLER            PIC  X(0003).
  4823     05  CACCTO PIC  X(0010).
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  CORIGHDO PIC  X(0011).
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  CORGNOO PIC  X(0006).
  4830*    -------------------------------
  4831     05  FILLER            PIC  X(0003).
  4832     05  CORGSEQO PIC  X(0004).
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  CREFHDGO PIC  X(0010).
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  CREFO PIC  X(0012).
  4839*    -------------------------------
  4840     05  FILLER            PIC  X(0003).
  4841     05  CNHINTO PIC  999999.99.
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  CCERTNOO PIC  X(0010).
  4845*    -------------------------------
  4846     05  FILLER            PIC  X(0003).
  4847     05  CSUFIXO PIC  X(0001).
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  CEFFDTO PIC  X(0008).
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  CLSTNMO PIC  X(0015).
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  CPCYNO PIC  X(0001).
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  CINAMEO PIC  X(0015).
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
  4862     05  CINITSO PIC  X(0010).
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  CCANREAO PIC  X(0001).
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  CKIND1O PIC  X(0002).
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  CCANDT1O PIC  X(0008).
  4872*    -------------------------------
  4873     05  FILLER            PIC  X(0003).
  4874     05  CREFND1O PIC  Z(7).99-.
  4875*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  92
* EL6311.cbl
  4876     05  FILLER            PIC  X(0003).
  4877     05  CMTHD1O PIC  X(0001).
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  CKIND2O PIC  X(0002).
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  CCANDT2O PIC  X(0008).
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  CREFND2O PIC  Z(7).99-.
  4887*    -------------------------------
  4888     05  FILLER            PIC  X(0003).
  4889     05  CMTHD2O PIC  X(0001).
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  CLIVESO PIC  X(0003).
  4893*    -------------------------------
  4894     05  FILLER            PIC  X(0003).
  4895     05  CFORCEO PIC  X(0001).
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
  4898     05  CBILCDO PIC  X(0001).
  4899*    -------------------------------
  4900     05  FILLER            PIC  X(0003).
  4901     05  CCRFND1O PIC  Z(7).99-.
  4902*    -------------------------------
  4903     05  FILLER            PIC  X(0003).
  4904     05  CCRFND2O PIC  Z(7).99-.
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  CBILIT1O PIC  X(0008).
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  CDRFND1O PIC  Z(7).99-.
  4911*    -------------------------------
  4912     05  FILLER            PIC  X(0003).
  4913     05  CBILIT2O PIC  X(0008).
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  CDRFND2O PIC  Z(7).99-.
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  CCANTXTO PIC  X(0005).
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  CCANFEEO PIC  Z9.
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  CTERM1O PIC  ZZ9.
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  CRTERM1O PIC  ZZ9.
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
  4931     05  CPREM1O PIC  ZZZZZZ9.99-.
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  93
* EL6311.cbl
  4934     05  CTERM2O PIC  ZZ9.
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  CRTERM2O PIC  ZZ9.
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  CPREM2O PIC  ZZZZZZ9.99-.
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  CENTRDTO PIC  X(0008).
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
  4946     05  CPAYEEO PIC  X(0006).
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CRFNDSWO PIC  X(0003).
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CLFHDGO PIC  X(0006).
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CAHHDGO PIC  X(0006).
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  CENTDTO PIC  X(0008).
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CENTBYO PIC  X(0004).
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CCHGCNTO PIC  X(0003).
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CLFREFNO PIC  X(0006).
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CAHREFNO PIC  X(0006).
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CREINCDO PIC  X(0003).
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CAEFFDTO PIC  X(0008).
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CAEXPDTO PIC  X(0008).
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  COMMLFO PIC  .99999.
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  COMMAHO PIC  .99999.
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CERMSG1O PIC  X(0078).
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  94
* EL6311.cbl
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CERMSG3O PIC  X(0078).
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CPFENTRO PIC  X(0002).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CPF5HDRO PIC  X(0005).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CPF4HDRO PIC  X(0013).
  5004*    -------------------------------
  5005     05  FILLER            PIC  X(0003).
  5006     05  CF15HDRO PIC  X(0022).
  5007*    -------------------------------
  5008 01  EL631DI REDEFINES EL631BI.
  5009     05  FILLER            PIC  X(0012).
  5010*    -------------------------------
  5011     05  DDATEL PIC S9(0004) COMP.
  5012     05  DDATEF PIC  X(0001).
  5013     05  FILLER REDEFINES DDATEF.
  5014         10  DDATEA PIC  X(0001).
  5015     05  DDATEI PIC  X(0008).
  5016*    -------------------------------
  5017     05  DTIMEL PIC S9(0004) COMP.
  5018     05  DTIMEF PIC  X(0001).
  5019     05  FILLER REDEFINES DTIMEF.
  5020         10  DTIMEA PIC  X(0001).
  5021     05  DTIMEI PIC  X(0005).
  5022*    -------------------------------
  5023     05  DHEADL PIC S9(0004) COMP.
  5024     05  DHEADF PIC  X(0001).
  5025     05  FILLER REDEFINES DHEADF.
  5026         10  DHEADA PIC  X(0001).
  5027     05  DHEADI PIC  X(0038).
  5028*    -------------------------------
  5029     05  DLDATEL PIC S9(0004) COMP.
  5030     05  DLDATEF PIC  X(0001).
  5031     05  FILLER REDEFINES DLDATEF.
  5032         10  DLDATEA PIC  X(0001).
  5033     05  DLDATEI PIC  X(0010).
  5034*    -------------------------------
  5035     05  DBATCHL PIC S9(0004) COMP.
  5036     05  DBATCHF PIC  X(0001).
  5037     05  FILLER REDEFINES DBATCHF.
  5038         10  DBATCHA PIC  X(0001).
  5039     05  DBATCHI PIC  X(0011).
  5040*    -------------------------------
  5041     05  DACCTNML PIC S9(0004) COMP.
  5042     05  DACCTNMF PIC  X(0001).
  5043     05  FILLER REDEFINES DACCTNMF.
  5044         10  DACCTNMA PIC  X(0001).
  5045     05  DACCTNMI PIC  X(0030).
  5046*    -------------------------------
  5047     05  DPROCDTL PIC S9(0004) COMP.
  5048     05  DPROCDTF PIC  X(0001).
  5049     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  95
* EL6311.cbl
  5050         10  DPROCDTA PIC  X(0001).
  5051     05  DPROCDTI PIC  X(0008).
  5052*    -------------------------------
  5053     05  DINPUTL PIC S9(0004) COMP.
  5054     05  DINPUTF PIC  X(0001).
  5055     05  FILLER REDEFINES DINPUTF.
  5056         10  DINPUTA PIC  X(0001).
  5057     05  DINPUTI PIC  X(0008).
  5058*    -------------------------------
  5059     05  DMAINDTL PIC S9(0004) COMP.
  5060     05  DMAINDTF PIC  X(0001).
  5061     05  FILLER REDEFINES DMAINDTF.
  5062         10  DMAINDTA PIC  X(0001).
  5063     05  DMAINDTI PIC  X(0008).
  5064*    -------------------------------
  5065     05  DCARRL PIC S9(0004) COMP.
  5066     05  DCARRF PIC  X(0001).
  5067     05  FILLER REDEFINES DCARRF.
  5068         10  DCARRA PIC  X(0001).
  5069     05  DCARRI PIC  X(0001).
  5070*    -------------------------------
  5071     05  DGROUPL PIC S9(0004) COMP.
  5072     05  DGROUPF PIC  X(0001).
  5073     05  FILLER REDEFINES DGROUPF.
  5074         10  DGROUPA PIC  X(0001).
  5075     05  DGROUPI PIC  X(0006).
  5076*    -------------------------------
  5077     05  DSTATEL PIC S9(0004) COMP.
  5078     05  DSTATEF PIC  X(0001).
  5079     05  FILLER REDEFINES DSTATEF.
  5080         10  DSTATEA PIC  X(0001).
  5081     05  DSTATEI PIC  X(0002).
  5082*    -------------------------------
  5083     05  DACCTL PIC S9(0004) COMP.
  5084     05  DACCTF PIC  X(0001).
  5085     05  FILLER REDEFINES DACCTF.
  5086         10  DACCTA PIC  X(0001).
  5087     05  DACCTI PIC  X(0010).
  5088*    -------------------------------
  5089     05  DRECVDTL PIC S9(0004) COMP.
  5090     05  DRECVDTF PIC  X(0001).
  5091     05  FILLER REDEFINES DRECVDTF.
  5092         10  DRECVDTA PIC  X(0001).
  5093     05  DRECVDTI PIC  X(0008).
  5094*    -------------------------------
  5095     05  DCSRL PIC S9(0004) COMP.
  5096     05  DCSRF PIC  X(0001).
  5097     05  FILLER REDEFINES DCSRF.
  5098         10  DCSRA PIC  X(0001).
  5099     05  DCSRI PIC  X(0004).
  5100*    -------------------------------
  5101     05  DREFHDGL PIC S9(0004) COMP.
  5102     05  DREFHDGF PIC  X(0001).
  5103     05  FILLER REDEFINES DREFHDGF.
  5104         10  DREFHDGA PIC  X(0001).
  5105     05  DREFHDGI PIC  X(0010).
  5106*    -------------------------------
  5107     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  96
* EL6311.cbl
  5108     05  DREFF PIC  X(0001).
  5109     05  FILLER REDEFINES DREFF.
  5110         10  DREFA PIC  X(0001).
  5111     05  DREFI PIC  X(0012).
  5112*    -------------------------------
  5113     05  DLFPHDGL PIC S9(0004) COMP.
  5114     05  DLFPHDGF PIC  X(0001).
  5115     05  FILLER REDEFINES DLFPHDGF.
  5116         10  DLFPHDGA PIC  X(0001).
  5117     05  DLFPHDGI PIC  X(0010).
  5118*    -------------------------------
  5119     05  DAHPHDGL PIC S9(0004) COMP.
  5120     05  DAHPHDGF PIC  X(0001).
  5121     05  FILLER REDEFINES DAHPHDGF.
  5122         10  DAHPHDGA PIC  X(0001).
  5123     05  DAHPHDGI PIC  X(0010).
  5124*    -------------------------------
  5125     05  DLFRHDGL PIC S9(0004) COMP.
  5126     05  DLFRHDGF PIC  X(0001).
  5127     05  FILLER REDEFINES DLFRHDGF.
  5128         10  DLFRHDGA PIC  X(0001).
  5129     05  DLFRHDGI PIC  X(0009).
  5130*    -------------------------------
  5131     05  DAHRHDGL PIC S9(0004) COMP.
  5132     05  DAHRHDGF PIC  X(0001).
  5133     05  FILLER REDEFINES DAHRHDGF.
  5134         10  DAHRHDGA PIC  X(0001).
  5135     05  DAHRHDGI PIC  X(0009).
  5136*    -------------------------------
  5137     05  DRISSL PIC S9(0004) COMP.
  5138     05  DRISSF PIC  X(0001).
  5139     05  FILLER REDEFINES DRISSF.
  5140         10  DRISSA PIC  X(0001).
  5141     05  DRISSI PIC  X(0005).
  5142*    -------------------------------
  5143     05  DRLFPRML PIC S9(0004) COMP.
  5144     05  DRLFPRMF PIC  X(0001).
  5145     05  FILLER REDEFINES DRLFPRMF.
  5146         10  DRLFPRMA PIC  X(0001).
  5147     05  DRLFPRMI PIC  S9(9)V99.
  5148*    -------------------------------
  5149     05  DRAHPRML PIC S9(0004) COMP.
  5150     05  DRAHPRMF PIC  X(0001).
  5151     05  FILLER REDEFINES DRAHPRMF.
  5152         10  DRAHPRMA PIC  X(0001).
  5153     05  DRAHPRMI PIC  S9(9)V99.
  5154*    -------------------------------
  5155     05  DRCANCL PIC S9(0004) COMP.
  5156     05  DRCANCF PIC  X(0001).
  5157     05  FILLER REDEFINES DRCANCF.
  5158         10  DRCANCA PIC  X(0001).
  5159     05  DRCANCI PIC  X(0005).
  5160*    -------------------------------
  5161     05  DRLFRFDL PIC S9(0004) COMP.
  5162     05  DRLFRFDF PIC  X(0001).
  5163     05  FILLER REDEFINES DRLFRFDF.
  5164         10  DRLFRFDA PIC  X(0001).
  5165     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  97
* EL6311.cbl
  5166*    -------------------------------
  5167     05  DRAHRFDL PIC S9(0004) COMP.
  5168     05  DRAHRFDF PIC  X(0001).
  5169     05  FILLER REDEFINES DRAHRFDF.
  5170         10  DRAHRFDA PIC  X(0001).
  5171     05  DRAHRFDI PIC  S9(9)V99.
  5172*    -------------------------------
  5173     05  DEISSL PIC S9(0004) COMP.
  5174     05  DEISSF PIC  X(0001).
  5175     05  FILLER REDEFINES DEISSF.
  5176         10  DEISSA PIC  X(0001).
  5177     05  DEISSI PIC  X(0005).
  5178*    -------------------------------
  5179     05  DELFPRML PIC S9(0004) COMP.
  5180     05  DELFPRMF PIC  X(0001).
  5181     05  FILLER REDEFINES DELFPRMF.
  5182         10  DELFPRMA PIC  X(0001).
  5183     05  DELFPRMI PIC  X(0011).
  5184*    -------------------------------
  5185     05  DEAHPRML PIC S9(0004) COMP.
  5186     05  DEAHPRMF PIC  X(0001).
  5187     05  FILLER REDEFINES DEAHPRMF.
  5188         10  DEAHPRMA PIC  X(0001).
  5189     05  DEAHPRMI PIC  X(0011).
  5190*    -------------------------------
  5191     05  DECANCL PIC S9(0004) COMP.
  5192     05  DECANCF PIC  X(0001).
  5193     05  FILLER REDEFINES DECANCF.
  5194         10  DECANCA PIC  X(0001).
  5195     05  DECANCI PIC  X(0005).
  5196*    -------------------------------
  5197     05  DELFRFDL PIC S9(0004) COMP.
  5198     05  DELFRFDF PIC  X(0001).
  5199     05  FILLER REDEFINES DELFRFDF.
  5200         10  DELFRFDA PIC  X(0001).
  5201     05  DELFRFDI PIC  X(0011).
  5202*    -------------------------------
  5203     05  DEAHRFDL PIC S9(0004) COMP.
  5204     05  DEAHRFDF PIC  X(0001).
  5205     05  FILLER REDEFINES DEAHRFDF.
  5206         10  DEAHRFDA PIC  X(0001).
  5207     05  DEAHRFDI PIC  X(0011).
  5208*    -------------------------------
  5209     05  DCISSL PIC S9(0004) COMP.
  5210     05  DCISSF PIC  X(0001).
  5211     05  FILLER REDEFINES DCISSF.
  5212         10  DCISSA PIC  X(0001).
  5213     05  DCISSI PIC  X(0005).
  5214*    -------------------------------
  5215     05  DCLFPRML PIC S9(0004) COMP.
  5216     05  DCLFPRMF PIC  X(0001).
  5217     05  FILLER REDEFINES DCLFPRMF.
  5218         10  DCLFPRMA PIC  X(0001).
  5219     05  DCLFPRMI PIC  X(0011).
  5220*    -------------------------------
  5221     05  DCAHPRML PIC S9(0004) COMP.
  5222     05  DCAHPRMF PIC  X(0001).
  5223     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  98
* EL6311.cbl
  5224         10  DCAHPRMA PIC  X(0001).
  5225     05  DCAHPRMI PIC  X(0011).
  5226*    -------------------------------
  5227     05  DCCANCL PIC S9(0004) COMP.
  5228     05  DCCANCF PIC  X(0001).
  5229     05  FILLER REDEFINES DCCANCF.
  5230         10  DCCANCA PIC  X(0001).
  5231     05  DCCANCI PIC  X(0005).
  5232*    -------------------------------
  5233     05  DCLFRFDL PIC S9(0004) COMP.
  5234     05  DCLFRFDF PIC  X(0001).
  5235     05  FILLER REDEFINES DCLFRFDF.
  5236         10  DCLFRFDA PIC  X(0001).
  5237     05  DCLFRFDI PIC  X(0011).
  5238*    -------------------------------
  5239     05  DCAHRFDL PIC S9(0004) COMP.
  5240     05  DCAHRFDF PIC  X(0001).
  5241     05  FILLER REDEFINES DCAHRFDF.
  5242         10  DCAHRFDA PIC  X(0001).
  5243     05  DCAHRFDI PIC  X(0011).
  5244*    -------------------------------
  5245     05  DOISSL PIC S9(0004) COMP.
  5246     05  DOISSF PIC  X(0001).
  5247     05  FILLER REDEFINES DOISSF.
  5248         10  DOISSA PIC  X(0001).
  5249     05  DOISSI PIC  X(0005).
  5250*    -------------------------------
  5251     05  DOLFPRML PIC S9(0004) COMP.
  5252     05  DOLFPRMF PIC  X(0001).
  5253     05  FILLER REDEFINES DOLFPRMF.
  5254         10  DOLFPRMA PIC  X(0001).
  5255     05  DOLFPRMI PIC  X(0011).
  5256*    -------------------------------
  5257     05  DOAHPRML PIC S9(0004) COMP.
  5258     05  DOAHPRMF PIC  X(0001).
  5259     05  FILLER REDEFINES DOAHPRMF.
  5260         10  DOAHPRMA PIC  X(0001).
  5261     05  DOAHPRMI PIC  X(0011).
  5262*    -------------------------------
  5263     05  DOCANCL PIC S9(0004) COMP.
  5264     05  DOCANCF PIC  X(0001).
  5265     05  FILLER REDEFINES DOCANCF.
  5266         10  DOCANCA PIC  X(0001).
  5267     05  DOCANCI PIC  X(0005).
  5268*    -------------------------------
  5269     05  DOLFRFDL PIC S9(0004) COMP.
  5270     05  DOLFRFDF PIC  X(0001).
  5271     05  FILLER REDEFINES DOLFRFDF.
  5272         10  DOLFRFDA PIC  X(0001).
  5273     05  DOLFRFDI PIC  X(0011).
  5274*    -------------------------------
  5275     05  DOAHRFDL PIC S9(0004) COMP.
  5276     05  DOAHRFDF PIC  X(0001).
  5277     05  FILLER REDEFINES DOAHRFDF.
  5278         10  DOAHRFDA PIC  X(0001).
  5279     05  DOAHRFDI PIC  X(0011).
  5280*    -------------------------------
  5281     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page  99
* EL6311.cbl
  5282     05  DITOTALF PIC  X(0001).
  5283     05  FILLER REDEFINES DITOTALF.
  5284         10  DITOTALA PIC  X(0001).
  5285     05  DITOTALI PIC  X(0005).
  5286*    -------------------------------
  5287     05  DIFATALL PIC S9(0004) COMP.
  5288     05  DIFATALF PIC  X(0001).
  5289     05  FILLER REDEFINES DIFATALF.
  5290         10  DIFATALA PIC  X(0001).
  5291     05  DIFATALI PIC  X(0005).
  5292*    -------------------------------
  5293     05  DIFORCEL PIC S9(0004) COMP.
  5294     05  DIFORCEF PIC  X(0001).
  5295     05  FILLER REDEFINES DIFORCEF.
  5296         10  DIFORCEA PIC  X(0001).
  5297     05  DIFORCEI PIC  X(0005).
  5298*    -------------------------------
  5299     05  DIHOLDL PIC S9(0004) COMP.
  5300     05  DIHOLDF PIC  X(0001).
  5301     05  FILLER REDEFINES DIHOLDF.
  5302         10  DIHOLDA PIC  X(0001).
  5303     05  DIHOLDI PIC  X(0005).
  5304*    -------------------------------
  5305     05  DIAVAILL PIC S9(0004) COMP.
  5306     05  DIAVAILF PIC  X(0001).
  5307     05  FILLER REDEFINES DIAVAILF.
  5308         10  DIAVAILA PIC  X(0001).
  5309     05  DIAVAILI PIC  X(0005).
  5310*    -------------------------------
  5311     05  DIGPREML PIC S9(0004) COMP.
  5312     05  DIGPREMF PIC  X(0001).
  5313     05  FILLER REDEFINES DIGPREMF.
  5314         10  DIGPREMA PIC  X(0001).
  5315     05  DIGPREMI PIC  X(0011).
  5316*    -------------------------------
  5317     05  DIBPREML PIC S9(0004) COMP.
  5318     05  DIBPREMF PIC  X(0001).
  5319     05  FILLER REDEFINES DIBPREMF.
  5320         10  DIBPREMA PIC  X(0001).
  5321     05  DIBPREMI PIC  X(0011).
  5322*    -------------------------------
  5323     05  DCTOTALL PIC S9(0004) COMP.
  5324     05  DCTOTALF PIC  X(0001).
  5325     05  FILLER REDEFINES DCTOTALF.
  5326         10  DCTOTALA PIC  X(0001).
  5327     05  DCTOTALI PIC  X(0005).
  5328*    -------------------------------
  5329     05  DCFATALL PIC S9(0004) COMP.
  5330     05  DCFATALF PIC  X(0001).
  5331     05  FILLER REDEFINES DCFATALF.
  5332         10  DCFATALA PIC  X(0001).
  5333     05  DCFATALI PIC  X(0005).
  5334*    -------------------------------
  5335     05  DCFORCEL PIC S9(0004) COMP.
  5336     05  DCFORCEF PIC  X(0001).
  5337     05  FILLER REDEFINES DCFORCEF.
  5338         10  DCFORCEA PIC  X(0001).
  5339     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 100
* EL6311.cbl
  5340*    -------------------------------
  5341     05  DCHOLDL PIC S9(0004) COMP.
  5342     05  DCHOLDF PIC  X(0001).
  5343     05  FILLER REDEFINES DCHOLDF.
  5344         10  DCHOLDA PIC  X(0001).
  5345     05  DCHOLDI PIC  X(0005).
  5346*    -------------------------------
  5347     05  DCAVAILL PIC S9(0004) COMP.
  5348     05  DCAVAILF PIC  X(0001).
  5349     05  FILLER REDEFINES DCAVAILF.
  5350         10  DCAVAILA PIC  X(0001).
  5351     05  DCAVAILI PIC  X(0005).
  5352*    -------------------------------
  5353     05  DCGPREML PIC S9(0004) COMP.
  5354     05  DCGPREMF PIC  X(0001).
  5355     05  FILLER REDEFINES DCGPREMF.
  5356         10  DCGPREMA PIC  X(0001).
  5357     05  DCGPREMI PIC  X(0011).
  5358*    -------------------------------
  5359     05  DCBPREML PIC S9(0004) COMP.
  5360     05  DCBPREMF PIC  X(0001).
  5361     05  FILLER REDEFINES DCBPREMF.
  5362         10  DCBPREMA PIC  X(0001).
  5363     05  DCBPREMI PIC  X(0011).
  5364*    -------------------------------
  5365     05  DNTOTALL PIC S9(0004) COMP.
  5366     05  DNTOTALF PIC  X(0001).
  5367     05  FILLER REDEFINES DNTOTALF.
  5368         10  DNTOTALA PIC  X(0001).
  5369     05  DNTOTALI PIC  X(0005).
  5370*    -------------------------------
  5371     05  DNFATALL PIC S9(0004) COMP.
  5372     05  DNFATALF PIC  X(0001).
  5373     05  FILLER REDEFINES DNFATALF.
  5374         10  DNFATALA PIC  X(0001).
  5375     05  DNFATALI PIC  X(0005).
  5376*    -------------------------------
  5377     05  DNFORCEL PIC S9(0004) COMP.
  5378     05  DNFORCEF PIC  X(0001).
  5379     05  FILLER REDEFINES DNFORCEF.
  5380         10  DNFORCEA PIC  X(0001).
  5381     05  DNFORCEI PIC  X(0005).
  5382*    -------------------------------
  5383     05  DNHOLDL PIC S9(0004) COMP.
  5384     05  DNHOLDF PIC  X(0001).
  5385     05  FILLER REDEFINES DNHOLDF.
  5386         10  DNHOLDA PIC  X(0001).
  5387     05  DNHOLDI PIC  X(0005).
  5388*    -------------------------------
  5389     05  DNAVAILL PIC S9(0004) COMP.
  5390     05  DNAVAILF PIC  X(0001).
  5391     05  FILLER REDEFINES DNAVAILF.
  5392         10  DNAVAILA PIC  X(0001).
  5393     05  DNAVAILI PIC  X(0005).
  5394*    -------------------------------
  5395     05  DNGPREML PIC S9(0004) COMP.
  5396     05  DNGPREMF PIC  X(0001).
  5397     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 101
* EL6311.cbl
  5398         10  DNGPREMA PIC  X(0001).
  5399     05  DNGPREMI PIC  X(0011).
  5400*    -------------------------------
  5401     05  DNBPREML PIC S9(0004) COMP.
  5402     05  DNBPREMF PIC  X(0001).
  5403     05  FILLER REDEFINES DNBPREMF.
  5404         10  DNBPREMA PIC  X(0001).
  5405     05  DNBPREMI PIC  X(0011).
  5406*    -------------------------------
  5407     05  DERMSGL PIC S9(0004) COMP.
  5408     05  DERMSGF PIC  X(0001).
  5409     05  FILLER REDEFINES DERMSGF.
  5410         10  DERMSGA PIC  X(0001).
  5411     05  DERMSGI PIC  X(0075).
  5412*    -------------------------------
  5413     05  DPFENTRL PIC S9(0004) COMP.
  5414     05  DPFENTRF PIC  X(0001).
  5415     05  FILLER REDEFINES DPFENTRF.
  5416         10  DPFENTRA PIC  X(0001).
  5417     05  DPFENTRI PIC  9(2).
  5418 01  EL631DO REDEFINES EL631BI.
  5419     05  FILLER            PIC  X(0012).
  5420*    -------------------------------
  5421     05  FILLER            PIC  X(0003).
  5422     05  DDATEO PIC  X(0008).
  5423*    -------------------------------
  5424     05  FILLER            PIC  X(0003).
  5425     05  DTIMEO PIC  99.99.
  5426*    -------------------------------
  5427     05  FILLER            PIC  X(0003).
  5428     05  DHEADO PIC  X(0038).
  5429*    -------------------------------
  5430     05  FILLER            PIC  X(0003).
  5431     05  DLDATEO PIC  X(0010).
  5432*    -------------------------------
  5433     05  FILLER            PIC  X(0003).
  5434     05  DBATCHO PIC  X(0011).
  5435*    -------------------------------
  5436     05  FILLER            PIC  X(0003).
  5437     05  DACCTNMO PIC  X(0030).
  5438*    -------------------------------
  5439     05  FILLER            PIC  X(0003).
  5440     05  DPROCDTO PIC  X(0008).
  5441*    -------------------------------
  5442     05  FILLER            PIC  X(0003).
  5443     05  DINPUTO PIC  X(0008).
  5444*    -------------------------------
  5445     05  FILLER            PIC  X(0003).
  5446     05  DMAINDTO PIC  X(0008).
  5447*    -------------------------------
  5448     05  FILLER            PIC  X(0003).
  5449     05  DCARRO PIC  X(0001).
  5450*    -------------------------------
  5451     05  FILLER            PIC  X(0003).
  5452     05  DGROUPO PIC  X(0006).
  5453*    -------------------------------
  5454     05  FILLER            PIC  X(0003).
  5455     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 102
* EL6311.cbl
  5456*    -------------------------------
  5457     05  FILLER            PIC  X(0003).
  5458     05  DACCTO PIC  X(0010).
  5459*    -------------------------------
  5460     05  FILLER            PIC  X(0003).
  5461     05  DRECVDTO PIC  X(0008).
  5462*    -------------------------------
  5463     05  FILLER            PIC  X(0003).
  5464     05  DCSRO PIC  X(0004).
  5465*    -------------------------------
  5466     05  FILLER            PIC  X(0003).
  5467     05  DREFHDGO PIC  X(0010).
  5468*    -------------------------------
  5469     05  FILLER            PIC  X(0003).
  5470     05  DREFO PIC  X(0012).
  5471*    -------------------------------
  5472     05  FILLER            PIC  X(0003).
  5473     05  DLFPHDGO PIC  X(0010).
  5474*    -------------------------------
  5475     05  FILLER            PIC  X(0003).
  5476     05  DAHPHDGO PIC  X(0010).
  5477*    -------------------------------
  5478     05  FILLER            PIC  X(0003).
  5479     05  DLFRHDGO PIC  X(0009).
  5480*    -------------------------------
  5481     05  FILLER            PIC  X(0003).
  5482     05  DAHRHDGO PIC  X(0009).
  5483*    -------------------------------
  5484     05  FILLER            PIC  X(0003).
  5485     05  DRISSO PIC  ZZ99-.
  5486*    -------------------------------
  5487     05  FILLER            PIC  X(0003).
  5488     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5489*    -------------------------------
  5490     05  FILLER            PIC  X(0003).
  5491     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5492*    -------------------------------
  5493     05  FILLER            PIC  X(0003).
  5494     05  DRCANCO PIC  ZZ99-.
  5495*    -------------------------------
  5496     05  FILLER            PIC  X(0003).
  5497     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5498*    -------------------------------
  5499     05  FILLER            PIC  X(0003).
  5500     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5501*    -------------------------------
  5502     05  FILLER            PIC  X(0003).
  5503     05  DEISSO PIC  ZZ99-.
  5504*    -------------------------------
  5505     05  FILLER            PIC  X(0003).
  5506     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5507*    -------------------------------
  5508     05  FILLER            PIC  X(0003).
  5509     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5510*    -------------------------------
  5511     05  FILLER            PIC  X(0003).
  5512     05  DECANCO PIC  ZZ99-.
  5513*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 103
* EL6311.cbl
  5514     05  FILLER            PIC  X(0003).
  5515     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5516*    -------------------------------
  5517     05  FILLER            PIC  X(0003).
  5518     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5519*    -------------------------------
  5520     05  FILLER            PIC  X(0003).
  5521     05  DCISSO PIC  ZZ99-.
  5522*    -------------------------------
  5523     05  FILLER            PIC  X(0003).
  5524     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5525*    -------------------------------
  5526     05  FILLER            PIC  X(0003).
  5527     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5528*    -------------------------------
  5529     05  FILLER            PIC  X(0003).
  5530     05  DCCANCO PIC  ZZ99-.
  5531*    -------------------------------
  5532     05  FILLER            PIC  X(0003).
  5533     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5534*    -------------------------------
  5535     05  FILLER            PIC  X(0003).
  5536     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5537*    -------------------------------
  5538     05  FILLER            PIC  X(0003).
  5539     05  DOISSO PIC  ZZ99-.
  5540*    -------------------------------
  5541     05  FILLER            PIC  X(0003).
  5542     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5543*    -------------------------------
  5544     05  FILLER            PIC  X(0003).
  5545     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5546*    -------------------------------
  5547     05  FILLER            PIC  X(0003).
  5548     05  DOCANCO PIC  ZZ99-.
  5549*    -------------------------------
  5550     05  FILLER            PIC  X(0003).
  5551     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5552*    -------------------------------
  5553     05  FILLER            PIC  X(0003).
  5554     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5555*    -------------------------------
  5556     05  FILLER            PIC  X(0003).
  5557     05  DITOTALO PIC  ZZZ99.
  5558*    -------------------------------
  5559     05  FILLER            PIC  X(0003).
  5560     05  DIFATALO PIC  ZZZ99.
  5561*    -------------------------------
  5562     05  FILLER            PIC  X(0003).
  5563     05  DIFORCEO PIC  ZZZ99.
  5564*    -------------------------------
  5565     05  FILLER            PIC  X(0003).
  5566     05  DIHOLDO PIC  ZZZ99.
  5567*    -------------------------------
  5568     05  FILLER            PIC  X(0003).
  5569     05  DIAVAILO PIC  ZZZ99.
  5570*    -------------------------------
  5571     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 104
* EL6311.cbl
  5572     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5573*    -------------------------------
  5574     05  FILLER            PIC  X(0003).
  5575     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5576*    -------------------------------
  5577     05  FILLER            PIC  X(0003).
  5578     05  DCTOTALO PIC  ZZZ99.
  5579*    -------------------------------
  5580     05  FILLER            PIC  X(0003).
  5581     05  DCFATALO PIC  ZZZ99.
  5582*    -------------------------------
  5583     05  FILLER            PIC  X(0003).
  5584     05  DCFORCEO PIC  ZZZ99.
  5585*    -------------------------------
  5586     05  FILLER            PIC  X(0003).
  5587     05  DCHOLDO PIC  ZZZ99.
  5588*    -------------------------------
  5589     05  FILLER            PIC  X(0003).
  5590     05  DCAVAILO PIC  ZZZ99.
  5591*    -------------------------------
  5592     05  FILLER            PIC  X(0003).
  5593     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5594*    -------------------------------
  5595     05  FILLER            PIC  X(0003).
  5596     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5597*    -------------------------------
  5598     05  FILLER            PIC  X(0003).
  5599     05  DNTOTALO PIC  ---99.
  5600*    -------------------------------
  5601     05  FILLER            PIC  X(0003).
  5602     05  DNFATALO PIC  ---99.
  5603*    -------------------------------
  5604     05  FILLER            PIC  X(0003).
  5605     05  DNFORCEO PIC  ---99.
  5606*    -------------------------------
  5607     05  FILLER            PIC  X(0003).
  5608     05  DNHOLDO PIC  ---99.
  5609*    -------------------------------
  5610     05  FILLER            PIC  X(0003).
  5611     05  DNAVAILO PIC  ---99.
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DNGPREMO PIC  -------9.99.
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DNBPREMO PIC  -------9.99.
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DERMSGO PIC  X(0075).
  5621*    -------------------------------
  5622     05  FILLER            PIC  X(0003).
  5623     05  DPFENTRO PIC  X(0002).
  5624*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 105
* EL6311.cbl
  5626 01  MAP-B REDEFINES EL631BI.
  5627     12  FILLER                  PIC X(569).
  5628*    12  FILLER                  PIC X(512).
  5629*    12  FILLER                  PIC X(510).
  5630     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5631         16  BKIND-LEN               PIC S9(4)  COMP.
  5632         16  BKIND-ATTRB             PIC X.
  5633         16  BKIND                   PIC XX.
  5634         16  BTYPE-LEN               PIC S9(4)  COMP.
  5635         16  BTYPE-ATTRB             PIC X.
  5636         16  BTYPE                   PIC X(3).
  5637         16  BTERM-LEN               PIC S9(4)  COMP.
  5638         16  BTERM-ATTRB             PIC X.
  5639         16  BTERMI                  PIC 999.
  5640         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5641         16  BBEN-LEN                PIC S9(4)  COMP.
  5642         16  BBEN-ATTRB              PIC X.
  5643         16  BBENI                   PIC 9(10)V99.
  5644*        16  BBENI                   PIC 9(12).
  5645         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5646         16  BPREM-LEN               PIC S9(4)  COMP.
  5647         16  BPREM-ATTRB             PIC X.
  5648         16  BPREMI                  PIC S9(9)V99.
  5649*        16  BPREMI                  PIC 9(11).
  5650         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5651         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5652         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5653         16  BEXPIRE-ATTRB           PIC X.
  5654         16  BEXPIRE                 PIC X(8).
  5655         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5656         16  BCRIT-PERD-ATTRB        PIC X.
  5657         16  BCRIT-PERDI             PIC 99.
  5658         16  BCRIT-PERDO REDEFINES
  5659                         BCRIT-PERDI PIC ZZ.
  5660         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5661         16  BALT-BEN-ATTRB          PIC X.
  5662         16  BALT-BENI               PIC 9(10)V99.
  5663*        16  BALT-BENI               PIC 9(12).
  5664         16  BALT-BENO REDEFINES
  5665                           BALT-BENI PIC Z(9).ZZ.
  5666         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5667         16  BALT-PREM-ATTRB         PIC X.
  5668         16  BALT-PREMI              PIC 9(9)V99.
  5669*        16  BALT-PREMI              PIC 9(11).
  5670         16  BALT-PREMO REDEFINES
  5671                          BALT-PREMI PIC Z(7).ZZ-.
  5672         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5673         16  BBEN-CD-ATTRB           PIC X.
  5674         16  BBEN-CD                 PIC XXX.
  5675         16  BCPREM-LEN              PIC S9(4)  COMP.
  5676         16  BCPREM-ATTRB            PIC X.
  5677         16  BCPREMI                 PIC S9(9)V99.
  5678*        16  BCPREMI                 PIC X(11).
  5679         16  BCPREMO REDEFINES BCPREMI
  5680                                     PIC Z(7).99-.
  5681         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5682         16  BCALT-PREM-ATTRB        PIC X.
  5683         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 106
* EL6311.cbl
  5684         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5685         16  BBEN-ABBR-ATTRB         PIC X.
  5686         16  BBEN-ABBR               PIC X(5).
  5687         16  BDIFF-LEN               PIC S9(4)  COMP.
  5688         16  BDIFF-ATTRB             PIC X.
  5689         16  BDIFFO                  PIC Z(7).99-.
  5690         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5691         16  BBILL-LIT-ATTRB         PIC X.
  5692         16  BBILL-LIT               PIC X(8).
  5693         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5694         16  BDALT-PREM-ATTRB        PIC X.
  5695         16  BDALT-PREM              PIC Z(7).99-.
  5696
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 107
* EL6311.cbl
  5698
  5699****************************************************************
  5700*
  5701* Copyright (c) 2007 by Clerity Solutions, Inc.
  5702* All rights reserved.
  5703*
  5704****************************************************************
  5705 01  DFHEIV.
  5706   02  DFHEIV0               PIC X(35).
  5707   02  DFHEIV1               PIC X(08).
  5708   02  DFHEIV2               PIC X(08).
  5709   02  DFHEIV3               PIC X(08).
  5710   02  DFHEIV4               PIC X(06).
  5711   02  DFHEIV5               PIC X(04).
  5712   02  DFHEIV6               PIC X(04).
  5713   02  DFHEIV7               PIC X(02).
  5714   02  DFHEIV8               PIC X(02).
  5715   02  DFHEIV9               PIC X(01).
  5716   02  DFHEIV10              PIC S9(7) COMP-3.
  5717   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5718   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5719   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5720   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5721   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5722   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5723   02  DFHEIV17              PIC X(04).
  5724   02  DFHEIV18              PIC X(04).
  5725   02  DFHEIV19              PIC X(04).
  5726   02  DFHEIV20              USAGE IS POINTER.
  5727   02  DFHEIV21              USAGE IS POINTER.
  5728   02  DFHEIV22              USAGE IS POINTER.
  5729   02  DFHEIV23              USAGE IS POINTER.
  5730   02  DFHEIV24              USAGE IS POINTER.
  5731   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5732   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5733   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5734   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5735   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5736   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5737   02  FILLER                PIC X(02).
  5738   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5739   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5740   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5741   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5742   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5743 LINKAGE  SECTION.
  5744*****************************************************************
  5745*                                                               *
  5746* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5747* All rights reserved.                                          *
  5748*                                                               *
  5749*****************************************************************
  5750 01  dfheiblk.
  5751     02  eibtime          pic s9(7) comp-3.
  5752     02  eibdate          pic s9(7) comp-3.
  5753     02  eibtrnid         pic x(4).
  5754     02  eibtaskn         pic s9(7) comp-3.
  5755     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 108
* EL6311.cbl
  5756     02  dfheigdi         pic s9(4) comp.
  5757     02  eibcposn         pic s9(4) comp.
  5758     02  eibcalen         pic s9(4) comp.
  5759     02  eibaid           pic x(1).
  5760     02  eibfiller1       pic x(1).
  5761     02  eibfn            pic x(2).
  5762     02  eibfiller2       pic x(2).
  5763     02  eibrcode         pic x(6).
  5764     02  eibfiller3       pic x(2).
  5765     02  eibds            pic x(8).
  5766     02  eibreqid         pic x(8).
  5767     02  eibrsrce         pic x(8).
  5768     02  eibsync          pic x(1).
  5769     02  eibfree          pic x(1).
  5770     02  eibrecv          pic x(1).
  5771     02  eibsend          pic x(1).
  5772     02  eibatt           pic x(1).
  5773     02  eibeoc           pic x(1).
  5774     02  eibfmh           pic x(1).
  5775     02  eibcompl         pic x(1).
  5776     02  eibsig           pic x(1).
  5777     02  eibconf          pic x(1).
  5778     02  eiberr           pic x(1).
  5779     02  eibrldbk         pic x(1).
  5780     02  eiberrcd         pic x(4).
  5781     02  eibsynrb         pic x(1).
  5782     02  eibnodat         pic x(1).
  5783     02  eibfiller5       pic x(2).
  5784     02  eibresp          pic 9(09) comp.
  5785     02  eibresp2         pic 9(09) comp.
  5786     02  dfheigdj         pic s9(4) comp.
  5787     02  dfheigdk         pic s9(4) comp.
  5788 01  DFHCOMMAREA                 PIC X(1300).
  5789*                                COPY ERCPNDB.
  5790******************************************************************
  5791*                                                                *
  5792*                                                                *
  5793*                            ERCPNDB.                            *
  5794*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5795*                            VMOD=2.025                          *
  5796*                                                                *
  5797*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5798*                                                                *
  5799******************************************************************
  5800*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5801*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5802******************************************************************
  5803*                                                                *
  5804*                                                                *
  5805*   FILE TYPE = VSAM,KSDS                                        *
  5806*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5807*                                                                *
  5808*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5809*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5810*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5811*                                                 RKP=13,LEN=36  *
  5812*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5813*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 109
* EL6311.cbl
  5814*                                                RKP=49,LEN=11   *
  5815*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5816*                                      AND CHG-SEQ.)             *
  5817*                                                RKP=60,LEN=15   *
  5818*                                                                *
  5819*   LOG = NO                                                     *
  5820*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5821******************************************************************
  5822******************************************************************
  5823*                   C H A N G E   L O G
  5824*
  5825* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5826*-----------------------------------------------------------------
  5827*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5828* EFFECTIVE    NUMBER
  5829*-----------------------------------------------------------------
  5830* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5831* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5832* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5833* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5834* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5835* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5836* 032306                   PEMA  ADD BOW LOAN NUMBER
  5837* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5838* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5839* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5840* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5841* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5842* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5843* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5844* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5845******************************************************************
  5846
  5847 01  PENDING-BUSINESS.
  5848     12  PB-RECORD-ID                     PIC XX.
  5849         88  VALID-PB-ID                        VALUE 'PB'.
  5850
  5851     12  PB-CONTROL-PRIMARY.
  5852         16  PB-COMPANY-CD                PIC X.
  5853         16  PB-ENTRY-BATCH               PIC X(6).
  5854         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5855         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5856
  5857     12  PB-CONTROL-BY-ACCOUNT.
  5858         16  PB-COMPANY-CD-A1             PIC X.
  5859         16  PB-CARRIER                   PIC X.
  5860         16  PB-GROUPING.
  5861             20  PB-GROUPING-PREFIX       PIC XXX.
  5862             20  PB-GROUPING-PRIME        PIC XXX.
  5863         16  PB-STATE                     PIC XX.
  5864         16  PB-ACCOUNT.
  5865             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5866             20  PB-ACCOUNT-PRIME         PIC X(6).
  5867         16  PB-CERT-EFF-DT               PIC XX.
  5868         16  PB-CERT-NO.
  5869             20  PB-CERT-PRIME            PIC X(10).
  5870             20  PB-CERT-SFX              PIC X.
  5871         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 110
* EL6311.cbl
  5872
  5873         16  PB-RECORD-TYPE               PIC X.
  5874             88  PB-MAILING-DATA                VALUE '0'.
  5875             88  PB-ISSUE                       VALUE '1'.
  5876             88  PB-CANCELLATION                VALUE '2'.
  5877             88  PB-BATCH-TRAILER               VALUE '9'.
  5878
  5879     12  PB-CONTROL-BY-ORIG-BATCH.
  5880         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5881         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5882         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5883         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5884
  5885     12  PB-CONTROL-BY-CSR.
  5886         16  PB-CSR-COMPANY-CD            PIC X.
  5887         16  PB-CSR-ID                    PIC X(4).
  5888         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5889         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5890         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5891******************************************************************
  5892*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5893******************************************************************
  5894
  5895     12  PB-LAST-MAINT-DT                 PIC XX.
  5896     12  PB-LAST-MAINT-BY                 PIC X(4).
  5897     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5898
  5899     12  PB-RECORD-BODY                   PIC X(375).
  5900
  5901     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5902         16  PB-CERT-ORIGIN               PIC X.
  5903             88  CLASIC-CREATED-CERT         VALUE '1'.
  5904         16  PB-I-NAME.
  5905             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5906             20  PB-I-INSURED-FIRST-NAME.
  5907                 24  PB-I-INSURED-1ST-INIT PIC X.
  5908                 24  FILLER                PIC X(9).
  5909             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5910         16  PB-I-AGE                     PIC S99   COMP-3.
  5911         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5912         16  PB-I-BIRTHDAY                PIC XX.
  5913         16  PB-I-INSURED-SEX             PIC X.
  5914             88  PB-SEX-MALE     VALUE 'M'.
  5915             88  PB-SEX-FEMALE   VALUE 'F'.
  5916
  5917         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5918         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5919         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5920         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5921         16  PB-I-SKIP-CODE               PIC X.
  5922             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5923             88  PB-SKIP-JULY              VALUE '1'.
  5924             88  PB-SKIP-AUGUST            VALUE '2'.
  5925             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5926             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5927             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5928             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5929             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 111
* EL6311.cbl
  5930             88  PB-SKIP-JUNE              VALUE '8'.
  5931             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5932             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5933             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5934         16  PB-I-TERM-TYPE               PIC X.
  5935             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5936             88  PB-PAID-WEEKLY            VALUE 'W'.
  5937             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5938             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5939             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5940         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5941         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5942         16  PB-I-DATA-ENTRY-SW           PIC X.
  5943             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5944             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5945             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5946             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5947         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5948         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5949*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5950         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5951         16  FILLER                       PIC X.
  5952
  5953         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5954             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5955             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5956                                                   '90' THRU '99'.
  5957         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5958                                          PIC XX.
  5959         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5960         16  PB-I-AMOUNT-FINANCED REDEFINES
  5961                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5962         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5963         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5964                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5965         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5966         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5967         16  PB-I-CLP-AMOUNT REDEFINES
  5968                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5969         16  PB-I-LF-CALC-FLAG            PIC X.
  5970             88 PB-COMP-LF-PREM               VALUE '?'.
  5971         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5972         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5973         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5974         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5975         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5976         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5977         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5978         16  PB-I-LF-ABBR                 PIC XXX.
  5979         16  PB-I-LF-INPUT-CD             PIC XX.
  5980
  5981         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5982             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5983             88  PB-INVALID-AH               VALUE '  ' '00'
  5984                                                   '90' THRU '99'.
  5985         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5986         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5987         16  PB-I-AH-CALC-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 112
* EL6311.cbl
  5988             88 PB-COMP-AH-PREM                  VALUE '?'.
  5989         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5990         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5991         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5992         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5993         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5994         16  PB-I-AH-ABBR                 PIC XXX.
  5995         16  PB-I-AH-INPUT-CD             PIC XXX.
  5996
  5997         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5998         16  PB-I-REIN-TABLE              PIC XXX.
  5999         16  PB-I-BUSINESS-TYPE           PIC 99.
  6000         16  PB-I-INDV-GRP-CD             PIC X.
  6001         16  PB-I-MORT-CODE.
  6002             20  PB-I-TABLE               PIC X.
  6003             20  PB-I-INTEREST            PIC XX.
  6004             20  PB-I-MORT-TYP            PIC X.
  6005         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6006         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6007         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6008         16  PB-I-INDV-GRP-OVRD           PIC X.
  6009         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6010         16  PB-I-SIG-SW                  PIC X.
  6011             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6012         16  PB-I-RATE-CLASS              PIC XX.
  6013         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6014         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6015         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6016         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6017         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6018         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6019         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6020         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6021         16  PB-I-OB-FLAG                 PIC X.
  6022             88  PB-I-OB                      VALUE 'B'.
  6023             88  PB-I-SUMMARY                 VALUE 'Z'.
  6024         16  PB-I-ENTRY-STATUS            PIC X.
  6025             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6026                                              'M' '5' '9' '2'.
  6027             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6028             88  PB-I-POLICY-PENDING          VALUE '2'.
  6029             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6030             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6031             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6032             88  PB-I-REIN-ONLY               VALUE '9'.
  6033             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6034             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6035             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6036             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6037         16  PB-I-INT-CODE                PIC X.
  6038             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6039             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6040         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6041         16  PB-I-SOC-SEC-NO              PIC X(11).
  6042         16  PB-I-MEMBER-NO               PIC X(12).
  6043         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6044*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6045         16  PB-I-OLD-LOF                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 113
* EL6311.cbl
  6046         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6047         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6048         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6049         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6050         16  PB-I-LIFE-INDICATOR          PIC X.
  6051             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6052         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6053         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6054                                          PIC S9(5)V99    COMP-3.
  6055         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6056             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6057             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6058         16  PB-I-1ST-PMT-DT              PIC XX.
  6059         16  PB-I-JOINT-INSURED.
  6060             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6061             20 PB-I-JOINT-FIRST-NAME.
  6062                24  PB-I-JOINT-FIRST-INIT PIC X.
  6063                24  FILLER                PIC X(9).
  6064             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6065*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6066         16  PB-I-BENEFICIARY-NAME.
  6067             20  PB-I-BANK-NUMBER         PIC X(10).
  6068             20  FILLER                   PIC X(15).
  6069         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6070         16  PB-I-REFERENCE               PIC X(12).
  6071         16  FILLER REDEFINES PB-I-REFERENCE.
  6072             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6073             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6074             20  PB-I-CLP-STATE           PIC XX.
  6075         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6076             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6077             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6078             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6079         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6080         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6081         16  PB-I-RESIDENT-STATE          PIC XX.
  6082         16  PB-I-RATE-CODE               PIC X(4).
  6083         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6084         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6085         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6086         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6087         16  PB-I-BANK-NOCHRGB            PIC 99.
  6088         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6089         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6090
  6091     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6092         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6093             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6094         16  PB-C-CANCEL-ORIGIN           PIC X.
  6095             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6096         16  PB-C-LF-CANCEL-DT            PIC XX.
  6097         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6098         16  PB-C-LF-CALC-REQ             PIC X.
  6099             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6100         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6101         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6102         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6103             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 114
* EL6311.cbl
  6104         16  PB-C-AH-CANCEL-DT            PIC XX.
  6105         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6106         16  PB-C-AH-CALC-REQ             PIC X.
  6107             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6108         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6109         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6110         16  PB-C-LAST-NAME               PIC X(15).
  6111         16  PB-C-REFUND-SW               PIC X.
  6112             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6113             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6114         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6115         16  PB-C-PAYEE-CODE              PIC X(6).
  6116         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6117         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6118         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6119         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6120         16  PB-C-REFERENCE               PIC X(12).
  6121         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6122         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6123         16  PB-C-POST-CARD-IND           PIC X.
  6124         16  PB-C-CANCEL-REASON           PIC X.
  6125         16  PB-C-REF-INTERFACE-SW        PIC X.
  6126         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6127         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6128         16  FILLER                       PIC X(01).
  6129*        16  FILLER                       PIC X(18).
  6130         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6131*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6132         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6133         16  PB-CANCELED-CERT-DATA.
  6134             20  PB-CI-INSURED-NAME.
  6135                 24  PB-CI-LAST-NAME      PIC X(15).
  6136                 24  PB-CI-INITIALS       PIC XX.
  6137             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6138             20  PB-CI-INSURED-SEX        PIC X.
  6139             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6140             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6141             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6142             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6143             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6144             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6145             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6146             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6147             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6148             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6149             20  PB-CI-RATE-CLASS         PIC XX.
  6150             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6151             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6152             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6153             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6154             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6155             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6156             20  PB-CI-LF-ABBR            PIC X(3).
  6157             20  PB-CI-AH-ABBR            PIC X(3).
  6158             20  PB-CI-OB-FLAG            PIC X.
  6159                 88  PB-CI-OB                VALUE 'B'.
  6160             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6161                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 115
* EL6311.cbl
  6162                                           'M' '4' '5' '9' '2'.
  6163                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6164                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6165                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6166                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6167                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6168                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6169                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6170                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6171                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6172                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6173                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6174                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6175             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6176                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6177                                           'M' '4' '5' '9' '2'.
  6178                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6179                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6180                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6181                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6182                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6183                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6184                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6185                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6186                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6187                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6188                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6189                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6190             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6191             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6192             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6193             20  PB-CI-MEMBER-NO          PIC X(12).
  6194             20  PB-CI-INT-CODE           PIC X.
  6195                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6196                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6197             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6198             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6199             20  PB-CI-COMP-EXCP-SW       PIC X.
  6200                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6201                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6202             20  PB-CI-ENTRY-STATUS       PIC X.
  6203             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6204             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6205             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6206             20  PB-CI-DEATH-DT           PIC XX.
  6207             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6208             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6209             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6210             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6211             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6212             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6213             20  PB-CI-ENTRY-DT              PIC XX.
  6214             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6215             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6216             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6217             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6218             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6219             20  PB-CI-OLD-LOF               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 116
* EL6311.cbl
  6220*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6221             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6222             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6223             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6224             20  PB-CI-INDV-GRP-CD           PIC X.
  6225             20  PB-CI-BENEFICIARY-NAME.
  6226                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6227                 24  FILLER                  PIC X(15).
  6228             20  PB-CI-NOTE-SW               PIC X.
  6229             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6230             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6231             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6232             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6233             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6234             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6235             20  PB-CI-FIRST-NAME            PIC X(10).
  6236             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6237
  6238         16  FILLER                       PIC X(13).
  6239*032306  16  FILLER                       PIC X(27).
  6240*        16  FILLER                       PIC X(46).
  6241
  6242     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6243         16  FILLER                       PIC X(10).
  6244         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6245         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6246         16  PB-M-INSURED-MID-INIT        PIC X.
  6247         16  PB-M-INSURED-AGE             PIC 99.
  6248         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6249         16  PB-M-INSURED-SEX             PIC X.
  6250         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6251         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6252         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6253         16  PB-M-INSURED-CITY-STATE.
  6254             20  PB-M-INSURED-CITY        PIC X(28).
  6255             20  PB-M-INSURED-STATE       PIC XX.
  6256         16  PB-M-INSURED-ZIP-CODE.
  6257             20  PB-M-INSURED-ZIP-PRIME.
  6258                 24  PB-M-INSURED-ZIP-1   PIC X.
  6259                     88  PB-M-CANADIAN-POST-CODE
  6260                                             VALUE 'A' THRU 'Z'.
  6261                 24  FILLER               PIC X(4).
  6262             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6263         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6264                                        PB-M-INSURED-ZIP-CODE.
  6265             20  PM-M-INS-CAN-POST1       PIC XXX.
  6266             20  PM-M-INS-CAN-POST2       PIC XXX.
  6267             20  FILLER                   PIC XXX.
  6268         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6269         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6270         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6271         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6272         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6273         16  PB-M-CRED-BENE-CITYST.
  6274             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6275             20  PB-M-CRED-BENE-STATE     PIC XX.
  6276         16  FILLER                       PIC X(92).
  6277
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 117
* EL6311.cbl
  6278     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6279         16  FILLER                       PIC X(10).
  6280         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6281         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6282         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6283         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6284         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6285         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6286         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6287         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6288         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6289         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6290         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6291         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6292         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6293         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6294         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6295         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6296         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6297         16  PB-ACCOUNT-NAME              PIC X(30).
  6298         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6299         16  PB-REFERENCE                 PIC X(12).
  6300         16  PB-B-RECEIVED-DT             PIC XX.
  6301         16  FILLER                       PIC X(234).
  6302
  6303     12  PB-RECORD-STATUS.
  6304         16  PB-CREDIT-SELECT-DT          PIC XX.
  6305         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6306         16  PB-BILLED-DT                 PIC XX.
  6307         16  PB-BILLING-STATUS            PIC X.
  6308             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6309             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6310             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6311         16  PB-RECORD-BILL               PIC X.
  6312             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6313             88  PB-RECORD-RETURNED           VALUE 'R'.
  6314             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6315             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6316             88  PB-OVERRIDE-AH               VALUE 'A'.
  6317             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6318         16  PB-BATCH-ENTRY               PIC X.
  6319             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6320             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6321             88  PB-REISSUED-CERT             VALUE 'E'.
  6322             88  PB-MONTHLY-CERT              VALUE 'M'.
  6323             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6324             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6325             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6326         16  PB-FORCE-CODE                PIC X.
  6327             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6328             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6329             88  PB-CANCEL-FORCE              VALUE '8'.
  6330             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6331             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6332             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6333             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6334             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6335             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 118
* EL6311.cbl
  6336             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6337         16  PB-FATAL-FLAG                PIC X.
  6338             88  PB-FATAL-ERRORS              VALUE 'X'.
  6339         16  PB-FORCE-ER-CD               PIC X.
  6340             88  PB-FORCE-ERRORS              VALUE 'F'.
  6341             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6342         16  PB-WARN-ER-CD                PIC X.
  6343             88  PB-WARNING-ERRORS            VALUE 'W'.
  6344         16  FILLER                       PIC X.
  6345         16  PB-OUT-BAL-CD                PIC X.
  6346             88  PB-OUT-OF-BAL                VALUE 'O'.
  6347         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6348         16  PB-AH-OVERRIDE-L1            PIC X.
  6349         16  PB-INPUT-DT                  PIC XX.
  6350         16  PB-INPUT-BY                  PIC X(4).
  6351         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6352         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6353         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6354         16  PB-LF-EARNING-METHOD         PIC X.
  6355         16  PB-AH-EARNING-METHOD         PIC X.
  6356         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6357         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6358         16  PB-REIN-CD                   PIC XXX.
  6359         16  PB-LF-REFUND-TYPE            PIC X.
  6360         16  PB-AH-REFUND-TYPE            PIC X.
  6361         16  PB-ACCT-EFF-DT               PIC XX.
  6362         16  PB-ACCT-EXP-DT               PIC XX.
  6363         16  PB-COMPANY-ID                PIC X(3).
  6364         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6365         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6366         16  PB-SV-CARRIER                PIC X.
  6367         16  PB-SV-GROUPING               PIC X(6).
  6368         16  PB-SV-STATE                  PIC XX.
  6369         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6370         16  PB-GA-BILLING-INFO.
  6371             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6372                                          PIC XX.
  6373         16  PB-SV-REMIT-TO  REDEFINES
  6374             PB-GA-BILLING-INFO           PIC X(10).
  6375         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6376         16  PB-I-LOAN-OFFICER            PIC X(5).
  6377         16  PB-I-VIN                     PIC X(17).
  6378
  6379         16  FILLER                       PIC X(04).
  6380         16  IMNET-BYPASS-SW              PIC X.
  6381
  6382******************************************************************
  6383*                COMMON EDIT ERRORS                              *
  6384******************************************************************
  6385
  6386     12  PB-COMMON-ERRORS.
  6387         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6388                                           PIC S9(4)     COMP.
  6389
  6390******************************************************************
  6391*                                COPY ELCCERT.
  6392******************************************************************
  6393*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 119
* EL6311.cbl
  6394*                            ELCCERT.                            *
  6395*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6396*                            VMOD=2.013                          *
  6397*                                                                *
  6398*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6399*                                                                *
  6400*   FILE TYPE = VSAM,KSDS                                        *
  6401*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6402*                                                                *
  6403*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6404*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6405*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6406*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6407*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6408*                                                                *
  6409*   LOG = YES                                                    *
  6410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6411******************************************************************
  6412*                   C H A N G E   L O G
  6413*
  6414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6415*-----------------------------------------------------------------
  6416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6417* EFFECTIVE    NUMBER
  6418*-----------------------------------------------------------------
  6419* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6420* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6421* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6422* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6423* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6424* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6425* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6426* 032612  CR2011110200001  PEMA  AHL CHANGES
  6427******************************************************************
  6428
  6429 01  CERTIFICATE-MASTER.
  6430     12  CM-RECORD-ID                      PIC XX.
  6431         88  VALID-CM-ID                      VALUE 'CM'.
  6432
  6433     12  CM-CONTROL-PRIMARY.
  6434         16  CM-COMPANY-CD                 PIC X.
  6435         16  CM-CARRIER                    PIC X.
  6436         16  CM-GROUPING.
  6437             20  CM-GROUPING-PREFIX        PIC X(3).
  6438             20  CM-GROUPING-PRIME         PIC X(3).
  6439         16  CM-STATE                      PIC XX.
  6440         16  CM-ACCOUNT.
  6441             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6442             20  CM-ACCOUNT-PRIME          PIC X(6).
  6443         16  CM-CERT-EFF-DT                PIC XX.
  6444         16  CM-CERT-NO.
  6445             20  CM-CERT-PRIME             PIC X(10).
  6446             20  CM-CERT-SFX               PIC X.
  6447
  6448     12  CM-CONTROL-BY-NAME.
  6449         16  CM-COMPANY-CD-A1              PIC X.
  6450         16  CM-INSURED-LAST-NAME          PIC X(15).
  6451         16  CM-INSURED-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 120
* EL6311.cbl
  6452             20  CM-INSURED-INITIAL1       PIC X.
  6453             20  CM-INSURED-INITIAL2       PIC X.
  6454
  6455     12  CM-CONTROL-BY-SSN.
  6456         16  CM-COMPANY-CD-A2              PIC X.
  6457         16  CM-SOC-SEC-NO.
  6458             20  CM-SSN-STATE              PIC XX.
  6459             20  CM-SSN-ACCOUNT            PIC X(6).
  6460             20  CM-SSN-LN3.
  6461                 25  CM-INSURED-INITIALS-A2.
  6462                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6463                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6464                 25 CM-PART-LAST-NAME-A2         PIC X.
  6465
  6466     12  CM-CONTROL-BY-CERT-NO.
  6467         16  CM-COMPANY-CD-A4              PIC X.
  6468         16  CM-CERT-NO-A4                 PIC X(11).
  6469
  6470     12  CM-CONTROL-BY-MEMB.
  6471         16  CM-COMPANY-CD-A5              PIC X.
  6472         16  CM-MEMBER-NO.
  6473             20  CM-MEMB-STATE             PIC XX.
  6474             20  CM-MEMB-ACCOUNT           PIC X(6).
  6475             20  CM-MEMB-LN4.
  6476                 25  CM-INSURED-INITIALS-A5.
  6477                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6478                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6479                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6480
  6481     12  CM-INSURED-PROFILE-DATA.
  6482         16  CM-INSURED-FIRST-NAME.
  6483             20  CM-INSURED-1ST-INIT       PIC X.
  6484             20  FILLER                    PIC X(9).
  6485         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6486         16  CM-INSURED-SEX                PIC X.
  6487             88  CM-SEX-MALE                  VALUE 'M'.
  6488             88  CM-SEX-FEMAL                 VALUE 'F'.
  6489         16  CM-INSURED-JOINT-AGE          PIC 99.
  6490         16  CM-JOINT-INSURED-NAME.
  6491             20  CM-JT-LAST-NAME           PIC X(15).
  6492             20  CM-JT-FIRST-NAME.
  6493                 24  CM-JT-1ST-INIT        PIC X.
  6494                 24  FILLER                PIC X(9).
  6495             20  CM-JT-INITIAL             PIC X.
  6496
  6497     12  CM-LIFE-DATA.
  6498         16  CM-LF-BENEFIT-CD              PIC XX.
  6499         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6500         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6501         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6502         16  CM-LF-DEV-CODE                PIC XXX.
  6503         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6504         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6505         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6506         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6507         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6508         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6509         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 121
* EL6311.cbl
  6510         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6511         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6512         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6513         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6514         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6515         16  FILLER                        PIC XX.
  6516
  6517     12  CM-AH-DATA.
  6518         16  CM-AH-BENEFIT-CD              PIC XX.
  6519         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6520         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6521         16  CM-AH-DEV-CODE                PIC XXX.
  6522         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6523         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6524         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6525         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6526         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6527         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6528         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6529         16  CM-AH-PAID-THRU-DT            PIC XX.
  6530             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6531         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6532         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6533         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6534         16  FILLER                        PIC X.
  6535
  6536     12  CM-LOAN-INFORMATION.
  6537         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6538         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6539                                           PIC S9(5)V99  COMP-3.
  6540         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6541         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6542         16  CM-PAY-FREQUENCY              PIC S99.
  6543         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6544         16  CM-RATE-CLASS                 PIC XX.
  6545         16  CM-BENEFICIARY                PIC X(25).
  6546         16  CM-POLICY-FORM-NO             PIC X(12).
  6547         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6548         16  CM-LAST-ADD-ON-DT             PIC XX.
  6549         16  CM-DEDUCTIBLE-AMOUNTS.
  6550             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6551             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6552         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6553             20  CM-RESIDENT-STATE         PIC XX.
  6554             20  CM-RATE-CODE              PIC X(4).
  6555             20  FILLER                    PIC XX.
  6556         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6557             20  CM-LOAN-OFFICER           PIC X(5).
  6558             20  FILLER                    PIC XXX.
  6559         16  CM-CSR-CODE                   PIC XXX.
  6560         16  CM-UNDERWRITING-CODE          PIC X.
  6561             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6562         16  CM-POST-CARD-IND              PIC X.
  6563         16  CM-NH-INTERFACE-SW            PIC X.
  6564         16  CM-PREMIUM-TYPE               PIC X.
  6565             88  CM-SING-PRM                  VALUE '1'.
  6566             88  CM-O-B-COVERAGE              VALUE '2'.
  6567             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 122
* EL6311.cbl
  6568         16  CM-IND-GRP-TYPE               PIC X.
  6569             88  CM-INDIVIDUAL                VALUE 'I'.
  6570             88  CM-GROUP                     VALUE 'G'.
  6571         16  CM-SKIP-CODE                  PIC X.
  6572             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6573             88  SKIP-JULY                    VALUE '1'.
  6574             88  SKIP-AUGUST                  VALUE '2'.
  6575             88  SKIP-SEPTEMBER               VALUE '3'.
  6576             88  SKIP-JULY-AUG                VALUE '4'.
  6577             88  SKIP-AUG-SEPT                VALUE '5'.
  6578             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6579             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6580             88  SKIP-JUNE                    VALUE '8'.
  6581             88  SKIP-JUNE-JULY               VALUE '9'.
  6582             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6583             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6584         16  CM-PAYMENT-MODE               PIC X.
  6585             88  PAY-MONTHLY                  VALUE SPACE.
  6586             88  PAY-WEEKLY                   VALUE '1'.
  6587             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6588             88  PAY-BI-WEEKLY                VALUE '3'.
  6589             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6590         16  CM-LOAN-NUMBER                PIC X(8).
  6591         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6592         16  CM-OLD-LOF                    PIC XXX.
  6593*        16  CM-LOAN-OFFICER               PIC XXX.
  6594         16  CM-REIN-TABLE                 PIC XXX.
  6595         16  CM-SPECIAL-REIN-CODE          PIC X.
  6596         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6597         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6598         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6599
  6600     12  CM-STATUS-DATA.
  6601         16  CM-ENTRY-STATUS               PIC X.
  6602         16  CM-ENTRY-DT                   PIC XX.
  6603
  6604         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6605         16  CM-LF-CANCEL-DT               PIC XX.
  6606         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6607
  6608         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6609         16  CM-LF-DEATH-DT                PIC XX.
  6610         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6611
  6612         16  CM-LF-CURRENT-STATUS          PIC X.
  6613             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6614                                                'M' '4' '5' '9'.
  6615             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6616             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6617             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6618             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6619             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6620             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6621             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6622             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6623             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6624             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6625             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 123
* EL6311.cbl
  6626             88  CM-LF-VOIDED                 VALUE 'V'.
  6627
  6628         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6629         16  CM-AH-CANCEL-DT               PIC XX.
  6630         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6631
  6632         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6633         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6634         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6635
  6636         16  CM-AH-CURRENT-STATUS          PIC X.
  6637             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6638                                                'M' '4' '5' '9'.
  6639             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6640             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6641             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6642             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6643             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6644             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6645             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6646             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6647             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6648             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6649             88  CM-AH-DECLINED               VALUE 'D'.
  6650             88  CM-AH-VOIDED                 VALUE 'V'.
  6651
  6652         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6653             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6654             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6655             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6656         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6657
  6658         16  CM-ENTRY-BATCH                PIC X(6).
  6659         16  CM-LF-EXIT-BATCH              PIC X(6).
  6660         16  CM-AH-EXIT-BATCH              PIC X(6).
  6661         16  CM-LAST-MONTH-END             PIC XX.
  6662
  6663     12  CM-NOTE-SW                        PIC X.
  6664         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6665         88  CERT-NOTES-PRESENT               VALUE '1'.
  6666         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6667         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6668         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6669         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6670         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6671         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6672     12  CM-COMP-EXCP-SW                   PIC X.
  6673         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6674         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6675     12  CM-INSURED-ADDRESS-SW             PIC X.
  6676         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6677         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6678
  6679*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6680     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6681     12  FILLER                            PIC X.
  6682
  6683*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 124
* EL6311.cbl
  6684     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6685     12  FILLER                            PIC X.
  6686*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6687     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6688
  6689     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6690         88  CERT-ADDED-BATCH                 VALUE ' '.
  6691         88  CERT-ADDED-ONLINE                VALUE '1'.
  6692         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6693         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6694         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6695     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6696         88  CERT-AS-LOADED                   VALUE ' '.
  6697         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6698         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6699         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6700         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6701         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6702         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6703         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6704
  6705     12  CM-ACCOUNT-COMM-PCTS.
  6706         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6707         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6708
  6709     12  CM-USER-FIELD                     PIC X.
  6710     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6711     12  CM-CLP-STATE                      PIC XX.
  6712     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6713     12  CM-USER-RESERVED                  PIC XXX.
  6714     12  FILLER REDEFINES CM-USER-RESERVED.
  6715         16  CM-AH-CLASS-CD                PIC XX.
  6716         16  F                             PIC X.
  6717******************************************************************
  6718*                                COPY ERCNOTE.
  6719******************************************************************
  6720*                                                                *
  6721*                                                                *
  6722*                            ERCNOTE                             *
  6723*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6724*                            VMOD=2.003                          *
  6725*                                                                *
  6726*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6727*                                                                *
  6728*        FILE TYPE= VSAM,KSDS                                    *
  6729*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6730*                                                                *
  6731*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6732*                                                                *
  6733*        LOG = YES                                               *
  6734*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6735*                                                                *
  6736******************************************************************
  6737*                   C H A N G E   L O G
  6738*
  6739* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6740*-----------------------------------------------------------------
  6741*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 125
* EL6311.cbl
  6742* EFFECTIVE    NUMBER
  6743*-----------------------------------------------------------------
  6744* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6745*                                FILE WILL CONTAIN BILLING NOTES O
  6746******************************************************************
  6747
  6748 01  CERTIFICATE-NOTE.
  6749     12  CN-RECORD-ID                PIC  XX.
  6750         88  VALID-CN-ID                  VALUE 'CN'.
  6751
  6752     12  CN-CONTROL-PRIMARY.
  6753         16  CN-COMPANY-CD           PIC X.
  6754         16  CN-CARRIER              PIC X.
  6755         16  CN-GROUPING.
  6756             20 CN-GROUPING-PREFIX   PIC XXX.
  6757             20 CN-GROUPING-PRIME    PIC XXX.
  6758         16  CN-STATE                PIC XX.
  6759         16  CN-ACCOUNT.
  6760             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6761             20 CN-ACCOUNT-PRIME     PIC X(6).
  6762         16  CN-CERT-EFF-DT          PIC XX.
  6763         16  CN-CERT-NO.
  6764             20  CN-CERT-PRIME       PIC X(10).
  6765             20  CN-CERT-SFX         PIC X.
  6766
  6767     12  CN-BILLING-START-LINE-NO    PIC 99.
  6768     12  CN-BILLING-END-LINE-NO      PIC 99.
  6769
  6770     12  CN-LINES.
  6771         16  CN-LINE OCCURS 10       PIC X(77).
  6772
  6773     12  CN-LAST-MAINT-DT            PIC XX.
  6774     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6775     12  CN-LAST-MAINT-USER          PIC X(4).
  6776     12  FILLER                      PIC X(6).
  6777******************************************************************
  6778*                                COPY ERCPNDM.
  6779******************************************************************
  6780*                                                                *
  6781*                                                                *
  6782*                            ERCPNDM                             *
  6783*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6784*                            VMOD=2.003                          *
  6785*                                                                *
  6786*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6787*                                                                *
  6788*   FILE TYPE = VSAM,KSDS                                        *
  6789*   RECORD SIZE = 374   RECFORM = FIX                            *
  6790*                                                                *
  6791*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6792*   ALTERNATE PATH    = NOT USED                                 *
  6793*                                                                *
  6794*   LOG = YES                                                    *
  6795*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6796******************************************************************
  6797*                   C H A N G E   L O G
  6798*
  6799* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 126
* EL6311.cbl
  6800*-----------------------------------------------------------------
  6801*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6802* EFFECTIVE    NUMBER
  6803*-----------------------------------------------------------------
  6804* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6805* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6806* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6807******************************************************************
  6808
  6809 01  PENDING-MAILING-DATA.
  6810     12  PM-RECORD-ID                      PIC XX.
  6811         88  VALID-MA-ID                       VALUE 'PM'.
  6812
  6813     12  PM-CONTROL-PRIMARY.
  6814         16  PM-COMPANY-CD                 PIC X.
  6815         16  PM-ENTRY-BATCH                PIC X(6).
  6816         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6817         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6818
  6819     12  FILLER                            PIC X(14).
  6820
  6821     12  PM-ACCESS-CONTROL.
  6822         16  PM-SOURCE-SYSTEM              PIC XX.
  6823             88  PM-FROM-CREDIT                VALUE 'CR'.
  6824             88  PM-FROM-VSI                   VALUE 'VS'.
  6825             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6826             88  PM-FROM-OTHER                 VALUE 'OT'.
  6827         16  PM-RECORD-ADD-DT              PIC XX.
  6828         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6829         16  PM-LAST-MAINT-DT              PIC XX.
  6830         16  PM-LAST-MAINT-BY              PIC XXXX.
  6831         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6832
  6833     12  PM-PROFILE-INFO.
  6834         16  PM-QUALIFY-CODE-1             PIC XX.
  6835         16  PM-QUALIFY-CODE-2             PIC XX.
  6836         16  PM-QUALIFY-CODE-3             PIC XX.
  6837         16  PM-QUALIFY-CODE-4             PIC XX.
  6838         16  PM-QUALIFY-CODE-5             PIC XX.
  6839
  6840         16  PM-INSURED-LAST-NAME          PIC X(15).
  6841         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6842         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6843         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6844         16  PM-INSURED-BIRTH-DT           PIC XX.
  6845         16  PM-INSURED-SEX                PIC X.
  6846             88  PM-SEX-MALE                   VALUE 'M'.
  6847             88  PM-SEX-FEMALE                 VALUE 'F'.
  6848         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6849
  6850         16  PM-ADDRESS-CORRECTED          PIC X.
  6851         16  PM-JOINT-BIRTH-DT             PIC XX.
  6852*        16  FILLER                        PIC X(12).
  6853
  6854         16  PM-ADDRESS-LINE-1             PIC X(30).
  6855         16  PM-ADDRESS-LINE-2             PIC X(30).
  6856         16  PM-CITY-STATE.
  6857             20  PM-CITY                   PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 127
* EL6311.cbl
  6858             20  PM-STATE                  PIC XX.
  6859         16  PM-ZIP.
  6860             20  PM-ZIP-CODE.
  6861                 24  PM-ZIP-1              PIC X.
  6862                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6863                 24  FILLER                PIC X(4).
  6864             20  PM-ZIP-PLUS4              PIC X(4).
  6865         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6866             20  PM-CAN-POST1              PIC XXX.
  6867             20  PM-CAN-POST2              PIC XXX.
  6868             20  FILLER                    PIC XXX.
  6869
  6870         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6871
  6872         16  FILLER                        PIC X(03).
  6873
  6874     12  PM-CRED-BENE-INFO.
  6875         16  PM-CRED-BENE-NAME             PIC X(25).
  6876         16  PM-CRED-BENE-ADDR             PIC X(30).
  6877         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6878         16  PM-CRED-BENE-CTYST.
  6879             20  PM-CRED-BENE-CITY         PIC X(28).
  6880             20  PM-CRED-BENE-STATE        PIC XX.
  6881         16  PM-CRED-BENE-ZIP.
  6882             20  PM-CB-ZIP-CODE.
  6883                 24  PM-CB-ZIP-1           PIC X.
  6884                     88  PM-CB-CANADIAN-POST-CODE
  6885                                  VALUE 'A' THRU 'Z'.
  6886                 24  FILLER                PIC X(4).
  6887             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6888         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6889             20  PM-CB-CAN-POST1           PIC XXX.
  6890             20  PM-CB-CAN-POST2           PIC XXX.
  6891             20  FILLER                    PIC XXX.
  6892     12  PM-POST-CARD-MAIL-DATA.
  6893         16  PM-MAIL-DATA OCCURS 7.
  6894             20  PM-MAIL-TYPE              PIC X.
  6895                 88  PM-12MO-MAILING           VALUE '1'.
  6896                 88  PM-EXP-MAILING            VALUE '2'.
  6897             20  PM-MAIL-STATUS            PIC X.
  6898                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6899                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6900                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6901             20  PM-MAIL-DATE              PIC XX.
  6902     12  FILLER                            PIC XX.
  6903     12  FILLER                            PIC X(12).
  6904*    12  FILLER                            PIC X(30).
  6905
  6906******************************************************************
  6907*                                COPY ERCMAIL.
  6908******************************************************************
  6909*                                                                *
  6910*                                                                *
  6911*                            ERCMAIL                             *
  6912*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6913*                            VMOD=2.003                          *
  6914*                                                                *
  6915*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 128
* EL6311.cbl
  6916*                                                                *
  6917*   FILE TYPE = VSAM,KSDS                                        *
  6918*   RECORD SIZE = 374   RECFORM = FIX                            *
  6919*                                                                *
  6920*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6921*   ALTERNATE PATH    = NOT USED                                 *
  6922*                                                                *
  6923*   LOG = YES                                                    *
  6924*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6925******************************************************************
  6926*                   C H A N G E   L O G
  6927*
  6928* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6929*-----------------------------------------------------------------
  6930*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6931* EFFECTIVE    NUMBER
  6932*-----------------------------------------------------------------
  6933* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6934* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6935* 111108                   PEMA  ADD CRED BENE ADDR2
  6936******************************************************************
  6937
  6938 01  MAILING-DATA.
  6939     12  MA-RECORD-ID                      PIC XX.
  6940         88  VALID-MA-ID                       VALUE 'MA'.
  6941
  6942     12  MA-CONTROL-PRIMARY.
  6943         16  MA-COMPANY-CD                 PIC X.
  6944         16  MA-CARRIER                    PIC X.
  6945         16  MA-GROUPING.
  6946             20  MA-GROUPING-PREFIX        PIC XXX.
  6947             20  MA-GROUPING-PRIME         PIC XXX.
  6948         16  MA-STATE                      PIC XX.
  6949         16  MA-ACCOUNT.
  6950             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6951             20  MA-ACCOUNT-PRIME          PIC X(6).
  6952         16  MA-CERT-EFF-DT                PIC XX.
  6953         16  MA-CERT-NO.
  6954             20  MA-CERT-PRIME             PIC X(10).
  6955             20  MA-CERT-SFX               PIC X.
  6956
  6957     12  FILLER                            PIC XX.
  6958
  6959     12  MA-ACCESS-CONTROL.
  6960         16  MA-SOURCE-SYSTEM              PIC XX.
  6961             88  MA-FROM-CREDIT                VALUE 'CR'.
  6962             88  MA-FROM-VSI                   VALUE 'VS'.
  6963             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6964             88  MA-FROM-OTHER                 VALUE 'OT'.
  6965         16  MA-RECORD-ADD-DT              PIC XX.
  6966         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6967         16  MA-LAST-MAINT-DT              PIC XX.
  6968         16  MA-LAST-MAINT-BY              PIC XXXX.
  6969         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6970
  6971     12  MA-PROFILE-INFO.
  6972         16  MA-QUALIFY-CODE-1             PIC XX.
  6973         16  MA-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 129
* EL6311.cbl
  6974         16  MA-QUALIFY-CODE-3             PIC XX.
  6975         16  MA-QUALIFY-CODE-4             PIC XX.
  6976         16  MA-QUALIFY-CODE-5             PIC XX.
  6977
  6978         16  MA-INSURED-LAST-NAME          PIC X(15).
  6979         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6980         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6981         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6982         16  MA-INSURED-BIRTH-DT           PIC XX.
  6983         16  MA-INSURED-SEX                PIC X.
  6984             88  MA-SEX-MALE                   VALUE 'M'.
  6985             88  MA-SEX-FEMALE                 VALUE 'F'.
  6986         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6987
  6988         16  MA-ADDRESS-CORRECTED          PIC X.
  6989         16  MA-JOINT-BIRTH-DT             PIC XX.
  6990*        16  FILLER                        PIC X(12).
  6991
  6992         16  MA-ADDRESS-LINE-1             PIC X(30).
  6993         16  MA-ADDRESS-LINE-2             PIC X(30).
  6994         16  MA-CITY-STATE.
  6995             20  MA-CITY                   PIC X(28).
  6996             20  MA-ADDR-STATE             PIC XX.
  6997         16  MA-ZIP.
  6998             20  MA-ZIP-CODE.
  6999                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7000                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7001                 24  FILLER                PIC X(4).
  7002             20  MA-ZIP-PLUS4              PIC X(4).
  7003         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7004             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7005             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7006             20  FILLER                    PIC X(3).
  7007
  7008         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7009
  7010         16  FILLER                        PIC XXX.
  7011*        16  FILLER                        PIC X(10).
  7012
  7013     12  MA-CRED-BENE-INFO.
  7014         16  MA-CRED-BENE-NAME                 PIC X(25).
  7015         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7016         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7017         16  MA-CRED-BENE-CTYST.
  7018             20  MA-CRED-BENE-CITY             PIC X(28).
  7019             20  MA-CRED-BENE-STATE            PIC XX.
  7020         16  MA-CRED-BENE-ZIP.
  7021             20  MA-CB-ZIP-CODE.
  7022                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7023                     88  MA-CB-CANADIAN-POST-CODE
  7024                                           VALUE 'A' THRU 'Z'.
  7025                 24  FILLER                    PIC X(4).
  7026             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7027         16  MA-CB-CANADIAN-POSTAL-CODE
  7028                            REDEFINES MA-CRED-BENE-ZIP.
  7029             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7030             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7031             20  FILLER                        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 130
* EL6311.cbl
  7032     12  MA-POST-CARD-MAIL-DATA.
  7033         16  MA-MAIL-DATA OCCURS 7.
  7034             20  MA-MAIL-TYPE              PIC X.
  7035                 88  MA-12MO-MAILING           VALUE '1'.
  7036                 88  MA-EXP-MAILING            VALUE '2'.
  7037             20  MA-MAIL-STATUS            PIC X.
  7038                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7039                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7040                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7041             20  MA-MAIL-DATE              PIC XX.
  7042     12  FILLER                            PIC XX.
  7043     12  FILLER                            PIC XX.
  7044*    12  FILLER                            PIC X(30).
  7045******************************************************************
  7046*                                COPY ERCRQST.
  7047******************************************************************
  7048*                                                                *
  7049*                                                                *
  7050*                            ERCRQST.                            *
  7051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7052*                            VMOD=2.002                          *
  7053*                                                                *
  7054*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7055*                                                                *
  7056*   FILE TYPE = VSAM,KSDS                                        *
  7057*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7058*                                                                *
  7059*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7060*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7061*                                   ACCOUNT, REF, BATCH)         *
  7062*                                                RKP=9, LEN=38   *
  7063*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7064*                                   ACCOUNT, REF, BATCH)         *
  7065*                                                RKP=47, LEN=46  *
  7066*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7067*                                   BATCH)                       *
  7068*                                                RKP=93, LEN=24  *
  7069*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7070*                                   REF, BATCH)                  *
  7071*                                                RKP=117, LEN=35 *
  7072*   LOG = NO                                                     *
  7073*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7074******************************************************************
  7075
  7076 01  AR-REQUEST-RECORD.
  7077     12  RQ-RECORD-ID                     PIC XX.
  7078         88  VALID-RQ-ID                        VALUE 'RQ'.
  7079
  7080     12  RQ-CONTROL-PRIMARY.
  7081         16  RQ-COMPANY-CD                PIC X.
  7082         16  RQ-ENTRY-BATCH               PIC X(6).
  7083
  7084     12  RQ-CONTROL-BY-ACCT-REF.
  7085         16  RQ-COMPANY-CD-A1             PIC X.
  7086         16  RQ-CARRIER-A1                PIC X.
  7087         16  RQ-GROUPING-A1               PIC X(6).
  7088         16  RQ-STATE-A1                  PIC XX.
  7089         16  RQ-ACCOUNT-A1                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 131
* EL6311.cbl
  7090         16  RQ-REFERENCE-A1              PIC X(12).
  7091         16  RQ-BATCH-A1                  PIC X(6).
  7092
  7093     12  RQ-CONTROL-BY-FIN-RESP.
  7094         16  RQ-COMPANY-CD-A2             PIC X.
  7095         16  RQ-CARRIER-A2                PIC X.
  7096         16  RQ-GROUPING-A2               PIC X(6).
  7097         16  RQ-FIN-RESP-A2               PIC X(10).
  7098         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7099         16  RQ-REFERENCE-A2              PIC X(12).
  7100         16  RQ-BATCH-A2                  PIC X(6).
  7101
  7102     12  RQ-CONTROL-BY-ACCT-AGENT.
  7103         16  RQ-COMPANY-CD-A3             PIC X.
  7104         16  RQ-CARRIER-A3                PIC X.
  7105         16  RQ-GROUPING-A3               PIC X(6).
  7106         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7107         16  RQ-BATCH-A3                  PIC X(6).
  7108
  7109     12  RQ-CONTROL-BY-SUMMARY.
  7110         16  RQ-COMPANY-CD-A4             PIC X.
  7111         16  RQ-SUMMARY-CODE              PIC X(6).
  7112         16  RQ-ACCOUNT-A4                PIC X(10).
  7113         16  RQ-REFERENCE-A4              PIC X(12).
  7114         16  RQ-BATCH-A4                  PIC X(6).
  7115
  7116     12  RQ-REQUEST-METHOD                PIC X.
  7117         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7118         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7119         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7120         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7121     12  FILLER                           PIC X.
  7122     12  RQ-STATUS                        PIC X.
  7123         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7124         88  RQ-RESUBMIT                      VALUE 'R'.
  7125     12  RQ-PROCESSOR-ID                  PIC X(4).
  7126     12  RQ-ENTRY-DT                      PIC XX.
  7127     12  RQ-MO-END-DT                     PIC XX.
  7128     12  RQ-REQUEST-DT                    PIC XX.
  7129     12  RQ-STMT-DT                       PIC XX.
  7130     12  RQ-REVERSAL-DT                   PIC XX.
  7131     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7132     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7133
  7134     12  FILLER                           PIC X(27).
  7135
  7136******************************************************************
  7137
  7138*                                COPY ERCLOFC.
  7139******************************************************************
  7140*                                                                *
  7141*                                                                *
  7142*                            ERCLOFC                             *
  7143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7144*                            VMOD=2.003                          *
  7145*                                                                *
  7146*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7147*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 132
* EL6311.cbl
  7148*   FILE TYPE = VSAM,KSDS                                        *
  7149*   RECORD SIZE = 670   RECFORM = FIX                            *
  7150*                                                                *
  7151*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7152*                                                                *
  7153*   LOG = YES                                                    *
  7154*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7155*                                                                *
  7156******************************************************************
  7157
  7158 01  LOAN-OFFICER-MASTER.
  7159     12  LO-RECORD-ID                PIC XX.
  7160         88  VALID-LO-ID                VALUE 'LO'.
  7161
  7162     12  LO-CONTROL-PRIMARY.
  7163         16  LO-COMPANY-CD           PIC X.
  7164         16  LO-CARRIER              PIC X.
  7165         16  LO-GROUPING.
  7166             20  LO-GROUPING-PREFIX  PIC XXX.
  7167             20  LO-GROUPING-PRIME   PIC XXX.
  7168         16  LO-STATE                PIC XX.
  7169         16  LO-ACCOUNT.
  7170             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7171             20  LO-ACCOUNT-PRIME    PIC X(6).
  7172         16  LO-OFFICER-CODE         PIC X(5).
  7173
  7174     12  LO-OFFICER-NAME             PIC X(30).
  7175
  7176     12  LO-LAST-MAINT-DT            PIC XX.
  7177     12  LO-LAST-USER                PIC X(4).
  7178     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7179
  7180     12  LO-COMP-CONTROL             PIC X.
  7181             88  LO-SHOW-COMP           VALUE 'Y'.
  7182             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7183     12  LO-DETAIL-CONTROL           PIC X.
  7184             88  LO-PRINT-DETAIL        VALUE 'D'.
  7185             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7186
  7187     12  LO-SV-CARRIER               PIC X.
  7188     12  LO-SV-GROUPING              PIC X(6).
  7189     12  LO-SV-STATE                 PIC XX.
  7190
  7191     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7192     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7193
  7194     12  LO-OFFICER-INFO.
  7195         16  FILLER OCCURS 12 TIMES.
  7196             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7197             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7198             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7199             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7200             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7201             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7202             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7203             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7204     12  FILLER                      PIC X(198).
  7205******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 133
* EL6311.cbl
  7206*                                COPY ERCPYAJ.
  7207******************************************************************
  7208*                                                                *
  7209*                            ERCPYAJ                             *
  7210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7211*                            VMOD=2.015                          *
  7212*                                                                *
  7213*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7214*                                                                *
  7215*                                                                *
  7216*   FILE TYPE = VSAM,KSDS                                        *
  7217*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7218*                                                                *
  7219*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7220*       ALTERNATE PATHS = NONE                                   *
  7221*                                                                *
  7222*   LOG = YES                                                    *
  7223*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7224******************************************************************
  7225******************************************************************
  7226*                   C H A N G E   L O G
  7227*
  7228* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7229*-----------------------------------------------------------------
  7230*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7231* EFFECTIVE    NUMBER
  7232*-----------------------------------------------------------------
  7233* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7234* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7235******************************************************************
  7236
  7237 01  PENDING-PAY-ADJ.
  7238     12  PY-RECORD-ID                     PIC XX.
  7239         88  VALID-PY-ID                        VALUE 'PY'.
  7240
  7241     12  PY-CONTROL-PRIMARY.
  7242         16  PY-COMPANY-CD                PIC X.
  7243         16  PY-CARRIER                   PIC X.
  7244         16  PY-GROUPING                  PIC X(6).
  7245         16  PY-FIN-RESP                  PIC X(10).
  7246         16  PY-ACCOUNT                   PIC X(10).
  7247         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7248                                          PIC X(10).
  7249         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7250         16  PY-RECORD-TYPE               PIC X.
  7251             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7252             88  PY-DEPOSIT                   VALUE 'D'.
  7253             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7254             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7255             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7256             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7257             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7258             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7259             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7260             88  PY-FICA-ENTRY                VALUE 'F'.
  7261             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7262             88  PY-POLICY-FEE                VALUE 'W'.
  7263             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 134
* EL6311.cbl
  7264
  7265     12  PY-PYMT-TYPE                     PIC X.
  7266             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7267             88  PY-REINS-PYMT                VALUE 'R'.
  7268             88  PY-EXP-PYMT                  VALUE 'E'.
  7269
  7270     12  PY-BIL-INV                       PIC X(6).
  7271     12  PY-REF-NO                        PIC X(12).
  7272
  7273     12  PY-LAST-MAINT-DT                 PIC XX.
  7274     12  PY-LAST-MAINT-BY                 PIC X(4).
  7275     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7276
  7277     12  PY-PYADJ-RECORD.
  7278         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7279         16  PY-ENTRY-COMMENT             PIC X(30).
  7280         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7281             20  PY-GL-ACCOUNT            PIC X(10).
  7282             20  PY-GL-STATE              PIC X(02).
  7283             20  PY-GL-CANC-SW            PIC X(01).
  7284                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7285                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7286             20  PY-GL-COMMENT            PIC X(10).
  7287             20  FILLER      REDEFINES PY-GL-COMMENT.
  7288                 24  PY-GL-CHECK-NO       PIC 9(06).
  7289                 24  FILLER               PIC X(04).
  7290             20  FILLER                   PIC X(07).
  7291         16  PY-SAVE-ACCOUNT              PIC X(10).
  7292         16  PY-SAVE-TYPE                 PIC X(01).
  7293
  7294         16  PY-LETTERS.
  7295             20  PY-LETTER OCCURS 3 TIMES
  7296                           INDEXED BY PY-LET-NDX
  7297                                          PIC X(04).
  7298
  7299         16  PY-ERCOMP-TYPE               PIC X.
  7300             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7301             88  PY-GA-TYPE                   VALUE 'G'.
  7302             88  PY-BANK-TYPE                 VALUE 'B'.
  7303         16  FILLER                       PIC X(05).
  7304
  7305     12  PY-RECORD-STATUS.
  7306         16  PY-CREDIT-SELECT-DT          PIC XX.
  7307         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7308         16  PY-BILLED-DATE               PIC XX.
  7309         16  PY-REPORTED-DT               PIC XX.
  7310         16  PY-PMT-APPLIED               PIC X.
  7311             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7312             88  PY-GA-PMT                    VALUE 'G'.
  7313             88  PY-OVWRITE-PMT               VALUE 'O'.
  7314             88  PY-NON-AR-PMT                VALUE 'N'.
  7315         16  FILLER                       PIC X(5).
  7316         16  PY-INPUT-DT                  PIC XX.
  7317         16  PY-CHECK-NUMBER              PIC X(6).
  7318         16  PY-VOID-SW                   PIC X.
  7319             88  PY-CHECK-VOIDED              VALUE 'V'.
  7320         16  PY-CHECK-ORIGIN-SW           PIC X.
  7321             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 135
* EL6311.cbl
  7322             88  PY-REFUND-CHECK              VALUE 'R'.
  7323             88  PY-GA-CHECK                  VALUE 'G'.
  7324             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7325             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7326         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7327         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7328         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7329         16  PY-BILL-FLAG                 PIC X.
  7330             88  PY-BILLED                    VALUE 'B'.
  7331         16  PY-AR-FLAG                   PIC X.
  7332             88  PY-AR-CYCLE                  VALUE 'C'.
  7333             88  PY-AR-MONTH-END              VALUE 'M'.
  7334         16  PY-AR-DATE                   PIC XX.
  7335
  7336     12  PY-GL-CODES.
  7337         16  PY-GL-DB                     PIC X(14).
  7338         16  PY-GL-CR                     PIC X(14).
  7339         16  PY-GL-FLAG                   PIC X.
  7340         16  PY-GL-DATE                   PIC XX.
  7341
  7342     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7343     12  FILLER                           PIC X(3).
  7344******************************************************************
  7345*                                COPY ERCCNOT.
  7346******************************************************************
  7347*                                                                *
  7348*                            ERCCNOT                             *
  7349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7350*                            VMOD=2.003                          *
  7351*                                                                *
  7352*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7353*                                                                *
  7354*        FILE TYPE= VSAM,KSDS                                    *
  7355*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7356*                                                                *
  7357*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7358*                                                                *
  7359*        LOG = YES                                               *
  7360*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7361*                                                                *
  7362******************************************************************
  7363*                   C H A N G E   L O G
  7364*
  7365* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7366*-----------------------------------------------------------------
  7367*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7368* EFFECTIVE    NUMBER
  7369*-----------------------------------------------------------------
  7370* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7371******************************************************************
  7372
  7373 01  CERT-NOTE-FILE.
  7374     12  CZ-RECORD-ID                PIC  XX.
  7375         88  VALID-CZ-ID                  VALUE 'CZ'.
  7376
  7377     12  CZ-CONTROL-PRIMARY.
  7378         16  CZ-COMPANY-CD           PIC X.
  7379         16  CZ-CARRIER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 136
* EL6311.cbl
  7380         16  CZ-GROUPING.
  7381             20 CZ-GROUPING-PREFIX   PIC XXX.
  7382             20 CZ-GROUPING-PRIME    PIC XXX.
  7383         16  CZ-STATE                PIC XX.
  7384         16  CZ-ACCOUNT.
  7385             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7386             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7387         16  CZ-CERT-EFF-DT          PIC XX.
  7388         16  CZ-CERT-NO.
  7389             20  CZ-CERT-PRIME       PIC X(10).
  7390             20  CZ-CERT-SFX         PIC X.
  7391         16  CZ-RECORD-TYPE          PIC X.
  7392             88  CERT-NOTE           VALUE '1'.
  7393             88  CLAIM-CERT-NOTE     VALUE '2'.
  7394         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7395
  7396     12  CZ-LAST-MAINT-DT            PIC XX.
  7397     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7398     12  CZ-LAST-MAINT-USER          PIC X(4).
  7399
  7400     12  CZ-NOTE-INFORMATION.
  7401         16  CZ-NOTE                 PIC X(63).
  7402         16  FILLER                  PIC X(39).
  7403******************************************************************
  7404*                                COPY ELCMSTR.
  7405******************************************************************
  7406*                                                                *
  7407*                            ELCMSTR.                            *
  7408*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7409*                            VMOD=2.012                          *
  7410*                                                                *
  7411*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7412*                                                                *
  7413*   FILE TYPE = VSAM,KSDS                                        *
  7414*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7415*                                                                *
  7416*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7417*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7418*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7419*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7420*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7421*                                                 RKP=75,LEN=21  *
  7422*                                                                *
  7423*   **** NOTE ****                                               *
  7424*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7425*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7426*                                                                *
  7427*   LOG = YES                                                    *
  7428*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7429******************************************************************
  7430*                   C H A N G E   L O G
  7431*
  7432* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7433*-----------------------------------------------------------------
  7434*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7435* EFFECTIVE    NUMBER
  7436*-----------------------------------------------------------------
  7437* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 137
* EL6311.cbl
  7438* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7439* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7440* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7441******************************************************************
  7442 01  CLAIM-MASTER.
  7443     12  CL-RECORD-ID                PIC XX.
  7444         88  VALID-CL-ID         VALUE 'CL'.
  7445
  7446     12  CL-CONTROL-PRIMARY.
  7447         16  CL-COMPANY-CD           PIC X.
  7448         16  CL-CARRIER              PIC X.
  7449         16  CL-CLAIM-NO             PIC X(7).
  7450         16  CL-CERT-NO.
  7451             20  CL-CERT-PRIME       PIC X(10).
  7452             20  CL-CERT-SFX         PIC X.
  7453
  7454     12  CL-CONTROL-BY-NAME.
  7455         16  CL-COMPANY-CD-A1        PIC X.
  7456         16  CL-INSURED-LAST-NAME    PIC X(15).
  7457         16  CL-INSURED-NAME.
  7458             20  CL-INSURED-1ST-NAME PIC X(12).
  7459             20  CL-INSURED-MID-INIT PIC X.
  7460
  7461     12  CL-CONTROL-BY-SSN.
  7462         16  CL-COMPANY-CD-A2        PIC X.
  7463         16  CL-SOC-SEC-NO.
  7464             20  CL-SSN-STATE        PIC XX.
  7465             20  CL-SSN-ACCOUNT      PIC X(6).
  7466             20  CL-SSN-LN3          PIC X(3).
  7467
  7468     12  CL-CONTROL-BY-CERT-NO.
  7469         16  CL-COMPANY-CD-A4        PIC X.
  7470         16  CL-CERT-NO-A4.
  7471             20  CL-CERT-A4-PRIME    PIC X(10).
  7472             20  CL-CERT-A4-SFX      PIC X.
  7473
  7474     12  CL-CONTROL-BY-CCN.
  7475         16  CL-COMPANY-CD-A5        PIC X.
  7476         16  CL-CCN-A5.
  7477             20  CL-CCN.
  7478                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7479                 24  CL-CCN-PRIME-A5 PIC X(12).
  7480             20  CL-CCN-FILLER-A5    PIC X(4).
  7481
  7482     12  CL-INSURED-PROFILE-DATA.
  7483         16  CL-INSURED-BIRTH-DT     PIC XX.
  7484         16  CL-INSURED-SEX-CD       PIC X.
  7485             88  INSURED-IS-MALE        VALUE 'M'.
  7486             88  INSURED-IS-FEMALE      VALUE 'F'.
  7487             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7488         16  CL-INSURED-OCC-CD       PIC X(6).
  7489         16  FILLER                  PIC X(5).
  7490
  7491     12  CL-PROCESSING-INFO.
  7492         16  CL-PROCESSOR-ID         PIC X(4).
  7493         16  CL-CLAIM-STATUS         PIC X.
  7494             88  CLAIM-IS-OPEN          VALUE 'O'.
  7495             88  CLAIM-IS-CLOSED        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 138
* EL6311.cbl
  7496         16  CL-CLAIM-TYPE           PIC X.
  7497*            88  AH-CLAIM               VALUE 'A'.
  7498*            88  LIFE-CLAIM             VALUE 'L'.
  7499*            88  PROPERTY-CLAIM         VALUE 'P'.
  7500*            88  IUI-CLAIM              VALUE 'I'.
  7501*            88  GAP-CLAIM              VALUE 'G'.
  7502         16  CL-CLAIM-PREM-TYPE      PIC X.
  7503             88  SINGLE-PREMIUM         VALUE '1'.
  7504             88  O-B-COVERAGE           VALUE '2'.
  7505             88  OPEN-END-COVERAGE      VALUE '3'.
  7506         16  CL-INCURRED-DT          PIC XX.
  7507         16  CL-REPORTED-DT          PIC XX.
  7508         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7509         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7510         16  CL-LAST-PMT-DT          PIC XX.
  7511         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7512         16  CL-PAID-THRU-DT         PIC XX.
  7513         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7514         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7515         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7516         16  CL-PMT-CALC-METHOD      PIC X.
  7517             88  CL-360-DAY-YR          VALUE '1'.
  7518             88  CL-365-DAY-YR          VALUE '2'.
  7519             88  CL-FULL-MONTHS         VALUE '3'.
  7520         16  CL-CAUSE-CD             PIC X(6).
  7521
  7522         16  CL-PRIME-CERT-NO.
  7523             20  CL-PRIME-CERT-PRIME PIC X(10).
  7524             20  CL-PRIME-CERT-SFX   PIC X.
  7525
  7526         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7527             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7528             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7529
  7530         16  CL-MICROFILM-NO         PIC X(10).
  7531         16  FILLER REDEFINES CL-MICROFILM-NO.
  7532             20  CL-BENEFIT-PERIOD   PIC 99.
  7533             20  FILLER              PIC X(8).
  7534         16  CL-PROG-FORM-TYPE       PIC X.
  7535         16  CL-LAST-ADD-ON-DT       PIC XX.
  7536
  7537         16  CL-LAST-REOPEN-DT       PIC XX.
  7538         16  CL-LAST-CLOSE-DT        PIC XX.
  7539         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7540             88  FINAL-PAID             VALUE '1'.
  7541             88  CLAIM-DENIED           VALUE '2'.
  7542             88  AUTO-CLOSE             VALUE '3'.
  7543             88  MANUAL-CLOSE           VALUE '4'.
  7544             88  BENEFITS-CHANGED       VALUE 'C'.
  7545             88  SETUP-ERRORS           VALUE 'E'.
  7546         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7547         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7548         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7549             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7550         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7551         16  FILLER                  PIC X.
  7552
  7553     12  CL-CERTIFICATE-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 139
* EL6311.cbl
  7554         16  CL-CERT-ORIGIN          PIC X.
  7555             88  CERT-WAS-ONLINE        VALUE '1'.
  7556             88  CERT-WAS-CREATED       VALUE '2'.
  7557             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7558         16  CL-CERT-KEY-DATA.
  7559             20  CL-CERT-CARRIER     PIC X.
  7560             20  CL-CERT-GROUPING    PIC X(6).
  7561             20  CL-CERT-STATE       PIC XX.
  7562             20  CL-CERT-ACCOUNT.
  7563                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7564                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7565             20  CL-CERT-EFF-DT      PIC XX.
  7566
  7567     12  CL-STATUS-CONTROLS.
  7568         16  CL-PRIORITY-CD          PIC X.
  7569             88  CONFIDENTIAL-DATA      VALUE '8'.
  7570             88  HIGHEST-PRIORITY       VALUE '9'.
  7571         16  CL-SUPV-ATTN-CD         PIC X.
  7572             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7573             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7574         16  CL-PURGED-DT            PIC XX.
  7575         16  CL-RESTORED-DT          PIC XX.
  7576         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7577         16  CL-NEXT-RESEND-DT       PIC XX.
  7578         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7579         16  CL-CRITICAL-PERIOD      PIC 99.
  7580*        16  FILLER                  PIC XX.
  7581         16  CL-LAST-MAINT-DT        PIC XX.
  7582         16  CL-LAST-MAINT-USER      PIC X(4).
  7583         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7584         16  CL-LAST-MAINT-TYPE      PIC X.
  7585             88  CLAIM-SET-UP           VALUE ' '.
  7586             88  PAYMENT-MADE           VALUE '1'.
  7587             88  LETTER-SENT            VALUE '2'.
  7588             88  MASTER-WAS-ALTERED     VALUE '3'.
  7589             88  MASTER-WAS-RESTORED    VALUE '4'.
  7590             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7591             88  FILE-CONVERTED         VALUE '6'.
  7592             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7593             88  ERROR-CORRECTION       VALUE 'E'.
  7594         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7595         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7596         16  CL-BENEFICIARY          PIC X(10).
  7597         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7598         16  CL-DENIAL-TYPE          PIC X.
  7599             88  CL-TYPE-DENIAL          VALUE '1'.
  7600             88  CL-TYPE-RESCISSION      VALUE '2'.
  7601             88  CL-TYPE-REFORMATION     VALUE '3'.
  7602             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7603             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7604         16  filler                  pic x(5).
  7605*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7606*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7607*        16  CL-RTW-DT               PIC XX.
  7608
  7609     12  CL-TRAILER-CONTROLS.
  7610         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7611             88  CL-1ST-TRL-AVAIL       VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 140
* EL6311.cbl
  7612             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7613             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7614         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7615         16  FILLER                  PIC XX.
  7616         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7617         16  CL-ADDRESS-TRAILER-CNT.
  7618             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7619                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7620             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7621                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7622             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7623                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7624             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7625                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7626             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7627                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7628             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7629                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7630             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7631                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7632
  7633     12  CL-CV-REFERENCE-NO.
  7634         16  CL-CV-REFNO-PRIME       PIC X(18).
  7635         16  CL-CV-REFNO-SFX         PIC XX.
  7636
  7637     12  CL-FILE-LOCATION            PIC X(4).
  7638
  7639     12  CL-PROCESS-ERRORS.
  7640         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7641             88  NO-FATAL-ERRORS        VALUE ZERO.
  7642         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7643             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7644
  7645     12  CL-PRODUCT-CD               PIC X.
  7646
  7647     12  CL-CURRENT-KEY-DATA.
  7648         16  CL-CURRENT-CARRIER      PIC X.
  7649         16  CL-CURRENT-GROUPING     PIC X(6).
  7650         16  CL-CURRENT-STATE        PIC XX.
  7651         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7652
  7653     12  CL-ASSOCIATES               PIC X.
  7654         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7655         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7656         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7657         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7658
  7659     12  CL-ACTIVITY-CODE            PIC 99.
  7660     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7661     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7662
  7663     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7664     12  CL-LAG-REPORT-CODE          PIC 9.
  7665     12  CL-LOAN-TYPE                PIC XX.
  7666     12  CL-LEGAL-STATE              PIC XX.
  7667
  7668     12  CL-YESNOSW                  PIC X.
  7669     12  CL-ACCIDENT-CLAIM-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 141
* EL6311.cbl
  7670         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7671         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7672         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7673     12  cl-insured-type             pic x.
  7674         88  cl-claim-on-primary         value 'P'.
  7675         88  cl-claim-on-co-borrower     value 'C'.
  7676     12  cl-benefit-expiration-dt    PIC XX.
  7677*                                COPY ERCENDT.
  7678******************************************************************
  7679*                                                                *
  7680*                                                                *
  7681*                            ERCENDT.                            *
  7682*                            VMOD=2.001                          *
  7683*                                                                *
  7684*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7685*                                                                *
  7686*   FILE TYPE = VSAM,KSDS                                        *
  7687*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7688*                                                                *
  7689*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7690*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7691*                                                                *
  7692*   LOG = NO                                                     *
  7693*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7694******************************************************************
  7695*-----------------------------------------------------------------
  7696*                   C H A N G E   L O G
  7697*
  7698* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7699*-----------------------------------------------------------------
  7700*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7701* EFFECTIVE    NUMBER
  7702*-----------------------------------------------------------------
  7703* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7704*                                WITH OPEN CLAIMS
  7705* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7706* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7707* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7708*-----------------------------------------------------------------
  7709 01  ENDORSEMENT-RECORD.
  7710     12  EN-RECORD-ID                PIC XX.
  7711         88  VALID-EN-ID                VALUE 'EN'.
  7712     12  EN-CONTROL-PRIMARY.
  7713         16  EN-COMPANY-CD           PIC X.
  7714         16  EN-CARRIER              PIC X.
  7715         16  EN-GROUPING             PIC X(6).
  7716         16  EN-STATE                PIC XX.
  7717         16  EN-ACCOUNT              PIC X(10).
  7718         16  EN-CERT-EFF-DT          PIC XX.
  7719         16  EN-CERT-NO.
  7720             20  EN-CERT-PRIME       PIC X(10).
  7721             20  EN-CERT-SFX         PIC X.
  7722         16  EN-REC-TYPE             PIC X.
  7723             88  EN-ISSUE               VALUE 'I'.
  7724             88  EN-CANCELLATION        VALUE 'C'.
  7725         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7726     12  EN-CONTROL-BY-ARCH-NO.
  7727         16  EN-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 142
* EL6311.cbl
  7728         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7729     12  EN-LAST-MAINT-DT            PIC XX.
  7730     12  EN-LAST-MAINT-BY            PIC X(4).
  7731     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7732     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7733     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7734         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7735         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7736         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7737         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7738         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7739         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7740         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7741         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7742         16  EN-LF-ORIG-BENCD        PIC XX.
  7743         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7744         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7745         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7746         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7747         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7748         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7749*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7750         16  EN-ORIG-CRED-BENE       PIC X(25).
  7751         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7752         16  FILLER                  PIC X.
  7753         16  EN-AH-ORIG-BENCD        PIC XX.
  7754         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7755         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7756         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7757         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7758*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7759*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7760         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7761         16  F                       PIC X(09).
  7762         16  EN-AH-ORIG-CP           PIC 99.
  7763         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7764         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7765         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7766         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7767         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7768         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7769         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7770         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7771         16  EN-LF-NEW-BENCD         PIC XX.
  7772         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7773         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7774         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7775         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7776         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7777         16  EN-LF-NEW-EXP-DT        PIC XX.
  7778         16  EN-NEW-CRED-BENE        PIC X(25).
  7779         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7780         16  FILLER                  PIC X.
  7781         16  EN-AH-NEW-BENCD         PIC XX.
  7782         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7783         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7784         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7785         16  EN-AH-NEW-EXP-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 143
* EL6311.cbl
  7786*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7787*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7788*        16  F                       PIC X(12).
  7789         16  EN-AH-NEW-CP            PIC 99.
  7790         16  EN-SIG-SW               PIC X.
  7791         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7792         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7793         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7794         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7795         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7796         16  FILLER                  PIC X(33).
  7797     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7798         16  EN-LF-ORIG-REF-DT       PIC XX.
  7799         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7800         16  EN-AH-ORIG-REF-DT       PIC XX.
  7801         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7802         16  EN-LF-NEW-REF-DT        PIC XX.
  7803         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7804         16  EN-AH-NEW-REF-DT        PIC XX.
  7805         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7806         16  EN-FLAG-CERT            PIC X.
  7807         16  EN-INS-LAST-NAME        PIC X(15).
  7808         16  EN-INS-FIRST-NAME       PIC X(10).
  7809         16  EN-INS-MIDDLE-INIT      PIC X.
  7810         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7811         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7812         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7813         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7814         16  FILLER                  PIC X(262).
  7815     12  EN-MONEY-SW             PIC X.
  7816     12  EN-HEALTH-APP           PIC X.
  7817     12  EN-VOUCHER-SW           PIC X.
  7818     12  EN-PAYEE                PIC X(14).
  7819     12  EN-INPUT-DT             PIC XX.
  7820     12  EN-PROCESS-DT           PIC XX.
  7821     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7822     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7823     12  EN-REASON-CODES.
  7824         16  F OCCURS 12.
  7825             20  EN-REASON-CODE  PIC X(4).
  7826     12  EN-TEMPLATE-USED        PIC X(8).
  7827     12  EN-DOCU-TYPE            PIC X.
  7828         88  EN-VERI-DOCU          VALUE 'V'.
  7829         88  EN-GCE-DOCU           VALUE 'G'.
  7830         88  EN-CANC-DOCU          VALUE 'C'.
  7831     12  EN-COMMENTS1            PIC X(13).
  7832     12  EN-COMMENTS2            PIC X(70).
  7833     12  EN-COMM-CHGBK           PIC X.
  7834         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7835         88  EN-CHG-ACCT           VALUE 'Y'.
  7836     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7837     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7838     12  EN-BATCH-NUMBER         PIC X(6).
  7839     12  EN-ACCT-SUMM            PIC X.
  7840     12  EN-CSO-SUMM             PIC X.
  7841     12  FILLER                  PIC X(13).
  7842******************************************************************
  7843*                                COPY ELCCRTT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 144
* EL6311.cbl
  7844******************************************************************
  7845*                                                                *
  7846*                            ELCCRTT.                            *
  7847*                                                                *
  7848*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7849*                                                                *
  7850*   FILE TYPE = VSAM,KSDS                                        *
  7851*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7852*                                                                *
  7853*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7854*                                                                *
  7855*   LOG = YES                                                    *
  7856*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7857******************************************************************
  7858*                   C H A N G E   L O G
  7859*
  7860* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7861*-----------------------------------------------------------------
  7862*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7863* EFFECTIVE    NUMBER
  7864*-----------------------------------------------------------------
  7865* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7866* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7867* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7868* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7869* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7870* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7871******************************************************************
  7872
  7873 01  CERTIFICATE-TRAILERS.
  7874     12  CS-RECORD-ID                      PIC XX.
  7875         88  VALID-CS-ID                      VALUE 'CS'.
  7876
  7877     12  CS-CONTROL-PRIMARY.
  7878         16  CS-COMPANY-CD                 PIC X.
  7879         16  CS-CARRIER                    PIC X.
  7880         16  CS-GROUPING                   PIC X(6).
  7881         16  CS-STATE                      PIC XX.
  7882         16  CS-ACCOUNT                    PIC X(10).
  7883         16  CS-CERT-EFF-DT                PIC XX.
  7884         16  CS-CERT-NO.
  7885             20  CS-CERT-PRIME             PIC X(10).
  7886             20  CS-CERT-SFX               PIC X.
  7887         16  CS-TRAILER-TYPE               PIC X.
  7888             88  COMM-TRLR           VALUE 'A'.
  7889             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7890             88  CERT-DATA-TRLR      VALUE 'C'.
  7891
  7892     12  CS-DATA-AREA                      PIC X(516).
  7893
  7894     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7895         16  CS-BANK-COMMISSION-AREA.
  7896             20  CS-BANK-COMMS       OCCURS 10.
  7897                 24  CS-AGT                PIC X(10).
  7898                 24  CS-COM-TYP            PIC X.
  7899                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7900                 24  CS-RECALC-LV-INDIC    PIC X.
  7901                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 145
* EL6311.cbl
  7902         16  FILLER                        PIC X(256).
  7903
  7904     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7905****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7906         16  CS-MB-CLAIM-DATA OCCURS 24.
  7907             20  CS-CLAIM-NO               PIC X(7).
  7908             20  CS-CLAIM-TYPE             PIC X.
  7909                 88  CS-AH-CLM               VALUE 'A'.
  7910                 88  CS-IU-CLM               VALUE 'I'.
  7911                 88  CS-GP-CLM               VALUE 'G'.
  7912                 88  CS-LF-CLM               VALUE 'L'.
  7913                 88  CS-PR-CLM               VALUE 'P'.
  7914             20  CS-INSURED-TYPE           PIC X.
  7915                 88  CS-PRIM-INSURED          VALUE 'P'.
  7916                 88  CS-CO-BORROWER           VALUE 'C'.
  7917             20  CS-BENEFIT-PERIOD         PIC 99.
  7918             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7919             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7920             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7921         16  FILLER                        PIC X(12).
  7922     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7923         16  CS-VIN-NUMBER                 PIC X(17).
  7924         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7925         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7926         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7927         16  FILLER                        PIC X(496).
  7928*                                COPY ERCCHEK.
  7929******************************************************************
  7930*                                                                *
  7931*                                                                *
  7932*                            ERCCHEK                             *
  7933*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7934*                            VMOD=2.008                          *
  7935*                                                                *
  7936*   FILE DESCRIPTION = CHECK RECORDS                             *
  7937*                                                                *
  7938*   FILE TYPE = VSAM,KSDS                                        *
  7939*   RECORD SIZE = 600    RECFORM = FIXED                         *
  7940*                                                                *
  7941*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  7942*       ALTERNATE INDEX = NONE                                   *
  7943*                                                                *
  7944*   LOG = YES                                                    *
  7945*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7946******************************************************************
  7947*                   C H A N G E   L O G
  7948*
  7949* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7950*-----------------------------------------------------------------
  7951*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7952* EFFECTIVE    NUMBER
  7953*-----------------------------------------------------------------
  7954* 021414    2003053000001  PEMA  changes for auto chk request
  7955******************************************************************
  7956 01  CHECK-RECORDS.
  7957     12  CH-RECORD-ID                      PIC XX.
  7958         88  VALID-CH-ID                      VALUE 'CH'.
  7959
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 146
* EL6311.cbl
  7960     12  CH-CONTROL-PRIMARY.
  7961         16  CH-COMPANY-CD                 PIC X.
  7962         16  CH-CARRIER                    PIC X.
  7963         16  CH-GROUPING                   PIC X(6).
  7964         16  CH-STATE                      PIC XX.
  7965         16  CH-ACCOUNT                    PIC X(10).
  7966         16  CH-CERT-EFF-DT                PIC XX.
  7967         16  CH-CERT-NO.
  7968             20  CH-CERT-PRIME             PIC X(10).
  7969             20  CH-CERT-SFX               PIC X.
  7970         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  7971
  7972     12  CH-RECORDED-DT                    PIC XX.
  7973     12  CH-RECORDED-BY                    PIC X(4).
  7974     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  7975
  7976     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  7977     12  CH-CHECK-NO                       PIC X(7).
  7978     12  CH-REASON-FOR-CHECK               PIC X(25).
  7979     12  CH-CHECK-WRITTEN-DT               PIC XX.
  7980     12  FILLER                            PIC X.
  7981
  7982     12  CH-PAYEE-INFO.
  7983         16  CH-PAYEE-NAME-1               PIC X(30).
  7984         16  CH-PAYEE-NAME-2               PIC X(30).
  7985         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  7986         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  7987         16  CH-PAYEE-CITY-ST.
  7988             20  CH-PAYEE-CITY             PIC X(28).
  7989             20  CH-PAYEE-STATE            PIC XX.
  7990         16  CH-PAYEE-ZIP-CODE.
  7991             20  CH-PAYEE-ZIP.
  7992                 24  CH-ZIP-PRI-1ST        PIC X.
  7993                     88  CH-CANADIAN-POST-CODE
  7994                                           VALUES 'A' THRU 'Z'.
  7995                 24  FILLER                PIC X(4).
  7996             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  7997         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  7998             20  CH-CAN-POSTAL-1           PIC XXX.
  7999             20  CH-CAN-POSTAL-2           PIC XXX.
  8000             20  FILLER                    PIC XXX.
  8001
  8002     12  CH-CHECK-STUB-TEXT.
  8003         16  CH-STUB-LINE-1                PIC X(30).
  8004         16  CH-TEXT-LINE-1                PIC X(50).
  8005         16  CH-TEXT-LINE-2                PIC X(50).
  8006         16  CH-TEXT-LINE-3                PIC X(40).
  8007     12  CH-RETURN-TO                      PIC X(30).
  8008
  8009     12  CH-COMPENSATION-CONTROL.
  8010         16  CH-COMP-CARRIER               PIC X.
  8011         16  CH-COMP-GROUPING              PIC X(6).
  8012         16  CH-COMP-FIN-RESP              PIC X(10).
  8013         16  CH-COMP-ACCOUNT               PIC X(10).
  8014
  8015     12  CH-CREDIT-SELECT-DT               PIC XX.
  8016     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8017     12  CH-PAYEE-CODE                     PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 147
* EL6311.cbl
  8018
  8019     12  CH-VOID-DATA.
  8020         20  CH-VOID-DT                    PIC XX.
  8021         20  CH-VOID-BY                    PIC X(4).
  8022         20  CH-VOID-REASON                PIC X(25).
  8023
  8024     12  CH-APPROVAL-DATA.
  8025         20  CH-APPROVAL-DT                PIC XX.
  8026         20  CH-APPROVAL-STATUS            PIC X.
  8027             88  CH-IN-LIMBO                  VALUE ' '.
  8028             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8029             88  CH-APPROVED                  VALUE 'A'.
  8030             88  CH-DENIED                    VALUE 'D'.
  8031         20  CH-APPROVED-BY                PIC XXXX.
  8032     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8033             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8034     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8035
  8036     12  ch-released-dt                    pic xx.
  8037     12  ch-check-cashed-dt                pic xx.
  8038     12  FILLER                            PIC X.
  8039*    12  CH-CHECK-REFERENCE                PIC X(12).
  8040     12  CH-CHECK-ORIGIN-SW                PIC X.
  8041             88  CH-REFUND-CHECK              VALUE 'R'.
  8042             88  CH-MAINT-CHECK               VALUE 'M'.
  8043
  8044     12  CH-CANC-DT                        PIC XX.
  8045     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8046     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8047
  8048     12  CH-INSURED-NAME                   PIC X(28).
  8049
  8050     12  ch-released-by                    pic x(4).
  8051     12  ch-csr                            pic x(4).
  8052     12  ch-deduct-commission              pic x.
  8053         88  ch-deduct-comm                  value 'Y'.
  8054         88  ch-do-not-deduct-comm           value 'N'.
  8055
  8056     12  FILLER                            PIC X(11).
  8057*    12  CH-LETTER-TABLE.
  8058*        16  CH-LETTERS OCCURS 3 TIMES
  8059*                       INDEXED BY CH-LT-NDX
  8060*                                          PIC X(04).
  8061
  8062     12  FILLER                            PIC X(07).
  8063
  8064 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8065                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8066                          PENDING-MAILING-DATA MAILING-DATA
  8067                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8068                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8069                          CLAIM-MASTER ENDORSEMENT-RECORD
  8070                          CERTIFICATE-TRAILERS CHECK-RECORDS.
  8071 0000-DFHEXIT SECTION.
  8072     MOVE '9#                    $   ' TO DFHEIV0.
  8073     MOVE 'EL6311' TO DFHEIV1.
  8074     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8075
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 148
* EL6311.cbl
  8076     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8077     MOVE EIBTRMID               TO QID-TERM.
  8078     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8079     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8080     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8081     MOVE 2                      TO EMI-SWITCH2.
  8082
  8083     IF EIBCALEN = 0
  8084         GO TO 8800-UNAUTHORIZED-ACCESS.
  8085
  8086     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8087     MOVE '5'                   TO DC-OPTION-CODE.
  8088     PERFORM 9700-DATE-LINK.
  8089     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8090     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8091
  8092     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8093     MOVE SPACE                  TO DC-OPTION-CODE.
  8094     PERFORM 9700-DATE-LINK.
  8095     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8096     MOVE LOW-VALUES             TO EL631BI.
  8097
  8098
  8099* EXEC CICS HANDLE CONDITION
  8100*        PGMIDERR  (9600-PGMID-ERROR)
  8101*        ERROR     (9990-ABEND)
  8102*        INVREQ    (9990-ABEND)
  8103*        QIDERR    (0010-MAIN-LOGIC)
  8104*    END-EXEC.
  8105*    MOVE '"$L.8N                ! " #00008094' TO DFHEIV0
  8106     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8108     MOVE X'2220233030303038303934' TO DFHEIV0(25:11)
  8109     CALL 'kxdfhei1' USING DFHEIV0
  8110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8111
  8112
  8113     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8114         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8115             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8116             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8117             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8118             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8119             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8120             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8121             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8122             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8123
  8124             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8125                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8126
  8127             ELSE
  8128                 NEXT SENTENCE
  8129
  8130         ELSE
  8131             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8132             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8133             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 149
* EL6311.cbl
  8134             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8135             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8136             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8137             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8138             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8139             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8140             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8141             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8142             GO TO 3900-RE-DISPLAY-RECORD
  8143     ELSE
  8144         GO TO 0020-MAIN-LOGIC.
  8145
  8146 0010-MAIN-LOGIC.
  8147     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8148                                    WS-FIRST-ENTRY-SW.
  8149
  8150     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8151
  8152     MOVE LOW-VALUES             TO EC-NEW-CERT
  8153                                    EC-NEW-STATE.
  8154
  8155     IF PI-DISPLAY-ORIGINAL-BATCH
  8156         NEXT SENTENCE
  8157     ELSE
  8158         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8159             GO TO 5000-BROWSE-BATCH-HEADERS.
  8160
  8161     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8162         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8163
  8164     IF PI-CSR-BROWSE
  8165        GO TO 4200-BROWSE-CSR-FORWARD.
  8166
  8167     IF PI-FILE-BROWSE
  8168         GO TO 4300-BROWSE-FILE-FORWARD.
  8169
  8170     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8171
  8172 0020-MAIN-LOGIC.
  8173     IF EIBAID = DFHCLEAR
  8174         GO TO 9400-CLEAR.
  8175
  8176     MOVE LOW-VALUES             TO EC-NEW-CERT
  8177                                    EC-NEW-STATE.
  8178
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 150
* EL6311.cbl
  8180
  8181******************************************************************
  8182*                                                                *
  8183*              R E C E I V E   M A P                             *
  8184*                                                                *
  8185******************************************************************
  8186
  8187 0200-RECEIVE.
  8188     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8189         MOVE ER-0008            TO EMI-ERROR
  8190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8191         IF PI-MAP-NAME = EL631B
  8192             MOVE -1                 TO BMAINTL
  8193             GO TO 8200-SEND-DATAONLY
  8194         ELSE
  8195             IF PI-MAP-NAME = EL631C
  8196                 MOVE -1                 TO CMAINTL
  8197                 GO TO 8200-SEND-DATAONLY
  8198             ELSE
  8199                 IF PI-MAP-NAME = EL631D
  8200                     MOVE -1                 TO DPFENTRL
  8201                     GO TO 8200-SEND-DATAONLY.
  8202
  8203
  8204* EXEC CICS RECEIVE
  8205*        MAP      (PI-MAP-NAME)
  8206*        MAPSET   (MAPSET-EL6311S)
  8207*        INTO     (EL631BI)
  8208*    END-EXEC.
  8209     MOVE LENGTH OF
  8210      EL631BI
  8211       TO DFHEIV11
  8212*    MOVE '8"T I  L              ''   #00008191' TO DFHEIV0
  8213     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8214     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8215     MOVE X'2020233030303038313931' TO DFHEIV0(25:11)
  8216     CALL 'kxdfhei1' USING DFHEIV0,
  8217           PI-MAP-NAME,
  8218           EL631BI,
  8219           DFHEIV11,
  8220           MAPSET-EL6311S,
  8221           DFHEIV99,
  8222           DFHEIV99
  8223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8224
  8225
  8226******************************************************************
  8227*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8228******************************************************************
  8229
  8230     IF BTYPE-LEN (1) EQUAL +3
  8231        IF BTYPE (1) EQUAL ALL ' '
  8232            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8233
  8234     IF BTYPE-LEN (2) EQUAL +3
  8235        IF BTYPE (2) EQUAL ALL ' '
  8236            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8237
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 151
* EL6311.cbl
  8238     INSPECT EL631BI CONVERTING '_' TO ' '.
  8239
  8240     IF PI-MAP-NAME = EL631B
  8241         IF BPFENTRL GREATER THAN ZEROS
  8242             IF EIBAID NOT = DFHENTER
  8243                 MOVE ER-0004       TO EMI-ERROR
  8244                 MOVE -1            TO BPFENTRL
  8245                 MOVE AL-UNBOF      TO BPFENTRA
  8246                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8247                 GO TO 8200-SEND-DATAONLY
  8248             ELSE
  8249                 IF BPFENTRI NUMERIC AND
  8250                   (BPFENTRI GREATER 0 AND LESS 25)
  8251                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8252                 ELSE
  8253                     MOVE ER-0029  TO EMI-ERROR
  8254                     MOVE AL-UNBON TO BPFENTRA
  8255                     MOVE -1       TO BPFENTRL
  8256                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8257                     GO TO 8200-SEND-DATAONLY
  8258         ELSE
  8259             NEXT SENTENCE
  8260     ELSE
  8261         IF PI-MAP-NAME = EL631C
  8262            IF CPFENTRL GREATER THAN ZEROS
  8263                IF EIBAID NOT = DFHENTER
  8264                 MOVE ER-0004         TO EMI-ERROR
  8265                 MOVE -1              TO CPFENTRL
  8266                 MOVE AL-UNBOF        TO CPFENTRA
  8267                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8268                 GO TO 8200-SEND-DATAONLY
  8269             ELSE
  8270                 IF CPFENTRI NUMERIC AND
  8271                   (CPFENTRI GREATER 0 AND LESS 25)
  8272                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8273                 ELSE
  8274                     MOVE ER-0029      TO EMI-ERROR
  8275                     MOVE AL-UNBON     TO CPFENTRA
  8276                     MOVE -1           TO CPFENTRL
  8277                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8278                     GO TO 8200-SEND-DATAONLY
  8279         ELSE
  8280             NEXT SENTENCE
  8281     ELSE
  8282     IF PI-MAP-NAME = EL631D
  8283         IF DPFENTRL GREATER THAN ZEROS
  8284             IF EIBAID NOT = DFHENTER
  8285                 MOVE ER-0004         TO EMI-ERROR
  8286                 MOVE -1              TO DPFENTRL
  8287                 MOVE AL-UNBOF        TO DPFENTRA
  8288                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8289                 GO TO 8200-SEND-DATAONLY
  8290             ELSE
  8291                 IF DPFENTRI NUMERIC AND
  8292                   (DPFENTRI GREATER 0 AND LESS 25)
  8293                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8294                 ELSE
  8295                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 152
* EL6311.cbl
  8296                     MOVE AL-UNBON     TO DPFENTRA
  8297                     MOVE -1           TO DPFENTRL
  8298                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8299                     GO TO 8200-SEND-DATAONLY.
  8300
  8301     IF EIBAID = DFHPF23
  8302         GO TO 8810-PF23.
  8303
  8304     IF EIBAID = DFHPF24
  8305         GO TO 9200-RETURN-MAIN-MENU.
  8306
  8307     IF EIBAID = DFHPF12
  8308         GO TO 9500-PF12.
  8309
  8310     IF PI-MAP-NAME = EL631B
  8311        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8312
  8313     IF PI-MAP-NAME = EL631C
  8314        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8315
  8316     IF PI-MAP-NAME = EL631D
  8317        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8318
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 153
* EL6311.cbl
  8320
  8321******************************************************************
  8322*                                                                *
  8323*      ISSUE SCREEN PF KEY CHECKING                              *
  8324*                                                                *
  8325******************************************************************
  8326
  8327******************************************************************
  8328*                                                                *
  8329*      PF KEY FUNCTIONS:                                         *
  8330*                                                                *
  8331*      PF1  = BROWSE FORWARD                                     *
  8332*      PF2  = BROWSE BACKWARD                                    *
  8333*      PF3  = CERTIFICATE LOOKUP                                 *
  8334*      PF4  = DISPLAY BATCH HEADER                               *
  8335*      PF5  = ADD ISSUE  SCREEN                                  *
  8336*      PF6  = ADD CANCEL SCREEN                                  *
  8337*      PF7  = CERTIFICATE DISPLAY                                *
  8338*      PF8  = CERTIFICATE NOTES                                  *
  8339*      PF9  = EDIT CONTROL                                       *
  8340*      PF10 = DISPLAY LETTER SCREEN                              *
  8341*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8342*      PF12 = HELP SCREEN                                        *
  8343*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8344*      PF14 = ACCOUNT MASTER                                     *
  8345*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8346*      PF16 = DISPLAY LETTER REVIEW                              *
  8347*                                                                *
  8348******************************************************************
  8349
  8350 0300-CHECK-ISSUE-PF-KEYS.
  8351     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8352        MOVE ER-2337            TO EMI-ERROR
  8353        MOVE -1                  TO BMAINTL
  8354        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8355        GO TO 8200-SEND-DATAONLY.
  8356
  8357     IF EIBAID = DFHPF1
  8358        MOVE '0'                TO PI-EDIT-SW
  8359        IF PI-PRIMARY-BROWSE
  8360           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8361        ELSE
  8362           IF PI-PRIMARY-WITH-SELECT
  8363              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8364           ELSE
  8365              IF PI-FILE-BROWSE
  8366                 GO TO 4300-BROWSE-FILE-FORWARD
  8367              ELSE
  8368                 IF PI-CSR-BROWSE
  8369                    GO TO 4200-BROWSE-CSR-FORWARD
  8370                 ELSE
  8371                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8372
  8373     IF EIBAID = DFHPF2
  8374        MOVE '0'                TO PI-EDIT-SW
  8375        IF PI-PRIMARY-BROWSE
  8376           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8377        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 154
* EL6311.cbl
  8378           IF PI-PRIMARY-WITH-SELECT
  8379              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8380           ELSE
  8381              IF PI-FILE-BROWSE
  8382                 GO TO 4800-BROWSE-FILE-BACKWARD
  8383              ELSE
  8384                 IF PI-CSR-BROWSE
  8385                    GO TO 4900-BROWSE-CSR-BACKWARD
  8386                 ELSE
  8387                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8388
  8389     IF EIBAID = DFHPF3
  8390        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8391        MOVE XCTL-EL127         TO PGM-NAME
  8392        GO TO 9300-XCTL.
  8393
  8394     IF (EIBAID = DFHPF15 OR DFHPF6)
  8395        AND (CSR-EDIT-SESSION)
  8396*       AND (FATAL-OR-UNFORCED)
  8397        AND (FATAL-ERRORS)
  8398        MOVE ER-1819             TO EMI-ERROR
  8399        MOVE -1                  TO BMAINTL
  8400        MOVE AL-UANON            TO BMAINTA
  8401        PERFORM 9900-ERROR-FORMAT
  8402                                 THRU 9900-EXIT
  8403        GO TO 8200-SEND-DATAONLY
  8404     END-IF
  8405     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8406      OR (EIBAID = DFHPF10)
  8407        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8408        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8409        IF (RESP-NORMAL)
  8410           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8411              AM-CONTROL-PRIMARY (1:20))
  8412            IF AM-NAME NOT GREATER THAN SPACES OR
  8413               AM-ADDRS NOT GREATER THAN SPACES  OR
  8414               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8415               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8416               AM-ZIP NOT GREATER THAN SPACES
  8417               MOVE ER-3834             TO EMI-ERROR
  8418               MOVE -1                  TO BMAINTL
  8419               MOVE AL-UANON            TO BMAINTA
  8420               PERFORM 9900-ERROR-FORMAT
  8421                                 THRU 9900-EXIT
  8422               GO TO 8200-SEND-DATAONLY
  8423            END-IF
  8424        ELSE
  8425           MOVE ER-1609             TO EMI-ERROR
  8426           MOVE -1                  TO BMAINTL
  8427           MOVE AL-UANON            TO BMAINTA
  8428           PERFORM 9900-ERROR-FORMAT
  8429                                THRU 9900-EXIT
  8430           GO TO 8200-SEND-DATAONLY
  8431        END-IF
  8432
  8433        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8434        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8435        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 155
* EL6311.cbl
  8436            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8437               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8438               MA-CITY NOT GREATER THAN SPACES OR
  8439               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8440               MA-ZIP-CODE NOT GREATER THAN SPACES
  8441               MOVE ER-3835             TO EMI-ERROR
  8442               MOVE -1                  TO BMAINTL
  8443               MOVE AL-UANON            TO BMAINTA
  8444               PERFORM 9900-ERROR-FORMAT
  8445                                 THRU 9900-EXIT
  8446               GO TO 8200-SEND-DATAONLY
  8447            END-IF
  8448        ELSE
  8449           MOVE ER-3000             TO EMI-ERROR
  8450           MOVE -1                  TO BMAINTL
  8451           MOVE AL-UANON            TO BMAINTA
  8452           PERFORM 9900-ERROR-FORMAT
  8453                                THRU 9900-EXIT
  8454           GO TO 8200-SEND-DATAONLY
  8455        END-IF
  8456
  8457     END-IF
  8458     IF (EIBAID = DFHPF15)
  8459        AND (CSR-EDIT-SESSION)
  8460        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8461        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8462        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8463        MOVE PI-SV-STATE         TO PI-STATE
  8464        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8465        MOVE BCERTNOI            TO PI-CERT-PRIME
  8466        MOVE BSUFIXI             TO PI-CERT-SFX
  8467        MOVE BEFFDTI             TO DEEDIT-FIELD
  8468        PERFORM 8600-DEEDIT
  8469        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8470        MOVE '4'                 TO DC-OPTION-CODE
  8471        PERFORM 9700-DATE-LINK
  8472        IF DATE-CONVERSION-ERROR
  8473           MOVE ER-0348          TO EMI-ERROR
  8474           MOVE -1               TO BEFFDTL
  8475           MOVE AL-UABON         TO BEFFDTA
  8476           PERFORM 9900-ERROR-FORMAT
  8477                                 THRU 9900-EXIT
  8478           GO TO 8200-SEND-DATAONLY
  8479        ELSE
  8480           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8481           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8482           MOVE XCTL-EL6315      TO PGM-NAME
  8483           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8484           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8485           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8486           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8487           GO TO 9300-XCTL
  8488        END-IF
  8489     END-IF
  8490
  8491     IF EIBAID = DFHPF4
  8492        MOVE '0'                TO PI-EDIT-SW
  8493        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 156
* EL6311.cbl
  8494           NEXT SENTENCE
  8495        ELSE
  8496           GO TO 7200-DISPLAY-BATCHES.
  8497
  8498     IF EIBAID = DFHPF5
  8499        MOVE ER-0029                TO EMI-ERROR
  8500        MOVE -1                     TO BPFENTRL
  8501        MOVE AL-UNBON               TO BPFENTRA
  8502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8503        GO TO 8200-SEND-DATAONLY.
  8504*        MOVE '0'                TO PI-EDIT-SW
  8505*        IF PI-DISPLAY-ORIGINAL-BATCH
  8506*           NEXT SENTENCE
  8507*        ELSE
  8508*           MOVE EL631B              TO PI-MAP-NAME
  8509*           MOVE LOW-VALUES          TO EL631BI
  8510*           MOVE 'A'                 TO BMAINTO
  8511*           MOVE AL-UANON            TO BMAINTA
  8512*           MOVE -1                  TO BMAINTL
  8513*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8514*           GO TO 8100-SEND-INITIAL-MAP.
  8515
  8516     IF EIBAID = DFHPF6
  8517        IF NOT CSR-EDIT-SESSION
  8518           MOVE ER-0029                TO EMI-ERROR
  8519           MOVE -1                     TO BPFENTRL
  8520           MOVE AL-UNBON               TO BPFENTRA
  8521           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8522           GO TO 8200-SEND-DATAONLY
  8523*           MOVE '0'              TO PI-EDIT-SW
  8524*           IF PI-DISPLAY-ORIGINAL-BATCH
  8525*              NEXT SENTENCE
  8526*           ELSE
  8527*              MOVE EL631C        TO PI-MAP-NAME
  8528*              MOVE LOW-VALUES    TO EL631CI
  8529*              MOVE 'A'           TO CMAINTO
  8530*              MOVE AL-UANON      TO CMAINTA
  8531*              MOVE -1            TO CMAINTL
  8532*              MOVE '6'           TO PI-MAINT-FUNCTION
  8533*              GO TO 8100-SEND-INITIAL-MAP
  8534*           END-IF
  8535        ELSE
  8536           PERFORM 5100-PROCESS-POL-RESC
  8537                                 THRU 5100-EXIT
  8538           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8539           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8540                                    PI-PREV-SEQ-NO
  8541           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8542*                                    WS-CANCEL-LETTER-SW
  8543                                    PI-ALL-ISSUES-SW
  8544                                    PI-ALL-CANCELS-SW
  8545           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8546        END-IF
  8547     END-IF
  8548     IF EIBAID = DFHPF7
  8549        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8550        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8551        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 157
* EL6311.cbl
  8552        MOVE PI-SV-STATE            TO PI-STATE
  8553        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8554        MOVE BCERTNOI               TO PI-CERT-PRIME
  8555        MOVE BSUFIXI                TO PI-CERT-SFX
  8556        MOVE BEFFDTI                TO DEEDIT-FIELD
  8557        PERFORM 8600-DEEDIT
  8558        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8559        MOVE '4'                    TO DC-OPTION-CODE
  8560        PERFORM 9700-DATE-LINK
  8561        IF DATE-CONVERSION-ERROR
  8562           MOVE ER-0348            TO EMI-ERROR
  8563           MOVE -1                  TO BEFFDTL
  8564           MOVE AL-UABON            TO BEFFDTA
  8565           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8566           GO TO 8200-SEND-DATAONLY
  8567        ELSE
  8568           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8569           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8570           MOVE XCTL-EL1273        TO PGM-NAME
  8571           GO TO 9300-XCTL.
  8572
  8573     IF EIBAID = DFHPF8
  8574        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8575        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8576        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8577        MOVE PI-SV-STATE            TO PI-STATE
  8578        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8579        MOVE BCERTNOI               TO PI-CERT-PRIME
  8580        MOVE BSUFIXI                TO PI-CERT-SFX
  8581        MOVE BEFFDTI                TO DEEDIT-FIELD
  8582        PERFORM 8600-DEEDIT
  8583        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8584        MOVE '4'                    TO DC-OPTION-CODE
  8585        PERFORM 9700-DATE-LINK
  8586        IF DATE-CONVERSION-ERROR
  8587           MOVE ER-0348            TO EMI-ERROR
  8588           MOVE -1                  TO BEFFDTL
  8589           MOVE AL-UABON            TO BEFFDTA
  8590           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8591           GO TO 8200-SEND-DATAONLY
  8592        ELSE
  8593           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8594           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8595           IF PI-COMPANY-ID = 'DMD'
  8596               MOVE XCTL-EL401DMD      TO PGM-NAME
  8597             ELSE
  8598               MOVE XCTL-EL1279        TO PGM-NAME
  8599           END-IF
  8600           GO TO 9300-XCTL.
  8601
  8602     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8603        MOVE XCTL-EL6312         TO PGM-NAME
  8604
  8605* EXEC CICS XCTL
  8606*           PROGRAM   (PGM-NAME)
  8607*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8608*           LENGTH    (WS-COMM-LENGTH)
  8609*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 158
* EL6311.cbl
  8610*    MOVE '.$C                   %   #00008575' TO DFHEIV0
  8611     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8612     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8613     MOVE X'2020233030303038353735' TO DFHEIV0(25:11)
  8614     CALL 'kxdfhei1' USING DFHEIV0,
  8615           PGM-NAME,
  8616           PROGRAM-INTERFACE-BLOCK,
  8617           WS-COMM-LENGTH,
  8618           DFHEIV99
  8619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8620     ELSE
  8621        MOVE '0'                 TO  PI-EDIT-SW.
  8622
  8623     IF  EIBAID = DFHPF10
  8624         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8625         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8626         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8627                                    PI-1042-WA
  8628         MOVE 4                  TO PI-689-DATA-SOURCE
  8629         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8630         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8631         MOVE PI-SV-STATE        TO PI-689-STATE
  8632         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8633         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8634         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8635         MOVE PI-PB-ALT-CHG-SEQ-NO
  8636                                 TO PI-689-ALT-SEQ-NO
  8637         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8638         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8639         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8640         MOVE +0                 TO PI-689-CONTROL
  8641         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8642                                    PI-689-EXP-DATE
  8643                                    PI-689-RESP-PERSON
  8644                                    PI-689-TYPE
  8645                                    PI-689-FOLLOW-UP-EDIT
  8646                                    PI-689-RESEND1-EDIT
  8647                                    PI-689-SEQ-EDIT
  8648                                    PI-689-BCSEQ-EDIT
  8649                                    PI-689-LBL-OVERRIDE
  8650         MOVE W-LETTER-COMMUNICATION-AREAS
  8651                                 TO PI-PROGRAM-WORK-AREA
  8652         MOVE XCTL-EL689         TO PGM-NAME
  8653         GO TO 9300-XCTL.
  8654
  8655     IF  EIBAID = DFHPF16
  8656         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8657         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8658         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8659                                    PI-1042-WA
  8660         MOVE 4                  TO PI-689-DATA-SOURCE
  8661         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8662         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8663         MOVE PI-SV-STATE        TO PI-689-STATE
  8664         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8665         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8666         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8667         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 159
* EL6311.cbl
  8668                                 TO PI-689-ALT-SEQ-NO
  8669         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8670         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8671         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8672         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8673         MOVE W-LETTER-COMMUNICATION-AREAS
  8674                                 TO PI-PROGRAM-WORK-AREA
  8675         MOVE XCTL-EL690         TO PGM-NAME
  8676         GO TO 9300-XCTL.
  8677
  8678     IF EIBAID = DFHPF13
  8679         MOVE XCTL-EL6313        TO PGM-NAME
  8680         GO TO 9300-XCTL.
  8681
  8682     IF EIBAID = DFHPF17
  8683        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8684        IF (PB-I-LOAN-APR > ZEROS)
  8685           and (pb-i-loan-apr < 99.9999)
  8686           AND (PB-I-BENEFICIARY-NAME NOT
  8687              = SPACES AND LOW-VALUES)
  8688
  8689           MOVE LINK-ELVADS          TO PGM-NAME
  8690
  8691* EXEC CICS LINK
  8692*              PROGRAM    (PGM-NAME)
  8693*              COMMAREA   (WS-PASS-AREA)
  8694*              LENGTH     (WS-PASS-AREA-LENGTH)
  8695*          END-EXEC
  8696*    MOVE '."C                   (   #00008650' TO DFHEIV0
  8697     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8698     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8699     MOVE X'2020233030303038363530' TO DFHEIV0(25:11)
  8700     CALL 'kxdfhei1' USING DFHEIV0,
  8701           PGM-NAME,
  8702           WS-PASS-AREA,
  8703           WS-PASS-AREA-LENGTH,
  8704           DFHEIV99,
  8705           DFHEIV99,
  8706           DFHEIV99,
  8707           DFHEIV99
  8708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8709
  8710           MOVE 0000             TO EMI-ERROR
  8711           MOVE -1               TO BMAINTL
  8712           PERFORM 9900-ERROR-FORMAT
  8713                                 THRU 9900-EXIT
  8714           GO TO 8200-SEND-DATAONLY
  8715        ELSE
  8716           MOVE ER-0877            TO EMI-ERROR
  8717           MOVE -1                  TO BEFFDTL
  8718           MOVE AL-UABON            TO BEFFDTA
  8719           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8720           GO TO 8200-SEND-DATAONLY
  8721        END-IF
  8722     END-IF
  8723     IF EIBAID = DFHPF14
  8724        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8725        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 160
* EL6311.cbl
  8726        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8727        MOVE PI-SV-STATE            TO PI-CR-STATE
  8728        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8729        MOVE SPACE                  TO PI-EDIT-SW
  8730        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8731        MOVE XCTL-EL650             TO PGM-NAME
  8732        GO TO 9300-XCTL.
  8733
  8734     IF EIBAID = DFHPF15
  8735        IF PI-COMPANY-ID  =  'HER'
  8736            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8737            MOVE XCTL-EL680         TO PGM-NAME
  8738            GO TO 9300-XCTL.
  8739
  8740     IF EIBAID = DFHENTER OR DFHPF11
  8741        GO TO 1000-ISSUE-MAINLINE.
  8742
  8743     MOVE ER-0029                TO EMI-ERROR
  8744     MOVE -1                     TO BPFENTRL
  8745     MOVE AL-UNBON               TO BPFENTRA
  8746     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8747     GO TO 8200-SEND-DATAONLY.
  8748
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 161
* EL6311.cbl
  8750
  8751******************************************************************
  8752*                                                                *
  8753*      CANCEL SCREEN PF KEY CHECKING                             *
  8754*                                                                *
  8755******************************************************************
  8756
  8757******************************************************************
  8758*                                                                *
  8759*      PF KEY FUNCTIONS:                                         *
  8760*                                                                *
  8761*      PF1  = BROWSE FORWARD                                     *
  8762*      PF2  = BROWSE BACKWARD                                    *
  8763*      PF3  = CERTIFICATE LOOKUP                                 *
  8764*      PF4  = DISPLAY BATCH HEADER                               *
  8765*      PF5  = ADD ISSUE SCREEN                                   *
  8766*      PF6  = ADD CANCEL SCREEN                                  *
  8767*      PF7  = CERTIFICATE DISPLAY                                *
  8768*      PF8  = CERTIFICATE NOTES                                  *
  8769*      PF9  = EDIT CONTROL                                       *
  8770*      PF10 = DISPLAY LETTER SCREEN                              *
  8771*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8772*      PF12 = DISPLAY HELP SCREEN                                *
  8773*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8774*      PF14 = ACCOUNT MASTER                                     *
  8775*      PF16 = LETTER REVIEW                                      *
  8776*                                                                *
  8777******************************************************************
  8778
  8779 0400-CHECK-CANCEL-PF-KEYS.
  8780     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8781        MOVE ER-2337             TO EMI-ERROR
  8782        MOVE -1                  TO CMAINTL
  8783        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8784        GO TO 8200-SEND-DATAONLY.
  8785
  8786     IF EIBAID = DFHPF1
  8787        MOVE '0'                TO PI-EDIT-SW
  8788        IF PI-PRIMARY-BROWSE
  8789           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8790        ELSE
  8791           IF PI-PRIMARY-WITH-SELECT
  8792              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8793           ELSE
  8794              IF PI-FILE-BROWSE
  8795                 GO TO 4300-BROWSE-FILE-FORWARD
  8796              ELSE
  8797                 IF PI-CSR-BROWSE
  8798                    GO TO 4200-BROWSE-CSR-FORWARD
  8799                 ELSE
  8800                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8801
  8802     IF EIBAID = DFHPF2
  8803        MOVE '0'                TO PI-EDIT-SW
  8804        IF PI-PRIMARY-BROWSE
  8805           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8806        ELSE
  8807           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 162
* EL6311.cbl
  8808              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8809           ELSE
  8810              IF PI-FILE-BROWSE
  8811                 GO TO 4800-BROWSE-FILE-BACKWARD
  8812              ELSE
  8813                 IF PI-CSR-BROWSE
  8814                    GO TO 4900-BROWSE-CSR-BACKWARD
  8815                 ELSE
  8816                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8817
  8818     IF EIBAID = DFHPF3
  8819        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8820        MOVE XCTL-EL127         TO PGM-NAME
  8821        GO TO 9300-XCTL.
  8822
  8823     IF (EIBAID = DFHPF15 OR DFHPF17)
  8824        AND (CSR-EDIT-SESSION)
  8825*       AND (FATAL-OR-UNFORCED)
  8826        AND (FATAL-ERRORS)
  8827        MOVE ER-1819             TO EMI-ERROR
  8828        MOVE -1                  TO CMAINTL
  8829        MOVE AL-UANON            TO CMAINTA
  8830        PERFORM 9900-ERROR-FORMAT
  8831                                 THRU 9900-EXIT
  8832        GO TO 8200-SEND-DATAONLY
  8833     END-IF
  8834     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8835       AND (CSR-EDIT-SESSION)
  8836        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8837        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8838        IF (RESP-NORMAL)
  8839           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8840              AM-CONTROL-PRIMARY (1:20))
  8841            IF AM-NAME NOT GREATER THAN SPACES OR
  8842               AM-ADDRS NOT GREATER THAN SPACES  OR
  8843               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8844               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8845               AM-ZIP NOT GREATER THAN SPACES
  8846               MOVE ER-3834             TO EMI-ERROR
  8847               MOVE -1                  TO BMAINTL
  8848               MOVE AL-UANON            TO BMAINTA
  8849               PERFORM 9900-ERROR-FORMAT
  8850                                 THRU 9900-EXIT
  8851               GO TO 8200-SEND-DATAONLY
  8852            END-IF
  8853        ELSE
  8854           MOVE ER-1609             TO EMI-ERROR
  8855           MOVE -1                  TO BMAINTL
  8856           MOVE AL-UANON            TO BMAINTA
  8857           PERFORM 9900-ERROR-FORMAT
  8858                                THRU 9900-EXIT
  8859           GO TO 8200-SEND-DATAONLY
  8860        END-IF
  8861
  8862        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8863        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8864        IF (ERMAIL-FOUND)
  8865            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 163
* EL6311.cbl
  8866               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8867               MA-CITY NOT GREATER THAN SPACES OR
  8868               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8869               MA-ZIP-CODE NOT GREATER THAN SPACES
  8870               MOVE ER-3835             TO EMI-ERROR
  8871               MOVE -1                  TO BMAINTL
  8872               MOVE AL-UANON            TO BMAINTA
  8873               PERFORM 9900-ERROR-FORMAT
  8874                                 THRU 9900-EXIT
  8875               GO TO 8200-SEND-DATAONLY
  8876            END-IF
  8877        ELSE
  8878           MOVE ER-3000             TO EMI-ERROR
  8879           MOVE -1                  TO BMAINTL
  8880           MOVE AL-UANON            TO BMAINTA
  8881           PERFORM 9900-ERROR-FORMAT
  8882                                THRU 9900-EXIT
  8883           GO TO 8200-SEND-DATAONLY
  8884        END-IF
  8885
  8886     END-IF
  8887     IF (EIBAID = DFHPF15 OR DFHPF17)
  8888        AND (CSR-EDIT-SESSION)
  8889        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8890        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8891        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8892        MOVE PI-SV-STATE         TO PI-STATE
  8893        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8894        MOVE CCERTNOI            TO PI-CERT-PRIME
  8895        MOVE CSUFIXI             TO PI-CERT-SFX
  8896        MOVE CEFFDTI             TO DEEDIT-FIELD
  8897        PERFORM 8600-DEEDIT
  8898        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8899        MOVE '4'                 TO DC-OPTION-CODE
  8900        PERFORM 9700-DATE-LINK
  8901        IF DATE-CONVERSION-ERROR
  8902           MOVE ER-0348          TO EMI-ERROR
  8903           MOVE -1               TO CEFFDTL
  8904           MOVE AL-UABON         TO CEFFDTA
  8905           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8906           GO TO 8200-SEND-DATAONLY
  8907        ELSE
  8908           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8909           PERFORM 6000-CREATE-TEMP-STORAGE
  8910                                 THRU 6000-EXIT
  8911           IF EIBAID = DFHPF17
  8912               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8913                                  THRU 6400-EXIT
  8914               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8915                                 '2' AND '3' AND '4'
  8916                  MOVE ER-3831     TO  EMI-ERROR
  8917                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8918                  GO TO 8200-SEND-DATAONLY
  8919               END-IF
  8920               MOVE 'Y'          TO PI-CLM-RESC-IND
  8921           ELSE
  8922               MOVE 'N'          TO PI-CLM-RESC-IND
  8923           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 164
* EL6311.cbl
  8924           MOVE XCTL-EL6316      TO PGM-NAME
  8925           MOVE '2'              TO PI-ISS-CAN-SW
  8926           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8927           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8928           GO TO 9300-XCTL
  8929        END-IF
  8930     END-IF
  8931
  8932     IF EIBAID = DFHPF4
  8933        MOVE '0'                TO PI-EDIT-SW
  8934        IF PI-DISPLAY-ORIGINAL-BATCH
  8935           NEXT SENTENCE
  8936        ELSE
  8937           GO TO 7200-DISPLAY-BATCHES.
  8938
  8939     IF EIBAID = DFHPF5
  8940        MOVE ER-0029                TO EMI-ERROR
  8941        MOVE -1                     TO BPFENTRL
  8942        MOVE AL-UNBON               TO BPFENTRA
  8943        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8944        GO TO 8200-SEND-DATAONLY.
  8945*        MOVE '0'                TO PI-EDIT-SW
  8946*        IF PI-DISPLAY-ORIGINAL-BATCH
  8947*           NEXT SENTENCE
  8948*        ELSE
  8949*           MOVE EL631B              TO PI-MAP-NAME
  8950*           MOVE LOW-VALUES          TO EL631BI
  8951*           MOVE 'A'                 TO BMAINTO
  8952*           MOVE AL-UANON            TO BMAINTA
  8953*           MOVE -1                  TO BMAINTL
  8954*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8955*           GO TO 8100-SEND-INITIAL-MAP.
  8956
  8957     IF EIBAID = DFHPF6
  8958        MOVE ER-0029                TO EMI-ERROR
  8959        MOVE -1                     TO BPFENTRL
  8960        MOVE AL-UNBON               TO BPFENTRA
  8961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8962        GO TO 8200-SEND-DATAONLY.
  8963*        MOVE '0'                TO PI-EDIT-SW
  8964*        IF PI-DISPLAY-ORIGINAL-BATCH
  8965*           NEXT SENTENCE
  8966*        ELSE
  8967*           MOVE EL631C              TO PI-MAP-NAME
  8968*           MOVE LOW-VALUES          TO EL631CI
  8969*           MOVE 'A'                 TO CMAINTO
  8970*           MOVE AL-UANON            TO CMAINTA
  8971*           MOVE -1                  TO CMAINTL
  8972*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8973*           GO TO 8100-SEND-INITIAL-MAP.
  8974
  8975     IF EIBAID = DFHPF7
  8976        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8977        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8978        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8979        MOVE PI-SV-STATE            TO PI-STATE
  8980        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8981        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 165
* EL6311.cbl
  8982        MOVE CSUFIXI                TO PI-CERT-SFX
  8983        MOVE CEFFDTI                TO DEEDIT-FIELD
  8984        PERFORM 8600-DEEDIT
  8985        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8986        MOVE '4'                    TO DC-OPTION-CODE
  8987        PERFORM 9700-DATE-LINK
  8988        IF DATE-CONVERSION-ERROR
  8989           MOVE ER-0348            TO EMI-ERROR
  8990           MOVE -1                  TO BEFFDTL
  8991           MOVE AL-UABON            TO BEFFDTA
  8992           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8993           GO TO 8200-SEND-DATAONLY
  8994        ELSE
  8995           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8996           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8997           MOVE XCTL-EL1273        TO PGM-NAME
  8998           GO TO 9300-XCTL.
  8999
  9000     IF EIBAID = DFHPF8
  9001        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9002        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9003        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9004        MOVE PI-SV-STATE            TO PI-STATE
  9005        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9006        MOVE CCERTNOI               TO PI-CERT-PRIME
  9007        MOVE CSUFIXI                TO PI-CERT-SFX
  9008        MOVE CEFFDTI                TO DEEDIT-FIELD
  9009        PERFORM 8600-DEEDIT
  9010        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9011        MOVE '4'                    TO DC-OPTION-CODE
  9012        PERFORM 9700-DATE-LINK
  9013        IF DATE-CONVERSION-ERROR
  9014           MOVE ER-0348             TO EMI-ERROR
  9015           MOVE -1                  TO BEFFDTL
  9016           MOVE AL-UABON            TO BEFFDTA
  9017           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9018           GO TO 8200-SEND-DATAONLY
  9019        ELSE
  9020           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9021           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9022           IF PI-COMPANY-ID = 'DMD'
  9023               MOVE XCTL-EL401DMD      TO PGM-NAME
  9024             ELSE
  9025               MOVE XCTL-EL1279        TO PGM-NAME
  9026           END-IF
  9027           GO TO 9300-XCTL.
  9028
  9029     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9030        MOVE XCTL-EL6312     TO PGM-NAME
  9031
  9032* EXEC CICS XCTL
  9033*           PROGRAM  (PGM-NAME)
  9034*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9035*           LENGTH   (WS-COMM-LENGTH)
  9036*       END-EXEC
  9037*    MOVE '.$C                   %   #00008977' TO DFHEIV0
  9038     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9039     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 166
* EL6311.cbl
  9040     MOVE X'2020233030303038393737' TO DFHEIV0(25:11)
  9041     CALL 'kxdfhei1' USING DFHEIV0,
  9042           PGM-NAME,
  9043           PROGRAM-INTERFACE-BLOCK,
  9044           WS-COMM-LENGTH,
  9045           DFHEIV99
  9046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9047     ELSE
  9048        MOVE '0'                 TO  PI-EDIT-SW.
  9049
  9050     IF EIBAID = DFHPF10
  9051         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9052         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9053         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9054         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9055                                    PI-1042-WA
  9056         MOVE 4                  TO PI-689-DATA-SOURCE
  9057         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9058         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9059         MOVE PI-SV-STATE        TO PI-689-STATE
  9060         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9061         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9062         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9063         MOVE PI-PB-ALT-CHG-SEQ-NO
  9064                                 TO PI-689-ALT-SEQ-NO
  9065         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9066         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9067         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9068         MOVE +0                 TO PI-689-CONTROL
  9069         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9070                                    PI-689-EXP-DATE
  9071                                    PI-689-RESP-PERSON
  9072                                    PI-689-TYPE
  9073                                    PI-689-FOLLOW-UP-EDIT
  9074                                    PI-689-RESEND1-EDIT
  9075                                    PI-689-SEQ-EDIT
  9076                                    PI-689-BCSEQ-EDIT
  9077                                    PI-689-LBL-OVERRIDE
  9078         MOVE W-LETTER-COMMUNICATION-AREAS
  9079                                 TO PI-PROGRAM-WORK-AREA
  9080         MOVE XCTL-EL689         TO PGM-NAME
  9081         GO TO 9300-XCTL.
  9082
  9083     IF  EIBAID = DFHPF16
  9084         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9085         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9086         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9087                                    PI-1042-WA
  9088         MOVE 4                  TO PI-689-DATA-SOURCE
  9089         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9090         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9091         MOVE PI-SV-STATE        TO PI-689-STATE
  9092         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9093         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9094         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9095         MOVE PI-PB-ALT-CHG-SEQ-NO
  9096                                 TO PI-689-ALT-SEQ-NO
  9097         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 167
* EL6311.cbl
  9098         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9099         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9100         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9101         MOVE W-LETTER-COMMUNICATION-AREAS
  9102                                 TO PI-PROGRAM-WORK-AREA
  9103         MOVE XCTL-EL690         TO PGM-NAME
  9104         GO TO 9300-XCTL.
  9105     IF (EIBAID = DFHPF13)
  9106        if (not fatal-errors)
  9107           and (not unforced-errors)
  9108           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9109           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9110           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9111           MOVE PI-SV-STATE      TO PI-STATE
  9112           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9113           MOVE CCERTNOI         TO PI-CERT-PRIME
  9114           MOVE CSUFIXI          TO PI-CERT-SFX
  9115           MOVE CEFFDTI          TO DEEDIT-FIELD
  9116           PERFORM 8600-DEEDIT
  9117           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9118           MOVE '4'              TO DC-OPTION-CODE
  9119           PERFORM 9700-DATE-LINK
  9120           IF DATE-CONVERSION-ERROR
  9121              MOVE ER-0348       TO EMI-ERROR
  9122              MOVE -1            TO CEFFDTL
  9123              MOVE AL-UABON      TO CEFFDTA
  9124              PERFORM 9900-ERROR-FORMAT
  9125                                 THRU 9900-EXIT
  9126              GO TO 8200-SEND-DATAONLY
  9127           ELSE
  9128              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9129              MOVE AL-UANON      TO CEFFDTA
  9130              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9131              PERFORM 6000-CREATE-TEMP-STORAGE
  9132                                 THRU 6000-EXIT
  9133              MOVE XCTL-EL677    TO PGM-NAME
  9134              GO TO 9300-XCTL
  9135           end-if
  9136        else
  9137           MOVE ER-3444          TO EMI-ERROR
  9138           MOVE -1               TO CPFENTRL
  9139           MOVE AL-UNBON         TO CPFENTRA
  9140           PERFORM 9900-ERROR-FORMAT
  9141                                 THRU 9900-EXIT
  9142           GO TO 8200-SEND-DATAONLY
  9143        end-if
  9144     end-if
  9145
  9146     IF EIBAID = DFHPF14
  9147        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9148        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9149        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9150        MOVE PI-SV-STATE            TO PI-CR-STATE
  9151        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9152        MOVE SPACE                  TO PI-EDIT-SW
  9153        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9154        MOVE XCTL-EL650             TO PGM-NAME
  9155        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 168
* EL6311.cbl
  9156
  9157     IF EIBAID = DFHENTER OR DFHPF11
  9158        GO TO 2000-CANCEL-MAINLINE.
  9159
  9160     MOVE ER-0029                TO EMI-ERROR.
  9161     MOVE -1                     TO CPFENTRL.
  9162     MOVE AL-UNBON               TO CPFENTRA.
  9163     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9164     GO TO 8200-SEND-DATAONLY.
  9165
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 169
* EL6311.cbl
  9167
  9168******************************************************************
  9169*                                                                *
  9170*      BATCH SCREEN PF KEY CHECKING                              *
  9171*                                                                *
  9172******************************************************************
  9173
  9174******************************************************************
  9175*                                                                *
  9176*      PF KEY FUNCTIONS:                                         *
  9177*                                                                *
  9178*      PF1 = BROWSE FORWARD                                      *
  9179*      PF2 = BROWSE BACKWARD                                     *
  9180*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9181*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9182*                                                                *
  9183*                                                                *
  9184******************************************************************
  9185
  9186 0500-CHECK-BATCH-PF-KEYS.
  9187     IF EIBAID = DFHPF1
  9188        MOVE '0'                TO PI-EDIT-SW
  9189        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9190           GO TO 5000-BROWSE-BATCH-HEADERS
  9191        ELSE
  9192           IF PI-GOOD-BROWSE
  9193              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9194                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9195              ELSE
  9196                 IF PI-FILE-BROWSE
  9197                    GO TO 4300-BROWSE-FILE-FORWARD
  9198                 ELSE
  9199                    IF PI-CSR-BROWSE
  9200                       GO TO 4200-BROWSE-CSR-FORWARD
  9201                    ELSE
  9202                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9203           ELSE
  9204              GO TO 0800-BROWSE-ERROR.
  9205
  9206     IF EIBAID = DFHPF2
  9207        MOVE '0'                TO PI-EDIT-SW
  9208        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9209           GO TO 5500-BROWSE-BATCH-BACKWARD
  9210        ELSE
  9211           IF PI-GOOD-BROWSE
  9212              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9213                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9214              ELSE
  9215                 IF PI-FILE-BROWSE
  9216                    GO TO 4800-BROWSE-FILE-BACKWARD
  9217                 ELSE
  9218                    IF PI-CSR-BROWSE
  9219                       GO TO 4900-BROWSE-CSR-BACKWARD
  9220                    ELSE
  9221                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9222           ELSE
  9223              GO TO 0800-BROWSE-ERROR.
  9224
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 170
* EL6311.cbl
  9225     IF EIBAID = DFHPF3
  9226        GO TO 3000-BATCH-MAINLINE.
  9227
  9228     IF  EIBAID = DFHPF4
  9229        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9230        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9231        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9232        MOVE PI-SV-STATE            TO PI-CR-STATE
  9233        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9234                                       PI-CR-FIN-RESP
  9235        MOVE 'A'                    TO PI-CR-TYPE
  9236        MOVE SPACE                  TO PI-EDIT-SW
  9237        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9238        MOVE XCTL-EL640             TO PGM-NAME
  9239        GO TO 9300-XCTL.
  9240
  9241     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9242       AND
  9243        (EIBAID = DFHENTER)
  9244           GO TO 3500-EDIT-BATCH-DATA.
  9245
  9246     IF EIBAID = DFHENTER
  9247        GO TO 3500-EDIT-BATCH-DATA.
  9248
  9249     MOVE ER-0029             TO EMI-ERROR.
  9250     MOVE -1                  TO DPFENTRL.
  9251     MOVE AL-UNBON            TO DPFENTRA.
  9252     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9253     GO TO 8200-SEND-DATAONLY.
  9254
  9255 0800-BROWSE-ERROR.
  9256     MOVE ER-2258                TO EMI-ERROR.
  9257     MOVE -1                     TO DPFENTRL.
  9258     MOVE AL-UNBON               TO DPFENTRA.
  9259     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9260     GO TO 8200-SEND-DATAONLY.
  9261
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 171
* EL6311.cbl
  9263
  9264******************************************************************
  9265*                                                                *
  9266*                I S S U E   M A I N L I N E                     *
  9267*                                                                *
  9268******************************************************************
  9269
  9270 1000-ISSUE-MAINLINE.
  9271     IF PI-DISPLAY-ORIGINAL-BATCH
  9272        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9273           MOVE ER-0023             TO EMI-ERROR
  9274           MOVE -1                  TO BMAINTL
  9275           MOVE AL-UABON            TO BMAINTA
  9276           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9277           GO TO 8200-SEND-DATAONLY
  9278        ELSE
  9279           NEXT SENTENCE
  9280     ELSE
  9281        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9282           MOVE ER-0023             TO EMI-ERROR
  9283           MOVE -1                  TO BMAINTL
  9284           MOVE AL-UABON            TO BMAINTA
  9285           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9286           GO TO 8200-SEND-DATAONLY.
  9287
  9288     IF BMAINTI = 'S'
  9289        GO TO 1100-SHOW-REQUEST.
  9290
  9291     IF NOT MODIFY-CAP
  9292         MOVE 'UPDATE'       TO SM-READ
  9293         PERFORM 9995-SECURITY-VIOLATION
  9294         MOVE ER-0070        TO EMI-ERROR
  9295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9296         GO TO 8100-SEND-INITIAL-MAP.
  9297
  9298     IF BMAINTL GREATER THAN ZEROS
  9299        IF PI-PF5-FUNCTION
  9300           IF BMAINTI NOT = 'A'
  9301              MOVE AL-UABON  TO BMAINTA
  9302              MOVE -1        TO BMAINTL
  9303              MOVE ER-2260   TO EMI-ERROR
  9304              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9305              GO TO 8200-SEND-DATAONLY.
  9306
  9307     IF BCERTNOL = ZEROS
  9308       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9309         NEXT SENTENCE
  9310     ELSE
  9311         IF BCERTNOL NOT = ZEROS
  9312             MOVE AL-UANON       TO BCERTNOA
  9313         ELSE
  9314             MOVE -1             TO BCERTNOL
  9315             MOVE  1             TO SET-CURSOR-SW
  9316             MOVE ER-2218        TO EMI-ERROR
  9317             MOVE AL-UABON       TO BCERTNOA
  9318             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9319
  9320     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 172
* EL6311.cbl
  9321         MOVE AL-UANON       TO BSUFIXA
  9322     ELSE
  9323         MOVE AL-SANOF       TO BSUFIXA.
  9324
  9325     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9326        NEXT SENTENCE
  9327     ELSE
  9328        IF BEFFDTL NOT = ZEROS
  9329           MOVE AL-UNNON             TO BEFFDTA
  9330           MOVE BEFFDTI              TO DEEDIT-FIELD
  9331           PERFORM 8600-DEEDIT
  9332           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9333           MOVE 4                    TO DC-OPTION-CODE
  9334           PERFORM 9700-DATE-LINK
  9335           IF NO-CONVERSION-ERROR
  9336              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9337              ELSE
  9338              MOVE -1                TO BEFFDTL
  9339              MOVE  1                TO SET-CURSOR-SW
  9340              MOVE ER-2226           TO EMI-ERROR
  9341              MOVE AL-UNBON          TO BEFFDTA
  9342              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9343           ELSE
  9344              MOVE -1                TO BEFFDTL
  9345              MOVE  1                TO SET-CURSOR-SW
  9346              MOVE ER-2220           TO EMI-ERROR
  9347              MOVE AL-UNBON          TO BEFFDTA
  9348              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9349
  9350     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9351
  9352     IF BCERTNOL NOT = ZEROS
  9353        MOVE BCERTNOI                TO WS-NEW-PRIME
  9354     ELSE
  9355        MOVE SPACES                  TO WS-NEW-PRIME.
  9356
  9357     IF BSUFIXL NOT = ZEROS
  9358        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9359     ELSE
  9360        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9361
  9362     IF BEFFDTL NOT = ZEROS
  9363        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9364     ELSE
  9365        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9366
  9367     IF BMAINTI = 'A' OR 'K' OR 'S'
  9368        NEXT SENTENCE
  9369     ELSE
  9370        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9371        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9372           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9373           WS-PB-RECORD-TYPE NOT = '1'
  9374           IF BMAINTI = 'C'
  9375               MOVE ER-2287          TO EMI-ERROR
  9376               MOVE -1               TO BCERTNOL
  9377               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9378               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 173
* EL6311.cbl
  9379               GO TO 8200-SEND-DATAONLY
  9380             ELSE
  9381               MOVE ER-2260          TO EMI-ERROR
  9382               MOVE -1               TO BCERTNOL
  9383               MOVE AL-UABON         TO BCERTNOA
  9384               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9385               GO TO 8200-SEND-DATAONLY.
  9386
  9387     IF BMAINTI = 'D'
  9388         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9389
  9390*    IF BMICRNOL  NOT =  ZEROS
  9391*        IF BMICRNOI  NUMERIC
  9392*            MOVE AL-UNNON       TO  BMICRNOA
  9393*        ELSE
  9394*            MOVE -1             TO  BMICRNOL
  9395*            MOVE 1              TO  SET-CURSOR-SW
  9396*            MOVE AL-UNBON       TO  BMICRNOA
  9397*            MOVE ER-2701        TO  EMI-ERROR
  9398*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9399     IF BVINL NOT = ZEROS
  9400        MOVE AL-UANON            TO BVINA
  9401     END-IF
  9402     IF B1STNML NOT = ZEROS
  9403         MOVE AL-UANON                TO B1STNMA.
  9404
  9405     IF BINITL  NOT = ZEROS
  9406        MOVE AL-UANON                TO BINITA.
  9407
  9408     IF BSEXL NOT = ZEROS
  9409        IF BSEXI = 'M' OR 'F'
  9410           MOVE AL-UANON             TO BSEXA
  9411        ELSE
  9412           MOVE -1               TO BSEXL
  9413           MOVE ER-2629          TO EMI-ERROR
  9414           MOVE AL-UABON         TO BSEXA
  9415           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9416
  9417     IF BAGEL NOT = ZEROS
  9418         IF BAGEI NUMERIC
  9419             MOVE BAGEI              TO WS-BAGE
  9420             MOVE AL-UNNON           TO BAGEA
  9421         ELSE
  9422             MOVE -1                 TO BAGEL
  9423             MOVE  1                 TO SET-CURSOR-SW
  9424             MOVE ER-2223            TO EMI-ERROR
  9425             MOVE AL-UNBON           TO BAGEA
  9426             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9427
  9428     IF BLSTNML NOT = ZERO  OR
  9429        B1STNML NOT = ZERO  OR
  9430        BINITL NOT = ZERO
  9431         IF BAGEL = ZEROS
  9432             MOVE -1                 TO BAGEL
  9433             MOVE  1                 TO SET-CURSOR-SW
  9434             MOVE ER-3269            TO EMI-ERROR
  9435             MOVE AL-UNBON           TO BAGEA
  9436             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 174
* EL6311.cbl
  9437         END-IF
  9438     END-IF.
  9439
  9440     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9441
  9442     IF (BBIRTHL GREATER THAN +0) AND
  9443        (BBIRTHI NOT EQUAL SPACES)
  9444        NEXT SENTENCE
  9445     ELSE
  9446        GO TO 1010-CHECK-AGE.
  9447
  9448     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9449     PERFORM 8600-DEEDIT.
  9450     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9451     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9452     MOVE AL-UNNON               TO BBIRTHA.
  9453     MOVE '4'                    TO DC-OPTION-CODE.
  9454     PERFORM 9700-DATE-LINK.
  9455     IF DATE-CONVERSION-ERROR
  9456        MOVE -1                  TO BBIRTHL
  9457        MOVE  1                  TO SET-CURSOR-SW
  9458        MOVE ER-2228             TO EMI-ERROR
  9459        MOVE AL-UNBON            TO BBIRTHA
  9460        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9461        GO TO 1010-CHECK-AGE.
  9462
  9463     IF (NO-CONVERSION-ERROR) AND
  9464        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9465        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9466        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9467        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9468                                    WS-CONVERTED-BIRTH
  9469        MOVE AL-UANON            TO BBIRTHA
  9470     ELSE
  9471        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9472        MOVE AL-UANON            TO BBIRTHA.
  9473
  9474 1010-CHECK-AGE.
  9475
  9476*    IF BAGEL = ZERO
  9477*       IF BBIRTHL GREATER THAN ZERO
  9478*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9479
  9480     IF B1STPMTL NOT = ZEROS
  9481        IF B1STPMTI = SPACES
  9482           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9483        ELSE
  9484           MOVE B1STPMTI             TO DEEDIT-FIELD
  9485           PERFORM 8600-DEEDIT
  9486           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9487           MOVE AL-UNNON             TO B1STPMTA
  9488           MOVE 4                    TO DC-OPTION-CODE
  9489           PERFORM 9700-DATE-LINK
  9490           IF NO-CONVERSION-ERROR
  9491              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9492              MOVE AL-UANON          TO B1STPMTA
  9493           ELSE
  9494              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 175
* EL6311.cbl
  9495              MOVE  1                TO SET-CURSOR-SW
  9496              MOVE ER-2200           TO EMI-ERROR
  9497              MOVE AL-UNBON          TO B1STPMTA
  9498              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9499
  9500     IF BDAYSL NOT = ZEROS
  9501         IF BDAYSI NUMERIC
  9502             MOVE AL-UNNON           TO BDAYSA
  9503         ELSE
  9504             MOVE -1                 TO BDAYSL
  9505             MOVE ER-2530            TO EMI-ERROR
  9506             MOVE AL-UNBON           TO BDAYSA
  9507             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9508
  9509     IF BLNTRML NOT = ZEROS
  9510         IF BLNTRMI NUMERIC
  9511             MOVE AL-UNNON       TO BLNTRMA
  9512         ELSE
  9513             MOVE -1             TO BLNTRML
  9514             MOVE ER-2533        TO EMI-ERROR
  9515             MOVE AL-UNBON       TO BLNTRMA
  9516             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9517
  9518**   IF PI-COMPANY-ID = 'DMD'
  9519     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9520        NEXT SENTENCE
  9521     ELSE
  9522         IF BLNOFCRL NOT = ZEROS
  9523            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9524            IF LOAN-OFFICER-FOUND
  9525                MOVE AL-UANON        TO BLNOFCRA
  9526             ELSE
  9527                 MOVE SPACE          TO WS-LOAN-OFFICER
  9528                 MOVE -1             TO BLNOFCRL
  9529                 MOVE  1             TO SET-CURSOR-SW
  9530                 MOVE ER-3006        TO EMI-ERROR
  9531                 MOVE AL-UNBON       TO BLNOFCRA
  9532                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9533
  9534     IF BFREQL NOT = ZEROS
  9535         IF BFREQI NUMERIC
  9536             MOVE AL-UNNON       TO BFREQA
  9537         ELSE
  9538             MOVE -1             TO BFREQL
  9539             MOVE  1             TO SET-CURSOR-SW
  9540             MOVE ER-2223        TO EMI-ERROR
  9541             MOVE AL-UNBON       TO BFREQA
  9542             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9543
  9544     IF BMODEL NOT = ZEROS
  9545         MOVE BMODEI             TO WS-MODE-CODE
  9546                                    PI-BMODE
  9547         IF WS-MODE-CODE-VALID
  9548             MOVE AL-UANON       TO BMODEA
  9549         ELSE
  9550             MOVE -1             TO BMODEL
  9551             MOVE ER-2591        TO EMI-ERROR
  9552             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 176
* EL6311.cbl
  9553             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9554
  9555     IF BPMTSL NOT = ZEROS
  9556         IF BPMTSI NUMERIC
  9557             MOVE AL-UNNON           TO BPMTSA
  9558             MOVE BPMTSI             TO PI-BPMTS
  9559         ELSE
  9560             MOVE -1                 TO BPMTSL
  9561             MOVE ER-2592            TO EMI-ERROR
  9562             MOVE AL-UNBON           TO BPMTSA
  9563             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9564
  9565     IF BPMTAMTL NOT = ZEROS
  9566
  9567* EXEC CICS BIF DEEDIT
  9568*            FIELD  (BPMTAMTI)
  9569*            LENGTH (9)
  9570*       END-EXEC
  9571     MOVE 9
  9572       TO DFHEIV11
  9573*    MOVE '@"L                   #   #00009501' TO DFHEIV0
  9574     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9575     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9576     MOVE X'2020233030303039353031' TO DFHEIV0(25:11)
  9577     CALL 'kxdfhei1' USING DFHEIV0,
  9578           BPMTAMTI,
  9579           DFHEIV11
  9580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9581        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9582*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9583*        PERFORM 8600-DEEDIT
  9584*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9585
  9586*    IF BAPRL NOT = ZEROS
  9587*        EXEC CICS BIF DEEDIT
  9588*            FIELD  (BAPRI)
  9589*            LENGTH (7)
  9590*        END-EXEC
  9591*        MOVE BAPRI              TO WS-BAPR.
  9592
  9593     IF BAPRL > 0
  9594        MOVE +0                  TO  WS-BAPR
  9595        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9596           (WS-SUB > 7)
  9597           OR (BAPRI (WS-SUB:1) NUMERIC)
  9598           OR (BAPRI (WS-SUB:1) = '.')
  9599        END-PERFORM
  9600        IF WS-SUB > 7
  9601           MOVE ER-2471       TO EMI-ERROR
  9602           MOVE -1            TO BAPRL
  9603           MOVE AL-UNBON      TO BAPRA
  9604           PERFORM 9900-ERROR-FORMAT
  9605                                 THRU 9900-EXIT
  9606        ELSE
  9607           IF BAPRI (WS-SUB:1) NUMERIC
  9608              MOVE WS-SUB           TO WS-BEG
  9609              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9610                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 177
* EL6311.cbl
  9611                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9612              END-PERFORM
  9613              COMPUTE WS-END = WS-SUB - WS-BEG
  9614              MOVE BAPRI (WS-BEG:WS-END)
  9615                                 TO WS-APR-WHOLE-NUM
  9616           END-IF
  9617           IF BAPRI (WS-SUB:1) = '.'
  9618              COMPUTE WS-BEG = WS-SUB + 1
  9619              IF (WS-BEG < 8)
  9620                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9621                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9622                    (WS-SUB > 7)
  9623                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9624                 END-PERFORM
  9625                 COMPUTE WS-END = WS-SUB - WS-BEG
  9626                 MOVE BAPRI (WS-BEG:WS-END)
  9627                                 TO WS-APR-DEC (1:WS-END)
  9628              END-IF
  9629           END-IF
  9630           MOVE AL-UNNON      TO BAPRA
  9631           MOVE WS-BAPR       TO BAPRO
  9632        END-IF
  9633     END-IF
  9634*     IF BAPRL NOT = ZEROS
  9635*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9636*        PERFORM 8600-DEEDIT
  9637*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9638
  9639     IF BLIVESL NOT = ZEROS
  9640        MOVE BLIVESI             TO DEEDIT-FIELD
  9641        PERFORM 8600-DEEDIT
  9642        IF DEEDIT-FIELD-V0 NUMERIC
  9643           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9644           MOVE AL-UNNON         TO BLIVESA
  9645        ELSE
  9646           MOVE -1               TO BLIVESL
  9647           MOVE AL-UNBON         TO BLIVESA
  9648           MOVE ER-2223          TO EMI-ERROR
  9649           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9650
  9651*DMD CUSTOM CODING*************START
  9652*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9653     IF PI-COMPANY-ID NOT = 'DMD'
  9654         MOVE ZEROS               TO BBILLEDL
  9655         GO TO 1010-EDIT-CONT.
  9656
  9657     IF BBILLEDL NOT = ZEROS
  9658        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9659        MOVE 'Y'                 TO WS-NUMERIC-SW
  9660        MOVE +1                  TO WS-CSO-SUB
  9661        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9662        IF CSO-NUMERIC-FIELD
  9663
  9664* EXEC CICS BIF DEEDIT
  9665*              FIELD  (BBILLEDI)
  9666*              LENGTH (9)
  9667*          END-EXEC
  9668     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 178
* EL6311.cbl
  9669       TO DFHEIV11
  9670*    MOVE '@"L                   #   #00009587' TO DFHEIV0
  9671     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9672     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9673     MOVE X'2020233030303039353837' TO DFHEIV0(25:11)
  9674     CALL 'kxdfhei1' USING DFHEIV0,
  9675           BBILLEDI,
  9676           DFHEIV11
  9677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9678           MOVE BBILLEDI         TO WS-BILLED
  9679           MOVE AL-UNNON         TO BBILLEDA
  9680        ELSE
  9681           MOVE -1               TO BBILLEDL
  9682           MOVE AL-UNBON         TO BBILLEDA
  9683           MOVE ER-2547          TO EMI-ERROR
  9684           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9685     ELSE
  9686        IF BMAINTI EQUAL 'A'
  9687           MOVE -1               TO BBILLEDL
  9688           MOVE AL-UNBON         TO BBILLEDA
  9689           MOVE ER-8148          TO EMI-ERROR
  9690           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9691
  9692 1010-EDIT-CONT.
  9693
  9694     IF BFORCEL  NOT = ZEROS
  9695         IF FORCE-CAP
  9696            MOVE AL-UANON            TO BFORCEA
  9697         ELSE
  9698            MOVE ER-2945             TO EMI-ERROR
  9699            MOVE AL-UABON            TO BFORCEA
  9700            MOVE -1                  TO BFORCEL
  9701            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9702
  9703     IF BENTRYL NOT = ZEROS
  9704        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9705                         'D' AND 'V' AND 'U' AND 'M'
  9706           MOVE ER-2224              TO EMI-ERROR
  9707           MOVE AL-UABON             TO BENTRYA
  9708           MOVE -1                   TO BENTRYL
  9709           MOVE  1                   TO SET-CURSOR-SW
  9710           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9711        ELSE
  9712           MOVE AL-UANON             TO BENTRYA.
  9713
  9714     IF BUNWRITL NOT = ZEROS
  9715        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9716           MOVE ER-7574              TO EMI-ERROR
  9717           MOVE AL-UABON             TO BUNWRITA
  9718           MOVE -1                   TO BUNWRITL
  9719           MOVE  1                   TO SET-CURSOR-SW
  9720           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9721        ELSE
  9722           MOVE AL-UANON             TO BUNWRITA.
  9723
  9724     IF BREINL  NOT = ZEROS
  9725         MOVE AL-UANON               TO BREINA.
  9726
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 179
* EL6311.cbl
  9727     IF BBILCDL NOT = ZEROS
  9728        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9729                             AND 'A' AND 'B' AND 'E'
  9730           MOVE ER-2225              TO EMI-ERROR
  9731           MOVE AL-UABON             TO BBILCDA
  9732           MOVE -1                   TO BBILCDL
  9733           MOVE  1                   TO SET-CURSOR-SW
  9734           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9735        ELSE
  9736           MOVE AL-UANON             TO BBILCDA.
  9737
  9738     IF BSKPCDL NOT = ZEROS
  9739         MOVE AL-UANON               TO BSKPCDA.
  9740
  9741     IF BINDGRPL NOT = ZEROS
  9742         MOVE AL-UANON               TO BINDGRPA.
  9743
  9744     IF BSIGL   NOT = ZEROS
  9745         MOVE AL-UANON               TO BSIGA.
  9746
  9747     IF BRTCLSL NOT = ZEROS
  9748         MOVE AL-UANON               TO BRTCLSA.
  9749
  9750     IF BMEMBERL NOT = ZEROS
  9751         MOVE AL-UANON               TO BMEMBERA.
  9752
  9753     MOVE +0                         TO WS-SUB1.
  9754
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 180
* EL6311.cbl
  9756
  9757******************************************************************
  9758*                                                                *
  9759*           E D I T   I S S U E   C O V E R A G E S              *
  9760*                                                                *
  9761******************************************************************
  9762
  9763 1020-EDIT-COVERAGES.
  9764     ADD +1                      TO WS-SUB1.
  9765
  9766     IF WS-SUB1 GREATER +2
  9767        GO TO 1025-EDIT-COMPLETE.
  9768
  9769     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9770       IF (BMODEL   GREATER ZERO  OR
  9771            BPMTSL   GREATER ZERO  OR
  9772            BPMTAMTL GREATER ZERO)
  9773          AND
  9774            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9775               GO TO 1021-CONT-EDIT.
  9776
  9777     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9778        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9779        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9780        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9781        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9782        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9783        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9784        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9785        NEXT SENTENCE
  9786         ELSE
  9787            GO TO 1020-EDIT-COVERAGES.
  9788
  9789 1021-CONT-EDIT.
  9790
  9791     IF BMAINTI = 'A'
  9792        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9793           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9794        ELSE
  9795           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9796           MOVE ER-7404          TO EMI-ERROR
  9797           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9798           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9799     ELSE
  9800        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9801           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9802
  9803     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9804        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9805        PERFORM 8600-DEEDIT
  9806        IF DEEDIT-FIELD-V0 NUMERIC
  9807           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9808        ELSE
  9809           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9810
  9811     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9812*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9813        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 181
* EL6311.cbl
  9814           BPMTSL  GREATER THAN ZEROS
  9815           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9816
  9817     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9818         IF BMODEL   GREATER THAN ZEROS  OR
  9819            BPMTSL   GREATER THAN ZEROS  OR
  9820            BPMTAMTL GREATER THAN ZEROS
  9821             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9822
  9823     IF BMAINTI = ('C' OR 'K')
  9824        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9825           NEXT SENTENCE
  9826        ELSE
  9827           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9828           PERFORM 8600-DEEDIT
  9829           IF DEEDIT-FIELD-V0 NUMERIC
  9830              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9831              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9832                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9833              ELSE
  9834                    MOVE ER-2241      TO EMI-ERROR
  9835                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9836                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9837                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9838           ELSE
  9839              MOVE ER-2223          TO EMI-ERROR
  9840              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9841              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9842              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9843     ELSE
  9844        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9845            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9846            PERFORM 8600-DEEDIT
  9847            IF DEEDIT-FIELD-V0      NUMERIC
  9848               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9849                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9850                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9851               ELSE
  9852                  MOVE ER-2241         TO EMI-ERROR
  9853                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9854                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9855                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9856            ELSE
  9857              MOVE ER-2223             TO EMI-ERROR
  9858              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9859              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9860              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9861        ELSE
  9862            MOVE ER-2240               TO EMI-ERROR
  9863            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9864            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9865*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9866*        IF BMODEL  GREATER THAN ZEROS  AND
  9867*           BPMTSL  GREATER THAN ZEROS
  9868*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9869
  9870     IF BBEN-LEN (WS-SUB1) = ZEROS
  9871        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 182
* EL6311.cbl
  9872           NEXT SENTENCE
  9873     ELSE
  9874        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9875           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9876
  9877* EXEC CICS BIF DEEDIT
  9878*              FIELD  (BBENI (WS-SUB1))
  9879*              LENGTH (12)
  9880*          END-EXEC
  9881     MOVE 12
  9882       TO DFHEIV11
  9883*    MOVE '@"L                   #   #00009789' TO DFHEIV0
  9884     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9885     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9886     MOVE X'2020233030303039373839' TO DFHEIV0(25:11)
  9887     CALL 'kxdfhei1' USING DFHEIV0,
  9888           BBENI(WS-SUB1),
  9889           DFHEIV11
  9890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9891           IF BBENI (WS-SUB1)  NUMERIC
  9892              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9893                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9894*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9895*          PERFORM 8600-DEEDIT
  9896*          IF DEEDIT-FIELD-V2  NUMERIC
  9897*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9898*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9899              ELSE
  9900                 MOVE ER-7632    TO EMI-ERROR
  9901                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9902                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9903                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9904           ELSE
  9905              MOVE ER-2223         TO EMI-ERROR
  9906              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9907              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9908              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9909        ELSE
  9910           MOVE ER-7632    TO EMI-ERROR
  9911           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9912           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9913           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9914
  9915     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9916        AND (BMAINTI = ('C' OR 'K'))
  9917        CONTINUE
  9918     ELSE
  9919        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9920           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9921           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9922              FOR ALL '.'
  9923           IF WS-TALLY > 1
  9924              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9925                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9926              END-PERFORM
  9927              IF A1 < 9
  9928                 ADD 3 TO A1
  9929                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 183
* EL6311.cbl
  9930              END-IF
  9931           ELSE
  9932              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9933                (A1 > 11)
  9934                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9935                  LOW-VALUES OR SPACES)
  9936              END-PERFORM
  9937              IF A1 > 1 AND < 12
  9938                 MOVE SPACES
  9939                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9940              END-IF
  9941           END-IF
  9942
  9943* EXEC CICS BIF DEEDIT
  9944*              FIELD  (BPREMI (WS-SUB1))
  9945*              LENGTH (11)
  9946*          END-EXEC
  9947     MOVE 11
  9948       TO DFHEIV11
  9949*    MOVE '@"L                   #   #00009844' TO DFHEIV0
  9950     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9951     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9952     MOVE X'2020233030303039383434' TO DFHEIV0(25:11)
  9953     CALL 'kxdfhei1' USING DFHEIV0,
  9954           BPREMI(WS-SUB1),
  9955           DFHEIV11
  9956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9957           IF BPREMI (WS-SUB1) NUMERIC
  9958              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9959                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9960*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9961*          PERFORM 8600-DEEDIT
  9962*          IF DEEDIT-FIELD-V2  NUMERIC
  9963*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9964*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9965              ELSE
  9966                 IF PI-COMPANY-ID NOT = 'DCC'
  9967                    MOVE ER-7633    TO EMI-ERROR
  9968                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9969                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9970                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9971                 END-IF
  9972              END-IF
  9973           ELSE
  9974              MOVE ER-2223         TO EMI-ERROR
  9975              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9976              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9977              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9978           END-IF
  9979        ELSE
  9980           IF PI-COMPANY-ID NOT = 'DCC'
  9981              MOVE ER-7633         TO EMI-ERROR
  9982              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9983              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9984              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9985           END-IF
  9986        END-IF
  9987     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 184
* EL6311.cbl
  9988
  9989     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9990        NEXT SENTENCE
  9991     ELSE
  9992        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9993
  9994* EXEC CICS BIF DEEDIT
  9995*           FIELD  (BCPREMI (WS-SUB1))
  9996*           LENGTH (11)
  9997*       END-EXEC
  9998     MOVE 11
  9999       TO DFHEIV11
 10000*    MOVE '@"L                   #   #00009884' TO DFHEIV0
 10001     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10002     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10003     MOVE X'2020233030303039383834' TO DFHEIV0(25:11)
 10004     CALL 'kxdfhei1' USING DFHEIV0,
 10005           BCPREMI(WS-SUB1),
 10006           DFHEIV11
 10007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10008        IF BCPREMI (WS-SUB1) NUMERIC
 10009           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10010*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10011*       PERFORM 8600-DEEDIT
 10012*       IF DEEDIT-FIELD-V2  NUMERIC
 10013*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10014        ELSE
 10015           MOVE ER-2223         TO EMI-ERROR
 10016           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10017           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10018           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10019
 10020     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10021        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10022        PERFORM 8600-DEEDIT
 10023        IF DEEDIT-FIELD-V0 NUMERIC
 10024           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10025           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10026         ELSE
 10027           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10028           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10029           MOVE ER-2223              TO EMI-ERROR
 10030           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10031
 10032     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10033        IF BEXPIRE   (WS-SUB1) = SPACES
 10034           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10035        ELSE
 10036           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10037           PERFORM 8600-DEEDIT
 10038           IF DEEDIT-FIELD-V0        NUMERIC
 10039              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10040              MOVE 4                TO DC-OPTION-CODE
 10041              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10042              PERFORM 9700-DATE-LINK
 10043              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10044                                                        (WS-SUB1)
 10045              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 185
* EL6311.cbl
 10046                 NEXT SENTENCE
 10047              ELSE
 10048                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10049                 MOVE ER-2531    TO EMI-ERROR
 10050                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10051                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10052           ELSE
 10053             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10054             MOVE ER-2532        TO EMI-ERROR
 10055             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10056             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10057
 10058     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10059        NEXT SENTENCE
 10060     ELSE
 10061
 10062* EXEC CICS BIF DEEDIT
 10063*           FIELD  (BALT-BENI (WS-SUB1))
 10064*           LENGTH (12)
 10065*       END-EXEC
 10066     MOVE 12
 10067       TO DFHEIV11
 10068*    MOVE '@"L                   #   #00009941' TO DFHEIV0
 10069     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10070     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10071     MOVE X'2020233030303039393431' TO DFHEIV0(25:11)
 10072     CALL 'kxdfhei1' USING DFHEIV0,
 10073           BALT-BENI(WS-SUB1),
 10074           DFHEIV11
 10075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10076        IF BALT-BENI (WS-SUB1) NUMERIC
 10077           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10078*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10079*       PERFORM 8600-DEEDIT
 10080*       IF DEEDIT-FIELD-V0 NUMERIC
 10081*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10082        ELSE
 10083           MOVE ER-2223         TO EMI-ERROR
 10084           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10085           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10086           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10087
 10088     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10089        NEXT SENTENCE
 10090     ELSE
 10091
 10092* EXEC CICS BIF DEEDIT
 10093*           FIELD  (BALT-PREMI (WS-SUB1))
 10094*           LENGTH (11)
 10095*       END-EXEC
 10096     MOVE 11
 10097       TO DFHEIV11
 10098*    MOVE '@"L                   #   #00009960' TO DFHEIV0
 10099     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10100     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10101     MOVE X'2020233030303039393630' TO DFHEIV0(25:11)
 10102     CALL 'kxdfhei1' USING DFHEIV0,
 10103           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 186
* EL6311.cbl
 10104           DFHEIV11
 10105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10106        IF BALT-PREMI (WS-SUB1) NUMERIC
 10107           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10108*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10109*       PERFORM 8600-DEEDIT
 10110*       IF DEEDIT-FIELD-V0 NUMERIC
 10111*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10112        ELSE
 10113           MOVE ER-2223         TO EMI-ERROR
 10114           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10115           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10116           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10117
 10118      GO TO 1020-EDIT-COVERAGES.
 10119
 10120 1025-EDIT-COMPLETE.
 10121     IF PI-COMPANY-ID  =  'DMD'
 10122        MOVE LOW-VALUES             TO BNCERTI
 10123                                       BNSTATI.
 10124
 10125     IF EMI-ERROR = ZEROS
 10126         NEXT SENTENCE
 10127     ELSE
 10128         GO TO 8200-SEND-DATAONLY.
 10129
 10130     IF BMAINTI = 'A'
 10131         GO TO 1200-ADD-ISSUE-ROUTINE.
 10132
 10133     IF BMAINTI = 'C'
 10134         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10135
 10136     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10137
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 187
* EL6311.cbl
 10139
 10140 1030-EDIT-FOR-NUMERICS.
 10141     IF WS-CSO-SUB EQUAL 10
 10142        GO TO 1030-EDIT-EXIT.
 10143
 10144     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10145        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10146        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10147           ADD +1               TO WS-CSO-SUB
 10148           GO TO 1030-EDIT-FOR-NUMERICS.
 10149
 10150     MOVE 'N'                   TO WS-NUMERIC-SW.
 10151
 10152 1030-EDIT-EXIT.
 10153******************************************************************
 10154*                                                                *
 10155*                 C A L C U L A T E   A G E                      *
 10156*                                                                *
 10157******************************************************************
 10158
 10159
 10160 1095-CALC-AGE.
 10161
 10162     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10163     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10164     MOVE 1                  TO DC-OPTION-CODE.
 10165     PERFORM 9700-DATE-LINK
 10166     IF NO-CONVERSION-ERROR
 10167         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10168         MOVE WS-BAGE            TO BAGEI
 10169         MOVE +2                 TO BAGEL
 10170         MOVE AL-UNNON TO BAGEA.
 10171
 10172 1099-EXIT.
 10173     EXIT.
 10174
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 188
* EL6311.cbl
 10176
 10177******************************************************************
 10178*                                                                *
 10179*                   S H O W   I S S U E                          *
 10180*                                                                *
 10181******************************************************************
 10182
 10183 1100-SHOW-REQUEST.
 10184     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10185
 10186     IF BCERTNOL = ZEROS AND
 10187        BEFFDTL  = ZEROS
 10188        MOVE -1                  TO BMAINTL
 10189        GO TO 8200-SEND-DATAONLY.
 10190
 10191     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10192
 10193     IF BSUFIXL NOT = ZEROS
 10194        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10195     ELSE
 10196        MOVE SPACE               TO WS-NEW-SUFFIX.
 10197
 10198     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10199     PERFORM 8600-DEEDIT.
 10200     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10201     MOVE '4'                    TO DC-OPTION-CODE.
 10202     PERFORM 9700-DATE-LINK.
 10203     IF DATE-CONVERSION-ERROR
 10204        MOVE ER-0348             TO EMI-ERROR
 10205        MOVE -1                  TO BEFFDTL
 10206        MOVE AL-UABON            TO BEFFDTA
 10207        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10208        GO TO 8200-SEND-DATAONLY
 10209     ELSE
 10210        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10211        MOVE AL-UANON            TO BEFFDTA
 10212        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10213
 10214     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10215
 10216     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10217        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10218          MOVE 'Y'                    TO WS-SHOW-SW
 10219          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10220             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10221           ELSE
 10222             IF PI-FILE-BROWSE
 10223                GO TO 4300-BROWSE-FILE-FORWARD
 10224              ELSE
 10225                IF PI-CSR-BROWSE
 10226                   GO TO 4200-BROWSE-CSR-FORWARD
 10227                ELSE
 10228                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10229        ELSE
 10230           GO TO 3900-RE-DISPLAY-RECORD.
 10231
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 189
* EL6311.cbl
 10233
 10234******************************************************************
 10235*                                                                *
 10236*            A D D   I S S U E   R O U T I N E                   *
 10237*                                                                *
 10238******************************************************************
 10239
 10240***************************************************************
 10241*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10242*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10243*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10244*     4. LINK TO THE EDIT ROUTINE.                            *
 10245*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10246*     6. WRITE THE NEW ISSUE RECORD.                          *
 10247*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10248*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10249*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10250*        ELSE                                                 *
 10251*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10252***************************************************************
 10253
 10254 1200-ADD-ISSUE-ROUTINE.
 10255     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10256
 10257
 10258* EXEC CICS GETMAIN
 10259*        SET     (ADDRESS OF PENDING-BUSINESS)
 10260*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10261*    END-EXEC.
 10262*    MOVE '," L                  $   #00010115' TO DFHEIV0
 10263     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10264     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10265     MOVE X'2020233030303130313135' TO DFHEIV0(25:11)
 10266     CALL 'kxdfhei1' USING DFHEIV0,
 10267           DFHEIV20,
 10268           ERPNDB-RECORD-LENGTH,
 10269           DFHEIV99
 10270     SET ADDRESS OF PENDING-BUSINESS TO
 10271         DFHEIV20
 10272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10273
 10274
 10275
 10276* EXEC CICS HANDLE CONDITION
 10277*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10278*    END-EXEC.
 10279*    MOVE '"$I                   ! # #00010120' TO DFHEIV0
 10280     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10282     MOVE X'2320233030303130313230' TO DFHEIV0(25:11)
 10283     CALL 'kxdfhei1' USING DFHEIV0
 10284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10285
 10286
 10287     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10288     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10289     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10290
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 190
* EL6311.cbl
 10291
 10292* EXEC CICS READ
 10293*        INTO    (PENDING-BUSINESS)
 10294*        DATASET (FILE-ID-ERPNDB)
 10295*        RIDFLD  (ERPNDB-KEY)
 10296*    END-EXEC.
 10297     MOVE LENGTH OF
 10298      PENDING-BUSINESS
 10299       TO DFHEIV11
 10300*    MOVE '&"IL       E          (   #00010128' TO DFHEIV0
 10301     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10303     MOVE X'2020233030303130313238' TO DFHEIV0(25:11)
 10304     CALL 'kxdfhei1' USING DFHEIV0,
 10305           FILE-ID-ERPNDB,
 10306           PENDING-BUSINESS,
 10307           DFHEIV11,
 10308           ERPNDB-KEY,
 10309           DFHEIV99,
 10310           DFHEIV99,
 10311           DFHEIV99
 10312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10313
 10314
 10315     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10316
 10317     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10318     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10319     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10320     MOVE SPACES                 TO PENDING-BUSINESS.
 10321     MOVE 'PB'                   TO PB-RECORD-ID.
 10322     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10323     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10324     MOVE SPACES                 TO PB-CERT-SFX.
 10325     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10326     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10327                                    PB-ALT-CHG-SEQ-NO.
 10328
 10329     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10330     MOVE '1'                    TO PB-RECORD-TYPE.
 10331
 10332     IF BSUFIXL NOT = ZEROS
 10333        MOVE BSUFIXI             TO PB-CERT-SFX.
 10334
 10335     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10336
 10337     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10338     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10339
 10340     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10341                                    PB-I-LF-PREM-CALC
 10342                                    PB-I-LF-ALT-PREM-CALC
 10343                                    PB-I-LF-RATE
 10344                                    PB-I-LF-ALT-RATE
 10345                                    PB-I-LF-REI-RATE
 10346                                    PB-I-LF-ALT-REI-RATE
 10347                                    PB-I-RATE-DEV-PCT-LF
 10348                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 191
* EL6311.cbl
 10349                                    PB-I-AH-RATE
 10350                                    PB-I-AH-REI-RATE
 10351                                    PB-I-AH-RATE-TRM
 10352                                    PB-I-RATE-DEV-PCT-AH
 10353                                    PB-I-BUSINESS-TYPE
 10354                                    PB-I-LIFE-COMMISSION
 10355                                    PB-I-JOINT-COMMISSION
 10356                                    PB-I-JOINT-AGE
 10357                                    PB-I-AH-COMMISSION
 10358                                    PB-I-CURR-SEQ
 10359                                    PB-CHG-COUNT
 10360                                    PB-LF-BILLED-AMTS
 10361                                    PB-AH-BILLED-AMTS
 10362                                    PB-CALC-TOLERANCE
 10363                                    PB-I-EXTENTION-DAYS
 10364*                                   PB-I-MICROFILM-NO
 10365                                    PB-I-TERM-IN-DAYS.
 10366
 10367     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10368                                    PB-I-LF-EXPIRE-DT
 10369                                    PB-I-AH-EXPIRE-DT
 10370                                    PB-BILLED-DT
 10371                                    PB-ACCT-EFF-DT
 10372                                    PB-ACCT-EXP-DT
 10373                                    PB-I-1ST-PMT-DT.
 10374
 10375     MOVE 'X'                    TO PB-FATAL-FLAG.
 10376
 10377     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10378
 10379     IF BLSTNML GREATER THAN ZEROS
 10380         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10381
 10382*    IF BMICRNOL  GREATER  ZEROS
 10383*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10384*    ELSE
 10385*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10386     IF BVINL > ZEROS
 10387        MOVE BVINI               TO PB-I-VIN
 10388     END-IF
 10389     IF B1STNML GREATER THAN ZEROS
 10390         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10391
 10392     IF BINITL  GREATER THAN ZEROS
 10393         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10394
 10395     IF BBIRTHL GREATER THAN ZERO
 10396         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10397     ELSE
 10398         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10399
 10400     IF B1STPMTL GREATER THAN ZERO
 10401         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10402     ELSE
 10403         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10404
 10405     IF BAGEL    GREATER THAN ZEROS
 10406         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 192
* EL6311.cbl
 10407        ELSE
 10408         MOVE ZEROS              TO PB-I-AGE.
 10409
 10410     IF BSEXL    GREATER THAN ZEROS
 10411         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10412
 10413     IF BTERM-LEN (1) GREATER THAN ZEROS
 10414        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10415     ELSE
 10416        MOVE ZEROS               TO PB-I-LF-TERM.
 10417
 10418     IF BTERM-LEN (2) GREATER THAN ZEROS
 10419        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10420     ELSE
 10421        MOVE ZEROS               TO PB-I-AH-TERM.
 10422
 10423     IF BLNTRML       GREATER THAN ZEROS
 10424         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10425        ELSE
 10426         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10427
 10428     IF BFREQL        GREATER THAN ZEROS
 10429         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10430        ELSE
 10431         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10432
 10433     IF BSKPCDL       GREATER THAN ZEROS
 10434         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10435
 10436     IF BMODEL        GREATER THAN ZEROS
 10437         MOVE BMODEI             TO PB-I-TERM-TYPE
 10438                                    PI-BMODE.
 10439
 10440     IF BPMTSL        GREATER THAN ZEROS
 10441         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10442                                    PI-BPMTS
 10443        ELSE
 10444         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10445                                    PI-BPMTS.
 10446
 10447     IF BPMTAMTL      GREATER THAN ZEROS
 10448         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10449        ELSE
 10450         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10451
 10452     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10453        IF BTYPE  (1)   NOT = ZEROS
 10454           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10455                                    PI-BTYPE (1)
 10456           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10457           MOVE SPACES           TO PB-I-LF-ABBR
 10458        ELSE
 10459           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10460                                    PB-I-LF-ABBR
 10461           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10462     ELSE
 10463        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10464                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 193
* EL6311.cbl
 10465        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10466
 10467     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10468         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10469     ELSE
 10470         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10471
 10472     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10473         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10474     ELSE
 10475         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10476
 10477     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10478         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10479            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10480            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10481         ELSE
 10482            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10483*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10484*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10485         END-IF
 10486     ELSE
 10487         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10488
 10489     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10490         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10491
 10492     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10493         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10494         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10495     ELSE
 10496         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10497
 10498     IF  BALT-PREM-LEN     (2) > ZEROS
 10499         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10500     ELSE
 10501         MOVE ZEROS            TO PB-I-TOT-FEES.
 10502
 10503     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10504        IF BTYPE      (2)   NOT = ZEROS
 10505           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10506                                  PI-BTYPE (2)
 10507           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10508           MOVE SPACES         TO PB-I-AH-ABBR
 10509        ELSE
 10510           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10511                                  PB-I-AH-ABBR
 10512           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10513     ELSE
 10514        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10515                                  PB-I-AH-ABBR
 10516        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10517
 10518     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10519         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10520     ELSE
 10521         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10522
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 194
* EL6311.cbl
 10523     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10524         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10525            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10526            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10527         ELSE
 10528            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10529*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10530*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10531         END-IF
 10532     ELSE
 10533         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10534
 10535     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10536         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10537
 10538     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10539        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10540     ELSE
 10541        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10542
 10543     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10544        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10545     ELSE
 10546        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10547
 10548     IF BINDGRPL  GREATER THAN ZEROS
 10549         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10550
 10551     IF BRTCLSL   GREATER THAN ZEROS
 10552         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10553
 10554     IF BSIGL     GREATER THAN ZEROS
 10555         MOVE BSIGI              TO PB-I-SIG-SW.
 10556     IF BAPRL > ZEROS
 10557         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10558     ELSE
 10559        if pi-company-id = 'CID'
 10560           move +99.9999         to pb-i-loan-apr
 10561        else
 10562           MOVE ZEROS            TO PB-I-LOAN-APR
 10563        end-if
 10564     end-if
 10565     IF BMEMBERL  GREATER THAN ZEROS
 10566         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10567
 10568     IF BLNOFCRL  GREATER THAN ZEROS
 10569         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10570
 10571     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10572        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10573     ELSE
 10574        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10575
 10576     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10577        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10578     ELSE
 10579        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10580
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 195
* EL6311.cbl
 10581     IF BDAYSL   GREATER THAN ZEROS
 10582        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10583                                    PB-I-EXTENTION-DAYS
 10584     ELSE
 10585        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10586                                    PB-I-EXTENTION-DAYS.
 10587
 10588     IF BDAYSL GREATER THAN ZEROS
 10589        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10590
 10591     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10592        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10593           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10594
 10595     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10596        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10597           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10598
 10599     IF B1STPMTL GREATER THAN ZEROS
 10600        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10601
 10602     IF PB-EXT-DAYS-PROCESSING
 10603        IF PB-I-EXTENTION-DAYS = ZEROS
 10604           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10605
 10606     IF PB-EXPIRE-DT-PROCESSING
 10607        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10608           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10609             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10610
 10611     IF PB-1ST-PMT-DT-PROCESSING
 10612        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10613           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10614
 10615     IF BREINL GREATER THAN ZEROS
 10616        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10617
 10618     IF BENTRYL NOT = ZEROS
 10619        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10620        IF PI-COMPANY-ID = 'CID'
 10621           AND (PB-BATCH-ENTRY = 'P')
 10622           AND (PB-STATE = 'VA')
 10623           PERFORM 1500-UPDATE-ERNOTE
 10624                                 THRU 1500-EXIT
 10625        END-IF
 10626     END-IF
 10627     IF BUNWRITL NOT = ZEROS
 10628        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10629
 10630     IF BFORCEL NOT = ZEROS
 10631        MOVE BFORCEI             TO PB-FORCE-CODE.
 10632
 10633     IF BBILCDL NOT = ZEROS
 10634        MOVE BBILCDI             TO PB-RECORD-BILL.
 10635
 10636     IF BLIVESL GREATER THAN ZEROS
 10637        MOVE WS-BLIVES           TO PB-I-LIVES
 10638     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 196
* EL6311.cbl
 10639        MOVE ZEROS               TO PB-I-LIVES.
 10640
 10641     IF BBILLEDL GREATER THAN ZEROS
 10642        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10643     ELSE
 10644        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10645
 10646*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10647
 10648 1260-WRITE-PB-RECORD.
 10649     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10650                                    PB-INPUT-BY.
 10651     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10652     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10653                                    PB-INPUT-DT.
 10654
 10655     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10656     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10657                                    PB-CONTROL-BY-ORIG-BATCH.
 10658
 10659
 10660     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10661     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10662     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10663     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10664     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10665
 10666     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10667
 10668     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10669
 10670     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10671     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10672     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10673
 10674     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10675     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10676
 10677 1275-WRITE-PENDING-BUSINESS.
 10678     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10679     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10680     MOVE 'A'                    TO JP-RECORD-TYPE.
 10681     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10682
 10683
 10684* EXEC CICS HANDLE CONDITION
 10685*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10686*    END-EXEC.
 10687*    MOVE '"$%                   ! $ #00010502' TO DFHEIV0
 10688     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10690     MOVE X'2420233030303130353032' TO DFHEIV0(25:11)
 10691     CALL 'kxdfhei1' USING DFHEIV0
 10692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10693
 10694
 10695
 10696* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 197
* EL6311.cbl
 10697*        DATASET (FILE-ID-ERPNDB)
 10698*        FROM    (PENDING-BUSINESS)
 10699*        RIDFLD  (PB-CONTROL-PRIMARY)
 10700*    END-EXEC.
 10701     MOVE LENGTH OF
 10702      PENDING-BUSINESS
 10703       TO DFHEIV11
 10704*    MOVE '&$ L                  ''   #00010506' TO DFHEIV0
 10705     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10707     MOVE X'2020233030303130353036' TO DFHEIV0(25:11)
 10708     CALL 'kxdfhei1' USING DFHEIV0,
 10709           FILE-ID-ERPNDB,
 10710           PENDING-BUSINESS,
 10711           DFHEIV11,
 10712           PB-CONTROL-PRIMARY,
 10713           DFHEIV99,
 10714           DFHEIV99
 10715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10716
 10717
 10718     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10719
 10720     PERFORM 8400-LOG-JOURNAL-RECORD.
 10721
 10722******************************************************************
 10723*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10724******************************************************************
 10725     display ' made it to add orig cert '
 10726     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10727     MOVE ' '                    TO WS-ERMAIL-SW
 10728
 10729* EXEC CICS READ
 10730*       DATASET   (FILE-ID-ERMAIL)
 10731*       SET       (ADDRESS OF MAILING-DATA)
 10732*       RIDFLD    (ERMAIL-KEY)
 10733*       RESP      (WS-RESPONSE)
 10734*    END-EXEC
 10735*    MOVE '&"S        E          (  N#00010522' TO DFHEIV0
 10736     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10737     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10738     MOVE X'204E233030303130353232' TO DFHEIV0(25:11)
 10739     CALL 'kxdfhei1' USING DFHEIV0,
 10740           FILE-ID-ERMAIL,
 10741           DFHEIV20,
 10742           DFHEIV99,
 10743           ERMAIL-KEY,
 10744           DFHEIV99,
 10745           DFHEIV99,
 10746           DFHEIV99
 10747     SET ADDRESS OF MAILING-DATA TO
 10748         DFHEIV20
 10749     MOVE EIBRESP  TO WS-RESPONSE
 10750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10751     IF RESP-NORMAL
 10752        SET ERMAIL-FOUND TO TRUE
 10753     END-IF
 10754
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 198
* EL6311.cbl
 10755     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10756     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10757     MOVE 'OC'                   TO OC-RECORD-ID
 10758     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10759                                 TO OC-CONTROL-PRIMARY (1:33)
 10760     MOVE 'I'                    TO OC-RECORD-TYPE
 10761     MOVE +4096                  TO OC-KEY-SEQ-NO
 10762     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10763     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10764     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10765     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10766     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10767     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10768     MOVE PB-I-AGE               TO OC-INS-AGE
 10769     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10770     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10771     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10772     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10773     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10774     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10775     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10776     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10777     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10778     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10779     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10780     IF PB-I-JOINT-COMMISSION > +0
 10781         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10782     ELSE
 10783         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10784     END-IF
 10785     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10786     MOVE +0                     TO OC-LF-CANCEL-AMT
 10787                                    OC-LF-ITD-CANCEL-AMT
 10788     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10789     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10790     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10791     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10792     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10793     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10794     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10795     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10796     MOVE +0                     TO OC-AH-CANCEL-AMT
 10797                                    OC-AH-ITD-CANCEL-AMT
 10798     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10799     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10800     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10801     IF ERMAIL-FOUND
 10802        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10803     END-IF
 10804     IF NOT CERT-TRL-REC-NOT-FOUND
 10805        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10806                           OC-INS-AGE-DEFAULT-FLAG
 10807        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10808                           OC-JNT-AGE-DEFAULT-FLAG
 10809     END-IF
 10810     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10811     .
 10812 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 199
* EL6311.cbl
 10813
 10814* EXEC CICS WRITE
 10815*       DATASET   ('ELCRTO')
 10816*       FROM      (ORIGINAL-CERTIFICATE)
 10817*       RIDFLD    (OC-CONTROL-PRIMARY)
 10818*       RESP      (WS-RESPONSE)
 10819*    END-EXEC
 10820     MOVE LENGTH OF
 10821      ORIGINAL-CERTIFICATE
 10822       TO DFHEIV11
 10823     MOVE 'ELCRTO' TO DFHEIV1
 10824*    MOVE '&$ L                  ''  N#00010590' TO DFHEIV0
 10825     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10826     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10827     MOVE X'204E233030303130353930' TO DFHEIV0(25:11)
 10828     CALL 'kxdfhei1' USING DFHEIV0,
 10829           DFHEIV1,
 10830           ORIGINAL-CERTIFICATE,
 10831           DFHEIV11,
 10832           OC-CONTROL-PRIMARY,
 10833           DFHEIV99,
 10834           DFHEIV99
 10835     MOVE EIBRESP  TO WS-RESPONSE
 10836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10837     display ' just wrote 1275 ' ws-response
 10838     IF RESP-DUPKEY
 10839        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10840        GO TO 1275-WRITE-ELCRTO
 10841     ELSE
 10842        IF NOT RESP-NORMAL
 10843           MOVE -1               TO BMAINTL
 10844           MOVE ER-7450          TO EMI-ERROR
 10845           PERFORM 9900-ERROR-FORMAT
 10846                                 THRU 9900-EXIT
 10847           GO TO 8200-SEND-DATAONLY
 10848        END-IF
 10849     END-IF
 10850******************************************************************
 10851*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10852******************************************************************
 10853
 10854
 10855* EXEC CICS READ
 10856*        INTO    (PENDING-BUSINESS)
 10857*        DATASET (FILE-ID-ERPNDB)
 10858*        RIDFLD  (ERPNDB-KEY)
 10859*        UPDATE
 10860*    END-EXEC.
 10861     MOVE LENGTH OF
 10862      PENDING-BUSINESS
 10863       TO DFHEIV11
 10864*    MOVE '&"IL       EU         (   #00010613' TO DFHEIV0
 10865     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10866     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10867     MOVE X'2020233030303130363133' TO DFHEIV0(25:11)
 10868     CALL 'kxdfhei1' USING DFHEIV0,
 10869           FILE-ID-ERPNDB,
 10870           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 200
* EL6311.cbl
 10871           DFHEIV11,
 10872           ERPNDB-KEY,
 10873           DFHEIV99,
 10874           DFHEIV99,
 10875           DFHEIV99
 10876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10877
 10878
 10879     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10880     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10881     MOVE 'B'                    TO JP-RECORD-TYPE.
 10882     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10883
 10884     PERFORM 8400-LOG-JOURNAL-RECORD.
 10885
 10886     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10887
 10888
 10889* EXEC CICS REWRITE
 10890*        DATASET (FILE-ID-ERPNDB)
 10891*        FROM    (PENDING-BUSINESS)
 10892*    END-EXEC.
 10893     MOVE LENGTH OF
 10894      PENDING-BUSINESS
 10895       TO DFHEIV11
 10896*    MOVE '&& L                  %   #00010629' TO DFHEIV0
 10897     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10898     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10899     MOVE X'2020233030303130363239' TO DFHEIV0(25:11)
 10900     CALL 'kxdfhei1' USING DFHEIV0,
 10901           FILE-ID-ERPNDB,
 10902           PENDING-BUSINESS,
 10903           DFHEIV11,
 10904           DFHEIV99
 10905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10906
 10907
 10908     MOVE 'C'                    TO JP-RECORD-TYPE.
 10909     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10910
 10911     PERFORM 8400-LOG-JOURNAL-RECORD.
 10912
 10913     IF WS-ERRORS-PRESENT
 10914         GO TO 3900-RE-DISPLAY-RECORD.
 10915
 10916     MOVE ZEROS                  TO EMI-ERROR.
 10917     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10918     MOVE LOW-VALUES             TO EL631BI.
 10919     MOVE  -1                    TO BMAINTL.
 10920     GO TO 8100-SEND-INITIAL-MAP.
 10921
 10922 1280-BATCH-HDR-NOT-FOUND.
 10923     MOVE -1                     TO BMAINTL.
 10924     MOVE ER-7450                TO EMI-ERROR.
 10925     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10926     GO TO 8200-SEND-DATAONLY.
 10927
 10928 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 201
* EL6311.cbl
 10929
 10930******************************************************************
 10931*                                                                *
 10932*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10933*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10934*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10935*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10936*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10937*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10938*                                                                *
 10939******************************************************************
 10940
 10941     IF LCP-ONCTR-01 =  0
 10942         ADD 1 TO LCP-ONCTR-01
 10943        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10944
 10945     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10946
 10947     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10948         NEXT SENTENCE
 10949     ELSE
 10950         ADD +1 TO PB-BATCH-SEQ-NO
 10951                   PB-CSR-BATCH-SEQ-NO
 10952         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10953         GO TO 1275-WRITE-PENDING-BUSINESS.
 10954
 10955     MOVE -1                     TO BCERTNOL.
 10956     MOVE AL-UABON               TO BCERTNOA.
 10957     MOVE AL-UNBON               TO BEFFDTA.
 10958
 10959     MOVE 1                      TO EMI-SUB
 10960                                    EMI-SWITCH1
 10961                                    EMI-SWITCH-AREA-1
 10962                                    EMI-SWITCH-AREA-2.
 10963
 10964     MOVE SPACES                 TO EMI-ERROR-LINES.
 10965
 10966
 10967* EXEC CICS SYNCPOINT ROLLBACK
 10968*    END-EXEC.
 10969*    MOVE '6"R                   !   #00010692' TO DFHEIV0
 10970     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10972     MOVE X'2020233030303130363932' TO DFHEIV0(25:11)
 10973     CALL 'kxdfhei1' USING DFHEIV0
 10974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10975
 10976
 10977     MOVE ER-2247                TO EMI-ERROR.
 10978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10979     GO TO 8200-SEND-DATAONLY.
 10980
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 202
* EL6311.cbl
 10982
 10983
 10984 1295-READ-CERT-TRAILER.
 10985
 10986
 10987* EXEC CICS GETMAIN
 10988*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10989*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10990*        INITIMG (GETMAIN-SPACE)
 10991*    END-EXEC
 10992*    MOVE ',"IL                  $   #00010704' TO DFHEIV0
 10993     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10994     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10995     MOVE X'2020233030303130373034' TO DFHEIV0(25:11)
 10996     CALL 'kxdfhei1' USING DFHEIV0,
 10997           DFHEIV20,
 10998           ELCRTT-RECORD-LENGTH,
 10999           GETMAIN-SPACE
 11000     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11001         DFHEIV20
 11002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11003
 11004     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11005     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11006     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11007
 11008
 11009* EXEC CICS HANDLE CONDITION
 11010*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11011*    END-EXEC.
 11012*    MOVE '"$I                   ! % #00010714' TO DFHEIV0
 11013     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11015     MOVE X'2520233030303130373134' TO DFHEIV0(25:11)
 11016     CALL 'kxdfhei1' USING DFHEIV0
 11017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11018
 11019
 11020
 11021* EXEC CICS READ
 11022*        DATASET  (CRTT-ID)
 11023*        RIDFLD   (ELCRTT-KEY)
 11024*        INTO     (CERTIFICATE-TRAILERS)
 11025*    END-EXEC.
 11026     MOVE LENGTH OF
 11027      CERTIFICATE-TRAILERS
 11028       TO DFHEIV11
 11029*    MOVE '&"IL       E          (   #00010718' TO DFHEIV0
 11030     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11032     MOVE X'2020233030303130373138' TO DFHEIV0(25:11)
 11033     CALL 'kxdfhei1' USING DFHEIV0,
 11034           CRTT-ID,
 11035           CERTIFICATE-TRAILERS,
 11036           DFHEIV11,
 11037           ELCRTT-KEY,
 11038           DFHEIV99,
 11039           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 203
* EL6311.cbl
 11040           DFHEIV99
 11041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11042
 11043
 11044     GO TO 1295-EXIT.
 11045
 11046 1295-CERT-TRL-REC-NOTFND.
 11047     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11048
 11049 1295-EXIT.
 11050     EXIT.
 11051
 11052******************************************************************
 11053*                                                                *
 11054*          C H A N G E   I S S U E   R O U T I N E               *
 11055*                                                                *
 11056******************************************************************
 11057
 11058***************************************************************
 11059*                                                             *
 11060*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11061*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11062*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11063*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11064*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11065*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11066*     5. LINK TO THE EDIT ROUTINE.                            *
 11067*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11068*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11069*              THE EDIT ROUTINE.                              *
 11070*     7. REWRITE THE NEW ISSUE                                *
 11071*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11072*                                                             *
 11073***************************************************************
 11074
 11075 1300-CHANGE-ISSUE-ROUTINE.
 11076     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11077
 11078     IF BCHGL NOT = ZEROS
 11079        MOVE ER-2196             TO EMI-ERROR
 11080        MOVE AL-UABON            TO BMAINTA
 11081        MOVE -1                  TO BMAINTL
 11082        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11083        GO TO 8200-SEND-DATAONLY.
 11084
 11085     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11086
 11087     IF BSUFIXL NOT = ZEROS
 11088        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11089     ELSE
 11090        MOVE SPACE               TO WS-NEW-SUFFIX.
 11091
 11092     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11093     PERFORM 8600-DEEDIT.
 11094     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11095     MOVE '4'                    TO DC-OPTION-CODE.
 11096     PERFORM 9700-DATE-LINK.
 11097     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 204
* EL6311.cbl
 11098        MOVE ER-0348             TO EMI-ERROR
 11099        MOVE -1                  TO BEFFDTL
 11100        MOVE AL-UABON            TO BEFFDTA
 11101        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11102        GO TO 8200-SEND-DATAONLY
 11103     ELSE
 11104        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11105        MOVE AL-UANON            TO BEFFDTA
 11106        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11107
 11108 1325-PROCESS-ISSUE-CHANGES.
 11109
 11110* EXEC CICS HANDLE CONDITION
 11111*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11112*    END-EXEC.
 11113*    MOVE '"$I                   ! & #00010789' TO DFHEIV0
 11114     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11116     MOVE X'2620233030303130373839' TO DFHEIV0(25:11)
 11117     CALL 'kxdfhei1' USING DFHEIV0
 11118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11119
 11120
 11121     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11122     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11123     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11124
 11125
 11126* EXEC CICS GETMAIN
 11127*        SET      (ADDRESS OF PENDING-BUSINESS)
 11128*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11129*        INITIMG  (GETMAIN-SPACE)
 11130*     END-EXEC.
 11131*    MOVE ',"IL                  $   #00010797' TO DFHEIV0
 11132     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11133     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11134     MOVE X'2020233030303130373937' TO DFHEIV0(25:11)
 11135     CALL 'kxdfhei1' USING DFHEIV0,
 11136           DFHEIV20,
 11137           ERPNDB-RECORD-LENGTH,
 11138           GETMAIN-SPACE
 11139     SET ADDRESS OF PENDING-BUSINESS TO
 11140         DFHEIV20
 11141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11142
 11143
 11144
 11145* EXEC CICS READ
 11146*        INTO    (PENDING-BUSINESS)
 11147*        DATASET (FILE-ID-ERPNDB)
 11148*        RIDFLD  (ERPNDB-KEY)
 11149*    END-EXEC.
 11150     MOVE LENGTH OF
 11151      PENDING-BUSINESS
 11152       TO DFHEIV11
 11153*    MOVE '&"IL       E          (   #00010803' TO DFHEIV0
 11154     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 205
* EL6311.cbl
 11156     MOVE X'2020233030303130383033' TO DFHEIV0(25:11)
 11157     CALL 'kxdfhei1' USING DFHEIV0,
 11158           FILE-ID-ERPNDB,
 11159           PENDING-BUSINESS,
 11160           DFHEIV11,
 11161           ERPNDB-KEY,
 11162           DFHEIV99,
 11163           DFHEIV99,
 11164           DFHEIV99
 11165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11166
 11167
 11168     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11169
 11170
 11171* EXEC CICS HANDLE CONDITION
 11172*         NOTFND     (1385-REC-NOT-FOUND)
 11173*    END-EXEC.
 11174*    MOVE '"$I                   ! '' #00010811' TO DFHEIV0
 11175     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11177     MOVE X'2720233030303130383131' TO DFHEIV0(25:11)
 11178     CALL 'kxdfhei1' USING DFHEIV0
 11179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11180
 11181
 11182**********************************************************
 11183*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11184*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11185**********************************************************
 11186
 11187
 11188* EXEC CICS READ
 11189*        DATASET (FILE-ID-ERPNDB)
 11190*        INTO    (PENDING-BUSINESS)
 11191*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11192*    END-EXEC.
 11193     MOVE LENGTH OF
 11194      PENDING-BUSINESS
 11195       TO DFHEIV11
 11196*    MOVE '&"IL       E          (   #00010820' TO DFHEIV0
 11197     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11198     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11199     MOVE X'2020233030303130383230' TO DFHEIV0(25:11)
 11200     CALL 'kxdfhei1' USING DFHEIV0,
 11201           FILE-ID-ERPNDB,
 11202           PENDING-BUSINESS,
 11203           DFHEIV11,
 11204           PI-PREV-CONTROL-PRIMARY,
 11205           DFHEIV99,
 11206           DFHEIV99,
 11207           DFHEIV99
 11208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11209
 11210
 11211********** DO NOT ALLOW CHANGES IF THRU A/R
 11212     IF BMAINTI = 'C'
 11213         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 206
* EL6311.cbl
 11214             MOVE ER-4005          TO EMI-ERROR
 11215             MOVE -1               TO BMAINTL
 11216             MOVE AL-UABON         TO BMAINTA
 11217             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11218             GO TO 8200-SEND-DATAONLY.
 11219**********
 11220
 11221     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11222        MOVE -1                 TO BMAINTL
 11223        MOVE ER-2197            TO EMI-ERROR
 11224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11225        GO TO 8200-SEND-DATAONLY.
 11226
 11227     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11228        MOVE ER-2196             TO EMI-ERROR
 11229        MOVE AL-UABON            TO BMAINTA
 11230        MOVE -1                  TO BMAINTL
 11231        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11232        GO TO 8200-SEND-DATAONLY.
 11233
 11234     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11235
 11236     IF PB-BILLED-DT = LOW-VALUES AND
 11237        PB-CHG-COUNT = ZEROS
 11238        NEXT SENTENCE
 11239     ELSE
 11240        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11241            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11242           OR
 11243           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11244            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11245           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11246
 11247
 11248* EXEC CICS READ
 11249*        DATASET (FILE-ID-ERPNDB)
 11250*        INTO    (PENDING-BUSINESS)
 11251*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11252*        UPDATE
 11253*    END-EXEC.
 11254     MOVE LENGTH OF
 11255      PENDING-BUSINESS
 11256       TO DFHEIV11
 11257*    MOVE '&"IL       EU         (   #00010862' TO DFHEIV0
 11258     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11259     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11260     MOVE X'2020233030303130383632' TO DFHEIV0(25:11)
 11261     CALL 'kxdfhei1' USING DFHEIV0,
 11262           FILE-ID-ERPNDB,
 11263           PENDING-BUSINESS,
 11264           DFHEIV11,
 11265           PI-PREV-CONTROL-PRIMARY,
 11266           DFHEIV99,
 11267           DFHEIV99,
 11268           DFHEIV99
 11269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11270
 11271
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 207
* EL6311.cbl
 11272     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11273     MOVE 'B'                    TO JP-RECORD-TYPE
 11274     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11275     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11276
 11277     PERFORM 8400-LOG-JOURNAL-RECORD.
 11278
 11279     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11280        PB-CHG-COUNT NOT = ZEROS
 11281        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11282            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11283           OR
 11284           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11285            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11286            MOVE LOW-VALUES             TO PB-BILLED-DT
 11287            ADD +1                      TO PB-CHG-COUNT.
 11288
 11289     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11290     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11291     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11292     MOVE '5'                    TO DC-OPTION-CODE.
 11293     PERFORM 9700-DATE-LINK
 11294     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11295
 11296*    IF BMICRNOL  GREATER  ZEROS
 11297*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11298
 11299     IF BVINL > ZEROS
 11300        MOVE BVINI               TO PB-I-VIN
 11301     END-IF
 11302     IF (BFORCEL NOT = ZEROS)
 11303        AND (PB-COMPANY-ID = 'DCC')
 11304        AND (BFORCEI = ' ')
 11305        AND (PB-FORCE-CODE = 'O')
 11306        COMPUTE PB-I-AH-PREMIUM-AMT =
 11307           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11308        PERFORM 1800-REMOVE-CERT-NOTES
 11309                                 THRU 1800-EXIT
 11310        PERFORM 1900-DELETE-ERPYAJ
 11311                                 THRU 1900-EXIT
 11312        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11313     END-IF
 11314     IF (BFORCEL NOT = ZEROS)
 11315        AND (PB-COMPANY-ID = 'DCC')
 11316        AND (BFORCEI = 'O')
 11317        AND (PB-FORCE-CODE NOT = 'O')
 11318        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11319           PB-I-AH-PREM-CALC
 11320        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11321        MOVE SPACE               TO DC-OPTION-CODE
 11322        PERFORM 9700-DATE-LINK
 11323        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11324        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11325        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11326        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11327        PERFORM 1500-UPDATE-ERNOTE
 11328                                 THRU 1500-EXIT
 11329        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 208
* EL6311.cbl
 11330                                 THRU 1600-EXIT
 11331     END-IF
 11332     IF BLSTNML  GREATER THAN ZEROS
 11333         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11334
 11335     IF B1STNML  GREATER THAN ZEROS
 11336         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11337
 11338     IF BINITL   GREATER THAN ZEROS
 11339         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11340
 11341     IF BBIRTHL  GREATER THAN ZERO
 11342         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11343
 11344     IF B1STPMTL GREATER THAN ZERO
 11345         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11346
 11347     IF BAGEL    GREATER THAN ZEROS
 11348         MOVE BAGEI              TO PB-I-AGE.
 11349
 11350     MOVE 'N'                    TO WS-INS-AGE-SET
 11351                                    WS-JNT-AGE-SET.
 11352     IF BAGEL    GREATER THAN ZEROS
 11353        MOVE 'Y'                TO WS-INS-AGE-SET
 11354        IF BAGEI = ZERO AND
 11355             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11356           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11357           MOVE 'AGE*'          TO BAGEDEFO
 11358        ELSE
 11359           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11360           MOVE 'AGE '          TO BAGEDEFO
 11361        END-IF
 11362        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11363     END-IF.
 11364
 11365     IF BSEXL    GREATER THAN ZEROS
 11366         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11367
 11368     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11369        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11370
 11371     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11372        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11373
 11374     IF BLNTRML  GREATER THAN ZEROS
 11375         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11376
 11377     IF BFREQL   GREATER THAN ZEROS
 11378         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11379
 11380     IF BSKPCDL  GREATER THAN ZEROS
 11381         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11382
 11383     IF BMODEL   GREATER THAN ZEROS
 11384         MOVE BMODEI             TO PB-I-TERM-TYPE
 11385                                    PI-BMODE.
 11386
 11387     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 209
* EL6311.cbl
 11388         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11389                                    PI-BPMTS.
 11390
 11391     IF BPMTAMTL GREATER THAN ZEROS
 11392         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11393
 11394     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11395         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11396
 11397     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11398         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11399
 11400     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11401
 11402     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11403         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11404            SUBTRACT PB-I-LF-PREMIUM-AMT
 11405                     FROM WS-B-LF-ISS-PRM-ENTERED
 11406            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11407            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11408            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11409         ELSE
 11410            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11411*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11412*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11413         END-IF
 11414     END-IF.
 11415
 11416     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11417            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11418                     FROM WS-B-LF-ISS-PRM-ENTERED
 11419         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11420         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11421
 11422     IF  BALT-PREM-LEN     (2)  > ZEROS
 11423         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11424
 11425     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11426         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11427
 11428     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11429         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11430            SUBTRACT PB-I-AH-PREMIUM-AMT
 11431                     FROM WS-B-AH-ISS-PRM-ENTERED
 11432            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11433            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11434            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11435         ELSE
 11436            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11437*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11438*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11439         END-IF
 11440     END-IF
 11441
 11442     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11443        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11444
 11445     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 210
* EL6311.cbl
 11446        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11447
 11448     IF BINDGRPL            GREATER THAN ZEROS
 11449         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11450
 11451     IF BRTCLSL             GREATER THAN ZEROS
 11452         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11453
 11454     IF BSIGL               GREATER THAN ZEROS
 11455         MOVE BSIGI              TO PB-I-SIG-SW.
 11456
 11457     IF BAPRL               GREATER THAN ZEROS
 11458         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11459
 11460     IF BMEMBERL            GREATER THAN ZEROS
 11461         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11462
 11463     IF BLNOFCRL            GREATER THAN ZEROS
 11464         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11465
 11466     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11467        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11468
 11469     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11470        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11471
 11472     IF BDAYSL              GREATER THAN ZEROS
 11473        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11474                                    PB-I-EXTENTION-DAYS.
 11475
 11476     IF BDAYSL GREATER THAN ZEROS
 11477        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11478
 11479     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11480        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11481           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11482
 11483     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11484        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11485           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11486
 11487     IF B1STPMTL GREATER THAN ZEROS
 11488        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11489
 11490     IF PB-EXT-DAYS-PROCESSING
 11491        IF PB-I-EXTENTION-DAYS = ZEROS
 11492           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11493
 11494     IF PB-EXPIRE-DT-PROCESSING
 11495        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11496           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11497             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11498
 11499     IF PB-1ST-PMT-DT-PROCESSING
 11500        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11501           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11502
 11503     IF BREINL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 211
* EL6311.cbl
 11504        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11505
 11506     IF BFORCEL NOT = ZEROS
 11507        MOVE BFORCEI             TO PB-FORCE-CODE.
 11508     IF (BENTRYL NOT = ZEROS)
 11509        AND (PB-COMPANY-ID = 'CID')
 11510        AND (PB-STATE = 'VA')
 11511        AND (BENTRYI NOT = 'P')
 11512        AND (PB-BATCH-ENTRY = 'P')
 11513        PERFORM 1800-REMOVE-CERT-NOTES
 11514                                 THRU 1800-EXIT
 11515     END-IF
 11516     IF BENTRYL NOT = ZEROS
 11517        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11518        IF PI-COMPANY-ID = 'CID'
 11519           AND (PB-BATCH-ENTRY = 'P')
 11520           AND (PB-STATE = 'VA')
 11521           PERFORM 1500-UPDATE-ERNOTE
 11522                                 THRU 1500-EXIT
 11523        END-IF
 11524     END-IF
 11525
 11526     IF BUNWRITL NOT = ZEROS
 11527        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11528
 11529     IF BBILCDL NOT = ZEROS
 11530        MOVE BBILCDI             TO PB-RECORD-BILL.
 11531
 11532     IF BLIVESL GREATER THAN ZEROS
 11533        MOVE WS-BLIVES           TO PB-I-LIVES.
 11534
 11535
 11536*DMD CUSTOM CODING*************START
 11537     IF PI-COMPANY-ID NOT = 'DMD'
 11538         MOVE ZEROS               TO BBILLEDL.
 11539*DMD CUSTOM CODING*************END
 11540
 11541     IF BBILLEDL GREATER THAN ZEROS
 11542        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11543
 11544
 11545*****************************************************************
 11546*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11547*****************************************************************
 11548
 11549     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11550        IF BTYPE  (1)   = ZEROS OR SPACES
 11551           IF REMOVE-LF-COVERAGE
 11552               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11553                                        PI-BTYPE (1)
 11554               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11555                                        WS-B-LF-ISS-PRM-ENTERED
 11556               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11557                                        WS-B-LF-ISS-PRM-ENTERED
 11558               SUBTRACT PB-I-LF-PREM-CALC FROM
 11559                                        WS-B-LF-ISS-PRM-COMPUTED
 11560               MOVE ZEROS            TO PB-I-LF-TERM
 11561                                        PB-I-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 212
* EL6311.cbl
 11562                                        PB-I-LF-PREMIUM-AMT
 11563                                        PB-I-LF-BENEFIT-CD
 11564                                        PB-I-LF-PREM-CALC
 11565                                        PB-I-LF-CRIT-PER
 11566                                        PB-I-LF-ALT-BENEFIT-AMT
 11567                                        PB-I-LF-ALT-PREMIUM-AMT
 11568               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11569           ELSE
 11570               NEXT SENTENCE
 11571        ELSE
 11572           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11573                                    PI-BTYPE (1).
 11574     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11575        IF BTYPE  (2)   = ZEROS OR SPACES
 11576           IF  REMOVE-AH-COVERAGE
 11577               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11578                                        PI-BTYPE (2)
 11579               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11580                                        WS-B-AH-ISS-PRM-ENTERED
 11581               SUBTRACT PB-I-AH-PREM-CALC FROM
 11582                                        WS-B-AH-ISS-PRM-COMPUTED
 11583               MOVE ZEROS            TO PB-I-AH-TERM
 11584                                        PB-I-AH-BENEFIT-AMT
 11585                                        PB-I-AH-PREMIUM-AMT
 11586                                        PB-I-AH-BENEFIT-CD
 11587                                        PB-I-AH-PREM-CALC
 11588                                        PB-I-AH-CRIT-PER
 11589               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11590           ELSE
 11591               NEXT SENTENCE
 11592        ELSE
 11593           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11594                                    PI-BTYPE (2).
 11595 1360-REWRITE-PB-RECORD.
 11596     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11597
 11598     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11599     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11600
 11601     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11602
 11603     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11604     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11605
 11606     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11607         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11608
 11609     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11610         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11611
 11612     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11613
 11614     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11615
 11616     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11617
 11618     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11619     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 213
* EL6311.cbl
 11620     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11621
 11622     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11623     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11624
 11625 1375-REWRITE-PB-RECORD.
 11626     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11627     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11628     MOVE 'C'                    TO JP-RECORD-TYPE.
 11629     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11630
 11631
 11632* EXEC CICS REWRITE
 11633*        DATASET (FILE-ID-ERPNDB)
 11634*        FROM    (PENDING-BUSINESS)
 11635*    END-EXEC.
 11636     MOVE LENGTH OF
 11637      PENDING-BUSINESS
 11638       TO DFHEIV11
 11639*    MOVE '&& L                  %   #00011228' TO DFHEIV0
 11640     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11641     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11642     MOVE X'2020233030303131323238' TO DFHEIV0(25:11)
 11643     CALL 'kxdfhei1' USING DFHEIV0,
 11644           FILE-ID-ERPNDB,
 11645           PENDING-BUSINESS,
 11646           DFHEIV11,
 11647           DFHEIV99
 11648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11649
 11650
 11651     PERFORM 8400-LOG-JOURNAL-RECORD.
 11652******************************************************************
 11653*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11654******************************************************************
 11655     display ' made it to update orig cert '
 11656     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11657     MOVE ' '                    TO WS-ERMAIL-SW
 11658
 11659* EXEC CICS READ
 11660*       DATASET   (FILE-ID-ERMAIL)
 11661*       SET       (ADDRESS OF MAILING-DATA)
 11662*       RIDFLD    (ERMAIL-KEY)
 11663*       RESP      (WS-RESPONSE)
 11664*    END-EXEC
 11665*    MOVE '&"S        E          (  N#00011240' TO DFHEIV0
 11666     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11668     MOVE X'204E233030303131323430' TO DFHEIV0(25:11)
 11669     CALL 'kxdfhei1' USING DFHEIV0,
 11670           FILE-ID-ERMAIL,
 11671           DFHEIV20,
 11672           DFHEIV99,
 11673           ERMAIL-KEY,
 11674           DFHEIV99,
 11675           DFHEIV99,
 11676           DFHEIV99
 11677     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 214
* EL6311.cbl
 11678         DFHEIV20
 11679     MOVE EIBRESP  TO WS-RESPONSE
 11680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11681     IF RESP-NORMAL
 11682        SET ERMAIL-FOUND TO TRUE
 11683     END-IF
 11684
 11685     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11686     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11687                                 TO ELCRTO-KEY
 11688     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11689     MOVE +0                     TO ELCRTO-SEQ-NO
 11690
 11691* EXEC CICS READ
 11692*       DATASET   ('ELCRTO')
 11693*       INTO      (ORIGINAL-CERTIFICATE)
 11694*       RIDFLD    (ELCRTO-KEY)
 11695*       GTEQ
 11696*       RESP      (WS-RESPONSE)
 11697*    END-EXEC
 11698     MOVE LENGTH OF
 11699      ORIGINAL-CERTIFICATE
 11700       TO DFHEIV11
 11701     MOVE 'ELCRTO' TO DFHEIV1
 11702*    MOVE '&"IL       G          (  N#00011255' TO DFHEIV0
 11703     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11705     MOVE X'204E233030303131323535' TO DFHEIV0(25:11)
 11706     CALL 'kxdfhei1' USING DFHEIV0,
 11707           DFHEIV1,
 11708           ORIGINAL-CERTIFICATE,
 11709           DFHEIV11,
 11710           ELCRTO-KEY,
 11711           DFHEIV99,
 11712           DFHEIV99,
 11713           DFHEIV99
 11714     MOVE EIBRESP  TO WS-RESPONSE
 11715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11716     display ' just read gteq ' ws-response
 11717     IF RESP-NORMAL
 11718        AND (OC-CONTROL-PRIMARY (1:33) =
 11719                 PB-CONTROL-BY-ACCOUNT (1:33))
 11720        AND (OC-RECORD-TYPE = 'I')
 11721        display ' resp norm, key =, type i '
 11722        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11723           display ' end proc blank '
 11724           display ' csr edit session ' PI-CSR-SESSION-SW
 11725           IF NOT CSR-EDIT-SESSION
 11726
 11727* EXEC CICS READ
 11728*                DATASET   ('ELCRTO')
 11729*                INTO      (ORIGINAL-CERTIFICATE)
 11730*                RIDFLD    (OC-CONTROL-PRIMARY)
 11731*                UPDATE
 11732*                RESP      (WS-RESPONSE)
 11733*             END-EXEC
 11734     MOVE LENGTH OF
 11735      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 215
* EL6311.cbl
 11736       TO DFHEIV11
 11737     MOVE 'ELCRTO' TO DFHEIV1
 11738*    MOVE '&"IL       EU         (  N#00011272' TO DFHEIV0
 11739     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11740     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11741     MOVE X'204E233030303131323732' TO DFHEIV0(25:11)
 11742     CALL 'kxdfhei1' USING DFHEIV0,
 11743           DFHEIV1,
 11744           ORIGINAL-CERTIFICATE,
 11745           DFHEIV11,
 11746           OC-CONTROL-PRIMARY,
 11747           DFHEIV99,
 11748           DFHEIV99,
 11749           DFHEIV99
 11750     MOVE EIBRESP  TO WS-RESPONSE
 11751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11752              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11753              IF RESP-NORMAL
 11754                 display ' good read upd '
 11755                 MOVE PB-I-INSURED-LAST-NAME TO
 11756                         OC-INS-LAST-NAME
 11757                 MOVE PB-I-INSURED-FIRST-NAME TO
 11758                         OC-INS-FIRST-NAME
 11759                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11760                         OC-INS-MIDDLE-INIT
 11761                 MOVE PB-I-AGE         TO OC-INS-AGE
 11762                 MOVE PB-I-JOINT-LAST-NAME   TO
 11763                         OC-JNT-LAST-NAME
 11764                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11765                         OC-JNT-FIRST-NAME
 11766                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11767                         OC-JNT-MIDDLE-INIT
 11768                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11769                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11770                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11771                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11772                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11773                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11774                         OC-LF-ALT-BEN-AMT
 11775                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11776                         OC-LF-ALT-PRM-AMT
 11777                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11778                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11779                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11780                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11781                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11782                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11783                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11784                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11785                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11786                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11787                 IF OC-CANCEL-TRAN-IND = 'N'
 11788                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11789                    MOVE +0            TO OC-LF-CANCEL-AMT
 11790                                          OC-LF-ITD-CANCEL-AMT
 11791                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11792                    MOVE +0            TO OC-AH-CANCEL-AMT
 11793                                          OC-AH-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 216
* EL6311.cbl
 11794                 END-IF
 11795                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11796                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11797                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11798                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11799                 IF ERMAIL-FOUND
 11800                    MOVE MA-CRED-BENE-NAME
 11801                                 TO OC-CRED-BENE-NAME
 11802                 END-IF
 11803                 IF NOT CERT-TRL-REC-NOT-FOUND
 11804                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11805                           OC-INS-AGE-DEFAULT-FLAG
 11806                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11807                           OC-JNT-AGE-DEFAULT-FLAG
 11808                 END-IF
 11809
 11810* EXEC CICS REWRITE
 11811*                   DATASET   ('ELCRTO')
 11812*                   FROM      (ORIGINAL-CERTIFICATE)
 11813*                   RESP      (WS-RESPONSE)
 11814*                END-EXEC
 11815     MOVE LENGTH OF
 11816      ORIGINAL-CERTIFICATE
 11817       TO DFHEIV11
 11818     MOVE 'ELCRTO' TO DFHEIV1
 11819*    MOVE '&& L                  %  N#00011336' TO DFHEIV0
 11820     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11821     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11822     MOVE X'204E233030303131333336' TO DFHEIV0(25:11)
 11823     CALL 'kxdfhei1' USING DFHEIV0,
 11824           DFHEIV1,
 11825           ORIGINAL-CERTIFICATE,
 11826           DFHEIV11,
 11827           DFHEIV99
 11828     MOVE EIBRESP  TO WS-RESPONSE
 11829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11830                 display ' just rewrote ' ws-response
 11831              END-IF
 11832           END-IF
 11833        ELSE
 11834           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11835           MOVE 'OC'             TO OC-RECORD-ID
 11836           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11837           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11838           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11839           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11840           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11841           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11842           MOVE PB-I-AGE         TO OC-INS-AGE
 11843           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11844           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11845           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11846           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11847           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11848           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11849           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11850           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11851           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 217
* EL6311.cbl
 11852           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11853           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11854           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11855           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11856           MOVE +0               TO OC-LF-CANCEL-AMT
 11857                                    OC-LF-ITD-CANCEL-AMT
 11858           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11859           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11860           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11861           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11862           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11863           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11864           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11865           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11866           MOVE +0               TO OC-AH-CANCEL-AMT
 11867                                    OC-AH-ITD-CANCEL-AMT
 11868           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11869           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11870           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11871           IF ERMAIL-FOUND
 11872              MOVE MA-CRED-BENE-NAME
 11873                                 TO OC-CRED-BENE-NAME
 11874           END-IF
 11875           IF NOT CERT-TRL-REC-NOT-FOUND
 11876              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11877                           OC-INS-AGE-DEFAULT-FLAG
 11878              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11879                           OC-JNT-AGE-DEFAULT-FLAG
 11880           END-IF
 11881           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11882
 11883* EXEC CICS WRITE
 11884*             DATASET   ('ELCRTO')
 11885*             FROM      (ORIGINAL-CERTIFICATE)
 11886*             RIDFLD    (OC-CONTROL-PRIMARY)
 11887*             RESP      (WS-RESPONSE)
 11888*          END-EXEC
 11889     MOVE LENGTH OF
 11890      ORIGINAL-CERTIFICATE
 11891       TO DFHEIV11
 11892     MOVE 'ELCRTO' TO DFHEIV1
 11893*    MOVE '&$ L                  ''  N#00011393' TO DFHEIV0
 11894     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11895     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11896     MOVE X'204E233030303131333933' TO DFHEIV0(25:11)
 11897     CALL 'kxdfhei1' USING DFHEIV0,
 11898           DFHEIV1,
 11899           ORIGINAL-CERTIFICATE,
 11900           DFHEIV11,
 11901           OC-CONTROL-PRIMARY,
 11902           DFHEIV99,
 11903           DFHEIV99
 11904     MOVE EIBRESP  TO WS-RESPONSE
 11905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11906        END-IF
 11907     ELSE
 11908        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11909        MOVE 'OC'                TO OC-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 218
* EL6311.cbl
 11910        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11911                                 TO OC-CONTROL-PRIMARY (1:33)
 11912        MOVE 'I'                 TO OC-RECORD-TYPE
 11913        MOVE +4096               TO OC-KEY-SEQ-NO
 11914        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11915        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11916        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11917        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11918        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11919        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11920        MOVE PB-I-AGE            TO OC-INS-AGE
 11921        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11922        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11923        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11924        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11925        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11926        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11927        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11928        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11929        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11930        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11931        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11932        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11933        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11934        MOVE +0                  TO OC-LF-CANCEL-AMT
 11935                                    OC-LF-ITD-CANCEL-AMT
 11936        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11937        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11938        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11939        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11940        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11941        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11942        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11943        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11944        MOVE +0                  TO OC-AH-CANCEL-AMT
 11945                                    OC-AH-ITD-CANCEL-AMT
 11946        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11947        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11948        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11949        IF ERMAIL-FOUND
 11950           MOVE MA-CRED-BENE-NAME
 11951                                 TO OC-CRED-BENE-NAME
 11952        END-IF
 11953        IF NOT CERT-TRL-REC-NOT-FOUND
 11954           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11955                           OC-INS-AGE-DEFAULT-FLAG
 11956           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11957                           OC-JNT-AGE-DEFAULT-FLAG
 11958        END-IF
 11959        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11960
 11961* EXEC CICS WRITE
 11962*          DATASET   ('ELCRTO')
 11963*          FROM      (ORIGINAL-CERTIFICATE)
 11964*          RIDFLD    (OC-CONTROL-PRIMARY)
 11965*          RESP      (WS-RESPONSE)
 11966*       END-EXEC
 11967     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 219
* EL6311.cbl
 11968      ORIGINAL-CERTIFICATE
 11969       TO DFHEIV11
 11970     MOVE 'ELCRTO' TO DFHEIV1
 11971*    MOVE '&$ L                  ''  N#00011453' TO DFHEIV0
 11972     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11973     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11974     MOVE X'204E233030303131343533' TO DFHEIV0(25:11)
 11975     CALL 'kxdfhei1' USING DFHEIV0,
 11976           DFHEIV1,
 11977           ORIGINAL-CERTIFICATE,
 11978           DFHEIV11,
 11979           OC-CONTROL-PRIMARY,
 11980           DFHEIV99,
 11981           DFHEIV99
 11982     MOVE EIBRESP  TO WS-RESPONSE
 11983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11984     END-IF
 11985******************************************************************
 11986*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11987******************************************************************
 11988
 11989     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11990     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11991
 11992
 11993* EXEC CICS READ
 11994*        INTO    (PENDING-BUSINESS)
 11995*        DATASET (FILE-ID-ERPNDB)
 11996*        RIDFLD  (ERPNDB-KEY)
 11997*        UPDATE
 11998*    END-EXEC.
 11999     MOVE LENGTH OF
 12000      PENDING-BUSINESS
 12001       TO DFHEIV11
 12002*    MOVE '&"IL       EU         (   #00011467' TO DFHEIV0
 12003     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12004     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12005     MOVE X'2020233030303131343637' TO DFHEIV0(25:11)
 12006     CALL 'kxdfhei1' USING DFHEIV0,
 12007           FILE-ID-ERPNDB,
 12008           PENDING-BUSINESS,
 12009           DFHEIV11,
 12010           ERPNDB-KEY,
 12011           DFHEIV99,
 12012           DFHEIV99,
 12013           DFHEIV99
 12014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12015
 12016
 12017     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12018     MOVE 'B'                    TO JP-RECORD-TYPE.
 12019     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12020
 12021     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12022
 12023     PERFORM 8400-LOG-JOURNAL-RECORD.
 12024
 12025     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 220
* EL6311.cbl
 12026
 12027     MOVE 'C'                    TO JP-RECORD-TYPE.
 12028     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12029
 12030
 12031* EXEC CICS REWRITE
 12032*        DATASET    (FILE-ID-ERPNDB)
 12033*        FROM       (PENDING-BUSINESS)
 12034*    END-EXEC.
 12035     MOVE LENGTH OF
 12036      PENDING-BUSINESS
 12037       TO DFHEIV11
 12038*    MOVE '&& L                  %   #00011487' TO DFHEIV0
 12039     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12040     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12041     MOVE X'2020233030303131343837' TO DFHEIV0(25:11)
 12042     CALL 'kxdfhei1' USING DFHEIV0,
 12043           FILE-ID-ERPNDB,
 12044           PENDING-BUSINESS,
 12045           DFHEIV11,
 12046           DFHEIV99
 12047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12048
 12049
 12050     PERFORM 8400-LOG-JOURNAL-RECORD.
 12051
 12052     IF WS-ERRORS-PRESENT
 12053        GO TO 3900-RE-DISPLAY-RECORD.
 12054
 12055     MOVE ZEROS                  TO EMI-ERROR.
 12056     MOVE -1                     TO BMAINTL.
 12057     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12058     GO TO 3900-RE-DISPLAY-RECORD.
 12059
 12060 1380-BATCH-HDR-NOT-FOUND.
 12061     MOVE -1                     TO BMAINTL.
 12062     MOVE ER-7450                TO EMI-ERROR.
 12063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12064     GO TO 8200-SEND-DATAONLY.
 12065
 12066 1385-REC-NOT-FOUND.
 12067     MOVE -1                     TO BMAINTL.
 12068     MOVE ER-7451                TO EMI-ERROR.
 12069     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12070     GO TO 8200-SEND-DATAONLY.
 12071
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 221
* EL6311.cbl
 12073
 12074 1386-UPDATE-AGE-FLAGS.
 12075
 12076
 12077* EXEC CICS GETMAIN
 12078*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12079*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12080*        INITIMG (GETMAIN-SPACE)
 12081*    END-EXEC
 12082*    MOVE ',"IL                  $   #00011518' TO DFHEIV0
 12083     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12084     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12085     MOVE X'2020233030303131353138' TO DFHEIV0(25:11)
 12086     CALL 'kxdfhei1' USING DFHEIV0,
 12087           DFHEIV20,
 12088           ELCRTT-RECORD-LENGTH,
 12089           GETMAIN-SPACE
 12090     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12091         DFHEIV20
 12092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12093
 12094
 12095* EXEC CICS HANDLE CONDITION
 12096*        NOTFND   (1386-NOTFND)
 12097*    END-EXEC.
 12098*    MOVE '"$I                   ! ( #00011524' TO DFHEIV0
 12099     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12101     MOVE X'2820233030303131353234' TO DFHEIV0(25:11)
 12102     CALL 'kxdfhei1' USING DFHEIV0
 12103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12104
 12105
 12106     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12107     MOVE 'C'                TO ELCRTT-REC-TYPE
 12108
 12109
 12110* EXEC CICS READ
 12111*        UPDATE
 12112*        DATASET  (CRTT-ID)
 12113*        RIDFLD   (ELCRTT-KEY)
 12114*        INTO     (CERTIFICATE-TRAILERS)
 12115*    END-EXEC.
 12116     MOVE LENGTH OF
 12117      CERTIFICATE-TRAILERS
 12118       TO DFHEIV11
 12119*    MOVE '&"IL       EU         (   #00011531' TO DFHEIV0
 12120     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12121     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12122     MOVE X'2020233030303131353331' TO DFHEIV0(25:11)
 12123     CALL 'kxdfhei1' USING DFHEIV0,
 12124           CRTT-ID,
 12125           CERTIFICATE-TRAILERS,
 12126           DFHEIV11,
 12127           ELCRTT-KEY,
 12128           DFHEIV99,
 12129           DFHEIV99,
 12130           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 222
* EL6311.cbl
 12131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12132
 12133
 12134     IF WS-INS-AGE-SET = 'Y'
 12135        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12136     END-IF
 12137     IF WS-JNT-AGE-SET = 'Y'
 12138        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12139     END-IF
 12140
 12141
 12142* EXEC CICS REWRITE
 12143*       DATASET  (CRTT-ID)
 12144*       FROM     (CERTIFICATE-TRAILERS)
 12145*    END-EXEC.
 12146     MOVE LENGTH OF
 12147      CERTIFICATE-TRAILERS
 12148       TO DFHEIV11
 12149*    MOVE '&& L                  %   #00011545' TO DFHEIV0
 12150     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12151     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12152     MOVE X'2020233030303131353435' TO DFHEIV0(25:11)
 12153     CALL 'kxdfhei1' USING DFHEIV0,
 12154           CRTT-ID,
 12155           CERTIFICATE-TRAILERS,
 12156           DFHEIV11,
 12157           DFHEIV99
 12158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12159
 12160
 12161     GO TO 1386-EXIT.
 12162
 12163 1386-NOTFND.
 12164
 12165     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12166     MOVE 'CS'         TO CS-RECORD-ID.
 12167     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12168     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12169     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12170     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12171     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12172
 12173* EXEC CICS WRITE
 12174*       DATASET  (CRTT-ID)
 12175*       RIDFLD   (ELCRTT-KEY)
 12176*       FROM     (CERTIFICATE-TRAILERS)
 12177*    END-EXEC.
 12178     MOVE LENGTH OF
 12179      CERTIFICATE-TRAILERS
 12180       TO DFHEIV11
 12181*    MOVE '&$ L                  ''   #00011561' TO DFHEIV0
 12182     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12183     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12184     MOVE X'2020233030303131353631' TO DFHEIV0(25:11)
 12185     CALL 'kxdfhei1' USING DFHEIV0,
 12186           CRTT-ID,
 12187           CERTIFICATE-TRAILERS,
 12188           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 223
* EL6311.cbl
 12189           ELCRTT-KEY,
 12190           DFHEIV99,
 12191           DFHEIV99
 12192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12193
 12194
 12195 1386-EXIT.
 12196     EXIT.
 12197
 12198 1390-UPDATE-ERPNDM.
 12199
 12200
 12201* EXEC CICS HANDLE CONDITION
 12202*        NOTFND (1399-EXIT)
 12203*    END-EXEC.
 12204*    MOVE '"$I                   ! ) #00011572' TO DFHEIV0
 12205     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12207     MOVE X'2920233030303131353732' TO DFHEIV0(25:11)
 12208     CALL 'kxdfhei1' USING DFHEIV0
 12209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12210
 12211
 12212     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12213
 12214
 12215* EXEC CICS READ
 12216*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12217*        DATASET (FILE-ID-ERPNDM)
 12218*        RIDFLD  (ERPNDM-KEY)
 12219*        UPDATE
 12220*    END-EXEC.
 12221*    MOVE '&"S        EU         (   #00011578' TO DFHEIV0
 12222     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12223     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12224     MOVE X'2020233030303131353738' TO DFHEIV0(25:11)
 12225     CALL 'kxdfhei1' USING DFHEIV0,
 12226           FILE-ID-ERPNDM,
 12227           DFHEIV20,
 12228           DFHEIV99,
 12229           ERPNDM-KEY,
 12230           DFHEIV99,
 12231           DFHEIV99,
 12232           DFHEIV99
 12233     SET ADDRESS OF PENDING-MAILING-DATA TO
 12234         DFHEIV20
 12235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12236
 12237
 12238     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12239     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12240     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12241
 12242     IF BLSTNML GREATER THAN ZEROS
 12243         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12244
 12245     IF B1STNML GREATER  THAN ZEROS
 12246         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 224
* EL6311.cbl
 12247
 12248     IF BINITL GREATER THAN ZEROS
 12249         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12250
 12251     IF BAGEL GREATER THAN ZEROS
 12252         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12253
 12254     IF BBIRTHL GREATER THAN ZEROS
 12255         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12256
 12257     IF BSEXL GREATER THAN ZEROS
 12258         MOVE  BSEXI             TO PM-INSURED-SEX.
 12259
 12260
 12261* EXEC CICS REWRITE
 12262*        DATASET (FILE-ID-ERPNDM)
 12263*        FROM    (PENDING-MAILING-DATA)
 12264*    END-EXEC.
 12265     MOVE LENGTH OF
 12266      PENDING-MAILING-DATA
 12267       TO DFHEIV11
 12268*    MOVE '&& L                  %   #00011607' TO DFHEIV0
 12269     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12270     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12271     MOVE X'2020233030303131363037' TO DFHEIV0(25:11)
 12272     CALL 'kxdfhei1' USING DFHEIV0,
 12273           FILE-ID-ERPNDM,
 12274           PENDING-MAILING-DATA,
 12275           DFHEIV11,
 12276           DFHEIV99
 12277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12278
 12279
 12280 1399-EXIT.
 12281     EXIT.
 12282
 12283******************************************************************
 12284*                                                                *
 12285*          D E L E T E   I S S U E   R O U T I N E               *
 12286*                                                                *
 12287******************************************************************
 12288
 12289 1400-DELETE-ISSUE-ROUTINE.
 12290     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12291
 12292     IF BCHGL NOT = ZEROS
 12293        MOVE ER-2196             TO EMI-ERROR
 12294        MOVE AL-UABON            TO BMAINTA
 12295        MOVE -1                  TO BMAINTL
 12296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12297        GO TO 8200-SEND-DATAONLY.
 12298
 12299
 12300* EXEC CICS HANDLE CONDITION
 12301*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12302*    END-EXEC.
 12303*    MOVE '"$I                   ! * #00011631' TO DFHEIV0
 12304     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 225
* EL6311.cbl
 12305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12306     MOVE X'2A20233030303131363331' TO DFHEIV0(25:11)
 12307     CALL 'kxdfhei1' USING DFHEIV0
 12308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12309
 12310
 12311     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12312     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12313     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12314
 12315
 12316* EXEC CICS READ
 12317*        SET     (ADDRESS OF PENDING-BUSINESS)
 12318*        DATASET (FILE-ID-ERPNDB)
 12319*        RIDFLD  (ERPNDB-KEY)
 12320*    END-EXEC.
 12321*    MOVE '&"S        E          (   #00011639' TO DFHEIV0
 12322     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12323     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12324     MOVE X'2020233030303131363339' TO DFHEIV0(25:11)
 12325     CALL 'kxdfhei1' USING DFHEIV0,
 12326           FILE-ID-ERPNDB,
 12327           DFHEIV20,
 12328           DFHEIV99,
 12329           ERPNDB-KEY,
 12330           DFHEIV99,
 12331           DFHEIV99,
 12332           DFHEIV99
 12333     SET ADDRESS OF PENDING-BUSINESS TO
 12334         DFHEIV20
 12335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12336
 12337
 12338     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12339
 12340     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12341
 12342     IF BSUFIXL NOT = ZEROS
 12343        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12344     ELSE
 12345        MOVE SPACE               TO WS-NEW-SUFFIX.
 12346
 12347     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12348     PERFORM 8600-DEEDIT.
 12349     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12350     MOVE '4'                    TO DC-OPTION-CODE.
 12351     PERFORM 9700-DATE-LINK.
 12352     IF DATE-CONVERSION-ERROR
 12353        MOVE ER-0348             TO EMI-ERROR
 12354        MOVE -1                  TO BEFFDTL
 12355        MOVE AL-UABON            TO BEFFDTA
 12356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12357        GO TO 8200-SEND-DATAONLY
 12358     ELSE
 12359        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12360        MOVE AL-UANON            TO BEFFDTA
 12361        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12362
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 226
* EL6311.cbl
 12363
 12364* EXEC CICS HANDLE CONDITION
 12365*         NOTFND    (1490-RECORD-NOT-FOUND)
 12366*    END-EXEC.
 12367*    MOVE '"$I                   ! + #00011670' TO DFHEIV0
 12368     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12370     MOVE X'2B20233030303131363730' TO DFHEIV0(25:11)
 12371     CALL 'kxdfhei1' USING DFHEIV0
 12372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12373
 12374
 12375
 12376* EXEC CICS READ
 12377*        SET     (ADDRESS OF PENDING-BUSINESS)
 12378*        DATASET (FILE-ID-ERPNDB)
 12379*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12380*        UPDATE
 12381*    END-EXEC.
 12382*    MOVE '&"S        EU         (   #00011674' TO DFHEIV0
 12383     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12384     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12385     MOVE X'2020233030303131363734' TO DFHEIV0(25:11)
 12386     CALL 'kxdfhei1' USING DFHEIV0,
 12387           FILE-ID-ERPNDB,
 12388           DFHEIV20,
 12389           DFHEIV99,
 12390           PI-PREV-CONTROL-PRIMARY,
 12391           DFHEIV99,
 12392           DFHEIV99,
 12393           DFHEIV99
 12394     SET ADDRESS OF PENDING-BUSINESS TO
 12395         DFHEIV20
 12396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12397
 12398
 12399     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12400        MOVE -1                 TO BMAINTL
 12401        MOVE ER-2197            TO EMI-ERROR
 12402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12403        GO TO 8200-SEND-DATAONLY.
 12404
 12405     IF PB-BILLED-DT NOT = LOW-VALUES
 12406        MOVE -1                 TO BMAINTL
 12407        MOVE ER-2129            TO EMI-ERROR
 12408        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12409        GO TO 8200-SEND-DATAONLY.
 12410
 12411     IF PB-CHG-COUNT NOT = ZEROS
 12412        MOVE ER-2336            TO EMI-ERROR
 12413        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12414        MOVE AL-UABON            TO BMAINTA
 12415        MOVE -1                  TO BMAINTL
 12416        GO TO 8200-SEND-DATAONLY.
 12417
 12418     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12419        PB-CHG-COUNT NOT = ZEROS
 12420        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 227
* EL6311.cbl
 12421        MOVE AL-UABON            TO BMAINTA
 12422        MOVE -1                  TO BMAINTL
 12423        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12424        GO TO 8200-SEND-DATAONLY.
 12425******************************************************************
 12426*                                                                *
 12427*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12428*                                                                *
 12429******************************************************************
 12430     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12431     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12432     MOVE +0                     TO ELCRTO-SEQ-NO
 12433
 12434* EXEC CICS READ
 12435*       DATASET   ('ELCRTO')
 12436*       INTO      (ORIGINAL-CERTIFICATE)
 12437*       RIDFLD    (ELCRTO-KEY)
 12438*       GTEQ
 12439*       RESP      (WS-RESPONSE)
 12440*    END-EXEC
 12441     MOVE LENGTH OF
 12442      ORIGINAL-CERTIFICATE
 12443       TO DFHEIV11
 12444     MOVE 'ELCRTO' TO DFHEIV1
 12445*    MOVE '&"IL       G          (  N#00011715' TO DFHEIV0
 12446     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12448     MOVE X'204E233030303131373135' TO DFHEIV0(25:11)
 12449     CALL 'kxdfhei1' USING DFHEIV0,
 12450           DFHEIV1,
 12451           ORIGINAL-CERTIFICATE,
 12452           DFHEIV11,
 12453           ELCRTO-KEY,
 12454           DFHEIV99,
 12455           DFHEIV99,
 12456           DFHEIV99
 12457     MOVE EIBRESP  TO WS-RESPONSE
 12458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12459     IF RESP-NORMAL
 12460        AND (OC-CONTROL-PRIMARY (1:33) =
 12461                 PB-CONTROL-BY-ACCOUNT (1:33))
 12462        AND (OC-RECORD-TYPE = 'I')
 12463
 12464* EXEC CICS READ
 12465*          DATASET   ('ELCRTO')
 12466*          INTO      (ORIGINAL-CERTIFICATE)
 12467*          RIDFLD    (ELCRTO-KEY)
 12468*          UPDATE
 12469*          RESP      (WS-RESPONSE)
 12470*       END-EXEC
 12471     MOVE LENGTH OF
 12472      ORIGINAL-CERTIFICATE
 12473       TO DFHEIV11
 12474     MOVE 'ELCRTO' TO DFHEIV1
 12475*    MOVE '&"IL       EU         (  N#00011726' TO DFHEIV0
 12476     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12477     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12478     MOVE X'204E233030303131373236' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 228
* EL6311.cbl
 12479     CALL 'kxdfhei1' USING DFHEIV0,
 12480           DFHEIV1,
 12481           ORIGINAL-CERTIFICATE,
 12482           DFHEIV11,
 12483           ELCRTO-KEY,
 12484           DFHEIV99,
 12485           DFHEIV99,
 12486           DFHEIV99
 12487     MOVE EIBRESP  TO WS-RESPONSE
 12488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12489        IF RESP-NORMAL
 12490
 12491* EXEC CICS DELETE
 12492*             DATASET   ('ELCRTO')
 12493*          END-EXEC
 12494     MOVE 'ELCRTO' TO DFHEIV1
 12495*    MOVE '&(                    &   #00011734' TO DFHEIV0
 12496     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12497     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12498     MOVE X'2020233030303131373334' TO DFHEIV0(25:11)
 12499     CALL 'kxdfhei1' USING DFHEIV0,
 12500           DFHEIV1,
 12501           DFHEIV99,
 12502           DFHEIV99,
 12503           DFHEIV99,
 12504           DFHEIV99
 12505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12506        END-IF
 12507     END-IF
 12508******************************************************************
 12509*                                                                *
 12510*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12511*                                                                *
 12512******************************************************************
 12513
 12514* EXEC CICS HANDLE CONDITION
 12515*        NOTFND    (1405-DELETE-CERTIFICATE)
 12516*    END-EXEC.
 12517*    MOVE '"$I                   ! , #00011744' TO DFHEIV0
 12518     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12519     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12520     MOVE X'2C20233030303131373434' TO DFHEIV0(25:11)
 12521     CALL 'kxdfhei1' USING DFHEIV0
 12522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12523
 12524
 12525
 12526* EXEC CICS READ
 12527*        EQUAL
 12528*        DATASET   (FILE-ID-ERPNDM)
 12529*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12530*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12531*        UPDATE
 12532*    END-EXEC.
 12533*    MOVE '&"S        EU         (   #00011748' TO DFHEIV0
 12534     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12535     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12536     MOVE X'2020233030303131373438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 229
* EL6311.cbl
 12537     CALL 'kxdfhei1' USING DFHEIV0,
 12538           FILE-ID-ERPNDM,
 12539           DFHEIV20,
 12540           DFHEIV99,
 12541           PI-PREV-CONTROL-PRIMARY,
 12542           DFHEIV99,
 12543           DFHEIV99,
 12544           DFHEIV99
 12545     SET ADDRESS OF PENDING-MAILING-DATA TO
 12546         DFHEIV20
 12547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12548
 12549
 12550     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12551     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12552     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12553
 12554     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12555
 12556
 12557* EXEC CICS DELETE
 12558*        DATASET   (FILE-ID-ERPNDM)
 12559*    END-EXEC.
 12560*    MOVE '&(                    &   #00011762' TO DFHEIV0
 12561     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12562     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12563     MOVE X'2020233030303131373632' TO DFHEIV0(25:11)
 12564     CALL 'kxdfhei1' USING DFHEIV0,
 12565           FILE-ID-ERPNDM,
 12566           DFHEIV99,
 12567           DFHEIV99,
 12568           DFHEIV99,
 12569           DFHEIV99
 12570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12571
 12572
 12573******************************************************************
 12574*                PROCESS   CERTIFICATE                           *
 12575******************************************************************
 12576
 12577 1405-DELETE-CERTIFICATE.
 12578
 12579* EXEC CICS HANDLE CONDITION
 12580*         NOTFND  (1420-CONTINUE-DELETE)
 12581*    END-EXEC.
 12582*    MOVE '"$I                   ! - #00011771' TO DFHEIV0
 12583     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12585     MOVE X'2D20233030303131373731' TO DFHEIV0(25:11)
 12586     CALL 'kxdfhei1' USING DFHEIV0
 12587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12588
 12589
 12590     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12591     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12592     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12593     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12594
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 230
* EL6311.cbl
 12595
 12596* EXEC CICS READ
 12597*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12598*        DATASET (FILE-ID-ELCERT)
 12599*        RIDFLD  (ELCERT-KEY)
 12600*        UPDATE
 12601*    END-EXEC.
 12602*    MOVE '&"S        EU         (   #00011780' TO DFHEIV0
 12603     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12604     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12605     MOVE X'2020233030303131373830' TO DFHEIV0(25:11)
 12606     CALL 'kxdfhei1' USING DFHEIV0,
 12607           FILE-ID-ELCERT,
 12608           DFHEIV20,
 12609           DFHEIV99,
 12610           ELCERT-KEY,
 12611           DFHEIV99,
 12612           DFHEIV99,
 12613           DFHEIV99
 12614     SET ADDRESS OF CERTIFICATE-MASTER TO
 12615         DFHEIV20
 12616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12617
 12618
 12619     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12620
 12621     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12622     MOVE 'B'                    TO JP-RECORD-TYPE
 12623     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12624
 12625     PERFORM 8400-LOG-JOURNAL-RECORD.
 12626
 12627     IF CERT-NOTES-ARE-NOT-PRESENT
 12628        MOVE ' '                 TO WS-CERT-NOTE-SW
 12629     ELSE
 12630        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12631
 12632     IF INSURED-ADDR-PRESENT
 12633        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12634
 12635******************************************************************
 12636******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12637******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12638******************************************************************
 12639******************************************************************
 12640
 12641     IF CERT-ADDED-BATCH AND
 12642        (NOT NO-CLAIM-ATTACHED
 12643         OR
 12644         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12645        GO TO 1410-REWRITE-CERT.
 12646
 12647******************************************************************
 12648******************************************************************
 12649
 12650     IF CERT-ADDED-BATCH  AND
 12651        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12652        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 231
* EL6311.cbl
 12653
 12654     IF NO-CLAIM-ATTACHED
 12655        NEXT SENTENCE
 12656     ELSE
 12657        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12658        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12659        GO TO 1410-REWRITE-CERT.
 12660
 12661     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12662     MOVE 'D'                      TO JP-RECORD-TYPE.
 12663     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12664
 12665
 12666* EXEC CICS DELETE
 12667*         DATASET    (FILE-ID-ELCERT)
 12668*    END-EXEC.
 12669*    MOVE '&(                    &   #00011833' TO DFHEIV0
 12670     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12671     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12672     MOVE X'2020233030303131383333' TO DFHEIV0(25:11)
 12673     CALL 'kxdfhei1' USING DFHEIV0,
 12674           FILE-ID-ELCERT,
 12675           DFHEIV99,
 12676           DFHEIV99,
 12677           DFHEIV99,
 12678           DFHEIV99
 12679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12680
 12681
 12682     PERFORM 8400-LOG-JOURNAL-RECORD.
 12683
 12684******************************************************************
 12685*                                                                *
 12686*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12687*                                                                *
 12688******************************************************************
 12689
 12690     IF  CERT-NOTES-ARE-PRESENT
 12691         NEXT SENTENCE
 12692     ELSE
 12693         GO TO 1407-DELETE-MAILING.
 12694
 12695
 12696* EXEC CICS HANDLE CONDITION
 12697*         NOTFND  (1406-DELETE-ERNOTE)
 12698*    END-EXEC.
 12699*    MOVE '"$I                   ! . #00011850' TO DFHEIV0
 12700     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12702     MOVE X'2E20233030303131383530' TO DFHEIV0(25:11)
 12703     CALL 'kxdfhei1' USING DFHEIV0
 12704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12705
 12706
 12707     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12708     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12709     MOVE 0                     TO ERCNOT-SEQUENCE.
 12710
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 232
* EL6311.cbl
 12711 1406-DELETE-ERCNOT-LOOP.
 12712
 12713
 12714* EXEC CICS READ
 12715*        GTEQ
 12716*        DATASET   (FILE-ID-ERCNOT)
 12717*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12718*        RIDFLD    (ERCNOT-KEY)
 12719*    END-EXEC.
 12720*    MOVE '&"S        G          (   #00011860' TO DFHEIV0
 12721     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12722     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12723     MOVE X'2020233030303131383630' TO DFHEIV0(25:11)
 12724     CALL 'kxdfhei1' USING DFHEIV0,
 12725           FILE-ID-ERCNOT,
 12726           DFHEIV20,
 12727           DFHEIV99,
 12728           ERCNOT-KEY,
 12729           DFHEIV99,
 12730           DFHEIV99,
 12731           DFHEIV99
 12732     SET ADDRESS OF CERT-NOTE-FILE TO
 12733         DFHEIV20
 12734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12735
 12736
 12737     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12738     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12739         GO TO 1406-DELETE-ERNOTE
 12740     END-IF.
 12741
 12742     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12743     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12744     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12745
 12746     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12747
 12748
 12749* EXEC CICS DELETE
 12750*        DATASET   (FILE-ID-ERCNOT)
 12751*        RIDFLD    (ERCNOT-KEY)
 12752*        END-EXEC.
 12753*    MOVE '&(  R                 &   #00011878' TO DFHEIV0
 12754     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12755     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12756     MOVE X'2020233030303131383738' TO DFHEIV0(25:11)
 12757     CALL 'kxdfhei1' USING DFHEIV0,
 12758           FILE-ID-ERCNOT,
 12759           ERCNOT-KEY,
 12760           DFHEIV99,
 12761           DFHEIV99,
 12762           DFHEIV99
 12763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12764
 12765
 12766     PERFORM 8400-LOG-JOURNAL-RECORD.
 12767
 12768     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 233
* EL6311.cbl
 12769
 12770 1406-DELETE-ERNOTE.
 12771
 12772
 12773* EXEC CICS HANDLE CONDITION
 12774*         NOTFND  (1407-DELETE-MAILING)
 12775*    END-EXEC.
 12776*    MOVE '"$I                   ! / #00011889' TO DFHEIV0
 12777     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12778     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12779     MOVE X'2F20233030303131383839' TO DFHEIV0(25:11)
 12780     CALL 'kxdfhei1' USING DFHEIV0
 12781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12782
 12783
 12784
 12785* EXEC CICS READ
 12786*        EQUAL
 12787*        DATASET   (FILE-ID-ERNOTE)
 12788*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12789*        RIDFLD    (ELCERT-KEY)
 12790*        UPDATE
 12791*    END-EXEC.
 12792*    MOVE '&"S        EU         (   #00011893' TO DFHEIV0
 12793     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12794     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12795     MOVE X'2020233030303131383933' TO DFHEIV0(25:11)
 12796     CALL 'kxdfhei1' USING DFHEIV0,
 12797           FILE-ID-ERNOTE,
 12798           DFHEIV20,
 12799           DFHEIV99,
 12800           ELCERT-KEY,
 12801           DFHEIV99,
 12802           DFHEIV99,
 12803           DFHEIV99
 12804     SET ADDRESS OF CERTIFICATE-NOTE TO
 12805         DFHEIV20
 12806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12807
 12808
 12809     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12810     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12811     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12812
 12813     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12814
 12815
 12816* EXEC CICS DELETE
 12817*        DATASET   (FILE-ID-ERNOTE)
 12818*        END-EXEC.
 12819*    MOVE '&(                    &   #00011907' TO DFHEIV0
 12820     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12821     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12822     MOVE X'2020233030303131393037' TO DFHEIV0(25:11)
 12823     CALL 'kxdfhei1' USING DFHEIV0,
 12824           FILE-ID-ERNOTE,
 12825           DFHEIV99,
 12826           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 234
* EL6311.cbl
 12827           DFHEIV99,
 12828           DFHEIV99
 12829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12830
 12831
 12832     PERFORM 8400-LOG-JOURNAL-RECORD.
 12833
 12834******************************************************************
 12835*                                                                *
 12836*                DELETE MAILING ADDRESS RECORDS                  *
 12837*                                                                *
 12838******************************************************************
 12839
 12840 1407-DELETE-MAILING.
 12841     IF CERT-ADDRESS-PRESENT
 12842        NEXT SENTENCE
 12843     ELSE
 12844        GO TO 1420-CONTINUE-DELETE.
 12845
 12846
 12847* EXEC CICS HANDLE CONDITION
 12848*         NOTFND  (1420-CONTINUE-DELETE)
 12849*    END-EXEC.
 12850*    MOVE '"$I                   ! 0 #00011925' TO DFHEIV0
 12851     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12853     MOVE X'3020233030303131393235' TO DFHEIV0(25:11)
 12854     CALL 'kxdfhei1' USING DFHEIV0
 12855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12856
 12857
 12858
 12859* EXEC CICS READ
 12860*        EQUAL
 12861*        DATASET   (FILE-ID-ERMAIL)
 12862*        SET       (ADDRESS OF MAILING-DATA)
 12863*        RIDFLD    (ELCERT-KEY)
 12864*        UPDATE
 12865*    END-EXEC.
 12866*    MOVE '&"S        EU         (   #00011929' TO DFHEIV0
 12867     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12868     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12869     MOVE X'2020233030303131393239' TO DFHEIV0(25:11)
 12870     CALL 'kxdfhei1' USING DFHEIV0,
 12871           FILE-ID-ERMAIL,
 12872           DFHEIV20,
 12873           DFHEIV99,
 12874           ELCERT-KEY,
 12875           DFHEIV99,
 12876           DFHEIV99,
 12877           DFHEIV99
 12878     SET ADDRESS OF MAILING-DATA TO
 12879         DFHEIV20
 12880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12881
 12882
 12883     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12884     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 235
* EL6311.cbl
 12885     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12886
 12887     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12888
 12889
 12890* EXEC CICS DELETE
 12891*        DATASET   (FILE-ID-ERMAIL)
 12892*    END-EXEC.
 12893*    MOVE '&(                    &   #00011943' TO DFHEIV0
 12894     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12895     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12896     MOVE X'2020233030303131393433' TO DFHEIV0(25:11)
 12897     CALL 'kxdfhei1' USING DFHEIV0,
 12898           FILE-ID-ERMAIL,
 12899           DFHEIV99,
 12900           DFHEIV99,
 12901           DFHEIV99,
 12902           DFHEIV99
 12903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12904
 12905
 12906     GO TO 1420-CONTINUE-DELETE.
 12907
 12908 1410-REWRITE-CERT.
 12909     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12910     MOVE 'C'                      TO JP-RECORD-TYPE.
 12911     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12912     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12913
 12914
 12915* EXEC CICS REWRITE
 12916*         DATASET    (FILE-ID-ELCERT)
 12917*         FROM       (CERTIFICATE-MASTER)
 12918*         END-EXEC.
 12919     MOVE LENGTH OF
 12920      CERTIFICATE-MASTER
 12921       TO DFHEIV11
 12922*    MOVE '&& L                  %   #00011955' TO DFHEIV0
 12923     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12924     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12925     MOVE X'2020233030303131393535' TO DFHEIV0(25:11)
 12926     CALL 'kxdfhei1' USING DFHEIV0,
 12927           FILE-ID-ELCERT,
 12928           CERTIFICATE-MASTER,
 12929           DFHEIV11,
 12930           DFHEIV99
 12931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12932
 12933
 12934     PERFORM 8400-LOG-JOURNAL-RECORD.
 12935
 12936 1420-CONTINUE-DELETE.
 12937     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12938     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12939
 12940     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12941     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12942
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 236
* EL6311.cbl
 12943     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12944
 12945 1450-DELETE-PB-RECORD.
 12946     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12947     MOVE 'D'                      TO JP-RECORD-TYPE
 12948     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12949
 12950
 12951* EXEC CICS DELETE
 12952*        DATASET    (FILE-ID-ERPNDB)
 12953*    END-EXEC.
 12954*    MOVE '&(                    &   #00011976' TO DFHEIV0
 12955     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12956     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12957     MOVE X'2020233030303131393736' TO DFHEIV0(25:11)
 12958     CALL 'kxdfhei1' USING DFHEIV0,
 12959           FILE-ID-ERPNDB,
 12960           DFHEIV99,
 12961           DFHEIV99,
 12962           DFHEIV99,
 12963           DFHEIV99
 12964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12965
 12966
 12967     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12968
 12969     PERFORM 8400-LOG-JOURNAL-RECORD.
 12970
 12971     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12972     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12973     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12974
 12975
 12976* EXEC CICS HANDLE CONDITION
 12977*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12978*    END-EXEC.
 12979*    MOVE '"$I                   ! 1 #00011988' TO DFHEIV0
 12980     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12982     MOVE X'3120233030303131393838' TO DFHEIV0(25:11)
 12983     CALL 'kxdfhei1' USING DFHEIV0
 12984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12985
 12986
 12987
 12988* EXEC CICS READ
 12989*        SET     (ADDRESS OF PENDING-BUSINESS)
 12990*        DATASET (FILE-ID-ERPNDB)
 12991*        RIDFLD  (ERPNDB-KEY)
 12992*        UPDATE
 12993*    END-EXEC.
 12994*    MOVE '&"S        EU         (   #00011992' TO DFHEIV0
 12995     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12996     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12997     MOVE X'2020233030303131393932' TO DFHEIV0(25:11)
 12998     CALL 'kxdfhei1' USING DFHEIV0,
 12999           FILE-ID-ERPNDB,
 13000           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 237
* EL6311.cbl
 13001           DFHEIV99,
 13002           ERPNDB-KEY,
 13003           DFHEIV99,
 13004           DFHEIV99,
 13005           DFHEIV99
 13006     SET ADDRESS OF PENDING-BUSINESS TO
 13007         DFHEIV20
 13008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13009
 13010
 13011     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13012
 13013     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13014
 13015     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13016        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13017        MOVE 'D'                   TO JP-RECORD-TYPE
 13018        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13019
 13020* EXEC CICS DELETE
 13021*            DATASET    (FILE-ID-ERPNDB)
 13022*       END-EXEC
 13023*    MOVE '&(                    &   #00012007' TO DFHEIV0
 13024     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13025     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13026     MOVE X'2020233030303132303037' TO DFHEIV0(25:11)
 13027     CALL 'kxdfhei1' USING DFHEIV0,
 13028           FILE-ID-ERPNDB,
 13029           DFHEIV99,
 13030           DFHEIV99,
 13031           DFHEIV99,
 13032           DFHEIV99
 13033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13034        PERFORM 8400-LOG-JOURNAL-RECORD
 13035     ELSE
 13036        MOVE 'B'                 TO JP-RECORD-TYPE
 13037        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13038        PERFORM 8400-LOG-JOURNAL-RECORD
 13039        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13040        MOVE 'C'                 TO JP-RECORD-TYPE
 13041        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13042
 13043* EXEC CICS REWRITE
 13044*            DATASET    (FILE-ID-ERPNDB)
 13045*            FROM       (PENDING-BUSINESS)
 13046*       END-EXEC
 13047     MOVE LENGTH OF
 13048      PENDING-BUSINESS
 13049       TO DFHEIV11
 13050*    MOVE '&& L                  %   #00012018' TO DFHEIV0
 13051     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13052     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13053     MOVE X'2020233030303132303138' TO DFHEIV0(25:11)
 13054     CALL 'kxdfhei1' USING DFHEIV0,
 13055           FILE-ID-ERPNDB,
 13056           PENDING-BUSINESS,
 13057           DFHEIV11,
 13058           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 238
* EL6311.cbl
 13059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13060        PERFORM 8400-LOG-JOURNAL-RECORD.
 13061
 13062******************************************************************
 13063*                                                                *
 13064*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13065*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13066*                                                                *
 13067******************************************************************
 13068
 13069     IF NOT PI-AR-PROCESSING
 13070        GO TO 1475-DELETE-FINISHED.
 13071
 13072     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13073        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13074        NEXT SENTENCE
 13075     ELSE
 13076        GO TO 1475-DELETE-FINISHED.
 13077
 13078
 13079* EXEC CICS HANDLE CONDITION
 13080*         NOTFND    (1475-DELETE-FINISHED)
 13081*         END-EXEC.
 13082*    MOVE '"$I                   ! 2 #00012040' TO DFHEIV0
 13083     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13085     MOVE X'3220233030303132303430' TO DFHEIV0(25:11)
 13086     CALL 'kxdfhei1' USING DFHEIV0
 13087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13088
 13089
 13090     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13091     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13092
 13093
 13094* EXEC CICS READ
 13095*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13096*        DATASET (FILE-ID-ERRQST)
 13097*        RIDFLD  (ERRQST-KEY)
 13098*        UPDATE
 13099*    END-EXEC.
 13100*    MOVE '&"S        EU         (   #00012047' TO DFHEIV0
 13101     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13102     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13103     MOVE X'2020233030303132303437' TO DFHEIV0(25:11)
 13104     CALL 'kxdfhei1' USING DFHEIV0,
 13105           FILE-ID-ERRQST,
 13106           DFHEIV20,
 13107           DFHEIV99,
 13108           ERRQST-KEY,
 13109           DFHEIV99,
 13110           DFHEIV99,
 13111           DFHEIV99
 13112     SET ADDRESS OF AR-REQUEST-RECORD TO
 13113         DFHEIV20
 13114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13115
 13116
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 239
* EL6311.cbl
 13117     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13118
 13119     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13120
 13121     MOVE 'D'                      TO JP-RECORD-TYPE.
 13122     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13123
 13124
 13125* EXEC CICS DELETE
 13126*         DATASET    (FILE-ID-ERRQST)
 13127*    END-EXEC.
 13128*    MOVE '&(                    &   #00012061' TO DFHEIV0
 13129     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13130     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13131     MOVE X'2020233030303132303631' TO DFHEIV0(25:11)
 13132     CALL 'kxdfhei1' USING DFHEIV0,
 13133           FILE-ID-ERRQST,
 13134           DFHEIV99,
 13135           DFHEIV99,
 13136           DFHEIV99,
 13137           DFHEIV99
 13138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13139
 13140
 13141     PERFORM 8400-LOG-JOURNAL-RECORD.
 13142
 13143 1475-DELETE-FINISHED.
 13144     MOVE ZEROS                  TO EMI-ERROR.
 13145     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13146     MOVE LOW-VALUES             TO EL631BI.
 13147     MOVE -1                     TO BMAINTL.
 13148     GO TO 8100-SEND-INITIAL-MAP.
 13149
 13150 1480-BATCH-HDR-NOT-FOUND.
 13151     MOVE -1                     TO BMAINTL.
 13152     MOVE ER-7450                TO EMI-ERROR.
 13153     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13154     GO TO 8200-SEND-DATAONLY.
 13155
 13156 1490-RECORD-NOT-FOUND.
 13157     MOVE -1                     TO BMAINTL.
 13158     MOVE ER-7451                TO EMI-ERROR.
 13159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13160     GO TO 8200-SEND-DATAONLY.
 13161
 13162******************************************************************
 13163*            O V E R   C H A R G E   P R O C E S S I N G         *
 13164******************************************************************
 13165 1500-UPDATE-ERNOTE.
 13166     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13167     MOVE 'A'                    TO WS-NOTE-SW
 13168     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13169     .
 13170 1500-EXIT.
 13171     EXIT.
 13172 1510-ADD-ERNOTE-REC.
 13173
 13174* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 240
* EL6311.cbl
 13175*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13176*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13177*        INITIMG (GETMAIN-SPACE)
 13178*    END-EXEC
 13179*    MOVE ',"IL                  $   #00012097' TO DFHEIV0
 13180     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13181     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13182     MOVE X'2020233030303132303937' TO DFHEIV0(25:11)
 13183     CALL 'kxdfhei1' USING DFHEIV0,
 13184           DFHEIV20,
 13185           ERNOTE-RECORD-LENGTH,
 13186           GETMAIN-SPACE
 13187     SET ADDRESS OF CERTIFICATE-NOTE TO
 13188         DFHEIV20
 13189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13190     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13191                                 TO ERNOTE-KEY
 13192
 13193* EXEC CICS READ
 13194*       DATASET    (FILE-ID-ERNOTE)
 13195*       RIDFLD     (ERNOTE-KEY)
 13196*       INTO       (CERTIFICATE-NOTE)
 13197*       RESP       (WS-RESPONSE)
 13198*       UPDATE
 13199*    END-EXEC
 13200     MOVE LENGTH OF
 13201      CERTIFICATE-NOTE
 13202       TO DFHEIV11
 13203*    MOVE '&"IL       EU         (  N#00012104' TO DFHEIV0
 13204     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13205     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13206     MOVE X'204E233030303132313034' TO DFHEIV0(25:11)
 13207     CALL 'kxdfhei1' USING DFHEIV0,
 13208           FILE-ID-ERNOTE,
 13209           CERTIFICATE-NOTE,
 13210           DFHEIV11,
 13211           ERNOTE-KEY,
 13212           DFHEIV99,
 13213           DFHEIV99,
 13214           DFHEIV99
 13215     MOVE EIBRESP  TO WS-RESPONSE
 13216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13217     IF RESP-NORMAL
 13218        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13219           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13220        END-IF
 13221        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13222           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13223        END-IF
 13224        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13225           (N1 > +10)
 13226           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13227           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13228        END-PERFORM
 13229        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13230          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13231
 13232* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 241
* EL6311.cbl
 13233*            DATASET    (FILE-ID-ERNOTE)
 13234*          END-EXEC
 13235*    MOVE '&*                    #   #00012125' TO DFHEIV0
 13236     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13237     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13238     MOVE X'2020233030303132313235' TO DFHEIV0(25:11)
 13239     CALL 'kxdfhei1' USING DFHEIV0,
 13240           FILE-ID-ERNOTE,
 13241           DFHEIV99
 13242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13243        ELSE
 13244          PERFORM VARYING N1 FROM +1 BY +1
 13245           UNTIL (N1 > +10)
 13246           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13247          END-PERFORM
 13248          IF (N1 < +11)
 13249            IF N1 >= CN-BILLING-START-LINE-NO AND
 13250              N1 <= CN-BILLING-END-LINE-NO
 13251              IF PI-COMPANY-ID = 'DCC'
 13252                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13253              ELSE
 13254                 MOVE WS-VA-NO-COMM-MESS
 13255                                    TO CN-LINE (N1)
 13256              END-IF
 13257            ELSE
 13258              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13259               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13260                IF PI-COMPANY-ID = 'DCC'
 13261                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13262                ELSE
 13263                  MOVE WS-VA-NO-COMM-MESS
 13264                                    TO CN-LINE (N1)
 13265                END-IF
 13266                MOVE N1             TO CN-BILLING-END-LINE-NO
 13267              ELSE
 13268                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13269                  IF PI-COMPANY-ID = 'DCC'
 13270                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13271                  ELSE
 13272                     MOVE WS-VA-NO-COMM-MESS
 13273                                    TO CN-LINE (N1)
 13274                  END-IF
 13275                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13276                                      CN-BILLING-START-LINE-NO
 13277                ELSE
 13278                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13279                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13280                     IF PI-COMPANY-ID = 'DCC'
 13281                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13282                     ELSE
 13283                       MOVE WS-VA-NO-COMM-MESS
 13284                                    TO CN-LINE (N1)
 13285                     END-IF
 13286                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13287                  ELSE
 13288                     PERFORM 1700-SQUEEZE-IT-IN
 13289                                 THRU 1700-EXIT
 13290                  END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 242
* EL6311.cbl
 13291                END-IF
 13292              END-IF
 13293            END-IF
 13294            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13295            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13296            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13297
 13298* EXEC CICS REWRITE
 13299*              DATASET    (FILE-ID-ERNOTE)
 13300*              FROM       (CERTIFICATE-NOTE)
 13301*              RESP       (WS-RESPONSE)
 13302*           END-EXEC
 13303     MOVE LENGTH OF
 13304      CERTIFICATE-NOTE
 13305       TO DFHEIV11
 13306*    MOVE '&& L                  %  N#00012182' TO DFHEIV0
 13307     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13308     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13309     MOVE X'204E233030303132313832' TO DFHEIV0(25:11)
 13310     CALL 'kxdfhei1' USING DFHEIV0,
 13311           FILE-ID-ERNOTE,
 13312           CERTIFICATE-NOTE,
 13313           DFHEIV11,
 13314           DFHEIV99
 13315     MOVE EIBRESP  TO WS-RESPONSE
 13316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13317          END-IF
 13318        END-IF
 13319     ELSE
 13320        MOVE SPACES              TO CERTIFICATE-NOTE
 13321        MOVE 'CN'                TO CN-RECORD-ID
 13322        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13323                                 TO CN-CONTROL-PRIMARY
 13324                                    ERNOTE-KEY
 13325        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13326                                    CN-BILLING-END-LINE-NO
 13327        IF PI-COMPANY-ID = 'DCC'
 13328           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13329        ELSE
 13330           MOVE WS-VA-NO-COMM-MESS
 13331                                 TO CN-LINE (1)
 13332        END-IF
 13333        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13334        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13335        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13336
 13337* EXEC CICS WRITE
 13338*          DATASET    (FILE-ID-ERNOTE)
 13339*          FROM       (CERTIFICATE-NOTE)
 13340*          RIDFLD     (ERNOTE-KEY)
 13341*          RESP       (WS-RESPONSE)
 13342*       END-EXEC
 13343     MOVE LENGTH OF
 13344      CERTIFICATE-NOTE
 13345       TO DFHEIV11
 13346*    MOVE '&$ L                  ''  N#00012206' TO DFHEIV0
 13347     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13348     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 243
* EL6311.cbl
 13349     MOVE X'204E233030303132323036' TO DFHEIV0(25:11)
 13350     CALL 'kxdfhei1' USING DFHEIV0,
 13351           FILE-ID-ERNOTE,
 13352           CERTIFICATE-NOTE,
 13353           DFHEIV11,
 13354           ERNOTE-KEY,
 13355           DFHEIV99,
 13356           DFHEIV99
 13357     MOVE EIBRESP  TO WS-RESPONSE
 13358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13359     END-IF
 13360     .
 13361 1510-EXIT.
 13362     EXIT.
 13363 1520-UPDATE-ELCERT.
 13364     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13365                                 TO ELCERT-KEY
 13366
 13367* EXEC CICS READ
 13368*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13369*        DATASET (FILE-ID-ELCERT)
 13370*        RIDFLD  (ELCERT-KEY)
 13371*        UPDATE
 13372*        RESP    (WS-RESPONSE)
 13373*    END-EXEC
 13374*    MOVE '&"S        EU         (  N#00012219' TO DFHEIV0
 13375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13376     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13377     MOVE X'204E233030303132323139' TO DFHEIV0(25:11)
 13378     CALL 'kxdfhei1' USING DFHEIV0,
 13379           FILE-ID-ELCERT,
 13380           DFHEIV20,
 13381           DFHEIV99,
 13382           ELCERT-KEY,
 13383           DFHEIV99,
 13384           DFHEIV99,
 13385           DFHEIV99
 13386     SET ADDRESS OF CERTIFICATE-MASTER TO
 13387         DFHEIV20
 13388     MOVE EIBRESP  TO WS-RESPONSE
 13389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13390     IF RESP-NORMAL
 13391        IF WS-NOTE-SW = 'A'
 13392           IF CM-NOTE-SW = ' '
 13393              MOVE '2'             TO CM-NOTE-SW
 13394           ELSE
 13395             IF CM-NOTE-SW = '1'
 13396                MOVE '3'           TO CM-NOTE-SW
 13397             ELSE
 13398               IF CM-NOTE-SW = '4'
 13399                  MOVE '6'         TO CM-NOTE-SW
 13400               ELSE
 13401                 IF CM-NOTE-SW = '5'
 13402                    MOVE '7'       TO CM-NOTE-SW
 13403                 END-IF
 13404               END-IF
 13405             END-IF
 13406           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 244
* EL6311.cbl
 13407        ELSE
 13408           IF CM-NOTE-SW = '2'
 13409              MOVE ' '             TO CM-NOTE-SW
 13410           ELSE
 13411             IF CM-NOTE-SW = '3'
 13412                MOVE '1'           TO CM-NOTE-SW
 13413             ELSE
 13414               IF CM-NOTE-SW = '6'
 13415                  MOVE '4'         TO CM-NOTE-SW
 13416               ELSE
 13417                 IF CM-NOTE-SW = '7'
 13418                    MOVE '5'       TO CM-NOTE-SW
 13419                 END-IF
 13420               END-IF
 13421             END-IF
 13422           END-IF
 13423        END-IF
 13424
 13425* EXEC CICS REWRITE
 13426*          DATASET    (FILE-ID-ELCERT)
 13427*          FROM       (CERTIFICATE-MASTER)
 13428*          RESP       (WS-RESPONSE)
 13429*       END-EXEC
 13430     MOVE LENGTH OF
 13431      CERTIFICATE-MASTER
 13432       TO DFHEIV11
 13433*    MOVE '&& L                  %  N#00012260' TO DFHEIV0
 13434     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13435     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13436     MOVE X'204E233030303132323630' TO DFHEIV0(25:11)
 13437     CALL 'kxdfhei1' USING DFHEIV0,
 13438           FILE-ID-ELCERT,
 13439           CERTIFICATE-MASTER,
 13440           DFHEIV11,
 13441           DFHEIV99
 13442     MOVE EIBRESP  TO WS-RESPONSE
 13443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13444        IF RESP-NORMAL
 13445           CONTINUE
 13446        ELSE
 13447           MOVE WS-RESPONSE TO EMI-ERROR
 13448           PERFORM 9900-ERROR-FORMAT
 13449                                 THRU 9900-EXIT
 13450           GO TO 8200-SEND-DATAONLY
 13451        END-IF
 13452     ELSE
 13453        MOVE -1                  TO BMAINTL
 13454        MOVE 0249                TO EMI-ERROR
 13455        PERFORM 9900-ERROR-FORMAT
 13456                                 THRU 9900-EXIT
 13457        GO TO 8200-SEND-DATAONLY
 13458     END-IF
 13459     .
 13460 1520-EXIT.
 13461     EXIT.
 13462 1600-UPDATE-ERPYAJ.
 13463     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13464                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 245
* EL6311.cbl
 13465     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13466                                 THRU 1620-EXIT
 13467     .
 13468 1600-EXIT.
 13469     EXIT.
 13470 1610-ADD-ERPYAJ-BANK-REC.
 13471
 13472* EXEC CICS GETMAIN
 13473*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13474*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13475*        INITIMG (GETMAIN-SPACE)
 13476*    END-EXEC
 13477*    MOVE ',"IL                  $   #00012292' TO DFHEIV0
 13478     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13479     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13480     MOVE X'2020233030303132323932' TO DFHEIV0(25:11)
 13481     CALL 'kxdfhei1' USING DFHEIV0,
 13482           DFHEIV20,
 13483           ERPYAJ-RECORD-LENGTH,
 13484           GETMAIN-SPACE
 13485     SET ADDRESS OF PENDING-PAY-ADJ TO
 13486         DFHEIV20
 13487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13488     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13489     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13490     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13491     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13492     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13493     MOVE +10                    TO ERPYAJ-SEQ-NO
 13494     MOVE 'R'                    TO ERPYAJ-TYPE
 13495     IF REVERSAL
 13496        MOVE 'C'                 TO ERPYAJ-TYPE
 13497     END-IF
 13498     MOVE SPACES                 TO PENDING-PAY-ADJ
 13499     MOVE 'PY'                   TO PY-RECORD-ID
 13500     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13501     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13502     IF REVERSAL
 13503        MOVE PB-I-DCC-OVER-CHG-AMT
 13504                                 TO PY-ENTRY-AMT
 13505     END-IF
 13506     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13507                                    PY-INPUT-DT
 13508*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13509*                                   PY-INPUT-DT
 13510     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13511     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13512     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13513     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13514     IF PB-CARRIER = '2'
 13515        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13516     ELSE
 13517        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13518     END-IF
 13519     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13520                                    PY-BILLED-DATE
 13521                                    PY-AR-DATE
 13522                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 246
* EL6311.cbl
 13523                                    PY-CHECK-WRITTEN-DT
 13524     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13525                                    PY-CHECK-QUE-SEQUENCE
 13526     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13527     PERFORM WITH TEST AFTER
 13528        UNTIL (NOT RESP-DUPKEY)
 13529           AND (NOT RESP-DUPREC)
 13530
 13531* EXEC CICS WRITE
 13532*          DATASET    (FILE-ID-ERPYAJ)
 13533*          FROM       (PENDING-PAY-ADJ)
 13534*          RIDFLD     (ERPYAJ-KEY)
 13535*          RESP       (WS-RESPONSE)
 13536*       END-EXEC
 13537     MOVE LENGTH OF
 13538      PENDING-PAY-ADJ
 13539       TO DFHEIV11
 13540*    MOVE '&$ L                  ''  N#00012339' TO DFHEIV0
 13541     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13542     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13543     MOVE X'204E233030303132333339' TO DFHEIV0(25:11)
 13544     CALL 'kxdfhei1' USING DFHEIV0,
 13545           FILE-ID-ERPYAJ,
 13546           PENDING-PAY-ADJ,
 13547           DFHEIV11,
 13548           ERPYAJ-KEY,
 13549           DFHEIV99,
 13550           DFHEIV99
 13551     MOVE EIBRESP  TO WS-RESPONSE
 13552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13553        IF RESP-DUPKEY OR RESP-DUPREC
 13554           ADD +1                TO ERPYAJ-SEQ-NO
 13555           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13556        END-IF
 13557     END-PERFORM
 13558     .
 13559 1610-EXIT.
 13560     EXIT.
 13561 1620-ADD-ERPYAJ-DLR-REC.
 13562     MOVE 'C'                    TO ERPYAJ-TYPE
 13563     IF REVERSAL
 13564        MOVE 'R'                 TO ERPYAJ-TYPE
 13565     END-IF
 13566     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13567                                    ERPYAJ-ACCOUNT
 13568     ADD +1                      TO ERPYAJ-SEQ-NO
 13569     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13570     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13571     IF PB-CARRIER = '2'
 13572        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13573     ELSE
 13574        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13575     END-IF
 13576     PERFORM WITH TEST AFTER
 13577        UNTIL (NOT RESP-DUPKEY)
 13578           AND (NOT RESP-DUPREC)
 13579
 13580* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 247
* EL6311.cbl
 13581*          DATASET    (FILE-ID-ERPYAJ)
 13582*          FROM       (PENDING-PAY-ADJ)
 13583*          RIDFLD     (ERPYAJ-KEY)
 13584*          RESP       (WS-RESPONSE)
 13585*       END-EXEC
 13586     MOVE LENGTH OF
 13587      PENDING-PAY-ADJ
 13588       TO DFHEIV11
 13589*    MOVE '&$ L                  ''  N#00012371' TO DFHEIV0
 13590     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13591     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13592     MOVE X'204E233030303132333731' TO DFHEIV0(25:11)
 13593     CALL 'kxdfhei1' USING DFHEIV0,
 13594           FILE-ID-ERPYAJ,
 13595           PENDING-PAY-ADJ,
 13596           DFHEIV11,
 13597           ERPYAJ-KEY,
 13598           DFHEIV99,
 13599           DFHEIV99
 13600     MOVE EIBRESP  TO WS-RESPONSE
 13601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13602        IF RESP-DUPKEY OR RESP-DUPREC
 13603           ADD +1                TO ERPYAJ-SEQ-NO
 13604           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13605        END-IF
 13606     END-PERFORM
 13607     .
 13608 1620-EXIT.
 13609     EXIT.
 13610 1700-SQUEEZE-IT-IN.
 13611     IF (N1 > CN-BILLING-END-LINE-NO)
 13612        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13613           N1 = +1
 13614           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13615           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13616              IF PI-COMPANY-ID = 'DCC'
 13617                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13618              ELSE
 13619                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13620              END-IF
 13621              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13622              MOVE +2 TO N1
 13623           END-IF
 13624        END-PERFORM
 13625     ELSE
 13626        IF (N1 < CN-BILLING-START-LINE-NO)
 13627           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13628              N1 = +10
 13629              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13630              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13631                 IF PI-COMPANY-ID = 'DCC'
 13632                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13633                 ELSE
 13634                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13635                 END-IF
 13636                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13637                 MOVE +9 TO N1
 13638              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 248
* EL6311.cbl
 13639           END-PERFORM
 13640        END-IF
 13641     END-IF
 13642     .
 13643 1700-EXIT.
 13644     EXIT.
 13645 1800-REMOVE-CERT-NOTES.
 13646     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13647                                 TO ERNOTE-KEY
 13648
 13649* EXEC CICS READ
 13650*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13651*       DATASET    (FILE-ID-ERNOTE)
 13652*       RIDFLD     (ERNOTE-KEY)
 13653*       RESP       (WS-RESPONSE)
 13654*       UPDATE
 13655*    END-EXEC
 13656*    MOVE '&"S        EU         (  N#00012423' TO DFHEIV0
 13657     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13658     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13659     MOVE X'204E233030303132343233' TO DFHEIV0(25:11)
 13660     CALL 'kxdfhei1' USING DFHEIV0,
 13661           FILE-ID-ERNOTE,
 13662           DFHEIV20,
 13663           DFHEIV99,
 13664           ERNOTE-KEY,
 13665           DFHEIV99,
 13666           DFHEIV99,
 13667           DFHEIV99
 13668     SET ADDRESS OF CERTIFICATE-NOTE TO
 13669         DFHEIV20
 13670     MOVE EIBRESP  TO WS-RESPONSE
 13671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13672     IF RESP-NORMAL
 13673        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13674           (N1 > +10)
 13675           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13676           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13677        END-PERFORM
 13678        IF N1 < +11
 13679           MOVE SPACES              TO CN-LINE (N1)
 13680           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13681              N1 <= CN-BILLING-END-LINE-NO
 13682              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13683              IF CN-BILLING-END-LINE-NO <
 13684                               CN-BILLING-START-LINE-NO
 13685                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13686                                     CN-BILLING-START-LINE-NO
 13687              END-IF
 13688              PERFORM 1820-SQUEEZE-ERNOTE
 13689                                  THRU 1820-EXIT
 13690           END-IF
 13691           IF CN-LINES = SPACES
 13692
 13693* EXEC CICS DELETE
 13694*                DATASET    (FILE-ID-ERNOTE)
 13695*                RESP       (WS-RESPONSE)
 13696*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 249
* EL6311.cbl
 13697*    MOVE '&(                    &  N#00012450' TO DFHEIV0
 13698     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13699     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13700     MOVE X'204E233030303132343530' TO DFHEIV0(25:11)
 13701     CALL 'kxdfhei1' USING DFHEIV0,
 13702           FILE-ID-ERNOTE,
 13703           DFHEIV99,
 13704           DFHEIV99,
 13705           DFHEIV99,
 13706           DFHEIV99
 13707     MOVE EIBRESP  TO WS-RESPONSE
 13708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13709              IF RESP-NORMAL
 13710                 MOVE 'D'        TO WS-NOTE-SW
 13711                 PERFORM 1520-UPDATE-ELCERT
 13712                                 THRU 1520-EXIT
 13713              END-IF
 13714           ELSE
 13715
 13716* EXEC CICS REWRITE
 13717*                DATASET    (FILE-ID-ERNOTE)
 13718*                FROM       (CERTIFICATE-NOTE)
 13719*                RESP       (WS-RESPONSE)
 13720*             END-EXEC
 13721     MOVE LENGTH OF
 13722      CERTIFICATE-NOTE
 13723       TO DFHEIV11
 13724*    MOVE '&& L                  %  N#00012460' TO DFHEIV0
 13725     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13726     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13727     MOVE X'204E233030303132343630' TO DFHEIV0(25:11)
 13728     CALL 'kxdfhei1' USING DFHEIV0,
 13729           FILE-ID-ERNOTE,
 13730           CERTIFICATE-NOTE,
 13731           DFHEIV11,
 13732           DFHEIV99
 13733     MOVE EIBRESP  TO WS-RESPONSE
 13734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13735           END-IF
 13736        END-IF
 13737     END-IF
 13738     .
 13739 1800-EXIT.
 13740     EXIT.
 13741 1820-SQUEEZE-ERNOTE.
 13742     MOVE CN-BILLING-START-LINE-NO TO N2
 13743     IF N2 = 0
 13744         MOVE +1                 TO N2
 13745     END-IF
 13746     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13747        (N1 > +9)
 13748        IF CN-LINE (N1) = SPACES
 13749           MOVE CN-LINE (N1 + +1)
 13750                                 TO CN-LINE (N1)
 13751           MOVE SPACES           TO CN-LINE (N1 + +1)
 13752        END-IF
 13753     END-PERFORM
 13754     .
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 250
* EL6311.cbl
 13755 1820-EXIT.
 13756     EXIT.
 13757 1900-DELETE-ERPYAJ.
 13758     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13759     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13760     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13761     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13762     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13763     MOVE +10                    TO ERPYAJ-SEQ-NO
 13764     MOVE 'R'                    TO ERPYAJ-TYPE
 13765     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13766
 13767* EXEC CICS STARTBR
 13768*       DATASET    (FILE-ID-ERPYAJ)
 13769*       RIDFLD     (ERPYAJ-KEY)
 13770*       RESP       (WS-RESPONSE)
 13771*    END-EXEC
 13772     MOVE 0
 13773       TO DFHEIV11
 13774*    MOVE '&,         G          &  N#00012496' TO DFHEIV0
 13775     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13776     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13777     MOVE X'204E233030303132343936' TO DFHEIV0(25:11)
 13778     CALL 'kxdfhei1' USING DFHEIV0,
 13779           FILE-ID-ERPYAJ,
 13780           ERPYAJ-KEY,
 13781           DFHEIV99,
 13782           DFHEIV11,
 13783           DFHEIV99
 13784     MOVE EIBRESP  TO WS-RESPONSE
 13785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13786     IF RESP-NORMAL
 13787        CONTINUE
 13788     ELSE
 13789        GO TO 1900-GET-DEALER
 13790     END-IF
 13791     .
 13792 1900-READNEXT-ERPYAJ-B.
 13793*  GET THE BANK ERPYAJ RECORD
 13794
 13795* EXEC CICS READNEXT
 13796*       DATASET    (FILE-ID-ERPYAJ)
 13797*       RIDFLD     (ERPYAJ-KEY)
 13798*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13799*       RESP       (WS-RESPONSE)
 13800*    END-EXEC
 13801     MOVE 0
 13802       TO DFHEIV11
 13803*    MOVE '&.S                   )  N#00012509' TO DFHEIV0
 13804     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13805     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13806     MOVE X'204E233030303132353039' TO DFHEIV0(25:11)
 13807     CALL 'kxdfhei1' USING DFHEIV0,
 13808           FILE-ID-ERPYAJ,
 13809           DFHEIV20,
 13810           DFHEIV99,
 13811           ERPYAJ-KEY,
 13812           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 251
* EL6311.cbl
 13813           DFHEIV11,
 13814           DFHEIV99,
 13815           DFHEIV99
 13816     SET ADDRESS OF PENDING-PAY-ADJ TO
 13817         DFHEIV20
 13818     MOVE EIBRESP  TO WS-RESPONSE
 13819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13820     IF RESP-NORMAL
 13821        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13822           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13823              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13824                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13825
 13826* EXEC CICS READ
 13827*                   DATASET    (FILE-ID-ERPYAJ)
 13828*                   RIDFLD     (ERPYAJ-KEY)
 13829*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13830*                   RESP       (WS-RESPONSE)
 13831*                   UPDATE
 13832*                END-EXEC
 13833*    MOVE '&"S        EU         (  N#00012520' TO DFHEIV0
 13834     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13835     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13836     MOVE X'204E233030303132353230' TO DFHEIV0(25:11)
 13837     CALL 'kxdfhei1' USING DFHEIV0,
 13838           FILE-ID-ERPYAJ,
 13839           DFHEIV20,
 13840           DFHEIV99,
 13841           ERPYAJ-KEY,
 13842           DFHEIV99,
 13843           DFHEIV99,
 13844           DFHEIV99
 13845     SET ADDRESS OF PENDING-PAY-ADJ TO
 13846         DFHEIV20
 13847     MOVE EIBRESP  TO WS-RESPONSE
 13848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13849                 IF RESP-NORMAL
 13850
 13851* EXEC CICS DELETE
 13852*                      DATASET   (FILE-ID-ERPYAJ)
 13853*                      RESP      (WS-RESPONSE)
 13854*                   END-EXEC
 13855*    MOVE '&(                    &  N#00012528' TO DFHEIV0
 13856     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13857     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13858     MOVE X'204E233030303132353238' TO DFHEIV0(25:11)
 13859     CALL 'kxdfhei1' USING DFHEIV0,
 13860           FILE-ID-ERPYAJ,
 13861           DFHEIV99,
 13862           DFHEIV99,
 13863           DFHEIV99,
 13864           DFHEIV99
 13865     MOVE EIBRESP  TO WS-RESPONSE
 13866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13867                 END-IF
 13868              ELSE
 13869                 SET REVERSAL    TO TRUE
 13870                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 252
* EL6311.cbl
 13871                                 THRU 1600-EXIT
 13872                 GO TO 1900-EXIT
 13873              END-IF
 13874           ELSE
 13875              GO TO 1900-READNEXT-ERPYAJ-B
 13876           END-IF
 13877        END-IF
 13878
 13879* EXEC CICS ENDBR
 13880*          DATASET   (FILE-ID-ERPYAJ)
 13881*       END-EXEC
 13882     MOVE 0
 13883       TO DFHEIV11
 13884*    MOVE '&2                    $   #00012543' TO DFHEIV0
 13885     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13886     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13887     MOVE X'2020233030303132353433' TO DFHEIV0(25:11)
 13888     CALL 'kxdfhei1' USING DFHEIV0,
 13889           FILE-ID-ERPYAJ,
 13890           DFHEIV11,
 13891           DFHEIV99
 13892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13893     END-IF
 13894     .
 13895 1900-GET-DEALER.
 13896     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13897     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13898     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13899     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13900     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13901     MOVE +10                    TO ERPYAJ-SEQ-NO
 13902     MOVE 'C'                    TO ERPYAJ-TYPE
 13903     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13904
 13905* EXEC CICS STARTBR
 13906*       DATASET    (FILE-ID-ERPYAJ)
 13907*       RIDFLD     (ERPYAJ-KEY)
 13908*       RESP       (WS-RESPONSE)
 13909*    END-EXEC
 13910     MOVE 0
 13911       TO DFHEIV11
 13912*    MOVE '&,         G          &  N#00012557' TO DFHEIV0
 13913     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13914     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13915     MOVE X'204E233030303132353537' TO DFHEIV0(25:11)
 13916     CALL 'kxdfhei1' USING DFHEIV0,
 13917           FILE-ID-ERPYAJ,
 13918           ERPYAJ-KEY,
 13919           DFHEIV99,
 13920           DFHEIV11,
 13921           DFHEIV99
 13922     MOVE EIBRESP  TO WS-RESPONSE
 13923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13924     IF RESP-NORMAL
 13925        CONTINUE
 13926     ELSE
 13927        GO TO 1900-EXIT
 13928     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 253
* EL6311.cbl
 13929     .
 13930 1900-READNEXT-ERPYAJ-D.
 13931*  GET THE DEALER ERPYAJ RECORD
 13932
 13933* EXEC CICS READNEXT
 13934*       DATASET    (FILE-ID-ERPYAJ)
 13935*       RIDFLD     (ERPYAJ-KEY)
 13936*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13937*       RESP       (WS-RESPONSE)
 13938*    END-EXEC
 13939     MOVE 0
 13940       TO DFHEIV11
 13941*    MOVE '&.S                   )  N#00012570' TO DFHEIV0
 13942     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13943     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13944     MOVE X'204E233030303132353730' TO DFHEIV0(25:11)
 13945     CALL 'kxdfhei1' USING DFHEIV0,
 13946           FILE-ID-ERPYAJ,
 13947           DFHEIV20,
 13948           DFHEIV99,
 13949           ERPYAJ-KEY,
 13950           DFHEIV99,
 13951           DFHEIV11,
 13952           DFHEIV99,
 13953           DFHEIV99
 13954     SET ADDRESS OF PENDING-PAY-ADJ TO
 13955         DFHEIV20
 13956     MOVE EIBRESP  TO WS-RESPONSE
 13957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13958     IF RESP-NORMAL
 13959        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13960           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13961              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13962                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13963
 13964* EXEC CICS READ
 13965*                   DATASET    (FILE-ID-ERPYAJ)
 13966*                   RIDFLD     (ERPYAJ-KEY)
 13967*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13968*                   RESP       (WS-RESPONSE)
 13969*                   UPDATE
 13970*                END-EXEC
 13971*    MOVE '&"S        EU         (  N#00012581' TO DFHEIV0
 13972     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13973     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13974     MOVE X'204E233030303132353831' TO DFHEIV0(25:11)
 13975     CALL 'kxdfhei1' USING DFHEIV0,
 13976           FILE-ID-ERPYAJ,
 13977           DFHEIV20,
 13978           DFHEIV99,
 13979           ERPYAJ-KEY,
 13980           DFHEIV99,
 13981           DFHEIV99,
 13982           DFHEIV99
 13983     SET ADDRESS OF PENDING-PAY-ADJ TO
 13984         DFHEIV20
 13985     MOVE EIBRESP  TO WS-RESPONSE
 13986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 254
* EL6311.cbl
 13987                 IF RESP-NORMAL
 13988
 13989* EXEC CICS DELETE
 13990*                      DATASET   (FILE-ID-ERPYAJ)
 13991*                      RESP      (WS-RESPONSE)
 13992*                   END-EXEC
 13993*    MOVE '&(                    &  N#00012589' TO DFHEIV0
 13994     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13995     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13996     MOVE X'204E233030303132353839' TO DFHEIV0(25:11)
 13997     CALL 'kxdfhei1' USING DFHEIV0,
 13998           FILE-ID-ERPYAJ,
 13999           DFHEIV99,
 14000           DFHEIV99,
 14001           DFHEIV99,
 14002           DFHEIV99
 14003     MOVE EIBRESP  TO WS-RESPONSE
 14004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14005                 END-IF
 14006              ELSE
 14007                 SET REVERSAL    TO TRUE
 14008              END-IF
 14009           ELSE
 14010              GO TO 1900-READNEXT-ERPYAJ-D
 14011           END-IF
 14012        END-IF
 14013
 14014* EXEC CICS ENDBR
 14015*          DATASET   (FILE-ID-ERPYAJ)
 14016*       END-EXEC
 14017     MOVE 0
 14018       TO DFHEIV11
 14019*    MOVE '&2                    $   #00012601' TO DFHEIV0
 14020     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14021     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14022     MOVE X'2020233030303132363031' TO DFHEIV0(25:11)
 14023     CALL 'kxdfhei1' USING DFHEIV0,
 14024           FILE-ID-ERPYAJ,
 14025           DFHEIV11,
 14026           DFHEIV99
 14027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14028     END-IF
 14029     .
 14030 1900-EXIT.
 14031     EXIT.
 14032******************************************************************
 14033*            C A N C E L   M A I N L I N E                       *
 14034******************************************************************
 14035
 14036 2000-CANCEL-MAINLINE.
 14037     IF PI-DISPLAY-ORIGINAL-BATCH
 14038        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14039           MOVE ER-0023             TO EMI-ERROR
 14040           MOVE -1                  TO CMAINTL
 14041           MOVE AL-UABON            TO CMAINTA
 14042           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14043           GO TO 8200-SEND-DATAONLY
 14044        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 255
* EL6311.cbl
 14045           NEXT SENTENCE
 14046     ELSE
 14047        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14048           MOVE ER-0023             TO EMI-ERROR
 14049           MOVE -1                  TO CMAINTL
 14050           MOVE AL-UABON            TO CMAINTA
 14051           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14052           GO TO 8200-SEND-DATAONLY.
 14053
 14054     IF CMAINTI = 'S'
 14055        GO TO 2100-SHOW-REQUEST.
 14056
 14057     IF NOT MODIFY-CAP
 14058         MOVE 'UPDATE'       TO SM-READ
 14059         PERFORM 9995-SECURITY-VIOLATION
 14060         MOVE ER-0070        TO EMI-ERROR
 14061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14062         GO TO 8100-SEND-INITIAL-MAP.
 14063
 14064     IF CMAINTL GREATER THAN ZEROS
 14065        IF PI-PF6-FUNCTION
 14066           IF CMAINTI NOT = 'A'
 14067              MOVE AL-UABON  TO CMAINTA
 14068              MOVE -1        TO CMAINTL
 14069              MOVE ER-2260   TO EMI-ERROR
 14070              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14071              GO TO 8200-SEND-DATAONLY.
 14072
 14073     IF CCERTNOL = ZEROS
 14074       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14075         NEXT SENTENCE
 14076     ELSE
 14077         IF CCERTNOL NOT = ZEROS
 14078             MOVE AL-UANON       TO CCERTNOA
 14079         ELSE
 14080             MOVE -1             TO CCERTNOL
 14081             MOVE  1             TO SET-CURSOR-SW
 14082             MOVE ER-2218       TO EMI-ERROR
 14083             MOVE AL-UABON       TO CCERTNOA
 14084             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14085
 14086     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14087        NEXT SENTENCE
 14088     ELSE
 14089        IF CEFFDTL NOT = ZEROS
 14090           MOVE AL-UNNON         TO CEFFDTA
 14091           MOVE CEFFDTI TO DEEDIT-FIELD
 14092           PERFORM 8600-DEEDIT
 14093           MOVE 4                TO DC-OPTION-CODE
 14094           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14095           PERFORM 9700-DATE-LINK
 14096           IF NO-CONVERSION-ERROR
 14097              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14098              ELSE
 14099              MOVE -1            TO CEFFDTL
 14100              MOVE  1            TO SET-CURSOR-SW
 14101              MOVE ER-2226      TO EMI-ERROR
 14102              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 256
* EL6311.cbl
 14103              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14104          ELSE
 14105          MOVE -1                 TO CEFFDTL
 14106          MOVE  1                 TO SET-CURSOR-SW
 14107          MOVE ER-2220            TO EMI-ERROR
 14108          MOVE AL-UNBON           TO CEFFDTA
 14109          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14110
 14111     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14112
 14113     IF CCERTNOL NOT = ZEROS
 14114        MOVE CCERTNOI                TO WS-NEW-PRIME
 14115     ELSE
 14116        MOVE SPACES                  TO WS-NEW-PRIME.
 14117
 14118     IF CSUFIXL NOT = ZEROS
 14119        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14120     ELSE
 14121        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14122
 14123     IF CEFFDTL NOT = ZEROS
 14124        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14125     ELSE
 14126        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14127
 14128     IF CMAINTI = 'A' OR 'K' OR 'S'
 14129        NEXT SENTENCE
 14130     ELSE
 14131        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14132        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14133           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14134           WS-PB-RECORD-TYPE NOT = '2'
 14135           IF CMAINTI = 'C'
 14136              MOVE ER-2287          TO EMI-ERROR
 14137              MOVE -1               TO CCERTNOL
 14138              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14139              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14140              GO TO 8200-SEND-DATAONLY
 14141             ELSE
 14142              MOVE ER-2260          TO EMI-ERROR
 14143              MOVE -1               TO CCERTNOL
 14144              MOVE AL-UABON         TO CCERTNOA
 14145              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14146              GO TO 8200-SEND-DATAONLY.
 14147
 14148     IF CMAINTI = 'D'
 14149        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14150
 14151     IF CLSTNML GREATER THAN ZEROS
 14152         MOVE AL-UANON           TO CLSTNMA.
 14153
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 257
* EL6311.cbl
 14155
 14156******************************************************************
 14157*                                                                *
 14158*           E D I T   C A N C E L   C O V E R A G E S            *
 14159*                                                                *
 14160******************************************************************
 14161
 14162 2015-EDIT-COVERAGES.
 14163     IF CCANDT1L      GREATER THAN ZEROS OR
 14164        CREFND1L      GREATER THAN ZEROS OR
 14165        CCANDT2L      GREATER THAN ZEROS OR
 14166        CREFND2L      GREATER THAN ZEROS OR
 14167        CMTHD1L       GREATER THAN ZEROS OR
 14168        CMTHD2L       GREATER THAN ZEROS OR
 14169        CLIVESL       GREATER THAN ZEROS OR
 14170        CPAYEEL       GREATER THAN ZEROS OR
 14171        CFORCEL       GREATER THAN ZEROS OR
 14172        CBILCDL       GREATER THAN ZEROS OR
 14173        CCANREAL      GREATER THAN ZEROS
 14174            NEXT SENTENCE
 14175         ELSE
 14176            GO TO 2030-EDIT-COMPLETE.
 14177
 14178     IF CCANDT1L = ZEROS
 14179        AND (CMAINTI = 'C' OR 'K')
 14180        NEXT SENTENCE
 14181     ELSE
 14182        IF CCANDT1L      GREATER THAN ZEROS
 14183            MOVE AL-UNNON            TO CCANDT1A
 14184            IF CCANDT1I = SPACES
 14185               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14186            ELSE
 14187               MOVE CCANDT1I            TO DEEDIT-FIELD
 14188               PERFORM 8600-DEEDIT
 14189               IF DEEDIT-FIELD-V0   NUMERIC
 14190                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14191                  MOVE 4                TO DC-OPTION-CODE
 14192                  PERFORM 9700-DATE-LINK
 14193                  IF NO-CONVERSION-ERROR
 14194                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14195                  ELSE
 14196                      MOVE -1        TO CCANDT1L
 14197                      MOVE ER-2227   TO EMI-ERROR
 14198                      MOVE AL-UNBON  TO CCANDT1A
 14199                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14200               ELSE
 14201                  MOVE -1         TO CCANDT1L
 14202                  MOVE ER-2223    TO EMI-ERROR
 14203                  MOVE AL-UNBON   TO CCANDT1A
 14204                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14205        ELSE
 14206            IF CREFND1L GREATER THAN ZEROS
 14207               MOVE -1             TO CCANDT1L
 14208               MOVE ER-2222        TO EMI-ERROR
 14209               MOVE AL-UNBOF       TO CCANDT1A
 14210               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14211
 14212     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 258
* EL6311.cbl
 14213        AND (CMAINTI = 'C' OR 'K')
 14214         NEXT SENTENCE
 14215     ELSE
 14216         IF CREFND1L NOT = ZEROS
 14217            MOVE AL-UNNON        TO CREFND1A
 14218
 14219* EXEC CICS BIF DEEDIT
 14220*               FIELD  (CREFND1I)
 14221*               LENGTH (11)
 14222*           END-EXEC
 14223     MOVE 11
 14224       TO DFHEIV11
 14225*    MOVE '@"L                   #   #00012794' TO DFHEIV0
 14226     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14227     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14228     MOVE X'2020233030303132373934' TO DFHEIV0(25:11)
 14229     CALL 'kxdfhei1' USING DFHEIV0,
 14230           CREFND1I,
 14231           DFHEIV11
 14232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14233            MOVE CREFND1I        TO WS-CREFND1
 14234*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14235*           PERFORM 8600-DEEDIT
 14236*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14237            IF WS-CREFND1  = ZEROS
 14238               AND CMAINTI = 'A'
 14239             MOVE ER-2437        TO EMI-ERROR
 14240             MOVE -1             TO CREFND1L
 14241             MOVE AL-UNBON       TO CREFND1A
 14242             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14243
 14244     IF CCANREAL > +0
 14245        MOVE AL-UANON            TO CCANREAA
 14246        IF CCANREAI = 'R' OR ' '
 14247           CONTINUE
 14248        ELSE
 14249           MOVE ER-9841        TO EMI-ERROR
 14250           MOVE -1             TO CCANREAL
 14251           MOVE AL-UABON       TO CCANREAA
 14252           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14253        END-IF
 14254     END-IF
 14255     IF CMTHD1L EQUAL +0
 14256        NEXT SENTENCE
 14257     ELSE
 14258        IF CMTHD1L NOT = +0
 14259           MOVE AL-UNNON        TO CMTHD1A
 14260           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14261                         OR '5' OR '6' OR '8' OR '9'
 14262                         OR 'R' OR ' '
 14263              NEXT SENTENCE
 14264           ELSE
 14265              MOVE ER-0582        TO EMI-ERROR
 14266              MOVE -1             TO CMTHD1L
 14267              MOVE AL-UNBON       TO CMTHD1A
 14268              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14269
 14270     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 259
* EL6311.cbl
 14271        AND (CMAINTI = 'C' OR 'K')
 14272         NEXT SENTENCE
 14273     ELSE
 14274         IF CCANDT2L  GREATER THAN ZEROS
 14275             MOVE AL-UNNON       TO CCANDT2A
 14276             IF CCANDT2I = SPACES
 14277                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14278             ELSE
 14279                MOVE CCANDT2I       TO DEEDIT-FIELD
 14280                PERFORM 8600-DEEDIT
 14281                IF DEEDIT-FIELD-V0   NUMERIC
 14282                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14283                   MOVE 4                TO DC-OPTION-CODE
 14284                   PERFORM 9700-DATE-LINK
 14285                   IF NO-CONVERSION-ERROR
 14286                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14287                   ELSE
 14288                      MOVE -1       TO CCANDT2L
 14289                      MOVE ER-2227  TO EMI-ERROR
 14290                      MOVE AL-UNBON TO CCANDT2A
 14291                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14292                ELSE
 14293                   MOVE -1         TO CCANDT2L
 14294                   MOVE ER-2223    TO EMI-ERROR
 14295                   MOVE AL-UNBON   TO CCANDT2A
 14296                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14297         ELSE
 14298            IF CREFND2L GREATER THAN ZEROS
 14299               MOVE -1             TO CCANDT2L
 14300               MOVE ER-2222        TO EMI-ERROR
 14301               MOVE AL-UNBOF       TO CCANDT2A
 14302               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14303
 14304     IF CREFND2L = ZEROS
 14305        AND (CMAINTI = 'C' OR 'K')
 14306         NEXT SENTENCE
 14307     ELSE
 14308         IF CREFND2L NOT = ZEROS
 14309            MOVE AL-UNNON        TO CREFND2A
 14310
 14311* EXEC CICS BIF DEEDIT
 14312*               FIELD  (CREFND2I)
 14313*               LENGTH (11)
 14314*           END-EXEC
 14315     MOVE 11
 14316       TO DFHEIV11
 14317*    MOVE '@"L                   #   #00012875' TO DFHEIV0
 14318     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14319     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14320     MOVE X'2020233030303132383735' TO DFHEIV0(25:11)
 14321     CALL 'kxdfhei1' USING DFHEIV0,
 14322           CREFND2I,
 14323           DFHEIV11
 14324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14325            MOVE CREFND2I        TO WS-CREFND2
 14326*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14327*           PERFORM 8600-DEEDIT
 14328*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 260
* EL6311.cbl
 14329            IF WS-CREFND2  = ZEROS
 14330               AND CMAINTI = 'A'
 14331             MOVE ER-2437        TO EMI-ERROR
 14332             MOVE -1             TO CREFND2L
 14333             MOVE AL-UNBON       TO CREFND2A
 14334             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14335
 14336     IF CMTHD2L EQUAL +0
 14337        NEXT SENTENCE
 14338     ELSE
 14339        IF CMTHD2L NOT = +0
 14340           MOVE AL-UNNON        TO CMTHD2A
 14341           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14342                         OR '5' OR '6' OR '8' OR '9'
 14343                         OR ' ' OR 'R'
 14344              NEXT SENTENCE
 14345           ELSE
 14346              MOVE ER-0582        TO EMI-ERROR
 14347              MOVE -1             TO CMTHD2L
 14348              MOVE AL-UNBON       TO CMTHD2A
 14349              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14350
 14351     IF CLIVESL GREATER THAN ZEROS
 14352         MOVE CLIVESI            TO DEEDIT-FIELD
 14353         PERFORM 8600-DEEDIT
 14354         IF DEEDIT-FIELD-V0 NUMERIC
 14355             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14356             MOVE AL-UNNON       TO CLIVESA
 14357         ELSE
 14358             MOVE -1             TO CLIVESL
 14359             MOVE AL-UNBON       TO CLIVESA
 14360             MOVE ER-2223        TO EMI-ERROR
 14361             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14362
 14363     IF CFORCEL  NOT = ZEROS
 14364         IF FORCE-CAP
 14365            MOVE AL-UANON            TO CFORCEA
 14366         ELSE
 14367            MOVE ER-2945             TO EMI-ERROR
 14368            MOVE AL-UABON            TO CFORCEA
 14369            MOVE -1                  TO CFORCEL
 14370            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14371
 14372     IF CPAYEEL GREATER THAN ZEROS
 14373        MOVE AL-UANON            TO CPAYEEA.
 14374
 14375     IF CBILCDL NOT = ZEROS
 14376        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14377                             AND 'A' AND 'B' AND 'E'
 14378           MOVE ER-2225              TO EMI-ERROR
 14379           MOVE AL-UABON             TO CBILCDA
 14380           MOVE -1                   TO CBILCDL
 14381           MOVE  1                   TO SET-CURSOR-SW
 14382           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14383        ELSE
 14384           MOVE AL-UANON             TO CBILCDA.
 14385
 14386 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 261
* EL6311.cbl
 14387     IF EMI-ERROR = ZEROS
 14388         NEXT SENTENCE
 14389     ELSE
 14390         GO TO 8200-SEND-DATAONLY.
 14391
 14392     IF CMAINTI = 'A'
 14393        GO TO 2200-ADD-CANCEL-ROUTINE.
 14394
 14395     IF CMAINTI = 'C'
 14396        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14397
 14398     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14399
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 262
* EL6311.cbl
 14401
 14402******************************************************************
 14403*                                                                *
 14404*                   S H O W   C A N C E L                        *
 14405*                                                                *
 14406******************************************************************
 14407
 14408 2100-SHOW-REQUEST.
 14409     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14410
 14411     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14412        MOVE -1                  TO CMAINTL
 14413        GO TO 8200-SEND-DATAONLY.
 14414
 14415     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14416
 14417     IF CSUFIXL NOT = ZEROS
 14418        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14419       ELSE
 14420        MOVE SPACE            TO WS-NEW-SUFFIX.
 14421
 14422     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14423     PERFORM 8600-DEEDIT.
 14424     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14425     MOVE '4'                    TO DC-OPTION-CODE.
 14426     PERFORM 9700-DATE-LINK.
 14427     IF DATE-CONVERSION-ERROR
 14428        MOVE ER-0348             TO EMI-ERROR
 14429        MOVE -1                  TO CEFFDTL
 14430        MOVE AL-UABON            TO CEFFDTA
 14431        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14432        GO TO 8200-SEND-DATAONLY
 14433     ELSE
 14434        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14435        MOVE AL-UANON            TO CEFFDTA
 14436        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14437
 14438     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14439
 14440     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14441        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14442        MOVE 'Y'                    TO WS-SHOW-SW
 14443        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14444           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14445        ELSE
 14446           IF PI-FILE-BROWSE
 14447              GO TO 4300-BROWSE-FILE-FORWARD
 14448           ELSE
 14449              IF PI-CSR-BROWSE
 14450                 GO TO 4200-BROWSE-CSR-FORWARD
 14451              ELSE
 14452                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14453     ELSE
 14454        GO TO 3900-RE-DISPLAY-RECORD.
 14455
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 263
* EL6311.cbl
 14457
 14458
 14459******************************************************************
 14460*                                                                *
 14461*            A D D   C A N C E L   R O U T I N E                 *
 14462*                                                                *
 14463******************************************************************
 14464
 14465 2200-ADD-CANCEL-ROUTINE.
 14466     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14467
 14468
 14469* EXEC CICS GETMAIN
 14470*        SET     (ADDRESS OF PENDING-BUSINESS)
 14471*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14472*    END-EXEC.
 14473*    MOVE '," L                  $   #00013022' TO DFHEIV0
 14474     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14475     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14476     MOVE X'2020233030303133303232' TO DFHEIV0(25:11)
 14477     CALL 'kxdfhei1' USING DFHEIV0,
 14478           DFHEIV20,
 14479           ERPNDB-RECORD-LENGTH,
 14480           DFHEIV99
 14481     SET ADDRESS OF PENDING-BUSINESS TO
 14482         DFHEIV20
 14483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14484
 14485
 14486
 14487* EXEC CICS HANDLE CONDITION
 14488*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14489*    END-EXEC.
 14490*    MOVE '"$I                   ! 3 #00013027' TO DFHEIV0
 14491     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14492     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14493     MOVE X'3320233030303133303237' TO DFHEIV0(25:11)
 14494     CALL 'kxdfhei1' USING DFHEIV0
 14495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14496
 14497
 14498     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14499     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14500     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14501
 14502
 14503* EXEC CICS READ
 14504*        INTO    (PENDING-BUSINESS)
 14505*        DATASET (FILE-ID-ERPNDB)
 14506*        RIDFLD  (ERPNDB-KEY)
 14507*    END-EXEC.
 14508     MOVE LENGTH OF
 14509      PENDING-BUSINESS
 14510       TO DFHEIV11
 14511*    MOVE '&"IL       E          (   #00013035' TO DFHEIV0
 14512     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14514     MOVE X'2020233030303133303335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 264
* EL6311.cbl
 14515     CALL 'kxdfhei1' USING DFHEIV0,
 14516           FILE-ID-ERPNDB,
 14517           PENDING-BUSINESS,
 14518           DFHEIV11,
 14519           ERPNDB-KEY,
 14520           DFHEIV99,
 14521           DFHEIV99,
 14522           DFHEIV99
 14523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14524
 14525
 14526     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14527
 14528     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14529     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14530     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14531     MOVE SPACES                 TO PENDING-BUSINESS.
 14532     MOVE 'PB'                   TO PB-RECORD-ID.
 14533     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14534     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14535     MOVE SPACES                 TO PB-CERT-SFX.
 14536     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14537     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14538                                    PB-ALT-CHG-SEQ-NO.
 14539
 14540     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14541     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14542     MOVE '2'                    TO PB-RECORD-TYPE.
 14543
 14544     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14545     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14546
 14547
 14548     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14549                                    PB-ALT-CHG-SEQ-NO
 14550                                    PB-C-LF-REF-CALC
 14551                                    PB-C-AH-REF-CALC
 14552                                    PB-C-LF-RFND-CLP
 14553                                    PB-C-AH-RFND-CLP
 14554                                    PB-CI-INSURED-AGE
 14555                                    PB-CI-LF-TERM
 14556                                    PB-CI-AH-TERM
 14557                                    PB-CI-LF-BENEFIT-CD
 14558                                    PB-CI-LF-BENEFIT-AMT
 14559                                    PB-CI-LF-ALT-BENEFIT-AMT
 14560                                    PB-CI-LF-PREMIUM-AMT
 14561                                    PB-CI-LF-ALT-PREMIUM-AMT
 14562                                    PB-CI-AH-BENEFIT-CD
 14563                                    PB-CI-AH-BENEFIT-AMT
 14564                                    PB-CI-AH-PREMIUM-AMT
 14565                                    PB-CI-PAY-FREQUENCY
 14566                                    PB-CI-LOAN-APR
 14567                                    PB-CI-LOAN-TERM
 14568                                    PB-CI-LIFE-COMMISSION
 14569                                    PB-CI-AH-COMMISSION
 14570                                    PB-CI-CURR-SEQ
 14571                                    PB-CI-AH-CANCEL-AMT
 14572                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 265
* EL6311.cbl
 14573                                    PB-CI-RATE-DEV-PCT-LF
 14574                                    PB-CI-RATE-DEV-PCT-AH
 14575                                    PB-CI-EXTENTION-DAYS
 14576                                    PB-CI-TERM-IN-DAYS
 14577                                    PB-CI-LIVES
 14578                                    PB-CI-LF-CRIT-PER
 14579                                    PB-CI-AH-CRIT-PER
 14580                                    PB-C-LF-REM-TERM
 14581                                    PB-C-AH-REM-TERM
 14582                                    PB-CHG-COUNT
 14583                                    PB-LF-BILLED-AMTS
 14584                                    PB-AH-BILLED-AMTS
 14585                                    PB-C-NH-INT-ON-REFS
 14586*                                   PB-C-MICROFILM-NO
 14587                                    PB-CALC-TOLERANCE.
 14588
 14589     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14590                                    PB-CI-AH-SETTLEMENT-DT
 14591                                    PB-CI-DEATH-DT
 14592                                    PB-CI-LF-PRIOR-CANCEL-DT
 14593                                    PB-CI-AH-PRIOR-CANCEL-DT
 14594                                    PB-CI-ENTRY-DT
 14595                                    PB-CI-LF-EXPIRE-DT
 14596                                    PB-CI-AH-EXPIRE-DT
 14597                                    PB-CI-LOAN-1ST-PMT-DT
 14598                                    PB-C-LF-CANCEL-DT
 14599                                    PB-C-AH-CANCEL-DT
 14600                                    PB-CREDIT-ACCEPT-DT
 14601                                    PB-BILLED-DT
 14602                                    PB-ACCT-EFF-DT
 14603                                    PB-ACCT-EXP-DT.
 14604
 14605     MOVE 'X'                    TO PB-FATAL-FLAG.
 14606
 14607     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14608
 14609     IF CSUFIXL     GREATER THAN ZEROS
 14610        MOVE CSUFIXI             TO PB-CERT-SFX.
 14611
 14612*    IF CMICRNOL  GREATER  ZEROS
 14613*        IF CMICRNOI  NUMERIC
 14614*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14615*            MOVE AL-UNNON       TO  CMICRNOA
 14616*        ELSE
 14617*            MOVE -1             TO  CMICRNOL
 14618*            MOVE AL-UNBON       TO  CMICRNOA
 14619*            MOVE ER-2701        TO  EMI-ERROR
 14620*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14621
 14622     IF CLSTNML     GREATER THAN ZEROS
 14623        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14624
 14625     IF CCANREAL > ZEROS
 14626        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14627     END-IF
 14628     IF CPCYNL > ZEROS
 14629        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14630     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 266
* EL6311.cbl
 14631     IF CCANDT1L    GREATER THAN ZEROS
 14632        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14633
 14634     IF CCANDT2L    GREATER THAN ZEROS
 14635        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14636
 14637     IF CMTHD1L    GREATER THAN +0
 14638        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14639
 14640     IF CMTHD2L    GREATER THAN +0
 14641        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14642
 14643     IF CREFND1L    GREATER THAN ZEROS
 14644        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14645        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14646     ELSE
 14647        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14648
 14649     IF CREFND2L    GREATER THAN ZEROS
 14650        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14651        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14652     ELSE
 14653        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14654
 14655     IF CLIVESL     GREATER THAN ZEROS
 14656        MOVE WS-CLIVES           TO PB-C-LIVES
 14657     ELSE
 14658        MOVE ZEROS               TO PB-C-LIVES.
 14659
 14660     IF CPAYEEL     GREATER THAN ZEROS
 14661        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14662
 14663     IF CFORCEL     GREATER THAN ZEROS
 14664        MOVE CFORCEI             TO PB-FORCE-CODE.
 14665
 14666     IF CBILCDL     GREATER THAN ZEROS
 14667        MOVE CBILCDI             TO PB-RECORD-BILL.
 14668
 14669*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14670
 14671 2260-WRITE-PB-RECORD.
 14672     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14673                                    PB-INPUT-BY.
 14674     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14675     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14676                                    PB-INPUT-DT.
 14677
 14678     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14679     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14680                                    PB-CONTROL-BY-ORIG-BATCH.
 14681
 14682     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14683     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14684     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14685     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14686     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14687
 14688     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 267
* EL6311.cbl
 14689
 14690     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14691
 14692     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14693     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14694     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14695
 14696     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14697     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14698
 14699 2275-WRITE-PENDING-BUSINESS.
 14700     MOVE 'A'                    TO JP-RECORD-TYPE.
 14701     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14702     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14703     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14704
 14705
 14706* EXEC CICS HANDLE CONDITION
 14707*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14708*    END-EXEC.
 14709*    MOVE '"$%                   ! 4 #00013220' TO DFHEIV0
 14710     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14711     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14712     MOVE X'3420233030303133323230' TO DFHEIV0(25:11)
 14713     CALL 'kxdfhei1' USING DFHEIV0
 14714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14715
 14716
 14717
 14718* EXEC CICS WRITE
 14719*        DATASET (FILE-ID-ERPNDB)
 14720*        FROM    (PENDING-BUSINESS)
 14721*        RIDFLD  (PB-CONTROL-PRIMARY)
 14722*    END-EXEC.
 14723     MOVE LENGTH OF
 14724      PENDING-BUSINESS
 14725       TO DFHEIV11
 14726*    MOVE '&$ L                  ''   #00013224' TO DFHEIV0
 14727     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14728     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14729     MOVE X'2020233030303133323234' TO DFHEIV0(25:11)
 14730     CALL 'kxdfhei1' USING DFHEIV0,
 14731           FILE-ID-ERPNDB,
 14732           PENDING-BUSINESS,
 14733           DFHEIV11,
 14734           PB-CONTROL-PRIMARY,
 14735           DFHEIV99,
 14736           DFHEIV99
 14737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14738
 14739
 14740     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14741
 14742     PERFORM 8400-LOG-JOURNAL-RECORD.
 14743
 14744******************************************************************
 14745*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14746******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 268
* EL6311.cbl
 14747
 14748     display ' made it to add orig CANCEL cert '
 14749     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14750     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14751     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14752     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14753
 14754
 14755* EXEC CICS READ
 14756*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14757*        DATASET (FILE-ID-ELCERT)
 14758*        RIDFLD  (ELCERT-KEY)
 14759*        RESP    (WS-RESPONSE)
 14760*    END-EXEC.
 14761*    MOVE '&"S        E          (  N#00013244' TO DFHEIV0
 14762     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14764     MOVE X'204E233030303133323434' TO DFHEIV0(25:11)
 14765     CALL 'kxdfhei1' USING DFHEIV0,
 14766           FILE-ID-ELCERT,
 14767           DFHEIV20,
 14768           DFHEIV99,
 14769           ELCERT-KEY,
 14770           DFHEIV99,
 14771           DFHEIV99,
 14772           DFHEIV99
 14773     SET ADDRESS OF CERTIFICATE-MASTER TO
 14774         DFHEIV20
 14775     MOVE EIBRESP  TO WS-RESPONSE
 14776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14777
 14778
 14779     IF NOT RESP-NORMAL
 14780        GO TO 2276-BYPASS-CRTO
 14781     END-IF
 14782
 14783     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14784     MOVE ' '                    TO WS-ERMAIL-SW
 14785
 14786
 14787* EXEC CICS READ
 14788*       DATASET   (FILE-ID-ERMAIL)
 14789*       SET       (ADDRESS OF MAILING-DATA)
 14790*       RIDFLD    (ERMAIL-KEY)
 14791*       RESP      (WS-RESPONSE)
 14792*    END-EXEC
 14793*    MOVE '&"S        E          (  N#00013258' TO DFHEIV0
 14794     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14795     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14796     MOVE X'204E233030303133323538' TO DFHEIV0(25:11)
 14797     CALL 'kxdfhei1' USING DFHEIV0,
 14798           FILE-ID-ERMAIL,
 14799           DFHEIV20,
 14800           DFHEIV99,
 14801           ERMAIL-KEY,
 14802           DFHEIV99,
 14803           DFHEIV99,
 14804           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 269
* EL6311.cbl
 14805     SET ADDRESS OF MAILING-DATA TO
 14806         DFHEIV20
 14807     MOVE EIBRESP  TO WS-RESPONSE
 14808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14809
 14810     IF RESP-NORMAL
 14811        SET ERMAIL-FOUND TO TRUE
 14812     END-IF
 14813
 14814     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14815
 14816     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14817     MOVE 'OC'                   TO OC-RECORD-ID
 14818     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14819                                 TO OC-CONTROL-PRIMARY (1:33)
 14820     MOVE 'I'                    TO OC-RECORD-TYPE
 14821     MOVE +4096                  TO OC-KEY-SEQ-NO
 14822     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14823     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14824     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14825
 14826     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14827     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14828     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14829     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14830     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14831     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14832     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14833     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14834     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14835     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14836     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14837     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14838     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14839     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14840     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14841     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14842     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14843     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14844     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14845     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14846     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14847     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14848     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14849     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14850     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14851     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14852     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14853     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14854     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14855     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14856     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14857     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14858
 14859     IF ERMAIL-FOUND
 14860        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14861     END-IF
 14862     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 270
* EL6311.cbl
 14863        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14864                           OC-INS-AGE-DEFAULT-FLAG
 14865        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14866                           OC-JNT-AGE-DEFAULT-FLAG
 14867     END-IF
 14868     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14869     .
 14870 2275-WRITE-ELCRTO.
 14871
 14872
 14873* EXEC CICS WRITE
 14874*       DATASET   ('ELCRTO')
 14875*       FROM      (ORIGINAL-CERTIFICATE)
 14876*       RIDFLD    (OC-CONTROL-PRIMARY)
 14877*       RESP      (WS-RESPONSE)
 14878*    END-EXEC
 14879     MOVE LENGTH OF
 14880      ORIGINAL-CERTIFICATE
 14881       TO DFHEIV11
 14882     MOVE 'ELCRTO' TO DFHEIV1
 14883*    MOVE '&$ L                  ''  N#00013327' TO DFHEIV0
 14884     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14885     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14886     MOVE X'204E233030303133333237' TO DFHEIV0(25:11)
 14887     CALL 'kxdfhei1' USING DFHEIV0,
 14888           DFHEIV1,
 14889           ORIGINAL-CERTIFICATE,
 14890           DFHEIV11,
 14891           OC-CONTROL-PRIMARY,
 14892           DFHEIV99,
 14893           DFHEIV99
 14894     MOVE EIBRESP  TO WS-RESPONSE
 14895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14896
 14897     display ' just wrote 2275 ' ws-response
 14898     IF RESP-DUPKEY
 14899        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14900        GO TO 2275-WRITE-ELCRTO
 14901     ELSE
 14902        IF NOT RESP-NORMAL
 14903           MOVE -1               TO BMAINTL
 14904           MOVE ER-7450          TO EMI-ERROR
 14905           PERFORM 9900-ERROR-FORMAT
 14906                                 THRU 9900-EXIT
 14907           GO TO 8200-SEND-DATAONLY
 14908        END-IF
 14909     END-IF.
 14910
 14911 2276-BYPASS-CRTO.
 14912******************************************************************
 14913*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14914******************************************************************
 14915
 14916
 14917* EXEC CICS READ
 14918*        INTO    (PENDING-BUSINESS)
 14919*        DATASET (FILE-ID-ERPNDB)
 14920*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 271
* EL6311.cbl
 14921*        UPDATE
 14922*    END-EXEC.
 14923     MOVE LENGTH OF
 14924      PENDING-BUSINESS
 14925       TO DFHEIV11
 14926*    MOVE '&"IL       EU         (   #00013353' TO DFHEIV0
 14927     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14928     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14929     MOVE X'2020233030303133333533' TO DFHEIV0(25:11)
 14930     CALL 'kxdfhei1' USING DFHEIV0,
 14931           FILE-ID-ERPNDB,
 14932           PENDING-BUSINESS,
 14933           DFHEIV11,
 14934           ERPNDB-KEY,
 14935           DFHEIV99,
 14936           DFHEIV99,
 14937           DFHEIV99
 14938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14939
 14940
 14941     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14942     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14943     MOVE 'B'                    TO JP-RECORD-TYPE.
 14944     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14945
 14946     PERFORM 8400-LOG-JOURNAL-RECORD.
 14947
 14948     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14949
 14950
 14951* EXEC CICS REWRITE
 14952*        DATASET (FILE-ID-ERPNDB)
 14953*        FROM    (PENDING-BUSINESS)
 14954*    END-EXEC.
 14955     MOVE LENGTH OF
 14956      PENDING-BUSINESS
 14957       TO DFHEIV11
 14958*    MOVE '&& L                  %   #00013369' TO DFHEIV0
 14959     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14960     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14961     MOVE X'2020233030303133333639' TO DFHEIV0(25:11)
 14962     CALL 'kxdfhei1' USING DFHEIV0,
 14963           FILE-ID-ERPNDB,
 14964           PENDING-BUSINESS,
 14965           DFHEIV11,
 14966           DFHEIV99
 14967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14968
 14969
 14970     MOVE 'C'                    TO JP-RECORD-TYPE.
 14971     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14972
 14973     PERFORM 8400-LOG-JOURNAL-RECORD.
 14974
 14975     IF WS-ERRORS-PRESENT
 14976        GO TO 3900-RE-DISPLAY-RECORD.
 14977
 14978     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 272
* EL6311.cbl
 14979     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14980     MOVE LOW-VALUES             TO EL631CI.
 14981     MOVE  -1                    TO CMAINTL.
 14982     GO TO 8100-SEND-INITIAL-MAP.
 14983
 14984 2280-BATCH-HDR-NOT-FOUND.
 14985     MOVE -1                     TO BMAINTL.
 14986     MOVE ER-7450                TO EMI-ERROR.
 14987     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14988     GO TO 8200-SEND-DATAONLY.
 14989
 14990 2290-DUPLICATE-ALT-INDEX.
 14991
 14992******************************************************************
 14993*                                                                *
 14994*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14995*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14996*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14997*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14998*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14999*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15000*                                                                *
 15001******************************************************************
 15002
 15003     IF LCP-ONCTR-02 =  0
 15004         ADD 1 TO LCP-ONCTR-02
 15005        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15006
 15007     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15008
 15009     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15010         NEXT SENTENCE
 15011     ELSE
 15012         ADD +1 TO PB-BATCH-SEQ-NO
 15013                   PB-CSR-BATCH-SEQ-NO
 15014         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15015         GO TO 2275-WRITE-PENDING-BUSINESS.
 15016
 15017     MOVE -1                     TO CCERTNOL.
 15018     MOVE AL-UABON               TO CCERTNOA.
 15019     MOVE AL-UNBON               TO CEFFDTA.
 15020
 15021     MOVE 1                      TO EMI-SUB
 15022                                    EMI-SWITCH1
 15023                                    EMI-SWITCH-AREA-1
 15024                                    EMI-SWITCH-AREA-2.
 15025
 15026     MOVE SPACES                 TO EMI-ERROR-LINES.
 15027
 15028
 15029* EXEC CICS SYNCPOINT ROLLBACK
 15030*    END-EXEC.
 15031*    MOVE '6"R                   !   #00013432' TO DFHEIV0
 15032     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15034     MOVE X'2020233030303133343332' TO DFHEIV0(25:11)
 15035     CALL 'kxdfhei1' USING DFHEIV0
 15036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 273
* EL6311.cbl
 15037
 15038
 15039     MOVE ER-2247                TO EMI-ERROR.
 15040     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15041     GO TO 8200-SEND-DATAONLY.
 15042
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 274
* EL6311.cbl
 15044
 15045******************************************************************
 15046*                                                                *
 15047*          C H A N G E   C A N C E L   R O U T I N E             *
 15048*                                                                *
 15049******************************************************************
 15050
 15051***************************************************************
 15052*                                                             *
 15053*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15054*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15055*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15056*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15057*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15058*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15059*     5. LINK TO THE EDIT ROUTINE.                            *
 15060*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15061*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15062*              THE EDIT ROUTINE.                              *
 15063*     7. REWRITE THE NEW ISSUE                                *
 15064*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15065*                                                             *
 15066***************************************************************
 15067 2300-CHANGE-CANCEL-ROUTINE.
 15068     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15069
 15070     IF CCHGL NOT = ZEROS
 15071        MOVE ER-2196             TO EMI-ERROR
 15072        MOVE AL-UABON            TO CMAINTA
 15073        MOVE -1                  TO CMAINTL
 15074        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15075        GO TO 8200-SEND-DATAONLY.
 15076
 15077     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15078
 15079     IF CSUFIXL NOT = ZEROS
 15080        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15081     ELSE
 15082        MOVE SPACE               TO WS-NEW-SUFFIX.
 15083
 15084     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15085     PERFORM 8600-DEEDIT.
 15086     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15087     MOVE '4'                    TO DC-OPTION-CODE.
 15088
 15089     PERFORM 9700-DATE-LINK.
 15090
 15091     IF DATE-CONVERSION-ERROR
 15092        MOVE ER-0348             TO EMI-ERROR
 15093        MOVE -1                  TO CEFFDTL
 15094        MOVE AL-UABON            TO CEFFDTA
 15095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15096        GO TO 8200-SEND-DATAONLY
 15097     ELSE
 15098        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15099        MOVE AL-UANON            TO CEFFDTA
 15100        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15101
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 275
* EL6311.cbl
 15102 2325-PROCESS-CANCEL-CHANGES.
 15103
 15104* EXEC CICS HANDLE CONDITION
 15105*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15106*    END-EXEC.
 15107*    MOVE '"$I                   ! 5 #00013499' TO DFHEIV0
 15108     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15110     MOVE X'3520233030303133343939' TO DFHEIV0(25:11)
 15111     CALL 'kxdfhei1' USING DFHEIV0
 15112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15113
 15114
 15115     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15116     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15117     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15118
 15119
 15120* EXEC CICS GETMAIN
 15121*        SET      (ADDRESS OF PENDING-BUSINESS)
 15122*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15123*        INITIMG  (GETMAIN-SPACE)
 15124*     END-EXEC.
 15125*    MOVE ',"IL                  $   #00013507' TO DFHEIV0
 15126     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15127     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15128     MOVE X'2020233030303133353037' TO DFHEIV0(25:11)
 15129     CALL 'kxdfhei1' USING DFHEIV0,
 15130           DFHEIV20,
 15131           ERPNDB-RECORD-LENGTH,
 15132           GETMAIN-SPACE
 15133     SET ADDRESS OF PENDING-BUSINESS TO
 15134         DFHEIV20
 15135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15136
 15137
 15138
 15139* EXEC CICS READ
 15140*        INTO    (PENDING-BUSINESS)
 15141*        DATASET (FILE-ID-ERPNDB)
 15142*        RIDFLD  (ERPNDB-KEY)
 15143*    END-EXEC.
 15144     MOVE LENGTH OF
 15145      PENDING-BUSINESS
 15146       TO DFHEIV11
 15147*    MOVE '&"IL       E          (   #00013513' TO DFHEIV0
 15148     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15150     MOVE X'2020233030303133353133' TO DFHEIV0(25:11)
 15151     CALL 'kxdfhei1' USING DFHEIV0,
 15152           FILE-ID-ERPNDB,
 15153           PENDING-BUSINESS,
 15154           DFHEIV11,
 15155           ERPNDB-KEY,
 15156           DFHEIV99,
 15157           DFHEIV99,
 15158           DFHEIV99
 15159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 276
* EL6311.cbl
 15160
 15161
 15162     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15163
 15164
 15165* EXEC CICS HANDLE CONDITION
 15166*         NOTFND     (2385-REC-NOT-FOUND)
 15167*    END-EXEC.
 15168*    MOVE '"$I                   ! 6 #00013521' TO DFHEIV0
 15169     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15171     MOVE X'3620233030303133353231' TO DFHEIV0(25:11)
 15172     CALL 'kxdfhei1' USING DFHEIV0
 15173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15174
 15175
 15176**********************************************************
 15177*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15178*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15179**********************************************************
 15180
 15181
 15182* EXEC CICS READ
 15183*        DATASET (FILE-ID-ERPNDB)
 15184*        INTO    (PENDING-BUSINESS)
 15185*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15186*    END-EXEC.
 15187     MOVE LENGTH OF
 15188      PENDING-BUSINESS
 15189       TO DFHEIV11
 15190*    MOVE '&"IL       E          (   #00013530' TO DFHEIV0
 15191     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15192     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15193     MOVE X'2020233030303133353330' TO DFHEIV0(25:11)
 15194     CALL 'kxdfhei1' USING DFHEIV0,
 15195           FILE-ID-ERPNDB,
 15196           PENDING-BUSINESS,
 15197           DFHEIV11,
 15198           PI-PREV-CONTROL-PRIMARY,
 15199           DFHEIV99,
 15200           DFHEIV99,
 15201           DFHEIV99
 15202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15203
 15204
 15205********** DO NOT ALLOW CHANGES IF THRU A/R
 15206     IF BMAINTI = 'C'
 15207         IF PB-EL860-INTERNAL-PROCESS
 15208             MOVE ER-4005          TO EMI-ERROR
 15209             MOVE -1               TO BMAINTL
 15210             MOVE AL-UABON         TO BMAINTA
 15211             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15212             GO TO 8200-SEND-DATAONLY.
 15213**********
 15214
 15215     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15216        MOVE -1                 TO CMAINTL
 15217        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 277
* EL6311.cbl
 15218        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15219        GO TO 8200-SEND-DATAONLY.
 15220
 15221     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15222        MOVE ER-2196             TO EMI-ERROR
 15223        MOVE AL-UABON            TO CMAINTA
 15224        MOVE -1                  TO CMAINTL
 15225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15226        GO TO 8200-SEND-DATAONLY.
 15227     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15228
 15229     IF PB-BILLED-DT = LOW-VALUES AND
 15230        PB-CHG-COUNT = ZEROS
 15231        NEXT SENTENCE
 15232     ELSE
 15233        IF (CREFND1L GREATER THAN ZEROS AND
 15234            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15235           OR
 15236           (CREFND2L GREATER THAN ZEROS AND
 15237            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15238           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15239     if ((crefnd1l <> zeros)
 15240        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15241                      or
 15242        ((crefnd2l <> zeros)
 15243        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15244        continue
 15245     else
 15246        go to 2330-continue-change
 15247     end-if
 15248
 15249     move zeros                  to ws-check-amts
 15250     move ' '                    to ws-stop-sw
 15251                                    ws-check-sw
 15252                                    ws-proc-check-sw
 15253                                    ws-chek-browse-sw
 15254
 15255     perform 2500-browse-checks  thru 2500-exit
 15256
 15257     if i-have-processed-checks
 15258        or i-have-checks
 15259        continue
 15260     else
 15261        go to 2330-continue-change
 15262     end-if
 15263
 15264     display ' pb lf can ' pb-c-lf-cancel-amt
 15265     display ' ws lf can ' ws-crefnd1
 15266     if crefnd1l <> zeros
 15267        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15268        move ws-crefnd1 to ws-new-ref-total
 15269     else
 15270        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15271     end-if
 15272     display ' pb ah can ' pb-c-ah-cancel-amt
 15273     display ' ws ah can ' ws-crefnd2
 15274     display ' chk amts  ' ws-check-amts
 15275     if crefnd2l <> zeros
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 278
* EL6311.cbl
 15276        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15277        compute ws-new-ref-total = ws-new-ref-total +
 15278           ws-crefnd2
 15279     else
 15280        compute ws-new-ref-total = ws-new-ref-total +
 15281           pb-c-ah-cancel-amt
 15282     end-if
 15283
 15284     if zeros = (ws-lf-diff + ws-ah-diff)
 15285        move er-3449             to emi-error
 15286        perform 9900-error-format thru 9900-exit
 15287        go to 2330-continue-change
 15288     end-if
 15289
 15290     if (ws-new-ref-total < ws-check-amts)
 15291        and (pb-c-refund-sw = 'Y')
 15292        move er-3447             to emi-error
 15293        perform 9900-error-format thru 9900-exit
 15294        move al-uabon            to cmainta
 15295        move -1                  to cmaintl
 15296        go to 8200-send-dataonly
 15297     end-if
 15298
 15299     if (ws-new-ref-total > ws-check-amts)
 15300        and (ws-check-amts not = zeros)
 15301        move er-3448             to emi-error
 15302        move al-uabon            to crefnd1a
 15303                                    crefnd2a
 15304        perform 9900-error-format thru 9900-exit
 15305     end-if
 15306
 15307*     if (ws-lf-diff + ws-ah-diff) < zeros
 15308*        move er-3447             to emi-error
 15309*        perform 9900-error-format thru 9900-exit
 15310*        move al-uabon            to cmainta
 15311*        move -1                  to cmaintl
 15312*        go to 8200-send-dataonly
 15313*     end-if
 15314     .
 15315 2330-continue-change.
 15316
 15317
 15318* EXEC CICS READ
 15319*        DATASET (FILE-ID-ERPNDB)
 15320*        INTO    (PENDING-BUSINESS)
 15321*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15322*        UPDATE
 15323*    END-EXEC.
 15324     MOVE LENGTH OF
 15325      PENDING-BUSINESS
 15326       TO DFHEIV11
 15327*    MOVE '&"IL       EU         (   #00013648' TO DFHEIV0
 15328     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15329     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15330     MOVE X'2020233030303133363438' TO DFHEIV0(25:11)
 15331     CALL 'kxdfhei1' USING DFHEIV0,
 15332           FILE-ID-ERPNDB,
 15333           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 279
* EL6311.cbl
 15334           DFHEIV11,
 15335           PI-PREV-CONTROL-PRIMARY,
 15336           DFHEIV99,
 15337           DFHEIV99,
 15338           DFHEIV99
 15339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15340
 15341
 15342     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15343     MOVE 'B'                    TO JP-RECORD-TYPE
 15344     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15345     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15346
 15347     PERFORM 8400-LOG-JOURNAL-RECORD.
 15348
 15349     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15350          PB-CHG-COUNT NOT = ZEROS
 15351        IF (CREFND1L GREATER THAN ZEROS AND
 15352            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15353           OR
 15354           (CREFND2L GREATER THAN ZEROS AND
 15355            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15356            ADD +1                      TO PB-CHG-COUNT
 15357            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15358
 15359*    IF CMICRNOL  GREATER  ZEROS
 15360*        IF CMICRNOI  NUMERIC
 15361*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15362*            MOVE AL-UNNON       TO  CMICRNOA
 15363*        ELSE
 15364*            MOVE -1             TO  CMICRNOL
 15365*            MOVE AL-UNBON       TO  CMICRNOA
 15366*            MOVE ER-2701        TO  EMI-ERROR
 15367*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15368
 15369     IF CSUFIXL GREATER THAN ZEROS
 15370        MOVE CSUFIXI             TO PB-CERT-SFX.
 15371
 15372     IF CLSTNML GREATER THAN ZEROS
 15373         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15374
 15375     IF CCANREAL > ZEROS
 15376        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15377     END-IF
 15378     IF CPCYNL > ZEROS
 15379        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15380     END-IF
 15381     IF CCANDT1L    GREATER THAN ZEROS
 15382        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15383
 15384     IF CCANDT2L    GREATER THAN ZEROS
 15385        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15386
 15387     IF CMTHD1L    GREATER THAN +0
 15388        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15389
 15390     IF CMTHD2L    GREATER THAN +0
 15391        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 280
* EL6311.cbl
 15392
 15393     IF CREFND1L    GREATER THAN ZEROS
 15394        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15395        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15396        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15397        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15398
 15399     IF CREFND2L    GREATER THAN ZEROS
 15400        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15401        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15402        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15403        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15404
 15405     IF CLIVESL     GREATER THAN ZEROS
 15406        MOVE WS-CLIVES           TO PB-C-LIVES.
 15407
 15408     IF CPAYEEL     GREATER THAN ZEROS
 15409        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15410
 15411     IF CFORCEL     GREATER THAN ZEROS
 15412        MOVE CFORCEI             TO PB-FORCE-CODE.
 15413
 15414     IF CBILCDL     GREATER THAN ZEROS
 15415        MOVE CBILCDI             TO PB-RECORD-BILL.
 15416
 15417 2360-REWRITE-PB-RECORD.
 15418     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15419     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15420     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15421     MOVE 'C'                    TO JP-RECORD-TYPE.
 15422     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15423     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15424     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15425
 15426     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15427
 15428     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15429     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15430
 15431     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15432
 15433     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15434
 15435     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15436     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15437     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15438
 15439     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15440     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15441
 15442 2375-REWRITE-PENDING-BUSINESS.
 15443     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15444     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15445     MOVE 'C'                    TO JP-RECORD-TYPE.
 15446     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15447
 15448
 15449* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 281
* EL6311.cbl
 15450*        DATASET (FILE-ID-ERPNDB)
 15451*        FROM    (PENDING-BUSINESS)
 15452*    END-EXEC.
 15453     MOVE LENGTH OF
 15454      PENDING-BUSINESS
 15455       TO DFHEIV11
 15456*    MOVE '&& L                  %   #00013761' TO DFHEIV0
 15457     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15458     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15459     MOVE X'2020233030303133373631' TO DFHEIV0(25:11)
 15460     CALL 'kxdfhei1' USING DFHEIV0,
 15461           FILE-ID-ERPNDB,
 15462           PENDING-BUSINESS,
 15463           DFHEIV11,
 15464           DFHEIV99
 15465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15466
 15467
 15468     PERFORM 8400-LOG-JOURNAL-RECORD.
 15469
 15470******************************************************************
 15471*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15472******************************************************************
 15473
 15474     display ' made it to update orig cancel cert '
 15475
 15476     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15477     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15478     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15479     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15480
 15481
 15482* EXEC CICS READ
 15483*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15484*        DATASET (FILE-ID-ELCERT)
 15485*        RIDFLD  (ELCERT-KEY)
 15486*        RESP    (WS-RESPONSE)
 15487*    END-EXEC.
 15488*    MOVE '&"S        E          (  N#00013779' TO DFHEIV0
 15489     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15491     MOVE X'204E233030303133373739' TO DFHEIV0(25:11)
 15492     CALL 'kxdfhei1' USING DFHEIV0,
 15493           FILE-ID-ELCERT,
 15494           DFHEIV20,
 15495           DFHEIV99,
 15496           ELCERT-KEY,
 15497           DFHEIV99,
 15498           DFHEIV99,
 15499           DFHEIV99
 15500     SET ADDRESS OF CERTIFICATE-MASTER TO
 15501         DFHEIV20
 15502     MOVE EIBRESP  TO WS-RESPONSE
 15503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15504
 15505
 15506     IF NOT RESP-NORMAL
 15507        GO TO 2376-BYPASS-CRTO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 282
* EL6311.cbl
 15508     END-IF
 15509
 15510
 15511     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15512     MOVE ' '                    TO WS-ERMAIL-SW
 15513
 15514
 15515* EXEC CICS READ
 15516*       DATASET   (FILE-ID-ERMAIL)
 15517*       SET       (ADDRESS OF MAILING-DATA)
 15518*       RIDFLD    (ERMAIL-KEY)
 15519*       RESP      (WS-RESPONSE)
 15520*    END-EXEC
 15521*    MOVE '&"S        E          (  N#00013794' TO DFHEIV0
 15522     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15524     MOVE X'204E233030303133373934' TO DFHEIV0(25:11)
 15525     CALL 'kxdfhei1' USING DFHEIV0,
 15526           FILE-ID-ERMAIL,
 15527           DFHEIV20,
 15528           DFHEIV99,
 15529           ERMAIL-KEY,
 15530           DFHEIV99,
 15531           DFHEIV99,
 15532           DFHEIV99
 15533     SET ADDRESS OF MAILING-DATA TO
 15534         DFHEIV20
 15535     MOVE EIBRESP  TO WS-RESPONSE
 15536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15537
 15538     IF RESP-NORMAL
 15539        SET ERMAIL-FOUND TO TRUE
 15540     END-IF
 15541
 15542     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15543
 15544     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15545                                 TO ELCRTO-KEY
 15546     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15547     MOVE +0                     TO ELCRTO-SEQ-NO
 15548
 15549
 15550* EXEC CICS READ
 15551*       DATASET   ('ELCRTO')
 15552*       INTO      (ORIGINAL-CERTIFICATE)
 15553*       RIDFLD    (ELCRTO-KEY)
 15554*       GTEQ
 15555*       RESP      (WS-RESPONSE)
 15556*    END-EXEC
 15557     MOVE LENGTH OF
 15558      ORIGINAL-CERTIFICATE
 15559       TO DFHEIV11
 15560     MOVE 'ELCRTO' TO DFHEIV1
 15561*    MOVE '&"IL       G          (  N#00013812' TO DFHEIV0
 15562     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15564     MOVE X'204E233030303133383132' TO DFHEIV0(25:11)
 15565     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 283
* EL6311.cbl
 15566           DFHEIV1,
 15567           ORIGINAL-CERTIFICATE,
 15568           DFHEIV11,
 15569           ELCRTO-KEY,
 15570           DFHEIV99,
 15571           DFHEIV99,
 15572           DFHEIV99
 15573     MOVE EIBRESP  TO WS-RESPONSE
 15574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15575
 15576     display ' just read gteq ' ws-response
 15577     IF RESP-NORMAL
 15578        AND (OC-CONTROL-PRIMARY (1:33) =
 15579                 PB-CONTROL-BY-ACCOUNT (1:33))
 15580        AND (OC-RECORD-TYPE = 'I')
 15581        display ' resp norm, key =, type i '
 15582        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15583           display ' end proc blank '
 15584           display ' csr edit session ' PI-CSR-SESSION-SW
 15585           IF NOT CSR-EDIT-SESSION
 15586
 15587* EXEC CICS READ
 15588*                DATASET   ('ELCRTO')
 15589*                INTO      (ORIGINAL-CERTIFICATE)
 15590*                RIDFLD    (OC-CONTROL-PRIMARY)
 15591*                UPDATE
 15592*                RESP      (WS-RESPONSE)
 15593*             END-EXEC
 15594     MOVE LENGTH OF
 15595      ORIGINAL-CERTIFICATE
 15596       TO DFHEIV11
 15597     MOVE 'ELCRTO' TO DFHEIV1
 15598*    MOVE '&"IL       EU         (  N#00013830' TO DFHEIV0
 15599     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15600     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15601     MOVE X'204E233030303133383330' TO DFHEIV0(25:11)
 15602     CALL 'kxdfhei1' USING DFHEIV0,
 15603           DFHEIV1,
 15604           ORIGINAL-CERTIFICATE,
 15605           DFHEIV11,
 15606           OC-CONTROL-PRIMARY,
 15607           DFHEIV99,
 15608           DFHEIV99,
 15609           DFHEIV99
 15610     MOVE EIBRESP  TO WS-RESPONSE
 15611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15612              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15613              IF RESP-NORMAL
 15614                 display ' good read upd '
 15615                 IF OC-ISSUE-TRAN-IND = 'N'
 15616                    MOVE CM-INSURED-LAST-NAME   TO
 15617                         OC-INS-LAST-NAME
 15618                    MOVE CM-INSURED-FIRST-NAME  TO
 15619                         OC-INS-FIRST-NAME
 15620                    MOVE CM-INSURED-INITIAL2    TO
 15621                         OC-INS-MIDDLE-INIT
 15622                    MOVE CM-INSURED-ISSUE-AGE   TO
 15623                         OC-INS-AGE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 284
* EL6311.cbl
 15624                    MOVE CM-JT-LAST-NAME        TO
 15625                         OC-JNT-LAST-NAME
 15626                    MOVE CM-JT-FIRST-NAME       TO
 15627                         OC-JNT-FIRST-NAME
 15628                    MOVE CM-JT-INITIAL          TO
 15629                         OC-JNT-MIDDLE-INIT
 15630                    MOVE CM-INSURED-JOINT-AGE   TO
 15631                         OC-JNT-AGE
 15632                    MOVE CM-LF-BENEFIT-CD       TO
 15633                         OC-LF-BENCD
 15634                    MOVE CM-LF-ORIG-TERM        TO
 15635                         OC-LF-TERM
 15636                    MOVE CM-LF-BENEFIT-AMT      TO
 15637                         OC-LF-BEN-AMT
 15638                    MOVE CM-LF-PREMIUM-AMT      TO
 15639                         OC-LF-PRM-AMT
 15640                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15641                         OC-LF-ALT-BEN-AMT
 15642                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15643                         OC-LF-ALT-PRM-AMT
 15644                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15645                         OC-LF-EXP-DT
 15646                    MOVE CM-LIFE-COMM-PCT       TO
 15647                         OC-LF-COMM-PCT
 15648                    MOVE CM-AH-BENEFIT-CD       TO
 15649                         OC-AH-BENCD
 15650                    MOVE CM-AH-ORIG-TERM        TO
 15651                         OC-AH-TERM
 15652                    MOVE CM-AH-BENEFIT-AMT      TO
 15653                         OC-AH-BEN-AMT
 15654                    MOVE CM-AH-PREMIUM-AMT      TO
 15655                         OC-AH-PRM-AMT
 15656                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15657                         OC-AH-EXP-DT
 15658                    MOVE CM-AH-COMM-PCT         TO
 15659                         OC-AH-COMM-PCT
 15660                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15661                         OC-AH-CP
 15662                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15663                         OC-1ST-PMT-DT
 15664                 END-IF
 15665                 MOVE PB-C-LF-CANCEL-DT      TO
 15666                         OC-LF-CANCEL-DT
 15667                 MOVE PB-C-LF-CANCEL-AMT     TO
 15668                         OC-LF-CANCEL-AMT
 15669                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15670                         OC-LF-ITD-CANCEL-AMT
 15671                 MOVE PB-C-AH-CANCEL-DT      TO
 15672                         OC-AH-CANCEL-DT
 15673                 MOVE PB-C-AH-CANCEL-AMT     TO
 15674                         OC-AH-CANCEL-AMT
 15675                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15676                         OC-AH-ITD-CANCEL-AMT
 15677                 MOVE 'Y'                    TO
 15678                         OC-CANCEL-TRAN-IND
 15679                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15680                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15681                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 285
* EL6311.cbl
 15682                 IF ERMAIL-FOUND
 15683                    MOVE MA-CRED-BENE-NAME
 15684                                 TO OC-CRED-BENE-NAME
 15685                 END-IF
 15686                 IF NOT CERT-TRL-REC-NOT-FOUND
 15687                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15688                           OC-INS-AGE-DEFAULT-FLAG
 15689                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15690                           OC-JNT-AGE-DEFAULT-FLAG
 15691                 END-IF
 15692
 15693* EXEC CICS REWRITE
 15694*                   DATASET   ('ELCRTO')
 15695*                   FROM      (ORIGINAL-CERTIFICATE)
 15696*                   RESP      (WS-RESPONSE)
 15697*                END-EXEC
 15698     MOVE LENGTH OF
 15699      ORIGINAL-CERTIFICATE
 15700       TO DFHEIV11
 15701     MOVE 'ELCRTO' TO DFHEIV1
 15702*    MOVE '&& L                  %  N#00013917' TO DFHEIV0
 15703     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15704     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15705     MOVE X'204E233030303133393137' TO DFHEIV0(25:11)
 15706     CALL 'kxdfhei1' USING DFHEIV0,
 15707           DFHEIV1,
 15708           ORIGINAL-CERTIFICATE,
 15709           DFHEIV11,
 15710           DFHEIV99
 15711     MOVE EIBRESP  TO WS-RESPONSE
 15712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15713                 display ' just rewrote ' ws-response
 15714              END-IF
 15715           END-IF
 15716        ELSE
 15717           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15718           MOVE 'OC'             TO OC-RECORD-ID
 15719           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15720           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15721           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15722           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15723           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15724           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15725           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15726           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15727           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15728           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15729           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15730           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15731           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15732           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15733           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15734           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15735           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15736           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15737           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15738           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15739           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 286
* EL6311.cbl
 15740           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15741           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15742           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15743           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15744           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15745           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15746           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15747           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15748           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15749           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15750           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15751           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15752           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15753           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15754           IF ERMAIL-FOUND
 15755              MOVE MA-CRED-BENE-NAME
 15756                                 TO OC-CRED-BENE-NAME
 15757           END-IF
 15758           IF NOT CERT-TRL-REC-NOT-FOUND
 15759              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15760                           OC-INS-AGE-DEFAULT-FLAG
 15761              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15762                           OC-JNT-AGE-DEFAULT-FLAG
 15763           END-IF
 15764           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15765
 15766* EXEC CICS WRITE
 15767*             DATASET   ('ELCRTO')
 15768*             FROM      (ORIGINAL-CERTIFICATE)
 15769*             RIDFLD    (OC-CONTROL-PRIMARY)
 15770*             RESP      (WS-RESPONSE)
 15771*          END-EXEC
 15772     MOVE LENGTH OF
 15773      ORIGINAL-CERTIFICATE
 15774       TO DFHEIV11
 15775     MOVE 'ELCRTO' TO DFHEIV1
 15776*    MOVE '&$ L                  ''  N#00013974' TO DFHEIV0
 15777     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15778     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15779     MOVE X'204E233030303133393734' TO DFHEIV0(25:11)
 15780     CALL 'kxdfhei1' USING DFHEIV0,
 15781           DFHEIV1,
 15782           ORIGINAL-CERTIFICATE,
 15783           DFHEIV11,
 15784           OC-CONTROL-PRIMARY,
 15785           DFHEIV99,
 15786           DFHEIV99
 15787     MOVE EIBRESP  TO WS-RESPONSE
 15788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15789        END-IF
 15790     ELSE
 15791        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15792        MOVE 'OC'                TO OC-RECORD-ID
 15793        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15794                                 TO OC-CONTROL-PRIMARY (1:33)
 15795        MOVE 'I'                 TO OC-RECORD-TYPE
 15796        MOVE +4096               TO OC-KEY-SEQ-NO
 15797        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 287
* EL6311.cbl
 15798        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15799        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15800        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15801        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15802        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15803        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15804        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15805        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15806        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15807        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15808        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15809        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15810        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15811        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15812        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15813        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15814        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15815        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15816        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15817        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15818        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15819        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15820        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15821        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15822        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15823        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15824        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15825        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15826        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15827        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15828        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15829        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15830        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15831        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15832        IF ERMAIL-FOUND
 15833           MOVE MA-CRED-BENE-NAME
 15834                                 TO OC-CRED-BENE-NAME
 15835        END-IF
 15836        IF NOT CERT-TRL-REC-NOT-FOUND
 15837           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15838                           OC-INS-AGE-DEFAULT-FLAG
 15839           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15840                           OC-JNT-AGE-DEFAULT-FLAG
 15841        END-IF
 15842        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15843
 15844
 15845* EXEC CICS WRITE
 15846*          DATASET   ('ELCRTO')
 15847*          FROM      (ORIGINAL-CERTIFICATE)
 15848*          RIDFLD    (OC-CONTROL-PRIMARY)
 15849*          RESP      (WS-RESPONSE)
 15850*       END-EXEC
 15851     MOVE LENGTH OF
 15852      ORIGINAL-CERTIFICATE
 15853       TO DFHEIV11
 15854     MOVE 'ELCRTO' TO DFHEIV1
 15855*    MOVE '&$ L                  ''  N#00014035' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 288
* EL6311.cbl
 15856     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15857     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15858     MOVE X'204E233030303134303335' TO DFHEIV0(25:11)
 15859     CALL 'kxdfhei1' USING DFHEIV0,
 15860           DFHEIV1,
 15861           ORIGINAL-CERTIFICATE,
 15862           DFHEIV11,
 15863           OC-CONTROL-PRIMARY,
 15864           DFHEIV99,
 15865           DFHEIV99
 15866     MOVE EIBRESP  TO WS-RESPONSE
 15867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15868     END-IF.
 15869
 15870 2376-BYPASS-CRTO.
 15871******************************************************************
 15872*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15873******************************************************************
 15874
 15875
 15876* EXEC CICS HANDLE CONDITION
 15877*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15878*    END-EXEC.
 15879*    MOVE '"$I                   ! 7 #00014048' TO DFHEIV0
 15880     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15882     MOVE X'3720233030303134303438' TO DFHEIV0(25:11)
 15883     CALL 'kxdfhei1' USING DFHEIV0
 15884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15885
 15886
 15887
 15888* EXEC CICS READ
 15889*        INTO    (PENDING-BUSINESS)
 15890*        DATASET (FILE-ID-ERPNDB)
 15891*        RIDFLD  (ERPNDB-KEY)
 15892*        UPDATE
 15893*    END-EXEC.
 15894     MOVE LENGTH OF
 15895      PENDING-BUSINESS
 15896       TO DFHEIV11
 15897*    MOVE '&"IL       EU         (   #00014052' TO DFHEIV0
 15898     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15899     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15900     MOVE X'2020233030303134303532' TO DFHEIV0(25:11)
 15901     CALL 'kxdfhei1' USING DFHEIV0,
 15902           FILE-ID-ERPNDB,
 15903           PENDING-BUSINESS,
 15904           DFHEIV11,
 15905           ERPNDB-KEY,
 15906           DFHEIV99,
 15907           DFHEIV99,
 15908           DFHEIV99
 15909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15910
 15911
 15912     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15913     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 289
* EL6311.cbl
 15914     MOVE 'B'                    TO JP-RECORD-TYPE.
 15915     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15916
 15917     PERFORM 8400-LOG-JOURNAL-RECORD.
 15918
 15919     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15920
 15921
 15922* EXEC CICS REWRITE
 15923*        DATASET (FILE-ID-ERPNDB)
 15924*        FROM    (PENDING-BUSINESS)
 15925*    END-EXEC.
 15926     MOVE LENGTH OF
 15927      PENDING-BUSINESS
 15928       TO DFHEIV11
 15929*    MOVE '&& L                  %   #00014068' TO DFHEIV0
 15930     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15931     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15932     MOVE X'2020233030303134303638' TO DFHEIV0(25:11)
 15933     CALL 'kxdfhei1' USING DFHEIV0,
 15934           FILE-ID-ERPNDB,
 15935           PENDING-BUSINESS,
 15936           DFHEIV11,
 15937           DFHEIV99
 15938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15939
 15940
 15941     MOVE 'C'                    TO JP-RECORD-TYPE.
 15942     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15943
 15944     PERFORM 8400-LOG-JOURNAL-RECORD.
 15945
 15946     IF WS-ERRORS-PRESENT
 15947         GO TO 3900-RE-DISPLAY-RECORD.
 15948
 15949     MOVE ZEROS                  TO EMI-ERROR
 15950     MOVE -1                     TO CMAINTL
 15951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15952     GO TO 3900-RE-DISPLAY-RECORD.
 15953
 15954 2380-BATCH-HDR-NOT-FOUND.
 15955     MOVE -1                     TO BMAINTL.
 15956     MOVE ER-7450                TO EMI-ERROR.
 15957     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15958     GO TO 8200-SEND-DATAONLY.
 15959
 15960 2385-REC-NOT-FOUND.
 15961     MOVE -1                     TO BMAINTL.
 15962     MOVE ER-7451                TO EMI-ERROR.
 15963     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15964     GO TO 8200-SEND-DATAONLY.
 15965
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 290
* EL6311.cbl
 15967
 15968******************************************************************
 15969*                                                                *
 15970*          D E L E T E   C A N C E L   R O U T I N E             *
 15971*                                                                *
 15972******************************************************************
 15973
 15974 2400-DELETE-CANCEL-ROUTINE.
 15975     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15976
 15977     IF CCHGL NOT = ZEROS
 15978        MOVE ER-2196             TO EMI-ERROR
 15979        MOVE AL-UABON            TO CMAINTA
 15980        MOVE -1                  TO CMAINTL
 15981        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15982        GO TO 8200-SEND-DATAONLY.
 15983
 15984
 15985* EXEC CICS HANDLE CONDITION
 15986*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15987*    END-EXEC.
 15988*    MOVE '"$I                   ! 8 #00014116' TO DFHEIV0
 15989     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15991     MOVE X'3820233030303134313136' TO DFHEIV0(25:11)
 15992     CALL 'kxdfhei1' USING DFHEIV0
 15993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15994
 15995
 15996     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15997     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15998     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15999
 16000
 16001* EXEC CICS READ
 16002*        SET     (ADDRESS OF PENDING-BUSINESS)
 16003*        DATASET (FILE-ID-ERPNDB)
 16004*        RIDFLD  (ERPNDB-KEY)
 16005*    END-EXEC.
 16006*    MOVE '&"S        E          (   #00014124' TO DFHEIV0
 16007     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16009     MOVE X'2020233030303134313234' TO DFHEIV0(25:11)
 16010     CALL 'kxdfhei1' USING DFHEIV0,
 16011           FILE-ID-ERPNDB,
 16012           DFHEIV20,
 16013           DFHEIV99,
 16014           ERPNDB-KEY,
 16015           DFHEIV99,
 16016           DFHEIV99,
 16017           DFHEIV99
 16018     SET ADDRESS OF PENDING-BUSINESS TO
 16019         DFHEIV20
 16020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16021
 16022
 16023     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16024
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 291
* EL6311.cbl
 16025     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16026
 16027     IF CSUFIXL NOT = ZEROS
 16028        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16029     ELSE
 16030        MOVE SPACE               TO WS-NEW-SUFFIX.
 16031
 16032     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16033
 16034     PERFORM 8600-DEEDIT.
 16035     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16036     MOVE '4'                    TO DC-OPTION-CODE.
 16037     PERFORM 9700-DATE-LINK.
 16038
 16039     IF DATE-CONVERSION-ERROR
 16040        MOVE ER-0348             TO EMI-ERROR
 16041        MOVE -1                  TO CEFFDTL
 16042        MOVE AL-UABON            TO CEFFDTA
 16043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16044        GO TO 8200-SEND-DATAONLY
 16045     ELSE
 16046        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16047        MOVE AL-UANON            TO CEFFDTA
 16048        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16049
 16050
 16051* EXEC CICS HANDLE CONDITION
 16052*         NOTFND    (2490-RECORD-NOT-FOUND)
 16053*    END-EXEC.
 16054*    MOVE '"$I                   ! 9 #00014157' TO DFHEIV0
 16055     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16057     MOVE X'3920233030303134313537' TO DFHEIV0(25:11)
 16058     CALL 'kxdfhei1' USING DFHEIV0
 16059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16060
 16061
 16062
 16063* EXEC CICS READ
 16064*        SET     (ADDRESS OF PENDING-BUSINESS)
 16065*        DATASET (FILE-ID-ERPNDB)
 16066*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16067*        UPDATE
 16068*    END-EXEC.
 16069*    MOVE '&"S        EU         (   #00014161' TO DFHEIV0
 16070     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16071     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16072     MOVE X'2020233030303134313631' TO DFHEIV0(25:11)
 16073     CALL 'kxdfhei1' USING DFHEIV0,
 16074           FILE-ID-ERPNDB,
 16075           DFHEIV20,
 16076           DFHEIV99,
 16077           PI-PREV-CONTROL-PRIMARY,
 16078           DFHEIV99,
 16079           DFHEIV99,
 16080           DFHEIV99
 16081     SET ADDRESS OF PENDING-BUSINESS TO
 16082         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 292
* EL6311.cbl
 16083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16084
 16085
 16086     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16087        MOVE -1                 TO CMAINTL
 16088        MOVE ER-2197            TO EMI-ERROR
 16089        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16090        GO TO 8200-SEND-DATAONLY.
 16091
 16092     IF PB-BILLED-DT NOT = LOW-VALUES
 16093        MOVE -1                 TO CMAINTL
 16094        MOVE ER-2129            TO EMI-ERROR
 16095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16096        GO TO 8200-SEND-DATAONLY.
 16097
 16098     IF PB-CHG-COUNT NOT = ZEROS
 16099        MOVE ER-2336            TO EMI-ERROR
 16100        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16101        MOVE AL-UABON            TO CMAINTA
 16102        MOVE -1                  TO CMAINTL
 16103        GO TO 8200-SEND-DATAONLY.
 16104
 16105     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16106        PB-CHG-COUNT NOT = ZEROS
 16107        MOVE ER-2196             TO EMI-ERROR
 16108        MOVE AL-UABON            TO CMAINTA
 16109        MOVE -1                  TO CMAINTL
 16110        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16111        GO TO 8200-SEND-DATAONLY.
 16112
 16113     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16114        MOVE ER-2900 TO EMI-ERROR
 16115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16116        MOVE AL-UABON         TO CMAINTA
 16117        MOVE -1               TO CMAINTL
 16118        GO TO 8200-SEND-DATAONLY.
 16119     move ' '                    to ws-stop-sw
 16120                                    ws-check-sw
 16121                                    ws-proc-check-sw
 16122                                    ws-chek-browse-sw
 16123
 16124     perform 2500-browse-checks  thru 2500-exit
 16125     if (i-have-processed-checks)
 16126        and (pb-c-refund-sw = 'Y')
 16127        move er-3446             to emi-error
 16128        perform 9900-error-format thru 9900-exit
 16129        move al-uabon            to cmainta
 16130        move -1                  to cmaintl
 16131        go to 8200-send-dataonly
 16132     end-if
 16133
 16134* EXEC CICS HANDLE CONDITION
 16135*         NOTFND  (2475-CONTINUE-DELETE)
 16136*    END-EXEC
 16137*    MOVE '"$I                   ! : #00014215' TO DFHEIV0
 16138     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16140     MOVE X'3A20233030303134323135' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 293
* EL6311.cbl
 16141     CALL 'kxdfhei1' USING DFHEIV0
 16142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16143
 16144     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16145     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16146     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16147     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16148
 16149
 16150* EXEC CICS READ
 16151*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16152*        DATASET (FILE-ID-ELCERT)
 16153*        RIDFLD  (ELCERT-KEY)
 16154*        UPDATE
 16155*    END-EXEC.
 16156*    MOVE '&"S        EU         (   #00014224' TO DFHEIV0
 16157     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16158     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16159     MOVE X'2020233030303134323234' TO DFHEIV0(25:11)
 16160     CALL 'kxdfhei1' USING DFHEIV0,
 16161           FILE-ID-ELCERT,
 16162           DFHEIV20,
 16163           DFHEIV99,
 16164           ELCERT-KEY,
 16165           DFHEIV99,
 16166           DFHEIV99,
 16167           DFHEIV99
 16168     SET ADDRESS OF CERTIFICATE-MASTER TO
 16169         DFHEIV20
 16170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16171
 16172
 16173     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16174
 16175     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16176     MOVE 'B'                    TO JP-RECORD-TYPE.
 16177     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16178     PERFORM 8400-LOG-JOURNAL-RECORD.
 16179
 16180     IF PB-CI-LIVES NOT NUMERIC
 16181         MOVE ZERO                    TO PB-CI-LIVES.
 16182
 16183     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16184        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16185           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16186           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16187           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16188                                            CM-LF-CANCEL-DT
 16189           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16190        ELSE
 16191           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16192           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16193           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16194           MOVE PB-CI-LIVES              TO CM-LIVES.
 16195
 16196     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16197        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16198           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 294
* EL6311.cbl
 16199               MOVE CM-LF-STATUS-AT-CANCEL
 16200                                        TO CM-LF-CURRENT-STATUS
 16201               MOVE SPACE
 16202                                        TO CM-LF-STATUS-AT-CANCEL
 16203           ELSE
 16204               MOVE PB-CI-LF-POLICY-STATUS
 16205                                        TO CM-LF-CURRENT-STATUS
 16206        ELSE
 16207           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16208
 16209
 16210     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16211        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16212           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16213           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16214           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16215                                            CM-AH-CANCEL-DT
 16216           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16217        ELSE
 16218           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16219           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16220           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16221           MOVE PB-CI-LIVES              TO CM-LIVES.
 16222
 16223     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16224        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16225           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16226               MOVE CM-AH-STATUS-AT-CANCEL
 16227                                        TO CM-AH-CURRENT-STATUS
 16228               MOVE SPACE
 16229                                        TO CM-AH-STATUS-AT-CANCEL
 16230           ELSE
 16231               MOVE PB-CI-AH-POLICY-STATUS
 16232                                        TO CM-AH-CURRENT-STATUS
 16233        ELSE
 16234           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16235
 16236 2450-REWRITE-CERT.
 16237     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16238     MOVE 'C'                      TO JP-RECORD-TYPE.
 16239     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16240
 16241
 16242* EXEC CICS REWRITE
 16243*        DATASET  (FILE-ID-ELCERT)
 16244*        FROM     (CERTIFICATE-MASTER)
 16245*    END-EXEC.
 16246     MOVE LENGTH OF
 16247      CERTIFICATE-MASTER
 16248       TO DFHEIV11
 16249*    MOVE '&& L                  %   #00014299' TO DFHEIV0
 16250     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16251     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16252     MOVE X'2020233030303134323939' TO DFHEIV0(25:11)
 16253     CALL 'kxdfhei1' USING DFHEIV0,
 16254           FILE-ID-ELCERT,
 16255           CERTIFICATE-MASTER,
 16256           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 295
* EL6311.cbl
 16257           DFHEIV99
 16258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16259
 16260
 16261     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16262
 16263     PERFORM 8400-LOG-JOURNAL-RECORD.
 16264
 16265     move ' '                    to ws-stop-sw
 16266                                    ws-proc-check-sw
 16267                                    ws-chek-browse-sw
 16268
 16269     if i-have-checks
 16270        perform until i-say-stop
 16271           perform 2510-startbr-erchek
 16272                                 thru 2510-exit
 16273           if resp-normal
 16274              perform 2520-readnext-erchek
 16275                                 thru 2520-exit
 16276           end-if
 16277           if (not resp-normal)
 16278              or (pb-control-by-account (1:33) not =
 16279                 ch-control-primary (1:33))
 16280                 set i-say-stop to true
 16281           else
 16282              perform 2530-readupd-erchek
 16283                                 thru 2530-exit
 16284              if resp-normal
 16285                 perform 2540-delete-erchek
 16286                                 thru 2540-exit
 16287              end-if
 16288              if ws-chek-browse-sw = 'Y'
 16289                 perform 2525-endbr-erchek
 16290                                 thru 2525-exit
 16291                 move ' '        to ws-chek-browse-sw
 16292              end-if
 16293           end-if
 16294        end-perform
 16295     end-if
 16296
 16297     if ws-chek-browse-sw = 'Y'
 16298        perform 2525-endbr-erchek thru 2525-exit
 16299     end-if
 16300     .
 16301 2475-CONTINUE-DELETE.
 16302     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16303     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16304
 16305     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16306     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16307
 16308     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16309
 16310     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16311     MOVE 'D'                    TO JP-RECORD-TYPE
 16312     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16313
 16314
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 296
* EL6311.cbl
 16315* EXEC CICS DELETE
 16316*        DATASET    (FILE-ID-ERPNDB)
 16317*    END-EXEC.
 16318*    MOVE '&(                    &   #00014357' TO DFHEIV0
 16319     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16320     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16321     MOVE X'2020233030303134333537' TO DFHEIV0(25:11)
 16322     CALL 'kxdfhei1' USING DFHEIV0,
 16323           FILE-ID-ERPNDB,
 16324           DFHEIV99,
 16325           DFHEIV99,
 16326           DFHEIV99,
 16327           DFHEIV99
 16328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16329
 16330
 16331     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16332
 16333     PERFORM 8400-LOG-JOURNAL-RECORD.
 16334
 16335     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16336     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16337
 16338
 16339* EXEC CICS HANDLE CONDITION
 16340*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16341*    END-EXEC.
 16342*    MOVE '"$I                   ! ; #00014368' TO DFHEIV0
 16343     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16345     MOVE X'3B20233030303134333638' TO DFHEIV0(25:11)
 16346     CALL 'kxdfhei1' USING DFHEIV0
 16347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16348
 16349
 16350
 16351* EXEC CICS READ
 16352*        SET     (ADDRESS OF PENDING-BUSINESS)
 16353*        DATASET (FILE-ID-ERPNDB)
 16354*        RIDFLD  (ERPNDB-KEY)
 16355*        UPDATE
 16356*    END-EXEC.
 16357*    MOVE '&"S        EU         (   #00014372' TO DFHEIV0
 16358     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16359     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16360     MOVE X'2020233030303134333732' TO DFHEIV0(25:11)
 16361     CALL 'kxdfhei1' USING DFHEIV0,
 16362           FILE-ID-ERPNDB,
 16363           DFHEIV20,
 16364           DFHEIV99,
 16365           ERPNDB-KEY,
 16366           DFHEIV99,
 16367           DFHEIV99,
 16368           DFHEIV99
 16369     SET ADDRESS OF PENDING-BUSINESS TO
 16370         DFHEIV20
 16371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16372
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 297
* EL6311.cbl
 16373
 16374     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16375     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16376
 16377     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16378        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16379        MOVE 'D'                 TO JP-RECORD-TYPE
 16380        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16381
 16382* EXEC CICS DELETE
 16383*            DATASET    (FILE-ID-ERPNDB)
 16384*       END-EXEC
 16385*    MOVE '&(                    &   #00014386' TO DFHEIV0
 16386     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16387     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16388     MOVE X'2020233030303134333836' TO DFHEIV0(25:11)
 16389     CALL 'kxdfhei1' USING DFHEIV0,
 16390           FILE-ID-ERPNDB,
 16391           DFHEIV99,
 16392           DFHEIV99,
 16393           DFHEIV99,
 16394           DFHEIV99
 16395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16396        PERFORM 8400-LOG-JOURNAL-RECORD
 16397     ELSE
 16398        MOVE 'B'                 TO JP-RECORD-TYPE
 16399        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16400        PERFORM 8400-LOG-JOURNAL-RECORD
 16401        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16402        MOVE 'C'                 TO JP-RECORD-TYPE
 16403        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16404
 16405* EXEC CICS REWRITE
 16406*            DATASET    (FILE-ID-ERPNDB)
 16407*            FROM       (PENDING-BUSINESS)
 16408*       END-EXEC
 16409     MOVE LENGTH OF
 16410      PENDING-BUSINESS
 16411       TO DFHEIV11
 16412*    MOVE '&& L                  %   #00014397' TO DFHEIV0
 16413     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16414     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16415     MOVE X'2020233030303134333937' TO DFHEIV0(25:11)
 16416     CALL 'kxdfhei1' USING DFHEIV0,
 16417           FILE-ID-ERPNDB,
 16418           PENDING-BUSINESS,
 16419           DFHEIV11,
 16420           DFHEIV99
 16421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16422        PERFORM 8400-LOG-JOURNAL-RECORD.
 16423
 16424******************************************************************
 16425*                                                                *
 16426*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16427*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16428*                                                                *
 16429******************************************************************
 16430
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 298
* EL6311.cbl
 16431     IF NOT PI-AR-PROCESSING
 16432        GO TO 2480-DELETE-FINISHED.
 16433
 16434     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16435        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16436        NEXT SENTENCE
 16437     ELSE
 16438        GO TO 2480-DELETE-FINISHED.
 16439
 16440
 16441* EXEC CICS HANDLE CONDITION
 16442*         NOTFND    (2480-DELETE-FINISHED)
 16443*    END-EXEC.
 16444*    MOVE '"$I                   ! < #00014419' TO DFHEIV0
 16445     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16447     MOVE X'3C20233030303134343139' TO DFHEIV0(25:11)
 16448     CALL 'kxdfhei1' USING DFHEIV0
 16449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16450
 16451
 16452     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16453     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16454
 16455
 16456* EXEC CICS READ
 16457*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16458*        DATASET (FILE-ID-ERRQST)
 16459*        RIDFLD  (ERRQST-KEY)
 16460*        UPDATE
 16461*    END-EXEC.
 16462*    MOVE '&"S        EU         (   #00014426' TO DFHEIV0
 16463     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16464     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16465     MOVE X'2020233030303134343236' TO DFHEIV0(25:11)
 16466     CALL 'kxdfhei1' USING DFHEIV0,
 16467           FILE-ID-ERRQST,
 16468           DFHEIV20,
 16469           DFHEIV99,
 16470           ERRQST-KEY,
 16471           DFHEIV99,
 16472           DFHEIV99,
 16473           DFHEIV99
 16474     SET ADDRESS OF AR-REQUEST-RECORD TO
 16475         DFHEIV20
 16476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16477
 16478
 16479     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16480
 16481     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16482
 16483     MOVE 'D'                      TO JP-RECORD-TYPE.
 16484     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16485
 16486
 16487* EXEC CICS DELETE
 16488*         DATASET    (FILE-ID-ERRQST)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 299
* EL6311.cbl
 16489*    END-EXEC.
 16490*    MOVE '&(                    &   #00014440' TO DFHEIV0
 16491     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16492     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16493     MOVE X'2020233030303134343430' TO DFHEIV0(25:11)
 16494     CALL 'kxdfhei1' USING DFHEIV0,
 16495           FILE-ID-ERRQST,
 16496           DFHEIV99,
 16497           DFHEIV99,
 16498           DFHEIV99,
 16499           DFHEIV99
 16500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16501
 16502
 16503     PERFORM 8400-LOG-JOURNAL-RECORD.
 16504
 16505 2480-DELETE-FINISHED.
 16506     MOVE ZEROS                  TO EMI-ERROR.
 16507     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16508     MOVE LOW-VALUES             TO EL631CI.
 16509     MOVE -1                     TO CMAINTL.
 16510     GO TO 8100-SEND-INITIAL-MAP.
 16511
 16512 2485-BATCH-HDR-NOT-FOUND.
 16513     MOVE -1                     TO CMAINTL
 16514     MOVE AL-UABON               TO CMAINTA.
 16515     MOVE ER-7450                TO EMI-ERROR.
 16516     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16517     GO TO 8200-SEND-DATAONLY.
 16518
 16519 2490-RECORD-NOT-FOUND.
 16520     MOVE -1                     TO CMAINTL
 16521     MOVE AL-UABON               TO CMAINTA.
 16522     MOVE ER-7451                TO EMI-ERROR.
 16523     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16524     GO TO 8200-SEND-DATAONLY.
 16525***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16526***                                                            ***
 16527***     2500  B R O W S E   C H E C K S                        ***
 16528***  We perform this routine from 2 different places.          ***
 16529***  1. If the user changes the refund amount on a cancel, we  ***
 16530***    want to.........                                        ***
 16531***    a. determine if prior checks have been processed        ***
 16532***    b. If the amt is larger, display message instructing    ***
 16533***     them to create another check to make up the difference.***
 16534***    c. If the amt is less, do not allow the change and      ***
 16535***     display a FATAL error suggesting they deal with check  ***
 16536***     records befor continuing.                              ***
 16537***  2. If the user wants to delete a cancel record we......   ***
 16538***    a. browse through all the checks and if there is a      ***
 16539***     processed check, send FATAL message.                   ***
 16540***    b. If there is a non-released check, then delete that   ***
 16541***     check after you delete the pending cancel record.      ***
 16542***                                                            ***
 16543***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16544
 16545 2500-browse-checks.
 16546
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 300
* EL6311.cbl
 16547     perform 2510-startbr-erchek thru 2510-exit
 16548
 16549     if not resp-normal
 16550        go to 2500-exit
 16551     end-if
 16552
 16553     perform until i-say-stop
 16554        perform 2520-readnext-erchek
 16555                                 thru 2520-exit
 16556        if (not resp-normal)
 16557           or (pb-control-by-account (1:33) not =
 16558              ch-control-primary (1:33))
 16559              set i-say-stop to true
 16560        else
 16561           if (ch-approval-status) = ' '
 16562              and (ch-void-dt = low-values)
 16563              and (ch-released-dt = low-values)
 16564              set i-have-checks to true
 16565           else
 16566              if ch-void-dt = low-values
 16567                 set i-have-processed-checks to true
 16568              end-if
 16569           end-if
 16570           if (ch-credit-accept-dt = low-values)
 16571              and (ch-void-dt = low-values)
 16572              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16573              compute ws-check-amts = ws-check-amts +
 16574                 ch-amount-paid
 16575           end-if
 16576        end-if
 16577     end-perform
 16578
 16579     if ws-chek-browse-sw = 'Y'
 16580        perform 2525-endbr-erchek thru 2525-exit
 16581     end-if
 16582
 16583    .
 16584 2500-exit.
 16585     exit.
 16586
 16587 2510-startbr-erchek.
 16588
 16589     move pb-control-by-account  to erchek-key
 16590     move +0                     to chek-record-seq
 16591
 16592
 16593* exec cics startbr
 16594*       dataset   ('ERCHEK')
 16595*       ridfld    (erchek-key)
 16596*       gteq
 16597*       resp      (ws-response)
 16598*    end-exec
 16599     MOVE 'ERCHEK' TO DFHEIV1
 16600     MOVE 0
 16601       TO DFHEIV11
 16602*    MOVE '&,         G          &  N#00014533' TO DFHEIV0
 16603     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16604     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 301
* EL6311.cbl
 16605     MOVE X'204E233030303134353333' TO DFHEIV0(25:11)
 16606     CALL 'kxdfhei1' USING DFHEIV0,
 16607           DFHEIV1,
 16608           erchek-key,
 16609           DFHEIV99,
 16610           DFHEIV11,
 16611           DFHEIV99
 16612     MOVE EIBRESP  TO ws-response
 16613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16614
 16615     IF RESP-NORMAL
 16616        move 'Y'                 to ws-chek-browse-sw
 16617     end-if
 16618
 16619     .
 16620 2510-exit.
 16621     exit.
 16622
 16623 2520-readnext-erchek.
 16624
 16625
 16626* EXEC CICS READNEXT
 16627*       SET     (ADDRESS OF CHECK-RECORDS)
 16628*       DATASET ('ERCHEK')
 16629*       RIDFLD  (ERCHEK-KEY)
 16630*       RESP    (WS-RESPONSE)
 16631*    END-EXEC
 16632     MOVE 'ERCHEK' TO DFHEIV1
 16633     MOVE 0
 16634       TO DFHEIV11
 16635*    MOVE '&.S                   )  N#00014550' TO DFHEIV0
 16636     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16637     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16638     MOVE X'204E233030303134353530' TO DFHEIV0(25:11)
 16639     CALL 'kxdfhei1' USING DFHEIV0,
 16640           DFHEIV1,
 16641           DFHEIV20,
 16642           DFHEIV99,
 16643           ERCHEK-KEY,
 16644           DFHEIV99,
 16645           DFHEIV11,
 16646           DFHEIV99,
 16647           DFHEIV99
 16648     SET ADDRESS OF CHECK-RECORDS TO
 16649         DFHEIV20
 16650     MOVE EIBRESP  TO WS-RESPONSE
 16651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16652
 16653     .
 16654 2520-exit.
 16655     exit.
 16656
 16657 2525-endbr-erchek.
 16658
 16659
 16660* exec cics endbr
 16661*       dataset  ('ERCHEK')
 16662*    end-exec
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 302
* EL6311.cbl
 16663     MOVE 'ERCHEK' TO DFHEIV1
 16664     MOVE 0
 16665       TO DFHEIV11
 16666*    MOVE '&2                    $   #00014563' TO DFHEIV0
 16667     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16668     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16669     MOVE X'2020233030303134353633' TO DFHEIV0(25:11)
 16670     CALL 'kxdfhei1' USING DFHEIV0,
 16671           DFHEIV1,
 16672           DFHEIV11,
 16673           DFHEIV99
 16674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16675
 16676     .
 16677 2525-exit.
 16678     exit.
 16679
 16680 2530-readupd-erchek.
 16681
 16682
 16683* EXEC CICS READ
 16684*       UPDATE
 16685*       SET     (ADDRESS OF CHECK-RECORDS)
 16686*       DATASET ('ERCHEK')
 16687*       RIDFLD  (ERCHEK-KEY)
 16688*       RESP    (WS-RESPONSE)
 16689*    END-EXEC
 16690     MOVE 'ERCHEK' TO DFHEIV1
 16691*    MOVE '&"S        EU         (  N#00014573' TO DFHEIV0
 16692     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16693     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16694     MOVE X'204E233030303134353733' TO DFHEIV0(25:11)
 16695     CALL 'kxdfhei1' USING DFHEIV0,
 16696           DFHEIV1,
 16697           DFHEIV20,
 16698           DFHEIV99,
 16699           ERCHEK-KEY,
 16700           DFHEIV99,
 16701           DFHEIV99,
 16702           DFHEIV99
 16703     SET ADDRESS OF CHECK-RECORDS TO
 16704         DFHEIV20
 16705     MOVE EIBRESP  TO WS-RESPONSE
 16706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16707
 16708     .
 16709 2530-exit.
 16710     exit.
 16711
 16712 2540-delete-erchek.
 16713
 16714
 16715* EXEC CICS DELETE
 16716*       DATASET ('ERCHEK')
 16717*       RESP    (WS-RESPONSE)
 16718*    END-EXEC
 16719     MOVE 'ERCHEK' TO DFHEIV1
 16720*    MOVE '&(                    &  N#00014587' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 303
* EL6311.cbl
 16721     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16722     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16723     MOVE X'204E233030303134353837' TO DFHEIV0(25:11)
 16724     CALL 'kxdfhei1' USING DFHEIV0,
 16725           DFHEIV1,
 16726           DFHEIV99,
 16727           DFHEIV99,
 16728           DFHEIV99,
 16729           DFHEIV99
 16730     MOVE EIBRESP  TO WS-RESPONSE
 16731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16732
 16733     .
 16734 2540-exit.
 16735     exit.
 16736***************************************************************
 16737*                                                             *
 16738*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16739*                                                             *
 16740***************************************************************
 16741
 16742***************************************************************
 16743*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16744*     AN ALREADY BILLED RECORD.                               *
 16745***************************************************************
 16746
 16747 2700-BUILD-CORRECTION-RECORD.
 16748     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16749     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16750     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16751     MOVE '5'                    TO DC-OPTION-CODE.
 16752     PERFORM 9700-DATE-LINK.
 16753     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16754
 16755     IF PB-CHG-COUNT = ZEROS
 16756        MOVE +1                  TO WS-SEQ-SAVE
 16757     ELSE
 16758        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16759
 16760     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16761     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16762
 16763     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16764
 16765     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16766     MOVE 'A'                    TO JP-RECORD-TYPE.
 16767     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16768
 16769
 16770* EXEC CICS WRITE
 16771*        DATASET    (FILE-ID-ERPNDB)
 16772*        FROM       (PENDING-BUSINESS)
 16773*        RIDFLD     (PB-CONTROL-PRIMARY)
 16774*    END-EXEC.
 16775     MOVE LENGTH OF
 16776      PENDING-BUSINESS
 16777       TO DFHEIV11
 16778*    MOVE '&$ L                  ''   #00014628' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 304
* EL6311.cbl
 16779     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16780     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16781     MOVE X'2020233030303134363238' TO DFHEIV0(25:11)
 16782     CALL 'kxdfhei1' USING DFHEIV0,
 16783           FILE-ID-ERPNDB,
 16784           PENDING-BUSINESS,
 16785           DFHEIV11,
 16786           PB-CONTROL-PRIMARY,
 16787           DFHEIV99,
 16788           DFHEIV99
 16789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16790
 16791
 16792     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16793
 16794     PERFORM 8400-LOG-JOURNAL-RECORD.
 16795
 16796 2799-EXIT.
 16797      EXIT.
 16798
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 305
* EL6311.cbl
 16800
 16801******************************************************************
 16802*                                                                *
 16803*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16804*                                                                *
 16805******************************************************************
 16806
 16807 2800-REWRITE-ISSUE-CERT-KEY.
 16808     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16809
 16810     IF  BCERTNOL GREATER THAN ZEROS
 16811         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16812
 16813     IF  BSUFIXL  GREATER THAN ZEROS
 16814         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16815
 16816     IF  BEFFDTL  GREATER THAN ZEROS
 16817         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16818
 16819 2810-READ-BY-ACCOUNT.
 16820
 16821* EXEC CICS HANDLE CONDITION
 16822*         NOTFND    (2820-PROCESS-REWRITE)
 16823*    END-EXEC.
 16824*    MOVE '"$I                   ! = #00014662' TO DFHEIV0
 16825     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16827     MOVE X'3D20233030303134363632' TO DFHEIV0(25:11)
 16828     CALL 'kxdfhei1' USING DFHEIV0
 16829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16830
 16831
 16832
 16833* EXEC CICS READ
 16834*        SET     (ADDRESS OF PENDING-BUSINESS)
 16835*        DATASET (FILE-ID-ERPNDB2)
 16836*        RIDFLD  (ERPNDB-ALT-KEY)
 16837*    END-EXEC.
 16838*    MOVE '&"S        E          (   #00014666' TO DFHEIV0
 16839     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16841     MOVE X'2020233030303134363636' TO DFHEIV0(25:11)
 16842     CALL 'kxdfhei1' USING DFHEIV0,
 16843           FILE-ID-ERPNDB2,
 16844           DFHEIV20,
 16845           DFHEIV99,
 16846           ERPNDB-ALT-KEY,
 16847           DFHEIV99,
 16848           DFHEIV99,
 16849           DFHEIV99
 16850     SET ADDRESS OF PENDING-BUSINESS TO
 16851         DFHEIV20
 16852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16853
 16854
 16855     GO TO 2890-DUPLICATE-RECORD.
 16856
 16857  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 306
* EL6311.cbl
 16858
 16859* EXEC CICS HANDLE CONDITION
 16860*         NOTFND    (2885-RECORD-MISSING)
 16861*    END-EXEC.
 16862*    MOVE '"$I                   ! > #00014675' TO DFHEIV0
 16863     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16865     MOVE X'3E20233030303134363735' TO DFHEIV0(25:11)
 16866     CALL 'kxdfhei1' USING DFHEIV0
 16867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16868
 16869
 16870     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16871
 16872
 16873* EXEC CICS READ
 16874*        SET     (ADDRESS OF PENDING-BUSINESS)
 16875*        DATASET (FILE-ID-ERPNDB)
 16876*        RIDFLD  (ERPNDB-KEY)
 16877*        UPDATE
 16878*    END-EXEC.
 16879*    MOVE '&"S        EU         (   #00014681' TO DFHEIV0
 16880     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16881     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16882     MOVE X'2020233030303134363831' TO DFHEIV0(25:11)
 16883     CALL 'kxdfhei1' USING DFHEIV0,
 16884           FILE-ID-ERPNDB,
 16885           DFHEIV20,
 16886           DFHEIV99,
 16887           ERPNDB-KEY,
 16888           DFHEIV99,
 16889           DFHEIV99,
 16890           DFHEIV99
 16891     SET ADDRESS OF PENDING-BUSINESS TO
 16892         DFHEIV20
 16893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16894
 16895
 16896     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16897     MOVE 'D'                    TO JP-RECORD-TYPE.
 16898     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16899     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16900
 16901     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16902
 16903     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16904     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16905     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16906
 16907
 16908* EXEC CICS DELETE
 16909*        DATASET    (FILE-ID-ERPNDB)
 16910*    END-EXEC.
 16911*    MOVE '&(                    &   #00014699' TO DFHEIV0
 16912     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16913     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16914     MOVE X'2020233030303134363939' TO DFHEIV0(25:11)
 16915     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 307
* EL6311.cbl
 16916           FILE-ID-ERPNDB,
 16917           DFHEIV99,
 16918           DFHEIV99,
 16919           DFHEIV99,
 16920           DFHEIV99
 16921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16922
 16923
 16924     PERFORM 8400-LOG-JOURNAL-RECORD.
 16925
 16926
 16927* EXEC CICS GETMAIN
 16928*        SET      (ADDRESS OF PENDING-BUSINESS)
 16929*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16930*        INITIMG  (GETMAIN-SPACE)
 16931*    END-EXEC.
 16932*    MOVE ',"IL                  $   #00014705' TO DFHEIV0
 16933     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16934     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16935     MOVE X'2020233030303134373035' TO DFHEIV0(25:11)
 16936     CALL 'kxdfhei1' USING DFHEIV0,
 16937           DFHEIV20,
 16938           ERPNDB-RECORD-LENGTH,
 16939           GETMAIN-SPACE
 16940     SET ADDRESS OF PENDING-BUSINESS TO
 16941         DFHEIV20
 16942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16943
 16944
 16945     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16946
 16947
 16948* EXEC CICS HANDLE CONDITION
 16949*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16950*    END-EXEC.
 16951*    MOVE '"$I                   ! ? #00014713' TO DFHEIV0
 16952     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16954     MOVE X'3F20233030303134373133' TO DFHEIV0(25:11)
 16955     CALL 'kxdfhei1' USING DFHEIV0
 16956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16957
 16958
 16959
 16960* EXEC CICS READ
 16961*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16962*        DATASET (FILE-ID-ELCERT)
 16963*        RIDFLD  (ELCERT-KEY)
 16964*        UPDATE
 16965*    END-EXEC.
 16966*    MOVE '&"S        EU         (   #00014717' TO DFHEIV0
 16967     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16968     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16969     MOVE X'2020233030303134373137' TO DFHEIV0(25:11)
 16970     CALL 'kxdfhei1' USING DFHEIV0,
 16971           FILE-ID-ELCERT,
 16972           DFHEIV20,
 16973           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 308
* EL6311.cbl
 16974           ELCERT-KEY,
 16975           DFHEIV99,
 16976           DFHEIV99,
 16977           DFHEIV99
 16978     SET ADDRESS OF CERTIFICATE-MASTER TO
 16979         DFHEIV20
 16980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16981
 16982
 16983     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16984     MOVE 'B'                    TO JP-RECORD-TYPE
 16985     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16986     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16987
 16988     IF INSURED-ADDR-PRESENT
 16989        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16990
 16991     IF CERT-NOTES-ARE-NOT-PRESENT
 16992        MOVE SPACE               TO WS-CERT-NOTE-SW
 16993     ELSE
 16994        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16995
 16996     IF CERT-ADDED-BATCH      OR
 16997        CERT-AND-CLAIM-ONLINE OR
 16998        CERT-WAS-CREATED-FOR-CLAIM
 16999        NEXT SENTENCE
 17000     ELSE
 17001        GO TO 2825-DELETE-CERTIFICATE.
 17002
 17003     PERFORM 8400-LOG-JOURNAL-RECORD.
 17004
 17005*********************************************************
 17006** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17007     IF CERT-ADDED-BATCH
 17008         GO TO 2822-REWRITE-ELCERT.
 17009*********************************************************
 17010
 17011     IF NO-CLAIM-ATTACHED
 17012        NEXT SENTENCE
 17013     ELSE
 17014        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17015        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17016
 17017 2822-REWRITE-ELCERT.
 17018     MOVE 'C'                    TO JP-RECORD-TYPE
 17019     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17020
 17021     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17022
 17023
 17024* EXEC CICS REWRITE
 17025*         DATASET    (FILE-ID-ELCERT)
 17026*         FROM       (CERTIFICATE-MASTER)
 17027*    END-EXEC.
 17028     MOVE LENGTH OF
 17029      CERTIFICATE-MASTER
 17030       TO DFHEIV11
 17031*    MOVE '&& L                  %   #00014764' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 309
* EL6311.cbl
 17032     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17033     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17034     MOVE X'2020233030303134373634' TO DFHEIV0(25:11)
 17035     CALL 'kxdfhei1' USING DFHEIV0,
 17036           FILE-ID-ELCERT,
 17037           CERTIFICATE-MASTER,
 17038           DFHEIV11,
 17039           DFHEIV99
 17040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17041
 17042
 17043     PERFORM 8400-LOG-JOURNAL-RECORD.
 17044
 17045     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17046
 17047 2825-DELETE-CERTIFICATE.
 17048     MOVE 'D'                      TO JP-RECORD-TYPE.
 17049     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17050
 17051     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17052
 17053
 17054* EXEC CICS DELETE
 17055*         DATASET    (FILE-ID-ELCERT)
 17056*    END-EXEC.
 17057*    MOVE '&(                    &   #00014779' TO DFHEIV0
 17058     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17059     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17060     MOVE X'2020233030303134373739' TO DFHEIV0(25:11)
 17061     CALL 'kxdfhei1' USING DFHEIV0,
 17062           FILE-ID-ELCERT,
 17063           DFHEIV99,
 17064           DFHEIV99,
 17065           DFHEIV99,
 17066           DFHEIV99
 17067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17068
 17069
 17070     PERFORM 8400-LOG-JOURNAL-RECORD.
 17071
 17072******************************************************************
 17073*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17074******************************************************************
 17075
 17076     IF CERT-NOTES-ARE-PRESENT
 17077        NEXT SENTENCE
 17078     ELSE
 17079        GO TO 2827-DELETE-MAILING.
 17080
 17081
 17082* EXEC CICS HANDLE CONDITION
 17083*         NOTFND  (2827-DELETE-MAILING)
 17084*    END-EXEC.
 17085*    MOVE '"$I                   ! @ #00014794' TO DFHEIV0
 17086     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17088     MOVE X'4020233030303134373934' TO DFHEIV0(25:11)
 17089     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 310
* EL6311.cbl
 17090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17091
 17092
 17093
 17094* EXEC CICS READ
 17095*        EQUAL
 17096*        DATASET   (FILE-ID-ERNOTE)
 17097*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17098*        RIDFLD    (ELCERT-KEY)
 17099*        UPDATE
 17100*    END-EXEC.
 17101*    MOVE '&"S        EU         (   #00014798' TO DFHEIV0
 17102     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17103     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17104     MOVE X'2020233030303134373938' TO DFHEIV0(25:11)
 17105     CALL 'kxdfhei1' USING DFHEIV0,
 17106           FILE-ID-ERNOTE,
 17107           DFHEIV20,
 17108           DFHEIV99,
 17109           ELCERT-KEY,
 17110           DFHEIV99,
 17111           DFHEIV99,
 17112           DFHEIV99
 17113     SET ADDRESS OF CERTIFICATE-NOTE TO
 17114         DFHEIV20
 17115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17116
 17117
 17118     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17119     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17120     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17121
 17122     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17123
 17124
 17125* EXEC CICS DELETE
 17126*        DATASET   (FILE-ID-ERNOTE)
 17127*    END-EXEC.
 17128*    MOVE '&(                    &   #00014812' TO DFHEIV0
 17129     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17130     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17131     MOVE X'2020233030303134383132' TO DFHEIV0(25:11)
 17132     CALL 'kxdfhei1' USING DFHEIV0,
 17133           FILE-ID-ERNOTE,
 17134           DFHEIV99,
 17135           DFHEIV99,
 17136           DFHEIV99,
 17137           DFHEIV99
 17138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17139
 17140
 17141     PERFORM 8400-LOG-JOURNAL-RECORD.
 17142
 17143******************************************************************
 17144*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17145******************************************************************
 17146
 17147 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 311
* EL6311.cbl
 17148     IF CERT-ADDRESS-PRESENT
 17149        NEXT SENTENCE
 17150     ELSE
 17151        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17152
 17153
 17154* EXEC CICS HANDLE CONDITION
 17155*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17156*    END-EXEC.
 17157*    MOVE '"$I                   ! A #00014828' TO DFHEIV0
 17158     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17160     MOVE X'4120233030303134383238' TO DFHEIV0(25:11)
 17161     CALL 'kxdfhei1' USING DFHEIV0
 17162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17163
 17164
 17165     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17166
 17167
 17168* EXEC CICS READ
 17169*        EQUAL
 17170*        DATASET   (FILE-ID-ERMAIL)
 17171*        SET       (ADDRESS OF MAILING-DATA)
 17172*        RIDFLD    (ERMAIL-KEY)
 17173*        UPDATE
 17174*    END-EXEC.
 17175*    MOVE '&"S        EU         (   #00014834' TO DFHEIV0
 17176     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17177     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17178     MOVE X'2020233030303134383334' TO DFHEIV0(25:11)
 17179     CALL 'kxdfhei1' USING DFHEIV0,
 17180           FILE-ID-ERMAIL,
 17181           DFHEIV20,
 17182           DFHEIV99,
 17183           ERMAIL-KEY,
 17184           DFHEIV99,
 17185           DFHEIV99,
 17186           DFHEIV99
 17187     SET ADDRESS OF MAILING-DATA TO
 17188         DFHEIV20
 17189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17190
 17191
 17192     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17193     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17194     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17195
 17196     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17197
 17198
 17199* EXEC CICS DELETE
 17200*        DATASET   (FILE-ID-ERMAIL)
 17201*    END-EXEC.
 17202*    MOVE '&(                    &   #00014848' TO DFHEIV0
 17203     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17204     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17205     MOVE X'2020233030303134383438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 312
* EL6311.cbl
 17206     CALL 'kxdfhei1' USING DFHEIV0,
 17207           FILE-ID-ERMAIL,
 17208           DFHEIV99,
 17209           DFHEIV99,
 17210           DFHEIV99,
 17211           DFHEIV99
 17212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17213
 17214
 17215     PERFORM 8400-LOG-JOURNAL-RECORD.
 17216
 17217 2830-BUILD-NEW-ISSUE-RECORD.
 17218     MOVE SPACES                 TO ELCERT-KEY.
 17219
 17220     IF  BCERTNOL GREATER THAN ZEROS
 17221         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17222
 17223     IF  BSUFIXL  GREATER THAN ZEROS
 17224         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17225
 17226     IF BEFFDTL GREATER THAN ZEROS
 17227        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17228
 17229 2870-WRITE-PENDING-BUSINESS.
 17230     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17231     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17232     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17233     MOVE '5'                    TO DC-OPTION-CODE.
 17234     PERFORM 9700-DATE-LINK.
 17235     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17236
 17237     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17238
 17239     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17240     MOVE 'A'                    TO JP-RECORD-TYPE.
 17241     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17242
 17243
 17244* EXEC CICS WRITE
 17245*        DATASET  (FILE-ID-ERPNDB)
 17246*        FROM     (PENDING-BUSINESS)
 17247*        RIDFLD   (PB-CONTROL-PRIMARY)
 17248*    END-EXEC.
 17249     MOVE LENGTH OF
 17250      PENDING-BUSINESS
 17251       TO DFHEIV11
 17252*    MOVE '&$ L                  ''   #00014880' TO DFHEIV0
 17253     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17254     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17255     MOVE X'2020233030303134383830' TO DFHEIV0(25:11)
 17256     CALL 'kxdfhei1' USING DFHEIV0,
 17257           FILE-ID-ERPNDB,
 17258           PENDING-BUSINESS,
 17259           DFHEIV11,
 17260           PB-CONTROL-PRIMARY,
 17261           DFHEIV99,
 17262           DFHEIV99
 17263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 313
* EL6311.cbl
 17264
 17265
 17266     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17267
 17268     PERFORM 8400-LOG-JOURNAL-RECORD.
 17269
 17270     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17271
 17272 2885-RECORD-MISSING.
 17273     MOVE -1                     TO BMAINTL
 17274     MOVE AL-UABON               TO BMAINTA
 17275     MOVE ER-2902                TO EMI-ERROR.
 17276     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17277     GO TO 8200-SEND-DATAONLY.
 17278
 17279 2890-DUPLICATE-RECORD.
 17280     MOVE -1                     TO BMAINTL.
 17281     MOVE AL-UABON               TO BCERTNOA.
 17282     MOVE AL-UNBON               TO BEFFDTA.
 17283     MOVE SPACE                  TO BMAINTI.
 17284
 17285     MOVE 1                      TO EMI-SUB
 17286                                    EMI-SWITCH1
 17287                                    EMI-SWITCH-AREA-1
 17288                                    EMI-SWITCH-AREA-2.
 17289
 17290     MOVE SPACES                 TO EMI-ERROR-LINES.
 17291
 17292
 17293* EXEC CICS SYNCPOINT ROLLBACK
 17294*    END-EXEC.
 17295*    MOVE '6"R                   !   #00014912' TO DFHEIV0
 17296     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17298     MOVE X'2020233030303134393132' TO DFHEIV0(25:11)
 17299     CALL 'kxdfhei1' USING DFHEIV0
 17300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17301
 17302
 17303     MOVE ER-2247                TO EMI-ERROR.
 17304     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17305     GO TO 8200-SEND-DATAONLY.
 17306
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 314
* EL6311.cbl
 17308
 17309******************************************************************
 17310*                                                                *
 17311*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17312*                                                                *
 17313******************************************************************
 17314
 17315 2900-REWRITE-CAN-CERT-KEY.
 17316     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17317
 17318     IF  CCERTNOL GREATER THAN ZEROS
 17319         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17320
 17321     IF  CSUFIXL  GREATER THAN ZEROS
 17322         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17323
 17324     IF  CEFFDTL  GREATER THAN ZEROS
 17325         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17326
 17327 2910-READ-BY-ACCOUNT.
 17328
 17329* EXEC CICS HANDLE CONDITION
 17330*         NOTFND    (2920-PROCESS-REWRITE)
 17331*    END-EXEC.
 17332*    MOVE '"$I                   ! B #00014940' TO DFHEIV0
 17333     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17335     MOVE X'4220233030303134393430' TO DFHEIV0(25:11)
 17336     CALL 'kxdfhei1' USING DFHEIV0
 17337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17338
 17339
 17340
 17341* EXEC CICS READ
 17342*        SET     (ADDRESS OF PENDING-BUSINESS)
 17343*        DATASET (FILE-ID-ERPNDB2)
 17344*        RIDFLD  (ERPNDB-ALT-KEY)
 17345*    END-EXEC.
 17346*    MOVE '&"S        E          (   #00014944' TO DFHEIV0
 17347     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17349     MOVE X'2020233030303134393434' TO DFHEIV0(25:11)
 17350     CALL 'kxdfhei1' USING DFHEIV0,
 17351           FILE-ID-ERPNDB2,
 17352           DFHEIV20,
 17353           DFHEIV99,
 17354           ERPNDB-ALT-KEY,
 17355           DFHEIV99,
 17356           DFHEIV99,
 17357           DFHEIV99
 17358     SET ADDRESS OF PENDING-BUSINESS TO
 17359         DFHEIV20
 17360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17361
 17362
 17363     GO TO 2990-DUPLICATE-RECORD.
 17364
 17365  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 315
* EL6311.cbl
 17366
 17367* EXEC CICS HANDLE CONDITION
 17368*         NOTFND    (2985-RECORD-MISSING)
 17369*    END-EXEC.
 17370*    MOVE '"$I                   ! C #00014953' TO DFHEIV0
 17371     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17372     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17373     MOVE X'4320233030303134393533' TO DFHEIV0(25:11)
 17374     CALL 'kxdfhei1' USING DFHEIV0
 17375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17376
 17377
 17378     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17379
 17380
 17381* EXEC CICS READ
 17382*        SET     (ADDRESS OF PENDING-BUSINESS)
 17383*        DATASET (FILE-ID-ERPNDB)
 17384*        RIDFLD  (ERPNDB-KEY)
 17385*        UPDATE
 17386*    END-EXEC.
 17387*    MOVE '&"S        EU         (   #00014959' TO DFHEIV0
 17388     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17389     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17390     MOVE X'2020233030303134393539' TO DFHEIV0(25:11)
 17391     CALL 'kxdfhei1' USING DFHEIV0,
 17392           FILE-ID-ERPNDB,
 17393           DFHEIV20,
 17394           DFHEIV99,
 17395           ERPNDB-KEY,
 17396           DFHEIV99,
 17397           DFHEIV99,
 17398           DFHEIV99
 17399     SET ADDRESS OF PENDING-BUSINESS TO
 17400         DFHEIV20
 17401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17402
 17403
 17404     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17405     MOVE 'D'                    TO JP-RECORD-TYPE.
 17406     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17407     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17408
 17409     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17410
 17411     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17412     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17413     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17414
 17415
 17416* EXEC CICS DELETE
 17417*        DATASET    (FILE-ID-ERPNDB)
 17418*    END-EXEC.
 17419*    MOVE '&(                    &   #00014977' TO DFHEIV0
 17420     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17422     MOVE X'2020233030303134393737' TO DFHEIV0(25:11)
 17423     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 316
* EL6311.cbl
 17424           FILE-ID-ERPNDB,
 17425           DFHEIV99,
 17426           DFHEIV99,
 17427           DFHEIV99,
 17428           DFHEIV99
 17429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17430
 17431
 17432     PERFORM 8400-LOG-JOURNAL-RECORD.
 17433
 17434
 17435* EXEC CICS GETMAIN
 17436*        SET      (ADDRESS OF PENDING-BUSINESS)
 17437*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17438*        INITIMG  (GETMAIN-SPACE)
 17439*    END-EXEC.
 17440*    MOVE ',"IL                  $   #00014983' TO DFHEIV0
 17441     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17442     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17443     MOVE X'2020233030303134393833' TO DFHEIV0(25:11)
 17444     CALL 'kxdfhei1' USING DFHEIV0,
 17445           DFHEIV20,
 17446           ERPNDB-RECORD-LENGTH,
 17447           GETMAIN-SPACE
 17448     SET ADDRESS OF PENDING-BUSINESS TO
 17449         DFHEIV20
 17450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17451
 17452
 17453     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17454
 17455 2950-PROCESS-CANCELS.
 17456
 17457
 17458* EXEC CICS HANDLE CONDITION
 17459*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17460*    END-EXEC.
 17461*    MOVE '"$I                   ! D #00014993' TO DFHEIV0
 17462     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17463     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17464     MOVE X'4420233030303134393933' TO DFHEIV0(25:11)
 17465     CALL 'kxdfhei1' USING DFHEIV0
 17466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17467
 17468
 17469
 17470* EXEC CICS READ
 17471*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17472*        DATASET (FILE-ID-ELCERT)
 17473*        RIDFLD  (ELCERT-KEY)
 17474*        UPDATE
 17475*    END-EXEC.
 17476*    MOVE '&"S        EU         (   #00014997' TO DFHEIV0
 17477     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17478     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17479     MOVE X'2020233030303134393937' TO DFHEIV0(25:11)
 17480     CALL 'kxdfhei1' USING DFHEIV0,
 17481           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 317
* EL6311.cbl
 17482           DFHEIV20,
 17483           DFHEIV99,
 17484           ELCERT-KEY,
 17485           DFHEIV99,
 17486           DFHEIV99,
 17487           DFHEIV99
 17488     SET ADDRESS OF CERTIFICATE-MASTER TO
 17489         DFHEIV20
 17490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17491
 17492
 17493     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17494
 17495     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17496     MOVE 'B'                      TO JP-RECORD-TYPE.
 17497     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17498     PERFORM 8400-LOG-JOURNAL-RECORD.
 17499
 17500     IF PB-CI-LIVES NOT NUMERIC
 17501         MOVE ZERO                    TO PB-CI-LIVES.
 17502
 17503     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17504        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17505        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17506        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17507                                         CM-LF-CANCEL-DT
 17508     ELSE
 17509        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17510        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17511        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17512        MOVE PB-CI-LIVES              TO CM-LIVES.
 17513
 17514     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17515        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17516            MOVE CM-LF-STATUS-AT-CANCEL
 17517                                     TO CM-LF-CURRENT-STATUS
 17518            MOVE SPACE
 17519                                     TO CM-LF-STATUS-AT-CANCEL
 17520        ELSE
 17521            MOVE PB-CI-LF-POLICY-STATUS
 17522                                     TO CM-LF-CURRENT-STATUS
 17523     ELSE
 17524        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17525
 17526     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17527        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17528        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17529        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17530                                         CM-AH-CANCEL-DT
 17531     ELSE
 17532        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17533        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17534        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17535        MOVE PB-CI-LIVES              TO CM-LIVES.
 17536
 17537     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17538        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17539            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 318
* EL6311.cbl
 17540                                     TO CM-AH-CURRENT-STATUS
 17541            MOVE SPACE
 17542                                     TO CM-AH-STATUS-AT-CANCEL
 17543        ELSE
 17544            MOVE PB-CI-AH-POLICY-STATUS
 17545                                     TO CM-AH-CURRENT-STATUS
 17546     ELSE
 17547        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17548
 17549 2975-REWRITE-CERT.
 17550     MOVE 'C'                      TO JP-RECORD-TYPE.
 17551     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17552
 17553
 17554* EXEC CICS REWRITE
 17555*        DATASET    (FILE-ID-ELCERT)
 17556*        FROM       (CERTIFICATE-MASTER)
 17557*    END-EXEC.
 17558     MOVE LENGTH OF
 17559      CERTIFICATE-MASTER
 17560       TO DFHEIV11
 17561*    MOVE '&& L                  %   #00015064' TO DFHEIV0
 17562     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17563     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17564     MOVE X'2020233030303135303634' TO DFHEIV0(25:11)
 17565     CALL 'kxdfhei1' USING DFHEIV0,
 17566           FILE-ID-ELCERT,
 17567           CERTIFICATE-MASTER,
 17568           DFHEIV11,
 17569           DFHEIV99
 17570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17571
 17572
 17573     PERFORM 8400-LOG-JOURNAL-RECORD.
 17574
 17575 2960-BUILD-NEW-CANCEL-RECORD.
 17576     IF  CCERTNOL GREATER THAN ZEROS
 17577         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17578
 17579     IF  CSUFIXL  GREATER THAN ZEROS
 17580         MOVE CSUFIXI             TO PB-CERT-SFX.
 17581
 17582     IF  CEFFDTL  GREATER  THAN ZEROS
 17583         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17584
 17585 2970-WRITE-PENDING-BUSINESS.
 17586     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17587     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17588     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17589     MOVE '5'                    TO DC-OPTION-CODE.
 17590     PERFORM 9700-DATE-LINK.
 17591     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17592
 17593     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17594
 17595     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17596                                    PB-CI-INSURED-SEX
 17597                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 319
* EL6311.cbl
 17598                                    PB-CI-AH-BENEFIT-CD
 17599                                    PB-CI-RATE-CLASS
 17600                                    PB-CI-RATE-DEV-LF
 17601                                    PB-CI-RATE-DEV-AH
 17602                                    PB-CI-LF-ABBR
 17603                                    PB-CI-AH-ABBR
 17604                                    PB-CI-OB-FLAG
 17605                                    PB-CI-LF-POLICY-STATUS
 17606                                    PB-CI-AH-POLICY-STATUS
 17607                                    PB-CI-INDV-GRP-CD
 17608                                    PB-CI-BENEFICIARY-NAME
 17609                                    PB-CI-NOTE-SW
 17610                                    PB-CI-SOC-SEC-NO
 17611                                    PB-CI-MEMBER-NO
 17612                                    PB-CI-INT-CODE
 17613                                    PB-CI-COMP-EXCP-SW
 17614                                    PB-CI-ENTRY-STATUS
 17615                                    PB-CI-CREDIT-INTERFACE-SW-1
 17616                                    PB-CI-CREDIT-INTERFACE-SW-2
 17617                                    PB-CI-ENTRY-BATCH.
 17618
 17619     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17620                                    PB-CI-AH-SETTLEMENT-DT
 17621                                    PB-CI-DEATH-DT
 17622                                    PB-CI-LF-PRIOR-CANCEL-DT
 17623                                    PB-CI-AH-PRIOR-CANCEL-DT
 17624                                    PB-CI-LOAN-1ST-PMT-DT
 17625                                    PB-CI-ENTRY-DT
 17626                                    PB-CI-LF-EXPIRE-DT
 17627                                    PB-CI-AH-EXPIRE-DT.
 17628
 17629     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17630                                    PB-CI-LF-TERM
 17631                                    PB-CI-LF-BENEFIT-AMT
 17632                                    PB-CI-LF-ALT-BENEFIT-AMT
 17633                                    PB-CI-LF-PREMIUM-AMT
 17634                                    PB-CI-LF-ALT-PREMIUM-AMT
 17635                                    PB-CI-AH-TERM
 17636                                    PB-CI-AH-BENEFIT-AMT
 17637                                    PB-CI-AH-PREMIUM-AMT
 17638                                    PB-CI-RATE-DEV-PCT-LF
 17639                                    PB-CI-RATE-DEV-PCT-AH
 17640                                    PB-CI-LIFE-COMMISSION
 17641                                    PB-CI-AH-COMMISSION
 17642                                    PB-CI-PAY-FREQUENCY
 17643                                    PB-CI-LOAN-APR
 17644                                    PB-CI-LOAN-TERM
 17645                                    PB-CI-CURR-SEQ
 17646                                    PB-CI-AH-CANCEL-AMT
 17647                                    PB-CI-LF-CANCEL-AMT
 17648                                    PB-CI-EXTENTION-DAYS
 17649                                    PB-CI-TERM-IN-DAYS
 17650                                    PB-CI-LOAN-OFFICER
 17651                                    PB-CI-LIVES
 17652                                    PB-CI-LF-CRIT-PER
 17653                                    PB-CI-AH-CRIT-PER
 17654                                    PB-C-LF-REM-TERM
 17655                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 320
* EL6311.cbl
 17656
 17657     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17658     MOVE 'A'                    TO JP-RECORD-TYPE.
 17659     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17660
 17661
 17662* EXEC CICS HANDLE CONDITION
 17663*        DUPREC   (2990-DUPLICATE-RECORD)
 17664*    END-EXEC.
 17665*    MOVE '"$%                   ! E #00015157' TO DFHEIV0
 17666     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17668     MOVE X'4520233030303135313537' TO DFHEIV0(25:11)
 17669     CALL 'kxdfhei1' USING DFHEIV0
 17670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17671
 17672
 17673
 17674* EXEC CICS WRITE
 17675*        DATASET  (FILE-ID-ERPNDB)
 17676*        FROM     (PENDING-BUSINESS)
 17677*        RIDFLD   (PB-CONTROL-PRIMARY)
 17678*    END-EXEC.
 17679     MOVE LENGTH OF
 17680      PENDING-BUSINESS
 17681       TO DFHEIV11
 17682*    MOVE '&$ L                  ''   #00015161' TO DFHEIV0
 17683     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17684     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17685     MOVE X'2020233030303135313631' TO DFHEIV0(25:11)
 17686     CALL 'kxdfhei1' USING DFHEIV0,
 17687           FILE-ID-ERPNDB,
 17688           PENDING-BUSINESS,
 17689           DFHEIV11,
 17690           PB-CONTROL-PRIMARY,
 17691           DFHEIV99,
 17692           DFHEIV99
 17693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17694
 17695
 17696     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17697
 17698     PERFORM 8400-LOG-JOURNAL-RECORD.
 17699
 17700     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17701
 17702 2985-RECORD-MISSING.
 17703     MOVE -1                     TO CMAINTL
 17704     MOVE AL-UABON               TO CMAINTA.
 17705
 17706     MOVE ER-2902                TO EMI-ERROR.
 17707     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17708     GO TO 8200-SEND-DATAONLY.
 17709
 17710 2990-DUPLICATE-RECORD.
 17711     MOVE SPACE                  TO CMAINTI.
 17712     MOVE -1                     TO CMAINTL.
 17713     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 321
* EL6311.cbl
 17714     MOVE AL-UNBON               TO CEFFDTA.
 17715
 17716     MOVE 1                      TO EMI-SUB
 17717                                    EMI-SWITCH1
 17718                                    EMI-SWITCH-AREA-1
 17719                                    EMI-SWITCH-AREA-2.
 17720     MOVE SPACES                 TO EMI-ERROR-LINES.
 17721
 17722
 17723* EXEC CICS SYNCPOINT ROLLBACK
 17724*    END-EXEC.
 17725*    MOVE '6"R                   !   #00015193' TO DFHEIV0
 17726     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17727     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17728     MOVE X'2020233030303135313933' TO DFHEIV0(25:11)
 17729     CALL 'kxdfhei1' USING DFHEIV0
 17730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17731
 17732
 17733     MOVE ER-2247                TO EMI-ERROR.
 17734     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17735     GO TO 8200-SEND-DATAONLY.
 17736
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 322
* EL6311.cbl
 17738
 17739***************************************************************
 17740*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17741*     PREMIUM FOR A SINGLE BATCH.                             *
 17742*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17743***************************************************************
 17744
 17745 3000-BATCH-MAINLINE.
 17746     IF PI-PREV-KEY NOT = SPACES
 17747         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17748     ELSE
 17749         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17750
 17751     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17752
 17753 3010-READNEXT.
 17754
 17755* EXEC CICS READ
 17756*         DATASET    (FILE-ID-ERPNDB)
 17757*         SET        (ADDRESS OF PENDING-BUSINESS)
 17758*         RIDFLD     (ERPNDB-KEY)
 17759*         GTEQ
 17760*    END-EXEC.
 17761*    MOVE '&"S        G          (   #00015217' TO DFHEIV0
 17762     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17764     MOVE X'2020233030303135323137' TO DFHEIV0(25:11)
 17765     CALL 'kxdfhei1' USING DFHEIV0,
 17766           FILE-ID-ERPNDB,
 17767           DFHEIV20,
 17768           DFHEIV99,
 17769           ERPNDB-KEY,
 17770           DFHEIV99,
 17771           DFHEIV99,
 17772           DFHEIV99
 17773     SET ADDRESS OF PENDING-BUSINESS TO
 17774         DFHEIV20
 17775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17776
 17777
 17778     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17779        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17780          GO TO 3030-END-BATCH.
 17781
 17782     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17783
 17784     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17785        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17786          GO TO 3020-BUMP-SEQ.
 17787
 17788     IF PB-ISSUE
 17789        ADD +1                   TO WS-ISS-TOTAL-CNT
 17790        IF PB-FATAL-ERRORS
 17791           ADD +1                      TO WS-ISS-FATAL-CNT
 17792           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17793           GO TO 3020-BUMP-SEQ
 17794        ELSE
 17795           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 323
* EL6311.cbl
 17796              ADD +1                      TO WS-ISS-FORCE-CNT
 17797              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17798              GO TO 3020-BUMP-SEQ
 17799           ELSE
 17800              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17801                 ADD +1                      TO WS-ISS-HOLD-CNT
 17802                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17803                 GO TO 3020-BUMP-SEQ
 17804              ELSE
 17805                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17806                     THRU  3299-EXIT
 17807                 GO TO 3020-BUMP-SEQ.
 17808
 17809     IF PB-CANCELLATION
 17810        ADD +1                   TO WS-CAN-TOTAL-CNT
 17811        IF PB-FATAL-ERRORS
 17812           ADD +1                 TO WS-CAN-FATAL-CNT
 17813           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17814           GO TO 3020-BUMP-SEQ
 17815        ELSE
 17816           IF PB-UNFORCED-ERRORS
 17817              ADD +1                 TO WS-CAN-FORCE-CNT
 17818              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17819              GO TO 3020-BUMP-SEQ
 17820           ELSE
 17821              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17822                 ADD +1                 TO WS-CAN-HOLD-CNT
 17823                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17824                 GO TO 3020-BUMP-SEQ
 17825              ELSE
 17826                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17827                     THRU  3499-EXIT
 17828                 GO TO 3020-BUMP-SEQ.
 17829
 17830     IF PB-BATCH-TRAILER
 17831         GO TO 3030-END-BATCH.
 17832
 17833 3020-BUMP-SEQ.
 17834     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17835     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17836     GO TO 3010-READNEXT.
 17837
 17838 3030-END-BATCH.
 17839     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17840     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17841     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17842     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17843
 17844     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17845                                          - WS-ISS-FORCE-CNT
 17846                                          - WS-ISS-HOLD-CNT).
 17847
 17848     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17849     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17850
 17851     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17852     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17853     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 324
* EL6311.cbl
 17854     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17855     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17856                                          - WS-CAN-FORCE-CNT
 17857                                          - WS-CAN-HOLD-CNT).
 17858     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17859     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17860
 17861     COMPUTE WS-NET-TOTAL-CNT
 17862         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17863     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17864     COMPUTE WS-NET-FATAL-CNT
 17865         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17866     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17867     COMPUTE WS-NET-FORCE-CNT
 17868         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17869     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17870     COMPUTE WS-NET-HOLD-CNT
 17871         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17872     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17873
 17874     COMPUTE WS-NET-AVAIL-CNT
 17875          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17876                              - WS-ISS-FORCE-CNT
 17877                              - WS-ISS-HOLD-CNT)
 17878          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17879                              - WS-CAN-FORCE-CNT
 17880                              - WS-CAN-HOLD-CNT).
 17881     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17882
 17883     COMPUTE WS-NET-GOOD-PREM
 17884         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17885     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17886     COMPUTE WS-NET-BAD-PREM
 17887         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17888     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17889
 17890     MOVE 0000                   TO EMI-ERROR.
 17891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17892     MOVE -1                     TO DPFENTRL.
 17893     GO TO 8200-SEND-DATAONLY.
 17894
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 325
* EL6311.cbl
 17896
 17897******************************************************************
 17898*                                                                *
 17899*           A D D    B A D   I S S U E   P R E M I U M           *
 17900*                                                                *
 17901******************************************************************
 17902
 17903 3100-ADD-BAD-ISSUE-PREM.
 17904     IF PB-OVERRIDE-LIFE
 17905       OR PB-OVERRIDE-BOTH
 17906           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17907           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17908       ELSE
 17909           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17910           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17911
 17912     IF PB-OVERRIDE-AH
 17913       OR PB-OVERRIDE-BOTH
 17914           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17915       ELSE
 17916           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17917
 17918 3199-EXIT.
 17919     EXIT.
 17920
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 326
* EL6311.cbl
 17922
 17923******************************************************************
 17924*                                                                *
 17925*       A D D   G O O D   I S S U E   P R E M I U M              *
 17926*                                                                *
 17927******************************************************************
 17928
 17929 3200-ADD-GOOD-ISSUE-PREM.
 17930     IF PB-OVERRIDE-LIFE
 17931       OR PB-OVERRIDE-BOTH
 17932           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17933           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17934       ELSE
 17935           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17936           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17937
 17938     IF PB-OVERRIDE-AH
 17939       OR PB-OVERRIDE-BOTH
 17940           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17941       ELSE
 17942           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17943
 17944 3299-EXIT.
 17945     EXIT.
 17946
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 327
* EL6311.cbl
 17948
 17949
 17950******************************************************************
 17951*                                                                *
 17952*        A D D   B A D   C A N C E L   P R E M I U M             *
 17953*                                                                *
 17954******************************************************************
 17955
 17956 3300-ADD-BAD-CANCEL-PREM.
 17957     IF PB-OVERRIDE-LIFE
 17958       OR PB-OVERRIDE-BOTH
 17959           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17960       ELSE
 17961           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17962
 17963     IF PB-OVERRIDE-AH
 17964       OR PB-OVERRIDE-BOTH
 17965           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17966       ELSE
 17967           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17968
 17969 3399-EXIT.
 17970     EXIT.
 17971
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 328
* EL6311.cbl
 17973
 17974******************************************************************
 17975*                                                                *
 17976*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17977*                                                                *
 17978******************************************************************
 17979
 17980 3400-ADD-GOOD-CANCEL-PREM.
 17981     IF PB-OVERRIDE-LIFE
 17982       OR PB-OVERRIDE-BOTH
 17983           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17984       ELSE
 17985           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17986
 17987     IF PB-OVERRIDE-AH
 17988       OR PB-OVERRIDE-BOTH
 17989           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17990       ELSE
 17991           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17992
 17993 3499-EXIT.
 17994     EXIT.
 17995
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 329
* EL6311.cbl
 17997
 17998******************************************************************
 17999*                                                                *
 18000*           E D I T   B A T C H   D A T A                        *
 18001*                                                                *
 18002******************************************************************
 18003
 18004 3500-EDIT-BATCH-DATA.
 18005     IF PI-PREV-KEY NOT = SPACES
 18006        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18007     ELSE
 18008        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18009
 18010     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18011     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18012
 18013
 18014* EXEC CICS HANDLE CONDITION
 18015*         NOTFND      (3590-NOT-FOUND)
 18016*    END-EXEC.
 18017*    MOVE '"$I                   ! F #00015459' TO DFHEIV0
 18018     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18019     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18020     MOVE X'4620233030303135343539' TO DFHEIV0(25:11)
 18021     CALL 'kxdfhei1' USING DFHEIV0
 18022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18023
 18024
 18025     IF DRISSL   GREATER THAN ZEROS OR
 18026        DRISSL   GREATER THAN ZEROS OR
 18027        DRLFPRML GREATER THAN ZEROS OR
 18028        DRAHPRML GREATER THAN ZEROS OR
 18029        DRCANCL  GREATER THAN ZEROS OR
 18030        DRLFRFDL GREATER THAN ZEROS OR
 18031        DRAHRFDL GREATER THAN ZEROS
 18032              NEXT SENTENCE
 18033          ELSE
 18034              MOVE ER-3224    TO EMI-ERROR
 18035              MOVE -1         TO DPFENTRL
 18036              MOVE AL-UNBON   TO DPFENTRA
 18037              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18038              GO TO 8200-SEND-DATAONLY.
 18039
 18040     IF NOT MODIFY-CAP
 18041         MOVE 'UPDATE'       TO SM-READ
 18042         PERFORM 9995-SECURITY-VIOLATION
 18043         MOVE ER-0070        TO EMI-ERROR
 18044         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18045         GO TO 8100-SEND-INITIAL-MAP.
 18046
 18047        IF DRISSL GREATER THAN ZEROS
 18048           MOVE AL-UNNON         TO DRISSA
 18049           MOVE DRISSI           TO DEEDIT-FIELD
 18050           PERFORM 8600-DEEDIT
 18051           IF DEEDIT-FIELD-V0  NUMERIC
 18052              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18053           ELSE
 18054              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 330
* EL6311.cbl
 18055              MOVE -1         TO DRISSL
 18056              MOVE AL-UNBON   TO DRISSA
 18057              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18058
 18059        IF DRLFPRML GREATER THAN ZEROS
 18060           MOVE AL-UNNON         TO DRLFPRMA
 18061
 18062* EXEC CICS BIF DEEDIT
 18063*              FIELD  (DRLFPRMI)
 18064*              LENGTH (11)
 18065*          END-EXEC
 18066     MOVE 11
 18067       TO DFHEIV11
 18068*    MOVE '@"L                   #   #00015499' TO DFHEIV0
 18069     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18070     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18071     MOVE X'2020233030303135343939' TO DFHEIV0(25:11)
 18072     CALL 'kxdfhei1' USING DFHEIV0,
 18073           DRLFPRMI,
 18074           DFHEIV11
 18075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18076           IF DRLFPRMI NUMERIC
 18077              MOVE DRLFPRMI   TO WS-DRLFPRM
 18078*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18079*          PERFORM 8600-DEEDIT
 18080*          IF DEEDIT-FIELD-V2  NUMERIC
 18081*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18082           ELSE
 18083              MOVE ER-2223    TO EMI-ERROR
 18084              MOVE -1         TO DRLFPRML
 18085              MOVE AL-UNBON   TO DRLFPRMA
 18086              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18087
 18088        IF DRAHPRML GREATER THAN ZEROS
 18089           MOVE AL-UNNON         TO DRAHPRMA
 18090
 18091* EXEC CICS BIF DEEDIT
 18092*              FIELD  (DRAHPRMI)
 18093*              LENGTH (11)
 18094*          END-EXEC
 18095     MOVE 11
 18096       TO DFHEIV11
 18097*    MOVE '@"L                   #   #00015517' TO DFHEIV0
 18098     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18099     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18100     MOVE X'2020233030303135353137' TO DFHEIV0(25:11)
 18101     CALL 'kxdfhei1' USING DFHEIV0,
 18102           DRAHPRMI,
 18103           DFHEIV11
 18104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18105           IF DRAHPRMI NUMERIC
 18106              MOVE DRAHPRMI   TO WS-DRAHPRM
 18107*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18108*          PERFORM 8600-DEEDIT
 18109*          IF DEEDIT-FIELD-V2  NUMERIC
 18110*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18111           ELSE
 18112              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 331
* EL6311.cbl
 18113              MOVE -1         TO DRAHPRML
 18114              MOVE AL-UNBON   TO DRAHPRMA
 18115              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18116
 18117        IF DRCANCL GREATER THAN ZEROS
 18118           MOVE AL-UNNON         TO DRCANCA
 18119           MOVE DRCANCI          TO DEEDIT-FIELD
 18120           PERFORM 8600-DEEDIT
 18121           IF DEEDIT-FIELD-V0  NUMERIC
 18122              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18123           ELSE
 18124              MOVE ER-2223    TO EMI-ERROR
 18125              MOVE -1         TO DRCANCL
 18126              MOVE AL-UNBON   TO DRCANCL
 18127              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18128
 18129        IF DRLFRFDL GREATER THAN ZEROS
 18130           MOVE AL-UNNON         TO DRLFRFDA
 18131
 18132* EXEC CICS BIF DEEDIT
 18133*              FIELD  (DRLFRFDI)
 18134*              LENGTH (11)
 18135*          END-EXEC
 18136     MOVE 11
 18137       TO DFHEIV11
 18138*    MOVE '@"L                   #   #00015547' TO DFHEIV0
 18139     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18140     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18141     MOVE X'2020233030303135353437' TO DFHEIV0(25:11)
 18142     CALL 'kxdfhei1' USING DFHEIV0,
 18143           DRLFRFDI,
 18144           DFHEIV11
 18145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18146           IF DRLFRFDI NUMERIC
 18147              MOVE DRLFRFDI   TO WS-DRLFRFD
 18148*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18149*          PERFORM 8600-DEEDIT
 18150*          IF DEEDIT-FIELD-V2  NUMERIC
 18151*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18152           ELSE
 18153              MOVE ER-2223    TO EMI-ERROR
 18154              MOVE -1         TO DRLFRFDL
 18155              MOVE AL-UNBON   TO DRLFRFDA
 18156              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18157
 18158        IF DRAHRFDL GREATER THAN ZEROS
 18159           MOVE AL-UNNON         TO DRAHRFDA
 18160
 18161* EXEC CICS BIF DEEDIT
 18162*              FIELD  (DRAHRFDI)
 18163*              LENGTH (11)
 18164*          END-EXEC
 18165     MOVE 11
 18166       TO DFHEIV11
 18167*    MOVE '@"L                   #   #00015565' TO DFHEIV0
 18168     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18169     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18170     MOVE X'2020233030303135353635' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 332
* EL6311.cbl
 18171     CALL 'kxdfhei1' USING DFHEIV0,
 18172           DRAHRFDI,
 18173           DFHEIV11
 18174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18175           IF DRAHRFDI NUMERIC
 18176              MOVE DRAHRFDI   TO WS-DRAHRFD
 18177*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18178*          PERFORM 8600-DEEDIT
 18179*          IF DEEDIT-FIELD-V2  NUMERIC
 18180*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18181           ELSE
 18182              MOVE ER-2223    TO EMI-ERROR
 18183              MOVE -1         TO DRAHRFDL
 18184              MOVE AL-UNBON   TO DRAHRFDA
 18185              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18186
 18187     IF EMI-ERROR = ZEROS
 18188        GO 3600-UPDATE-BATCH-HEADER.
 18189
 18190     GO TO 8200-SEND-DATAONLY.
 18191
 18192 3590-NOT-FOUND.
 18193     MOVE ER-2192                TO EMI-ERROR.
 18194     MOVE -1                     TO DPFENTRL.
 18195     MOVE AL-UNBON               TO DPFENTRA.
 18196     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18197     GO TO 8200-SEND-DATAONLY.
 18198
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 333
* EL6311.cbl
 18200
 18201******************************************************************
 18202*                                                                *
 18203*           U P D A T E   B A T C H   H E A D E R                *
 18204*                                                                *
 18205******************************************************************
 18206
 18207 3600-UPDATE-BATCH-HEADER.
 18208
 18209* EXEC CICS HANDLE CONDITION
 18210*         NOTFND      (3690-NOT-FOUND)
 18211*    END-EXEC.
 18212*    MOVE '"$I                   ! G #00015602' TO DFHEIV0
 18213     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18215     MOVE X'4720233030303135363032' TO DFHEIV0(25:11)
 18216     CALL 'kxdfhei1' USING DFHEIV0
 18217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18218
 18219
 18220
 18221* EXEC CICS READ
 18222*        DATASET (FILE-ID-ERPNDB)
 18223*        RIDFLD  (ERPNDB-KEY)
 18224*        SET     (ADDRESS OF PENDING-BUSINESS)
 18225*        UPDATE
 18226*    END-EXEC.
 18227*    MOVE '&"S        EU         (   #00015606' TO DFHEIV0
 18228     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18229     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18230     MOVE X'2020233030303135363036' TO DFHEIV0(25:11)
 18231     CALL 'kxdfhei1' USING DFHEIV0,
 18232           FILE-ID-ERPNDB,
 18233           DFHEIV20,
 18234           DFHEIV99,
 18235           ERPNDB-KEY,
 18236           DFHEIV99,
 18237           DFHEIV99,
 18238           DFHEIV99
 18239     SET ADDRESS OF PENDING-BUSINESS TO
 18240         DFHEIV20
 18241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18242
 18243
 18244     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18245     MOVE 'B'                    TO JP-RECORD-TYPE.
 18246     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18247
 18248     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18249
 18250     PERFORM 8400-LOG-JOURNAL-RECORD.
 18251
 18252     IF DRISSL GREATER THAN ZEROS
 18253        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18254
 18255     IF DRCANCL GREATER THAN ZEROS
 18256        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18257
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 334
* EL6311.cbl
 18258
 18259     IF DRLFPRML GREATER THAN ZEROS
 18260        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18261
 18262     IF DRAHPRML GREATER THAN ZEROS
 18263        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18264
 18265     IF DRLFRFDL GREATER THAN ZEROS
 18266        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18267
 18268     IF DRAHRFDL GREATER THAN ZEROS
 18269        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18270
 18271 3670-REWRITE-BATCH-HEADER.
 18272     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18273        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18274        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18275        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18276        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18277        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18278        MOVE SPACE               TO PB-OUT-BAL-CD
 18279     ELSE
 18280        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18281
 18282     MOVE 'C'                    TO JP-RECORD-TYPE.
 18283     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18284
 18285
 18286* EXEC CICS REWRITE
 18287*         DATASET      (FILE-ID-ERPNDB)
 18288*         FROM         (PENDING-BUSINESS)
 18289*    END-EXEC.
 18290     MOVE LENGTH OF
 18291      PENDING-BUSINESS
 18292       TO DFHEIV11
 18293*    MOVE '&& L                  %   #00015654' TO DFHEIV0
 18294     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18295     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18296     MOVE X'2020233030303135363534' TO DFHEIV0(25:11)
 18297     CALL 'kxdfhei1' USING DFHEIV0,
 18298           FILE-ID-ERPNDB,
 18299           PENDING-BUSINESS,
 18300           DFHEIV11,
 18301           DFHEIV99
 18302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18303
 18304
 18305     PERFORM 8400-LOG-JOURNAL-RECORD.
 18306
 18307     GO TO 7200-DISPLAY-BATCHES.
 18308
 18309 3690-NOT-FOUND.
 18310     MOVE ER-2192                TO EMI-ERROR.
 18311     MOVE -1                     TO DPFENTRL.
 18312     MOVE AL-UNBON               TO DPFENTRA.
 18313     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18314     GO TO 8200-SEND-DATAONLY.
 18315
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 335
* EL6311.cbl
 18317
 18318******************************************************************
 18319*                                                                *
 18320*           R E - D I S P L A Y   R E C O R D                    *
 18321*                                                                *
 18322******************************************************************
 18323
 18324 3900-RE-DISPLAY-RECORD.
 18325
 18326* EXEC CICS HANDLE CONDITION
 18327*         NOTFND   (3990-NOT-FOUND)
 18328*    END-EXEC.
 18329*    MOVE '"$I                   ! H #00015679' TO DFHEIV0
 18330     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18332     MOVE X'4820233030303135363739' TO DFHEIV0(25:11)
 18333     CALL 'kxdfhei1' USING DFHEIV0
 18334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18335
 18336
 18337     IF PI-DISPLAY-ORIGINAL-BATCH
 18338         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18339     ELSE
 18340         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18341
 18342
 18343* EXEC CICS READ
 18344*         DATASET   (FILE-ID)
 18345*         RIDFLD    (PI-PREV-KEY)
 18346*         SET       (ADDRESS OF PENDING-BUSINESS)
 18347*    END-EXEC.
 18348*    MOVE '&"S        E          (   #00015688' TO DFHEIV0
 18349     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18351     MOVE X'2020233030303135363838' TO DFHEIV0(25:11)
 18352     CALL 'kxdfhei1' USING DFHEIV0,
 18353           FILE-ID,
 18354           DFHEIV20,
 18355           DFHEIV99,
 18356           PI-PREV-KEY,
 18357           DFHEIV99,
 18358           DFHEIV99,
 18359           DFHEIV99
 18360     SET ADDRESS OF PENDING-BUSINESS TO
 18361         DFHEIV20
 18362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18363
 18364
 18365     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18366
 18367     IF PB-ISSUE
 18368         GO TO 7000-DISPLAY-ISSUES.
 18369
 18370     IF PB-CANCELLATION
 18371         GO TO 7100-DISPLAY-CANCELS.
 18372
 18373     IF PB-BATCH-TRAILER
 18374         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 336
* EL6311.cbl
 18375
 18376 3990-NOT-FOUND.
 18377     MOVE LOW-VALUES             TO EL631BI.
 18378
 18379     IF PI-MAP-NAME = EL631B
 18380         MOVE -1                  TO BMAINTL
 18381     ELSE
 18382         MOVE -1                  TO CMAINTL.
 18383
 18384     GO TO 8100-SEND-INITIAL-MAP.
 18385
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 337
* EL6311.cbl
 18387
 18388***************************************************************
 18389*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18390*                                                             *
 18391*      1. START BROWSE WITH                                   *
 18392*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18393*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18394*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18395*                                                             *
 18396*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18397*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18398*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18399*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18400*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18401*               AND IS IT TO BE DISPLAYED.                    *
 18402*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18403*               DISPLAYED.                                    *
 18404*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18405*               DISPLAYED.                                    *
 18406*                                                             *
 18407*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18408*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18409***************************************************************
 18410
 18411 4000-BROWSE-DETAIL-FORWARD.
 18412     IF FIRST-TIME
 18413        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18414     ELSE
 18415        IF SHOW-RECORD
 18416           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18417           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18418           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18419           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18420           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18421        ELSE
 18422           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18423
 18424
 18425* EXEC CICS HANDLE CONDITION
 18426*         NOTFND   (4050-END-RECORDS)
 18427*         ENDFILE  (4050-END-RECORDS)
 18428*    END-EXEC.
 18429*    MOVE '"$I''                  ! I #00015753' TO DFHEIV0
 18430     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18431     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18432     MOVE X'4920233030303135373533' TO DFHEIV0(25:11)
 18433     CALL 'kxdfhei1' USING DFHEIV0
 18434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18435
 18436
 18437
 18438* EXEC CICS STARTBR
 18439*         DATASET   (FILE-ID-ERPNDB2)
 18440*         RIDFLD    (ERPNDB-ALT-KEY)
 18441*    END-EXEC.
 18442     MOVE 0
 18443       TO DFHEIV11
 18444*    MOVE '&,         G          &   #00015758' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 338
* EL6311.cbl
 18445     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18446     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18447     MOVE X'2020233030303135373538' TO DFHEIV0(25:11)
 18448     CALL 'kxdfhei1' USING DFHEIV0,
 18449           FILE-ID-ERPNDB2,
 18450           ERPNDB-ALT-KEY,
 18451           DFHEIV99,
 18452           DFHEIV11,
 18453           DFHEIV99
 18454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18455
 18456
 18457     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18458
 18459     IF FIRST-TIME OR SHOW-RECORD
 18460        MOVE SPACE               TO WS-FIRST-TIME-SW
 18461        GO TO 4005-READ-NEXT-RECORD.
 18462
 18463
 18464* EXEC CICS READNEXT
 18465*         DATASET    (FILE-ID-ERPNDB2)
 18466*         SET        (ADDRESS OF PENDING-BUSINESS)
 18467*         RIDFLD     (ERPNDB-ALT-KEY)
 18468*    END-EXEC.
 18469     MOVE 0
 18470       TO DFHEIV11
 18471*    MOVE '&.S                   )   #00015769' TO DFHEIV0
 18472     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18473     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18474     MOVE X'2020233030303135373639' TO DFHEIV0(25:11)
 18475     CALL 'kxdfhei1' USING DFHEIV0,
 18476           FILE-ID-ERPNDB2,
 18477           DFHEIV20,
 18478           DFHEIV99,
 18479           ERPNDB-ALT-KEY,
 18480           DFHEIV99,
 18481           DFHEIV11,
 18482           DFHEIV99,
 18483           DFHEIV99
 18484     SET ADDRESS OF PENDING-BUSINESS TO
 18485         DFHEIV20
 18486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18487
 18488
 18489 4005-READ-NEXT-RECORD.
 18490
 18491* EXEC CICS READNEXT
 18492*         DATASET    (FILE-ID-ERPNDB2)
 18493*         SET        (ADDRESS OF PENDING-BUSINESS)
 18494*         RIDFLD     (ERPNDB-ALT-KEY)
 18495*    END-EXEC.
 18496     MOVE 0
 18497       TO DFHEIV11
 18498*    MOVE '&.S                   )   #00015776' TO DFHEIV0
 18499     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18500     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18501     MOVE X'2020233030303135373736' TO DFHEIV0(25:11)
 18502     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 339
* EL6311.cbl
 18503           FILE-ID-ERPNDB2,
 18504           DFHEIV20,
 18505           DFHEIV99,
 18506           ERPNDB-ALT-KEY,
 18507           DFHEIV99,
 18508           DFHEIV11,
 18509           DFHEIV99,
 18510           DFHEIV99
 18511     SET ADDRESS OF PENDING-BUSINESS TO
 18512         DFHEIV20
 18513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18514
 18515
 18516     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18517
 18518     IF WS-BATCH-PREFIX = '#CL'
 18519        GO TO 4005-READ-NEXT-RECORD.
 18520
 18521     IF SHOW-RECORD
 18522        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18523           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18524           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18525           PB-STATE         NOT = PI-PB-STATE          OR
 18526           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18527           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18528           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18529           GO TO 4050-END-RECORDS
 18530        ELSE
 18531           GO TO 4010-CHECK-REC-TYPE.
 18532
 18533     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18534        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18535        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18536        PB-STATE            NOT = PI-PB-STATE          OR
 18537        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18538        GO TO 4050-END-RECORDS.
 18539
 18540     IF PB-BATCH-TRAILER
 18541        GO TO 4005-READ-NEXT-RECORD.
 18542
 18543     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18544        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18545           GO TO 4005-READ-NEXT-RECORD
 18546        ELSE
 18547           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18548              GO TO 4010-CHECK-REC-TYPE
 18549           ELSE
 18550              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18551                 GO TO 4010-CHECK-REC-TYPE
 18552              ELSE
 18553                 GO TO 4005-READ-NEXT-RECORD.
 18554
 18555     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18556        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18557           GO TO 4005-READ-NEXT-RECORD.
 18558
 18559 4010-CHECK-REC-TYPE.
 18560     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 340
* EL6311.cbl
 18561         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18562             NEXT SENTENCE
 18563         ELSE
 18564             GO TO 4005-READ-NEXT-RECORD.
 18565
 18566     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18567         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18568             NEXT SENTENCE
 18569        ELSE
 18570             GO TO 4005-READ-NEXT-RECORD.
 18571
 18572     IF NOT DISPLAY-CHANGE-RECORDS AND
 18573            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18574        GO TO 4005-READ-NEXT-RECORD.
 18575
 18576     IF DISPLAY-HOLD-RECORDS AND
 18577        NOT PB-RECORD-ON-HOLD
 18578          GO TO 4005-READ-NEXT-RECORD.
 18579
 18580     IF PB-ISSUE
 18581        IF DISPLAY-CHK-REQ-RECORDS
 18582            GO TO 4005-READ-NEXT-RECORD.
 18583
 18584     IF PB-ISSUE
 18585        IF ISSUE-WITH-WARNING
 18586           IF PB-WARNING-ERRORS
 18587              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18588                  GO TO 4005-READ-NEXT-RECORD
 18589              ELSE
 18590                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18591                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18592                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18593                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18594                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18595                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18596                 GO TO 7000-DISPLAY-ISSUES
 18597           ELSE
 18598              GO TO 4005-READ-NEXT-RECORD.
 18599
 18600     IF PB-ISSUE
 18601        IF (ISSUES-IN-ERROR AND
 18602            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18603            ALL-ISSUES
 18604            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18605            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18606            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18607            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18608            MOVE PB-SV-STATE            TO PI-SV-STATE
 18609            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18610            GO TO 7000-DISPLAY-ISSUES
 18611        ELSE
 18612            GO TO 4005-READ-NEXT-RECORD.
 18613
 18614     IF PB-CANCELLATION
 18615        IF DISPLAY-CHK-REQ-RECORDS
 18616           IF PB-C-REFUND-REQUESTED
 18617              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18618              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 341
* EL6311.cbl
 18619              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18620              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18621              MOVE PB-SV-STATE            TO PI-SV-STATE
 18622              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18623              GO TO 7100-DISPLAY-CANCELS
 18624           ELSE
 18625               GO TO 4005-READ-NEXT-RECORD.
 18626
 18627     IF PB-CANCELLATION
 18628        IF CANCEL-WITH-WARNING
 18629           IF PB-WARNING-ERRORS
 18630              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18631                  GO TO 4005-READ-NEXT-RECORD
 18632              ELSE
 18633                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18634                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18635                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18636                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18637                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18638                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18639                 GO TO 7100-DISPLAY-CANCELS
 18640           ELSE
 18641              GO TO 4005-READ-NEXT-RECORD.
 18642
 18643     IF PB-CANCELLATION
 18644        IF (CANCEL-IN-ERROR  AND
 18645            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18646            ALL-CANCELS
 18647            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18648            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18649            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18650            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18651            MOVE PB-SV-STATE            TO PI-SV-STATE
 18652            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18653            GO TO 7100-DISPLAY-CANCELS.
 18654
 18655     GO TO 4005-READ-NEXT-RECORD.
 18656
 18657 4050-END-RECORDS.
 18658******************************************************************
 18659*                                                                *
 18660*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18661*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18662*         PROGRAM.                                               *
 18663*                                                                *
 18664******************************************************************
 18665
 18666     IF BROWSE-STARTED
 18667        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18668
 18669* EXEC CICS ENDBR
 18670*            DATASET  (FILE-ID-ERPNDB2)
 18671*       END-EXEC.
 18672     MOVE 0
 18673       TO DFHEIV11
 18674*    MOVE '&2                    $   #00015934' TO DFHEIV0
 18675     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18676     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 342
* EL6311.cbl
 18677     MOVE X'2020233030303135393334' TO DFHEIV0(25:11)
 18678     CALL 'kxdfhei1' USING DFHEIV0,
 18679           FILE-ID-ERPNDB2,
 18680           DFHEIV11,
 18681           DFHEIV99
 18682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18683
 18684
 18685     IF  EIBTRNID NOT = TRANS-EXB1
 18686         IF PENDING-BUS-RECS-FOUND
 18687             NEXT SENTENCE
 18688           ELSE
 18689             MOVE '9'            TO PI-BROWSE-SW
 18690             GO TO 9400-CLEAR.
 18691
 18692     IF SHOW-RECORD
 18693        MOVE ER-2253            TO EMI-ERROR
 18694       ELSE
 18695        MOVE ER-2254            TO EMI-ERROR.
 18696
 18697     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18698
 18699     IF PI-MAP-NAME = SPACES
 18700        MOVE -1                  TO DPFENTRL
 18701        MOVE EL631D               TO PI-MAP-NAME
 18702        GO TO 8100-SEND-INITIAL-MAP.
 18703
 18704     IF PI-MAP-NAME = EL631B
 18705        MOVE -1                  TO BMAINTL
 18706     ELSE
 18707        IF PI-MAP-NAME = EL631C
 18708           MOVE -1               TO CMAINTL
 18709        ELSE
 18710           MOVE -1               TO DPFENTRL.
 18711
 18712     GO TO 8200-SEND-DATAONLY.
 18713
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 343
* EL6311.cbl
 18715
 18716***************************************************************
 18717*                                                             *
 18718*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18719*                                                             *
 18720*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18721*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18722*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18723*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18724*                                                             *
 18725*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18726*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18727*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18728*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18729*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18730*                AND IS IT TO BE DISPLAYED.                   *
 18731*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18732*                DISPLAYED.                                   *
 18733*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18734*                DISPLAYED.                                   *
 18735*                                                             *
 18736*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18737*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18738*                                                             *
 18739*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18740*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18741*                THEY ARE NOT TO BE DISPLAYED.                *
 18742*                                                             *
 18743***************************************************************
 18744
 18745 4100-BROWSE-PRIMARY-FORWARD.
 18746     IF FIRST-TIME  OR SHOW-RECORD
 18747        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18748        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18749        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18750     ELSE
 18751        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18752        IF ERPNDB-BATCH-SEQ-NO = +9999
 18753           GO TO 4150-END-BATCH
 18754        ELSE
 18755           IF DISPLAY-CHANGE-RECORDS
 18756              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18757           ELSE
 18758              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18759              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18760
 18761     IF FIRST-TIME
 18762         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18763            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18764              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18765
 18766
 18767* EXEC CICS HANDLE CONDITION
 18768*         ENDFILE  (4150-END-BATCH)
 18769*    END-EXEC.
 18770*    MOVE '"$''                   ! J #00016019' TO DFHEIV0
 18771     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 344
* EL6311.cbl
 18773     MOVE X'4A20233030303136303139' TO DFHEIV0(25:11)
 18774     CALL 'kxdfhei1' USING DFHEIV0
 18775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18776
 18777
 18778 4105-READ-NEXT.
 18779
 18780* EXEC CICS HANDLE CONDITION
 18781*         NOTFND    (4150-END-BATCH)
 18782*    END-EXEC.
 18783*    MOVE '"$I                   ! K #00016024' TO DFHEIV0
 18784     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18786     MOVE X'4B20233030303136303234' TO DFHEIV0(25:11)
 18787     CALL 'kxdfhei1' USING DFHEIV0
 18788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18789
 18790
 18791     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18792
 18793     IF PI-DISPLAY-ORIGINAL-BATCH
 18794        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18795     ELSE
 18796        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18797
 18798
 18799* EXEC CICS READ
 18800*         DATASET   (FILE-ID)
 18801*         SET       (ADDRESS OF PENDING-BUSINESS)
 18802*         RIDFLD    (ERPNDB-KEY)
 18803*         GTEQ
 18804*    END-EXEC.
 18805*    MOVE '&"S        G          (   #00016035' TO DFHEIV0
 18806     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18808     MOVE X'2020233030303136303335' TO DFHEIV0(25:11)
 18809     CALL 'kxdfhei1' USING DFHEIV0,
 18810           FILE-ID,
 18811           DFHEIV20,
 18812           DFHEIV99,
 18813           ERPNDB-KEY,
 18814           DFHEIV99,
 18815           DFHEIV99,
 18816           DFHEIV99
 18817     SET ADDRESS OF PENDING-BUSINESS TO
 18818         DFHEIV20
 18819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18820
 18821
 18822     IF PI-DISPLAY-ORIGINAL-BATCH
 18823        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18824           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18825           GO TO 4150-END-BATCH
 18826        ELSE
 18827           IF PB-BATCH-TRAILER
 18828              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18829              GO TO 4105-READ-NEXT
 18830           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 345
* EL6311.cbl
 18831              NEXT SENTENCE
 18832     ELSE
 18833        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18834           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18835           GO TO 4150-END-BATCH.
 18836
 18837     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18838
 18839     IF WS-BATCH-PREFIX = '#CL'
 18840         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18841         GO TO 4105-READ-NEXT.
 18842
 18843     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18844     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18845     MOVE PB-STATE               TO PI-PB-STATE.
 18846     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18847
 18848     IF PB-BATCH-TRAILER
 18849        IF SHOW-RECORD
 18850           GO TO 4150-END-BATCH
 18851        ELSE
 18852           MOVE ER-2251         TO EMI-ERROR
 18853           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18854           MOVE 1               TO PI-BROWSE-TYPE
 18855           GO TO 7200-DISPLAY-BATCHES.
 18856
 18857     IF SHOW-RECORD
 18858           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18859              GO TO 4110-BUMP-SEQ
 18860           ELSE
 18861              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18862                 GO TO 4110-BUMP-SEQ
 18863              ELSE
 18864                 GO TO 4107-CHECK-REC-TYPE.
 18865
 18866     IF NOT  PI-PRIMARY-WITH-SELECT
 18867        GO TO 4107-CHECK-REC-TYPE.
 18868
 18869     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18870        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18871           GO TO 4110-BUMP-SEQ
 18872        ELSE
 18873           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18874              GO TO 4107-CHECK-REC-TYPE
 18875           ELSE
 18876              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18877                 GO TO 4107-CHECK-REC-TYPE
 18878              ELSE
 18879                 GO TO 4110-BUMP-SEQ.
 18880
 18881     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18882        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18883           GO TO 4110-BUMP-SEQ.
 18884
 18885 4107-CHECK-REC-TYPE.
 18886     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18887         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18888             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 346
* EL6311.cbl
 18889           ELSE
 18890             GO TO 4110-BUMP-SEQ.
 18891
 18892     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18893         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18894             NEXT SENTENCE
 18895           ELSE
 18896             GO TO 4110-BUMP-SEQ.
 18897
 18898     IF NOT DISPLAY-CHANGE-RECORDS AND
 18899        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18900           GO TO 4110-BUMP-SEQ.
 18901
 18902     IF DISPLAY-HOLD-RECORDS AND
 18903        NOT PB-RECORD-ON-HOLD
 18904          GO TO 4110-BUMP-SEQ.
 18905
 18906     IF PB-ISSUE
 18907        IF DISPLAY-CHK-REQ-RECORDS
 18908            GO TO 4110-BUMP-SEQ.
 18909
 18910     IF PB-ISSUE
 18911        IF ISSUE-WITH-WARNING
 18912           IF PB-WARNING-ERRORS
 18913              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18914                  GO TO 4110-BUMP-SEQ
 18915              ELSE
 18916                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18917                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18918                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18919                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18920                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18921                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18922                 GO TO 7000-DISPLAY-ISSUES
 18923        ELSE
 18924            GO TO 4110-BUMP-SEQ.
 18925
 18926     IF PB-ISSUE
 18927        IF (ISSUES-IN-ERROR AND
 18928            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18929            ALL-ISSUES
 18930            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18931            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18932            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18933            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18934            MOVE PB-SV-STATE            TO PI-SV-STATE
 18935            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18936            GO TO 7000-DISPLAY-ISSUES
 18937        ELSE
 18938            GO TO 4110-BUMP-SEQ.
 18939
 18940     IF PB-CANCELLATION
 18941        IF DISPLAY-CHK-REQ-RECORDS
 18942           IF PB-C-REFUND-REQUESTED
 18943              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18944              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18945              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18946              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 347
* EL6311.cbl
 18947              MOVE PB-SV-STATE            TO PI-SV-STATE
 18948              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18949              GO TO 7100-DISPLAY-CANCELS
 18950           ELSE
 18951              GO TO 4110-BUMP-SEQ.
 18952
 18953     IF PB-CANCELLATION
 18954        IF CANCEL-WITH-WARNING
 18955           IF PB-WARNING-ERRORS
 18956              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18957                  GO TO 4110-BUMP-SEQ
 18958              ELSE
 18959                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18960                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18961                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18962                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18963                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18964                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18965                 GO TO 7100-DISPLAY-CANCELS
 18966           ELSE
 18967              GO TO 4110-BUMP-SEQ.
 18968
 18969     IF PB-CANCELLATION
 18970        IF (CANCEL-IN-ERROR  AND
 18971            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18972            ALL-CANCELS
 18973            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18974            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18975            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18976            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18977            MOVE PB-SV-STATE            TO PI-SV-STATE
 18978            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18979            GO TO 7100-DISPLAY-CANCELS.
 18980
 18981 4110-BUMP-SEQ.
 18982     IF NOT DISPLAY-CHANGE-RECORDS
 18983        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18984        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18985     ELSE
 18986        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18987           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18988           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18989        ELSE
 18990           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18991           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18992
 18993     GO TO 4105-READ-NEXT.
 18994
 18995 4150-END-BATCH.
 18996******************************************************************
 18997*                                                                *
 18998*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18999*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19000*         PROGRAM.                                               *
 19001*                                                                *
 19002******************************************************************
 19003
 19004     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 348
* EL6311.cbl
 19005         IF PENDING-BUS-RECS-FOUND
 19006             NEXT SENTENCE
 19007           ELSE
 19008             MOVE '9'            TO PI-BROWSE-SW
 19009             GO TO 9400-CLEAR.
 19010
 19011     IF SHOW-RECORD
 19012        MOVE ER-2253             TO EMI-ERROR
 19013     ELSE
 19014        MOVE ER-2251             TO EMI-ERROR.
 19015
 19016     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19017
 19018     IF PI-MAP-NAME = SPACES
 19019        MOVE -1                  TO BMAINTL
 19020        MOVE EL631B              TO PI-MAP-NAME
 19021        GO TO 8100-SEND-INITIAL-MAP.
 19022
 19023     IF PI-MAP-NAME = EL631B
 19024        MOVE -1                  TO BMAINTL
 19025     ELSE
 19026        IF PI-MAP-NAME = EL631C
 19027           MOVE -1               TO CMAINTL
 19028        ELSE
 19029           MOVE -1               TO DPFENTRL.
 19030
 19031     GO TO 8200-SEND-DATAONLY.
 19032
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 349
* EL6311.cbl
 19034
 19035***************************************************************
 19036*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19037*                                                             *
 19038*      1. START BROWSE WITH                                   *
 19039*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19040*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19041*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19042*                                                             *
 19043*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19044*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19045*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19046*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19047*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19048*               AND IS IT TO BE DISPLAYED.                    *
 19049*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19050*               DISPLAYED.                                    *
 19051*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19052*               DISPLAYED.                                    *
 19053*                                                             *
 19054*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19055*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19056***************************************************************
 19057
 19058 4200-BROWSE-CSR-FORWARD.
 19059
 19060     IF FIRST-TIME
 19061        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19062     ELSE
 19063        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19064
 19065
 19066* EXEC CICS HANDLE CONDITION
 19067*         NOTFND   (4250-END-RECORDS)
 19068*         ENDFILE  (4250-END-RECORDS)
 19069*    END-EXEC.
 19070*    MOVE '"$I''                  ! L #00016285' TO DFHEIV0
 19071     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19073     MOVE X'4C20233030303136323835' TO DFHEIV0(25:11)
 19074     CALL 'kxdfhei1' USING DFHEIV0
 19075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19076
 19077
 19078
 19079* EXEC CICS STARTBR
 19080*         DATASET   (FILE-ID-ERPNDB4)
 19081*         RIDFLD    (ERPNDB-CSR-KEY)
 19082*    END-EXEC.
 19083     MOVE 0
 19084       TO DFHEIV11
 19085*    MOVE '&,         G          &   #00016290' TO DFHEIV0
 19086     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19087     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19088     MOVE X'2020233030303136323930' TO DFHEIV0(25:11)
 19089     CALL 'kxdfhei1' USING DFHEIV0,
 19090           FILE-ID-ERPNDB4,
 19091           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 350
* EL6311.cbl
 19092           DFHEIV99,
 19093           DFHEIV11,
 19094           DFHEIV99
 19095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19096
 19097
 19098     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19099
 19100     IF FIRST-TIME
 19101        MOVE SPACE               TO WS-FIRST-TIME-SW
 19102        GO TO 4205-READ-NEXT-RECORD.
 19103
 19104
 19105* EXEC CICS READNEXT
 19106*         DATASET    (FILE-ID-ERPNDB4)
 19107*         SET        (ADDRESS OF PENDING-BUSINESS)
 19108*         RIDFLD     (ERPNDB-CSR-KEY)
 19109*    END-EXEC.
 19110     MOVE 0
 19111       TO DFHEIV11
 19112*    MOVE '&.S                   )   #00016301' TO DFHEIV0
 19113     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19114     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19115     MOVE X'2020233030303136333031' TO DFHEIV0(25:11)
 19116     CALL 'kxdfhei1' USING DFHEIV0,
 19117           FILE-ID-ERPNDB4,
 19118           DFHEIV20,
 19119           DFHEIV99,
 19120           ERPNDB-CSR-KEY,
 19121           DFHEIV99,
 19122           DFHEIV11,
 19123           DFHEIV99,
 19124           DFHEIV99
 19125     SET ADDRESS OF PENDING-BUSINESS TO
 19126         DFHEIV20
 19127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19128
 19129
 19130 4205-READ-NEXT-RECORD.
 19131
 19132
 19133* EXEC CICS READNEXT
 19134*         DATASET    (FILE-ID-ERPNDB4)
 19135*         SET        (ADDRESS OF PENDING-BUSINESS)
 19136*         RIDFLD     (ERPNDB-CSR-KEY)
 19137*    END-EXEC.
 19138     MOVE 0
 19139       TO DFHEIV11
 19140*    MOVE '&.S                   )   #00016309' TO DFHEIV0
 19141     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19142     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19143     MOVE X'2020233030303136333039' TO DFHEIV0(25:11)
 19144     CALL 'kxdfhei1' USING DFHEIV0,
 19145           FILE-ID-ERPNDB4,
 19146           DFHEIV20,
 19147           DFHEIV99,
 19148           ERPNDB-CSR-KEY,
 19149           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 351
* EL6311.cbl
 19150           DFHEIV11,
 19151           DFHEIV99,
 19152           DFHEIV99
 19153     SET ADDRESS OF PENDING-BUSINESS TO
 19154         DFHEIV20
 19155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19156
 19157
 19158     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19159
 19160     IF WS-BATCH-PREFIX = '#CL'
 19161        GO TO 4205-READ-NEXT-RECORD.
 19162
 19163     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19164        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19165        GO TO 4250-END-RECORDS.
 19166
 19167     IF PB-BATCH-TRAILER
 19168        GO TO 4205-READ-NEXT-RECORD.
 19169
 19170     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19171        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19172           GO TO 4205-READ-NEXT-RECORD
 19173        ELSE
 19174           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19175              GO TO 4210-CHECK-REC-TYPE
 19176           ELSE
 19177              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19178                 GO TO 4210-CHECK-REC-TYPE
 19179              ELSE
 19180                 GO TO 4205-READ-NEXT-RECORD.
 19181
 19182     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19183        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19184           GO TO 4205-READ-NEXT-RECORD.
 19185
 19186 4210-CHECK-REC-TYPE.
 19187     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19188         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19189             NEXT SENTENCE
 19190         ELSE
 19191             GO TO 4205-READ-NEXT-RECORD.
 19192
 19193     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19194         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19195             NEXT SENTENCE
 19196        ELSE
 19197             GO TO 4205-READ-NEXT-RECORD.
 19198
 19199     IF NOT DISPLAY-CHANGE-RECORDS AND
 19200            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19201        GO TO 4205-READ-NEXT-RECORD.
 19202
 19203     IF DISPLAY-HOLD-RECORDS AND
 19204        NOT PB-RECORD-ON-HOLD
 19205          GO TO 4205-READ-NEXT-RECORD.
 19206
 19207     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 352
* EL6311.cbl
 19208        IF DISPLAY-CHK-REQ-RECORDS
 19209            GO TO 4205-READ-NEXT-RECORD.
 19210
 19211     IF PB-ISSUE
 19212        IF ISSUE-WITH-WARNING
 19213           IF PB-WARNING-ERRORS
 19214              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19215                  GO TO 4205-READ-NEXT-RECORD
 19216              ELSE
 19217                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19218                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19219                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19220                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19221                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19222                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19223                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19224                 GO TO 7000-DISPLAY-ISSUES
 19225           ELSE
 19226              GO TO 4205-READ-NEXT-RECORD.
 19227
 19228     IF PB-ISSUE
 19229        IF (ISSUES-IN-ERROR AND
 19230            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19231            ALL-ISSUES
 19232            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19233            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19234            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19235            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19236            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19237            MOVE PB-SV-STATE            TO PI-SV-STATE
 19238            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19239            GO TO 7000-DISPLAY-ISSUES
 19240        ELSE
 19241            GO TO 4205-READ-NEXT-RECORD.
 19242
 19243     IF PB-CANCELLATION
 19244        IF DISPLAY-CHK-REQ-RECORDS
 19245           IF PB-C-REFUND-REQUESTED
 19246              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19247              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19248              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19249              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19250              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19251              MOVE PB-SV-STATE            TO PI-SV-STATE
 19252              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19253              GO TO 7100-DISPLAY-CANCELS
 19254           ELSE
 19255               GO TO 4205-READ-NEXT-RECORD.
 19256
 19257     IF PB-CANCELLATION
 19258        IF CANCEL-WITH-WARNING
 19259           IF PB-WARNING-ERRORS
 19260              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19261                  GO TO 4205-READ-NEXT-RECORD
 19262              ELSE
 19263                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19264                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19265                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 353
* EL6311.cbl
 19266                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19267                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19268                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19269                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19270                 GO TO 7100-DISPLAY-CANCELS
 19271           ELSE
 19272              GO TO 4205-READ-NEXT-RECORD.
 19273
 19274     IF PB-CANCELLATION
 19275        IF (CANCEL-IN-ERROR  AND
 19276            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19277            ALL-CANCELS
 19278            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19279            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19280            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19281            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19282            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19283            MOVE PB-SV-STATE            TO PI-SV-STATE
 19284            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19285            GO TO 7100-DISPLAY-CANCELS.
 19286
 19287     GO TO 4205-READ-NEXT-RECORD.
 19288
 19289 4250-END-RECORDS.
 19290******************************************************************
 19291*                                                                *
 19292*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19293*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19294*         PROGRAM.                                               *
 19295*                                                                *
 19296******************************************************************
 19297
 19298     IF BROWSE-STARTED
 19299        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19300
 19301* EXEC CICS ENDBR
 19302*            DATASET  (FILE-ID-ERPNDB4)
 19303*       END-EXEC.
 19304     MOVE 0
 19305       TO DFHEIV11
 19306*    MOVE '&2                    $   #00016457' TO DFHEIV0
 19307     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19308     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19309     MOVE X'2020233030303136343537' TO DFHEIV0(25:11)
 19310     CALL 'kxdfhei1' USING DFHEIV0,
 19311           FILE-ID-ERPNDB4,
 19312           DFHEIV11,
 19313           DFHEIV99
 19314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19315
 19316
 19317     IF  EIBTRNID NOT = TRANS-EXB1
 19318         IF PENDING-BUS-RECS-FOUND
 19319             NEXT SENTENCE
 19320           ELSE
 19321             MOVE '9'            TO PI-BROWSE-SW
 19322             GO TO 9400-CLEAR.
 19323
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 354
* EL6311.cbl
 19324     IF SHOW-RECORD
 19325        MOVE ER-2253            TO EMI-ERROR
 19326       ELSE
 19327        MOVE ER-2254            TO EMI-ERROR.
 19328
 19329     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19330
 19331     IF PI-MAP-NAME = SPACES
 19332        MOVE -1                  TO DPFENTRL
 19333        MOVE EL631D               TO PI-MAP-NAME
 19334        GO TO 8100-SEND-INITIAL-MAP.
 19335
 19336     IF PI-MAP-NAME = EL631B
 19337        MOVE -1                  TO BMAINTL
 19338     ELSE
 19339        IF PI-MAP-NAME = EL631C
 19340           MOVE -1               TO CMAINTL
 19341        ELSE
 19342           MOVE -1               TO DPFENTRL.
 19343
 19344     GO TO 8200-SEND-DATAONLY.
 19345
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 355
* EL6311.cbl
 19347
 19348***************************************************************
 19349*                                                             *
 19350*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19351*                                                             *
 19352*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19353*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19354*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19355*                                                             *
 19356*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19357*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19358*          A. IS IT WITHIN THE SAME COMPANY                   *
 19359*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19360*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19361*                AND IS IT TO BE DISPLAYED.                   *
 19362*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19363*                DISPLAYED.                                   *
 19364*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19365*                DISPLAYED.                                   *
 19366*                                                             *
 19367*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19368*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19369*                                                             *
 19370*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19371*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19372*                THEY ARE NOT TO BE DISPLAYED.                *
 19373*                                                             *
 19374***************************************************************
 19375
 19376 4300-BROWSE-FILE-FORWARD.
 19377     IF FIRST-TIME OR SHOW-RECORD
 19378        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19379        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19380        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19381     ELSE
 19382        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19383        IF ERPNDB-BATCH-SEQ-NO = +9999
 19384           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19385        ELSE
 19386           IF DISPLAY-CHANGE-RECORDS
 19387              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19388           ELSE
 19389              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19390              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19391
 19392
 19393* EXEC CICS HANDLE CONDITION
 19394*         ENDFILE  (4350-END-BATCH)
 19395*         NOTFND   (4350-END-BATCH)
 19396*    END-EXEC.
 19397*    MOVE '"$''I                  ! M #00016536' TO DFHEIV0
 19398     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19400     MOVE X'4D20233030303136353336' TO DFHEIV0(25:11)
 19401     CALL 'kxdfhei1' USING DFHEIV0
 19402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19403
 19404
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 356
* EL6311.cbl
 19405 4305-READ-NEXT.
 19406     IF PI-DISPLAY-ORIGINAL-BATCH
 19407        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19408     ELSE
 19409        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19410
 19411
 19412* EXEC CICS READ
 19413*         DATASET   (FILE-ID)
 19414*         SET       (ADDRESS OF PENDING-BUSINESS)
 19415*         RIDFLD    (ERPNDB-KEY)
 19416*         GTEQ
 19417*    END-EXEC.
 19418*    MOVE '&"S        G          (   #00016547' TO DFHEIV0
 19419     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19421     MOVE X'2020233030303136353437' TO DFHEIV0(25:11)
 19422     CALL 'kxdfhei1' USING DFHEIV0,
 19423           FILE-ID,
 19424           DFHEIV20,
 19425           DFHEIV99,
 19426           ERPNDB-KEY,
 19427           DFHEIV99,
 19428           DFHEIV99,
 19429           DFHEIV99
 19430     SET ADDRESS OF PENDING-BUSINESS TO
 19431         DFHEIV20
 19432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19433
 19434
 19435     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19436        GO TO 4350-END-BATCH.
 19437
 19438     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19439                                    WS-BATCH-NO.
 19440
 19441     IF  WS-BATCH-PREFIX = '#CL'
 19442         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19443         GO TO 4305-READ-NEXT.
 19444
 19445     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19446     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19447     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19448     MOVE PB-STATE               TO PI-PB-STATE.
 19449     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19450
 19451     IF PB-BATCH-TRAILER
 19452        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19453        GO TO 4305-READ-NEXT.
 19454
 19455     IF SHOW-RECORD
 19456           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19457              GO TO 4310-BUMP-SEQ
 19458           ELSE
 19459              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19460                 GO TO 4310-BUMP-SEQ
 19461              ELSE
 19462                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 357
* EL6311.cbl
 19463
 19464     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19465        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19466           GO TO 4310-BUMP-SEQ
 19467        ELSE
 19468           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19469              GO TO 4307-CHECK-REC-TYPE
 19470           ELSE
 19471              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19472                 GO TO 4307-CHECK-REC-TYPE
 19473              ELSE
 19474                 GO TO 4310-BUMP-SEQ.
 19475
 19476     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19477        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19478           GO TO 4310-BUMP-SEQ.
 19479
 19480 4307-CHECK-REC-TYPE.
 19481     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19482         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19483             NEXT SENTENCE
 19484         ELSE
 19485             GO TO 4310-BUMP-SEQ.
 19486
 19487     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19488         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19489             NEXT SENTENCE
 19490        ELSE
 19491             GO TO 4310-BUMP-SEQ.
 19492
 19493     IF NOT DISPLAY-CHANGE-RECORDS AND
 19494            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19495        GO TO 4310-BUMP-SEQ.
 19496
 19497     IF DISPLAY-HOLD-RECORDS AND
 19498        NOT PB-RECORD-ON-HOLD
 19499          GO TO 4310-BUMP-SEQ.
 19500
 19501     IF PB-ISSUE
 19502        IF DISPLAY-CHK-REQ-RECORDS
 19503           GO TO 4310-BUMP-SEQ.
 19504
 19505     IF PB-ISSUE
 19506        IF ISSUE-WITH-WARNING
 19507           IF PB-WARNING-ERRORS
 19508              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19509                  GO TO 4310-BUMP-SEQ
 19510              ELSE
 19511                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19512                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19513                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19514                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19515                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19516                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19517                 GO TO 7000-DISPLAY-ISSUES
 19518           ELSE
 19519              GO TO 4310-BUMP-SEQ.
 19520
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 358
* EL6311.cbl
 19521     IF PB-ISSUE
 19522        IF (ISSUES-IN-ERROR AND
 19523            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19524            ALL-ISSUES
 19525            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19526            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19527            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19528            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19529            MOVE PB-SV-STATE            TO PI-SV-STATE
 19530            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19531            GO TO 7000-DISPLAY-ISSUES
 19532        ELSE
 19533            GO TO 4310-BUMP-SEQ.
 19534
 19535     IF PB-CANCELLATION
 19536        IF DISPLAY-CHK-REQ-RECORDS
 19537           IF PB-C-REFUND-REQUESTED
 19538              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19539              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19540              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19541              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19542              MOVE PB-SV-STATE            TO PI-SV-STATE
 19543              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19544              GO TO 7100-DISPLAY-CANCELS
 19545           ELSE
 19546              GO TO 4310-BUMP-SEQ.
 19547
 19548     IF PB-CANCELLATION
 19549        IF CANCEL-WITH-WARNING
 19550           IF PB-WARNING-ERRORS
 19551              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19552                  GO TO 4310-BUMP-SEQ
 19553              ELSE
 19554                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19555                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19556                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19557                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19558                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19559                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19560                 GO TO 7100-DISPLAY-CANCELS
 19561           ELSE
 19562              GO TO 4310-BUMP-SEQ.
 19563
 19564     IF PB-CANCELLATION
 19565        IF (CANCEL-IN-ERROR  AND
 19566            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19567            ALL-CANCELS
 19568            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19569            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19570            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19571            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19572            MOVE PB-SV-STATE            TO PI-SV-STATE
 19573            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19574            GO TO 7100-DISPLAY-CANCELS.
 19575
 19576 4310-BUMP-SEQ.
 19577     IF NOT DISPLAY-CHANGE-RECORDS
 19578        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 359
* EL6311.cbl
 19579        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19580     ELSE
 19581        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19582           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19583           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19584        ELSE
 19585           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19586           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19587
 19588     GO TO 4305-READ-NEXT.
 19589
 19590 4350-END-BATCH.
 19591
 19592******************************************************************
 19593*                                                                *
 19594*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19595*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19596*         PROGRAM.                                               *
 19597*                                                                *
 19598******************************************************************
 19599
 19600     IF  EIBTRNID NOT = TRANS-EXB1
 19601         IF PENDING-BUS-RECS-FOUND
 19602             NEXT SENTENCE
 19603           ELSE
 19604             MOVE '9'            TO PI-BROWSE-SW
 19605             GO TO 9400-CLEAR.
 19606
 19607     IF SHOW-RECORD
 19608        MOVE ER-2253            TO EMI-ERROR
 19609     ELSE
 19610        MOVE ER-2251            TO EMI-ERROR.
 19611
 19612     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19613
 19614     IF PI-MAP-NAME = SPACES
 19615        MOVE -1                  TO BMAINTL
 19616        MOVE EL631B               TO PI-MAP-NAME
 19617        GO TO 8100-SEND-INITIAL-MAP.
 19618
 19619     IF PI-MAP-NAME = EL631B
 19620        MOVE -1                  TO BMAINTL
 19621     ELSE
 19622        IF PI-MAP-NAME = EL631C
 19623           MOVE -1               TO CMAINTL
 19624        ELSE
 19625           MOVE -1               TO DPFENTRL.
 19626
 19627     GO TO 8200-SEND-DATAONLY.
 19628
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 360
* EL6311.cbl
 19630
 19631******************************************************************
 19632*                                                                *
 19633*        B R O W S E   D E T A I L   B A C K W A R D             *
 19634*                                                                *
 19635******************************************************************
 19636
 19637 4500-BROWSE-DETAIL-BACKWARD.
 19638
 19639     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19640
 19641
 19642* EXEC CICS HANDLE CONDITION
 19643*         NOTFND   (4570-NOT-FOUND)
 19644*         ENDFILE  (4550-END-RECORDS)
 19645*    END-EXEC
 19646*    MOVE '"$I''                  ! N #00016760' TO DFHEIV0
 19647     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19649     MOVE X'4E20233030303136373630' TO DFHEIV0(25:11)
 19650     CALL 'kxdfhei1' USING DFHEIV0
 19651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19652
 19653
 19654* EXEC CICS STARTBR
 19655*         DATASET   (FILE-ID-ERPNDB2)
 19656*         RIDFLD    (ERPNDB-ALT-KEY)
 19657*    END-EXEC.
 19658     MOVE 0
 19659       TO DFHEIV11
 19660*    MOVE '&,         G          &   #00016765' TO DFHEIV0
 19661     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19663     MOVE X'2020233030303136373635' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0,
 19665           FILE-ID-ERPNDB2,
 19666           ERPNDB-ALT-KEY,
 19667           DFHEIV99,
 19668           DFHEIV11,
 19669           DFHEIV99
 19670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19671
 19672
 19673     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19674                                    WS-FIRST-TIME-SW.
 19675
 19676 4505-READ-PREV-RECORD.
 19677
 19678* EXEC CICS READPREV
 19679*         DATASET    (FILE-ID-ERPNDB2)
 19680*         SET        (ADDRESS OF PENDING-BUSINESS)
 19681*         RIDFLD     (ERPNDB-ALT-KEY)
 19682*    END-EXEC.
 19683     MOVE 0
 19684       TO DFHEIV11
 19685*    MOVE '&0S                   )   #00016774' TO DFHEIV0
 19686     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19687     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 361
* EL6311.cbl
 19688     MOVE X'2020233030303136373734' TO DFHEIV0(25:11)
 19689     CALL 'kxdfhei1' USING DFHEIV0,
 19690           FILE-ID-ERPNDB2,
 19691           DFHEIV20,
 19692           DFHEIV99,
 19693           ERPNDB-ALT-KEY,
 19694           DFHEIV99,
 19695           DFHEIV11,
 19696           DFHEIV99,
 19697           DFHEIV99
 19698     SET ADDRESS OF PENDING-BUSINESS TO
 19699         DFHEIV20
 19700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19701
 19702
 19703     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19704
 19705     IF WS-BATCH-PREFIX = '#CL'
 19706         GO TO 4505-READ-PREV-RECORD.
 19707
 19708     IF FIRST-TIME
 19709         MOVE SPACE               TO WS-FIRST-TIME-SW
 19710         GO TO 4505-READ-PREV-RECORD.
 19711
 19712     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19713        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19714        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19715        PB-STATE         NOT = PI-PB-STATE    OR
 19716        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19717          GO TO 4550-END-RECORDS.
 19718
 19719
 19720     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19721
 19722     IF PB-BATCH-TRAILER
 19723        GO TO 4505-READ-PREV-RECORD.
 19724
 19725     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19726
 19727     IF  WS-BATCH-PREFIX = '#CL'
 19728         GO TO 4505-READ-PREV-RECORD.
 19729
 19730     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19731        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19732           GO TO 4505-READ-PREV-RECORD
 19733        ELSE
 19734           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19735              GO TO 4510-CHECK-REC-TYPE
 19736           ELSE
 19737              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19738                 GO TO 4510-CHECK-REC-TYPE
 19739              ELSE
 19740                 GO TO 4505-READ-PREV-RECORD.
 19741
 19742     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19743        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19744           GO TO 4505-READ-PREV-RECORD.
 19745
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 362
* EL6311.cbl
 19746 4510-CHECK-REC-TYPE.
 19747     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19748         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19749             NEXT SENTENCE
 19750         ELSE
 19751             GO TO 4505-READ-PREV-RECORD.
 19752
 19753     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19754         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19755             NEXT SENTENCE
 19756        ELSE
 19757             GO TO 4505-READ-PREV-RECORD.
 19758
 19759     IF NOT DISPLAY-CHANGE-RECORDS AND
 19760            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19761        GO TO 4505-READ-PREV-RECORD.
 19762
 19763     IF DISPLAY-HOLD-RECORDS AND
 19764        NOT PB-RECORD-ON-HOLD
 19765          GO TO 4505-READ-PREV-RECORD.
 19766
 19767     IF PB-ISSUE
 19768        IF DISPLAY-CHK-REQ-RECORDS
 19769           GO TO 4505-READ-PREV-RECORD.
 19770
 19771     IF PB-ISSUE
 19772        IF ISSUE-WITH-WARNING
 19773           IF PB-WARNING-ERRORS
 19774              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19775                  GO TO 4505-READ-PREV-RECORD
 19776              ELSE
 19777                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19778                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19779                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19780                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19781                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19782                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19783                 GO TO 7000-DISPLAY-ISSUES
 19784           ELSE
 19785              GO TO 4505-READ-PREV-RECORD.
 19786
 19787     IF PB-ISSUE
 19788        IF (ISSUES-IN-ERROR AND
 19789            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19790            ALL-ISSUES
 19791            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19792            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19793            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19794            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19795            MOVE PB-SV-STATE            TO PI-SV-STATE
 19796            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19797            GO TO 7000-DISPLAY-ISSUES
 19798        ELSE
 19799            GO TO 4505-READ-PREV-RECORD.
 19800
 19801     IF PB-CANCELLATION
 19802        IF DISPLAY-CHK-REQ-RECORDS
 19803           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 363
* EL6311.cbl
 19804              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19805              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19806              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19807              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19808              MOVE PB-SV-STATE            TO PI-SV-STATE
 19809              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19810              GO TO 7100-DISPLAY-CANCELS
 19811           ELSE
 19812              GO TO 4505-READ-PREV-RECORD.
 19813
 19814     IF PB-CANCELLATION
 19815        IF CANCEL-WITH-WARNING
 19816           IF PB-WARNING-ERRORS
 19817              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19818                  GO TO 4505-READ-PREV-RECORD
 19819              ELSE
 19820                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19821                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19822                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19823                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19824                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19825                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19826                 GO TO 7100-DISPLAY-CANCELS
 19827           ELSE
 19828              GO TO 4505-READ-PREV-RECORD.
 19829
 19830     IF PB-CANCELLATION
 19831        IF (CANCEL-IN-ERROR  AND
 19832            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19833            ALL-CANCELS
 19834            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19835            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19836            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19837            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19838            MOVE PB-SV-STATE            TO PI-SV-STATE
 19839            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19840            GO TO 7100-DISPLAY-CANCELS.
 19841
 19842     GO TO 4505-READ-PREV-RECORD.
 19843
 19844 4550-END-RECORDS.
 19845     IF PI-MAP-NAME = EL631B
 19846        MOVE -1                  TO BMAINTL
 19847     ELSE
 19848        IF PI-MAP-NAME = EL631C
 19849           MOVE -1               TO CMAINTL
 19850        ELSE
 19851           MOVE -1               TO DPFENTRL.
 19852
 19853     MOVE ER-2255               TO EMI-ERROR.
 19854     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19855     GO TO 8200-SEND-DATAONLY.
 19856
 19857 4570-NOT-FOUND.
 19858
 19859******************************************************************
 19860*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19861******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 364
* EL6311.cbl
 19862
 19863
 19864* EXEC CICS RESETBR
 19865*         DATASET    (FILE-ID-ERPNDB2)
 19866*         RIDFLD     (ERPNDB-ALT-KEY)
 19867*    END-EXEC.
 19868     MOVE 0
 19869       TO DFHEIV11
 19870*    MOVE '&4         G          &   #00016940' TO DFHEIV0
 19871     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19872     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19873     MOVE X'2020233030303136393430' TO DFHEIV0(25:11)
 19874     CALL 'kxdfhei1' USING DFHEIV0,
 19875           FILE-ID-ERPNDB2,
 19876           ERPNDB-ALT-KEY,
 19877           DFHEIV99,
 19878           DFHEIV11,
 19879           DFHEIV99
 19880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19881
 19882
 19883
 19884* EXEC CICS READNEXT
 19885*         DATASET    (FILE-ID-ERPNDB2)
 19886*         SET        (ADDRESS OF PENDING-BUSINESS)
 19887*         RIDFLD     (ERPNDB-ALT-KEY)
 19888*    END-EXEC.
 19889     MOVE 0
 19890       TO DFHEIV11
 19891*    MOVE '&.S                   )   #00016945' TO DFHEIV0
 19892     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19893     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19894     MOVE X'2020233030303136393435' TO DFHEIV0(25:11)
 19895     CALL 'kxdfhei1' USING DFHEIV0,
 19896           FILE-ID-ERPNDB2,
 19897           DFHEIV20,
 19898           DFHEIV99,
 19899           ERPNDB-ALT-KEY,
 19900           DFHEIV99,
 19901           DFHEIV11,
 19902           DFHEIV99,
 19903           DFHEIV99
 19904     SET ADDRESS OF PENDING-BUSINESS TO
 19905         DFHEIV20
 19906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19907
 19908
 19909
 19910* EXEC CICS READPREV
 19911*         DATASET    (FILE-ID-ERPNDB2)
 19912*         SET        (ADDRESS OF PENDING-BUSINESS)
 19913*         RIDFLD     (ERPNDB-ALT-KEY)
 19914*    END-EXEC.
 19915     MOVE 0
 19916       TO DFHEIV11
 19917*    MOVE '&0S                   )   #00016951' TO DFHEIV0
 19918     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19919     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 365
* EL6311.cbl
 19920     MOVE X'2020233030303136393531' TO DFHEIV0(25:11)
 19921     CALL 'kxdfhei1' USING DFHEIV0,
 19922           FILE-ID-ERPNDB2,
 19923           DFHEIV20,
 19924           DFHEIV99,
 19925           ERPNDB-ALT-KEY,
 19926           DFHEIV99,
 19927           DFHEIV11,
 19928           DFHEIV99,
 19929           DFHEIV99
 19930     SET ADDRESS OF PENDING-BUSINESS TO
 19931         DFHEIV20
 19932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19933
 19934
 19935 4580-READ-PREV-RECORD.
 19936
 19937* EXEC CICS READPREV
 19938*         DATASET    (FILE-ID-ERPNDB2)
 19939*         SET        (ADDRESS OF PENDING-BUSINESS)
 19940*         RIDFLD     (ERPNDB-ALT-KEY)
 19941*    END-EXEC.
 19942     MOVE 0
 19943       TO DFHEIV11
 19944*    MOVE '&0S                   )   #00016958' TO DFHEIV0
 19945     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19946     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19947     MOVE X'2020233030303136393538' TO DFHEIV0(25:11)
 19948     CALL 'kxdfhei1' USING DFHEIV0,
 19949           FILE-ID-ERPNDB2,
 19950           DFHEIV20,
 19951           DFHEIV99,
 19952           ERPNDB-ALT-KEY,
 19953           DFHEIV99,
 19954           DFHEIV11,
 19955           DFHEIV99,
 19956           DFHEIV99
 19957     SET ADDRESS OF PENDING-BUSINESS TO
 19958         DFHEIV20
 19959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19960
 19961
 19962     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19963
 19964     IF WS-BATCH-PREFIX = '#CL'
 19965        GO TO 4580-READ-PREV-RECORD.
 19966
 19967     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19968     GO TO 4505-READ-PREV-RECORD.
 19969
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 366
* EL6311.cbl
 19971
 19972******************************************************************
 19973*                                                                *
 19974*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19975*                                                                *
 19976******************************************************************
 19977
 19978 4600-BROWSE-PRIMARY-BACKWARD.
 19979        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19980
 19981     IF ERPNDB-BATCH-SEQ-NO = +9999
 19982        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19983
 19984        IF ERPNDB-BATCH-SEQ-NO = +0000
 19985           GO TO 4650-END-BATCH
 19986        ELSE
 19987           IF PI-MAP-NAME NOT = EL631D
 19988              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19989                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19990              ELSE
 19991                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19992                 IF DISPLAY-CHANGE-RECORDS
 19993                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19994                 ELSE
 19995                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19996
 19997
 19998* EXEC CICS HANDLE CONDITION
 19999*         NOTFND    (4680-NOT-FOUND)
 20000*         ENDFILE   (4680-NOT-FOUND)
 20001*    END-EXEC.
 20002*    MOVE '"$I''                  ! O #00016999' TO DFHEIV0
 20003     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20005     MOVE X'4F20233030303136393939' TO DFHEIV0(25:11)
 20006     CALL 'kxdfhei1' USING DFHEIV0
 20007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20008
 20009
 20010 4605-READ-NEXT.
 20011     IF ERPNDB-BATCH-SEQ-NO = +0000
 20012        GO TO 4650-END-BATCH.
 20013
 20014     IF PI-DISPLAY-ORIGINAL-BATCH
 20015        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20016     ELSE
 20017        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20018
 20019
 20020* EXEC CICS READ
 20021*         DATASET   (FILE-ID)
 20022*         SET       (ADDRESS OF PENDING-BUSINESS)
 20023*         RIDFLD    (ERPNDB-KEY)
 20024*    END-EXEC.
 20025*    MOVE '&"S        E          (   #00017013' TO DFHEIV0
 20026     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20027     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20028     MOVE X'2020233030303137303133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 367
* EL6311.cbl
 20029     CALL 'kxdfhei1' USING DFHEIV0,
 20030           FILE-ID,
 20031           DFHEIV20,
 20032           DFHEIV99,
 20033           ERPNDB-KEY,
 20034           DFHEIV99,
 20035           DFHEIV99,
 20036           DFHEIV99
 20037     SET ADDRESS OF PENDING-BUSINESS TO
 20038         DFHEIV20
 20039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20040
 20041
 20042     IF NOT  PI-PRIMARY-WITH-SELECT
 20043        GO TO 4607-CHECK-REC-TYPE.
 20044
 20045     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20046
 20047     IF  WS-BATCH-PREFIX = '#CL'
 20048         GO TO 4610-BUMP-SEQ.
 20049
 20050     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20051        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20052           GO TO 4610-BUMP-SEQ
 20053        ELSE
 20054           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20055              GO TO 4607-CHECK-REC-TYPE
 20056           ELSE
 20057              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20058                 GO TO 4607-CHECK-REC-TYPE
 20059              ELSE
 20060                 GO TO 4610-BUMP-SEQ.
 20061
 20062     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20063        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20064           GO TO 4610-BUMP-SEQ.
 20065
 20066 4607-CHECK-REC-TYPE.
 20067     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20068         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20069             NEXT SENTENCE
 20070         ELSE
 20071             GO TO 4610-BUMP-SEQ.
 20072
 20073     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20074         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20075             NEXT SENTENCE
 20076        ELSE
 20077             GO TO 4610-BUMP-SEQ.
 20078
 20079     IF NOT DISPLAY-CHANGE-RECORDS AND
 20080            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20081        GO TO 4610-BUMP-SEQ.
 20082
 20083     IF DISPLAY-HOLD-RECORDS AND
 20084        NOT PB-RECORD-ON-HOLD
 20085          GO TO 4610-BUMP-SEQ.
 20086
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 368
* EL6311.cbl
 20087     IF PB-ISSUE
 20088        IF DISPLAY-CHK-REQ-RECORDS
 20089           GO TO 4610-BUMP-SEQ.
 20090
 20091     IF PB-ISSUE
 20092        IF ISSUE-WITH-WARNING
 20093           IF PB-WARNING-ERRORS
 20094              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20095                  GO TO 4610-BUMP-SEQ
 20096              ELSE
 20097                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20098                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20099                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20100                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20101                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20102                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20103                 GO TO 7000-DISPLAY-ISSUES
 20104           ELSE
 20105              GO TO 4610-BUMP-SEQ.
 20106
 20107     IF PB-ISSUE
 20108        IF (ISSUES-IN-ERROR AND
 20109            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20110            ALL-ISSUES
 20111            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20112            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20113            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20114            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20115            MOVE PB-SV-STATE            TO PI-SV-STATE
 20116            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20117            GO TO 7000-DISPLAY-ISSUES
 20118        ELSE
 20119            GO TO 4610-BUMP-SEQ.
 20120
 20121     IF PB-CANCELLATION
 20122        IF DISPLAY-CHK-REQ-RECORDS
 20123           IF PB-C-REFUND-REQUESTED
 20124              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20125              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20126              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20127              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20128              MOVE PB-SV-STATE            TO PI-SV-STATE
 20129              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20130              GO TO 7100-DISPLAY-CANCELS
 20131           ELSE
 20132              GO TO 4610-BUMP-SEQ.
 20133
 20134     IF PB-CANCELLATION
 20135        IF CANCEL-WITH-WARNING
 20136           IF PB-WARNING-ERRORS
 20137              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20138                  GO TO 4610-BUMP-SEQ
 20139              ELSE
 20140                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20141                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20142                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20143                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20144                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 369
* EL6311.cbl
 20145                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20146                 GO TO 7100-DISPLAY-CANCELS
 20147           ELSE
 20148              GO TO 4610-BUMP-SEQ.
 20149
 20150     IF PB-CANCELLATION
 20151        IF (CANCEL-IN-ERROR  AND
 20152            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20153            ALL-CANCELS
 20154            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20155            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20156            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20157            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20158            MOVE PB-SV-STATE            TO PI-SV-STATE
 20159            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20160            GO TO 7100-DISPLAY-CANCELS.
 20161
 20162 4610-BUMP-SEQ.
 20163     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20164        GO TO 4650-END-BATCH.
 20165
 20166     IF DISPLAY-CHANGE-RECORDS
 20167        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20168           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20169        ELSE
 20170           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20171           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20172        ELSE
 20173           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20174           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20175
 20176        GO TO 4605-READ-NEXT.
 20177
 20178 4650-END-BATCH.
 20179     IF PI-MAP-NAME = EL631B
 20180        MOVE -1                  TO BMAINTL
 20181     ELSE
 20182        IF PI-MAP-NAME = EL631C
 20183           MOVE -1               TO CMAINTL
 20184        ELSE
 20185           MOVE -1               TO DPFENTRL.
 20186
 20187     MOVE ER-2252               TO EMI-ERROR.
 20188     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20189     GO TO 8200-SEND-DATAONLY.
 20190
 20191 4680-NOT-FOUND.
 20192     IF DISPLAY-CHANGE-RECORDS
 20193        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20194           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20195        ELSE
 20196           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20197           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20198     ELSE
 20199        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20200
 20201     GO TO 4605-READ-NEXT.
 20202
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 370
* EL6311.cbl
 20204
 20205******************************************************************
 20206*                                                                *
 20207*        B R O W S E   F I L E   B A C K W A R D S               *
 20208*                                                                *
 20209******************************************************************
 20210
 20211 4800-BROWSE-FILE-BACKWARD.
 20212
 20213* EXEC CICS HANDLE CONDITION
 20214*         NOTFND   (4860-NOT-FOUND)
 20215*         ENDFILE  (4850-END-RECORDS)
 20216*    END-EXEC.
 20217*    MOVE '"$I''                  ! P #00017189' TO DFHEIV0
 20218     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20220     MOVE X'5020233030303137313839' TO DFHEIV0(25:11)
 20221     CALL 'kxdfhei1' USING DFHEIV0
 20222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20223
 20224
 20225     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20226
 20227     IF PI-DISPLAY-ORIGINAL-BATCH
 20228        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20229     ELSE
 20230        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20231
 20232
 20233* EXEC CICS STARTBR
 20234*         DATASET   (FILE-ID)
 20235*         RIDFLD    (ERPNDB-KEY)
 20236*    END-EXEC.
 20237     MOVE 0
 20238       TO DFHEIV11
 20239*    MOVE '&,         G          &   #00017201' TO DFHEIV0
 20240     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20241     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20242     MOVE X'2020233030303137323031' TO DFHEIV0(25:11)
 20243     CALL 'kxdfhei1' USING DFHEIV0,
 20244           FILE-ID,
 20245           ERPNDB-KEY,
 20246           DFHEIV99,
 20247           DFHEIV11,
 20248           DFHEIV99
 20249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20250
 20251
 20252     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20253
 20254
 20255* EXEC CICS READPREV
 20256*         DATASET    (FILE-ID-ERPNDB)
 20257*         SET        (ADDRESS OF PENDING-BUSINESS)
 20258*         RIDFLD     (ERPNDB-KEY)
 20259*    END-EXEC.
 20260     MOVE 0
 20261       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 371
* EL6311.cbl
 20262*    MOVE '&0S                   )   #00017208' TO DFHEIV0
 20263     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20264     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20265     MOVE X'2020233030303137323038' TO DFHEIV0(25:11)
 20266     CALL 'kxdfhei1' USING DFHEIV0,
 20267           FILE-ID-ERPNDB,
 20268           DFHEIV20,
 20269           DFHEIV99,
 20270           ERPNDB-KEY,
 20271           DFHEIV99,
 20272           DFHEIV11,
 20273           DFHEIV99,
 20274           DFHEIV99
 20275     SET ADDRESS OF PENDING-BUSINESS TO
 20276         DFHEIV20
 20277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20278
 20279
 20280 4810-READ-PREV-RECORD.
 20281
 20282* EXEC CICS READPREV
 20283*         DATASET    (FILE-ID-ERPNDB)
 20284*         SET        (ADDRESS OF PENDING-BUSINESS)
 20285*         RIDFLD     (ERPNDB-KEY)
 20286*    END-EXEC.
 20287     MOVE 0
 20288       TO DFHEIV11
 20289*    MOVE '&0S                   )   #00017215' TO DFHEIV0
 20290     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20291     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20292     MOVE X'2020233030303137323135' TO DFHEIV0(25:11)
 20293     CALL 'kxdfhei1' USING DFHEIV0,
 20294           FILE-ID-ERPNDB,
 20295           DFHEIV20,
 20296           DFHEIV99,
 20297           ERPNDB-KEY,
 20298           DFHEIV99,
 20299           DFHEIV11,
 20300           DFHEIV99,
 20301           DFHEIV99
 20302     SET ADDRESS OF PENDING-BUSINESS TO
 20303         DFHEIV20
 20304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20305
 20306
 20307     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20308        GO TO 4850-END-RECORDS.
 20309
 20310     IF PB-BATCH-TRAILER
 20311        GO TO 4810-READ-PREV-RECORD.
 20312
 20313     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20314
 20315     IF  WS-BATCH-PREFIX = '#CL'
 20316         GO TO 4810-READ-PREV-RECORD.
 20317
 20318     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20319        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 372
* EL6311.cbl
 20320           GO TO 4810-READ-PREV-RECORD
 20321        ELSE
 20322           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20323              GO TO 4820-CHECK-REC-TYPE
 20324           ELSE
 20325              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20326                 GO TO 4820-CHECK-REC-TYPE
 20327              ELSE
 20328                 GO TO 4810-READ-PREV-RECORD.
 20329
 20330     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20331        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20332           GO TO 4810-READ-PREV-RECORD.
 20333
 20334 4820-CHECK-REC-TYPE.
 20335     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20336         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20337             NEXT SENTENCE
 20338         ELSE
 20339             GO TO 4810-READ-PREV-RECORD.
 20340
 20341     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20342         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20343             NEXT SENTENCE
 20344        ELSE
 20345             GO TO 4810-READ-PREV-RECORD.
 20346
 20347     IF NOT DISPLAY-CHANGE-RECORDS AND
 20348            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20349        GO TO 4810-READ-PREV-RECORD.
 20350
 20351     IF DISPLAY-HOLD-RECORDS AND
 20352        NOT PB-RECORD-ON-HOLD
 20353          GO TO 4810-READ-PREV-RECORD.
 20354
 20355     IF PB-ISSUE
 20356        IF DISPLAY-CHK-REQ-RECORDS
 20357           GO TO 4810-READ-PREV-RECORD.
 20358
 20359     IF PB-ISSUE
 20360        IF ISSUE-WITH-WARNING
 20361           IF PB-WARNING-ERRORS
 20362              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20363                  GO TO 4810-READ-PREV-RECORD
 20364              ELSE
 20365                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20366                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20367                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20368                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20369                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20370                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20371                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20372                 GO TO 7000-DISPLAY-ISSUES
 20373           ELSE
 20374              GO TO 4810-READ-PREV-RECORD.
 20375
 20376     IF PB-ISSUE
 20377        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 373
* EL6311.cbl
 20378            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20379            ALL-ISSUES
 20380            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20381            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20382            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20383            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20384            MOVE PB-SV-STATE            TO PI-SV-STATE
 20385            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20386            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20387            GO TO 7000-DISPLAY-ISSUES
 20388        ELSE
 20389            GO TO 4810-READ-PREV-RECORD.
 20390
 20391     IF PB-CANCELLATION
 20392        IF DISPLAY-CHK-REQ-RECORDS
 20393           IF PB-C-REFUND-REQUESTED
 20394              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20395              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20396              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20397              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20398              MOVE PB-SV-STATE            TO PI-SV-STATE
 20399              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20400              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20401              GO TO 7100-DISPLAY-CANCELS
 20402           ELSE
 20403              GO TO 4810-READ-PREV-RECORD.
 20404
 20405     IF PB-CANCELLATION
 20406        IF CANCEL-WITH-WARNING
 20407           IF PB-WARNING-ERRORS
 20408              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20409                  GO TO 4810-READ-PREV-RECORD
 20410              ELSE
 20411                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20412                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20413                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20414                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20415                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20416                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20417                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20418                 GO TO 7100-DISPLAY-CANCELS
 20419           ELSE
 20420              GO TO 4810-READ-PREV-RECORD.
 20421
 20422     IF PB-CANCELLATION
 20423        IF (CANCEL-IN-ERROR  AND
 20424            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20425            ALL-CANCELS
 20426            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20427            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20428            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20429            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20430            MOVE PB-SV-STATE            TO PI-SV-STATE
 20431            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20432            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20433            GO TO 7100-DISPLAY-CANCELS.
 20434
 20435     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 374
* EL6311.cbl
 20436
 20437 4850-END-RECORDS.
 20438     MOVE ER-2252                TO EMI-ERROR.
 20439     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20440
 20441     IF PI-MAP-NAME = EL631B
 20442        MOVE -1                  TO BPFENTRL
 20443     ELSE
 20444        MOVE -1                  TO CPFENTRL.
 20445
 20446     GO TO 8200-SEND-DATAONLY.
 20447
 20448 4860-NOT-FOUND.
 20449
 20450******************************************************************
 20451*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20452******************************************************************
 20453
 20454
 20455* EXEC CICS RESETBR
 20456*         DATASET    (FILE-ID-ERPNDB)
 20457*         RIDFLD     (ERPNDB-KEY)
 20458*     END-EXEC.
 20459     MOVE 0
 20460       TO DFHEIV11
 20461*    MOVE '&4         G          &   #00017368' TO DFHEIV0
 20462     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20463     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20464     MOVE X'2020233030303137333638' TO DFHEIV0(25:11)
 20465     CALL 'kxdfhei1' USING DFHEIV0,
 20466           FILE-ID-ERPNDB,
 20467           ERPNDB-KEY,
 20468           DFHEIV99,
 20469           DFHEIV11,
 20470           DFHEIV99
 20471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20472
 20473
 20474
 20475* EXEC CICS READNEXT
 20476*         DATASET    (FILE-ID-ERPNDB)
 20477*         SET        (ADDRESS OF PENDING-BUSINESS)
 20478*         RIDFLD     (ERPNDB-KEY)
 20479*    END-EXEC.
 20480     MOVE 0
 20481       TO DFHEIV11
 20482*    MOVE '&.S                   )   #00017373' TO DFHEIV0
 20483     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20484     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20485     MOVE X'2020233030303137333733' TO DFHEIV0(25:11)
 20486     CALL 'kxdfhei1' USING DFHEIV0,
 20487           FILE-ID-ERPNDB,
 20488           DFHEIV20,
 20489           DFHEIV99,
 20490           ERPNDB-KEY,
 20491           DFHEIV99,
 20492           DFHEIV11,
 20493           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 375
* EL6311.cbl
 20494           DFHEIV99
 20495     SET ADDRESS OF PENDING-BUSINESS TO
 20496         DFHEIV20
 20497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20498
 20499
 20500
 20501* EXEC CICS READPREV
 20502*         DATASET    (FILE-ID-ERPNDB)
 20503*         SET        (ADDRESS OF PENDING-BUSINESS)
 20504*         RIDFLD     (ERPNDB-KEY)
 20505*    END-EXEC.
 20506     MOVE 0
 20507       TO DFHEIV11
 20508*    MOVE '&0S                   )   #00017379' TO DFHEIV0
 20509     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20510     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20511     MOVE X'2020233030303137333739' TO DFHEIV0(25:11)
 20512     CALL 'kxdfhei1' USING DFHEIV0,
 20513           FILE-ID-ERPNDB,
 20514           DFHEIV20,
 20515           DFHEIV99,
 20516           ERPNDB-KEY,
 20517           DFHEIV99,
 20518           DFHEIV11,
 20519           DFHEIV99,
 20520           DFHEIV99
 20521     SET ADDRESS OF PENDING-BUSINESS TO
 20522         DFHEIV20
 20523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20524
 20525
 20526     GO TO 4810-READ-PREV-RECORD.
 20527
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 376
* EL6311.cbl
 20529
 20530******************************************************************
 20531*                                                                *
 20532*           B R O W S E   C S R   B A C K W A R D                *
 20533*                                                                *
 20534******************************************************************
 20535
 20536 4900-BROWSE-CSR-BACKWARD.
 20537
 20538     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20539
 20540
 20541* EXEC CICS HANDLE CONDITION
 20542*         NOTFND   (4970-NOT-FOUND)
 20543*         ENDFILE  (4950-END-RECORDS)
 20544*    END-EXEC
 20545*    MOVE '"$I''                  ! Q #00017399' TO DFHEIV0
 20546     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20548     MOVE X'5120233030303137333939' TO DFHEIV0(25:11)
 20549     CALL 'kxdfhei1' USING DFHEIV0
 20550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20551
 20552
 20553* EXEC CICS STARTBR
 20554*         DATASET   (FILE-ID-ERPNDB4)
 20555*         RIDFLD    (ERPNDB-CSR-KEY)
 20556*    END-EXEC.
 20557     MOVE 0
 20558       TO DFHEIV11
 20559*    MOVE '&,         G          &   #00017404' TO DFHEIV0
 20560     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20561     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20562     MOVE X'2020233030303137343034' TO DFHEIV0(25:11)
 20563     CALL 'kxdfhei1' USING DFHEIV0,
 20564           FILE-ID-ERPNDB4,
 20565           ERPNDB-CSR-KEY,
 20566           DFHEIV99,
 20567           DFHEIV11,
 20568           DFHEIV99
 20569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20570
 20571
 20572     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20573                                    WS-FIRST-TIME-SW.
 20574
 20575 4905-READ-PREV-RECORD.
 20576
 20577* EXEC CICS READPREV
 20578*         DATASET    (FILE-ID-ERPNDB4)
 20579*         SET        (ADDRESS OF PENDING-BUSINESS)
 20580*         RIDFLD     (ERPNDB-CSR-KEY)
 20581*    END-EXEC.
 20582     MOVE 0
 20583       TO DFHEIV11
 20584*    MOVE '&0S                   )   #00017413' TO DFHEIV0
 20585     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20586     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 377
* EL6311.cbl
 20587     MOVE X'2020233030303137343133' TO DFHEIV0(25:11)
 20588     CALL 'kxdfhei1' USING DFHEIV0,
 20589           FILE-ID-ERPNDB4,
 20590           DFHEIV20,
 20591           DFHEIV99,
 20592           ERPNDB-CSR-KEY,
 20593           DFHEIV99,
 20594           DFHEIV11,
 20595           DFHEIV99,
 20596           DFHEIV99
 20597     SET ADDRESS OF PENDING-BUSINESS TO
 20598         DFHEIV20
 20599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20600
 20601
 20602     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20603
 20604     IF WS-BATCH-PREFIX = '#CL'
 20605         GO TO 4905-READ-PREV-RECORD.
 20606
 20607     IF FIRST-TIME
 20608         MOVE SPACE               TO WS-FIRST-TIME-SW
 20609         GO TO 4905-READ-PREV-RECORD.
 20610
 20611     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20612        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20613        GO TO 4950-END-RECORDS.
 20614
 20615     IF PB-BATCH-TRAILER
 20616        GO TO 4905-READ-PREV-RECORD.
 20617
 20618     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20619
 20620     IF  WS-BATCH-PREFIX = '#CL'
 20621         GO TO 4905-READ-PREV-RECORD.
 20622
 20623     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20624        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20625           GO TO 4905-READ-PREV-RECORD
 20626        ELSE
 20627           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20628              GO TO 4910-CHECK-REC-TYPE
 20629           ELSE
 20630              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20631                 GO TO 4910-CHECK-REC-TYPE
 20632              ELSE
 20633                 GO TO 4905-READ-PREV-RECORD.
 20634
 20635     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20636        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20637           GO TO 4905-READ-PREV-RECORD.
 20638
 20639 4910-CHECK-REC-TYPE.
 20640     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20641         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20642             NEXT SENTENCE
 20643         ELSE
 20644             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 378
* EL6311.cbl
 20645
 20646     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20647         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20648             NEXT SENTENCE
 20649        ELSE
 20650             GO TO 4905-READ-PREV-RECORD.
 20651
 20652     IF NOT DISPLAY-CHANGE-RECORDS AND
 20653            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20654        GO TO 4905-READ-PREV-RECORD.
 20655
 20656     IF DISPLAY-HOLD-RECORDS AND
 20657        NOT PB-RECORD-ON-HOLD
 20658          GO TO 4905-READ-PREV-RECORD.
 20659
 20660     IF PB-ISSUE
 20661        IF DISPLAY-CHK-REQ-RECORDS
 20662           GO TO 4905-READ-PREV-RECORD.
 20663
 20664     IF PB-ISSUE
 20665        IF ISSUE-WITH-WARNING
 20666           IF PB-WARNING-ERRORS
 20667              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20668                  GO TO 4505-READ-PREV-RECORD
 20669              ELSE
 20670                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20671                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20672                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20673                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20674                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20675                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20676                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20677                 GO TO 7000-DISPLAY-ISSUES
 20678           ELSE
 20679              GO TO 4905-READ-PREV-RECORD.
 20680
 20681     IF PB-ISSUE
 20682        IF (ISSUES-IN-ERROR AND
 20683            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20684            ALL-ISSUES
 20685            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20686            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20687            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20688            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20689            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20690            MOVE PB-SV-STATE            TO PI-SV-STATE
 20691            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20692            GO TO 7000-DISPLAY-ISSUES
 20693        ELSE
 20694            GO TO 4905-READ-PREV-RECORD.
 20695
 20696     IF PB-CANCELLATION
 20697        IF DISPLAY-CHK-REQ-RECORDS
 20698           IF PB-C-REFUND-REQUESTED
 20699              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20700              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20701              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20702              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 379
* EL6311.cbl
 20703              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20704              MOVE PB-SV-STATE            TO PI-SV-STATE
 20705              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20706              GO TO 7100-DISPLAY-CANCELS
 20707           ELSE
 20708              GO TO 4905-READ-PREV-RECORD.
 20709
 20710     IF PB-CANCELLATION
 20711        IF CANCEL-WITH-WARNING
 20712           IF PB-WARNING-ERRORS
 20713              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20714                  GO TO 4505-READ-PREV-RECORD
 20715              ELSE
 20716                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20717                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20718                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20719                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20720                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20721                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20722                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20723                 GO TO 7100-DISPLAY-CANCELS
 20724           ELSE
 20725              GO TO 4905-READ-PREV-RECORD.
 20726
 20727     IF PB-CANCELLATION
 20728        IF (CANCEL-IN-ERROR  AND
 20729            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20730            ALL-CANCELS
 20731            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20732            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20733            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20734            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20735            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20736            MOVE PB-SV-STATE            TO PI-SV-STATE
 20737            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20738            GO TO 7100-DISPLAY-CANCELS.
 20739
 20740     GO TO 4905-READ-PREV-RECORD.
 20741
 20742 4950-END-RECORDS.
 20743     IF PI-MAP-NAME = EL631B
 20744        MOVE -1                  TO BMAINTL
 20745     ELSE
 20746        IF PI-MAP-NAME = EL631C
 20747           MOVE -1               TO CMAINTL
 20748        ELSE
 20749           MOVE -1               TO DPFENTRL.
 20750
 20751     MOVE ER-2255               TO EMI-ERROR.
 20752     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20753     GO TO 8200-SEND-DATAONLY.
 20754
 20755 4970-NOT-FOUND.
 20756
 20757******************************************************************
 20758*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20759******************************************************************
 20760
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 380
* EL6311.cbl
 20761
 20762* EXEC CICS RESETBR
 20763*         DATASET    (FILE-ID-ERPNDB4)
 20764*         RIDFLD     (ERPNDB-CSR-KEY)
 20765*    END-EXEC.
 20766     MOVE 0
 20767       TO DFHEIV11
 20768*    MOVE '&4         G          &   #00017578' TO DFHEIV0
 20769     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20770     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20771     MOVE X'2020233030303137353738' TO DFHEIV0(25:11)
 20772     CALL 'kxdfhei1' USING DFHEIV0,
 20773           FILE-ID-ERPNDB4,
 20774           ERPNDB-CSR-KEY,
 20775           DFHEIV99,
 20776           DFHEIV11,
 20777           DFHEIV99
 20778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20779
 20780
 20781
 20782* EXEC CICS READNEXT
 20783*         DATASET    (FILE-ID-ERPNDB4)
 20784*         SET        (ADDRESS OF PENDING-BUSINESS)
 20785*         RIDFLD     (ERPNDB-CSR-KEY)
 20786*    END-EXEC.
 20787     MOVE 0
 20788       TO DFHEIV11
 20789*    MOVE '&.S                   )   #00017583' TO DFHEIV0
 20790     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20791     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20792     MOVE X'2020233030303137353833' TO DFHEIV0(25:11)
 20793     CALL 'kxdfhei1' USING DFHEIV0,
 20794           FILE-ID-ERPNDB4,
 20795           DFHEIV20,
 20796           DFHEIV99,
 20797           ERPNDB-CSR-KEY,
 20798           DFHEIV99,
 20799           DFHEIV11,
 20800           DFHEIV99,
 20801           DFHEIV99
 20802     SET ADDRESS OF PENDING-BUSINESS TO
 20803         DFHEIV20
 20804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20805
 20806
 20807
 20808* EXEC CICS READPREV
 20809*         DATASET    (FILE-ID-ERPNDB4)
 20810*         SET        (ADDRESS OF PENDING-BUSINESS)
 20811*         RIDFLD     (ERPNDB-CSR-KEY)
 20812*    END-EXEC.
 20813     MOVE 0
 20814       TO DFHEIV11
 20815*    MOVE '&0S                   )   #00017589' TO DFHEIV0
 20816     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20817     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20818     MOVE X'2020233030303137353839' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 381
* EL6311.cbl
 20819     CALL 'kxdfhei1' USING DFHEIV0,
 20820           FILE-ID-ERPNDB4,
 20821           DFHEIV20,
 20822           DFHEIV99,
 20823           ERPNDB-CSR-KEY,
 20824           DFHEIV99,
 20825           DFHEIV11,
 20826           DFHEIV99,
 20827           DFHEIV99
 20828     SET ADDRESS OF PENDING-BUSINESS TO
 20829         DFHEIV20
 20830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20831
 20832
 20833 4980-READ-PREV-RECORD.
 20834
 20835* EXEC CICS READPREV
 20836*         DATASET    (FILE-ID-ERPNDB4)
 20837*         SET        (ADDRESS OF PENDING-BUSINESS)
 20838*         RIDFLD     (ERPNDB-CSR-KEY)
 20839*    END-EXEC.
 20840     MOVE 0
 20841       TO DFHEIV11
 20842*    MOVE '&0S                   )   #00017596' TO DFHEIV0
 20843     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20844     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20845     MOVE X'2020233030303137353936' TO DFHEIV0(25:11)
 20846     CALL 'kxdfhei1' USING DFHEIV0,
 20847           FILE-ID-ERPNDB4,
 20848           DFHEIV20,
 20849           DFHEIV99,
 20850           ERPNDB-CSR-KEY,
 20851           DFHEIV99,
 20852           DFHEIV11,
 20853           DFHEIV99,
 20854           DFHEIV99
 20855     SET ADDRESS OF PENDING-BUSINESS TO
 20856         DFHEIV20
 20857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20858
 20859
 20860     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20861
 20862     IF WS-BATCH-PREFIX = '#CL'
 20863        GO TO 4980-READ-PREV-RECORD.
 20864
 20865     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20866     GO TO 4905-READ-PREV-RECORD.
 20867
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 382
* EL6311.cbl
 20869
 20870
 20871******************************************************************
 20872*                                                                *
 20873*        B R O W S E   B A T C H   H E A D E R S                 *
 20874*                                                                *
 20875******************************************************************
 20876
 20877 5000-BROWSE-BATCH-HEADERS.
 20878
 20879     IF EIBTRNID NOT = TRANS-EXB1
 20880        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20881        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20882        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20883        GO TO 5010-READ-NEXT-RECORD.
 20884
 20885     IF EIBAID = DFHPF4
 20886        MOVE '0'                TO PI-EDIT-SW
 20887        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20888        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20889        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20890        GO TO 5010-READ-NEXT-RECORD.
 20891
 20892     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20893     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20894     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20895
 20896
 20897* EXEC CICS HANDLE CONDITION
 20898*         ENDFILE  (5050-NOT-FOUND)
 20899*    END-EXEC.
 20900*    MOVE '"$''                   ! R #00017638' TO DFHEIV0
 20901     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20903     MOVE X'5220233030303137363338' TO DFHEIV0(25:11)
 20904     CALL 'kxdfhei1' USING DFHEIV0
 20905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20906
 20907
 20908 5010-READ-NEXT-RECORD.
 20909
 20910* EXEC CICS HANDLE CONDITION
 20911*         NOTFND    (5050-NOT-FOUND)
 20912*    END-EXEC.
 20913*    MOVE '"$I                   ! S #00017643' TO DFHEIV0
 20914     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20916     MOVE X'5320233030303137363433' TO DFHEIV0(25:11)
 20917     CALL 'kxdfhei1' USING DFHEIV0
 20918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20919
 20920
 20921
 20922* EXEC CICS READ
 20923*         DATASET   (FILE-ID-ERPNDB)
 20924*         SET       (ADDRESS OF PENDING-BUSINESS)
 20925*         RIDFLD    (ERPNDB-KEY)
 20926*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 383
* EL6311.cbl
 20927*    END-EXEC.
 20928*    MOVE '&"S        G          (   #00017647' TO DFHEIV0
 20929     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20930     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20931     MOVE X'2020233030303137363437' TO DFHEIV0(25:11)
 20932     CALL 'kxdfhei1' USING DFHEIV0,
 20933           FILE-ID-ERPNDB,
 20934           DFHEIV20,
 20935           DFHEIV99,
 20936           ERPNDB-KEY,
 20937           DFHEIV99,
 20938           DFHEIV99,
 20939           DFHEIV99
 20940     SET ADDRESS OF PENDING-BUSINESS TO
 20941         DFHEIV20
 20942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20943
 20944
 20945     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20946         GO TO 5050-NOT-FOUND.
 20947
 20948     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20949
 20950     IF WS-BATCH-PREFIX = '#CL'
 20951         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20952         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20953         GO TO 5010-READ-NEXT-RECORD.
 20954
 20955     IF NOT PB-BATCH-TRAILER
 20956         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20957         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20958         GO TO 5010-READ-NEXT-RECORD.
 20959
 20960     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20961         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20962             NEXT SENTENCE
 20963         ELSE
 20964             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20965             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20966             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20967             GO TO 5010-READ-NEXT-RECORD.
 20968
 20969     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20970         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20971             NEXT SENTENCE
 20972        ELSE
 20973             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20974             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20975             GO TO 5010-READ-NEXT-RECORD.
 20976
 20977     IF EIBAID = DFHPF4
 20978        MOVE '0'                TO PI-EDIT-SW
 20979        GO TO 7200-DISPLAY-BATCHES.
 20980
 20981     IF PI-CSR-BROWSE
 20982        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20983           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20984           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 384
* EL6311.cbl
 20985           GO TO 5010-READ-NEXT-RECORD.
 20986
 20987     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20988       IF PI-PB-CARRIER    = SPACES AND
 20989          PI-PB-GROUPING   = SPACES AND
 20990          PI-PB-STATE      = SPACES AND
 20991          PI-PB-ACCOUNT    = SPACES
 20992            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20993            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20994            GO TO 7200-DISPLAY-BATCHES
 20995         ELSE
 20996           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20997              PI-PB-GROUPING   = PB-GROUPING AND
 20998              PI-PB-STATE      = PB-STATE    AND
 20999              PI-PB-ACCOUNT    = PB-ACCOUNT
 21000              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21001              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21002              GO TO 7200-DISPLAY-BATCHES.
 21003
 21004     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21005     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21006
 21007
 21008* EXEC CICS HANDLE CONDITION
 21009*         NOTFND    (5050-NOT-FOUND)
 21010*    END-EXEC.
 21011*    MOVE '"$I                   ! T #00017716' TO DFHEIV0
 21012     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21014     MOVE X'5420233030303137373136' TO DFHEIV0(25:11)
 21015     CALL 'kxdfhei1' USING DFHEIV0
 21016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21017
 21018
 21019
 21020* EXEC CICS READ
 21021*         DATASET   (FILE-ID-ERPNDB)
 21022*         SET       (ADDRESS OF PENDING-BUSINESS)
 21023*         RIDFLD    (ERPNDB-KEY)
 21024*         GTEQ
 21025*    END-EXEC.
 21026*    MOVE '&"S        G          (   #00017720' TO DFHEIV0
 21027     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21029     MOVE X'2020233030303137373230' TO DFHEIV0(25:11)
 21030     CALL 'kxdfhei1' USING DFHEIV0,
 21031           FILE-ID-ERPNDB,
 21032           DFHEIV20,
 21033           DFHEIV99,
 21034           ERPNDB-KEY,
 21035           DFHEIV99,
 21036           DFHEIV99,
 21037           DFHEIV99
 21038     SET ADDRESS OF PENDING-BUSINESS TO
 21039         DFHEIV20
 21040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21041
 21042
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 385
* EL6311.cbl
 21043     GO TO 5010-READ-NEXT-RECORD.
 21044
 21045 5050-NOT-FOUND.
 21046
 21047******************************************************************
 21048*                                                                *
 21049*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21050*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21051*         PROGRAM.                                               *
 21052*                                                                *
 21053******************************************************************
 21054
 21055     IF EIBTRNID NOT = TRANS-EXB1
 21056        IF PENDING-BUS-RECS-FOUND
 21057            NEXT SENTENCE
 21058          ELSE
 21059            MOVE '9'            TO PI-BROWSE-SW
 21060            GO TO 9400-CLEAR.
 21061
 21062     MOVE ER-2256                TO EMI-ERROR.
 21063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21064
 21065     IF PI-MAP-NAME = SPACES
 21066        MOVE EL631D              TO PI-MAP-NAME
 21067        MOVE -1                  TO DPFENTRL
 21068        GO TO 8100-SEND-INITIAL-MAP.
 21069
 21070     IF PI-MAP-NAME = EL631B
 21071        MOVE -1                  TO BMAINTL
 21072     ELSE
 21073        IF PI-MAP-NAME = EL631C
 21074           MOVE -1               TO CMAINTL
 21075        ELSE
 21076           MOVE -1               TO DPFENTRL
 21077           GO TO 8200-SEND-DATAONLY.
 21078
 21079     GO TO 8100-SEND-INITIAL-MAP.
 21080
 21081     .
 21082 5100-PROCESS-POL-RESC.
 21083     MOVE ZEROS                  TO CG-LF-BENCD
 21084                                    CG-AH-BENCD
 21085                                    CG-LF-CAN-AMT
 21086                                    CG-AH-CAN-AMT
 21087     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21088                                    CG-AH-CAN-DT
 21089     MOVE SPACES                 TO CG-BATCH-NO
 21090     MOVE '4'                    TO CG-OPTION-CODE
 21091     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21092     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21093     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21094     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21095     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21096     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21097     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21098     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21099     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21100     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 386
* EL6311.cbl
 21101     MOVE PI-PREV-ALT-KEY (1:33)
 21102                                 TO CG-CERT-KEY
 21103     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21104     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21105                                    CG-AH-CAN-AMT
 21106     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21107                                    CG-AH-CAN-DT
 21108     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21109     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21110      display 'about to cancel ' cg-cert-key
 21111
 21112* EXEC CICS LINK
 21113*        PROGRAM  ('ELCANC')
 21114*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21115*    END-EXEC
 21116     MOVE LENGTH OF
 21117      CANCEL-GEN-PASS-AREA
 21118       TO DFHEIV11
 21119     MOVE 'ELCANC' TO DFHEIV1
 21120*    MOVE '."C                   (   #00017795' TO DFHEIV0
 21121     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21123     MOVE X'2020233030303137373935' TO DFHEIV0(25:11)
 21124     CALL 'kxdfhei1' USING DFHEIV0,
 21125           DFHEIV1,
 21126           CANCEL-GEN-PASS-AREA,
 21127           DFHEIV11,
 21128           DFHEIV99,
 21129           DFHEIV99,
 21130           DFHEIV99,
 21131           DFHEIV99
 21132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21133     IF CG-SUCCESS
 21134        CONTINUE
 21135     ELSE
 21136        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21137        MOVE '3'                 TO EMI-SWITCH1
 21138        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21139        EVALUATE TRUE
 21140           WHEN CG-DATE-ERROR
 21141             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21142           WHEN CG-CERT-NOT-FOUND
 21143             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21144           WHEN CG-AMOUNT-ERROR
 21145             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21146           WHEN CG-OPTION-ERROR
 21147             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21148           WHEN CG-PREV-CAN
 21149             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21150           WHEN CG-INVALID-DATA
 21151             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21152           WHEN CG-NO-ACCT-MSTR
 21153             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21154           WHEN CG-SFX-A-EXIST
 21155             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21156           WHEN CG-MISC-ERROR
 21157             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21158           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 387
* EL6311.cbl
 21159             MOVE ' ERROR - ELCANC - RETURN '
 21160                                 TO EMI-ERROR-TEXT (1) (12:25)
 21161        END-EVALUATE
 21162        GO TO 8200-SEND-DATAONLY
 21163     END-IF
 21164     .
 21165 5100-EXIT.
 21166     EXIT.
 21167
 21168******************************************************************
 21169*                                                                *
 21170*        B R O W S E   B A T C H   B A C K W A R D S             *
 21171*                                                                *
 21172******************************************************************
 21173
 21174 5500-BROWSE-BATCH-BACKWARD.
 21175
 21176* EXEC CICS HANDLE CONDITION
 21177*         NOTFND   (5550-END-RECORDS)
 21178*         ENDFILE  (5550-END-RECORDS)
 21179*    END-EXEC.
 21180*    MOVE '"$I''                  ! U #00017841' TO DFHEIV0
 21181     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21183     MOVE X'5520233030303137383431' TO DFHEIV0(25:11)
 21184     CALL 'kxdfhei1' USING DFHEIV0
 21185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21186
 21187
 21188 5505-START-BROWSE.
 21189     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21190     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21191     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21192
 21193
 21194* EXEC CICS STARTBR
 21195*         DATASET   (FILE-ID-ERPNDB)
 21196*         RIDFLD    (ERPNDB-ALT-KEY)
 21197*    END-EXEC.
 21198     MOVE 0
 21199       TO DFHEIV11
 21200*    MOVE '&,         G          &   #00017851' TO DFHEIV0
 21201     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21202     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21203     MOVE X'2020233030303137383531' TO DFHEIV0(25:11)
 21204     CALL 'kxdfhei1' USING DFHEIV0,
 21205           FILE-ID-ERPNDB,
 21206           ERPNDB-ALT-KEY,
 21207           DFHEIV99,
 21208           DFHEIV11,
 21209           DFHEIV99
 21210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21211
 21212
 21213     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21214
 21215
 21216* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 388
* EL6311.cbl
 21217*         DATASET    (FILE-ID-ERPNDB)
 21218*         SET        (ADDRESS OF PENDING-BUSINESS)
 21219*         RIDFLD     (ERPNDB-KEY)
 21220*    END-EXEC.
 21221     MOVE 0
 21222       TO DFHEIV11
 21223*    MOVE '&.S                   )   #00017858' TO DFHEIV0
 21224     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21225     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21226     MOVE X'2020233030303137383538' TO DFHEIV0(25:11)
 21227     CALL 'kxdfhei1' USING DFHEIV0,
 21228           FILE-ID-ERPNDB,
 21229           DFHEIV20,
 21230           DFHEIV99,
 21231           ERPNDB-KEY,
 21232           DFHEIV99,
 21233           DFHEIV11,
 21234           DFHEIV99,
 21235           DFHEIV99
 21236     SET ADDRESS OF PENDING-BUSINESS TO
 21237         DFHEIV20
 21238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21239
 21240
 21241
 21242* EXEC CICS READPREV
 21243*         DATASET    (FILE-ID-ERPNDB)
 21244*         SET        (ADDRESS OF PENDING-BUSINESS)
 21245*         RIDFLD     (ERPNDB-KEY)
 21246*    END-EXEC.
 21247     MOVE 0
 21248       TO DFHEIV11
 21249*    MOVE '&0S                   )   #00017864' TO DFHEIV0
 21250     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21251     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21252     MOVE X'2020233030303137383634' TO DFHEIV0(25:11)
 21253     CALL 'kxdfhei1' USING DFHEIV0,
 21254           FILE-ID-ERPNDB,
 21255           DFHEIV20,
 21256           DFHEIV99,
 21257           ERPNDB-KEY,
 21258           DFHEIV99,
 21259           DFHEIV11,
 21260           DFHEIV99,
 21261           DFHEIV99
 21262     SET ADDRESS OF PENDING-BUSINESS TO
 21263         DFHEIV20
 21264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21265
 21266
 21267
 21268* EXEC CICS READPREV
 21269*         DATASET    (FILE-ID-ERPNDB)
 21270*         SET        (ADDRESS OF PENDING-BUSINESS)
 21271*         RIDFLD     (ERPNDB-KEY)
 21272*    END-EXEC.
 21273     MOVE 0
 21274       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 389
* EL6311.cbl
 21275*    MOVE '&0S                   )   #00017870' TO DFHEIV0
 21276     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21277     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21278     MOVE X'2020233030303137383730' TO DFHEIV0(25:11)
 21279     CALL 'kxdfhei1' USING DFHEIV0,
 21280           FILE-ID-ERPNDB,
 21281           DFHEIV20,
 21282           DFHEIV99,
 21283           ERPNDB-KEY,
 21284           DFHEIV99,
 21285           DFHEIV11,
 21286           DFHEIV99,
 21287           DFHEIV99
 21288     SET ADDRESS OF PENDING-BUSINESS TO
 21289         DFHEIV20
 21290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21291
 21292
 21293     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21294        GO TO 5550-END-RECORDS.
 21295
 21296     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21297
 21298     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21299
 21300     IF  WS-BATCH-PREFIX = '#CL'
 21301             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21302
 21303* EXEC CICS ENDBR
 21304*                 DATASET  (FILE-ID-ERPNDB)
 21305*            END-EXEC
 21306     MOVE 0
 21307       TO DFHEIV11
 21308*    MOVE '&2                    $   #00017885' TO DFHEIV0
 21309     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21310     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21311     MOVE X'2020233030303137383835' TO DFHEIV0(25:11)
 21312     CALL 'kxdfhei1' USING DFHEIV0,
 21313           FILE-ID-ERPNDB,
 21314           DFHEIV11,
 21315           DFHEIV99
 21316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21317         GO TO 5505-START-BROWSE.
 21318
 21319     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21320         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21321             NEXT SENTENCE
 21322         ELSE
 21323             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21324
 21325* EXEC CICS ENDBR
 21326*                 DATASET  (FILE-ID-ERPNDB)
 21327*            END-EXEC
 21328     MOVE 0
 21329       TO DFHEIV11
 21330*    MOVE '&2                    $   #00017895' TO DFHEIV0
 21331     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21332     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 390
* EL6311.cbl
 21333     MOVE X'2020233030303137383935' TO DFHEIV0(25:11)
 21334     CALL 'kxdfhei1' USING DFHEIV0,
 21335           FILE-ID-ERPNDB,
 21336           DFHEIV11,
 21337           DFHEIV99
 21338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21339             GO TO 5505-START-BROWSE.
 21340
 21341
 21342     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21343         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21344             NEXT SENTENCE
 21345        ELSE
 21346             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21347
 21348* EXEC CICS ENDBR
 21349*                 DATASET  (FILE-ID-ERPNDB)
 21350*            END-EXEC
 21351     MOVE 0
 21352       TO DFHEIV11
 21353*    MOVE '&2                    $   #00017906' TO DFHEIV0
 21354     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21355     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21356     MOVE X'2020233030303137393036' TO DFHEIV0(25:11)
 21357     CALL 'kxdfhei1' USING DFHEIV0,
 21358           FILE-ID-ERPNDB,
 21359           DFHEIV11,
 21360           DFHEIV99
 21361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21362             GO TO 5505-START-BROWSE.
 21363
 21364     IF NOT PB-BATCH-TRAILER
 21365        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21366
 21367* EXEC CICS ENDBR
 21368*            DATASET  (FILE-ID-ERPNDB)
 21369*       END-EXEC
 21370     MOVE 0
 21371       TO DFHEIV11
 21372*    MOVE '&2                    $   #00017913' TO DFHEIV0
 21373     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21374     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21375     MOVE X'2020233030303137393133' TO DFHEIV0(25:11)
 21376     CALL 'kxdfhei1' USING DFHEIV0,
 21377           FILE-ID-ERPNDB,
 21378           DFHEIV11,
 21379           DFHEIV99
 21380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21381        GO TO 5505-START-BROWSE.
 21382
 21383     IF PI-CSR-BROWSE
 21384        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21385           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21386
 21387* EXEC CICS ENDBR
 21388*               DATASET  (FILE-ID-ERPNDB)
 21389*          END-EXEC
 21390     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 391
* EL6311.cbl
 21391       TO DFHEIV11
 21392*    MOVE '&2                    $   #00017921' TO DFHEIV0
 21393     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21394     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21395     MOVE X'2020233030303137393231' TO DFHEIV0(25:11)
 21396     CALL 'kxdfhei1' USING DFHEIV0,
 21397           FILE-ID-ERPNDB,
 21398           DFHEIV11,
 21399           DFHEIV99
 21400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21401           GO TO 5505-START-BROWSE.
 21402
 21403     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21404        IF PI-PB-CARRIER    = SPACES AND
 21405           PI-PB-GROUPING   = SPACES AND
 21406           PI-PB-STATE      = SPACES AND
 21407           PI-PB-ACCOUNT    = SPACES
 21408             GO TO 7200-DISPLAY-BATCHES
 21409          ELSE
 21410            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21411               PI-PB-GROUPING   = PB-GROUPING AND
 21412               PI-PB-STATE      = PB-STATE    AND
 21413               PI-PB-ACCOUNT    = PB-ACCOUNT
 21414                 GO TO 7200-DISPLAY-BATCHES.
 21415
 21416     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21417
 21418
 21419* EXEC CICS ENDBR
 21420*         DATASET  (FILE-ID-ERPNDB)
 21421*    END-EXEC.
 21422     MOVE 0
 21423       TO DFHEIV11
 21424*    MOVE '&2                    $   #00017941' TO DFHEIV0
 21425     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21426     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21427     MOVE X'2020233030303137393431' TO DFHEIV0(25:11)
 21428     CALL 'kxdfhei1' USING DFHEIV0,
 21429           FILE-ID-ERPNDB,
 21430           DFHEIV11,
 21431           DFHEIV99
 21432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21433
 21434
 21435     GO TO 5505-START-BROWSE.
 21436
 21437 5550-END-RECORDS.
 21438     MOVE ER-2257                TO EMI-ERROR.
 21439     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21440     MOVE -1                     TO DPFENTRL.
 21441
 21442     GO TO 8200-SEND-DATAONLY.
 21443
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 392
* EL6311.cbl
 21445
 21446******************************************************************
 21447*                                                                *
 21448*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21449*                                                                *
 21450******************************************************************
 21451
 21452 6000-CREATE-TEMP-STORAGE.
 21453
 21454
 21455* EXEC CICS HANDLE CONDITION
 21456*        QIDERR  (6050-QID-ERROR)
 21457*    END-EXEC.
 21458*    MOVE '"$N                   ! V #00017964' TO DFHEIV0
 21459     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21461     MOVE X'5620233030303137393634' TO DFHEIV0(25:11)
 21462     CALL 'kxdfhei1' USING DFHEIV0
 21463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21464
 21465
 21466
 21467* EXEC CICS WRITEQ TS
 21468*        QUEUE    (QID)
 21469*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21470*        LENGTH   (WS-COMM-LENGTH)
 21471*        ITEM     (W-ONE)
 21472*    END-EXEC.
 21473*    MOVE '*" I                  ''   #00017968' TO DFHEIV0
 21474     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21475     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21476     MOVE X'2020233030303137393638' TO DFHEIV0(25:11)
 21477     CALL 'kxdfhei1' USING DFHEIV0,
 21478           QID,
 21479           PROGRAM-INTERFACE-BLOCK,
 21480           WS-COMM-LENGTH,
 21481           W-ONE,
 21482           DFHEIV99,
 21483           DFHEIV99
 21484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21485
 21486
 21487 6000-EXIT.
 21488      EXIT.
 21489
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 393
* EL6311.cbl
 21491
 21492******************************************************************
 21493*                                                                *
 21494*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21495*                                                                *
 21496******************************************************************
 21497
 21498 6050-RECOVER-TEMP-STORAGE.
 21499     IF PGM-NAME = XCTL-EL6312
 21500        GO TO 6050-EXIT.
 21501
 21502     IF PGM-NAME = XCTL-EL6313
 21503        GO TO 6050-EXIT.
 21504
 21505     IF PGM-NAME = XCTL-EL6315
 21506         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21507     END-IF
 21508
 21509     IF PGM-NAME = XCTL-EL6316
 21510         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21511     END-IF
 21512
 21513
 21514* EXEC CICS HANDLE CONDITION
 21515*        QIDERR  (6050-QID-ERROR)
 21516*    END-EXEC.
 21517*    MOVE '"$N                   ! W #00018001' TO DFHEIV0
 21518     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21519     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21520     MOVE X'5720233030303138303031' TO DFHEIV0(25:11)
 21521     CALL 'kxdfhei1' USING DFHEIV0
 21522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21523
 21524
 21525
 21526* EXEC CICS READQ TS
 21527*         QUEUE   (QID)
 21528*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21529*         LENGTH  (WS-COMM-LENGTH)
 21530*         ITEM    (W-ONE)
 21531*     END-EXEC.
 21532*    MOVE '*$II   L              ''   #00018005' TO DFHEIV0
 21533     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21535     MOVE X'2020233030303138303035' TO DFHEIV0(25:11)
 21536     CALL 'kxdfhei1' USING DFHEIV0,
 21537           QID,
 21538           PROGRAM-INTERFACE-BLOCK,
 21539           WS-COMM-LENGTH,
 21540           W-ONE,
 21541           DFHEIV99,
 21542           DFHEIV99
 21543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21544
 21545
 21546 6050-DELETE-TEMP-STORAGE.
 21547
 21548
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 394
* EL6311.cbl
 21549* EXEC CICS DELETEQ TS
 21550*        QUEUE   (QID)
 21551*    END-EXEC.
 21552*    MOVE '*&                    #   #00018014' TO DFHEIV0
 21553     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21554     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21555     MOVE X'2020233030303138303134' TO DFHEIV0(25:11)
 21556     CALL 'kxdfhei1' USING DFHEIV0,
 21557           QID,
 21558           DFHEIV99
 21559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21560
 21561
 21562     GO TO 6050-EXIT.
 21563
 21564 6050-QID-ERROR.
 21565     MOVE ER-0033                TO EMI-ERROR
 21566     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21567
 21568 6050-EXIT.
 21569      EXIT.
 21570
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 395
* EL6311.cbl
 21572
 21573******************************************************************
 21574*                                                                *
 21575*            T E R M   C O N V E R S I O N                       *
 21576*                                                                *
 21577******************************************************************
 21578
 21579 6100-TERM-CONVERSION.
 21580
 21581     IF PI-BPMTS = ZERO
 21582         GO TO 6199-EXIT.
 21583
 21584     IF PI-BMODE = ' ' OR 'M'
 21585         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21586         GO TO 6105-ROUND-TERM.
 21587
 21588     IF PI-BMODE = 'S'
 21589         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21590         GO TO 6105-ROUND-TERM.
 21591
 21592     IF PI-BMODE = 'W'
 21593         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21594         GO TO 6105-ROUND-TERM.
 21595
 21596     IF PI-BMODE = 'B'
 21597         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21598         GO TO 6105-ROUND-TERM.
 21599
 21600     IF PI-BMODE = 'T'
 21601         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21602
 21603 6105-ROUND-TERM.
 21604
 21605     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21606         ADD +1                  TO WS-CALC-TERM-WHOLE
 21607         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21608
 21609     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21610         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21611
 21612     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21613         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21614                                      WS-BTERM    (WS-SUB1)
 21615         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21616
 21617     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21618         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21619             MOVE -1               TO BMODEL
 21620             MOVE ER-2593          TO EMI-ERROR
 21621             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21622             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21623
 21624 6124-CHECK-BENEFIT.
 21625
 21626     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21627        GO TO 6126-COMPUTE-BENEFIT.
 21628
 21629     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 396
* EL6311.cbl
 21630
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 397
* EL6311.cbl
 21632******************************************************************
 21633**         COMPUTE TERM AND BENEFIT
 21634******************************************************************
 21635 6125-COMPUTE-TERM-BENEFIT.
 21636
 21637     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21638        PI-BPMTAMT = ZERO
 21639         GO TO 6199-EXIT.
 21640
 21641     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21642                                     WS-BTERM  (WS-SUB1).
 21643     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21644
 21645 6126-COMPUTE-BENEFIT.
 21646
 21647     IF PI-BMODE = 'M' OR  ' '
 21648         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21649
 21650     IF PI-BMODE = 'W'
 21651         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21652
 21653     IF PI-BMODE = 'S'
 21654         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21655
 21656     IF PI-BMODE = 'B'
 21657         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21658
 21659     IF PI-BMODE = 'T'
 21660         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21661
 21662     IF WS-SUB1 = +1
 21663        COMPUTE WS-BBEN (WS-SUB1) =
 21664                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21665
 21666     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21667     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21668     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21669
 21670 6199-EXIT.
 21671     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 398
* EL6311.cbl
 21673
 21674******************************************************************
 21675*                                                                *
 21676*             D I S P L A Y   I S S U E S                        *
 21677*                                                                *
 21678******************************************************************
 21679
 21680 6200-CREATE-VADS.
 21681     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21682     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21683     MOVE SPACES                 TO WS-PASS-VADS-REC
 21684
 21685* EXEC CICS GETMAIN
 21686*       SET      (ADDRESS OF PENDING-BUSINESS)
 21687*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21688*       INITIMG  (GETMAIN-SPACE)
 21689*       RESP     (WS-RESPONSE)
 21690*    END-EXEC
 21691*    MOVE ',"IL                  $  N#00018140' TO DFHEIV0
 21692     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21693     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21694     MOVE X'204E233030303138313430' TO DFHEIV0(25:11)
 21695     CALL 'kxdfhei1' USING DFHEIV0,
 21696           DFHEIV20,
 21697           ERPNDB-RECORD-LENGTH,
 21698           GETMAIN-SPACE
 21699     SET ADDRESS OF PENDING-BUSINESS TO
 21700         DFHEIV20
 21701     MOVE EIBRESP  TO WS-RESPONSE
 21702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21703
 21704* EXEC CICS READ
 21705*       INTO    (PENDING-BUSINESS)
 21706*       DATASET (FILE-ID-ERPNDB)
 21707*       RIDFLD  (ERPNDB-KEY)
 21708*       RESP    (WS-RESPONSE)
 21709*    END-EXEC
 21710     MOVE LENGTH OF
 21711      PENDING-BUSINESS
 21712       TO DFHEIV11
 21713*    MOVE '&"IL       E          (  N#00018146' TO DFHEIV0
 21714     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21715     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21716     MOVE X'204E233030303138313436' TO DFHEIV0(25:11)
 21717     CALL 'kxdfhei1' USING DFHEIV0,
 21718           FILE-ID-ERPNDB,
 21719           PENDING-BUSINESS,
 21720           DFHEIV11,
 21721           ERPNDB-KEY,
 21722           DFHEIV99,
 21723           DFHEIV99,
 21724           DFHEIV99
 21725     MOVE EIBRESP  TO WS-RESPONSE
 21726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21727     IF RESP-NORMAL
 21728        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21729        IF (RESP-NORMAL)
 21730           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 399
* EL6311.cbl
 21731              AM-CONTROL-PRIMARY (1:20))
 21732           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21733        ELSE
 21734           MOVE 'ACCOUNT NOT FOUND'
 21735                                 TO VD-ACCOUNT-NAME
 21736        END-IF
 21737        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21738                                    TO M1
 21739        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21740        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21741           (A2 > M1)
 21742           OR (WS-WORK-FIELD (A2:1) = '*')
 21743           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21744           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21745        END-PERFORM
 21746        IF A2 > M1
 21747           CONTINUE
 21748        ELSE
 21749           MOVE WS-WORK-FIELD (1:A2 - 1)
 21750                                    TO VD-ACCOUNT-NAME
 21751        END-IF
 21752        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21753        MOVE PB-CARRIER          TO VD-CARRIER
 21754        MOVE PB-GROUPING         TO VD-GROUPING
 21755        MOVE PB-STATE            TO VD-STATE
 21756        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21757        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21758        MOVE PB-CERT-NO          TO VD-CERT-NO
 21759        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21760        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21761        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21762        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21763        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21764        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21765        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21766        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21767        MOVE PB-CSR-ID           TO VD-CSR-ID
 21768        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21769        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21770        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21771        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21772        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21773        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21774        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21775        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21776        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21777        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21778        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21779        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21780        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21781     END-IF
 21782     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21783
 21784
 21785* EXEC CICS GETMAIN
 21786*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21787*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21788*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 400
* EL6311.cbl
 21789*       RESP     (WS-RESPONSE)
 21790*    END-EXEC
 21791*    MOVE ',"IL                  $  N#00018209' TO DFHEIV0
 21792     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21793     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21794     MOVE X'204E233030303138323039' TO DFHEIV0(25:11)
 21795     CALL 'kxdfhei1' USING DFHEIV0,
 21796           DFHEIV20,
 21797           ERPNDM-RECORD-LENGTH,
 21798           GETMAIN-SPACE
 21799     SET ADDRESS OF PENDING-MAILING-DATA TO
 21800         DFHEIV20
 21801     MOVE EIBRESP  TO WS-RESPONSE
 21802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21803
 21804
 21805* EXEC CICS READ
 21806*       INTO    (PENDING-MAILING-DATA)
 21807*       DATASET (FILE-ID-ERPNDM)
 21808*       RIDFLD  (ERPNDM-KEY)
 21809*       RESP    (WS-RESPONSE)
 21810*    END-EXEC
 21811     MOVE LENGTH OF
 21812      PENDING-MAILING-DATA
 21813       TO DFHEIV11
 21814*    MOVE '&"IL       E          (  N#00018216' TO DFHEIV0
 21815     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21816     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21817     MOVE X'204E233030303138323136' TO DFHEIV0(25:11)
 21818     CALL 'kxdfhei1' USING DFHEIV0,
 21819           FILE-ID-ERPNDM,
 21820           PENDING-MAILING-DATA,
 21821           DFHEIV11,
 21822           ERPNDM-KEY,
 21823           DFHEIV99,
 21824           DFHEIV99,
 21825           DFHEIV99
 21826     MOVE EIBRESP  TO WS-RESPONSE
 21827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21828
 21829     IF RESP-NORMAL
 21830        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21831        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21832        MOVE PM-CITY              TO VD-INSURED-CITY
 21833        MOVE PM-STATE             TO VD-INSURED-STATE
 21834        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21835     END-IF
 21836
 21837     MOVE 'VAC1'                  TO VD-LETTER-ID
 21838     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21839     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21840     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21841     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21842     MOVE +0                      TO VD-ARCHIVE-NO
 21843     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21844     .
 21845 6200-EXIT.
 21846     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 401
* EL6311.cbl
 21847 6210-READ-ERACCT.
 21848     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21849     MOVE LOW-VALUES             TO ERACCT-FILL
 21850
 21851* EXEC CICS READ
 21852*         DATASET   ('ERACCT')
 21853*         INTO      (ACCOUNT-MASTER)
 21854*         RIDFLD    (ERACCT-KEY)
 21855*         GTEQ
 21856*         RESP      (WS-RESPONSE)
 21857*    END-EXEC
 21858     MOVE LENGTH OF
 21859      ACCOUNT-MASTER
 21860       TO DFHEIV11
 21861     MOVE 'ERACCT' TO DFHEIV1
 21862*    MOVE '&"IL       G          (  N#00018244' TO DFHEIV0
 21863     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21865     MOVE X'204E233030303138323434' TO DFHEIV0(25:11)
 21866     CALL 'kxdfhei1' USING DFHEIV0,
 21867           DFHEIV1,
 21868           ACCOUNT-MASTER,
 21869           DFHEIV11,
 21870           ERACCT-KEY,
 21871           DFHEIV99,
 21872           DFHEIV99,
 21873           DFHEIV99
 21874     MOVE EIBRESP  TO WS-RESPONSE
 21875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21876     .
 21877 6210-EXIT.
 21878     EXIT.
 21879
 21880 6220-READ-ERMAIL.
 21881
 21882     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21883     MOVE ' '                    TO WS-ERMAIL-SW
 21884
 21885
 21886* EXEC CICS READ
 21887*       DATASET   (FILE-ID-ERMAIL)
 21888*       SET       (ADDRESS OF MAILING-DATA)
 21889*       RIDFLD    (ERMAIL-KEY)
 21890*       RESP      (WS-RESPONSE)
 21891*    END-EXEC
 21892*    MOVE '&"S        E          (  N#00018260' TO DFHEIV0
 21893     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21894     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21895     MOVE X'204E233030303138323630' TO DFHEIV0(25:11)
 21896     CALL 'kxdfhei1' USING DFHEIV0,
 21897           FILE-ID-ERMAIL,
 21898           DFHEIV20,
 21899           DFHEIV99,
 21900           ERMAIL-KEY,
 21901           DFHEIV99,
 21902           DFHEIV99,
 21903           DFHEIV99
 21904     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 402
* EL6311.cbl
 21905         DFHEIV20
 21906     MOVE EIBRESP  TO WS-RESPONSE
 21907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21908
 21909     IF RESP-NORMAL
 21910        SET ERMAIL-FOUND TO TRUE
 21911     END-IF
 21912     .
 21913 6220-EXIT.
 21914     EXIT.
 21915
 21916 6400-CHECK-FOR-RES-REF-CLAIM.
 21917     display 'made it to 6400- for ' pi-cert-no
 21918     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21919
 21920     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21921                                    W-CL-COMP-CD.
 21922     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21923                                    W-CL-CERT-NO.
 21924     MOVE SPACES                 TO MSTR-CERT-SFX.
 21925
 21926
 21927* EXEC CICS HANDLE CONDITION
 21928*        NOTFND  (6400-CONTINUE)
 21929*        ENDFILE (6400-CONTINUE)
 21930*    END-EXEC.
 21931*    MOVE '"$I''                  ! X #00018284' TO DFHEIV0
 21932     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21933     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21934     MOVE X'5820233030303138323834' TO DFHEIV0(25:11)
 21935     CALL 'kxdfhei1' USING DFHEIV0
 21936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21937
 21938
 21939
 21940* EXEC CICS IGNORE CONDITION
 21941*        DUPKEY
 21942*    END-EXEC.
 21943*    MOVE '"*$                   !   #00018289' TO DFHEIV0
 21944     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21945     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21946     MOVE X'2020233030303138323839' TO DFHEIV0(25:11)
 21947     CALL 'kxdfhei1' USING DFHEIV0
 21948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21949
 21950
 21951
 21952* EXEC CICS STARTBR
 21953*        DATASET   (CLMS-ID)
 21954*        RIDFLD    (ELMSTR-KEY)
 21955*        GENERIC   EQUAL
 21956*        KEYLENGTH (ELMSTR-LENGTH)
 21957*    END-EXEC.
 21958     MOVE 0
 21959       TO DFHEIV11
 21960*    MOVE '&,   KG    E          &   #00018293' TO DFHEIV0
 21961     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21962     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 403
* EL6311.cbl
 21963     MOVE X'2020233030303138323933' TO DFHEIV0(25:11)
 21964     CALL 'kxdfhei1' USING DFHEIV0,
 21965           CLMS-ID,
 21966           ELMSTR-KEY,
 21967           ELMSTR-LENGTH,
 21968           DFHEIV11,
 21969           DFHEIV99
 21970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21971
 21972
 21973     display 'browse started'
 21974     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21975
 21976 6400-NEXT-CLAIM.
 21977
 21978
 21979* EXEC CICS READNEXT
 21980*        DATASET   (CLMS-ID)
 21981*        RIDFLD    (ELMSTR-KEY)
 21982*        SET       (ADDRESS OF CLAIM-MASTER)
 21983*    END-EXEC.
 21984     MOVE 0
 21985       TO DFHEIV11
 21986*    MOVE '&.S                   )   #00018305' TO DFHEIV0
 21987     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21988     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21989     MOVE X'2020233030303138333035' TO DFHEIV0(25:11)
 21990     CALL 'kxdfhei1' USING DFHEIV0,
 21991           CLMS-ID,
 21992           DFHEIV20,
 21993           DFHEIV99,
 21994           ELMSTR-KEY,
 21995           DFHEIV99,
 21996           DFHEIV11,
 21997           DFHEIV99,
 21998           DFHEIV99
 21999     SET ADDRESS OF CLAIM-MASTER TO
 22000         DFHEIV20
 22001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22002
 22003
 22004     display 'read claim for ' mstr-cert-no
 22005     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22006        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22007         GO TO 6400-CONTINUE
 22008     END-IF.
 22009
 22010     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22011        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22012        PI-STATE       NOT = CL-CERT-STATE     OR
 22013        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22014        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22015         GO TO 6400-NEXT-CLAIM
 22016     END-IF.
 22017
 22018     display 'found claim ' cl-claim-no
 22019        ' with denial type ' cl-denial-type
 22020     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 404
* EL6311.cbl
 22021         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22022         GO TO 6400-CONTINUE
 22023     END-IF.
 22024
 22025     GO TO 6400-NEXT-CLAIM.
 22026
 22027 6400-CONTINUE.
 22028
 22029     IF WS-BROWSE-STARTED-SW = 'Y'
 22030
 22031* EXEC CICS ENDBR
 22032*            DATASET   (CLMS-ID)
 22033*        END-EXEC
 22034     MOVE 0
 22035       TO DFHEIV11
 22036*    MOVE '&2                    $   #00018337' TO DFHEIV0
 22037     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22038     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22039     MOVE X'2020233030303138333337' TO DFHEIV0(25:11)
 22040     CALL 'kxdfhei1' USING DFHEIV0,
 22041           CLMS-ID,
 22042           DFHEIV11,
 22043           DFHEIV99
 22044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22045         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22046     END-IF.
 22047
 22048 6400-EXIT.
 22049     EXIT.
 22050
 22051 7000-DISPLAY-ISSUES.
 22052
 22053     IF PI-DISPLAY-ORIGINAL-BATCH
 22054        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22055        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22056     ELSE
 22057        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22058
 22059     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22060
 22061     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22062     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22063
 22064     MOVE LOW-VALUES                 TO EL631BI.
 22065     MOVE ZEROS                      TO PI-BPMTAMT
 22066                                        PI-BPMTS.
 22067     MOVE SPACE                      TO PI-BMODE
 22068                                        PI-BTYPE (1)
 22069                                        PI-BTYPE (2).
 22070     MOVE EL631B                     TO PI-MAP-NAME.
 22071     MOVE 'Y'                        TO PI-BROWSE-SW.
 22072     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22073                                        PI-HIGH-SEQ-NO.
 22074
 22075     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22076        MOVE AL-SABOF                TO BCHGTA
 22077        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22078        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 405
* EL6311.cbl
 22079     ELSE
 22080        MOVE AL-SADOF                TO BCHGTA
 22081                                        BCHGA
 22082        MOVE PB-CHG-COUNT            TO BCHGO.
 22083
 22084     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22085     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22086     MOVE WS-HR-MINS                 TO BMANTATO.
 22087
 22088     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22089        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22090        MOVE SPACE                   TO DC-OPTION-CODE
 22091        PERFORM 9700-DATE-LINK
 22092        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22093        MOVE 'INACTIVE'              TO BMOENDTO
 22094     ELSE
 22095        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22096        MOVE SPACE                   TO DC-OPTION-CODE
 22097        PERFORM 9700-DATE-LINK
 22098        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22099        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22100        MOVE SPACE                   TO DC-OPTION-CODE
 22101        PERFORM 9700-DATE-LINK
 22102        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22103
 22104*    MOVE PB-I-REFERENCE             TO BREFO.
 22105
 22106*    IF PI-COMPANY-ID EQUAL 'HER'
 22107*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22108*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22109*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22110*                MOVE WS-MEMBER-NO-1-8
 22111*                                TO  BMICRNOO.
 22112
 22113*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22114*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22115*            MOVE PB-I-MICROFILM-NO
 22116*                                TO  BMICRNOO.
 22117     IF PB-I-VIN NOT = SPACES
 22118        MOVE PB-I-VIN            TO BVINO
 22119     END-IF
 22120
 22121     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22122     MOVE PB-CERT-SFX                TO BSUFIXO.
 22123     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22124     MOVE SPACE                      TO DC-OPTION-CODE.
 22125     PERFORM 9700-DATE-LINK.
 22126     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22127
 22128     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22129     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22130     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22131     MOVE PB-I-INSURED-SEX           TO BSEXO
 22132
 22133     IF PB-I-AGE NOT = ZEROS
 22134         MOVE PB-I-AGE               TO BAGEO.
 22135
 22136     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 406
* EL6311.cbl
 22137                                 TO ELCERT-KEY
 22138     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22139     IF NOT CERT-TRL-REC-NOT-FOUND
 22140         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22141             MOVE 'AGE*'             TO BAGEDEFO
 22142         ELSE
 22143             MOVE 'AGE '             TO BAGEDEFO
 22144         END-IF
 22145     ELSE
 22146         MOVE 'AGE '             TO BAGEDEFO
 22147     END-IF
 22148
 22149     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22150         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22151         MOVE SPACE                  TO DC-OPTION-CODE
 22152         PERFORM 9700-DATE-LINK
 22153         IF NO-CONVERSION-ERROR
 22154            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22155
 22156     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22157         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22158         MOVE SPACE                  TO DC-OPTION-CODE
 22159         PERFORM 9700-DATE-LINK
 22160         IF NO-CONVERSION-ERROR
 22161            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22162
 22163     IF PB-I-EXTENTION-DAYS NUMERIC
 22164        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22165           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22166        ELSE
 22167           IF PB-I-TERM-IN-DAYS NUMERIC
 22168              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22169                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22170
 22171     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22172        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22173
 22174     MOVE PB-FORCE-CODE              TO BFORCEO.
 22175     MOVE PB-I-TERM-TYPE             TO BMODEO
 22176                                        PI-BMODE.
 22177
 22178     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22179        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22180
 22181     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22182         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22183                                        PI-BPMTS.
 22184
 22185     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22186         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22187           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22188                                        PI-BPMTAMT.
 22189
 22190     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22191     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22192     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22193     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22194     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 407
* EL6311.cbl
 22195     MOVE PB-I-SIG-SW                TO BSIGO.
 22196     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22197     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22198     MOVE PB-RECORD-BILL             TO BBILCDO.
 22199     MOVE PB-FORCE-CODE              TO BFORCEO.
 22200
 22201     IF (PB-I-LIVES NUMERIC)
 22202        AND (PB-I-LIVES > ZEROS)
 22203        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22204        IF (RESP-NORMAL)
 22205           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22206           CONTINUE
 22207        ELSE
 22208           MOVE PB-I-LIVES       TO BLIVESO
 22209        END-IF
 22210     END-IF
 22211
 22212     IF PB-I-NUM-BILLED NUMERIC AND
 22213        PB-I-NUM-BILLED GREATER THAN ZEROS
 22214        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22215*    ELSE
 22216*       MOVE ZEROS                   TO BBILLEDO.
 22217
 22218     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22219
 22220     IF PB-I-LOAN-APR NOT = +99.9999
 22221        MOVE PB-I-LOAN-APR           TO BAPRO.
 22222
 22223     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22224        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22225
 22226     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22227        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22228           MOVE AL-SANOF                TO BORIGHDA
 22229           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22230           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22231
 22232     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22233
 22234     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22235        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22236
 22237     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22238        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22239                                        PI-BTYPE (1).
 22240
 22241     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22242        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22243
 22244     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22245        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22246
 22247     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22248        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22249
 22250     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22251        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22252
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 408
* EL6311.cbl
 22253     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22254        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22255
 22256     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22257         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22258         MOVE SPACE                  TO DC-OPTION-CODE
 22259         PERFORM 9700-DATE-LINK
 22260         IF NO-CONVERSION-ERROR
 22261            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22262
 22263     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22264        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22265        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22266        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22267        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22268                 GIVING BDIFFO (1)
 22269     ELSE
 22270        MOVE SPACES                  TO BBEN-CD     (1)
 22271                                        BBEN-ABBR   (1).
 22272
 22273     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22274        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22275        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22276                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22277
 22278     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22279       IF PB-RECORD-ON-HOLD
 22280          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22281
 22282     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22283       IF PB-RECORD-RETURNED
 22284          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22285
 22286     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22287        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22288             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22289
 22290     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22291
 22292     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22293        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22294
 22295     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22296        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22297                                        PI-BTYPE (2).
 22298
 22299     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22300        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22301
 22302     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22303        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22304
 22305     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22306        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22307
 22308     IF PB-I-TOT-FEES NOT NUMERIC
 22309        MOVE ZEROS               TO PB-I-TOT-FEES
 22310     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 409
* EL6311.cbl
 22311     IF PB-I-TOT-FEES > ZEROS
 22312        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22313
 22314     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22315         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22316         MOVE SPACE                  TO DC-OPTION-CODE
 22317         PERFORM 9700-DATE-LINK
 22318         IF NO-CONVERSION-ERROR
 22319            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22320
 22321     IF PB-I-TOT-FEES > ZEROS
 22322        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22323        SUBTRACT PB-I-TOT-FEES FROM
 22324                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22325
 22326     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22327        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22328        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22329        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22330        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22331                 GIVING BDIFFO (2)
 22332     ELSE
 22333        MOVE SPACES                  TO BBEN-CD     (2)
 22334                                        BBEN-ABBR   (2).
 22335
 22336     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22337       IF PB-RECORD-ON-HOLD
 22338          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22339
 22340     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22341       IF PB-RECORD-RETURNED
 22342          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22343
 22344     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22345        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22346             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22347
 22348     MOVE PB-CSR-ID                  TO BCSRO.
 22349
 22350     IF PI-COMPANY-ID  =  'DMD'
 22351        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22352            NEXT SENTENCE
 22353        ELSE
 22354            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22355               MOVE 'NEW CERT'       TO BNCERTLI
 22356               MOVE EC-NEW-CERT      TO BNCERTO.
 22357
 22358     IF PI-COMPANY-ID  =  'DMD'
 22359        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22360            NEXT SENTENCE
 22361        ELSE
 22362           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22363               MOVE 'NEW STATE'      TO BNSTATLI
 22364               MOVE EC-NEW-STATE     TO BNSTATO.
 22365
 22366 7000-CONTINUE.
 22367     MOVE 'C'                        TO BMAINTI.
 22368     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 410
* EL6311.cbl
 22369
 22370     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22371        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22372
 22373     IF PI-6315-FINALIZED = 'Y'   AND
 22374        PB-UNFORCED-ERRORS
 22375          MOVE -1                TO BFORCEL
 22376          MOVE  1                TO SET-CURSOR-SW
 22377     END-IF
 22378
 22379     IF NO-CURSOR-SET
 22380        MOVE -1                      TO BMAINTL.
 22381
 22382     GO TO 8100-SEND-INITIAL-MAP.
 22383
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 411
* EL6311.cbl
 22385
 22386******************************************************************
 22387*                                                                *
 22388*             D I S P L A Y   C A N C E L S                      *
 22389*                                                                *
 22390******************************************************************
 22391
 22392 7100-DISPLAY-CANCELS.
 22393     IF PI-DISPLAY-ORIGINAL-BATCH
 22394        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22395        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22396     ELSE
 22397        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22398
 22399     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22400
 22401     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22402     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22403
 22404     MOVE LOW-VALUES                 TO EL631CI.
 22405     MOVE EL631C                     TO PI-MAP-NAME.
 22406     MOVE 'Y'                        TO PI-BROWSE-SW.
 22407     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22408                                        PI-HIGH-SEQ-NO.
 22409
 22410     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22411        MOVE AL-SABOF                TO CCHGTA
 22412        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22413        MOVE AL-SANON                TO CCHGA
 22414      ELSE
 22415        MOVE AL-SADOF                TO CCHGTA
 22416                                        CCHGA
 22417        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22418
 22419*    MOVE PB-C-REFERENCE             TO CREFO.
 22420
 22421*    IF PB-C-MICROFILM-NO IS NUMERIC
 22422*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22423*          MOVE PB-C-MICROFILM-NO
 22424*                                TO CMICRNOO
 22425*          MOVE AL-UNNON         TO CMICRNOA
 22426*       END-IF
 22427*    END-IF
 22428     IF PB-C-NH-INT-ON-REFS NUMERIC
 22429        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22430           MOVE PB-C-NH-INT-ON-REFS
 22431                                 TO CNHINTO
 22432           MOVE AL-SANOF         TO CNHINTA
 22433        END-IF
 22434     END-IF
 22435     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22436     MOVE PB-CERT-SFX                TO CSUFIXO.
 22437     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22438     MOVE SPACE                      TO DC-OPTION-CODE.
 22439     PERFORM 9700-DATE-LINK.
 22440     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22441
 22442     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 412
* EL6311.cbl
 22443        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22444        MOVE SPACE                   TO DC-OPTION-CODE
 22445        PERFORM 9700-DATE-LINK
 22446        IF NO-CONVERSION-ERROR
 22447           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22448
 22449     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22450        NEXT SENTENCE
 22451     ELSE
 22452        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22453
 22454     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22455        NEXT SENTENCE
 22456     ELSE
 22457        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22458
 22459     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22460        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22461        MOVE SPACE                   TO DC-OPTION-CODE
 22462        PERFORM 9700-DATE-LINK
 22463        IF NO-CONVERSION-ERROR
 22464           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22465
 22466     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22467         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22468
 22469     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22470         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22471
 22472     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22473        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22474        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22475                 GIVING CDRFND1O.
 22476
 22477     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22478        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22479        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22480                 GIVING CDRFND2O.
 22481
 22482     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22483       IF PB-RECORD-ON-HOLD
 22484          MOVE 'ON HOLD'             TO CBILIT1O.
 22485
 22486     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22487       IF PB-RECORD-RETURNED
 22488          MOVE 'RETURNED'            TO CBILIT1O.
 22489
 22490     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22491        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22492             MOVE 'OVERRIDE'         TO CBILIT1O.
 22493
 22494     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22495       IF PB-RECORD-ON-HOLD
 22496          MOVE 'ON HOLD'             TO CBILIT2O.
 22497
 22498     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22499       IF PB-RECORD-RETURNED
 22500          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 413
* EL6311.cbl
 22501
 22502     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22503        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22504             MOVE 'OVERRIDE'         TO CBILIT2O.
 22505
 22506     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22507     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22508     IF PB-C-POST-CARD-IND = 'Y'
 22509        MOVE 'Y'                     TO CPCYNO
 22510     ELSE
 22511        MOVE 'N'                     TO CPCYNO
 22512     END-IF
 22513     MOVE PB-FORCE-CODE              TO CFORCEO.
 22514     MOVE PB-RECORD-BILL             TO CBILCDO.
 22515     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22516     MOVE SPACES                     TO CINITSO.
 22517     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22518         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22519     ELSE
 22520         MOVE PB-CI-INITIALS         TO CINITSO
 22521     END-IF.
 22522
 22523     IF PB-CI-CANCEL-FEE NUMERIC
 22524        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22525        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22526     ELSE
 22527        MOVE ZEROES                  TO W-CANCEL-FEE.
 22528
 22529     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22530
 22531     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22532        ADD PB-CI-LF-PREMIUM-AMT
 22533             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22534
 22535     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22536        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22537
 22538     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22539     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22540     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22541     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22542
 22543     IF PB-C-LIVES NUMERIC
 22544        MOVE PB-C-LIVES              TO CLIVESO.
 22545
 22546     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22547        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22548
 22549     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22550        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22551        MOVE SPACE                   TO DC-OPTION-CODE
 22552        PERFORM 9700-DATE-LINK
 22553        IF NO-CONVERSION-ERROR
 22554           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22555
 22556     IF  PB-C-REFUND-CREATED
 22557         MOVE 'YES'                  TO CRFNDSWO
 22558     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 414
* EL6311.cbl
 22559         IF PB-C-REFUND-REQUESTED
 22560            MOVE 'REQ'               TO CRFNDSWO
 22561         ELSE
 22562            MOVE 'NO'                TO CRFNDSWO.
 22563
 22564     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22565     MOVE SPACE                      TO DC-OPTION-CODE.
 22566     PERFORM 9700-DATE-LINK.
 22567     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22568     MOVE PB-INPUT-BY                TO CENTBYO.
 22569
 22570     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22571        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22572        MOVE SPACE                   TO DC-OPTION-CODE
 22573        PERFORM 9700-DATE-LINK
 22574        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22575        MOVE 'INACTIVE'              TO CMOENDTO
 22576     ELSE
 22577        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22578        MOVE SPACE                   TO DC-OPTION-CODE
 22579        PERFORM 9700-DATE-LINK
 22580        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22581        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22582        MOVE SPACE                   TO DC-OPTION-CODE
 22583        PERFORM 9700-DATE-LINK
 22584        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22585
 22586     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22587
 22588     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22589     MOVE WS-HR-MINS                 TO CMANTATO.
 22590
 22591     EVALUATE PB-LF-REFUND-TYPE
 22592        WHEN '1'
 22593           MOVE 'RULE78'            TO CLFREFNO
 22594        WHEN '2'
 22595           MOVE 'PRORAT'            TO CLFREFNO
 22596        WHEN '3'
 22597           MOVE 'CALIF'             TO CLFREFNO
 22598        WHEN '4'
 22599           MOVE 'IRREG'             TO CLFREFNO
 22600        WHEN '5'
 22601           MOVE 'NETPAY'            TO CLFREFNO
 22602        WHEN '6'
 22603           MOVE 'ATCP'              TO CLFREFNO
 22604        WHEN '7'
 22605           MOVE 'UTAH'              TO CLFREFNO
 22606        WHEN '8'
 22607           MOVE 'MEAN'              TO CLFREFNO
 22608        WHEN '9'
 22609           MOVE 'SUM '              TO CLFREFNO
 22610        WHEN 'B'
 22611           MOVE 'BALN'              TO CLFREFNO
 22612     END-EVALUATE.
 22613
 22614     EVALUATE TRUE
 22615        WHEN PB-AH-REFUND-TYPE =  '1'
 22616           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 415
* EL6311.cbl
 22617        WHEN PB-AH-REFUND-TYPE =  '2'
 22618           MOVE 'PRORAT'            TO CAHREFNO
 22619        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22620           MOVE 'CALIF'             TO CAHREFNO
 22621        WHEN PB-AH-REFUND-TYPE =  '4'
 22622           MOVE 'IRREG'             TO CAHREFNO
 22623        WHEN PB-AH-REFUND-TYPE =  '5'
 22624           MOVE 'NETPAY'            TO CAHREFNO
 22625        WHEN PB-AH-REFUND-TYPE =  '6'
 22626           MOVE 'ATCP'              TO CAHREFNO
 22627        WHEN PB-AH-REFUND-TYPE =  '7'
 22628           MOVE 'UTAH'              TO CAHREFNO
 22629        WHEN PB-AH-REFUND-TYPE =  '8'
 22630           MOVE 'MEAN'              TO CAHREFNO
 22631        WHEN PB-AH-REFUND-TYPE =  '9'
 22632           MOVE 'SUM '              TO CAHREFNO
 22633        WHEN PB-AH-REFUND-TYPE =  'B'
 22634           MOVE 'BALN'              TO CAHREFNO
 22635     END-EVALUATE.
 22636
 22637     MOVE PB-REIN-CD                 TO CREINCDO.
 22638
 22639     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22640        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22641        MOVE SPACE                   TO DC-OPTION-CODE
 22642        PERFORM 9700-DATE-LINK
 22643        IF NO-CONVERSION-ERROR
 22644           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22645
 22646     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22647        MOVE 999999                  TO WS-EXP-DT-EDIT
 22648        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22649        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22650     ELSE
 22651        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22652           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22653           MOVE SPACE                   TO DC-OPTION-CODE
 22654           PERFORM 9700-DATE-LINK
 22655           IF NO-CONVERSION-ERROR
 22656              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22657
 22658     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22659        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22660           MOVE AL-SANOF                TO CORIGHDA
 22661           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22662           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22663
 22664     MOVE PB-CSR-ID              TO CCSRO.
 22665
 22666     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22667     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22668
 22669     MOVE 'C'                    TO CMAINTI.
 22670     MOVE AL-UANON               TO CMAINTA.
 22671
 22672     IF PI-6316-FINALIZED = 'Y'  AND
 22673        PB-UNFORCED-ERRORS
 22674          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 416
* EL6311.cbl
 22675          MOVE  1                TO SET-CURSOR-SW
 22676     END-IF
 22677
 22678     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22679        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22680
 22681     IF NO-CURSOR-SET
 22682        MOVE -1                  TO CMAINTL.
 22683
 22684     GO TO 8100-SEND-INITIAL-MAP.
 22685
 22686
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 417
* EL6311.cbl
 22688***************************************************************
 22689*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22690*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22691***************************************************************
 22692
 22693 7200-DISPLAY-BATCHES.
 22694     MOVE EL631D                 TO PI-MAP-NAME.
 22695     MOVE LOW-VALUES             TO EL631DI.
 22696
 22697     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22698
 22699
 22700* EXEC CICS HANDLE CONDITION
 22701*         NOTFND   (3690-NOT-FOUND)
 22702*    END-EXEC.
 22703*    MOVE '"$I                   ! Y #00018994' TO DFHEIV0
 22704     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22706     MOVE X'5920233030303138393934' TO DFHEIV0(25:11)
 22707     CALL 'kxdfhei1' USING DFHEIV0
 22708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22709
 22710
 22711     IF PI-DISPLAY-SCREEN
 22712        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22713     ELSE
 22714        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22715
 22716     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22717     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22718
 22719
 22720* EXEC CICS READ
 22721*         DATASET   (FILE-ID-ERPNDB)
 22722*         RIDFLD    (ERPNDB-KEY)
 22723*         SET       (ADDRESS OF PENDING-BUSINESS)
 22724*    END-EXEC.
 22725*    MOVE '&"S        E          (   #00019006' TO DFHEIV0
 22726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22728     MOVE X'2020233030303139303036' TO DFHEIV0(25:11)
 22729     CALL 'kxdfhei1' USING DFHEIV0,
 22730           FILE-ID-ERPNDB,
 22731           DFHEIV20,
 22732           DFHEIV99,
 22733           ERPNDB-KEY,
 22734           DFHEIV99,
 22735           DFHEIV99,
 22736           DFHEIV99
 22737     SET ADDRESS OF PENDING-BUSINESS TO
 22738         DFHEIV20
 22739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22740
 22741
 22742     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22743     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22744     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22745     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 418
* EL6311.cbl
 22746     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22747
 22748     MOVE EL631D                 TO PI-MAP-NAME.
 22749     MOVE LOW-VALUES             TO EL631DI.
 22750     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22751
 22752*    IF PI-AR-PROCESSING
 22753*       MOVE PB-REFERENCE        TO DREFO.
 22754
 22755     MOVE PB-CSR-ID              TO DCSRO.
 22756
 22757     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22758        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22759        MOVE SPACE               TO DC-OPTION-CODE
 22760        PERFORM 9700-DATE-LINK
 22761        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22762        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22763        MOVE 'INACTIVE'          TO DLDATEO
 22764     ELSE
 22765        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22766        MOVE SPACE               TO DC-OPTION-CODE
 22767        PERFORM 9700-DATE-LINK
 22768        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22769
 22770     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22771     MOVE SPACE                  TO DC-OPTION-CODE.
 22772     PERFORM 9700-DATE-LINK.
 22773     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22774
 22775     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22776        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22777     ELSE
 22778        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22779        MOVE SPACE               TO DC-OPTION-CODE
 22780        PERFORM 9700-DATE-LINK
 22781        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22782
 22783     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22784     MOVE SPACE                  TO DC-OPTION-CODE.
 22785     PERFORM 9700-DATE-LINK.
 22786     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22787
 22788     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22789     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22790
 22791     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22792        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22793                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22794
 22795     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22796     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22797     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22798
 22799     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22800        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22801                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22802
 22803     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 419
* EL6311.cbl
 22804     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22805     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22806
 22807     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22808        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22809                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22810
 22811     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22812     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22813
 22814     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22815        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22816                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22817
 22818     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22819     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22820     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22821
 22822     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22823        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22824                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22825
 22826     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22827     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22828     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22829
 22830     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22831        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22832                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22833
 22834     MOVE -1                     TO DPFENTRL.
 22835     GO TO 8100-SEND-INITIAL-MAP.
 22836
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 420
* EL6311.cbl
 22838
 22839***************************************************************
 22840*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22841*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22842*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22843*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22844*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22845*     ARE THEN SET ACCORDINGLY.                               *
 22846*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22847*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22848*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22849***************************************************************
 22850
 22851******************************************************************
 22852*                                                                *
 22853*            E R R O R   A N A L Y S I S                         *
 22854*                                                                *
 22855******************************************************************
 22856
 22857******************************************************************
 22858*                                                                *
 22859*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22860*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22861*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22862*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22863*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22864*                                                                *
 22865*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22866*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22867*                                                                *
 22868******************************************************************
 22869
 22870 7300-FORMAT-ERRORS.
 22871     MOVE ' '                    TO PI-ERRORS-SW
 22872     IF PB-COMMON-ERRORS = LOW-VALUES
 22873        IF PB-FATAL-ERRORS
 22874           MOVE ER-2695          TO EMI-ERROR
 22875           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22876           GO TO 7399-EXIT.
 22877
 22878     MOVE +0                     TO WS-SUB4.
 22879
 22880 7310-ERROR-LOOP.
 22881
 22882     ADD +1                      TO WS-SUB4.
 22883
 22884     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22885        GO TO 7350-SET-ERROR-FLAGS.
 22886
 22887     IF PI-COMPANY-ID = 'UCL'
 22888         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22889             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22890             MOVE ' '                   TO DC-OPTION-CODE
 22891             PERFORM 9700-DATE-LINK
 22892             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22893
 22894     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22895     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 421
* EL6311.cbl
 22896     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22897
 22898     GO TO 7310-ERROR-LOOP.
 22899
 22900
 22901 7350-SET-ERROR-FLAGS.
 22902
 22903     IF EMI-FATAL-CTR NOT = ZEROS
 22904        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22905        MOVE 'X'                 TO PB-FATAL-FLAG
 22906                                    PI-ERRORS-SW
 22907        GO TO 7355-SET-ERROR-FLAGS.
 22908
 22909     move ' ' to pi-unforced-sw
 22910     IF EMI-FORCABLE-CTR NOT = ZEROS
 22911        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22912        IF PB-ISSUE
 22913           IF PB-ISSUE-FORCE
 22914              MOVE 'F'           TO PB-FORCE-ER-CD
 22915              MOVE ER-2600       TO EMI-ERROR
 22916              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22917             ELSE
 22918              MOVE 'X'           TO PB-FORCE-ER-CD
 22919*                                   PI-ERRORS-SW
 22920          ELSE
 22921           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22922              MOVE 'F'           TO PB-FORCE-ER-CD
 22923                                    pi-unforced-sw
 22924              MOVE ER-2600       TO EMI-ERROR
 22925              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22926             ELSE
 22927              MOVE 'X'           TO PB-FORCE-ER-CD
 22928                                    pi-unforced-sw.
 22929*                                   PI-ERRORS-SW.
 22930
 22931     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22932     IF PB-ISSUE
 22933         MOVE 'I'                TO ENDT-RECORD-TYPE
 22934     ELSE
 22935         MOVE 'C'                TO ENDT-RECORD-TYPE
 22936     END-IF
 22937     MOVE +0                     TO ENDT-SEQ-NO
 22938
 22939
 22940* EXEC CICS READ
 22941*        DATASET   (FILE-ID-ERENDT)
 22942*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22943*        RIDFLD    (ERENDT-KEY)
 22944*        RESP      (WS-RESPONSE)
 22945*        GTEQ
 22946*    END-EXEC
 22947*    MOVE '&"S        G          (  N#00019209' TO DFHEIV0
 22948     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22950     MOVE X'204E233030303139323039' TO DFHEIV0(25:11)
 22951     CALL 'kxdfhei1' USING DFHEIV0,
 22952           FILE-ID-ERENDT,
 22953           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 422
* EL6311.cbl
 22954           DFHEIV99,
 22955           ERENDT-KEY,
 22956           DFHEIV99,
 22957           DFHEIV99,
 22958           DFHEIV99
 22959     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22960         DFHEIV20
 22961     MOVE EIBRESP  TO WS-RESPONSE
 22962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22963
 22964     IF RESP-NORMAL
 22965        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22966        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22967            MOVE ER-0280          TO EMI-ERROR
 22968            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22969            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22970            EVALUATE TRUE
 22971              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22972                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22973              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22974                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22975              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22976                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22977            END-EVALUATE
 22978        END-IF
 22979     END-IF
 22980
 22981
 22982
 22983     IF FIRST-ENTRY OR
 22984        EIBAID = DFHPF1 OR DFHPF2
 22985        MOVE '0'                TO PI-EDIT-SW
 22986        GO TO 7399-EXIT.
 22987
 22988 7355-SET-ERROR-FLAGS.
 22989
 22990     IF EMI-WARNING-CTR NOT = ZEROS
 22991        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22992        MOVE 'W'                 TO PB-WARN-ER-CD.
 22993
 22994     IF PB-UNFORCED-ERRORS OR
 22995        PB-FATAL-ERRORS    OR
 22996        PB-RECORD-ON-HOLD  OR
 22997        PB-RECORD-RETURNED OR
 22998        PB-CANCELLATION
 22999          NEXT SENTENCE
 23000        ELSE
 23001          GO TO 7399-EXIT.
 23002
 23003
 23004* EXEC CICS  HANDLE CONDITION
 23005*           NOTFND   (7399-EXIT)
 23006*    END-EXEC.
 23007*    MOVE '"$I                   ! Z #00019256' TO DFHEIV0
 23008     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23010     MOVE X'5A20233030303139323536' TO DFHEIV0(25:11)
 23011     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 423
* EL6311.cbl
 23012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23013
 23014
 23015     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23016     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23017     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23018     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23019
 23020
 23021* EXEC CICS READ
 23022*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23023*        DATASET (FILE-ID-ELCERT)
 23024*        RIDFLD  (ELCERT-KEY)
 23025*        UPDATE
 23026*    END-EXEC.
 23027*    MOVE '&"S        EU         (   #00019265' TO DFHEIV0
 23028     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23029     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23030     MOVE X'2020233030303139323635' TO DFHEIV0(25:11)
 23031     CALL 'kxdfhei1' USING DFHEIV0,
 23032           FILE-ID-ELCERT,
 23033           DFHEIV20,
 23034           DFHEIV99,
 23035           ELCERT-KEY,
 23036           DFHEIV99,
 23037           DFHEIV99,
 23038           DFHEIV99
 23039     SET ADDRESS OF CERTIFICATE-MASTER TO
 23040         DFHEIV20
 23041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23042
 23043
 23044
 23045     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23046     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23047
 23048     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23049        GO TO 7360-REWRITE-CERT-MASTER.
 23050
 23051     IF PB-ISSUE
 23052        IF PB-RECORD-RETURNED
 23053            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23054            GO TO 7360-REWRITE-CERT-MASTER
 23055        ELSE
 23056            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23057            GO TO 7360-REWRITE-CERT-MASTER.
 23058
 23059     IF PB-RECORD-RETURNED
 23060         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23061         GO TO 7360-REWRITE-CERT-MASTER.
 23062
 23063     IF (PB-C-LF-CANCEL-VOIDED)
 23064        or (pb-c-ah-cancel-voided)
 23065        IF (PB-UNFORCED-ERRORS OR
 23066            PB-FATAL-ERRORS    OR
 23067            PB-RECORD-ON-HOLD)
 23068            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23069            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 424
* EL6311.cbl
 23070        ELSE
 23071            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23072            GO TO 7360-REWRITE-CERT-MASTER.
 23073
 23074     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23075                            OR PB-RECORD-ON-HOLD)
 23076        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23077     ELSE
 23078        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23079
 23080 7360-REWRITE-CERT-MASTER.
 23081
 23082     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23083        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23084
 23085* EXEC CICS UNLOCK
 23086*            DATASET    (FILE-ID-ELCERT)
 23087*       END-EXEC
 23088*    MOVE '&*                    #   #00019312' TO DFHEIV0
 23089     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23090     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23091     MOVE X'2020233030303139333132' TO DFHEIV0(25:11)
 23092     CALL 'kxdfhei1' USING DFHEIV0,
 23093           FILE-ID-ELCERT,
 23094           DFHEIV99
 23095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23096        GO TO 7399-EXIT.
 23097
 23098
 23099* EXEC CICS REWRITE
 23100*         DATASET    (FILE-ID-ELCERT)
 23101*         FROM       (CERTIFICATE-MASTER)
 23102*    END-EXEC.
 23103     MOVE LENGTH OF
 23104      CERTIFICATE-MASTER
 23105       TO DFHEIV11
 23106*    MOVE '&& L                  %   #00019317' TO DFHEIV0
 23107     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23108     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23109     MOVE X'2020233030303139333137' TO DFHEIV0(25:11)
 23110     CALL 'kxdfhei1' USING DFHEIV0,
 23111           FILE-ID-ELCERT,
 23112           CERTIFICATE-MASTER,
 23113           DFHEIV11,
 23114           DFHEIV99
 23115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23116
 23117
 23118 7399-EXIT.
 23119      EXIT.
 23120
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 425
* EL6311.cbl
 23122
 23123*************************************************************
 23124*                                                           *
 23125*              S E T   A T T R I B U T E S                  *
 23126*                                                           *
 23127*************************************************************
 23128
 23129 7400-SET-ATTRIBUTES.
 23130
 23131     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23132        GO TO 7499-EXIT.
 23133
 23134**2601**
 23135
 23136     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23137        IF PB-ISSUE
 23138           MOVE AL-UABON         TO BEFFDTA
 23139           GO TO 7499-EXIT
 23140         ELSE
 23141           MOVE AL-UABON         TO CEFFDTA
 23142           GO TO 7499-EXIT.
 23143
 23144**2604**
 23145
 23146     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23147        IF PB-ISSUE
 23148           MOVE AL-UABON         TO BTYPE1A
 23149           MOVE -1               TO BTYPE1L
 23150           MOVE  1               TO SET-CURSOR-SW
 23151           GO TO 7499-EXIT.
 23152
 23153**2605**
 23154
 23155     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23156        IF PB-ISSUE
 23157           MOVE AL-UABON         TO BTYPE2A
 23158           MOVE -1               TO BTYPE2L
 23159           MOVE  1               TO SET-CURSOR-SW
 23160           GO TO 7499-EXIT.
 23161
 23162**2606**
 23163
 23164     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23165        IF PB-ISSUE
 23166           MOVE AL-UABON         TO BSIGA
 23167           MOVE -1               TO BSIGL
 23168           MOVE  1               TO SET-CURSOR-SW
 23169           GO TO 7499-EXIT.
 23170
 23171**2607**
 23172
 23173     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23174        IF PB-ISSUE
 23175           MOVE AL-UABON         TO BSIGA
 23176           MOVE -1               TO BSIGL
 23177           MOVE  1               TO SET-CURSOR-SW
 23178           GO TO 7499-EXIT.
 23179
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 426
* EL6311.cbl
 23180**2615**
 23181
 23182     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23183        IF PB-ISSUE
 23184           MOVE AL-UABOF         TO BREINA
 23185           MOVE -1               TO BREINL
 23186           GO TO 7499-EXIT.
 23187
 23188**2622**
 23189
 23190     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23191        IF PB-ISSUE
 23192           MOVE AL-UABON         TO BEFFDTA
 23193           GO TO 7499-EXIT
 23194        ELSE
 23195           MOVE AL-UABON         TO CEFFDTA
 23196           GO TO 7499-EXIT.
 23197
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 427
* EL6311.cbl
 23199
 23200*************************************************************
 23201*                                                           *
 23202*              I S S U E   E R R O R S                      *
 23203*                                                           *
 23204*************************************************************
 23205
 23206 7420-ISSUE-ERRORS.
 23207
 23208**2626**
 23209
 23210     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23211        MOVE AL-UABON            TO BCERTNOA
 23212        GO TO 7499-EXIT.
 23213
 23214**2627**
 23215
 23216     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23217        MOVE AL-UNBON            TO BAGEA
 23218        MOVE -1                  TO BAGEL
 23219        MOVE  1                  TO SET-CURSOR-SW
 23220        GO TO 7499-EXIT.
 23221
 23222**2628**
 23223
 23224     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23225        MOVE AL-UNBON            TO BAGEA
 23226        MOVE -1                  TO BAGEL
 23227        MOVE  1                  TO SET-CURSOR-SW
 23228        GO TO 7499-EXIT.
 23229
 23230**2629**
 23231
 23232     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23233        MOVE AL-UABON            TO BSEXA
 23234        MOVE -1                  TO BSEXL
 23235        MOVE  1                  TO SET-CURSOR-SW
 23236        GO TO 7499-EXIT.
 23237
 23238**2630**
 23239
 23240     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23241        MOVE -1                  TO BTYPE1L
 23242        MOVE  1                  TO SET-CURSOR-SW
 23243        GO TO 7499-EXIT.
 23244
 23245**2631**
 23246
 23247     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23248        MOVE -1                  TO BTYPE1L
 23249        MOVE  1                  TO SET-CURSOR-SW
 23250        GO TO 7499-EXIT.
 23251
 23252**2632**
 23253
 23254     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23255        MOVE AL-UNBON            TO BBEN1A
 23256        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 428
* EL6311.cbl
 23257        MOVE  1                  TO SET-CURSOR-SW
 23258        GO TO 7499-EXIT.
 23259
 23260**2633**
 23261
 23262     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23263        MOVE AL-UNBON            TO BPREM1A
 23264        MOVE -1                  TO BPREM1L
 23265        MOVE  1                  TO SET-CURSOR-SW
 23266        GO TO 7499-EXIT.
 23267
 23268**2634**
 23269
 23270     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23271        MOVE -1                  TO BTYPE2L
 23272        MOVE  1                  TO SET-CURSOR-SW
 23273        GO TO 7499-EXIT.
 23274
 23275**2635**
 23276
 23277     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23278        MOVE AL-UNBON            TO BBEN2A
 23279        MOVE -1                  TO BBEN2L
 23280        MOVE  1                  TO SET-CURSOR-SW
 23281        GO TO 7499-EXIT.
 23282
 23283**2636**
 23284
 23285     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23286        MOVE AL-UNBON            TO BPREM2A
 23287        MOVE -1                  TO BPREM2L
 23288        MOVE  1                  TO SET-CURSOR-SW
 23289        GO TO 7499-EXIT.
 23290
 23291**2639**
 23292
 23293     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23294        MOVE AL-UNBON            TO BBEN1A
 23295        MOVE -1                  TO BBEN1L
 23296        MOVE  1                  TO SET-CURSOR-SW
 23297        GO TO 7499-EXIT.
 23298
 23299**2640**
 23300
 23301     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23302        MOVE AL-UNBON            TO BBEN2A
 23303        MOVE -1                  TO BBEN2L
 23304        MOVE  1                  TO SET-CURSOR-SW
 23305        GO TO 7499-EXIT.
 23306
 23307**2647**
 23308
 23309     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23310        MOVE AL-UNBON            TO BTERM1A
 23311        MOVE -1                  TO BTERM1L
 23312        MOVE  1                  TO SET-CURSOR-SW
 23313        GO TO 7499-EXIT.
 23314
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 429
* EL6311.cbl
 23315**2648**
 23316
 23317     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23318        MOVE AL-UNBON            TO BLNTRMA
 23319        MOVE -1                  TO BLNTRML
 23320        MOVE  1                  TO SET-CURSOR-SW
 23321        GO TO 7499-EXIT.
 23322
 23323**2649**
 23324
 23325     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23326        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23327            MOVE AL-UNBON            TO BPREM1A
 23328            MOVE -1                  TO BPREM1L
 23329            MOVE  1                  TO SET-CURSOR-SW
 23330            GO TO 7499-EXIT
 23331     ELSE
 23332        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23333           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23334            MOVE AL-UNBON            TO BPREM2A
 23335            MOVE -1                  TO BPREM2L
 23336            MOVE  1                  TO SET-CURSOR-SW
 23337            GO TO 7499-EXIT.
 23338
 23339**2650**
 23340
 23341     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23342        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23343            MOVE AL-UNBON        TO BPREM1A
 23344            MOVE -1              TO BPREM1L
 23345            MOVE  1              TO SET-CURSOR-SW
 23346            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23347                MOVE AL-UNBON        TO BPREM2A
 23348                MOVE -1              TO BPREM2L
 23349                MOVE  1              TO SET-CURSOR-SW
 23350                GO TO 7499-EXIT
 23351            ELSE
 23352                GO TO 7499-EXIT
 23353        ELSE
 23354            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23355                MOVE AL-UNBON        TO BPREM2A
 23356                MOVE -1              TO BPREM2L
 23357                MOVE  1              TO SET-CURSOR-SW
 23358                GO TO 7499-EXIT
 23359            ELSE
 23360                GO TO 7499-EXIT.
 23361
 23362**2651**
 23363
 23364     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23365        MOVE AL-UABON            TO BSIGA
 23366        MOVE -1                  TO BSIGL
 23367        MOVE  1                  TO SET-CURSOR-SW
 23368        GO TO 7499-EXIT.
 23369
 23370**2653**
 23371
 23372     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 430
* EL6311.cbl
 23373        MOVE AL-UABON            TO BFREQA
 23374        MOVE -1                  TO BFREQL
 23375        MOVE  1                  TO SET-CURSOR-SW
 23376        GO TO 7499-EXIT.
 23377
 23378**2654**
 23379
 23380     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23381        MOVE AL-UABON            TO BFREQA
 23382        MOVE -1                  TO BFREQL
 23383        MOVE  1                  TO SET-CURSOR-SW
 23384        GO TO 7499-EXIT.
 23385
 23386**2655**
 23387
 23388     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23389        MOVE AL-UABON            TO BFREQA
 23390        MOVE -1                  TO BFREQL
 23391        MOVE  1                  TO SET-CURSOR-SW
 23392        GO TO 7499-EXIT.
 23393
 23394**2656**
 23395
 23396     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23397        MOVE AL-UNBON            TO BAPRA
 23398        MOVE -1                  TO BAPRL
 23399        MOVE  1                  TO SET-CURSOR-SW
 23400        GO TO 7499-EXIT.
 23401
 23402**2657**
 23403
 23404     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23405        MOVE AL-UNBON            TO BAPRA
 23406        MOVE -1                  TO BAPRL
 23407        MOVE  1                  TO SET-CURSOR-SW
 23408        GO TO 7499-EXIT.
 23409
 23410**2658**
 23411
 23412     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23413        MOVE AL-UNBON            TO BTERM2A
 23414        MOVE -1                  TO BTERM2L
 23415        MOVE  1                  TO SET-CURSOR-SW
 23416        GO TO 7499-EXIT.
 23417
 23418**2660**
 23419
 23420     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23421        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23422        MOVE -1                  TO BLSTNML
 23423        MOVE  1                  TO SET-CURSOR-SW
 23424        GO TO 7499-EXIT.
 23425
 23426
 23427**2662**
 23428
 23429     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23430        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 431
* EL6311.cbl
 23431        MOVE -1                  TO BAGEL
 23432        MOVE  1                  TO SET-CURSOR-SW
 23433        GO TO 7499-EXIT.
 23434
 23435**2663**
 23436
 23437     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23438        MOVE AL-UNBON            TO BAGEA
 23439        MOVE -1                  TO BAGEL
 23440        MOVE  1                  TO SET-CURSOR-SW
 23441        GO TO 7499-EXIT.
 23442
 23443**2664**
 23444
 23445     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23446        MOVE AL-UABON            TO BREINA
 23447        MOVE -1                  TO BREINL
 23448        MOVE  1                  TO SET-CURSOR-SW
 23449        GO TO 7499-EXIT.
 23450
 23451**2667**
 23452
 23453     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23454        MOVE AL-UNBON            TO BBEN2A
 23455        MOVE -1                  TO BBEN2L
 23456        MOVE  1                  TO SET-CURSOR-SW
 23457        GO TO 7499-EXIT.
 23458
 23459**2668**
 23460
 23461     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23462        MOVE AL-UABON            TO BEFFDTA
 23463        GO TO 7499-EXIT.
 23464
 23465**2669**
 23466
 23467     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23468       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23469       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23470        MOVE AL-UNBON            TO BAGEA
 23471        MOVE -1                  TO BAGEL
 23472        MOVE  1                  TO SET-CURSOR-SW
 23473        GO TO 7499-EXIT.
 23474
 23475**2670**
 23476
 23477     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23478        MOVE AL-UABON            TO BFORCEA
 23479        MOVE -1                  TO BFORCEL
 23480        MOVE  1                  TO SET-CURSOR-SW
 23481        GO TO 7499-EXIT.
 23482
 23483**2671**
 23484
 23485     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23486        MOVE AL-UABON            TO BEFFDTA
 23487        GO TO 7499-EXIT.
 23488
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 432
* EL6311.cbl
 23489**2672**
 23490
 23491     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23492        MOVE AL-UABON            TO BEFFDTA
 23493        GO TO 7499-EXIT.
 23494
 23495**2673**
 23496
 23497     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23498        MOVE AL-UABON            TO BEFFDTA
 23499        GO TO 7499-EXIT.
 23500
 23501**2674**
 23502
 23503     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23504        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23505        MOVE -1                  TO BTYPE1L
 23506        MOVE  1                  TO SET-CURSOR-SW
 23507        GO TO 7499-EXIT.
 23508
 23509**2677**
 23510
 23511     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23512        MOVE AL-UNBON            TO BTERM1A
 23513        MOVE -1                  TO BTERM1L
 23514        MOVE  1                  TO SET-CURSOR-SW
 23515        GO TO 7499-EXIT.
 23516
 23517**2678**
 23518
 23519     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23520        MOVE AL-UNBON            TO BTERM2A
 23521        MOVE -1                  TO BTERM2L
 23522        MOVE  1                  TO SET-CURSOR-SW
 23523        GO TO 7499-EXIT.
 23524
 23525**2679**
 23526
 23527     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23528        MOVE AL-UABON            TO BTYPE1A
 23529        MOVE -1                  TO BTYPE1L
 23530        MOVE  1                  TO SET-CURSOR-SW
 23531        GO TO 7499-EXIT.
 23532
 23533**2680**
 23534
 23535     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23536        MOVE AL-UABOF            TO B1STPMTA
 23537        MOVE -1                  TO B1STPMTL
 23538        MOVE  1                  TO SET-CURSOR-SW
 23539        GO TO 7499-EXIT.
 23540
 23541**2681**
 23542
 23543     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23544        MOVE AL-UABON            TO BDAYSA
 23545        MOVE -1                  TO BDAYSL
 23546        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 433
* EL6311.cbl
 23547        GO TO 7499-EXIT.
 23548
 23549**2682**
 23550
 23551     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23552        MOVE AL-UABON            TO BTERM1A
 23553        MOVE -1                  TO BTERM1L
 23554        MOVE  1                  TO SET-CURSOR-SW
 23555        GO TO 7499-EXIT.
 23556
 23557**2683**
 23558
 23559     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23560        MOVE AL-UABON            TO BSKPCDA
 23561        MOVE -1                  TO BSKPCDL
 23562        MOVE  1                  TO SET-CURSOR-SW
 23563        GO TO 7499-EXIT.
 23564
 23565**2684**
 23566
 23567     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23568        MOVE AL-UABON            TO BTYPE2A
 23569        MOVE -1                  TO BTYPE2L
 23570        MOVE  1                  TO SET-CURSOR-SW
 23571        GO TO 7499-EXIT.
 23572
 23573**2686**
 23574
 23575     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23576        MOVE AL-UABON            TO BTYPE2A
 23577        MOVE -1                  TO BTYPE2L
 23578        MOVE  1                  TO SET-CURSOR-SW
 23579        GO TO 7499-EXIT.
 23580
 23581**2689**
 23582
 23583     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23584        MOVE AL-UABON            TO BSIGA
 23585        MOVE -1                  TO BSIGL
 23586        MOVE  1                  TO SET-CURSOR-SW
 23587        GO TO 7499-EXIT.
 23588
 23589**2690**
 23590
 23591     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23592        MOVE AL-UABOF            TO BLNOFCRA
 23593        MOVE -1                  TO BLNOFCRL
 23594        MOVE  1                  TO SET-CURSOR-SW
 23595        GO TO 7499-EXIT.
 23596
 23597**2693**
 23598
 23599     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23600        MOVE AL-UABOF            TO BLNOFCRA
 23601        MOVE AL-UNBON            TO BBEN1A
 23602        MOVE -1                  TO BBEN1L
 23603        MOVE  1                  TO SET-CURSOR-SW
 23604        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 434
* EL6311.cbl
 23605
 23606**2720**
 23607
 23608     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23609        MOVE AL-UNBON            TO BBEN1A
 23610        MOVE -1                  TO BBEN1L
 23611        MOVE  1                  TO SET-CURSOR-SW
 23612        GO TO 7499-EXIT.
 23613
 23614**2709**
 23615
 23616*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23617*       MOVE AL-UNBON            TO BBEN1A
 23618*       MOVE -1                  TO BBEN1L
 23619*       MOVE  1                  TO SET-CURSOR-SW
 23620*       GO TO 7499-EXIT.
 23621
 23622*************************************************************
 23623*                                                           *
 23624*            C A N C E L   E R R O R S                      *
 23625*                                                           *
 23626*************************************************************
 23627
 23628**2726**
 23629
 23630     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23631        MOVE AL-UABON            TO CCERTNOA
 23632        GO TO 7499-EXIT.
 23633
 23634**2728**
 23635
 23636     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23637        MOVE AL-UABON            TO CCERTNOA
 23638        GO TO 7499-EXIT.
 23639
 23640**2729**
 23641
 23642     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23643        MOVE AL-UABON            TO CCERTNOA
 23644        GO TO 7499-EXIT.
 23645
 23646**2730**
 23647
 23648     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23649        MOVE AL-UABON            TO CCERTNOA
 23650        GO TO 7499-EXIT.
 23651
 23652**2731**
 23653
 23654     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23655        MOVE AL-UABON            TO CCANDT1A
 23656        MOVE -1                  TO CCANDT1L
 23657        MOVE  1                  TO SET-CURSOR-SW
 23658        GO TO 7499-EXIT.
 23659
 23660**2732**
 23661
 23662     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 435
* EL6311.cbl
 23663        MOVE AL-UABON            TO CCANDT1A
 23664        MOVE -1                  TO CCANDT1L
 23665        MOVE  1                  TO SET-CURSOR-SW
 23666        GO TO 7499-EXIT.
 23667
 23668**2733**
 23669
 23670     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23671        MOVE AL-UABON            TO CCANDT1A
 23672        MOVE -1                  TO CCANDT1L
 23673        MOVE  1                  TO SET-CURSOR-SW
 23674        GO TO 7499-EXIT.
 23675
 23676**2734**
 23677
 23678     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23679        MOVE AL-UNBON            TO CREFND1A
 23680        MOVE -1                  TO CREFND1L
 23681        MOVE  1                  TO SET-CURSOR-SW
 23682        GO TO 7499-EXIT.
 23683
 23684**2735**
 23685
 23686     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23687        MOVE AL-UABON            TO CCANDT2A
 23688        MOVE -1                  TO CCANDT2L
 23689        MOVE  1                  TO SET-CURSOR-SW
 23690        GO TO 7499-EXIT.
 23691
 23692**2736**
 23693
 23694     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23695        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23696            MOVE AL-UNBON        TO CREFND1A
 23697            MOVE -1              TO CREFND1L
 23698            MOVE  1              TO SET-CURSOR-SW
 23699            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23700                MOVE AL-UNBON        TO CREFND2A
 23701                MOVE -1              TO CREFND2L
 23702                MOVE  1              TO SET-CURSOR-SW
 23703                GO TO 7499-EXIT
 23704            ELSE
 23705                GO TO 7499-EXIT
 23706        ELSE
 23707            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23708                MOVE AL-UNBON        TO CREFND2A
 23709                MOVE -1              TO CREFND2L
 23710                MOVE  1              TO SET-CURSOR-SW
 23711                GO TO 7499-EXIT
 23712            ELSE
 23713                GO TO 7499-EXIT.
 23714
 23715**2738**
 23716
 23717     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23718        MOVE -1                  TO CREFND2L
 23719        MOVE  1                  TO SET-CURSOR-SW
 23720        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 436
* EL6311.cbl
 23721
 23722**2739**
 23723
 23724     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23725        MOVE -1                  TO CREFND1L
 23726        MOVE  1                  TO SET-CURSOR-SW
 23727        GO TO 7499-EXIT.
 23728
 23729**2741**
 23730
 23731     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23732        MOVE -1                  TO CREFND1L
 23733        MOVE  1                  TO SET-CURSOR-SW
 23734        GO TO 7499-EXIT.
 23735
 23736**2743**
 23737
 23738     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23739        MOVE AL-UNBON            TO CCANDT1A
 23740        MOVE -1                  TO CCANDT1L
 23741        MOVE  1                  TO SET-CURSOR-SW
 23742        GO TO 7499-EXIT.
 23743
 23744**2744**
 23745
 23746     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23747        MOVE AL-UNBON            TO CCANDT2A
 23748        MOVE -1                  TO CCANDT2L
 23749        MOVE  1                  TO SET-CURSOR-SW
 23750        GO TO 7499-EXIT.
 23751
 23752**2747**
 23753
 23754     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23755        MOVE AL-UABON            TO CLSTNMA
 23756        MOVE -1                  TO CLSTNML
 23757        MOVE  1                  TO SET-CURSOR-SW
 23758        GO TO 7499-EXIT.
 23759
 23760**2749**
 23761
 23762     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23763        MOVE AL-UABON            TO CFORCEA
 23764        MOVE -1                  TO CFORCEL
 23765        MOVE  1                  TO SET-CURSOR-SW
 23766        GO TO 7499-EXIT.
 23767
 23768**2753**
 23769
 23770     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23771        MOVE AL-UNBON            TO CCANDT1A
 23772        MOVE -1                  TO CCANDT1L
 23773        MOVE  1                  TO SET-CURSOR-SW
 23774        GO TO 7499-EXIT.
 23775
 23776**2755**
 23777
 23778     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 437
* EL6311.cbl
 23779        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23780            MOVE AL-UNBON        TO CREFND1A
 23781            MOVE -1              TO CREFND1L
 23782            MOVE  1              TO SET-CURSOR-SW
 23783            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23784                MOVE AL-UNBON        TO CREFND2A
 23785                MOVE -1              TO CREFND2L
 23786                MOVE  1              TO SET-CURSOR-SW
 23787                GO TO 7499-EXIT
 23788            ELSE
 23789                GO TO 7499-EXIT
 23790        ELSE
 23791            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23792                MOVE AL-UNBON        TO CREFND2A
 23793                MOVE -1              TO CREFND2L
 23794                MOVE  1              TO SET-CURSOR-SW
 23795            ELSE
 23796                GO TO 7499-EXIT.
 23797
 23798**2757**
 23799
 23800     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23801        MOVE AL-UNBON            TO CLIVESA
 23802        MOVE -1                  TO CLIVESL
 23803        MOVE  1                  TO SET-CURSOR-SW
 23804        GO TO 7499-EXIT.
 23805
 23806**2771**
 23807
 23808     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23809        MOVE AL-UABON            TO CCANDT2A
 23810        MOVE -1                  TO CCANDT2L
 23811        MOVE  1                  TO SET-CURSOR-SW
 23812        GO TO 7499-EXIT.
 23813
 23814**2774**
 23815
 23816     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23817        MOVE AL-UABON            TO CCANDT1A
 23818        MOVE -1                  TO CCANDT1L
 23819        MOVE  1                  TO SET-CURSOR-SW
 23820        GO TO 7499-EXIT.
 23821
 23822**2775**
 23823
 23824     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23825        MOVE AL-UABON            TO CCANDT2A
 23826        MOVE -1                  TO CCANDT2L
 23827        MOVE  1                  TO SET-CURSOR-SW
 23828        GO TO 7499-EXIT.
 23829
 23830**2776**
 23831
 23832     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23833        MOVE AL-UABON            TO CCANDT1A
 23834        MOVE -1                  TO CCANDT1L
 23835        MOVE  1                  TO SET-CURSOR-SW
 23836        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 438
* EL6311.cbl
 23837
 23838
 23839**2777**
 23840
 23841     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23842        MOVE AL-UABON            TO CCANDT2A
 23843        MOVE -1                  TO CCANDT2L
 23844        MOVE  1                  TO SET-CURSOR-SW
 23845        GO TO 7499-EXIT.
 23846
 23847**2794**
 23848
 23849     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23850        MOVE AL-UABON            TO CFORCEA
 23851        MOVE -1                  TO CFORCEL
 23852        MOVE  1                  TO SET-CURSOR-SW
 23853        GO TO 7499-EXIT.
 23854
 23855**2799**
 23856
 23857     IF PI-COMPANY-ID = 'UCL'
 23858         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23859             MOVE AL-UNBON            TO BEFFDTA
 23860             MOVE -1                  TO BEFFDTL
 23861             MOVE  1                  TO SET-CURSOR-SW
 23862             GO TO 7499-EXIT.
 23863
 23864 7499-EXIT.
 23865      EXIT.
 23866
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 439
* EL6311.cbl
 23868
 23869 7500-READ-ERLOFC.
 23870     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23871                                     ERLOFC-KEY.
 23872
 23873     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23874
 23875     IF ST-ACCNT-CNTL
 23876         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23877
 23878     IF CARR-GROUP-ST-ACCNT-CNTL
 23879         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23880         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23881         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23882
 23883     IF CARR-ST-ACCNT-CNTL
 23884         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23885         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23886
 23887     IF CARR-ACCNT-CNTL
 23888         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23889
 23890     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23891
 23892     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23893
 23894
 23895* EXEC CICS HANDLE CONDITION
 23896*        NOTFND   (7550-OFFICER-NOTFND)
 23897*    END-EXEC.
 23898*    MOVE '"$I                   ! [ #00020098' TO DFHEIV0
 23899     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23901     MOVE X'5B20233030303230303938' TO DFHEIV0(25:11)
 23902     CALL 'kxdfhei1' USING DFHEIV0
 23903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23904
 23905
 23906
 23907* EXEC CICS READ
 23908*        DATASET   (FILE-ID-ERLOFC)
 23909*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23910*        RIDFLD    (ERLOFC-KEY)
 23911*        EQUAL
 23912*    END-EXEC.
 23913*    MOVE '&"S        E          (   #00020102' TO DFHEIV0
 23914     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23916     MOVE X'2020233030303230313032' TO DFHEIV0(25:11)
 23917     CALL 'kxdfhei1' USING DFHEIV0,
 23918           FILE-ID-ERLOFC,
 23919           DFHEIV20,
 23920           DFHEIV99,
 23921           ERLOFC-KEY,
 23922           DFHEIV99,
 23923           DFHEIV99,
 23924           DFHEIV99
 23925     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 440
* EL6311.cbl
 23926         DFHEIV20
 23927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23928
 23929
 23930     GO TO 7599-EXIT.
 23931
 23932 7550-OFFICER-NOTFND.
 23933     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23934
 23935 7599-EXIT.
 23936      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 441
* EL6311.cbl
 23938******************************************************************
 23939*                                                                *
 23940*            S  E N D    I N I T I A L   M A P                   *
 23941*                                                                *
 23942******************************************************************
 23943
 23944 8100-SEND-INITIAL-MAP.
 23945     MOVE EIBTIME                TO TIME-IN.
 23946
 23947     IF EIBAID = DFHPF11
 23948        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23949        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23950
 23951
 23952     IF PI-COMPANY-ID = CLIENT-GIC
 23953        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23954                                       BCPREM-ATTRB (2).
 23955
 23956     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23957                         CLIENT-PEM OR
 23958                         CLIENT-CSO)
 23959        AND PI-DISPLAY-ORIGINAL-BATCH
 23960          IF PI-MAP-NAME = EL631B
 23961             MOVE AL-SADOF               TO BPF5HDRA
 23962                                            BPF4HDRA
 23963          ELSE
 23964             IF PI-MAP-NAME = EL631C
 23965                MOVE AL-SADOF            TO CPF5HDRA
 23966                                            CPF4HDRA.
 23967
 23968     IF PI-MAP-NAME = EL631B
 23969        MOVE AL-SADOF               TO BPF5HDRA
 23970     ELSE
 23971        MOVE AL-SADOF               TO CPF5HDRA
 23972     END-IF
 23973
 23974*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23975     IF PI-MAP-NAME = EL631B
 23976          IF PI-COMPANY-ID NOT = 'DMD'
 23977             MOVE AL-SANOF            TO BBILLEDA
 23978             MOVE AL-SADOF            TO DMDBILA.
 23979*DMD CUSTOM CODING*************END
 23980
 23981     IF PI-PROCESSOR-ID = 'LGXX'
 23982        IF PI-MAP-NAME = EL631B
 23983           MOVE AL-SABOF                    TO BREFHDGA
 23984           MOVE AL-SANOF                    TO BREFA
 23985        ELSE
 23986           IF PI-MAP-NAME = EL631C
 23987              MOVE AL-SABOF                 TO CREFHDGA
 23988              MOVE AL-SANOF                 TO CREFA.
 23989
 23990*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23991     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23992        NEXT SENTENCE
 23993     ELSE
 23994        IF PI-MAP-NAME = EL631C
 23995           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 442
* EL6311.cbl
 23996                                       CCANFEEA.
 23997
 23998     IF PI-MAP-NAME = EL631D
 23999        IF PI-AR-PROCESSING
 24000           MOVE AL-SANOF            TO DREFHDGA
 24001        ELSE
 24002           MOVE AL-SADOF            TO DREFHDGA.
 24003
 24004     IF (PI-COMPANY-ID NOT = 'DCC')
 24005        AND (PI-MAP-NAME = EL631B)
 24006        MOVE AL-SADOF            TO BVINHA
 24007                                    BVINA
 24008     END-IF
 24009     IF PI-MAP-NAME = EL631B
 24010        IF CSR-EDIT-SESSION
 24011           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24012                                 TO BHEADO
 24013           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24014        ELSE
 24015           MOVE AL-SADOF         TO BF15HDRA
 24016           MOVE '4=B-HDR      '  TO BPF4HDRO
 24017        END-IF
 24018        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24019        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24020        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24021        MOVE WS-CURRENT-DT          TO BDATEO
 24022        MOVE TIME-OUT               TO BTIMEO
 24023        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24024        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24025        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24026        IF   WS-DISPLAY-SCREEN
 24027             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24028             MOVE PB-SV-CARRIER     TO BCARRO
 24029             MOVE PB-SV-GROUPING    TO BGROUPO
 24030             MOVE PB-SV-STATE       TO BSTATEO
 24031             MOVE PB-ACCOUNT        TO BACCTO
 24032        ELSE
 24033             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24034     ELSE
 24035        IF PI-MAP-NAME = EL631C
 24036           MOVE '4=B-HDR      '     TO CPF4HDRO
 24037           IF CSR-EDIT-SESSION
 24038              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24039                                 TO CHEADO
 24040           ELSE
 24041              MOVE AL-SADOF      TO CF15HDRA
 24042           END-IF
 24043           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24044           MOVE WS-CURRENT-DT          TO CDATEO
 24045           MOVE TIME-OUT               TO CTIMEO
 24046           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24047           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24048           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24049           MOVE WS-C-HDG               TO CLFHDGO
 24050           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24051           MOVE WS-C-HDG               TO CAHHDGO
 24052           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24053           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 443
* EL6311.cbl
 24054           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24055           IF   WS-DISPLAY-SCREEN
 24056                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24057                MOVE PB-SV-CARRIER     TO CCARRO
 24058                MOVE PB-SV-GROUPING    TO CGROUPO
 24059                MOVE PB-SV-STATE       TO CSTATEO
 24060                MOVE PB-ACCOUNT        TO CACCTO
 24061           ELSE
 24062                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24063        ELSE
 24064           MOVE WS-CURRENT-DT          TO DDATEO
 24065           MOVE TIME-OUT               TO DTIMEO
 24066           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24067                                          WS-REFUND-HDG-OVERRIDE
 24068           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24069           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24070           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24071                                          WS-REFUND-HDG-OVERRIDE
 24072           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24073           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24074           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24075           IF CSR-EDIT-SESSION
 24076              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24077                                 TO DHEADO
 24078           END-IF
 24079           IF  WS-DISPLAY-SCREEN
 24080               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24081               MOVE PB-CARRIER         TO DCARRO
 24082               MOVE PB-GROUPING        TO DGROUPO
 24083               MOVE PB-STATE           TO DSTATEO
 24084               MOVE PB-ACCOUNT         TO DACCTO
 24085               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24086           ELSE
 24087               MOVE EL631D             TO PI-MAP-NAME
 24088               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24089               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24090
 24091     MOVE SPACE                        TO WS-DISPLAY-SW.
 24092
 24093
 24094* EXEC CICS SEND
 24095*        MAP      (PI-MAP-NAME)
 24096*        MAPSET   (MAPSET-EL6311S)
 24097*        FROM     (EL631BI)
 24098*        ERASE
 24099*        CURSOR
 24100*    END-EXEC.
 24101     MOVE LENGTH OF
 24102      EL631BI
 24103       TO DFHEIV12
 24104     MOVE -1
 24105       TO DFHEIV11
 24106*    MOVE '8$     CT  E    H L F ,   #00020272' TO DFHEIV0
 24107     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 24108     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24109     MOVE X'2020233030303230323732' TO DFHEIV0(25:11)
 24110     CALL 'kxdfhei1' USING DFHEIV0,
 24111           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 444
* EL6311.cbl
 24112           EL631BI,
 24113           DFHEIV12,
 24114           MAPSET-EL6311S,
 24115           DFHEIV99,
 24116           DFHEIV99,
 24117           DFHEIV99,
 24118           DFHEIV11,
 24119           DFHEIV99,
 24120           DFHEIV99,
 24121           DFHEIV99
 24122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24123
 24124
 24125     GO TO 9100-RETURN-TRAN.
 24126
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 445
* EL6311.cbl
 24128
 24129******************************************************************
 24130*                                                                *
 24131*              S E N D    D A T A O N L Y                        *
 24132*                                                                *
 24133******************************************************************
 24134
 24135 8200-SEND-DATAONLY.
 24136     MOVE EIBTIME                TO TIME-IN.
 24137
 24138     IF PI-COMPANY-ID = CLIENT-GIC
 24139        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24140                                       BCPREM-ATTRB (2).
 24141
 24142     IF PI-MAP-NAME = EL631B
 24143        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24144        MOVE WS-CURRENT-DT          TO BDATEO
 24145        MOVE TIME-OUT               TO BTIMEO
 24146        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24147        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24148        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24149        MOVE SPACES                 TO BPFENTRO
 24150        MOVE AL-UANOF               TO BPFENTRA
 24151
 24152*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24153        IF PI-COMPANY-ID NOT = 'DMD'
 24154             MOVE AL-SANOF            TO BBILLEDA
 24155             MOVE AL-SADOF            TO DMDBILA
 24156         ELSE
 24157            NEXT SENTENCE
 24158*DMD CUSTOM CODING*************END
 24159     ELSE
 24160        IF PI-MAP-NAME = EL631C
 24161           MOVE WS-CURRENT-DT          TO CDATEO
 24162           MOVE TIME-OUT               TO CTIMEO
 24163           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24164           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24165           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24166           MOVE SPACES                 TO CPFENTRO
 24167           MOVE AL-UANOF               TO CPFENTRA
 24168        ELSE
 24169           MOVE WS-CURRENT-DT          TO DDATEO
 24170           MOVE TIME-OUT               TO DTIMEO
 24171           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24172
 24173
 24174* EXEC CICS SEND
 24175*        MAP      (PI-MAP-NAME)
 24176*        MAPSET   (MAPSET-EL6311S)
 24177*        FROM     (EL631BI)
 24178*        DATAONLY
 24179*        CURSOR
 24180*    END-EXEC.
 24181     MOVE LENGTH OF
 24182      EL631BI
 24183       TO DFHEIV12
 24184     MOVE -1
 24185       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 446
* EL6311.cbl
 24186*    MOVE '8$D    CT       H L F ,   #00020328' TO DFHEIV0
 24187     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24188     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24189     MOVE X'2020233030303230333238' TO DFHEIV0(25:11)
 24190     CALL 'kxdfhei1' USING DFHEIV0,
 24191           PI-MAP-NAME,
 24192           EL631BI,
 24193           DFHEIV12,
 24194           MAPSET-EL6311S,
 24195           DFHEIV99,
 24196           DFHEIV99,
 24197           DFHEIV99,
 24198           DFHEIV11,
 24199           DFHEIV99,
 24200           DFHEIV99,
 24201           DFHEIV99
 24202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24203
 24204
 24205     GO TO 9100-RETURN-TRAN.
 24206
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 447
* EL6311.cbl
 24208
 24209******************************************************************
 24210*                                                                *
 24211*           U T I L I T Y   R O U T I N E S                      *
 24212*                                                                *
 24213******************************************************************
 24214
 24215 8300-SEND-TEXT.
 24216
 24217* EXEC CICS SEND TEXT
 24218*        FROM     (LOGOFF-TEXT)
 24219*        LENGTH   (LOGOFF-LENGTH)
 24220*        ERASE
 24221*        FREEKB
 24222*    END-EXEC.
 24223*    MOVE '8&      T  E F  H   F -   #00020347' TO DFHEIV0
 24224     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24225     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24226     MOVE X'2020233030303230333437' TO DFHEIV0(25:11)
 24227     CALL 'kxdfhei1' USING DFHEIV0,
 24228           LOGOFF-TEXT,
 24229           LOGOFF-LENGTH,
 24230           DFHEIV99,
 24231           DFHEIV99,
 24232           DFHEIV99,
 24233           DFHEIV99,
 24234           DFHEIV99,
 24235           DFHEIV99,
 24236           DFHEIV99,
 24237           DFHEIV99,
 24238           DFHEIV99,
 24239           DFHEIV99
 24240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24241
 24242
 24243
 24244* EXEC CICS RETURN
 24245*    END-EXEC.
 24246*    MOVE '.(                    ''   #00020354' TO DFHEIV0
 24247     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24248     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24249     MOVE X'2020233030303230333534' TO DFHEIV0(25:11)
 24250     CALL 'kxdfhei1' USING DFHEIV0,
 24251           DFHEIV99,
 24252           DFHEIV99,
 24253           DFHEIV99,
 24254           DFHEIV99,
 24255           DFHEIV99,
 24256           DFHEIV99
 24257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24258
 24259
 24260 8400-LOG-JOURNAL-RECORD.
 24261     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24262     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24263
 24264*    EXEC CICS JOURNAL
 24265*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 448
* EL6311.cbl
 24266*        JTYPEID     ('EL')
 24267*        FROM        (JOURNAL-RECORD)
 24268*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24269*    END-EXEC.
 24270
 24271 8600-DEEDIT.
 24272
 24273* EXEC CICS BIF DEEDIT
 24274*         FIELD   (DEEDIT-FIELD)
 24275*         LENGTH  (15)
 24276*    END-EXEC.
 24277     MOVE 15
 24278       TO DFHEIV11
 24279*    MOVE '@"L                   #   #00020369' TO DFHEIV0
 24280     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24281     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24282     MOVE X'2020233030303230333639' TO DFHEIV0(25:11)
 24283     CALL 'kxdfhei1' USING DFHEIV0,
 24284           DEEDIT-FIELD,
 24285           DFHEIV11
 24286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24287
 24288
 24289 8800-UNAUTHORIZED-ACCESS.
 24290     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24291     GO TO 8300-SEND-TEXT.
 24292
 24293 8810-PF23.
 24294     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24295     MOVE XCTL-EL005             TO PGM-NAME.
 24296     GO TO 9300-XCTL.
 24297
 24298 9100-RETURN-TRAN.
 24299     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24300
 24301     IF  PI-MAP-NAME =  EL631B
 24302         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24303
 24304     IF  PI-MAP-NAME =  EL631C
 24305         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24306
 24307     IF  PI-MAP-NAME =  EL631D
 24308         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24309
 24310
 24311* EXEC CICS RETURN
 24312*        TRANSID    (TRANS-EXB1)
 24313*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24314*        LENGTH     (1300)
 24315*    END-EXEC.
 24316     MOVE 1300
 24317       TO DFHEIV11
 24318*    MOVE '.(CT                  ''   #00020395' TO DFHEIV0
 24319     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24321     MOVE X'2020233030303230333935' TO DFHEIV0(25:11)
 24322     CALL 'kxdfhei1' USING DFHEIV0,
 24323           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 449
* EL6311.cbl
 24324           PROGRAM-INTERFACE-BLOCK,
 24325           DFHEIV11,
 24326           DFHEIV99,
 24327           DFHEIV99,
 24328           DFHEIV99
 24329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24330
 24331
 24332 9200-RETURN-MAIN-MENU.
 24333     MOVE XCTL-EL626             TO PGM-NAME.
 24334     GO TO 9300-XCTL.
 24335
 24336 9300-XCTL.
 24337
 24338* EXEC CICS XCTL
 24339*        PROGRAM    (PGM-NAME)
 24340*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24341*        LENGTH     (PI-COMM-LENGTH)
 24342*    END-EXEC.
 24343*    MOVE '.$C                   %   #00020406' TO DFHEIV0
 24344     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24345     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24346     MOVE X'2020233030303230343036' TO DFHEIV0(25:11)
 24347     CALL 'kxdfhei1' USING DFHEIV0,
 24348           PGM-NAME,
 24349           PROGRAM-INTERFACE-BLOCK,
 24350           PI-COMM-LENGTH,
 24351           DFHEIV99
 24352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24353
 24354
 24355 9400-CLEAR.
 24356     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24357     GO TO 9300-XCTL.
 24358
 24359 9500-PF12.
 24360     MOVE XCTL-EL010             TO PGM-NAME.
 24361     GO TO 9300-XCTL.
 24362
 24363 9600-PGMID-ERROR.
 24364
 24365* EXEC CICS HANDLE CONDITION
 24366*        PGMIDERR    (8300-SEND-TEXT)
 24367*    END-EXEC.
 24368*    MOVE '"$L                   ! \ #00020421' TO DFHEIV0
 24369     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24371     MOVE X'5C20233030303230343231' TO DFHEIV0(25:11)
 24372     CALL 'kxdfhei1' USING DFHEIV0
 24373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24374
 24375
 24376     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24377     MOVE ' '                    TO PI-ENTRY-CD-1.
 24378     MOVE XCTL-EL005             TO PGM-NAME.
 24379     MOVE PGM-NAME               TO LOGOFF-PGM.
 24380     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24381     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 450
* EL6311.cbl
 24382
 24383 9700-DATE-LINK.
 24384     MOVE LINK-ELDATCV           TO PGM-NAME.
 24385
 24386* EXEC CICS LINK
 24387*        PROGRAM    (PGM-NAME)
 24388*        COMMAREA   (DATE-CONVERSION-DATA)
 24389*        LENGTH     (DC-COMM-LENGTH)
 24390*    END-EXEC.
 24391*    MOVE '."C                   (   #00020434' TO DFHEIV0
 24392     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24393     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24394     MOVE X'2020233030303230343334' TO DFHEIV0(25:11)
 24395     CALL 'kxdfhei1' USING DFHEIV0,
 24396           PGM-NAME,
 24397           DATE-CONVERSION-DATA,
 24398           DC-COMM-LENGTH,
 24399           DFHEIV99,
 24400           DFHEIV99,
 24401           DFHEIV99,
 24402           DFHEIV99
 24403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24404
 24405
 24406 9800-LINK-PENDING-EDIT.
 24407     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24408     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24409
 24410     MOVE LINK-EL050             TO PGM-NAME
 24411     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24412     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24413                                    WK-CO-TOL-CLAIM
 24414                                    WK-CO-TOL-PREM
 24415                                    WK-CO-TOL-REFUND
 24416                                    WK-CO-TOL-PREM-PCT
 24417                                    WK-CO-TOL-REFUND-PCT
 24418                                    WK-REFUND-OVS-AMT
 24419                                    WK-REFUND-OVS-PCT
 24420                                    WK-ACCT-ADDR
 24421                                    WK-LIFE-EDIT-ADDR
 24422                                    WK-AH-EDIT-ADDR
 24423                                    WK-LIFE-BEN-ADDR
 24424                                    WK-AH-BEN-ADDR
 24425                                    WK-STATE-ADDR
 24426                                    WK-PLAN-ADDR
 24427                                    WK-FORM-ADDR
 24428     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24429
 24430     MOVE '6'                    TO WK-ENTRY-SW.
 24431
 24432     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24433
 24434     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24435                                    EC-AM-EXPIRATION-DT
 24436                                    EC-AM-EFFECTIVE-DT
 24437                                    EC-CM-LF-CANCEL-DT
 24438                                    EC-CM-AH-CANCEL-DT
 24439                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 451
* EL6311.cbl
 24440
 24441     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24442                                    EC-CO-TOL-REFUND
 24443                                    EC-CO-MIN-AGE
 24444                                    EC-CO-MIN-PREMIUM
 24445                                    EC-CO-MIN-TERM
 24446                                    EC-CO-MAX-TERM
 24447                                    EC-ST-TOL-PREM
 24448                                    EC-ST-TOL-REFUND
 24449                                    EC-AM-LF-TOL-PREM
 24450                                    EC-AM-AH-TOL-PREM
 24451                                    EC-AM-LF-MAX-ATT-AGE
 24452                                    EC-AM-LF-MAX-AGE
 24453                                    EC-AM-LF-MAX-TERM
 24454                                    EC-AM-LF-MAX-TOT-BEN
 24455                                    EC-AM-AH-MAX-ATT-AGE
 24456                                    EC-AM-AH-MAX-AGE
 24457                                    EC-AM-AH-MAX-TERM
 24458                                    EC-AM-AH-MAX-TOT-BEN
 24459                                    EC-AM-AH-MAX-MON-BEN
 24460                                    EC-RT-LF-MAX-ATT-AGE
 24461                                    EC-RT-LF-MAX-AGE
 24462                                    EC-RT-LF-MAX-TERM
 24463                                    EC-RT-LF-MAX-TOT-BEN
 24464                                    EC-RT-AH-MAX-ATT-AGE
 24465                                    EC-RT-AH-MAX-AGE
 24466                                    EC-RT-AH-MAX-TERM
 24467                                    EC-RT-AH-MAX-TOT-BEN
 24468                                    EC-RT-AH-MAX-MON-BEN
 24469                                    EC-RT-AH-RATE
 24470                                    EC-RT-LF-RATE
 24471                                    EC-RT-LF-NSP-RATE
 24472                                    EC-RT-AH-NSP-RATE
 24473                                    EC-CM-LF-PRIOR-REFUND
 24474                                    EC-CM-AH-PRIOR-REFUND.
 24475
 24476     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24477                                    EC-ST-TOL-PREM-PCT
 24478                                    EC-AM-LF-TOL-REFUND
 24479                                    EC-AM-LF-DEV-PERCENT
 24480                                    EC-CO-TOL-REFUND-PCT
 24481                                    EC-ST-TOL-REFUND-PCT
 24482                                    EC-AM-AH-TOL-REFUND
 24483                                    EC-AM-AH-DEV-PERCENT.
 24484
 24485
 24486* EXEC CICS LINK
 24487*         PROGRAM   (PGM-NAME)
 24488*         COMMAREA  (PASSED-RECORD)
 24489*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24490*    END-EXEC.
 24491*    MOVE '."C                   (   #00020519' TO DFHEIV0
 24492     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24494     MOVE X'2020233030303230353139' TO DFHEIV0(25:11)
 24495     CALL 'kxdfhei1' USING DFHEIV0,
 24496           PGM-NAME,
 24497           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 452
* EL6311.cbl
 24498           WS-EDIT-PASS-LENGTH,
 24499           DFHEIV99,
 24500           DFHEIV99,
 24501           DFHEIV99,
 24502           DFHEIV99
 24503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24504
 24505
 24506     MOVE '1'                    TO PI-EDIT-SW.
 24507     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24508
 24509     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24510
 24511     IF PI-COMPANY-ID = 'UCL'
 24512         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24513
 24514     IF VALID-PB-ID
 24515        GO TO 9800-EXIT.
 24516
 24517     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24518
 24519     IF PI-MAP-NAME = EL631B
 24520        MOVE -1                  TO BMAINTL
 24521       ELSE
 24522        MOVE -1                  TO CMAINTL.
 24523
 24524     GO TO 8200-SEND-DATAONLY.
 24525
 24526 9800-EXIT.
 24527      EXIT.
 24528
 24529 9900-ERROR-FORMAT.
 24530
 24531     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24532
 24533     IF NOT EMI-ERRORS-COMPLETE
 24534         MOVE LINK-EL001         TO PGM-NAME
 24535
 24536* EXEC CICS LINK
 24537*            PROGRAM    (PGM-NAME)
 24538*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24539*            LENGTH     (EMI-COMM-LENGTH)
 24540*        END-EXEC.
 24541*    MOVE '."C                   (   #00020554' TO DFHEIV0
 24542     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24544     MOVE X'2020233030303230353534' TO DFHEIV0(25:11)
 24545     CALL 'kxdfhei1' USING DFHEIV0,
 24546           PGM-NAME,
 24547           ERROR-MESSAGE-INTERFACE-BLOCK,
 24548           EMI-COMM-LENGTH,
 24549           DFHEIV99,
 24550           DFHEIV99,
 24551           DFHEIV99,
 24552           DFHEIV99
 24553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24554
 24555
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 453
* EL6311.cbl
 24556 9900-EXIT.
 24557     EXIT.
 24558
 24559 9990-ABEND.
 24560     MOVE LINK-EL004             TO PGM-NAME.
 24561     MOVE DFHEIBLK               TO EMI-LINE1.
 24562
 24563* EXEC CICS LINK
 24564*        PROGRAM   (PGM-NAME)
 24565*        COMMAREA  (EMI-LINE1)
 24566*        LENGTH    (72)
 24567*    END-EXEC.
 24568     MOVE 72
 24569       TO DFHEIV11
 24570*    MOVE '."C                   (   #00020566' TO DFHEIV0
 24571     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24573     MOVE X'2020233030303230353636' TO DFHEIV0(25:11)
 24574     CALL 'kxdfhei1' USING DFHEIV0,
 24575           PGM-NAME,
 24576           EMI-LINE1,
 24577           DFHEIV11,
 24578           DFHEIV99,
 24579           DFHEIV99,
 24580           DFHEIV99,
 24581           DFHEIV99
 24582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24583
 24584
 24585     IF PI-MAP-NAME = EL631B
 24586        MOVE -1                  TO BMAINTL
 24587       ELSE
 24588        MOVE -1                  TO CMAINTL.
 24589
 24590     IF EIBTRNID NOT = TRANS-EXB1
 24591        GO TO 8100-SEND-INITIAL-MAP
 24592       ELSE
 24593        GO TO 8200-SEND-DATAONLY.
 24594
 24595 9995-SECURITY-VIOLATION.
 24596*                            COPY ELCSCTP.
 24597******************************************************************
 24598*                                                                *
 24599*                            ELCSCTP                             *
 24600*                            VMOD=2.001                          *
 24601*                                                                *
 24602*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24603******************************************************************
 24604
 24605
 24606     MOVE EIBDATE          TO SM-JUL-DATE.
 24607     MOVE EIBTRMID         TO SM-TERMID.
 24608     MOVE THIS-PGM         TO SM-PGM.
 24609     MOVE EIBTIME          TO TIME-IN.
 24610     MOVE TIME-OUT         TO SM-TIME.
 24611     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24612
 24613
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 454
* EL6311.cbl
 24614* EXEC CICS LINK
 24615*         PROGRAM  ('EL003')
 24616*         COMMAREA (SECURITY-MESSAGE)
 24617*         LENGTH   (80)
 24618*    END-EXEC.
 24619     MOVE 'EL003' TO DFHEIV1
 24620     MOVE 80
 24621       TO DFHEIV11
 24622*    MOVE '."C                   (   #00020600' TO DFHEIV0
 24623     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24625     MOVE X'2020233030303230363030' TO DFHEIV0(25:11)
 24626     CALL 'kxdfhei1' USING DFHEIV0,
 24627           DFHEIV1,
 24628           SECURITY-MESSAGE,
 24629           DFHEIV11,
 24630           DFHEIV99,
 24631           DFHEIV99,
 24632           DFHEIV99,
 24633           DFHEIV99
 24634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24635
 24636
 24637******************************************************************
 24638
 24639
 24640 9999-DFHBACK SECTION.
 24641     MOVE '9%                    "   ' TO DFHEIV0
 24642     MOVE 'EL6311' TO DFHEIV1
 24643     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24644     GOBACK.
 24645 9999-DFHEXIT.
 24646     IF DFHEIGDJ EQUAL 0001
 24647         NEXT SENTENCE
 24648     ELSE IF DFHEIGDJ EQUAL 2
 24649         GO TO 9600-PGMID-ERROR,
 24650               9990-ABEND,
 24651               9990-ABEND,
 24652               0010-MAIN-LOGIC
 24653         DEPENDING ON DFHEIGDI
 24654     ELSE IF DFHEIGDJ EQUAL 3
 24655         GO TO 1280-BATCH-HDR-NOT-FOUND
 24656         DEPENDING ON DFHEIGDI
 24657     ELSE IF DFHEIGDJ EQUAL 4
 24658         GO TO 1290-DUPLICATE-ALT-INDEX
 24659         DEPENDING ON DFHEIGDI
 24660     ELSE IF DFHEIGDJ EQUAL 5
 24661         GO TO 1295-CERT-TRL-REC-NOTFND
 24662         DEPENDING ON DFHEIGDI
 24663     ELSE IF DFHEIGDJ EQUAL 6
 24664         GO TO 1380-BATCH-HDR-NOT-FOUND
 24665         DEPENDING ON DFHEIGDI
 24666     ELSE IF DFHEIGDJ EQUAL 7
 24667         GO TO 1385-REC-NOT-FOUND
 24668         DEPENDING ON DFHEIGDI
 24669     ELSE IF DFHEIGDJ EQUAL 8
 24670         GO TO 1386-NOTFND
 24671         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 455
* EL6311.cbl
 24672     ELSE IF DFHEIGDJ EQUAL 9
 24673         GO TO 1399-EXIT
 24674         DEPENDING ON DFHEIGDI
 24675     ELSE IF DFHEIGDJ EQUAL 10
 24676         GO TO 1480-BATCH-HDR-NOT-FOUND
 24677         DEPENDING ON DFHEIGDI
 24678     ELSE IF DFHEIGDJ EQUAL 11
 24679         GO TO 1490-RECORD-NOT-FOUND
 24680         DEPENDING ON DFHEIGDI
 24681     ELSE IF DFHEIGDJ EQUAL 12
 24682         GO TO 1405-DELETE-CERTIFICATE
 24683         DEPENDING ON DFHEIGDI
 24684     ELSE IF DFHEIGDJ EQUAL 13
 24685         GO TO 1420-CONTINUE-DELETE
 24686         DEPENDING ON DFHEIGDI
 24687     ELSE IF DFHEIGDJ EQUAL 14
 24688         GO TO 1406-DELETE-ERNOTE
 24689         DEPENDING ON DFHEIGDI
 24690     ELSE IF DFHEIGDJ EQUAL 15
 24691         GO TO 1407-DELETE-MAILING
 24692         DEPENDING ON DFHEIGDI
 24693     ELSE IF DFHEIGDJ EQUAL 16
 24694         GO TO 1420-CONTINUE-DELETE
 24695         DEPENDING ON DFHEIGDI
 24696     ELSE IF DFHEIGDJ EQUAL 17
 24697         GO TO 1480-BATCH-HDR-NOT-FOUND
 24698         DEPENDING ON DFHEIGDI
 24699     ELSE IF DFHEIGDJ EQUAL 18
 24700         GO TO 1475-DELETE-FINISHED
 24701         DEPENDING ON DFHEIGDI
 24702     ELSE IF DFHEIGDJ EQUAL 19
 24703         GO TO 2280-BATCH-HDR-NOT-FOUND
 24704         DEPENDING ON DFHEIGDI
 24705     ELSE IF DFHEIGDJ EQUAL 20
 24706         GO TO 2290-DUPLICATE-ALT-INDEX
 24707         DEPENDING ON DFHEIGDI
 24708     ELSE IF DFHEIGDJ EQUAL 21
 24709         GO TO 2380-BATCH-HDR-NOT-FOUND
 24710         DEPENDING ON DFHEIGDI
 24711     ELSE IF DFHEIGDJ EQUAL 22
 24712         GO TO 2385-REC-NOT-FOUND
 24713         DEPENDING ON DFHEIGDI
 24714     ELSE IF DFHEIGDJ EQUAL 23
 24715         GO TO 2380-BATCH-HDR-NOT-FOUND
 24716         DEPENDING ON DFHEIGDI
 24717     ELSE IF DFHEIGDJ EQUAL 24
 24718         GO TO 2485-BATCH-HDR-NOT-FOUND
 24719         DEPENDING ON DFHEIGDI
 24720     ELSE IF DFHEIGDJ EQUAL 25
 24721         GO TO 2490-RECORD-NOT-FOUND
 24722         DEPENDING ON DFHEIGDI
 24723     ELSE IF DFHEIGDJ EQUAL 26
 24724         GO TO 2475-CONTINUE-DELETE
 24725         DEPENDING ON DFHEIGDI
 24726     ELSE IF DFHEIGDJ EQUAL 27
 24727         GO TO 2485-BATCH-HDR-NOT-FOUND
 24728         DEPENDING ON DFHEIGDI
 24729     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 456
* EL6311.cbl
 24730         GO TO 2480-DELETE-FINISHED
 24731         DEPENDING ON DFHEIGDI
 24732     ELSE IF DFHEIGDJ EQUAL 29
 24733         GO TO 2820-PROCESS-REWRITE
 24734         DEPENDING ON DFHEIGDI
 24735     ELSE IF DFHEIGDJ EQUAL 30
 24736         GO TO 2885-RECORD-MISSING
 24737         DEPENDING ON DFHEIGDI
 24738     ELSE IF DFHEIGDJ EQUAL 31
 24739         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24740         DEPENDING ON DFHEIGDI
 24741     ELSE IF DFHEIGDJ EQUAL 32
 24742         GO TO 2827-DELETE-MAILING
 24743         DEPENDING ON DFHEIGDI
 24744     ELSE IF DFHEIGDJ EQUAL 33
 24745         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24746         DEPENDING ON DFHEIGDI
 24747     ELSE IF DFHEIGDJ EQUAL 34
 24748         GO TO 2920-PROCESS-REWRITE
 24749         DEPENDING ON DFHEIGDI
 24750     ELSE IF DFHEIGDJ EQUAL 35
 24751         GO TO 2985-RECORD-MISSING
 24752         DEPENDING ON DFHEIGDI
 24753     ELSE IF DFHEIGDJ EQUAL 36
 24754         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24755         DEPENDING ON DFHEIGDI
 24756     ELSE IF DFHEIGDJ EQUAL 37
 24757         GO TO 2990-DUPLICATE-RECORD
 24758         DEPENDING ON DFHEIGDI
 24759     ELSE IF DFHEIGDJ EQUAL 38
 24760         GO TO 3590-NOT-FOUND
 24761         DEPENDING ON DFHEIGDI
 24762     ELSE IF DFHEIGDJ EQUAL 39
 24763         GO TO 3690-NOT-FOUND
 24764         DEPENDING ON DFHEIGDI
 24765     ELSE IF DFHEIGDJ EQUAL 40
 24766         GO TO 3990-NOT-FOUND
 24767         DEPENDING ON DFHEIGDI
 24768     ELSE IF DFHEIGDJ EQUAL 41
 24769         GO TO 4050-END-RECORDS,
 24770               4050-END-RECORDS
 24771         DEPENDING ON DFHEIGDI
 24772     ELSE IF DFHEIGDJ EQUAL 42
 24773         GO TO 4150-END-BATCH
 24774         DEPENDING ON DFHEIGDI
 24775     ELSE IF DFHEIGDJ EQUAL 43
 24776         GO TO 4150-END-BATCH
 24777         DEPENDING ON DFHEIGDI
 24778     ELSE IF DFHEIGDJ EQUAL 44
 24779         GO TO 4250-END-RECORDS,
 24780               4250-END-RECORDS
 24781         DEPENDING ON DFHEIGDI
 24782     ELSE IF DFHEIGDJ EQUAL 45
 24783         GO TO 4350-END-BATCH,
 24784               4350-END-BATCH
 24785         DEPENDING ON DFHEIGDI
 24786     ELSE IF DFHEIGDJ EQUAL 46
 24787         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:14 Page 457
* EL6311.cbl
 24788               4550-END-RECORDS
 24789         DEPENDING ON DFHEIGDI
 24790     ELSE IF DFHEIGDJ EQUAL 47
 24791         GO TO 4680-NOT-FOUND,
 24792               4680-NOT-FOUND
 24793         DEPENDING ON DFHEIGDI
 24794     ELSE IF DFHEIGDJ EQUAL 48
 24795         GO TO 4860-NOT-FOUND,
 24796               4850-END-RECORDS
 24797         DEPENDING ON DFHEIGDI
 24798     ELSE IF DFHEIGDJ EQUAL 49
 24799         GO TO 4970-NOT-FOUND,
 24800               4950-END-RECORDS
 24801         DEPENDING ON DFHEIGDI
 24802     ELSE IF DFHEIGDJ EQUAL 50
 24803         GO TO 5050-NOT-FOUND
 24804         DEPENDING ON DFHEIGDI
 24805     ELSE IF DFHEIGDJ EQUAL 51
 24806         GO TO 5050-NOT-FOUND
 24807         DEPENDING ON DFHEIGDI
 24808     ELSE IF DFHEIGDJ EQUAL 52
 24809         GO TO 5050-NOT-FOUND
 24810         DEPENDING ON DFHEIGDI
 24811     ELSE IF DFHEIGDJ EQUAL 53
 24812         GO TO 5550-END-RECORDS,
 24813               5550-END-RECORDS
 24814         DEPENDING ON DFHEIGDI
 24815     ELSE IF DFHEIGDJ EQUAL 54
 24816         GO TO 6050-QID-ERROR
 24817         DEPENDING ON DFHEIGDI
 24818     ELSE IF DFHEIGDJ EQUAL 55
 24819         GO TO 6050-QID-ERROR
 24820         DEPENDING ON DFHEIGDI
 24821     ELSE IF DFHEIGDJ EQUAL 56
 24822         GO TO 6400-CONTINUE,
 24823               6400-CONTINUE
 24824         DEPENDING ON DFHEIGDI
 24825     ELSE IF DFHEIGDJ EQUAL 57
 24826         GO TO 3690-NOT-FOUND
 24827         DEPENDING ON DFHEIGDI
 24828     ELSE IF DFHEIGDJ EQUAL 58
 24829         GO TO 7399-EXIT
 24830         DEPENDING ON DFHEIGDI
 24831     ELSE IF DFHEIGDJ EQUAL 59
 24832         GO TO 7550-OFFICER-NOTFND
 24833         DEPENDING ON DFHEIGDI
 24834     ELSE IF DFHEIGDJ EQUAL 60
 24835         GO TO 8300-SEND-TEXT
 24836         DEPENDING ON DFHEIGDI.
 24837     MOVE '9%                    "   ' TO DFHEIV0
 24838     MOVE 'EL6311' TO DFHEIV1
 24839     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24840     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14900     Code:       98468
